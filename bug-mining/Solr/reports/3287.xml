<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:20:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9838] atomic &quot;inc&quot; when adding doc doesn&apos;t respect field &quot;default&quot; from schema</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9838</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;If you do an &quot;atomic update&quot; when adding a document for the first time, then the &quot;inc&quot; operator acts as if the field has a default of 0.&lt;/p&gt;

&lt;p&gt;But if the &lt;tt&gt;&amp;lt;field/&amp;gt;&lt;/tt&gt; has an &lt;b&gt;actual&lt;/b&gt; default in the schema.xml (example: &lt;tt&gt;default=&quot;42&quot;&lt;/tt&gt;) then that default is ignored by the atomic update code path.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13026493">SOLR-9838</key>
            <summary>atomic &quot;inc&quot; when adding doc doesn&apos;t respect field &quot;default&quot; from schema</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ichattopadhyaya">Ishan Chattopadhyaya</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Dec 2016 22:13:28 +0000</created>
                <updated>Sat, 8 Jun 2019 15:30:05 +0000</updated>
                            <resolved>Mon, 13 Mar 2017 13:24:58 +0000</resolved>
                                                    <fixVersion>6.5</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15730105" author="hossman" created="Wed, 7 Dec 2016 22:15:55 +0000"  >&lt;p&gt;I noticed this while working on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5944&quot; title=&quot;Support updates of numeric DocValues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5944&quot;&gt;&lt;del&gt;SOLR-5944&lt;/del&gt;&lt;/a&gt;, as part of that issue i&apos;ll add an &lt;tt&gt;&amp;#64;AwaitsFix&lt;/tt&gt; test that points to this jira, but the general gist of the problem is that if you do something like this...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;clearIndex();
assertU(adoc(sdoc(&quot;id&quot;, &quot;7&quot;, &quot;field_with_default&quot;, ImmutableMap.of(&quot;inc&quot;, &quot;666&quot;))));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;..the end result is that doc#7 gets a value of 666 in &quot;field_with_default&quot; instead of 666 + whatever the default field value is.&lt;/p&gt;</comment>
                            <comment id="15895218" author="sarkaramrit2@gmail.com" created="Fri, 3 Mar 2017 23:09:01 +0000"  >&lt;p&gt;The troubled code is in AtomicUpdateDocumentMerger.java::doInc(..) :&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  protected void doInc(SolrInputDocument toDoc, SolrInputField sif, Object fieldVal) {
    SolrInputField numericField = toDoc.get(sif.getName());
    if (numericField == null) {
      toDoc.setField(sif.getName(),  fieldVal); //need to check the default in schema here, instead just putting whatever is coming
    } else {
     ...................................................................
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I will try to cook up a patch for the same with relevant test cases.&lt;/p&gt;</comment>
                            <comment id="15895304" author="sarkaramrit2@gmail.com" created="Sat, 4 Mar 2017 00:22:04 +0000"  >&lt;p&gt;Hoss,&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9838&quot; title=&quot;atomic &amp;quot;inc&amp;quot; when adding doc doesn&amp;#39;t respect field &amp;quot;default&amp;quot; from schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9838&quot;&gt;&lt;del&gt;SOLR-9838&lt;/del&gt;&lt;/a&gt;.patch uploaded which incorporates default values while performing &quot;inc&quot; operation. Fixed a single test-method too.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	modified:   solr/core/src/java/org/apache/solr/update/processor/AtomicUpdateDocumentMerger.java
	modified:   solr/core/src/test/org/apache/solr/update/processor/AtomicUpdatesTest.java&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Feedback will be appreciated.&lt;/p&gt;</comment>
                            <comment id="15907423" author="ichattopadhyaya" created="Mon, 13 Mar 2017 13:10:46 +0000"  >&lt;p&gt;The change looks good. Attaching another patch with some refactoring / cleanup. Planning to commit this soon.&lt;/p&gt;</comment>
                            <comment id="15907446" author="jira-bot" created="Mon, 13 Mar 2017 13:18:58 +0000"  >&lt;p&gt;Commit a06c39f3e50a1616cd7c48f4454dd77be17c7278 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a06c39f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a06c39f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9838&quot; title=&quot;atomic &amp;quot;inc&amp;quot; when adding doc doesn&amp;#39;t respect field &amp;quot;default&amp;quot; from schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9838&quot;&gt;&lt;del&gt;SOLR-9838&lt;/del&gt;&lt;/a&gt;: &apos;inc&apos; atomic update doesn&apos;t respect default field value&lt;/p&gt;</comment>
                            <comment id="15907449" author="jira-bot" created="Mon, 13 Mar 2017 13:23:51 +0000"  >&lt;p&gt;Commit dab1e2d66c9232a938ab8d6fdd1032f1984c75be in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=dab1e2d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=dab1e2d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9838&quot; title=&quot;atomic &amp;quot;inc&amp;quot; when adding doc doesn&amp;#39;t respect field &amp;quot;default&amp;quot; from schema&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9838&quot;&gt;&lt;del&gt;SOLR-9838&lt;/del&gt;&lt;/a&gt;: &apos;inc&apos; atomic update doesn&apos;t respect default field value&lt;/p&gt;</comment>
                            <comment id="15907451" author="ichattopadhyaya" created="Mon, 13 Mar 2017 13:24:58 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sarkaramrit2%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;sarkaramrit2@gmail.com&quot;&gt;sarkaramrit2@gmail.com&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12706005">SOLR-5944</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12857678" name="SOLR-9838.patch" size="3084" author="ichattopadhyaya" created="Mon, 13 Mar 2017 13:14:21 +0000"/>
                            <attachment id="12856803" name="SOLR-9838.patch" size="4104" author="sarkaramrit2@gmail.com" created="Wed, 8 Mar 2017 12:48:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37bfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>