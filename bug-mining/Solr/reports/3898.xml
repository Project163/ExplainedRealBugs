<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:32:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-12250] NegativeArraySizeException on TransactionLog if previous document more than 1.9GB</title>
                <link>https://issues.apache.org/jira/browse/SOLR-12250</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In TransactionLog, we have&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
bufSize = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.min(1024*1024, lastAddSize+(lastAddSize&amp;gt;&amp;gt;3)+256);

MemOutputStream out = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MemOutputStream(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[bufSize]);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note that bufSize will be a negative number if lastAddSize &amp;gt;&#160;1908874127 ( which is around 1.9GB).&lt;/p&gt;

&lt;p&gt;Although this seems to relate to user&apos;s error&#160;because of sending such a big document. But the exception is thrown for the update after the big one. Therefore it is better to fix the problem and solving how we can prohibit users from sending very big documents in other issues.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13153926">SOLR-12250</key>
            <summary>NegativeArraySizeException on TransactionLog if previous document more than 1.9GB</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="caomanhdat">Cao Manh Dat</assignee>
                                    <reporter username="caomanhdat">Cao Manh Dat</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Apr 2018 04:36:24 +0000</created>
                <updated>Sat, 8 Jun 2019 15:12:22 +0000</updated>
                            <resolved>Wed, 6 Jun 2018 08:53:32 +0000</resolved>
                                                    <fixVersion>7.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16447454" author="jira-bot" created="Mon, 23 Apr 2018 01:42:13 +0000"  >&lt;p&gt;Commit f8c210f1484ed2749d4e14be1fa4905fb3d96e94 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=f8c210f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=f8c210f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12250&quot; title=&quot;NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12250&quot;&gt;&lt;del&gt;SOLR-12250&lt;/del&gt;&lt;/a&gt;: NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&lt;/p&gt;</comment>
                            <comment id="16447458" author="jira-bot" created="Mon, 23 Apr 2018 01:47:21 +0000"  >&lt;p&gt;Commit 78bc27c5da58c01a836a0b87d00328d90a262569 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=78bc27c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=78bc27c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12250&quot; title=&quot;NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12250&quot;&gt;&lt;del&gt;SOLR-12250&lt;/del&gt;&lt;/a&gt;: NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&lt;/p&gt;</comment>
                            <comment id="16447716" author="jira-bot" created="Mon, 23 Apr 2018 08:14:03 +0000"  >&lt;p&gt;Commit 4136fe0e65ac4394033d24840ac364943c7d89a2 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=simonw&quot; class=&quot;user-hover&quot; rel=&quot;simonw&quot;&gt;simonw&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4136fe0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4136fe0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12250&quot; title=&quot;NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12250&quot;&gt;&lt;del&gt;SOLR-12250&lt;/del&gt;&lt;/a&gt;: Add missing assumeWorkingMockito call&lt;/p&gt;</comment>
                            <comment id="16447718" author="jira-bot" created="Mon, 23 Apr 2018 08:14:52 +0000"  >&lt;p&gt;Commit 4cd0a0aae329f62d440735f2a963ab8ba0e910bd in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=simonw&quot; class=&quot;user-hover&quot; rel=&quot;simonw&quot;&gt;simonw&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4cd0a0a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4cd0a0a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12250&quot; title=&quot;NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12250&quot;&gt;&lt;del&gt;SOLR-12250&lt;/del&gt;&lt;/a&gt;: Add missing assumeWorkingMockito call&lt;/p&gt;</comment>
                            <comment id="16448356" author="hossman" created="Mon, 23 Apr 2018 16:04:28 +0000"  >&lt;p&gt;Dat: even after simon&apos;s addition of &lt;tt&gt;assumeWorkingMockito&lt;/tt&gt; this test is still causing jenkins failures...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Build: https://jenkins.thetaphi.de/job/Lucene-Solr-7.x-Linux/1781/
Java: 64bit/jdk-11-ea+5 -XX:+UseCompressedOops -XX:+UseConcMarkSweepGC

1 tests failed.
FAILED:  org.apache.solr.update.TransactionLogTest.testBigLastAddSize

Error Message:
 Mockito cannot mock this class: class org.apache.solr.update.AddUpdateCommand.  Mockito can only mock non-private &amp;amp;
non-final classes. If you&apos;re not sure why you&apos;re getting this error, please report to the mailing list.   Java
: 11 JVM vendor name    : &quot;Oracle Corporation&quot; JVM vendor version : 11-ea+5 JVM name           : OpenJDK 64-Bit
Server VM JVM version        : 11-ea+5 JVM info           : mixed mode OS name            : Linux OS version
: 4.13.0-37-generic   Underlying exception : java.lang.UnsupportedOperationException: Cannot define class using
reflection

Stack Trace:
org.mockito.exceptions.base.MockitoException: 
Mockito cannot mock this class: class org.apache.solr.update.AddUpdateCommand.

Mockito can only mock non-private &amp;amp; non-final classes.
If you&apos;re not sure why you&apos;re getting this error, please report to the mailing list.

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16453837" author="caomanhdat" created="Thu, 26 Apr 2018 10:53:49 +0000"  >&lt;p&gt;It is weird, I run the test locally on my machine and it always pass.&lt;/p&gt;</comment>
                            <comment id="16453845" author="jira-bot" created="Thu, 26 Apr 2018 10:57:54 +0000"  >&lt;p&gt;Commit e331c068df6ef40193e41c30f1ab1c7be82021c2 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e331c06&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e331c06&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12250&quot; title=&quot;NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12250&quot;&gt;&lt;del&gt;SOLR-12250&lt;/del&gt;&lt;/a&gt;: Remove the usage of mockito&lt;/p&gt;</comment>
                            <comment id="16453846" author="jira-bot" created="Thu, 26 Apr 2018 10:58:45 +0000"  >&lt;p&gt;Commit bb084c0dbf4b13cede400f94ec7831c32c1ba247 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=bb084c0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=bb084c0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12250&quot; title=&quot;NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12250&quot;&gt;&lt;del&gt;SOLR-12250&lt;/del&gt;&lt;/a&gt;: Remove the usage of mockito&lt;/p&gt;</comment>
                            <comment id="16503009" author="jira-bot" created="Wed, 6 Jun 2018 08:50:42 +0000"  >&lt;p&gt;Commit 2f19ae1907e63864e19eda5b6325083f61f9cf66 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2f19ae1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2f19ae1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12250&quot; title=&quot;NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12250&quot;&gt;&lt;del&gt;SOLR-12250&lt;/del&gt;&lt;/a&gt;: Create the temporary tlog file properly&lt;/p&gt;</comment>
                            <comment id="16503012" author="jira-bot" created="Wed, 6 Jun 2018 08:52:39 +0000"  >&lt;p&gt;Commit 0358fcb1759038f76d91c124703c5d3244125f75 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0358fcb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0358fcb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12250&quot; title=&quot;NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12250&quot;&gt;&lt;del&gt;SOLR-12250&lt;/del&gt;&lt;/a&gt;: Fix precommit&lt;/p&gt;</comment>
                            <comment id="16503015" author="jira-bot" created="Wed, 6 Jun 2018 08:53:10 +0000"  >&lt;p&gt;Commit df98a76f8a858d95ed3ea08ffc3e03a4a150e2e9 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=df98a76&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=df98a76&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12250&quot; title=&quot;NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12250&quot;&gt;&lt;del&gt;SOLR-12250&lt;/del&gt;&lt;/a&gt;: Create the temporary tlog file properly&lt;/p&gt;</comment>
                            <comment id="16503016" author="jira-bot" created="Wed, 6 Jun 2018 08:53:11 +0000"  >&lt;p&gt;Commit 0cfa798f8a96637405c4b6bee9a56b6c47eb52ea in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0cfa798&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0cfa798&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12250&quot; title=&quot;NegativeArraySizeException on TransactionLog if previous document more than 1.9GB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12250&quot;&gt;&lt;del&gt;SOLR-12250&lt;/del&gt;&lt;/a&gt;: Fix precommit&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12919972" name="SOLR-12250.patch" size="2916" author="caomanhdat" created="Fri, 20 Apr 2018 06:49:08 +0000"/>
                            <attachment id="12919958" name="SOLR-12250.patch" size="2870" author="caomanhdat" created="Fri, 20 Apr 2018 05:13:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 23 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ssy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>