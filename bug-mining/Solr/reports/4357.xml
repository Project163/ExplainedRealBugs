<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:41:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13946] SpellCheckCollatorTest.testEstimatedHitCounts reproducing failure seed</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13946</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The following seed reliably fails on branch_8x.&#160; based on the results of git bisect, it appears that this in some way relates to changes made in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-8660&quot; title=&quot;Include totalHitsThreshold when tracking total hits in TopDocsCollector&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-8660&quot;&gt;&lt;del&gt;LUCENE-8660&lt;/del&gt;&lt;/a&gt; (TopDocsCollectors&apos;s accuracy in reporting totalHits when dealing with totalHitsThreshold) even though all usage in sol should be requesting &lt;tt&gt;totalHitsThreshold=Integer.MAX_VALUE&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=SpellCheckCollatorTest -Dtests.method=testEstimatedHitCounts -Dtests.seed=AFA731DEE618DA14 -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true -Dtests.badapples=true -Dtests.locale=ga-IE -Dtests.timezone=Canada/Atlantic -Dtests.asserts=true -Dtests.file.encoding=UTF-8
   [junit4] ERROR   0.36s | SpellCheckCollatorTest.testEstimatedHitCounts &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.RuntimeException: Exception during query
   [junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([AFA731DEE618DA14:9E1C8FEB4327CAC4]:0)
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:1001)
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:961)
   [junit4]    &amp;gt; 	at org.apache.solr.spelling.SpellCheckCollatorTest.testEstimatedHitCounts(SpellCheckCollatorTest.java:569)
   [junit4]    &amp;gt; 	at java.lang.Thread.run(Thread.java:748)
   [junit4]    &amp;gt; Caused by: java.lang.RuntimeException: REQUEST FAILED: xpath=//lst[@name=&apos;spellcheck&apos;]/lst[@name=&apos;collations&apos;]/lst[@name=&apos;collation&apos;]/long[@name=&apos;hits&apos; and 3 &amp;lt;= . and . &amp;lt;= 13]
   [junit4]    &amp;gt; 	xml response was: &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
   [junit4]    &amp;gt; &amp;lt;response&amp;gt;
   [junit4]    &amp;gt; &amp;lt;lst name=&quot;responseHeader&quot;&amp;gt;&amp;lt;int name=&quot;status&quot;&amp;gt;0&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;QTime&quot;&amp;gt;2&amp;lt;/int&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;result name=&quot;response&quot; numFound=&quot;0&quot; start=&quot;0&quot;&amp;gt;&amp;lt;/result&amp;gt;&amp;lt;lst name=&quot;spellcheck&quot;&amp;gt;&amp;lt;lst name=&quot;suggestions&quot;&amp;gt;&amp;lt;lst name=&quot;everother&quot;&amp;gt;&amp;lt;int name=&quot;numFound&quot;&amp;gt;1&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;startOffset&quot;&amp;gt;9&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;endOffset&quot;&amp;gt;18&amp;lt;/int&amp;gt;&amp;lt;arr name=&quot;suggestion&quot;&amp;gt;&amp;lt;str&amp;gt;everyother&amp;lt;/str&amp;gt;&amp;lt;/arr&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;lst name=&quot;collations&quot;&amp;gt;&amp;lt;lst name=&quot;collation&quot;&amp;gt;&amp;lt;str name=&quot;collationQuery&quot;&amp;gt;teststop:everyother&amp;lt;/str&amp;gt;&amp;lt;long name=&quot;hits&quot;&amp;gt;14&amp;lt;/long&amp;gt;&amp;lt;lst name=&quot;misspellingsAndCorrections&quot;&amp;gt;&amp;lt;str name=&quot;everother&quot;&amp;gt;everyother&amp;lt;/str&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;
   [junit4]    &amp;gt; &amp;lt;/response&amp;gt;
   [junit4]    &amp;gt; 	request was:spellcheck=true&amp;amp;spellcheck.dictionary=direct&amp;amp;spellcheck.count=1&amp;amp;spellcheck.collate=true&amp;amp;spellcheck.maxCollationTries=1&amp;amp;spellcheck.maxCollations=1&amp;amp;spellcheck.collateExtendedResults=true&amp;amp;qt=/spellCheckCompRH&amp;amp;q=teststop:everother&amp;amp;spellcheck.collateMaxCollectDocs=5
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:994)
   [junit4]    &amp;gt; 	... 41 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13269431">SOLR-13946</key>
            <summary>SpellCheckCollatorTest.testEstimatedHitCounts reproducing failure seed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Nov 2019 22:17:46 +0000</created>
                <updated>Tue, 21 Jan 2020 16:56:59 +0000</updated>
                            <resolved>Thu, 21 Nov 2019 19:01:12 +0000</resolved>
                                                    <fixVersion>8.4</fixVersion>
                    <fixVersion>9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16977881" author="hossman" created="Tue, 19 Nov 2019 22:19:55 +0000"  >&lt;p&gt;Background...&lt;/p&gt;

&lt;p&gt;Jenkins recently identified a reproducing seed failure for SpellCheckCollatorTest.testEstimatedHitCounts on branch_8_3 that reproduces on branch_8x...&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=SpellCheckCollatorTest -Dtests.method=testEstimatedHitCounts -Dtests.seed=AFA731DEE618DA14 -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true -Dtests.badapples=true -Dtests.linedocsfile=/home/jenkins/jenkins-slave/workspace/Lucene-Solr-NightlyTests-8.3/test-data/enwiki.random.lines.txt -Dtests.locale=ga-IE -Dtests.timezone=Canada/Atlantic -Dtests.asserts=true -Dtests.file.encoding=UTF-8
   [junit4] ERROR   0.16s J2 | SpellCheckCollatorTest.testEstimatedHitCounts &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.RuntimeException: Exception during query
   [junit4]    &amp;gt;        at __randomizedtesting.SeedInfo.seed([AFA731DEE618DA14:9E1C8FEB4327CAC4]:0)
   [junit4]    &amp;gt;        at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:998)
   [junit4]    &amp;gt;        at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:958)
   [junit4]    &amp;gt;        at org.apache.solr.spelling.SpellCheckCollatorTest.testEstimatedHitCounts(SpellCheckCollatorTest.java:569)
   [junit4]    &amp;gt;        at java.lang.Thread.run(Thread.java:748)
   [junit4]    &amp;gt; Caused by: java.lang.RuntimeException: REQUEST FAILED: xpath=//lst[@name=&apos;spellcheck&apos;]/lst[@name=&apos;collations&apos;]/lst[@name=&apos;collation&apos;]/long[@name=&apos;hits&apos; and 3 &amp;lt;= . and . &amp;lt;= 13]
   [junit4]    &amp;gt;        xml response was: &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
   [junit4]    &amp;gt; &amp;lt;response&amp;gt;
   [junit4]    &amp;gt; &amp;lt;lst name=&quot;responseHeader&quot;&amp;gt;&amp;lt;int name=&quot;status&quot;&amp;gt;0&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;QTime&quot;&amp;gt;2&amp;lt;/int&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;result name=&quot;response&quot; numFound=&quot;0&quot; start=&quot;0&quot;&amp;gt;&amp;lt;/result&amp;gt;&amp;lt;lst name=&quot;spellcheck&quot;&amp;gt;&amp;lt;lst name=&quot;suggestions&quot;&amp;gt;&amp;lt;lst name=&quot;everother&quot;&amp;gt;&amp;lt;int name=&quot;numFound&quot;&amp;gt;1&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;startOffset&quot;&amp;gt;9&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;endOffset&quot;&amp;gt;18&amp;lt;/int&amp;gt;&amp;lt;arr name=&quot;suggestion&quot;&amp;gt;&amp;lt;str&amp;gt;everyother&amp;lt;/str&amp;gt;&amp;lt;/arr&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;lst name=&quot;collations&quot;&amp;gt;&amp;lt;lst name=&quot;collation&quot;&amp;gt;&amp;lt;str name=&quot;collationQuery&quot;&amp;gt;teststop:everyother&amp;lt;/str&amp;gt;&amp;lt;long name=&quot;hits&quot;&amp;gt;14&amp;lt;/long&amp;gt;&amp;lt;lst name=&quot;misspellingsAndCorrections&quot;&amp;gt;&amp;lt;str name=&quot;everother&quot;&amp;gt;everyother&amp;lt;/str&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;
   [junit4]    &amp;gt; &amp;lt;/response&amp;gt;
   [junit4]    &amp;gt;        request was:spellcheck=true&amp;amp;spellcheck.dictionary=direct&amp;amp;spellcheck.count=1&amp;amp;spellcheck.collate=true&amp;amp;spellcheck.maxCollationTries=1&amp;amp;spellcheck.maxCollations=1&amp;amp;spellcheck.collateExtendedResults=true&amp;amp;qt=/spellCheckCompRH&amp;amp;q=teststop:everother&amp;amp;spellcheck.collateMaxCollectDocs=5
   [junit4]    &amp;gt;        at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:991)
   [junit4]    &amp;gt;        ... 41 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;...that seed did not reproduce on branch_8_0, so i attempted to use &quot;git bisect&quot; to idenfity when exactly it started to fail, but that lead to a false end (651f41e21bd3df98f70d2673295db29506e3d2e6) where a new variable was introduced in RandomCodec skewing the results. For completeness, i manually tried overriding the random FSTLoadMode in RandomCodec, after consuming hte same amount of randomness, and got a failure from this seed for all possible values &#8211; supporting the theory that this bug existed prior to this commit, it just doesn&apos;t manifest with the same seed prior to this.&lt;/p&gt;

&lt;p&gt;Going one commit prior to when the randomization changed (80a6590c52b) I then attempted to beast this test w/diff seeds to try and find a new permutation that would fail...&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ant beast -Dbeast.iters=1000  -Dtestcase=SpellCheckCollatorTest -Dtests.method=testEstimatedHitCounts -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true -Dtests.badapples=true  -Dtests.locale=et-EE -Dtests.timezone=Australia/Canberra -Dtests.asserts=true -Dtests.file.encoding=UTF-8
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;...and found this...&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  [beaster]   2&amp;gt; 5212 INFO  (TEST-SpellCheckCollatorTest.testEstimatedHitCounts-seed#[989A055D5EA05EC3]) [    ] o.a.s.SolrTestCaseJ4 ###Ending testEstimatedHitCounts
  [beaster]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=SpellCheckCollatorTest -Dtests.method=testEstimatedHitCounts -Dtests.seed=989A055D5EA05EC3 -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true -Dtests.badapples=true -Dtests.locale=et-EE -Dtests.timezone=Australia/Canberra -Dtests.asserts=true -Dtests.file.encoding=UTF-8
  [beaster] [14:21:03.465] ERROR   0.40s | SpellCheckCollatorTest.testEstimatedHitCounts &amp;lt;&amp;lt;&amp;lt;
  [beaster]    &amp;gt; Throwable #1: java.lang.RuntimeException: Exception during query
  [beaster]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([989A055D5EA05EC3:A921BB68FB9F4E13]:0)
  [beaster]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:934)
  [beaster]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:894)
  [beaster]    &amp;gt; 	at org.apache.solr.spelling.SpellCheckCollatorTest.testEstimatedHitCounts(SpellCheckCollatorTest.java:569)
...
  [beaster]    &amp;gt; Caused by: java.lang.RuntimeException: REQUEST FAILED: xpath=//lst[@name=&apos;spellcheck&apos;]/lst[@name=&apos;collations&apos;]/lst[@name=&apos;collation&apos;]/long[@name=&apos;hits&apos; and 3 &amp;lt;= . and . &amp;lt;= 13]
  [beaster]    &amp;gt; 	xml response was: &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
  [beaster]    &amp;gt; &amp;lt;response&amp;gt;
  [beaster]    &amp;gt; &amp;lt;lst name=&quot;responseHeader&quot;&amp;gt;&amp;lt;int name=&quot;status&quot;&amp;gt;0&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;QTime&quot;&amp;gt;3&amp;lt;/int&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;result name=&quot;response&quot; numFound=&quot;0&quot; start=&quot;0&quot;&amp;gt;&amp;lt;/result&amp;gt;&amp;lt;lst name=&quot;spellcheck&quot;&amp;gt;&amp;lt;lst name=&quot;suggestions&quot;&amp;gt;&amp;lt;lst name=&quot;everother&quot;&amp;gt;&amp;lt;int name=&quot;numFound&quot;&amp;gt;1&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;startOffset&quot;&amp;gt;9&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;endOffset&quot;&amp;gt;18&amp;lt;/int&amp;gt;&amp;lt;arr name=&quot;suggestion&quot;&amp;gt;&amp;lt;str&amp;gt;everyother&amp;lt;/str&amp;gt;&amp;lt;/arr&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;lst name=&quot;collations&quot;&amp;gt;&amp;lt;lst name=&quot;collation&quot;&amp;gt;&amp;lt;str name=&quot;collationQuery&quot;&amp;gt;teststop:everyother&amp;lt;/str&amp;gt;&amp;lt;long name=&quot;hits&quot;&amp;gt;14&amp;lt;/long&amp;gt;&amp;lt;lst name=&quot;misspellingsAndCorrections&quot;&amp;gt;&amp;lt;str name=&quot;everother&quot;&amp;gt;everyother&amp;lt;/str&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;
  [beaster]    &amp;gt; &amp;lt;/response&amp;gt;
  [beaster]    &amp;gt; 
  [beaster]    &amp;gt; 	request was:spellcheck=true&amp;amp;spellcheck.dictionary=direct&amp;amp;spellcheck.count=1&amp;amp;spellcheck.collate=true&amp;amp;spellcheck.maxCollationTries=1&amp;amp;spellcheck.maxCollations=1&amp;amp;spellcheck.collateExtendedResults=true&amp;amp;qt=/spellCheckCompRH&amp;amp;q=teststop:everother&amp;amp;spellcheck.collateMaxCollectDocs=5
  [beaster]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:927)
  [beaster]    &amp;gt; 	... 41 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;A quick check confirmed that this seed reproduced even as far back as branch_8_0 (93d1e67886e75623f3f72526284bdbc3b1fef7e6), but did &lt;b&gt;NOT&lt;/b&gt; reproduce when this assert was last (substantively) modified (213a2a1791e4557afd2542a25e94eec65e29a42d) as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5344&quot; title=&quot;SpellCheckCollatorTest.testEstimatedHitCounts fails in jenkins from time to time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5344&quot;&gt;&lt;del&gt;SOLR-5344&lt;/del&gt;&lt;/a&gt; (in 2016)&lt;/p&gt;

&lt;p&gt;So back to git bisect...&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;93d1e67886e75623f3f72526284bdbc3b1fef7e6 is the first bad commit
commit 93d1e67886e75623f3f72526284bdbc3b1fef7e6
Author: jimczi &amp;lt;jimczi@apache.org&amp;gt;
Date:   Mon Jan 28 22:43:20 2019 +0100

    LUCENE-8660: TopDocsCollectors now return an accurate count (instead of a lower bound) if the total hit count is equal to the provided threshold.

:040000 040000 7bd5d8ab9e691e1253979cf8698fa88b2c7b9fb1 ec6791f9fc718f27eb7ffd9451bff3595e25250b M	lucene
bisect run success
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;...I&apos;m not really clear on how this change could affect ths test given that AFAIK every usage of TopDocsCollectors in solr &lt;em&gt;should&lt;/em&gt; be insisting on an exact count of total hits (ie threshold=MAX_INT) but since this commit has no modifications to the test-framework randomness that could otherwise impact this test, the fact that it&apos;s first failing seed means &lt;b&gt;something&lt;/b&gt; about these changes impacted the underlying code being tested.&lt;/p&gt;</comment>
                            <comment id="16977937" author="hossman" created="Wed, 20 Nov 2019 00:04:00 +0000"  >&lt;p&gt;Looking back at &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdyer&quot; class=&quot;user-hover&quot; rel=&quot;jdyer&quot;&gt;jdyer&lt;/a&gt;&apos;s comments in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5344&quot; title=&quot;SpellCheckCollatorTest.testEstimatedHitCounts fails in jenkins from time to time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5344&quot;&gt;&lt;del&gt;SOLR-5344&lt;/del&gt;&lt;/a&gt;, i realize now that the reason 93d1e67886e7 impacted this test seed is because SpellCheckCollator uses &lt;tt&gt;SolrIndexSearcher.TERMINATE_EARLY&lt;/tt&gt; when &lt;tt&gt;spellcheck.collateMaxCollectDocs&lt;/tt&gt; is used.&lt;/p&gt;

&lt;p&gt;Fundementally, i think these assertions are just flawed given that a random merge policy can result in docs in any order &#8211; so all of the &lt;tt&gt;everyother&lt;/tt&gt; docs could wind up at the begining of the index, split across 2 segments. the first segment could contain exactly 5 docs, all of which might have that term &#8211; so the EarlyTerminatingCollector will abort with numberScanned=5, numberCollected=5 and the hueristic will think every doc in the (incredibly tiny) index is a match.  &lt;/p&gt;

&lt;p&gt;(See also &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5344&quot; title=&quot;SpellCheckCollatorTest.testEstimatedHitCounts fails in jenkins from time to time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5344&quot;&gt;&lt;del&gt;SOLR-5344&lt;/del&gt;&lt;/a&gt; still being re-opened and the record of similar reproducing seeds in the past)&lt;/p&gt;

&lt;p&gt;i &lt;b&gt;think&lt;/b&gt; the test might work &quot;as designed&quot; if we forced in order merges ... or we could just change the assertions: when &lt;tt&gt;spellcheck.collateMaxCollectDocs&lt;/tt&gt; is &amp;gt;= the actual number of docs that match, then the hits should be exact. otherwise the only thing we can really say for sure is that the lower bound should be at least as high as &lt;tt&gt;spellcheck.collateMaxCollectDocs&lt;/tt&gt; and the upper bound should never be more then the # of docs in the index.&lt;/p&gt;</comment>
                            <comment id="16978732" author="hossman" created="Wed, 20 Nov 2019 21:08:38 +0000"  >&lt;p&gt;attaching a patch i&apos;ve beasted 1000 times each on master and branch_8x using (with tests.nightly=true tests.multiplier=2 and no fixed seed) w/o any failures.&lt;/p&gt;

&lt;p&gt;i&apos;m planning to commit &amp;amp; backport soon unless anyone objects.&lt;/p&gt;</comment>
                            <comment id="16979510" author="jira-bot" created="Thu, 21 Nov 2019 18:46:46 +0000"  >&lt;p&gt;Commit 8f30f6436c13d757ea70d1168be5442810709130 in lucene-solr&apos;s branch refs/heads/master from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=8f30f64&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=8f30f64&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13946&quot; title=&quot;SpellCheckCollatorTest.testEstimatedHitCounts reproducing failure seed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13946&quot;&gt;&lt;del&gt;SOLR-13946&lt;/del&gt;&lt;/a&gt;: Fix SpellCheckCollatorTest.testEstimatedHitCounts lower/upper bounds to match computable values based on random merge policies&lt;/p&gt;</comment>
                            <comment id="16979520" author="jira-bot" created="Thu, 21 Nov 2019 19:00:51 +0000"  >&lt;p&gt;Commit 070b691b1fd360bf1d7a30ae3baf1886cda6999b in lucene-solr&apos;s branch refs/heads/branch_8x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=070b691&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=070b691&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13946&quot; title=&quot;SpellCheckCollatorTest.testEstimatedHitCounts reproducing failure seed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13946&quot;&gt;&lt;del&gt;SOLR-13946&lt;/del&gt;&lt;/a&gt;: Fix SpellCheckCollatorTest.testEstimatedHitCounts lower/upper bounds to match computable values based on random merge policies&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 8f30f6436c13d757ea70d1168be5442810709130)&lt;/p&gt;</comment>
                            <comment id="17005007" author="jpountz" created="Sun, 29 Dec 2019 20:51:26 +0000"  >&lt;p&gt;Closing after the 8.4.0 release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12673620">SOLR-5344</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12986365" name="SOLR-13946.patch" size="2988" author="hossman" created="Wed, 20 Nov 2019 21:06:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 46 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z08sy0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>