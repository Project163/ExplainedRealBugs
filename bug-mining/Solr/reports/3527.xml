<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:25:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11016] TestCloudJSONFacetJoinDomain.testBespoke() failures</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11016</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Policeman Jenkins found a reproducing branch_6x seed &lt;a href=&quot;https://jenkins.thetaphi.de/job/Lucene-Solr-6.x-MacOSX/980/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://jenkins.thetaphi.de/job/Lucene-Solr-6.x-MacOSX/980/&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Checking out Revision 9947a811e83cc0f848f9ddaa37a4137f19efff1a (refs/remotes/origin/branch_6x)
[...]
   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=TestCloudJSONFacetJoinDomain -Dtests.method=testBespoke -Dtests.seed=CF428F9440CE16E -Dtests.slow=true -Dtests.locale=cs -Dtests.timezone=America/Aruba -Dtests.asserts=true -Dtests.file.encoding=UTF-8
   [junit4] FAILURE 1.72s J1 | TestCloudJSONFacetJoinDomain.testBespoke &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: {main(json.facet={top+:+{+type:terms,+field:field_9_is,+limit:+21,+domain:{join:{from:field_5_idsS,to:field_9_is}}}+}),extra(q=(field_7_ids:6+OR+field_3_is:3)&amp;amp;rows=0)} ===&amp;gt; {responseHeader={zkConnected=true,status=0,QTime=5},response={numFound=0,start=0,maxScore=0.0,docs=[]},facets={count=0}} --&amp;gt; top key missing from: {count=0}
   [junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([CF428F9440CE16E:72FACC08C8C2699]:0)
   [junit4]    &amp;gt; 	at org.apache.solr.cloud.TestCloudJSONFacetJoinDomain.assertFacetCountsAreCorrect(TestCloudJSONFacetJoinDomain.java:333)
   [junit4]    &amp;gt; 	at org.apache.solr.cloud.TestCloudJSONFacetJoinDomain.testBespoke(TestCloudJSONFacetJoinDomain.java:262)
   [junit4]    &amp;gt; 	at java.lang.Thread.run(Thread.java:748)
   [junit4]    &amp;gt; Caused by: java.lang.AssertionError: top key missing from: {count=0}
   [junit4]    &amp;gt; 	at org.apache.solr.cloud.TestCloudJSONFacetJoinDomain.assertFacetCountsAreCorrect(TestCloudJSONFacetJoinDomain.java:351)
   [junit4]    &amp;gt; 	at org.apache.solr.cloud.TestCloudJSONFacetJoinDomain.assertFacetCountsAreCorrect(TestCloudJSONFacetJoinDomain.java:331)
[...]
   [junit4]   2&amp;gt; NOTE: test params are: codec=CheapBastard, sim=RandomSimilarity(queryNorm=true,coord=crazy): {}, locale=cs, timezone=America/Aruba
   [junit4]   2&amp;gt; NOTE: Mac OS X 10.11.6 x86_64/Oracle Corporation 1.8.0_131 (64-bit)/cpus=3,threads=1,free=58802776,total=266338304
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Another reproducing branch_6x seed, from &lt;a href=&quot;https://jenkins.thetaphi.de/job/Lucene-Solr-6.x-Solaris/849/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://jenkins.thetaphi.de/job/Lucene-Solr-6.x-Solaris/849/&lt;/a&gt; (job history has been removed since it&apos;s too old - notification email arrived on May 24th):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Java: 64bit/jdk1.8.0 -XX:+UseCompressedOops -XX:+UseSerialGC

1 tests failed.
FAILED:  org.apache.solr.cloud.TestCloudJSONFacetJoinDomain.testBespoke

Error Message:
{main(json.facet={top+:+{+type:terms,+field:field_9_is,+limit:+21,+domain:{join:{from:field_5_idsS,to:field_9_is}}}+}),extra(q=(field_7_ids:6+OR+field_3_is:3)&amp;amp;rows=0)} ===&amp;gt; {responseHeader={zkConnected=true,status=0,QTime=2},response={numFound=0,start=0,maxScore=0.0,docs=[]},facets={count=0}} --&amp;gt; top key missing from: {count=0}

Stack Trace:
java.lang.AssertionError: {main(json.facet={top+:+{+type:terms,+field:field_9_is,+limit:+21,+domain:{join:{from:field_5_idsS,to:field_9_is}}}+}),extra(q=(field_7_ids:6+OR+field_3_is:3)&amp;amp;rows=0)} ===&amp;gt; {responseHeader={zkConnected=true,status=0,QTime=2},response={numFound=0,start=0,maxScore=0.0,docs=[]},facets={count=0}} --&amp;gt; top key missing from: {count=0}
	at __randomizedtesting.SeedInfo.seed([D2F19637CE167869:D92A120E0696BF9E]:0)
	at org.apache.solr.cloud.TestCloudJSONFacetJoinDomain.assertFacetCountsAreCorrect(TestCloudJSONFacetJoinDomain.java:333)
	at org.apache.solr.cloud.TestCloudJSONFacetJoinDomain.testBespoke(TestCloudJSONFacetJoinDomain.java:262)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that both of the above seeds reproduce for me on Linux with Java8.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13084933">SOLR-11016</key>
            <summary>TestCloudJSONFacetJoinDomain.testBespoke() failures</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="sarowe">Steven Rowe</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Jul 2017 19:09:09 +0000</created>
                <updated>Sat, 8 Jun 2019 15:21:18 +0000</updated>
                            <resolved>Thu, 6 Jul 2017 16:41:54 +0000</resolved>
                                                    <fixVersion>7.0</fixVersion>
                    <fixVersion>7.1</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16075726" author="hossman" created="Thu, 6 Jul 2017 01:04:12 +0000"  >&lt;p&gt;Silly test bug &amp;#8211; the helper methods for verifying the facet results don&apos;t account for the possibility that the query won&apos;t match any (of the randomly indexed) documents.&lt;/p&gt;

&lt;p&gt;Attached patch was generated from master, but also applies cleanly to 6x where I verified it fixes the mentioned seed failures.  It also includes some new &quot;bespoke&quot; queries that force issues like this to crop up regardless of the seed.&lt;/p&gt;

&lt;p&gt;I&apos;ll hammer on this on master for a bit &amp;amp; then commit &amp;amp; backport to 7x&lt;/p&gt;</comment>
                            <comment id="16076848" author="jira-bot" created="Thu, 6 Jul 2017 16:33:29 +0000"  >&lt;p&gt;Commit d81daf54b4b567327c6ebde94b2b2eedacf19cd6 in lucene-solr&apos;s branch refs/heads/master from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d81daf5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d81daf5&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11016&quot; title=&quot;TestCloudJSONFacetJoinDomain.testBespoke() failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11016&quot;&gt;&lt;del&gt;SOLR-11016&lt;/del&gt;&lt;/a&gt;: Fix TestCloudJSONFacetJoinDomain test-only bug&lt;/p&gt;</comment>
                            <comment id="16076858" author="jira-bot" created="Thu, 6 Jul 2017 16:38:19 +0000"  >&lt;p&gt;Commit 4816a1cb1b3d66c0537c9b77b86497408b5f01c8 in lucene-solr&apos;s branch refs/heads/branch_7_0 from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4816a1c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4816a1c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11016&quot; title=&quot;TestCloudJSONFacetJoinDomain.testBespoke() failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11016&quot;&gt;&lt;del&gt;SOLR-11016&lt;/del&gt;&lt;/a&gt;: Fix TestCloudJSONFacetJoinDomain test-only bug&lt;/p&gt;

&lt;p&gt;(cherry picked from commit d81daf54b4b567327c6ebde94b2b2eedacf19cd6)&lt;/p&gt;</comment>
                            <comment id="16076859" author="jira-bot" created="Thu, 6 Jul 2017 16:38:20 +0000"  >&lt;p&gt;Commit 9fa0ff7fb34cb678e24f6fda83a9242cd8e5b55d in lucene-solr&apos;s branch refs/heads/branch_7x from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9fa0ff7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9fa0ff7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11016&quot; title=&quot;TestCloudJSONFacetJoinDomain.testBespoke() failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11016&quot;&gt;&lt;del&gt;SOLR-11016&lt;/del&gt;&lt;/a&gt;: Fix TestCloudJSONFacetJoinDomain test-only bug&lt;/p&gt;

&lt;p&gt;(cherry picked from commit d81daf54b4b567327c6ebde94b2b2eedacf19cd6)&lt;/p&gt;</comment>
                            <comment id="16207343" author="shalinmangar" created="Tue, 17 Oct 2017 11:03:38 +0000"  >&lt;p&gt;Bulk close after 7.1.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13067765">SOLR-10583</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12875840" name="SOLR-11016.patch" size="5878" author="hossman" created="Thu, 6 Jul 2017 01:01:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 5 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h5a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>