<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:34:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4321] SolrCloud collection CREATE will put multiple master shards on a single node (and no shards on some)</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4321</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;This is best described by a photo of my SolrCloud admin: &lt;a href=&quot;http://i.imgur.com/hW4xnxy.png&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://i.imgur.com/hW4xnxy.png&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I have a 4 node cluster, with shard count of 2 and replication factor of 2.&lt;/p&gt;

&lt;p&gt;After running something like,&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;http://localhost:8983/solr/admin/collections?action=CREATE&amp;amp;name=15724&amp;amp;numShards=2&amp;amp;replicationFactor=2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/admin/collections?action=CREATE&amp;amp;name=15724&amp;amp;numShards=2&amp;amp;replicationFactor=2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The shards seem to be completely randomly placed, which is fine, but some nodes receive more of the share than others (some even receiving none).&lt;/p&gt;

&lt;p&gt;For example, 15724 has given node &quot;backfill-1d&quot; 2 &quot;parts&quot;, 15724_shard1_replica2 and 15724_shard2_replica1 but has given &quot;backfill-2d&quot; nothing at all.&lt;/p&gt;

&lt;p&gt;This creates unnecessary load on some nodes, no? Is this something I am supposed to handle myself (I looked, but don&apos;t see how).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12628432">SOLR-4321</key>
            <summary>SolrCloud collection CREATE will put multiple master shards on a single node (and no shards on some)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="bretthoerner">Brett Hoerner</reporter>
                        <labels>
                    </labels>
                <created>Sat, 19 Jan 2013 22:30:43 +0000</created>
                <updated>Mon, 9 May 2016 18:44:14 +0000</updated>
                            <resolved>Thu, 24 Jan 2013 15:27:52 +0000</resolved>
                                    <version>4.1</version>
                                    <fixVersion>4.2</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13558130" author="bretthoerner" created="Sat, 19 Jan 2013 23:59:28 +0000"  >&lt;p&gt;I should note that the first collection created (by being in the solr.xml before the SolrCloud instances are brought up) is fine.&lt;/p&gt;

&lt;p&gt;I have a single collection called &quot;default&quot; in the config before I start my first node, and it starts with 1/2 shards and 0/2 replica (the first node). As each node is brought up for the first time it takes (in order), shard2, replica1, then replica2.&lt;/p&gt;

&lt;p&gt;I&apos;d like to note I&apos;m also having another problem that is only happening on 4.1 (not 4.0), and I&apos;m starting to think it could be related: &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/lucene-solr-user/201301.mbox/browser&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/lucene-solr-user/201301.mbox/browser&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13558131" author="bretthoerner" created="Sun, 20 Jan 2013 00:02:07 +0000"  >&lt;p&gt;Here are some logs from the very first boot of this cluster (repeatable). &quot;default&quot; is in solr.xml to start, I try creating test1, test2, etc using the same curl command from above (which works fine in 4.0):&lt;/p&gt;

&lt;p&gt;Jan 19, 2013 11:37:05 PM org.apache.solr.core.SolrCore initIndex&lt;br/&gt;
WARNING: &lt;span class=&quot;error&quot;&gt;&amp;#91;default&amp;#93;&lt;/span&gt; Solr index directory &apos;/mnt/solr/data/default/index&apos; doesn&apos;t exist. Creating new index...&lt;br/&gt;
Jan 19, 2013 11:45:18 PM org.apache.solr.core.SolrCore initIndex&lt;br/&gt;
WARNING: &lt;span class=&quot;error&quot;&gt;&amp;#91;test1_shard2_replica2&amp;#93;&lt;/span&gt; Solr index directory &apos;/mnt/solr/data/test1_shard2_replica2/index&apos; doesn&apos;t exist. Creating new index...&lt;br/&gt;
Jan 19, 2013 11:45:19 PM org.apache.solr.common.SolrException log&lt;br/&gt;
SEVERE: Sync Failed&lt;br/&gt;
Jan 19, 2013 11:48:29 PM org.apache.solr.core.SolrCore initIndex&lt;br/&gt;
WARNING: &lt;span class=&quot;error&quot;&gt;&amp;#91;test2_shard2_replica2&amp;#93;&lt;/span&gt; Solr index directory &apos;/mnt/solr/data/test2_shard2_replica2/index&apos; doesn&apos;t exist. Creating new index...&lt;br/&gt;
Jan 19, 2013 11:48:29 PM org.apache.solr.common.SolrException log&lt;br/&gt;
SEVERE: Sync Failed&lt;br/&gt;
Jan 19, 2013 11:48:31 PM org.apache.solr.core.SolrCore initIndex&lt;br/&gt;
WARNING: &lt;span class=&quot;error&quot;&gt;&amp;#91;test3_shard1_replica1&amp;#93;&lt;/span&gt; Solr index directory &apos;/mnt/solr/data/test3_shard1_replica1/index&apos; doesn&apos;t exist. Creating new index...&lt;br/&gt;
Jan 19, 2013 11:48:32 PM org.apache.solr.common.SolrException log&lt;br/&gt;
SEVERE: Sync Failed&lt;br/&gt;
Jan 19, 2013 11:48:34 PM org.apache.solr.core.SolrCore initIndex&lt;br/&gt;
WARNING: &lt;span class=&quot;error&quot;&gt;&amp;#91;test4_shard2_replica1&amp;#93;&lt;/span&gt; Solr index directory &apos;/mnt/solr/data/test4_shard2_replica1/index&apos; doesn&apos;t exist. Creating new index...&lt;br/&gt;
Jan 19, 2013 11:48:34 PM org.apache.solr.core.SolrCore initIndex&lt;br/&gt;
WARNING: &lt;span class=&quot;error&quot;&gt;&amp;#91;test4_shard1_replica2&amp;#93;&lt;/span&gt; Solr index directory &apos;/mnt/solr/data/test4_shard1_replica2/index&apos; doesn&apos;t exist. Creating new index...&lt;br/&gt;
Jan 19, 2013 11:48:36 PM org.apache.solr.common.SolrException log&lt;br/&gt;
SEVERE: Sync Failed&lt;br/&gt;
Jan 19, 2013 11:48:37 PM org.apache.solr.core.SolrCore initIndex&lt;br/&gt;
WARNING: &lt;span class=&quot;error&quot;&gt;&amp;#91;test5_shard2_replica2&amp;#93;&lt;/span&gt; Solr index directory &apos;/mnt/solr/data/test5_shard2_replica2/index&apos; doesn&apos;t exist. Creating new index...&lt;br/&gt;
Jan 19, 2013 11:48:39 PM org.apache.solr.common.SolrException log&lt;br/&gt;
SEVERE: Sync Failed&lt;br/&gt;
Jan 19, 2013 11:48:41 PM org.apache.solr.update.PeerSync sync&lt;br/&gt;
WARNING: no frame of reference to tell of we&apos;ve missed updates&lt;br/&gt;
Jan 19, 2013 11:50:07 PM org.apache.solr.core.SolrCore initIndex&lt;br/&gt;
WARNING: &lt;span class=&quot;error&quot;&gt;&amp;#91;foo_shard1_replica1&amp;#93;&lt;/span&gt; Solr index directory &apos;/mnt/solr/data/foo_shard1_replica1/index&apos; doesn&apos;t exist. Creating new index...&lt;br/&gt;
Jan 19, 2013 11:50:08 PM org.apache.solr.common.SolrException log&lt;br/&gt;
SEVERE: Sync Failed&lt;/p&gt;</comment>
                            <comment id="13558146" author="efalcao" created="Sun, 20 Jan 2013 01:53:23 +0000"  >&lt;p&gt;I am able to confirm this using the SolrCloud example documentation found at &lt;a href=&quot;http://wiki.apache.org/solr/SolrCloud#Example_C:_Two_shard_cluster_with_shard_replicas_and_zookeeper_ensemble&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/solr/SolrCloud#Example_C:_Two_shard_cluster_with_shard_replicas_and_zookeeper_ensemble&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Reproduction steps:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Follow example C&lt;/li&gt;
	&lt;li&gt;Create a new collection: curl &quot;http://localhost:8983/solr/admin/collections?action=CREATE&amp;amp;name=foo&amp;amp;numShards=2&amp;amp;replicationFactor=2&quot;&lt;/li&gt;
	&lt;li&gt;Verify that in the cloud admin, the new collection is imbalanced (it&apos;s not using the right mix of nodes)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;I annotated the node numbers, hoping to provide some clarity (since the ip is the same, i hope it adds some clarity):&lt;br/&gt;
&lt;a href=&quot;http://imgur.com/05L7eZ4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://imgur.com/05L7eZ4&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="13558149" author="efalcao" created="Sun, 20 Jan 2013 02:27:27 +0000"  >&lt;p&gt;Here is a better permalink for brett&apos;s issue: &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/lucene-solr-user/201301.mbox/%3CCAC8vSzZ2hmdtm6iWc9Byf6ESSATuKc7Xq%3DoPHFNeEAWqCTtJ8Q%40mail.gmail.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/lucene-solr-user/201301.mbox/%3CCAC8vSzZ2hmdtm6iWc9Byf6ESSATuKc7Xq%3DoPHFNeEAWqCTtJ8Q%40mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13558372" author="bretthoerner" created="Sun, 20 Jan 2013 20:19:11 +0000"  >&lt;p&gt;Eric&apos;s patch works for me, 4 node cluster, 2 shards, 2 replicas and each node gets 1 piece of the pie.&lt;/p&gt;</comment>
                            <comment id="13558378" author="efalcao" created="Sun, 20 Jan 2013 20:34:14 +0000"  >&lt;p&gt;Same patch but it applies at the root directory of the project&lt;/p&gt;</comment>
                            <comment id="13559784" author="markrmiller@gmail.com" created="Tue, 22 Jan 2013 17:27:40 +0000"  >&lt;p&gt;Thanks guys - I&apos;ve added a test. Will commit soon.&lt;/p&gt;</comment>
                            <comment id="13561676" author="commit-tag-bot" created="Thu, 24 Jan 2013 15:18:13 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Mark Robert Miller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1438043&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1438043&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4321&quot; title=&quot;SolrCloud collection CREATE will put multiple master shards on a single node (and no shards on some)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4321&quot;&gt;&lt;del&gt;SOLR-4321&lt;/del&gt;&lt;/a&gt;: Collections API will sometimes use a node more than once, even when more unused nodes are available.&lt;/p&gt;</comment>
                            <comment id="13561679" author="markrmiller@gmail.com" created="Thu, 24 Jan 2013 15:27:52 +0000"  >&lt;p&gt;Thanks guys!&lt;/p&gt;</comment>
                            <comment id="13561682" author="commit-tag-bot" created="Thu, 24 Jan 2013 15:32:12 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Mark Robert Miller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1438046&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1438046&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4321&quot; title=&quot;SolrCloud collection CREATE will put multiple master shards on a single node (and no shards on some)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4321&quot;&gt;&lt;del&gt;SOLR-4321&lt;/del&gt;&lt;/a&gt;: Collections API will sometimes use a node more than once, even when more unused nodes are available.&lt;/p&gt;</comment>
                            <comment id="13654096" author="thetaphi" created="Fri, 10 May 2013 10:34:00 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12565973" name="SOLR-4321.patch" size="4087" author="markrmiller@gmail.com" created="Tue, 22 Jan 2013 17:27:17 +0000"/>
                            <attachment id="12565710" name="SOLR-4321.patch" size="1268" author="efalcao" created="Sun, 20 Jan 2013 20:34:14 +0000"/>
                            <attachment id="12565662" name="SOLR-4321.patch" size="1248" author="efalcao" created="Sun, 20 Jan 2013 03:32:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>305586</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i18fhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>257312</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>