<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:57:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16735] &quot;Invalid SNI&quot; error when request server name doesn&apos;t match host certificate</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16735</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Jetty 10 slightly changed the behavior for handling SNI validation. See &lt;a href=&quot;https://github.com/eclipse/jetty.project/blob/jetty-9.4.x/jetty-server/src/main/java/org/eclipse/jetty/server/SecureRequestCustomizer.java#L262&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Jetty9.4&lt;/a&gt; vs &lt;a href=&quot;https://github.com/eclipse/jetty.project/blob/jetty-10.0.x/jetty-server/src/main/java/org/eclipse/jetty/server/SecureRequestCustomizer.java#L242&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Jetty 10&lt;/a&gt;. In Jetty 9, by default (which Solr uses up to version 9.1), SNI extension was not validated if not present, but in Jetty 10, by default, the host name is validated against the host certificate, and &lt;tt&gt;400: Invalid SNI&lt;/tt&gt; is thrown if they don&apos;t match.&lt;/p&gt;

&lt;p&gt;I think the right approach for Solr is to set &lt;tt&gt;sniHostCheck&lt;/tt&gt; to &lt;tt&gt;false&lt;/tt&gt;, and at the most be the option to configure using jetty internal sysprops like &lt;a href=&quot;https://github.com/eclipse/jetty.project/blob/jetty-10.0.x/jetty-server/src/main/config/etc/jetty-ssl.xml#L56-L61&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; &lt;/p&gt;</description>
                <environment></environment>
        <key id="13531337">SOLR-16735</key>
            <summary>&quot;Invalid SNI&quot; error when request server name doesn&apos;t match host certificate</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tflobbe">Tomas Eduardo Fernandez Lobbe</assignee>
                                    <reporter username="tflobbe">Tomas Eduardo Fernandez Lobbe</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Apr 2023 19:31:17 +0000</created>
                <updated>Fri, 17 Oct 2025 20:04:40 +0000</updated>
                            <resolved>Fri, 7 Apr 2023 05:04:35 +0000</resolved>
                                    <version>9.2</version>
                                    <fixVersion>9.3</fixVersion>
                    <fixVersion>9.2.1</fixVersion>
                    <fixVersion>10.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17708095" author="risdenk" created="Mon, 3 Apr 2023 19:48:10 +0000"  >&lt;p&gt;hmm not sure I fully understand the issue and why we would want sniHostCheck to be false.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.eclipse.org/jetty/documentation/jetty-10/operations_guide.php&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.eclipse.org/jetty/documentation/jetty-10/operations_guide.php&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The table in jetty.ssl.sniHostCheck seems to me that the default of sniHostCheck = true is correct. &lt;/p&gt;</comment>
                            <comment id="17708147" author="tomasflobbe" created="Mon, 3 Apr 2023 22:16:58 +0000"  >&lt;p&gt;The reason I think we should allow sniHostCheck to be false is that the certificate in the host could have been created for a name that&apos;s different than the one in the request, for example, if you are using a load balancer in front of the cluster. This is something that would work in Solr 9.1 and before but not Solr 9.2&lt;/p&gt;

&lt;p&gt;The reason I think we should make the default for sniHostCheck is that, if I understand correctly (and I may not &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, so correct me if I&apos;m wrong), the whole point of SNI validation is to be able to host multiple domains on the same server (Jetty). We don&apos;t support people running their apps in the same Jetty web server as Solr.&lt;/p&gt;

&lt;p&gt;I guess the reason someone may want this set to `true` could be if they are reusing the same keystore for multiple applications?&lt;/p&gt;</comment>
                            <comment id="17708340" author="janhoy" created="Tue, 4 Apr 2023 09:59:03 +0000"  >&lt;p&gt;Makes sense to me to stick with the 9.0 and 9.1 behavior and if we want to flip the default, introuce it in 10.0 and document it as a major change.&lt;/p&gt;</comment>
                            <comment id="17708554" author="tomasflobbe" created="Tue, 4 Apr 2023 19:32:31 +0000"  >&lt;p&gt;The thing is that, technically the default didn&apos;t change in Jetty (hostCheck validation was &lt;tt&gt;true&lt;/tt&gt; already in Jetty 9), is just that the validation treats differently the case of empty SNI.&lt;br/&gt;
We can, for now, just include Jetty&apos;s configuration of &lt;tt&gt;SecureRequestCustomizer&lt;/tt&gt; and let users configure via system property? maybe this is uncommon enough issue that not too many people hit it.&lt;/p&gt;</comment>
                            <comment id="17708842" author="janhoy" created="Wed, 5 Apr 2023 12:09:22 +0000"  >&lt;p&gt;Yes, perhaps call it out in upgrade notes for 9.3 with a mention of the system property, for those using a proxy and SSL.&lt;/p&gt;</comment>
                            <comment id="17709529" author="jira-bot" created="Fri, 7 Apr 2023 00:30:35 +0000"  >&lt;p&gt;Commit bb9fe5c8b6194ae859fb38a63fee49951b49b485 in solr&apos;s branch refs/heads/main from Tomas Eduardo Fernandez Lobbe&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=bb9fe5c8b61&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=bb9fe5c8b61&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16735&quot; title=&quot;&amp;quot;Invalid SNI&amp;quot; error when request server name doesn&amp;#39;t match host certificate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16735&quot;&gt;&lt;del&gt;SOLR-16735&lt;/del&gt;&lt;/a&gt;: Allow custom configuration of Jetty&apos;s SecureRequestCustomizer (#1547)&lt;/p&gt;

&lt;p&gt;This change allows users that use TLS to configure Jetty&apos;s SecureRequestCustomizer using System properties on startup&lt;/p&gt;</comment>
                            <comment id="17709579" author="jira-bot" created="Fri, 7 Apr 2023 04:22:16 +0000"  >&lt;p&gt;Commit 76a7fa332404227fa8dd8cf1bb869ac9acad6d57 in solr&apos;s branch refs/heads/branch_9x from Tomas Eduardo Fernandez Lobbe&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=76a7fa33240&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=76a7fa33240&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16735&quot; title=&quot;&amp;quot;Invalid SNI&amp;quot; error when request server name doesn&amp;#39;t match host certificate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16735&quot;&gt;&lt;del&gt;SOLR-16735&lt;/del&gt;&lt;/a&gt;: Allow custom configuration of Jetty&apos;s SecureRequestCustomizer (#1547)&lt;/p&gt;

&lt;p&gt;This change allows users that use TLS to configure Jetty&apos;s SecureRequestCustomizer using System properties on startup&lt;/p&gt;</comment>
                            <comment id="17709586" author="jira-bot" created="Fri, 7 Apr 2023 05:03:57 +0000"  >&lt;p&gt;Commit d9d86fb22a561dfccfe9c06ec5235c84dc3d34a6 in solr&apos;s branch refs/heads/branch_9_2 from Tomas Eduardo Fernandez Lobbe&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=d9d86fb22a5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=d9d86fb22a5&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16735&quot; title=&quot;&amp;quot;Invalid SNI&amp;quot; error when request server name doesn&amp;#39;t match host certificate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16735&quot;&gt;&lt;del&gt;SOLR-16735&lt;/del&gt;&lt;/a&gt;: Allow custom configuration of Jetty&apos;s SecureRequestCustomizer (#1547)&lt;/p&gt;

&lt;p&gt;This change allows users that use TLS to configure Jetty&apos;s SecureRequestCustomizer using System properties on startup&lt;/p&gt;</comment>
                            <comment id="17718241" author="jsweeney" created="Mon, 1 May 2023 15:26:04 +0000"  >&lt;p&gt;Closing after the 9.2.1 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 28 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1h2f4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>