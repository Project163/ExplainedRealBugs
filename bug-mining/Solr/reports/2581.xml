<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:06:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7818] Distributed stats only calculates with the terms that are present in the last shard of the distributed request</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7818</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In ExactStatsCache#mergeToGlobalStats we go through the n responses and merge the termStats and colStats. But we keep putting the terms into the map which means only the last shard response terms will get used.&lt;/p&gt;

&lt;p&gt;This can lead to some terms not ending up calculating the distributed idf scores as the last shard might not have contained the term while the other shards actually had those terms.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12846770">SOLR-7818</key>
            <summary>Distributed stats only calculates with the terms that are present in the last shard of the distributed request</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="varun">Varun Thacker</assignee>
                                    <reporter username="varun">Varun Thacker</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Jul 2015 06:48:02 +0000</created>
                <updated>Thu, 21 Nov 2019 00:41:46 +0000</updated>
                            <resolved>Wed, 5 Aug 2015 13:50:04 +0000</resolved>
                                    <version>5.0</version>
                    <version>5.1</version>
                    <version>5.2</version>
                    <version>5.2.1</version>
                                    <fixVersion>5.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14641967" author="varunthacker" created="Sun, 26 Jul 2015 13:33:20 +0000"  >&lt;p&gt;Patch where the terms is calculated and added at the merge stage instead of the individual shards sending them and the merge stage merging them&lt;/p&gt;</comment>
                            <comment id="14642279" author="anshumg" created="Mon, 27 Jul 2015 05:24:37 +0000"  >&lt;p&gt;We should merge the terms from shard responses in a set and add that outside of the loop rather than calling &lt;tt&gt;createNormalizedWeight&lt;/tt&gt; and &lt;tt&gt;extractTerms&lt;/tt&gt;. This approach could potentially return only local terms, depending upon the query parser.&lt;/p&gt;

&lt;p&gt;Also having a test would be nice so we don&apos;t regress.&lt;/p&gt;</comment>
                            <comment id="14655266" author="varunthacker" created="Wed, 5 Aug 2015 12:20:42 +0000"  >&lt;p&gt;Thanks Anshum for your feedback.&lt;/p&gt;

&lt;p&gt;Yeah the earlier method wouldn&apos;t have worked for query parsers like MLTQueryParser etc. &lt;/p&gt;

&lt;p&gt;Regarding a test case I&apos;ve added &lt;tt&gt;TestDistributedIDF#testMultiCollectionQuery&lt;/tt&gt; . This test exposes this problem.&lt;/p&gt;</comment>
                            <comment id="14658218" author="jira-bot" created="Wed, 5 Aug 2015 13:30:54 +0000"  >&lt;p&gt;Commit 1694210 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1694210&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1694210&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7818&quot; title=&quot;Distributed stats only calculates with the terms that are present in the last shard of the distributed request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7818&quot;&gt;&lt;del&gt;SOLR-7818&lt;/del&gt;&lt;/a&gt;: Distributed stats is only calculated with the terms that are present in the last shard of a distributed request&lt;/p&gt;</comment>
                            <comment id="14658222" author="jira-bot" created="Wed, 5 Aug 2015 13:35:41 +0000"  >&lt;p&gt;Commit 1694211 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1694211&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1694211&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7818&quot; title=&quot;Distributed stats only calculates with the terms that are present in the last shard of the distributed request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7818&quot;&gt;&lt;del&gt;SOLR-7818&lt;/del&gt;&lt;/a&gt;: Distributed stats is only calculated with the terms that are present in the last shard of a distributed request (merged from trunk r1694210)&lt;/p&gt;</comment>
                            <comment id="14658233" author="jira-bot" created="Wed, 5 Aug 2015 13:44:07 +0000"  >&lt;p&gt;Commit 1694213 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1694213&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1694213&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7818&quot; title=&quot;Distributed stats only calculates with the terms that are present in the last shard of the distributed request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7818&quot;&gt;&lt;del&gt;SOLR-7818&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7756&quot; title=&quot;ExactStatsCache and LRUStatsCache will throw an NPE when a term is not present on a shard&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7756&quot;&gt;&lt;del&gt;SOLR-7756&lt;/del&gt;&lt;/a&gt; Added better descriptions in the CHANGES entry for these two issues&lt;/p&gt;</comment>
                            <comment id="14658235" author="jira-bot" created="Wed, 5 Aug 2015 13:46:22 +0000"  >&lt;p&gt;Commit 1694214 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1694214&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1694214&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7818&quot; title=&quot;Distributed stats only calculates with the terms that are present in the last shard of the distributed request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7818&quot;&gt;&lt;del&gt;SOLR-7818&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7756&quot; title=&quot;ExactStatsCache and LRUStatsCache will throw an NPE when a term is not present on a shard&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7756&quot;&gt;&lt;del&gt;SOLR-7756&lt;/del&gt;&lt;/a&gt; Added better descriptions in the CHANGES entry for these two issues (merged from trunk r1694213)&lt;/p&gt;</comment>
                            <comment id="14658238" author="varunthacker" created="Wed, 5 Aug 2015 13:50:04 +0000"  >&lt;p&gt;Thanks Anshum for the review.&lt;/p&gt;</comment>
                            <comment id="14713267" author="shalinmangar" created="Wed, 26 Aug 2015 13:06:15 +0000"  >&lt;p&gt;Bulk close for 5.3.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12748847" name="SOLR-7818.patch" size="4799" author="varun" created="Wed, 5 Aug 2015 12:20:42 +0000"/>
                            <attachment id="12747231" name="SOLR-7818.patch" size="2937" author="varun" created="Sun, 26 Jul 2015 13:33:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 12 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2hj8v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>