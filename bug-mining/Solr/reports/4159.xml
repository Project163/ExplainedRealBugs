<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:37:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-12891] Injection Dangers in Streaming Expressions</title>
                <link>https://issues.apache.org/jira/browse/SOLR-12891</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I just spent some time fiddling with streaming expressions for fun, reading Erick Erickson&apos;s blog (&lt;a href=&quot;https://lucidworks.com/2017/12/06/streaming-expressions-in-solrj/)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lucidworks.com/2017/12/06/streaming-expressions-in-solrj/)&lt;/a&gt;&#160;and the example given in the ref guide (&lt;a href=&quot;https://lucene.apache.org/solr/guide/7_5/streaming-expressions.html#streaming-requests-and-responses)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lucene.apache.org/solr/guide/7_5/streaming-expressions.html#streaming-requests-and-responses)&lt;/a&gt;&#160;and it occurred to me that we are recommending string concatenation into an expression language with the power to harm the server, or other network services visible from the server. I&apos;m starting this Jira as a security issue to avoid creating a public impression of insecurity, feel free to undo that if I have guessed wrong. I haven&apos;t developed an exploit example, but it would go something like this:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Some portion of an expression is built including user supplied data using the techniques we&apos;re recommending in the ref guide&lt;/li&gt;
	&lt;li&gt;Malicious user constructs input data that breaks out of the expression (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10894&quot; title=&quot;Streaming expressions handling of escaped special characters bug&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10894&quot;&gt;SOLR-10894&lt;/a&gt;&#160;is relevant here), probably somewhere inside a let() expression where one could simply define an additional variable taking the value of a malicious expression...&lt;/li&gt;
	&lt;li&gt;update() expression is executed to add/overwrite data, jdbc() makes a JDBC connection to a database visible to the server, or the malicious expression executes some very expensive expression for DOS effect.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Technically this is of course the fault of the end user who allowed unchecked input into programmatic execution, but when I think about how to check the input I realize that the only way to be sure is to construct for myself a notion of exactly how the parser behaves and then determine what needs to be escaped. To do this I need to dig into the expression parser code...&lt;/p&gt;

&lt;p&gt;How to escape input is also already unclear as shown by&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10894&quot; title=&quot;Streaming expressions handling of escaped special characters bug&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10894&quot;&gt;SOLR-10894&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There&apos;s another important wrinkle that would easily be missed by someone trying to construct their own escaping/protection system relating to parameter substitution as discussed here:&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8458&quot; title=&quot;Add Streaming Expressions tests for parameter substitution&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8458&quot;&gt;&lt;del&gt;SOLR-8458&lt;/del&gt;&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;I think the solution to this is that SolrJ&#160;API should be enhanced to provide an escaping utility at a minimum and possibly a &quot;prepared expression&quot; similar to SQL prepared statements and call this issue to attention in the ref guide once these tools are available...&#160;&lt;/p&gt;

&lt;p&gt;Additionally, templating features might be a useful addition&#160;to help folks manage large expressions and facilitate re-use of patterns... such&#160;templating should also have this issue in mind when/if they are added.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13193143">SOLR-12891</key>
            <summary>Injection Dangers in Streaming Expressions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gus">Gus Heck</reporter>
                        <labels>
                            <label>security</label>
                    </labels>
                <created>Sun, 21 Oct 2018 21:24:37 +0000</created>
                <updated>Thu, 12 May 2022 00:26:24 +0000</updated>
                            <resolved>Tue, 12 Mar 2019 16:00:41 +0000</resolved>
                                    <version>7.5</version>
                    <version>8.0</version>
                                    <fixVersion>8.1</fixVersion>
                    <fixVersion>9.0</fixVersion>
                                    <component>streaming expressions</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="16658566" author="gus_heck" created="Mon, 22 Oct 2018 04:35:20 +0000"  >&lt;p&gt;Imagine a system where user entered dates are passed down to a streaming expression as part of search terms and substituted in with params myStart and myEnd that are added to the end of the url by the web application front end.&lt;/p&gt;

&lt;p&gt;Normal use:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/foo/stream?expr=let(a=search(foo,q=%22time_dt:[${myStart}%20TO%20${myEnd}]%22,%20fl=%22id,time_dt%22,sort=%22time_dt%20asc%22))&amp;amp;myStart=2000-01-01T00:00:00Z&amp;amp;myEnd=2020-01-01T00:00:00Z&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Exploit&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/foo/stream?expr=let(a=search(foo,q=%22time_dt:[${myStart}%20TO%20${myEnd}]%22,%20fl=%22id,time_dt%22,sort=%22time_dt%20asc%22))&amp;amp;myStart=2000-01-01T00:00:00Z&amp;amp;myEnd=2020-01-01T00:00:00Z]%22,fl=%22id%22,sort=%22id%20asc%22),%20b=jdbc(%20connection=%22jdbc:postgresql://localhost:5432/activate2018%22,sql=%22select%20*%20from%20users%22,sort=%22id%20asc%22),c=search(foo,q=%22time_dt:[*%20TO%20&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;response was:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;result-set&quot;&lt;/span&gt;: {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;docs&quot;&lt;/span&gt;: [{
      &lt;span class=&quot;code-quote&quot;&gt;&quot;EXCEPTION&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;Failed to determine JDBC driver from connection url &lt;span class=&quot;code-quote&quot;&gt;&apos;jdbc:postgresql:localhost:5432/activate2018&apos;&lt;/span&gt;. Usually &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; means the driver is not loaded - you can have JDBCStream &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to load it by providing the &lt;span class=&quot;code-quote&quot;&gt;&apos;driverClassName&apos;&lt;/span&gt; value&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;EOF&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;RESPONSE_TIME&quot;&lt;/span&gt;: 54
    }]
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This fails, because I haven&apos;t set up my test system with a driver jar, but it clearly tried to make a connection. So anything substituted into an expression&#160;within a let() and possibly other constructs allows arbitrary expression execution.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16658974" author="gus_heck" created="Mon, 22 Oct 2018 13:20:55 +0000"  >&lt;p&gt;The above example demonstrates the vulnerability of the language, but probably can&apos;t be solved without unacceptable changes to substitution features in our url handling, so&#160;use of url substitution&#160; might need to be simply &quot;not recommended&quot; but what should they do instead? The&#160;attached solrj code exhibits identical problems, the assumption being that the dates are user supplied in the real world.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure this issue should really be a bug. It sits in a funny gray area where we haven&apos;t really forced the user to make insecure code, but we&apos;ve gilded the path to it.&lt;/p&gt;</comment>
                            <comment id="16661200" author="joel.bernstein" created="Tue, 23 Oct 2018 20:07:53 +0000"  >&lt;p&gt;One possible approach to this is to simply turn off macro substitutions by default for streaming expressions. Then document how to turn it on (via a flag in solrconfig possibly) and what the risks are.&#160; The macro substitutions are happening before the /stream handler gets the code, so we&apos;d have to change that code to run it conditionally.&#160;&#160;&lt;/p&gt;</comment>
                            <comment id="16661229" author="cpoerschke" created="Tue, 23 Oct 2018 20:23:00 +0000"  >&lt;p&gt;Different from the &lt;a href=&quot;https://lucene.apache.org/solr/guide/7_5/variables.html#the-let-expression&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;let&lt;/a&gt; expression mentioned above, the &lt;a href=&quot;https://lucene.apache.org/solr/guide/7_5/stream-decorator-reference.html#eval&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;eval&lt;/a&gt; stream decorator is described as &quot;... allows for use cases where new streaming expressions are generated on the fly and then evaluated.  ...&quot; &amp;#8211; I am not yet familiar enough with streaming expressions to think of what an example use might look like but the &quot;on the fly&quot; bit perhaps implies a degree of risk if user input influences what is generated?&lt;/p&gt;</comment>
                            <comment id="16661255" author="joel.bernstein" created="Tue, 23 Oct 2018 20:46:24 +0000"  >&lt;p&gt;I think eval is pretty clearly understood as: &quot;If I do this code will get injected here&quot;.&#160;&lt;/p&gt;

&lt;p&gt;The macro substitution is less clear, because you may be using it for injecting a variable, but instead somebody injects code.&lt;/p&gt;</comment>
                            <comment id="16661381" author="joel.bernstein" created="Tue, 23 Oct 2018 22:18:32 +0000"  >&lt;p&gt;The&#160;MacroExpander class already has conditional logic controlling when macros should be expanded. We should be able to add more checks to block macros for requests to the /stream handler by default.&lt;/p&gt;</comment>
                            <comment id="16661458" author="gus_heck" created="Tue, 23 Oct 2018 23:26:27 +0000"  >&lt;p&gt;The recently added parallel list probably has a problem similar to let()...&#160; if we can detect&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;amp;expr=&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and turn off expansion by default, that would help that level of the problem. People who want to&#160;live dangerously of course should be able to turn it back on...&#160;&lt;/p&gt;

&lt;p&gt;I think it&apos;s probably also a good idea to provide some facility for safe substitution in java code (see my code example attached, for which a safe alternative should be available).&#160;&lt;/p&gt;</comment>
                            <comment id="16661523" author="gus_heck" created="Wed, 24 Oct 2018 00:37:06 +0000"  >&lt;p&gt;had an idea... presently taking a crack at a PreparedExpression class that works by checking that the expected number of expressions (before substitution) matches the final number of expressions (after substitution)&lt;/p&gt;</comment>
                            <comment id="16661637" author="gus_heck" created="Wed, 24 Oct 2018 02:42:54 +0000"  >&lt;p&gt;Added a patch that is my totally untested concept of a PreparedExpression class. Needs tests (or really to be executed even once!)... Just a straw man at this point.&lt;/p&gt;</comment>
                            <comment id="16662558" author="joel.bernstein" created="Wed, 24 Oct 2018 17:08:53 +0000"  >&lt;p&gt;Interesting patch. I had not thought of using regexes for this type of expression validation. We could also compile the streaming expression and then walk the nodes and count the expressions that way. But what&apos;s nice about the regex approach is that we could place code like this in an area of Solr that is decoupled from Streaming Expressions, like the MacroExpander. So potentially run the regexes, before and after the expansion and throw a security exception if we find something we don&apos;t like. I don&apos;t think this resolves all issues though as SQL injection is still possibly problematic.&#160;&lt;/p&gt;

&lt;p&gt;So, to resolve this ticket I think we should continue with the plan of turning off macro expansion by default with streaming expressions. Then in the docs that explains how to turn it, place a warning.&lt;/p&gt;</comment>
                            <comment id="16662654" author="joel.bernstein" created="Wed, 24 Oct 2018 18:30:13 +0000"  >&lt;p&gt;The place to add conditional logic is actually in RequestUtil, not the MacroExpander which I mentioned above. It is a very easy change. There also needs to be a flag that turns on/off macro expansion for streaming. I was thinking about adding this as a Java system property formatted as such: &lt;b&gt;-DStreamingExpressionMacros=true/false&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;If this property is not present than macro expansion will be turned off by default for Streaming Expressions. Then this can be documented clearly in the RefGuide.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16662705" author="gus_heck" created="Wed, 24 Oct 2018 19:18:17 +0000"  >&lt;p&gt;The regexes are just for identifying parameters... I do do a compile and walk&#160;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;(in countExpressions(StreamingExpression))&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Specifically&#160; it (supposedly, untested) works like this:&lt;/p&gt;

&lt;p&gt;1) Specify a parameterized string&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PreparedExpression prepExpr = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PreparedExpression(&lt;span class=&quot;code-quote&quot;&gt;&quot;search(collection1,q=\&quot;&lt;/span&gt;?$?\&lt;span class=&quot;code-quote&quot;&gt;&quot;, fl=\&quot;&lt;/span&gt;id\&lt;span class=&quot;code-quote&quot;&gt;&quot;, sort=\&quot;&lt;/span&gt;id asc\&lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;2) The constructor invokes a check to count up the total number of expected expressions and caches that count.&lt;/p&gt;

&lt;p&gt;3) add parameters&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
prepEpxr.addParameter(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;4) call either safeExpression() or safeExpressionString()&lt;/p&gt;

&lt;p&gt;5) The parameters are substituted and the result is counted as well, comparing to the cached expected count, erroring if they don&apos;t match&lt;/p&gt;

&lt;p&gt;6) If all goes well, then the expression/string is emitted as (string value shown here)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
search(collection1,q=&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, fl=&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;, sort=&lt;span class=&quot;code-quote&quot;&gt;&quot;id asc&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16662747" author="gus_heck" created="Wed, 24 Oct 2018 19:42:59 +0000"  >&lt;p&gt;I&apos;m curious why RequestUtil and not MacroExpander (there&apos;s a MacroExpander in Feature.java too). I was thinking something like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; expandingEpxr =
    &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.valueOf(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.getProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;StreamingExpressionMacros&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;));



&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; expand() {
  &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.expanded = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;(orig.size());
  &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; changed = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
  &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]&amp;gt; entry : orig.entrySet()) {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; k = entry.getKey();
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] values = entry.getValue();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!expandingEpxr &amp;amp;&amp;amp; &lt;span class=&quot;code-quote&quot;&gt;&quot;expr&quot;&lt;/span&gt;.equals(k) ) { &lt;span class=&quot;code-comment&quot;&gt;// SOLR-12891
&lt;/span&gt;      expanded.put(k,values);
      &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
    }
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; newK = expand(k);
...&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Thus if the expander gets used anywhere else it&apos;s still safe.&lt;/p&gt;</comment>
                            <comment id="16662976" author="joel.bernstein" created="Wed, 24 Oct 2018 23:15:30 +0000"  >&lt;p&gt;Ah, I see you are walking the expressions too, nice&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I like your approach in the MacroExpander. I was thinking the RequestUtil because we know the request handler in that part of the code, so we could block expansion for the stream and graph handler. Using the parameter value would work, as no other part of Solr uses &quot;expr&quot; as a parameter. But let&apos;s go with the MacroExpander approach.&lt;/p&gt;</comment>
                            <comment id="16663123" author="gus_heck" created="Thu, 25 Oct 2018 02:53:07 +0000"  >&lt;p&gt;MacroExpander example above&#160;seems to work but it took me a while to figure out why the error message is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Cannot parse &lt;span class=&quot;code-quote&quot;&gt;&apos;time_dt:[ TO ]&apos;&lt;/span&gt;: Encountered \&lt;span class=&quot;code-quote&quot;&gt;&quot; \&quot;&lt;/span&gt;]\&lt;span class=&quot;code-quote&quot;&gt;&quot; \&quot;&lt;/span&gt;] \&lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt; at line 1, column 13.\nWas expecting:\n    \&lt;span class=&quot;code-quote&quot;&gt;&quot;TO\&quot;&lt;/span&gt; ...\n
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;not&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Cannot parse &lt;span class=&quot;code-quote&quot;&gt;&apos;time_dt:[${myStart} TO ${myEnd}]&apos;&lt;/span&gt;: Encountered \&lt;span class=&quot;code-quote&quot;&gt;&quot; \&quot;&lt;/span&gt;]\&lt;span class=&quot;code-quote&quot;&gt;&quot; \&quot;&lt;/span&gt;] \&lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt; at line 1, column 13.\nWas expecting:\n    \&lt;span class=&quot;code-quote&quot;&gt;&quot;TO\&quot;&lt;/span&gt; ...\n
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Of course it&apos;s because when the search gets issued by the CloudSolrStream, it&apos;s now in param &quot;q&quot; not param &quot;expr&quot; and substitution happens (to nothing because the params are not present in the call to /search...) This appears to still be safe however because the search() expression&#160;doesn&apos;t appear to have a means to pass parameters to the underlying search. If parameters could be passed it might expand into something expensive, but not nearly as dangerous as expressions.&#160;Also, I think qt=/stream&#160;won&apos;t&#160;get you anywhere either since you would have to pass an expr param somehow and even if you could that would again get ignored by the expander.&lt;/p&gt;

&lt;p&gt;I have the expander fix and a test for it coded locally, will add it to the patch tomorrow along with a test for the PreparedExpression and a means to reset the prepared expression for reuse to avoid double parsing it every time. Spent my time tonight noodling the secondary substitution above and then thinking through the &quot;what if parameter passing is added later&quot; question.&#160;&lt;/p&gt;

&lt;p&gt;Also considering changing the name because it is not in fact an actual expression (i.e. not a subclass of TupleStream). On one hand the PreparedExpression/PreparedStatement parallel naming makes the purpose easy to understand if you ever did JDBC, on the other hand it&apos;s not an expression.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16664472" author="gus_heck" created="Fri, 26 Oct 2018 00:42:52 +0000"  >&lt;p&gt;Patch with tests and rename to InjectionDefense instead of PreparedExpression. But it just occurred to me the ref guide example ought to be updated...&lt;/p&gt;</comment>
                            <comment id="16664547" author="gus_heck" created="Fri, 26 Oct 2018 02:16:32 +0000"  >&lt;p&gt;Attaching patch with doc change, It loogs good in my IDE&apos;s rendering of .adoc files, but I couldn&apos;t build the ref guide. I can&apos;t seem to get around this:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Relative link points at id that doesn&apos;t exist in dest: metrics-reporting.html#the-metrics-reporters-element
... source: file:/home/gus/clients/ds/tp/code/lucene-solr/solr/build/solr-ref-guide/html-site/major-changes-in-solr-7.html
Processed 2125 links (1470 relative) to 2803 anchors in 225 files
Total of 1 problems found&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I even tried deleting the entire line in major-changes-in-solr-7.adoc that appeared to reference metrics reporting... but this still comes up (even after a clean)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16672483" author="gus_heck" created="Fri, 2 Nov 2018 01:44:55 +0000"  >&lt;p&gt;The patch seems to work, and I think this is ready to go.&#160;Should this get into 7.6?&lt;/p&gt;</comment>
                            <comment id="16673883" author="gus_heck" created="Sat, 3 Nov 2018 01:50:37 +0000"  >&lt;p&gt;I was thinking maybe I&apos;d add a note about expr being special to whatever part of the ref guide documents parameter substitution, but so far all I can find via google and quickly paging through the docs is &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yseeley%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yseeley@gmail.com&quot;&gt;yseeley@gmail.com&lt;/a&gt;&apos;s post on the topic. Does that perhaps need to be added to the documentation?&lt;/p&gt;

&lt;p&gt;I did of course find the parameter dereferencing bit for localparams, but that&apos;s obviously not quite the same thing since the syntax differs&lt;/p&gt;

&lt;p&gt;And there&apos;s this bit that seems to assume the user already knows about this feature:&#160; &lt;a href=&quot;https://lucene.apache.org/solr/guide/7_5/json-request-api.html#parameter-substitution-macro-expansion&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lucene.apache.org/solr/guide/7_5/json-request-api.html#parameter-substitution-macro-expansion&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Perhaps I should open another ticket after this is out to document the Macro expansion feature here: &lt;a href=&quot;https://lucene.apache.org/solr/guide/7_5/common-query-parameters.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lucene.apache.org/solr/guide/7_5/common-query-parameters.html&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16674412" author="gus_heck" created="Sun, 4 Nov 2018 14:08:58 +0000"  >&lt;p&gt;Ah I knew there had to be some sort of documentation on handling of security issues somewhere. I finally found &lt;a href=&quot;https://www.apache.org/security/committers.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/security/committers.html&lt;/a&gt; (this should probably be linked from &lt;a href=&quot;http://www.apache.org/dev/new-committers-guide.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/dev/new-committers-guide.html&lt;/a&gt; at a minimum, maybe from the jira create page?) I had to google &quot;Apache security issue&quot; and then scroll down to find the link at the very bottom of &lt;a href=&quot;https://www.apache.org/security/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/security/&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;It seems that I have kinda jumped the process by filing the bug, though only mildly since it is flagged security. It also seems based on that page that unless someone informs me that that process doesn&apos;t apply, this needs to be carried forward by someone on PMC (who can see the state of that process).&lt;/p&gt;</comment>
                            <comment id="16675911" author="joel.bernstein" created="Tue, 6 Nov 2018 00:09:34 +0000"  >&lt;p&gt;Hi Gus, I&apos;m finishing one other ticket then I&apos;ll have some time to review the patch. I&apos;d like to get this in for 7.6 as well.&lt;/p&gt;</comment>
                            <comment id="16690599" author="gus_heck" created="Sat, 17 Nov 2018 15:29:54 +0000"  >&lt;p&gt;Is this still likely to make 7.6? or will it be in a 7.6.1? I don&apos;t really think it should wait till 8.0/7.7&lt;/p&gt;</comment>
                            <comment id="16692295" author="joel.bernstein" created="Mon, 19 Nov 2018 21:18:38 +0000"  >&lt;p&gt;Hi Gus, sorry for the delay in reviewing. I will be reviewing the ticket later today and should have comments and changes by tomorrow.&#160;&lt;/p&gt;</comment>
                            <comment id="16702197" author="gus_heck" created="Wed, 28 Nov 2018 17:51:06 +0000"  >&lt;p&gt;Hmm RC for 7.6 appears to be tomorrow.&lt;/p&gt;</comment>
                            <comment id="16702670" author="joel.bernstein" created="Thu, 29 Nov 2018 03:24:25 +0000"  >&lt;p&gt;Hi Gus,&lt;/p&gt;

&lt;p&gt;Sorry for not getting to this sooner. After reviewing the code again it looks like the MacroExpander code is pretty simple and does the job to mitigate the risk.&#160;The InjectionDefense code is trickier and I would need more time to wrap my head around it.&#160;&lt;/p&gt;

&lt;p&gt;Let&apos;s shoot to get this in after the 7.6 release. It can be in either 7.7 or if you feel strongly about it could be in a 7.6.1.&lt;/p&gt;</comment>
                            <comment id="16702720" author="gus_heck" created="Thu, 29 Nov 2018 04:44:53 +0000"  >&lt;p&gt;That&apos;s probably good, happy to have&#160;a carful second set of eyes on it. Also, I expect that there&apos;s questions of whether or not this has a CVE etc (or not) that should be handled per policy (I&apos;m guessing the interaction on this ticket gets us through step 7, but 8 is up to you), and I&apos;d doubt that is easy to do as a last minute thing.&lt;/p&gt;

&lt;p&gt;This isn&apos;t currently a recognized problem&#160;for any&#160;users I know of;&#160;It&apos;s just something that I realized while looking at the docs. The only rush is to get it out before someone malicious&#160;realizes the same thing I did and&#160;finds someone who can get hurt by it.&lt;/p&gt;

&lt;p&gt;The set of folks vulnerable is probably somewhat small, given that one has to be A) using regular expressions and B) allowing user supplied data to form part of the expression, however it&apos;s probably pretty easy for a malicious user to identify the system as vulnerable to injection of some sort, because it will probably throw errors on &quot; chars and such. They just won&apos;t have any success throwing the script kiddie sql injections at it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;d be +1 to get in in a&#160;7.6.1, but I don&apos;t feel strongly about it, certainly better to wait 7.7 rather than jam it in 7.6 at the last minute. I guess it&apos;s protocol question of whether or not it remains secret until just before 7.6.1 or 7.7..... with 7.7 it would be a while to sit on it I guess.&lt;/p&gt;

&lt;p&gt;Another thing I just realized is I lost track of one of my goals &quot;People who want to&#160;live dangerously of course should be able to turn it back on...&#160;&quot; I don&apos;t think I actually provided that capability.&lt;/p&gt;</comment>
                            <comment id="16733535" author="ctargett" created="Thu, 3 Jan 2019 21:24:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbernste&quot; class=&quot;user-hover&quot; rel=&quot;jbernste&quot;&gt;jbernste&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gus_heck&quot; class=&quot;user-hover&quot; rel=&quot;gus_heck&quot;&gt;gus_heck&lt;/a&gt; - Since we&apos;ve been treating this as a vulnerability by keeping this issue private, we should request a CVE for it and try to get it into a 7.6.1 as soon as possible. If we don&apos;t need a CVE because it&apos;s not really a vulnerability then IMO we can make this public and take our time getting it into 7.7/8.0. &lt;/p&gt;</comment>
                            <comment id="16734535" author="ctargett" created="Fri, 4 Jan 2019 20:15:34 +0000"  >&lt;p&gt;I talked to Joel offline about this and together we determined that we probably don&apos;t need a CVE for this, nor do we need to keep this private. From my understanding, any attack based on this would need to start from an insecure website that allows a malicious actor to inject data into a form. This isn&apos;t a use case we&apos;ve seen people implement to date.&lt;/p&gt;

&lt;p&gt;Handling this scenario better is a good idea, hopefully by 8.0, but I propose making this public again and not treating it as a security issue going forward.&lt;/p&gt;</comment>
                            <comment id="16734645" author="gus_heck" created="Fri, 4 Jan 2019 22:49:58 +0000"  >&lt;p&gt;That&apos;s fine, I flagged it as security because I wasn&apos;t sure, and better safe than sorry. I think I have an action item here to follow up on the last bit of my Nov28 comment.&#160;&lt;/p&gt;</comment>
                            <comment id="16737555" author="ctargett" created="Tue, 8 Jan 2019 21:47:57 +0000"  >&lt;p&gt;Changed issue visibility from private to public.&lt;/p&gt;</comment>
                            <comment id="16747552" author="gus_heck" created="Sun, 20 Jan 2019 21:17:29 +0000"  >&lt;p&gt;patch updated for current master, and CHANGES.txt added and sysprop to restore previous behavior documented. Will commit to 7x,8x,master in a day or two if no objections&lt;/p&gt;</comment>
                            <comment id="16790623" author="jira-bot" created="Tue, 12 Mar 2019 14:47:28 +0000"  >&lt;p&gt;Commit 9edc557f4526ffbbf35daea06972eb2c595e692b in lucene-solr&apos;s branch refs/heads/master from Gus Heck&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=9edc557&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=9edc557&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12891&quot; title=&quot;Injection Dangers in Streaming Expressions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12891&quot;&gt;&lt;del&gt;SOLR-12891&lt;/del&gt;&lt;/a&gt; MacroExpander will no longer will expand URL parameters by&lt;br/&gt;
default inside of the &apos;expr&apos; parameter, add InjectionDefense class&lt;br/&gt;
for safer handling of untrusted data in streaming expressions and add&lt;br/&gt;
-DStreamingExpressionMacros system property to revert to legacy behavior&lt;/p&gt;</comment>
                            <comment id="16790685" author="jira-bot" created="Tue, 12 Mar 2019 15:57:30 +0000"  >&lt;p&gt;Commit 470813143d3b3a31232de2788a987b01a742c67e in lucene-solr&apos;s branch refs/heads/branch_8x from Gus Heck&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=4708131&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=4708131&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12891&quot; title=&quot;Injection Dangers in Streaming Expressions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12891&quot;&gt;&lt;del&gt;SOLR-12891&lt;/del&gt;&lt;/a&gt; MacroExpander will no longer will expand URL parameters by&lt;br/&gt;
default inside of the &apos;expr&apos; parameter, add InjectionDefense class&lt;br/&gt;
for safer handling of untrusted data in streaming expressions and add&lt;br/&gt;
-DStreamingExpressionMacros system property to revert to legacy behavior&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 9edc557f4526ffbbf35daea06972eb2c595e692b)&lt;/p&gt;</comment>
                            <comment id="16790688" author="gus_heck" created="Tue, 12 Mar 2019 16:00:41 +0000"  >&lt;p&gt;Finally got back to this. Tweaked the final patch slightly to allow it to pass a couple of unit tests in core, fix CHANGES.txt.&lt;/p&gt;</comment>
                            <comment id="16790884" author="cpoerschke" created="Tue, 12 Mar 2019 18:59:13 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gus_heck&quot; class=&quot;user-hover&quot; rel=&quot;gus_heck&quot;&gt;gus_heck&lt;/a&gt;, is the &lt;a href=&quot;https://github.com/apache/lucene-solr/blob/9edc557f4526ffbbf35daea06972eb2c595e692b/solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/expr/InjectionDefense.java#L85&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/9edc557f4526ffbbf35daea06972eb2c595e692b/solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/expr/InjectionDefense.java#L85&lt;/a&gt; &lt;tt&gt;System.out.println&lt;/tt&gt; potentially unintended? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickerickson&quot;&gt;erickerickson&lt;/a&gt;&#160;mentioned on the dev list about looking into some &quot;bytes to stdout and stderr&quot; limits being exceeded in tests and I speculatively searched my inbox for &quot;System.out&quot; and thus found that line 85.&lt;/p&gt;</comment>
                            <comment id="16790959" author="gus_heck" created="Tue, 12 Mar 2019 20:01:13 +0000"  >&lt;p&gt;Certainly, thanks for catching that.... I wish precommit&#160;would flag such things. Will fix.&lt;/p&gt;</comment>
                            <comment id="16791838" author="erickerickson" created="Wed, 13 Mar 2019 15:59:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gus_heck&quot; class=&quot;user-hover&quot; rel=&quot;gus_heck&quot;&gt;gus_heck&lt;/a&gt; What do you want precommit to catch? If it&apos;s uses in the non-test code of &quot;System.out.println&quot; or &quot;System.err.println&quot; that&apos;s pretty easy.&lt;/p&gt;

&lt;p&gt;See:&#160;&#160;lucene/tools/src/groovy/check-source-patterns.groovy&lt;/p&gt;

&lt;p&gt;You&apos;d have to be careful to &lt;em&gt;not&lt;/em&gt; check for this in the test files where it&apos;s legit....&lt;/p&gt;

&lt;p&gt;One thing to remember though is that the regex is executed against the &lt;em&gt;entire&lt;/em&gt; file as one big string, not line-by-line.&#160;&lt;/p&gt;

&lt;p&gt;I do seem to remember that there are some commented-out calls to System.out.*, perhaps munging the text and leaving the comment in or some clever regex makes sense. Or just removing them, I&apos;m not a huge fan of leaving comments like that in that never get removed....&lt;/p&gt;</comment>
                            <comment id="16791841" author="risdenk" created="Wed, 13 Mar 2019 16:02:07 +0000"  >&lt;p&gt;I thought forbiddenapis would catch System.out... Maybe we don&apos;t have the forbidden api rule in place?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/policeman-tools/forbidden-apis/wiki/BundledSignatures&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/policeman-tools/forbidden-apis/wiki/BundledSignatures&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;jdk-system-out&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="16792039" author="gus_heck" created="Wed, 13 Mar 2019 19:19:38 +0000"  >&lt;p&gt;Looked into it a little, filed &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13322&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-13322&lt;/a&gt; based on Kevin &amp;amp; Erik&apos;s comments on slack.&lt;/p&gt;</comment>
                            <comment id="16792056" author="joel.bernstein" created="Wed, 13 Mar 2019 19:48:04 +0000"  >&lt;p&gt;I recently left System.out in another commit and found/removed later. No precommit errors.&lt;/p&gt;</comment>
                            <comment id="17197901" author="dsmiley" created="Thu, 17 Sep 2020 18:43:03 +0000"  >&lt;p&gt;I appreciate the attention to detail on identifying this problem, and the peer review here, but respectfully, IMO the committed solution of modifying MacroExpander to check for one special parameter is a total hack.  It feels weird/yucky that user input is subject to parameter substitution &amp;#8211; &quot;q&quot; param or whatever else you concoct into other parameters.  I&apos;m not sure if the worst that could happen is merely lots of confusion (e.g. why does my attempt to search for code snippets not work when this syntax is used), or wether it might have sinister effects in some systems.  I&apos;d instead rather see macro expansion simply not work on parameters sent into the request, except maybe an allow-list that would include the &quot;json&quot; parameter and maybe one or two others, at most.  I could also imagine a local-param for a query to explicitly opt-in.  Parameters specified in configuration (request handler or params.json) would always be eligible for macro-expansion.  WDYT?  I realize I&apos;m proposing a breaking change that would only be acceptable for a major release (e.g. 9.0).&lt;/p&gt;</comment>
                            <comment id="17535396" author="janhoy" created="Thu, 12 May 2022 00:26:24 +0000"  >&lt;p&gt;Closing after the 9.0.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12955578" name="SOLR-12891.patch" size="28805" author="gus" created="Sun, 20 Jan 2019 21:15:53 +0000"/>
                            <attachment id="12945687" name="SOLR-12891.patch" size="27401" author="gus" created="Fri, 26 Oct 2018 02:16:37 +0000"/>
                            <attachment id="12945682" name="SOLR-12891.patch" size="25487" author="gus" created="Fri, 26 Oct 2018 00:41:29 +0000"/>
                            <attachment id="12945325" name="SOLR-12891.patch" size="14374" author="gus" created="Wed, 24 Oct 2018 02:41:54 +0000"/>
                            <attachment id="12945020" name="SOLR12819example.java" size="2117" author="gus" created="Mon, 22 Oct 2018 13:19:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3zgpr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>