<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:09:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16952] solr.DenseVectorField does not work on a collection with more than 1 shards</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16952</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;the field type solr.DenseVectorField introduced in solr 9.0 works well with single core user managed and single shard collection in solr cloud way, but in any multi shard collection it stores data as list of strings instead of list of floats and running query on top of it also fails to provide correct results.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;attaching screenshot, the field name is vector, which is defined as&#160;&lt;br/&gt;
&amp;lt;fieldType&#160;name=&quot;knn_vector&quot;&#160;class=&quot;solr.DenseVectorField&quot;&#160;vectorDimension=&quot;512&quot;&#160;similarityFunction=&quot;cosine&quot;/&amp;gt;&lt;br/&gt;
&lt;font color=&quot;#000080&quot;&gt;&lt;/font&gt;&lt;br/&gt;
&amp;lt;field&#160;name=&quot;vector&quot;&#160;type=&quot;knn_vector&quot;&#160;indexed=&quot;true&quot;&#160;stored=&quot;true&quot;/&amp;gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;environment check on:&lt;br/&gt;
Ubuntu 20.04&lt;br/&gt;
java 11 and java 17&lt;/p&gt;</environment>
        <key id="13548824">SOLR-16952</key>
            <summary>solr.DenseVectorField does not work on a collection with more than 1 shards</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cpoerschke">Christine Poerschke</assignee>
                                    <reporter username="qais_qadri">Qais Qadri</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Aug 2023 10:47:58 +0000</created>
                <updated>Mon, 12 Feb 2024 19:48:57 +0000</updated>
                            <resolved>Mon, 4 Dec 2023 14:55:43 +0000</resolved>
                                    <version>9.0</version>
                    <version>9.1</version>
                    <version>9.2</version>
                    <version>9.1.1</version>
                    <version>9.3</version>
                    <version>9.2.1</version>
                    <version>9.4</version>
                                    <fixVersion>9.5</fixVersion>
                                    <component>multicore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="6600">1h 50m</timespent>
                                <comments>
                            <comment id="17776683" author="alessandro.benedetti" created="Wed, 18 Oct 2023 13:38:57 +0000"  >&lt;p&gt;Can you elaborate?&lt;br/&gt;
It &apos;won&apos;t work&apos; is way too generic.&lt;br/&gt;
Do you mean that stored fields don&apos;t align with the expected JSON array type (String vs Float?)&lt;br/&gt;
Or what else?&lt;/p&gt;</comment>
                            <comment id="17779322" author="JIRAUSER301963" created="Wed, 25 Oct 2023 04:18:22 +0000"  >&lt;p&gt;Sure &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abenedetti&quot; class=&quot;user-hover&quot; rel=&quot;abenedetti&quot;&gt;abenedetti&lt;/a&gt;,&#160;&lt;br/&gt;
The field defined as solr.DenseVectorField is expected to store an array of floats, right? And this worked right in case of a single shard collection meaning it indeed stored and returned array of floats. But in a multishard collection, the field returns back an array of strings instead of array of floats. I have attached a screenshot previously where the field name &lt;em&gt;vector&lt;/em&gt; has value as array of strings instead of array of floats when original data that was indexed had list of floats, but If I create a collection with only one shard and index same data, it is correctly stored as array of floats. This causes the query on the field in multishard also return incorrect results.&lt;/p&gt;</comment>
                            <comment id="17791235" author="cpoerschke" created="Wed, 29 Nov 2023 18:17:46 +0000"  >&lt;p&gt;I&apos;m able to reproduce this &amp;#8211; arriving here via experimentation with streaming expressions and dense vector fields &amp;#8211; pull request with demo and proposed change to follow.&lt;/p&gt;</comment>
                            <comment id="17791968" author="jira-bot" created="Fri, 1 Dec 2023 09:29:21 +0000"  >&lt;p&gt;Commit ca146aaadd850218331168e62bec46a93d021c22 in solr&apos;s branch refs/heads/main from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=ca146aaadd8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=ca146aaadd8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16952&quot; title=&quot;solr.DenseVectorField does not work on a collection with more than 1 shards&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16952&quot;&gt;&lt;del&gt;SOLR-16952&lt;/del&gt;&lt;/a&gt;: add DocsStreamerTest.testDenseVectorField test (#2107)&lt;/p&gt;
</comment>
                            <comment id="17791969" author="jira-bot" created="Fri, 1 Dec 2023 09:33:38 +0000"  >&lt;p&gt;Commit c64fde3366a70cbc95714d1f4ffeb2e773b51df9 in solr&apos;s branch refs/heads/branch_9x from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=c64fde3366a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=c64fde3366a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16952&quot; title=&quot;solr.DenseVectorField does not work on a collection with more than 1 shards&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16952&quot;&gt;&lt;del&gt;SOLR-16952&lt;/del&gt;&lt;/a&gt;: add DocsStreamerTest.testDenseVectorField test (#2107)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit ca146aaadd850218331168e62bec46a93d021c22)&lt;/p&gt;</comment>
                            <comment id="17792890" author="jira-bot" created="Mon, 4 Dec 2023 14:53:25 +0000"  >&lt;p&gt;Commit 508f63b28c49349b4735248265344e76ac81c1dc in solr&apos;s branch refs/heads/main from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=508f63b28c4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=508f63b28c4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16952&quot; title=&quot;solr.DenseVectorField does not work on a collection with more than 1 shards&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16952&quot;&gt;&lt;del&gt;SOLR-16952&lt;/del&gt;&lt;/a&gt;: add DenseVectorField to DocsStreamer.KNOWN_TYPES (#2103)&lt;/p&gt;
</comment>
                            <comment id="17792892" author="jira-bot" created="Mon, 4 Dec 2023 14:54:34 +0000"  >&lt;p&gt;Commit c96463a5cef8f38184a7fc8ccd9fed81a6fbff54 in solr&apos;s branch refs/heads/branch_9x from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=c96463a5cef&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=c96463a5cef&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16952&quot; title=&quot;solr.DenseVectorField does not work on a collection with more than 1 shards&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16952&quot;&gt;&lt;del&gt;SOLR-16952&lt;/del&gt;&lt;/a&gt;: add DenseVectorField to DocsStreamer.KNOWN_TYPES (#2103)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 508f63b28c49349b4735248265344e76ac81c1dc)&lt;/p&gt;</comment>
                            <comment id="17792893" author="cpoerschke" created="Mon, 4 Dec 2023 14:55:43 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qais_qadri&quot; class=&quot;user-hover&quot; rel=&quot;qais_qadri&quot;&gt;qais_qadri&lt;/a&gt; for reporting this issue!&lt;/p&gt;</comment>
                            <comment id="17816732" author="gerlowskija" created="Mon, 12 Feb 2024 19:48:57 +0000"  >&lt;p&gt;Closing after the 9.5.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13062504" name="Screenshot from 2023-08-22 15-32-48.png" size="168931" author="qais_qadri" created="Mon, 28 Aug 2023 10:46:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1k1i0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>