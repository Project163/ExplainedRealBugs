<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:47:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-15233] ConfigurableInternodeAuthHadoopPlugin with authorization is broken</title>
                <link>https://issues.apache.org/jira/browse/SOLR-15233</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Setting up a cluster with multiple solr nodes with Kerberos using it for internode communication as well (attached security.json) and added Ranger as authorization plugin.&lt;/p&gt;

&lt;p&gt;When sending requests the authentication happens against the end user but the authorization is for solr service user.&lt;/p&gt;

&lt;p&gt;Tested two cases (3 nodes, have a collection with 2 replicas on 2 nodes of it):&lt;br/&gt;
1. send a query to a node where the collection has replica. Authorization is wrong every nodes&lt;/p&gt;

&lt;p&gt;2. send a query to a node which doesn&apos;t contain a replica. The first place authorization is fine but when the query distributed it goes as solr service user issued.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13363329">SOLR-15233</key>
            <summary>ConfigurableInternodeAuthHadoopPlugin with authorization is broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mdrob">Mike Drob</assignee>
                                    <reporter username="gezan">Geza Nagy</reporter>
                        <labels>
                            <label>authentication</label>
                            <label>authorization</label>
                    </labels>
                <created>Tue, 9 Mar 2021 17:20:28 +0000</created>
                <updated>Tue, 13 Apr 2021 20:10:32 +0000</updated>
                            <resolved>Mon, 5 Apr 2021 18:15:01 +0000</resolved>
                                    <version>8.4.1</version>
                                    <fixVersion>9.0</fixVersion>
                    <fixVersion>8.8.2</fixVersion>
                    <fixVersion>8.9</fixVersion>
                                    <component>Authentication</component>
                    <component>Authorization</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17306124" author="gerlowskija" created="Mon, 22 Mar 2021 11:20:26 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gezan&quot; class=&quot;user-hover&quot; rel=&quot;gezan&quot;&gt;gezan&lt;/a&gt;, thanks for reporting.  Do you think the issue is unique to Ranger, or could it be reproduced without?  If there&apos;s an easier way to reproduce I might be able to take a look, but the Ranger plugin is technically 3rd-party code and I have no experience with setting it up or debugging it.&lt;/p&gt;

&lt;p&gt;Would it be possible to come up with a Dockerized environment that can reproduce the problem? (perhaps piggy-backing on &lt;a href=&quot;https://github.com/chatman/solr-kerberos-docker&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this project&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="17306192" author="gezan" created="Mon, 22 Mar 2021 13:23:32 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gerlowskija&quot; class=&quot;user-hover&quot; rel=&quot;gerlowskija&quot;&gt;gerlowskija&lt;/a&gt;,&lt;br/&gt;
Honestly I haven&apos;t tried it with different plugin but this must be reproducible with other plugins as well I think.&lt;/p&gt;

&lt;p&gt;Here&apos;s what I found:&lt;br/&gt;
The authorization plugins get an authcontext and the userprincipal in it is the getReq().getUserPrincipal().&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/solr/blob/9eaefdf6b6178042bd26420fede08c0db65c45f3/solr/core/src/java/org/apache/solr/servlet/HttpSolrCall.java#L1115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/blob/9eaefdf6b6178042bd26420fede08c0db65c45f3/solr/core/src/java/org/apache/solr/servlet/HttpSolrCall.java#L1115&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;In our case (Auth with hadoop auth + Kerberos) this will be the one who sent the request and has a valid kerberos ticket or if there is a doAs parameter in the query string then the doAs user.&lt;/p&gt;

&lt;p&gt;For the internode requests Solr will use it&apos;s own kerberos login settings (in my case it&apos;s solr@EXAMPLE.COM the principal)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I saw an old ticket which is very similar to this: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13619&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-13619&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But If I understand it right it was solved only for the KerberosPlugin.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I already created a patch for the previous repository (lucene-solr), I haven&apos;t adopted yet for the current. But what I do in it is intercepting the internode requests&#160; in the ConfigurableInternodeAuthHadoopPlugin and set the doAs parameter if it&apos;s not presented already. This solved the issue for me but might be a bit naive approach.&lt;/p&gt;

&lt;p&gt;I&apos;ll upload this patch here as soon as I cherry picked to the new repo to see what I&apos;m talking about. Also I&apos;ll try to reproduce it in the solr-kerberos-docker as well.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17310568" author="gezan" created="Mon, 29 Mar 2021 11:05:15 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gerlowskija&quot; class=&quot;user-hover&quot; rel=&quot;gerlowskija&quot;&gt;gerlowskija&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I reproduced the issue using the socker project and with the RuleBasedAuth plugin (instead of Ranger)&lt;/p&gt;

&lt;p&gt;if you have time to check it&apos;s on my fork:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/gezan/solr-kerberos-docker/tree/SOLR-15233&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/gezan/solr-kerberos-docker/tree/SOLR-15233&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I also extended the README with the repro steps.&lt;/p&gt;</comment>
                            <comment id="17311633" author="gerlowskija" created="Tue, 30 Mar 2021 16:31:53 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gezan&quot; class=&quot;user-hover&quot; rel=&quot;gezan&quot;&gt;gezan&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thanks a ton for the reproduction.  Really appreciate the effort.  With the docker setup I was able to reproduce no problem.  I also checked 8.6.3 and confirm it reproduces there as well.  (I suspect the problem is in both 8.8.x and master/main, but haven&apos;t confirmed)  Your security configuration looks sane to me.  So this looks like a legit problem IMO.  I haven&apos;t tinkered with the code at all, but I suspect you&apos;re dead-on to suspect that &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13619&quot; title=&quot;Kerberos: 403 when node doesn&amp;#39;t host collection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13619&quot;&gt;&lt;del&gt;SOLR-13619&lt;/del&gt;&lt;/a&gt; seems incredibly similar and probably needs broadened out to cover other plugins like CIAHP.&lt;/p&gt;

&lt;p&gt;Since this is very likely a valid security issue I&apos;ve made this jira private for the time being.  I&apos;m going to raise this with the PMC to talk about next steps in terms of getting the ball rolling on a bug fix release and/or filing a CVE.&lt;/p&gt;</comment>
                            <comment id="17311650" author="mdrob" created="Tue, 30 Mar 2021 17:07:31 +0000"  >&lt;p&gt;I&apos;m a little confused on the details here -&lt;/p&gt;

&lt;p&gt;From the linked details on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13619&quot; title=&quot;Kerberos: 403 when node doesn&amp;#39;t host collection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13619&quot;&gt;&lt;del&gt;SOLR-13619&lt;/del&gt;&lt;/a&gt; I would expect this to be an authorization issue where we fail closed, however the description here sounds like we fail open?&lt;/p&gt;

&lt;p&gt;If we go directly to the correct node then we get the expected failure, but if we go to a different node then the request is forwarded with solr credentials not the user credentials and allows requests to succeed, did I understand that correctly?&lt;/p&gt;

&lt;p&gt;And this would be scoped to all requests, not just queries or updates or admin, right? Well, maybe admin are ok because those don&apos;t forward to other nodes? If we&apos;re doing a distributed query will it fail on one node and succeed on others?&lt;/p&gt;</comment>
                            <comment id="17311725" author="gezan" created="Tue, 30 Mar 2021 18:44:03 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mdrob&quot; class=&quot;user-hover&quot; rel=&quot;mdrob&quot;&gt;mdrob&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;You are right. I have to correct myself, it&apos;s not similar but might be related.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&quot;If we go directly to the correct node then we get the expected failure, but if we go to a different node then the request is forwarded with solr credentials not the user credentials and allows requests to succeed, did I understand that correctly?&quot;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This is right exactly&lt;/p&gt;

&lt;p&gt;This applies to any request which is forwarded to another node since from then it goes with solr user.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&quot;&#160;If we&apos;re doing a distributed query will it fail on one node and succeed on others?&quot;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;As I experienced the node which starts the distribution sends an http request to itself so it will end with 200 ok too but its already after a forwarding (since you sent the original request to a node which doesn&apos;t have a replica) it will operate with solr&apos;s permissions already.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17311735" author="gerlowskija" created="Tue, 30 Mar 2021 19:11:47 +0000"  >&lt;p&gt;Additional details:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;this behavior affects search and update requests.  Admin requests are unaffected since they&apos;re not proxied to leaders the way searches/updates are.&lt;/li&gt;
	&lt;li&gt;I was able to reproduce the behavior on 8.8.1.  I strongly suspect the issue is on &lt;tt&gt;main&lt;/tt&gt;/9.0 as well, but haven&apos;t been able to test as porting the required configuration to 9.0 has a few tricks I haven&apos;t figured out yet.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17311752" author="mdrob" created="Tue, 30 Mar 2021 19:42:02 +0000"  >&lt;p&gt;Is there anything special about the three node setup and the target collection having two shards? Or do we expect that this would reproduce with 2 nodes and a single shard collection? I&apos;m getting started on trying to set up a reproduction without docker and want to check how well we understand this already before diving further.&lt;/p&gt;</comment>
                            <comment id="17311767" author="mdrob" created="Tue, 30 Mar 2021 19:57:29 +0000"  >&lt;p&gt;Looking at this more... is this actually an issue with the Krb5HttpClientBuilder rather than the ConfigurableInternodeAuthHadoopPlugin? The regular HadoopAuthPlugin delegates internode requests to PkiAuthenticationPlugin which I expect to be doing the right thing since we have lots of test coverage there. Need to verify this though.&lt;/p&gt;

&lt;p&gt;The CIAHP delegates to whatever the configuration tells it to, so the fault would be with the client builder sending the wrong request, not with the plugin itself.&lt;/p&gt;</comment>
                            <comment id="17311769" author="gerlowskija" created="Tue, 30 Mar 2021 19:59:05 +0000"  >&lt;p&gt;My understanding is that the specific number of shards and nodes are unimportant, so long as &lt;tt&gt;numNodes &amp;gt; numShards&lt;/tt&gt; so that a node not hosting any shards is possible.  I&apos;d expect 2 nodes, 1 shard to reproduce as you mentioned.&lt;/p&gt;</comment>
                            <comment id="17311780" author="mdrob" created="Tue, 30 Mar 2021 20:13:05 +0000"  >&lt;p&gt;&lt;tt&gt;TestImpersonationWithHadoopAuth.testForwarding&lt;/tt&gt; is annotated AwaitsFix on &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-9893&quot; title=&quot;Ticket cache support for MiniKdc&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-9893&quot;&gt;HADOOP-9893&lt;/a&gt; which is still open after 8 years. Not a lot of hope for that one getting fixed. Uncommenting it gets me a 401 Authentication error, which I have no idea how to add the proper credentials to the request. If that&apos;s even related.&lt;/p&gt;</comment>
                            <comment id="17311790" author="gerlowskija" created="Tue, 30 Mar 2021 20:26:02 +0000"  >
&lt;blockquote&gt;&lt;p&gt;The CIAHP delegates to whatever the configuration tells it to, so the fault would be with the client builder sending the wrong request, not with the plugin itself.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;(Take this with a grain of salt.  Definitely open to correction from Jan or anyone that knows Solr auth stuff better.)&lt;/p&gt;

&lt;p&gt;I don&apos;t think that&apos;s wrong per-se, but I&apos;d look at it differently.  When a request has authc and authz occur on different nodes, Solr expects the auth plugin to provide the authenticated principal somewhere on the internode request.  The PKI plugin itself has logic to create the signed header containing the userPrincipal.  The KerberosPlugin also has a header (added in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13619&quot; title=&quot;Kerberos: 403 when node doesn&amp;#39;t host collection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13619&quot;&gt;&lt;del&gt;SOLR-13619&lt;/del&gt;&lt;/a&gt;). etc.&lt;/p&gt;

&lt;p&gt;You&apos;re right I think that we could solve this with logic at the builder level - it&apos;s totally doable - but other Solr places that handle this logic do it at the plugin level. &lt;/p&gt;</comment>
                            <comment id="17311837" author="mdrob" created="Tue, 30 Mar 2021 22:27:49 +0000"  >&lt;p&gt;I&apos;ve played around with a couple of tries at getting TestRuleBasedAuthorizationWithKerberos to reproduce this since it already uses CIAHP, but didn&apos;t have any luck. I started with increasing the amount of cluster nodes from 1 to 2, but we don&apos;t have any negative test cases in that class so I&apos;m not sure if my failures were of the expected kind or due to user error.&lt;/p&gt;</comment>
                            <comment id="17311987" author="mdrob" created="Wed, 31 Mar 2021 02:51:17 +0000"  >&lt;p&gt;Attached a patch that has a test, but the test fails because the requests pass. So this doesn&apos;t repro yet, but I think this is the correct way to approach this.&lt;/p&gt;</comment>
                            <comment id="17312110" author="gezan" created="Wed, 31 Mar 2021 06:33:06 +0000"  >&lt;p&gt;I think&#160;Krb5HttpClientBuilder vs&#160;ConfigurableInternodeAuthHadoopPlugin is a question of responsibility? So which component is responsible to set the correct credential when sending a request?&lt;/p&gt;

&lt;p&gt;I would say the Auth plugin because I think when the shard handler distributes a query for example I&apos;m not sure it&apos;s uses an http client from the specified client builder but using a default one.&lt;/p&gt;

&lt;p&gt;And this is the main reason why I reproduced the issue with more then 2 nodes(and 1 shard) because there is a difference between forwarding the original request (This is initiated from the HttpSolrCall class) and send the distrib queries to other shards (These are sent by the HttpShardHandler as I remember)&lt;/p&gt;</comment>
                            <comment id="17312127" author="gezan" created="Wed, 31 Mar 2021 07:02:48 +0000"  >&lt;p&gt;I added a patch (it&apos;s based on the 8.8.1 tag) as I modified the CIAHP and setting the doAs parameter to the internode requests by intercepting them.&lt;br/&gt;
 It&apos;s a naive and a bit brute force approach but by my manual testing it solves the issue.&lt;br/&gt;
 Maybe it help to figure out the final solution.&lt;/p&gt;</comment>
                            <comment id="17312319" author="gerlowskija" created="Wed, 31 Mar 2021 12:36:06 +0000"  >&lt;p&gt;Thanks Geza, I think your &lt;tt&gt;interceptInternodeRequest&lt;/tt&gt; approach here is the right one to take - that seems like the route other plugins go in handling this problem.&lt;/p&gt;

&lt;p&gt;I&apos;ll take this patch and Mike&apos;s test attempt and try to come up with a full PR for this today.  I&apos;ve assigned this to myself accordingly.&lt;/p&gt;</comment>
                            <comment id="17312502" author="gerlowskija" created="Wed, 31 Mar 2021 16:01:43 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gezan&quot; class=&quot;user-hover&quot; rel=&quot;gezan&quot;&gt;gezan&lt;/a&gt; - as I said above I think the general &lt;tt&gt;interceptInternodeRequest&lt;/tt&gt; approach you took in your patch is the right way to go.  But I&apos;m still working through some of the details - specifically about where and how the &quot;doAs&quot; parameter gets evaluated.&lt;/p&gt;

&lt;p&gt;I can see you&apos;re setting it in the interceptor, but the patch has no new code that ever checks the value.  From that I gather that &quot;doAs&quot; is a parameter that hadoop&apos;s auth library handles natively, but that still leaves me with some questions:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;I can&apos;t find any docs on how that works.  I can find &quot;doAs&quot; docs for the UGI Java client, but nothing in the context of it being a HTTP API parameter.&lt;/li&gt;
	&lt;li&gt;Does the use of &quot;doAs&quot; for internode requests require any particular hadoop-auth configuration that Solr needs to hardcode to allow this to work?  (I see some mention of feature flags for &quot;doAs&quot;-impersonation in hadoop docs, but I&apos;m not sure what others might be necessary.)&lt;/li&gt;
	&lt;li&gt;What prevents lesser-permissioned users from adding &quot;doAs&quot; to their requests before sending to Solr?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Had I written this, I probably would&apos;ve used a &quot;originalUserPrincipal&quot; header similar to what Ishan added to KerberosPlugin in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13619&quot; title=&quot;Kerberos: 403 when node doesn&amp;#39;t host collection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13619&quot;&gt;&lt;del&gt;SOLR-13619&lt;/del&gt;&lt;/a&gt;, but that&apos;s mostly because I didn&apos;t know that &quot;doAs&quot; existed.  Will dig in more this afternoon - just figured I&apos;d ask in case you had answers that would short circuit some of that investigation.  Thanks!&lt;/p&gt;</comment>
                            <comment id="17312538" author="mdrob" created="Wed, 31 Mar 2021 16:46:06 +0000"  >&lt;p&gt;Uploaded new test case  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13023260/13023260_0001-SOLR-15233-Add-negative-test-case-for-KRB-Authz.patch&quot; title=&quot;0001-SOLR-15233-Add-negative-test-case-for-KRB-Authz.patch attached to SOLR-15233&quot;&gt;0001-SOLR-15233-Add-negative-test-case-for-KRB-Authz.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; which I would expect to be failing if it was reproducing this issue correctly. However, it properly blocks both requests (the direct and the forwarded) so maybe there needs to be more nuance in the configuration. I think the issue is that I don&apos;t have a second user principal that should be authorized, i.e. we need two users so that we can escalate from one to the other?&lt;/p&gt;</comment>
                            <comment id="17312620" author="gerlowskija" created="Wed, 31 Mar 2021 18:51:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;i.e. we need two users so that we can escalate from one to the other?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think that was the issue yep.  I&apos;ve uploaded a unit test that reproduces on &apos;main&apos;:  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13023261/13023261_SOLR-15233-reproducing-unit-test.patch&quot; title=&quot;SOLR-15233-reproducing-unit-test.patch attached to SOLR-15233&quot;&gt;SOLR-15233-reproducing-unit-test.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;.  The trick I think was the switch to Http2SolrClient in the test - the SolrClient Kerberos support on the HTTP2 side doesn&apos;t rely on sysprops/static-initialization the way that we do in our HTTP1 clients, so that lets the test make an &quot;end-user&quot; request with a different principal from what Solr uses for internode requests.&lt;/p&gt;

&lt;p&gt;In the meantime I&apos;m still trying to better understand the &quot;doAs&quot; functionality that Geza hooked into in his patch.  Trying to decide between that hadoop-native approach and creating our own header for this info as the KerberosPlugin does.&lt;/p&gt;</comment>
                            <comment id="17312623" author="gezan" created="Wed, 31 Mar 2021 18:53:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gerlowskija&quot; class=&quot;user-hover&quot; rel=&quot;gerlowskija&quot;&gt;gerlowskija&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The doAs parameter is evaluated in this class from hadoop-common project:&#160;&lt;b&gt;org.apache.hadoop.security.token.delegation.web.DelegationTokenAuthenticationFilter&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I can&apos;t find any docs on how that works. I can find &quot;doAs&quot; docs for the UGI Java client, but nothing in the context of it being a HTTP API parameter.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In short it grabs the doAs param from &lt;em&gt;request.queryString()&lt;/em&gt; then sets up the proxy user and authorize it (this only checks if the user is eligible for setting the given proxy user). If it succeeds it wraps the original request and this wrapper has the getUserPrincpial() method which will return the doAs instead of the sender&apos;s principal.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Does the use of &quot;doAs&quot; for internode requests require any particular hadoop-auth configuration that Solr needs to hardcode to allow this to work? (I see some mention of feature flags for &quot;doAs&quot;-impersonation in hadoop docs, but I&apos;m not sure what others might be necessary.)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The only configuration which necessary is to set is the proxyuser settings to allow solr to call doAs for anyone.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;What prevents lesser-permissioned users from adding &quot;doAs&quot; to their requests before sending to Solr?&lt;br/&gt;
 Lesser permissioned user cannot tackle this since solr user needs right only to do something in a name of a user which has lesser permissions only and that user will still be authorized with the authorization plugin.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17312625" author="gezan" created="Wed, 31 Mar 2021 18:59:02 +0000"  >&lt;p&gt;What I experienced as a drawback when the end user gets the response the doAs parameter which has been added during the process is visible in the final response too. That&apos;s not so fancy.&lt;/p&gt;</comment>
                            <comment id="17312686" author="gerlowskija" created="Wed, 31 Mar 2021 20:07:17 +0000"  >&lt;p&gt;Thanks for the details Geza.  I&apos;ll need to test out setting that configuration and do some tests to make sure impersonation isn&apos;t an issue, but hopefully we&apos;ll be able to vet and go this route.&lt;/p&gt;

&lt;p&gt;One hiccup I ran into - I applied both your fix and the latest test patch but the unit test still fails.  Perhaps the test is missing CIAHP config that&apos;s required for the doAs-based fix to work?  If you have a chance to try it out, let me know.&lt;/p&gt;</comment>
                            <comment id="17312707" author="mdrob" created="Wed, 31 Mar 2021 21:08:54 +0000"  >&lt;p&gt;I don&apos;t think we should be needing Hadoop&apos;s &lt;tt&gt;doAs&lt;/tt&gt; support here - I would feel much better if we leveraged the same logic that we currently have in KerberosFilter.substituteOriginalUserRequest - we already consider the forwarding user to have permissions to impersonate&lt;/p&gt;</comment>
                            <comment id="17312818" author="mdrob" created="Thu, 1 Apr 2021 02:59:36 +0000"  >&lt;p&gt;I was able to back port the failing test to 8x as well, so that&apos;s some progress!&lt;/p&gt;

&lt;p&gt;I&apos;m not entirely clear on how to set up the impersonation in a way that HadoopAuthFilter will pick it up. It already has support for reading some authentication data at &lt;a href=&quot;https://github.com/apache/lucene-solr/blob/branch_8x/solr/core/src/java/org/apache/solr/security/HadoopAuthFilter.java#L79&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/branch_8x/solr/core/src/java/org/apache/solr/security/HadoopAuthFilter.java#L79&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I wanted to do something that was similar to what we have in the KerberosPlugin/Filter, but it looks like HadoopAuthPlugin/Filter already have facilities for this using the UGI. I think that is what Geza&apos;s fix was trying to activate, I suspect that there will be additional configuration that we need to add to our security.json to make this path work. I&apos;ll start trying to pull in more properties tomorrow - it&apos;s been a long day for me and I&apos;m not making much progress anymore at this point.&lt;/p&gt;</comment>
                            <comment id="17313077" author="gerlowskija" created="Thu, 1 Apr 2021 10:52:10 +0000"  >&lt;blockquote&gt;&lt;p&gt;I suspect that there will be additional configuration that we need to add to our security.json to make this path work.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I ran into the same conclusion yesterday afternoon when I noticed that Geza&apos;s doAs fix doesn&apos;t pass the unit test ootb.  If there&apos;s required configuration here to allow &apos;doAs&apos; to work, then maybe that&apos;s something that CIAHP should hardcode, instead of relying on the user to provide a secure configuration.  Or at the least, if certain properties are required in security.json to enable impersonation and prevent privilege escalation to the service user, then we need to be really really clear about that in the ref-guide docs.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gezan&quot; class=&quot;user-hover&quot; rel=&quot;gezan&quot;&gt;gezan&lt;/a&gt; do you happen to have the security.json that you tested your patch with that we could look at?&lt;/p&gt;</comment>
                            <comment id="17313124" author="gezan" created="Thu, 1 Apr 2021 12:01:37 +0000"  >&lt;p&gt;I think this is the only thing I added to my security.json which is not in my repro project: (This allows solr to impersonate everyone)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-json&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;proxyUserConfigs&quot;&lt;/span&gt;:{
      &lt;span class=&quot;code-quote&quot;&gt;&quot;proxyuser.solr.groups&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;*&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;proxyuser.solr.hosts&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;*&quot;&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ll try to check my fix with your test, maybe this is the reason why it still fails.&lt;br/&gt;
By the way the idea of using doAs is coming from the admin UI. I saw it does something similar:&lt;/p&gt;

&lt;p&gt; &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13023311/13023311_admin-ui-doAs.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;</comment>
                            <comment id="17313168" author="mdrob" created="Thu, 1 Apr 2021 13:13:47 +0000"  >&lt;p&gt;We have a CVE reserved for this, Gaza please indicate how you would like to be credited (sometimes this includes corporate affiliation depending on the circumstances of the discovery). &lt;/p&gt;</comment>
                            <comment id="17313175" author="gezan" created="Thu, 1 Apr 2021 13:29:37 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mdrob&quot; class=&quot;user-hover&quot; rel=&quot;mdrob&quot;&gt;mdrob&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;My name is enough. Company is not important in this case.&lt;/p&gt;</comment>
                            <comment id="17313282" author="gezan" created="Thu, 1 Apr 2021 16:14:58 +0000"  >&lt;p&gt;I think I figured out. My patch tries to trigger the do as logic in &lt;b&gt;org.apache.hadoop.security.token.delegation.web.DelegationTokenAuthenticationFilter&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;But for this delegation tokens should be enabled&lt;/p&gt;

&lt;p&gt;I think because of this:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/solr/blob/main/solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin.java#L133&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/blob/main/solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin.java#L133&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;I uploaded the patch for the security json. With this the test ran successfully for me.&#160;&lt;/p&gt;</comment>
                            <comment id="17313409" author="mdrob" created="Thu, 1 Apr 2021 19:54:09 +0000"  >&lt;p&gt;Does this mean that without delegation tokens enabled that we would always be allowing users to escalate their read privs? Why would we support it without DTs in that case.&lt;/p&gt;</comment>
                            <comment id="17313423" author="mdrob" created="Thu, 1 Apr 2021 20:17:18 +0000"  >&lt;p&gt;This ends up being too strict. I tried to add in a positive test case with the impersonation/delegation and that failed with:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    &quot;message&quot; : &quot;User: solr@EXAMPLE.COM is not allowed to impersonate solr_alt@EXAMPLE.COM&quot;,
    &quot;exception&quot; : &quot;AuthorizationException&quot;,
    &quot;javaClassName&quot; : &quot;org.apache.hadoop.security.authorize.AuthorizationException&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt; &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13023336/13023336_SOLR-15233.2.patch&quot; title=&quot;SOLR-15233.2.patch attached to SOLR-15233&quot;&gt;SOLR-15233.2.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; contains the test case as well as the doAs fix and the security.json updates. It&apos;s one comprehensive patch that combines everything we&apos;ve seen so far.&lt;/p&gt;</comment>
                            <comment id="17313433" author="mdrob" created="Thu, 1 Apr 2021 20:27:11 +0000"  >&lt;p&gt;We need to configure superusers as in &lt;a href=&quot;https://hadoop.apache.org/docs/r3.2.2/hadoop-project-dist/hadoop-common/Superusers.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hadoop.apache.org/docs/r3.2.2/hadoop-project-dist/hadoop-common/Superusers.html&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="17313445" author="mdrob" created="Thu, 1 Apr 2021 20:53:22 +0000"  >&lt;p&gt;good news - I was able to configure the Hadoop superuser settings and have the test passing locally now.&lt;/p&gt;

&lt;p&gt;&lt;del&gt;bad news - I think this affects HadoopAuthPlugin in addition to CIAHP? I&apos;ll try to reproduce with that instead, which I assume will take me a while because everything else has been slow going on this as well.&lt;/del&gt; Nope, HadoopAuthPlugin is fine&lt;/p&gt;</comment>
                            <comment id="17313465" author="mdrob" created="Thu, 1 Apr 2021 22:46:37 +0000"  >&lt;p&gt;Patch still needs a CHANGES entry, but otherwise is ready for review I think.&lt;/p&gt;

&lt;p&gt;I think we should fix this for 8.x and then probably remove the CIAHP option in 9x. I&apos;m not sure that it is better than using our native KRB or even HadoopAuth+PKI.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gezan&quot; class=&quot;user-hover&quot; rel=&quot;gezan&quot;&gt;gezan&lt;/a&gt; - I can imagine you would be upset about this removal? Or maybe not? Probably this is a discussion we can have later after the immediate fixes have been committed.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gerlowskija&quot; class=&quot;user-hover&quot; rel=&quot;gerlowskija&quot;&gt;gerlowskija&lt;/a&gt; - please please please review. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17313824" author="gerlowskija" created="Fri, 2 Apr 2021 11:41:20 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mdrob&quot; class=&quot;user-hover&quot; rel=&quot;mdrob&quot;&gt;mdrob&lt;/a&gt;, patch looks good overall!  Getting really close here!  A few comments/questions:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;Krb5HttpClientUtils&lt;/tt&gt; is only really used as a test utility, so it prob needs moved to live in the &lt;tt&gt;test&lt;/tt&gt; tree and not in SolrJ proper.&lt;/li&gt;
	&lt;li&gt;Should we have ref-guide docs to accompany this change, so we can warn users of the importance of these delegation-token/proxyuser configs?&lt;/li&gt;
	&lt;li&gt;Question: What happens right now if a CIAHP user doesn&apos;t enable delegation tokens in their config or doesn&apos;t specify the proxyuser configuration? Is the user-escalation still possible?  If so, do we want to do anything in the code to warn/prevent users from making that mistake?  (e.g. should we hardcode those values?  log a warning?  Fail to init the plugin entirely until proxyUser values are provided?)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Other than that this looks good to me!  Will manual-test with the patch shortly to make sure it prevents the reproduction Geza provided.&lt;/p&gt;</comment>
                            <comment id="17313868" author="gerlowskija" created="Fri, 2 Apr 2021 13:16:12 +0000"  >&lt;p&gt;Mike pointed out to me offline that I just overlooked the ref-guide docs.  On a second glance, those look great, not sure how I missed them before.  Other than the test-utility needing moved then, this LGTM&lt;/p&gt;</comment>
                            <comment id="17313957" author="mdrob" created="Fri, 2 Apr 2021 16:31:47 +0000"  >&lt;p&gt; &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13023358/13023358_SOLR-15233.4.patch&quot; title=&quot;SOLR-15233.4.patch attached to SOLR-15233&quot;&gt;SOLR-15233.4.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;:&lt;/p&gt;

&lt;p&gt;Moved ClientUtils to src/test&lt;br/&gt;
Minor refactoring to reduce duplicated code&lt;br/&gt;
Several fixes to make recommit happy&lt;br/&gt;
Added CHANGES entry&lt;/p&gt;</comment>
                            <comment id="17313960" author="mdrob" created="Fri, 2 Apr 2021 16:35:54 +0000"  >&lt;p&gt;One additional concern might be that the superuser should only be allowed to impersonate on requests coming from hosts that are part of the cluster. But that can be covered in documentation.&lt;/p&gt;</comment>
                            <comment id="17313977" author="mdrob" created="Fri, 2 Apr 2021 17:10:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt; - what does this comment mean? cuts off mid-sentence! &lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/solr/blob/main/solr/core/src/test/org/apache/solr/security/hadoop/TestSolrCloudWithHadoopAuthPlugin.java#L72&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/blob/main/solr/core/src/test/org/apache/solr/security/hadoop/TestSolrCloudWithHadoopAuthPlugin.java#L72&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17314111" author="mdrob" created="Fri, 2 Apr 2021 23:29:51 +0000"  >&lt;p&gt;Thought of another test case to tighten this up, ran into &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15310&quot; title=&quot;HttpClientUtil interceptors are shared by multiple CoreContainer in same Test JVM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15310&quot;&gt;SOLR-15310&lt;/a&gt; while testing. We need to test this on a real cluster as well as within unit tests, I think. I&apos;ll have a better patch up Monday, hopefully somebody else can integrate that with the docker images.&lt;/p&gt;

&lt;p&gt;We weren&apos;t correctly forwarding for all the types of queries and it wasn&apos;t playing well with the shortName feature on the rule based authorization plugin because we were losing information on some of the forwarded requests. I reworked CIAHP to be more like KerberosPlugin on the interception, and refactored some of that logic, but am continuing to test. So far it looks promising.&lt;/p&gt;

&lt;p&gt;I found a potential NPE, so I&apos;ve taken care of that too.&lt;/p&gt;

&lt;p&gt;Big apologies that these are no longer incremental patches. I know that makes them harder to review, but it&apos;s already pretty tough on me trying to keep my 882 and 8x and 9x changes all in sync.&lt;/p&gt;</comment>
                            <comment id="17314829" author="gerlowskija" created="Mon, 5 Apr 2021 12:46:18 +0000"  >&lt;p&gt;Hey Mike, the latest patch looks good to me.  Only small nitpick is regarding the CHANGES.txt entry, which calls &quot;doAs&quot; a header instead of a query-param.  But that&apos;s a minor quibble&lt;/p&gt;

&lt;p&gt;Will test out in a docker cluster shortly and report back!&lt;/p&gt;</comment>
                            <comment id="17314859" author="gerlowskija" created="Mon, 5 Apr 2021 13:25:22 +0000"  >&lt;p&gt;Latest patch looked good in my docker testing.&lt;/p&gt;</comment>
                            <comment id="17316316" author="janhoy" created="Wed, 7 Apr 2021 12:56:35 +0000"  >&lt;p&gt;I cannot recall what the comment &quot;The metrics counter for wrong credentials here really just means...&quot; really tried to say. Somehow we must have anticipated wrong credentials at that point. Is this some challenge-reponse kind of pattern where you&apos;ll always first get a failure followed by the correct auth right after? Since both &apos;authenticated&apos; and &apos;failWrongCredentials&apos; have the same counts?&lt;/p&gt;</comment>
                            <comment id="17319693" author="mdrob" created="Mon, 12 Apr 2021 20:10:19 +0000"  >&lt;p&gt;Closing after the 8.8.2 release&lt;/p&gt;</comment>
                            <comment id="17320339" author="anshumg" created="Tue, 13 Apr 2021 17:16:00 +0000"  >&lt;p&gt;Late to the party, but this looks food. I&apos;d reviewed this last week but forgot to leave a note here.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13023260" name="0001-SOLR-15233-Add-negative-test-case-for-KRB-Authz.patch" size="6496" author="mdrob" created="Wed, 31 Mar 2021 16:43:11 +0000"/>
                            <attachment id="13023261" name="SOLR-15233-reproducing-unit-test.patch" size="12076" author="gerlowskija" created="Wed, 31 Mar 2021 18:42:08 +0000"/>
                            <attachment id="13023336" name="SOLR-15233.2.patch" size="15777" author="mdrob" created="Thu, 1 Apr 2021 20:16:39 +0000"/>
                            <attachment id="13023338" name="SOLR-15233.3.patch" size="21528" author="mdrob" created="Thu, 1 Apr 2021 22:40:08 +0000"/>
                            <attachment id="13023358" name="SOLR-15233.4.patch" size="23614" author="mdrob" created="Fri, 2 Apr 2021 16:29:53 +0000"/>
                            <attachment id="13023363" name="SOLR-15233.5.patch" size="33445" author="mdrob" created="Fri, 2 Apr 2021 23:30:49 +0000"/>
                            <attachment id="13023322" name="SOLR-15233_Enable_delegation_tokens.patch" size="954" author="gezan" created="Thu, 1 Apr 2021 16:15:13 +0000"/>
                            <attachment id="13021947" name="Screenshot 2021-03-09 at 18.15.31.png" size="342988" author="gezan" created="Tue, 9 Mar 2021 17:20:22 +0000"/>
                            <attachment id="13023311" name="admin-ui-doAs.png" size="20238" author="gezan" created="Thu, 1 Apr 2021 12:01:04 +0000"/>
                            <attachment id="13021946" name="security.json" size="1818" author="gezan" created="Tue, 9 Mar 2021 17:20:21 +0000"/>
                            <attachment id="13023214" name="solr-15233_Adding_doAs_to_requests_in_CIAHP.patch" size="4063" author="gezan" created="Wed, 31 Mar 2021 07:00:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 31 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ogs8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>