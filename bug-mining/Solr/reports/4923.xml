<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:51:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16160] UpdateXmlMessages duplicate data when data is removed and then added in the same message</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16160</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;&lt;b&gt;Replication Steps&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;1. Have two multi-value fields with the following schema&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;docTags&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;plongs&quot;&lt;/span&gt; multiValued=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;&amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tg0001&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;ipro_strings&quot;&lt;/span&gt; multiValued=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;

&amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;plong&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.LongPointField&quot;&lt;/span&gt; docValues=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;ipro_strings&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.TextField&quot;&lt;/span&gt; sortMissingLast=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; multiValued=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;
&amp;lt;analyzer&amp;gt;
&amp;lt;tokenizer class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.KeywordTokenizerFactory&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.LowerCaseFilterFactory&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;/analyzer&amp;gt;
&amp;lt;/fieldType&amp;gt; 

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;2. Execute the following UpdateXmlMessage&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;add&#160;commitWithin=&lt;span class=&quot;code-quote&quot;&gt;&quot;1000&quot;&lt;/span&gt;&amp;gt;
&amp;lt;doc&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;_id&quot;&lt;/span&gt;&amp;gt;1&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;docTags&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[1]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tg0001&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[Convert&#160;to&#160;Image]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;docTags&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[4]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tg0001&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[Large&#160;Files]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;docTags&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[6]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tg0001&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[To&#160;Bulk-Print]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;/doc&amp;gt;
&amp;lt;/add&amp;gt;
&amp;lt;add&#160;commitWithin=&lt;span class=&quot;code-quote&quot;&gt;&quot;1000&quot;&lt;/span&gt;&amp;gt;
&amp;lt;doc&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;_id&quot;&lt;/span&gt;&amp;gt;1&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;docTags&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[6]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tg0001&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[To&#160;Bulk-Print]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;docTags&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;add-distinct&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[1]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tg0001&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;add-distinct&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[Convert&#160;to&#160;Image]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;docTags&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;add-distinct&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[4]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tg0001&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;add-distinct&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[Large&#160;Files]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;/doc&amp;gt;
&amp;lt;/add&amp;gt;
&amp;lt;add&#160;commitWithin=&lt;span class=&quot;code-quote&quot;&gt;&quot;1000&quot;&lt;/span&gt;&amp;gt;
&amp;lt;doc&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;_id&quot;&lt;/span&gt;&amp;gt;1&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;docTags&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[1]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tg0001&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[Convert&#160;to&#160;Image]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;docTags&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[4]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tg0001&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;remove&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[Large&#160;Files]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;docTags&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;add-distinct&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[6]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;field&#160;name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tg0001&quot;&lt;/span&gt;&#160;update=&lt;span class=&quot;code-quote&quot;&gt;&quot;add-distinct&quot;&lt;/span&gt;&amp;gt;&amp;lt;![CDATA[To&#160;Bulk-Print]]&amp;gt;&amp;lt;/field&amp;gt;
&amp;lt;/doc&amp;gt;
&amp;lt;/add&amp;gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;3. Observe the following defect of duplicate values in those fields for that document&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13042698/13042698_image-2022-04-20-10-35-05-247.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Note:&lt;/b&gt;&#160;If you add the data first in the Xml message and the update=&quot;remove&quot; tags at the bottom, it works as expected and only adds once instance of the data from the above update=&quot;add-distinct&quot; message. The issue only occurs if the remove tags come before the add-distinct tags.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Is this because of some undocumented order the updates need to be in or is it a true defect that it is not working as expected?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13440745">SOLR-16160</key>
            <summary>UpdateXmlMessages duplicate data when data is removed and then added in the same message</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="krisden">Kevin Risden</assignee>
                                    <reporter username="nhadder">Nick Hadder</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Apr 2022 17:37:05 +0000</created>
                <updated>Fri, 17 Oct 2025 20:05:18 +0000</updated>
                            <resolved>Tue, 18 Oct 2022 00:10:08 +0000</resolved>
                                    <version>9.0</version>
                    <version>8.11.1</version>
                    <version>9.1</version>
                                    <fixVersion>9.2</fixVersion>
                    <fixVersion>10.0</fixVersion>
                                    <component>search</component>
                    <component>update</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4200">1h 10m</timespent>
                                <comments>
                            <comment id="17618003" author="alex.parvulescu" created="Sat, 15 Oct 2022 02:18:06 +0000"  >&lt;p&gt;I put together a PR for this bug &lt;a href=&quot;https://github.com/apache/solr/pull/1078&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/1078&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17619157" author="jira-bot" created="Tue, 18 Oct 2022 00:06:32 +0000"  >&lt;p&gt;Commit 095976e2a04da5613e3f9b099f34a2b54a09bd3a in solr&apos;s branch refs/heads/main from Alex&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=095976e2a04&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=095976e2a04&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16160&quot; title=&quot;UpdateXmlMessages duplicate data when data is removed and then added in the same message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16160&quot;&gt;&lt;del&gt;SOLR-16160&lt;/del&gt;&lt;/a&gt;: UpdateXmlMessages duplicate data when data is removed and then added in the same message (#1078)&lt;/p&gt;

&lt;p&gt;Co-authored-by: Kevin Risden &amp;lt;krisden@apache.org&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17619161" author="jira-bot" created="Tue, 18 Oct 2022 00:09:59 +0000"  >&lt;p&gt;Commit ff93fe6a2d8d7dafee22c67fa89d0dd3f02fd237 in solr&apos;s branch refs/heads/branch_9x from Alex&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=ff93fe6a2d8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=ff93fe6a2d8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16160&quot; title=&quot;UpdateXmlMessages duplicate data when data is removed and then added in the same message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16160&quot;&gt;&lt;del&gt;SOLR-16160&lt;/del&gt;&lt;/a&gt;: UpdateXmlMessages duplicate data when data is removed and then added in the same message (#1078)&lt;/p&gt;

&lt;p&gt;Co-authored-by: Kevin Risden &amp;lt;krisden@apache.org&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17619162" author="risdenk" created="Tue, 18 Oct 2022 00:10:08 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17705546" author="houston" created="Mon, 27 Mar 2023 18:04:18 +0000"  >&lt;p&gt;Closing after the 9.2.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13042699" name="image-2022-04-20-10-34-08-573.png" size="83108" author="nhadder" created="Wed, 20 Apr 2022 17:34:09 +0000"/>
                            <attachment id="13042698" name="image-2022-04-20-10-35-05-247.png" size="64224" author="nhadder" created="Wed, 20 Apr 2022 17:35:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 33 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z11n9s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>