<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:25:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2987] ExternalFileField With Invalid TrieField Key</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2987</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The current error handling in reading an external file field only catches an error when parsing the float value on a line, which then skips that line.  If the key field is a trie field, such as a TrieIntField, and the key value in the file cannot be parsed to an int, loading of the entire file fails.  &lt;/p&gt;

&lt;p&gt;Shouldn&apos;t the call to get the indexed value of the key should be in the same try/catch as the float parsing for the line?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12536345">SOLR-2987</key>
            <summary>ExternalFileField With Invalid TrieField Key</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="erickerickson">Erick Erickson</assignee>
                                    <reporter username="mgarski">Michael Garski</reporter>
                        <labels>
                    </labels>
                <created>Sat, 24 Dec 2011 13:12:13 +0000</created>
                <updated>Fri, 10 May 2013 10:40:27 +0000</updated>
                            <resolved>Tue, 10 Jan 2012 22:51:35 +0000</resolved>
                                    <version>3.5</version>
                    <version>3.6</version>
                    <version>4.0-ALPHA</version>
                                    <fixVersion>3.6</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13175730" author="mgarski" created="Sat, 24 Dec 2011 14:21:27 +0000"  >&lt;p&gt;Stack trace that occurs with a line in the file such as &apos;=34&apos; where the key value is missing:&lt;/p&gt;

&lt;p&gt;Dec 23, 2011 8:26:17 AM org.apache.solr.common.SolrException log&lt;br/&gt;
SEVERE: java.lang.NumberFormatException: For input string: &quot;&quot;&lt;br/&gt;
	at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)&lt;br/&gt;
	at java.lang.Integer.parseInt(Integer.java:493)&lt;br/&gt;
	at java.lang.Integer.parseInt(Integer.java:514)&lt;br/&gt;
	at org.apache.solr.schema.TrieField.readableToIndexed(TrieField.java:314)&lt;br/&gt;
	at org.apache.solr.search.function.FileFloatSource.getFloats(FileFloatSource.java:258)&lt;br/&gt;
	at org.apache.solr.search.function.FileFloatSource.access$000(FileFloatSource.java:59)&lt;br/&gt;
	at org.apache.solr.search.function.FileFloatSource$2.createValue(FileFloatSource.java:130)&lt;br/&gt;
	at org.apache.solr.search.function.FileFloatSource$Cache.get(FileFloatSource.java:161)&lt;br/&gt;
	at org.apache.solr.search.function.FileFloatSource.getCachedFloats(FileFloatSource.java:124)&lt;br/&gt;
	at org.apache.solr.search.function.FileFloatSource.getValues(FileFloatSource.java:83)&lt;br/&gt;
	at org.apache.lucene.queries.function.valuesource.MultiFloatFunction.getValues(MultiFloatFunction.java:65)&lt;br/&gt;
	at org.apache.lucene.queries.function.valuesource.MultiFloatFunction.getValues(MultiFloatFunction.java:65)&lt;br/&gt;
	at org.apache.solr.search.DoubleParser$Function.getValues(ValueSourceParser.java:1056)&lt;br/&gt;
	at org.apache.lucene.queries.function.valuesource.MultiFloatFunction.getValues(MultiFloatFunction.java:65)&lt;br/&gt;
	at org.apache.lucene.queries.function.valuesource.MultiFloatFunction.getValues(MultiFloatFunction.java:65)&lt;br/&gt;
	at org.apache.lucene.queries.function.valuesource.MultiFloatFunction.getValues(MultiFloatFunction.java:65)&lt;br/&gt;
	at org.apache.lucene.queries.function.FunctionQuery$AllScorer.&amp;lt;init&amp;gt;(FunctionQuery.java:119)&lt;br/&gt;
	at org.apache.lucene.queries.function.FunctionQuery$FunctionWeight.scorer(FunctionQuery.java:94)&lt;br/&gt;
	at org.apache.lucene.search.BooleanQuery$BooleanWeight.scorer(BooleanQuery.java:317)&lt;br/&gt;
	at org.apache.lucene.search.FilteredQuery$1.scorer(FilteredQuery.java:153)&lt;br/&gt;
	at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)&lt;br/&gt;
	at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:354)&lt;br/&gt;
	at org.apache.solr.search.Grouping.execute(Grouping.java:351)&lt;br/&gt;
	at org.apache.solr.handler.component.QueryComponent.process(QueryComponent.java:495)&lt;br/&gt;
	at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:194)&lt;br/&gt;
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)&lt;br/&gt;
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:1478)&lt;br/&gt;
	at org.apache.solr.core.QuerySenderListener.newSearcher(QuerySenderListener.java:59)&lt;br/&gt;
	at org.apache.solr.core.SolrCore$3.call(SolrCore.java:1255)&lt;br/&gt;
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)&lt;br/&gt;
	at java.util.concurrent.FutureTask.run(FutureTask.java:166)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:636)&lt;/p&gt;</comment>
                            <comment id="13176954" author="mgarski" created="Thu, 29 Dec 2011 02:29:18 +0000"  >&lt;p&gt;Patch that moves key lookup to within same try/catch as the value parsing. Corrected exception message to include the field name.&lt;/p&gt;</comment>
                            <comment id="13182977" author="erickerickson" created="Tue, 10 Jan 2012 01:14:29 +0000"  >&lt;p&gt;Nice catch!&lt;/p&gt;

&lt;p&gt;The only way I can generate this error is if the &lt;b&gt;keyfield&lt;/b&gt; is a numeric type. Otherwise, with string types, it works just fine because when the line like &quot;=76.0&quot; is parsed, no attempt is made to convert the incoming key to anything. And since there are no terms in the index that match the empty string, this just gets collected as an error and logged. So your patch looks fine.&lt;/p&gt;

&lt;p&gt;I don&apos;t see a good way to test this though, at least not in a positive sense. I can include bogus entries in TestFunctionQuery for a start. I can add a test for an &lt;b&gt;numeric&lt;/b&gt; type keyfield modeled on testExternalFileFieldStringKeys, call it testExternalFileFieldNumericKeys, leave off the key and see if it succeeds. But on a quick glance, I don&apos;t see a good way to verify that the errors are appropriately logged. Anyone want to weigh in on whether it&apos;s worth the effort?&lt;/p&gt;</comment>
                            <comment id="13183660" author="erickerickson" created="Tue, 10 Jan 2012 22:48:16 +0000"  >&lt;p&gt;Latest patch&lt;/p&gt;</comment>
                            <comment id="13183664" author="erickerickson" created="Tue, 10 Jan 2012 22:51:35 +0000"  >&lt;p&gt;Thanks Michael!&lt;/p&gt;

&lt;p&gt;trunk: r-1229783&lt;br/&gt;
3.x:   r-1229782&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12510116" name="SOLR-2987-3x.patch" size="2689" author="erickerickson" created="Tue, 10 Jan 2012 22:48:16 +0000"/>
                            <attachment id="12510115" name="SOLR-2987.patch" size="2644" author="erickerickson" created="Tue, 10 Jan 2012 22:48:16 +0000"/>
                            <attachment id="12508812" name="eff_key_error.patch" size="1031" author="mgarski" created="Thu, 29 Dec 2011 02:29:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>222028</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 46 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03hdj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18248</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>