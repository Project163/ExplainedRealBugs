<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:29:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11664] range facets with with sub aggregations on string fields give incorrect results</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11664</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Reported by Volodymyr Rudniev &lt;a href=&quot;http://markmail.org/message/3pueopseidgijqs3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/message/3pueopseidgijqs3&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13120083">SOLR-11664</key>
            <summary>range facets with with sub aggregations on string fields give incorrect results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="yseeley@gmail.com">Yonik Seeley</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Nov 2017 23:10:58 +0000</created>
                <updated>Sat, 8 Jun 2019 15:16:42 +0000</updated>
                            <resolved>Wed, 6 Dec 2017 01:19:16 +0000</resolved>
                                    <version>7.0</version>
                                    <fixVersion>7.2</fixVersion>
                                    <component>Facet Module</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16278661" author="yseeley@gmail.com" created="Tue, 5 Dec 2017 14:51:39 +0000"  >&lt;p&gt;Debugging UniqueSinglevaluedSlotAcc points to this being caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-7407&quot; title=&quot;Explore switching doc values to an iterator API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-7407&quot;&gt;&lt;del&gt;LUCENE-7407&lt;/del&gt;&lt;/a&gt;, which lines up with Volodymyr seeing this issue in 7.0 and later.&lt;/p&gt;</comment>
                            <comment id="16278819" author="yseeley@gmail.com" created="Tue, 5 Dec 2017 16:29:28 +0000"  >&lt;p&gt;Here&apos;s a draft patch that shows the approach I&apos;m taking to fix this.&lt;br/&gt;
Basically, add a resetIterators() method to SlotAcc, and hoist the logic to call both reset() and resetIterators() up into SlotAcc.setNextReader to try and avoid bugs in individual aggregations.&lt;/p&gt;

&lt;p&gt;I&apos;ll now work on tests + auditing &amp;amp; fixing up other SlotAcc implementations to call super.setNextReader()&lt;/p&gt;</comment>
                            <comment id="16279300" author="yseeley@gmail.com" created="Tue, 5 Dec 2017 22:34:36 +0000"  >&lt;p&gt;Here&apos;s a completed patch.&lt;br/&gt;
I backed out calling reset() from setReader() is it was too invasive (numSlots was needed everywhere if reset was always going to be called for initialization).&lt;/p&gt;</comment>
                            <comment id="16279491" author="jira-bot" created="Wed, 6 Dec 2017 01:15:29 +0000"  >&lt;p&gt;Commit e84cce8ea15d28aa1d261441bebdef48b8baf9a6 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e84cce8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e84cce8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11664&quot; title=&quot;range facets with with sub aggregations on string fields give incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11664&quot;&gt;&lt;del&gt;SOLR-11664&lt;/del&gt;&lt;/a&gt;: fix range facet issues with sub-aggregations on string fields, adds resetIterator to SlotAcc&lt;/p&gt;</comment>
                            <comment id="16279495" author="jira-bot" created="Wed, 6 Dec 2017 01:18:10 +0000"  >&lt;p&gt;Commit 3305c50775f7b2450422cdec0fae5b47cbe56340 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=3305c50&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=3305c50&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11664&quot; title=&quot;range facets with with sub aggregations on string fields give incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11664&quot;&gt;&lt;del&gt;SOLR-11664&lt;/del&gt;&lt;/a&gt;: fix range facet issues with sub-aggregations on string fields, adds resetIterator to SlotAcc&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12995282">LUCENE-7407</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12900757" name="SOLR-11664.patch" size="11532" author="yseeley@gmail.com" created="Tue, 5 Dec 2017 22:33:39 +0000"/>
                            <attachment id="12900701" name="SOLR-11664.patch" size="4431" author="yseeley@gmail.com" created="Tue, 5 Dec 2017 16:25:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 50 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3n2o7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>