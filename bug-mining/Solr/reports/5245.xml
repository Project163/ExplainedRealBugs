<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:11:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17574] ClusterState getHostAllowList isn&apos;t always updated when live nodes change</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17574</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;ClusterState.getHostAllowList was introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15217&quot; title=&quot;use shardsWhitelist in ReplicationHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15217&quot;&gt;&lt;del&gt;SOLR-15217&lt;/del&gt;&lt;/a&gt; to validate a host may be reached for distributed-search. &#160;But it&apos;s a cached value computed from the live nodes, and the live nodes may change. &#160;Thus it can happen that a new live node arrives, gets replicas, and suddenly, distributed-search fails with a 403 (&quot;Forbidden&quot;), with an error string containing this substring: &quot;is neither a live node of the cluster nor in the configured&quot;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13599946">SOLR-17574</key>
            <summary>ClusterState getHostAllowList isn&apos;t always updated when live nodes change</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dsmiley">David Smiley</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 25 Nov 2024 18:35:47 +0000</created>
                <updated>Thu, 30 Jan 2025 18:10:48 +0000</updated>
                            <resolved>Wed, 4 Dec 2024 11:02:39 +0000</resolved>
                                    <version>8.8.2</version>
                                    <fixVersion>9.8</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="17900992" author="dsmiley" created="Mon, 25 Nov 2024 18:46:33 +0000"  >&lt;p&gt;I think the &quot;hostAllowList&quot; ought to not be on ClusterState; it ought to be in AllowListUrlChecker and cached there based on the latest liveNodes seen from ClusterState. &#160;It&apos;s the only consumer. &#160;ClusterState is an important SolrCloud abstraction; we should be conservative in adding methods there. &#160;WDYT &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=broustant&quot; class=&quot;user-hover&quot; rel=&quot;broustant&quot;&gt;broustant&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="17901180" author="broustant" created="Tue, 26 Nov 2024 12:00:21 +0000"  >&lt;p&gt;I think I was misled at the PR time by the ClusterState javadoc that says &quot;Immutable state of the cloud&quot;, whereas there is this setLiveNodes() method.&lt;/p&gt;

&lt;p&gt;I agree, the host allow list would rather be computed and cached in AllowListUrlChecker. If we change the ClusterState.setLiveNodes() method to copy the parameter set in a new unmodifiable set, then AllowListUrlChecker can quickly check the ClusterState.getLiveNodes() object ref for change.&lt;/p&gt;</comment>
                            <comment id="17902582" author="dsmiley" created="Tue, 3 Dec 2024 10:50:24 +0000"  >&lt;p&gt;Even though this is a public method on ClusterState; I think we can simply remove it without back-compat. &#160;It&apos;s only there to serve AllowListUrlChecker.&lt;/p&gt;</comment>
                            <comment id="17902939" author="jira-bot" created="Wed, 4 Dec 2024 10:23:33 +0000"  >&lt;p&gt;Commit 83391964df5b01839329be44fb31a030864770c1 in solr&apos;s branch refs/heads/main from Bruno Roustant&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=83391964df5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=83391964df5&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17574&quot; title=&quot;ClusterState getHostAllowList isn&amp;#39;t always updated when live nodes change&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17574&quot;&gt;&lt;del&gt;SOLR-17574&lt;/del&gt;&lt;/a&gt;: Move host allow list cache to AllowListUrlChecker. (#2892)&lt;/p&gt;
</comment>
                            <comment id="17902953" author="jira-bot" created="Wed, 4 Dec 2024 11:00:41 +0000"  >&lt;p&gt;Commit 3b094fad639adc7e65404dfe7f9ecc58103345e4 in solr&apos;s branch refs/heads/branch_9x from Bruno Roustant&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=3b094fad639&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=3b094fad639&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17574&quot; title=&quot;ClusterState getHostAllowList isn&amp;#39;t always updated when live nodes change&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17574&quot;&gt;&lt;del&gt;SOLR-17574&lt;/del&gt;&lt;/a&gt;: Move host allow list cache to AllowListUrlChecker. (#2892)&lt;/p&gt;
</comment>
                            <comment id="17921957" author="anshumg" created="Tue, 28 Jan 2025 22:17:55 +0000"  >&lt;p&gt;Closing after the 9.8.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13362476">SOLR-15217</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1sraw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>