diff --git a/solr/core/src/test/org/apache/solr/update/processor/NestedAtomicUpdateTest.java b/solr/core/src/test/org/apache/solr/update/processor/NestedAtomicUpdateTest.java
index e016d2ccf46..155f0c791af 100644
--- a/solr/core/src/test/org/apache/solr/update/processor/NestedAtomicUpdateTest.java
+++ b/solr/core/src/test/org/apache/solr/update/processor/NestedAtomicUpdateTest.java
@@ -691,7 +691,7 @@ public class NestedAtomicUpdateTest extends SolrTestCaseJ4 {
         "=={\"doc\":{'id':\"1\", \"latlon\":\"0,0\"" +
             ", cat_ss:[\"aaa\",\"ccc\"], child1:[{\"id\":\"2\",\"cat_ss\":[\"child\"]}, {\"id\":\"3\",\"cat_ss\":[\"child\"]}]}}");
 
-    doc = sdoc("id", "1", "child1", Collections.singletonMap("set", null));
+    doc = sdoc("id", "1", "child1", Collections.singletonMap("set", empty ? new ArrayList<>() : null));
     addAndGetVersion(doc, params("wt", "json"));
 
     assertJQ(req("qt", "/get", "id", "1", "fl", "id, latlon, cat_ss, child1, [child]"),
