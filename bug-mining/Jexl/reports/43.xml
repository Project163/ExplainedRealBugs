<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:57:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JEXL-144] Empty array property setting fails</title>
                <link>https://issues.apache.org/jira/browse/JEXL-144</link>
                <project id="12310479" key="JEXL">Commons JEXL</project>
                    <description>&lt;p&gt;Suppose a bean has an array property setter method (e.g, public void setStrarr(String []) ).&lt;br/&gt;
If I use an expression like this with an empty array, then it fails with the error message, &quot;inaccessible or unknown property strarr&quot;.&lt;/p&gt;

&lt;p&gt;  // example expression&lt;br/&gt;
  bean.strarr = [ ];&lt;/p&gt;</description>
                <environment></environment>
        <key id="12677202">JEXL-144</key>
            <summary>Empty array property setting fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="woon_san">Woonsan Ko</reporter>
                        <labels>
                    </labels>
                <created>Sat, 2 Nov 2013 04:47:22 +0000</created>
                <updated>Mon, 21 Mar 2016 14:10:06 +0000</updated>
                            <resolved>Thu, 19 Mar 2015 15:15:36 +0000</resolved>
                                    <version>2.1.1</version>
                                    <fixVersion>3.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13811873" author="woon_san" created="Sat, 2 Nov 2013 04:53:51 +0000"  >&lt;p&gt;The error seems to happen because it tries to resolve the type of the first array item in order to find the best setter method.&lt;br/&gt;
However, if an empty array is provided, it cannot detect the component type of the array, and so it fails to find a proper method from the object array (Object[]) argument.&lt;/p&gt;</comment>
                            <comment id="13811875" author="woon_san" created="Sat, 2 Nov 2013 05:00:29 +0000"  >&lt;p&gt;Attaching patches:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;jexl2-empty-array-patch.txt for 2.0 branch&lt;/li&gt;
	&lt;li&gt;jexl3-empty-array-patch.txt for trunk&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;All the internal method cache objects (ClassMap, MethodMap, MethodKey, etc) do not have the argument information. So, they cannot detect if the property value argument is an empty array.&lt;br/&gt;
Therefore, the most proper location to improve is PropertySetExecutor.java, IMHO, where methods are looked up by the input argument and its type.&lt;/p&gt;

&lt;p&gt;Basically, PropertySetExecutor now finds an array setter method by the method name if no proper method was found yet.&lt;br/&gt;
And, it invokes the detected method with a newly created empty array object later by the detected array component type.&lt;/p&gt;

&lt;p&gt;Please review the patches.&lt;/p&gt;

&lt;p&gt;Thanks in advance,&lt;/p&gt;

&lt;p&gt;Woonsan&lt;/p&gt;</comment>
                            <comment id="13811927" author="sebb@apache.org" created="Sat, 2 Nov 2013 10:20:55 +0000"  >&lt;p&gt;What about overloaded methods? How does JEXL know which one to choose?&lt;/p&gt;</comment>
                            <comment id="13812269" author="woon_san" created="Sun, 3 Nov 2013 05:34:40 +0000"  >&lt;p&gt;Hi Sebb,&lt;/p&gt;

&lt;p&gt;That&apos;s a good point! My initial patch just chose the first found one, but I don&apos;t think it was quite right.&lt;/p&gt;

&lt;p&gt;So, I&apos;m uploading new patches (jexl2-empty-array-patch-2.txt for 2.0 branch and jexl3-empty-array-patch-2.txt for trunk), which now fails to find the setter method if there&apos;s an ambiguity due to the overloaded setter methods.&lt;br/&gt;
JEXL can now report the following exception message in that case:&lt;br/&gt;
&quot;&apos;quux.arr2 = [  ];&apos; unknown, ambiguous or inaccessible property arr2&quot;&lt;/p&gt;

&lt;p&gt;In summary, JEXL can now set an empty array if there&apos;s only one setter method with the property name and array type parameter, but it fails and reports the ambiguity if there are any other overloaded methods.&lt;br/&gt;
I think this should be fine.&lt;/p&gt;

&lt;p&gt;Please review those.&lt;/p&gt;

&lt;p&gt;Cheers,&lt;/p&gt;

&lt;p&gt;Woonsan&lt;/p&gt;</comment>
                            <comment id="13813066" author="henrib" created="Mon, 4 Nov 2013 18:08:06 +0000"  >&lt;p&gt;Hi;&lt;br/&gt;
Nice addition!&lt;/p&gt;

&lt;p&gt;Just to nitpick, it seems the boolean property isEmptyArrayValue could be &quot;removed&quot; since the emptyArrayComponentType is not null only when the other one is true (emptyArrayComponentType != null &amp;lt;=&amp;gt; isEmprtyArrayValue == true). I&apos;m also wondering if there could be another way (from the JEXL3/Uberspect may be) to avoid adding this emptyComponentType in the setter when the property is actually not an array...&lt;/p&gt;

&lt;p&gt;Btw, I&apos;ve got many uncommitted JEXL3 modifications (no-one seemed interested in JEXL2+ and the release cycle/process was too long/costly for my sole/own usage); just let me know if JEXL3 is something you could consider using.&lt;br/&gt;
Cheers&lt;/p&gt;</comment>
                            <comment id="13813428" author="woon_san" created="Mon, 4 Nov 2013 23:49:36 +0000"  >&lt;p&gt;Hi Henri,&lt;/p&gt;

&lt;p&gt;Thanks a lot for the review and remark!&lt;br/&gt;
I&apos;m attaching a revised patch for 2.0 branch (jexl2-empty-array-patch-3.txt) and another for trunk (jexl3-empty-array-patch-3.txt) which don&apos;t have &apos;isEmptyArrayValue&apos; member any more.&lt;/p&gt;

&lt;p&gt;Regarding &quot;another way (from the JEXL3/Uberspect)&quot;, yes, that looks a lot better to add this kind of code in Uberspect.java maybe instead of PropertySetExecutor even though I don&apos;t fully understand the design changes in JEXL3 yet. I&apos;ll try to understand JEXL3 Uberspect and try a patch in that way soon. (So, you can disregard the patch for trunk now.)&lt;/p&gt;

&lt;p&gt;By the way, I&apos;m going to use JEXL2 in our document processing engine module (which is based on SCXML 2.0) in the short term. So, we&apos;re definitely interested in having this feature in JEXL2, not JEXL3 in the short term.&lt;br/&gt;
In the longer term, I&apos;ll probably want to upgrade it to JEXL3 because it might be more flexible/customizable and stable.&lt;/p&gt;

&lt;p&gt;Best,&lt;/p&gt;

&lt;p&gt;Woonsan&lt;/p&gt;</comment>
                            <comment id="13814409" author="woon_san" created="Tue, 5 Nov 2013 23:42:47 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=henrib&quot; class=&quot;user-hover&quot; rel=&quot;henrib&quot;&gt;henrib&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Your idea (adding determination code into Uberspect instead of PropertySetExecutor) seems better.&lt;br/&gt;
So, I&apos;d like to ask your opinion on my improvement idea.&lt;br/&gt;
In JEXL3, I think I can do the following:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Improve Uberspect#getPropertySet() to return a separate executor type instance when the argument is an empty array.&lt;br/&gt;
  So, I think we can add EmptyArrayPropertySetExecutor by extending PropertySetExecutor. Its #discover() is used to get an executor instance in that case. We don&apos;t have to keep the member in Executor classes any more.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;How does it sound to you?&lt;/p&gt;

&lt;p&gt;Also, in the same approach, I think we can improve Introspector#getSetExecutor() for JEXL2.&lt;/p&gt;

&lt;p&gt;If it sounds okay to you, I will post new patches. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Cheers,&lt;/p&gt;

&lt;p&gt;Woonsan&lt;/p&gt;</comment>
                            <comment id="13814433" author="sebb@apache.org" created="Wed, 6 Nov 2013 00:16:00 +0000"  >&lt;p&gt;Please can we keep discussions of Jexl3 etc. to the developer list? They are off-topic for this JIRA.&lt;/p&gt;</comment>
                            <comment id="13815610" author="woon_san" created="Thu, 7 Nov 2013 03:38:03 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I&apos;m attaching new patches (jexl2-empty-array-patch-4.txt for 2.0 branch and jexl3-empty-array-patch-4.txt for trunk).&lt;/p&gt;

&lt;p&gt;These improve PropertySetExecutor class not to introduce a new member variable any more. Instead, it resolves the array component type when executing the setter method. This doesn&apos;t make any difference in performance now because the array component type resolution is done only once anyway.&lt;/p&gt;

&lt;p&gt;I also considered improving Uberspect instead as mentioned before, but that approach has to introduce a new EmptyArrayPropertySetExecutor, which doesn&apos;t seem to be really simple and nice to me.&lt;/p&gt;

&lt;p&gt;Therefore, I decided to improve the PropertySetExecutor only, not to have a new property there.&lt;/p&gt;

&lt;p&gt;Could you please review the new patches?&lt;/p&gt;

&lt;p&gt;Cheers,&lt;/p&gt;

&lt;p&gt;Woonsan&lt;/p&gt;</comment>
                            <comment id="13831663" author="henrib" created="Mon, 25 Nov 2013 17:47:51 +0000"  >&lt;p&gt;Committed the fix in jexl3 (plus a few other things).&lt;/p&gt;</comment>
                            <comment id="14369500" author="henrib" created="Thu, 19 Mar 2015 15:15:36 +0000"  >&lt;p&gt;Fixed in 3.0 a while ago&lt;/p&gt;</comment>
                            <comment id="15204236" author="henrib" created="Mon, 21 Mar 2016 14:10:06 +0000"  >&lt;p&gt;Update issues resolved in 3.0 to closed &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12611809" name="jexl2-empty-array-patch-2.txt" size="9260" author="woon_san" created="Sun, 3 Nov 2013 05:34:40 +0000"/>
                            <attachment id="12612062" name="jexl2-empty-array-patch-3.txt" size="9173" author="woon_san" created="Mon, 4 Nov 2013 23:49:36 +0000"/>
                            <attachment id="12612523" name="jexl2-empty-array-patch-4.txt" size="8295" author="woon_san" created="Thu, 7 Nov 2013 03:38:03 +0000"/>
                            <attachment id="12611743" name="jexl2-empty-array-patch.txt" size="7125" author="woon_san" created="Sat, 2 Nov 2013 05:00:29 +0000"/>
                            <attachment id="12611810" name="jexl3-empty-array-patch-2.txt" size="10425" author="woon_san" created="Sun, 3 Nov 2013 05:34:40 +0000"/>
                            <attachment id="12612063" name="jexl3-empty-array-patch-3.txt" size="10338" author="woon_san" created="Mon, 4 Nov 2013 23:49:36 +0000"/>
                            <attachment id="12612524" name="jexl3-empty-array-patch-4.txt" size="8785" author="woon_san" created="Thu, 7 Nov 2013 03:38:03 +0000"/>
                            <attachment id="12611744" name="jexl3-empty-array-patch.txt" size="7895" author="woon_san" created="Sat, 2 Nov 2013 05:00:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>356577</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 34 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1pgzb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>356865</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>