<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:58:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JEXL-302] JexlScript.getVariables returns strange values for array access</title>
                <link>https://issues.apache.org/jira/browse/JEXL-302</link>
                <project id="12310479" key="JEXL">Commons JEXL</project>
                    <description>&lt;p&gt;I can not understand the logic behind the current implementation of &lt;tt&gt;JexlScript.getVariables()&lt;/tt&gt; method. From the documentation we know that the result should be the set of script variables. For the code&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
a[b][c]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it gives three variables &lt;tt&gt;a&lt;/tt&gt;, &lt;tt&gt;b&lt;/tt&gt;, &lt;tt&gt;c&lt;/tt&gt;. So far so good. But for the code&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
a[b][&lt;span class=&quot;code-quote&quot;&gt;&apos;c&apos;&lt;/span&gt;]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it returns &lt;tt&gt;a&lt;/tt&gt; and &lt;tt&gt;b c&lt;/tt&gt;, where second variable has two fragments &lt;tt&gt;b&lt;/tt&gt; and &lt;tt&gt;c&lt;/tt&gt;. The documentation states that variables with multiple fragments are ant-ish variables, but I don&apos;t have any of ant-ish variables in the example, and &lt;tt&gt;&apos;c&apos;&lt;/tt&gt; is not a variable, but a constant. I expect to get &lt;tt&gt;a&lt;/tt&gt; and &lt;tt&gt;b&lt;/tt&gt; as a result.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13233923">JEXL-302</key>
            <summary>JexlScript.getVariables returns strange values for array access</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="henrib">Henri Biestro</assignee>
                                    <reporter username="dmitri_blinov">Dmitri Blinov</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 May 2019 08:55:01 +0000</created>
                <updated>Mon, 7 Jun 2021 13:14:48 +0000</updated>
                            <resolved>Sat, 8 Jun 2019 13:21:13 +0000</resolved>
                                    <version>3.1</version>
                                    <fixVersion>3.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16845983" author="henrib" created="Wed, 22 May 2019 15:27:01 +0000"  >&lt;p&gt;I suspect your (failing) example is: why does &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;b&amp;#39;&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;c&amp;#93;&lt;/span&gt;&lt;/tt&gt; generate &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;a&amp;quot;,&#8221;b&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt;&#160;and &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;c&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt;&#160;as the variable set of lists ?&lt;/p&gt;

&lt;p&gt;This probably stems from the current behaviour where &lt;tt&gt;a.b&lt;/tt&gt; is equivalent to &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;b&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt; or &lt;tt&gt;a.0&lt;/tt&gt; is equivalent to &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;/tt&gt;. There are plenty of tests in VarTests.testRef(...) that indicate the intent for getVariable to collect that equivalence.&lt;br/&gt;
It is guaranteed that the 1st member of each segment (list) is the name of a variable; one can consider the whole segment as the actual varying element ( as in a.b value changes with a and a.b ).&lt;br/&gt;
Does this make more sense?&lt;/p&gt;</comment>
                            <comment id="16854569" author="dmitri_blinov" created="Mon, 3 Jun 2019 13:02:48 +0000"  >&lt;p&gt;I have got your point, but for the sake of argument, as of now - &lt;tt&gt;a.b&lt;/tt&gt; is not equivalent to &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;b&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt;. First because of ant-ish variables. One can only address anti-sh variable as &lt;tt&gt;a.b&lt;/tt&gt;, not as &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;b&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt;. Strictly speaking&#160;&lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;b&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt; is not equivalent to &lt;tt&gt;a.b&lt;/tt&gt;, because we can have &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;b+c&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt;, but we can not have &lt;tt&gt;a.(b+c)&lt;/tt&gt;. And second - because we can have &lt;tt&gt;propertyGet()/propertySet()&lt;/tt&gt; and &lt;tt&gt;arrayGet()/arraySet()&lt;/tt&gt; to be overloaded separately, so that they can perform different operations.&lt;/p&gt;

&lt;p&gt;I also understand that what the &lt;tt&gt;a.b&lt;/tt&gt; is resolved into (whether this a variable &lt;tt&gt;a.b&lt;/tt&gt; or only &lt;tt&gt;a&lt;/tt&gt; is a variable, and &lt;tt&gt;b&lt;/tt&gt; is property name) is decided during runtime, so this can not be defined from syntax representation tree alone - a tough task for &lt;tt&gt;JexlScript.getVariables()&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Still, the example of issue&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
a[b][&lt;span class=&quot;code-quote&quot;&gt;&apos;c&apos;&lt;/span&gt;]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;does not follow the pattern of &lt;tt&gt;a.b&lt;/tt&gt; == &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;b&amp;quot;&amp;#93;&lt;/span&gt;&lt;/tt&gt;. From what I get from the &lt;tt&gt;JexlScript.getVariables(),&lt;/tt&gt; the code &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;b&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;c&amp;#39;&amp;#93;&lt;/span&gt;&lt;/tt&gt; is equivalent to &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;b.c&amp;#93;&lt;/span&gt;&lt;/tt&gt;, which in fact should be equivalent to &lt;tt&gt;a[b&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;c&amp;quot;&amp;#93;&lt;/span&gt;]&lt;/tt&gt;. Something is wrong here...&lt;/p&gt;</comment>
                            <comment id="16856126" author="henrib" created="Tue, 4 Jun 2019 21:13:23 +0000"  >&lt;p&gt;I&apos;m sorry, I must have been unclear; let me try again.&lt;/p&gt;

&lt;p&gt;The intended purpose of getVariable is to retrieve the list of variables susceptible to change the outcome of a script/expression evaluation. The output is a set of list of strings. Each list is at least a (top level) variable followed by properties; if one of this list is {&lt;tt&gt;&quot;a&quot;, &quot;b&quot;&lt;/tt&gt;}, it means if there is a solvable variable &lt;tt&gt;&apos;a&apos;&lt;/tt&gt; - and more precisely a solvable property &lt;tt&gt;&quot;b&quot;&lt;/tt&gt; of  a variable &lt;tt&gt;&quot;a&quot;&lt;/tt&gt;, varying its value is susceptible to change the outcome of the script evaluation. If one list is {&lt;tt&gt;&quot;a&quot;, &quot;b&quot;, &quot;c&quot;&lt;/tt&gt;}, it means the solvable property &lt;tt&gt;&quot;c&quot;&lt;/tt&gt; of the solvable property &lt;tt&gt;&quot;b&quot;&lt;/tt&gt; of the solvable variable &lt;tt&gt;&quot;a&quot;&lt;/tt&gt; may have an effect etc. You get the idea.&lt;br/&gt;
It also means in that latest form case, that &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;b&amp;#39;&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;c&amp;#39;&amp;#93;&lt;/span&gt;&lt;/tt&gt; may behave the same way and thus generates the same list..&lt;br/&gt;
A side effect is that the method also picks up the (evil) antish-variables but I suspect (and hope) anyone using those in their environment knows them and should have no difficulty reconciling the output of getVariables and the potential antish vars.&lt;/p&gt;

&lt;p&gt;As for you example, &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;b&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;c&amp;#39;&amp;#93;&lt;/span&gt;&lt;/tt&gt; is not equivalent to &lt;tt&gt;a&lt;span class=&quot;error&quot;&gt;&amp;#91;b.c&amp;#93;&lt;/span&gt;&lt;/tt&gt; ; the latter is equivalent to &lt;tt&gt;a[b&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;c&amp;#39;&amp;#93;&lt;/span&gt;]&lt;/tt&gt;. I&apos;ve added 2 more examples in VarTest.testRefs ( &lt;a href=&quot;https://github.com/apache/commons-jexl/commit/66d5f6e69992a6473c94bff2cf17889a428ab622&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-jexl/commit/66d5f6e69992a6473c94bff2cf17889a428ab622&lt;/a&gt; ).&lt;/p&gt;

&lt;p&gt;All that being said, I think the feature still works as intended (per &lt;a href=&quot;https://issues.apache.org/jira/browse/JEXL-113&quot; title=&quot;Add functions to extract which variables, parameters and local variables are used to evaluate a script&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JEXL-113&quot;&gt;&lt;del&gt;JEXL-113&lt;/del&gt;&lt;/a&gt;). But I hear you, things have changed wrt to property/array resolution so we may want to add an option to that feature to only consider dotted identifiers - not their array counterparts. That&apos;s fairly easy (Engine.java, lline 588, add a condition), we just need to specify how to pass it down. I prototried with a boolean argument to getVariable, that works but changes lots of code, adding overloads; may be the Engine could be configured through an option since it is probably related to resolver strategies.&lt;/p&gt;

&lt;p&gt;Share your thoughts.&lt;/p&gt;</comment>
                            <comment id="16857849" author="dmitri_blinov" created="Thu, 6 Jun 2019 16:29:24 +0000"  >&lt;p&gt;I think the idea of having an option at the Engine level is more preferrable than a parameter of the &lt;tt&gt;getVariables()&lt;/tt&gt;. I can not imagine a situation where one needs to analyze variables both ways at once, so we can have the engine to be in compatible mode by default, and allow to trigger it on during engine creation in case one sees its more appropriate.&lt;/p&gt;</comment>
                            <comment id="16857942" author="dmitri_blinov" created="Thu, 6 Jun 2019 17:48:22 +0000"  >&lt;p&gt;Just as I thought, there is a bug in current implementation. Consider the following test case in &lt;tt&gt;VarTest.testRefs&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; e = JEXL.createScript(&lt;span class=&quot;code-quote&quot;&gt;&quot;a[b].c&quot;&lt;/span&gt;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; vars = e.getVariables();
&#160;&#160;&#160;&#160;&#160;&#160;&#160; expect = mkref(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[][]{{&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;}, {&lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;}});
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertTrue(eq(expect, vars));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16859218" author="henrib" created="Sat, 8 Jun 2019 13:21:13 +0000"  >&lt;p&gt;Changeset: a3c210cfc5eabd1bbb1d6ae4b009fe831e2f1d9b&lt;br/&gt;
Author:    Henri Biestro &amp;lt;hbiestro@gmail.com&amp;gt;&lt;br/&gt;
Date:      2019-06-08 15:20&lt;br/&gt;
Message:   &lt;a href=&quot;https://issues.apache.org/jira/browse/JEXL-302&quot; title=&quot;JexlScript.getVariables returns strange values for array access&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JEXL-302&quot;&gt;&lt;del&gt;JEXL-302&lt;/del&gt;&lt;/a&gt;: added jexl builder flag to control variable collecting behavior (collectAll); fixed wrong collecting behavior on array references&lt;/p&gt;</comment>
                            <comment id="17030755" author="dmitri_blinov" created="Wed, 5 Feb 2020 15:54:09 +0000"  >&lt;p&gt;Maybe I&apos;m kicking a dead horse here, but can you please explain the logic behind &lt;tt&gt;x.y[&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;z&amp;#39;, &amp;#39;t&amp;#39;&amp;#93;&lt;/span&gt;]&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testLiteral() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        JexlScript e = JEXL.createScript(&lt;span class=&quot;code-quote&quot;&gt;&quot;x.y[[&lt;span class=&quot;code-quote&quot;&gt;&apos;z&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;t&apos;&lt;/span&gt;]]&quot;&lt;/span&gt;);
        Set&amp;lt;List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt; vars = e.getVariables();
        Assert.assertEquals(1, vars.size());
        Assert.assertTrue(eq(mkref(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[][]{{&lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;y&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;[ &lt;span class=&quot;code-quote&quot;&gt;&apos;z&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;t&apos;&lt;/span&gt; ]&quot;&lt;/span&gt;}}), vars));
    } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Why do we expect the last &quot;[ &apos;z&apos;, &apos;t&apos; ]&quot; part? How is it differ from, for instance, &lt;tt&gt;x.y&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;z&amp;#39; + &amp;#39;t&amp;#39;&amp;#93;&lt;/span&gt;&lt;/tt&gt; in a sense that both &lt;tt&gt;&apos;z&apos; + &apos;t&apos;&lt;/tt&gt; and &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;z&amp;#39;, &amp;#39;t&amp;#39;&amp;#93;&lt;/span&gt;&lt;/tt&gt; are just expressions?&lt;/p&gt;</comment>
                            <comment id="17034586" author="henrib" created="Tue, 11 Feb 2020 16:32:41 +0000"  >&lt;p&gt;That subject is moot if you use a JexBuilder(). collectAll(false) as in:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        JexlEngine jexld = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JexlBuilder().collectAll(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;).create();
        e = jexld.createScript(&lt;span class=&quot;code-quote&quot;&gt;&quot;x.y[{&lt;span class=&quot;code-quote&quot;&gt;&apos;z&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;t&apos;&lt;/span&gt;}]&quot;&lt;/span&gt;);
        vars = e.getVariables();
        Assert.assertEquals(1, vars.size());
        Assert.assertTrue(eq(mkref(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[][]{{&lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;y&quot;&lt;/span&gt;}}), vars));}
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In the collectAll(true) case, the logic is in the actual intent of getVariables ; statically capture the elements that will potentially influence the script execution flow, ie all variables. Since one can configure JEXL so that a.b is equivalent to a&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;b&amp;#39;&amp;#93;&lt;/span&gt;, it stands to reason that a a[&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;b&amp;#39;, &amp;#39;c&#8217;&amp;#93;&lt;/span&gt;] can be interpreted as &lt;span class=&quot;error&quot;&gt;&amp;#91;a.b, a.c&amp;#93;&lt;/span&gt;. , thus the a, &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;&amp;#93;&lt;/span&gt; resulting of getVariables.&#160;The same logic can be applied to constant sets and maps.&lt;/p&gt;

&lt;p&gt;For instance:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        script = JEXL.createScript(&lt;span class=&quot;code-quote&quot;&gt;&quot;moon.landing[[&lt;span class=&quot;code-quote&quot;&gt;&apos;yyyy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;MM&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;dd&apos;&lt;/span&gt;]]&quot;&lt;/span&gt;);
        result = (List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;) script.execute(ctxt);
        Assert.assertEquals(Arrays.asList(&lt;span class=&quot;code-quote&quot;&gt;&quot;1969&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;7&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;20&quot;&lt;/span&gt;), result);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In this example, the script&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 moon.landing[[&lt;span class=&quot;code-quote&quot;&gt;&apos;yyyy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;MM&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;dd&apos;&lt;/span&gt;]]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;is equivalent to&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 [ moon.landing.yyyy, moon.landing.MM, moon.landing.dd ]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With a bit of added parsing, it becomes possible to determine those from getVariables.&lt;br/&gt;
 I&apos;m adding a test case to illustrate, &lt;a href=&quot;https://github.com/apache/commons-jexl/commit/09db242b8cffbf63ad4a59d4e62f3ac358d4be24&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JEXL-302: added a test for JexBuilder.captureAll() and JexlScript.get&#8230;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17035185" author="dmitri_blinov" created="Wed, 12 Feb 2020 09:20:21 +0000"  >&lt;p&gt;Thanks for the clarification, it was the transion from &lt;tt&gt;a[&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;&amp;#93;&lt;/span&gt;]&lt;/tt&gt; to &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;a.b, a.c&amp;#93;&lt;/span&gt;&lt;/tt&gt; that I wasn&apos;t able to figure out. This is not obvious because getting list of properties via array access is not supported anywhere in the basic implementation. Not sure whether it&apos;s worth adding such a feature though. But one thing that I think is strange here is that &lt;tt&gt;getVariables()&lt;/tt&gt;&#160; in fact &lt;b&gt;relies&lt;/b&gt; on the hypotesis that one should implement array access to support sets and arrays in such a way.&lt;/p&gt;</comment>
                            <comment id="17037331" author="henrib" created="Fri, 14 Feb 2020 22:13:11 +0000"  >&lt;p&gt;Changeset: 8dee2ad6abe88213625dc126cf811d43925c6317&lt;br/&gt;
Author:    henrib &amp;lt;henrib@apache.org&amp;gt;&lt;br/&gt;
Date:      2020-02-14 23:12&lt;br/&gt;
Message:   &lt;a href=&quot;https://issues.apache.org/jira/browse/JEXL-302&quot; title=&quot;JexlScript.getVariables returns strange values for array access&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JEXL-302&quot;&gt;&lt;del&gt;JEXL-302&lt;/del&gt;&lt;/a&gt;: added a capture mode to further refine how getVariable should behave wrt constants in array references&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02shk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>