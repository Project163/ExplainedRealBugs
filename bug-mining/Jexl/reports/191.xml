<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:59:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JEXL-375] Cannot access enums by their name when using sandbox</title>
                <link>https://issues.apache.org/jira/browse/JEXL-375</link>
                <project id="12310479" key="JEXL">Commons JEXL</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;when using sandbox, accessing enum value via the dot notation fails with an exception `JexlException$Property: JexlTest.addressTypeTest:186 undefined property &apos;DOMICILE&apos;`.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The only workaround I have found was to use the `valueOf` method on the enum.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I tried tracking down the cause. I believe the issue lies in `SandboxUberspect.getPropertyGet` on line&lt;/p&gt;

&lt;p&gt;`final String actual = sandbox.read(obj.getClass(), property)`&lt;/p&gt;

&lt;p&gt;where obj is the class of the enum, and thus the permission gets read for `Class&amp;lt;Object&amp;gt;` (result of `obj.getClass()`) instead of the enum.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Contrast this to the code in `Uberspect.getPropertyGet` , where it tries to also resolve against `obj`, not only its superclass.&lt;/p&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;executor = FieldGetExecutor.discover(is, claz, property);&lt;br/&gt;
// static class fields (enums included)&lt;br/&gt;
if (obj instanceof Class&amp;lt;?&amp;gt;)&lt;/p&gt;

{ &#160; &#160;executor = FieldGetExecutor.discover(is, (Class&amp;lt;?&amp;gt;) obj, property); }

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Here is unit test demonstrating this issue.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Test
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void addressTypeTest() {
    JexlSandbox jexlSandbox = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JexlSandbox(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
    jexlSandbox.allow(Type.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;getName());

    JexlEngine engine = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JexlBuilder()
            .sandbox(jexlSandbox)
            .create();

    &lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; context = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt;();
    context.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;Type&quot;&lt;/span&gt;, Type.class);

    Type typeValueOf = (Type) engine.createScript(
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Type.valueOf(&lt;span class=&quot;code-quote&quot;&gt;&apos;DOMICILE&apos;&lt;/span&gt;);\n&quot;&lt;/span&gt;
    ).execute(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MapContext(context));
    assertEquals(Type.DOMICILE, typeValueOf);

    Type typeDirect = (Type) engine.createScript(
            &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Type.DOMICILE;\n&quot;&lt;/span&gt;
    ).execute(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MapContext(context));
    assertEquals(Type.DOMICILE, typeDirect);
}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; Type {
    DELIVERY_ADDRESS,
    DOMICILE
}
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13471333">JEXL-375</key>
            <summary>Cannot access enums by their name when using sandbox</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="henrib">Henri Biestro</assignee>
                                    <reporter username="klickajan">Jan Kli&#269;ka</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Jul 2022 06:52:11 +0000</created>
                <updated>Mon, 27 Mar 2023 10:59:04 +0000</updated>
                            <resolved>Sun, 24 Jul 2022 14:26:22 +0000</resolved>
                                    <version>3.2.1</version>
                                    <fixVersion>3.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                            <timeestimate seconds="7200">2h</timeestimate>
                                        <comments>
                            <comment id="17570482" author="henrib" created="Sun, 24 Jul 2022 14:26:22 +0000"  >&lt;p&gt;Thanks for the report.&lt;br/&gt;
Commit &lt;a href=&quot;https://github.com/apache/commons-jexl/commit/bec28b3353fa5e158d72bf9c40c5020308e6ae40&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;bec28b33&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17572287" author="JIRAUSER292727" created="Thu, 28 Jul 2022 07:51:47 +0000"  >&lt;p&gt;Thank you for the fix. Do you know when we can expect release of version 3.3 on maven?&lt;/p&gt;</comment>
                            <comment id="17572332" author="henrib" created="Thu, 28 Jul 2022 08:55:31 +0000"  >&lt;p&gt;I might try to release in second half of August...&lt;/p&gt;</comment>
                            <comment id="17572357" author="JIRAUSER292727" created="Thu, 28 Jul 2022 09:44:23 +0000"  >&lt;p&gt;Ok, thank you.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z16tjk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>