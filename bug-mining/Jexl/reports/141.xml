<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:58:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JEXL-306] Ternary operator ? protects also its branches from resolution errors</title>
                <link>https://issues.apache.org/jira/browse/JEXL-306</link>
                <project id="12310479" key="JEXL">Commons JEXL</project>
                    <description>&lt;p&gt;Consider the following test case (suppose its added to IfTest)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&#160;&#160; @Test
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testTernaryFail() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
&#160;&#160;&#160;&#160;&#160;&#160;&#160; JexlEvalContext jc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JexlEvalContext();
&#160;&#160;&#160;&#160;&#160;&#160;&#160; JexlExpression e = JEXL.createExpression(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; ? bar : quux&quot;&lt;/span&gt;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; o;

&#160;&#160;&#160;&#160;&#160;&#160;&#160; jc.setStrict(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; jc.setSilent(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; o = e.evaluate(jc);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;Should have failed&quot;&lt;/span&gt;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception ex) {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-comment&quot;&gt;// OK
&lt;/span&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }
&#160;&#160;&#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The expected behavior is to fail with &lt;tt&gt;undefined variable...&lt;/tt&gt; because neither &lt;tt&gt;bar&lt;/tt&gt; nor &lt;tt&gt;quux&lt;/tt&gt; is defined &lt;/p&gt;</description>
                <environment></environment>
        <key id="13238146">JEXL-306</key>
            <summary>Ternary operator ? protects also its branches from resolution errors</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="henrib">Henri Biestro</assignee>
                                    <reporter username="dmitri_blinov">Dmitri Blinov</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Jun 2019 09:01:23 +0000</created>
                <updated>Mon, 7 Jun 2021 13:14:51 +0000</updated>
                            <resolved>Tue, 11 Jun 2019 12:50:48 +0000</resolved>
                                    <version>3.1</version>
                                    <fixVersion>3.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16859219" author="henrib" created="Sat, 8 Jun 2019 13:21:19 +0000"  >&lt;p&gt;Changeset: 041fcaf0b32e1316c578f971039e1632a01f8f79&lt;br/&gt;
Author:    Henri Biestro &amp;lt;hbiestro@gmail.com&amp;gt;&lt;br/&gt;
Date:      2019-06-08 15:18&lt;br/&gt;
Message:   &lt;a href=&quot;https://issues.apache.org/jira/browse/JEXL-306&quot; title=&quot;Ternary operator ? protects also its branches from resolution errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JEXL-306&quot;&gt;&lt;del&gt;JEXL-306&lt;/del&gt;&lt;/a&gt;: ensure ternary expressions only protect the condition part against variable resolution failure&lt;/p&gt;</comment>
                            <comment id="16859816" author="dmitri_blinov" created="Mon, 10 Jun 2019 08:23:52 +0000"  >&lt;p&gt;The following script throws an exception &quot;Undefined property y&quot;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; x = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&quot;&lt;/span&gt;); x.y ? 1 : 2&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I&apos;m confused, is it a supposed behaviour? Shouldn&apos;t it return &lt;tt&gt;2&lt;/tt&gt; just like in&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
x ? 1 : 2&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;?&lt;/p&gt;</comment>
                            <comment id="16859823" author="henrib" created="Mon, 10 Jun 2019 08:35:44 +0000"  >&lt;p&gt;Not a regression but the&#160;behaviour&#160;between &apos;??&apos;, &apos;?:&apos; wrt&#160;&apos;?.&apos; and the &apos;safe&apos; mode seems inconsistent. The question is twofold:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;should all ternaries behave the same (aka ?: and ??) wrt to unsolvable variables and properties?&lt;/li&gt;
	&lt;li&gt;should the ternaries also protect from unsolvable properties - or only from unsolvable variables - in non-safe mode?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16860053" author="dmitri_blinov" created="Mon, 10 Jun 2019 15:02:04 +0000"  >&lt;p&gt;Regarding second part of the question, consider the following example &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;x.y ? 1 : 2&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It returns 2 because x.y is undefined ant-ish variable. Another example that returns 2 is &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; x = {&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;:1}; x.y ? 1 : 2&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;My opinion is that we would expect predicted equal behaviour from syntactically equal constructs. So yes - ternaries should protect from unsolvable properties.&lt;/p&gt;</comment>
                            <comment id="16860093" author="dmitri_blinov" created="Mon, 10 Jun 2019 15:40:57 +0000"  >&lt;p&gt;Regarding the first part of the question. &lt;/p&gt;

&lt;p&gt;Lets start with &lt;tt&gt;x?.y&lt;/tt&gt;. My understanding is that this operator is simply an inline for &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (x == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; x.y&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt&gt;else&lt;/tt&gt; part of the &lt;tt&gt;if&lt;/tt&gt; is an ordinary unprotected property access operator that should behave just as simple &lt;tt&gt;x.y&lt;/tt&gt;. So we can keep &lt;tt&gt;?.&lt;/tt&gt; aside and focus on &lt;tt&gt;??&lt;/tt&gt; and &lt;tt&gt;?:&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;&apos;l try to summarize what we have now for ternaries. The operator &lt;tt&gt;&amp;#63;?&lt;/tt&gt; is the most simple case because its only checks its left side for &lt;tt&gt;null&lt;/tt&gt; or undefined. The elvis operator &lt;tt&gt;?:&lt;/tt&gt; is like &lt;tt&gt;??&lt;/tt&gt; but checks its left side not only for &lt;tt&gt;null&lt;/tt&gt; or undefined, but also for the left side to be logically &lt;tt&gt;false&lt;/tt&gt;. Conventional ternary operator &lt;tt&gt;?:&lt;/tt&gt; is like &lt;tt&gt;?:&lt;/tt&gt; elvis operator regarding its left-side operand, but allows to specify a value not only for &lt;tt&gt;false&lt;/tt&gt; but also for &lt;tt&gt;true&lt;/tt&gt;. So, I think all ternaries differ only in their result part, and should be equal in their treatment of the left part&lt;/p&gt;</comment>
                            <comment id="16860139" author="henrib" created="Mon, 10 Jun 2019 16:36:28 +0000"  >&lt;p&gt;Intermediate commit&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/commons-jexl/commit/a69782bea469a766f71f12f76e9d5154b7415be4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-jexl/commit/a69782bea469a766f71f12f76e9d5154b7415be4&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16860331" author="henrib" created="Mon, 10 Jun 2019 21:09:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/commons-jexl/commit/c6fa248e6c51c36a61be9d7bc6b6b15d4013875e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-jexl/commit/c6fa248e6c51c36a61be9d7bc6b6b15d4013875e&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16861007" author="henrib" created="Tue, 11 Jun 2019 12:48:25 +0000"  >&lt;p&gt;Code may be simpler&lt;/p&gt;</comment>
                            <comment id="16861010" author="henrib" created="Tue, 11 Jun 2019 12:50:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/commons-jexl/commit/a10776a6afd3a9f2c07069cf56183a78e0a4ed76&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-jexl/commit/a10776a6afd3a9f2c07069cf56183a78e0a4ed76&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z03ih4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>