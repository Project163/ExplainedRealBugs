<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:57:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JEXL-87] Inconsistent behaviour of arithmetical operations</title>
                <link>https://issues.apache.org/jira/browse/JEXL-87</link>
                <project id="12310479" key="JEXL">Commons JEXL</project>
                    <description>&lt;p&gt;BigInteger(7) / BigInteger(2) == 3&lt;br/&gt;
whereas&lt;br/&gt;
BigDecimal(7) / BigDecimal(2) == 4, because the result is rounded up.&lt;/p&gt;

&lt;p&gt;I would expect the results to be the same.&lt;/p&gt;

&lt;p&gt;Rather worse is:&lt;/p&gt;

&lt;p&gt;BigDecimal(7) % BigDecimal(2) == -1&lt;/p&gt;

&lt;p&gt;which makes no sense at all.&lt;/p&gt;

&lt;p&gt;Seems to me that the arithmetic &quot;rules&quot; need revisiting and rationalising - for example why should Integer be treated as double?&lt;/p&gt;

&lt;p&gt;At present literal numbers are treated as Integer or Float; there&apos;s no option to generate Long or Double literals.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12433558">JEXL-87</key>
            <summary>Inconsistent behaviour of arithmetical operations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="henrib">Henri Biestro</assignee>
                                    <reporter username="sebb">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Aug 2009 10:46:00 +0000</created>
                <updated>Tue, 9 Mar 2010 15:15:50 +0000</updated>
                            <resolved>Wed, 2 Sep 2009 14:19:28 +0000</resolved>
                                                    <fixVersion>2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12746469" author="henrib" created="Sat, 22 Aug 2009 15:26:30 +0000"  >&lt;p&gt;About literals, it could be convenient &amp;amp; easy to add syntactic notations for the different literal types :&lt;br/&gt;
123L for (Long) 123&lt;br/&gt;
12.3d for Double&lt;br/&gt;
12.3D for BigDecimal (capital &apos;D&apos;))&lt;br/&gt;
123I for BigInteger (capital &apos;I&apos;)&lt;/p&gt;

&lt;p&gt;On the arithmetic itself, it might be easier on the user-end to follow more common rules about types by avoiding automatic conversion &amp;amp; add coercion operators (or functions in the global namespace) - applying the &quot;lesser surprise principle&quot;. &lt;/p&gt;

&lt;p&gt;The &quot;more common rules&quot; would be composition rules based on a usual datatype ordering:&lt;br/&gt;
String &amp;gt; BigDecimal &amp;gt; Double &amp;gt; BigInteger &amp;gt; Long &amp;gt; Character &amp;gt; Int &amp;gt; Short  &amp;gt; Byte&lt;/p&gt;

&lt;p&gt;And all operations would do:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;x o y -&amp;gt; Compose(type(x), type(y)).o(x,y)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With compose being:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Compose(&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;, BigInteger) -&amp;gt; BigDecimal
Composte(t1, t2) -&amp;gt; Datatype.Max(t1, t2) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And each datatype implement its own code for each operation.&lt;/p&gt;

&lt;p&gt;Since arithmetic operations could then overflow, we&apos;d introduce explicit coercions to let users circumvent these cases.&lt;/p&gt;

&lt;p&gt;I however suspect such a scheme would be further away from the JSF/JSP EL spec.&lt;br/&gt;
WDYT ?&lt;/p&gt;
</comment>
                            <comment id="12750449" author="henrib" created="Wed, 2 Sep 2009 14:19:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/JEXL-87&quot; title=&quot;Inconsistent behaviour of arithmetical operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JEXL-87&quot;&gt;&lt;del&gt;JEXL-87&lt;/del&gt;&lt;/a&gt;: &lt;br/&gt;
Fix in Parser.jjt, &quot;x + y / a + b&quot; was throwing a ParseException &lt;br/&gt;
Fixed JexlArithmetic; use the same algo wrt datatype for all operations, fixed modulo for BigDecimal and made integer results to scale down to &apos;int&apos; (was only to long) when possible &lt;br/&gt;
Fixed tests to check for &apos;int(eger)&apos; instead of &apos;long&apos; when needed. &lt;/p&gt;

&lt;p&gt;Modified: &lt;br/&gt;
    commons/proper/jexl/branches/2.0/src/main/java/org/apache/commons/jexl/JexlArithmetic.java &lt;br/&gt;
    commons/proper/jexl/branches/2.0/src/main/java/org/apache/commons/jexl/parser/Parser.jjt &lt;br/&gt;
    commons/proper/jexl/branches/2.0/src/test/java/org/apache/commons/jexl/ArithmeticTest.java &lt;br/&gt;
    commons/proper/jexl/branches/2.0/src/test/java/org/apache/commons/jexl/ForEachTest.java &lt;br/&gt;
    commons/proper/jexl/branches/2.0/src/test/java/org/apache/commons/jexl/IssuesTest.java &lt;br/&gt;
    commons/proper/jexl/branches/2.0/src/test/java/org/apache/commons/jexl/JexlTest.java &lt;br/&gt;
    commons/proper/jexl/branches/2.0/src/test/java/org/apache/commons/jexl/ScriptTest.java &lt;br/&gt;
    commons/proper/jexl/branches/2.0/src/test/java/org/apache/commons/jexl/WhileTest.java &lt;/p&gt;</comment>
                            <comment id="12843122" author="henrib" created="Tue, 9 Mar 2010 15:15:50 +0000"  >&lt;p&gt;Bulk closing issues resolved in JEXL 2.0.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46646</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0xqxj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>195000</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>