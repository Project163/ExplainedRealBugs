<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:57:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JEXL-162] empty() function throws an exception : unsupported type</title>
                <link>https://issues.apache.org/jira/browse/JEXL-162</link>
                <project id="12310479" key="JEXL">Commons JEXL</project>
                    <description>&lt;p&gt;empty() : unsupported type : class com.sun.org.apache.xerces.internal.dom.ElementImpl.&lt;/p&gt;

&lt;p&gt;Exepected behaviour - just return false if neither:&lt;/p&gt;

&lt;p&gt;    Object is null&lt;br/&gt;
    Object is an empty string&lt;br/&gt;
    Object is an array of length zero&lt;br/&gt;
    Object is a collection of size zero&lt;br/&gt;
    Object is an empty map&lt;br/&gt;
.....&lt;/p&gt;</description>
                <environment></environment>
        <key id="12844266">JEXL-162</key>
            <summary>empty() function throws an exception : unsupported type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="henrib">Henri Biestro</assignee>
                                    <reporter username="dmitri_blinov">Dmitri Blinov</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Jul 2015 19:31:07 +0000</created>
                <updated>Mon, 21 Mar 2016 14:10:13 +0000</updated>
                            <resolved>Sat, 11 Jul 2015 20:52:52 +0000</resolved>
                                    <version>3.0</version>
                                    <fixVersion>3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14623341" author="henrib" created="Sat, 11 Jul 2015 10:31:58 +0000"  >&lt;p&gt;The documented behavior is not what you expect.&lt;br/&gt;
It actually states : Returns &lt;b&gt;true&lt;/b&gt; if the expression following is either...&lt;br/&gt;
The rationale is that &apos;emptiness&apos; must have a meaning for the object considered, a callable method implementation.&lt;br/&gt;
I agree though that a &lt;em&gt;lenient&lt;/em&gt; arithmetic should return &apos;false&apos; (and &apos;size&apos; should return 0) rather than generate an error.&lt;/p&gt;

&lt;p&gt;You can implement your behavior by subclassing JexlArithmetic and overload the &apos;empty&apos; method as in the following where an &apos;empty&apos; node is a node without attributes nor children.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;XmlArithmetic &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; JexlArithmetic {
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; XmlArithmetic(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; lenient) {
            &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(lenient);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; empty(org.w3c.dom.Element elt) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; !elt.hasAttributes() &amp;amp;&amp;amp; !elt.hasChildNodes();
        }
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void test162() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        JexlEngine jexl = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JexlBuilder().arithmetic(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlArithmetic(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)).create();
        JexlScript s0 = jexl.createScript(&lt;span class=&quot;code-quote&quot;&gt;&quot;empty(x)&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;x&quot;&lt;/span&gt;);
        Document xml;
        Node x;
        &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; r;
        xml = getDocument(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;node info=&lt;span class=&quot;code-quote&quot;&gt;&apos;123&apos;&lt;/span&gt;/&amp;gt;&quot;&lt;/span&gt;);
        x = xml.getLastChild();
        r = (&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;) s0.execute(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, x);
        Assert.assertFalse(r);
        xml = getDocument(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;node&amp;gt;some content&amp;lt;/node&amp;gt;&quot;&lt;/span&gt;);
        x = xml.getLastChild();
        r = (&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;) s0.execute(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, x);
        Assert.assertFalse(r);
        xml = getDocument(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;node/&amp;gt;&quot;&lt;/span&gt;);
        x = xml.getLastChild();
        r = (&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;) s0.execute(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, x);
        Assert.assertTrue(r);
    }
        
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Document getDocument(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; xml) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, SAXException, ParserConfigurationException {
        DocumentBuilder xmlBuilder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
        InputStream stringInputStream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayInputStream(xml.getBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;));
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; xmlBuilder.parse(stringInputStream);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14623401" author="dmitri_blinov" created="Sat, 11 Jul 2015 13:49:03 +0000"  >&lt;p&gt;You are right that JEXL documentation does not clearly state that empty() operator will ever return &lt;b&gt;false&lt;/b&gt;, but from experience with EL, in which spec clearly defines &quot;otherwise return false&quot;, and from behaviour of JEXL 2.1, I was kind of expecting this behaviour. I understand your point about &apos;emptiness&apos; which must have special meaning for objects like maps and collections etc, but in EL and JEXL we are get used to little nifty things like type coercions, so for me personally it&apos;s not obvious why in that case we must be so strict.&lt;/p&gt;

&lt;p&gt;And you are right, I&apos;m getting this exception in lenient mode, which I hope will be fixed.&lt;/p&gt;

&lt;p&gt;And thanks for suggesting how to implement empty() for XML nodes, I&apos;ll definitly play with it.&lt;/p&gt;</comment>
                            <comment id="14623572" author="henrib" created="Sat, 11 Jul 2015 20:52:52 +0000"  >&lt;p&gt;Point taken; the empty/size operators are back to being lenient.&lt;br/&gt;
Overloads may throw exceptions that will be handled specifically. &lt;/p&gt;

&lt;p&gt;Added specific exception/method for operator error handling, updated behavior to be as lenient as 2.x, added test, clarified doc and updated changes.&lt;/p&gt;

&lt;p&gt;src/main/java/org/apache/commons/jexl3/JexlException.java&lt;br/&gt;
src/main/java/org/apache/commons/jexl3/internal/Interpreter.java&lt;br/&gt;
src/main/java/org/apache/commons/jexl3/parser/Parser.jjt&lt;br/&gt;
src/site/xdoc/changes.xml&lt;br/&gt;
src/site/xdoc/reference/syntax.xml&lt;br/&gt;
src/test/java/org/apache/commons/jexl3/ArithmeticTest.java&lt;/p&gt;

&lt;p&gt;Committed revision 1690404.&lt;/p&gt;</comment>
                            <comment id="15204264" author="henrib" created="Mon, 21 Mar 2016 14:10:13 +0000"  >&lt;p&gt;Update issues resolved in 3.0 to closed &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 34 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2h4bj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>