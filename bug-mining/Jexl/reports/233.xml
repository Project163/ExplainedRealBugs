<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:59:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JEXL-420] Error while comparing float and string value</title>
                <link>https://issues.apache.org/jira/browse/JEXL-420</link>
                <project id="12310479" key="JEXL">Commons JEXL</project>
                    <description>&lt;p&gt;code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
1.2 == &apos;&apos;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;returns false&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
1.2 == &lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;causes exception&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.ArithmeticException: &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt; coercion: (a)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Is it possible to check the right side is a number like string and return false if not?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13567509">JEXL-420</key>
            <summary>Error while comparing float and string value</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="henrib">Henri Biestro</assignee>
                                    <reporter username="xupengcheng">Xu Pengcheng</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Feb 2024 03:24:39 +0000</created>
                <updated>Fri, 9 Feb 2024 09:09:12 +0000</updated>
                            <resolved>Fri, 9 Feb 2024 09:04:28 +0000</resolved>
                                    <version>3.3</version>
                                    <fixVersion>3.4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17815391" author="henrib" created="Wed, 7 Feb 2024 18:03:42 +0000"  >&lt;p&gt;It is always possible to use an arithmetic (ie a JexlArithmetic derived class) of your choosing.&lt;br/&gt;
In your case, you might want to override the method:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; toDouble(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; val)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;so it returns NaN when encountering a String.&lt;br/&gt;
Alternatively, you could override:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; compare(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; left, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; right, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; JexlOperator &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;) {
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.compare(left, right, &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;);
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(ArithmeticException xa) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (EQ.equals(&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;)) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.MAX_VALUE;
        }
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; xa;
    }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to return a comparison value leading to false for the operator when catching an ArithmeticException.&lt;/p&gt;

&lt;p&gt;As for the general case, I&apos;d rather not weaken the type system; the empty string is already an (historic) convenient exception.&lt;/p&gt;</comment>
                            <comment id="17815516" author="JIRAUSER294041" created="Thu, 8 Feb 2024 05:30:36 +0000"  >&lt;p&gt;I agree that not weaken the type system, but in Java, usually the &apos;equals&apos; method should handle type diff and return false instead of throwing exception.&lt;/p&gt;

&lt;p&gt;For java object in JEXL, &apos;==&apos; Equality uses the java equals method, for numeric values, I think it is good to try parsing non-numeric object for comparison, but personally I think returns false for parsing failure is more consistently, and if so, the historic convenient exception for empty string is no need any more.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="17815639" author="henrib" created="Thu, 8 Feb 2024 11:23:01 +0000"  >&lt;p&gt;You are right; it makes more sense to follow the Java convention. The type system is already lenient so it might as well be convenient and coherent.&#160;&lt;/p&gt;</comment>
                            <comment id="17815979" author="henrib" created="Fri, 9 Feb 2024 09:04:28 +0000"  >&lt;ul&gt;
	&lt;li&gt;Added specific CoercionException (subclass of ArithmeticException) to be ignored during comparisons to allow fall through.&lt;/li&gt;
	&lt;li&gt;Throw &#160;CoercionException from parse{Number*} methods.&lt;/li&gt;
	&lt;li&gt;Added consistency in treating NaN and &apos;&apos; in all cases&lt;/li&gt;
	&lt;li&gt;Avoid going through parse(value.toString()) since type system is (seems) stable enough&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Commit &lt;a href=&quot;https://github.com/apache/commons-jexl/commit/f5bf27caaf7c577ed039232e5db81bcb835bc228&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;f5bf27ca&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1n8eo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>