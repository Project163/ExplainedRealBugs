<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:57:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JEXL-98] Quote escaping cannot be escaped</title>
                <link>https://issues.apache.org/jira/browse/JEXL-98</link>
                <project id="12310479" key="JEXL">Commons JEXL</project>
                    <description>&lt;p&gt;I want to invoke a &quot;replace&quot; method which (pretty much like String.replace()) takes three String parameters:&lt;/p&gt;

&lt;p&gt;function.replace(String text, String oldPart, String newPart)&lt;/p&gt;

&lt;p&gt;If I invoke it to replace single backslash characters with double backslash characters (which is admittedly a VERY special use case), I invoke it in my unit test with an expression like this one:&lt;/p&gt;

&lt;p&gt;  function.replace(&apos;DOMAIN\somename&apos;, &apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos;, &apos;\\\\&apos;)&lt;/p&gt;

&lt;p&gt;The result with JEXL 1.x was a string &quot;DOMAIN&lt;br class=&quot;atl-forced-newline&quot; /&gt;somename&quot;. But with JEXL 2, I get this error:&lt;/p&gt;

&lt;p&gt;2010-03-11 14:50:59,681 &lt;span class=&quot;error&quot;&gt;&amp;#91;CC:&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;RC:&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;CN:&amp;#93;&lt;/span&gt; - &lt;span class=&quot;error&quot;&gt;&amp;#91;SYSTEM&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;INVALID_EXPR&amp;#93;&lt;/span&gt; Invalid expression in configuration. Expression: &apos;function.replace(&apos;DOMAIN\myname&apos;, &apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos;, &apos;\\\\&apos;) / Exception: org.apache.commons.jexl2.JexlException: com.usp.sls.toolkit.expression.impl.Jexl2Provider.getScript@441tokenization failed&apos;&lt;br/&gt;
org.apache.commons.jexl2.JexlException: com.usp.sls.toolkit.expression.impl.Jexl2Provider.getScript@441tokenization failed&lt;br/&gt;
	at org.apache.commons.jexl2.JexlEngine.parse(JexlEngine.java:816)&lt;br/&gt;
	at org.apache.commons.jexl2.JexlEngine.createScript(JexlEngine.java:414)&lt;br/&gt;
	at org.apache.commons.jexl2.JexlEngine.createScript(JexlEngine.java:397)&lt;br/&gt;
	at com.usp.sls.toolkit.expression.impl.Jexl2Provider.getScript(Jexl2Provider.java:441)&lt;br/&gt;
	at com.usp.sls.toolkit.expression.impl.Jexl2Provider.evaluateExpression(Jexl2Provider.java:152)&lt;br/&gt;
	at com.usp.sls.toolkit.expression.Expression.evaluateExpression(Expression.java:201)&lt;br/&gt;
	at com.usp.sls.toolkit.expression.JexlTest.testReplace(JexlTest.java:84)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at junit.framework.TestCase.runTest(TestCase.java:164)&lt;br/&gt;
	at junit.framework.TestCase.runBare(TestCase.java:130)&lt;br/&gt;
	at junit.framework.TestResult$1.protect(TestResult.java:110)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:128)&lt;br/&gt;
	at junit.framework.TestResult.run(TestResult.java:113)&lt;br/&gt;
	at junit.framework.TestCase.run(TestCase.java:120)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:228)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:223)&lt;br/&gt;
	at org.junit.internal.runners.OldTestClassRunner.run(OldTestClassRunner.java:35)&lt;br/&gt;
	at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:46)&lt;br/&gt;
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)&lt;br/&gt;
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)&lt;br/&gt;
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)&lt;br/&gt;
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)&lt;br/&gt;
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)&lt;br/&gt;
Caused by: org.apache.commons.jexl2.parser.TokenMgrError: Lexical error at line 1, column 42.  Encountered: &quot;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&quot; (92), after : &quot;&quot;&lt;br/&gt;
	at org.apache.commons.jexl2.parser.ParserTokenManager.getNextToken(ParserTokenManager.java:1564)&lt;br/&gt;
	at org.apache.commons.jexl2.parser.Parser.jj_scan_token(Parser.java:3914)&lt;br/&gt;
	at org.apache.commons.jexl2.parser.Parser.jj_3R_118(Parser.java:2776)&lt;br/&gt;
	at org.apache.commons.jexl2.parser.Parser.jj_3R_111(Parser.java:2759)&lt;/p&gt;

&lt;p&gt;Obviously, the JEXL parser thinks that the backslash in the first string is meant to escape the following quote, which it isn&apos;t. The String should actually end there. So, I tried to escape the escape character, like this:&lt;/p&gt;

&lt;p&gt;  function.replace(&apos;DOMAIN\somename&apos;, &apos;\\\\&apos;, &apos;\\\\\\\\&apos;)&lt;/p&gt;

&lt;p&gt;But to no avail, same error.&lt;/p&gt;

&lt;p&gt;So, can escape characters be escaped in JEXL 2?&lt;/p&gt;</description>
                <environment>&lt;p&gt;All Java&lt;/p&gt;</environment>
        <key id="12458813">JEXL-98</key>
            <summary>Quote escaping cannot be escaped</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="henrib">Henri Biestro</assignee>
                                    <reporter username="marcelschoen">Marcel Schoen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Mar 2010 14:03:16 +0000</created>
                <updated>Wed, 7 Apr 2010 14:40:53 +0000</updated>
                            <resolved>Thu, 11 Mar 2010 21:33:53 +0000</resolved>
                                    <version>2.0</version>
                                    <fixVersion>2.0.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12844136" author="henrib" created="Thu, 11 Mar 2010 16:59:56 +0000"  >&lt;p&gt;There is definitely a problem in the grammar wrt escaping.&lt;br/&gt;
A workaround is to use Unicode escaping for the backslashes like the following code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;fn98 {
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; replace(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; str, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; target, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; replacement) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; str.replace(target, replacement);
        }
    }
    
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void test98() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; expr = &lt;span class=&quot;code-quote&quot;&gt;&quot;fn:replace(&lt;span class=&quot;code-quote&quot;&gt;&apos;DOMAIN\\somename&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;\\u005c&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;\\u005c\\u005c&apos;&lt;/span&gt;)&quot;&lt;/span&gt;;
        JexlEngine jexl = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JexlEngine();
        Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; funcs = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt;();
        funcs.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;fn&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; fn98());
        jexl.setFunctions(funcs);
        &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; value = jexl.createExpression(expr).evaluate(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        assertEquals(expr, &lt;span class=&quot;code-quote&quot;&gt;&quot;DOMAIN\\\\somename&quot;&lt;/span&gt;, value);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12844243" author="henrib" created="Thu, 11 Mar 2010 21:33:53 +0000"  >&lt;p&gt;922023	Thu Mar 11 22:13:34 CET 2010	henrib&lt;br/&gt;
Parser.jjt modified to allow proper escaping (backslash);&lt;br/&gt;
Added test for &lt;a href=&quot;https://issues.apache.org/jira/browse/JEXL-98&quot; title=&quot;Quote escaping cannot be escaped&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JEXL-98&quot;&gt;&lt;del&gt;JEXL-98&lt;/del&gt;&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/JEXL-97&quot; title=&quot;JEXL parses long expressions with lots of parenthesis slowly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JEXL-97&quot;&gt;&lt;del&gt;JEXL-97&lt;/del&gt;&lt;/a&gt;;&lt;br/&gt;
Added a formatting space in JexlException&lt;br/&gt;
Issue #&lt;a href=&quot;https://issues.apache.org/jira/browse/JEXL-98&quot; title=&quot;Quote escaping cannot be escaped&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JEXL-98&quot;&gt;&lt;del&gt;JEXL-98&lt;/del&gt;&lt;/a&gt; - Quote escaping cannot be escaped&lt;/p&gt;

&lt;p&gt;trunk/src/test/java/org/apache/commons/jexl2/IssuesTest.java &lt;br/&gt;
trunk/src/main/java/org/apache/commons/jexl2/parser/Parser.jjt &lt;br/&gt;
trunk/src/main/java/org/apache/commons/jexl2/JexlException.java&lt;br/&gt;
Committed revision 922023.&lt;/p&gt;</comment>
                            <comment id="12854522" author="henrib" created="Wed, 7 Apr 2010 14:40:53 +0000"  >&lt;p&gt;Fix delivered through 2.0.1 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46609</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 33 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0xref:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>195076</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>