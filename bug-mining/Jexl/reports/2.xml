<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:57:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JEXL-26] ASTArrayAccess messes up on fallback to JexlContext</title>
                <link>https://issues.apache.org/jira/browse/JEXL-26</link>
                <project id="12310479" key="JEXL">Commons JEXL</project>
                    <description>&lt;p&gt;When executing an expression if a null comes up (unresolved object) it attempts to build an identifier to query the JexlContext directly. However it only works on sequential ASTIdentifier nodes. If there is another sort of node then it ends up searching the JexlContext for a mangled or malformed variable.&lt;/p&gt;

&lt;p&gt;I think this is a bug because subobjects with properties or methods that are null can &quot;inherit&quot; the value of objects or properties in the base JexlContext scope. It&apos;s too unpredictable to be a legitimate feature.&lt;/p&gt;

&lt;p&gt;for example in the expression: objects&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;.status&lt;/p&gt;

&lt;p&gt;if (objects&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt; != null &amp;amp;&amp;amp; objects&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;.status == null) then it will search for the bare expression &quot;status&quot; in the JexlContext. Ideally it would query the JexlContext map for the full expression, however the details of that are difficult to implement and can produce odd results.&lt;/p&gt;

&lt;p&gt;Even worse with an expression like: base.objects&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;.status.&lt;br/&gt;
if (base != null &amp;amp;&amp;amp; base.objects&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt; != null &amp;amp;&amp;amp; base.objects&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;.status == null) then this expression will evaluate look for &quot;base.status&quot; in the JexlContext map.&lt;/p&gt;

&lt;p&gt;It currently works as expected for expressions like base.object.status by searching for &quot;base.object.status&quot; in the JexlContext if status is null. Although I&apos;m not entirely convinced that it is a good idea to do this.&lt;/p&gt;

&lt;p&gt;Simple Fix:&lt;/p&gt;

&lt;p&gt;in ASTReference.java change the function getIdentifierToDepth() to return an empty string if there are non ASTIdentifier Nodes in the expression (in my case it&apos;s ASTArrayAccess nodes). This is the simplest solution and stops subobjects effectively assuming values of objects in the base JexlContext while still allowing you to bind objects into the JexlContext with identifiers with &quot;.&quot; in the name.&lt;/p&gt;

&lt;p&gt;So you could add &quot;object.tracking.status&quot; directly into the JexlContext and it would work. However you couldn&apos;t add object.tracking&lt;span class=&quot;error&quot;&gt;&amp;#91;23&amp;#93;&lt;/span&gt;.status because one of the Nodes is an ArrayAccess node and it can&apos;t be translated back into a string by the current implementation.&lt;/p&gt;

&lt;p&gt;/* patched function */&lt;/p&gt;

&lt;p&gt;    private String getIdentifierToDepth(int i) {&lt;br/&gt;
        StringBuffer varName = new StringBuffer();&lt;br/&gt;
        for (int j = 0; j &amp;lt;= i; j++) {&lt;br/&gt;
            SimpleNode node = (SimpleNode) jjtGetChild(j);&lt;br/&gt;
            if (node instanceof ASTIdentifier) {&lt;br/&gt;
                varName.append(((ASTIdentifier) node).getIdentifierString());&lt;br/&gt;
                if (j != i) &lt;/p&gt;
{
                    varName.append(&apos;.&apos;);
                }
&lt;p&gt;            } else &lt;/p&gt;
{
                /* expression is unresolvable and variable name is invalid */
                return &quot;&quot;;
            }
&lt;p&gt;        }&lt;br/&gt;
        return varName.toString();&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;You could always add some code to support ASTArrayAccess nodes. However you&apos;d also have to support either evaluating, or reducing to a string, the index expression. Which is messy.&lt;/p&gt;</description>
                <environment>&lt;p&gt;N/A&lt;/p&gt;</environment>
        <key id="12354757">JEXL-26</key>
            <summary>ASTArrayAccess messes up on fallback to JexlContext</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="colinlear">Colin Lear</reporter>
                        <labels>
                    </labels>
                <created>Sat, 4 Nov 2006 07:23:16 +0000</created>
                <updated>Tue, 9 Mar 2010 15:15:44 +0000</updated>
                            <resolved>Sun, 28 Oct 2007 09:07:22 +0000</resolved>
                                    <version>1.1</version>
                                    <fixVersion>2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12537879" author="diongillard" created="Fri, 26 Oct 2007 08:51:27 +0000"  >&lt;p&gt;This may be fixed in the JEXL 2.0 development branch. It needs a test.&lt;/p&gt;</comment>
                            <comment id="12538293" author="diongillard" created="Sun, 28 Oct 2007 09:07:22 +0000"  >&lt;p&gt;This is fixed in the 2.0 branch.&lt;br/&gt;
There is a test in ArrayAccessTest.testArrayAndDottedConflict() which makes sure it works correctly.&lt;/p&gt;</comment>
                            <comment id="12843086" author="henrib" created="Tue, 9 Mar 2010 15:15:44 +0000"  >&lt;p&gt;Bulk closing issues resolved in JEXL 2.0.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46701</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0xqov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>194961</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>