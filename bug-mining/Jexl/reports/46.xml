<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sun Nov 09 05:57:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JEXL-146] Performance problem in Interpreter.unknownVariable mechanism</title>
                <link>https://issues.apache.org/jira/browse/JEXL-146</link>
                <project id="12310479" key="JEXL">Commons JEXL</project>
                    <description>&lt;p&gt;When JEXL is used in non-strict mode it silently ignores unknown variables.  However it still constructs a &lt;tt&gt;JexlException.Variable&lt;/tt&gt; exception, even though it doesn&apos;t throw it.&lt;/p&gt;

&lt;p&gt;Constructing exceptions in Java is expensive.  If you happen to have a situation where unknown variables are common then this becomes a performance problem.  It is showing up as an issue in our application.&lt;/p&gt;

&lt;p&gt;Inspecting the source of &lt;tt&gt;Interpreter&lt;/tt&gt; it looks like a similar issue could also occur with a number of the other exceptions.  They are always created, even if they are not going to be thrown.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12745178">JEXL-146</key>
            <summary>Performance problem in Interpreter.unknownVariable mechanism</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dmaplesden">David Maplesden</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Oct 2014 07:02:01 +0000</created>
                <updated>Mon, 21 Mar 2016 14:10:16 +0000</updated>
                            <resolved>Thu, 19 Mar 2015 15:24:00 +0000</resolved>
                                    <version>2.1.1</version>
                    <version>3.0</version>
                                    <fixVersion>3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14154487" author="dmaplesden" created="Wed, 1 Oct 2014 07:08:43 +0000"  >&lt;p&gt;The fix for this is fairly straight-forward, it just requires delaying the construction of the exception until the moment it is actually going to be thrown.  The information required to construct the appropriate exception can be passed through to the appropriate point.&lt;/p&gt;

&lt;p&gt;I am happy to provide a patch for the change.  What is the best way to do this?  I can provide a pull request for the github mirror project or a patch file on this ticket?&lt;/p&gt;

&lt;p&gt;It would be great to have it available in a stable release.  Doesn&apos;t look like there has been one of those in some time, is there any chance of one in the near future?  If so, should I provide a patch for 3.0 or 2.1?&lt;/p&gt;</comment>
                            <comment id="14154589" author="henrib" created="Wed, 1 Oct 2014 09:07:51 +0000"  >&lt;p&gt;Committed a fix in the 3.0 trunk (unsolvable variable/property/method); let me know if this is what you expected.&lt;/p&gt;

&lt;p&gt;On the release subject, you should post/ask to the mailing list to see if any committer is interested in releasing 3.0.&lt;/p&gt;</comment>
                            <comment id="14154654" author="dmaplesden" created="Wed, 1 Oct 2014 10:56:12 +0000"  >&lt;p&gt;Hi Henri,&lt;/p&gt;

&lt;p&gt;Thanks for your quick response.&lt;/p&gt;

&lt;p&gt;I haven&apos;t done a line by line check but it certainly looks like it has addressed my main concern, delaying the construction of the exceptions until the point where they are actually thrown.  Looks good.  Some of the other changes I don&apos;t completely understand but I trust you do!&lt;/p&gt;

&lt;p&gt;One thing I did notice, the way you now temporarily change the `strictEngine` member variable means the class is no longer thread-safe.  I&apos;m not 100% sure that it was thread-safe before, but it seems possible that it was intended to be given that most of the member variables are final or volatile.  You may need to double-check that usage.  Although looking closer it looks like `functors` was already not used in a thread-safe manner... so maybe the class is not intended to be thread-safe.&lt;/p&gt;

&lt;p&gt;Anyway, thank you for the change, it does look like it will address my problem.&lt;/p&gt;</comment>
                            <comment id="14154717" author="henrib" created="Wed, 1 Oct 2014 12:07:22 +0000"  >&lt;p&gt;An Interpreter instance is created for each expression/script execution; it should not be possible to share an interpreter between 2 threads so the thread safety (of isStrictEngine) is not really a concern. The only exception is the &apos;cancelled&apos; flag which allows thread cancellation of a script running as a callable.&lt;br/&gt;
You are however absolutely right about the potential issue with the functors; these should definitely not be shared between interpreter instances. I&apos;ve made corrections accordingly; Closure/callable no longer acquire a reference to their caller functor. Thanks for spotting the issue.&lt;/p&gt;</comment>
                            <comment id="15204276" author="henrib" created="Mon, 21 Mar 2016 14:10:16 +0000"  >&lt;p&gt;Update issues resolved in 3.0 to closed &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 34 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20o8f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>