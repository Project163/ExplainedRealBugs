diff --git a/src/server.c b/src/server.c
index f5fb339f9..ddc90b3dd 100644
--- a/src/server.c
+++ b/src/server.c
@@ -3509,6 +3509,7 @@ int processCommand(client *c) {
         !(c->flags & CLIENT_MASTER) &&
         c->cmd->flags & CMD_WRITE)
     {
+        flagTransaction(c);
         addReply(c, shared.roslaveerr);
         return C_OK;
     }
