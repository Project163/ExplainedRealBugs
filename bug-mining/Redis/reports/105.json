{"url":"https://api.github.com/repos/redis/redis/issues/13224","repository_url":"https://api.github.com/repos/redis/redis","labels_url":"https://api.github.com/repos/redis/redis/issues/13224/labels{/name}","comments_url":"https://api.github.com/repos/redis/redis/issues/13224/comments","events_url":"https://api.github.com/repos/redis/redis/issues/13224/events","html_url":"https://github.com/redis/redis/issues/13224","id":2250471620,"node_id":"I_kwDOAAJhcs6GI3jE","number":13224,"title":"[CRASH] cluster relance failed:  ASSERTION FAILED","user":{"login":"xiaozhuang-a","id":61875985,"node_id":"MDQ6VXNlcjYxODc1OTg1","avatar_url":"https://avatars.githubusercontent.com/u/61875985?v=4","gravatar_id":"","url":"https://api.github.com/users/xiaozhuang-a","html_url":"https://github.com/xiaozhuang-a","followers_url":"https://api.github.com/users/xiaozhuang-a/followers","following_url":"https://api.github.com/users/xiaozhuang-a/following{/other_user}","gists_url":"https://api.github.com/users/xiaozhuang-a/gists{/gist_id}","starred_url":"https://api.github.com/users/xiaozhuang-a/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiaozhuang-a/subscriptions","organizations_url":"https://api.github.com/users/xiaozhuang-a/orgs","repos_url":"https://api.github.com/users/xiaozhuang-a/repos","events_url":"https://api.github.com/users/xiaozhuang-a/events{/privacy}","received_events_url":"https://api.github.com/users/xiaozhuang-a/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2024-04-18T11:39:36Z","updated_at":"2024-06-04T12:16:37Z","closed_at":"2024-06-04T12:16:37Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Notice!\r\n- If a Redis module was involved, please open an issue in the module's repo instead!\r\n- If you're using docker on Apple M1, please make sure the image you're using was compiled for ARM!\r\n\r\n\r\n**Crash report**\r\n\r\nPaste the complete crash log between the quotes below. Please include a few lines from the log preceding the crash report to provide some context.\r\n\r\nredis-cluster: v7.2.4\r\nDuring the rebalance phase of Redis expansion and sharding, the source node that was migrated crashed. The way to perform the rebalance was through 'Redis cli cluster rebalance', and the rebalance failure resulted in abnormal status of the slot, which cannot be fixed using the cluster fix. This is a headache for us\r\n\r\n\r\n```\r\n99535:M 18 Apr 2024 17:37:28.526 * Starting automatic rewriting of AOF on 100% growth\r\n799535:M 18 Apr 2024 17:37:28.526 * Creating AOF incr file appendonly.aof.208368.incr.aof on background rewrite\r\n799535:M 18 Apr 2024 17:37:28.536 * Background append only file rewriting started by pid 3380172\r\n3380172:C 18 Apr 2024 17:37:29.835 * Successfully created the temporary AOF base file temp-rewriteaof-bg-3380172.aof\r\n3380172:C 18 Apr 2024 17:37:29.840 * Fork CoW for AOF rewrite: current 20 MB, peak 20 MB, average 14 MB\r\n799535:M 18 Apr 2024 17:37:29.844 * Background AOF rewrite terminated with success\r\n799535:M 18 Apr 2024 17:37:29.844 * Successfully renamed the temporary AOF base file temp-rewriteaof-bg-3380172.aof in\r\nto appendonly.aof.208368.base.rdb\r\n799535:M 18 Apr 2024 17:37:29.845 * Removing the history file appendonly.aof.208367.incr.aof in the background\r\n799535:M 18 Apr 2024 17:37:29.845 * Removing the history file appendonly.aof.208367.base.rdb in the background\r\n799535:M 18 Apr 2024 17:37:29.845 * Background AOF rewrite finished successfully\r\n799535:M 18 Apr 2024 17:37:35.298 # === ASSERTION FAILED ===\r\n799535:M 18 Apr 2024 17:37:35.298 # ==> networking.c:2066 'c->duration == 0' is not true\r\n799535:M 18 Apr 2024 17:37:35.305 # Bio worker thread #0 terminated\r\n799535:M 18 Apr 2024 17:37:35.306 # Bio worker thread #1 terminated\r\n799535:M 18 Apr 2024 17:37:35.306 # Bio worker thread #2 terminated\r\n799535:M 18 Apr 2024 17:37:35.306 # IO thread(tid:139898848896768) terminated\r\n799535:M 18 Apr 2024 17:37:35.306 # IO thread(tid:139898840504064) terminated\r\n\r\n```\r\n\r\n**Additional information**\r\n\r\n1. OS distribution and version\r\n2. Steps to reproduce (if any)\r\n","closed_by":{"login":"sundb","id":965798,"node_id":"MDQ6VXNlcjk2NTc5OA==","avatar_url":"https://avatars.githubusercontent.com/u/965798?v=4","gravatar_id":"","url":"https://api.github.com/users/sundb","html_url":"https://github.com/sundb","followers_url":"https://api.github.com/users/sundb/followers","following_url":"https://api.github.com/users/sundb/following{/other_user}","gists_url":"https://api.github.com/users/sundb/gists{/gist_id}","starred_url":"https://api.github.com/users/sundb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sundb/subscriptions","organizations_url":"https://api.github.com/users/sundb/orgs","repos_url":"https://api.github.com/users/sundb/repos","events_url":"https://api.github.com/users/sundb/events{/privacy}","received_events_url":"https://api.github.com/users/sundb/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/redis/redis/issues/13224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/redis/redis/issues/13224/timeline","performed_via_github_app":null,"state_reason":"completed"}