{"url":"https://api.github.com/repos/redis/redis/issues/7275","repository_url":"https://api.github.com/repos/redis/redis","labels_url":"https://api.github.com/repos/redis/redis/issues/7275/labels{/name}","comments_url":"https://api.github.com/repos/redis/redis/issues/7275/comments","events_url":"https://api.github.com/repos/redis/redis/issues/7275/events","html_url":"https://github.com/redis/redis/issues/7275","id":620313370,"node_id":"MDU6SXNzdWU2MjAzMTMzNzA=","number":7275,"title":"Redis 6.0.3 assertion on make test in networking.c: c->reply_bytes < SIZE_MAX-(1024*64)' is not true","user":{"login":"rdghickman","id":10304857,"node_id":"MDQ6VXNlcjEwMzA0ODU3","avatar_url":"https://avatars.githubusercontent.com/u/10304857?v=4","gravatar_id":"","url":"https://api.github.com/users/rdghickman","html_url":"https://github.com/rdghickman","followers_url":"https://api.github.com/users/rdghickman/followers","following_url":"https://api.github.com/users/rdghickman/following{/other_user}","gists_url":"https://api.github.com/users/rdghickman/gists{/gist_id}","starred_url":"https://api.github.com/users/rdghickman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdghickman/subscriptions","organizations_url":"https://api.github.com/users/rdghickman/orgs","repos_url":"https://api.github.com/users/rdghickman/repos","events_url":"https://api.github.com/users/rdghickman/events{/privacy}","received_events_url":"https://api.github.com/users/rdghickman/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":15,"created_at":"2020-05-18T15:44:52Z","updated_at":"2020-05-22T14:18:20Z","closed_at":"2020-05-21T13:47:16Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"[ok]: XREVRANGE returns the reverse of XRANGE\r\n\r\nLogged warnings (pid 8206):\r\n=== REDIS BUG REPORT START: Cut & paste starting from here ===\r\n8206:M 18 May 2020 16:27:09.565 # === ASSERTION FAILED ===\r\n8206:M 18 May 2020 16:27:09.565 # ==> networking.c:2749 'c->reply_bytes < SIZE_MAX-(1024*64)' is not true\r\n8206:M 18 May 2020 16:27:09.565 # (forcing SIGSEGV to print the bug report.)\r\n8206:M 18 May 2020 16:27:09.565 # Redis 6.0.3 crashed by signal: 11\r\n8206:M 18 May 2020 16:27:09.566 # Crashed running the instruction at: 0x7a930\r\n8206:M 18 May 2020 16:27:09.566 # Accessing address: 0xffffffff\r\n8206:M 18 May 2020 16:27:09.566 # Failed assertion: c->reply_bytes < SIZE_MAX-(1024*64) (networking.c:2749)\r\n\r\n------ STACK TRACE ------\r\nEIP:\r\nsrc/redis-server 127.0.0.1:21241(_serverAssert+0x6c)[0x7a930]\r\n\r\nBacktrace:\r\nsrc/redis-server 127.0.0.1:21241(logStackTrace+0x30)[0x7d100]\r\nsrc/redis-server 127.0.0.1:21241(sigsegvHandler+0x90)[0x7d7d0]\r\n/lib/arm-linux-gnueabihf/libc.so.6(__default_rt_sa_restorer+0x0)[0x76cdf6c0]\r\nsrc/redis-server 127.0.0.1:21241(_serverAssert+0x6c)[0x7a930]\r\nsrc/redis-server 127.0.0.1:21241(asyncCloseClientOnOutputBufferLimitReached+0x98)[0x47c50]\r\nsrc/redis-server 127.0.0.1:21241(addReply+0x190)[0x47f04]\r\nsrc/redis-server 127.0.0.1:21241(streamReplyWithRange+0xec)[0xbbdd0]\r\nsrc/redis-server 127.0.0.1:21241(xreadCommand+0x7c4)[0xbcf04]\r\nsrc/redis-server 127.0.0.1:21241(call+0x9c)[0x380e0]\r\nsrc/redis-server 127.0.0.1:21241(processCommand+0x48c)[0x389f4]\r\nsrc/redis-server 127.0.0.1:21241(processCommandAndResetClient+0x14)[0x46b9c]\r\nsrc/redis-server 127.0.0.1:21241(processInputBuffer+0x124)[0x4b2a4]\r\nsrc/redis-server 127.0.0.1:21241[0xc7ca4]\r\nsrc/redis-server 127.0.0.1:21241(aeProcessEvents+0x2c4)[0x31eb4]\r\nsrc/redis-server 127.0.0.1:21241(aeMain+0x20)[0x321d0]\r\nsrc/redis-server 127.0.0.1:21241(main+0x464)[0x2ec10]\r\n/lib/arm-linux-gnueabihf/libc.so.6(__libc_start_main+0x114)[0x76cc9678]\r\n\r\n------ INFO OUTPUT ------\r\n# Server\r\nredis_version:6.0.3\r\nredis_git_sha1:00000000\r\nredis_git_dirty:0\r\nredis_build_id:bfe8e08ae070287a\r\nredis_mode:standalone\r\nos:Linux 4.19.58-v7+ armv7l\r\narch_bits:32\r\nmultiplexing_api:epoll\r\natomicvar_api:atomic-builtin\r\ngcc_version:6.3.0\r\nprocess_id:8206\r\nrun_id:dfd2ef3910c55fa9e271558d448c6cc4a6126eff\r\ntcp_port:21241\r\nuptime_in_seconds:53\r\nuptime_in_days:0\r\nhz:10\r\nconfigured_hz:10\r\nlru_clock:12757325\r\nexecutable:/home/pi/rhickman/redis-6.0.3/src/redis-server\r\nconfig_file:/home/pi/rhickman/redis-6.0.3/./tests/tmp/redis.conf.7354.60\r\n\r\n# Clients\r\nconnected_clients:1\r\nclient_recent_max_input_buffer:2\r\nclient_recent_max_output_buffer:0\r\nblocked_clients:0\r\ntracking_clients:0\r\nclients_in_timeout_table:0\r\n\r\n# Memory\r\nused_memory:839856\r\nused_memory_human:820.17K\r\nused_memory_rss:6123520\r\nused_memory_rss_human:5.84M\r\nused_memory_peak:2104096\r\nused_memory_peak_human:2.01M\r\nused_memory_peak_perc:39.92%\r\nused_memory_overhead:631250\r\nused_memory_startup:614348\r\nused_memory_dataset:208606\r\nused_memory_dataset_perc:92.50%\r\nallocator_allocated:789080\r\nallocator_active:6095872\r\nallocator_resident:6095872\r\ntotal_system_memory:917020672\r\ntotal_system_memory_human:874.54M\r\nused_memory_lua:27648\r\nused_memory_lua_human:27.00K\r\nused_memory_scripts:0\r\nused_memory_scripts_human:0B\r\nnumber_of_cached_scripts:0\r\nmaxmemory:3221225472\r\nmaxmemory_human:3.00G\r\nmaxmemory_policy:noeviction\r\nallocator_frag_ratio:7.73\r\nallocator_frag_bytes:5306792\r\nallocator_rss_ratio:1.00\r\nallocator_rss_bytes:0\r\nrss_overhead_ratio:1.00\r\nrss_overhead_bytes:27648\r\nmem_fragmentation_ratio:7.76\r\nmem_fragmentation_bytes:5334440\r\nmem_not_counted_for_evict:0\r\nmem_replication_backlog:0\r\nmem_clients_slaves:0\r\nmem_clients_normal:16850\r\nmem_aof_buffer:0\r\nmem_allocator:libc\r\nactive_defrag_running:0\r\nlazyfree_pending_objects:0\r\n\r\n# Persistence\r\nloading:0\r\nrdb_changes_since_last_save:11014\r\nrdb_bgsave_in_progress:0\r\nrdb_last_save_time:1589815576\r\nrdb_last_bgsave_status:ok\r\nrdb_last_bgsave_time_sec:-1\r\nrdb_current_bgsave_time_sec:-1\r\nrdb_last_cow_size:0\r\naof_enabled:0\r\naof_rewrite_in_progress:0\r\naof_rewrite_scheduled:0\r\naof_last_rewrite_time_sec:-1\r\naof_current_rewrite_time_sec:-1\r\naof_last_bgrewrite_status:ok\r\naof_last_write_status:ok\r\naof_last_cow_size:0\r\nmodule_fork_in_progress:0\r\nmodule_fork_last_cow_size:0\r\n\r\n# Stats\r\ntotal_connections_received:2\r\ntotal_commands_processed:11132\r\ninstantaneous_ops_per_sec:0\r\ntotal_net_input_bytes:658093\r\ntotal_net_output_bytes:2451977\r\ninstantaneous_input_kbps:0.00\r\ninstantaneous_output_kbps:0.00\r\nrejected_connections:0\r\nsync_full:0\r\nsync_partial_ok:0\r\nsync_partial_err:0\r\nexpired_keys:0\r\nexpired_stale_perc:0.00\r\nexpired_time_cap_reached_count:0\r\nexpire_cycle_cpu_milliseconds:5\r\nevicted_keys:0\r\nkeyspace_hits:112\r\nkeyspace_misses:1\r\npubsub_channels:0\r\npubsub_patterns:0\r\nlatest_fork_usec:0\r\nmigrate_cached_sockets:0\r\nslave_expires_tracked_keys:0\r\nactive_defrag_hits:0\r\nactive_defrag_misses:0\r\nactive_defrag_key_hits:0\r\nactive_defrag_key_misses:0\r\ntracking_total_keys:0\r\ntracking_total_items:0\r\ntracking_total_prefixes:0\r\nunexpected_error_replies:0\r\n\r\n# Replication\r\nrole:master\r\nconnected_slaves:0\r\nmaster_replid:30e8e2b996773cc435aae4a20df40a48c9ec7633\r\nmaster_replid2:0000000000000000000000000000000000000000\r\nmaster_repl_offset:0\r\nmaster_repl_meaningful_offset:0\r\nsecond_repl_offset:-1\r\nrepl_backlog_active:0\r\nrepl_backlog_size:1048576\r\nrepl_backlog_first_byte_offset:0\r\nrepl_backlog_histlen:0\r\n\r\n# CPU\r\nused_cpu_sys:1.037396\r\nused_cpu_user:2.297092\r\nused_cpu_sys_children:0.000000\r\nused_cpu_user_children:0.000000\r\n\r\n# Modules\r\n\r\n# Commandstats\r\ncmdstat_ping:calls=1,usec=8,usec_per_call=8.00\r\ncmdstat_xadd:calls=11011,usec=762546,usec_per_call=69.25\r\ncmdstat_xrevrange:calls=2,usec=221898,usec_per_call=110949.00\r\ncmdstat_xrange:calls=106,usec=656160,usec_per_call=6190.19\r\ncmdstat_xlen:calls=2,usec=39,usec_per_call=19.50\r\ncmdstat_del:calls=4,usec=228,usec_per_call=57.00\r\ncmdstat_exists:calls=1,usec=15,usec_per_call=15.00\r\ncmdstat_multi:calls=2,usec=16,usec_per_call=8.00\r\ncmdstat_exec:calls=2,usec=672462,usec_per_call=336231.00\r\ncmdstat_select:calls=1,usec=11,usec_per_call=11.00\r\n\r\n# Cluster\r\ncluster_enabled:0\r\n\r\n# Keyspace\r\ndb9:keys=1,expires=0,avg_ttl=0\r\n\r\n------ CLIENT LIST OUTPUT ------\r\nid=5 addr=127.0.0.1:44325 fd=8 name= age=53 idle=0 flags=N db=9 sub=0 psub=0 multi=-1 qbuf=69 qbuf-free=32699 obl=0 oll=4 omem=16488 events=r cmd=xread user=default\r\n\r\n------ CURRENT CLIENT INFO ------\r\nid=5 addr=127.0.0.1:44325 fd=8 name= age=53 idle=0 flags=N db=9 sub=0 psub=0 multi=-1 qbuf=69 qbuf-free=32699 obl=0 oll=4 omem=16488 events=r cmd=xread user=default\r\nargv[0]: 'XREAD'\r\nargv[1]: 'COUNT'\r\nargv[2]: '1'\r\nargv[3]: 'STREAMS'\r\nargv[4]: 'mystream'\r\nargv[5]: '0-0'\r\n\r\n------ REGISTERS ------\r\n8206:M 18 May 2020 16:27:09.570 #\r\nR10:00000000000fb74c R9 :0000000000000001\r\nR8 :0000000000000000 R7 :000000007eb032d8\r\nR6 :00000000000f1670 R5 :00000000000f0e10\r\nR4 :0000000000000abd R3 :00000000001376a8\r\nR2 :00000000ffffffff R1 :0000000000000078\r\nR0 :0000000000000000 EC :0000000000000000\r\nfp: 0000000000000837 ip:0000000000000000\r\n\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fe7) -> 00000000\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fe6) -> 00000000\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fe5) -> 00047f04\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fe4) -> 7eb032d8\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fe3) -> 00000000\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fe2) -> 7eb03070\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fe1) -> 01a07d68\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fe0) -> 019e4170\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fdf) -> 00047c50\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fde) -> 00000000\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fdd) -> fffefffe\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fdc) -> 01a07d68\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fdb) -> 01a07d68\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fda) -> 00000000\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fd9) -> 01c3bfe8\r\n8206:M 18 May 2020 16:27:09.570 # (7eb02fd8) -> 000f1670\r\n\r\n------ MODULES INFO OUTPUT ------\r\n\r\n------ FAST MEMORY TEST ------\r\n8206:M 18 May 2020 16:27:09.571 # Bio thread for job type #0 terminated\r\n8206:M 18 May 2020 16:27:09.571 # Bio thread for job type #1 terminated\r\n8206:M 18 May 2020 16:27:09.571 # Bio thread for job type #2 terminated\r\n*** Preparing to test memory region 129000 (69632 bytes)\r\n*** Preparing to test memory region 19ab000 (2891776 bytes)\r\n*** Preparing to test memory region 752c4000 (8388608 bytes)\r\n*** Preparing to test memory region 75ac5000 (8388608 bytes)\r\n*** Preparing to test memory region 762c6000 (8716288 bytes)\r\n*** Preparing to test memory region 76cb1000 (8192 bytes)\r\n*** Preparing to test memory region 76def000 (12288 bytes)\r\n*** Preparing to test memory region 76e19000 (8192 bytes)\r\n*** Preparing to test memory region 76e88000 (4096 bytes)\r\n*** Preparing to test memory region 76f4c000 (8192 bytes)\r\n.O.O.O.O.O.O.O.O.O.O\r\nFast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.\r\n\r\n------ DUMPING CODE AROUND EIP ------\r\nSymbol: _serverAssert (base: 0x7a8c4)\r\nModule: src/redis-server 127.0.0.1:21241 (base 0x10000)\r\n$ xxd -r -p /tmp/dump.hex /tmp/dump.bin\r\n$ objdump --adjust-vma=0x7a8c4 -D -b binary -m i386:x86-64 /tmp/dump.bin\r\n------\r\n8206:M 18 May 2020 16:27:12.583 # dump of function (hexdump of 236 bytes):\r\nf0402de90070a0e168409fe50cd04de20160a0e14c3b94e50250a0e1000053e30000001a66ffffeb4c109fe50300a0e3e5ebfeeb0530a0e10620a0e100708de538109fe50300a0e3dfebfeeb30109fe50300a0e3407b84e5446b84e5485b84e5d9ebfeeb0030e0e37820a0e30020c3e50cd08de2f080bde8a876130038ad0f0054ad0f0070ad0f000c319fe5f04f2de90050a0e14c3b93e5acd04de2000053e33b00000af4109fe50300a0e3c6ebfeebd826c5e1e8109fe50300a0e3c2ebfeeb2020a0e308108de2080095e5703501ebd0109fe50020a0e10300a0e3baebfeeb282095e5c0109fe50300a0e3\r\n\r\n=== REDIS BUG REPORT END. Make sure to include from START to END. ===\r\n","closed_by":{"login":"antirez","id":65632,"node_id":"MDQ6VXNlcjY1NjMy","avatar_url":"https://avatars.githubusercontent.com/u/65632?v=4","gravatar_id":"","url":"https://api.github.com/users/antirez","html_url":"https://github.com/antirez","followers_url":"https://api.github.com/users/antirez/followers","following_url":"https://api.github.com/users/antirez/following{/other_user}","gists_url":"https://api.github.com/users/antirez/gists{/gist_id}","starred_url":"https://api.github.com/users/antirez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/antirez/subscriptions","organizations_url":"https://api.github.com/users/antirez/orgs","repos_url":"https://api.github.com/users/antirez/repos","events_url":"https://api.github.com/users/antirez/events{/privacy}","received_events_url":"https://api.github.com/users/antirez/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/redis/redis/issues/7275/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/redis/redis/issues/7275/timeline","performed_via_github_app":null,"state_reason":"completed"}