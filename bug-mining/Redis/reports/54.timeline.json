[{"url":"https://api.github.com/repos/redis/redis/issues/comments/700731944","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-700731944","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":700731944,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMDczMTk0NA==","user":{"login":"yossigo","id":1481195,"node_id":"MDQ6VXNlcjE0ODExOTU=","avatar_url":"https://avatars.githubusercontent.com/u/1481195?v=4","gravatar_id":"","url":"https://api.github.com/users/yossigo","html_url":"https://github.com/yossigo","followers_url":"https://api.github.com/users/yossigo/followers","following_url":"https://api.github.com/users/yossigo/following{/other_user}","gists_url":"https://api.github.com/users/yossigo/gists{/gist_id}","starred_url":"https://api.github.com/users/yossigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yossigo/subscriptions","organizations_url":"https://api.github.com/users/yossigo/orgs","repos_url":"https://api.github.com/users/yossigo/repos","events_url":"https://api.github.com/users/yossigo/events{/privacy}","received_events_url":"https://api.github.com/users/yossigo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-29T14:11:30Z","updated_at":"2020-09-29T14:11:30Z","body":"@tzickel Unfortunately I don't see how this can be done in a complete manner, as theoretically commands with movable keys have a lot of freedom regarding their positions and count. Even if we did hard code that for Redis commands, we'd still be left with the problem of modules with movable keys.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/700731944/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yossigo","id":1481195,"node_id":"MDQ6VXNlcjE0ODExOTU=","avatar_url":"https://avatars.githubusercontent.com/u/1481195?v=4","gravatar_id":"","url":"https://api.github.com/users/yossigo","html_url":"https://github.com/yossigo","followers_url":"https://api.github.com/users/yossigo/followers","following_url":"https://api.github.com/users/yossigo/following{/other_user}","gists_url":"https://api.github.com/users/yossigo/gists{/gist_id}","starred_url":"https://api.github.com/users/yossigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yossigo/subscriptions","organizations_url":"https://api.github.com/users/yossigo/orgs","repos_url":"https://api.github.com/users/yossigo/repos","events_url":"https://api.github.com/users/yossigo/events{/privacy}","received_events_url":"https://api.github.com/users/yossigo/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3819835200,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzgxOTgzNTIwMA==","url":"https://api.github.com/repos/redis/redis/issues/events/3819835200","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-29T14:11:30Z","performed_via_github_app":null},{"id":3819835203,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM4MTk4MzUyMDM=","url":"https://api.github.com/repos/redis/redis/issues/events/3819835203","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-29T14:11:30Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/700874042","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-700874042","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":700874042,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMDg3NDA0Mg==","user":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-29T17:44:16Z","updated_at":"2020-09-29T17:44:16Z","body":"I think that today's situation is bad and can be improved, most libraries hard code this information which sucks (and then when a new function comes out they need to figure it out to get it supported and release an update, if at all).\r\n\r\nRedis server should provide library developers as much information to handle all the stuff it asks of them to support.\r\n\r\nIn my opinion, functions that can support it (i.e. all of the bulitins today and some of the modules?) should support it in one way or the other (as outlined above, maybe a new index in command info?), and only functions who specifically can't should opt out.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/700874042/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/700885001","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-700885001","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":700885001,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMDg4NTAwMQ==","user":{"login":"yossigo","id":1481195,"node_id":"MDQ6VXNlcjE0ODExOTU=","avatar_url":"https://avatars.githubusercontent.com/u/1481195?v=4","gravatar_id":"","url":"https://api.github.com/users/yossigo","html_url":"https://github.com/yossigo","followers_url":"https://api.github.com/users/yossigo/followers","following_url":"https://api.github.com/users/yossigo/following{/other_user}","gists_url":"https://api.github.com/users/yossigo/gists{/gist_id}","starred_url":"https://api.github.com/users/yossigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yossigo/subscriptions","organizations_url":"https://api.github.com/users/yossigo/orgs","repos_url":"https://api.github.com/users/yossigo/repos","events_url":"https://api.github.com/users/yossigo/events{/privacy}","received_events_url":"https://api.github.com/users/yossigo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-29T18:03:01Z","updated_at":"2020-09-29T18:03:01Z","body":"@tzickel I guess that what you're proposing is basically this: leave the custom getkeys mechanism (movable keys) in place but add additional *declarative* schemes for commands in addition to the current first/last/step scheme. For example, a num-keys/first-key scheme that could be used by `EVAL` and others.\r\n\r\nI'd be happy to get the perspective on this from other client library maintainers. @gkorland What do you think?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/700885001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yossigo","id":1481195,"node_id":"MDQ6VXNlcjE0ODExOTU=","avatar_url":"https://avatars.githubusercontent.com/u/1481195?v=4","gravatar_id":"","url":"https://api.github.com/users/yossigo","html_url":"https://github.com/yossigo","followers_url":"https://api.github.com/users/yossigo/followers","following_url":"https://api.github.com/users/yossigo/following{/other_user}","gists_url":"https://api.github.com/users/yossigo/gists{/gist_id}","starred_url":"https://api.github.com/users/yossigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yossigo/subscriptions","organizations_url":"https://api.github.com/users/yossigo/orgs","repos_url":"https://api.github.com/users/yossigo/repos","events_url":"https://api.github.com/users/yossigo/events{/privacy}","received_events_url":"https://api.github.com/users/yossigo/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3820989789,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzgyMDk4OTc4OQ==","url":"https://api.github.com/repos/redis/redis/issues/events/3820989789","actor":{"login":"gkorland","id":753206,"node_id":"MDQ6VXNlcjc1MzIwNg==","avatar_url":"https://avatars.githubusercontent.com/u/753206?v=4","gravatar_id":"","url":"https://api.github.com/users/gkorland","html_url":"https://github.com/gkorland","followers_url":"https://api.github.com/users/gkorland/followers","following_url":"https://api.github.com/users/gkorland/following{/other_user}","gists_url":"https://api.github.com/users/gkorland/gists{/gist_id}","starred_url":"https://api.github.com/users/gkorland/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gkorland/subscriptions","organizations_url":"https://api.github.com/users/gkorland/orgs","repos_url":"https://api.github.com/users/gkorland/repos","events_url":"https://api.github.com/users/gkorland/events{/privacy}","received_events_url":"https://api.github.com/users/gkorland/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-29T18:03:01Z","performed_via_github_app":null},{"id":3820989795,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM4MjA5ODk3OTU=","url":"https://api.github.com/repos/redis/redis/issues/events/3820989795","actor":{"login":"gkorland","id":753206,"node_id":"MDQ6VXNlcjc1MzIwNg==","avatar_url":"https://avatars.githubusercontent.com/u/753206?v=4","gravatar_id":"","url":"https://api.github.com/users/gkorland","html_url":"https://github.com/gkorland","followers_url":"https://api.github.com/users/gkorland/followers","following_url":"https://api.github.com/users/gkorland/following{/other_user}","gists_url":"https://api.github.com/users/gkorland/gists{/gist_id}","starred_url":"https://api.github.com/users/gkorland/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gkorland/subscriptions","organizations_url":"https://api.github.com/users/gkorland/orgs","repos_url":"https://api.github.com/users/gkorland/repos","events_url":"https://api.github.com/users/gkorland/events{/privacy}","received_events_url":"https://api.github.com/users/gkorland/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-29T18:03:01Z","performed_via_github_app":null},{"id":3820989799,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzgyMDk4OTc5OQ==","url":"https://api.github.com/repos/redis/redis/issues/events/3820989799","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-29T18:03:01Z","performed_via_github_app":null},{"id":3820989805,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM4MjA5ODk4MDU=","url":"https://api.github.com/repos/redis/redis/issues/events/3820989805","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-29T18:03:02Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/700942316","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-700942316","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":700942316,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMDk0MjMxNg==","user":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-29T19:38:40Z","updated_at":"2020-09-30T05:39:17Z","body":"FYI: This was recently discussed here: https://github.com/redis/redis/pull/7794\r\nAFAIR not all the `movablekeys` command use this `numkeys` scheme.\r\nOne extremely bad example IMHO is the STRALGO command (which i wish would have been broken to some 4 different commands rather than one).\r\n\r\nI think that for commands like STRALGO there are only two options, either the client library implements specific support for it, or it uses the GETKEYS command.\r\n\r\nI do agree that we should make it easier for client libraries to support the common schemes (like EVAL), however i don't think that re-purposing the `lastkey` argument is right, and i don't think it's safe to assume that the very next argument after the `numkeys` argument is the first key.\r\nfor instance the ZUNIONSTORE have a separate `storekey`, and only later the `numkeys` and the input keys, and in theory these may be spaced apart (unlike ZUNION and EVAL).\r\n\r\nFrom what i've seen, some client libraries just need one key (in order to hash it and decide which cluster node to send the command to), so for that purpose they can just use the `storekey` and don't even need to look into `numkeys` etc. but i think we wanna build something that can be used to discover all keys, and not just one.\r\n\r\nI think we should emit more fields in COMMAND INFO to reflect the more complicated schemes rather than re-purpose existing fields.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/700942316/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/701288600","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-701288600","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":701288600,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMTI4ODYwMA==","user":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-30T09:54:06Z","updated_at":"2020-09-30T09:54:20Z","body":"In that PR numkeys is used as this.\r\n\r\nAnd yes, the end goal for this specific request is for cluster routing (i.e. just tell me sufficient information to where I can find any key without asking the server each invocation).\r\n\r\nIt would be nice if there was a guide on how to properly design commands arguments to be friendly for clients (maybe for other goals instead of just cluster, like knowing if a command can be used in a PIPELINE, can cause BLOCKING, etc... although ACL has improved that), for example XREAD seems to be designed poorly in this regards.\r\n\r\nIn STRALGO, maybe it's possible to consider STRALGO LCS KEYS as the command (other invocations don't require knowing the key).\r\nIn ZUNIONSTORE it's easy, the first index is always the first keys, which is enough for cluster routing.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/701288600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/711462058","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-711462058","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":711462058,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMTQ2MjA1OA==","user":{"login":"trevor211","id":5462911,"node_id":"MDQ6VXNlcjU0NjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/5462911?v=4","gravatar_id":"","url":"https://api.github.com/users/trevor211","html_url":"https://github.com/trevor211","followers_url":"https://api.github.com/users/trevor211/followers","following_url":"https://api.github.com/users/trevor211/following{/other_user}","gists_url":"https://api.github.com/users/trevor211/gists{/gist_id}","starred_url":"https://api.github.com/users/trevor211/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trevor211/subscriptions","organizations_url":"https://api.github.com/users/trevor211/orgs","repos_url":"https://api.github.com/users/trevor211/repos","events_url":"https://api.github.com/users/trevor211/events{/privacy}","received_events_url":"https://api.github.com/users/trevor211/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T01:34:07Z","updated_at":"2020-10-19T01:34:07Z","body":"I think it is not easy to design for every existing commands keeping the purpose of existing fields as they are.\r\n\r\nIn order to provide a way for clients to cache, we can only use `COMMAND INFO` instead of `COMMAND GETKEYS`.\r\nBased on current design, we can add an additional field for the output of `COMMAND INFO`, e.g. `numkeys `.\r\nWe could provide a `get_command_info_proc` handle for each command just like `getkeys_proc`.\r\n\r\nWe can handle most of the existing builtin command, and we could even handle most of module command provided that modules got updated using the new mechanism.\r\n\r\nWe can not handle every command, one example is `ZUNIONSTORE `. \r\nLooking at the command format, FYR https://redis.io/commands/zunionstore, \r\n`ZUNIONSTORE destination numkeys key [key ...] [WEIGHTS weight [weight ...]] [AGGREGATE SUM|MIN|MAX]`.\r\nI think we should emit the `destination`, and `key [key ...]` parts, but that's not possible even with the added output of `numkeys`.\r\n\r\nOne thing I think we should be sure is that the existing fields of the output of `COMMAND INFO`(`first key position`, `last key position`, `step count` and so on) should be kept as they are.\r\n\r\nIMHO re-purpose existing fields is not a good idea. Besides that, do you have any other ideas? @tzickel \r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/711462058/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"trevor211","id":5462911,"node_id":"MDQ6VXNlcjU0NjI5MTE=","avatar_url":"https://avatars.githubusercontent.com/u/5462911?v=4","gravatar_id":"","url":"https://api.github.com/users/trevor211","html_url":"https://github.com/trevor211","followers_url":"https://api.github.com/users/trevor211/followers","following_url":"https://api.github.com/users/trevor211/following{/other_user}","gists_url":"https://api.github.com/users/trevor211/gists{/gist_id}","starred_url":"https://api.github.com/users/trevor211/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trevor211/subscriptions","organizations_url":"https://api.github.com/users/trevor211/orgs","repos_url":"https://api.github.com/users/trevor211/repos","events_url":"https://api.github.com/users/trevor211/events{/privacy}","received_events_url":"https://api.github.com/users/trevor211/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3890948983,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzg5MDk0ODk4Mw==","url":"https://api.github.com/repos/redis/redis/issues/events/3890948983","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-10-19T01:34:08Z","performed_via_github_app":null},{"id":3890948986,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM4OTA5NDg5ODY=","url":"https://api.github.com/repos/redis/redis/issues/events/3890948986","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-10-19T01:34:08Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/711752609","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-711752609","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":711752609,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMTc1MjYwOQ==","user":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-19T07:27:48Z","updated_at":"2020-10-19T07:27:48Z","body":"maybe the response should be an array possibly holding more than one key-range spec.\r\n\r\nZUNIONSTORE could have something like this:\r\n```\r\n1) 1) \"zunionstore\"\r\n   2) (integer) -4\r\n   3) 1) write\r\n      2) denyoom\r\n      3) movablekeys\r\n   4) (integer) 0\r\n   5) (integer) 0\r\n   6) (integer) 0\r\n   7) 1) @write\r\n      2) @sortedset\r\n      3) @slow\r\n   8) 1) 1) range      <- first spec of type \"range\"\r\n         2) 1) write   <- flags specifying this is used for write\r\n         3) 1) 1       <- index of first key\r\n            2) 1       <- index of last key\r\n            3) 1       <- key step\r\n      2) 1) keynum     <- second spec of type \"keynum\"\r\n         2) 1) read    <- flags specifying this is used for read\r\n         3) 1) 2       <- index of keynum\r\n            2) 3       <- first key index\r\n            3) 1       <- key step\r\n```\r\n\r\nfor SORT STORE we can have: \r\n```\r\n1) 1) \"sort\"\r\n   2) (integer) -2\r\n   3) 1) write\r\n      2) denyoom\r\n      3) movablekeys\r\n   4) (integer) 1\r\n   5) (integer) 1\r\n   6) (integer) 1\r\n   7) 1) @write\r\n      2) @set\r\n      3) @sortedset\r\n      4) @list\r\n      5) @slow\r\n      6) @dangerous\r\n   8) 1) 1) range      <- first spec of type \"range\"\r\n         2) 1) read    <- flags specifying this is used for write\r\n         3) 1) 1       <- index of first key\r\n            2) 1       <- index of last key\r\n            3) 1       <- key step\r\n      2) 1) keyword    <- first spec of type \"keyword\"\r\n         2) 1) write   <- flags specifying this is used for read\r\n         3) 1) STORE   <- keyword string\r\n            2) 1       <- key count\r\n            3) 1       <- key step\r\n```\r\n\r\nfor XREAD we can have: \r\n```\r\n1) 1) \"xread\"\r\n   2) (integer) -4\r\n   3) 1) readonly\r\n      2) movablekeys\r\n   4) (integer) 1\r\n   5) (integer) 1\r\n   6) (integer) 1\r\n   7) 1) @read\r\n      2) @stream\r\n      3) @slow\r\n      4) @blocking\r\n   8) 1) 1) keyword      <- first spec of type \"keyword\"\r\n         2) 1) read      <- flags specifying this is used for read\r\n         3) 1) STREAMS   <- keyword string\r\n            2) -1        <- key count (-1 indicating till the last argument, -2 one before the last)\r\n            3) -2        <- key step (-2 indicating only half of the remaining args)\r\n```\r\n\r\nThe above may also in some way fit STRALGO LCS, but i have a feeling i rather break it into smaller commands and deprecate it.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/711752609/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3897400983,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDM4OTc0MDA5ODM=","url":"https://api.github.com/repos/redis/redis/issues/events/3897400983","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2020-10-20T08:40:48Z","milestone":{"title":"Next minor backlog"},"performed_via_github_app":null},{"id":3897402083,"node_id":"MDEyOkxhYmVsZWRFdmVudDM4OTc0MDIwODM=","url":"https://api.github.com/repos/redis/redis/issues/events/3897402083","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-10-20T08:41:03Z","label":{"name":"state:major-decision","color":"44f221"},"performed_via_github_app":null},{"id":3897402086,"node_id":"MDEyOkxhYmVsZWRFdmVudDM4OTc0MDIwODY=","url":"https://api.github.com/repos/redis/redis/issues/events/3897402086","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-10-20T08:41:03Z","label":{"name":"state:needs-design","color":"10c9c9"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/714528935","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-714528935","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":714528935,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDUyODkzNQ==","user":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-22T14:21:37Z","updated_at":"2020-10-22T14:21:37Z","body":"I'll try to translate the above set of examples to a specification.\r\n\r\nThe 8th element of the command info array, if exists, holds an array of key specs.\r\nThe array may be empty, which indicates the command doesn't take any key arguments,\r\nor may contain one or more key-specs, each one may leads to the discovery of 0 or more key arguments.\r\n\r\nA client library that doesn't support this key-spec feature will keep using the first,last,step and movablekeys flag which will obviously remain unchanged.\r\n\r\nA client that supports this key-specs feature need only to look at the key-specs array.\r\nIf it finds an unrecognized spec, it must resort to use COMMAND GETKEYS if it wishes to get all key name arguments, but if all it needs is one key in order to know which cluster node to use, then maybe another spec (if the command has several) can supply that, and there's no need to use GETKEYS.\r\n\r\nEach spec is an array or arguments, first one is the spec name, second one is an array of flags, and the third is an array containing details about the spec (specific meaning for each spec type)\r\nThe initial flags we support are \"read\" and \"write\" indicating if the keys that this key-spec finds are used for read or for write. clients should ignore ignore any unfamiliar flags.\r\n\r\nthe initial set of key-specs that covers the entire redis command list is:\r\n- \"range\" - [first_idx, last_idx, step]\r\n- \"keynum\" - [keynum_idx, first_idx, step]\r\n- \"keyword\" - [keyword_str, count, step]\r\n  the `count` argument can be negative which key position from the last argument (i.e. -1 means all remaining arguments).\r\n  the `step` argument can be negative which indicates the keys are consecutive, but their count is 1/(-count) of the arguments found according to the `count` option. i.e. -2 means half of the remaining arguments. that's done in order to support XREAD\r\n\r\nMost of the existing commands in redis are already covered by the basic \"range\" spec, the ones that aren't are covered by these command specs combinations:\r\n- ZUNIONSTORE / ZINTERSTORE = range + keynum\r\n- ZUNION / ZINTER = keynum\r\n- SORT = range + keyword\r\n- MIGRATE = range + keyword(\"keys\")\r\n- EVAL / EVALSHA = keynum\r\n- GEORADIUS_RO / GEORADIUSBYMEMBER_RO = range\r\n- GEORADIUS / GEORADIUSBYMEMBER = range + keyword(\"store\") + keyword(\"storedist\")\r\n- XREAD / XREADGROUP = keyword(\"streams\")\r\n- MEMORY = keyword(\"usage\")\r\n- STRALGO = keyword(\"keys\")","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/714528935/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/redis/redis/issues/comments/715563310","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-715563310","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":715563310,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTU2MzMxMA==","user":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-23T20:01:07Z","updated_at":"2020-10-23T20:02:01Z","body":"@oranagra I like that idea (and modules should have an API for specifying this as well).\r\n\r\nAs for the read/write flags, I think that information might be informal in commands.json as well ?\r\n\r\nAnother thought is, can we push this more and somehow get the same info we get in commands.json here about all input arguments ?\r\n\r\nhttps://github.com/redis/redis-doc/blob/master/commands.json\r\n\r\nWithout the full arguments information, maybe there are some edge cases where you can use something that looks like a keyword string before as something else (if he skipped an unknown spec, or in your SORT example, what happens if in the BY pattern, the pattern is called STORE).","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/715563310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3915545157,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzkxNTU0NTE1Nw==","url":"https://api.github.com/repos/redis/redis/issues/events/3915545157","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-10-23T20:01:07Z","performed_via_github_app":null},{"id":3915545167,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM5MTU1NDUxNjc=","url":"https://api.github.com/repos/redis/redis/issues/events/3915545167","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-10-23T20:01:07Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/716108972","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-716108972","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":716108972,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjEwODk3Mg==","user":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-25T08:03:47Z","updated_at":"2020-10-25T08:03:47Z","body":"@tzickel can you describe your use of commands.json?\r\nare you in some way bundling it in your client library and use the metadata it provides for argument validation?\r\n\r\nI agree that the `keyword` spec is vulnerable to some other argument carrying the keyword string. the only way i see around it is to let the client validate the executed arguments against the full command argument syntax (like the one included in commands.json, which btw i'm not sure is feasible with it's current form), but that sounds like a big burden on the client.\r\n\r\nMaybe one way to reduce the burden for the client would have been to implement this common logic in hiredis, and have client use it to perform that service for them, but that's not applicable for some clients.\r\nAlso, either way if we go that direction, it means an old client library that was released before some command was added to redis, won't be able to handle it (unlike my proposed spec approach).\r\n(i'm assuming clients can execute commands they don't explicitly support and still send them to the right shard and pass back the correct response, as i've seen in some clients).","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/716108972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3917564616,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzkxNzU2NDYxNg==","url":"https://api.github.com/repos/redis/redis/issues/events/3917564616","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-10-25T08:03:47Z","performed_via_github_app":null},{"id":3917564617,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM5MTc1NjQ2MTc=","url":"https://api.github.com/repos/redis/redis/issues/events/3917564617","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-10-25T08:03:48Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/716130514","html_url":"https://github.com/redis/redis/issues/7297#issuecomment-716130514","issue_url":"https://api.github.com/repos/redis/redis/issues/7297","id":716130514,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjEzMDUxNA==","user":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-10-25T11:16:57Z","updated_at":"2020-10-25T11:19:20Z","body":"Currently I have no use of it, buy it would be nice if it was possible to use it as a template for not writing a boilerplate for all the Redis functions, and auto code generation of the commands.\r\n\r\nAs for the keyword, maybe we can do, if you see the keyword twice in the input, then try any of them, if the server returns an key error, then ask the server for the key information for this specific instance (which normally should not happen).\r\n\r\nBut maybe we can focus on getting ```COMMAND INFO``` to just give us the minimal information needed for routing, so instead of trying to specify all possible key information for the command, let's try to see if for all current commands, we can return a simple scheme for getting one key index from a given command (for ```SORT``` that will be just index 1).","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/716130514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tzickel","id":7489847,"node_id":"MDQ6VXNlcjc0ODk4NDc=","avatar_url":"https://avatars.githubusercontent.com/u/7489847?v=4","gravatar_id":"","url":"https://api.github.com/users/tzickel","html_url":"https://github.com/tzickel","followers_url":"https://api.github.com/users/tzickel/followers","following_url":"https://api.github.com/users/tzickel/following{/other_user}","gists_url":"https://api.github.com/users/tzickel/gists{/gist_id}","starred_url":"https://api.github.com/users/tzickel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tzickel/subscriptions","organizations_url":"https://api.github.com/users/tzickel/orgs","repos_url":"https://api.github.com/users/tzickel/repos","events_url":"https://api.github.com/users/tzickel/events{/privacy}","received_events_url":"https://api.github.com/users/tzickel/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"yossigo","id":1481195,"node_id":"MDQ6VXNlcjE0ODExOTU=","avatar_url":"https://avatars.githubusercontent.com/u/1481195?v=4","gravatar_id":"","url":"https://api.github.com/users/yossigo","html_url":"https://github.com/yossigo","followers_url":"https://api.github.com/users/yossigo/followers","following_url":"https://api.github.com/users/yossigo/following{/other_user}","gists_url":"https://api.github.com/users/yossigo/gists{/gist_id}","starred_url":"https://api.github.com/users/yossigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yossigo/subscriptions","organizations_url":"https://api.github.com/users/yossigo/orgs","repos_url":"https://api.github.com/users/yossigo/repos","events_url":"https://api.github.com/users/yossigo/events{/privacy}","received_events_url":"https://api.github.com/users/yossigo/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-08T10:36:15Z","updated_at":"2020-12-08T10:36:15Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/redis/redis/issues/8157","repository_url":"https://api.github.com/repos/redis/redis","labels_url":"https://api.github.com/repos/redis/redis/issues/8157/labels{/name}","comments_url":"https://api.github.com/repos/redis/redis/issues/8157/comments","events_url":"https://api.github.com/repos/redis/redis/issues/8157/events","html_url":"https://github.com/redis/redis/issues/8157","id":759331866,"node_id":"MDU6SXNzdWU3NTkzMzE4NjY=","number":8157,"title":"[META] Module API V1","user":{"login":"yossigo","id":1481195,"node_id":"MDQ6VXNlcjE0ODExOTU=","avatar_url":"https://avatars.githubusercontent.com/u/1481195?v=4","gravatar_id":"","url":"https://api.github.com/users/yossigo","html_url":"https://github.com/yossigo","followers_url":"https://api.github.com/users/yossigo/followers","following_url":"https://api.github.com/users/yossigo/following{/other_user}","gists_url":"https://api.github.com/users/yossigo/gists{/gist_id}","starred_url":"https://api.github.com/users/yossigo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yossigo/subscriptions","organizations_url":"https://api.github.com/users/yossigo/orgs","repos_url":"https://api.github.com/users/yossigo/repos","events_url":"https://api.github.com/users/yossigo/events{/privacy}","received_events_url":"https://api.github.com/users/yossigo/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-12-08T10:36:14Z","updated_at":"2022-06-14T10:39:20Z","closed_at":null,"author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":156018,"node_id":"MDEwOlJlcG9zaXRvcnkxNTYwMTg=","name":"redis","full_name":"redis/redis","private":false,"owner":{"login":"redis","id":1529926,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1Mjk5MjY=","avatar_url":"https://avatars.githubusercontent.com/u/1529926?v=4","gravatar_id":"","url":"https://api.github.com/users/redis","html_url":"https://github.com/redis","followers_url":"https://api.github.com/users/redis/followers","following_url":"https://api.github.com/users/redis/following{/other_user}","gists_url":"https://api.github.com/users/redis/gists{/gist_id}","starred_url":"https://api.github.com/users/redis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/redis/subscriptions","organizations_url":"https://api.github.com/users/redis/orgs","repos_url":"https://api.github.com/users/redis/repos","events_url":"https://api.github.com/users/redis/events{/privacy}","received_events_url":"https://api.github.com/users/redis/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/redis/redis","description":"For developers, who are building real-time data-driven applications, Redis is the preferred, fastest, and most feature-rich cache, data structure server, and document and vector query engine.","fork":false,"url":"https://api.github.com/repos/redis/redis","forks_url":"https://api.github.com/repos/redis/redis/forks","keys_url":"https://api.github.com/repos/redis/redis/keys{/key_id}","collaborators_url":"https://api.github.com/repos/redis/redis/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/redis/redis/teams","hooks_url":"https://api.github.com/repos/redis/redis/hooks","issue_events_url":"https://api.github.com/repos/redis/redis/issues/events{/number}","events_url":"https://api.github.com/repos/redis/redis/events","assignees_url":"https://api.github.com/repos/redis/redis/assignees{/user}","branches_url":"https://api.github.com/repos/redis/redis/branches{/branch}","tags_url":"https://api.github.com/repos/redis/redis/tags","blobs_url":"https://api.github.com/repos/redis/redis/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/redis/redis/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/redis/redis/git/refs{/sha}","trees_url":"https://api.github.com/repos/redis/redis/git/trees{/sha}","statuses_url":"https://api.github.com/repos/redis/redis/statuses/{sha}","languages_url":"https://api.github.com/repos/redis/redis/languages","stargazers_url":"https://api.github.com/repos/redis/redis/stargazers","contributors_url":"https://api.github.com/repos/redis/redis/contributors","subscribers_url":"https://api.github.com/repos/redis/redis/subscribers","subscription_url":"https://api.github.com/repos/redis/redis/subscription","commits_url":"https://api.github.com/repos/redis/redis/commits{/sha}","git_commits_url":"https://api.github.com/repos/redis/redis/git/commits{/sha}","comments_url":"https://api.github.com/repos/redis/redis/comments{/number}","issue_comment_url":"https://api.github.com/repos/redis/redis/issues/comments{/number}","contents_url":"https://api.github.com/repos/redis/redis/contents/{+path}","compare_url":"https://api.github.com/repos/redis/redis/compare/{base}...{head}","merges_url":"https://api.github.com/repos/redis/redis/merges","archive_url":"https://api.github.com/repos/redis/redis/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/redis/redis/downloads","issues_url":"https://api.github.com/repos/redis/redis/issues{/number}","pulls_url":"https://api.github.com/repos/redis/redis/pulls{/number}","milestones_url":"https://api.github.com/repos/redis/redis/milestones{/number}","notifications_url":"https://api.github.com/repos/redis/redis/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/redis/redis/labels{/name}","releases_url":"https://api.github.com/repos/redis/redis/releases{/id}","deployments_url":"https://api.github.com/repos/redis/redis/deployments","created_at":"2009-03-21T22:32:25Z","updated_at":"2025-11-10T01:47:26Z","pushed_at":"2025-11-09T07:49:54Z","git_url":"git://github.com/redis/redis.git","ssh_url":"git@github.com:redis/redis.git","clone_url":"https://github.com/redis/redis.git","svn_url":"https://github.com/redis/redis","homepage":"http://redis.io","size":204997,"stargazers_count":71629,"watchers_count":71629,"language":"C","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":24316,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2706,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["cache","caching","database","distributed-systems","in-memory","in-memory-database","json","key-value","key-value-store","message-broker","message-queue","no-sql","nosql","open-source","real-time","realtime","redis","time-series","vector-databases","vector-search"],"visibility":"public","forks":24316,"open_issues":2706,"watchers":71629,"default_branch":"unstable","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"# Module API V1\r\n\r\nThis is an attempt to scope out all missing or broken Redis Module API capabilities, and create an exahustive list that defines a stable V1 interface.\r\n\r\nThe Module API was in continuous state of development since Redis 4. Although it maintains ABI backwards compatibility, this does make things  more difficult for module developers to mange.\r\n\r\n# General\r\n\r\nBetter documentation is desparately needed. Things that come in mind:\r\n\r\n1. A step by step / tutorial-like stuff.\r\n2. Better organize the growing reference for better navigation, etc.\r\n3. Some real world examples.\r\n\r\n## Big Topics\r\n\r\n* New, significant capabilities.\r\n* Need work to define the concept or reach a solid API design.\r\n* Potentially have a system-wide effect.\r\n\r\n- [ ] Asynchronous RM_Call support (#7992)\r\n- [ ] An API to query command flags. This should be done in tandem with improved command introspection, like #7297 and can also provide help as described in #4175 and an alternative to #3700 (#7991)\r\n- [ ] I/O APIs for use cases such as encryption or compression of AOF/RDB files, streaming files directly to and from non-file sink or source\r\n- [x] RESP3 Support (#6860, No. 1) (#8521, #9202)\r\n- [x] Opt-in ACL support for modules\r\n- [ ] APIs to extend ACLs and built-in users (#8329)\r\n- [ ] Better support for ACL and module commands (categories?)\r\n- [ ] A way for in-place upgrade of a module (old version pass state to new version)\r\n\r\n## Native Key Access\r\n\r\n* Provide better coverage for accessing native Redis data types.\r\n* We should not try to cover all *commands* and just provide the necessary primitives.\r\n\r\n- [x] Streams support as a native type (#5760)\r\n- [ ] Missing hash functions:\r\n    - [x] `RM_HashDel` (using `RM_HashSet` with `REDISMODULE_HASH_DELETE`).\r\n    - [x] `RM_HashLen` (using `RM_ValueLength`).\r\n    - [ ] Field iteration API, similar to the one provided by sorted sets.\r\n- [x] Missing list functions (see #8439):\r\n    - [ ] `RM_ListGet`\r\n    - [ ] `RM_ListInsert`\r\n    - [x] `RM_ListLen` (using `RM_ValueLength`).\r\n    - [ ] `RM_ListRemove`\r\n    - [ ] `RM_ListSet`\r\n    - [ ] Iteration API\r\n- [ ] Missing set functions:\r\n    - [ ] `RM_SetAdd`\r\n    - [ ] `RM_SetCard`\r\n    - [ ] `RM_SetIsMember`\r\n    - [ ] `RM_SetRemove`\r\n    - [ ] Iteration API\r\n- [ ] Optimize the API to provide zero-copy (but safe) access to elements. see #8473\r\n\r\n## Minor Improvements / Fixes\r\n\r\n* Need some level of API design or decision making.\r\n* Impact has a limited scope.\r\n\r\n- [ ] Module Pub/Sub subscribe support (#7298)\r\n- [x] `RM_HashSet` return code is ambigious (#6914)\r\n- [ ] All variadic API functions should also have a non-variadic version (#7860)\r\n- [ ] Support opt-in keyspace notification on native data type access (#6544)\r\n- [ ] Better way to handle `RM_BlockClient` when called in a context that does not allow that (#5567)\r\n- [x] Add samples support to mem_usage callback (#4177)\r\n- [ ] Module command validation step for better `MULTI/EXEC` handling (#3635)\r\n- [x] Add `RM_KeyExists` function (#6860, No. 11)\r\n- [ ] Additional hooks: Before fork, before keyspace iteration on main thread, before/after AOF rewrite to allow aux data storage (#7350, #6860 No. 12+13))\r\n- [ ] Extend defrag API to handle late-defrag of globals and defrag of RAX structures.\r\n- [ ] Create more unit tests to improve module API coverage\r\n- [x] Graduate from experimental API some of the stuff (#6860, No. 4)\r\n\r\n## Trivial\r\n\r\n- [ ] Optimize network usage when `REDISMODULE_POSTPONED_ARRAY_LEN` is used (#6444)\r\n- [ ] `SendClusterMessage` crashes thread safe context (#5500)\r\n- [ ] Get hash slots for a Cluster Node (#5371)\r\n- [ ] Concurrent `MODULE UNLOAD` and a module command in `MULTI/EXEC` will crash (#4826)\r\n- [ ] Provide module file name in `MODULE LIST` (#4413)\r\n- [x] Fix `RM_StringTruncate()` with a zero length which currently does nothing, or document the otherwise unexpected behavior (#3717)\r\n- [ ] Fix `RM_WrongArity()` crash on thread safe context (#4756)\r\n- [ ] Add `NOTIFY_MODULE` (Need to better understand the use case) (#6963)\r\n- [ ] Fix `RM_BlockClient` misuse leading to crashes (#4366)\r\n- [x] Optimize `RM_Call` by recycling a single client (#4623)\r\n- [ ] Refuse to load a module without `aof_rewrite` callback if preamble is disabled, or disable preamble if such modules are loaded\r\n\r\n# Module API V2 and beyond\r\n\r\nBig things beyond the current Module API V1 effort.\r\n\r\n- [ ] Expose event loop for arbitrary file descriptor I/O (#4158)\r\n- [ ] Expose the connection abstraction layer to allow modules to do arbitrary TCP and TLS\r\n","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/8157/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/redis/redis/issues/8157/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":4200970906,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQyMDA5NzA5MDY=","url":"https://api.github.com/repos/redis/redis/issues/events/4200970906","actor":{"login":"guybe7","id":19590683,"node_id":"MDQ6VXNlcjE5NTkwNjgz","avatar_url":"https://avatars.githubusercontent.com/u/19590683?v=4","gravatar_id":"","url":"https://api.github.com/users/guybe7","html_url":"https://github.com/guybe7","followers_url":"https://api.github.com/users/guybe7/followers","following_url":"https://api.github.com/users/guybe7/following{/other_user}","gists_url":"https://api.github.com/users/guybe7/gists{/gist_id}","starred_url":"https://api.github.com/users/guybe7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guybe7/subscriptions","organizations_url":"https://api.github.com/users/guybe7/orgs","repos_url":"https://api.github.com/users/guybe7/repos","events_url":"https://api.github.com/users/guybe7/events{/privacy}","received_events_url":"https://api.github.com/users/guybe7/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"5462e85a154b8a7d0fc02954ef749118b51978e8","commit_url":"https://api.github.com/repos/guybe7/redis/commits/5462e85a154b8a7d0fc02954ef749118b51978e8","created_at":"2021-01-13T12:28:02Z","performed_via_github_app":null},{"actor":{"login":"guybe7","id":19590683,"node_id":"MDQ6VXNlcjE5NTkwNjgz","avatar_url":"https://avatars.githubusercontent.com/u/19590683?v=4","gravatar_id":"","url":"https://api.github.com/users/guybe7","html_url":"https://github.com/guybe7","followers_url":"https://api.github.com/users/guybe7/followers","following_url":"https://api.github.com/users/guybe7/following{/other_user}","gists_url":"https://api.github.com/users/guybe7/gists{/gist_id}","starred_url":"https://api.github.com/users/guybe7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guybe7/subscriptions","organizations_url":"https://api.github.com/users/guybe7/orgs","repos_url":"https://api.github.com/users/guybe7/repos","events_url":"https://api.github.com/users/guybe7/events{/privacy}","received_events_url":"https://api.github.com/users/guybe7/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-01-13T12:28:22Z","updated_at":"2021-01-13T12:28:22Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/redis/redis/issues/8324","repository_url":"https://api.github.com/repos/redis/redis","labels_url":"https://api.github.com/repos/redis/redis/issues/8324/labels{/name}","comments_url":"https://api.github.com/repos/redis/redis/issues/8324/comments","events_url":"https://api.github.com/repos/redis/redis/issues/8324/events","html_url":"https://github.com/redis/redis/pull/8324","id":785063135,"node_id":"MDExOlB1bGxSZXF1ZXN0NTU0MTUwNzg1","number":8324,"title":"A better approach for COMMAND INFO for movablekeys commands","user":{"login":"guybe7","id":19590683,"node_id":"MDQ6VXNlcjE5NTkwNjgz","avatar_url":"https://avatars.githubusercontent.com/u/19590683?v=4","gravatar_id":"","url":"https://api.github.com/users/guybe7","html_url":"https://github.com/guybe7","followers_url":"https://api.github.com/users/guybe7/followers","following_url":"https://api.github.com/users/guybe7/following{/other_user}","gists_url":"https://api.github.com/users/guybe7/gists{/gist_id}","starred_url":"https://api.github.com/users/guybe7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guybe7/subscriptions","organizations_url":"https://api.github.com/users/guybe7/orgs","repos_url":"https://api.github.com/users/guybe7/repos","events_url":"https://api.github.com/users/guybe7/events{/privacy}","received_events_url":"https://api.github.com/users/guybe7/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2215206194,"node_id":"MDU6TGFiZWwyMjE1MjA2MTk0","url":"https://api.github.com/repos/redis/redis/labels/state:needs-doc-pr","name":"state:needs-doc-pr","color":"d8bc31","default":false,"description":"requires a PR to redis-doc repository"},{"id":2215208094,"node_id":"MDU6TGFiZWwyMjE1MjA4MDk0","url":"https://api.github.com/repos/redis/redis/labels/state:to-be-merged","name":"state:to-be-merged","color":"5585f4","default":false,"description":"The PR should be merged soon, even if not yet ready, this is used so that it won't be forgotten"},{"id":2215208801,"node_id":"MDU6TGFiZWwyMjE1MjA4ODAx","url":"https://api.github.com/repos/redis/redis/labels/state:major-decision","name":"state:major-decision","color":"44f221","default":false,"description":"Requires core team consensus"},{"id":2219859425,"node_id":"MDU6TGFiZWwyMjE5ODU5NDI1","url":"https://api.github.com/repos/redis/redis/labels/release-notes","name":"release-notes","color":"b60205","default":false,"description":"indication that this issue needs to be mentioned in the release notes"},{"id":2572777300,"node_id":"MDU6TGFiZWwyNTcyNzc3MzAw","url":"https://api.github.com/repos/redis/redis/labels/approval-needed","name":"approval-needed","color":"ef1a33","default":false,"description":"Waiting for core team approval to be merged"}],"state":"closed","locked":false,"assignee":{"login":"guybe7","id":19590683,"node_id":"MDQ6VXNlcjE5NTkwNjgz","avatar_url":"https://avatars.githubusercontent.com/u/19590683?v=4","gravatar_id":"","url":"https://api.github.com/users/guybe7","html_url":"https://github.com/guybe7","followers_url":"https://api.github.com/users/guybe7/followers","following_url":"https://api.github.com/users/guybe7/following{/other_user}","gists_url":"https://api.github.com/users/guybe7/gists{/gist_id}","starred_url":"https://api.github.com/users/guybe7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guybe7/subscriptions","organizations_url":"https://api.github.com/users/guybe7/orgs","repos_url":"https://api.github.com/users/guybe7/repos","events_url":"https://api.github.com/users/guybe7/events{/privacy}","received_events_url":"https://api.github.com/users/guybe7/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"guybe7","id":19590683,"node_id":"MDQ6VXNlcjE5NTkwNjgz","avatar_url":"https://avatars.githubusercontent.com/u/19590683?v=4","gravatar_id":"","url":"https://api.github.com/users/guybe7","html_url":"https://github.com/guybe7","followers_url":"https://api.github.com/users/guybe7/followers","following_url":"https://api.github.com/users/guybe7/following{/other_user}","gists_url":"https://api.github.com/users/guybe7/gists{/gist_id}","starred_url":"https://api.github.com/users/guybe7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guybe7/subscriptions","organizations_url":"https://api.github.com/users/guybe7/orgs","repos_url":"https://api.github.com/users/guybe7/repos","events_url":"https://api.github.com/users/guybe7/events{/privacy}","received_events_url":"https://api.github.com/users/guybe7/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/redis/redis/milestones/10","html_url":"https://github.com/redis/redis/milestone/10","labels_url":"https://api.github.com/repos/redis/redis/milestones/10/labels","id":5683881,"node_id":"MDk6TWlsZXN0b25lNTY4Mzg4MQ==","number":10,"title":"Next minor backlog","description":"","creator":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":37,"closed_issues":46,"state":"open","created_at":"2020-07-21T07:39:22Z","updated_at":"2025-10-28T08:50:19Z","due_on":null,"closed_at":null},"comments":17,"created_at":"2021-01-13T12:28:22Z","updated_at":"2022-01-24T07:54:49Z","closed_at":"2021-09-15T08:10:29Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":156018,"node_id":"MDEwOlJlcG9zaXRvcnkxNTYwMTg=","name":"redis","full_name":"redis/redis","private":false,"owner":{"login":"redis","id":1529926,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1Mjk5MjY=","avatar_url":"https://avatars.githubusercontent.com/u/1529926?v=4","gravatar_id":"","url":"https://api.github.com/users/redis","html_url":"https://github.com/redis","followers_url":"https://api.github.com/users/redis/followers","following_url":"https://api.github.com/users/redis/following{/other_user}","gists_url":"https://api.github.com/users/redis/gists{/gist_id}","starred_url":"https://api.github.com/users/redis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/redis/subscriptions","organizations_url":"https://api.github.com/users/redis/orgs","repos_url":"https://api.github.com/users/redis/repos","events_url":"https://api.github.com/users/redis/events{/privacy}","received_events_url":"https://api.github.com/users/redis/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/redis/redis","description":"For developers, who are building real-time data-driven applications, Redis is the preferred, fastest, and most feature-rich cache, data structure server, and document and vector query engine.","fork":false,"url":"https://api.github.com/repos/redis/redis","forks_url":"https://api.github.com/repos/redis/redis/forks","keys_url":"https://api.github.com/repos/redis/redis/keys{/key_id}","collaborators_url":"https://api.github.com/repos/redis/redis/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/redis/redis/teams","hooks_url":"https://api.github.com/repos/redis/redis/hooks","issue_events_url":"https://api.github.com/repos/redis/redis/issues/events{/number}","events_url":"https://api.github.com/repos/redis/redis/events","assignees_url":"https://api.github.com/repos/redis/redis/assignees{/user}","branches_url":"https://api.github.com/repos/redis/redis/branches{/branch}","tags_url":"https://api.github.com/repos/redis/redis/tags","blobs_url":"https://api.github.com/repos/redis/redis/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/redis/redis/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/redis/redis/git/refs{/sha}","trees_url":"https://api.github.com/repos/redis/redis/git/trees{/sha}","statuses_url":"https://api.github.com/repos/redis/redis/statuses/{sha}","languages_url":"https://api.github.com/repos/redis/redis/languages","stargazers_url":"https://api.github.com/repos/redis/redis/stargazers","contributors_url":"https://api.github.com/repos/redis/redis/contributors","subscribers_url":"https://api.github.com/repos/redis/redis/subscribers","subscription_url":"https://api.github.com/repos/redis/redis/subscription","commits_url":"https://api.github.com/repos/redis/redis/commits{/sha}","git_commits_url":"https://api.github.com/repos/redis/redis/git/commits{/sha}","comments_url":"https://api.github.com/repos/redis/redis/comments{/number}","issue_comment_url":"https://api.github.com/repos/redis/redis/issues/comments{/number}","contents_url":"https://api.github.com/repos/redis/redis/contents/{+path}","compare_url":"https://api.github.com/repos/redis/redis/compare/{base}...{head}","merges_url":"https://api.github.com/repos/redis/redis/merges","archive_url":"https://api.github.com/repos/redis/redis/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/redis/redis/downloads","issues_url":"https://api.github.com/repos/redis/redis/issues{/number}","pulls_url":"https://api.github.com/repos/redis/redis/pulls{/number}","milestones_url":"https://api.github.com/repos/redis/redis/milestones{/number}","notifications_url":"https://api.github.com/repos/redis/redis/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/redis/redis/labels{/name}","releases_url":"https://api.github.com/repos/redis/redis/releases{/id}","deployments_url":"https://api.github.com/repos/redis/redis/deployments","created_at":"2009-03-21T22:32:25Z","updated_at":"2025-11-10T01:47:26Z","pushed_at":"2025-11-09T07:49:54Z","git_url":"git://github.com/redis/redis.git","ssh_url":"git@github.com:redis/redis.git","clone_url":"https://github.com/redis/redis.git","svn_url":"https://github.com/redis/redis","homepage":"http://redis.io","size":204997,"stargazers_count":71629,"watchers_count":71629,"language":"C","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":24316,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2706,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["cache","caching","database","distributed-systems","in-memory","in-memory-database","json","key-value","key-value-store","message-broker","message-queue","no-sql","nosql","open-source","real-time","realtime","redis","time-series","vector-databases","vector-search"],"visibility":"public","forks":24316,"open_issues":2706,"watchers":71629,"default_branch":"unstable","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/redis/redis/pulls/8324","html_url":"https://github.com/redis/redis/pull/8324","diff_url":"https://github.com/redis/redis/pull/8324.diff","patch_url":"https://github.com/redis/redis/pull/8324.patch","merged_at":"2021-09-15T08:10:29Z"},"body":"Edit: the interfaces here later changed, see #10056\r\n\r\nFix #7297\r\n\r\nThe problem:\r\n\r\nToday, there is no way for a client library or app to know the key name indexes for commands such as ZUNIONSTORE/EVAL and others with \"numkeys\", since COMMAND INFO returns no useful info for them.\r\n\r\nFor cluster-aware redis clients, this requires to 'patch' the client library code specifically for each of these commands or to resolve each execution of these commands with COMMAND GETKEYS.\r\n\r\nThe solution:\r\n\r\nIntroducing key specs other than the legacy \"range\" (first,last,step)\r\n\r\nThe 8th element of the command info array, if exists, holds an array of key specs. The array may be empty, which indicates the command doesn't take any key arguments or may contain one or more key-specs, each one may leads to the discovery of 0 or more key arguments.\r\n\r\nA client library that doesn't support this key-spec feature will keep using the first,last,step and movablekeys flag which will obviously remain unchanged.\r\n\r\nA client that supports this key-specs feature needs only to look at the key-specs array. If it finds an unrecognized spec, it must resort to using COMMAND GETKEYS if it wishes to get all key name arguments, but if all it needs is one key in order to know which cluster node to use, then maybe another spec (if the command has several) can supply that, and there's no need to use GETKEYS.\r\n\r\nEach spec is an array of arguments, first one is the spec name, the second is an array of flags, and the third is an array containing details about the spec (specific meaning for each spec type)\r\nThe initial flags we support are \"read\" and \"write\" indicating if the keys that this key-spec finds are used for read or for write. clients should ignore any unfamiliar flags.\r\n\r\nIn order to easily find the positions of keys in a given array of args we introduce keys specs. There are two logical steps of key specs:\r\n1. `start_search`: Given an array of args, indicate where we should start searching for keys\r\n2. `find_keys`: Given the output of start_search and an array of args, indicate all possible indices of keys.\r\n\r\n### start_search step specs\r\n- `index`: specify an argument index explicitly\r\n  - `index`: 0 based index (1 means the first command argument)\r\n- `keyword`: specify a string to match in `argv`. We should start searching for keys just after the keyword appears.\r\n  - `keyword`: the string to search for\r\n  - `start_search`: an index from which to start the keyword search (can be negative, which means to search from the end)\r\n\r\nExamples:\r\n- `SET` has start_search of type `index` with value `1`\r\n- `XREAD` has start_search of type `keyword` with value `[STREAMS,1]`\r\n- `MIGRATE` has start_search of type `keyword` with value `[KEYS,-2]`\r\n\r\n### find_keys step specs\r\n- `range`: specify `[count, step, limit]`.\r\n  - `lastkey`: index of the last key. relative to the index returned from begin_search. -1 indicating till the last argument, -2 one before the last\r\n  - `step`: how many args should we skip after finding a key, in order to find the next one\r\n  - `limit`: if count is -1, we use limit to stop the search by a factor. 0 and 1 mean no limit. 2 means  of the remaining args, 3 means , and so on.\r\n- keynum: specify `[keynum_index, first_key_index, step]`.\r\n  - `keynum_index`: is relative to the return of the `start_search` spec.\r\n  - `first_key_index`: is relative to `keynum_index`.\r\n  - `step`: how many args should we skip after finding a key, in order to find the next one\r\n\r\nExamples:\r\n- `SET` has `range` of `[0,1,0]`\r\n- `MSET` has `range` of `[-1,2,0]`\r\n- `XREAD` has `range` of `[-1,1,2]`\r\n- `ZUNION` has `start_search` of type `index` with value `1` and `find_keys` of type `keynum` with value `[0,1,1]`\r\n- `AI.DAGRUN` has `start_search` of type `keyword` with value `[LOAD,1]` and `find_keys` of type `keynum` with value `[0,1,1]` (see https://oss.redislabs.com/redisai/master/commands/#aidagrun)\r\n\r\nNote: this solution is not perfect as the module writers can come up with anything, but at least we will be able to find the key args of the vast majority of commands.\r\nIf one of the above specs cant describe the key positions, the module writer can always fall back to the `getkeys-api` option.\r\n\r\nSome keys cannot be found easily (`KEYS` in `MIGRATE`: Imagine the argument for `AUTH` is the string KEYS - we will start searching in the wrong index). \r\nThe guarantee is that the specs may be incomplete (`incomplete` will be specified in the spec to denote that) but we never report false information (assuming the command syntax is correct). \r\nFor `MIGRATE` we start searching from the end - `startfrom=-1` - and if one of the keys is actually called \"keys\" we will report only a subset of all keys - hence the `incomplete` flag.\r\nSome `incomplete` specs can be completely empty (i.e. UNKNOWN begin_search) which should tell the client that COMMAND GETKEYS (or any other way to get the keys) must be used (Example: For `SORT` there is no way to describe the STORE keyword spec, as the word \"store\" can appear anywhere in the command).\r\n\r\nWe will expose these key specs in the `COMMAND` command so that clients can learn, on startup, where the keys are for all commands instead of holding hardcoded tables or use `COMMAND GETKEYS` in runtime.\r\n\r\nComments:\r\n1. Redis doesn't internally use the new specs, they are only used for COMMAND output.\r\n2. In order to support the current COMMAND INFO format (reply array indices 4, 5, 6) we created a synthetic range, called legacy_range, that, if possible, is built according to the new specs.\r\n3. Redis currently uses only getkeys_proc or the legacy_range to get the keys indices (in COMMAND GETKEYS for example).\r\n\r\n\"incomplete\" specs:\r\nthe command we have issues with are MIGRATE, STRALGO, and SORT\r\nfor MIGRATE, because the token KEYS, if exists, must be the last token, we can search in reverse. it one of the keys is actually the string \"keys\" will return just a subset of the keys (hence, it's \"incomplete\")\r\nfor SORT and STRALGO we can use this heuristic (the keys can be anywhere in the command) and therefore we added a key spec that is both \"incomplete\" and of \"unknown type\"\r\n\r\nif a client encounters an \"incomplete\" spec it means that it must find a different way (either COMMAND GETKEYS or have its own parser) to retrieve the keys.\r\nplease note that all commands, apart from the three mentioned above, have \"complete\" key specs","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/8324/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/redis/redis/issues/8324/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":4201112304,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQyMDExMTIzMDQ=","url":"https://api.github.com/repos/redis/redis/issues/events/4201112304","actor":{"login":"guybe7","id":19590683,"node_id":"MDQ6VXNlcjE5NTkwNjgz","avatar_url":"https://avatars.githubusercontent.com/u/19590683?v=4","gravatar_id":"","url":"https://api.github.com/users/guybe7","html_url":"https://github.com/guybe7","followers_url":"https://api.github.com/users/guybe7/followers","following_url":"https://api.github.com/users/guybe7/following{/other_user}","gists_url":"https://api.github.com/users/guybe7/gists{/gist_id}","starred_url":"https://api.github.com/users/guybe7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guybe7/subscriptions","organizations_url":"https://api.github.com/users/guybe7/orgs","repos_url":"https://api.github.com/users/guybe7/repos","events_url":"https://api.github.com/users/guybe7/events{/privacy}","received_events_url":"https://api.github.com/users/guybe7/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e153acf7908feed1de302e4522729f3da7544bcf","commit_url":"https://api.github.com/repos/guybe7/redis/commits/e153acf7908feed1de302e4522729f3da7544bcf","created_at":"2021-01-13T13:03:42Z","performed_via_github_app":null}]