{"url":"https://api.github.com/repos/redis/redis/issues/11868","repository_url":"https://api.github.com/repos/redis/redis","labels_url":"https://api.github.com/repos/redis/redis/issues/11868/labels{/name}","comments_url":"https://api.github.com/repos/redis/redis/issues/11868/comments","events_url":"https://api.github.com/repos/redis/redis/issues/11868/events","html_url":"https://github.com/redis/redis/issues/11868","id":1604872436,"node_id":"I_kwDOAAJhcs5fqGj0","number":11868,"title":"[BUG] [err]: Active defrag in tests/unit/memefficiency.tcl","user":{"login":"rnek0","id":52655832,"node_id":"MDQ6VXNlcjUyNjU1ODMy","avatar_url":"https://avatars.githubusercontent.com/u/52655832?v=4","gravatar_id":"","url":"https://api.github.com/users/rnek0","html_url":"https://github.com/rnek0","followers_url":"https://api.github.com/users/rnek0/followers","following_url":"https://api.github.com/users/rnek0/following{/other_user}","gists_url":"https://api.github.com/users/rnek0/gists{/gist_id}","starred_url":"https://api.github.com/users/rnek0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnek0/subscriptions","organizations_url":"https://api.github.com/users/rnek0/orgs","repos_url":"https://api.github.com/users/rnek0/repos","events_url":"https://api.github.com/users/rnek0/events{/privacy}","received_events_url":"https://api.github.com/users/rnek0/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-03-01T12:22:21Z","updated_at":"2023-03-04T10:54:38Z","closed_at":"2023-03-04T10:54:38Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\nOne test fail\r\n\r\nA short description of the bug.\r\nTesting solo test\r\n[err]: Active defrag in tests/unit/memefficiency.tcl\r\nExpected 38 <= 30 (context: type eval line 113 cmd {assert {$max_latency <= 30}} proc ::test)\r\n\r\n**To reproduce**\r\nTry Make test on last version (wget https://download.redis.io/redis-stable.tar.gz) with tcl8.6\r\n\r\n**Expected behavior**\r\nPass\r\n\r\n**Additional information**\r\n\r\n[84/84 done]: unit/maxmemory (377 seconds)\r\nTesting solo test\r\n[ignore]: Test LPUSH and LPOP on plain nodes over 4GB: large memory flag not provided\r\n[ignore]: Test LINDEX and LINSERT on plain nodes over 4GB: large memory flag not provided\r\n[ignore]: Test LTRIM on plain nodes over 4GB: large memory flag not provided\r\n[ignore]: Test LREM on plain nodes over 4GB: large memory flag not provided\r\n[ignore]: Test LSET on plain nodes over 4GB: large memory flag not provided\r\n[ignore]: Test LMOVE on plain nodes over 4GB: large memory flag not provided\r\n[84/84 done]: list-large-memory (0 seconds)\r\nTesting solo test\r\n[ignore]: SADD, SCARD, SISMEMBER - large data: large memory flag not provided\r\n[84/84 done]: set-large-memory (1 seconds)\r\nTesting solo test\r\n[ignore]: BIT pos larger than UINT_MAX: large memory flag not provided\r\n[ignore]: SETBIT values larger than UINT32_MAX and lzf_compress/lzf_decompress correctly: large memory flag not provided\r\n[84/84 done]: bitops-large-memory (0 seconds)\r\nTesting solo test\r\n[ignore]: XADD one huge field: large memory flag not provided\r\n[ignore]: XADD one huge field - 1: large memory flag not provided\r\n[ignore]: several XADD big fields: large memory flag not provided\r\n[ignore]: single XADD big fields: large memory flag not provided\r\n[ignore]: hash with many big fields: large memory flag not provided\r\n[ignore]: hash with one huge field: large memory flag not provided\r\n[84/84 done]: violations (2 seconds)\r\nTesting solo test\r\n[err]: Active defrag in tests/unit/memefficiency.tcl\r\nExpected 38 <= 30 (context: type eval line 113 cmd {assert {$max_latency <= 30}} proc ::test)\r\n[ok]: Active defrag eval scripts (11348 ms)\r\n[ok]: Active defrag big keys (74509 ms)\r\n[ok]: Active defrag big list (64162 ms)\r\n[ok]: Active defrag edge case (91244 ms)\r\n[84/84 done]: defrag (328 seconds)\r\n\r\n                   The End\r\n\r\nExecution time of different units:\r\n  1 seconds - unit/info-command\r\n  1 seconds - unit/printver\r\n  2 seconds - unit/type/incr\r\n  4 seconds - unit/info\r\n  5 seconds - unit/auth\r\n  6 seconds - unit/keyspace\r\n  8 seconds - unit/protocol\r\n  1 seconds - unit/quit\r\n  11 seconds - unit/type/stream-cgroups\r\n  8 seconds - unit/multi\r\n  3 seconds - unit/acl-v2\r\n  11 seconds - unit/acl\r\n  20 seconds - unit/expire\r\n  31 seconds - unit/type/list\r\n  29 seconds - integration/block-repl\r\n  66 seconds - unit/aofrw\r\n  87 seconds - unit/type/hash\r\n  90 seconds - unit/scan\r\n  103 seconds - unit/type/string\r\n  103 seconds - unit/other\r\n  118 seconds - unit/type/set\r\n  77 seconds - integration/replication-3\r\n  128 seconds - unit/sort\r\n  132 seconds - unit/dump\r\n  48 seconds - integration/shutdown\r\n  22 seconds - integration/corrupt-dump-fuzzer\r\n  5 seconds - integration/convert-zipmap-hash-on-load\r\n  2 seconds - integration/convert-ziplist-hash-on-load\r\n  39 seconds - integration/aof-multi-part\r\n  3 seconds - integration/convert-ziplist-zset-on-load\r\n  4 seconds - integration/logging\r\n  137 seconds - integration/replication-2\r\n  25 seconds - integration/psync2-pingoff\r\n  27 seconds - integration/psync2-reg\r\n  65 seconds - integration/rdb\r\n  10 seconds - integration/failover\r\n  32 seconds - integration/psync2-master-restart\r\n  3 seconds - unit/pubsub\r\n  48 seconds - integration/psync2\r\n  10 seconds - integration/dismiss-mem\r\n  11 seconds - integration/redis-benchmark\r\n  3 seconds - unit/pubsubshard\r\n  3 seconds - unit/slowlog\r\n  86 seconds - integration/corrupt-dump\r\n  11 seconds - unit/functions\r\n  218 seconds - unit/type/list-3\r\n  2 seconds - unit/limits\r\n  131 seconds - integration/replication-buffer\r\n  7 seconds - unit/introspection-2\r\n  211 seconds - unit/latency-monitor\r\n  12 seconds - unit/bitfield\r\n  52 seconds - unit/introspection\r\n  50 seconds - unit/bitops\r\n  162 seconds - integration/aof\r\n  13 seconds - unit/lazyfree\r\n  5 seconds - unit/wait\r\n  3 seconds - unit/pause\r\n  1 seconds - unit/tls\r\n  4 seconds - unit/querybuf\r\n  5 seconds - unit/tracking\r\n  3 seconds - unit/oom-score-adj\r\n  3 seconds - unit/shutdown\r\n  8 seconds - unit/networking\r\n  86 seconds - unit/scripting\r\n  1 seconds - unit/violations\r\n  2 seconds - unit/replybufsize\r\n  3 seconds - unit/cluster-scripting\r\n  70 seconds - unit/memefficiency\r\n  6 seconds - unit/cluster/misc\r\n  6 seconds - unit/cluster/links\r\n  307 seconds - unit/type/list-2\r\n  128 seconds - integration/redis-cli\r\n  34 seconds - unit/cluster\r\n  317 seconds - unit/type/zset\r\n  237 seconds - integration/replication-psync\r\n  64 seconds - unit/pendingquerybuf\r\n  132 seconds - unit/obuf-limits\r\n  277 seconds - integration/replication-4\r\n  69 seconds - unit/client-eviction\r\n  365 seconds - unit/type/stream\r\n  169 seconds - unit/hyperloglog\r\n  306 seconds - unit/geo\r\n  559 seconds - integration/replication\r\n  377 seconds - unit/maxmemory\r\n  0 seconds - list-large-memory\r\n  1 seconds - set-large-memory\r\n  0 seconds - bitops-large-memory\r\n  2 seconds - violations\r\n  328 seconds - defrag\r\n\r\n!!! WARNING The following tests failed:\r\n\r\n*** [err]: Active defrag in tests/unit/memefficiency.tcl\r\nExpected 38 <= 30 (context: type eval line 113 cmd {assert {$max_latency <= 30}} proc ::test)\r\nCleanup: may take some time... OK\r\nmake[1]: *** [Makefile:427: test] Error 1\r\nmake[1]: Leaving directory '/down-redis/redis-stable/src'\r\nmake: *** [Makefile:6: test] Error 2","closed_by":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/redis/redis/issues/11868/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/redis/redis/issues/11868/timeline","performed_via_github_app":null,"state_reason":"completed"}