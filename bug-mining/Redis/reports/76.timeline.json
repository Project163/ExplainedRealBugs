[{"id":7049778331,"node_id":"LE_lADOAAJhcs5OZ0xpzwAAAAGkMxSb","url":"https://api.github.com/repos/redis/redis/issues/events/7049778331","actor":{"login":"enjoy-binbin","id":22811481,"node_id":"MDQ6VXNlcjIyODExNDgx","avatar_url":"https://avatars.githubusercontent.com/u/22811481?v=4","gravatar_id":"","url":"https://api.github.com/users/enjoy-binbin","html_url":"https://github.com/enjoy-binbin","followers_url":"https://api.github.com/users/enjoy-binbin/followers","following_url":"https://api.github.com/users/enjoy-binbin/following{/other_user}","gists_url":"https://api.github.com/users/enjoy-binbin/gists{/gist_id}","starred_url":"https://api.github.com/users/enjoy-binbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/enjoy-binbin/subscriptions","organizations_url":"https://api.github.com/users/enjoy-binbin/orgs","repos_url":"https://api.github.com/users/enjoy-binbin/repos","events_url":"https://api.github.com/users/enjoy-binbin/events{/privacy}","received_events_url":"https://api.github.com/users/enjoy-binbin/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2022-07-23T03:38:20Z","label":{"name":"7.0-must-have","color":"528D20"},"performed_via_github_app":null},{"id":15184068472,"node_id":"PVTISC_lADOAAJhcs5OZ0xpzwAAAAOJCn94","url":"https://api.github.com/repos/redis/redis/issues/events/15184068472","actor":{"login":"enjoy-binbin","id":22811481,"node_id":"MDQ6VXNlcjIyODExNDgx","avatar_url":"https://avatars.githubusercontent.com/u/22811481?v=4","gravatar_id":"","url":"https://api.github.com/users/enjoy-binbin","html_url":"https://github.com/enjoy-binbin","followers_url":"https://api.github.com/users/enjoy-binbin/followers","following_url":"https://api.github.com/users/enjoy-binbin/following{/other_user}","gists_url":"https://api.github.com/users/enjoy-binbin/gists{/gist_id}","starred_url":"https://api.github.com/users/enjoy-binbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/enjoy-binbin/subscriptions","organizations_url":"https://api.github.com/users/enjoy-binbin/orgs","repos_url":"https://api.github.com/users/enjoy-binbin/repos","events_url":"https://api.github.com/users/enjoy-binbin/events{/privacy}","received_events_url":"https://api.github.com/users/enjoy-binbin/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"project_v2_item_status_changed","commit_id":null,"commit_url":null,"created_at":"2022-07-23T03:39:57Z","performed_via_github_app":null},{"id":15229007088,"node_id":"ATPVTE_lADOAAJhcs5OZ0xpzwAAAAOLuDTw","url":"https://api.github.com/repos/redis/redis/issues/events/15229007088","actor":{"login":"enjoy-binbin","id":22811481,"node_id":"MDQ6VXNlcjIyODExNDgx","avatar_url":"https://avatars.githubusercontent.com/u/22811481?v=4","gravatar_id":"","url":"https://api.github.com/users/enjoy-binbin","html_url":"https://github.com/enjoy-binbin","followers_url":"https://api.github.com/users/enjoy-binbin/followers","following_url":"https://api.github.com/users/enjoy-binbin/following{/other_user}","gists_url":"https://api.github.com/users/enjoy-binbin/gists{/gist_id}","starred_url":"https://api.github.com/users/enjoy-binbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/enjoy-binbin/subscriptions","organizations_url":"https://api.github.com/users/enjoy-binbin/orgs","repos_url":"https://api.github.com/users/enjoy-binbin/repos","events_url":"https://api.github.com/users/enjoy-binbin/events{/privacy}","received_events_url":"https://api.github.com/users/enjoy-binbin/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"added_to_project_v2","commit_id":null,"commit_url":null,"created_at":"2022-07-23T03:39:57Z","performed_via_github_app":null},{"id":15193107248,"node_id":"PVTISC_lADOAAJhcs5OZ0xpzwAAAAOJlGsw","url":"https://api.github.com/repos/redis/redis/issues/events/15193107248","actor":{"login":"enjoy-binbin","id":22811481,"node_id":"MDQ6VXNlcjIyODExNDgx","avatar_url":"https://avatars.githubusercontent.com/u/22811481?v=4","gravatar_id":"","url":"https://api.github.com/users/enjoy-binbin","html_url":"https://github.com/enjoy-binbin","followers_url":"https://api.github.com/users/enjoy-binbin/followers","following_url":"https://api.github.com/users/enjoy-binbin/following{/other_user}","gists_url":"https://api.github.com/users/enjoy-binbin/gists{/gist_id}","starred_url":"https://api.github.com/users/enjoy-binbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/enjoy-binbin/subscriptions","organizations_url":"https://api.github.com/users/enjoy-binbin/orgs","repos_url":"https://api.github.com/users/enjoy-binbin/repos","events_url":"https://api.github.com/users/enjoy-binbin/events{/privacy}","received_events_url":"https://api.github.com/users/enjoy-binbin/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"project_v2_item_status_changed","commit_id":null,"commit_url":null,"created_at":"2022-07-23T03:40:10Z","performed_via_github_app":null},{"id":15233446455,"node_id":"ATPVTE_lADOAAJhcs5OZ0xpzwAAAAOL-_I3","url":"https://api.github.com/repos/redis/redis/issues/events/15233446455","actor":{"login":"enjoy-binbin","id":22811481,"node_id":"MDQ6VXNlcjIyODExNDgx","avatar_url":"https://avatars.githubusercontent.com/u/22811481?v=4","gravatar_id":"","url":"https://api.github.com/users/enjoy-binbin","html_url":"https://github.com/enjoy-binbin","followers_url":"https://api.github.com/users/enjoy-binbin/followers","following_url":"https://api.github.com/users/enjoy-binbin/following{/other_user}","gists_url":"https://api.github.com/users/enjoy-binbin/gists{/gist_id}","starred_url":"https://api.github.com/users/enjoy-binbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/enjoy-binbin/subscriptions","organizations_url":"https://api.github.com/users/enjoy-binbin/orgs","repos_url":"https://api.github.com/users/enjoy-binbin/repos","events_url":"https://api.github.com/users/enjoy-binbin/events{/privacy}","received_events_url":"https://api.github.com/users/enjoy-binbin/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"added_to_project_v2","commit_id":null,"commit_url":null,"created_at":"2022-07-23T03:40:10Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/redis/redis/issues/comments/1193060390","html_url":"https://github.com/redis/redis/issues/11030#issuecomment-1193060390","issue_url":"https://api.github.com/repos/redis/redis/issues/11030","id":1193060390,"node_id":"IC_kwDOAAJhcs5HHKgm","user":{"login":"enjoy-binbin","id":22811481,"node_id":"MDQ6VXNlcjIyODExNDgx","avatar_url":"https://avatars.githubusercontent.com/u/22811481?v=4","gravatar_id":"","url":"https://api.github.com/users/enjoy-binbin","html_url":"https://github.com/enjoy-binbin","followers_url":"https://api.github.com/users/enjoy-binbin/followers","following_url":"https://api.github.com/users/enjoy-binbin/following{/other_user}","gists_url":"https://api.github.com/users/enjoy-binbin/gists{/gist_id}","starred_url":"https://api.github.com/users/enjoy-binbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/enjoy-binbin/subscriptions","organizations_url":"https://api.github.com/users/enjoy-binbin/orgs","repos_url":"https://api.github.com/users/enjoy-binbin/repos","events_url":"https://api.github.com/users/enjoy-binbin/events{/privacy}","received_events_url":"https://api.github.com/users/enjoy-binbin/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-23T04:56:41Z","updated_at":"2022-07-23T04:57:08Z","body":"for the record: 6.2.6 is ok (6.2.7 will panic), introduced #10651, calling in a function also will panic","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/1193060390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"enjoy-binbin","id":22811481,"node_id":"MDQ6VXNlcjIyODExNDgx","avatar_url":"https://avatars.githubusercontent.com/u/22811481?v=4","gravatar_id":"","url":"https://api.github.com/users/enjoy-binbin","html_url":"https://github.com/enjoy-binbin","followers_url":"https://api.github.com/users/enjoy-binbin/followers","following_url":"https://api.github.com/users/enjoy-binbin/following{/other_user}","gists_url":"https://api.github.com/users/enjoy-binbin/gists{/gist_id}","starred_url":"https://api.github.com/users/enjoy-binbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/enjoy-binbin/subscriptions","organizations_url":"https://api.github.com/users/enjoy-binbin/orgs","repos_url":"https://api.github.com/users/enjoy-binbin/repos","events_url":"https://api.github.com/users/enjoy-binbin/events{/privacy}","received_events_url":"https://api.github.com/users/enjoy-binbin/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":15198170621,"node_id":"PVTISC_lADOAAJhcs5OZ0xpzwAAAAOJ4a39","url":"https://api.github.com/repos/redis/redis/issues/events/15198170621","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"project_v2_item_status_changed","commit_id":null,"commit_url":null,"created_at":"2022-07-24T05:43:59Z","performed_via_github_app":null},{"id":15235497738,"node_id":"ATPVTE_lADOAAJhcs5OZ0xpzwAAAAOMGz8K","url":"https://api.github.com/repos/redis/redis/issues/events/15235497738","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"added_to_project_v2","commit_id":null,"commit_url":null,"created_at":"2022-07-24T05:43:59Z","performed_via_github_app":null},{"id":7051083253,"node_id":"REFE_lADOAAJhcs5OZ0xpzwAAAAGkRv31","url":"https://api.github.com/repos/redis/redis/issues/events/7051083253","actor":{"login":"MeirShpilraien","id":28348822,"node_id":"MDQ6VXNlcjI4MzQ4ODIy","avatar_url":"https://avatars.githubusercontent.com/u/28348822?v=4","gravatar_id":"","url":"https://api.github.com/users/MeirShpilraien","html_url":"https://github.com/MeirShpilraien","followers_url":"https://api.github.com/users/MeirShpilraien/followers","following_url":"https://api.github.com/users/MeirShpilraien/following{/other_user}","gists_url":"https://api.github.com/users/MeirShpilraien/gists{/gist_id}","starred_url":"https://api.github.com/users/MeirShpilraien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MeirShpilraien/subscriptions","organizations_url":"https://api.github.com/users/MeirShpilraien/orgs","repos_url":"https://api.github.com/users/MeirShpilraien/repos","events_url":"https://api.github.com/users/MeirShpilraien/events{/privacy}","received_events_url":"https://api.github.com/users/MeirShpilraien/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"73ba54ad3c8598fc73f071282153dd41e01c9891","commit_url":"https://api.github.com/repos/MeirShpilraien/redis/commits/73ba54ad3c8598fc73f071282153dd41e01c9891","created_at":"2022-07-24T07:50:29Z","performed_via_github_app":null},{"actor":{"login":"MeirShpilraien","id":28348822,"node_id":"MDQ6VXNlcjI4MzQ4ODIy","avatar_url":"https://avatars.githubusercontent.com/u/28348822?v=4","gravatar_id":"","url":"https://api.github.com/users/MeirShpilraien","html_url":"https://github.com/MeirShpilraien","followers_url":"https://api.github.com/users/MeirShpilraien/followers","following_url":"https://api.github.com/users/MeirShpilraien/following{/other_user}","gists_url":"https://api.github.com/users/MeirShpilraien/gists{/gist_id}","starred_url":"https://api.github.com/users/MeirShpilraien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MeirShpilraien/subscriptions","organizations_url":"https://api.github.com/users/MeirShpilraien/orgs","repos_url":"https://api.github.com/users/MeirShpilraien/repos","events_url":"https://api.github.com/users/MeirShpilraien/events{/privacy}","received_events_url":"https://api.github.com/users/MeirShpilraien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-24T07:51:29Z","updated_at":"2022-07-24T07:51:29Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/redis/redis/issues/11032","repository_url":"https://api.github.com/repos/redis/redis","labels_url":"https://api.github.com/repos/redis/redis/issues/11032/labels{/name}","comments_url":"https://api.github.com/repos/redis/redis/issues/11032/comments","events_url":"https://api.github.com/repos/redis/redis/issues/11032/events","html_url":"https://github.com/redis/redis/pull/11032","id":1315836559,"node_id":"PR_kwDOAAJhcs47_c6_","number":11032,"title":"Fix #11030, use lua_rawget to avoid triggering metatables and crash.","user":{"login":"MeirShpilraien","id":28348822,"node_id":"MDQ6VXNlcjI4MzQ4ODIy","avatar_url":"https://avatars.githubusercontent.com/u/28348822?v=4","gravatar_id":"","url":"https://api.github.com/users/MeirShpilraien","html_url":"https://github.com/MeirShpilraien","followers_url":"https://api.github.com/users/MeirShpilraien/followers","following_url":"https://api.github.com/users/MeirShpilraien/following{/other_user}","gists_url":"https://api.github.com/users/MeirShpilraien/gists{/gist_id}","starred_url":"https://api.github.com/users/MeirShpilraien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MeirShpilraien/subscriptions","organizations_url":"https://api.github.com/users/MeirShpilraien/orgs","repos_url":"https://api.github.com/users/MeirShpilraien/repos","events_url":"https://api.github.com/users/MeirShpilraien/events{/privacy}","received_events_url":"https://api.github.com/users/MeirShpilraien/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2215208801,"node_id":"MDU6TGFiZWwyMjE1MjA4ODAx","url":"https://api.github.com/repos/redis/redis/labels/state:major-decision","name":"state:major-decision","color":"44f221","default":false,"description":"Requires core team consensus"},{"id":2219859425,"node_id":"MDU6TGFiZWwyMjE5ODU5NDI1","url":"https://api.github.com/repos/redis/redis/labels/release-notes","name":"release-notes","color":"b60205","default":false,"description":"indication that this issue needs to be mentioned in the release notes"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-07-24T07:51:29Z","updated_at":"2022-07-26T07:56:57Z","closed_at":"2022-07-26T07:33:51Z","author_association":"NONE","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":156018,"node_id":"MDEwOlJlcG9zaXRvcnkxNTYwMTg=","name":"redis","full_name":"redis/redis","private":false,"owner":{"login":"redis","id":1529926,"node_id":"MDEyOk9yZ2FuaXphdGlvbjE1Mjk5MjY=","avatar_url":"https://avatars.githubusercontent.com/u/1529926?v=4","gravatar_id":"","url":"https://api.github.com/users/redis","html_url":"https://github.com/redis","followers_url":"https://api.github.com/users/redis/followers","following_url":"https://api.github.com/users/redis/following{/other_user}","gists_url":"https://api.github.com/users/redis/gists{/gist_id}","starred_url":"https://api.github.com/users/redis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/redis/subscriptions","organizations_url":"https://api.github.com/users/redis/orgs","repos_url":"https://api.github.com/users/redis/repos","events_url":"https://api.github.com/users/redis/events{/privacy}","received_events_url":"https://api.github.com/users/redis/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/redis/redis","description":"For developers, who are building real-time data-driven applications, Redis is the preferred, fastest, and most feature-rich cache, data structure server, and document and vector query engine.","fork":false,"url":"https://api.github.com/repos/redis/redis","forks_url":"https://api.github.com/repos/redis/redis/forks","keys_url":"https://api.github.com/repos/redis/redis/keys{/key_id}","collaborators_url":"https://api.github.com/repos/redis/redis/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/redis/redis/teams","hooks_url":"https://api.github.com/repos/redis/redis/hooks","issue_events_url":"https://api.github.com/repos/redis/redis/issues/events{/number}","events_url":"https://api.github.com/repos/redis/redis/events","assignees_url":"https://api.github.com/repos/redis/redis/assignees{/user}","branches_url":"https://api.github.com/repos/redis/redis/branches{/branch}","tags_url":"https://api.github.com/repos/redis/redis/tags","blobs_url":"https://api.github.com/repos/redis/redis/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/redis/redis/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/redis/redis/git/refs{/sha}","trees_url":"https://api.github.com/repos/redis/redis/git/trees{/sha}","statuses_url":"https://api.github.com/repos/redis/redis/statuses/{sha}","languages_url":"https://api.github.com/repos/redis/redis/languages","stargazers_url":"https://api.github.com/repos/redis/redis/stargazers","contributors_url":"https://api.github.com/repos/redis/redis/contributors","subscribers_url":"https://api.github.com/repos/redis/redis/subscribers","subscription_url":"https://api.github.com/repos/redis/redis/subscription","commits_url":"https://api.github.com/repos/redis/redis/commits{/sha}","git_commits_url":"https://api.github.com/repos/redis/redis/git/commits{/sha}","comments_url":"https://api.github.com/repos/redis/redis/comments{/number}","issue_comment_url":"https://api.github.com/repos/redis/redis/issues/comments{/number}","contents_url":"https://api.github.com/repos/redis/redis/contents/{+path}","compare_url":"https://api.github.com/repos/redis/redis/compare/{base}...{head}","merges_url":"https://api.github.com/repos/redis/redis/merges","archive_url":"https://api.github.com/repos/redis/redis/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/redis/redis/downloads","issues_url":"https://api.github.com/repos/redis/redis/issues{/number}","pulls_url":"https://api.github.com/repos/redis/redis/pulls{/number}","milestones_url":"https://api.github.com/repos/redis/redis/milestones{/number}","notifications_url":"https://api.github.com/repos/redis/redis/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/redis/redis/labels{/name}","releases_url":"https://api.github.com/repos/redis/redis/releases{/id}","deployments_url":"https://api.github.com/repos/redis/redis/deployments","created_at":"2009-03-21T22:32:25Z","updated_at":"2025-11-10T01:47:26Z","pushed_at":"2025-11-09T07:49:54Z","git_url":"git://github.com/redis/redis.git","ssh_url":"git@github.com:redis/redis.git","clone_url":"https://github.com/redis/redis.git","svn_url":"https://github.com/redis/redis","homepage":"http://redis.io","size":204997,"stargazers_count":71629,"watchers_count":71629,"language":"C","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":24316,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2706,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["cache","caching","database","distributed-systems","in-memory","in-memory-database","json","key-value","key-value-store","message-broker","message-queue","no-sql","nosql","open-source","real-time","realtime","redis","time-series","vector-databases","vector-search"],"visibility":"public","forks":24316,"open_issues":2706,"watchers":71629,"default_branch":"unstable","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/redis/redis/pulls/11032","html_url":"https://github.com/redis/redis/pull/11032","diff_url":"https://github.com/redis/redis/pull/11032.diff","patch_url":"https://github.com/redis/redis/pull/11032.patch","merged_at":"2022-07-26T07:33:51Z"},"body":"Fix #11030, use lua_rawget to avoid triggering metatables.\r\n\r\n#11030 shows how return `_G` from the Lua script (either function or eval), cause the Lua interpreter to Panic and the Redis processes to exit with error code 1. Though return `_G` only panic on Redis 7 and 6.2.7, the underline issue exists on older versions as well (6.0 and 6.2). The underline issue is returning a table with a metatable such that the metatable raises an error.\r\n\r\nThe following example demonstrate the issue:\r\n```\r\n127.0.0.1:6379> eval \"local a = {}; setmetatable(a,{__index=function() foo() end}) return a\" 0\r\nError: Server closed the connection\r\n```\r\n```\r\nPANIC: unprotected error in call to Lua API (user_script:1: Script attempted to access nonexistent global variable 'foo')\r\n```\r\n\r\nThe Lua panic happened because when returning the result to the client, Redis needs to introspect the returning table and transform the table into a resp. In order to scan the table, Redis uses `lua_gettable` api which might trigger the metatable (if exists) and might raise an error. This code is not running inside `pcall` (Lua protected call), so raising an error causes the Lua to panic and exit. Notice that this is not a crash, its a Lua panic that exit with error code 1.\r\n\r\nReturning `_G` panics on Redis 7 and 6.2.7 because on those versions `_G` has a metatable that raises error when trying to fetch a none existing key.\r\n\r\n### Solution\r\n\r\nInstead of using `lua_gettable` that might raise error and cause the issue, use `lua_rawget` that simply return the value from the table without triggering any metatable logic. This is promised not to raise and error.\r\n\r\nThe downside of this solution is that it might be considered as breaking change, if someone rely on metatable in the returned value. An alternative solution is to wrap this entire logic with `pcall` (Lua protected call), this alternative require a much bigger refactoring. We need to decide if we believe its actually a breaking change or is it something that we can accept (@yossigo @oranagra @madolson FYI).\r\n\r\n### Back Porting\r\n\r\nThe same fix will work on older versions as well (6.2, 6.0). Notice that on those version, the issue can cause Redis to crash if inside the metatable logic there is an attempt to accesses Redis (`redis.call`). On 7.0, there is not crash and the `redis.call` is executed as if it was done from inside the script itself.\r\n\r\n### Tests\r\n\r\nTests was added the verify the fix\r\n","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/11032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/redis/redis/issues/11032/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/redis/redis/issues/comments/1193266859","html_url":"https://github.com/redis/redis/issues/11030#issuecomment-1193266859","issue_url":"https://api.github.com/repos/redis/redis/issues/11030","id":1193266859,"node_id":"IC_kwDOAAJhcs5HH86r","user":{"login":"MeirShpilraien","id":28348822,"node_id":"MDQ6VXNlcjI4MzQ4ODIy","avatar_url":"https://avatars.githubusercontent.com/u/28348822?v=4","gravatar_id":"","url":"https://api.github.com/users/MeirShpilraien","html_url":"https://github.com/MeirShpilraien","followers_url":"https://api.github.com/users/MeirShpilraien/followers","following_url":"https://api.github.com/users/MeirShpilraien/following{/other_user}","gists_url":"https://api.github.com/users/MeirShpilraien/gists{/gist_id}","starred_url":"https://api.github.com/users/MeirShpilraien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MeirShpilraien/subscriptions","organizations_url":"https://api.github.com/users/MeirShpilraien/orgs","repos_url":"https://api.github.com/users/MeirShpilraien/repos","events_url":"https://api.github.com/users/MeirShpilraien/events{/privacy}","received_events_url":"https://api.github.com/users/MeirShpilraien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-07-24T07:52:45Z","updated_at":"2022-07-24T07:52:45Z","body":"@pragus Thanks reporting, already open a PR that will fix it: https://github.com/redis/redis/pull/11032.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/redis/redis/issues/comments/1193266859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"MeirShpilraien","id":28348822,"node_id":"MDQ6VXNlcjI4MzQ4ODIy","avatar_url":"https://avatars.githubusercontent.com/u/28348822?v=4","gravatar_id":"","url":"https://api.github.com/users/MeirShpilraien","html_url":"https://github.com/MeirShpilraien","followers_url":"https://api.github.com/users/MeirShpilraien/followers","following_url":"https://api.github.com/users/MeirShpilraien/following{/other_user}","gists_url":"https://api.github.com/users/MeirShpilraien/gists{/gist_id}","starred_url":"https://api.github.com/users/MeirShpilraien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MeirShpilraien/subscriptions","organizations_url":"https://api.github.com/users/MeirShpilraien/orgs","repos_url":"https://api.github.com/users/MeirShpilraien/repos","events_url":"https://api.github.com/users/MeirShpilraien/events{/privacy}","received_events_url":"https://api.github.com/users/MeirShpilraien/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":7051085921,"node_id":"MEE_lADOAAJhcs5OZ0xpzwAAAAGkRwhh","url":"https://api.github.com/repos/redis/redis/issues/events/7051085921","actor":{"login":"pragus","id":25162653,"node_id":"MDQ6VXNlcjI1MTYyNjUz","avatar_url":"https://avatars.githubusercontent.com/u/25162653?v=4","gravatar_id":"","url":"https://api.github.com/users/pragus","html_url":"https://github.com/pragus","followers_url":"https://api.github.com/users/pragus/followers","following_url":"https://api.github.com/users/pragus/following{/other_user}","gists_url":"https://api.github.com/users/pragus/gists{/gist_id}","starred_url":"https://api.github.com/users/pragus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pragus/subscriptions","organizations_url":"https://api.github.com/users/pragus/orgs","repos_url":"https://api.github.com/users/pragus/repos","events_url":"https://api.github.com/users/pragus/events{/privacy}","received_events_url":"https://api.github.com/users/pragus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2022-07-24T07:52:45Z","performed_via_github_app":null},{"id":7051085924,"node_id":"SE_lADOAAJhcs5OZ0xpzwAAAAGkRwhk","url":"https://api.github.com/repos/redis/redis/issues/events/7051085924","actor":{"login":"pragus","id":25162653,"node_id":"MDQ6VXNlcjI1MTYyNjUz","avatar_url":"https://avatars.githubusercontent.com/u/25162653?v=4","gravatar_id":"","url":"https://api.github.com/users/pragus","html_url":"https://github.com/pragus","followers_url":"https://api.github.com/users/pragus/followers","following_url":"https://api.github.com/users/pragus/following{/other_user}","gists_url":"https://api.github.com/users/pragus/gists{/gist_id}","starred_url":"https://api.github.com/users/pragus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pragus/subscriptions","organizations_url":"https://api.github.com/users/pragus/orgs","repos_url":"https://api.github.com/users/pragus/repos","events_url":"https://api.github.com/users/pragus/events{/privacy}","received_events_url":"https://api.github.com/users/pragus/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2022-07-24T07:52:45Z","performed_via_github_app":null},{"id":15176743070,"node_id":"RFPVTE_lADOAAJhcs5OZ0xpzwAAAAOImrie","url":"https://api.github.com/repos/redis/redis/issues/events/15176743070","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"removed_from_project_v2","commit_id":null,"commit_url":null,"created_at":"2022-07-24T08:05:33Z","performed_via_github_app":null},{"id":15179005691,"node_id":"RFPVTE_lADOAAJhcs5OZ0xpzwAAAAOIvT77","url":"https://api.github.com/repos/redis/redis/issues/events/15179005691","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"removed_from_project_v2","commit_id":null,"commit_url":null,"created_at":"2022-07-24T08:05:33Z","performed_via_github_app":null},{"id":15177011761,"node_id":"RFPVTE_lADOAAJhcs5OZ0xpzwAAAAOIntIx","url":"https://api.github.com/repos/redis/redis/issues/events/15177011761","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"removed_from_project_v2","commit_id":null,"commit_url":null,"created_at":"2022-07-24T08:05:34Z","performed_via_github_app":null},{"id":7062378792,"node_id":"CE_lADOAAJhcs5OZ0xpzwAAAAGk81ko","url":"https://api.github.com/repos/redis/redis/issues/events/7062378792","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2022-07-26T07:33:52Z","state_reason":null,"performed_via_github_app":null},{"id":7062379778,"node_id":"REFE_lADOAAJhcs5OZ0xpzwAAAAGk810C","url":"https://api.github.com/repos/redis/redis/issues/events/7062379778","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"020e046b4210f64a614d7ec51b4ee09f746e5350","commit_url":"https://api.github.com/repos/redis/redis/commits/020e046b4210f64a614d7ec51b4ee09f746e5350","created_at":"2022-07-26T07:34:01Z","performed_via_github_app":null},{"id":7433811549,"node_id":"REFE_lADOAAJhcs5OZ0xpzwAAAAG7FvZd","url":"https://api.github.com/repos/redis/redis/issues/events/7433811549","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ddf1bcf788c81b6b89d4c2949a437633fea09f91","commit_url":"https://api.github.com/repos/redis/redis/commits/ddf1bcf788c81b6b89d4c2949a437633fea09f91","created_at":"2022-09-21T19:42:07Z","performed_via_github_app":null},{"id":8015195323,"node_id":"REFE_lADOAAJhcs5OZ0xpzwAAAAHdviy7","url":"https://api.github.com/repos/redis/redis/issues/events/8015195323","actor":{"login":"oranagra","id":7045099,"node_id":"MDQ6VXNlcjcwNDUwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/7045099?v=4","gravatar_id":"","url":"https://api.github.com/users/oranagra","html_url":"https://github.com/oranagra","followers_url":"https://api.github.com/users/oranagra/followers","following_url":"https://api.github.com/users/oranagra/following{/other_user}","gists_url":"https://api.github.com/users/oranagra/gists{/gist_id}","starred_url":"https://api.github.com/users/oranagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oranagra/subscriptions","organizations_url":"https://api.github.com/users/oranagra/orgs","repos_url":"https://api.github.com/users/oranagra/repos","events_url":"https://api.github.com/users/oranagra/events{/privacy}","received_events_url":"https://api.github.com/users/oranagra/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e1b17f1232cb5c17a91442227e1fc6074c3eb09b","commit_url":"https://api.github.com/repos/redis/redis/commits/e1b17f1232cb5c17a91442227e1fc6074c3eb09b","created_at":"2022-12-12T15:03:32Z","performed_via_github_app":null},{"id":8982296743,"node_id":"REFE_lADOAAJhcs5OZ0xpzwAAAAIXYvin","url":"https://api.github.com/repos/redis/redis/issues/events/8982296743","actor":{"login":"Mixficsol","id":73943232,"node_id":"MDQ6VXNlcjczOTQzMjMy","avatar_url":"https://avatars.githubusercontent.com/u/73943232?v=4","gravatar_id":"","url":"https://api.github.com/users/Mixficsol","html_url":"https://github.com/Mixficsol","followers_url":"https://api.github.com/users/Mixficsol/followers","following_url":"https://api.github.com/users/Mixficsol/following{/other_user}","gists_url":"https://api.github.com/users/Mixficsol/gists{/gist_id}","starred_url":"https://api.github.com/users/Mixficsol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mixficsol/subscriptions","organizations_url":"https://api.github.com/users/Mixficsol/orgs","repos_url":"https://api.github.com/users/Mixficsol/repos","events_url":"https://api.github.com/users/Mixficsol/events{/privacy}","received_events_url":"https://api.github.com/users/Mixficsol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"6c62e43e39c22bfb8edb296acf5bb4c9152eb9d2","commit_url":"https://api.github.com/repos/Mixficsol/redis/commits/6c62e43e39c22bfb8edb296acf5bb4c9152eb9d2","created_at":"2023-04-12T07:35:43Z","performed_via_github_app":null},{"id":9966090265,"node_id":"REFE_lADOAAJhcs5OZ0xpzwAAAAJSBngZ","url":"https://api.github.com/repos/redis/redis/issues/events/9966090265","actor":{"login":"enjoy-binbin","id":22811481,"node_id":"MDQ6VXNlcjIyODExNDgx","avatar_url":"https://avatars.githubusercontent.com/u/22811481?v=4","gravatar_id":"","url":"https://api.github.com/users/enjoy-binbin","html_url":"https://github.com/enjoy-binbin","followers_url":"https://api.github.com/users/enjoy-binbin/followers","following_url":"https://api.github.com/users/enjoy-binbin/following{/other_user}","gists_url":"https://api.github.com/users/enjoy-binbin/gists{/gist_id}","starred_url":"https://api.github.com/users/enjoy-binbin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/enjoy-binbin/subscriptions","organizations_url":"https://api.github.com/users/enjoy-binbin/orgs","repos_url":"https://api.github.com/users/enjoy-binbin/repos","events_url":"https://api.github.com/users/enjoy-binbin/events{/privacy}","received_events_url":"https://api.github.com/users/enjoy-binbin/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"d148fa92b1405f9f22b442d12ace719f08f90bd0","commit_url":"https://api.github.com/repos/enjoy-binbin/redis/commits/d148fa92b1405f9f22b442d12ace719f08f90bd0","created_at":"2023-07-31T16:15:53Z","performed_via_github_app":null}]