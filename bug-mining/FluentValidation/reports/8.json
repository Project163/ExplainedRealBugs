{"url":"https://api.github.com/repos/FluentValidation/FluentValidation/issues/1561","repository_url":"https://api.github.com/repos/FluentValidation/FluentValidation","labels_url":"https://api.github.com/repos/FluentValidation/FluentValidation/issues/1561/labels{/name}","comments_url":"https://api.github.com/repos/FluentValidation/FluentValidation/issues/1561/comments","events_url":"https://api.github.com/repos/FluentValidation/FluentValidation/issues/1561/events","html_url":"https://github.com/FluentValidation/FluentValidation/issues/1561","id":731394868,"node_id":"MDU6SXNzdWU3MzEzOTQ4Njg=","number":1561,"title":"CollectionPropertyRule should only iterate the collection once","user":{"login":"JeremySkinner","id":90130,"node_id":"MDQ6VXNlcjkwMTMw","avatar_url":"https://avatars.githubusercontent.com/u/90130?v=4","gravatar_id":"","url":"https://api.github.com/users/JeremySkinner","html_url":"https://github.com/JeremySkinner","followers_url":"https://api.github.com/users/JeremySkinner/followers","following_url":"https://api.github.com/users/JeremySkinner/following{/other_user}","gists_url":"https://api.github.com/users/JeremySkinner/gists{/gist_id}","starred_url":"https://api.github.com/users/JeremySkinner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JeremySkinner/subscriptions","organizations_url":"https://api.github.com/users/JeremySkinner/orgs","repos_url":"https://api.github.com/users/JeremySkinner/repos","events_url":"https://api.github.com/users/JeremySkinner/events{/privacy}","received_events_url":"https://api.github.com/users/JeremySkinner/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FluentValidation/FluentValidation/milestones/27","html_url":"https://github.com/FluentValidation/FluentValidation/milestone/27","labels_url":"https://api.github.com/repos/FluentValidation/FluentValidation/milestones/27/labels","id":5739727,"node_id":"MDk6TWlsZXN0b25lNTczOTcyNw==","number":27,"title":"10.0","description":"","creator":{"login":"JeremySkinner","id":90130,"node_id":"MDQ6VXNlcjkwMTMw","avatar_url":"https://avatars.githubusercontent.com/u/90130?v=4","gravatar_id":"","url":"https://api.github.com/users/JeremySkinner","html_url":"https://github.com/JeremySkinner","followers_url":"https://api.github.com/users/JeremySkinner/followers","following_url":"https://api.github.com/users/JeremySkinner/following{/other_user}","gists_url":"https://api.github.com/users/JeremySkinner/gists{/gist_id}","starred_url":"https://api.github.com/users/JeremySkinner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JeremySkinner/subscriptions","organizations_url":"https://api.github.com/users/JeremySkinner/orgs","repos_url":"https://api.github.com/users/JeremySkinner/repos","events_url":"https://api.github.com/users/JeremySkinner/events{/privacy}","received_events_url":"https://api.github.com/users/JeremySkinner/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":21,"state":"closed","created_at":"2020-08-06T11:15:05Z","updated_at":"2021-04-15T12:10:23Z","due_on":"2021-07-01T07:00:00Z","closed_at":"2021-04-15T12:10:23Z"},"comments":1,"created_at":"2020-10-28T12:24:32Z","updated_at":"2020-11-18T00:20:30Z","closed_at":"2020-11-03T17:21:48Z","author_association":"MEMBER","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Imagine the following:\r\n\r\n```csharp\r\n// Names is an IEnumerable<string>\r\nRuleForEach(x => x.Names).NotNull().NotEqual(\"Foo\");\r\n```\r\n\r\nThis will loop over the collection once for each validator. In this case, it'll be iterated twice (once for NotNull and once for NotEqual). If there is only one validator in the rule, this is OK, but if there are several then this could be problematic if the collection is very large. \r\n\r\nInstead, change this to the other way around: loop over the collection only once, and for each element loop over the property validators and invoke them.\r\n\r\n- [x] Pre-filter the list of validators in the rule (rather than checking their condition for every iteration of the loop)\r\n- [x] Loop over the collection property\r\n- [x] For each element in the property, loop over the (filtered) validators in the chain and invoke them.\r\n\r\nThis means a lot more duplication between PropertyRule and CollectionPropertyRule, but is probably worth it. ","closed_by":{"login":"JeremySkinner","id":90130,"node_id":"MDQ6VXNlcjkwMTMw","avatar_url":"https://avatars.githubusercontent.com/u/90130?v=4","gravatar_id":"","url":"https://api.github.com/users/JeremySkinner","html_url":"https://github.com/JeremySkinner","followers_url":"https://api.github.com/users/JeremySkinner/followers","following_url":"https://api.github.com/users/JeremySkinner/following{/other_user}","gists_url":"https://api.github.com/users/JeremySkinner/gists{/gist_id}","starred_url":"https://api.github.com/users/JeremySkinner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JeremySkinner/subscriptions","organizations_url":"https://api.github.com/users/JeremySkinner/orgs","repos_url":"https://api.github.com/users/JeremySkinner/repos","events_url":"https://api.github.com/users/JeremySkinner/events{/privacy}","received_events_url":"https://api.github.com/users/JeremySkinner/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FluentValidation/FluentValidation/issues/1561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FluentValidation/FluentValidation/issues/1561/timeline","performed_via_github_app":null,"state_reason":"completed"}