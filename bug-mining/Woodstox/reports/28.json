{"url":"https://api.github.com/repos/FasterXML/woodstox/issues/122","repository_url":"https://api.github.com/repos/FasterXML/woodstox","labels_url":"https://api.github.com/repos/FasterXML/woodstox/issues/122/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/woodstox/issues/122/comments","events_url":"https://api.github.com/repos/FasterXML/woodstox/issues/122/events","html_url":"https://github.com/FasterXML/woodstox/issues/122","id":800168336,"node_id":"MDU6SXNzdWU4MDAxNjgzMzY=","number":122,"title":"Expected either attr limit (2147483647) >= currAttrSize (0) OR >= outBuf.length (96)","user":{"login":"j3rem1e","id":2384547,"node_id":"MDQ6VXNlcjIzODQ1NDc=","avatar_url":"https://avatars.githubusercontent.com/u/2384547?v=4","gravatar_id":"","url":"https://api.github.com/users/j3rem1e","html_url":"https://github.com/j3rem1e","followers_url":"https://api.github.com/users/j3rem1e/followers","following_url":"https://api.github.com/users/j3rem1e/following{/other_user}","gists_url":"https://api.github.com/users/j3rem1e/gists{/gist_id}","starred_url":"https://api.github.com/users/j3rem1e/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/j3rem1e/subscriptions","organizations_url":"https://api.github.com/users/j3rem1e/orgs","repos_url":"https://api.github.com/users/j3rem1e/repos","events_url":"https://api.github.com/users/j3rem1e/events{/privacy}","received_events_url":"https://api.github.com/users/j3rem1e/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/woodstox/milestones/21","html_url":"https://github.com/FasterXML/woodstox/milestone/21","labels_url":"https://api.github.com/repos/FasterXML/woodstox/milestones/21/labels","id":6424461,"node_id":"MDk6TWlsZXN0b25lNjQyNDQ2MQ==","number":21,"title":"6.2.4","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":1,"state":"open","created_at":"2021-02-11T22:51:13Z","updated_at":"2021-02-11T22:59:03Z","due_on":null,"closed_at":null},"comments":2,"created_at":"2021-02-03T09:59:47Z","updated_at":"2021-02-11T23:13:20Z","closed_at":"2021-02-11T22:59:02Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"After upgrading my application to woodstock v6.2.x, importing xml failed with this exception :\r\n\r\n```\r\nCaused by: java.lang.RuntimeException: Internal error: Expected either attr limit (2147483647) >= currAttrSize (0) OR >= outBuf.length (96)\r\n\tat com.ctc.wstx.util.ExceptionUtil.throwInternal(ExceptionUtil.java:69) ~[?:?]\r\n\tat com.ctc.wstx.sr.BasicStreamReader._checkAttributeLimit(BasicStreamReader.java:2056) ~[?:?]\r\n\tat com.ctc.wstx.sr.BasicStreamReader.parseAttrValue(BasicStreamReader.java:2038) ~[?:?]\r\n\tat com.ctc.wstx.sr.BasicStreamReader.handleNsAttrs(BasicStreamReader.java:3144) ~[?:?]\r\n\tat com.ctc.wstx.sr.BasicStreamReader.handleStartElem(BasicStreamReader.java:3042) ~[?:?]\r\n\tat com.ctc.wstx.sr.BasicStreamReader.handleRootElem(BasicStreamReader.java:2188) ~[?:?]\r\n\tat com.ctc.wstx.sr.BasicStreamReader.nextFromProlog(BasicStreamReader.java:2168) ~[?:?]\r\n\tat com.ctc.wstx.sr.BasicStreamReader.next(BasicStreamReader.java:1180) ~[?:?]\r\n```\r\n\r\ndowngrading to v6.0.2 fixes it.\r\n\r\nI don't really understand what the message means.. ;)\r\n\r\nThe code looks like the following : \r\n\r\n```java\r\npublic static void checkSVG(final String svg) {\r\n\tboolean allowed = true;\r\n\r\n\tXMLInputFactory factory = XMLInputFactory.newInstance();\r\n\tfactory.setProperty(XMLInputFactory.SUPPORT_DTD, Boolean.FALSE);\r\n\tfactory.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, Boolean.FALSE);\r\n\tfactory.setProperty(\"com.ctc.wstx.maxAttributeSize\", Integer.MAX_VALUE);\r\n\r\n\tXMLStreamReader reader = factory.createXMLStreamReader(new StringReader(svg))\r\n\ttry {\r\n\t\twhile (reader.hasNext()) {\r\n\t\t\tif (reader.next() == XMLEvent.START_ELEMENT) {\r\n\r\n\t\t\t\tif (!WHITELIST_ELEMENTS.contains(reader.getLocalName())) {\r\n\t\t\t\t\tallowed = false;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tint attcount = reader.getAttributeCount();\r\n\t\t\t\tfor (int i = 0; i < attcount; ++i) {\r\n\t\t\t\t\tString attName = reader.getAttributeLocalName(i); \r\n\t\t\t\t\tif (!WHITELIST_ATTRIBUTES.contains(attName)) {\r\n\t\t\t\t\t\tallowed = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (final XMLStreamException e) {\r\n\t\tExceptionUtils.throwRuntimeException(e);\r\n\t}\r\n\t\r\n\tif (!allowed) {\r\n\t\tthrow new SecurityException(\"xxx\");\r\n\t}\r\n}\r\n``` \r\n","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/woodstox/issues/122/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/woodstox/issues/122/timeline","performed_via_github_app":null,"state_reason":"completed"}