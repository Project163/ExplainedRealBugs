{"url":"https://api.github.com/repos/FasterXML/woodstox/issues/21","repository_url":"https://api.github.com/repos/FasterXML/woodstox","labels_url":"https://api.github.com/repos/FasterXML/woodstox/issues/21/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/woodstox/issues/21/comments","events_url":"https://api.github.com/repos/FasterXML/woodstox/issues/21/events","html_url":"https://github.com/FasterXML/woodstox/issues/21","id":166651057,"node_id":"MDU6SXNzdWUxNjY2NTEwNTc=","number":21,"title":"500 characters limit when calling XMLStreamReader#getText() after CDATA event","user":{"login":"elrodro83","id":8010105,"node_id":"MDQ6VXNlcjgwMTAxMDU=","avatar_url":"https://avatars.githubusercontent.com/u/8010105?v=4","gravatar_id":"","url":"https://api.github.com/users/elrodro83","html_url":"https://github.com/elrodro83","followers_url":"https://api.github.com/users/elrodro83/followers","following_url":"https://api.github.com/users/elrodro83/following{/other_user}","gists_url":"https://api.github.com/users/elrodro83/gists{/gist_id}","starred_url":"https://api.github.com/users/elrodro83/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elrodro83/subscriptions","organizations_url":"https://api.github.com/users/elrodro83/orgs","repos_url":"https://api.github.com/users/elrodro83/repos","events_url":"https://api.github.com/users/elrodro83/events{/privacy}","received_events_url":"https://api.github.com/users/elrodro83/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/woodstox/milestones/3","html_url":"https://github.com/FasterXML/woodstox/milestone/3","labels_url":"https://api.github.com/repos/FasterXML/woodstox/milestones/3/labels","id":1716180,"node_id":"MDk6TWlsZXN0b25lMTcxNjE4MA==","number":3,"title":"5.0.3","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":3,"state":"open","created_at":"2016-04-19T03:41:34Z","updated_at":"2016-08-24T03:55:30Z","due_on":null,"closed_at":null},"comments":13,"created_at":"2016-07-20T18:35:13Z","updated_at":"2016-08-24T20:08:37Z","closed_at":"2016-08-17T21:04:46Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"While the scenario tested in TestXMLStreamReader2#testLongerCData() works correcly, the same 500 chars limit bug (WSTX-211) is still happening with a slight modification. For instance, this test case:\n\n```\n    public void testLongerCData2() throws Exception\n    {\n        String SRC_TEXT =\n                \"\\r\\n123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678\\r\\n\"\n                          + \"<embededElement>Woodstox 4.0.5 does not like this embedded element.  However, if you take\\r\\n\"\n                          + \"out one or more characters from the really long line (so that less than 500 characters come between\\r\\n\"\n                          + \"'CDATA[' and the opening of the embeddedElement tag (including LF), then Woodstox will instead\\r\\n\"\n                          + \"complain that the CDATA section wasn't ended.\";\n        String DST_TEXT = SRC_TEXT.replace(\"\\r\\n\", \"\\n\");\n        String XML = \"<?xml version='1.0' encoding='utf-8'?>\\r\\n\"\n                     + \"<test><![CDATA[\" + SRC_TEXT + \"]]></test>\";\n        // Hmmh. Seems like we need the BOM...\n        ByteArrayOutputStream bos = new ByteArrayOutputStream();\n        bos.write(0xEF);\n        bos.write(0xBB);\n        bos.write(0xBF);\n        bos.write(XML.getBytes(\"UTF-8\"));\n        byte[] bytes = bos.toByteArray();\n        XMLInputFactory2 f = (XMLInputFactory2) XMLInputFactory.newInstance();\n        // important: don't force coalescing, that'll convert CDATA to CHARACTERS\n        f.setProperty(XMLInputFactory.IS_COALESCING, Boolean.valueOf(false));\n\n        XMLStreamReader sr = f.createXMLStreamReader(new ByteArrayInputStream(bytes));\n        assertTokenType(START_DOCUMENT, sr.getEventType());\n        assertTokenType(START_ELEMENT, sr.next());\n        assertEquals(\"test\", sr.getLocalName());\n        assertTokenType(CDATA, sr.next());\n        // This should still work, although with linefeed replacements\n        final String text = sr.getText();\n        assertEquals(\"\" + text.length(), DST_TEXT, text);\n        // assertTokenType(END_ELEMENT, sr.getEventType());\n        sr.close();\n    }\n```\n\ndoes _sr.next()_ followed by _sr.getText()_ instead of doing just _sr.getElementText()_.\n\nWhen running this test case, you will see that only the first 500 characters are read.\n\nThis usage id done, for instance, by CXF, in _StaxUtils#copy_\n","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/woodstox/issues/21/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/woodstox/issues/21/timeline","performed_via_github_app":null,"state_reason":"completed"}