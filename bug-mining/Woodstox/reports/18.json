{"url":"https://api.github.com/repos/FasterXML/woodstox/issues/82","repository_url":"https://api.github.com/repos/FasterXML/woodstox","labels_url":"https://api.github.com/repos/FasterXML/woodstox/issues/82/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/woodstox/issues/82/comments","events_url":"https://api.github.com/repos/FasterXML/woodstox/issues/82/events","html_url":"https://github.com/FasterXML/woodstox/issues/82","id":492522995,"node_id":"MDU6SXNzdWU0OTI1MjI5OTU=","number":82,"title":"Recycled buffers in XMLStreamWriter are colliding between multiple writer instances when used in an Akka stream","user":{"login":"jphelp32","id":2238383,"node_id":"MDQ6VXNlcjIyMzgzODM=","avatar_url":"https://avatars.githubusercontent.com/u/2238383?v=4","gravatar_id":"","url":"https://api.github.com/users/jphelp32","html_url":"https://github.com/jphelp32","followers_url":"https://api.github.com/users/jphelp32/followers","following_url":"https://api.github.com/users/jphelp32/following{/other_user}","gists_url":"https://api.github.com/users/jphelp32/gists{/gist_id}","starred_url":"https://api.github.com/users/jphelp32/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jphelp32/subscriptions","organizations_url":"https://api.github.com/users/jphelp32/orgs","repos_url":"https://api.github.com/users/jphelp32/repos","events_url":"https://api.github.com/users/jphelp32/events{/privacy}","received_events_url":"https://api.github.com/users/jphelp32/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/woodstox/milestones/10","html_url":"https://github.com/FasterXML/woodstox/milestone/10","labels_url":"https://api.github.com/repos/FasterXML/woodstox/milestones/10/labels","id":4699520,"node_id":"MDk6TWlsZXN0b25lNDY5OTUyMA==","number":10,"title":"6.0.1","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":1,"state":"open","created_at":"2019-09-27T21:21:58Z","updated_at":"2019-09-27T21:21:58Z","due_on":null,"closed_at":null},"comments":16,"created_at":"2019-09-12T00:11:17Z","updated_at":"2019-09-27T21:21:58Z","closed_at":"2019-09-12T23:02:05Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'll start w/the caveat that I have not been able to produce a unit test case to illustrate this issue. But what I'm observing in our application is that the recycled char buffers (pretty sure it's the small copy buffers, but could potentially be the others), are being concurrently used by multiple threads in an Akka stream, and the result is corrupted output. In particular in the namespace writing, in my application.\r\nI've so far been unable to reproduce the problem using aalto, but I'm not certain it also isn't affected given that it also uses the ThreadLocal recycled buffers.\r\nHoping you might have an inkling as to how to attempt to reproduce outside of Akka and my application? Or perhaps this is already a known issue that woodstox should not be used under fork-join parallelism?  (However, I did try changing my akka configuration to use a fixed threadpool dispatcher and the problem still occurs.)\r\nI've locally recompiled woodstox w/some debug logging added and I have some log files that demonstrate the problem. Don't want to presume upon you to review them, but I mention in case it might help. \r\n","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/woodstox/issues/82/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/woodstox/issues/82/timeline","performed_via_github_app":null,"state_reason":"completed"}