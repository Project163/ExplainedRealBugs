diff --git a/.idea/libraries/Maven__stax_stax_api_1_0_1.xml b/.idea/libraries/Maven__stax_stax_api_1_0_1.xml
deleted file mode 100644
index 0b13335..0000000
--- a/.idea/libraries/Maven__stax_stax_api_1_0_1.xml
+++ /dev/null
@@ -1,13 +0,0 @@
-<component name="libraryTable">
-  <library name="Maven: stax:stax-api:1.0.1">
-    <CLASSES>
-      <root url="jar://$MAVEN_REPOSITORY$/stax/stax-api/1.0.1/stax-api-1.0.1.jar!/" />
-    </CLASSES>
-    <JAVADOC>
-      <root url="jar://$MAVEN_REPOSITORY$/stax/stax-api/1.0.1/stax-api-1.0.1-javadoc.jar!/" />
-    </JAVADOC>
-    <SOURCES>
-      <root url="jar://$MAVEN_REPOSITORY$/stax/stax-api/1.0.1/stax-api-1.0.1-sources.jar!/" />
-    </SOURCES>
-  </library>
-</component>
\ No newline at end of file
diff --git a/pom.xml b/pom.xml
index e9dbd66..7187dfc 100644
--- a/pom.xml
+++ b/pom.xml
@@ -68,17 +68,17 @@
         <dependency>
             <groupId>org.apache.poi</groupId>
             <artifactId>poi</artifactId>
-            <version>3.17</version>
+            <version>4.1.0</version>
         </dependency>
         <dependency>
             <groupId>org.apache.poi</groupId>
             <artifactId>poi-ooxml</artifactId>
-            <version>3.17</version>
+            <version>4.1.0</version>
         </dependency>
         <dependency>
             <groupId>org.apache.poi</groupId>
             <artifactId>poi-ooxml-schemas</artifactId>
-            <version>3.17</version>
+            <version>4.1.0</version>
         </dependency>
         <dependency>
             <groupId>org.apache.commons</groupId>
diff --git a/simple-excel.iml b/simple-excel.iml
index fa788a5..12ee770 100644
--- a/simple-excel.iml
+++ b/simple-excel.iml
@@ -18,14 +18,15 @@
     <orderEntry type="library" scope="TEST" name="Maven: org.jmock:jmock-legacy:2.6.0" level="project" />
     <orderEntry type="library" scope="TEST" name="Maven: org.objenesis:objenesis:1.0" level="project" />
     <orderEntry type="library" scope="TEST" name="Maven: cglib:cglib-nodep:2.1_3" level="project" />
-    <orderEntry type="library" name="Maven: org.apache.poi:poi:3.17" level="project" />
-    <orderEntry type="library" name="Maven: commons-codec:commons-codec:1.10" level="project" />
-    <orderEntry type="library" name="Maven: org.apache.commons:commons-collections4:4.1" level="project" />
-    <orderEntry type="library" name="Maven: org.apache.poi:poi-ooxml:3.17" level="project" />
-    <orderEntry type="library" name="Maven: com.github.virtuald:curvesapi:1.04" level="project" />
-    <orderEntry type="library" name="Maven: org.apache.poi:poi-ooxml-schemas:3.17" level="project" />
-    <orderEntry type="library" name="Maven: org.apache.xmlbeans:xmlbeans:2.6.0" level="project" />
-    <orderEntry type="library" name="Maven: stax:stax-api:1.0.1" level="project" />
+    <orderEntry type="library" name="Maven: org.apache.poi:poi:4.1.0" level="project" />
+    <orderEntry type="library" name="Maven: commons-codec:commons-codec:1.12" level="project" />
+    <orderEntry type="library" name="Maven: org.apache.commons:commons-collections4:4.3" level="project" />
+    <orderEntry type="library" name="Maven: org.apache.commons:commons-math3:3.6.1" level="project" />
+    <orderEntry type="library" name="Maven: org.apache.poi:poi-ooxml:4.1.0" level="project" />
+    <orderEntry type="library" name="Maven: org.apache.commons:commons-compress:1.18" level="project" />
+    <orderEntry type="library" name="Maven: com.github.virtuald:curvesapi:1.06" level="project" />
+    <orderEntry type="library" name="Maven: org.apache.poi:poi-ooxml-schemas:4.1.0" level="project" />
+    <orderEntry type="library" name="Maven: org.apache.xmlbeans:xmlbeans:3.1.0" level="project" />
     <orderEntry type="library" name="Maven: org.apache.commons:commons-lang3:3.1" level="project" />
     <orderEntry type="library" name="Maven: org.hamcrest:hamcrest-core:1.3" level="project" />
     <orderEntry type="library" name="Maven: org.hamcrest:hamcrest-library:1.3" level="project" />
diff --git a/src/main/java/bad/robot/excel/cell/BlankCell.java b/src/main/java/bad/robot/excel/cell/BlankCell.java
index e90e437..874dde5 100644
--- a/src/main/java/bad/robot/excel/cell/BlankCell.java
+++ b/src/main/java/bad/robot/excel/cell/BlankCell.java
@@ -25,7 +25,7 @@ import org.apache.poi.ss.usermodel.Row;
 import org.apache.poi.ss.usermodel.Workbook;
 
 import static bad.robot.excel.column.ColumnIndex.column;
-import static org.apache.poi.ss.usermodel.Cell.CELL_TYPE_BLANK;
+import static org.apache.poi.ss.usermodel.CellType.BLANK;
 
 public class BlankCell extends StyledCell {
 
@@ -39,7 +39,7 @@ public class BlankCell extends StyledCell {
 
     @Override
     public void addTo(Row row, ColumnIndex column, Workbook workbook) {
-        Cell cell = row.createCell(column.value(), CELL_TYPE_BLANK);
+        Cell cell = row.createCell(column.value(), BLANK);
         this.getStyle().applyTo(cell, workbook);
     }
 
diff --git a/src/main/java/bad/robot/excel/cell/BooleanCell.java b/src/main/java/bad/robot/excel/cell/BooleanCell.java
index ca384ec..32c893b 100644
--- a/src/main/java/bad/robot/excel/cell/BooleanCell.java
+++ b/src/main/java/bad/robot/excel/cell/BooleanCell.java
@@ -22,7 +22,7 @@ import bad.robot.excel.style.Style;
 import org.apache.poi.ss.usermodel.Row;
 import org.apache.poi.ss.usermodel.Workbook;
 
-import static org.apache.poi.ss.usermodel.Cell.CELL_TYPE_BOOLEAN;
+import static org.apache.poi.ss.usermodel.CellType.BOOLEAN;
 
 public class BooleanCell extends StyledCell {
 
@@ -39,7 +39,7 @@ public class BooleanCell extends StyledCell {
 
     @Override
     public void addTo(Row row, ColumnIndex column, Workbook workbook) {
-        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), CELL_TYPE_BOOLEAN);
+        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), BOOLEAN);
         update(cell, workbook);
     }
 
diff --git a/src/main/java/bad/robot/excel/cell/DateCell.java b/src/main/java/bad/robot/excel/cell/DateCell.java
index ac0bcbc..b0fc980 100644
--- a/src/main/java/bad/robot/excel/cell/DateCell.java
+++ b/src/main/java/bad/robot/excel/cell/DateCell.java
@@ -26,7 +26,7 @@ import org.apache.poi.ss.usermodel.Workbook;
 import java.util.Date;
 
 import static bad.robot.excel.cell.DataFormat.asDayMonthYear;
-import static org.apache.poi.ss.usermodel.Cell.CELL_TYPE_NUMERIC;
+import static org.apache.poi.ss.usermodel.CellType.NUMERIC;
 
 public class DateCell extends StyledCell {
 
@@ -43,7 +43,7 @@ public class DateCell extends StyledCell {
 
     @Override
     public void addTo(Row row, ColumnIndex column, Workbook workbook) {
-        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), CELL_TYPE_NUMERIC);
+        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), NUMERIC);
         update(cell, workbook);
     }
 
@@ -65,6 +65,6 @@ public class DateCell extends StyledCell {
     }
 
     private static boolean isCellDateFormatted(org.apache.poi.ss.usermodel.Cell cell) {
-        return cell.getCellType() == CELL_TYPE_NUMERIC && DateUtil.isCellDateFormatted(cell);
+        return cell.getCellType() == NUMERIC && DateUtil.isCellDateFormatted(cell);
     }
 }
diff --git a/src/main/java/bad/robot/excel/cell/DoubleCell.java b/src/main/java/bad/robot/excel/cell/DoubleCell.java
index 850fda5..94e0950 100644
--- a/src/main/java/bad/robot/excel/cell/DoubleCell.java
+++ b/src/main/java/bad/robot/excel/cell/DoubleCell.java
@@ -23,7 +23,7 @@ import org.apache.poi.ss.usermodel.Row;
 import org.apache.poi.ss.usermodel.Workbook;
 
 import static java.lang.String.format;
-import static org.apache.poi.ss.usermodel.Cell.CELL_TYPE_NUMERIC;
+import static org.apache.poi.ss.usermodel.CellType.NUMERIC;
 
 public class DoubleCell extends StyledCell {
 
@@ -40,7 +40,7 @@ public class DoubleCell extends StyledCell {
 
     @Override
     public void addTo(Row row, ColumnIndex column, Workbook workbook) {
-        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), CELL_TYPE_NUMERIC);
+        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), NUMERIC);
         update(cell, workbook);
     }
 
diff --git a/src/main/java/bad/robot/excel/cell/ErrorCell.java b/src/main/java/bad/robot/excel/cell/ErrorCell.java
index 88357ca..76dd7c3 100644
--- a/src/main/java/bad/robot/excel/cell/ErrorCell.java
+++ b/src/main/java/bad/robot/excel/cell/ErrorCell.java
@@ -23,7 +23,7 @@ import org.apache.poi.ss.usermodel.Row;
 import org.apache.poi.ss.usermodel.Workbook;
 
 import static java.lang.String.format;
-import static org.apache.poi.ss.usermodel.Cell.CELL_TYPE_ERROR;
+import static org.apache.poi.ss.usermodel.CellType.ERROR;
 
 public class ErrorCell extends StyledCell {
 
@@ -40,7 +40,7 @@ public class ErrorCell extends StyledCell {
 
     @Override
     public void addTo(Row row, ColumnIndex column, Workbook workbook) {
-        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), CELL_TYPE_ERROR);
+        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), ERROR);
         update(cell, workbook);
     }
 
diff --git a/src/main/java/bad/robot/excel/cell/FormulaCell.java b/src/main/java/bad/robot/excel/cell/FormulaCell.java
index a959a9a..4bd469f 100644
--- a/src/main/java/bad/robot/excel/cell/FormulaCell.java
+++ b/src/main/java/bad/robot/excel/cell/FormulaCell.java
@@ -23,7 +23,7 @@ import org.apache.poi.ss.usermodel.Row;
 import org.apache.poi.ss.usermodel.Workbook;
 
 import static java.lang.String.format;
-import static org.apache.poi.ss.usermodel.Cell.CELL_TYPE_FORMULA;
+import static org.apache.poi.ss.usermodel.CellType.FORMULA;
 
 public class FormulaCell extends StyledCell {
 
@@ -44,7 +44,7 @@ public class FormulaCell extends StyledCell {
 
     @Override
     public void addTo(Row row, ColumnIndex column, Workbook workbook) {
-        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), CELL_TYPE_FORMULA);
+        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), FORMULA);
         update(cell, workbook);
     }
 
diff --git a/src/main/java/bad/robot/excel/cell/StringCell.java b/src/main/java/bad/robot/excel/cell/StringCell.java
index 18ae71d..249467e 100644
--- a/src/main/java/bad/robot/excel/cell/StringCell.java
+++ b/src/main/java/bad/robot/excel/cell/StringCell.java
@@ -22,7 +22,7 @@ import bad.robot.excel.style.Style;
 import org.apache.poi.ss.usermodel.Row;
 import org.apache.poi.ss.usermodel.Workbook;
 
-import static org.apache.poi.ss.usermodel.Cell.CELL_TYPE_STRING;
+import static org.apache.poi.ss.usermodel.CellType.STRING;
 
 public class StringCell extends StyledCell {
 
@@ -39,7 +39,7 @@ public class StringCell extends StyledCell {
 
     @Override
     public void addTo(Row row, ColumnIndex column, Workbook workbook) {
-        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), CELL_TYPE_STRING);
+        org.apache.poi.ss.usermodel.Cell cell = row.createCell(column.value(), STRING);
         update(cell, workbook);
     }
 
diff --git a/src/main/java/bad/robot/excel/matchers/CellType.java b/src/main/java/bad/robot/excel/matchers/CellType.java
index d23b04a..56e3cb1 100644
--- a/src/main/java/bad/robot/excel/matchers/CellType.java
+++ b/src/main/java/bad/robot/excel/matchers/CellType.java
@@ -21,32 +21,32 @@ import bad.robot.excel.cell.*;
 
 import static bad.robot.excel.PoiToExcelCoercions.asExcelCoordinate;
 import static bad.robot.excel.cell.Hyperlink.hyperlink;
-import static org.apache.poi.ss.usermodel.Cell.*;
+import static org.apache.poi.ss.usermodel.CellType.*;
 import static org.apache.poi.ss.usermodel.DateUtil.isCellDateFormatted;
 
 public enum CellType implements CellAdapter {
 
-    Boolean(CELL_TYPE_BOOLEAN) {
+    Boolean(BOOLEAN) {
         @Override
         public Cell adapt(org.apache.poi.ss.usermodel.Cell cell) {
             return new BooleanCell(cell.getBooleanCellValue());
         }
     },
-    Error(CELL_TYPE_ERROR) {
+    Error(ERROR) {
         @Override
         public Cell adapt(org.apache.poi.ss.usermodel.Cell cell) {
             return new ErrorCell(cell.getErrorCellValue());
         }
     },
-    Formula(CELL_TYPE_FORMULA) {
+    Formula(FORMULA) {
         @Override
         public Cell adapt(org.apache.poi.ss.usermodel.Cell cell) {
-            if (cell.getCachedFormulaResultType() == CELL_TYPE_ERROR)
+            if (cell.getCachedFormulaResultType() == ERROR)
                 return new ErrorCell(cell.getErrorCellValue());
             return new FormulaCell(cell.getCellFormula());
         }
     },
-    Numeric(CELL_TYPE_NUMERIC) {
+    Numeric(NUMERIC) {
         @Override
         public Cell adapt(org.apache.poi.ss.usermodel.Cell cell) {
             if (isCellDateFormatted(cell))
@@ -54,7 +54,7 @@ public enum CellType implements CellAdapter {
             return new DoubleCell(cell.getNumericCellValue());
         }
     },
-    String(CELL_TYPE_STRING) {
+    String(STRING) {
         @Override
         public Cell adapt(org.apache.poi.ss.usermodel.Cell cell) {
             if (cell.getHyperlink() != null && containsUrl(cell.getHyperlink()))
@@ -70,16 +70,16 @@ public enum CellType implements CellAdapter {
             return hyperlink.getAddress().startsWith("http://") || hyperlink.getAddress().startsWith("file://");
         }
     },
-    Blank(CELL_TYPE_BLANK) {
+    Blank(BLANK) {
         @Override
         public Cell adapt(org.apache.poi.ss.usermodel.Cell cell) {
             return new BlankCell();
         }
     };
 
-    private final Integer poiType;
+    private final org.apache.poi.ss.usermodel.CellType poiType;
 
-    CellType(Integer poiType) {
+    CellType(org.apache.poi.ss.usermodel.CellType poiType) {
         this.poiType = poiType;
     }
 
diff --git a/src/main/java/bad/robot/excel/row/CopyRow.java b/src/main/java/bad/robot/excel/row/CopyRow.java
index 5659594..b1a2d28 100644
--- a/src/main/java/bad/robot/excel/row/CopyRow.java
+++ b/src/main/java/bad/robot/excel/row/CopyRow.java
@@ -79,22 +79,22 @@ public class CopyRow {
 
     private static void setCellDataValue(Cell oldCell, Cell newCell) {
         switch (oldCell.getCellType()) {
-            case Cell.CELL_TYPE_BLANK:
+            case BLANK:
                 newCell.setCellValue(oldCell.getStringCellValue());
                 break;
-            case Cell.CELL_TYPE_BOOLEAN:
+            case BOOLEAN:
                 newCell.setCellValue(oldCell.getBooleanCellValue());
                 break;
-            case Cell.CELL_TYPE_ERROR:
+            case ERROR:
                 newCell.setCellErrorValue(oldCell.getErrorCellValue());
                 break;
-            case Cell.CELL_TYPE_FORMULA:
+            case FORMULA:
                 newCell.setCellFormula(oldCell.getCellFormula());
                 break;
-            case Cell.CELL_TYPE_NUMERIC:
+            case NUMERIC:
                 newCell.setCellValue(oldCell.getNumericCellValue());
                 break;
-            case Cell.CELL_TYPE_STRING:
+            case STRING:
                 newCell.setCellValue(oldCell.getRichStringCellValue());
                 break;
         }
diff --git a/src/main/java/bad/robot/excel/workbook/PoiWorkbookReader.java b/src/main/java/bad/robot/excel/workbook/PoiWorkbookReader.java
index cbe86a9..581f082 100644
--- a/src/main/java/bad/robot/excel/workbook/PoiWorkbookReader.java
+++ b/src/main/java/bad/robot/excel/workbook/PoiWorkbookReader.java
@@ -16,7 +16,6 @@
 
 package bad.robot.excel.workbook;
 
-import org.apache.poi.openxml4j.exceptions.InvalidFormatException;
 import org.apache.poi.ss.usermodel.Workbook;
 import org.apache.poi.ss.usermodel.WorkbookFactory;
 
@@ -39,8 +38,6 @@ public class PoiWorkbookReader implements Readable<Workbook> {
             throw new IllegalArgumentException("stream was null, could not load the workbook");
         try {
             return WorkbookFactory.create(stream);
-        } catch (InvalidFormatException e) {
-            throw new IOException(e);
         } finally {
             stream.close();
         }
diff --git a/src/test/java/bad/robot/excel/matchers/StubCell.java b/src/test/java/bad/robot/excel/matchers/StubCell.java
index 4068a58..13c76bd 100644
--- a/src/test/java/bad/robot/excel/matchers/StubCell.java
+++ b/src/test/java/bad/robot/excel/matchers/StubCell.java
@@ -17,23 +17,21 @@
 package bad.robot.excel.matchers;
 
 import org.apache.poi.hssf.usermodel.HSSFWorkbook;
-import org.apache.poi.ss.usermodel.Cell;
-import org.apache.poi.ss.usermodel.CellStyle;
-import org.apache.poi.ss.usermodel.Sheet;
-import org.apache.poi.ss.usermodel.Workbook;
+import org.apache.poi.ss.usermodel.CellType;
+import org.apache.poi.ss.usermodel.*;
 
 import java.util.Date;
 
-import static org.apache.poi.ss.usermodel.Cell.*;
+import static org.apache.poi.ss.usermodel.CellType.*;
 
 class StubCell {
 
     static Cell createBlankCell(int row, int column) {
-        return create(row, column, CELL_TYPE_BLANK);
+        return create(row, column, BLANK);
     }
 
     static Cell createCell(int row, int column, Boolean aBoolean) {
-        Cell cell = create(row, column, CELL_TYPE_BOOLEAN);
+        Cell cell = create(row, column, BOOLEAN);
         cell.setCellValue(aBoolean);
         return cell;
     }
@@ -43,19 +41,19 @@ class StubCell {
     }
 
     static Cell createCell(int row, int column, Byte value) {
-        Cell cell = create(row, column, CELL_TYPE_ERROR);
+        Cell cell = create(row, column, ERROR);
         cell.setCellErrorValue(value);
         return cell;
     }
 
     static Cell createFormulaCell(int row, int column, String formula) {
-        Cell cell = create(row, column, CELL_TYPE_FORMULA);
+        Cell cell = create(row, column, FORMULA);
         cell.setCellFormula(formula);
         return cell;
     }
 
     static Cell createCell(int row, int column, Double aDouble) {
-        Cell cell = create(row, column, CELL_TYPE_NUMERIC);
+        Cell cell = create(row, column, NUMERIC);
         cell.setCellValue(aDouble);
         return cell;
     }
@@ -67,7 +65,7 @@ class StubCell {
         static Cell createCell(int row, int column, Date date) {
         Workbook workbook = new HSSFWorkbook();
         Sheet sheet = workbook.createSheet();
-        Cell cell = sheet.createRow(row).createCell(column, CELL_TYPE_NUMERIC);
+        Cell cell = sheet.createRow(row).createCell(column, NUMERIC);
         cell.setCellValue(date);
         CellStyle style = workbook.createCellStyle();
         style.setDataFormat(workbook.getCreationHelper().createDataFormat().getFormat("m/d/yy h:mm"));
@@ -76,7 +74,7 @@ class StubCell {
     }
 
     static Cell createCell(int row, int column, String value) {
-        Cell cell = create(row, column, CELL_TYPE_STRING);
+        Cell cell = create(row, column, STRING);
         cell.setCellValue(value);
         return cell;
     }
@@ -85,7 +83,7 @@ class StubCell {
         return createCell(0, 0, value);
     }
 
-    private static Cell create(int row, int column, int type) {
+    private static Cell create(int row, int column, CellType type) {
         Workbook workbook = new HSSFWorkbook();
         Sheet sheet = workbook.createSheet();
         Cell cell = sheet.createRow(row).createCell(column, type);
