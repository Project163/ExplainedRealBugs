diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
index 7476d9da..00705ccd 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
@@ -158,6 +158,8 @@ public abstract class AmqpAbstractResource<R extends JmsResource, E extends Endp
             endpoint.close();
         }
 
+        handleResourceClosure(provider, error);
+
         if (getResourceInfo() instanceof JmsConnectionInfo) {
             provider.fireProviderException(error);
         } else {
@@ -165,6 +167,10 @@ public abstract class AmqpAbstractResource<R extends JmsResource, E extends Endp
         }
     }
 
+    public void handleResourceClosure(AmqpProvider provider, Exception error) {
+        // Nothing do be done here, subclasses can override as needed.
+    }
+
     /**
      * Perform the close operation on the managed endpoint.  A subclass may
      * override this method to alter the standard close path such as endpoint
diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpFixedProducer.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpFixedProducer.java
index bbf48cb8..c354822f 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpFixedProducer.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpFixedProducer.java
@@ -306,23 +306,18 @@ public class AmqpFixedProducer extends AmqpProducer {
     }
 
     @Override
-    public void remotelyClosed(AmqpProvider provider) {
-        super.remotelyClosed(provider);
-
-        Exception ex = null;
-        if (!sent.isEmpty()) {
+    public void handleResourceClosure(AmqpProvider provider, Exception error) {
+        if (error == null) {
             // TODO: create/use a more specific/appropriate exception type?
-            ex = new JMSException("Producer closed remotely before message transfer result was notified");
+            error = new JMSException("Producer closed remotely before message transfer result was notified");
         }
 
-        ex = AmqpSupport.convertToException(getEndpoint(), getEndpoint().getRemoteCondition(), ex);
-
         for (Delivery delivery : sent) {
             try {
                 AsyncResult request = (AsyncResult) delivery.getContext();
 
                 if (request != null && !request.isComplete()) {
-                    request.onFailure(ex);
+                    request.onFailure(error);
                 }
 
                 delivery.settle();
@@ -338,7 +333,7 @@ public class AmqpFixedProducer extends AmqpProducer {
             try {
                 AsyncResult request = blockedSend.request;
                 if (request != null && !request.isComplete()) {
-                    request.onFailure(ex);
+                    request.onFailure(error);
                 }
             } catch (Exception e) {
                 LOG.debug("Caught exception when failing blocked send during remote producer closure: {}", blockedSend, e);
diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpSession.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpSession.java
index 24f9db10..c0436e6e 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpSession.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpSession.java
@@ -47,6 +47,7 @@ public class AmqpSession extends AmqpAbstractResource<JmsSessionInfo, Session> i
     private final AmqpTransactionContext txContext;
 
     private final Map<JmsConsumerId, AmqpConsumer> consumers = new HashMap<JmsConsumerId, AmqpConsumer>();
+    private final Map<JmsProducerId, AmqpProducer> producers = new HashMap<JmsProducerId, AmqpProducer>();
 
     public AmqpSession(AmqpConnection connection, JmsSessionInfo info, Session session) {
         super(info, session, connection);
@@ -202,6 +203,9 @@ public class AmqpSession extends AmqpAbstractResource<JmsSessionInfo, Session> i
         if (resource instanceof AmqpConsumer) {
             AmqpConsumer consumer = (AmqpConsumer) resource;
             consumers.put(consumer.getConsumerId(), consumer);
+        } else if (resource instanceof AmqpProducer) {
+            AmqpProducer producer = (AmqpProducer) resource;
+            producers.put(producer.getProducerId(), producer);
         } else {
             connection.addChildResource(resource);
         }
@@ -213,11 +217,25 @@ public class AmqpSession extends AmqpAbstractResource<JmsSessionInfo, Session> i
         if (resource instanceof AmqpConsumer) {
             AmqpConsumer consumer = (AmqpConsumer) resource;
             consumers.remove(consumer.getConsumerId());
+        } else if (resource instanceof AmqpProducer) {
+            AmqpProducer producer = (AmqpProducer) resource;
+            producers.remove(producer.getProducerId());
         } else {
             connection.removeChildResource(resource);
         }
     }
 
+    @Override
+    public void handleResourceClosure(AmqpProvider provider, Exception error) {
+        for (AmqpConsumer consumer : consumers.values()) {
+            consumer.handleResourceClosure(provider, error);
+        }
+
+        for (AmqpProducer producer : producers.values()) {
+            producer.handleResourceClosure(provider, error);
+        }
+    }
+
     /**
      * Query the Session to see if there are any registered consumer instances that have
      * a durable subscription with the given subscription name.
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java
index f93dcbdb..cd43444d 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java
@@ -48,7 +48,9 @@ import javax.jms.ConnectionMetaData;
 import javax.jms.ExceptionListener;
 import javax.jms.IllegalStateException;
 import javax.jms.JMSException;
+import javax.jms.Message;
 import javax.jms.MessageConsumer;
+import javax.jms.MessageProducer;
 import javax.jms.Queue;
 import javax.jms.Session;
 
@@ -446,4 +448,40 @@ public class ConnectionIntegrationTest extends QpidJmsTestCase {
             session.close();
         }
     }
+
+    @Test(timeout = 20000)
+    public void  testRemotelyEndConnectionWithSessionWithProducerWithSendWaitingOnCredit() throws Exception {
+        final String BREAD_CRUMB = "ErrorMessageBreadCrumb";
+
+        try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
+            Connection connection = testFixture.establishConnecton(testPeer);
+
+            testPeer.expectBegin();
+            Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
+
+            // Expect producer creation, don't give it credit.
+            testPeer.expectSenderAttachWithoutGrantingCredit();
+
+            // Producer has no credit so the send should block waiting for it.
+            testPeer.remotelyCloseConnection(true, AmqpError.RESOURCE_LIMIT_EXCEEDED, BREAD_CRUMB);
+
+            Queue queue = session.createQueue("myQueue");
+            final MessageProducer producer = session.createProducer(queue);
+
+            Message message = session.createTextMessage("myMessage");
+
+            try {
+                producer.send(message);
+                fail("Expected exception to be thrown");
+            } catch (JMSException jmse) {
+                // Expected
+                assertNotNull("Expected exception to have a message", jmse.getMessage());
+                assertTrue("Expected breadcrumb to be present in message", jmse.getMessage().contains(BREAD_CRUMB));
+            }
+
+            connection.close();
+
+            testPeer.waitForAllHandlersToComplete(3000);
+        }
+    }
 }
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SessionIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SessionIntegrationTest.java
index c2d3dd66..e6682f5c 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SessionIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SessionIntegrationTest.java
@@ -1632,6 +1632,43 @@ public class SessionIntegrationTest extends QpidJmsTestCase {
         }
     }
 
+    @Test(timeout = 20000)
+    public void testRemotelyEndSessionWithProducerSendWaitingForCredit() throws Exception {
+        final String BREAD_CRUMB = "ErrorMessageBreadCrumb";
+
+        try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
+            Connection connection = testFixture.establishConnecton(testPeer);
+
+            testPeer.expectBegin();
+            Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
+
+            // Expect producer creation, don't give it credit.
+            testPeer.expectSenderAttachWithoutGrantingCredit();
+
+            // Producer has no credit so the send should block waiting for it.
+            testPeer.remotelyEndLastOpenedSession(true, 0, AmqpError.RESOURCE_DELETED, BREAD_CRUMB);
+            testPeer.expectClose();
+
+            Queue queue = session.createQueue("myQueue");
+            final MessageProducer producer = session.createProducer(queue);
+
+            Message message = session.createTextMessage("myMessage");
+
+            try {
+                producer.send(message);
+                fail("Expected exception to be thrown");
+            } catch (JMSException jmse) {
+                // Expected
+                assertNotNull("Expected exception to have a message", jmse.getMessage());
+                assertTrue("Expected breadcrumb to be present in message", jmse.getMessage().contains(BREAD_CRUMB));
+            }
+
+            connection.close();
+
+            testPeer.waitForAllHandlersToComplete(3000);
+        }
+    }
+
     @Test(timeout = 20000)
     public void testRemotelyEndSessionWithConsumer() throws Exception {
         final String BREAD_CRUMB = "ErrorMessage";
