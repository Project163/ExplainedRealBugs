diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/util/AbstractMessageQueue.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/util/AbstractMessageQueue.java
index 18f69916..0b692909 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/util/AbstractMessageQueue.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/util/AbstractMessageQueue.java
@@ -43,8 +43,9 @@ public abstract class AbstractMessageQueue implements MessageQueue {
                 if (timeout == -1) {
                     lock.wait();
                 } else {
+                    long start = System.currentTimeMillis();
                     lock.wait(timeout);
-                    break;
+                    timeout = Math.max(timeout + start - System.currentTimeMillis(), 0);
                 }
             }
 
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/util/FifoMessageQueueTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/util/FifoMessageQueueTest.java
index 4a349189..82354785 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/util/FifoMessageQueueTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/util/FifoMessageQueueTest.java
@@ -277,6 +277,41 @@ public class FifoMessageQueueTest {
         assertSame(message, queue.dequeue(-1));
     }
 
+    @Test(timeout = 10000)
+    public void testDequeueWaitsUntilMessageArrivesWhenLockNotified() throws InterruptedException {
+        doDequeueWaitsUntilMessageArrivesWhenLockNotifiedTestImpl(-1);
+    }
+
+    @Test(timeout = 10000)
+    public void testTimedDequeueWaitsUntilMessageArrivesWhenLockNotified() throws InterruptedException {
+        doDequeueWaitsUntilMessageArrivesWhenLockNotifiedTestImpl(100000);
+    }
+
+    private void doDequeueWaitsUntilMessageArrivesWhenLockNotifiedTestImpl(int timeout) throws InterruptedException {
+        final JmsInboundMessageDispatch message = createEnvelope();
+        Thread runner = new Thread(new Runnable() {
+
+            @Override
+            public void run() {
+                try {
+                    TimeUnit.MILLISECONDS.sleep(100);
+                } catch (InterruptedException e) {
+                }
+                synchronized (queue.getLock()) {
+                    queue.getLock().notify();
+                }
+                try {
+                    TimeUnit.MILLISECONDS.sleep(100);
+                } catch (InterruptedException e) {
+                }
+                queue.enqueueFirst(message);
+            }
+        });
+        runner.start();
+
+        assertSame(message, queue.dequeue(timeout));
+    }
+
     @Test(timeout = 10000)
     public void testDequeueReturnsWhenQueueIsStopped() throws InterruptedException {
         Thread runner = new Thread(new Runnable() {
@@ -284,7 +319,7 @@ public class FifoMessageQueueTest {
             @Override
             public void run() {
                 try {
-                    TimeUnit.MILLISECONDS.sleep(500);
+                    TimeUnit.MILLISECONDS.sleep(100);
                 } catch (InterruptedException e) {
                 }
                 queue.stop();
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/util/PriorityMessageQueueTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/util/PriorityMessageQueueTest.java
index 1b460923..b62043e8 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/util/PriorityMessageQueueTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/util/PriorityMessageQueueTest.java
@@ -285,32 +285,22 @@ public class PriorityMessageQueueTest {
 
     @Test(timeout = 10000)
     public void testDequeueWaitsUntilMessageArrives() throws InterruptedException {
-        final JmsInboundMessageDispatch message = createEnvelope();
-        Thread runner = new Thread(new Runnable() {
-
-            @Override
-            public void run() {
-                try {
-                    TimeUnit.MILLISECONDS.sleep(200);
-                } catch (InterruptedException e) {
-                }
-                queue.enqueueFirst(message);
-            }
-        });
-        runner.start();
-
-        assertSame(message, queue.dequeue(-1));
+        doDequeueWaitsUntilMessageArrivesTestImpl(-1);
     }
 
     @Test(timeout = 10000)
     public void testDequeueTimedWaitsUntilMessageArrives() throws InterruptedException {
+        doDequeueWaitsUntilMessageArrivesTestImpl(5000);
+    }
+
+    private void doDequeueWaitsUntilMessageArrivesTestImpl(int timeout) throws InterruptedException {
         final JmsInboundMessageDispatch message = createEnvelope();
         Thread runner = new Thread(new Runnable() {
 
             @Override
             public void run() {
                 try {
-                    TimeUnit.MILLISECONDS.sleep(500);
+                    TimeUnit.MILLISECONDS.sleep(100);
                 } catch (InterruptedException e) {
                 }
                 queue.enqueueFirst(message);
@@ -318,25 +308,34 @@ public class PriorityMessageQueueTest {
         });
         runner.start();
 
-        assertSame(message, queue.dequeue(5000));
+        assertSame(message, queue.dequeue(timeout));
     }
 
     @Test(timeout = 10000)
     public void testDequeueWaitsUntilMessageArrivesWhenLockNotified() throws InterruptedException {
+        doDequeueWaitsUntilMessageArrivesWhenLockNotifiedTestImpl(-1);
+    }
+
+    @Test(timeout = 10000)
+    public void testTimedDequeueWaitsUntilMessageArrivesWhenLockNotified() throws InterruptedException {
+        doDequeueWaitsUntilMessageArrivesWhenLockNotifiedTestImpl(100000);
+    }
+
+    private void doDequeueWaitsUntilMessageArrivesWhenLockNotifiedTestImpl(int timeout) throws InterruptedException {
         final JmsInboundMessageDispatch message = createEnvelope();
         Thread runner = new Thread(new Runnable() {
 
             @Override
             public void run() {
                 try {
-                    TimeUnit.MILLISECONDS.sleep(200);
+                    TimeUnit.MILLISECONDS.sleep(100);
                 } catch (InterruptedException e) {
                 }
                 synchronized (queue.getLock()) {
                     queue.getLock().notify();
                 }
                 try {
-                    TimeUnit.MILLISECONDS.sleep(200);
+                    TimeUnit.MILLISECONDS.sleep(100);
                 } catch (InterruptedException e) {
                 }
                 queue.enqueueFirst(message);
@@ -344,7 +343,7 @@ public class PriorityMessageQueueTest {
         });
         runner.start();
 
-        assertSame(message, queue.dequeue(-1));
+        assertSame(message, queue.dequeue(timeout));
     }
 
     @Test(timeout = 10000)
@@ -354,7 +353,7 @@ public class PriorityMessageQueueTest {
             @Override
             public void run() {
                 try {
-                    TimeUnit.MILLISECONDS.sleep(500);
+                    TimeUnit.MILLISECONDS.sleep(100);
                 } catch (InterruptedException e) {
                 }
                 queue.stop();
