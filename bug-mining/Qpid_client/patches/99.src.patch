diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
index 00705ccd..a7d243f1 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
@@ -158,6 +158,9 @@ public abstract class AmqpAbstractResource<R extends JmsResource, E extends Endp
             endpoint.close();
         }
 
+        // Process the close now, so that child close operations see the correct state.
+        provider.pumpToProtonTransport();
+
         handleResourceClosure(provider, error);
 
         if (getResourceInfo() instanceof JmsConnectionInfo) {
diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpSession.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpSession.java
index c0436e6e..c09e8967 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpSession.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpSession.java
@@ -228,11 +228,11 @@ public class AmqpSession extends AmqpAbstractResource<JmsSessionInfo, Session> i
     @Override
     public void handleResourceClosure(AmqpProvider provider, Exception error) {
         for (AmqpConsumer consumer : consumers.values()) {
-            consumer.handleResourceClosure(provider, error);
+            consumer.locallyClosed(provider, error);
         }
 
         for (AmqpProducer producer : producers.values()) {
-            producer.handleResourceClosure(provider, error);
+            producer.locallyClosed(provider, error);
         }
     }
 
