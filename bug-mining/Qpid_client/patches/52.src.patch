diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsConnection.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsConnection.java
index 374bcc34..0ca100b6 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsConnection.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsConnection.java
@@ -613,8 +613,13 @@ public class JmsConnection implements Connection, TopicConnection, QueueConnecti
 
         try {
             ProviderFuture request = new ProviderFuture();
-            provider.create(resource, request);
-            request.sync();
+            requests.put(request, request);
+            try {
+                provider.create(resource, request);
+                request.sync();
+            } finally {
+                requests.remove(request);
+            }
         } catch (Exception ex) {
             throw JmsExceptionSupport.create(ex);
         }
@@ -625,8 +630,13 @@ public class JmsConnection implements Connection, TopicConnection, QueueConnecti
 
         try {
             ProviderFuture request = new ProviderFuture();
-            provider.start(resource, request);
-            request.sync();
+            requests.put(request, request);
+            try {
+                provider.start(resource, request);
+                request.sync();
+            } finally {
+                requests.remove(request);
+            }
         } catch (Exception ioe) {
             throw JmsExceptionSupport.create(ioe);
         }
@@ -637,8 +647,13 @@ public class JmsConnection implements Connection, TopicConnection, QueueConnecti
 
         try {
             ProviderFuture request = new ProviderFuture();
-            provider.stop(resource, request);
-            request.sync();
+            requests.put(request, request);
+            try {
+                provider.stop(resource, request);
+                request.sync();
+            } finally {
+                requests.remove(request);
+            }
         } catch (Exception ioe) {
             throw JmsExceptionSupport.create(ioe);
         }
@@ -649,8 +664,13 @@ public class JmsConnection implements Connection, TopicConnection, QueueConnecti
 
         try {
             ProviderFuture request = new ProviderFuture();
-            provider.destroy(resource, request);
-            request.sync();
+            requests.put(request, request);
+            try {
+                provider.destroy(resource, request);
+                request.sync();
+            } finally {
+                requests.remove(request);
+            }
         } catch (Exception ioe) {
             throw JmsExceptionSupport.create(ioe);
         }
@@ -716,8 +736,13 @@ public class JmsConnection implements Connection, TopicConnection, QueueConnecti
 
         try {
             ProviderFuture request = new ProviderFuture();
-            provider.unsubscribe(name, request);
-            request.sync();
+            requests.put(request, request);
+            try {
+                provider.unsubscribe(name, request);
+                request.sync();
+            } finally {
+                requests.remove(request);
+            }
         } catch (Exception ioe) {
             throw JmsExceptionSupport.create(ioe);
         }
@@ -729,8 +754,13 @@ public class JmsConnection implements Connection, TopicConnection, QueueConnecti
 
         try {
             ProviderFuture request = new ProviderFuture();
-            provider.commit(sessionId, request);
-            request.sync();
+            requests.put(request, request);
+            try {
+                provider.commit(sessionId, request);
+                request.sync();
+            } finally {
+                requests.remove(request);
+            }
         } catch (Exception ioe) {
             throw JmsExceptionSupport.create(ioe);
         }
@@ -742,8 +772,13 @@ public class JmsConnection implements Connection, TopicConnection, QueueConnecti
 
         try {
             ProviderFuture request = new ProviderFuture();
-            provider.rollback(sessionId, request);
-            request.sync();
+            requests.put(request, request);
+            try {
+                provider.rollback(sessionId, request);
+                request.sync();
+            } finally {
+                requests.remove(request);
+            }
         } catch (Exception ioe) {
             throw JmsExceptionSupport.create(ioe);
         }
@@ -755,8 +790,13 @@ public class JmsConnection implements Connection, TopicConnection, QueueConnecti
 
         try {
             ProviderFuture request = new ProviderFuture();
-            provider.recover(sessionId, request);
-            request.sync();
+            requests.put(request, request);
+            try {
+                provider.recover(sessionId, request);
+                request.sync();
+            } finally {
+                requests.remove(request);
+            }
         } catch (Exception ioe) {
             throw JmsExceptionSupport.create(ioe);
         }
@@ -768,8 +808,13 @@ public class JmsConnection implements Connection, TopicConnection, QueueConnecti
 
         try {
             ProviderFuture request = new ProviderFuture();
-            provider.pull(consumerId, timeout, request);
-            request.sync();
+            requests.put(request, request);
+            try {
+                provider.pull(consumerId, timeout, request);
+                request.sync();
+            } finally {
+                requests.remove(request);
+            }
         } catch (Exception ioe) {
             throw JmsExceptionSupport.create(ioe);
         }
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java
index a3b2b15a..5acb1bf6 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java
@@ -27,6 +27,7 @@ import static org.hamcrest.Matchers.allOf;
 import static org.hamcrest.Matchers.arrayContaining;
 import static org.hamcrest.Matchers.equalTo;
 import static org.hamcrest.Matchers.hasEntry;
+import static org.hamcrest.Matchers.notNullValue;
 import static org.hamcrest.Matchers.nullValue;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertNotNull;
@@ -116,6 +117,50 @@ public class ConnectionIntegrationTest extends QpidJmsTestCase {
         }
     }
 
+    @Test(timeout = 20000)
+    public void testRemotelyCloseConnectionDuringSessionCreation() throws Exception {
+        final String BREAD_CRUMB = "ErrorMessageBreadCrumb";
+
+        try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
+            Connection connection = testFixture.establishConnecton(testPeer);
+
+            // Expect the begin, then explicitly close the connection with an error
+            testPeer.expectBegin(notNullValue(), false);
+            testPeer.remotelyCloseConnection(true, AmqpError.NOT_ALLOWED, BREAD_CRUMB);
+
+            try {
+                connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
+                fail("Expected exception to be thrown");
+            } catch (JMSException jmse) {
+                // Expected
+                assertNotNull("Expected exception to have a message", jmse.getMessage());
+                assertTrue("Expected breadcrumb to be present in message", jmse.getMessage().contains(BREAD_CRUMB));
+            }
+
+            testPeer.waitForAllHandlersToComplete(3000);
+        }
+    }
+
+    @Test(timeout = 20000)
+    public void testRemotelyDropConnectionDuringSessionCreation() throws Exception {
+        try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
+            Connection connection = testFixture.establishConnecton(testPeer);
+
+            // Expect the begin, then drop connection without without a close frame.
+            testPeer.expectBegin(notNullValue(), false);
+            testPeer.dropAfterLastHandler();
+
+            try {
+                connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
+                fail("Expected exception to be thrown");
+            } catch (JMSException jmse) {
+                // Expected
+            }
+
+            testPeer.waitForAllHandlersToComplete(3000);
+        }
+    }
+
     @Test(timeout = 20000)
     public void testConnectionMetaDataVersion() throws Exception {
         try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SessionIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SessionIntegrationTest.java
index a982d846..47add865 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SessionIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SessionIntegrationTest.java
@@ -1457,7 +1457,7 @@ public class SessionIntegrationTest extends QpidJmsTestCase {
         try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
             Connection connection = testFixture.establishConnecton(testPeer, options);
 
-            testPeer.expectBegin(equalTo(UnsignedInteger.valueOf(value)));
+            testPeer.expectBegin(equalTo(UnsignedInteger.valueOf(value)), true);
             Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
 
             assertNotNull("Session should not be null", session);
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/provider/failover/FailoverIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/provider/failover/FailoverIntegrationTest.java
index 3acf71e2..f5347302 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/provider/failover/FailoverIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/provider/failover/FailoverIntegrationTest.java
@@ -256,7 +256,8 @@ public class FailoverIntegrationTest extends QpidJmsTestCase {
             originalPeer.expectBegin();
             originalPeer.expectBegin();
             originalPeer.expectReceiverAttach();
-            originalPeer.expectLinkFlowThenDrop();
+            originalPeer.expectLinkFlow(true, false, equalTo(UnsignedInteger.ONE));
+            originalPeer.dropAfterLastHandler();
 
             final JmsConnection connection = establishAnonymousConnecton(originalPeer, finalPeer);
             connection.getPrefetchPolicy().setQueuePrefetch(0);
@@ -324,7 +325,8 @@ public class FailoverIntegrationTest extends QpidJmsTestCase {
             originalPeer.expectBegin();
             originalPeer.expectBegin();
             originalPeer.expectReceiverAttach();
-            originalPeer.expectLinkFlowThenDrop();
+            originalPeer.expectLinkFlow();
+            originalPeer.dropAfterLastHandler();
 
             final JmsConnection connection = establishAnonymousConnecton(originalPeer, finalPeer);
             connection.getPrefetchPolicy().setQueuePrefetch(0);
@@ -394,7 +396,8 @@ public class FailoverIntegrationTest extends QpidJmsTestCase {
             originalPeer.expectBegin();
             originalPeer.expectBegin();
             originalPeer.expectReceiverAttach();
-            originalPeer.expectLinkFlowThenDrop();
+            originalPeer.expectLinkFlow();
+            originalPeer.dropAfterLastHandler();
 
             final JmsConnection connection = establishAnonymousConnecton(originalPeer, finalPeer);
             connection.getPrefetchPolicy().setQueuePrefetch(0);
@@ -491,7 +494,8 @@ public class FailoverIntegrationTest extends QpidJmsTestCase {
             originalPeer.expectBegin();
             originalPeer.expectQueueBrowserAttach();
             originalPeer.expectLinkFlow();
-            originalPeer.expectLinkFlowThenDrop();
+            originalPeer.expectLinkFlow(true, false, equalTo(UnsignedInteger.valueOf(JmsPrefetchPolicy.DEFAULT_QUEUE_BROWSER_PREFETCH)));
+            originalPeer.dropAfterLastHandler();
 
             // --- Post Failover Expectations of FinalPeer --- //
 
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java
index 9fae2d1d..040cded6 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java
@@ -614,10 +614,10 @@ public class TestAmqpPeer implements AutoCloseable
 
     public void expectBegin()
     {
-        expectBegin(notNullValue());
+        expectBegin(notNullValue(), true);
     }
 
-    public void expectBegin(Matcher<?> outgoingWindowMatcher)
+    public void expectBegin(Matcher<?> outgoingWindowMatcher, boolean sendResponse)
     {
         final BeginMatcher beginMatcher = new BeginMatcher()
                 .withRemoteChannel(nullValue())
@@ -632,29 +632,31 @@ public class TestAmqpPeer implements AutoCloseable
             beginMatcher.withOutgoingWindow(outgoingWindowMatcher);
         }
 
-        // The response will have its remoteChannel field dynamically set based on incoming value
-        final BeginFrame beginResponse = new BeginFrame()
+        if(sendResponse) {
+            // The response will have its remoteChannel field dynamically set based on incoming value
+            final BeginFrame beginResponse = new BeginFrame()
             .setNextOutgoingId(UnsignedInteger.ONE)
             .setIncomingWindow(UnsignedInteger.ZERO)
             .setOutgoingWindow(UnsignedInteger.ZERO);
 
-        // The response frame channel will be dynamically set based on the incoming frame. Using the -1 is an illegal placeholder.
-        final FrameSender beginResponseSender = new FrameSender(this, FrameType.AMQP, -1, beginResponse, null);
-        beginResponseSender.setValueProvider(new ValueProvider()
-        {
-            @Override
-            public void setValues()
+            // The response frame channel will be dynamically set based on the incoming frame. Using the -1 is an illegal placeholder.
+            final FrameSender beginResponseSender = new FrameSender(this, FrameType.AMQP, -1, beginResponse, null);
+            beginResponseSender.setValueProvider(new ValueProvider()
             {
-                int actualChannel = beginMatcher.getActualChannel();
+                @Override
+                public void setValues()
+                {
+                    int actualChannel = beginMatcher.getActualChannel();
 
-                beginResponseSender.setChannel(actualChannel);
-                beginResponse.setRemoteChannel(
-                        UnsignedShort.valueOf((short) actualChannel));
+                    beginResponseSender.setChannel(actualChannel);
+                    beginResponse.setRemoteChannel(
+                            UnsignedShort.valueOf((short) actualChannel));
 
-                _lastInitiatedChannel = actualChannel;
-            }
-        });
-        beginMatcher.onCompletion(beginResponseSender);
+                    _lastInitiatedChannel = actualChannel;
+                }
+            });
+            beginMatcher.onCompletion(beginResponseSender);
+        }
 
         addHandler(beginMatcher);
     }
@@ -1672,17 +1674,14 @@ public class TestAmqpPeer implements AutoCloseable
         addHandler(new HeaderHandlerImpl(AmqpHeader.SASL_HEADER, AmqpHeader.SASL_HEADER, exitAfterHeader));
     }
 
-    public void expectLinkFlowThenDrop()
-    {
-        AmqpPeerRunnable exitAfterFlow = new AmqpPeerRunnable() {
+    public void dropAfterLastHandler() {
+        AmqpPeerRunnable exitEarly = new AmqpPeerRunnable() {
             @Override
             public void run() {
                 _driverRunnable.exitReadLoopEarly();
             }
         };
 
-        final FlowMatcher flowMatcher = new FlowMatcher().onCompletion(exitAfterFlow);
-
-        addHandler(flowMatcher);
+        runAfterLastHandler(exitEarly);
     }
 }
