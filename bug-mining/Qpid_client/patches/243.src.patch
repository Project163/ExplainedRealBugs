diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ProducerIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ProducerIntegrationTest.java
index dc885250..ceba81f4 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ProducerIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ProducerIntegrationTest.java
@@ -3107,7 +3107,7 @@ public class ProducerIntegrationTest extends QpidJmsTestCase {
      * @throws Exception
      */
     @Repeat(repetitions = 1)
-    @Test(timeout = 20000)
+    @Test(timeout = 35000)
     public void testSendToRemotelyClosedProducerFailsIfSendAfterDetached() throws Exception {
         try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
             JmsConnection connection = (JmsConnection) testFixture.establishConnecton(testPeer);
@@ -3159,6 +3159,11 @@ public class ProducerIntegrationTest extends QpidJmsTestCase {
             session.close();
 
             testPeer.waitForAllHandlersToComplete(1000);
+
+            testPeer.expectClose();
+            connection.close();
+
+            testPeer.waitForAllHandlersToComplete(1000);
         }
     }
 }
