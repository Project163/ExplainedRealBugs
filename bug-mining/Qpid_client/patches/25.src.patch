diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/IdleTimeoutIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/IdleTimeoutIntegrationTest.java
index 6e7db222..9fe598c7 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/IdleTimeoutIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/IdleTimeoutIntegrationTest.java
@@ -179,7 +179,7 @@ public class IdleTimeoutIntegrationTest extends QpidJmsTestCase {
 
             testPeer.waitForAllHandlersToComplete(1000);
             // The peer is still connected, so it will get the close frame with error
-            testPeer.expectClose(Matchers.notNullValue());
+            testPeer.expectClose(Matchers.notNullValue(), false);
             assertNull(testPeer.getThrowable());
             testPeer.setSuppressReadExceptionOnClose(true);
 
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SaslIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SaslIntegrationTest.java
index 19a6b85b..d2222c91 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SaslIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/SaslIntegrationTest.java
@@ -37,6 +37,7 @@ import org.apache.qpid.jms.test.testpeer.TestAmqpPeer;
 import org.apache.qpid.jms.transports.TransportSslOptions;
 import org.apache.qpid.jms.transports.TransportSupport;
 import org.apache.qpid.proton.amqp.Symbol;
+import org.hamcrest.Matchers;
 import org.junit.Test;
 
 public class SaslIntegrationTest extends QpidJmsTestCase {
@@ -153,6 +154,10 @@ public class SaslIntegrationTest extends QpidJmsTestCase {
 
             testPeer.expectFailingSaslConnect(serverMechs, clientSelectedMech);
 
+            // Work around race with test peer close
+            testPeer.expectHeaderAndOpen();
+            testPeer.expectClose(Matchers.nullValue(), false);
+
             ConnectionFactory factory = new JmsConnectionFactory("amqp://localhost:" + testPeer.getServerPort() + "?jms.clientID=myclientid");
             try {
                 factory.createConnection(username, password);
@@ -200,6 +205,10 @@ public class SaslIntegrationTest extends QpidJmsTestCase {
 
             testPeer.expectFailingSaslConnect(serverMechs, clientSelectedMech);
 
+            // Work around race with test peer close
+            testPeer.expectHeaderAndOpen();
+            testPeer.expectClose(Matchers.nullValue(), false);
+
             JmsConnectionFactory factory = new JmsConnectionFactory("amqps://localhost:" + testPeer.getServerPort() + connOptions);
             try {
                 factory.createConnection();
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java
index d4adeb79..7822c80d 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java
@@ -600,16 +600,25 @@ public class TestAmqpPeer implements AutoCloseable
 
     public void expectClose()
     {
-        expectClose(Matchers.nullValue());
+        expectClose(Matchers.nullValue(), true);
     }
 
-    public void expectClose(Matcher<?> errorMatcher)
+    public void expectClose(Matcher<?> errorMatcher, boolean sendReply)
     {
-        addHandler(new CloseMatcher()
-            .withError(errorMatcher)
-            .onSuccess(new FrameSender(this, FrameType.AMQP, 0,
+        CloseMatcher closeMatcher = new CloseMatcher().withError(errorMatcher);
+        if(sendReply) {
+            closeMatcher.onSuccess(new FrameSender(this, FrameType.AMQP, 0,
                     new CloseFrame(),
-                    null)));
+                    null));
+        }
+
+        addHandler(closeMatcher);
+    }
+
+    public void expectHeaderAndOpen()
+    {
+        addHandler(new HeaderHandlerImpl(AmqpHeader.HEADER, AmqpHeader.HEADER));
+        addHandler(new OpenMatcher());
     }
 
     public void expectBegin(boolean expectSessionFlow)
