diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
index 45079597..246fcbc7 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
@@ -87,9 +87,12 @@ public abstract class AmqpAbstractResource<R extends JmsResource, E extends Endp
 
         resourceInfo.setState(ResourceState.CLOSED);
 
-        // If already closed signal success or else the caller might never get notified.
+        // If the current state of the connection or the provider doesn't match what we'd expect for
+        // a normal close chain of events then we can assume something else went wrong or was triggered
+        // by the remote so we just close our end and cleanup.
         if (getEndpoint().getLocalState() == EndpointState.CLOSED ||
-            getEndpoint().getRemoteState() == EndpointState.CLOSED) {
+            getEndpoint().getRemoteState() == EndpointState.CLOSED ||
+            getParent().getProvider().isFailed()) {
 
             // Remote already closed this resource, close locally and free.
             if (getEndpoint().getLocalState() != EndpointState.CLOSED) {
diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpProvider.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpProvider.java
index 8880e3a3..59aa3831 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpProvider.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpProvider.java
@@ -1012,11 +1012,17 @@ public class AmqpProvider implements Provider, TransportListener , AmqpResourceP
                     case TRANSPORT_ERROR:
                         // We handle authentication failure elsewhere, but in doing so we close the transport
                         // head which would also get us here, so only action this if auth succeeded.
-                        if(authenticator == null || (authenticator.isComplete() && authenticator.wasSuccessful())) {
+                        if (authenticator == null || (authenticator.isComplete() && authenticator.wasSuccessful())) {
                             protonTransportErrorHandled = true;
                             ErrorCondition transportCondition = protonTransport.getCondition();
                             String message = extractTransportErrorMessage(transportCondition);
 
+                            // Transport has failed, ensure that we see local end of connection as closed
+                            // so other shutdown processing doesn't mistakenly assume we can still get a
+                            // close from the remote.
+                            protonConnection.setCondition(transportCondition);
+                            protonConnection.close();
+
                             throw new ProviderFailedException(message);
                         }
                         break;
@@ -1444,6 +1450,14 @@ public class AmqpProvider implements Provider, TransportListener , AmqpResourceP
         return remoteURI;
     }
 
+    public Throwable getFailureCause() {
+        return failureCause;
+    }
+
+    public boolean isFailed() {
+        return failureCause != null;
+    }
+
     @Override
     public List<URI> getAlternateURIs() {
         List<URI> alternates = new ArrayList<>();
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/TransactionsIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/TransactionsIntegrationTest.java
index 5eeecdb7..abfd4b50 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/TransactionsIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/TransactionsIntegrationTest.java
@@ -1688,6 +1688,7 @@ public class TransactionsIntegrationTest extends QpidJmsTestCase {
         }
     }
 
+    @Repeat(repetitions = 1)
     @Test(timeout=20000)
     public void testTransactionDeclaredDispositionWithoutTxnId() throws Exception {
         try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
