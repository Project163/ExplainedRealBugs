diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsMessageConsumer.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsMessageConsumer.java
index 893a5767..de7ef63f 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsMessageConsumer.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsMessageConsumer.java
@@ -106,11 +106,16 @@ public class JmsMessageConsumer implements AutoCloseable, MessageConsumer, JmsMe
         consumerInfo.setPresettle(session.getPresettlePolicy().isConsumerPresttled(session, destination));
         consumerInfo.setDeserializationPolicy(deserializationPolicy);
 
-        session.getConnection().createResource(consumerInfo);
+        session.add(this);
+        try {
+            session.getConnection().createResource(consumerInfo);
+        } catch (JMSException jmse) {
+            session.remove(this);
+            throw jmse;
+        }
     }
 
     public void init() throws JMSException {
-        session.add(this);
         startConsumerResource();
     }
 
diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsMessageProducer.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsMessageProducer.java
index e040068b..a1bbe38b 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsMessageProducer.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsMessageProducer.java
@@ -64,7 +64,13 @@ public class JmsMessageProducer implements AutoCloseable, MessageProducer {
         this.producerInfo.setDestination(destination);
         this.producerInfo.setPresettle(session.getPresettlePolicy().isProducerPresttled(session, destination));
 
-        session.getConnection().createResource(producerInfo);
+        session.add(this);
+        try {
+            session.getConnection().createResource(producerInfo);
+        } catch (JMSException jmse) {
+            session.remove(this);
+            throw jmse;
+        }
     }
 
     @Override
diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsSession.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsSession.java
index b8aded82..4644267f 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsSession.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsSession.java
@@ -469,7 +469,6 @@ public class JmsSession implements AutoCloseable, Session, QueueSession, TopicSe
         checkClosed();
         JmsDestination dest = JmsMessageTransformation.transformDestination(connection, destination);
         JmsMessageProducer result = new JmsMessageProducer(getNextProducerId(), this, dest);
-        add(result);
         return result;
     }
 
@@ -481,7 +480,6 @@ public class JmsSession implements AutoCloseable, Session, QueueSession, TopicSe
         checkClosed();
         JmsDestination dest = JmsMessageTransformation.transformDestination(connection, queue);
         JmsQueueSender result = new JmsQueueSender(getNextProducerId(), this, dest);
-        add(result);
         return result;
     }
 
@@ -493,7 +491,6 @@ public class JmsSession implements AutoCloseable, Session, QueueSession, TopicSe
         checkClosed();
         JmsDestination dest = JmsMessageTransformation.transformDestination(connection, topic);
         JmsTopicPublisher result = new JmsTopicPublisher(getNextProducerId(), this, dest);
-        add(result);
         return result;
     }
 
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ProducerIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ProducerIntegrationTest.java
index c334be0b..6c53398d 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ProducerIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ProducerIntegrationTest.java
@@ -40,7 +40,6 @@ import java.util.Set;
 import java.util.UUID;
 import java.util.concurrent.CountDownLatch;
 import java.util.concurrent.TimeUnit;
-import java.util.concurrent.atomic.AtomicBoolean;
 
 import javax.jms.Connection;
 import javax.jms.DeliveryMode;
@@ -866,12 +865,12 @@ public class ProducerIntegrationTest extends QpidJmsTestCase {
         final String BREAD_CRUMB = "ErrorMessageBreadCrumb";
 
         try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
-            final AtomicBoolean producerClosed = new AtomicBoolean();
+            final CountDownLatch producerClosed = new CountDownLatch(1);
             JmsConnection connection = (JmsConnection) testFixture.establishConnecton(testPeer);
             connection.addConnectionListener(new JmsDefaultConnectionListener() {
                 @Override
                 public void onProducerClosed(MessageProducer producer, Exception exception) {
-                    producerClosed.set(true);
+                    producerClosed.countDown();
                 }
             });
 
@@ -908,7 +907,7 @@ public class ProducerIntegrationTest extends QpidJmsTestCase {
                 }
             }, 10000, 10));
 
-            assertTrue("Producer closed callback didn't trigger", producerClosed.get());
+            assertTrue("Producer closed callback didn't trigger", producerClosed.await(10, TimeUnit.SECONDS));
 
             // Try closing it explicitly, should effectively no-op in client.
             // The test peer will throw during close if it sends anything.
