diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
index a7d243f1..a8599ac4 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpAbstractResource.java
@@ -155,7 +155,7 @@ public abstract class AmqpAbstractResource<R extends JmsResource, E extends Endp
         if (endpoint != null) {
             // TODO: if this is a producer/consumer link then we may only be detached,
             // rather than fully closed, and should respond appropriately.
-            endpoint.close();
+            closeOrDetachEndpoint();
         }
 
         // Process the close now, so that child close operations see the correct state.
diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpConsumer.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpConsumer.java
index a162af30..c15fd088 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpConsumer.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpConsumer.java
@@ -123,7 +123,7 @@ public class AmqpConsumer extends AmqpAbstractResource<JmsConsumerInfo, Receiver
                         Exception cause = new JmsOperationTimedOutException("Remote did not respond to a drain request in time");
                         locallyClosed(session.getProvider(), cause);
                         stopRequest.onFailure(cause);
-                        session.getProvider().pumpToProtonTransport(stopRequest);
+                        session.getProvider().pumpToProtonTransport();
                     }
                 }, getDrainTimeout());
 
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConsumerIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConsumerIntegrationTest.java
index 4f59bc8c..b9403018 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConsumerIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConsumerIntegrationTest.java
@@ -755,15 +755,25 @@ public class ConsumerIntegrationTest extends QpidJmsTestCase {
 
     @Test(timeout=30000)
     public void testReceiveWithTimoutAndNoDrainResponseFailsAfterTimeout() throws IOException, Exception {
-        doDrainWithNoResponseOnNoMessageTestImpl(false);
+        doDrainWithNoResponseOnNoMessageTestImpl(false, false);
     }
 
     @Test(timeout=30000)
     public void testReceiveNoWaitAndNoDrainResponseFailsAfterTimeout() throws IOException, Exception {
-        doDrainWithNoResponseOnNoMessageTestImpl(true);
+        doDrainWithNoResponseOnNoMessageTestImpl(true, false);
     }
 
-    private void doDrainWithNoResponseOnNoMessageTestImpl(boolean noWait) throws JMSException, InterruptedException, Exception, IOException {
+    @Test(timeout=30000)
+    public void testDurableReceiveWithTimoutAndNoDrainResponseFailsAfterTimeout() throws IOException, Exception {
+        doDrainWithNoResponseOnNoMessageTestImpl(false, true);
+    }
+
+    @Test(timeout=30000)
+    public void testDurableReceiveNoWaitAndNoDrainResponseFailsAfterTimeout() throws IOException, Exception {
+        doDrainWithNoResponseOnNoMessageTestImpl(true, true);
+    }
+
+    private void doDrainWithNoResponseOnNoMessageTestImpl(boolean noWait, boolean durable) throws JMSException, InterruptedException, Exception, IOException {
         try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
             Connection connection = null;
             connection = testFixture.establishConnecton(testPeer, "?amqp.drainTimeout=500");
@@ -773,19 +783,35 @@ public class ConsumerIntegrationTest extends QpidJmsTestCase {
             testPeer.expectBegin();
 
             Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
-            Queue queue = session.createQueue("myQueue");
+            Topic topic = session.createTopic("topic");
 
             // Expect receiver link attach and send credit
-            testPeer.expectReceiverAttach();
-            testPeer.expectLinkFlow(false, false, equalTo(UnsignedInteger.valueOf(JmsDefaultPrefetchPolicy.DEFAULT_QUEUE_PREFETCH)));
+            if (durable) {
+                testPeer.expectDurableSubscriberAttach(topic.getTopicName(), getTestName());
+            } else {
+                testPeer.expectReceiverAttach();
+            }
+
+            testPeer.expectLinkFlow(false, false, equalTo(UnsignedInteger.valueOf(JmsDefaultPrefetchPolicy.DEFAULT_TOPIC_PREFETCH)));
 
             // Expect drain but do not respond so that the consumer times out.
-            testPeer.expectLinkFlow(true, false, equalTo(UnsignedInteger.valueOf(JmsDefaultPrefetchPolicy.DEFAULT_QUEUE_PREFETCH)));
+            testPeer.expectLinkFlow(true, false, equalTo(UnsignedInteger.valueOf(JmsDefaultPrefetchPolicy.DEFAULT_TOPIC_PREFETCH)));
 
             // Consumer should close due to timed waiting for drain.
-            testPeer.expectDetach(true, true, true);
+            if (durable) {
+                // TODO - Bug in Proton-J causes extra flow to be emitted on detach.
+                testPeer.expectLinkFlow(true, false, equalTo(UnsignedInteger.valueOf(JmsDefaultPrefetchPolicy.DEFAULT_TOPIC_PREFETCH)));
+                testPeer.expectDetach(false, true, true);
+            } else {
+                testPeer.expectDetach(true, true, true);
+            }
 
-            final MessageConsumer consumer = session.createConsumer(queue);
+            final MessageConsumer consumer;
+            if (durable) {
+                consumer = session.createDurableSubscriber(topic, getTestName());
+            } else {
+                consumer = session.createConsumer(topic);
+            }
 
             try {
                 if (noWait) {
