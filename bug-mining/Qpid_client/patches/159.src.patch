diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsSession.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsSession.java
index 700d36f7..a821c187 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsSession.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/JmsSession.java
@@ -142,8 +142,19 @@ public class JmsSession implements AutoCloseable, Session, QueueSession, TopicSe
 
         connection.createResource(sessionInfo);
 
-        // We always keep an open TX so start now.
-        getTransactionContext().begin();
+        // We always keep an open TX if transacted so start now.
+        try {
+            getTransactionContext().begin();
+        } catch (Exception e) {
+            // failed, close the AMQP session before we throw
+            try {
+                connection.destroyResource(sessionInfo);
+            } catch (Exception ex) {
+                // Ignore, throw original error
+            }
+
+            throw e;
+        }
 
         // Start the completion executor now as it's needed throughout the
         // lifetime of the Session.
diff --git a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpTransactionCoordinator.java b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpTransactionCoordinator.java
index 567e43d4..caf6921e 100644
--- a/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpTransactionCoordinator.java
+++ b/qpid-jms-client/src/main/java/org/apache/qpid/jms/provider/amqp/AmqpTransactionCoordinator.java
@@ -90,7 +90,7 @@ public class AmqpTransactionCoordinator extends AmqpAbstractResource<JmsSessionI
                     Exception cause = AmqpSupport.convertToException(
                         getParent().getProvider(), getEndpoint(), rejected.getError());
                     JMSException failureCause = null;
-                    if (txId.getProviderContext().equals(COMMIT_MARKER)) {
+                    if (COMMIT_MARKER.equals(txId.getProviderContext())){
                         failureCause = new TransactionRolledBackException(cause.getMessage());
                     } else {
                         failureCause = new JMSException(cause.getMessage());
@@ -133,7 +133,7 @@ public class AmqpTransactionCoordinator extends AmqpAbstractResource<JmsSessionI
         Declare declare = new Declare();
         message.setBody(new AmqpValue(declare));
 
-        ScheduledFuture<?> timeout = scheduleTimeoutIfNeeded("Timed out waiting for discharge of TX.", request);
+        ScheduledFuture<?> timeout = scheduleTimeoutIfNeeded("Timed out waiting for declare of TX.", request);
         OperationContext context = new OperationContext(txId, request, timeout);
 
         Delivery delivery = getEndpoint().delivery(tagGenerator.getNextTag());
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java
index d8c713fe..3e12fd98 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/ConnectionIntegrationTest.java
@@ -258,6 +258,8 @@ public class ConnectionIntegrationTest extends QpidJmsTestCase {
             txCoordinatorMatcher.withCapabilities(arrayContaining(TxnCapability.LOCAL_TXN));
             testPeer.expectSenderAttach(notNullValue(), txCoordinatorMatcher, true, true, false, 0, null, null);
             testPeer.expectDetach(true, false, false);
+            // Expect the AMQP session to be closed due to the JMS session creation failure.
+            testPeer.expectEnd();
 
             try {
                 connection.createSession(true, Session.SESSION_TRANSACTED);
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/TransactionsIntegrationTest.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/TransactionsIntegrationTest.java
index 47af07fc..d026b2cd 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/TransactionsIntegrationTest.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/integration/TransactionsIntegrationTest.java
@@ -52,6 +52,7 @@ import org.apache.qpid.jms.message.JmsInboundMessageDispatch;
 import org.apache.qpid.jms.policy.JmsDefaultPrefetchPolicy;
 import org.apache.qpid.jms.test.QpidJmsTestCase;
 import org.apache.qpid.jms.test.testpeer.TestAmqpPeer;
+import org.apache.qpid.jms.test.testpeer.basictypes.AmqpError;
 import org.apache.qpid.jms.test.testpeer.describedtypes.Accepted;
 import org.apache.qpid.jms.test.testpeer.describedtypes.Declare;
 import org.apache.qpid.jms.test.testpeer.describedtypes.Declared;
@@ -1251,6 +1252,8 @@ public class TransactionsIntegrationTest extends QpidJmsTestCase {
             testPeer.expectBegin();
             testPeer.expectCoordinatorAttach();
             testPeer.expectDeclareButDoNotRespond();
+            // Expect the AMQP session to be closed due to the JMS session creation failure.
+            testPeer.expectEnd();
 
             try {
                 connection.createSession(true, Session.SESSION_TRANSACTED);
@@ -1268,6 +1271,66 @@ public class TransactionsIntegrationTest extends QpidJmsTestCase {
         }
     }
 
+    @Test(timeout=20000)
+    public void testSessionCreateFailsOnDeclareRejection() throws Exception {
+        try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
+            Connection connection = testFixture.establishConnecton(testPeer);
+            connection.start();
+
+            testPeer.expectBegin();
+            testPeer.expectCoordinatorAttach();
+
+            // First expect an unsettled 'declare' transfer to the txn coordinator, and
+            // reply with a Rejected disposition state to indicate failure.
+            testPeer.expectDeclareAndReject();
+            // Expect the AMQP session to be closed due to the JMS session creation failure.
+            testPeer.expectEnd();
+
+            try {
+                connection.createSession(true, Session.SESSION_TRANSACTED);
+                fail("should have thrown");
+            } catch (JMSException jmse) {
+                // Expected
+            }
+
+            testPeer.expectClose();
+            connection.close();
+
+            testPeer.waitForAllHandlersToComplete(1000);
+        }
+    }
+
+    @Test(timeout=20000)
+    public void testSessionCreateFailsOnCoordinatorLinkRefusal() throws Exception {
+        try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
+            Connection connection = testFixture.establishConnecton(testPeer);
+            connection.start();
+
+            testPeer.expectBegin();
+
+            // Expect coordinator link, refuse it, expect detach reply
+            String errorMessage = "CoordinatorLinkRefusal-breadcrumb";
+            testPeer.expectCoordinatorAttach(true, false, AmqpError.NOT_IMPLEMENTED, errorMessage);
+            testPeer.expectDetach(true, false, false);
+
+            // Expect the AMQP session to be closed due to the JMS session creation failure.
+            testPeer.expectEnd();
+
+            try {
+                connection.createSession(true, Session.SESSION_TRANSACTED);
+                fail("should have thrown");
+            } catch (JMSException jmse) {
+                assertNotNull(jmse.getMessage());
+                assertTrue("Expected exception message to contain breadcrumb", jmse.getMessage().contains(errorMessage));
+            }
+
+            testPeer.expectClose();
+            connection.close();
+
+            testPeer.waitForAllHandlersToComplete(1000);
+        }
+    }
+
     @Test(timeout=20000)
     public void testTransactionRolledBackOnSessionCloseTimesOut() throws Exception {
         try (TestAmqpPeer testPeer = new TestAmqpPeer();) {
diff --git a/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java b/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java
index ffbafa73..2e2c9af3 100644
--- a/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java
+++ b/qpid-jms-client/src/test/java/org/apache/qpid/jms/test/testpeer/TestAmqpPeer.java
@@ -78,6 +78,7 @@ import org.apache.qpid.jms.test.testpeer.describedtypes.EndFrame;
 import org.apache.qpid.jms.test.testpeer.describedtypes.FlowFrame;
 import org.apache.qpid.jms.test.testpeer.describedtypes.FrameDescriptorMapping;
 import org.apache.qpid.jms.test.testpeer.describedtypes.OpenFrame;
+import org.apache.qpid.jms.test.testpeer.describedtypes.Rejected;
 import org.apache.qpid.jms.test.testpeer.describedtypes.Released;
 import org.apache.qpid.jms.test.testpeer.describedtypes.SaslChallengeFrame;
 import org.apache.qpid.jms.test.testpeer.describedtypes.SaslMechanismsFrame;
@@ -2082,6 +2083,14 @@ public class TestAmqpPeer implements AutoCloseable
         expectTransfer(declareMatcher, nullValue(), false, false, null, false);
     }
 
+    public void expectDeclareAndReject()
+    {
+        TransferPayloadCompositeMatcher declareMatcher = new TransferPayloadCompositeMatcher();
+        declareMatcher.setMessageContentMatcher(new EncodedAmqpValueMatcher(new Declare()));
+
+        expectTransfer(declareMatcher, nullValue(), false, new Rejected(), true);
+    }
+
     public void expectDischarge(Binary txnId, boolean dischargeState) {
         expectDischarge(txnId, dischargeState, new Accepted());
     }
