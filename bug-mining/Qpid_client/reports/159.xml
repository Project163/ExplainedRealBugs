<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:18:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPIDJMS-307] fix handling of tx declare rejection while creating a transacted Session</title>
                <link>https://issues.apache.org/jira/browse/QPIDJMS-307</link>
                <project id="12314524" key="QPIDJMS">Qpid JMS</project>
                    <description>&lt;p&gt;The client doesnt currently handle the failure to create a transacted session when running against Dispatch 0.7.0, NPE&apos;ing in the process giving the exception below rather than a more helpful exception, as detailed at &lt;a href=&quot;https://lists.apache.org/thread.html/b81df836d2bd11801f1aaf5e835de19ac14d10a0e5b14f64f5aa663c@%3Cusers.qpid.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread.html/b81df836d2bd11801f1aaf5e835de19ac14d10a0e5b14f64f5aa663c@%3Cusers.qpid.apache.org%3E&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;javax.jms.JMSException: java.lang.NullPointerException
at
org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:86)
at
org.apache.qpid.jms.exceptions.JmsExceptionSupport.create(JmsExceptionSupport.java:108)
at org.apache.qpid.jms.JmsConnection.createResource(JmsConnection.java:609)
at
org.apache.qpid.jms.JmsLocalTransactionContext.begin(JmsLocalTransactionContext.java:125)
at org.apache.qpid.jms.JmsSession.&amp;lt;init&amp;gt;(JmsSession.java:143)
at org.apache.qpid.jms.JmsConnection.createSession(JmsConnection.java:299)
at org.myorg.mymessaging.PostOffice.buildSession(PostOffice.java:149)
...
Caused by: java.io.IOException: java.lang.NullPointerException
at
org.apache.qpid.jms.util.IOExceptionSupport.create(IOExceptionSupport.java:45)
at
org.apache.qpid.jms.provider.amqp.AmqpTransactionCoordinator.processDeliveryUpdates(AmqpTransactionCoordinator.java:117)
at
org.apache.qpid.jms.provider.amqp.AmqpProvider.processUpdates(AmqpProvider.java:928)
at
org.apache.qpid.jms.provider.amqp.AmqpProvider.access$1800(AmqpProvider.java:93)
at
org.apache.qpid.jms.provider.amqp.AmqpProvider$18.run(AmqpProvider.java:790)
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
at java.util.concurrent.FutureTask.run(FutureTask.java:266)
at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
at
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.NullPointerException
at
org.apache.qpid.jms.provider.amqp.AmqpTransactionCoordinator.processDeliveryUpdates(AmqpTransactionCoordinator.java:93)
... 10 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13091851">QPIDJMS-307</key>
            <summary>fix handling of tx declare rejection while creating a transacted Session</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="robbie">Robbie Gemmell</assignee>
                                    <reporter username="robbie">Robbie Gemmell</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Aug 2017 10:35:20 +0000</created>
                <updated>Wed, 30 Aug 2017 14:26:33 +0000</updated>
                            <resolved>Thu, 3 Aug 2017 17:23:50 +0000</resolved>
                                    <version>0.23.0</version>
                                    <fixVersion>0.24.0</fixVersion>
                                    <component>qpid-jms-client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16111817" author="danlangford" created="Wed, 2 Aug 2017 22:13:04 +0000"  >&lt;p&gt;for the record this was against Dispatch 0.7.0. Now that I have upgraded to Dispatch 0.8.0 I do not see a NPE. instead the code seems to just &quot;hang&quot; or wait when creating a session. this is with no linkRoute $coordinator configured yet&lt;/p&gt;</comment>
                            <comment id="16112910" author="gemmellr" created="Thu, 3 Aug 2017 15:17:13 +0000"  >&lt;p&gt;There are a variety of bugs and behaviours in play here.&lt;/p&gt;

&lt;p&gt;The router is accepting the clients transaction coordination link, whereas it should actually refuse it if it knows it hasnt been link-routed somewhere, since it doesnt coordinate transactions itself, ergo no reason to accept the link. I&apos;ve raised &lt;a href=&quot;https://issues.apache.org/jira/browse/DISPATCH-802&quot; title=&quot;refuse transaction coordination links if they can&amp;#39;t be routed to a coordinator&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DISPATCH-802&quot;&gt;&lt;del&gt;DISPATCH-802&lt;/del&gt;&lt;/a&gt; for this.&lt;/p&gt;

&lt;p&gt;In 0.7.0 Dispatch would grant credit to senders for an address even if it knew there were no receivers for it. This would allow the client to actually try and declare a transaction. The router presumably rejected that declare. The client mishandled the rejection, giving you the exception you saw.&lt;/p&gt;

&lt;p&gt;In 0.8.0 the router does not grant credit to senders on adddresses it knows have no receivers. It still erroneously accepts the coordinator link, but it doesnt give any credit, so the client doesnt get as far as sending its transaction declare, and so doesnt get the rejection back, and doesnt fall over it. If you add something like &quot;?jms.requestTimeout=10000&quot; to your URI the client will time out waiting on its declare for the transaction and throw against 0.8.0.&lt;/p&gt;</comment>
                            <comment id="16113127" author="jira-bot" created="Thu, 3 Aug 2017 17:22:42 +0000"  >&lt;p&gt;Commit cc00816c4d4cfca2bcc4f3ac71b86a0e1d53a36d in qpid-jms&apos;s branch refs/heads/master from Robert Gemmell&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=qpid-jms.git;h=cc00816&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=qpid-jms.git;h=cc00816&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-307&quot; title=&quot;fix handling of tx declare rejection while creating a transacted Session&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-307&quot;&gt;&lt;del&gt;QPIDJMS-307&lt;/del&gt;&lt;/a&gt;: avoid NPE during declare rejection, ensure the AMQP session is closed before JMS createSession throws, correct exception message.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13092216">DISPATCH-802</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ibfj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>