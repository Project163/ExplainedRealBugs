<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:18:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPIDJMS-346] No Exception thrown when server indicates error unsubscribing from durable subscription</title>
                <link>https://issues.apache.org/jira/browse/QPIDJMS-346</link>
                <project id="12314524" key="QPIDJMS">Qpid JMS</project>
                    <description>&lt;p&gt;Testing the shared durable subscription functionality against Qpid Broker-J I found that if I attempted to unsubscribe a shared durable subscription from client A, while still having an active consumer from client B, then no exception was thrown in client A.&lt;/p&gt;

&lt;p&gt;The protocol trace from the client A is as follows:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[362461018:0] -&amp;gt; Attach{name=&apos;myDurableSub|global&apos;, handle=0, role=RECEIVER, sndSettleMode=UNSETTLED, rcvSettleMode=FIRST, source=null, target=Target{address=&apos;null&apos;, durable=NONE, expiryPolicy=SESSION_END, timeout=0, dynamic=false, dynamicNodeProperties=null, capabilities=null}, unsettled=null, incompleteUnsettled=false, initialDeliveryCount=null, maxMessageSize=null, offeredCapabilities=null, desiredCapabilities=[shared, global], properties=null}
[362461018:0] &amp;lt;- Attach{name=&apos;myDurableSub|global&apos;, handle=0, role=SENDER, sndSettleMode=UNSETTLED, rcvSettleMode=FIRST, source=Source{address=&apos;topic&apos;, durable=CONFIGURATION, expiryPolicy=NEVER, timeout=0, dynamic=false, dynamicNodeProperties=null, distributionMode=copy, filter=null, defaultOutcome=Modified{deliveryFailed=true, undeliverableHere=null, messageAnnotations=null}, outcomes=[amqp:accepted:list, amqp:released:list, amqp:rejected:list], capabilities=[global, shared, topic]}, target=Target{address=&apos;null&apos;, durable=NONE, expiryPolicy=SESSION_END, timeout=0, dynamic=false, dynamicNodeProperties=null, capabilities=null}, unsettled={}, incompleteUnsettled=false, initialDeliveryCount=0, maxMessageSize=null, offeredCapabilities=[SHARED-SUBS], desiredCapabilities=null, properties={}}
[362461018:0] -&amp;gt; Detach{handle=0, closed=true, error=null}
[362461018:0] &amp;lt;- Detach{handle=0, closed=true, error=Error{condition=amqp:resource-locked, description=&apos;There are consumers on Queue &apos;qpidsub_/_global__/myDurableSub_/durable&apos;&apos;, info=null}}
[362461018:0] -&amp;gt; Close{error=null}
[362461018:0] &amp;lt;- Close{error=null}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;While the broker is sending back a detach with closed=true (which is essentially accurate) it is also providing an error.  The JMS API docs have this to say:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;It is erroneous for a client to delete a durable subscription while there is an active (not closed) consumer for the subscription, or while a consumed message is part of a pending transaction or has not been acknowledged in the session.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So I presume we should be triggering off the fact that the broker sent detach contains an error to throw an appropriate JMSException&lt;/p&gt;</description>
                <environment></environment>
        <key id="13116733">QPIDJMS-346</key>
            <summary>No Exception thrown when server indicates error unsubscribing from durable subscription</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="rgodfrey">Robert Godfrey</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Nov 2017 16:33:18 +0000</created>
                <updated>Mon, 15 Jan 2018 16:16:40 +0000</updated>
                            <resolved>Mon, 11 Dec 2017 16:05:23 +0000</resolved>
                                    <version>0.27.0</version>
                                    <fixVersion>0.28.0</fixVersion>
                                    <component>qpid-jms-client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16256084" author="jira-bot" created="Thu, 16 Nov 2017 22:41:42 +0000"  >&lt;p&gt;Commit 9258e899c22718875a25e37817f76c9994398646 in qpid-jms&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish121&quot; class=&quot;user-hover&quot; rel=&quot;tabish121&quot;&gt;tabish121&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=qpid-jms.git;h=9258e89&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=qpid-jms.git;h=9258e89&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-346&quot; title=&quot;No Exception thrown when server indicates error unsubscribing from durable subscription&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-346&quot;&gt;&lt;del&gt;QPIDJMS-346&lt;/del&gt;&lt;/a&gt; Pass along any errors from result of unsubscribe calls&lt;/p&gt;

&lt;p&gt;When the detach of a recovered durable subscription is received we need&lt;br/&gt;
to check that the remote did not indicate that there was an error on the&lt;br/&gt;
detach.  If there was then the unsubscribe likely failed and we want to&lt;br/&gt;
pass those errors along to the caller of Session#unsubscribe(&quot;sub&quot;)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3mi27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>