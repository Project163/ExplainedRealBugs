<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:19:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPIDJMS-530] Potential NPE in JmsSession consumerClosed()</title>
                <link>https://issues.apache.org/jira/browse/QPIDJMS-530</link>
                <project id="12314524" key="QPIDJMS">Qpid JMS</project>
                    <description>&lt;p&gt;In the following code (JMSSession line 416), if consumer is null this throws a NPE and the consumer never recovers:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;        JmsMessageConsumer consumer = consumers.get(resource.getId());
        if (consumer.hasMessageListener()) {
            connection.onAsyncException(JmsExceptionSupport.create(cause));
        }

        try {
            if (consumer != null) {
                consumer.shutdown(cause);
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Happy to raise a PR myself for this (just ask) but I have had to fix it locally.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13368389">QPIDJMS-530</key>
            <summary>Potential NPE in JmsSession consumerClosed()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tabish">Timothy A. Bish</assignee>
                                    <reporter username="indysilver">David Martin</reporter>
                        <labels>
                    </labels>
                <created>Mon, 29 Mar 2021 14:39:52 +0000</created>
                <updated>Tue, 13 Apr 2021 11:31:43 +0000</updated>
                            <resolved>Mon, 29 Mar 2021 16:23:22 +0000</resolved>
                                    <version>0.56.0</version>
                                    <fixVersion>0.58.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17310765" author="jira-bot" created="Mon, 29 Mar 2021 16:21:57 +0000"  >&lt;p&gt;Commit 7046c7d37c951b07684d3c9bade5e3191c5fc60f in qpid-jms&apos;s branch refs/heads/main from Timothy Bish&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=qpid-jms.git;h=7046c7d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=qpid-jms.git;h=7046c7d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-530&quot; title=&quot;Potential NPE in JmsSession consumerClosed()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-530&quot;&gt;&lt;del&gt;QPIDJMS-530&lt;/del&gt;&lt;/a&gt; Add null check when dealing with consumer remote close&lt;/p&gt;

&lt;p&gt;Possible race on concurrent close from local and remote can lead to NPE&lt;br/&gt;
during remote close handling as consumer might have already removed&lt;br/&gt;
itself from tracking at the session lvel.&lt;/p&gt;</comment>
                            <comment id="17310800" author="indysilver" created="Mon, 29 Mar 2021 17:14:55 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tabish&quot; class=&quot;user-hover&quot; rel=&quot;tabish&quot;&gt;tabish&lt;/a&gt;&#160;Surprisingly seems to have broken a test though.&#160;&lt;/p&gt;</comment>
                            <comment id="17311322" author="gemmellr" created="Tue, 30 Mar 2021 09:32:00 +0000"  >&lt;p&gt;Can you elaborate, what test and failure? All the tests still pass locally for me, and there were no failures across the ~15 different CI runs.&lt;/p&gt;</comment>
                            <comment id="17311376" author="indysilver" created="Tue, 30 Mar 2021 10:29:54 +0000"  >&lt;p&gt;I pulled the commit referenced above and ran mvn test. A single test reported a failure:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[INFO] Running org.apache.qpid.jms.provider.failover.FailoverIntegrationTest
[ERROR] Tests run: 81, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 24.794 s &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.qpid.jms.provider.failover.FailoverIntegrationTest
[ERROR] testTxCommitThrowsWhenNoDischargeResponseSentAndConnectionDrops(org.apache.qpid.jms.provider.failover.FailoverIntegrationTest)  Time elapsed: 5.156 s  &amp;lt;&amp;lt;&amp;lt; FAILURE!
java.lang.AssertionError: Should reported failed
        at org.apache.qpid.jms.provider.failover.FailoverIntegrationTest.testTxCommitThrowsWhenNoDischargeResponseSentAndConnectionDrops(FailoverIntegrationTest.java:2599)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It could be because I&apos;m running Windows? I haven&apos;t had time to look into it but I will have a closer look later.&lt;/p&gt;</comment>
                            <comment id="17311398" author="gemmellr" created="Tue, 30 Mar 2021 10:44:53 +0000"  >&lt;p&gt;Shouldnt be because you are on windows, there are at least 4 runs on Windows amongst the CI runs I mentioned passed. Is it repeatable? If not its perhaps a slight non-deterministic variance or just an unexpected pause in the test thats caused an unexpected one off failure. FWIW I&apos;ve just run the test 1000 times without issue.&lt;/p&gt;</comment>
                            <comment id="17311402" author="indysilver" created="Tue, 30 Mar 2021 10:49:41 +0000"  >&lt;p&gt;It happens every time I run it on my particular machine. Just that one. I&apos;ve re-pulled it to a fresh directory a few times too. I&apos;ll try building v0.56 from source which was what we were using before. Using java&#160;openjdk version &quot;1.8.0_212-8u&quot;&lt;/p&gt;</comment>
                            <comment id="17311453" author="gemmellr" created="Tue, 30 Mar 2021 11:51:42 +0000"  >&lt;p&gt;There doesnt seem to be any way this change could cause that to me, as it only comes into play at all during a remote consumer closure, and that particular test has no consumers.&lt;/p&gt;

&lt;p&gt;There dont look to have been any changes since 0.56.0 that I think should cause any difference to that test either though.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The actual main objective of the test has actually passed by that point (that commit threw), the bit that is failing is a secondary element, essentially checking for giggles that an internal listener got told the connection ws done as failover had failed as expected, as it was set up to fail. Thats the only failure route I can see - something else on your box takes the port and prevents the failover attempts being exhausted within the expected time.&lt;/p&gt;</comment>
                            <comment id="17311499" author="indysilver" created="Tue, 30 Mar 2021 12:51:34 +0000"  >&lt;p&gt;Given that you are running the CI tests on clean build agents and I am not I think its 100% likely to be my local machine but I will dig into it later anyway just in case I find anything&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0pbuw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>