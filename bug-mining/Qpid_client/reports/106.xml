<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:18:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPIDJMS-205] make shutdown of Netty executor group wait for completion</title>
                <link>https://issues.apache.org/jira/browse/QPIDJMS-205</link>
                <project id="12314524" key="QPIDJMS">Qpid JMS</project>
                    <description>&lt;p&gt;The client (and some test server/transports) doesn&apos;t currently wait for completion when it instructs the Netty executor group for the connection to shut down during transport closure, it should.&lt;/p&gt;

&lt;p&gt;Some manifestations of issues this leads to:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The thread may still be running when e.g a container checks for Thread and ThreadLocal leakage during shutdown of an app using the client.&lt;/li&gt;
	&lt;li&gt;When lots of connections are created and closed in a small period of time, this can lead to a lot of Thread and Selector&apos;s remaining &apos;in use&apos; during the shutdown period. This has been seen to occasionally present itself in CI, e.g hitting open file descriptor limits or running out of memory for thread stack etc.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Making use of Netty&apos;s &apos;shutdownGracefully&apos; method (with &apos;shutdownNow&apos; being deprecated) and waiting for the completion, an observed 1 second delay is present, which is undesirable as it makes the tests (and real world use) take &lt;span class=&quot;error&quot;&gt;&amp;#91;a lot&amp;#93;&lt;/span&gt; longer. However as of the 4.0.41.Final release (/ &lt;a href=&quot;https://github.com/netty/netty/issues/4241&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/netty/netty/issues/4241&lt;/a&gt;) which we now use thanks to &lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-203&quot; title=&quot;Update Netty to latest bugfix release 4.0.41.Final&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-203&quot;&gt;&lt;del&gt;QPIDJMS-203&lt;/del&gt;&lt;/a&gt;, using a 0ms &apos;grace Period&apos; no longer sees this delay. Given that we dont use the group for other tasks and don&apos;t try to shut it down until after the lone Channel on it has been closed, supplying a 0ms grace period seems suitable in this case.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13002738">QPIDJMS-205</key>
            <summary>make shutdown of Netty executor group wait for completion</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="robbie">Robbie Gemmell</assignee>
                                    <reporter username="robbie">Robbie Gemmell</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 Sep 2016 14:25:14 +0000</created>
                <updated>Mon, 9 Jan 2017 16:34:09 +0000</updated>
                            <resolved>Mon, 5 Sep 2016 15:39:59 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>qpid-jms-client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15465152" author="jira-bot" created="Mon, 5 Sep 2016 14:35:23 +0000"  >&lt;p&gt;Commit 87dbd80dc61928b5ce228342ccf26f7a3a4de006 in qpid-jms&apos;s branch refs/heads/master from Robert Gemmell&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=qpid-jms.git;h=87dbd80&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=qpid-jms.git;h=87dbd80&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-205&quot; title=&quot;make shutdown of Netty executor group wait for completion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-205&quot;&gt;&lt;del&gt;QPIDJMS-205&lt;/del&gt;&lt;/a&gt;: update group shutdown to use 0ms grace period and await completion&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 10 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33927:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>