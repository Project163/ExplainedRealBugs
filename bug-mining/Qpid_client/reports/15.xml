<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:17:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPIDJMS-49] handle messages with an unknown content-type</title>
                <link>https://issues.apache.org/jira/browse/QPIDJMS-49</link>
                <project id="12314524" key="QPIDJMS">Qpid JMS</project>
                    <description>&lt;p&gt;When a message is received, the client tries to decode the message and transform it to JmsMessage. However, the decoding of the message suceeds only when the message:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;has the JMS_MSG_TYPE annotation&lt;/li&gt;
	&lt;li&gt;or has a content type&lt;/li&gt;
	&lt;li&gt;or the content has a specific AMQP type&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;However, if the message doesn&apos;t match any of these, the client simply returns it back to the broker just with a warning:&lt;br/&gt;
2015-05-14 14:25:53 +0200 WARN org.apache.qpid.jms.provider.amqp.AmqpConsumer - Error on transform: Could not create a JMS message from incoming message&lt;/p&gt;

&lt;p&gt;When using the Qpid JMS API with the Qpid C++ broker, it seems to happen quite often that the messages falls into this category. For example the qpid-send utility (+ other clients based on the C++ API) tends to produce this kind of messages.&lt;/p&gt;

&lt;p&gt;Wouldn&apos;t it be better to transform such messages to BytesMessages? IMHO a client application with some additional knowledge about the message content might be able to process the payload correctly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12829837">QPIDJMS-49</key>
            <summary>handle messages with an unknown content-type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="robbie">Robbie Gemmell</assignee>
                                    <reporter username="scholzj">Jakub Scholz</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 May 2015 12:35:28 +0000</created>
                <updated>Wed, 6 Jan 2016 12:33:01 +0000</updated>
                            <resolved>Wed, 20 May 2015 13:29:19 +0000</resolved>
                                    <version>0.1.0</version>
                    <version>0.2.0</version>
                                    <fixVersion>0.3.0</fixVersion>
                                    <component>qpid-jms-client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14543750" author="gemmellr" created="Thu, 14 May 2015 14:48:11 +0000"  >&lt;p&gt;Hi Jakub,&lt;/p&gt;

&lt;p&gt;The likely cause for qpid-send (which I admit I haven&apos;t tried, but will now) to be doing this often would probably be for it to send &apos;data&apos; body sections without any content type set, and understandably also without the particular annotation the JMS client can optionally use to decide on message types. Looking at the code I can see this case would indeed fail to classify, causing it to behave as observed.&lt;/p&gt;

&lt;p&gt;It has long been the intention that should be a BytesMessage, so I&apos;m a little surprised the tests allowed (and worse, actually validated) the current behavior. Oops. I&apos;ll get that fixed&lt;/p&gt;</comment>
                            <comment id="14545498" author="jira-bot" created="Fri, 15 May 2015 13:37:33 +0000"  >&lt;p&gt;Commit 3637ec99936082b377341827813ec2f76333ed2b in qpid-jms&apos;s branch refs/heads/master from Robert Gemmell&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=qpid-jms.git;h=3637ec9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=qpid-jms.git;h=3637ec9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-49&quot; title=&quot;handle messages with an unknown content-type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-49&quot;&gt;&lt;del&gt;QPIDJMS-49&lt;/del&gt;&lt;/a&gt;: ensure messages with unknown content-type and Data sections are handled as BytesMessage, and those with no sections are handled as Message&lt;/p&gt;</comment>
                            <comment id="14545506" author="gemmellr" created="Fri, 15 May 2015 13:39:46 +0000"  >&lt;p&gt;Ok, I was slightly wrong in what I said yesterday, and this turned out to be more complicated than I guessed too.&lt;/p&gt;

&lt;p&gt;The client is already treating Data sections without a content-type as a BytesMessage as expected. What it wasnt doing yet is treating Data sections with an unknown content types as BytesMessages. I&apos;ve made some changes that resolves that.&lt;/p&gt;

&lt;p&gt;When using AMQP 1.0, qpid-send does not send messages with Data sections as I guessed and doesnt set the content-type either, it always sends a Amqp-Value section with Binary whether asked to send n bytes or given a particular content string (well, prior to Gordon&apos;s commit in &lt;a href=&quot;http://svn.apache.org/r1679556&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1679556&lt;/a&gt; after I enquired about sending strings). That all worked fine when I tried it out, which was interesting. The issue occurs when you use qpid-send with AMQP 0.10 to send messages to the broker, and then consume them with the JMS client. When converted to AMQP 1.0 to send to the client, the messages ended up with Data sections and an empty Symbol as the content-type because the original 0-10 message had an empty but present content type value. The client then failed to handle that as above, neither counting it as &apos;no content type&apos; or handling &apos;unknown content type&apos; correctly.&lt;/p&gt;</comment>
                            <comment id="14552315" author="jira-bot" created="Wed, 20 May 2015 13:28:25 +0000"  >&lt;p&gt;Commit 6b7320052b26fb2345bd3c7aac44e94857c98cbd in qpid-jms&apos;s branch refs/heads/master from Robert Gemmell&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=qpid-jms.git;h=6b73200&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=qpid-jms.git;h=6b73200&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-49&quot; title=&quot;handle messages with an unknown content-type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-49&quot;&gt;&lt;del&gt;QPIDJMS-49&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-52&quot; title=&quot;support charset parameter in content-type value&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-52&quot;&gt;&lt;del&gt;QPIDJMS-52&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-53&quot; title=&quot;treat messages with a Data section and common textual content-type values as TextMessage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-53&quot;&gt;&lt;del&gt;QPIDJMS-53&lt;/del&gt;&lt;/a&gt;: add some integration tests to verify the pieces are wired up&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 26 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2eq6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>