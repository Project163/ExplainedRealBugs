<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:19:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[QPIDJMS-588] failover URI with invalid/unused user-info in component URI not rejected, can be logged</title>
                <link>https://issues.apache.org/jira/browse/QPIDJMS-588</link>
                <project id="12314524" key="QPIDJMS">Qpid JMS</project>
                    <description>&lt;p&gt;The clients documented connection URI config does not utilise user-info details from the URI, with it actively refusing its presence in the base non-failover connection URI, for example using &quot;amqp://erroneous-user:erroneous-pass@localhost:5672&quot; will result in an IllegalArgumentException when creating the connection factory.&lt;/p&gt;

&lt;p&gt;If however a failover URI is supplied with a component server connection URI nested within it erroneously containing user-info detail, e.g &quot;failover:(amqp://erroneous-user:erroneous-pass@localhost:5672)&quot;, then they remain invalid/unused as expected but do not currently result in the IllegalArgumentException as in the non-failover case. Later code within the client does not expect this invalid/unused user-info detail to be present, and so can then log it.&lt;/p&gt;

&lt;p&gt;The erroneous presence of the invalid/unused user-info within a component of a failover URI should also cause an IllegalArgumentException when creating the connection factory.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;================&lt;/p&gt;

&lt;p&gt;Original Description:&lt;/p&gt;

&lt;p&gt;If I have a failover URL with `user:password` configured than the password is logged in plain text.&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;BrokerURL&lt;/ins&gt;: failover:(amqp://&lt;b&gt;myactivemquser:my-secure-password&lt;/b&gt;@localhost:5672)&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Log extract:&lt;/ins&gt;&lt;br/&gt;
2023-05-15 13:04:42.484 &#160;INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;localhost:5672&amp;#93;&lt;/span&gt;] org.apache.qpid.jms.JmsConnection &#160; &#160; &#160; &#160;: Connection ID:83323730-746c-4430-988f-e9e5f699dc1c:1 connected to server: amqp://&lt;b&gt;myactivemquser:my-secure-password&lt;/b&gt;@localhost:5672&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Expected behaviour:&lt;/p&gt;

&lt;p&gt;The password is masked in the log or an IllegalArgumentException is thrown similar to the non failover URL:&lt;/p&gt;

&lt;p&gt;amqp://&lt;b&gt;myactivemquser:my-secure-password&lt;/b&gt;@localhost:5672 results in a&#160;&lt;/p&gt;

&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.IllegalArgumentException: The supplied URI cannot contain a User-Info section&lt;br/&gt;
&#160; &#160; at org.apache.qpid.jms.JmsConnectionFactory.setRemoteURI(JmsConnectionFactory.java:406)&lt;br/&gt;
&#160; &#160; at org.amqphub.spring.boot.jms.autoconfigure.AMQP10JMSConnectionFactoryFactory.createConnectionFactory(AMQP10JMSConnectionFactoryFactory.java:66)&lt;br/&gt;
&#160; &#160; ... 69 common frames omitted&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;We are currently using Apache Qpid 2.2.0&lt;/p&gt;</environment>
        <key id="13536227">QPIDJMS-588</key>
            <summary>failover URI with invalid/unused user-info in component URI not rejected, can be logged</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="robbie">Robbie Gemmell</assignee>
                                    <reporter username="patrick_gell">Patrick Gell</reporter>
                        <labels>
                            <label>password</label>
                            <label>security</label>
                    </labels>
                <created>Mon, 15 May 2023 12:35:43 +0000</created>
                <updated>Mon, 22 May 2023 10:22:27 +0000</updated>
                            <resolved>Wed, 17 May 2023 14:02:18 +0000</resolved>
                                    <version>1.8.0</version>
                    <version>2.2.0</version>
                                    <fixVersion>1.9.0</fixVersion>
                    <fixVersion>2.3.0</fixVersion>
                                    <component>qpid-jms-client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17722786" author="gemmellr" created="Mon, 15 May 2023 13:53:40 +0000"  >&lt;p&gt;This presumably happens because the code in the ConnectionFactory which normally rejects the invalid presence of userinfo detail in the base URI, doesnt apply to failover URIs which are instead handled later by the failover provider to extract individual server details, which presumably isnt enforcing the same check for invalid presence of userinfo detail in the base URI. The later created Connection then doesnt anticipate userinfo being present in its base URI since it is not considered valid to be there in the client URI, and it then logs the base URI (first stripping the query, that might have had user detail props contained). For now: remove the invalid userinfo detail from your URI, it isnt being used from there anyway.&lt;/p&gt;</comment>
                            <comment id="17722984" author="JIRAUSER300413" created="Tue, 16 May 2023 04:51:50 +0000"  >&lt;p&gt;Thanks for the fast reply.&lt;/p&gt;

&lt;p&gt;What should be the correct handling of such URL? Throw an IllegalArgumentException?&lt;/p&gt;

&lt;p&gt;I could have a look into it and provide a pull request for that.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Best regards,&lt;/p&gt;

&lt;p&gt;Patrick&lt;/p&gt;</comment>
                            <comment id="17723197" author="gemmellr" created="Tue, 16 May 2023 16:50:13 +0000"  >&lt;p&gt;It should throw an IllegalArgumentException as it already does in the regular/non-failover URI case, since the userinfo presence is not considered valid and will not be used.&lt;/p&gt;

&lt;p&gt;I already have a change mostly done for this, just still to give it a check over and tidyup before pushing.&lt;/p&gt;</comment>
                            <comment id="17723467" author="jira-bot" created="Wed, 17 May 2023 13:52:24 +0000"  >&lt;p&gt;Commit b42d890e60308881eb654c4f115a786eaa7ba118 in qpid-jms&apos;s branch refs/heads/main from Robbie Gemmell&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=qpid-jms.git;h=b42d890e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=qpid-jms.git;h=b42d890e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-588&quot; title=&quot;failover URI with invalid/unused user-info in component URI not rejected, can be logged&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-588&quot;&gt;&lt;del&gt;QPIDJMS-588&lt;/del&gt;&lt;/a&gt;: throw IAE on attempt to create connection factory with invalid failover URI components containing User-Info&lt;/p&gt;</comment>
                            <comment id="17723470" author="jira-bot" created="Wed, 17 May 2023 13:59:29 +0000"  >&lt;p&gt;Commit 01e49dc5706976a87c02976a17ae8691d7666356 in qpid-jms&apos;s branch refs/heads/1.x from Robbie Gemmell&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=qpid-jms.git;h=01e49dc5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=qpid-jms.git;h=01e49dc5&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/QPIDJMS-588&quot; title=&quot;failover URI with invalid/unused user-info in component URI not rejected, can be logged&quot; class=&quot;issue-link&quot; data-issue-key=&quot;QPIDJMS-588&quot;&gt;&lt;del&gt;QPIDJMS-588&lt;/del&gt;&lt;/a&gt;: throw IAE on attempt to create connection factory with invalid failover URI components containing User-Info&lt;/p&gt;

&lt;p&gt;(cherry picked from commit b42d890e60308881eb654c4f115a786eaa7ba118)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 25 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1hwbc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>