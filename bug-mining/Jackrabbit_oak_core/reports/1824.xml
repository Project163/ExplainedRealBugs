<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:54:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-8306] Empty PrincipalProvider cache breaks membership collection</title>
                <link>https://issues.apache.org/jira/browse/OAK-8306</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;Regression caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-7024&quot; title=&quot;java.security.acl deprecated in Java 10, marked for removal in Java 14&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-7024&quot;&gt;&lt;del&gt;OAK-7024&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; when I replaced &lt;tt&gt;new HashSet&amp;lt;Group&amp;gt;(1)&lt;/tt&gt; with &lt;tt&gt;Collections.emptySet()&lt;/tt&gt; forgetting that this is actually an immutable set.&lt;/p&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;02.05.2019 11:50:51.663 INFO [qtp1880753633-1912] org.apache.sling.auth.core.impl.SlingAuthenticator handleLoginFailure: Unable to authenticate null: java.lang.UnsupportedOperationExcepti 
on 
at java.util.AbstractCollection.add(AbstractCollection.java:262) 
at org.apache.jackrabbit.oak.security.user.UserPrincipalProvider.getGroupMembership(UserPrincipalProvider.java:267) 
at org.apache.jackrabbit.oak.security.user.UserPrincipalProvider.getMembershipPrincipals(UserPrincipalProvider.java:124) 
at org.apache.jackrabbit.oak.spi.security.authentication.AbstractLoginModule.getPrincipals(AbstractLoginModule.java:498) 
at org.apache.jackrabbit.oak.security.authentication.token.TokenLoginModule.commit(TokenLoginModule.java:154)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/jackrabbit-oak/commit/75fa2b33cc7d5447aae2ecefbf369c3b2b2c424b#diff-bca626bc7a86cf9a4435a00386f08401L322&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-oak/commit/75fa2b33cc7d5447aae2ecefbf369c3b2b2c424b#diff-bca626bc7a86cf9a4435a00386f08401L322&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13232235">OAK-8306</key>
            <summary>Empty PrincipalProvider cache breaks membership collection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stillalex">Alex Deparvu</assignee>
                                    <reporter username="stillalex">Alex Deparvu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 May 2019 14:21:23 +0000</created>
                <updated>Tue, 11 Jun 2019 10:51:34 +0000</updated>
                            <resolved>Wed, 8 May 2019 15:42:59 +0000</resolved>
                                                    <fixVersion>1.10.3</fixVersion>
                    <fixVersion>1.14.0</fixVersion>
                                    <component>core</component>
                    <component>security</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16835640" author="alex.parvulescu" created="Wed, 8 May 2019 14:27:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anchela&quot; class=&quot;user-hover&quot; rel=&quot;anchela&quot;&gt;anchela&lt;/a&gt; feedback appreciated!&lt;/p&gt;</comment>
                            <comment id="16835652" author="anchela" created="Wed, 8 May 2019 14:43:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, patch for the fix looks good to me. with the test-case i think I would either mention the issue or create a separate test-case &apos;readingFromEntyCache&apos; or something similar, maybe triggering cache creation for a user without group membership... but that&apos;s just a matter of taste.&lt;/p&gt;</comment>
                            <comment id="16835657" author="alex.parvulescu" created="Wed, 8 May 2019 14:50:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;maybe triggering cache creation for a user without group membership&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;thanks. this is not possible due to the &lt;tt&gt;MEMBERSHIP_THRESHOLD&lt;/tt&gt; check, it would have to be a test that starts with a few members, then removes all of them, so basically ending up in the current test. I&apos;ll add the jira for future ref.&lt;/p&gt;</comment>
                            <comment id="16835668" author="anchela" created="Wed, 8 May 2019 15:08:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;.... ah... i see... seems i don&apos;t recall the details of my code &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. but adding jira ref is equally good. and as i said, it&apos;s more about taste... because i keep wondering every now and then about a test of mine looking at it after a while and whishing i had added a hint about the intention.&lt;/p&gt;</comment>
                            <comment id="16835697" author="alex.parvulescu" created="Wed, 8 May 2019 15:42:59 +0000"  >&lt;ul&gt;
	&lt;li&gt;fixed on trunk with &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1858931&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1858931&amp;amp;view=rev&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;1.10 with &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1858932&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1858932&amp;amp;view=rev&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16860848" author="edivad" created="Tue, 11 Jun 2019 10:51:34 +0000"  >&lt;p&gt;bulk close 1.14.0&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13122579">OAK-7024</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12968196" name="OAK-8306.patch" size="2597" author="stillalex" created="Wed, 8 May 2019 14:27:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02i3s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>