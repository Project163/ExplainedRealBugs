<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:51:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-5125] Some implementations of CacheValue.getMemory() don&apos;t care about integer overflow.</title>
                <link>https://issues.apache.org/jira/browse/OAK-5125</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;The interface method org.apache.jackrabbit.oak.cache.CacheValue.getMemory() returns an int value, while some implementations measure values larger than Integer.MAX_VALUE, producing an int overflow. This actually breaks in real life when testing with huge repos and machines, since it&apos;s used to measure the size of local diffs (e.g. a reindexing may diff the whole repo against an empty root).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13021468">OAK-5125</key>
            <summary>Some implementations of CacheValue.getMemory() don&apos;t care about integer overflow.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="baedke">Manfred Baedke</assignee>
                                    <reporter username="baedke">Manfred Baedke</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Nov 2016 14:15:34 +0000</created>
                <updated>Tue, 16 Feb 2021 09:52:37 +0000</updated>
                            <resolved>Mon, 5 Dec 2016 20:51:42 +0000</resolved>
                                    <version>1.0.34</version>
                    <version>1.2.21</version>
                    <version>1.4.10</version>
                    <version>1.5.13</version>
                                    <fixVersion>1.4.11</fixVersion>
                    <fixVersion>1.5.15</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15683084" author="mreutegg" created="Mon, 21 Nov 2016 10:06:18 +0000"  >&lt;p&gt;In addition to protecting against integer overflow in getMemory() the DocumentNodeStore should also ensure a cache entry never reaches that size. I&apos;d say it shouldn&apos;t even get close to Integer.MAX_VALUE because such a big cache entry potentially kicks out a lot of other useful cache entries. Created &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-5132&quot; title=&quot;Limit diff cache entries in size&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-5132&quot;&gt;&lt;del&gt;OAK-5132&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15723208" author="baedke" created="Mon, 5 Dec 2016 19:59:55 +0000"  >&lt;p&gt;Fixed in trunk : &lt;a href=&quot;http://svn.apache.org/r1772768&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1772768&lt;/a&gt;&lt;br/&gt;
Merged into 1.4:  &lt;a href=&quot;http://svn.apache.org/r1772798&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1772798&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;d like to add unit tests, but the tests would produce OOMs with the current settings, because we&apos;d need something like 8g heap.&lt;/p&gt;</comment>
                            <comment id="15724778" author="mreutegg" created="Tue, 6 Dec 2016 08:14:24 +0000"  >&lt;p&gt;It&apos;s indeed difficult to test. For EmpiricalWeigher a simple test is possible, because you can pass it a mocked CacheValue with artificially high memory usage. It may also make sense to move the checked cast to int with the debug message into a utility class. That would reduce duplicate code.&lt;/p&gt;</comment>
                            <comment id="15742157" author="edivad" created="Mon, 12 Dec 2016 14:36:57 +0000"  >&lt;p&gt;Bulk close for 1.5.15&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13022148">OAK-5132</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 48 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36gf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>