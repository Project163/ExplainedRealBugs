<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:42:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1424] Oak API allows to create hidden tree and properties</title>
                <link>https://issues.apache.org/jira/browse/OAK-1424</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;while we don&apos;t expose hidden items (name starting with &quot;:&quot;) on the OAK API, it is currently still possible to create such items and Tree#addChild even returns the hidden tree.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12695498">OAK-1424</key>
            <summary>Oak API allows to create hidden tree and properties</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Feb 2014 12:33:21 +0000</created>
                <updated>Thu, 27 Feb 2014 09:28:50 +0000</updated>
                            <resolved>Thu, 20 Feb 2014 13:46:07 +0000</resolved>
                                                    <fixVersion>0.17</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13903206" author="anchela" created="Mon, 17 Feb 2014 12:56:53 +0000"  >&lt;p&gt;added 2 tests at rev. 1568968&lt;/p&gt;</comment>
                            <comment id="13904128" author="mduerig" created="Tue, 18 Feb 2014 15:07:38 +0000"  >&lt;p&gt;Initial patch for how this could be fixed in the &lt;tt&gt;Tree&lt;/tt&gt; implementation. The changes in the respective methods also cater for what I think is necessary for &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1431&quot; title=&quot;Handling of empty or invalid names&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1431&quot;&gt;&lt;del&gt;OAK-1431&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;However with this patch some of the tests in &lt;tt&gt;org.apache.jackrabbit.oak.jcr.CopyTest&lt;/tt&gt; fail:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.IllegalArgumentException
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:77)
	at org.apache.jackrabbit.oak.core.MutableTree.setProperty(MutableTree.java:285)
	at org.apache.jackrabbit.oak.jcr.delegate.WorkspaceDelegate$WorkspaceCopy.copy(WorkspaceDelegate.java:164)
	at org.apache.jackrabbit.oak.jcr.delegate.WorkspaceDelegate$WorkspaceCopy.perform(WorkspaceDelegate.java:130)
	at org.apache.jackrabbit.oak.jcr.delegate.WorkspaceDelegate.copy(WorkspaceDelegate.java:98)
	at org.apache.jackrabbit.oak.jcr.session.WorkspaceImpl$2.perform(WorkspaceImpl.java:153)
	at org.apache.jackrabbit.oak.jcr.delegate.SessionDelegate.perform(SessionDelegate.java:154)
	at org.apache.jackrabbit.oak.jcr.session.WorkspaceImpl.copy(WorkspaceImpl.java:139)
	at org.apache.jackrabbit.oak.jcr.session.WorkspaceImpl.copy(WorkspaceImpl.java:121)
	at org.apache.jackrabbit.oak.jcr.CopyTest.testCopyVersionableNodeClearsVersions(CopyTest.java:144)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is due to the copy implementation introduced with &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-918&quot; title=&quot;Copying nodes does not create independant version histories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-918&quot;&gt;&lt;del&gt;OAK-918&lt;/del&gt;&lt;/a&gt; deliberately adding a hidden node to a &lt;tt&gt;Tree&lt;/tt&gt;.  &lt;/p&gt;</comment>
                            <comment id="13904172" author="mduerig" created="Tue, 18 Feb 2014 15:48:18 +0000"  >&lt;p&gt;I currently see two ways to convey the information about the source of the copy operation down to the &lt;tt&gt;VersionEditor&lt;/tt&gt;:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;instead of using a hidden property, use a non hidden property and a special mixin type for that property. There is no need to actually persist this. This is only for passing that information down and the &lt;tt&gt;VersionEditor&lt;/tt&gt; could easily remove the mixin and the property again.&lt;/li&gt;
	&lt;li&gt;use the &lt;tt&gt;CommitInfo&lt;/tt&gt; to pass additional copy meta data down to the &lt;tt&gt;VersionEditor&lt;/tt&gt;.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Any other options?&lt;/p&gt;</comment>
                            <comment id="13904182" author="anchela" created="Tue, 18 Feb 2014 15:54:04 +0000"  >&lt;p&gt;3. Refactor Root#commit(String, String) to take a Map&amp;lt;String,String&amp;gt; instead.&lt;/p&gt;

&lt;p&gt;1 looks a bit cumbersome, doesn&apos;t it?&lt;br/&gt;
2 is not IMO feasible as long as CommitInfo is in the spi and not part of oak-api&lt;/p&gt;</comment>
                            <comment id="13904193" author="jukkaz" created="Tue, 18 Feb 2014 16:06:05 +0000"  >&lt;p&gt;How about initializing the &lt;tt&gt;jcr:copiedFrom&lt;/tt&gt; version histories already in &lt;tt&gt;WorkspaceDelegate.copy()&lt;/tt&gt;? This way we the source information would already be in the correct place to begin with, and there would be no need for a special mechanism to pass it through the commit.&lt;/p&gt;</comment>
                            <comment id="13905711" author="mduerig" created="Wed, 19 Feb 2014 17:26:46 +0000"  >&lt;p&gt;Updated patch. This patch uses the info map introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1438&quot; title=&quot;Generalise Root.commit(String) to Root.commit(Map)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1438&quot;&gt;&lt;del&gt;OAK-1438&lt;/del&gt;&lt;/a&gt; to pass the copy-source to the commit hooks. What is left to do is to use this information in &lt;tt&gt;org.apache.jackrabbit.oak.plugins.version.ReadWriteVersionManager#getOrCreateVersionHistory&lt;/tt&gt; to correctly set the &lt;tt&gt;jcr:copiedFrom&lt;/tt&gt; property. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anchela&quot; class=&quot;user-hover&quot; rel=&quot;anchela&quot;&gt;anchela&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mreutegg&quot; class=&quot;user-hover&quot; rel=&quot;mreutegg&quot;&gt;mreutegg&lt;/a&gt; any of you could have a quick look into that?&lt;/p&gt;</comment>
                            <comment id="13905724" author="anchela" created="Wed, 19 Feb 2014 17:34:09 +0000"  >&lt;p&gt;sure. will take a look tomorrow.&lt;/p&gt;</comment>
                            <comment id="13906958" author="anchela" created="Thu, 20 Feb 2014 13:46:18 +0000"  >&lt;p&gt;Committed revision 1570187.&lt;/p&gt;</comment>
                            <comment id="13914277" author="alex.parvulescu" created="Thu, 27 Feb 2014 09:28:50 +0000"  >&lt;p&gt;bulk close for the 0.17.1 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12695686">OAK-1431</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12629814" name="OAK-1424-1.patch" size="20824" author="mduerig" created="Wed, 19 Feb 2014 17:26:46 +0000"/>
                            <attachment id="12629541" name="OAK-1424.patch" size="8630" author="mduerig" created="Tue, 18 Feb 2014 15:07:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>374006</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 38 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1sg9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>374306</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>