<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:38:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-841] Indexing empty string fails with &quot;there&apos;s already a child node with name &apos;:index&apos;&quot;</title>
                <link>https://issues.apache.org/jira/browse/OAK-841</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;Indexing an empty property value results in an &apos;node already exists&apos; exception in the MicroKernel.&lt;/p&gt;

&lt;p&gt;The value probably needs to be encoded in the index.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12649115">OAK-841</key>
            <summary>Indexing empty string fails with &quot;there&apos;s already a child node with name &apos;:index&apos;&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stillalex">Alex Deparvu</assignee>
                                    <reporter username="mreutegg">Marcel Reutegger</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 May 2013 13:34:24 +0000</created>
                <updated>Fri, 20 Sep 2013 07:01:25 +0000</updated>
                            <resolved>Fri, 24 May 2013 08:34:38 +0000</resolved>
                                    <version>0.8</version>
                                    <fixVersion>0.9</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13665202" author="alex.parvulescu" created="Thu, 23 May 2013 14:10:27 +0000"  >&lt;p&gt;interesting and unexpected &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
does it make sense to keep references to nodes that have an empty values?&lt;br/&gt;
are there queries that only check for a property&apos;s &apos;existence&apos; rather than the actual value?&lt;/p&gt;</comment>
                            <comment id="13665211" author="mreutegg" created="Thu, 23 May 2013 14:17:23 +0000"  >&lt;p&gt;&amp;gt; does it make sense to keep references to nodes that have an empty values?&lt;/p&gt;

&lt;p&gt;I think it does. Otherwise you cannot use the index when you have a query, which checks for existence of a property.&lt;/p&gt;

&lt;p&gt;&amp;gt; are there queries that only check for a property&apos;s &apos;existence&apos; rather than the actual value?&lt;/p&gt;

&lt;p&gt;there are, but you may also have queries where a property must match the empty string!&lt;/p&gt;</comment>
                            <comment id="13665212" author="tmueller" created="Thu, 23 May 2013 14:17:36 +0000"  >&lt;p&gt;A possible solution: if the indexed value is empty or ends with character x, then append character x to the value to get the index node name. When reading, if the index node name ends with character x, the last character has to be removed. Character x could be a space.&lt;/p&gt;</comment>
                            <comment id="13665216" author="tmueller" created="Thu, 23 May 2013 14:19:36 +0000"  >&lt;p&gt;Hm, actually we might need an even more advanced escape mechanism: what about values that contain the character &quot;/&quot;?&lt;/p&gt;</comment>
                            <comment id="13665219" author="tmueller" created="Thu, 23 May 2013 14:22:43 +0000"  >&lt;p&gt;Sorry, &quot;/&quot; is not a problem, as we use URLEncoder.encode.&lt;/p&gt;</comment>
                            <comment id="13665222" author="alex.parvulescu" created="Thu, 23 May 2013 14:29:12 +0000"  >&lt;p&gt;attaching a simpler version of the test&lt;/p&gt;</comment>
                            <comment id="13665223" author="alex.parvulescu" created="Thu, 23 May 2013 14:33:50 +0000"  >&lt;p&gt;&amp;gt; Character x could be a space.&lt;br/&gt;
what about &quot;:&quot; ?&lt;/p&gt;

&lt;p&gt;I mean use &quot;:&quot; as a replacement for the empty string value only.&lt;/p&gt;</comment>
                            <comment id="13665231" author="tmueller" created="Thu, 23 May 2013 14:41:37 +0000"  >&lt;p&gt;&amp;gt; what about &quot;:&quot; ?&lt;/p&gt;

&lt;p&gt;Sure! I don&apos;t have a preference really. Only: if adding the character x is done before URLEncoder.encode, then it shouldn&apos;t be a character that is encoded. Better yet if the character is appended after URLEncoder.encode.&lt;/p&gt;</comment>
                            <comment id="13665232" author="tmueller" created="Thu, 23 May 2013 14:43:41 +0000"  >&lt;p&gt;Checking the code, I didn&apos;t see a place where we un-escape the node name (to get the original value). Yet we should still make sure that this is possible (as we might need it at some point).&lt;/p&gt;</comment>
                            <comment id="13666109" author="alex.parvulescu" created="Fri, 24 May 2013 08:34:38 +0000"  >&lt;p&gt;fixed in rev 1485969.&lt;/p&gt;

&lt;p&gt;I used the &apos;:&apos; token for empty strings. To bypass the encoding issue I added a check before the encoding takes place, this way the token will not get encoded so there will be no conflicting keys.&lt;/p&gt;


&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/r1485969&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1485969&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13667670" author="tmueller" created="Mon, 27 May 2013 10:00:00 +0000"  >&lt;p&gt;I see, so that &quot;&quot; is encoded as &quot;:&quot;, and &quot;:&quot; is encoded as &quot;%3A&quot;. Yes, that works! I will add a test case for &quot;:&quot; so we don&apos;t break it in the future.&lt;/p&gt;</comment>
                            <comment id="13772702" author="alex.parvulescu" created="Fri, 20 Sep 2013 07:01:25 +0000"  >&lt;p&gt;Bulk close for the 0.9 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12584505" name="PropertyIndexTest.java.patch" size="1435" author="stillalex" created="Thu, 23 May 2013 14:29:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>329442</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 9 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ku5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>329777</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>