<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:49:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-3753] Test failure: HeavyWriteIT</title>
                <link>https://issues.apache.org/jira/browse/OAK-3753</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;&lt;tt&gt;org.apache.jackrabbit.oak.plugins.segment.HeavyWriteIT&lt;/tt&gt; failed on Jenkins:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;heavyWrite[usePersistedMap: false](org.apache.jackrabbit.oak.plugins.segment.HeavyWriteIT)  Time elapsed: 106.519 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
java.lang.IllegalStateException
	at com.google.common.base.Preconditions.checkState(Preconditions.java:134)
	at org.apache.jackrabbit.oak.plugins.segment.Segment.&amp;lt;init&amp;gt;(Segment.java:214)
	at org.apache.jackrabbit.oak.plugins.segment.Segment.&amp;lt;init&amp;gt;(Segment.java:198)
	at org.apache.jackrabbit.oak.plugins.segment.file.FileStore.readSegment(FileStore.java:1177)
	at org.apache.jackrabbit.oak.plugins.segment.SegmentTracker.readSegment(SegmentTracker.java:224)
	at org.apache.jackrabbit.oak.plugins.segment.SegmentId.getSegment(SegmentId.java:149)
	at org.apache.jackrabbit.oak.plugins.segment.RecordId.getSegment(RecordId.java:88)
	at org.apache.jackrabbit.oak.plugins.segment.Segment.readTemplate(Segment.java:506)
	at org.apache.jackrabbit.oak.plugins.segment.SegmentNodeState.getTemplate(SegmentNodeState.java:79)
	at org.apache.jackrabbit.oak.plugins.segment.SegmentNodeState.getChildNode(SegmentNodeState.java:381)
	at org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilder$UnconnectedHead.update(MemoryNodeBuilder.java:651)
	at org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilder$ConnectedHead.update(MemoryNodeBuilder.java:729)
	at org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilder.head(MemoryNodeBuilder.java:171)
	at org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilder.access$300(MemoryNodeBuilder.java:88)
	at org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilder$UnconnectedHead.update(MemoryNodeBuilder.java:650)
	at org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilder$ConnectedHead.update(MemoryNodeBuilder.java:729)
	at org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilder.head(MemoryNodeBuilder.java:171)
	at org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilder.exists(MemoryNodeBuilder.java:273)
	at org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilder.setProperty(MemoryNodeBuilder.java:506)
	at org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilder.setProperty(MemoryNodeBuilder.java:515)
	at org.apache.jackrabbit.oak.plugins.segment.HeavyWriteIT.createProperties(HeavyWriteIT.java:156)
	at org.apache.jackrabbit.oak.plugins.segment.HeavyWriteIT.createNodes(HeavyWriteIT.java:148)
	at org.apache.jackrabbit.oak.plugins.segment.HeavyWriteIT.createNodes(HeavyWriteIT.java:149)
	at org.apache.jackrabbit.oak.plugins.segment.HeavyWriteIT.heavyWrite(HeavyWriteIT.java:129)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Seen at build 597&lt;/p&gt;</description>
                <environment>&lt;p&gt;Jenkins, Ubuntu: &lt;a href=&quot;https://builds.apache.org/job/Apache%20Jackrabbit%20Oak%20matrix/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Apache%20Jackrabbit%20Oak%20matrix/&lt;/a&gt;&lt;/p&gt;</environment>
        <key id="12920359">OAK-3753</key>
            <summary>Test failure: HeavyWriteIT</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="mduerig">Michael D&#252;rig</reporter>
                        <labels>
                            <label>ci</label>
                            <label>jenkins</label>
                    </labels>
                <created>Wed, 9 Dec 2015 08:34:48 +0000</created>
                <updated>Fri, 4 Oct 2019 17:50:54 +0000</updated>
                            <resolved>Wed, 5 Oct 2016 20:10:51 +0000</resolved>
                                                    <fixVersion>1.6.0</fixVersion>
                                    <component>segmentmk</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15048316" author="mduerig" created="Wed, 9 Dec 2015 08:51:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alex.parvulescu&quot; class=&quot;user-hover&quot; rel=&quot;alex.parvulescu&quot;&gt;alex.parvulescu&lt;/a&gt; FYI&lt;/p&gt;</comment>
                            <comment id="15048366" author="mduerig" created="Wed, 9 Dec 2015 09:29:09 +0000"  >&lt;p&gt;Added additional logging dumping invalid segments when encountered at &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1718784&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1718784&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15361125" author="edivad" created="Mon, 4 Jul 2016 10:11:52 +0000"  >&lt;p&gt;re-opening and making a blocker as it consistently fails on my local while performing pre-release checks. Full &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12816012/12816012_build-1467624994.log.gz&quot; title=&quot;build-1467624994.log.gz attached to OAK-3753&quot;&gt;maven build logs&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;/cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alex.parvulescu&quot; class=&quot;user-hover&quot; rel=&quot;alex.parvulescu&quot;&gt;alex.parvulescu&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;update: it didn&apos;t fail constantly. It failed 3 times in a row and not failing as of now. I still have one more build log if needed.&lt;/p&gt;</comment>
                            <comment id="15382366" author="mduerig" created="Mon, 18 Jul 2016 14:35:20 +0000"  >&lt;p&gt;This is scary:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.IllegalStateException: Invalid segment format. Dumping segment 5e9e2c92-b53d-4efb-a6b3-7df5e01a174c
00000000 64 61 74 61 30 30 30 31 37 61 2E 74 61 72 2E 69 data00017a.tar.i
00000010 64 78 00 00 00 00 00 00 00 00 00 00 00 00 00 00 dx..............
00000020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
00000030 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This segment buffer is completely corrupted. My closest bet so far would be that we are dealing with a uninitialised buffer here caused by some race condition. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=edivad&quot; class=&quot;user-hover&quot; rel=&quot;edivad&quot;&gt;edivad&lt;/a&gt;, did you always get the same behaviour when the test failed? Could you share the logs here when it fails again?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=frm&quot; class=&quot;user-hover&quot; rel=&quot;frm&quot;&gt;frm&lt;/a&gt; FYI&lt;/p&gt;</comment>
                            <comment id="15385937" author="edivad" created="Wed, 20 Jul 2016 14:24:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mduerig&quot; class=&quot;user-hover&quot; rel=&quot;mduerig&quot;&gt;mduerig&lt;/a&gt; attaching all the builds I have with the error.&lt;/p&gt;</comment>
                            <comment id="15385949" author="mduerig" created="Wed, 20 Jul 2016 14:30:59 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=edivad&quot; class=&quot;user-hover&quot; rel=&quot;edivad&quot;&gt;edivad&lt;/a&gt;. All those show the same weird hexdump as in my previous comment. Would you also have the &lt;tt&gt;unit-test.log&lt;/tt&gt; files around? Otherwise please attach once this happens again. &lt;/p&gt;</comment>
                            <comment id="15413320" author="edivad" created="Tue, 9 Aug 2016 10:04:16 +0000"  >&lt;p&gt;forgot the unit-test.log and now it has gone. However this is another build off the 1.4 branch: &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12822764/12822764_build-1470736039.log.gz&quot; title=&quot;build-1470736039.log.gz attached to OAK-3753&quot;&gt;build-1470736039.log.gz&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="15424347" author="mduerig" created="Wed, 17 Aug 2016 11:48:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=edivad&quot; class=&quot;user-hover&quot; rel=&quot;edivad&quot;&gt;edivad&lt;/a&gt;, could you check whether the tests run with memory mapping or plain file access on that machine?&lt;/p&gt;</comment>
                            <comment id="15424849" author="mduerig" created="Wed, 17 Aug 2016 16:32:15 +0000"  >&lt;p&gt;Very similar symptoms on &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-4675&quot; title=&quot;SNFE thrown while testing FileStore.cleanup() running concurrently with writes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-4675&quot;&gt;&lt;del&gt;OAK-4675&lt;/del&gt;&lt;/a&gt;. However there it was only reproducible when not using memory mapped files. &lt;/p&gt;</comment>
                            <comment id="15426643" author="mduerig" created="Thu, 18 Aug 2016 15:28:18 +0000"  >&lt;p&gt;This looks more and more like a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-4675&quot; title=&quot;SNFE thrown while testing FileStore.cleanup() running concurrently with writes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-4675&quot;&gt;&lt;del&gt;OAK-4675&lt;/del&gt;&lt;/a&gt;. Porting the test &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adulceanu&quot; class=&quot;user-hover&quot; rel=&quot;adulceanu&quot;&gt;adulceanu&lt;/a&gt; to &lt;tt&gt;oak-segment&lt;/tt&gt; I am able to reproduce &quot;Invalid segment format&quot; error: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.IllegalStateException: Invalid segment format. Dumping segment b3307395-6b84-4035-af39-52b487f817e7
00000000 64 61 74 61 30 30 30 30 30 61 2E 74 61 72 2E 69 data00000a.tar.i
00000010 64 78 00 00 00 00 00 00 00 00 00 00 00 00 00 00 dx..............
00000020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
00000030 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
00000040 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
00000050 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
00000060 00 00 00 00 30 30 30 30 34 30 30 00 30 30 30 30 ....0000400.0000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15549803" author="mduerig" created="Wed, 5 Oct 2016 20:10:51 +0000"  >&lt;p&gt;Fixed with &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-4675&quot; title=&quot;SNFE thrown while testing FileStore.cleanup() running concurrently with writes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-4675&quot;&gt;&lt;del&gt;OAK-4675&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12997573">OAK-4675</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12819098" name="build-1462283631.log.gz" size="22155" author="edivad" created="Wed, 20 Jul 2016 14:24:05 +0000"/>
                            <attachment id="12819099" name="build-1463134483.log.gz" size="22035" author="edivad" created="Wed, 20 Jul 2016 14:24:05 +0000"/>
                            <attachment id="12819100" name="build-1467622598.log.gz" size="22743" author="edivad" created="Wed, 20 Jul 2016 14:24:05 +0000"/>
                            <attachment id="12816012" name="build-1467624994.log.gz" size="4039" author="edivad" created="Mon, 4 Jul 2016 10:11:52 +0000"/>
                            <attachment id="12819101" name="build-1468934799.log.gz" size="24447" author="edivad" created="Wed, 20 Jul 2016 14:24:05 +0000"/>
                            <attachment id="12822764" name="build-1470736039.log.gz" size="4018" author="edivad" created="Tue, 9 Aug 2016 10:04:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311120" key="com.pyxis.greenhopper.jira:gh-epic-link">
                        <customfieldname>Epic Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>OAK-2714</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 6 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1rw6k:i</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>