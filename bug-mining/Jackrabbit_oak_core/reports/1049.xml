<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:46:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-2203] Full reindexing is triggered when the IndexEditor is missing</title>
                <link>https://issues.apache.org/jira/browse/OAK-2203</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;Currently the IndexUpdate class responsible for handling the index editors is a bit eager in triggering a reindex in the case where is doesn&apos;t find the editor for a specific index type &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.&lt;br/&gt;
This has a few drawbacks:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if you update a bundle with an index impl (ex: oak-lucene) IndexUpdate will catch that downtime, see the index as offline and ask for a reindex. not cool.&lt;/li&gt;
	&lt;li&gt;it will eagerly set &apos;reindex=true&apos; even on nodes that are not index definitions, causing mild annoyances (&lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2024&quot; title=&quot;Error when accessing /oak:index/rep:policy/reindex property via JCR&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2024&quot;&gt;&lt;del&gt;OAK-2024&lt;/del&gt;&lt;/a&gt;).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This begs the question: when should we automatically mark for reindex an index definition?&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/jackrabbit-oak/blob/trunk/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/IndexUpdate.java#L162&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-oak/blob/trunk/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/IndexUpdate.java#L162&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12748541">OAK-2203</key>
            <summary>Full reindexing is triggered when the IndexEditor is missing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stillalex">Alex Deparvu</assignee>
                                    <reporter username="stillalex">Alex Deparvu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Oct 2014 09:07:45 +0000</created>
                <updated>Mon, 20 Apr 2015 07:30:23 +0000</updated>
                            <resolved>Thu, 23 Oct 2014 10:10:10 +0000</resolved>
                                    <version>1.0</version>
                    <version>1.0.1</version>
                    <version>1.0.2</version>
                    <version>1.0.3</version>
                    <version>1.0.4</version>
                    <version>1.0.5</version>
                    <version>1.0.6</version>
                    <version>1.0.7</version>
                    <version>1.1.0</version>
                    <version>1.1.1</version>
                                    <fixVersion>1.0.8</fixVersion>
                    <fixVersion>1.1.2</fixVersion>
                                    <component>core</component>
                    <component>lucene</component>
                    <component>solr</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14178296" author="chetanm" created="Tue, 21 Oct 2014 11:40:06 +0000"  >&lt;p&gt;The logic cannot move forward in absence of index provider without marking the index for reindex otherwise the index editor would &lt;em&gt;miss out see some changes&lt;/em&gt;. I see two options&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Foe async index update
	&lt;ol&gt;
		&lt;li&gt;If an index provider is missing  we terminate that operation and let normal retry logic perform the index again&lt;/li&gt;
		&lt;li&gt;Do a wait for upto some configured time interval and then mark it for reindex. The wait can be done for a whitelist of index provider&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
	&lt;li&gt;For sync case we have to trigger reindex or keep current request waiting for some time&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14178317" author="alex.parvulescu" created="Tue, 21 Oct 2014 11:52:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;async&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;There&apos;s no need for waiting. I like #1: just loop again without applying the index updates, treat the missing index like a commit exception. the issue is with indexes that are missing permanently/are disabled. We should at least add an ignored type (or list of types) to make sure we don&apos;t block the index updates indefinitely (like a type=&quot;disabled&quot;).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;sync case&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I wouldn&apos;t resort to waiting, just keep the current behavior, mark for reindex.&lt;/p&gt;</comment>
                            <comment id="14181191" author="alex.parvulescu" created="Thu, 23 Oct 2014 10:08:35 +0000"  >&lt;p&gt;fixed with rev1633783.&lt;/p&gt;

&lt;p&gt;I introduced a strategy class that should help with controlling the behavior when dealing with a missing index provider. By default (the sync defs) it will set the reindex flag to true. For the async cases it will throw a commit exception which will allow the async indexer to skip the current cycle and try again later. For now the async indexer will ignore definitions named &apos;disabled&apos; (hardcoded name), if this needs to be configurable, I can follow up on it later.&lt;/p&gt;</comment>
                            <comment id="14181192" author="alex.parvulescu" created="Thu, 23 Oct 2014 10:10:10 +0000"  >&lt;p&gt;merged to 1.0 with rev 1633784.&lt;/p&gt;</comment>
                            <comment id="14195914" author="alex.parvulescu" created="Tue, 4 Nov 2014 08:54:37 +0000"  >&lt;p&gt;Bulk close for 1.0.8&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12733341">OAK-2024</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i218lz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>