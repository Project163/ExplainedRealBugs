<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:54:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-9775] ACEs with unsupported restrictions must be cleared upon editing</title>
                <link>https://issues.apache.org/jira/browse/OAK-9775</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;if the tree presentation of an access control list contains restrictions that are not supported the restriction provider will ignore them upon reading the policy from the content repository.&lt;/p&gt;

&lt;p&gt;this will lead to ACEs being generated that contain an incomplete restriction set. however, the access control manager fails to detect them as incomplete or invalid, which upon editing of the policy will lead to &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;incomplete ACEs being written back &lt;em&gt;or&lt;/em&gt;&lt;/li&gt;
	&lt;li&gt;AccessControlValidator failing in case the incomplete ACEs result in duplications&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;instead ACEs containing unsupported restrictions must be detected and removed from the policy upon editing (with a error being logged).&lt;/p&gt;

&lt;p&gt;how to get there:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;custom restrictions being written to the repository and the custom restriction provider being uninstalled from the security setup&lt;/li&gt;
	&lt;li&gt;using newer restrictions and then using that repository content with an older oak version that doesn&apos;t support those restrictions&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13445844">OAK-9775</key>
            <summary>ACEs with unsupported restrictions must be cleared upon editing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="angela">Angela Schreiber</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 May 2022 13:51:47 +0000</created>
                <updated>Fri, 15 Jul 2022 14:53:52 +0000</updated>
                            <resolved>Mon, 30 May 2022 06:35:06 +0000</resolved>
                                                    <fixVersion>1.44.0</fixVersion>
                                    <component>authorization-principalbased</component>
                    <component>core</component>
                    <component>security</component>
                    <component>security-spi</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17539787" author="brobert" created="Thu, 19 May 2022 20:36:10 +0000"  >&lt;p&gt;Also the validation error produced by this makes no sense today.&#160; For example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.jackrabbit.oak.api.CommitFailedException: OakAccessControl0013: Duplicate ACE &lt;span class=&quot;code-quote&quot;&gt;&apos;/rep:policy/deny21&apos;&lt;/span&gt; found in policy
at org.apache.jackrabbit.oak.security.authorization.accesscontrol.AccessControlValidator.accessViolation(AccessControlValidator.java:309) [org.apache.jackrabbit.oak-core:1.40.0.T20211119100624-06dae64]
at org.apache.jackrabbit.oak.security.authorization.accesscontrol.AccessControlValidator.checkValidPolicy(AccessControlValidator.java:210) [org.apache.jackrabbit.oak-core:1.40.0.T20211119100624-06dae64]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The duplication check is based on the policy content not the node names; however the conflicting policy node path is not provided nor are the policy node values.&#160; A developer or admin receiving this error doesn&apos;t have a lot of data points to triage the problem in this case.&lt;/p&gt;</comment>
                            <comment id="17539945" author="anchela" created="Fri, 20 May 2022 06:36:01 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brobert&quot; class=&quot;user-hover&quot; rel=&quot;brobert&quot;&gt;brobert&lt;/a&gt;, i think you are confusing terms. what you probably meant is access control entry not policy. the policy is in this case the access control list and it&apos;s path is actually part of the exception message: in your example it&apos;s &quot;/rep:policy&quot; and the access controlled node is the root node.&lt;/p&gt;</comment>
                            <comment id="17541843" author="anchela" created="Wed, 25 May 2022 06:18:56 +0000"  >&lt;p&gt;additional testing with a composite restriction provider shows that this bug is impacted by &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-9782&quot; title=&quot;CompositeRestrictionProvider must call validate on aggregated providers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-9782&quot;&gt;&lt;del&gt;OAK-9782&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13448149">OAK-9791</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13445991">OAK-9778</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="13446512">OAK-9782</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                            <outwardlinks description="Testing discovered">
                                        <issuelink>
            <issuekey id="13446512">OAK-9782</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13446391">OAK-9779</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 24 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z12ijc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>