<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:48:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-2961] Async index fails with OakState0001: Unresolved conflicts in /:async</title>
                <link>https://issues.apache.org/jira/browse/OAK-2961</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;When running on a mongo cluster, in case of high activity the async index could fail with the following exception.&lt;/p&gt;

&lt;p&gt;Reproduced with LucenePropertyIndex.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;10:55:13.069 [oak-scheduled-executor-5] WARN  o.a.j.o.p.index.AsyncIndexUpdate - [async] The index update failed
org.apache.jackrabbit.oak.api.CommitFailedException: OakState0001: Unresolved conflicts in /:async
	at org.apache.jackrabbit.oak.plugins.commit.ConflictValidator.failOnMergeConflict(ConflictValidator.java:84) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.commit.ConflictValidator.propertyAdded(ConflictValidator.java:54) ~[classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorDiff.propertyAdded(EditorDiff.java:82) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.memory.ModifiedNodeState.compareAgainstBaseState(ModifiedNodeState.java:378) ~[classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorDiff.childNodeChanged(EditorDiff.java:148) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.memory.ModifiedNodeState.compareAgainstBaseState(ModifiedNodeState.java:400) ~[classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorDiff.process(EditorDiff.java:52) ~[classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorHook.processCommit(EditorHook.java:55) ~[classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.CompositeHook.processCommit(CompositeHook.java:61) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreBranch$InMemory.merge(DocumentNodeStoreBranch.java:528) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreBranch.merge0(DocumentNodeStoreBranch.java:219) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreBranch.merge(DocumentNodeStoreBranch.java:171) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentRootBuilder.merge(DocumentRootBuilder.java:158) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStore.merge(DocumentNodeStore.java:1466) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.mergeWithConcurrencyCheck(AsyncIndexUpdate.java:467) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.access$4(AsyncIndexUpdate.java:445) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate$AsyncUpdateCallback.&amp;lt;init&amp;gt;(AsyncIndexUpdate.java:201) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.updateIndex(AsyncIndexUpdate.java:372) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.run(AsyncIndexUpdate.java:320) ~[classes/:na]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471) [na:1.7.0_60]
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:304) [na:1.7.0_60]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:178) [na:1.7.0_60]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [na:1.7.0_60]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) [na:1.7.0_60]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) [na:1.7.0_60]
	at java.lang.Thread.run(Thread.java:745) [na:1.7.0_60]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12835667">OAK-2961</key>
            <summary>Async index fails with OakState0001: Unresolved conflicts in /:async</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="edivad">Davide Giannella</assignee>
                                    <reporter username="edivad">Davide Giannella</reporter>
                        <labels>
                            <label>resilience</label>
                    </labels>
                <created>Fri, 5 Jun 2015 10:02:46 +0000</created>
                <updated>Wed, 2 Mar 2016 11:45:46 +0000</updated>
                            <resolved>Thu, 25 Jun 2015 13:17:00 +0000</resolved>
                                    <version>1.0.14</version>
                    <version>1.2.2</version>
                    <version>1.4</version>
                                    <fixVersion>1.0.17</fixVersion>
                    <fixVersion>1.2.3</fixVersion>
                    <fixVersion>1.3.2</fixVersion>
                    <fixVersion>1.4</fixVersion>
                                    <component>mongomk</component>
                    <component>query</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14574251" author="edivad" created="Fri, 5 Jun 2015 10:09:12 +0000"  >&lt;p&gt;in &lt;a href=&quot;https://svn.apache.org/r1683700&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683700&lt;/a&gt; a tentative test (Ignored) for reproducing the issue: &lt;tt&gt;AsyncConflictsIT.java&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chetanm&quot; class=&quot;user-hover&quot; rel=&quot;chetanm&quot;&gt;chetanm&lt;/a&gt; could you give a look?&lt;/p&gt;</comment>
                            <comment id="14583526" author="chetanm" created="Fri, 12 Jun 2015 14:52:17 +0000"  >&lt;p&gt;Looks like the issue is in AsyncIndexUpdate around what is considered as concurrent update. The above test runs a 5 node cluster and creates and index and triggers a reindex. It can happen and infact here does happen that on 2 cluster node AsyncIndex job is fired at same time and they both try to set the lease which can result in conflict at DocumentStore layer (and hence not detected by CommitHook). For e.g. in this test following logs is seen where it can be seen that &lt;tt&gt;async-lease&lt;/tt&gt; is different&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;19:09:26.346 DEBUG [oak-scheduled-executor-23] ConflictValidator.java:91 Commit failed due to unresolved conflicts in /:async = {addExistingProperty = {async-lease = {1434118165914,1434118164643}},changeChangedProperty = {async-temp = {&amp;lt;ARRAY&amp;gt;,&amp;lt;ARRAY&amp;gt;}}}
org.apache.jackrabbit.oak.api.CommitFailedException: OakState0001: Unresolved conflicts in /:async
	at org.apache.jackrabbit.oak.plugins.commit.ConflictValidator.failOnMergeConflict(ConflictValidator.java:84) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.commit.ConflictValidator.propertyAdded(ConflictValidator.java:54) [classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorDiff.propertyAdded(EditorDiff.java:82) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.memory.ModifiedNodeState.compareAgainstBaseState(ModifiedNodeState.java:378) [classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorDiff.childNodeChanged(EditorDiff.java:148) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.memory.ModifiedNodeState.compareAgainstBaseState(ModifiedNodeState.java:399) [classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorDiff.process(EditorDiff.java:52) [classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorHook.processCommit(EditorHook.java:54) [classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.CompositeHook.processCommit(CompositeHook.java:61) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreBranch$InMemory.merge(DocumentNodeStoreBranch.java:543) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreBranch.merge0(DocumentNodeStoreBranch.java:223) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreBranch.merge(DocumentNodeStoreBranch.java:171) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentRootBuilder.merge(DocumentRootBuilder.java:158) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStore.merge(DocumentNodeStore.java:1495) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.mergeWithConcurrencyCheck(AsyncIndexUpdate.java:467) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.access$400(AsyncIndexUpdate.java:76) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate$AsyncUpdateCallback.&amp;lt;init&amp;gt;(AsyncIndexUpdate.java:201) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.updateIndex(AsyncIndexUpdate.java:371) [classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.run(AsyncIndexUpdate.java:320) [classes/:na]
19:09:26.347 WARN  [oak-scheduled-executor-23] AsyncIndexUpdate.java:342 [async] The index update failed
org.apache.jackrabbit.oak.api.CommitFailedException: OakState0001: Unresolved conflicts in /:async
	at org.apache.jackrabbit.oak.plugins.commit.ConflictValidator.failOnMergeConflict(ConflictValidator.java:84) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.commit.ConflictValidator.propertyAdded(ConflictValidator.java:54) ~[classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorDiff.propertyAdded(EditorDiff.java:82) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.memory.ModifiedNodeState.compareAgainstBaseState(ModifiedNodeState.java:378) ~[classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorDiff.childNodeChanged(EditorDiff.java:148) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.memory.ModifiedNodeState.compareAgainstBaseState(ModifiedNodeState.java:399) ~[classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorDiff.process(EditorDiff.java:52) ~[classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.EditorHook.processCommit(EditorHook.java:54) ~[classes/:na]
	at org.apache.jackrabbit.oak.spi.commit.CompositeHook.processCommit(CompositeHook.java:61) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreBranch$InMemory.merge(DocumentNodeStoreBranch.java:543) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreBranch.merge0(DocumentNodeStoreBranch.java:223) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreBranch.merge(DocumentNodeStoreBranch.java:171) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentRootBuilder.merge(DocumentRootBuilder.java:158) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.document.DocumentNodeStore.merge(DocumentNodeStore.java:1495) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.mergeWithConcurrencyCheck(AsyncIndexUpdate.java:467) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.access$400(AsyncIndexUpdate.java:76) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate$AsyncUpdateCallback.&amp;lt;init&amp;gt;(AsyncIndexUpdate.java:201) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.updateIndex(AsyncIndexUpdate.java:371) ~[classes/:na]
	at org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate.run(AsyncIndexUpdate.java:320) ~[classes/:na]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471) [na:1.7.0_55]
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:304) [na:1.7.0_55]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:178) [na:1.7.0_55]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [na:1.7.0_55]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) [na:1.7.0_55]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) [na:1.7.0_55]
	at java.lang.Thread.run(Thread.java:745) [na:1.7.0_55]

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is a valid concurrent update conflict and is very much possible in a cluster and if async job on both cluster node are running. Current logic in &lt;tt&gt;AsyncIndexUpdate#mergeWithConcurrencyCheck&lt;/tt&gt; does not check for that and treats it as a generic commit failure. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alex.parvulescu&quot; class=&quot;user-hover&quot; rel=&quot;alex.parvulescu&quot;&gt;alex.parvulescu&lt;/a&gt; Should not we also catch CommitFailedException and if it is of type STATE and code 1 then treat it as CONCURRENT_UPDATE&lt;/p&gt;</comment>
                            <comment id="14586332" author="alex.parvulescu" created="Mon, 15 Jun 2015 17:17:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chetanm&quot; class=&quot;user-hover&quot; rel=&quot;chetanm&quot;&gt;chetanm&lt;/a&gt; sounds good! &lt;br/&gt;
sorry for the late reply, to move things along I&apos;ve created a patch and attached it to the issue. &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12739645/12739645_OAK-2961.patch&quot; title=&quot;OAK-2961.patch attached to OAK-2961&quot;&gt;OAK-2961.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="14587657" author="edivad" created="Tue, 16 Jun 2015 08:21:38 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alexparvulescu&quot; class=&quot;user-hover&quot; rel=&quot;alexparvulescu&quot;&gt;alexparvulescu&lt;/a&gt; patch looks good for what I can see. I&apos;ll&lt;br/&gt;
apply it and re-execute the IT. In case fixes will commit to trunk.&lt;/p&gt;</comment>
                            <comment id="14587721" author="chetanm" created="Tue, 16 Jun 2015 09:08:13 +0000"  >&lt;p&gt;+1. Patch looks fine&lt;/p&gt;</comment>
                            <comment id="14588369" author="alex.parvulescu" created="Tue, 16 Jun 2015 16:58:08 +0000"  >&lt;p&gt;tentatively setting the 1.2.x fix version for backport, I&apos;d like to have this avail on the 1.2 branch as well.&lt;/p&gt;</comment>
                            <comment id="14589478" author="edivad" created="Wed, 17 Jun 2015 08:26:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alexparvulescu&quot; class=&quot;user-hover&quot; rel=&quot;alexparvulescu&quot;&gt;alexparvulescu&lt;/a&gt; we may be needing this for 1.0 as well. Let me see after applying the patch if it solves and if it&apos;s easy to backport.&lt;/p&gt;</comment>
                            <comment id="14589757" author="edivad" created="Wed, 17 Jun 2015 13:29:07 +0000"  >&lt;p&gt;Applied the patch and the /:async conflict goes away. Anyway still&lt;br/&gt;
there&apos;re warnings which as of now don&apos;t know if they are something to&lt;br/&gt;
worry about or not.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;14:21:53.983 [main] INFO  o.a.j.oak.jcr.AsyncConflictsIT - adding 10000 nodes
14:21:59.104 [oak-scheduled-executor-5] INFO  o.a.j.o.p.i.l.LuceneIndexEditorContext - Loaded default Tika Config from classpath file:/Users/dgiannel/work/sources/apache/jackrabbit-oak/oak-lucene/target/classes/org/apache/jackrabbit/oak/plugins/index/lucene/tika-config.xml
14:21:59.661 [main] INFO  o.a.j.oak.jcr.AsyncConflictsIT - Nodes added.
14:21:59.662 [main] INFO  o.a.j.oak.jcr.AsyncConflictsIT - issuing re-index and wait for finish
14:21:59.974 [oak-scheduled-executor-5] DEBUG o.a.j.o.p.i.l.L.perf - Created IndexWriter for directory Lucene Index : &amp;lt;No &apos;name&apos; property defined&amp;gt; [took 83ms]
14:21:59.980 [oak-scheduled-executor-5] DEBUG o.a.j.o.p.i.l.L.perf - Closed IndexWriter for directory Lucene Index : &amp;lt;No &apos;name&apos; property defined&amp;gt; [took 6ms]
14:21:59.980 [oak-scheduled-executor-5] DEBUG o.a.j.o.p.i.l.LuceneIndexEditorContext - Text extraction stats  0 (0 min, 0 sec, 0 B)
14:22:05.387 [oak-scheduled-executor-3] DEBUG o.a.j.o.p.i.l.L.perf - Created IndexWriter for directory Lucene Index : &amp;lt;No &apos;name&apos; property defined&amp;gt; [took 0ms]
14:22:05.389 [oak-scheduled-executor-3] DEBUG o.a.j.o.p.i.l.L.perf - Closed IndexWriter for directory Lucene Index : &amp;lt;No &apos;name&apos; property defined&amp;gt; [took 1ms]
14:22:05.389 [oak-scheduled-executor-3] DEBUG o.a.j.o.p.i.l.LuceneIndexEditorContext - Text extraction stats  0 (0 min, 0 sec, 0 B)
14:22:06.082 [oak-scheduled-executor-7] WARN  o.a.j.o.p.index.AsyncIndexUpdate - [async] Failed to retrieve previously indexed checkpoint r14e01aef4dd-0-1; re-running the initial index update
14:22:06.259 [oak-scheduled-executor-7] WARN  o.a.j.o.p.index.AsyncIndexUpdate - [async] Failed to retrieve previously indexed checkpoint r14e01aef4dd-0-1; re-running the initial index update
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;WARNs are not systematically. They happen something like 2 times over 5 runs.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alexparvulescu&quot; class=&quot;user-hover&quot; rel=&quot;alexparvulescu&quot;&gt;alexparvulescu&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chetanm&quot; class=&quot;user-hover&quot; rel=&quot;chetanm&quot;&gt;chetanm&lt;/a&gt; thoughts?&lt;/p&gt;

&lt;p&gt;PS: created&lt;br/&gt;
&lt;a href=&quot;https://github.com/davidegiannella/jackrabbit-oak/tree/OAK-2961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/davidegiannella/jackrabbit-oak/tree/OAK-2961&lt;/a&gt; for&lt;br/&gt;
experimenting in case.&lt;/p&gt;

</comment>
                            <comment id="14595539" author="edivad" created="Mon, 22 Jun 2015 09:00:48 +0000"  >&lt;p&gt;By looking at the code, it seems the above WARN could happen when over&lt;br/&gt;
the cluster, one node started and maybe already completed the first&lt;br/&gt;
indexing, but the update is not yet visible to all other nodes. They&lt;br/&gt;
will then try to perform the initial indexing. That should be trapped&lt;br/&gt;
either by the merging at mongo layer, ensuring therefore data&lt;br/&gt;
consistency, or by the concurrency check if the process is still&lt;br/&gt;
running.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alexparvulescu&quot; class=&quot;user-hover&quot; rel=&quot;alexparvulescu&quot;&gt;alexparvulescu&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chetanm&quot; class=&quot;user-hover&quot; rel=&quot;chetanm&quot;&gt;chetanm&lt;/a&gt; thoughts? I&apos;m for committing the patch&lt;br/&gt;
to trunk and consider this as fixed.&lt;/p&gt;
</comment>
                            <comment id="14595587" author="edivad" created="Mon, 22 Jun 2015 09:43:45 +0000"  >&lt;p&gt;Bulk move to 1.3.2&lt;/p&gt;</comment>
                            <comment id="14600724" author="amitjain" created="Thu, 25 Jun 2015 05:40:09 +0000"  >&lt;p&gt;I think these warnings are fine. I debugged a little and these warnings seemed to be caused by:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A checkpoint of a successful async thread run being visible to 2 subsequent threads.&lt;/li&gt;
	&lt;li&gt;And one of these releasing the checkpoint after its successful run and the 2nd trying to read the checkpoint which has already been released.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Relevant logs:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;10:51:40.025 DEBUG [oak-scheduled-executor-12] AsyncIndexUpdate.java:265 [async] Running background index task
10:51:40.030 INFO  [oak-scheduled-executor-12] AsyncIndexUpdate.java:319 Marked checkpointToRelease afterCheckpoint [r14e292a0ad4-1-4]
10:51:41.037 INFO  [oak-scheduled-executor-12] AsyncIndexUpdate.java:432 [async] Reindexing completed for indexes: [/oak:index/asyncconflict*(0)] in 1.007 s
10:51:41.040 INFO  [oak-scheduled-executor-12] AsyncIndexUpdate.java:334 Marked checkpointToRelease beforeCheckpoint [r14e2929faff-0-1]
10:51:41.040 INFO  [oak-scheduled-executor-12] AsyncIndexUpdate.java:351 [r14e2929faff-0-1] checkpoint to release
10:51:45.953 DEBUG [oak-scheduled-executor-19] AsyncIndexUpdate.java:265 [async] Running background index task
10:51:45.956 INFO  [oak-scheduled-executor-19] AsyncIndexUpdate.java:319 Marked checkpointToRelease afterCheckpoint [r14e292a1a05-1-3]
10:51:45.956 DEBUG [oak-scheduled-executor-19] AsyncIndexUpdate.java:221 [async] Releasing temporary checkpoint r14e2929faff-0-1: true
10:51:45.970 DEBUG [oak-scheduled-executor-19] AsyncIndexUpdate.java:447 [async] AsyncIndex update run completed in 14.37 ms. Indexed 0 nodes
10:51:45.971 INFO  [oak-scheduled-executor-19] AsyncIndexUpdate.java:334 Marked checkpointToRelease beforeCheckpoint [r14e292a0ad4-1-4]
10:51:46.042 DEBUG [oak-scheduled-executor-18] AsyncIndexUpdate.java:265 [async] Running background index task
10:51:46.042 WARN  [oak-scheduled-executor-18] AsyncIndexUpdate.java:286 [async] Failed to retrieve previously indexed checkpoint r14e292a0ad4-1-4; re-running the initial index update
10:51:46.043 INFO  [oak-scheduled-executor-18] AsyncIndexUpdate.java:319 Marked checkpointToRelease afterCheckpoint [r14e292a16af-0-4]
10:51:46.043 DEBUG [oak-scheduled-executor-18] AsyncIndexUpdate.java:221 [async] Releasing temporary checkpoint r14e2929faff-0-1: true
10:51:46.046 DEBUG [oak-scheduled-executor-18] AsyncIndexUpdate.java:221 [async] Releasing temporary checkpoint r14e292a0ad4-1-4: true
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14600818" author="edivad" created="Thu, 25 Jun 2015 07:32:15 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amitjain&quot; class=&quot;user-hover&quot; rel=&quot;amitjain&quot;&gt;amitjain&lt;/a&gt; for confirming the triviality of the logs. Will commit to trunk and see what backports we need.&lt;/p&gt;</comment>
                            <comment id="14600922" author="edivad" created="Thu, 25 Jun 2015 09:22:00 +0000"  >&lt;ul&gt;
	&lt;li&gt;trunk: &lt;a href=&quot;https://svn.apache.org/r1683700&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683700&lt;/a&gt; and &lt;a href=&quot;https://svn.apache.org/r1687441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1687441&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;1.0: &lt;a href=&quot;https://svn.apache.org/r1687501&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1687501&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;1.2: &lt;a href=&quot;https://svn.apache.org/r1687507&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1687507&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14614754" author="edivad" created="Mon, 6 Jul 2015 09:12:04 +0000"  >&lt;p&gt;Bulk close for 1.3.2&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12840495">OAK-3034</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12895331">OAK-3436</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12762824">OAK-2373</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12739645" name="OAK-2961.patch" size="1748" author="stillalex" created="Mon, 15 Jun 2015 17:17:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 19 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fo93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>