<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:50:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-4313] QueryImpl should avoid traversal with queries containing native constraints</title>
                <link>https://issues.apache.org/jira/browse/OAK-4313</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;If no index supports suggestion (or spellcheck or similar) query, then a query like&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SELECT * from [nt:base] where SUGGEST(&apos;test&apos;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;shouldn&apos;t get traversing index&lt;/p&gt;</description>
                <environment></environment>
        <key id="12962627">OAK-4313</key>
            <summary>QueryImpl should avoid traversal with queries containing native constraints</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="catholicon">Vikas Saurabh</assignee>
                                    <reporter username="catholicon">Vikas Saurabh</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Apr 2016 15:11:32 +0000</created>
                <updated>Tue, 8 Oct 2019 15:22:14 +0000</updated>
                            <resolved>Wed, 27 Apr 2016 21:10:25 +0000</resolved>
                                                    <fixVersion>1.2.15</fixVersion>
                    <fixVersion>1.4.2</fixVersion>
                    <fixVersion>1.5.2</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                                    <component>query</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15258249" author="catholicon" created="Tue, 26 Apr 2016 15:15:37 +0000"  >&lt;p&gt;I think &lt;tt&gt;SuggestImpl&lt;/tt&gt; and &lt;tt&gt;SpellcheckImpl&lt;/tt&gt; should throw in &lt;tt&gt;evaluate()&lt;/tt&gt; just as &lt;tt&gt;SimilarImpl&lt;/tt&gt; does. Something like:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SpellcheckImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SpellcheckImpl.java
index b4bdedc..51ed7bf 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SpellcheckImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SpellcheckImpl.java
@@ -66,8 +66,7 @@ public class SpellcheckImpl extends ConstraintImpl {
         // and because we don&apos;t know how to process native
         // conditions
         if (!(selector.getIndex() instanceof FulltextQueryIndex)) {
-            log.warn(&quot;No full-text index was found that can process the condition &quot; + toString());
-            return false;
+            throw new IllegalArgumentException(&quot;No full-text index was found that can process the condition &quot; + toString());
         }
         // we assume the index only returns the requested entries
         return true;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SuggestImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SuggestImpl.java
index fc04c40..4a4605a 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SuggestImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SuggestImpl.java
@@ -66,8 +66,7 @@ public class SuggestImpl extends ConstraintImpl {
         // and because we don&apos;t know how to process native
         // conditions
         if (!(selector.getIndex() instanceof FulltextQueryIndex)) {
-            log.warn(&quot;No full-text index was found that can process the condition &quot; + toString());
-            return false;
+            throw new IllegalArgumentException(&quot;No full-text index was found that can process the condition &quot; + toString());
         }
         // we assume the index only returns the requested entries
         return true;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m still trying to figure out how to test &apos;avoid repository scan&apos;. I would want to avoid asserting &apos;an exception is expected in &lt;tt&gt;QueryResult.getRows()&lt;/tt&gt;&apos;. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thomasm&quot; class=&quot;user-hover&quot; rel=&quot;thomasm&quot;&gt;thomasm&lt;/a&gt; thought?&lt;/p&gt;

&lt;p&gt;(cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=teofili&quot; class=&quot;user-hover&quot; rel=&quot;teofili&quot;&gt;teofili&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="15258290" author="catholicon" created="Tue, 26 Apr 2016 15:28:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=teofili&quot; class=&quot;user-hover&quot; rel=&quot;teofili&quot;&gt;teofili&lt;/a&gt; pointed me to &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2548&quot; title=&quot;Spellcheck/suggest queries should return no results if no index can handle them&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2548&quot;&gt;&lt;del&gt;OAK-2548&lt;/del&gt;&lt;/a&gt;. Changing exception-&amp;gt;no results was done there.&lt;/p&gt;

&lt;p&gt;Given we&apos;d like to keep &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2548&quot; title=&quot;Spellcheck/suggest queries should return no results if no index can handle them&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2548&quot;&gt;&lt;del&gt;OAK-2548&lt;/del&gt;&lt;/a&gt;, another option could be that we can disable traversal index if filter contains a native query. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thomasm&quot; class=&quot;user-hover&quot; rel=&quot;thomasm&quot;&gt;thomasm&lt;/a&gt;, thoughts?&lt;/p&gt;

&lt;p&gt;Possible patch:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
index daaac7f..1882cdb 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
@@ -947,7 +947,7 @@ public class QueryImpl implements Query {

     public SelectorExecutionPlan getBestSelectorExecutionPlan(FilterImpl filter) {
         return getBestSelectorExecutionPlan(context.getBaseState(), filter,
-                context.getIndexProvider(), traversalEnabled);
+                context.getIndexProvider(), traversalEnabled &amp;amp;&amp;amp; !filter.containsNativeConstraint());
     }

     private SelectorExecutionPlan getBestSelectorExecutionPlan(
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15258587" author="catholicon" created="Tue, 26 Apr 2016 18:08:20 +0000"  >&lt;p&gt;Attaching &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12800837/12800837_OAK-4313.patch&quot; title=&quot;OAK-4313.patch attached to OAK-4313&quot;&gt;patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; which contains a fix (2nd approach) and a few tests.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thomasm&quot; class=&quot;user-hover&quot; rel=&quot;thomasm&quot;&gt;thomasm&lt;/a&gt;, can you please review? (I&apos;m not sure if that was most minimal way to test this)&lt;/p&gt;</comment>
                            <comment id="15259785" author="tmueller" created="Wed, 27 Apr 2016 08:36:47 +0000"  >&lt;p&gt;Sorry I don&apos;t understand the logic behind the fix and the test. The assertion in the test is a bit strange:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;assertTrue(queryType + &quot; query without supporting index mustn&apos;t traverse&quot;,
                !(index !=null &amp;amp;&amp;amp; index instanceof TraversingIndex));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So the test passes if &lt;em&gt;any&lt;/em&gt; other index is used (a property index for example). Why is the traversing index so bad, and any other index is better? Maybe the cost of traversing is lower than the cost of using a property index. A property index doesn&apos;t support spellcheck and suggest, the same as the traversal index.&lt;/p&gt;

&lt;p&gt;Maybe you want to ensure the following:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;(a) if an index supports native queries, then use that one (if multiple such indexes are available, use the one with the lowest cost).&lt;/li&gt;
	&lt;li&gt;(b) if no such index is available that supports native queries, then return no rows in all cases.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If this is correct, then I suggest for the case (b) we use the traverse index, but add a new condition that is always wrong (kind of like adding &quot;where 1=0&quot;). I can come up with a patch for the query engine.&lt;/p&gt;</comment>
                            <comment id="15259876" author="catholicon" created="Wed, 27 Apr 2016 09:35:57 +0000"  >&lt;p&gt;The issue got more relevant with &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-3838&quot; title=&quot;IndexPlanner incorrectly lets all full text indices to participate for suggest/spellcheck queries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-3838&quot;&gt;&lt;del&gt;OAK-3838&lt;/del&gt;&lt;/a&gt; as before that a lucene index which doesn&apos;t support suggestion also declared to &apos;support&apos; suggestions (i.e. it didn&apos;t say INIFINITY for cost) and hence avoided the traversal.&lt;/p&gt;</comment>
                            <comment id="15259877" author="catholicon" created="Wed, 27 Apr 2016 09:37:53 +0000"  >&lt;p&gt;Yes, you&apos;re right. What I want to do is avoid repository traversal. Skipping TraversingIndex was the simplest approach I could think of (admittedly, I&apos;m not too sure of how to do &quot;where 1=0&quot; kind of condition).&lt;/p&gt;</comment>
                            <comment id="15260238" author="tmueller" created="Wed, 27 Apr 2016 14:29:22 +0000"  >&lt;p&gt;Sorry it took a bit longer than expected... here the patch. The idea is to use the traversal index, but ensure that we don&apos;t traverse the whole repository. Just one row at most. Scanning one row is needed for the rep:similar() case: for this case, we still expect that an exception is thrown (&lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2548&quot; title=&quot;Spellcheck/suggest queries should return no results if no index can handle them&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2548&quot;&gt;&lt;del&gt;OAK-2548&lt;/del&gt;&lt;/a&gt; is just for spellcheck and suggest, not for similarity search). Well if that&apos;s not correct, then this patch could be simplified a bit. But I would keep the idea to use traversal, but not traverse too much.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;--- src/main/java/org/apache/jackrabbit/oak/spi/query/Cursors.java	(revision 1741187)
+++ src/main/java/org/apache/jackrabbit/oak/spi/query/Cursors.java	(working copy)
@@ -218,7 +218,9 @@
 
         private final Deque&amp;lt;Iterator&amp;lt;? extends ChildNodeEntry&amp;gt;&amp;gt; nodeIterators =
                 Queues.newArrayDeque();
-
+        
+        private boolean justOneRow;
+        
         private String parentPath;
 
         private String currentPath;
@@ -241,6 +243,16 @@
             NodeState parent = null;
             NodeState node = rootState;
             
+            if (filter.containsNativeConstraint()) {
+                // OAK-4313: if no other index was found, 
+                // then we ensure that only one row is returned
+                nodeIterators.add(Iterators.singletonIterator(
+                        new MemoryChildNodeEntry(currentPath, node)));
+                parentPath = &quot;&quot;;       
+                justOneRow = true;
+                return;
+            }
+            
             if (filter.isAlwaysFalse()) {
                 // nothing can match this filter, leave nodes empty
                 return;
@@ -326,6 +338,9 @@
                         continue;
                     }
                     currentPath = PathUtils.concat(parentPath, name);
+                    if (justOneRow) {
+                        return;
+                    }
 
                     PathRestriction r = filter.getPathRestriction();
                     if (r == PathRestriction.ALL_CHILDREN || 
Index: src/test/java/org/apache/jackrabbit/oak/query/NativeQueryTest.java
===================================================================
--- src/test/java/org/apache/jackrabbit/oak/query/NativeQueryTest.java	(revision 0)
+++ src/test/java/org/apache/jackrabbit/oak/query/NativeQueryTest.java	(working copy)
@@ -0,0 +1,92 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the &quot;License&quot;); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.jackrabbit.oak.query;
+
+import static org.apache.jackrabbit.JcrConstants.JCR_SYSTEM;
+import static org.apache.jackrabbit.oak.plugins.nodetype.NodeTypeConstants.JCR_NODE_TYPES;
+import static org.apache.jackrabbit.oak.plugins.nodetype.write.InitialContent.INITIAL_CONTENT;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.fail;
+
+import java.text.ParseException;
+import java.util.Iterator;
+
+import org.apache.jackrabbit.oak.api.Result;
+import org.apache.jackrabbit.oak.api.ResultRow;
+import org.apache.jackrabbit.oak.api.Type;
+import org.apache.jackrabbit.oak.core.ImmutableRoot;
+import org.apache.jackrabbit.oak.namepath.NamePathMapper;
+import org.apache.jackrabbit.oak.spi.state.NodeState;
+import org.junit.Test;
+
+public class NativeQueryTest {
+
+    private final NodeState types = INITIAL_CONTENT.getChildNode(JCR_SYSTEM)
+            .getChildNode(JCR_NODE_TYPES);
+
+    private final ImmutableRoot ROOT = new ImmutableRoot(INITIAL_CONTENT);
+    private final QueryEngineImpl QUERY_ENGINE = (QueryEngineImpl)ROOT.getQueryEngine();
+
+    private final SQL2Parser p = new SQL2Parser(NamePathMapper.DEFAULT, types, new QueryEngineSettings());
+
+    @Test
+    public void dontTraverseForSuggest() throws Exception {
+        String sql = &quot;select [rep:suggest()] from [nt:base] where suggest(&apos;test&apos;)&quot;;
+        assertDontTraverseFor(sql, &quot;Suggest&quot;);
+    }
+
+    @Test
+    public void dontTraverseForSpellcheck() throws Exception {
+        String sql = &quot;select [rep:spellcheck()] from [nt:base] where spellcheck(&apos;test&apos;)&quot;;
+        assertDontTraverseFor(sql, &quot;Spellcheck&quot;);
+    }
+
+    @Test
+    public void dontTraverseForSimilar() throws Exception {
+        String sql = &quot;select [rep:similar()] from [nt:base] where similar(., &apos;/test/a&apos;)&quot;;
+        try {
+            assertDontTraverseFor(sql, &quot;Similar&quot;);
+            fail();
+        } catch(IllegalArgumentException e) {
+            // OAK-2548 if about 2spellcheck&quot; and &quot;suggest&quot;, but not about for &quot;similar&quot;.
+        }
+    }
+
+    private void assertDontTraverseFor(String sql, String queryType) throws ParseException {
+        QueryImpl query = (QueryImpl)p.parse(sql);
+        query.setExecutionContext(QUERY_ENGINE.getExecutionContext());
+        Result result = query.executeQuery();
+        Iterator&amp;lt;? extends ResultRow&amp;gt; it = result.getRows().iterator();
+        assertFalse(it.hasNext());
+        
+        query = (QueryImpl)p.parse(&quot;measure &quot; + sql);
+        query.setExecutionContext(QUERY_ENGINE.getExecutionContext());
+        result = query.executeQuery();
+        it = result.getRows().iterator();
+        while(it.hasNext()) {
+            ResultRow row = it.next();
+            String selector = row.getValue(&quot;selector&quot;).getValue(Type.STRING);
+            if (&quot;nt:base&quot;.equals(selector)) {
+                long scanCount = row.getValue(&quot;scanCount&quot;).getValue(Type.LONG);
+                // we expect that exactly one node was scanned, but that&apos;s it
+                // - no traversal of the whole respository
+                assertEquals(1, scanCount);
+            }
+        }        
+    }
+}
\ No newline at end of file
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15260364" author="catholicon" created="Wed, 27 Apr 2016 15:57:02 +0000"  >&lt;p&gt;Thanks for the patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thomasm&quot; class=&quot;user-hover&quot; rel=&quot;thomasm&quot;&gt;thomasm&lt;/a&gt;. I think TraversingCursor should not traverse even for rep:similar case. That rep:similar throws and not return false like others (spellcheck and suggest) should probably be corrected separately (may be a new issue relating to this one and &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2548&quot; title=&quot;Spellcheck/suggest queries should return no results if no index can handle them&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2548&quot;&gt;&lt;del&gt;OAK-2548&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Tested a modified version (removed &lt;tt&gt;justOneRow&lt;/tt&gt; and assert scanCount as 0) which works for current oak-lucene and patched oak-core (also, requires adjusting *sql2_native.txt similar to &lt;a href=&quot;https://svn.apache.org/r1662456&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1662456&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;I&apos;d like to commit the simplified patch as you suggested (opened &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-4317&quot; title=&quot;Similar and Native queries should return no results if no index can handle them&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-4317&quot;&gt;&lt;del&gt;OAK-4317&lt;/del&gt;&lt;/a&gt; to align SimilarImpl with SuggestImpl and SpellcheckImpl).&lt;/p&gt;</comment>
                            <comment id="15260950" author="catholicon" created="Wed, 27 Apr 2016 21:10:25 +0000"  >&lt;p&gt;Fixed in &lt;a href=&quot;https://svn.apache.org/r1741343&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1741343&lt;/a&gt; on trunk. Would start backport post 1.4.2.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thomasm&quot; class=&quot;user-hover&quot; rel=&quot;thomasm&quot;&gt;thomasm&lt;/a&gt;, can you please review? I&apos;ve fixed &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-4317&quot; title=&quot;Similar and Native queries should return no results if no index can handle them&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-4317&quot;&gt;&lt;del&gt;OAK-4317&lt;/del&gt;&lt;/a&gt; (&lt;tt&gt;return false&lt;/tt&gt; instead of &lt;tt&gt;throw&lt;/tt&gt; in SImilarImpl and NativeFunctionImpl).&lt;/p&gt;</comment>
                            <comment id="15261907" author="tmueller" created="Thu, 28 Apr 2016 10:05:44 +0000"  >&lt;p&gt;Looks good to me. Now no exception is thrown for the rep:similar() case, if no (Lucene / Solr) index is available. That simplifies the code, but I&apos;m not completely sure if this is a problem, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=teofili&quot; class=&quot;user-hover&quot; rel=&quot;teofili&quot;&gt;teofili&lt;/a&gt; is it OK? In &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2548&quot; title=&quot;Spellcheck/suggest queries should return no results if no index can handle them&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2548&quot;&gt;&lt;del&gt;OAK-2548&lt;/del&gt;&lt;/a&gt;, you didn&apos;t change rep:similar(), was there a reason for that, or maybe rep:similar() was just not available / important back then? I assume you would have written about that in &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2548&quot; title=&quot;Spellcheck/suggest queries should return no results if no index can handle them&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2548&quot;&gt;&lt;del&gt;OAK-2548&lt;/del&gt;&lt;/a&gt; if there was a reason to throw an exception.&lt;/p&gt;</comment>
                            <comment id="15261910" author="teofili" created="Thu, 28 Apr 2016 10:08:41 +0000"  >&lt;p&gt;yes, that&apos;s ok. Basically I should&apos;ve changed the behaviour also for &lt;em&gt;rep:similar&lt;/em&gt; back in &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2548&quot; title=&quot;Spellcheck/suggest queries should return no results if no index can handle them&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2548&quot;&gt;&lt;del&gt;OAK-2548&lt;/del&gt;&lt;/a&gt;, but I overlooked that: so thanks for having spotted it.&lt;/p&gt;</comment>
                            <comment id="15263121" author="catholicon" created="Thu, 28 Apr 2016 22:04:11 +0000"  >&lt;p&gt;Backported to 1.4 branch at &lt;a href=&quot;https://svn.apache.org/r1741533&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1741533&lt;/a&gt; and to 1.2 branch at &lt;a href=&quot;https://svn.apache.org/r1741539&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1741539&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15284552" author="edivad" created="Mon, 16 May 2016 13:57:26 +0000"  >&lt;p&gt;Bulk close for 1.5.2&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13044758">OAK-5739</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12927321">OAK-3838</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12777208">OAK-2548</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="12963118">OAK-4317</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12800837" name="OAK-4313.patch" size="5042" author="catholicon" created="Tue, 26 Apr 2016 18:08:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 26 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2wr8f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>