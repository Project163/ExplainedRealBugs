<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:54:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-9891] Removal (purge) of version of a node does not remove associated labels</title>
                <link>https://issues.apache.org/jira/browse/OAK-9891</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;We have encountered a behavior of versionStorage and versionLabels which I think is bug.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Current behavior:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Create a node and make it &lt;b&gt;versionable&lt;/b&gt;&lt;/li&gt;
	&lt;li&gt;Now create more than two versions (for example two version is&#160; &lt;b&gt;1.0&lt;/b&gt; and &lt;b&gt;1.1&lt;/b&gt; respectively)&lt;/li&gt;
	&lt;li&gt;Now add label at version 1.0 via &lt;b&gt;VersionHistory&lt;/b&gt; Object (for example label is &lt;b&gt;Label_1.0&lt;/b&gt;)&lt;/li&gt;
	&lt;li&gt;Now remove the version 1.0 via calling &lt;b&gt;removeVersion(1.0)&lt;/b&gt; method of &lt;b&gt;VersionHistory&lt;/b&gt; object&lt;/li&gt;
	&lt;li&gt;Now call method &lt;b&gt;hasVersionLabel(Label_1.0)&lt;/b&gt;&#160; of versionHistory . its now returning true.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Expected behaviour:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Call to the &lt;b&gt;hasVersionLabel(Label_1.0)&lt;/b&gt;&#160; of &lt;b&gt;versionHistory&lt;/b&gt; should not return true because version associated with label does not exist. And removing the version should remove associated labels.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If we say that &lt;b&gt;hasVersionLabel(Label_1.0)&lt;/b&gt;&#160; of &lt;b&gt;versionHistory&lt;/b&gt; returning true is expected behavior because label is not removed. Then call to the function getVersionByLabel(&lt;b&gt;Label_1.0) of versionHistory&lt;/b&gt; will ** throw VersionException because version does not exist. So the repository goes into inconsistent state.&lt;/p&gt;




&lt;p&gt;&lt;b&gt;Solution proposal:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;One of the solution can be that whenever consumer of&#160; versionHistory removes the version , he should be forced to remove the versionLabel first by throwing LabelExistException&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Another solution can be we should remove version label whenever user removes the version.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13475933">OAK-9891</key>
            <summary>Removal (purge) of version of a node does not remove associated labels</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mreutegg">Marcel Reutegger</assignee>
                                    <reporter username="arun92ram">Arun Kumar Ram</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Aug 2022 10:20:50 +0000</created>
                <updated>Wed, 10 May 2023 10:49:27 +0000</updated>
                            <resolved>Fri, 16 Sep 2022 06:24:02 +0000</resolved>
                                                    <fixVersion>1.46.0</fixVersion>
                    <fixVersion>1.22.13</fixVersion>
                                    <component>jcr</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="172800">48h</timeoriginalestimate>
                            <timeestimate seconds="172800">48h</timeestimate>
                                        <comments>
                            <comment id="17600385" author="arun92ram" created="Mon, 5 Sep 2022 12:49:07 +0000"  >&lt;p&gt;adding pull request link: &lt;a href=&quot;https://github.com/apache/jackrabbit-oak/pull/688&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-oak/pull/688&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17605630" author="mreutegg" created="Fri, 16 Sep 2022 06:23:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arun92ram&quot; class=&quot;user-hover&quot; rel=&quot;arun92ram&quot;&gt;arun92ram&lt;/a&gt;, thank you for the PR. Looks good and I merged it.&lt;/p&gt;

&lt;p&gt;Behaviour of Oak is now in line with Jackrabbit classic. Any label associated with a version that gets removed will also be removed automatically.&lt;/p&gt;</comment>
                            <comment id="17608210" author="arun92ram" created="Thu, 22 Sep 2022 10:35:09 +0000"  >&lt;p&gt;adding pull request for&#160; 1.22 branch &lt;a href=&quot;https://github.com/apache/jackrabbit-oak/pull/716&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/jackrabbit-oak/pull/716&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17610998" author="mreutegg" created="Thu, 29 Sep 2022 12:13:16 +0000"  >&lt;p&gt;Merged into 1.22 branch with PR #716&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13482727">OAK-9953</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13480124">JCR-4837</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13047932" name="OAK-9891_removal_of_version_should_remove_associated_labels.patch" size="3769" author="arun92ram" created="Tue, 9 Aug 2022 10:41:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 6 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z17luo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>