<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:43:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1566] ArrayIndexOutOfBoundsException in Segment.getRefId()</title>
                <link>https://issues.apache.org/jira/browse/OAK-1566</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;It looks like there is some SegmentMK bug that causes the &lt;tt&gt;Segment.getRefId()&lt;/tt&gt; to throw an &lt;tt&gt;ArrayIndexOutOfBoundsException&lt;/tt&gt; in some fairly rare corner cases.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12702283">OAK-1566</key>
            <summary>ArrayIndexOutOfBoundsException in Segment.getRefId()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jukkaz">Jukka Zitting</assignee>
                                    <reporter username="jukkaz">Jukka Zitting</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Mar 2014 23:21:28 +0000</created>
                <updated>Thu, 21 Aug 2014 20:52:15 +0000</updated>
                            <resolved>Fri, 21 Mar 2014 16:12:17 +0000</resolved>
                                                    <fixVersion>0.20</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13942150" author="jukkaz" created="Thu, 20 Mar 2014 19:06:21 +0000"  >&lt;p&gt;This is probably related to the HAMT data structure used for child node entries, as the problem only seems to occur in cases where we&apos;re dealing with flat nodes with at least hundreds of thousands of children.&lt;/p&gt;</comment>
                            <comment id="13942763" author="chetanm" created="Fri, 21 Mar 2014 04:11:55 +0000"  >&lt;p&gt;Similar exception is being seen when starting Oak based system. System log has quite a few entries with following stacktrace and in all cases the index is 100. &lt;/p&gt;

&lt;p&gt;Also to note this issue came when using &lt;tt&gt;FileDataStore&lt;/tt&gt; with &lt;tt&gt;SegmentNodeStore&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;21.03.2014 09:32:54.541 *ERROR* [OsgiInstallerImpl] com.adobe.granite.installer.factory.packages.impl.PackageTransformer Error while processing install task.
java.lang.ArrayIndexOutOfBoundsException: 100
	at org.apache.jackrabbit.oak.plugins.segment.Segment.getRefId(Segment.java:172)
	at org.apache.jackrabbit.oak.plugins.segment.Segment.internalReadRecordId(Segment.java:280)
	at org.apache.jackrabbit.oak.plugins.segment.Segment.readRecordId(Segment.java:276)
	at org.apache.jackrabbit.oak.plugins.segment.SegmentNodeState.getChildNode(SegmentNodeState.java:341)
	at org.apache.jackrabbit.oak.plugins.segment.SegmentNodeStore.getRoot(SegmentNodeStore.java:114)
	at org.apache.jackrabbit.oak.spi.state.ProxyNodeStore.getRoot(ProxyNodeStore.java:35)
	at org.apache.jackrabbit.oak.core.MutableRoot.&amp;lt;init&amp;gt;(MutableRoot.java:155)
	at org.apache.jackrabbit.oak.core.ContentSessionImpl.getLatestRoot(ContentSessionImpl.java:106)
	at org.apache.jackrabbit.oak.jcr.delegate.SessionDelegate.&amp;lt;init&amp;gt;(SessionDelegate.java:140)
	at org.apache.jackrabbit.oak.jcr.repository.RepositoryImpl$1.&amp;lt;init&amp;gt;(RepositoryImpl.java:261)
	at org.apache.jackrabbit.oak.jcr.repository.RepositoryImpl.createSessionDelegate(RepositoryImpl.java:259)
	at org.apache.jackrabbit.oak.jcr.repository.RepositoryImpl.login(RepositoryImpl.java:246)
	at com.adobe.granite.repository.impl.CRX3RepositoryImpl.login(CRX3RepositoryImpl.java:65)
	at com.adobe.granite.repository.impl.SlingRepositoryImpl$2.run(SlingRepositoryImpl.java:107)
	at com.adobe.granite.repository.impl.SlingRepositoryImpl$2.run(SlingRepositoryImpl.java:100)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAsPrivileged(Subject.java:517)
	at com.adobe.granite.repository.impl.SlingRepositoryImpl.createAdministrativeSession(SlingRepositoryImpl.java:100)
	at org.apache.sling.jcr.base.AbstractSlingRepository2.loginAdministrative(AbstractSlingRepository2.java:362)
	at com.adobe.granite.installer.factory.packages.impl.PackageTransformer$InstallPackageTask.execute(PackageTransformer.java:247)
	at org.apache.sling.installer.core.impl.OsgiInstallerImpl.executeTasks(OsgiInstallerImpl.java:733)
	at org.apache.sling.installer.core.impl.OsgiInstallerImpl.run(OsgiInstallerImpl.java:247)
	at java.lang.Thread.run(Thread.java:662)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13943193" author="jukkaz" created="Fri, 21 Mar 2014 16:12:17 +0000"  >&lt;p&gt;Turns out that this was  instead a bug introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1423&quot; title=&quot;SegmentMK: Add index(es) to tar file backend&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1423&quot;&gt;&lt;del&gt;OAK-1423&lt;/del&gt;&lt;/a&gt;. Fixed in revision 1579965.&lt;/p&gt;</comment>
                            <comment id="13962916" author="alex.parvulescu" created="Tue, 8 Apr 2014 12:47:32 +0000"  >&lt;p&gt;bulk close for the 0.20.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12735894">OAK-2049</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>380623</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1tkvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>380902</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>