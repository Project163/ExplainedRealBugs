<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:43:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1582] ClassCastException in MarkSweepGarbageCollector#init()</title>
                <link>https://issues.apache.org/jira/browse/OAK-1582</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;Initialising &lt;tt&gt;MarkSweepGarbageCollector&lt;/tt&gt; with any other node store than &lt;tt&gt;DocumentNodeStore&lt;/tt&gt; causes a &lt;tt&gt;ClassCastException&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12702625">OAK-1582</key>
            <summary>ClassCastException in MarkSweepGarbageCollector#init()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="mduerig">Michael D&#252;rig</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Mar 2014 12:43:57 +0000</created>
                <updated>Tue, 8 Apr 2014 12:47:33 +0000</updated>
                            <resolved>Fri, 28 Mar 2014 13:43:34 +0000</resolved>
                                                    <fixVersion>0.20</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13944975" author="tmueller" created="Mon, 24 Mar 2014 12:52:33 +0000"  >&lt;p&gt;With which other NodeStore do you want to use the MarkSweepGarbageCollector?&lt;/p&gt;

&lt;p&gt;The BlobStore garbage collection currently can&apos;t use the NodeStore interface because it needs the following features that are only present in the DocumentNodeStore interface:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;DocumentNodeStore.getBlobStore (needs to return a GarbageCollectableBlobStore)&lt;/li&gt;
	&lt;li&gt;DocumentNodeStore.getReferencedBlobsIterator&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I don&apos;t think we assume each NodeStore implements those methods, but I guess we could add an new interface, maybe NodeStoreWithGarbageCollectableBlobStore (a long name, not sure how to best shorten it).&lt;/p&gt;</comment>
                            <comment id="13944994" author="mduerig" created="Mon, 24 Mar 2014 13:11:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;With which other NodeStore do you want to use the MarkSweepGarbageCollector?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I wanted to use that for &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1559&quot; title=&quot;Expose BlobGCMBean for supported NodeStores&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1559&quot;&gt;&lt;del&gt;OAK-1559&lt;/del&gt;&lt;/a&gt; since the API promises to work with all &lt;tt&gt;NodeStore&lt;/tt&gt; implementations.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;The BlobStore garbage collection currently can&apos;t use the NodeStore interface because...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;tt&gt;MarkSweepGarbageCollector&lt;/tt&gt; should then probably &lt;b&gt;not&lt;/b&gt; take an &lt;tt&gt;NodeStore&lt;/tt&gt; argument but rather something more specific.&lt;/p&gt;
</comment>
                            <comment id="13947841" author="tmueller" created="Wed, 26 Mar 2014 12:14:57 +0000"  >&lt;p&gt;I don&apos;t have the time to look at this issue. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mduerig&quot; class=&quot;user-hover&quot; rel=&quot;mduerig&quot;&gt;mduerig&lt;/a&gt;, I guess you assigned the issue to me because I committed his patch (right?), but I&apos;m not actually the author of this code. I think it was Amit Jain, maybe you want to contact him or resolve the issue yourself?&lt;/p&gt;</comment>
                            <comment id="13947862" author="mduerig" created="Wed, 26 Mar 2014 12:44:55 +0000"  >&lt;p&gt;Yes I&apos;m aware of that. I thought it would make sense if you could take this up with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amitj_76&quot; class=&quot;user-hover&quot; rel=&quot;amitj_76&quot;&gt;amitj_76&lt;/a&gt; since you reviewed his initial patch so you know your way around in this area much better than I do.&lt;/p&gt;</comment>
                            <comment id="13947876" author="amitjain" created="Wed, 26 Mar 2014 12:59:24 +0000"  >&lt;p&gt;I am working to resolve this issue.&lt;/p&gt;</comment>
                            <comment id="13948939" author="amitjain" created="Thu, 27 Mar 2014 06:30:05 +0000"  >&lt;p&gt;Patch attached to fix the issue. Please review.&lt;/p&gt;

&lt;p&gt;Outline of the changes done:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Removed &lt;tt&gt;NodeStore&lt;/tt&gt; argument from the API.&lt;/li&gt;
	&lt;li&gt;Added a new interface &lt;tt&gt;BlobReferenceRetriever&lt;/tt&gt; with implementations &lt;tt&gt;DocumentBlobReferenceRetriever&lt;/tt&gt; and &lt;tt&gt;SegmentBlobReferenceRetriever&lt;/tt&gt; for retrieving references from the underlying mechanisms of Document and Segment NodeStores&lt;/li&gt;
	&lt;li&gt;Associated changes in the &lt;tt&gt;NodeStoreService&lt;/tt&gt; implementations.&lt;/li&gt;
	&lt;li&gt;Apart from changes introduced by above changes in the &lt;tt&gt;MarkSweepGarbageCollector&lt;/tt&gt;, have mark and sweep as public methods so that they can be called separately.&lt;/li&gt;
	&lt;li&gt;Moved &lt;tt&gt;ReferenceCollector&lt;/tt&gt; to &lt;tt&gt;org.apache.jackrabbit.oak.plugins.blob&lt;/tt&gt; from &lt;tt&gt;org.apache.jackrabbit.oak.plugins.segment&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13950712" author="mduerig" created="Fri, 28 Mar 2014 13:43:34 +0000"  >&lt;p&gt;Fixed at &lt;a href=&quot;http://svn.apache.org/r1582748&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1582748&lt;/a&gt;. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amitj_76&quot; class=&quot;user-hover&quot; rel=&quot;amitj_76&quot;&gt;amitj_76&lt;/a&gt; for the patch. &lt;/p&gt;

&lt;p&gt;Note that I created &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1639&quot; title=&quot;MarkSweepGarbageCollector improvements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1639&quot;&gt;&lt;del&gt;OAK-1639&lt;/del&gt;&lt;/a&gt; for following up with improvements that might still be needed. &lt;/p&gt;</comment>
                            <comment id="13962922" author="alex.parvulescu" created="Tue, 8 Apr 2014 12:47:33 +0000"  >&lt;p&gt;bulk close for the 0.20.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12702109">OAK-1559</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12637099" name="OAK-1582.patch" size="38272" author="amitjain" created="Thu, 27 Mar 2014 06:30:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>380964</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1tmzb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>381243</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>