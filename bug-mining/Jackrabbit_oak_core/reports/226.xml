<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:36:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-644] Revisit PrivilegeDefinitionStore&apos;s use of null as a child name parameter</title>
                <link>https://issues.apache.org/jira/browse/OAK-644</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;As discussed on &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-635&quot; title=&quot;SegmentMK NPE in SegmentNodeState#getChildNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-635&quot;&gt;&lt;del&gt;OAK-635&lt;/del&gt;&lt;/a&gt;, I&apos;m extracting the PrivilegeDefinitionStore code&amp;amp;patch into a dedicated issue.&lt;/p&gt;

&lt;p&gt;Following the discussion on the dev list, I&apos;ve filed it as a bug, as nulls are not considered valid input parameters.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12633005">OAK-644</key>
            <summary>Revisit PrivilegeDefinitionStore&apos;s use of null as a child name parameter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="angela">Angela Schreiber</assignee>
                                    <reporter username="stillalex">Alex Deparvu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Feb 2013 16:00:05 +0000</created>
                <updated>Tue, 21 May 2013 11:26:19 +0000</updated>
                            <resolved>Tue, 19 Feb 2013 16:40:18 +0000</resolved>
                                    <version>0.7</version>
                                    <fixVersion>0.7</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13581400" author="alex.parvulescu" created="Tue, 19 Feb 2013 16:10:18 +0000"  >&lt;p&gt;proposed patch to simply break the loop at the &apos;null&apos; entry.&lt;/p&gt;

&lt;p&gt;as discussed on &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-635&quot; title=&quot;SegmentMK NPE in SegmentNodeState#getChildNode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-635&quot;&gt;&lt;del&gt;OAK-635&lt;/del&gt;&lt;/a&gt; this may not be the best solution.&lt;/p&gt;

&lt;p&gt;the patch also enables the failing tests.&lt;/p&gt;</comment>
                            <comment id="13581403" author="anchela" created="Tue, 19 Feb 2013 16:13:26 +0000"  >&lt;p&gt;i didn&apos;t follow the other issue. can you provide addition information on how you got there?&lt;br/&gt;
null privilege name doesn&apos;t makes too much sense and i don&apos;t see any reason why you should get&lt;br/&gt;
there... so probably a bug or work-in-progress-artefact of the ac-work.&lt;br/&gt;
anyway: breaking is definitely wrong it is would lead to strange effects that hard to track.&lt;/p&gt;

&lt;p&gt;i will add a checkNotNull for the time being so we can track troubable some code.&lt;/p&gt;</comment>
                            <comment id="13581408" author="alex.parvulescu" created="Tue, 19 Feb 2013 16:23:35 +0000"  >&lt;p&gt;sure, no problem.&lt;br/&gt;
just run AccessControlManagerImplTest#testSetPolicy - currently marked as ignored.&lt;/p&gt;

&lt;p&gt;PrivilegeDefinitionStore.getBits receives an array that has only one element - a null value. &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.NullPointerException
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:191)
	at org.apache.jackrabbit.oak.kernel.KernelNodeState.getChildNode(KernelNodeState.java:208)
	at org.apache.jackrabbit.oak.core.ReadOnlyTree.getChild(ReadOnlyTree.java:140)
	at org.apache.jackrabbit.oak.core.ReadOnlyTree.getChild(ReadOnlyTree.java:1)
	at org.apache.jackrabbit.oak.security.privilege.PrivilegeDefinitionStore.getBits(PrivilegeDefinitionStore.java:113)
	at org.apache.jackrabbit.oak.security.authorization.PermissionHook$Diff.createEntry(PermissionHook.java:237)
	at org.apache.jackrabbit.oak.security.authorization.PermissionHook$Diff.addEntry(PermissionHook.java:197)
	at org.apache.jackrabbit.oak.security.authorization.PermissionHook$Diff.childNodeAdded(PermissionHook.java:147)
	at org.apache.jackrabbit.oak.spi.state.AbstractNodeState.compareAgainstBaseState(AbstractNodeState.java:160)
	at org.apache.jackrabbit.oak.kernel.KernelNodeState.compareAgainstBaseState(KernelNodeState.java:287)
	at org.apache.jackrabbit.oak.security.authorization.PermissionHook$Diff.childNodeAdded(PermissionHook.java:151)
	at org.apache.jackrabbit.oak.spi.state.AbstractNodeState.compareAgainstBaseState(AbstractNodeState.java:160)
	at org.apache.jackrabbit.oak.kernel.KernelNodeState.compareAgainstBaseState(KernelNodeState.java:287)
	at org.apache.jackrabbit.oak.security.authorization.PermissionHook$Diff.childNodeChanged(PermissionHook.java:164)
	at org.apache.jackrabbit.oak.plugins.memory.ModifiedNodeState$3.childNodeChanged(ModifiedNodeState.java:300)
	at org.apache.jackrabbit.oak.spi.state.AbstractNodeState.compareAgainstBaseState(AbstractNodeState.java:153)
	at org.apache.jackrabbit.oak.kernel.KernelNodeState.compareAgainstBaseState(KernelNodeState.java:287)
	at org.apache.jackrabbit.oak.plugins.memory.ModifiedNodeState.compareAgainstBaseState(ModifiedNodeState.java:271)
	at org.apache.jackrabbit.oak.security.authorization.PermissionHook.processCommit(PermissionHook.java:75)
	at org.apache.jackrabbit.oak.spi.commit.CompositeHook.processCommit(CompositeHook.java:59)
	at org.apache.jackrabbit.oak.spi.commit.CompositeHook.processCommit(CompositeHook.java:59)
	at org.apache.jackrabbit.oak.kernel.KernelNodeStoreBranch.merge(KernelNodeStoreBranch.java:128)
	at org.apache.jackrabbit.oak.core.RootImpl$2.run(RootImpl.java:256)
	at org.apache.jackrabbit.oak.core.RootImpl$2.run(RootImpl.java:1)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:337)
	at org.apache.jackrabbit.oak.core.RootImpl.commit(RootImpl.java:251)
	at org.apache.jackrabbit.oak.security.authorization.AccessControlManagerImplTest.testSetPolicy(AccessControlManagerImplTest.java:567)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13581413" author="anchela" created="Tue, 19 Feb 2013 16:27:29 +0000"  >&lt;p&gt;thanks... this is indeed caused by work-in-progress commit of mine.&lt;br/&gt;
i will take care of it.&lt;/p&gt;</comment>
                            <comment id="13581426" author="anchela" created="Tue, 19 Feb 2013 16:40:18 +0000"  >&lt;p&gt;fixed revision 1447803.&lt;/p&gt;

&lt;p&gt;in fact the wip permission hook is the culprit. since access&lt;br/&gt;
control is not enabled anyway, i removed it from the config for the&lt;br/&gt;
time being.&lt;/p&gt;

&lt;p&gt;added a null-check in the store in order to have earlier failure&lt;br/&gt;
and removed @Ignore annotation with the tests again.&lt;/p&gt;</comment>
                            <comment id="13588193" author="alex.parvulescu" created="Wed, 27 Feb 2013 10:10:22 +0000"  >&lt;p&gt;assigning fix version&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12569952" name="OAK-644.patch" size="1694" author="stillalex" created="Tue, 19 Feb 2013 16:10:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>313501</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 38 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1i3mf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>313846</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>