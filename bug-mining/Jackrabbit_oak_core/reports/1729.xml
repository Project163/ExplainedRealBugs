<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:53:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-6481] Missing versionable path property for oak:mount-libs-crx.default</title>
                <link>https://issues.apache.org/jira/browse/OAK-6481</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;After applying the &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-3777&quot; title=&quot;Multiplexing support in default PermissionStore implementation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-3777&quot;&gt;&lt;del&gt;OAK-3777&lt;/del&gt;&lt;/a&gt;, following warning can be found in the logs:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;21.07.2017 02:00:00.713 *WARN* [sling-default-999-HourlySnapshotJob] org.apache.jackrabbit.oak.plugins.version.ReadOnlyVersionManager Missing versionable path property for oak:mount-libs-crx.default at /jcr:system/jcr:versionStorage/5e/8d/89/5e8d8989-f86b-4e1b-b7f8-5089c44f5ed7
21.07.2017 02:00:00.713 *WARN* [sling-default-999-HourlySnapshotJob] org.apache.jackrabbit.oak.security.authorization.permission.CompiledPermissionImpl Cannot retrieve versionable node for /jcr:system/jcr:versionStorage/5e/8d/89/5e8d8989-f86b-4e1b-b7f8-5089c44f5ed7/1.0/jcr:frozenNode
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It suggests that somehow the name of the new permission store (oak:mount-libs-crx.default) is being used as the workspace name for the version storage.&lt;/p&gt;

&lt;p&gt;If I understand correctly, it shouldn&apos;t happen. The workspace name is sometimes used as the name of the permission store node (eg. &lt;tt&gt;/jcr:system/rep:permissionStore/crx.default&lt;/tt&gt;), but not the other way around - the name of the permission store node is not always a valid workspace name (eg. &lt;tt&gt;/jcr:system/rep:permissionStore/oak:mount-libs-crx.default&lt;/tt&gt;)&lt;/p&gt;

&lt;p&gt;//cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13089015">OAK-6481</key>
            <summary>Missing versionable path property for oak:mount-libs-crx.default</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tomek.rekawek">Tomek R&#281;kawek</reporter>
                        <labels>
                    </labels>
                <created>Fri, 21 Jul 2017 10:37:12 +0000</created>
                <updated>Thu, 3 Aug 2017 13:55:09 +0000</updated>
                            <resolved>Fri, 21 Jul 2017 15:46:19 +0000</resolved>
                                    <version>1.7.3</version>
                                    <fixVersion>1.7.5</fixVersion>
                    <fixVersion>1.8.0</fixVersion>
                                    <component>composite</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16096145" author="tomek.rekawek" created="Fri, 21 Jul 2017 11:20:08 +0000"  >&lt;p&gt;Or maybe it&apos;s another problem: the &lt;tt&gt;oak:mount-libs-crx.default&lt;/tt&gt; is sometimes used as the workspace name and it&apos;s valid for the permission-related code, but not for the other Oak code depending on the workspace name (eg. version storage).&lt;/p&gt;</comment>
                            <comment id="16096175" author="tomek.rekawek" created="Fri, 21 Jul 2017 12:10:41 +0000"  >&lt;p&gt;Attached a &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12878341/12878341_OAK-6481.patch&quot; title=&quot;OAK-6481.patch attached to OAK-6481&quot;&gt;patch proposal&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; that passes the workspace name and the mount separately, so the permission store code can get the permission root properly, without losing the original workspace name (which can be used in other Oak methods).&lt;/p&gt;

&lt;p&gt;If no multiplexing is used, the default Mount is passed, which fall backs to the default behaviour:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; @Nonnull &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getPermissionRootName(@Nonnull Mount mount, @Nonnull &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; workspace) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (mount.isDefault()) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; workspace;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; mount.getPathFragmentName() + &lt;span class=&quot;code-quote&quot;&gt;&quot;-&quot;&lt;/span&gt; + workspace;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anchela&quot; class=&quot;user-hover&quot; rel=&quot;anchela&quot;&gt;anchela&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, WDYT?&lt;/p&gt;</comment>
                            <comment id="16096279" author="alex.parvulescu" created="Fri, 21 Jul 2017 13:52:18 +0000"  >&lt;p&gt;I&apos;m trying to read the patch, but I don&apos;t see the fix you mention here. there are plenty of changes that are orthogonal to the problem you mention. could you explain what exactly are you trying to achieve here?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If no multiplexing is used, the default Mount is passed, which fall backs to the default behaviour:&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;yes. I agree this looks cleaner than before, but please submit an improvement request for this one, don&apos;t include it as a part of an unrelated issue.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;but not for the other Oak code depending on the workspace name (eg. version storage).&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;that was my initial thought as well. where is this fixed in the patch? could we extract those parts to clarify the fix you propose?&lt;br/&gt;
Was the version storage fixed to work with the multiplexing code? If so, I maybe failed to properly integrate into that, otherwise we probably need to fix the version storage bits first.&lt;/p&gt;</comment>
                            <comment id="16096293" author="tomek.rekawek" created="Fri, 21 Jul 2017 14:12:22 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m trying to read the patch, but I don&apos;t see the fix you mention here. there are plenty of changes that are orthogonal to the problem you mention. could you explain what exactly are you trying to achieve here?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sure. In the current trunk code, the workspace name parameter passed between different permission-related classes is sometimes a valid workspace name (in this example, &lt;tt&gt;crx.default&lt;/tt&gt;) and sometimes it&apos;s just a name of the permission root node (&lt;tt&gt;oak:mount-libs-crx.default&lt;/tt&gt;). The latter is not a valid workspace name, but works in the permission-related code, because in this code it&apos;s only used to get the right permission root node from /jcr:system/rep:permissionsStore.&lt;/p&gt;

&lt;p&gt;However, when the permission-related code interacts with other parts of the Oak, like in here: &lt;a href=&quot;https://github.com/apache/jackrabbit-oak/blob/b8f559514e3f4d76bb28e3b7584b8350acd8ff82/oak-authorization-cug/src/main/java/org/apache/jackrabbit/oak/spi/security/authorization/cug/impl/CugPermissionProvider.java#L397&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CugPermissionProvider:397&lt;/a&gt;, passing the same &quot;extended&quot; workspace name may break something. In this case, the ReadOnlyVersionManager#getVersionable() method expects a valid workspace name, while the CugPermissionsProvider passes the one containing the Mount fragment.&lt;/p&gt;

&lt;p&gt;The submitted patch changes this behaviour. It no longer combines the workspace name with the mount name, but keeps them separated. This way, if some code invoked from the permission providers (like the ReadOnlyVersionManager) expects a valid workspace name, it can get one.&lt;/p&gt;</comment>
                            <comment id="16096300" author="rombert" created="Fri, 21 Jul 2017 14:22:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;Was the version storage fixed to work with the multiplexing code? If so, I maybe failed to properly integrate into that, otherwise we probably need to fix the version storage bits first.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;For now we don&apos;t expect the versioning storage to interact with the composite setup (&lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-6445&quot; title=&quot;Ensure mounted node stores don&amp;#39;t contain versionable nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-6445&quot;&gt;&lt;del&gt;OAK-6445&lt;/del&gt;&lt;/a&gt;) so the versioning code should only be minimally impacted - hopefully not at all.&lt;/p&gt;</comment>
                            <comment id="16096328" author="tomek.rekawek" created="Fri, 21 Jul 2017 14:39:33 +0000"  >&lt;p&gt;After discussing with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt; on the IM, there&apos;s a second version of the patch: &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12878356/12878356_OAK-6481-2.patch&quot; title=&quot;OAK-6481-2.patch attached to OAK-6481&quot;&gt;OAK-6481-2.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;. It passes the permissionRootName rather than the whole mount object. Also, there&apos;s a new test case for the getPermissionRootName() method.&lt;/p&gt;</comment>
                            <comment id="16096397" author="alex.parvulescu" created="Fri, 21 Jul 2017 15:46:19 +0000"  >&lt;p&gt;applied the patch with minor modifications &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1802609&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1802609&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomek.rekawek&quot; class=&quot;user-hover&quot; rel=&quot;tomek.rekawek&quot;&gt;tomek.rekawek&lt;/a&gt; for the fix!&lt;/p&gt;</comment>
                            <comment id="16112767" author="edivad" created="Thu, 3 Aug 2017 13:55:09 +0000"  >&lt;p&gt;Bulk close for 1.7.5&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12878356" name="OAK-6481-2.patch" size="19398" author="tomek.rekawek" created="Fri, 21 Jul 2017 14:38:18 +0000"/>
                            <attachment id="12878341" name="OAK-6481.patch" size="18943" author="tomek.rekawek" created="Fri, 21 Jul 2017 12:10:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3hudr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>