<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:40:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1186] Parallel execution of ConcurrentReadAccessControlledTreeTest fails with MongoMK</title>
                <link>https://issues.apache.org/jira/browse/OAK-1186</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;The is caused by concurrent creation of test content and the conflict it creates in the index. Every Oak test instance tries to create &lt;tt&gt;/oak:index/nodetype/:index/nt%3Afile&lt;/tt&gt;, but only one will succeed. AFAICS there are two options how to handle this:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Implement conflict annotation (&lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1185&quot; title=&quot;DocumentNodeStore: annotate conflicts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1185&quot;&gt;OAK-1185&lt;/a&gt;), though I&apos;m not sure this will really work. On commit, the rebase happens first, when changes from the other Oak instance may not be visible yet. Then, the commit hook runs and perform another branch commit with the changes, which works fine. Only the last step fails, when MongoMK tries to merge the branch. This is the point when the conflict may be detected.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Implement a retry logic in MongoMK/NS&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12679185">OAK-1186</key>
            <summary>Parallel execution of ConcurrentReadAccessControlledTreeTest fails with MongoMK</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mreutegg">Marcel Reutegger</assignee>
                                    <reporter username="mreutegg">Marcel Reutegger</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Nov 2013 09:25:01 +0000</created>
                <updated>Mon, 3 Apr 2017 15:42:19 +0000</updated>
                            <resolved>Mon, 6 Jan 2014 14:34:08 +0000</resolved>
                                    <version>0.10</version>
                                    <fixVersion>0.14</fixVersion>
                                    <component>benchmarks</component>
                    <component>core</component>
                    <component>mongomk</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13827487" author="mreutegg" created="Wed, 20 Nov 2013 09:47:04 +0000"  >&lt;p&gt;As mentioned in the description, conflict annotation does not always work, because it may happen that the conflict is not yet there on rebase, but only when merge is called on the underlying storage.&lt;/p&gt;

&lt;p&gt;Created &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1202&quot; title=&quot;Retry Persisted merge&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1202&quot;&gt;&lt;del&gt;OAK-1202&lt;/del&gt;&lt;/a&gt; to persue the retry approach.&lt;/p&gt;</comment>
                            <comment id="13834582" author="mreutegg" created="Thu, 28 Nov 2013 07:57:19 +0000"  >&lt;p&gt;The initial issue is now fixed and the retry is done as expected, but now the import fails because they concurrently import the same XML system view file with referenceable nodes. This lead to a constraint violation exception because those referenceable nodes have duplicate UUIDs. The test specifies an ImportUUIDBehavior.IMPORT_UUID_CREATE_NEW, which should actually result in newly created UUIDs in case of a conflict. This fails in the test because all oak instances import the nodes at the same time and the base state doesn&apos;t have any of those nodes at the time of the save.&lt;/p&gt;

&lt;p&gt;It is probably best to change the test.&lt;/p&gt;</comment>
                            <comment id="13836402" author="mreutegg" created="Mon, 2 Dec 2013 10:09:06 +0000"  >&lt;p&gt;The implementation for IMPORT_UUID_CREATE_NEW is in my view not quite correct in Jackrabbit and Oak. The spec says:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Incoming nodes are assigned newly created identifiers upon addition to the workspace. As a result, identifier collisions never occur.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Both implementations currently assume the behavior only kicks in when a collision occurs and only create a new UUID in this case. These kind of implementations obviously have the drawback that race conditions can occur when multiple sessions import a node with the same UUID. With Oak it can even be reproduced deterministically because of the MVCC model.&lt;/p&gt;</comment>
                            <comment id="13863012" author="mreutegg" created="Mon, 6 Jan 2014 14:34:08 +0000"  >&lt;p&gt;With the changes from &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1244&quot; title=&quot;Always create new UUID on ImportBehavior.IMPORT_UUID_CREATE_NEW&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1244&quot;&gt;&lt;del&gt;OAK-1244&lt;/del&gt;&lt;/a&gt;, running the benchmark concurrently is now successful.&lt;/p&gt;

&lt;p&gt;Resolving as fixed.&lt;/p&gt;</comment>
                            <comment id="13869504" author="alex.parvulescu" created="Mon, 13 Jan 2014 13:05:58 +0000"  >&lt;p&gt;bulk close for the 0.14 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12682099">OAK-1244</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12680136">OAK-1202</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>358550</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 44 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1pt53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>358840</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>