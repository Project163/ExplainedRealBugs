<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:40:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1132] QueryEngine #executeQuery creates a new revision on each call</title>
                <link>https://issues.apache.org/jira/browse/OAK-1132</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;It looks like the #getQueryEngine relies on the node state provided by &lt;em&gt;AbstractRoot.this.getRootState()&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;On the segmentmk it looks like each call creates a new revision &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.&lt;br/&gt;
One option is to switch to the base state, but it looks like there are some tests failing.&lt;/p&gt;



&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://svn.apache.org/viewvc/jackrabbit/oak/trunk/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentRootBuilder.java?view=markup#l46&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/jackrabbit/oak/trunk/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentRootBuilder.java?view=markup#l46&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12676655">OAK-1132</key>
            <summary>QueryEngine #executeQuery creates a new revision on each call</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stillalex">Alex Deparvu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Oct 2013 15:32:41 +0000</created>
                <updated>Thu, 21 Nov 2013 10:30:42 +0000</updated>
                            <resolved>Thu, 31 Oct 2013 16:39:25 +0000</resolved>
                                                    <fixVersion>0.11</fixVersion>
                                    <component>query</component>
                    <component>segmentmk</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13809270" author="alex.parvulescu" created="Wed, 30 Oct 2013 16:08:09 +0000"  >&lt;p&gt;actually each #executeQuery call creates a new revision, as that method calls the #getExecutionContext method, I&apos;ll update the title to reflect this.&lt;/p&gt;</comment>
                            <comment id="13810416" author="jukkaz" created="Thu, 31 Oct 2013 16:39:25 +0000"  >&lt;p&gt;Fixed in revision 1537547 as discussed on oak-dev@. Query execution now uses the base state for normal index lookups.&lt;/p&gt;</comment>
                            <comment id="13810420" author="alex.parvulescu" created="Thu, 31 Oct 2013 16:50:30 +0000"  >&lt;p&gt;awesome, thanks Jukka for taking care of this!&lt;/p&gt;</comment>
                            <comment id="13817122" author="mduerig" created="Fri, 8 Nov 2013 08:53:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;Query execution now uses the base state for normal index lookups.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;At least to me it isn&apos;t obvious why the base state is sufficient here while for the second argument we need a &lt;tt&gt;Tree&lt;/tt&gt; for the head state. Especially since the respective method names on &lt;tt&gt;ExecutionContext&lt;/tt&gt; suggest the two entities being the same except for access control evaluation. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jukkaz&quot; class=&quot;user-hover&quot; rel=&quot;jukkaz&quot;&gt;jukkaz&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alex.parvulescu&quot; class=&quot;user-hover&quot; rel=&quot;alex.parvulescu&quot;&gt;alex.parvulescu&lt;/a&gt; could you clarify this in the  Javadoc of &lt;tt&gt;ExecutionContext&lt;/tt&gt;. &lt;/p&gt;</comment>
                            <comment id="13817323" author="jukkaz" created="Fri, 8 Nov 2013 15:01:51 +0000"  >&lt;p&gt;I renamed the &lt;tt&gt;getRootState&lt;/tt&gt; method to &lt;tt&gt;getBaseState&lt;/tt&gt; in revision 1540064. The intention, as mentioned in the javadocs is to use that state for the index lookups, and since indices aren&apos;t updated yet for transient changes, there&apos;s no point in using the head state for index lookups.&lt;/p&gt;</comment>
                            <comment id="13828761" author="alex.parvulescu" created="Thu, 21 Nov 2013 10:30:42 +0000"  >&lt;p&gt;bulk close for the 0.11 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>356087</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1pdyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>356375</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>