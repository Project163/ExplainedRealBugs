<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:36:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-554] PropertyStates#createProperty ignores namespace mappings when creating states of type NAME and PATH</title>
                <link>https://issues.apache.org/jira/browse/OAK-554</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;as far as i saw we use PropertyStates#createProperty to create and&lt;br/&gt;
set an OAK property from a given JCR value or a list of JCR values.&lt;/p&gt;

&lt;p&gt;this works well for all types of values except for NAME, PATH which &lt;br/&gt;
may contain values with remapped namespaces which will not be converted&lt;br/&gt;
back to oak-values during the state creation:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;     List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; vals = Lists.newArrayList();
     &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Value value : values) {
         vals.add(value.getString());
     }
     &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MultiGenericPropertyState(name, vals, Type.fromTag(type, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;if am not mistaken &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;value.getString()&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; will return the JCR&lt;br/&gt;
representation of the value instead of the oak representation as it&lt;br/&gt;
would be needed here.&lt;/p&gt;

&lt;p&gt;possible solutions include:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;passing namepathmapper to the create method&lt;/li&gt;
	&lt;li&gt;only accept oak Value implementation that allows to retrieve the&lt;br/&gt;
  internal representation, which is present in the ValueImpl afaik.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12627216">OAK-554</key>
            <summary>PropertyStates#createProperty ignores namespace mappings when creating states of type NAME and PATH</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Jan 2013 17:34:15 +0000</created>
                <updated>Mon, 6 May 2013 15:48:54 +0000</updated>
                            <resolved>Fri, 18 Jan 2013 16:22:37 +0000</resolved>
                                                    <fixVersion>0.6</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13553644" author="mduerig" created="Tue, 15 Jan 2013 10:31:11 +0000"  >&lt;blockquote&gt;&lt;p&gt;only accept oak Value implementation that allows to retrieve the internal representation, which is present in the ValueImpl afaik.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think that&apos;s what we should do.&lt;/p&gt;

&lt;p&gt;The two &lt;tt&gt;createProperty&lt;/tt&gt; methods that take a &lt;tt&gt;Value&lt;/tt&gt; as argument should check whether it is a &lt;tt&gt;ValueImpl&lt;/tt&gt; and unpack and return its internal representation. If this is not the case, we should fall back to the current behaviour. Except for &lt;tt&gt;NAME&lt;/tt&gt; and &lt;tt&gt;PATH&lt;/tt&gt; where I&apos;d just throw an &lt;tt&gt;IllegalArguementException&lt;/tt&gt;. &lt;br/&gt;
We can always add a further method, which takes care of that and which takes a &lt;tt&gt;NamePathMapper&lt;/tt&gt; as one of its arguments if it turns out to be required. &lt;/p&gt;</comment>
                            <comment id="13554956" author="anchela" created="Wed, 16 Jan 2013 11:39:20 +0000"  >&lt;p&gt;agreed... this would be my preferred so solution as well.&lt;br/&gt;
in particular as i don&apos;t remember a use-case for custom value implementations... if we can&lt;br/&gt;
handle them smoothly (for example someone using the value impls from jcr-commons) it&apos;s&lt;br/&gt;
nice but i am perfectly fine throwing for the name/path variants as people should really use&lt;br/&gt;
the valuefactory obtained from the session to build value objects.&lt;/p&gt;
</comment>
                            <comment id="13557325" author="mduerig" created="Fri, 18 Jan 2013 16:22:37 +0000"  >&lt;p&gt;Fixed at revision 1435216&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>303986</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17hb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>251773</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>