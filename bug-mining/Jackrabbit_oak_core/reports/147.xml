<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:35:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-447] Adding a node with the name of a removed node can lead to an inconsistent hierarchy of node builders</title>
                <link>https://issues.apache.org/jira/browse/OAK-447</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description></description>
                <environment></environment>
        <key id="12616073">OAK-447</key>
            <summary>Adding a node with the name of a removed node can lead to an inconsistent hierarchy of node builders</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mduerig">Michael D&#252;rig</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Nov 2012 15:30:15 +0000</created>
                <updated>Mon, 6 May 2013 15:48:55 +0000</updated>
                            <resolved>Thu, 15 Nov 2012 17:09:26 +0000</resolved>
                                                    <fixVersion>0.6</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13497164" author="mduerig" created="Wed, 14 Nov 2012 15:42:58 +0000"  >&lt;p&gt;I added a test case demonstrating the issue at revision 1409233.&lt;/p&gt;</comment>
                            <comment id="13497266" author="mduerig" created="Wed, 14 Nov 2012 17:44:12 +0000"  >&lt;p&gt;Tentative patch. With the patch the issue goes away, however I can&apos;t be sure whether this is the right thing to do. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jukkaz&quot; class=&quot;user-hover&quot; rel=&quot;jukkaz&quot;&gt;jukkaz&lt;/a&gt;, could you have a look?&lt;/p&gt;</comment>
                            <comment id="13497273" author="mduerig" created="Wed, 14 Nov 2012 17:49:56 +0000"  >&lt;p&gt;Beyond the immediate issue at hand, I think &lt;tt&gt;MemoryNodeBuilder&lt;/tt&gt; should be refactored/simplified. It is quiet difficult to follow the state tracking logic, and introducing the &lt;tt&gt;reset()&lt;/tt&gt; method has made it even more difficult (and error prone). &lt;/p&gt;</comment>
                            <comment id="13497944" author="jukkaz" created="Thu, 15 Nov 2012 11:22:55 +0000"  >&lt;p&gt;Looking at this now.&lt;/p&gt;

&lt;p&gt;Re: refactoring/simplification; Agreed. MNB originally had pretty good state invariants that are still described in the now outdated class javadocs. As the design settles again, with reset() and status handling added, I think we should formulate new invariants and better assert/document them. That would probably also lead to some simplification of the code.&lt;/p&gt;</comment>
                            <comment id="13497951" author="mduerig" created="Thu, 15 Nov 2012 11:29:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;MNB originally had pretty good state invariants &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Right, see also the FIXME in &lt;tt&gt;getNodeState&lt;/tt&gt; to that respect.&lt;/p&gt;</comment>
                            <comment id="13498059" author="jukkaz" created="Thu, 15 Nov 2012 14:53:34 +0000"  >&lt;p&gt;I found an alternative fix to this. The root cause was in the handling of the read-only case at the beginning of child(). That code didn&apos;t take the remove + add situation into account and would result in a child builder that isn&apos;t properly connected with the rest of the builder hierarchy.&lt;/p&gt;

&lt;p&gt;I seem to have some trouble with svn access at the moment, so the fix is in &lt;a href=&quot;https://github.com/jukka/jackrabbit-oak/commit/a0aeefe5378d1f189ab38ca462af45096a55c1d7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jukka/jackrabbit-oak/commit/a0aeefe5378d1f189ab38ca462af45096a55c1d7&lt;/a&gt; until I manage to commit it.&lt;/p&gt;</comment>
                            <comment id="13498075" author="mduerig" created="Thu, 15 Nov 2012 15:23:40 +0000"  >&lt;p&gt;Thanks. This seem like a better solution. AFAICS your fix skips the short cut for the read only case when the base of the write state is not the same as the base state of the builder. Which is the correct thing to do because in this case we are in fact in write mode.&lt;/p&gt;</comment>
                            <comment id="13498142" author="jukkaz" created="Thu, 15 Nov 2012 17:09:26 +0000"  >&lt;p&gt;Exactly. Committed in revision 1409885.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12553515" name="OAK-447.patch" size="20508" author="mduerig" created="Wed, 14 Nov 2012 17:44:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>257816</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 1 week, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0kk6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>118088</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>