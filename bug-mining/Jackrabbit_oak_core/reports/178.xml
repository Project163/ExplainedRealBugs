<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:36:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-531] NodeBuilder deleted child nodes can come back</title>
                <link>https://issues.apache.org/jira/browse/OAK-531</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;While working on &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-520&quot; title=&quot;IllegalStateException in MemoryNodeBuilder&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-520&quot;&gt;&lt;del&gt;OAK-520&lt;/del&gt;&lt;/a&gt;, I&apos;ve noticed a problem with the NodeBuilder: when we delete an entire hierarchy of nodes and then recreate a part of it, some of the previously deleted nodes can come back.&lt;/p&gt;

&lt;p&gt;This only happens when there are more than 3 levels of nodes.&lt;/p&gt;

&lt;p&gt;So given a hierarchy of nodes: /x/y/z deleted &apos;x&apos; and simply use the NodeBuilder to traverse down on the same path: .child(&apos;x&apos;).child(&apos;y&apos;).&lt;br/&gt;
At this point the &apos;z&apos; child reappears even though it was deleted before.&lt;/p&gt;


&lt;p&gt;I&apos;ll attach a test case shortly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12624320">OAK-531</key>
            <summary>NodeBuilder deleted child nodes can come back</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="stillalex">Alex Deparvu</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Dec 2012 18:15:47 +0000</created>
                <updated>Mon, 6 May 2013 15:49:09 +0000</updated>
                            <resolved>Wed, 19 Dec 2012 16:46:29 +0000</resolved>
                                                    <fixVersion>0.6</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13534141" author="alex.parvulescu" created="Mon, 17 Dec 2012 18:17:31 +0000"  >&lt;p&gt;Attaching failing test case.&lt;/p&gt;

&lt;p&gt;The code is based on the Property2Index code.&lt;/p&gt;</comment>
                            <comment id="13536100" author="mduerig" created="Wed, 19 Dec 2012 16:38:45 +0000"  >&lt;p&gt;&lt;tt&gt;MemoryNodeBuilder.write&lt;/tt&gt; does only check a builder&apos;s immediate parent for removed child builders. It should instead traverse up the hierarchy and check whether any of the parents has been removed. &lt;/p&gt;</comment>
                            <comment id="13536107" author="mduerig" created="Wed, 19 Dec 2012 16:46:29 +0000"  >&lt;p&gt;Fixed at revision 1423930. Thanks for finding this!&lt;/p&gt;</comment>
                            <comment id="13536558" author="mduerig" created="Wed, 19 Dec 2012 23:13:52 +0000"  >&lt;p&gt;Turns out that there is no need to traverse the parent hierarchy. Just correctly check whether a node has been removed from the parent builder by checking whether it is present in the base state but not present in the write state. Improved at revision 1424213.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12623977">OAK-520</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12561324" name="OAK-531.patch" size="3380" author="stillalex" created="Mon, 17 Dec 2012 18:17:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>299159</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 48 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i15zyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>243126</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>