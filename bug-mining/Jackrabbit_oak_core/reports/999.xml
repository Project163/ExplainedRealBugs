<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:45:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-2052] Node.setProperty(String, Value) fails for binary non ValueImpls</title>
                <link>https://issues.apache.org/jira/browse/OAK-2052</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/JCRVLT-58&quot; title=&quot;VLT RCP errs when moving binary content&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JCRVLT-58&quot;&gt;&lt;del&gt;JCRVLT-58&lt;/del&gt;&lt;/a&gt; reports an issue where &quot;copying&quot; of a JCR value fails,&lt;br/&gt;
because the source and destination repository implementation are&lt;br/&gt;
different.&lt;/p&gt;

&lt;p&gt;so basically:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;s1 = repository1.login(); &lt;span class=&quot;code-comment&quot;&gt;// remote repository via davex
&lt;/span&gt;s2 = repository2.login(); &lt;span class=&quot;code-comment&quot;&gt;// local oak repository
&lt;/span&gt;
p1 = s1.getProperty(....);
n2 = s2.getNode(....);

n2.setProperty(p1.getName(), p1.getValue());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;AFAICT, this usually works but not for binary values. it eventually fails in:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.jackrabbit.oak.plugins.value.ValueImpl#getBlob(javax.jcr.Value)

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Blob getBlob(Value value) {
        checkState(value &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; ValueImpl);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; ((ValueImpl) value).getBlob();
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...because the value is not a ValueImpl but a QValue.&lt;/p&gt;

&lt;p&gt;IMO, this should work, even if the value is not a ValueImpl. In this&lt;br/&gt;
case, it should fall back to the API methods to read the binary.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12736711">OAK-2052</key>
            <summary>Node.setProperty(String, Value) fails for binary non ValueImpls</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="tripod">Tobias Bocanegra</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Aug 2014 05:54:57 +0000</created>
                <updated>Tue, 14 Oct 2014 15:28:16 +0000</updated>
                            <resolved>Thu, 28 Aug 2014 10:47:40 +0000</resolved>
                                                    <fixVersion>1.0.8</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14113653" author="mduerig" created="Thu, 28 Aug 2014 10:47:40 +0000"  >&lt;p&gt;Fixed at &lt;a href=&quot;http://svn.apache.org/r1621115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1621115&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14114107" author="tripod" created="Thu, 28 Aug 2014 18:21:26 +0000"  >&lt;p&gt;thanks. works.&lt;/p&gt;</comment>
                            <comment id="14170993" author="chetanm" created="Tue, 14 Oct 2014 14:26:45 +0000"  >&lt;p&gt;In some case if there is an error while creating the Value from InputStream then that gets wrapped in ErrorValue. With current code in branch that exception would get lost as the instanceof check would fail. With this fix that exception would be surfaced and user would get to know the root cause.&lt;/p&gt;

&lt;p&gt;So possibly it would be good to merge it to 1.0 branch.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tripod&quot; class=&quot;user-hover&quot; rel=&quot;tripod&quot;&gt;tripod&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mduerig&quot; class=&quot;user-hover&quot; rel=&quot;mduerig&quot;&gt;mduerig&lt;/a&gt; Thoughts?&lt;/p&gt;</comment>
                            <comment id="14171004" author="mduerig" created="Tue, 14 Oct 2014 14:36:16 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14171071" author="chetanm" created="Tue, 14 Oct 2014 15:28:04 +0000"  >&lt;p&gt;Merged to 1.0 in &lt;a href=&quot;http://svn.apache.org/r1631789&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1631789&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12736635">JCRVLT-58</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12678416">OAK-1164</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 5 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1zbr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>