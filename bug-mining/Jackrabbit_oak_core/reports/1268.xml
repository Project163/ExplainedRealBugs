<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:48:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-3155] AsyncIndex stats do not capture execution for runs where no indexing is performed</title>
                <link>https://issues.apache.org/jira/browse/OAK-3155</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;&lt;tt&gt;AsyncIndexStats&lt;/tt&gt; currently provides a time series of the stats around when async indexing run and what time it took. Current logic only collect stats when actual indexing is performed. If no change happened in the repository from the last run that stats around that is ignored.&lt;/p&gt;

&lt;p&gt;Due to this if we see a time series of when runs happen then it might not be true and gives a false impression that async indexing is slow. &lt;/p&gt;

&lt;p&gt;As a fix we should record execution stats for every run&lt;/p&gt;</description>
                <environment></environment>
        <key id="12849840">OAK-3155</key>
            <summary>AsyncIndex stats do not capture execution for runs where no indexing is performed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chetanm">Chetan Mehrotra</assignee>
                                    <reporter username="chetanm">Chetan Mehrotra</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Jul 2015 04:40:06 +0000</created>
                <updated>Wed, 2 Mar 2016 12:01:31 +0000</updated>
                            <resolved>Fri, 31 Jul 2015 06:57:55 +0000</resolved>
                                                    <fixVersion>1.0.18</fixVersion>
                    <fixVersion>1.2.4</fixVersion>
                    <fixVersion>1.3.4</fixVersion>
                    <fixVersion>1.4</fixVersion>
                                    <component>query</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14645485" author="chetanm" created="Wed, 29 Jul 2015 05:50:39 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12747720/12747720_OAK-3155.patch&quot; title=&quot;OAK-3155.patch attached to OAK-3155&quot;&gt;patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; for the same&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amitj_76&quot; class=&quot;user-hover&quot; rel=&quot;amitj_76&quot;&gt;amitj_76&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alexparvulescu&quot; class=&quot;user-hover&quot; rel=&quot;alexparvulescu&quot;&gt;alexparvulescu&lt;/a&gt; Can you review it. With this change the time series would reflect the true state&lt;/p&gt;</comment>
                            <comment id="14645741" author="alex.parvulescu" created="Wed, 29 Jul 2015 09:07:25 +0000"  >&lt;p&gt;looks good!&lt;/p&gt;

&lt;p&gt;the only issue I see is around the &apos;//Do not update the status as technically the run is not complete&apos; behavior. What will happen is the #start method will get called again on the next run, so the watch will reset making the intention to keep the stats running superfluous. I think we should call #postAsyncRunStatsStatus anyway, even if it&apos;s a failed run, I wouldn&apos;t mix error handling with stats.&lt;/p&gt;</comment>
                            <comment id="14645785" author="chetanm" created="Wed, 29 Jul 2015 09:34:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;What will happen is the #start method will get called again on the next run, so the watch will reset making the intention to keep the stats running superfluous.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That would still be fine. There are two stats we collect&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Execution count&lt;/li&gt;
	&lt;li&gt;Time taken for each execution&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;In case of missed checkpoint execution count would not get updated for that run and execution time would also be assumed to be zero. In next cycle when checkpoint can be obtained then execution count would be increased and time taken would only be for that run as watch is resent. So end stats are still correct. &lt;/p&gt;

&lt;p&gt;However if we increment the count even when checkpoint cannot be obtained then it gives a false impression that indexing is running fine i.e. no of executions per minute are high which is not the real case. Probably we should track checkpoint miss separately. Say count number of checkpoint for certain duration 1 min. If the count is more than 5 then log a warning/info message&lt;/p&gt;</comment>
                            <comment id="14646144" author="chetanm" created="Wed, 29 Jul 2015 14:47:16 +0000"  >&lt;p&gt;Linking to &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-3164&quot; title=&quot;MemoryNodeStore issues duplicate checkpoint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-3164&quot;&gt;&lt;del&gt;OAK-3164&lt;/del&gt;&lt;/a&gt; as testcase for this issue fails due to how checkpoints are managed within MemoryNodeStore&lt;/p&gt;</comment>
                            <comment id="14648842" author="chetanm" created="Fri, 31 Jul 2015 06:57:55 +0000"  >&lt;p&gt;Applied the patch along with test. Also merged to branches and this would help us in debugging slow asyn indexing scenario in a better way by giving accurate timeseries data&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;trunk - &lt;a href=&quot;http://svn.apache.org/r1693526&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1693526&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;1.0 - &lt;a href=&quot;http://svn.apache.org/r1693529&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1693529&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;1.2 - &lt;a href=&quot;http://svn.apache.org/r1693531&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1693531&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12849949">OAK-3164</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="12779013">OAK-2567</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12747720" name="OAK-3155.patch" size="4060" author="chetanm" created="Wed, 29 Jul 2015 05:50:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 16 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2i1zj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>