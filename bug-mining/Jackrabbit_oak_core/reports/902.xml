<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:44:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1855] Travis builds time out</title>
                <link>https://issues.apache.org/jira/browse/OAK-1855</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;Recently quite many travis builds failed because they hit the 50 minutes time limit.&lt;/p&gt;

&lt;p&gt;Possible solutions that come to my mind:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;reduce the time our tests take&lt;/li&gt;
	&lt;li&gt;split up the build with multiple profiles&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12716163">OAK-1855</key>
            <summary>Travis builds time out</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="edivad">Davide Giannella</assignee>
                                    <reporter username="mreutegg">Marcel Reutegger</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 May 2014 18:41:06 +0000</created>
                <updated>Wed, 22 Jul 2020 10:55:30 +0000</updated>
                            <resolved>Wed, 3 Sep 2014 08:42:49 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14008660" author="mduerig" created="Mon, 26 May 2014 08:17:15 +0000"  >&lt;p&gt;Another time saver might be to remove the &lt;tt&gt;MicroKernelImpl&lt;/tt&gt; fixture from the various tests. I don&apos;t think this adds much value any more. &lt;/p&gt;</comment>
                            <comment id="14074209" author="edivad" created="Fri, 25 Jul 2014 08:46:01 +0000"  >&lt;p&gt;I&apos;m not that expert in how to configure those stuff but I think we can&lt;br/&gt;
address this in two steps:&lt;/p&gt;

&lt;p&gt;First split the build with multiple profiles to avoid it failing. I&lt;br/&gt;
would say to have a profile for unit test (mvn clean install), one for&lt;br/&gt;
pedantic (-P pedantic) and one for the integration testing (-P&lt;br/&gt;
integrationTesting). They should all be there. Is it possible?&lt;/p&gt;

&lt;p&gt;The we can investigate the build itself drawing some stats from&lt;br/&gt;
previous build and address what can be addressed with individual&lt;br/&gt;
issues grouped by an epic.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="14077789" author="edivad" created="Tue, 29 Jul 2014 14:56:27 +0000"  >&lt;p&gt;managed to split the build by &lt;em&gt;pedantic&lt;/em&gt; and &lt;em&gt;integrationTesting&lt;/em&gt; in my &lt;a href=&quot;https://github.com/davidegiannella/jackrabbit-oak/tree/OAK-1855&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;sandbox branch&lt;/a&gt; and discovered that the build is taking always more than 30 minutes &lt;a href=&quot;https://travis-ci.org/davidegiannella/jackrabbit-oak/builds/31125814&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;even for the pedantic&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;That is pointing into the direction that some unit testing are taking a bit longer and maybe have to be moved to integration testing.&lt;/p&gt;

&lt;p&gt;Generated a list of those (&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12658417/12658417_OAK-1855-ut-times.txt&quot; title=&quot;OAK-1855-ut-times.txt attached to OAK-1855&quot;&gt;OAK-1855-ut-times.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;) with a command like&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;grep -A1 &apos;^Running &apos; log.txt | grep -v &apos;-&apos; | awk &apos;{ if ($1==&quot;Running&quot;) { test=$2 } else { if ($1==&quot;Tests&quot;) { print $12 &quot; &quot; test }}}&apos; | sort -nr &amp;gt; OAK-1855-ut-times.txt
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the top 10 UT are:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;116.932 org.apache.jackrabbit.oak.jcr.RepositoryTest
83.745 org.apache.jackrabbit.oak.plugins.index.solr.query.SolrIndexQueryTest
78.076 org.apache.jackrabbit.oak.jcr.observation.ObservationRefreshTest
73.123 org.apache.jackrabbit.oak.jcr.query.QueryJcrTest
68.798 org.apache.jackrabbit.oak.jcr.observation.ObservationTest
55.403 org.apache.jackrabbit.oak.plugins.document.BasicDocumentStoreTest
42.279 org.apache.jackrabbit.oak.jcr.query.QueryJcrTest
39.765 org.apache.jackrabbit.oak.security.authentication.ldap.LdapProviderTest
34.887 org.apache.jackrabbit.oak.jcr.random.RandomizedReadTest
32.668 org.apache.jackrabbit.oak.jcr.query.qom.QomTest
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;will investigate further into those for understanding if or what can be moved.&lt;/p&gt;</comment>
                            <comment id="14077814" author="mduerig" created="Tue, 29 Jul 2014 15:13:43 +0000"  >&lt;p&gt;We could also &quot;stripe&quot; the individual fixtures: Just running &lt;tt&gt;mvn clean install&lt;/tt&gt; it would run all unit tests against the segment node store. Running against different/additional fixtures could be achieved through environment variables/command line arguments. This way people working on the code could just run the tests against their favourite back end. On Travis we could schedule separate jobs for each of the fixtures. &lt;/p&gt;

&lt;p&gt;Only if this is not sufficient would I go on and partition the current tests into separate profiles. &lt;/p&gt;

&lt;p&gt;BTW: we have some initial pieces for this in place already. See &lt;tt&gt;AbstractRepositoryTest#FIXTURES&lt;/tt&gt; and for the TCK tests we would need to tweak &lt;tt&gt;TCKBase#TCKBase&lt;/tt&gt; in a similar way.&lt;/p&gt;</comment>
                            <comment id="14080849" author="edivad" created="Thu, 31 Jul 2014 13:25:55 +0000"  >&lt;p&gt;Managed to have the build running and completing in a decent time.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://travis-ci.org/davidegiannella/jackrabbit-oak/builds/31327009&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/davidegiannella/jackrabbit-oak/builds/31327009&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As it&apos;s a crucial part of our development I&apos;d ask to review what I did&lt;br/&gt;
before committing.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/davidegiannella/jackrabbit-oak/commit/51d4f3530352548a78eb229d76f6a2bcacb242cc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/davidegiannella/jackrabbit-oak/commit/51d4f3530352548a78eb229d76f6a2bcacb242cc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;In a nutshell&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Split the build into 4 different profiles: pedantic, unittesting, IT&lt;br/&gt;
over Segment and IT over all Documents.&lt;/p&gt;

&lt;p&gt;This is done by using the env variable &lt;tt&gt;ns-fixtures&lt;/tt&gt;. See &lt;a href=&quot;https://github.com/davidegiannella/jackrabbit-oak/commit/51d4f3530352548a78eb229d76f6a2bcacb242cc#diff-fed97835e439cc5cc599dad06d08092bR1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;FixturesHelper&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;When running locally &lt;tt&gt;mvn clean install&lt;/tt&gt; it will run the TCK and&lt;br/&gt;
AbstractRepository tests against Segment. It&apos;s easy to override in&lt;br/&gt;
case with&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mvn clean install -Dns-fixtures=DOCUMENT_NS
# you can leave it blank and will run against all fixtures
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;unittesting profiles runs against all fixtures.&lt;/p&gt;

&lt;p&gt;Disabled unit testing for the integration testing profiles and&lt;br/&gt;
pedantic ones.&lt;/p&gt;

&lt;p&gt;If needed it&apos;s possible to have tests fixture aware. See&lt;br/&gt;
&lt;tt&gt;AbstractRepositoryTest&lt;/tt&gt;, &lt;tt&gt;TCKBase&lt;/tt&gt; and&lt;br/&gt;
&lt;tt&gt;OrderedIndexConcurrentClusterIT&lt;/tt&gt; in the above commit for example.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;integrationTesting&lt;/tt&gt; profile now runs only on Segment and skip unit&lt;br/&gt;
testing. &lt;br/&gt;
&lt;b&gt;We probably have to change something either here or in the release process&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="14084427" author="mduerig" created="Mon, 4 Aug 2014 08:34:56 +0000"  >&lt;p&gt;I like the &lt;tt&gt;FixturesHelper&lt;/tt&gt; approach and the separation of integration and unit tests. I also think it is a good idea to only run against a default fixture (e.g. segment) for local builds and making this overrideable through the &lt;tt&gt;ns-fixtures&lt;/tt&gt; property. What confuses me is the proliferation of profiles. Do we need &lt;tt&gt;ITSegmentMK&lt;/tt&gt; and &lt;tt&gt;ITDocumentALL&lt;/tt&gt;? Both are mostly copies of the &lt;tt&gt;integrationTesting&lt;/tt&gt; profile. Can&apos;t we specify that property override directly to Travis? Also I&apos;m not clear about the &lt;tt&gt;pedantic&lt;/tt&gt; profile. What tests on what fixtures does this one run? &lt;/p&gt;</comment>
                            <comment id="14086276" author="edivad" created="Tue, 5 Aug 2014 13:43:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mduerig&quot; class=&quot;user-hover&quot; rel=&quot;mduerig&quot;&gt;mduerig&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The usage of multiple profiles moves the ownership of the build to&lt;br/&gt;
maven rather than to travis and gives clearer output on the travis&lt;br/&gt;
console (at least IMO). &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve changed again the build for having 1 integration testing profile&lt;br/&gt;
in&lt;br/&gt;
&lt;a href=&quot;https://github.com/davidegiannella/jackrabbit-oak/commit/b110680ebc4a99317c12e7c481272800a2ee618a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;OAK-1855-r3&lt;/a&gt;&lt;br/&gt;
and you can see the output of the related build at&lt;br/&gt;
&lt;a href=&quot;https://travis-ci.org/davidegiannella/jackrabbit-oak/builds/31710931&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://travis-ci.org/davidegiannella/jackrabbit-oak/builds/31710931&lt;/a&gt;&lt;br/&gt;
(currently building).&lt;/p&gt;

&lt;p&gt;&lt;b&gt;In a nutshell&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;pedantic&lt;/tt&gt; runs: rat, findbugs and checkstyle (as ever) but skip the&lt;br/&gt;
unit testing&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;unittesting&lt;/tt&gt; runs all the unit tests against all the available&lt;br/&gt;
fixtures&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;integrationTesting&lt;/tt&gt; by default runs all the unittests and&lt;br/&gt;
integration tests against Segment. Overridden in the build for&lt;br/&gt;
skipping the UT and splitting Segment from Document* fixtures. Should&lt;br/&gt;
be more easily integrated into the check-release.sh if needed for&lt;br/&gt;
testing at least against Segment.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;clean install&lt;/tt&gt; will run the unit testing against Segment only;&lt;br/&gt;
where tests are FixturesHelper compliant.&lt;/p&gt;
</comment>
                            <comment id="14090445" author="mduerig" created="Fri, 8 Aug 2014 07:52:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;ve changed again the build for having 1 integration testing profile&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I like this approach better. To me it is much clearer as the configuration that is only used for travis is right there in the &lt;tt&gt;.travis.yml&lt;/tt&gt; and takes up a single line instead of the almost 30 lines of a respective Maven profile. &lt;/p&gt;</comment>
                            <comment id="14119656" author="edivad" created="Wed, 3 Sep 2014 08:42:49 +0000"  >&lt;p&gt;Resolved in trunk @ &lt;a href=&quot;http://svn.apache.org/r1622182&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1622182&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14159848" author="amitjain" created="Mon, 6 Oct 2014 04:08:59 +0000"  >&lt;p&gt;Bulk close for 1.1.0&lt;/p&gt;</comment>
                            <comment id="17162708" author="reschke" created="Wed, 22 Jul 2020 10:55:30 +0000"  >&lt;p&gt;trunk: (1.1.0) &lt;a href=&quot;http://svn.apache.org/r1622182&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1622182&lt;/a&gt; &lt;a href=&quot;http://svn.apache.org/r1614296&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1614296&lt;/a&gt; &lt;a href=&quot;http://svn.apache.org/r1607046&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1607046&lt;/a&gt; &lt;a href=&quot;http://svn.apache.org/r1597598&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1597598&lt;/a&gt; &lt;a href=&quot;http://svn.apache.org/r1597586&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;r1597586&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12658417" name="OAK-1855-ut-times.txt" size="29959" author="edivad" created="Tue, 29 Jul 2014 14:56:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>394372</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 16 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1vwjj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>394511</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>