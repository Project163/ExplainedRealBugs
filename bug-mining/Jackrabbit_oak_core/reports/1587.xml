<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:51:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-5151] Overflown ChangeSets are not handled correctly in ChangeSetFilterImpl</title>
                <link>https://issues.apache.org/jira/browse/OAK-5151</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-5107&quot; title=&quot;Avoid NullPointerException in ChangeSetFilterImpl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-5107&quot;&gt;&lt;del&gt;OAK-5107&lt;/del&gt;&lt;/a&gt; there was a NPE reported which happened during prefiltering. Turns out that the &lt;tt&gt;null&lt;/tt&gt; there was not due to some bug but actually the &lt;em&gt;overflowing&lt;/em&gt; aspect of the ChangeSet: when there are too many items put into a ChangeSet (in the ChangeSetBuilder actually), then to avoid it consuming arbitrary large amounts of memory it has a mechanism that marks a particular set as &lt;em&gt;overflown&lt;/em&gt;. It does this by returning &lt;tt&gt;null&lt;/tt&gt; for that set.&lt;/p&gt;

&lt;p&gt;The ChangeSetFilterImpl stumbled over this very fact and the fix in &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-5107&quot; title=&quot;Avoid NullPointerException in ChangeSetFilterImpl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-5107&quot;&gt;&lt;del&gt;OAK-5107&lt;/del&gt;&lt;/a&gt; is actually wrong, as it treats null as an empty set, which results in wrong prefiltering.&lt;/p&gt;

&lt;p&gt;The actual fix is:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;either upon overflow to just include the change (simplest)&lt;/li&gt;
	&lt;li&gt;or only look at non-overflown sets of the ChangeSet&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;For simplicity reason the first choice is implemented at this stage. Perhaps later on we should improve this (created &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-5151&quot; title=&quot;Overflown ChangeSets are not handled correctly in ChangeSetFilterImpl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-5151&quot;&gt;&lt;del&gt;OAK-5151&lt;/del&gt;&lt;/a&gt; for this)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13022918">OAK-5151</key>
            <summary>Overflown ChangeSets are not handled correctly in ChangeSetFilterImpl</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefanegli">Stefan Egli</assignee>
                                    <reporter username="stefanegli">Stefan Egli</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Nov 2016 16:26:28 +0000</created>
                <updated>Mon, 30 Jan 2017 20:22:50 +0000</updated>
                            <resolved>Thu, 24 Nov 2016 08:43:18 +0000</resolved>
                                    <version>1.5.14</version>
                                    <fixVersion>1.5.15</fixVersion>
                    <fixVersion>1.6.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15690708" author="egli" created="Wed, 23 Nov 2016 16:58:30 +0000"  >&lt;p&gt;Fix done in &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1771006&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1771006&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Leaving open for now for adding a unit test for this.&lt;/p&gt;</comment>
                            <comment id="15692657" author="egli" created="Thu, 24 Nov 2016 08:43:18 +0000"  >&lt;p&gt;and test added in &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1771083&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1771083&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
resolving.&lt;/p&gt;</comment>
                            <comment id="15742078" author="edivad" created="Mon, 12 Dec 2016 14:36:11 +0000"  >&lt;p&gt;Bulk close for 1.5.15&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13022919">OAK-5152</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="13020593">OAK-5107</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 48 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36pdb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>