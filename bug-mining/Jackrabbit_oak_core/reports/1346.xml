<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:49:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-2635] TimeSeriesMax&apos;s frequent &apos;drops to 0&apos;</title>
                <link>https://issues.apache.org/jira/browse/OAK-2635</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;The current implementation of TimeSeriesMax - which is what is backing eg the very important &apos;ObservationQueueMaxLength&apos; statistics - has a very infamous behavior: it does very frequent, intermittent &apos;jumps back to 0&apos;. This even though the queue-lengths are still at the previous highs, as can often be seen with subsequent measurements (which eg are still showing there are 1000 events in the observation queue).&lt;/p&gt;

&lt;p&gt;The reason seems to be that&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the value is increased via &lt;tt&gt;TimeSeriesMax.recordValue()&lt;/tt&gt; during a 1 second interval&lt;/li&gt;
	&lt;li&gt;reset to 0 via &lt;tt&gt;TimeSeriesMax&amp;lt;init&amp;gt;.run()&lt;/tt&gt; every second&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So basically, every second the counter is reset, then during 1 second if any call to &lt;tt&gt;recordValue()&lt;/tt&gt; happens, it is increased.&lt;/p&gt;

&lt;p&gt;This in my view is rather unfortunate - as it can result in mentioned &apos;jumpy-0&apos; behavior, but it can also jump to values in between if the largest queue does not reports its length during 1 second.&lt;/p&gt;

&lt;p&gt;It sounds a bit like this was done this way intentionally? (perhaps to make it as inexpensive as possible) or could this be fixed?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12782216">OAK-2635</key>
            <summary>TimeSeriesMax&apos;s frequent &apos;drops to 0&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="stefanegli">Stefan Egli</reporter>
                        <labels>
                            <label>observation</label>
                            <label>tooling</label>
                    </labels>
                <created>Mon, 16 Mar 2015 14:53:21 +0000</created>
                <updated>Thu, 26 Sep 2019 11:43:52 +0000</updated>
                            <resolved>Tue, 6 Oct 2015 09:42:21 +0000</resolved>
                                    <version>1.0.12</version>
                                    <fixVersion>1.3.8</fixVersion>
                    <fixVersion>1.4</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14363491" author="mduerig" created="Mon, 16 Mar 2015 17:03:41 +0000"  >&lt;p&gt;AFAICS &lt;tt&gt;TimeSeriesAverage&lt;/tt&gt; has the same problem. In the end this is cause by missing values, so I think we should add a way to expose such. &lt;/p&gt;</comment>
                            <comment id="14370158" author="mduerig" created="Thu, 19 Mar 2015 21:30:56 +0000"  >&lt;p&gt;Moving to 1.3 as &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-3860&quot; title=&quot;Properly expose missing values in TimeSeries implementations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JCR-3860&quot;&gt;&lt;del&gt;JCR-3860&lt;/del&gt;&lt;/a&gt;, which this issue depends upon has been moved to Jackrabbit 2.11&lt;/p&gt;</comment>
                            <comment id="14941164" author="mduerig" created="Fri, 2 Oct 2015 14:00:51 +0000"  >&lt;p&gt;Need fix from &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-3860&quot; title=&quot;Properly expose missing values in TimeSeries implementations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JCR-3860&quot;&gt;&lt;del&gt;JCR-3860&lt;/del&gt;&lt;/a&gt; to proceed here&lt;/p&gt;</comment>
                            <comment id="14941182" author="mduerig" created="Fri, 2 Oct 2015 14:15:14 +0000"  >&lt;p&gt;Proposed patch using -1 to encode missing values of observation queue length. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stefanegli&quot; class=&quot;user-hover&quot; rel=&quot;stefanegli&quot;&gt;stefanegli&lt;/a&gt;, please have a look.&lt;/p&gt;</comment>
                            <comment id="14943059" author="egli" created="Mon, 5 Oct 2015 08:25:38 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14944798" author="mduerig" created="Tue, 6 Oct 2015 09:42:21 +0000"  >&lt;p&gt;Fixed at &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1706968&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1706968&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14958639" author="edivad" created="Thu, 15 Oct 2015 10:11:21 +0000"  >&lt;p&gt;Bulk close for 1.3.8&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12896355">OAK-3448</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12782274">JCR-3860</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12764771" name="OAK_2635.patch" size="1637" author="mduerig" created="Fri, 2 Oct 2015 14:15:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 5 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i26t53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>