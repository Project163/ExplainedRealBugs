<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:44:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1874] Indexes: re-index automatically when adding an index</title>
                <link>https://issues.apache.org/jira/browse/OAK-1874</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;When adding an index via import of content, the index is not automatically re-built. This is problematic, because subsequent queries will return no data because of that. Currently, the only way to re-index is to set the &quot;reindex&quot; property to &quot;true&quot;.&lt;/p&gt;

&lt;p&gt;I suggest that indexes are automatically re-indexes if the hidden child node (&quot;:data&quot; I believe) is missing. This is in addition to the &quot;reindex&quot; property.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12718568">OAK-1874</key>
            <summary>Indexes: re-index automatically when adding an index</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stillalex">Alex Deparvu</assignee>
                                    <reporter username="thomasm">Thomas Mueller</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Jun 2014 08:40:43 +0000</created>
                <updated>Tue, 25 Jul 2017 07:50:41 +0000</updated>
                            <resolved>Wed, 11 Jun 2014 15:03:48 +0000</resolved>
                                                    <fixVersion>1.0.1</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                    <component>query</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14018704" author="mmarth" created="Thu, 5 Jun 2014 11:45:04 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I suggest that indexes are automatically re-indexes if the hidden child node (&quot;:data&quot; I believe) is missing. This is in addition to the &quot;reindex&quot; property. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That would work.&lt;/p&gt;

&lt;p&gt;Maybe an alternative approach: if an index definition node is added I would expect this to trigger a re-index in any case (so not rely on the hidden child node, but trigger the re-index whenever an index definition is created)&lt;/p&gt;</comment>
                            <comment id="14026318" author="alex.parvulescu" created="Tue, 10 Jun 2014 10:53:23 +0000"  >&lt;p&gt;attaching proposed patch based on the idea that new definitions will be automatically marked for reindexing.&lt;/p&gt;</comment>
                            <comment id="14026375" author="mmarth" created="Tue, 10 Jun 2014 12:08:17 +0000"  >&lt;p&gt;added 1.0.1 fixVersion&lt;/p&gt;</comment>
                            <comment id="14027824" author="tmueller" created="Wed, 11 Jun 2014 14:40:16 +0000"  >&lt;p&gt;I&apos;m not sure about the fix, I would have expected something like this (not tested):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+    private boolean shouldReindex(NodeBuilder definition, NodeState before,
+            String name) {
+        PropertyState ps = definition.getProperty(REINDEX_PROPERTY_NAME);
+        if (ps != null &amp;amp;&amp;amp; ps.getValue(BOOLEAN)) {
+            return true;
+        }
+        // in the case this is a new node, reindex in every case
+        // (don&apos;t trust the reindex property in this case)
+        return !before.getChildNode(INDEX_DEFINITIONS_NAME).hasChildNode(name);
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Reason: if index definitions are exported and re-imported, the imported node has the reindex property explicitly set to &quot;false&quot;. So basically, this property can&apos;t be always trusted.&lt;/p&gt;

&lt;p&gt;Does it make sense?&lt;/p&gt;

&lt;p&gt;The  test would need to be modified as well.&lt;/p&gt;</comment>
                            <comment id="14027843" author="alex.parvulescu" created="Wed, 11 Jun 2014 15:00:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;if index definitions are exported and re-imported, the imported node has the reindex property explicitly set to &quot;false&quot;. So basically, this property can&apos;t be always trusted.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Makes perfect sense, I&apos;ve changed the code and the test to follow this advice.&lt;/p&gt;</comment>
                            <comment id="14027844" author="alex.parvulescu" created="Wed, 11 Jun 2014 15:03:48 +0000"  >&lt;p&gt;Thanks Thomas for the feedback!&lt;/p&gt;

&lt;p&gt;Fixed on trunk with &lt;a href=&quot;http://svn.apache.org/r1601922&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1601922&lt;/a&gt;&lt;br/&gt;
and on 1.0 with &lt;a href=&quot;http://svn.apache.org/r1601923&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1601923&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13089779">OAK-6487</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12649562" name="OAK-1874.patch" size="5025" author="stillalex" created="Tue, 10 Jun 2014 10:53:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396767</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 23 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1wb4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396886</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>