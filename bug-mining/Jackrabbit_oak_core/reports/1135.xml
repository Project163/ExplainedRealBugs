<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:47:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-2449] offline compaction (via oak-run) broken</title>
                <link>https://issues.apache.org/jira/browse/OAK-2449</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;This is a likely regression introduced with &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2192&quot; title=&quot;Concurrent commit during compaction results in mixed segments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2192&quot;&gt;&lt;del&gt;OAK-2192&lt;/del&gt;&lt;/a&gt;: when doing offline compaction via oak-run with a current oak trunk, the compaction never finishes - instead it creates tar file after tar file - basically filling up the disk if you dont stop it.&lt;/p&gt;

&lt;p&gt;It looks like oak-run&apos;s Main.compact() does not set the newly (in &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2192&quot; title=&quot;Concurrent commit during compaction results in mixed segments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2192&quot;&gt;&lt;del&gt;OAK-2192&lt;/del&gt;&lt;/a&gt;) added compactionStrategy - instead, compactionStrategy is set to NO_COMPACTION - which returns false when being asked if compaction is finished (compacted()) - which is why it just loops - and in each loop add a bit to the store.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12770321">OAK-2449</key>
            <summary>offline compaction (via oak-run) broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stillalex">Alex Deparvu</assignee>
                                    <reporter username="stefanegli">Stefan Egli</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Jan 2015 11:16:26 +0000</created>
                <updated>Thu, 26 Sep 2019 11:40:36 +0000</updated>
                            <resolved>Mon, 2 Feb 2015 13:07:38 +0000</resolved>
                                    <version>1.1.5</version>
                                    <fixVersion>1.0.12</fixVersion>
                    <fixVersion>1.1.6</fixVersion>
                                    <component>run</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14293373" author="egli" created="Tue, 27 Jan 2015 11:18:03 +0000"  >&lt;p&gt;Attached a suggestion for how to fix this: by setting compactionStrategy (with defaults) in oak-run&apos;s Main.compact()&lt;/p&gt;</comment>
                            <comment id="14293389" author="alex.parvulescu" created="Tue, 27 Jan 2015 11:38:45 +0000"  >&lt;p&gt;good catch!&lt;/p&gt;

&lt;p&gt;I would not use &lt;em&gt;CompactionStrategy.CLEANUP_DEFAULT&lt;/em&gt;, instead offline compaction should be as aggressive as possible, so I would put &lt;em&gt;CleanupType.CLEAN_ALL&lt;/em&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mduerig&quot; class=&quot;user-hover&quot; rel=&quot;mduerig&quot;&gt;mduerig&lt;/a&gt; thoughts?&lt;/p&gt;</comment>
                            <comment id="14296856" author="mduerig" created="Thu, 29 Jan 2015 13:53:12 +0000"  >&lt;p&gt;Yes this should definitely be &lt;tt&gt;CleanupType.CLEAN_ALL&lt;/tt&gt; for the offline case. Old segments only mean something in the online case.&lt;/p&gt;</comment>
                            <comment id="14301110" author="alex.parvulescu" created="Mon, 2 Feb 2015 10:14:24 +0000"  >&lt;p&gt;attaching a slightly improved version of the patch. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mduerig&quot; class=&quot;user-hover&quot; rel=&quot;mduerig&quot;&gt;mduerig&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stefanegli&quot; class=&quot;user-hover&quot; rel=&quot;stefanegli&quot;&gt;stefanegli&lt;/a&gt; feedback?&lt;/p&gt;</comment>
                            <comment id="14301118" author="egli" created="Mon, 2 Feb 2015 10:25:55 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14301214" author="mduerig" created="Mon, 2 Feb 2015 12:39:00 +0000"  >&lt;p&gt;Looks good to me.&lt;/p&gt;</comment>
                            <comment id="14301246" author="alex.parvulescu" created="Mon, 2 Feb 2015 13:07:38 +0000"  >&lt;p&gt;thanks for the feedback!&lt;br/&gt;
fixed with &lt;a href=&quot;http://svn.apache.org/r1656453&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1656453&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14311997" author="edivad" created="Mon, 9 Feb 2015 09:43:10 +0000"  >&lt;p&gt;Bulk close for 1.1.6&lt;/p&gt;</comment>
                            <comment id="14315791" author="alex.parvulescu" created="Wed, 11 Feb 2015 08:40:20 +0000"  >&lt;p&gt;merged to 1.0 with rev 1658896.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12748055">OAK-2192</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12695900" name="OAK-2449.patch" size="3280" author="stillalex" created="Mon, 2 Feb 2015 10:14:24 +0000"/>
                            <attachment id="12694768" name="compaction.patch" size="2175" author="stefanegli" created="Tue, 27 Jan 2015 11:18:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 40 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24u5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>