<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:42:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1417] Processing pending observation events does not scale linearly with the number of events</title>
                <link>https://issues.apache.org/jira/browse/OAK-1417</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;&lt;tt&gt;org.apache.jackrabbit.oak.jcr.LargeOperationIT#largeNumberOfPendingEvents&lt;/tt&gt; does not scale linearly. Neither on a segment nor on a document node store. This test asserts that the number of pending observation events (e.g. due to  a large commit or cluster sync) has a linear processing time. That is the time it takes to process one such event is independent of the total number of events.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;seg quotients: 0.24215928530697586, 0.4065934065934066, 1.7548262548262548, 0.6892189218921893, 1.2083000798084598
doc quotients: 0.2990824434780629, 0.14113885505481122, 0.587378640776699, 1.3122130394857667, 142.65850244926523
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;While in the case of the segment node store the numbers do not seem too worrisome, the document node store seems to start lagging behind badly as soon as there are more than 32768 pending events. &lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1413&quot; title=&quot;Add scalability tests for large operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1413&quot;&gt;&lt;del&gt;OAK-1413&lt;/del&gt;&lt;/a&gt; for how to read those numbers. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12694529">OAK-1417</key>
            <summary>Processing pending observation events does not scale linearly with the number of events</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="mduerig">Michael D&#252;rig</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Feb 2014 16:49:26 +0000</created>
                <updated>Thu, 27 Feb 2014 09:28:52 +0000</updated>
                            <resolved>Tue, 18 Feb 2014 11:59:08 +0000</resolved>
                                                    <fixVersion>0.17</fixVersion>
                                    <component>mongomk</component>
                    <component>segmentmk</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13898394" author="jukkaz" created="Tue, 11 Feb 2014 22:18:08 +0000"  >&lt;p&gt;Are we sure that this should really scale linearly? For example the more content you have, the deeper the content tree is, which adds a tiny amount of extra cost to the access of each leaf node. Like in &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1416&quot; title=&quot;Adding many siblings does not scale as expected in the number of added nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1416&quot;&gt;&lt;del&gt;OAK-1416&lt;/del&gt;&lt;/a&gt;, a performance goal of &lt;tt&gt;O&amp;#40;n log n)&lt;/tt&gt; would seem more realistic.&lt;/p&gt;</comment>
                            <comment id="13898440" author="jukkaz" created="Tue, 11 Feb 2014 22:48:04 +0000"  >&lt;p&gt;The &lt;tt&gt;O&amp;#40;n log n)&lt;/tt&gt; assumption indeed seems to be the case here. The &lt;tt&gt;Event.getPath()&lt;/tt&gt; call in the test case is proportional to path length, which in the test setup grows as a logarithm of the total number of nodes. With &lt;tt&gt;n&lt;/tt&gt; &lt;tt&gt;getPath()&lt;/tt&gt; calls, the combined time becomes &lt;tt&gt;O&amp;#40;n log n)&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;The attached patch shortcuts the path mapping to a no-op for this test scenario where there are no local namespace remappings. This brings the observed performance scaling closer to &lt;tt&gt;O&amp;#40;n)&lt;/tt&gt; for the SegmentMK.&lt;/p&gt;</comment>
                            <comment id="13899020" author="jukkaz" created="Wed, 12 Feb 2014 11:34:47 +0000"  >&lt;p&gt;Committed the patch in revision 1567588. The result is still not strictly linear as some smaller &lt;tt&gt;log n&lt;/tt&gt; components remain in each iteration, but they don&apos;t show up as prominently as the path mapping overhead.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;seg quotients: 0.09921634480828435, 0.9760225669957687, 1.0809248554913296, 0.8141711229946524, 1.1707717569786535
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13899149" author="mduerig" created="Wed, 12 Feb 2014 14:42:24 +0000"  >&lt;p&gt;Also with my &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1413?focusedCommentId=13899140&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13899140&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;latest changes &lt;/a&gt; this test still fails. Although by very little with the segment node store:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;quotients: 0.1736829444310801, 0.4644506001846722, 1.1520874751491055, 0.822260569456428,  1.3189926547743966, 1.7104216388225935, 0.987906976744186,  0.7984934086629002, 0.8266509433962265, 0.8787446504992867
    bound: 1.4321928094887362, 1.3929025540806694, 1.360160674573947,  1.3324560072990281, 1.3087091496348118, 1.2881285396591575, 1.2701205059304603, 1.2542310644051389, 1.2401071163826312, 1.2274698997309137
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here the first line are the quotients as described in &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1413&quot; title=&quot;Add scalability tests for large operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1413&quot;&gt;&lt;del&gt;OAK-1413&lt;/del&gt;&lt;/a&gt;. The second line is the upper bound for these quotients.&lt;/p&gt;

&lt;p&gt;The respective value for the document node store: &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;quotients: 2.1008669201520913, 0.19547968609735616, 0.1288793422709429, 0.44655172413793104, 4.732303732303732, 0.20288278487897743, 0.9289544235924933, 0.6608946608946609, 80.51310043668123,  12.080081355932203
    bound: 1.4321928094887362, 1.3929025540806694,  1.360160674573947,  1.3324560072990281,  1.3087091496348118, 1.2881285396591575, 1.2701205059304603, 1.2542310644051389, 1.2401071163826312, 1.2274698997309137
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;These values look good generally. Except the last two values which exceed their bounds by quite some factors (12 and 80!).&lt;/p&gt;</comment>
                            <comment id="13903985" author="mduerig" created="Tue, 18 Feb 2014 11:59:08 +0000"  >&lt;p&gt;This is fixed after introducing the &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1413?focusedCommentId=13903948&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13903948&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;more stable test method &lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="13914285" author="alex.parvulescu" created="Thu, 27 Feb 2014 09:28:52 +0000"  >&lt;p&gt;bulk close for the 0.17.1 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12628355" name="0001-OAK-1417-Processing-pending-observation-events-does-.patch" size="1954" author="jukkaz" created="Tue, 11 Feb 2014 22:48:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>373037</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 38 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1sabz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>373339</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>