<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:46:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-2359] read is inefficient when there are many split documents</title>
                <link>https://issues.apache.org/jira/browse/OAK-2359</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;As reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2358&quot; title=&quot;revisionGC leaves garbage around, for often-changed nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2358&quot;&gt;&lt;del&gt;OAK-2358&lt;/del&gt;&lt;/a&gt; there is a potential problem with revisionGC not cleaning up split documents properly (in 1.0.8.r1644758 at least). &lt;/p&gt;

&lt;p&gt;As a side-effect, having many garbage-revisions renders the diffImpl algorithm to become very slow - normally it would take only a few millis, but with nodes that have many split-documents I can see diffImpl take hundres of millis, sometimes up to a few seconds. Which causes the observation dequeuing to be slower than the rate in which observation events are enqueued, which results in observation queue never being cleaned up and event handling being delayed more and more.&lt;/p&gt;

&lt;p&gt;Adding some logging showed that diffImpl would often read many split-documents, which supports the assumption that the revisionGC not cleaning up revisions has the diffImpl-slowness as a side-effect. Having said that - diffImpl should probably still be able to run fast, since all the revisions it should look at should be in the main document, not in split documents.&lt;/p&gt;

&lt;p&gt;I dont have a test case handy for this at the moment unfortunately - if more is coming up, I&apos;ll add more details here.&lt;/p&gt;</description>
                <environment>&lt;p&gt;1.0.8.r1644758&lt;/p&gt;</environment>
        <key id="12761870">OAK-2359</key>
            <summary>read is inefficient when there are many split documents</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mreutegg">Marcel Reutegger</assignee>
                                    <reporter username="stefanegli">Stefan Egli</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Dec 2014 21:42:57 +0000</created>
                <updated>Tue, 13 Jan 2015 08:14:22 +0000</updated>
                            <resolved>Tue, 6 Jan 2015 08:43:08 +0000</resolved>
                                    <version>1.0.8</version>
                                    <fixVersion>1.0.10</fixVersion>
                    <fixVersion>1.1.4</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14247436" author="egli" created="Mon, 15 Dec 2014 23:42:51 +0000"  >&lt;p&gt;Attaching some suggestions as to what additional log.debug could help debug situations like these in the product in the future. Not saying that this patch is very elaborate, just added a few lines to narrow down the issue and having this in oak directly would be preferable.&lt;br/&gt;
Re EventGenerator : not so sure about the usefulness of the individual log.debug in childNodeAdded etc - but the profiling output of generate() has helped somewhat.. but something like this could surely be generalized further and applied at various suspicious places in oak I guess..&lt;/p&gt;</comment>
                            <comment id="14264552" author="mreutegg" created="Mon, 5 Jan 2015 12:46:33 +0000"  >&lt;p&gt;One of the cases I analyzed, showed a frequently modified node with a property, which was deleted a long time ago. This resulted in a traversal of many split documents even though the information about the removed property was actually in the main document.&lt;/p&gt;

&lt;p&gt;I will create a test to reproduce this behaviour.&lt;/p&gt;</comment>
                            <comment id="14265856" author="mreutegg" created="Tue, 6 Jan 2015 08:43:08 +0000"  >&lt;p&gt;Fixed in trunk &lt;a href=&quot;http://svn.apache.org/r1649743&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1649743&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and merged into 1.0 branch &lt;a href=&quot;http://svn.apache.org/r1649751&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1649751&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14274874" author="edivad" created="Tue, 13 Jan 2015 08:14:22 +0000"  >&lt;p&gt;Bulk close for 1.1.4&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12761866">OAK-2358</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12762213">OAK-2361</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12687333" name="oak2359patch.diff" size="7090" author="stefanegli" created="Mon, 15 Dec 2014 23:42:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 44 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i23gf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>