<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:40:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1171] Query fails unexpectedly when property conversion is not possible</title>
                <link>https://issues.apache.org/jira/browse/OAK-1171</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;A simple xpath query for a string property doesn&apos;t work when there is a long (or other inconvertible) property under the same name anywhere in the repository.&lt;/p&gt;

&lt;p&gt;To reproduce:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Create a &lt;tt&gt;LONG&lt;/tt&gt; property: &lt;tt&gt;/test/@property = 1&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Run this query: &lt;tt&gt;//*[property = &quot;foo&quot;]&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This will throw a NumberFormatException at &lt;tt&gt;o.a.j.o.plugins.value.Conversions$Converter.toLong(Conversions.java:80)&lt;/tt&gt; and fail the query.&lt;/p&gt;

&lt;p&gt;Jackrabbit 2 works well here and simply does not include a match for that node in the result. While I can see that Oak seems to implement the &lt;a href=&quot;http://www.day.com/specs/jcr/2.0/6_Query.html#6.7.16%20Comparison&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JCR 2.0 spec&lt;/a&gt; here:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;If operand1 and operand2 evaluate to values of different property types, the value of operand2 is converted to the property type of the value of operand1 as described in &#167;3.6.4 Property Type Conversion. If the type conversion fails, the query is &lt;em&gt;invalid&lt;/em&gt;.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;... I don&apos;t think this makes any sense. If conversion does not work, this is simply not a match, but it must not break the query.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12678932">OAK-1171</key>
            <summary>Query fails unexpectedly when property conversion is not possible</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stillalex">Alex Deparvu</assignee>
                                    <reporter username="alexander.klimetschek">Alexander Klimetschek</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Nov 2013 03:44:18 +0000</created>
                <updated>Thu, 21 Nov 2013 10:30:57 +0000</updated>
                            <resolved>Wed, 13 Nov 2013 15:35:29 +0000</resolved>
                                                    <fixVersion>0.11</fixVersion>
                                    <component>jcr</component>
                    <component>query</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13820899" author="alexander.klimetschek" created="Wed, 13 Nov 2013 03:45:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1076&quot; title=&quot;XPath failures for typed properties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1076&quot;&gt;&lt;del&gt;OAK-1076&lt;/del&gt;&lt;/a&gt; might be related. It refers to range queries, not the equality operator, but the issue might be the same.&lt;/p&gt;</comment>
                            <comment id="13820905" author="alexander.klimetschek" created="Wed, 13 Nov 2013 04:00:23 +0000"  >&lt;p&gt;The simplest solution might be to catch that exception somewhere inside &lt;tt&gt;AstElement#convertValueToType&lt;/tt&gt; or &lt;tt&gt;ComparisonImpl#evaluate&lt;/tt&gt;, AFAICS.&lt;/p&gt;</comment>
                            <comment id="13821427" author="alex.parvulescu" created="Wed, 13 Nov 2013 15:35:29 +0000"  >&lt;p&gt;fixed with rev &lt;a href=&quot;http://svn.apache.org/r1541517&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1541517&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13828802" author="alex.parvulescu" created="Thu, 21 Nov 2013 10:30:57 +0000"  >&lt;p&gt;bulk close for the 0.11 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12672127">OAK-1076</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>358298</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1prl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>358588</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>