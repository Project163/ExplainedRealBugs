<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:44:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1816] Oak#createContentRepository never unregisters some of its services</title>
                <link>https://issues.apache.org/jira/browse/OAK-1816</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;&lt;tt&gt;Oak#createContentRepository&lt;/tt&gt; registers a bunch of services with the &lt;tt&gt;Whiteboard&lt;/tt&gt; (MBeans, Executor, Observer) that are never unregistered. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12713890">OAK-1816</key>
            <summary>Oak#createContentRepository never unregisters some of its services</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chetanm">Chetan Mehrotra</assignee>
                                    <reporter username="mduerig">Michael D&#252;rig</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 May 2014 12:51:54 +0000</created>
                <updated>Wed, 1 Oct 2014 13:09:55 +0000</updated>
                            <resolved>Wed, 25 Jun 2014 15:24:52 +0000</resolved>
                                                    <fixVersion>1.0.3</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13996340" author="mduerig" created="Tue, 13 May 2014 12:58:05 +0000"  >&lt;p&gt;The simplest solution would be to have &lt;tt&gt;ContentRepositoryImpl&lt;/tt&gt; implement &lt;tt&gt;Closeable&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Another solution would be to have the respective &lt;tt&gt;Oak&lt;/tt&gt; instance keep track of the registrations and require the caller of &lt;tt&gt;createContentRepository&lt;/tt&gt; to release them once done. &lt;/p&gt;</comment>
                            <comment id="13998562" author="chetanm" created="Thu, 15 May 2014 08:02:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;The simplest solution would be to have ContentRepositoryImpl implement Closeable&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1 if we cannot add explicit close method to &lt;tt&gt;ContentRepository&lt;/tt&gt; interface now.&lt;/p&gt;</comment>
                            <comment id="14041943" author="chetanm" created="Tue, 24 Jun 2014 10:19:08 +0000"  >&lt;p&gt;Patch which takes the first approach by making ContentRepositoryImpl implements Closeable. However now the calling code has to check if the returned contentRepository is closeable and close it then upon shutdown.&lt;/p&gt;

&lt;p&gt;The fix also resolves &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1485&quot; title=&quot;AsyncIndexUpdate unable to cope with restarts in an OSGi environment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1485&quot;&gt;&lt;del&gt;OAK-1485&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Or we can make Oak instance statefull and have a lifecycle handling there&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jukkaz&quot; class=&quot;user-hover&quot; rel=&quot;jukkaz&quot;&gt;jukkaz&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mduerig&quot; class=&quot;user-hover&quot; rel=&quot;mduerig&quot;&gt;mduerig&lt;/a&gt; Kindly review&lt;/p&gt;</comment>
                            <comment id="14042012" author="mduerig" created="Tue, 24 Jun 2014 11:53:58 +0000"  >&lt;p&gt;I generally share Jukka&apos;s view that the creator of a resource should also take care of properly shutting it down. I.e. there is no need for implementing and instance testing for &lt;tt&gt;Closeable&lt;/tt&gt;. However I this case I don&apos;t see an easy way to follow this approach. So +1 unless Jukka, has another idea.&lt;/p&gt;

&lt;p&gt;Re. the implementation maybe &lt;tt&gt;CompositeRegistration&lt;/tt&gt; might simplify things a bit?&lt;/p&gt;</comment>
                            <comment id="14043554" author="jukkaz" created="Wed, 25 Jun 2014 14:44:36 +0000"  >&lt;p&gt;+0.5 on the patch.&lt;/p&gt;

&lt;p&gt;I think fundamentally the Oak class is growing beyond it&apos;s original design here, and instead of adding features like this we might be better served by not trying to extend it any further. As seen here, a complex deployment with lots of moving pieces will need more explicit lifecycle management than what the Oak class provides. For example in an OSGi environment it might make more sense to just &lt;b&gt;avoid&lt;/b&gt; using the Oak class and instead directly instantiate and manage the various required components using the existing lifecycle management functionality already provided by OSGi.&lt;/p&gt;</comment>
                            <comment id="14043614" author="chetanm" created="Wed, 25 Jun 2014 15:24:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think fundamentally the Oak class is growing beyond it&apos;s original design here&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes it was meant to be a simple builder. For now I would commit the patch and later we can see how to refactor all that logic in createContentRepository. &lt;/p&gt;</comment>
                            <comment id="14043616" author="chetanm" created="Wed, 25 Jun 2014 15:24:52 +0000"  >&lt;p&gt;Applied a slightly modified patch which makes use of CompositeReference in &lt;a href=&quot;http://svn.apache.org/r1605447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1605447&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14068406" author="chetanm" created="Mon, 21 Jul 2014 11:08:16 +0000"  >&lt;p&gt;Merged to 1.0 branch in &lt;a href=&quot;http://svn.apache.org/r1612244&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1612244&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12652175" name="OAK-1816.patch" size="5320" author="chetanm" created="Tue, 24 Jun 2014 10:19:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>392203</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 17 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1vjkn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>392396</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>