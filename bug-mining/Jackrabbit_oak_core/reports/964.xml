<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:45:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1973] IndexUpdate traverses the data nodes under index nodes</title>
                <link>https://issues.apache.org/jira/browse/OAK-1973</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;AsyncIndexUpdate uses IndexUpdate class as Editor and passes it to EditorDiff. IndexUpdate insternally wraps all the IndexEditors with VisibileEditor such that they do not traverse the invisible nodes (like :data). However IndexUpdate itself is not wrapped with VisibileEditor due to which it has to traverse all the Index data also for diff.&lt;/p&gt;

&lt;p&gt;Ideally IndexUpdate itself should be wrapped with VisibileEditor&lt;/p&gt;</description>
                <environment></environment>
        <key id="12727652">OAK-1973</key>
            <summary>IndexUpdate traverses the data nodes under index nodes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chetanm">Chetan Mehrotra</assignee>
                                    <reporter username="chetanm">Chetan Mehrotra</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Jul 2014 13:18:35 +0000</created>
                <updated>Wed, 1 Oct 2014 13:09:57 +0000</updated>
                            <resolved>Fri, 18 Jul 2014 10:55:40 +0000</resolved>
                                                    <fixVersion>1.0.3</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14063464" author="chetanm" created="Wed, 16 Jul 2014 13:20:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jukkaz&quot; class=&quot;user-hover&quot; rel=&quot;jukkaz&quot;&gt;jukkaz&lt;/a&gt; Should IndexUpdate be wrapped with VisibleEditor?&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;             IndexUpdate indexUpdate =
                     new IndexUpdate(provider, name, after, builder, callback);
             CommitFailedException exception =
-                    EditorDiff.process(indexUpdate, before, after);
+                    EditorDiff.process(VisibleEditor.wrap(indexUpdate), before, after);
             if (exception != null) {
                 throw exception;
             }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14063642" author="jukkaz" created="Wed, 16 Jul 2014 15:56:54 +0000"  >&lt;p&gt;Yes, good point! When applying the change, we can also drop the VisibleEditor wrapping of IndexEditors, as the higher-level wrapping already takes care of excluding hidden content from the diff.&lt;/p&gt;</comment>
                            <comment id="14063670" author="chetanm" created="Wed, 16 Jul 2014 16:15:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;When applying the change, we can also drop the VisibleEditor wrapping of IndexEditors&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I thought about that but then saw that IndexUpdate is being used in other places also so probably that is required. Right?&lt;/p&gt;</comment>
                            <comment id="14063677" author="jukkaz" created="Wed, 16 Jul 2014 16:19:30 +0000"  >&lt;p&gt;We should probably add the &lt;tt&gt;VisibleEditor&lt;/tt&gt; wrapping also to the other places where &lt;tt&gt;IndexUpdate&lt;/tt&gt; is being used.&lt;/p&gt;</comment>
                            <comment id="14065058" author="chetanm" created="Thu, 17 Jul 2014 16:09:04 +0000"  >&lt;p&gt;Patch for the same&lt;br/&gt;
&amp;#8211; Wraps the IndexUpdate with VisibleEditor where used (except Upgrade)&lt;br/&gt;
&amp;#8211; Removed internal wrapping of editors as the IndexUpdate itself is wrapped&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jukkaz&quot; class=&quot;user-hover&quot; rel=&quot;jukkaz&quot;&gt;jukkaz&lt;/a&gt; Can you have a look?&lt;/p&gt;</comment>
                            <comment id="14065082" author="jukkaz" created="Thu, 17 Jul 2014 16:32:59 +0000"  >&lt;p&gt;+1 looks good&lt;/p&gt;</comment>
                            <comment id="14066268" author="chetanm" created="Fri, 18 Jul 2014 10:55:40 +0000"  >&lt;p&gt;Applied the patch in &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;trunk - &lt;a href=&quot;http://svn.apache.org/r1611584&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1611584&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;1.0 - &lt;a href=&quot;http://svn.apache.org/r1611585&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1611585&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14076169" author="alex.parvulescu" created="Mon, 28 Jul 2014 12:11:10 +0000"  >&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc/jackrabbit/oak/branches/1.0/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/commit/VisibleEditor.java?r1=1611585&amp;amp;r2=1611584&amp;amp;pathrev=1611585&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/jackrabbit/oak/branches/1.0/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/commit/VisibleEditor.java?r1=1611585&amp;amp;r2=1611584&amp;amp;pathrev=1611585&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (editor != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !(editor &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; VisibleEditor)) {
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; VisibleEditor(editor);
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;shouldn&apos;t this be &lt;em&gt;return editor&lt;/em&gt; instead? It looks like if you wrap a VisibleEditor you get a null, but a better option would be to simply return the original one.&lt;/p&gt;</comment>
                            <comment id="14077455" author="chetanm" created="Tue, 29 Jul 2014 07:02:11 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alex.parvulescu&quot; class=&quot;user-hover&quot; rel=&quot;alex.parvulescu&quot;&gt;alex.parvulescu&lt;/a&gt; for spotting it. Fixed it in &lt;span class=&quot;error&quot;&gt;&amp;#91;trunk|1614265&amp;#93;&lt;/span&gt; and &lt;a href=&quot;http://svn.apache.org/r1614266&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;1.0&lt;/a&gt; &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12737481">OAK-2059</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12656285" name="OAK-1973.patch" size="4738" author="chetanm" created="Thu, 17 Jul 2014 16:09:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>405757</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xtr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>405779</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>