<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:54:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-9344] JcrLastModifiedConflictHandler prone to NPE</title>
                <link>https://issues.apache.org/jira/browse/OAK-9344</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mreutegg&quot; class=&quot;user-hover&quot; rel=&quot;mreutegg&quot;&gt;mreutegg&lt;/a&gt;, while working on &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-9343&quot; title=&quot;Missing NotNull annotations with implementations of ThreeWayConflictHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-9343&quot;&gt;&lt;del&gt;OAK-9343&lt;/del&gt;&lt;/a&gt; i noticed that &lt;tt&gt;JcrLastModifiedConflictHandler&lt;/tt&gt; is prone to NPE as &lt;tt&gt;ISO8601.parse&lt;/tt&gt; may return null. the return values however are passed to the &apos;pick&apos; method which doesn&apos;t handle a potential null value... a similar problem was spotted with &lt;tt&gt;ExternalIdentityConflictHandler&lt;/tt&gt; (see  also &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-8700&quot; title=&quot;ExternalIdentityConflictHandler prone to NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-8700&quot;&gt;&lt;del&gt;OAK-8700&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void merge(@NotNull NodeBuilder parent, @NotNull PropertyState ours, @NotNull PropertyState theirs) {
        Calendar o = parse(ours.getValue(Type.DATE));
        Calendar t = parse(theirs.getValue(Type.DATE));
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (JCR_CREATED.equals(ours.getName())) {
            parent.setProperty(ours.getName(), pick(o, t, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;));
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            parent.setProperty(ours.getName(), pick(o, t, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;));
        }
    }

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Calendar pick(Calendar a, Calendar b, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; jcrCreated) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (a.before(b)) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; jcrCreated ? a : b;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; jcrCreated ? b : a;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13356705">OAK-9344</key>
            <summary>JcrLastModifiedConflictHandler prone to NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="angela">Angela Schreiber</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Feb 2021 09:10:20 +0000</created>
                <updated>Thu, 3 Jun 2021 14:53:20 +0000</updated>
                            <resolved>Tue, 9 Feb 2021 08:59:35 +0000</resolved>
                                                    <fixVersion>1.40.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17278766" author="anchela" created="Thu, 4 Feb 2021 11:01:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mreutegg&quot; class=&quot;user-hover&quot; rel=&quot;mreutegg&quot;&gt;mreutegg&lt;/a&gt;, proposed fix attached. i would appreciate if you could review it. in particular the change that returns &lt;tt&gt;Resolution.IGNORED&lt;/tt&gt; if the the conflict could not be merged due to null values as NodeBuilder.setProperty mandates the value to be notnull).&lt;/p&gt;</comment>
                            <comment id="17280817" author="tmueller" created="Mon, 8 Feb 2021 07:34:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=angela&quot; class=&quot;user-hover&quot; rel=&quot;angela&quot;&gt;angela&lt;/a&gt; you asked me for a review... If my findings:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Javadocs would help in my view.&lt;/li&gt;
	&lt;li&gt;There was a typo in the test (fixed).&lt;/li&gt;
	&lt;li&gt;The test didn&apos;t cover all cases (I fixed that, now 100% code coverage).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Attached a new patch.&lt;/p&gt;</comment>
                            <comment id="17281616" author="anchela" created="Tue, 9 Feb 2021 08:18:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thomasm&quot; class=&quot;user-hover&quot; rel=&quot;thomasm&quot;&gt;thomasm&lt;/a&gt;, thanks a lot. very much appreciated. i will add notnull-annotations to the extra methods you added to reduce duplications. also i think the javadoc would be easier to read if the corresponding params in &apos;pick&apos; would be renamed to ours and theirs respectively. i will adjust it accordingly and then commit the changes.&lt;/p&gt;</comment>
                            <comment id="17281633" author="tmueller" created="Tue, 9 Feb 2021 08:46:48 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17281641" author="anchela" created="Tue, 9 Feb 2021 08:59:35 +0000"  >&lt;p&gt;Committed revision 1886355.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13356703">OAK-9343</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13020175" name="OAK-9344-b.patch" size="10980" author="thomasm" created="Mon, 8 Feb 2021 07:35:19 +0000"/>
                            <attachment id="13020003" name="OAK-9344.patch" size="9033" author="angela" created="Thu, 4 Feb 2021 10:58:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 39 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ncl4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>