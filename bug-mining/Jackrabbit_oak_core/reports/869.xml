<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:44:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1776] Ordered index returns the wrong nodes when ordering by relative properties</title>
                <link>https://issues.apache.org/jira/browse/OAK-1776</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;The ordered index returns the wrong nodes (the child nodes) when the &quot;order by&quot; uses a relative path for the property name. Example:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;select * from [nt:file] order by [jcr:content/jcr:lastModified]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This query returns the nodes at level &quot;jcr:content&quot; (the child nodes) instead of the nodes at level &quot;nt:file&quot;.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12711120">OAK-1776</key>
            <summary>Ordered index returns the wrong nodes when ordering by relative properties</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thomasm">Thomas Mueller</assignee>
                                    <reporter username="thomasm">Thomas Mueller</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Apr 2014 08:49:46 +0000</created>
                <updated>Wed, 4 Jun 2014 10:16:45 +0000</updated>
                            <resolved>Tue, 29 Apr 2014 13:10:52 +0000</resolved>
                                                    <fixVersion>1.0</fixVersion>
                                    <component>query</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13984126" author="tmueller" created="Tue, 29 Apr 2014 08:52:23 +0000"  >&lt;p&gt;Patch for review:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Index: src/main/java/org/apache/jackrabbit/oak/plugins/index/property/OrderedPropertyIndex.java
===================================================================
--- src/main/java/org/apache/jackrabbit/oak/plugins/index/property/OrderedPropertyIndex.java	(revision 1589427)
+++ src/main/java/org/apache/jackrabbit/oak/plugins/index/property/OrderedPropertyIndex.java	(working copy)
@@ -101,7 +101,7 @@
                     if (lookup.isIndexed(propertyName, &quot;/&quot;, filter)) {
                         IndexPlan.Builder b = getIndexPlanBuilder(filter);
                         b.setSortOrder(ImmutableList.of(new OrderEntry(
-                            propertyName,
+                                oe.getPropertyName(),
                                 Type.UNDEFINED,
                                 lookup.isAscending(root, propertyName, filter) ? OrderEntry.Order.ASCENDING
                                         : OrderEntry.Order.DESCENDING)));
@@ -204,6 +204,7 @@
                 // we could be here if we have a query where the ORDER BY makes us play it.
                 for (OrderEntry oe : sortOrder) {
                     String propertyName = PathUtils.getName(oe.getPropertyName());
+                    depth = PathUtils.getDepth(oe.getPropertyName());
                     if (lookup.isIndexed(propertyName, &quot;/&quot;, null)) {
                         paths = lookup.query(filter, propertyName, new PropertyRestriction());
                     }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13984139" author="edivad" created="Tue, 29 Apr 2014 09:05:33 +0000"  >&lt;p&gt;looks good to me. thanks!&lt;/p&gt;</comment>
                            <comment id="13984247" author="tmueller" created="Tue, 29 Apr 2014 12:39:06 +0000"  >&lt;p&gt;Patch for review. The changes in oak-jcr are a test case, plus adding the ordered index in the default &quot;Jcr&quot; instance.&lt;/p&gt;</comment>
                            <comment id="13984256" author="edivad" created="Tue, 29 Apr 2014 12:48:14 +0000"  >&lt;p&gt;looks good to me.&lt;/p&gt;</comment>
                            <comment id="13984258" author="tmueller" created="Tue, 29 Apr 2014 12:49:44 +0000"  >&lt;p&gt;Revision 1590967 (trunk)&lt;/p&gt;</comment>
                            <comment id="13984272" author="tmueller" created="Tue, 29 Apr 2014 13:10:44 +0000"  >&lt;p&gt;Revision 1590975 (1.0 branch)&lt;/p&gt;</comment>
                            <comment id="14017564" author="alex.parvulescu" created="Wed, 4 Jun 2014 10:16:45 +0000"  >&lt;p&gt;bulk close for the 1.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12642448" name="OAK-1776.patch" size="5512" author="thomasm" created="Tue, 29 Apr 2014 12:39:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389441</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 24 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1v2xr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389683</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>