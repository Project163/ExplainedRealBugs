<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:53:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-8000] AccessControlManagerImpl.getEffectivePolicies(String) doesn&apos;t respect restrictions</title>
                <link>https://issues.apache.org/jira/browse/OAK-8000</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, looking at the implementation of &lt;tt&gt;AccessControlManagerImpl.getEffectivePolicies(String)&lt;/tt&gt; I noticed that the implementation only walks up the hierarchy collection the access control lists but does not evaluated whether the individual entries actually take effect on the tree defined by the &apos;absPath&apos; param. While this is always true for entries without restrictions, it doesn&apos;t necessarily apply for entries that hold restrictions.&lt;/p&gt;

&lt;p&gt;The easiest way to fix this was probably to call the variant of &lt;tt&gt;createACL&lt;/tt&gt; that takes a &lt;tt&gt;Predicate&lt;/tt&gt; and use that one to read and evaluate the restriction pattern present with each entry tree. &lt;/p&gt;

&lt;p&gt;Since the &lt;tt&gt;AccessControlManager.getEffectivePolicies&lt;/tt&gt; is defined to be best-effort, I don&apos;t consider this a serious flaw. But for the sake of improved accuracy it might still be worth addressing. wdyt?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13211204">OAK-8000</key>
            <summary>AccessControlManagerImpl.getEffectivePolicies(String) doesn&apos;t respect restrictions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="angela">Angela Schreiber</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Jan 2019 07:56:39 +0000</created>
                <updated>Tue, 12 Feb 2019 16:25:43 +0000</updated>
                            <resolved>Tue, 12 Feb 2019 16:25:43 +0000</resolved>
                                                                    <component>core</component>
                    <component>security</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="16750154" author="anchela" created="Wed, 23 Jan 2019 15:52:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, while working on the fix, I noted another twist to the story. while the result &lt;tt&gt;getEffectivePolicies&lt;/tt&gt; would be accurate when taking restrictions into considerations, that evaluation would result in skipping entries that hold restrictions primarily pointing to properties. i included one example to illustrate this in &lt;tt&gt;AccessControlManagerTest.testGetEffectivePoliciesMatchingPropertyRestriction&lt;/tt&gt;. So, having a proposed fix I feel a bit undecided about it.... &lt;/p&gt;</comment>
                            <comment id="16763696" author="anchela" created="Fri, 8 Feb 2019 15:28:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, i am inclined to resolve this wontfix. i would adjust the additional test-cases to make sure we have the existing behavior covered with tests and will try to mention the limitation in the documentation. wdyt?&lt;/p&gt;</comment>
                            <comment id="16766106" author="anchela" created="Tue, 12 Feb 2019 14:57:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, also i noticed while working on this the getEffectivePolicies methods may returns empty ACLs, which doesn&apos;t make too much sense IMO. I would refactor that part out and report it with a separate issue. (&lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-8044&quot; title=&quot;AccessControlManagerImpl.getEffectivePolicies returns empty ACLs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-8044&quot;&gt;&lt;del&gt;OAK-8044&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="16766209" author="anchela" created="Tue, 12 Feb 2019 16:25:43 +0000"  >&lt;p&gt;Committed additional tests illustrating the current behavior and an extra section in the documentation highlighting the limitation of the existing code at revision 1853451.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12955994" name="OAK-8000-test.patch" size="36648" author="angela" created="Wed, 23 Jan 2019 15:41:46 +0000"/>
                            <attachment id="12955995" name="OAK-8000.patch" size="13740" author="angela" created="Wed, 23 Jan 2019 15:41:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 39 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi07hs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>