<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:39:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1000] Queries on node name fail if the name starts with a number</title>
                <link>https://issues.apache.org/jira/browse/OAK-1000</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;The &lt;em&gt;NodeNameImpl&lt;/em&gt; encodes the node name when used in a query via the &lt;em&gt;ISO9075.encode&lt;/em&gt; method. &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;The problem appears when a node name starts with a number: the encode will turn &lt;em&gt;123456&lt;/em&gt; into _&lt;em&gt;x0031_23456&lt;/em&gt; thus failing the node name match.&lt;/p&gt;


&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://svn.us.apache.org/viewvc/jackrabbit/oak/trunk/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeNameImpl.java?view=markup#l80&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.us.apache.org/viewvc/jackrabbit/oak/trunk/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeNameImpl.java?view=markup#l80&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12666937">OAK-1000</key>
            <summary>Queries on node name fail if the name starts with a number</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thomasm">Thomas Mueller</assignee>
                                    <reporter username="stillalex">Alex Deparvu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Sep 2013 17:48:31 +0000</created>
                <updated>Fri, 20 Sep 2013 07:01:34 +0000</updated>
                            <resolved>Thu, 5 Sep 2013 13:18:43 +0000</resolved>
                                                    <fixVersion>0.9</fixVersion>
                                    <component>core</component>
                    <component>query</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13758048" author="alex.parvulescu" created="Wed, 4 Sep 2013 17:53:52 +0000"  >&lt;p&gt;added a failing test with &lt;a href=&quot;http://svn.apache.org/r1520083&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1520083&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13758823" author="tmueller" created="Thu, 5 Sep 2013 06:37:22 +0000"  >&lt;p&gt;Interesting. It looks like a property type conversion / comparison problem, I will investigate. There is a related test in oak-core that tests for&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;select [jcr:path] from [nt:base] where name() = &lt;span class=&quot;code-quote&quot;&gt;&apos;My_x0020_Documents&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and expects &quot;My Documents&quot; to match.&lt;/p&gt;</comment>
                            <comment id="13758838" author="tmueller" created="Thu, 5 Sep 2013 06:59:40 +0000"  >&lt;p&gt;According to the test org.apache.jackrabbit.core.query.FnNameQueryTest.testWithSpace, the query with the condition &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;fn:name() = &lt;span class=&quot;code-quote&quot;&gt;&apos;My_x0020_Documents&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is supposed to match the node named &quot;My Documents&quot;, but the condition &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;fn:name() = &lt;span class=&quot;code-quote&quot;&gt;&apos;My Documents&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is supposed &lt;em&gt;not&lt;/em&gt; to match the node named &quot;My Documents&quot;.&lt;/p&gt;</comment>
                            <comment id="13758839" author="tmueller" created="Thu, 5 Sep 2013 07:09:50 +0000"  >&lt;p&gt;It sounds like the test org.apache.jackrabbit.core.query.FnNameQueryTest.testWithSpace and your new test org.apache.jackrabbit.oak.jcr.query.QueryTest.fnNameEncoding somewhat contradict each other. &lt;/p&gt;

&lt;p&gt;testWithSpace expects, for a node named &apos;My Documents&apos;:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;name() = &apos;My_x0020_Documents&apos;&lt;/li&gt;
	&lt;li&gt;name() &amp;lt;&amp;gt; &apos;My Documents&apos;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;fnNameEncoding expects, for a node named &apos;123456_test_name&apos;:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;name() = &apos;123456_test_name&apos;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I will check what Jackrabbit 2.x does here.&lt;/p&gt;</comment>
                            <comment id="13758846" author="tmueller" created="Thu, 5 Sep 2013 07:18:19 +0000"  >&lt;p&gt;When running the following test in Jackrabbit 2.x, it fails at the same place that it fails in Oak:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testFnNameEncoding() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        testRootNode.addNode(&lt;span class=&quot;code-quote&quot;&gt;&quot;123456_test_name&quot;&lt;/span&gt;);
        superuser.save();

        QueryManager qm = superuser.getWorkspace().getQueryManager();
        Query q;

        q = qm.createQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-comment&quot;&gt;//*[jcr:like(fn:name(), &lt;span class=&quot;code-quote&quot;&gt;&apos;%123456%&apos;&lt;/span&gt;)]&quot;&lt;/span&gt;, Query.XPATH);
&lt;/span&gt;        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;/testroot/123456_test_name&quot;&lt;/span&gt;, getPaths(q));

        q = qm.createQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-comment&quot;&gt;//*[fn:name() = &lt;span class=&quot;code-quote&quot;&gt;&apos;123456_test_name&apos;&lt;/span&gt;]&quot;&lt;/span&gt;, Query.XPATH);
&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;// fails here ---&amp;gt;
&lt;/span&gt;        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;/testroot/123456_test_name&quot;&lt;/span&gt;, getPaths(q));

    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So it sounds like the current behavior of Oak is compatible with Jackrabbit 2.x.&lt;/p&gt;

&lt;p&gt;I&apos;m not saying I understand the reason for this behavior &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13758857" author="tmueller" created="Thu, 5 Sep 2013 07:30:25 +0000"  >&lt;p&gt;The first part of your test, the query&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;q = qm.createQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-comment&quot;&gt;//*[jcr:like(fn:name(), &lt;span class=&quot;code-quote&quot;&gt;&apos;%123456%&apos;&lt;/span&gt;)]&quot;&lt;/span&gt;, Query.XPATH);
&lt;/span&gt;assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;/testroot/123456_test_name&quot;&lt;/span&gt;, getPaths(q));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Passes with Jackrabbit 2.x and fails with Oak. So we do have an incompatibility here, I will try to find a way to support it in Oak. &lt;/p&gt;

&lt;p&gt;Thanks for the test case!&lt;/p&gt;</comment>
                            <comment id="13758861" author="mreutegg" created="Thu, 5 Sep 2013 07:32:00 +0000"  >&lt;p&gt;ISO9075 only applies to XPath and not SQL because XPath does not allow spaces in a path element. That&apos;s why &lt;tt&gt;fn:name() = &apos;My_x0020_Documents&apos;&lt;/tt&gt; must match, but &lt;tt&gt;fn:name() = &apos;My Documents&apos;&lt;/tt&gt; must not.&lt;/p&gt;

&lt;p&gt;Similarly &lt;tt&gt;select &lt;span class=&quot;error&quot;&gt;&amp;#91;jcr:path&amp;#93;&lt;/span&gt; from &lt;span class=&quot;error&quot;&gt;&amp;#91;nt:base&amp;#93;&lt;/span&gt; where name() = &apos;My_x0020_Documents&apos;&lt;/tt&gt; should not match because SQL does not know about ISO9075. &lt;/p&gt;</comment>
                            <comment id="13758863" author="tmueller" created="Thu, 5 Sep 2013 07:46:42 +0000"  >&lt;p&gt;Hm, OK, that&apos;s interesting. I will need to run more tests then (with both Jackrabbit 2.x and Oak).&lt;/p&gt;

&lt;p&gt;&amp;gt; ISO9075 only applies to XPath and not SQL&lt;/p&gt;

&lt;p&gt;OK, I didn&apos;t know... &lt;a href=&quot;http://en.wikipedia.org/wiki/ISO_9075&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://en.wikipedia.org/wiki/ISO_9075&lt;/a&gt; says ISO 9075 is the SQL standard &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13758867" author="mreutegg" created="Thu, 5 Sep 2013 07:57:16 +0000"  >&lt;p&gt;Right. I was refering the XPath because it is specified to run against a virtual document view &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; of the repository where escaping is applied &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://www.day.com/specs/jcr/1.0/6.6.1_XPath_over_Document_View.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.day.com/specs/jcr/1.0/6.6.1_XPath_over_Document_View.html&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://www.day.com/specs/jcr/2.0/7_Export.html#7.4%20Escaping%20of%20Names&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.day.com/specs/jcr/2.0/7_Export.html#7.4%20Escaping%20of%20Names&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For JCR SQL that&apos;s not the case.&lt;/p&gt;</comment>
                            <comment id="13758938" author="mreutegg" created="Thu, 5 Sep 2013 09:24:14 +0000"  >&lt;p&gt;To be more specific, the spec references just this part of ISO 9075 when it talks about encoding:&lt;br/&gt;
&lt;a href=&quot;http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=35341&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=35341&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Unfortunately the footnotes do not work in the HTML version of the spec :-/&lt;/p&gt;</comment>
                            <comment id="13759049" author="tmueller" created="Thu, 5 Sep 2013 13:18:43 +0000"  >&lt;p&gt;Thanks Marcel.&lt;/p&gt;

&lt;p&gt;The problem should be fixed in revision 1520297, even thought I had to change the test case slightly.&lt;/p&gt;</comment>
                            <comment id="13772750" author="alex.parvulescu" created="Fri, 20 Sep 2013 07:01:34 +0000"  >&lt;p&gt;Bulk close for the 0.9 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>346874</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 9 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ntbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>347174</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>