<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:54:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-11764] Query planner: when multiple indexes have same cost, planner should choose index deterministically</title>
                <link>https://issues.apache.org/jira/browse/OAK-11764</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;The query planner chooses the index with the lowest cost. But if multiple indexes evaluate to the same cost, currently the planner is taking the first index that is evaluated with the lowest score. This is not deterministic, so the same query may be evaluated sometimes by an index and other times by a different index. Although the results should be the same regardless of the index being used, there can be some cases where the customers are (wrongly) relying on the query being evaluated by the same index every time. For instance, if the query does not precisely define the order of the results, and different indexes will return different orders. This does not violate the contract of the query specification, but users may rely on the results being always in the same order (for instance, to implement pagination).&lt;/p&gt;

&lt;p&gt;The indexes are evaluated in the class &lt;a href=&quot;#L116-L133],&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;FullTextIndex&lt;/a&gt; and taken from a Set with all the indexes created in &lt;a href=&quot;#L55-L70].&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;IndexLookup&lt;/a&gt; This class uses a JDK HashSet to store the indexes. The iteration order of this class is changed on purpose from run to run of the JDK. Previously, this class was using a Guava HashSet, which iterates always by the order by which the elements are added. This &lt;a href=&quot;https://github.com/apache/jackrabbit-oak/pull/1678&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; changed the Guava to the JDK HashSet.&lt;/p&gt;

&lt;p&gt;We should ensure that the indexes are selected in a deterministic order, even if they have the same cost.&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13620854">OAK-11764</key>
            <summary>Query planner: when multiple indexes have same cost, planner should choose index deterministically</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="11">Done</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nuno.santos">Nuno Santos</reporter>
                        <labels>
                            <label>indexing</label>
                    </labels>
                <created>Fri, 13 Jun 2025 13:04:11 +0000</created>
                <updated>Wed, 2 Jul 2025 08:05:06 +0000</updated>
                            <resolved>Wed, 25 Jun 2025 08:30:38 +0000</resolved>
                                                    <fixVersion>1.82.0</fixVersion>
                                    <component>indexing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            21 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1wbl4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>