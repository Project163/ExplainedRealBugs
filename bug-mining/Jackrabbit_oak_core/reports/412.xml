<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:39:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-978] AssertionError thrown for invalid paths</title>
                <link>https://issues.apache.org/jira/browse/OAK-978</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;If the Oak is run with assertions enabled (-ea VM flag) then it throws &lt;tt&gt;AssertionError&lt;/tt&gt; instead of &lt;tt&gt;javax.jcr.RepositoryException&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testExceptionThrownForInvalidPath() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; RepositoryException {
        Session session = getAdminSession();

        session.itemExists(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-comment&quot;&gt;//jcr:content&quot;&lt;/span&gt;);
&lt;/span&gt;    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Above code has following behaviour&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;In JR2 - javax.jcr.RepositoryException: Invalid path://jcr:content&lt;/li&gt;
	&lt;li&gt;In Oak with -ea - java.lang.AssertionError&lt;/li&gt;
	&lt;li&gt;In Oak without -ea - Returns false.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;For compatibility and also as per spec it should throw RepositoryException&lt;/p&gt;</description>
                <environment></environment>
        <key id="12665665">OAK-978</key>
            <summary>AssertionError thrown for invalid paths</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="chetanm">Chetan Mehrotra</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Aug 2013 08:04:32 +0000</created>
                <updated>Fri, 20 Sep 2013 07:01:44 +0000</updated>
                            <resolved>Tue, 27 Aug 2013 10:10:33 +0000</resolved>
                                                    <fixVersion>0.9</fixVersion>
                                    <component>jcr</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13751099" author="mduerig" created="Tue, 27 Aug 2013 09:07:31 +0000"  >&lt;p&gt;This is not a compatibility issue but a bug. It &lt;b&gt;should actually&lt;/b&gt; throw a &lt;tt&gt;RepositoryException&lt;/tt&gt; and never a &lt;tt&gt;AssertionError&lt;/tt&gt;. I&apos;ll move the issue to a top level one. &lt;/p&gt;</comment>
                            <comment id="13751136" author="mduerig" created="Tue, 27 Aug 2013 09:53:54 +0000"  >&lt;p&gt;The issues is caused by the (premature) optimisation in &lt;tt&gt;NamePathMapperImpl#getOakPath&lt;/tt&gt;. I&apos;ll remove this for the time being. We can optimise again when it turns out to be necessary. &lt;/p&gt;</comment>
                            <comment id="13751150" author="mduerig" created="Tue, 27 Aug 2013 10:10:33 +0000"  >&lt;p&gt;Fixed at &lt;a href=&quot;http://svn.apache.org/r1517773&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1517773&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13751242" author="jukkaz" created="Tue, 27 Aug 2013 13:12:12 +0000"  >&lt;blockquote&gt;&lt;p&gt;(premature) optimization&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Are we sure it&apos;s premature? Name/path mapping used to be on a critical path for many of the micro-benchmarks I ran before, and even though we managed to refactor away most of the unnecessary mappings, I wouldn&apos;t be surprised if this remained a performance-critical piece of code, since it gets invoked by almost all JCR method calls, including reads.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;caused&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The way I see it, the &lt;tt&gt;NamePathMapper&lt;/tt&gt; should be responsible just for applying namespace mappings, not verifying whether a path is valid or matches actual content. The validation and resolution of a path (the latter implies the former, so no extra check would commonly be needed) is better handled once namespace mappings have already been done. Thus I disagree that the cause of this issue is in &lt;tt&gt;NamePathMapperImpl&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="13751287" author="mduerig" created="Tue, 27 Aug 2013 14:13:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;Are we sure it&apos;s premature? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In the way that it was broken: yes.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;The way I see it, the NamePathMapper should be responsible...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We had that discussion on several occasions but so far no one found out how to cleanly separate those concerns&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;: in order to validate a path, you need to fully parse it. The code I removed tried otherwise and it failed, even though it has been &apos;fixed&apos; several times. An alternative solution would be to replace the removed code with a call to &lt;tt&gt;JcrPathParser.validate&lt;/tt&gt; but I think that wouldn&apos;t aid performance and AFAIR we even had something along these lines earlier. &lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; the thing you are for calling here is making paths proper classes so we can parse the path string into an intermediate representation with thunks for name mappings. &lt;/p&gt;</comment>
                            <comment id="13772800" author="alex.parvulescu" created="Fri, 20 Sep 2013 07:01:43 +0000"  >&lt;p&gt;Bulk close for the 0.9 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>345605</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 9 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1nlj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>345906</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>