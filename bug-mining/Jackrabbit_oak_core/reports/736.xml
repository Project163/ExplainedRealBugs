<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:42:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1491] ObservationTest failure on Windows</title>
                <link>https://issues.apache.org/jira/browse/OAK-1491</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;&lt;tt&gt;ObservationTest&lt;/tt&gt; fails often on some Windows machines:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;pathFilter[3](org.apache.jackrabbit.oak.jcr.observation.ObservationTest)  Time elapsed: 0.864 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!
java.lang.AssertionError: Missing events: [path = /events/only/here/below/this, type = 1]
	at org.junit.Assert.fail(Assert.java:93)
	at org.junit.Assert.assertTrue(Assert.java:43)
	at org.apache.jackrabbit.oak.jcr.observation.ObservationTest.pathFilter(ObservationTest.java:315)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;filterPropertyOfParent[2](org.apache.jackrabbit.oak.jcr.observation.ObservationTest)  Time elapsed: 0.88 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!
java.lang.AssertionError: Missing events: [path = /test_node/a/jcr:primaryType, type = 4, path = /test_node/a/foo, type = 4, path = /test_node/a/b, type = 1]
	at org.junit.Assert.fail(Assert.java:93)
	at org.junit.Assert.assertTrue(Assert.java:43)
	at org.apache.jackrabbit.oak.jcr.observation.ObservationTest.filterPropertyOfParent(ObservationTest.java:614)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I have the suspicion this is an issue with the test similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1486&quot; title=&quot;BackgroundObserverTest occasionally failing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1486&quot;&gt;&lt;del&gt;OAK-1486&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;&lt;a href=&quot;http://ci.apache.org/builders/oak-trunk-win7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ci.apache.org/builders/oak-trunk-win7&lt;/a&gt;&lt;/p&gt;</environment>
        <key id="12698610">OAK-1491</key>
            <summary>ObservationTest failure on Windows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="mduerig">Michael D&#252;rig</reporter>
                        <labels>
                            <label>observation</label>
                    </labels>
                <created>Tue, 4 Mar 2014 11:13:04 +0000</created>
                <updated>Mon, 6 Oct 2014 04:09:17 +0000</updated>
                            <resolved>Fri, 16 May 2014 13:53:02 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                    <component>core</component>
                    <component>jcr</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13931770" author="reschke" created="Wed, 12 Mar 2014 13:53:11 +0000"  >&lt;p&gt;On a desktop Win7 corei7 I occasionally see JackRabbitNodeTest.testRenameEventHandling failing (&quot;Expected NODE_MOVED event upon renaming a node.&quot;). It appears that this does not happen when the test class is run in isolation; maybe a timing problem caused by GC? (the code waits for 5sec for the event)&lt;/p&gt;

&lt;p&gt;In the meantime I modified the test to collect more information, and it appears that a subsequent event indeed get&apos;s delivered; meaning that the event not only does not show up in time but indeed is lost. Diagnostics:&lt;/p&gt;

&lt;p&gt;junit.framework.AssertionFailedError: Expected NODE_MOVED event upon renaming a node (received: none; next event after additional addNode/save operation: type 1 1394636315281ms /testroot/aXYZ)&lt;/p&gt;</comment>
                            <comment id="13933221" author="reschke" created="Thu, 13 Mar 2014 13:17:27 +0000"  >&lt;p&gt;I have also tried a modified version of the test that uses Workspace.move instead:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;--- oak-jcr/src/test/java/org/apache/jackrabbit/oak/jcr/JackrabbitNodeTest.java(revision 1577126)
+++ oak-jcr/src/test/java/org/apache/jackrabbit/oak/jcr/JackrabbitNodeTest.java(working copy)
@@ -100,7 +100,8 @@
             &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name = n.getName();

             JackrabbitNode node = (JackrabbitNode) n;
-            node.rename(name + &lt;span class=&quot;code-quote&quot;&gt;&apos;X&apos;&lt;/span&gt;);
+            &lt;span class=&quot;code-comment&quot;&gt;// node.rename(name + &lt;span class=&quot;code-quote&quot;&gt;&apos;X&apos;&lt;/span&gt;);
&lt;/span&gt;+            n.getSession().getWorkspace().move(n.getPath(), n.getPath() + &lt;span class=&quot;code-quote&quot;&gt;&quot;X&quot;&lt;/span&gt;);
             superuser.save();

             &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; foundMove = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but see the same kind of failures (so it doesn&apos;t seem to be caused by the use of JackrabbitNode.rename()).&lt;/p&gt;</comment>
                            <comment id="13968404" author="mduerig" created="Mon, 14 Apr 2014 14:51:01 +0000"  >&lt;p&gt;Also &lt;a href=&quot;http://ci.apache.org/builders/oak-trunk-win7/builds/5307&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;observed&lt;/a&gt;: &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;concurrentObservers(org.apache.jackrabbit.oak.spi.commit.BackgroundObserverTest)  Time elapsed: 5.059 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!
java.lang.AssertionError
	at org.junit.Assert.fail(Assert.java:92)
	at org.junit.Assert.assertTrue(Assert.java:43)
	at org.junit.Assert.assertTrue(Assert.java:54)
	at org.apache.jackrabbit.oak.spi.commit.BackgroundObserverTest.concurrentObservers(BackgroundObserverTest.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13987535" author="mduerig" created="Fri, 2 May 2014 09:26:02 +0000"  >&lt;p&gt;Observed &lt;a href=&quot;http://ci.apache.org/builders/oak-trunk-win7/builds/25&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;today &lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;noEventsForTouchedProperties[4](org.apache.jackrabbit.oak.jcr.CompatibilityIssuesTest)  Time elapsed: 15.645 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!
java.lang.AssertionError: expected:&amp;lt;1&amp;gt; but was:&amp;lt;0&amp;gt;
	at org.junit.Assert.fail(Assert.java:93)
	at org.junit.Assert.failNotEquals(Assert.java:647)
	at org.junit.Assert.assertEquals(Assert.java:128)
	at org.junit.Assert.assertEquals(Assert.java:472)
	at org.junit.Assert.assertEquals(Assert.java:456)
	at org.apache.jackrabbit.oak.jcr.CompatibilityIssuesTest.noEventsForTouchedProperties(CompatibilityIssuesTest.java:331)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13990628" author="mduerig" created="Tue, 6 May 2014 13:20:20 +0000"  >&lt;p&gt;Created a branch on my Github fork for instrumenting the code to track this down: &lt;a href=&quot;https://github.com/mduerig/jackrabbit-oak/tree/OAK-1491&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mduerig/jackrabbit-oak/tree/OAK-1491&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13992635" author="mduerig" created="Thu, 8 May 2014 10:01:11 +0000"  >&lt;p&gt;Seems like all of the above failures are test artefact that only occur in some rather specific environments. &lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;The failures of &lt;tt&gt;ObservationRefreshTest&lt;/tt&gt; and &lt;tt&gt;BackgroundObserverTest&lt;/tt&gt; where caused by the observation revision queue filling up while the tests would wait for pending events. In such a scenario pending events would be delayed up to a subsequent commit. Since the test is already waiting this would never happen and the wait would eventually time out. I fixed this in the tests by ensuring the observation revision queue is sufficiently large to hold all commit.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;The failures of &lt;tt&gt;ObservationTest&lt;/tt&gt; and &lt;tt&gt;CompatibilityIssuesTest&lt;/tt&gt; where caused by simple time outs in environments that couldn&apos;t cope with the load. I made &lt;tt&gt;ObservationTest&lt;/tt&gt; to not run the fixtures parallel any more and increased the timeouts.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;See &lt;a href=&quot;http://svn.apache.org/r1593213&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1593213&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I keep the issue open a bit longer until we have sufficient feedback from our CIs backing above observations.&lt;/p&gt;</comment>
                            <comment id="13999805" author="mduerig" created="Fri, 16 May 2014 13:53:02 +0000"  >&lt;p&gt;Resolving as fixed as I haven&apos;t seen this any more on out internal CI since my latest changes in a couple of hundred builds. &lt;/p&gt;

&lt;p&gt;On &lt;a href=&quot;http://ci.apache.org/builders/oak-trunk-win7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ci.apache.org/builders/oak-trunk-win7&lt;/a&gt; this still seems to occur sporadically however I attribute this to the overall shakyness of that environment until someone comes up with further evidence for another cause. &lt;/p&gt;</comment>
                            <comment id="14159918" author="amitjain" created="Mon, 6 Oct 2014 04:09:17 +0000"  >&lt;p&gt;Bulk close for 1.1.0&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>376968</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 6 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1syi7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>377263</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>