<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:53:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-5656] InitialContent depends on document.bundlor.BundlingConfigInitializer</title>
                <link>https://issues.apache.org/jira/browse/OAK-5656</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chetanm&quot; class=&quot;user-hover&quot; rel=&quot;chetanm&quot;&gt;chetanm&lt;/a&gt;, in the light of &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-4975&quot; title=&quot;Setup a default Bundling config&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-4975&quot;&gt;&lt;del&gt;OAK-4975&lt;/del&gt;&lt;/a&gt; a dependency to the document nodestore code got introduced in &lt;tt&gt;org.apache.jackrabbit.oak.plugins.nodetype.write.InitialContent&lt;/tt&gt; by adding the following line:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        BundlingConfigInitializer.INSTANCE.initialize(builder);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the &lt;tt&gt;BundlingConfigInitializer&lt;/tt&gt; is defined in the &lt;tt&gt;org.apache.jackrabbit.oak.plugins.document.bundlor&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;To me that looks quite troublesome and I don&apos;t think the generic JCR-InitialContent should have any dependency on the document nodestore code base.&lt;/p&gt;

&lt;p&gt;Why not defining a dedicated &lt;tt&gt;RepositoryInitializer&lt;/tt&gt; for that kind of init an making sure it is listed in the (default) setup scenarios (or at least in those that actually have a document store and thus require this)?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13042975">OAK-5656</key>
            <summary>InitialContent depends on document.bundlor.BundlingConfigInitializer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mreutegg">Marcel Reutegger</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                            <label>modularization</label>
                            <label>tech-debt</label>
                    </labels>
                <created>Tue, 14 Feb 2017 15:29:45 +0000</created>
                <updated>Thu, 27 Mar 2025 13:40:49 +0000</updated>
                            <resolved>Thu, 14 Sep 2017 06:30:45 +0000</resolved>
                                                    <fixVersion>1.7.8</fixVersion>
                    <fixVersion>1.8.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15867307" author="chetanm" created="Wed, 15 Feb 2017 05:53:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anchela&quot; class=&quot;user-hover&quot; rel=&quot;anchela&quot;&gt;anchela&lt;/a&gt; RepositoryInitializer based approach was discussed as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-4975&quot; title=&quot;Setup a default Bundling config&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-4975&quot;&gt;&lt;del&gt;OAK-4975&lt;/del&gt;&lt;/a&gt; and also on the &lt;a href=&quot;https://lists.apache.org/thread.html/6f19a1390f5c3161311815378eef7688607329ae63d891bf04a4dc62@%3Coak-dev.jackrabbit.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;oak-dev&lt;/a&gt; and consensus then was to keep this simple and bootstrap this config from within InitialContent&lt;/p&gt;</comment>
                            <comment id="15867490" author="anchela" created="Wed, 15 Feb 2017 09:04:44 +0000"  >&lt;p&gt;yes... but looking at it after the fact I have the impression that we should adjust that in order to break the dependency to the document store... this looks troublesome to me.&lt;/p&gt;</comment>
                            <comment id="16162887" author="mreutegg" created="Tue, 12 Sep 2017 12:57:16 +0000"  >&lt;p&gt;I would also like to move this out of InitialContent / oak-core. It is currently the only dependency that prevents us from moving the DocumentNodeStore implementation to a separate bundle.&lt;/p&gt;

&lt;p&gt;How about leaving it up to the application to decide whether it wants to setup bundling of jcr:content node into the parent nt:file node? Both &lt;tt&gt;Oak&lt;/tt&gt; and &lt;tt&gt;Jcr&lt;/tt&gt; builder classes have a &lt;tt&gt;with(RepositoryInitializer)&lt;/tt&gt; method that can be used.&lt;/p&gt;</comment>
                            <comment id="16162894" author="anchela" created="Tue, 12 Sep 2017 13:03:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mreutegg&quot; class=&quot;user-hover&quot; rel=&quot;mreutegg&quot;&gt;mreutegg&lt;/a&gt;, glad to hear. Who is going to take care of it? &lt;/p&gt;</comment>
                            <comment id="16162901" author="mreutegg" created="Tue, 12 Sep 2017 13:09:37 +0000"  >&lt;p&gt;I&apos;ll work on a proposal and attach a patch...&lt;/p&gt;</comment>
                            <comment id="16164408" author="mreutegg" created="Wed, 13 Sep 2017 09:53:32 +0000"  >&lt;p&gt;Proposed changes in &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12886849/12886849_OAK-5656.patch&quot; title=&quot;OAK-5656.patch attached to OAK-5656&quot;&gt;OAK-5656.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;. As mentioned before it becomes the responsibility of the code that bootstraps the Oak or JCR repository to decide whether the BundlingConfigInitializer is used or not.&lt;/p&gt;</comment>
                            <comment id="16164501" author="mreutegg" created="Wed, 13 Sep 2017 11:15:26 +0000"  >&lt;p&gt;Updated patch with a change missing in oak-run.&lt;/p&gt;</comment>
                            <comment id="16164532" author="chetanm" created="Wed, 13 Sep 2017 11:50:51 +0000"  >&lt;p&gt;To allow use of this initializer we would need to export the &quot;org.apache.jackrabbit.oak.plugins.document.bundlor&quot; package from oak-core&lt;/p&gt;</comment>
                            <comment id="16164539" author="mreutegg" created="Wed, 13 Sep 2017 11:57:29 +0000"  >&lt;p&gt;This is only required for OSGi deployments and there are alternatives:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A bundle that wants to use this initializer could also inline the class at build time. This avoids the need to export the package.&lt;/li&gt;
	&lt;li&gt;We move the initializer to a separate package to minimize the exported surface. At the moment none of the DocumentMK related packages are exported.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I don&apos;t have a strong preference... What do you prefer?&lt;/p&gt;</comment>
                            <comment id="16164608" author="chetanm" created="Wed, 13 Sep 2017 13:01:34 +0000"  >&lt;p&gt;Lets go for inline approach for now as it appears we need to extend the patterns also for custom nodetypes. If required we can export it later&lt;/p&gt;</comment>
                            <comment id="16165799" author="mreutegg" created="Thu, 14 Sep 2017 06:16:57 +0000"  >&lt;p&gt;Ack. As mentioned we can still export it later.&lt;/p&gt;</comment>
                            <comment id="16165816" author="mreutegg" created="Thu, 14 Sep 2017 06:30:45 +0000"  >&lt;p&gt;Applied patch to trunk: &lt;a href=&quot;http://svn.apache.org/r1808312&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1808312&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16185642" author="edivad" created="Fri, 29 Sep 2017 10:09:54 +0000"  >&lt;p&gt;Bulk close for 1.7.8&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13613337">OAK-11625</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12886849" name="OAK-5656.patch" size="7431" author="mreutegg" created="Wed, 13 Sep 2017 11:15:18 +0000"/>
                            <attachment id="12886831" name="OAK-5656.patch" size="6185" author="mreutegg" created="Wed, 13 Sep 2017 09:51:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311120" key="com.pyxis.greenhopper.jira:gh-epic-link">
                        <customfieldname>Epic Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>OAK-6069</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 7 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3a2cf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>