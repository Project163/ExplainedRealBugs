<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:44:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1943] UserImporter doesn&apos;t import protected rep:passwordLastModified</title>
                <link>https://issues.apache.org/jira/browse/OAK-1943</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;while writing a dedicated test case for user import along with &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1922&quot; title=&quot;Introduce Password Expiry With Max Password Age and On First Login&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1922&quot;&gt;&lt;del&gt;OAK-1922&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=djaeggi&quot; class=&quot;user-hover&quot; rel=&quot;djaeggi&quot;&gt;djaeggi&lt;/a&gt; found that the rep:passwordLastModified is not being imported.&lt;br/&gt;
in order not to block the initial feature request, we decided to move that in a separate issue and ignore the corresponding test with an corresponding link to this issue.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12725273">OAK-1943</key>
            <summary>UserImporter doesn&apos;t import protected rep:passwordLastModified</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Jul 2014 14:40:20 +0000</created>
                <updated>Mon, 6 Oct 2014 04:46:52 +0000</updated>
                            <resolved>Fri, 4 Jul 2014 13:51:59 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14052247" author="anchela" created="Fri, 4 Jul 2014 08:10:23 +0000"  >&lt;p&gt;the flow is as follows:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the user node gets created&lt;/li&gt;
	&lt;li&gt;the protected password property is handled by UserImporter and triggers the creation of the rep:pwd node&lt;/li&gt;
	&lt;li&gt;further processing the ImportImpl detects that protected the rep:pwd node already exists and ignores it along with it&apos;s properties.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;IMO we have the following possibilities:&lt;br/&gt;
1. we adjust the ImporterImpl such that protected child properties of that existing protected node trigger a call to the protectedpropertyimporters. this would be required if we think that the rep:pwd node may contain additional information that must be importer or if we think that the rep:passwordLastModified should not be generated but taken over from the imported content (i would rather not do the latter)&lt;br/&gt;
2. we leave the ImporterImpl as is if we assume that everything underneath rep:pwd is (or must be) auto-created by the user management implementation and should never be imported -&amp;gt; change the test cases to reflect this.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=djaeggi&quot; class=&quot;user-hover&quot; rel=&quot;djaeggi&quot;&gt;djaeggi&lt;/a&gt;, what do you think?&lt;/p&gt;</comment>
                            <comment id="14052258" author="dominique.jaeggi" created="Fri, 4 Jul 2014 08:35:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anchela&quot; class=&quot;user-hover&quot; rel=&quot;anchela&quot;&gt;anchela&lt;/a&gt;, i would tend towards option 1, including full import of the rep:passwordLastModified property. not importing it would kind of defeat the purpose of the importer. we&apos;re already importing security-relevant data, such as users, their passwords, etc. as such i don&apos;t see why the password modification date should not be imported.&lt;/p&gt;</comment>
                            <comment id="14052283" author="anchela" created="Fri, 4 Jul 2014 09:12:01 +0000"  >&lt;p&gt;ok. fine with me.&lt;/p&gt;</comment>
                            <comment id="14052335" author="anchela" created="Fri, 4 Jul 2014 10:16:55 +0000"  >&lt;p&gt;fixed at r1607820 as suggested by dominique. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=djaeggi&quot; class=&quot;user-hover&quot; rel=&quot;djaeggi&quot;&gt;djaeggi&lt;/a&gt; feel free to provide more tests in case you think something is missing.&lt;br/&gt;
furthermore i would suggest that you add a section to your feature documentation describing who the lastmod property behaves upon XML import (it&apos;s not generated if feature enabled and property missing), otherwise it&apos;s imported overwriting any generated values.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=djaeggi&quot; class=&quot;user-hover&quot; rel=&quot;djaeggi&quot;&gt;djaeggi&lt;/a&gt;, what&apos;s your preference when it comes to importing these properties and the expiry feature is disabled? leaving this open until we have a clear picture here.&lt;/p&gt;
</comment>
                            <comment id="14052388" author="dominique.jaeggi" created="Fri, 4 Jul 2014 12:07:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anchela&quot; class=&quot;user-hover&quot; rel=&quot;anchela&quot;&gt;anchela&lt;/a&gt;, added one more test via &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12654093/12654093_OAK-1934_-_added_one_more_test.patch&quot; title=&quot;OAK-1934_-_added_one_more_test.patch attached to OAK-1943&quot;&gt;OAK-1934_-_added_one_more_test.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; - it checks that expiry props are still there if a user is overwritten via import, the XML of which doesn&apos;t contain an expiry prop.&lt;/p&gt;

&lt;p&gt;i added the following to the feature documentation:&lt;/p&gt;

&lt;p&gt;&quot;When users are imported via the Oak JCR XML importer, the expiry relevant nodes and property are supported. If the XML specifies a rep:pwd node and optionally a rep:passwordLastModified property, these are imported, irrespective of the password expiry or force initial password change being enabled. If they&apos;re enabled, the imported property will be used in the normal login process as described above. If not enabled, the imported property will have no effect.&lt;br/&gt;
On the other hand, if the imported user already exists, potentially existing rep:passwordLastModified properties will be overwritten with the value from the import. If password expiry is enabled, this may cause passwords to expire earlier or later than anticipated, governed by the new value. Also, an import may create such a property where none previously existed, thus effectively cancelling the need to change the password on first login - if the feature is enabled.&lt;br/&gt;
Therefore customers using the importer in such fashion should be aware of the potential need to enable password expiry/force initial password change for the imported data to make sense, and/or the effect on already existing/overwritten data.&quot;&lt;/p&gt;

&lt;p&gt;regarding importing when expiry is disabled: if the expiry property is imported and the feature is disabled, the property is essentially dead weight, as it is neither read nor updated upon password change. Conversely, if the feature is suddenly enabled, the data is already there and can be used. The only change required for that to work, could be: in UserManager#setPassword, if the property already exists, update it irrespective of the feature being enabled. &lt;/p&gt;

&lt;p&gt;WDYT?&lt;/p&gt;</comment>
                            <comment id="14052448" author="anchela" created="Fri, 4 Jul 2014 13:51:59 +0000"  >&lt;p&gt;agreed. commited addition test at rev. 1607857 (thanks a lot!)&lt;/p&gt;

&lt;p&gt;regarding updating the last-mod property irrespective of the expiry feature being enabled: i&apos;d rather wait and see if there is real need... but if you want to add this feel free to open an improvement issue with a patch. i will be happy to commit it on your behalf.&lt;/p&gt;</comment>
                            <comment id="14159863" author="amitjain" created="Mon, 6 Oct 2014 04:09:03 +0000"  >&lt;p&gt;Bulk close for 1.1.0&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12654093" name="OAK-1934_-_added_one_more_test.patch" size="3219" author="dominique.jaeggi" created="Fri, 4 Jul 2014 12:07:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403456</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 6 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xftr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403504</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>