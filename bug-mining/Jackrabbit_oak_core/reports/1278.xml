<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:48:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-3191] Oak UserManager#getAuthorizable handles null and empty string differently than Jackrabbit</title>
                <link>https://issues.apache.org/jira/browse/OAK-3191</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;With Jackrabbit, the following API call&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;UserManager#getAuthorizable(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; auth)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;with either &lt;tt&gt;null&lt;/tt&gt; or &lt;tt&gt;&quot;&quot;&lt;/tt&gt; used to throw&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Invalid authorizable name &lt;span class=&quot;code-quote&quot;&gt;&apos;&quot;&lt;/span&gt; + id + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos;&lt;/span&gt;&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With Oak UserManager, the same input does not throw an IAE, but instead return a &lt;tt&gt;null&lt;/tt&gt; value when providing &lt;tt&gt;&quot;&quot;&lt;/tt&gt; and throws a NPE when providing &lt;tt&gt;null&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;From my POV, it would be best to avoid throwing exceptions on those two cases. Indeed, returning a &lt;tt&gt;null&lt;/tt&gt; value is simpler for the API user and would comply with the API.&lt;br/&gt;
If so, the implementation in case of &lt;tt&gt;null&lt;/tt&gt; may be changed in order to swallow the &lt;tt&gt;null&lt;/tt&gt; value and the difference between Jackrabbit and Oak may be documented.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12852616">OAK-3191</key>
            <summary>Oak UserManager#getAuthorizable handles null and empty string differently than Jackrabbit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="angela">Angela Schreiber</assignee>
                                    <reporter username="marett">Timothee Maret</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Aug 2015 16:10:15 +0000</created>
                <updated>Wed, 2 Mar 2016 12:06:54 +0000</updated>
                            <resolved>Tue, 11 Aug 2015 08:58:38 +0000</resolved>
                                    <version>1.3.2</version>
                                    <fixVersion>1.3.4</fixVersion>
                    <fixVersion>1.4</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14660233" author="marett" created="Thu, 6 Aug 2015 16:14:35 +0000"  >&lt;p&gt;Attaching a patch containing two dumb unit tests that show the behaviour in Oak.&lt;/p&gt;</comment>
                            <comment id="14660710" author="anchela" created="Thu, 6 Aug 2015 20:05:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marett&quot; class=&quot;user-hover&quot; rel=&quot;marett&quot;&gt;marett&lt;/a&gt;, thanks for spotting this. in case of doubt i would rather adopt the same behavior than we had in jackrabbit... in particular since creating a user with null/empty id throws illegalargumentexception. but i will take a closer look again; in any case i don&apos;t recall having made this a deliberate break wrt jackrabbit behavior.&lt;/p&gt;

&lt;p&gt;btw: changed prio to minor. afaik the API contract doesn&apos;t specify how to deal with null/empty id and therefore we have IMHO no major misbehavior.&lt;/p&gt;</comment>
                            <comment id="14660776" author="marett" created="Thu, 6 Aug 2015 20:54:52 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anchela&quot; class=&quot;user-hover&quot; rel=&quot;anchela&quot;&gt;anchela&lt;/a&gt;, ensuring backaward compatibility also makes sense. I agree, this is not urgent (I used the default priority).&lt;/p&gt;</comment>
                            <comment id="14661950" author="anchela" created="Fri, 7 Aug 2015 14:54:00 +0000"  >&lt;p&gt;proposed fix to establish backwards compatible behavior (plus some minor improvement in the UserManagemerImpl).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marett&quot; class=&quot;user-hover&quot; rel=&quot;marett&quot;&gt;marett&lt;/a&gt;, do you see any issue with fixing it this way?&lt;/p&gt;</comment>
                            <comment id="14661969" author="marett" created="Fri, 7 Aug 2015 15:13:19 +0000"  >&lt;p&gt;If supporting backward compatibility is the highest concern, then it makes sense. There may be some users of the existing Oak UserManager that will face the new exceptions but that looks like reasonable risk.&lt;/p&gt;

&lt;p&gt;However, I think it may make more sense to swallow those inputs as it would comply with the API. From a user POV, I think it would avoid to be &quot;surprised&quot; by receiving an exception on some inputs. Indeed, the list of non valid input is currently non documented. Looking at the source code helps, but even then it may be surprising that empty string is illegal but a blank string is legal.&lt;/p&gt;</comment>
                            <comment id="14679663" author="anchela" created="Mon, 10 Aug 2015 06:46:46 +0000"  >&lt;p&gt;it&apos;s just a high concern not the highest &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
since your report subject stressed the fact that it&apos;s different from Jackrabbit 2.x, i wanted to address this in the first place. as far as the API is concerned: even today&apos;s solution complies with the API as it doesn&apos;t make any statements about &apos;illegal&apos; ids and how to handle them. nor does the API come with annotations. creating a user with empty or null ID however is forbidden with &lt;tt&gt;IllegalArgumentException&lt;/tt&gt;, so one might argue that it&apos;s consistent to behave the same for &lt;tt&gt;getAuthorizable&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;but i can also live with returning &lt;tt&gt;null&lt;/tt&gt; for both empty and null id.&lt;/p&gt;</comment>
                            <comment id="14679747" author="marett" created="Mon, 10 Aug 2015 08:01:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;even today&apos;s solution complies with the API&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I agree. The only folks that may experience this edge case slight difference in the implementation are those moving customer code from Jackrabbit code to Oak.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;so one might argue that it&apos;s consistent to behave the same for getAuthorizable&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I agree. &lt;/p&gt;

&lt;p&gt;It is seems like an implementation choice whether to limit the valid inputs for consistency or have the implementation handle as much input as possible. Maybe not breaking Oak code (thus keeping returning null)  and telling Jackrabbit-&amp;gt;Oak migrators that there may be change is the simplest &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="14679780" author="anchela" created="Mon, 10 Aug 2015 08:19:54 +0000"  >&lt;p&gt;I don&apos;t have a strong preference here... alternative patch will follow (-&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-3191&quot; title=&quot;Oak UserManager#getAuthorizable handles null and empty string differently than Jackrabbit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-3191&quot;&gt;&lt;del&gt;OAK-3191&lt;/del&gt;&lt;/a&gt;_2.patch)&lt;/p&gt;
</comment>
                            <comment id="14681470" author="anchela" created="Tue, 11 Aug 2015 08:58:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marett&quot; class=&quot;user-hover&quot; rel=&quot;marett&quot;&gt;marett&lt;/a&gt;, i applied the second patch at r1695231 avoiding runtime exceptions (but consequently making oak behave differently than jackrabbit 2.x). the fix not only applies to retrieving authorizables by ID but also for lookup by principal.&lt;/p&gt;

&lt;p&gt;additionally, i mentioned the different behavior in the &apos;differences wrt jackrabbit 2.x&apos; section in the documentation.&lt;/p&gt;

&lt;p&gt;Timothee, thanks a lot for reporting and the initial patch.&lt;/p&gt;</comment>
                            <comment id="14706658" author="edivad" created="Fri, 21 Aug 2015 12:13:07 +0000"  >&lt;p&gt;Bulk close for 1.3.4&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12749287" name="OAK-3191.patch" size="10600" author="angela" created="Fri, 7 Aug 2015 14:54:00 +0000"/>
                            <attachment id="12749088" name="OAK-3191.patch" size="2059" author="marett" created="Thu, 6 Aug 2015 16:14:35 +0000"/>
                            <attachment id="12749557" name="OAK-3191_2.patch" size="10966" author="angela" created="Mon, 10 Aug 2015 09:35:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 13 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ifdj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>