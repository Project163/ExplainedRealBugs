<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:40:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-1178] MutableTree#isNew: replace implementation by NodeBuilder#isNew </title>
                <link>https://issues.apache.org/jira/browse/OAK-1178</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;Similar to the issue described in &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-1177&quot; title=&quot;Node#isModified returns true if node has non-readable child&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-1177&quot;&gt;&lt;del&gt;OAK-1177&lt;/del&gt;&lt;/a&gt; we may consider replacing the implementation of MutableTree#isNew by the corresponding call on the NodeBuilder.&lt;/p&gt;

&lt;p&gt;See also &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-947&quot; title=&quot;New node becomes existing after Session.refresh(true)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-947&quot;&gt;&lt;del&gt;OAK-947&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12679016">OAK-1178</key>
            <summary>MutableTree#isNew: replace implementation by NodeBuilder#isNew </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mduerig">Michael D&#252;rig</assignee>
                                    <reporter username="angela">Angela Schreiber</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Nov 2013 13:53:41 +0000</created>
                <updated>Thu, 21 Nov 2013 10:30:15 +0000</updated>
                            <resolved>Wed, 13 Nov 2013 21:12:03 +0000</resolved>
                                                    <fixVersion>0.11</fixVersion>
                                    <component>core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13821363" author="anchela" created="Wed, 13 Nov 2013 14:07:16 +0000"  >&lt;p&gt;patch that replaces implementation of MutableTree#isNew by the delegating it to NodeBuilder#isNew.&lt;/p&gt;

&lt;p&gt;However, this causes org.apache.jackrabbit.oak.core.RootTest to fail...&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jukkaz&quot; class=&quot;user-hover&quot; rel=&quot;jukkaz&quot;&gt;jukkaz&lt;/a&gt;, any idea why NodeBuilder#isNew seems to be wrong here?&lt;/p&gt;</comment>
                            <comment id="13821506" author="mduerig" created="Wed, 13 Nov 2013 16:42:57 +0000"  >&lt;p&gt;This is probably caused by some of the &lt;tt&gt;NodeBuilder&lt;/tt&gt; implementations not preserving the status across rebase operations. Added a test case for &lt;tt&gt;KernelNodeBuilder&lt;/tt&gt; at &lt;a href=&quot;http://svn.apache.org/r1541601&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1541601&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13821526" author="anchela" created="Wed, 13 Nov 2013 17:02:05 +0000"  >&lt;p&gt;that might be... i had another look at the MemoryNodeBuilder and wondered why #isNew() is implemented as:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isNew() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; !isRoot() &amp;amp;&amp;amp; !parent.base().hasChildNode(name) &amp;amp;&amp;amp; parent.hasChildNode(name);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;instead of just writing:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; !base().exists();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;there is most probably a reason for this, but just from the methods available i would have expected that this simplified version would reveal if there exists a persisted base-state.  &lt;/p&gt;
</comment>
                            <comment id="13821535" author="jukkaz" created="Wed, 13 Nov 2013 17:06:44 +0000"  >&lt;blockquote&gt;&lt;p&gt;simplified version&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, that definitely makes sense. I think the current &lt;tt&gt;isNew()&lt;/tt&gt; code dates back to the time before we had the &lt;tt&gt;exists()&lt;/tt&gt; mechanism, which makes it so convoluted.&lt;/p&gt;</comment>
                            <comment id="13821540" author="jukkaz" created="Wed, 13 Nov 2013 17:09:01 +0000"  >&lt;p&gt;Actually, the method should probably use &lt;tt&gt;exists() &amp;amp;&amp;amp; !base().exists()&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="13821542" author="mduerig" created="Wed, 13 Nov 2013 17:11:56 +0000"  >&lt;p&gt;Right, this makes the tests pass. I&apos;ll double check and commit if IT tests pass.&lt;/p&gt;</comment>
                            <comment id="13821558" author="mduerig" created="Wed, 13 Nov 2013 17:31:26 +0000"  >&lt;p&gt;At &lt;a href=&quot;http://svn.apache.org/r1541626&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1541626&lt;/a&gt; I committed the simplified implementation for &lt;tt&gt;NodeBuilder.isNew&lt;/tt&gt;. This reduces the number of test failures in &lt;tt&gt;RootTest&lt;/tt&gt; (with Angela&apos;s patch, that is) to &lt;tt&gt;moveRemoveAdd&lt;/tt&gt; and &lt;tt&gt;moveExistingParent&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="13821844" author="mduerig" created="Wed, 13 Nov 2013 21:12:03 +0000"  >&lt;p&gt;Fixed at &lt;a href=&quot;http://svn.apache.org/r1541707&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1541707&lt;/a&gt;.&lt;br/&gt;
Turns out that the &lt;tt&gt;KernelNodeBuilder&lt;/tt&gt; and the &lt;tt&gt;MongoNodeBuilder&lt;/tt&gt; did not correctly set their base state on rebase. Additionally &lt;tt&gt;MongoNodeBuilder&lt;/tt&gt; relied on the &lt;tt&gt;MemoryNodeBuilder&lt;/tt&gt; backing it for calculating its base state. However, this doesn&apos;t work since we need to take also the persisted changes (on the private branch) into consideration.&lt;/p&gt;</comment>
                            <comment id="13828688" author="alex.parvulescu" created="Thu, 21 Nov 2013 10:30:15 +0000"  >&lt;p&gt;bulk close for the 0.11 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12652622">OAK-869</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12662418">OAK-947</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12613606" name="OAK-1178.patch" size="1281" author="angela" created="Wed, 13 Nov 2013 14:07:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>358381</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ps3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>358671</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>