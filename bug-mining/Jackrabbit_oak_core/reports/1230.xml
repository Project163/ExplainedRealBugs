<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:48:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[OAK-3028] Hierarchy conflict detection broken</title>
                <link>https://issues.apache.org/jira/browse/OAK-3028</link>
                <project id="12313221" key="OAK">Jackrabbit Oak</project>
                    <description>&lt;p&gt;Hierarchy conflict detection is broken in 1.0.14. It may happen that a child document is created even though the parent is considered deleted.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12840055">OAK-3028</key>
            <summary>Hierarchy conflict detection broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mreutegg">Marcel Reutegger</assignee>
                                    <reporter username="mreutegg">Marcel Reutegger</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Jun 2015 07:00:29 +0000</created>
                <updated>Wed, 2 Mar 2016 11:49:26 +0000</updated>
                            <resolved>Wed, 24 Jun 2015 13:59:05 +0000</resolved>
                                    <version>1.0.14</version>
                    <version>1.0.15</version>
                    <version>1.3.0</version>
                    <version>1.3.1</version>
                                    <fixVersion>1.0.16</fixVersion>
                    <fixVersion>1.2.3</fixVersion>
                    <fixVersion>1.3.2</fixVersion>
                    <fixVersion>1.4</fixVersion>
                                    <component>core</component>
                    <component>mongomk</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14598983" author="reschke" created="Wed, 24 Jun 2015 07:11:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mreutegg&quot; class=&quot;user-hover&quot; rel=&quot;mreutegg&quot;&gt;mreutegg&lt;/a&gt;] this does affect RDBMK too, right?&lt;/p&gt;</comment>
                            <comment id="14598988" author="mreutegg" created="Wed, 24 Jun 2015 07:15:18 +0000"  >&lt;p&gt;Attached test to reproduce the issue. Use -Dns-fixtures=DOCUMENT_NS to just run the MongoMK based fixture.&lt;/p&gt;</comment>
                            <comment id="14598992" author="mreutegg" created="Wed, 24 Jun 2015 07:16:41 +0000"  >&lt;p&gt;I don&apos;t know yet if this also affects RDBMK, the test I used is derived from AbstractRepositoryTest, which does not have an RDBFixture. So far I only tested with MongoMK.&lt;/p&gt;</comment>
                            <comment id="14599005" author="mreutegg" created="Wed, 24 Jun 2015 07:25:47 +0000"  >&lt;p&gt;The test runs fine on my machine when I run it on 1.0.13 and fails on 1.0.14. I&apos;ll try to pinpoint the offending commit.&lt;/p&gt;</comment>
                            <comment id="14599010" author="mreutegg" created="Wed, 24 Jun 2015 07:33:58 +0000"  >&lt;p&gt;The tests starts to fail with the commit for &lt;a href=&quot;https://issues.apache.org/jira/browse/OAK-2804&quot; title=&quot;Conditional remove on DocumentStore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OAK-2804&quot;&gt;&lt;del&gt;OAK-2804&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14599011" author="mreutegg" created="Wed, 24 Jun 2015 07:37:23 +0000"  >&lt;p&gt;This issue is present in all branches, but does not affect a released version on the 1.2 branch. Affected released versions are 1.0.14, 1.0.15, 1.3.0 and 1.3.1. &lt;/p&gt;</comment>
                            <comment id="14599136" author="mreutegg" created="Wed, 24 Jun 2015 08:58:00 +0000"  >&lt;p&gt;This issue also affects the RDBMK. The conflict is not detected when multiple commits enter the BatchCommitQueue. Due to a bug in UpdateOp, the collisions checks are missing for a batch commit. This means a commit will proceed even when a collision marker is present on the commit root document for the given commit.&lt;/p&gt;</comment>
                            <comment id="14599454" author="mreutegg" created="Wed, 24 Jun 2015 13:59:05 +0000"  >&lt;p&gt;Fixed in trunk: &lt;a href=&quot;http://svn.apache.org/r1687220&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1687220&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Merged into 1.2 branch: &lt;a href=&quot;http://svn.apache.org/r1687224&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1687224&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Merged into 1.0 branch: &lt;a href=&quot;http://svn.apache.org/r1687282&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1687282&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14599568" author="joerghoh" created="Wed, 24 Jun 2015 15:22:32 +0000"  >&lt;p&gt;How can I check if my instance is affected? Are there any log messages pointing to that problem? And if I am affected, do I need to start a recovery mechanism? How could it look like?&lt;/p&gt;</comment>
                            <comment id="14600819" author="mreutegg" created="Thu, 25 Jun 2015 07:34:30 +0000"  >&lt;p&gt;There is no tool to detect the inconsistency. If the issue occurs, you will see repeated exceptions about merge failures because of conflicts. E.g.:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.jackrabbit.oak.plugins.document.DocumentStoreException: The node 11:/oak:index/nodetype/:index/nt%3Aunstructured/test/level-0/level-1/level-2/level-3/level-4/child-0 was already added in revision
r14e2998ce4c-0-1, before
r14e2998f0ab-0-1; document: ...

org.apache.jackrabbit.oak.plugins.document.DocumentStoreException: The node 11:/oak:index/nodetype/:index/nt%3Aunstructured/test/level-0/level-1/level-2/level-3/level-4/child-0 was already added in revision
r14e2998ce4c-0-1, before
r14e29991618-0-1; document: ...

org.apache.jackrabbit.oak.plugins.document.DocumentStoreException: The node 11:/oak:index/nodetype/:index/nt%3Aunstructured/test/level-0/level-1/level-2/level-3/level-4/child-0 was already added in revision
r14e2998ce4c-0-1, before
r14e2999365e-0-1; document: ...

org.apache.jackrabbit.oak.plugins.document.DocumentStoreException: The node 11:/oak:index/nodetype/:index/nt%3Aunstructured/test/level-0/level-1/level-2/level-3/level-4/child-0 was already added in revision
r14e2998ce4c-0-1, before
r14e299959c1-0-1; document: ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The exceptions will report the same revision when the node was already added. In the above test run &lt;tt&gt;r14e2998ce4c-0-1&lt;/tt&gt;, but the revision of the node to be added will be different with every attempt. In this case you would have to remove the document directly in the DocumentStore to recover from this inconsistency.&lt;/p&gt;</comment>
                            <comment id="14605687" author="mreutegg" created="Mon, 29 Jun 2015 14:30:30 +0000"  >&lt;p&gt;Bulk close for 1.0.16&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12919515">OAK-3733</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12823041">OAK-2804</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12741459" name="ConcurrentAddRemove2IT.patch" size="5672" author="mreutegg" created="Wed, 24 Jun 2015 07:15:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 20 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2gf5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>