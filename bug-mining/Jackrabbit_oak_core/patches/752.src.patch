diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
index 2838e81b73..aa784de16a 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
@@ -213,11 +213,18 @@ public class FileStore implements SegmentStore {
                 tracker.getWriter().flush();
 
                 synchronized (this) {
+                    boolean success = true;
                     for (TarFile file : bulkFiles) {
-                        file.flush();
+                        success = success && file.flush();
                     }
                     for (TarFile file : dataFiles) {
-                        file.flush();
+                        success = success && file.flush();
+                    }
+                    if (!success) {
+                        log.warn("Failed to sync one ore more tar files with"
+                                + " the underlying file system, possibly because of"
+                                + " http://bugs.java.com/bugdatabase/view_bug.do?bug_id=6539707."
+                                + " Will retry later.");
                     }
                     journalFile.writeBytes(after + " root\n");
                     journalFile.getChannel().force(false);
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/MappedAccess.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/MappedAccess.java
index 93b0bef2bf..539da681b6 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/MappedAccess.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/MappedAccess.java
@@ -66,7 +66,7 @@ class MappedAccess implements FileAccess {
     }
 
     @Override
-    public synchronized void flush() {
+    public synchronized void flush() throws IOException {
         if (updated) {
             buffer.force();
             updated = false;
@@ -74,7 +74,8 @@ class MappedAccess implements FileAccess {
     }
 
     @Override
-    public void close() {
+    public void close() throws IOException {
+        flush();
     }
 
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/RandomAccess.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/RandomAccess.java
index c8823303c1..43b167b586 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/RandomAccess.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/RandomAccess.java
@@ -29,6 +29,8 @@ class RandomAccess implements FileAccess {
 
     private final RandomAccessFile file;
 
+    private boolean updated = false;
+
     RandomAccess(@Nonnull RandomAccessFile file) throws IOException {
         this.file = checkNotNull(file);
     }
@@ -55,16 +57,20 @@ class RandomAccess implements FileAccess {
             throws IOException {
         file.seek(position);
         file.write(buffer, offset, length);
+        updated = true;
     }
 
     @Override
-    public void flush() throws IOException {
-        file.getFD().sync();
+    public synchronized void flush() throws IOException {
+        if (updated) {
+            file.getFD().sync();
+            updated = false;
+        }
     }
 
     @Override
-    public void close() throws IOException {
-        file.close();
+    public synchronized void close() throws IOException {
+        file.close(); // will automatically sync unsaved changes
     }
 
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/TarFile.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/TarFile.java
index e6f194e97a..84cad55e36 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/TarFile.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/TarFile.java
@@ -191,13 +191,26 @@ class TarFile {
         access.write(position, header, 0, BLOCK_SIZE);
     }
 
-    public void flush() throws IOException {
-        access.flush();
+    public boolean flush() throws IOException {
+        try {
+            access.flush();
+            return true;
+        } catch (IOException e) {
+            StackTraceElement[] trace = e.getStackTrace();
+            if (trace.length > 2
+                    && "java.nio.MappedByteBuffer".equals(trace[0].getClassName())
+                    && "force0".equals(trace[0].getMethodName())
+                    && "java.nio.MappedByteBuffer".equals(trace[1].getClassName())
+                    && "force".equals(trace[1].getMethodName())) {
+                return false;
+            } else {
+                throw e;
+            }
+        }
     }
 
 
     void close() throws IOException {
-        flush();
         access.close();
     }
 
