diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeStateBuilder.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeStateBuilder.java
index a6f4330d32..ab392f8da3 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeStateBuilder.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeStateBuilder.java
@@ -22,6 +22,7 @@ import org.apache.jackrabbit.oak.kernel.PropertyStateImpl;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeStateBuilder;
 
+import java.util.Collections;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
@@ -33,9 +34,15 @@ class MemoryNodeStateBuilder implements NodeStateBuilder {
 
     private final NodeState base;
 
+    /**
+     * Set of added, modified or removed ({@code null} value) property states.
+     */
     private final Map<String, PropertyState> properties =
             new HashMap<String, PropertyState>();
 
+    /**
+     * Set of added, modified or removed ({@code null} value) child node states.
+     */
     private final Map<String, NodeState> nodes =
             new HashMap<String, NodeState>();
 
@@ -50,9 +57,24 @@ class MemoryNodeStateBuilder implements NodeStateBuilder {
             return base; // shortcut
         } else {
             return new ModifiedNodeState(
-                    base,
-                    new HashMap<String, PropertyState>(properties),
-                    new HashMap<String, NodeState>(nodes));
+                    base, snapshot(properties), snapshot(nodes));
+        }
+    }
+
+    /**
+     * Returns an optimized snapshot of the current state of the given map.
+     *
+     * @param map mutable map
+     * @return optimized snapshot
+     */
+    private static <T> Map<String, T> snapshot(Map<String, T> map) {
+        if (map.isEmpty()) {
+            return Collections.emptyMap();
+        } else if (map.size() == 1) {
+            Map.Entry<String, T> entry = map.entrySet().iterator().next();
+            return Collections.singletonMap(entry.getKey(), entry.getValue());
+        } else {
+            return new HashMap<String, T>(map);
         }
     }
 
@@ -63,7 +85,11 @@ class MemoryNodeStateBuilder implements NodeStateBuilder {
 
     @Override
     public void removeNode(String name) {
-        nodes.put(name, null);
+        if (base.getChildNode(name) != null) {
+            nodes.put(name, null);
+        } else {
+            nodes.remove(name);
+        }
     }
 
     @Override
@@ -80,7 +106,11 @@ class MemoryNodeStateBuilder implements NodeStateBuilder {
 
     @Override
     public void removeProperty(String name) {
-        properties.put(name, null);
+        if (base.getProperty(name) != null) {
+            properties.put(name, null);
+        } else {
+            properties.remove(name);
+        }
     }
 
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/ModifiedNodeState.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/ModifiedNodeState.java
index a436f58606..f448e0b3b8 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/ModifiedNodeState.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/ModifiedNodeState.java
@@ -51,12 +51,11 @@ public class ModifiedNodeState extends ProxyNodeState {
         for (Map.Entry<String, PropertyState> entry : properties.entrySet()) {
             PropertyState before = super.getProperty(entry.getKey());
             PropertyState after = entry.getValue();
-            if (before == null) {
-                if (after != null) {
-                    diff.propertyAdded(after);
-                }
-            } else if (after == null) {
+            if (after == null) {
+                assert before != null;
                 diff.propertyDeleted(before);
+            } else if (before == null) {
+                diff.propertyAdded(after);
             } else {
                 diff.propertyChanged(before, after);
             }
@@ -66,12 +65,11 @@ public class ModifiedNodeState extends ProxyNodeState {
             String name = entry.getKey();
             NodeState before = super.getChildNode(name);
             NodeState after = entry.getValue();
-            if (before == null) {
-                if (after != null) {
-                    diff.childNodeAdded(name, after);
-                }
-            } else if (after == null) {
+            if (after == null) {
+                assert before != null;
                 diff.childNodeDeleted(name, before);
+            } else if (before == null) {
+                diff.childNodeAdded(name, after);
             } else {
                 diff.childNodeChanged(name, before, after);
             }
