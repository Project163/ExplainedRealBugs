diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeStore.java
index 26bb4b4eb4..ef3bac7e9d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeStore.java
@@ -1478,7 +1478,7 @@ public final class DocumentNodeStore
         addPathsForDiff(path, paths, getPendingModifications(), minRev);
         for (Revision r : new Revision[]{fromRev, toRev}) {
             if (r.isBranch()) {
-                Branch b = getBranches().getBranch(fromRev);
+                Branch b = getBranches().getBranch(r);
                 if (b != null) {
                     addPathsForDiff(path, paths, b.getModifications(r), r);
                 }
