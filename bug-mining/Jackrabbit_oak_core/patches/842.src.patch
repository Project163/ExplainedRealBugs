diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
index 1a6d7d3889..218df74928 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
@@ -118,6 +118,13 @@ public class QueryImpl implements Query {
 
     private OrderingImpl[] orderings;
     private ColumnImpl[] columns;
+    
+    /**
+     * The columns that make a row distinct. This is all columns
+     * except for "jcr:score".
+     */
+    private boolean[] distinctColumns;
+    
     private boolean explain, measure;
     private boolean distinct;
     private long limit = Long.MAX_VALUE;
@@ -347,6 +354,15 @@ public class QueryImpl implements Query {
         for (ColumnImpl column : columns) {
             column.bindSelector(source);
         }
+        distinctColumns = new boolean[columns.length];
+        for (int i = 0; i < columns.length; i++) {
+            ColumnImpl c = columns[i];
+            boolean distinct = true;
+            if (JCR_SCORE.equals(c.getPropertyName())) {
+                distinct = false;
+            }
+            distinctColumns[i] = distinct;
+        }
     }
 
     @Override
@@ -409,7 +425,7 @@ public class QueryImpl implements Query {
             ResultRowImpl r = new ResultRowImpl(this,
                     Tree.EMPTY_ARRAY,
                     new PropertyValue[] { PropertyValues.newString(plan)},
-                    null);
+                    null, null);
             return Arrays.asList(r).iterator();
         }
         if (LOG.isDebugEnabled()) {
@@ -474,7 +490,7 @@ public class QueryImpl implements Query {
                             PropertyValues.newString("query"),
                             PropertyValues.newLong(rowIt.getReadCount())
                         },
-                    null);
+                    null, null);
             list.add(r);
             for (SelectorImpl selector : selectors) {
                 r = new ResultRowImpl(this,
@@ -483,7 +499,7 @@ public class QueryImpl implements Query {
                                 PropertyValues.newString(selector.getSelectorName()),
                                 PropertyValues.newLong(selector.getScanCount()),
                             },
-                        null);
+                        null, null);
                 list.add(r);
             }
             it = list.iterator();
@@ -676,7 +692,7 @@ public class QueryImpl implements Query {
                 orderValues[i] = orderings[i].getOperand().currentProperty();
             }
         }
-        return new ResultRowImpl(this, trees, values, orderValues);
+        return new ResultRowImpl(this, trees, values, distinctColumns, orderValues);
     }
 
     @Override
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java
index 186a612043..c0b3b06cc1 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java
@@ -35,13 +35,28 @@ public class ResultRowImpl implements ResultRow {
 
     private final Query query;
     private final Tree[] trees;
+    
+    /**
+     * The column values.
+     */
     private final PropertyValue[] values;
+    
+    /**
+     * Whether the value at the given index is used for comparing rows (used
+     * within hashCode and equals). If null, all columns are distinct.
+     */
+    private final boolean[] distinctValues;
+    
+    /**
+     * The values used for ordering.
+     */
     private final PropertyValue[] orderValues;
 
-    ResultRowImpl(Query query, Tree[] trees, PropertyValue[] values, PropertyValue[] orderValues) {
+    ResultRowImpl(Query query, Tree[] trees, PropertyValue[] values, boolean[] distinctValues, PropertyValue[] orderValues) {
         this.query = query;
         this.trees = trees;
         this.values = values;
+        this.distinctValues = distinctValues;
         this.orderValues = orderValues;
     }
     
@@ -137,7 +152,18 @@ public class ResultRowImpl implements ResultRow {
     public int hashCode() {
         int result = 1;
         result = 31 * result + Arrays.hashCode(getPaths());
-        result = 31 * result + Arrays.hashCode(values);
+        result = 31 * result + hashCodeOfValues();
+        return result;
+    }
+    
+    private int hashCodeOfValues() {
+        int result = 1;
+        for (int i = 0; i < values.length; i++) {
+            if (distinctValues == null || distinctValues[i]) {
+                PropertyValue v = values[i];
+                result = 31 * result + (v == null ? 0 : v.hashCode());
+            }
+        }
         return result;
     }
 
@@ -153,9 +179,20 @@ public class ResultRowImpl implements ResultRow {
         ResultRowImpl other = (ResultRowImpl) obj;
         if (!Arrays.equals(getPaths(), other.getPaths())) {
             return false;
-        } else if (!Arrays.equals(values, other.values)) {
+        } else if (!Arrays.equals(distinctValues, other.distinctValues)) {
             return false;
         }
+        // if distinctValues are equals, then the number of values
+        // is also equal
+        for (int i = 0; i < values.length; i++) {
+            if (distinctValues == null || distinctValues[i]) {
+                Object o1 = values[i];
+                Object o2 = other.values[i];
+                if (!(o1 == null ? o2 == null : o1.equals(o2))) {
+                    return false;
+                }
+            }
+        }
         return true;
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/UnionQueryImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/UnionQueryImpl.java
index 5b9f6fc350..c2cd04c549 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/UnionQueryImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/UnionQueryImpl.java
@@ -223,7 +223,7 @@ public class UnionQueryImpl implements Query {
             ResultRowImpl r = new ResultRowImpl(this,
                     Tree.EMPTY_ARRAY,
                     new PropertyValue[] { PropertyValues.newString(plan)},
-                    null);
+                    null, null);
             return Arrays.asList(r).iterator();
         }
         if (LOG.isDebugEnabled()) {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java
index 78f4bc0454..ed806a842d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java
@@ -39,6 +39,10 @@ public class ColumnImpl extends AstElement {
     public String getColumnName() {
         return columnName;
     }
+    
+    public String getPropertyName() {
+        return propertyName;
+    }
 
     @Override
     boolean accept(AstVisitor v) {
