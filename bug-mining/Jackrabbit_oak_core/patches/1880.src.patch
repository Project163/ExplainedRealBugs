diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/AbstractSecurityTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/AbstractSecurityTest.java
index 90c6b496bc..828a08c3b3 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/AbstractSecurityTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/AbstractSecurityTest.java
@@ -70,6 +70,7 @@ import org.jetbrains.annotations.NotNull;
 import org.jetbrains.annotations.Nullable;
 import org.junit.After;
 import org.junit.Before;
+import org.mockito.Mockito;
 
 import static org.apache.jackrabbit.guava.common.collect.Lists.newArrayList;
 
@@ -130,6 +131,11 @@ public abstract class AbstractSecurityTest {
         }
     }
 
+    @After
+    public void clearMocks() {
+        Mockito.framework().clearInlineMocks();
+    }
+
     protected ContentRepository getContentRepository() {
         return contentRepository;
     }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/LoginContextProviderImplTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/LoginContextProviderImplTest.java
index 52198e7049..dc41c3799a 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/LoginContextProviderImplTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/LoginContextProviderImplTest.java
@@ -20,7 +20,10 @@ import java.security.Principal;
 import java.security.PrivilegedAction;
 import java.security.Provider;
 import java.security.Security;
+import java.util.ArrayList;
 import java.util.HashMap;
+import java.util.List;
+
 import javax.jcr.GuestCredentials;
 import javax.jcr.SimpleCredentials;
 import javax.security.auth.Subject;
@@ -42,6 +45,7 @@ import org.apache.jackrabbit.oak.spi.security.authentication.PreAuthContext;
 import org.apache.jackrabbit.oak.spi.whiteboard.DefaultWhiteboard;
 import org.jetbrains.annotations.NotNull;
 import org.jetbrains.annotations.Nullable;
+import org.junit.After;
 import org.junit.Test;
 
 import static org.junit.Assert.assertFalse;
@@ -55,19 +59,28 @@ public class LoginContextProviderImplTest extends AbstractSecurityTest {
 
     private LoginContextProviderImpl lcProvider;
 
+    private final List<String> registeredProviderNames = new ArrayList<>();
+
     @Override
     public void before() throws Exception {
         super.before();
         lcProvider = newLoginContextProviderImpl(ConfigurationParameters.EMPTY);
     }
 
+    @After
+    public void removeSecurityProvider() {
+        for (String name : registeredProviderNames) {
+            Security.removeProvider(name);
+        }
+    }
+
     private LoginContextProviderImpl newLoginContextProviderImpl(ConfigurationParameters params) {
         return new LoginContextProviderImpl(AuthenticationConfiguration.DEFAULT_APP_NAME, params,
                 getContentRepository(), getSecurityProvider(), new DefaultWhiteboard(), LoginModuleMonitor.NOOP);
     }
 
     @NotNull
-    private static String addProvider(boolean enableAppName) throws Exception {
+    private String addProvider(boolean enableAppName) throws Exception {
         Provider.Service service = mock(Provider.Service.class);
         when(service.newInstance(null)).thenReturn(new ConfigurationSpi() {
             @Override
@@ -85,6 +98,7 @@ public class LoginContextProviderImplTest extends AbstractSecurityTest {
         Provider provider = when(mock(Provider.class).getName()).thenReturn(name).getMock();
         when(provider.getService("Configuration", "JavaLoginConfig")).thenReturn(service);
         Security.addProvider(provider);
+        registeredProviderNames.add(name);
         return provider.getName();
     }
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java
index 884d1c9d3b..5dc74c97db 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java
@@ -86,7 +86,6 @@ import static org.mockito.ArgumentMatchers.anyInt;
 import static org.mockito.ArgumentMatchers.anyLong;
 import static org.mockito.ArgumentMatchers.anyString;
 import static org.mockito.ArgumentMatchers.eq;
-import static org.mockito.Mockito.clearInvocations;
 import static org.mockito.Mockito.mock;
 import static org.mockito.Mockito.never;
 import static org.mockito.Mockito.verify;
@@ -106,7 +105,6 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
     @Override
     public void after() throws Exception {
         try {
-            clearInvocations(monitor);
             if (user != null) {
                 user.remove();
                 root.commit();
