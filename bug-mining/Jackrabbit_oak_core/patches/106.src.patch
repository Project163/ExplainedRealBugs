diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/SecurityProviderImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/SecurityProviderImpl.java
index 5e199bf464..6d6487bb54 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/SecurityProviderImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/SecurityProviderImpl.java
@@ -77,6 +77,11 @@ public class SecurityProviderImpl implements SecurityProvider {
             loginConfig = new OakConfiguration();
             Configuration.setConfiguration(loginConfig);
         }
+        if (loginConfig.getAppConfigurationEntry(appName) == null) {
+            log.warn("Failed to retrieve login configuration for {}: using default configuration.", appName);
+            loginConfig = new OakConfiguration();
+            Configuration.setConfiguration(loginConfig);
+        }
         return new LoginContextProviderImpl(appName, loginConfig, nodeStore, this);
     }
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/lucene/LuceneIndexQueryTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/lucene/LuceneIndexQueryTest.java
index c461174663..dea481b9dc 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/lucene/LuceneIndexQueryTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/lucene/LuceneIndexQueryTest.java
@@ -26,7 +26,6 @@ import org.apache.jackrabbit.oak.spi.commit.CommitHook;
 import org.apache.jackrabbit.oak.spi.commit.CompositeHook;
 import org.apache.jackrabbit.oak.spi.query.CompositeQueryIndexProvider;
 import org.apache.jackrabbit.oak.spi.query.QueryIndexProvider;
-import org.apache.jackrabbit.oak.spi.security.OpenSecurityProvider;
 
 /**
  * Tests the query engine using the default index implementation: the
@@ -51,7 +50,7 @@ public class LuceneIndexQueryTest extends AbstractQueryTest implements
                         TEST_INDEX_HOME));
         MicroKernel mk = new MicroKernelImpl();
         createDefaultKernelTracker().available(mk);
-        return new Oak(mk).with(qip).with(ch).with(new OpenSecurityProvider()).createContentRepository();
+        return new Oak(mk).with(qip).with(ch).with(getSecurityProvider()).createContentRepository();
     }
 
 }
\ No newline at end of file
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/old/QueryTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/old/QueryTest.java
index f2779d4f23..bca6834fe9 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/old/QueryTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/old/QueryTest.java
@@ -21,7 +21,6 @@ import org.apache.jackrabbit.oak.query.AbstractQueryTest;
 import org.apache.jackrabbit.oak.spi.commit.CompositeHook;
 import org.apache.jackrabbit.oak.spi.query.CompositeQueryIndexProvider;
 import org.apache.jackrabbit.oak.spi.query.QueryIndexProvider;
-import org.apache.jackrabbit.oak.spi.security.OpenSecurityProvider;
 import org.junit.Ignore;
 import org.junit.Test;
 
@@ -45,7 +44,7 @@ public class QueryTest extends AbstractQueryTest {
         QueryIndexProvider qip = new CompositeQueryIndexProvider(pi);
         CompositeHook hook = new CompositeHook(pi);
         createDefaultKernelTracker().available(mk);
-        return new Oak(mk).with(qip).with(hook).with(new OpenSecurityProvider()).createContentRepository();
+        return new Oak(mk).with(qip).with(hook).with(getSecurityProvider()).createContentRepository();
     }
 
     @Test
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexQueryTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexQueryTest.java
index 7ebcd40f6b..b59a44f4c2 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexQueryTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexQueryTest.java
@@ -25,7 +25,6 @@ import org.apache.jackrabbit.oak.spi.commit.CommitHook;
 import org.apache.jackrabbit.oak.spi.commit.CompositeHook;
 import org.apache.jackrabbit.oak.spi.query.CompositeQueryIndexProvider;
 import org.apache.jackrabbit.oak.spi.query.QueryIndexProvider;
-import org.apache.jackrabbit.oak.spi.security.OpenSecurityProvider;
 
 /**
  * Tests the query engine using the default index implementation: the
@@ -40,7 +39,7 @@ public class PropertyIndexQueryTest extends AbstractQueryTest {
         CommitHook ch = new CompositeHook(new PropertyIndexHook());
         MicroKernel mk = new MicroKernelImpl();
         createDefaultKernelTracker().available(mk);
-        return new Oak(mk).with(qip).with(ch).with(new OpenSecurityProvider()).createContentRepository();
+        return new Oak(mk).with(qip).with(ch).with(getSecurityProvider()).createContentRepository();
     }
 
 }
\ No newline at end of file
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/TraversingIndexQueryTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/TraversingIndexQueryTest.java
index 8584eebdab..71e5526c12 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/TraversingIndexQueryTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/TraversingIndexQueryTest.java
@@ -18,7 +18,6 @@ import org.apache.jackrabbit.mk.core.MicroKernelImpl;
 import org.apache.jackrabbit.oak.Oak;
 import org.apache.jackrabbit.oak.api.ContentRepository;
 import org.apache.jackrabbit.oak.query.AbstractQueryTest;
-import org.apache.jackrabbit.oak.spi.security.OpenSecurityProvider;
 
 /**
  * Tests the query engine using the default index implementation: the
@@ -30,7 +29,7 @@ public class TraversingIndexQueryTest extends AbstractQueryTest {
     protected ContentRepository createRepository() {
         MicroKernel mk = new MicroKernelImpl();
         createDefaultKernelTracker().available(mk);
-        return new Oak(mk).with(new OpenSecurityProvider()).createContentRepository();
+        return new Oak(mk).with(getSecurityProvider()).createContentRepository();
     }
 
 }
