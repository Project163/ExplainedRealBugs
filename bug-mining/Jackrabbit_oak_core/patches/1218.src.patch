diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/CompactionMap.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/CompactionMap.java
index 40e941e09e..4cec21996f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/CompactionMap.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/CompactionMap.java
@@ -85,7 +85,6 @@ public class CompactionMap {
     private long[] afterMsbs = new long[0];
     private long[] afterLsbs = new long[0];
 
-    private long prevWeight;
     private CompactionMap prev;
 
     CompactionMap(int compressInterval, SegmentTracker tracker) {
@@ -433,7 +432,6 @@ public class CompactionMap {
      */
     void merge(CompactionMap prev) {
         this.prev = prev;
-        this.prevWeight = prev.getEstimatedWeight();
     }
 
     public String getCompactionStats() {
@@ -485,8 +483,12 @@ public class CompactionMap {
 
     }
 
-    public long getLastMergeWeight() {
-        return this.prevWeight;
+    /**
+     * The weight of the last generation of the compaction map.
+     * @return  Estimated weight of the last generation of the compaction map.
+     */
+    public long getLastWeight() {
+        return getEstimatedWeight(this);
     }
 
     private static long getEstimatedWeight(CompactionMap cm) {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
index 818277d945..4d12b94e0a 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
@@ -434,7 +434,7 @@ public class FileStore implements SegmentStore {
         long avail = runtime.totalMemory() - runtime.freeMemory();
         long delta = 0;
         if (compactionStrategy.getCompactionMap() != null) {
-            delta = compactionStrategy.getCompactionMap().getLastMergeWeight();
+            delta = compactionStrategy.getCompactionMap().getLastWeight();
         }
         long needed = delta * compactionStrategy.getMemoryThreshold();
         if (needed >= avail) {
