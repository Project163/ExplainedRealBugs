diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DiffCache.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DiffCache.java
index 23479a7960..edcee29518 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DiffCache.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DiffCache.java
@@ -74,8 +74,11 @@ public interface DiffCache {
         /**
          * Called when all changes have been appended and the entry is ready
          * to be used by the cache.
+         * 
+         * @return {@code true} if the entry was successfully added to the
+         *          cache, {@code false} otherwise.
          */
-        void done();
+        boolean done();
     }
 
     public interface Loader {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/MemoryDiffCache.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/MemoryDiffCache.java
index 798e5ef0ae..0bdb180692 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/MemoryDiffCache.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/MemoryDiffCache.java
@@ -104,7 +104,8 @@ public class MemoryDiffCache implements DiffCache {
         }
 
         @Override
-        public void done() {
+        public boolean done() {
+            return true;
         }
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/MongoDiffCache.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/MongoDiffCache.java
index 9627c331f8..184a3e16ee 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/MongoDiffCache.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/MongoDiffCache.java
@@ -115,12 +115,17 @@ public class MongoDiffCache extends MemoryDiffCache {
             }
 
             @Override
-            public void done() {
+            public boolean done() {
                 try {
-                    changes.insert(commit.doc, WriteConcern.UNACKNOWLEDGED);
+                    // do not write back if doc is too big
+                    if (commit.size < 16 * 1024 * 1024) {
+                        changes.insert(commit.doc, WriteConcern.UNACKNOWLEDGED);
+                        return true;
+                    }
                 } catch (MongoException e) {
                     LOG.warn("Write back of diff cache entry failed", e);
                 }
+                return false;
             }
         };
     }
@@ -182,6 +187,7 @@ public class MongoDiffCache extends MemoryDiffCache {
     static class Diff {
 
         private final DBObject doc;
+        private long size;
 
         Diff(Revision from, Revision to) {
             this.doc = new BasicDBObject();
@@ -203,9 +209,11 @@ public class MongoDiffCache extends MemoryDiffCache {
                     BasicDBObject child = new BasicDBObject();
                     current.put(escName, child);
                     current = child;
+                    size += escName.length() * 2 + 8;
                 }
             }
             current.put("_c", checkNotNull(changes));
+            size += 4 + changes.length() * 2 + 8;
         }
 
         String getChanges(String path) {
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/AmnesiaDiffCache.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/AmnesiaDiffCache.java
index 7fe0d06ef5..5cacaf94cc 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/AmnesiaDiffCache.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/AmnesiaDiffCache.java
@@ -50,7 +50,8 @@ class AmnesiaDiffCache implements DiffCache {
             }
 
             @Override
-            public void done() {
+            public boolean done() {
+                return false;
             }
         };
     }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/mongo/MongoDiffCacheTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/mongo/MongoDiffCacheTest.java
index bd38546390..b5e5f937a7 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/mongo/MongoDiffCacheTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/mongo/MongoDiffCacheTest.java
@@ -19,11 +19,21 @@ package org.apache.jackrabbit.oak.plugins.document.mongo;
 import java.util.Arrays;
 import java.util.List;
 
+import com.mongodb.DB;
+
+import org.apache.jackrabbit.oak.plugins.document.DiffCache;
+import org.apache.jackrabbit.oak.plugins.document.DocumentMK;
+import org.apache.jackrabbit.oak.plugins.document.DocumentStore;
 import org.apache.jackrabbit.oak.plugins.document.Revision;
 import org.junit.Test;
 
+import static org.apache.jackrabbit.oak.plugins.document.Collection.NODES;
+import static org.apache.jackrabbit.oak.plugins.document.DocumentStoreFixture.MONGO;
 import static org.apache.jackrabbit.oak.plugins.document.mongo.MongoDiffCache.Diff;
 import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertTrue;
+import static org.junit.Assume.assumeTrue;
 
 /**
  * Tests for the MongoDiffCache.
@@ -67,6 +77,29 @@ public class MongoDiffCacheTest {
         assertEquals("^", doMerge("^", "-", "+", "^"));
     }
 
+    @Test
+    public void sizeLimit() {
+        assumeTrue(MONGO.isAvailable());
+        DocumentStore store = MONGO.createDocumentStore();
+        assertTrue(store instanceof MongoDocumentStore);
+        DB db = ((MongoDocumentStore) store).getDBCollection(NODES).getDB();
+        
+        MongoDiffCache diffCache = new MongoDiffCache(db, 32, new DocumentMK.Builder());
+        DiffCache.Entry entry = diffCache.newEntry(
+                new Revision(1, 0, 1), new Revision(2, 0, 1));
+        for (int i = 0; i < 100; i++) {
+            for (int j = 0; j < 100; j++) {
+                for (int k = 0; k < 64; k++) {
+                    entry.append("/node-" + i + "/node-" + j + "/node-" + k, 
+                            "^\"foo\":{}");
+                }
+            }
+        }
+        assertFalse(entry.done());
+        
+        store.dispose();
+    }
+
     private String doMerge(String... ops) {
         List<String> opsList = Arrays.asList(ops);
         Diff diff = null;
