diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserManagerImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserManagerImpl.java
index ff34e63fa0..c954c0ce46 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserManagerImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserManagerImpl.java
@@ -288,7 +288,7 @@ public class UserManagerImpl implements UserManager {
         if (tree == null || !tree.exists()) {
             return null;
         }
-        return getAuthorizable(userProvider.getAuthorizableId(tree), tree);
+        return getAuthorizable(UserUtil.getAuthorizableId(tree), tree);
     }
 
     @Nonnull
@@ -325,9 +325,9 @@ public class UserManagerImpl implements UserManager {
             return null;
         }
         if (UserUtil.isType(tree, AuthorizableType.USER)) {
-            return new UserImpl(userProvider.getAuthorizableId(tree), tree, this);
+            return new UserImpl(UserUtil.getAuthorizableId(tree), tree, this);
         } else if (UserUtil.isType(tree, AuthorizableType.GROUP)) {
-            return new GroupImpl(userProvider.getAuthorizableId(tree), tree, this);
+            return new GroupImpl(UserUtil.getAuthorizableId(tree), tree, this);
         } else {
             throw new RepositoryException("Not a user or group tree " + tree.getPath() + '.');
         }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserProvider.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserProvider.java
index 4152bd42c5..410e439541 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserProvider.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserProvider.java
@@ -28,7 +28,6 @@ import javax.jcr.nodetype.ConstraintViolationException;
 import javax.jcr.query.Query;
 
 import org.apache.jackrabbit.JcrConstants;
-import org.apache.jackrabbit.oak.api.PropertyState;
 import org.apache.jackrabbit.oak.api.Result;
 import org.apache.jackrabbit.oak.api.ResultRow;
 import org.apache.jackrabbit.oak.api.Root;
@@ -40,14 +39,12 @@ import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
 import org.apache.jackrabbit.oak.spi.security.user.AuthorizableNodeName;
 import org.apache.jackrabbit.oak.spi.security.user.AuthorizableType;
 import org.apache.jackrabbit.oak.spi.security.user.UserConstants;
-import org.apache.jackrabbit.oak.spi.security.user.util.UserUtil;
 import org.apache.jackrabbit.oak.util.NodeUtil;
 import org.apache.jackrabbit.util.Text;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
 import static com.google.common.base.Preconditions.checkNotNull;
-import static org.apache.jackrabbit.oak.api.Type.STRING;
 
 /**
  * User provider implementation and manager for group memberships with the
@@ -228,20 +225,6 @@ class UserProvider extends AuthorizableBaseProvider {
         return null;
     }
 
-    @CheckForNull
-    static String getAuthorizableId(@Nonnull Tree authorizableTree) {
-        checkNotNull(authorizableTree);
-        if (UserUtil.isType(authorizableTree, AuthorizableType.AUTHORIZABLE)) {
-            PropertyState idProp = authorizableTree.getProperty(UserConstants.REP_AUTHORIZABLE_ID);
-            if (idProp != null) {
-                return idProp.getValue(STRING);
-            } else {
-                return Text.unescapeIllegalJcrChars(authorizableTree.getName());
-            }
-        }
-        return null;
-    }
-
     //------------------------------------------------------------< private >---
 
     private Tree createAuthorizableNode(String authorizableId, boolean isGroup, String intermediatePath) throws RepositoryException {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserValidator.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserValidator.java
index f4c736cb0a..8669cb6b9c 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserValidator.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserValidator.java
@@ -166,7 +166,7 @@ class UserValidator extends DefaultValidator implements UserConstants {
 
     private boolean isAdminUser(@Nonnull Tree userTree) {
         if (userTree.exists() && isUser(userTree)) {
-            String id = UserProvider.getAuthorizableId(userTree);
+            String id = UserUtil.getAuthorizableId(userTree);
             return UserUtil.getAdminId(provider.getConfig()).equals(id);
         } else {
             return false;
@@ -178,7 +178,7 @@ class UserValidator extends DefaultValidator implements UserConstants {
     }
 
     private static boolean isValidUUID(@Nonnull Tree parent, @Nonnull String uuid) {
-        String id = UserProvider.getAuthorizableId(parent);
+        String id = UserUtil.getAuthorizableId(parent);
         return id != null && uuid.equals(UserProvider.getContentID(id));
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/ResultRowToAuthorizable.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/ResultRowToAuthorizable.java
index dc419fd555..ff2f6e4ea3 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/ResultRowToAuthorizable.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/ResultRowToAuthorizable.java
@@ -71,7 +71,10 @@ class ResultRowToAuthorizable implements Function<ResultRow, Authorizable> {
                 type = UserUtil.getType(tree);
             }
             if (tree.exists() && (targetType == null || targetType == type)) {
-                authorizable = userManager.getAuthorizableByPath(tree.getPath());
+                String id = UserUtil.getAuthorizableId(tree);
+                if (id != null) {
+                    authorizable = userManager.getAuthorizable(id);
+                }
             }
         } catch (RepositoryException e) {
             log.debug("Failed to access authorizable " + resultPath);
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/UserQueryManager.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/UserQueryManager.java
index 9c1f643973..176b4984cb 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/UserQueryManager.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/UserQueryManager.java
@@ -156,8 +156,9 @@ public class UserQueryManager {
      * @throws javax.jcr.RepositoryException If an error occurs.
      */
     @Nonnull
-    public Iterator<Authorizable> findAuthorizables(String relPath, String value,
-                                                    AuthorizableType authorizableType) throws RepositoryException {
+    public Iterator<Authorizable> findAuthorizables(@Nonnull String relPath,
+                                                    @Nullable String value,
+                                                    @Nonnull AuthorizableType authorizableType) throws RepositoryException {
         return findAuthorizables(relPath, value, authorizableType, true);
     }
 
@@ -180,17 +181,21 @@ public class UserQueryManager {
      * @throws javax.jcr.RepositoryException If an error occurs.
      */
     @Nonnull
-    public Iterator<Authorizable> findAuthorizables(String relPath, String value,
-                                                    AuthorizableType authorizableType, boolean exact) throws RepositoryException {
+    public Iterator<Authorizable> findAuthorizables(@Nonnull String relPath,
+                                                    @Nullable String value,
+                                                    @Nonnull AuthorizableType authorizableType,
+                                                    boolean exact) throws RepositoryException {
         String statement = buildXPathStatement(relPath, value, authorizableType, exact);
         return findAuthorizables(statement, Long.MAX_VALUE, 0, authorizableType);
     }
 
     //------------------------------------------------------------< private >---
     @Nonnull
-    private String buildXPathStatement(String relPath, String value, AuthorizableType type, boolean exact) {
+    private String buildXPathStatement(@Nonnull String relPath,
+                                       @Nullable String value,
+                                       @Nonnull AuthorizableType type, boolean exact) {
         StringBuilder stmt = new StringBuilder();
-        String searchRoot = QueryUtil.getSearchRoot(type, config);
+        String searchRoot = namePathMapper.getJcrPath(QueryUtil.getSearchRoot(type, config));
         if (!"/".equals(searchRoot)) {
             stmt.append(searchRoot);
         }
@@ -216,7 +221,7 @@ public class UserQueryManager {
                 }
             }
             path = Strings.emptyToNull(sb.toString());
-            ntName = QueryUtil.getNodeTypeName(type);
+            ntName = namePathMapper.getJcrName(QueryUtil.getNodeTypeName(type));
         }
 
         stmt.append("//");
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/util/UserUtil.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/util/UserUtil.java
index 3abe59a91e..6874e41c57 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/util/UserUtil.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/util/UserUtil.java
@@ -20,6 +20,7 @@ import javax.annotation.CheckForNull;
 import javax.annotation.Nonnull;
 import javax.annotation.Nullable;
 
+import org.apache.jackrabbit.oak.api.PropertyState;
 import org.apache.jackrabbit.oak.api.Tree;
 import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
 import org.apache.jackrabbit.oak.spi.security.user.AuthorizableType;
@@ -27,6 +28,9 @@ import org.apache.jackrabbit.oak.spi.security.user.UserConstants;
 import org.apache.jackrabbit.oak.util.TreeUtil;
 import org.apache.jackrabbit.util.Text;
 
+import static com.google.common.base.Preconditions.checkNotNull;
+import static org.apache.jackrabbit.oak.api.Type.STRING;
+
 /**
  * Utility methods for user management.
  */
@@ -94,4 +98,18 @@ public final class UserUtil implements UserConstants {
         }
         return path;
     }
+
+    @CheckForNull
+    public static String getAuthorizableId(@Nonnull Tree authorizableTree) {
+        checkNotNull(authorizableTree);
+        if (UserUtil.isType(authorizableTree, AuthorizableType.AUTHORIZABLE)) {
+            PropertyState idProp = authorizableTree.getProperty(UserConstants.REP_AUTHORIZABLE_ID);
+            if (idProp != null) {
+                return idProp.getValue(STRING);
+            } else {
+                return Text.unescapeIllegalJcrChars(authorizableTree.getName());
+            }
+        }
+        return null;
+    }
 }
\ No newline at end of file
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/UserProviderTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/UserProviderTest.java
index 49e3e2081a..c69dc46ec3 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/UserProviderTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/UserProviderTest.java
@@ -29,6 +29,7 @@ import org.apache.jackrabbit.oak.plugins.nodetype.write.InitialContent;
 import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
 import org.apache.jackrabbit.oak.spi.security.OpenSecurityProvider;
 import org.apache.jackrabbit.oak.spi.security.user.UserConstants;
+import org.apache.jackrabbit.oak.spi.security.user.util.UserUtil;
 import org.apache.jackrabbit.util.Text;
 import org.junit.After;
 import org.junit.Before;
@@ -224,7 +225,7 @@ public class UserProviderTest {
             root.commit();
 
             assertEquals(defaultUserPath + m.get(uid), user.getPath());
-            assertEquals(uid, userProvider.getAuthorizableId(user));
+            assertEquals(uid, UserUtil.getAuthorizableId(user));
 
             Tree ath = userProvider.getAuthorizable(uid);
             assertNotNull("Tree with id " + uid + " must exist.", ath);
@@ -272,11 +273,11 @@ public class UserProviderTest {
 
         String userID = "Amanda";
         Tree user = up.createUser(userID, null);
-        assertEquals(userID, up.getAuthorizableId(user));
+        assertEquals(userID, UserUtil.getAuthorizableId(user));
 
         String groupID = "visitors";
         Tree group = up.createGroup(groupID, null);
-        assertEquals(groupID, up.getAuthorizableId(group));
+        assertEquals(groupID, UserUtil.getAuthorizableId(group));
     }
 
     @Test
