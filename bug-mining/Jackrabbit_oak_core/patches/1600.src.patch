diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/osgi/ObserverTracker.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/osgi/ObserverTracker.java
index cf3dfbfb56..90908d1060 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/osgi/ObserverTracker.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/osgi/ObserverTracker.java
@@ -22,13 +22,13 @@ package org.apache.jackrabbit.oak.osgi;
 import static com.google.common.base.Preconditions.checkNotNull;
 import static com.google.common.base.Preconditions.checkState;
 import static com.google.common.collect.Maps.newHashMap;
+import static org.apache.jackrabbit.oak.commons.IOUtils.closeQuietly;
 
 import java.io.Closeable;
 import java.util.Map;
 
 import javax.annotation.Nonnull;
 
-import com.google.common.io.Closeables;
 import org.apache.jackrabbit.oak.spi.commit.Observable;
 import org.apache.jackrabbit.oak.spi.commit.Observer;
 import org.osgi.framework.BundleContext;
@@ -82,7 +82,7 @@ public class ObserverTracker implements ServiceTrackerCustomizer {
     public void removedService(ServiceReference reference, Object service) {
         Closeable subscription = subscriptions.remove(reference);
         if (subscription != null) {
-            Closeables.closeQuietly(subscription);
+            closeQuietly(subscription);
             bundleContext.ungetService(reference);
         }
     }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/AbstractBlob.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/AbstractBlob.java
index 1489f782d8..bac22b06bc 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/AbstractBlob.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/AbstractBlob.java
@@ -26,8 +26,7 @@ import javax.annotation.Nonnull;
 
 import com.google.common.hash.HashCode;
 import com.google.common.hash.Hashing;
-import com.google.common.io.ByteStreams;
-import com.google.common.io.InputSupplier;
+import com.google.common.io.ByteSource;
 
 import org.apache.jackrabbit.oak.api.Blob;
 
@@ -38,10 +37,10 @@ import org.apache.jackrabbit.oak.api.Blob;
  */
 public abstract class AbstractBlob implements Blob {
 
-    private static InputSupplier<InputStream> supplier(final Blob blob) {
-        return new InputSupplier<InputStream>() {
+    private static ByteSource supplier(final Blob blob) {
+        return new ByteSource() {
             @Override
-            public InputStream getInput() throws IOException {
+            public InputStream openStream() throws IOException {
                 return blob.getNewStream();
             }
         };
@@ -65,7 +64,7 @@ public abstract class AbstractBlob implements Blob {
         }
 
         try {
-            return ByteStreams.equal(supplier(a), supplier(b));
+            return supplier(a).contentEquals(supplier(b));
         } catch (IOException e) {
             throw new IllegalStateException("Blob equality check failed", e);
         }
@@ -105,7 +104,7 @@ public abstract class AbstractBlob implements Blob {
         // Blobs are immutable so we can safely cache the hash
         if (hashCode == null) {
             try {
-                hashCode = ByteStreams.hash(supplier(this), Hashing.sha256());
+                hashCode = supplier(this).hash(Hashing.sha256());
             } catch (IOException e) {
                 throw new IllegalStateException("Hash calculation failed", e);
             }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/CompositeDataStoreCacheTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/CompositeDataStoreCacheTest.java
index ecb9dfa751..0b655ccb51 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/CompositeDataStoreCacheTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/CompositeDataStoreCacheTest.java
@@ -19,7 +19,6 @@
 package org.apache.jackrabbit.oak.plugins.blob;
 
 import java.io.File;
-import java.io.FileInputStream;
 import java.io.IOException;
 import java.io.InputStream;
 import java.util.concurrent.CountDownLatch;
@@ -506,7 +505,7 @@ public class CompositeDataStoreCacheTest extends AbstractDataStoreCacheTest {
         // Get a handle to the file and open stream
         File fileOnUpload = cache.getIfPresent(ID_PREFIX + 0);
         assertNotNull(fileOnUpload);
-        final FileInputStream fStream = Files.newInputStreamSupplier(fileOnUpload).getInput();
+        final InputStream fStream = Files.asByteSource(fileOnUpload).openStream();
 
         thread1Start.countDown();
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/UploadStagingCacheTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/UploadStagingCacheTest.java
index c83fcc712c..671e655c78 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/UploadStagingCacheTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/UploadStagingCacheTest.java
@@ -19,7 +19,6 @@
 package org.apache.jackrabbit.oak.plugins.blob;
 
 import java.io.File;
-import java.io.FileInputStream;
 import java.io.IOException;
 import java.io.InputStream;
 import java.util.Iterator;
@@ -431,7 +430,7 @@ public class UploadStagingCacheTest extends AbstractDataStoreCacheTest {
 
         // Get a handle to the file and open stream
         File file = stagingCache.getIfPresent(ID_PREFIX + 0);
-        final FileInputStream fStream = Files.newInputStreamSupplier(file).getInput();
+        final InputStream fStream = Files.asByteSource(file).openStream();
 
         // task to copy the steam to a file simulating read from the stream
         File temp = folder.newFile();
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/DocumentMKCommitAddTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/DocumentMKCommitAddTest.java
index 4a47c21e8f..9f56574be6 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/DocumentMKCommitAddTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/DocumentMKCommitAddTest.java
@@ -203,7 +203,7 @@ public class DocumentMKCommitAddTest extends BaseDocumentMKTest {
     @Ignore("OAK-461")
     public void commitTime() throws Exception {
         boolean debug = false;
-        final Stopwatch watch = new Stopwatch();
+        final Stopwatch watch = Stopwatch.createUnstarted();
         for (int i = 0; i < 1000; i++) {
             watch.start();
             String diff = "+\"a"+i+"\" : {} +\"b"+i+"\" : {} +\"c"+i+"\" : {}";
