diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelRootBuilder.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelRootBuilder.java
index c7da53602c..440e47b99e 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelRootBuilder.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelRootBuilder.java
@@ -145,7 +145,19 @@ class KernelRootBuilder extends MemoryNodeBuilder implements FastCopyMove {
      */
     NodeState merge(CommitHook hook, CommitInfo info) throws CommitFailedException {
         purge();
-        branch.merge(hook, info);
+        boolean success = false;
+        try {
+            branch.merge(hook, info);
+            success = true;
+        } finally {
+            if (!success) {
+                // need to adjust base and head of this builder
+                // in case branch.merge() did a rebase and then
+                // a commit hook failed the merge
+                super.reset(branch.getHead());
+                this.base = branch.getBase();
+            }
+        }
         return reset();
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/mongomk/MongoRootBuilder.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/mongomk/MongoRootBuilder.java
index f4ac698761..268f3df42e 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/mongomk/MongoRootBuilder.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/mongomk/MongoRootBuilder.java
@@ -142,7 +142,19 @@ class MongoRootBuilder extends MemoryNodeBuilder {
      */
     NodeState merge(CommitHook hook, CommitInfo info) throws CommitFailedException {
         purge();
-        branch.merge(hook, info);
+        boolean success = false;
+        try {
+            branch.merge(hook, info);
+            success = true;
+        } finally {
+            if (!success) {
+                // need to adjust base and head of this builder
+                // in case branch.merge() did a rebase and then
+                // a commit hook failed the merge
+                super.reset(branch.getHead());
+                this.base = branch.getBase();
+            }
+        }
         return reset();
     }
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/kernel/NodeStoreTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/kernel/NodeStoreTest.java
index 1a79758563..7d05e5227e 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/kernel/NodeStoreTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/kernel/NodeStoreTest.java
@@ -19,11 +19,12 @@
 package org.apache.jackrabbit.oak.kernel;
 
 import static com.google.common.base.Preconditions.checkNotNull;
-import static junit.framework.Assert.assertFalse;
 import static org.apache.jackrabbit.oak.api.Type.LONG;
 import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertNotNull;
 import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.fail;
 import static org.junit.runners.Parameterized.Parameters;
 
 import java.util.ArrayList;
@@ -446,6 +447,34 @@ public class NodeStoreTest {
         compareAgainstBaseState(KernelNodeState.MAX_CHILD_NODE_NAMES);
     }
 
+    @Test // OAK-1320
+    public void rebaseWithFailedMerge() throws CommitFailedException {
+        NodeBuilder rootBuilder = store.getRoot().builder();
+        rootBuilder.child("foo");
+
+        // commit something in between to force rebase
+        NodeBuilder b = store.getRoot().builder();
+        b.child("bar");
+        store.merge(b, EmptyHook.INSTANCE, null);
+
+        try {
+            store.merge(rootBuilder, new CommitHook() {
+                @Nonnull
+                @Override
+                public NodeState processCommit(NodeState before, NodeState after)
+                        throws CommitFailedException {
+                    throw new CommitFailedException("", 0, "commit rejected");
+                }
+            }, null);
+            fail("must throw CommitFailedException");
+        } catch (CommitFailedException e) {
+            // expected
+        }
+        // merge again
+        NodeState root = store.merge(rootBuilder, EmptyHook.INSTANCE, null);
+        assertTrue(root.hasChildNode("bar"));
+    }
+
     private void compareAgainstBaseState(int childNodeCount) throws CommitFailedException {
         NodeState before = store.getRoot();
         NodeBuilder builder = before.builder();
