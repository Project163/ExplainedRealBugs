diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
index 65ed332c9e..a8a5cadec4 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
@@ -1033,7 +1033,23 @@ public class QueryImpl implements Query {
                 bestPlan = indexPlan;
             }
         }
-        if (bestIndex == null) {
+        boolean potentiallySlowTraversalQuery = bestIndex == null;
+        if (traversalEnabled) {
+            TraversingIndex traversal = new TraversingIndex();
+            double cost = traversal.getCost(filter, rootState);
+            if (LOG.isDebugEnabled()) {
+                logDebug("cost for " + traversal.getIndexName() + " is " + cost);
+            }
+            if (cost < bestCost || bestCost == Double.POSITIVE_INFINITY) {
+                bestCost = cost;
+                bestPlan = null;
+                bestIndex = traversal;
+                if (potentiallySlowTraversalQuery) {
+                    potentiallySlowTraversalQuery = traversal.isPotentiallySlow(filter, rootState);
+                }
+            }
+        }
+        if (potentiallySlowTraversalQuery) {
             QueryOptions.Traversal traversal = queryOptions.traversal;
             if (traversal == Traversal.DEFAULT) {
                 // use the (configured) default
@@ -1054,18 +1070,6 @@ public class QueryImpl implements Query {
                 throw new IllegalArgumentException(message);
             }
         }
-        if (traversalEnabled) {
-            QueryIndex traversal = new TraversingIndex();
-            double cost = traversal.getCost(filter, rootState);
-            if (LOG.isDebugEnabled()) {
-                logDebug("cost for " + traversal.getIndexName() + " is " + cost);
-            }
-            if (cost < bestCost || bestCost == Double.POSITIVE_INFINITY) {
-                bestCost = cost;
-                bestPlan = null;
-                bestIndex = traversal;
-            }
-        }
         return new SelectorExecutionPlan(filter.getSelector(), bestIndex, bestPlan, bestCost);
     }
     
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/TraversingIndex.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/TraversingIndex.java
index e09ae969ff..b49625e376 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/TraversingIndex.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/TraversingIndex.java
@@ -42,6 +42,32 @@ public class TraversingIndex implements QueryIndex {
     public Cursor query(Filter filter, NodeState rootState) {
         return Cursors.newTraversingCursor(filter, rootState);
     }
+    
+    public boolean isPotentiallySlow(Filter filter, NodeState rootState) {
+        if (filter.getFullTextConstraint() != null) {
+            // not an appropriate index for full-text search
+            return true;
+        }
+        if (filter.containsNativeConstraint()) {
+            // not an appropriate index for native search
+            return true;
+        }
+        if (filter.isAlwaysFalse()) {
+            return false;
+        }
+        PathRestriction restriction = filter.getPathRestriction();
+        switch (restriction) {
+        case EXACT:
+        case PARENT:
+        case DIRECT_CHILDREN:
+            return false;
+        case NO_RESTRICTION:
+        case ALL_CHILDREN:
+            return true;
+        default:
+            throw new IllegalArgumentException("Unknown restriction: " + restriction);
+        }
+    }
 
     @Override
     public double getCost(Filter filter, NodeState rootState) {
