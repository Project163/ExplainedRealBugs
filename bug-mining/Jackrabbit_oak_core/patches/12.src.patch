diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/CoreValue.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/CoreValue.java
index 11f5498c43..9ebcfeab9e 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/CoreValue.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/CoreValue.java
@@ -22,7 +22,7 @@ import java.math.BigDecimal;
 /**
  * CoreValue... TODO: add description and javadoc for methods
  */
-public interface CoreValue {
+public interface CoreValue extends Comparable<CoreValue> {
 
     int getType();
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/QueryEngine.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/QueryEngine.java
index ca435bedf4..10e163148b 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/QueryEngine.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/QueryEngine.java
@@ -19,7 +19,6 @@ package org.apache.jackrabbit.oak.api;
 import java.text.ParseException;
 import java.util.List;
 import java.util.Map;
-import org.apache.jackrabbit.oak.query.CoreValue;
 
 /**
  * The query engine allows to parse and execute queries.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/ResultRow.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/ResultRow.java
index aae1869b55..764a9b147b 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/ResultRow.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/ResultRow.java
@@ -1,7 +1,5 @@
 package org.apache.jackrabbit.oak.api;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
-
 /**
  * A query result row.
  */
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/CoreValueFactoryImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/CoreValueFactoryImpl.java
index 233226a480..1ba3c3514d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/CoreValueFactoryImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/CoreValueFactoryImpl.java
@@ -38,7 +38,8 @@ public class CoreValueFactoryImpl implements CoreValueFactory {
 
     private final MicroKernel mk;
 
-    CoreValueFactoryImpl(MicroKernel mk) {
+    // TODO: currently public for query tests -> see todo there...
+    public CoreValueFactoryImpl(MicroKernel mk) {
         this.mk = mk;
     }
 
@@ -76,8 +77,12 @@ public class CoreValueFactoryImpl implements CoreValueFactory {
 
     @Override
     public CoreValue createValue(String value, int type) {
-        return new CoreValueImpl(value, type);
+        // TODO check again...
+        if (type == PropertyType.BINARY) {
+            BinaryValue bv = new BinaryValue(value, mk);
+            return new CoreValueImpl(bv);
+        } else {
+            return new CoreValueImpl(value, type);
+        }
     }
-
-
 }
\ No newline at end of file
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/CoreValueImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/CoreValueImpl.java
index b9bb9db263..bd00d9232b 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/CoreValueImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/CoreValueImpl.java
@@ -29,7 +29,7 @@ import java.math.BigDecimal;
 /**
  * CoreValueImpl... TODO: javadoc
  */
-class CoreValueImpl implements CoreValue, Comparable<CoreValue>{
+class CoreValueImpl implements CoreValue {
 
     /**
      * logger instance
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/KernelContentRepository.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/KernelContentRepository.java
index 6026069ba2..ff422e7bb7 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/KernelContentRepository.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/KernelContentRepository.java
@@ -87,15 +87,15 @@ public class KernelContentRepository implements ContentRepository {
             throw new LoginException("login failed");
         }
 
-        QueryEngine queryEngine = new QueryEngineImpl(microKernel);
+        CoreValueFactory valueFactory = new CoreValueFactoryImpl(microKernel);
+
+        QueryEngine queryEngine = new QueryEngineImpl(microKernel, valueFactory);
         // TODO set revision!?
         NodeState wspRoot = nodeStore.getRoot().getChildNode(workspaceName);
         if (wspRoot == null) {
             throw new NoSuchWorkspaceException(workspaceName);
         }
 
-        CoreValueFactory valueFactory = new CoreValueFactoryImpl(microKernel);
-
         return new KernelContentSession(
                 sc, workspaceName, nodeStore, wspRoot, queryEngine, valueFactory);
     }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/CoreValue.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/CoreValue.java
deleted file mode 100644
index 45d3a0333d..0000000000
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/CoreValue.java
+++ /dev/null
@@ -1,127 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.oak.query;
-
-import java.math.BigDecimal;
-
-public class CoreValue implements Comparable<CoreValue> {
-
-    public static final int UNDEFINED = 0;
-    public static final int STRING = 1;
-    public static final int BINARY = 2;
-    public static final int LONG = 3;
-    public static final int DOUBLE = 4;
-    public static final int DATE = 5;
-    public static final int BOOLEAN = 6;
-    public static final int NAME = 7;
-    public static final int PATH = 8;
-    public static final int REFERENCE = 9;
-    public static final int WEAKREFERENCE = 10;
-    public static final int URI = 11;
-    public static final int DECIMAL = 12;
-
-    private final Object value;
-    private final int type;
-
-    public CoreValue(Object value, int type) {
-        this.value = value;
-        this.type = type;
-    }
-
-    public String getString() {
-        return value.toString();
-    }
-
-    public int getType() {
-        return type;
-    }
-
-    public long getLong() {
-        // TODO convert?
-        return ((Long) value).longValue();
-    }
-
-    public double getDouble() {
-        // TODO convert?
-        return ((Double) value).doubleValue();
-    }
-
-    public boolean getBoolean() {
-        // TODO convert?
-        return ((Boolean) value).booleanValue();
-    }
-
-    public BigDecimal getDecimal() {
-        // TODO convert?
-        return (BigDecimal) value;
-    }
-
-    public String getBinary() {
-        // TODO convert?
-        return value.toString();
-    }
-
-    public String getDate() {
-        // TODO convert?
-        return value.toString();
-    }
-
-    @Override
-    public int hashCode() {
-        return type ^ value.hashCode();
-    }
-
-    @Override
-    public boolean equals(Object o) {
-        if (this == o) {
-            return true;
-        }
-        if (!(o instanceof CoreValue)) {
-            return false;
-        }
-        CoreValue v = (CoreValue) o;
-        return type == v.type && value.equals(v.value);
-    }
-
-    @Override
-    public int compareTo(CoreValue o) {
-        if (this == o) {
-            return 0;
-        }
-        if (type != o.type) {
-            // TODO convert?
-            return type - o.type;
-        }
-        switch (type) {
-        case LONG:
-            return ((Long) value).compareTo((Long) o.value);
-        case DOUBLE:
-            return ((Double) value).compareTo((Double) o.value);
-        case DECIMAL:
-            return ((BigDecimal) value).compareTo((BigDecimal) o.value);
-        case BOOLEAN:
-            return ((Boolean) value).compareTo((Boolean) o.value);
-        }
-        return value.toString().compareTo(o.toString());
-    }
-
-    @Override
-    public String toString() {
-        return getString();
-    }
-
-}
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
index e09bdc3344..838591af99 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
@@ -20,6 +20,8 @@ import java.util.HashMap;
 import java.util.Iterator;
 import java.util.List;
 import org.apache.jackrabbit.mk.api.MicroKernel;
+import org.apache.jackrabbit.oak.api.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValueFactory;
 import org.apache.jackrabbit.oak.query.ast.AstVisitorBase;
 import org.apache.jackrabbit.oak.query.ast.BindVariableValueImpl;
 import org.apache.jackrabbit.oak.query.ast.ChildNodeImpl;
@@ -63,14 +65,15 @@ public class Query {
     private long limit;
     private long offset;
     private boolean prepared;
-    private final CoreValueFactory valueFactory = new CoreValueFactory();
+    private final CoreValueFactory valueFactory;
 
     Query(SourceImpl source, ConstraintImpl constraint, OrderingImpl[] orderings,
-            ColumnImpl[] columns) {
+          ColumnImpl[] columns, CoreValueFactory valueFactory) {
         this.source = source;
         this.constraint = constraint;
         this.orderings = orderings;
         this.columns = columns;
+        this.valueFactory = valueFactory;
     }
 
     public void init() {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryEngineImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryEngineImpl.java
index 5cb3590090..90dcf51206 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryEngineImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryEngineImpl.java
@@ -21,6 +21,8 @@ import java.util.List;
 import java.util.Map;
 import java.util.Map.Entry;
 import org.apache.jackrabbit.mk.api.MicroKernel;
+import org.apache.jackrabbit.oak.api.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValueFactory;
 import org.apache.jackrabbit.oak.api.QueryEngine;
 
 public class QueryEngineImpl implements QueryEngine {
@@ -29,11 +31,12 @@ public class QueryEngineImpl implements QueryEngine {
     private static final String XPATH = "xpath";
 
     private final MicroKernel mk;
-    private final CoreValueFactory vf = new CoreValueFactory();
+    private final CoreValueFactory vf;
     private final SQL2Parser parserSQL2;
 
-    public QueryEngineImpl(MicroKernel mk) {
+    public QueryEngineImpl(MicroKernel mk, CoreValueFactory valueFactory) {
         this.mk = mk;
+        this.vf = valueFactory;
         parserSQL2 = new SQL2Parser(vf);
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java
index bd4f6a4856..35985df60f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java
@@ -16,6 +16,7 @@
  */
 package org.apache.jackrabbit.oak.query;
 
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.api.ResultRow;
 import org.apache.jackrabbit.oak.query.ast.ColumnImpl;
 import org.apache.jackrabbit.oak.query.ast.SelectorImpl;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
index ec400da3fb..d011a143b6 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
@@ -16,6 +16,8 @@
  */
 package org.apache.jackrabbit.oak.query;
 
+import org.apache.jackrabbit.oak.api.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValueFactory;
 import org.apache.jackrabbit.oak.query.ast.AstElementFactory;
 import org.apache.jackrabbit.oak.query.ast.Operator;
 import org.apache.jackrabbit.oak.query.ast.BindVariableValueImpl;
@@ -32,6 +34,7 @@ import org.apache.jackrabbit.oak.query.ast.SelectorImpl;
 import org.apache.jackrabbit.oak.query.ast.SourceImpl;
 import org.apache.jackrabbit.oak.query.ast.StaticOperandImpl;
 
+import javax.jcr.PropertyType;
 import java.math.BigDecimal;
 import java.text.ParseException;
 import java.util.ArrayList;
@@ -117,7 +120,7 @@ public class SQL2Parser {
         if (!currentToken.isEmpty()) {
             throw getSyntaxError("<end>");
         }
-        Query q = new Query(source, constraint, orderings, columnArray);
+        Query q = new Query(source, constraint, orderings, columnArray, valueFactory);
         q.setExplain(explain);
         q.init();
         return q;
@@ -442,16 +445,16 @@ public class SQL2Parser {
             }
             int valueType = currentValue.getType();
             switch (valueType) {
-            case CoreValue.LONG:
+            case PropertyType.LONG:
                 currentValue = valueFactory.createValue(-currentValue.getLong());
                 break;
-            case CoreValue.DOUBLE:
+            case PropertyType.DOUBLE:
                 currentValue = valueFactory.createValue(-currentValue.getDouble());
                 break;
-            case CoreValue.BOOLEAN:
+            case PropertyType.BOOLEAN:
                 currentValue = valueFactory.createValue(!currentValue.getBoolean());
                 break;
-            case CoreValue.DECIMAL:
+            case PropertyType.DECIMAL:
                 currentValue = valueFactory.createValue(currentValue.getDecimal().negate());
                 break;
             default:
@@ -505,35 +508,35 @@ public class SQL2Parser {
      * @param value the original value
      * @return the literal
      */
-    private LiteralImpl getUncastLiteral(CoreValue value) throws ParseException {
+    private LiteralImpl getUncastLiteral(CoreValue value) {
         return factory.literal(value);
     }
 
     private CoreValue parseCastAs(CoreValue value) throws ParseException {
-        if (readIf("STRING")) {
+        if (readIfPropertyType(PropertyType.STRING)) {
             return valueFactory.createValue(value.getString());
-        } else if (readIf("BINARY")) {
-            return valueFactory.createValue(value.getBinary());
-        } else if (readIf("DATE")) {
-            return valueFactory.createValue(value.getDate());
-        } else if (readIf("LONG")) {
+        } else if (readIfPropertyType(PropertyType.BINARY)) {
+            return valueFactory.createValue(value.getString(), PropertyType.BINARY);
+        } else if (readIfPropertyType(PropertyType.DATE)) {
+            return valueFactory.createValue(value.getString(), PropertyType.DATE);
+        } else if (readIfPropertyType(PropertyType.LONG)) {
             return valueFactory.createValue(value.getLong());
-        } else if (readIf("DOUBLE")) {
+        } else if (readIfPropertyType(PropertyType.DOUBLE)) {
             return valueFactory.createValue(value.getDouble());
-        } else if (readIf("DECIMAL")) {
+        } else if (readIfPropertyType(PropertyType.DECIMAL)) {
             return valueFactory.createValue(value.getDecimal());
-        } else if (readIf("BOOLEAN")) {
+        } else if (readIfPropertyType(PropertyType.BOOLEAN)) {
             return valueFactory.createValue(value.getBoolean());
-        } else if (readIf("NAME")) {
-            return valueFactory.createValue(value.getString(), CoreValue.NAME);
-        } else if (readIf("PATH")) {
-            return valueFactory.createValue(value.getString(), CoreValue.PATH);
-        } else if (readIf("REFERENCE")) {
-            return valueFactory.createValue(value.getString(), CoreValue.REFERENCE);
-        } else if (readIf("WEAKREFERENCE")) {
-            return valueFactory.createValue(value.getString(), CoreValue.WEAKREFERENCE);
-        } else if (readIf("URI")) {
-            return valueFactory.createValue(value.getString(), CoreValue.URI);
+        } else if (readIfPropertyType(PropertyType.NAME)) {
+            return valueFactory.createValue(value.getString(), PropertyType.NAME);
+        } else if (readIfPropertyType(PropertyType.PATH)) {
+            return valueFactory.createValue(value.getString(), PropertyType.PATH);
+        } else if (readIfPropertyType(PropertyType.REFERENCE)) {
+            return valueFactory.createValue(value.getString(), PropertyType.REFERENCE);
+        } else if (readIfPropertyType(PropertyType.WEAKREFERENCE)) {
+            return valueFactory.createValue(value.getString(), PropertyType.WEAKREFERENCE);
+        } else if (readIfPropertyType(PropertyType.URI)) {
+            return valueFactory.createValue(value.getString(), PropertyType.URI);
         } else {
             throw getSyntaxError("data type (STRING|BINARY|...)");
         }
@@ -616,6 +619,11 @@ public class SQL2Parser {
         return array;
     }
 
+    private boolean readIfPropertyType(int propertyType) throws ParseException {
+        String propertyName = PropertyType.nameFromValue(propertyType);
+        return readIf(propertyName);
+    }
+
     private boolean readIf(String token) throws ParseException {
         if (isToken(token)) {
             read();
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElementFactory.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElementFactory.java
index 58fa40629b..eb9e234efd 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElementFactory.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElementFactory.java
@@ -13,7 +13,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 
 /**
  * A factory for syntax tree elements.
@@ -59,7 +59,7 @@ public class AstElementFactory {
     }
 
     public OrderingImpl descending(DynamicOperandImpl operand) {
-        return new OrderingImpl((DynamicOperandImpl) operand, Order.DESCENDING);
+        return new OrderingImpl(operand, Order.DESCENDING);
     }
 
     public EquiJoinConditionImpl equiJoinCondition(String selector1Name, String property1Name, String selector2Name,
@@ -129,7 +129,7 @@ public class AstElementFactory {
     }
 
     public UpperCaseImpl upperCase(DynamicOperandImpl operand) {
-        return new UpperCaseImpl((DynamicOperandImpl) operand);
+        return new UpperCaseImpl(operand);
     }
 
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/BindVariableValueImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/BindVariableValueImpl.java
index f79ccafeec..6d1968f154 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/BindVariableValueImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/BindVariableValueImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 
 public class BindVariableValueImpl extends StaticOperandImpl {
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java
index 4949059a74..564a947b72 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 
 public class ColumnImpl extends AstElement {
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ComparisonImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ComparisonImpl.java
index d913c44394..eab60809d8 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ComparisonImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ComparisonImpl.java
@@ -18,8 +18,8 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
-import org.apache.jackrabbit.oak.query.CoreValueFactory;
+import org.apache.jackrabbit.oak.api.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValueFactory;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public class ComparisonImpl extends ConstraintImpl {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DynamicOperandImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DynamicOperandImpl.java
index a07968bdb1..c065c34f1b 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DynamicOperandImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DynamicOperandImpl.java
@@ -16,7 +16,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public abstract class DynamicOperandImpl extends AstElement {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java
index 70c99325b4..7dc00ee85d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public class EquiJoinConditionImpl extends JoinConditionImpl {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchScoreImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchScoreImpl.java
index 2a6ee5ca01..f12bf16edb 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchScoreImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchScoreImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public class FullTextSearchScoreImpl extends DynamicOperandImpl {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LengthImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LengthImpl.java
index 2adf9a4f4a..cb7872b154 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LengthImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LengthImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public class LengthImpl extends DynamicOperandImpl {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LiteralImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LiteralImpl.java
index 843ddd62f8..341ad4c2b9 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LiteralImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LiteralImpl.java
@@ -18,8 +18,10 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.SQL2Parser;
-import org.apache.jackrabbit.oak.query.CoreValue;
+
+import javax.jcr.PropertyType;
 
 public class LiteralImpl extends StaticOperandImpl {
 
@@ -40,33 +42,7 @@ public class LiteralImpl extends StaticOperandImpl {
 
     @Override
     public String toString() {
-        switch (value.getType()) {
-        case CoreValue.BINARY:
-            return cast("BINARY");
-        case CoreValue.BOOLEAN:
-            return cast("BOOLEAN");
-        case CoreValue.DATE:
-            return cast("DATE");
-        case CoreValue.DECIMAL:
-            return cast("DECIMAL");
-        case CoreValue.DOUBLE:
-        case CoreValue.LONG:
-            return value.getString();
-        case CoreValue.NAME:
-            return cast("NAME");
-        case CoreValue.PATH:
-            return cast("PATH");
-        case CoreValue.REFERENCE:
-            return cast("REFERENCE");
-        case CoreValue.STRING:
-            return escape();
-        case CoreValue.URI:
-            return cast("URI");
-        case CoreValue.WEAKREFERENCE:
-            return cast("WEAKREFERENCE");
-        default:
-            return escape();
-        }
+        return PropertyType.nameFromValue(value.getType()).toUpperCase();
     }
 
     private String cast(String type) {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LowerCaseImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LowerCaseImpl.java
index ab58a34d25..ccbc5a2c0c 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LowerCaseImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LowerCaseImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public class LowerCaseImpl extends DynamicOperandImpl {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeLocalNameImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeLocalNameImpl.java
index c31a4f5c3e..ac349d069b 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeLocalNameImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeLocalNameImpl.java
@@ -19,7 +19,7 @@
 package org.apache.jackrabbit.oak.query.ast;
 
 import org.apache.jackrabbit.mk.util.PathUtils;
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public class NodeLocalNameImpl extends DynamicOperandImpl {
@@ -53,7 +53,7 @@ public class NodeLocalNameImpl extends DynamicOperandImpl {
     }
 
     @Override
-    public  CoreValue currentValue() {
+    public CoreValue currentValue() {
         String name = PathUtils.getName(selector.currentPath());
         int colon = name.indexOf(':');
         // TODO LOCALNAME: evaluation of local name might not be correct
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeNameImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeNameImpl.java
index 29ad55aafb..7457062f41 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeNameImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeNameImpl.java
@@ -19,7 +19,7 @@
 package org.apache.jackrabbit.oak.query.ast;
 
 import org.apache.jackrabbit.mk.util.PathUtils;
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public class NodeNameImpl extends DynamicOperandImpl {
@@ -53,7 +53,7 @@ public class NodeNameImpl extends DynamicOperandImpl {
     }
 
     @Override
-    public  CoreValue currentValue() {
+    public CoreValue currentValue() {
         String name = PathUtils.getName(selector.currentPath());
         return query.getValueFactory().createValue(name);
     }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyExistenceImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyExistenceImpl.java
index 3eae5eb043..4f5543c634 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyExistenceImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyExistenceImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public class PropertyExistenceImpl extends ConstraintImpl {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyValueImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyValueImpl.java
index 4e99f98923..eb8511b52e 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyValueImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyValueImpl.java
@@ -21,7 +21,7 @@ package org.apache.jackrabbit.oak.query.ast;
 import org.apache.jackrabbit.mk.json.JsopTokenizer;
 import org.apache.jackrabbit.mk.simple.NodeImpl;
 import org.apache.jackrabbit.mk.util.PathUtils;
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public class PropertyValueImpl extends DynamicOperandImpl {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
index 6f92976700..1a81aef014 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
@@ -21,8 +21,8 @@ package org.apache.jackrabbit.oak.query.ast;
 import org.apache.jackrabbit.mk.api.MicroKernel;
 import org.apache.jackrabbit.mk.json.JsopTokenizer;
 import org.apache.jackrabbit.mk.simple.NodeImpl;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.Query;
-import org.apache.jackrabbit.oak.query.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Cursor;
 import org.apache.jackrabbit.oak.query.index.Filter;
 import org.apache.jackrabbit.oak.query.index.QueryIndex;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/StaticOperandImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/StaticOperandImpl.java
index 391264e41c..dcaedbc121 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/StaticOperandImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/StaticOperandImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 
 public abstract class StaticOperandImpl extends AstElement {
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/UpperCaseImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/UpperCaseImpl.java
index 17591fc5f3..bd02ced8b5 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/UpperCaseImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/UpperCaseImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.index.Filter;
 
 public class UpperCaseImpl extends DynamicOperandImpl {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/Filter.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/Filter.java
index 1b66267e33..b6bf07431c 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/Filter.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/Filter.java
@@ -21,7 +21,7 @@ package org.apache.jackrabbit.oak.query.index;
 import java.util.HashMap;
 import java.util.Map.Entry;
 import org.apache.jackrabbit.mk.util.PathUtils;
-import org.apache.jackrabbit.oak.query.CoreValue;
+import org.apache.jackrabbit.oak.api.CoreValue;
 import org.apache.jackrabbit.oak.query.ast.Operator;
 import org.apache.jackrabbit.oak.query.ast.SelectorImpl;
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/CoreValueFactory.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/AbstractQueryTest.java
similarity index 53%
rename from oak-core/src/main/java/org/apache/jackrabbit/oak/query/CoreValueFactory.java
rename to oak-core/src/test/java/org/apache/jackrabbit/oak/query/AbstractQueryTest.java
index 6b26ec9a0a..040f1b1518 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/CoreValueFactory.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/AbstractQueryTest.java
@@ -16,32 +16,24 @@
  */
 package org.apache.jackrabbit.oak.query;
 
-import java.math.BigDecimal;
-
-public class CoreValueFactory {
-
-    public CoreValue createValue(String value) {
-        return new CoreValue(value, CoreValue.STRING);
-    }
-
-    public CoreValue createValue(BigDecimal value) {
-        return new CoreValue(value, CoreValue.DECIMAL);
-    }
-
-    public CoreValue createValue(double value) {
-        return new CoreValue(value, CoreValue.DOUBLE);
-    }
-
-    public CoreValue createValue(long value) {
-        return new CoreValue(value, CoreValue.LONG);
-    }
-
-    public CoreValue createValue(boolean value) {
-        return new CoreValue(value, CoreValue.BOOLEAN);
-    }
+import org.apache.jackrabbit.mk.api.MicroKernel;
+import org.apache.jackrabbit.mk.core.MicroKernelImpl;
+import org.apache.jackrabbit.oak.api.CoreValueFactory;
+import org.apache.jackrabbit.oak.core.CoreValueFactoryImpl;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+
+/**
+ * AbstractQueryTest...
+ */
+public abstract class AbstractQueryTest {
 
-    public CoreValue createValue(String value, int type) {
-        return new CoreValue(value, type);
-    }
+    /**
+     * logger instance
+     */
+    private static final Logger log = LoggerFactory.getLogger(AbstractQueryTest.class);
 
-}
+    // TODO improve: use ContentRepository here instead of creating mk instance.
+    protected final MicroKernel mk = new MicroKernelImpl();
+    protected final CoreValueFactory vf = new CoreValueFactoryImpl(mk);
+}
\ No newline at end of file
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/QueryTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/QueryTest.java
index 40b06b1480..006e4d713f 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/QueryTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/QueryTest.java
@@ -13,8 +13,11 @@
  */
 package org.apache.jackrabbit.oak.query;
 
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertTrue;
+import org.apache.jackrabbit.oak.api.CoreValue;
+import org.apache.jackrabbit.oak.api.Result;
+import org.apache.jackrabbit.oak.api.ResultRow;
+import org.junit.Test;
+
 import java.io.FileOutputStream;
 import java.io.InputStream;
 import java.io.InputStreamReader;
@@ -27,19 +30,16 @@ import java.util.Collections;
 import java.util.HashMap;
 import java.util.Iterator;
 import java.util.List;
-import org.apache.jackrabbit.mk.api.MicroKernel;
-import org.apache.jackrabbit.mk.core.MicroKernelImpl;
-import org.apache.jackrabbit.oak.api.Result;
-import org.apache.jackrabbit.oak.api.ResultRow;
-import org.junit.Test;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertTrue;
 
 /**
  * Test the query feature.
  */
-public class QueryTest {
+public class QueryTest extends AbstractQueryTest {
 
-    private final MicroKernel mk = new MicroKernelImpl();
-    private QueryEngineImpl qe = new QueryEngineImpl(mk);
+    private QueryEngineImpl qe = new QueryEngineImpl(mk, vf);
 
     @Test
     public void script() throws Exception {
@@ -56,7 +56,6 @@ public class QueryTest {
         mk.commit("/", "+ \"test\": { \"hello\": {\"id\": \"1\"}, \"world\": {\"id\": \"2\"}}",
                 null, null);
         HashMap<String, CoreValue> sv = new HashMap<String, CoreValue>();
-        CoreValueFactory vf = new CoreValueFactory();
         sv.put("id", vf.createValue("1"));
         Iterator<? extends ResultRow> result;
         result = qe.executeQuery("select * from [nt:base] where id = $id",
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/FilterTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/FilterTest.java
index eebd145e87..247c046a95 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/FilterTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/FilterTest.java
@@ -18,26 +18,28 @@
  */
 package org.apache.jackrabbit.oak.query.index;
 
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertTrue;
-import static org.junit.Assert.fail;
-import java.util.ArrayList;
-import java.util.Random;
-import org.apache.jackrabbit.oak.query.CoreValue;
-import org.apache.jackrabbit.oak.query.CoreValueFactory;
+import org.apache.jackrabbit.oak.api.CoreValue;
+import org.apache.jackrabbit.oak.query.AbstractQueryTest;
 import org.apache.jackrabbit.oak.query.ast.Operator;
 import org.apache.jackrabbit.oak.query.index.Filter.PathRestriction;
 import org.junit.Test;
 
+import java.util.ArrayList;
+import java.util.Random;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.fail;
+
 /**
  * Tests the Filter class.
  */
-public class FilterTest {
+public class FilterTest extends AbstractQueryTest {
 
     @Test
     public void propertyRestriction() {
-        CoreValue one = new CoreValueFactory().createValue("1");
-        CoreValue two = new CoreValueFactory().createValue("2");
+        CoreValue one = vf.createValue("1");
+        CoreValue two = vf.createValue("2");
 
         Filter f = new Filter(null);
         assertTrue(null == f.getPropertyRestriction("x"));
