diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeState.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeState.java
index 928f354b8b..8fcb9f9e5f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeState.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeState.java
@@ -283,9 +283,8 @@ public class SegmentNodeState extends Record implements NodeState {
             SegmentNodeState that = (SegmentNodeState) base;
             return getRecordId().equals(that.getRecordId())
                 || getTemplate().compareAgainstBaseState(
-                        getSegment(), getRecordId(),
-                        that.getTemplate(), that.getRecordId(),
-                        diff);
+                        getSegment(), getRecordId(), that.getTemplate(),
+                        that.getSegment(), that.getRecordId(), diff);
         } else {
             // fallback
             return AbstractNodeState.compareAgainstBaseState(this, base, diff);
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Template.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Template.java
index 630ebd862b..cb71ea56e9 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Template.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Template.java
@@ -266,12 +266,13 @@ public class Template {
     }
 
     public boolean compareAgainstBaseState(
-            final Segment segment, RecordId afterId,
-            Template beforeTemplate, RecordId beforeId,
+            Segment afterSegment, RecordId afterId,
+            Template beforeTemplate, Segment beforeSegment, RecordId beforeId,
             final NodeStateDiff diff) {
-        checkNotNull(segment);
+        checkNotNull(afterSegment);
         checkNotNull(afterId);
         checkNotNull(beforeTemplate);
+        checkNotNull(beforeSegment);
         checkNotNull(beforeId);
         checkNotNull(diff);
 
@@ -281,9 +282,6 @@ public class Template {
             return false;
         }
 
-        final Segment afterSegment = segment.getSegment(afterId);
-        final Segment beforeSegment = segment.getSegment(beforeId);
-
         // Compare other properties, leveraging the ordering
         int beforeIndex = 0;
         int afterIndex = 0;
@@ -438,7 +436,6 @@ public class Template {
         if (childName == MANY_CHILD_NODES) {
             RecordId childNodesId = segment.readRecordId(offset);
             MapRecord children = segment.readMap(childNodesId);
-            final Segment s = segment;
             children.compareAgainstEmptyMap(new MapDiff() {
                 @Override
                 public boolean entryAdded(MapEntry after) {
