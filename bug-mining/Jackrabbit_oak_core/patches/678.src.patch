diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/version/DateVersionSelector.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/version/DateVersionSelector.java
index 64318cc41b..5cb703ae5f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/version/DateVersionSelector.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/version/DateVersionSelector.java
@@ -83,6 +83,8 @@ public class DateVersionSelector implements VersionSelector {
             if (c > latestDate && c <= timestamp) {
                 latestDate = c;
                 latestVersion = v;
+            } else if (c == latestDate) {
+                throw new RepositoryException("two versions share the same jcr:created timestamp in history:" + history);
             }
         }
         return latestVersion;
