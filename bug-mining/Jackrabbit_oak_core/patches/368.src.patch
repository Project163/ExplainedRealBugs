diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStore.java
index 6f70e9a3b9..98685c38fd 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStore.java
@@ -16,9 +16,14 @@
  */
 package org.apache.jackrabbit.oak.kernel;
 
+import static com.google.common.base.Preconditions.checkArgument;
+import static com.google.common.base.Preconditions.checkNotNull;
+
 import java.io.IOException;
 import java.io.InputStream;
 import java.util.concurrent.ExecutionException;
+import java.util.concurrent.locks.Lock;
+import java.util.concurrent.locks.ReentrantLock;
 
 import javax.annotation.CheckForNull;
 import javax.annotation.Nonnull;
@@ -29,18 +34,14 @@ import com.google.common.cache.LoadingCache;
 import com.google.common.cache.Weigher;
 import com.google.common.util.concurrent.ListenableFuture;
 import com.google.common.util.concurrent.SettableFuture;
-
 import org.apache.jackrabbit.mk.api.MicroKernel;
 import org.apache.jackrabbit.mk.api.MicroKernelException;
+import org.apache.jackrabbit.oak.cache.CacheStats;
 import org.apache.jackrabbit.oak.spi.commit.EmptyObserver;
 import org.apache.jackrabbit.oak.spi.commit.Observer;
 import org.apache.jackrabbit.oak.spi.state.AbstractNodeStore;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeStoreBranch;
-import org.apache.jackrabbit.oak.cache.CacheStats;
-
-import static com.google.common.base.Preconditions.checkArgument;
-import static com.google.common.base.Preconditions.checkNotNull;
 
 /**
  * {@code NodeStore} implementations against {@link MicroKernel}.
@@ -64,6 +65,11 @@ public class KernelNodeStore extends AbstractNodeStore {
 
     private final CacheStats cacheStats;
 
+    /**
+     * Lock passed to branches for coordinating merges
+     */
+    private final Lock mergeLock = new ReentrantLock();
+
     /**
      * State of the current root node.
      */
@@ -140,7 +146,7 @@ public class KernelNodeStore extends AbstractNodeStore {
 
     @Override
     public NodeStoreBranch branch() {
-        return new KernelNodeStoreBranch(this, getRoot());
+        return new KernelNodeStoreBranch(this, getRoot(), mergeLock);
     }
 
     /**
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java
index d4a054b26f..2d33778414 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java
@@ -23,6 +23,8 @@ import static org.apache.jackrabbit.oak.commons.PathUtils.elements;
 import static org.apache.jackrabbit.oak.commons.PathUtils.getName;
 import static org.apache.jackrabbit.oak.commons.PathUtils.getParentPath;
 
+import java.util.concurrent.locks.Lock;
+
 import org.apache.jackrabbit.mk.api.MicroKernel;
 import org.apache.jackrabbit.mk.api.MicroKernelException;
 import org.apache.jackrabbit.oak.api.CommitFailedException;
@@ -43,6 +45,11 @@ class KernelNodeStoreBranch extends AbstractNodeStoreBranch {
     /** The underlying store to which this branch belongs */
     private final KernelNodeStore store;
 
+    /**
+     * Lock for coordinating concurrent merge operations
+     */
+    private final Lock mergeLock;
+
     /** Root state of the base revision of this branch */
     private KernelNodeState base;
 
@@ -55,10 +62,11 @@ class KernelNodeStoreBranch extends AbstractNodeStoreBranch {
     /** Number of updates to this branch via {@link #setRoot(NodeState)} */
     private int updates = 0;
 
-    KernelNodeStoreBranch(KernelNodeStore store, KernelNodeState root) {
+    KernelNodeStoreBranch(KernelNodeStore store, KernelNodeState root, Lock mergeLock) {
         this.store = store;
         this.base = root;
         this.head = root;
+        this.mergeLock = mergeLock;
     }
 
     @Override
@@ -138,46 +146,46 @@ class KernelNodeStoreBranch extends AbstractNodeStoreBranch {
     @Override
     public NodeState merge(CommitHook hook, PostCommitHook committed) throws CommitFailedException {
         checkNotMerged();
-        synchronized (this) {
+        NodeState oldRoot = head;
+        mergeLock.lock();
+        try {
             rebase();
             NodeState toCommit = checkNotNull(hook).processCommit(base, head);
-            NodeState oldRoot = head;
             head = toCommit;
-
-            try {
-                if (head.equals(base)) {
-                    // Nothing was written to this branch: return base state
-                    head = null;  // Mark as merged
-                    committed.contentChanged(base, base);
-                    return base;
+            if (head.equals(base)) {
+                // Nothing was written to this branch: return base state
+                head = null;  // Mark as merged
+                committed.contentChanged(base, base);
+                return base;
+            } else {
+                NodeState newRoot;
+                JsopDiff diff = new JsopDiff(store);
+                if (headRevision == null) {
+                    // no branch created yet, commit directly
+                    head.compareAgainstBaseState(base, diff);
+                    newRoot = store.commit(diff.toString(), base.getRevision());
                 } else {
-                    NodeState newRoot;
-                    JsopDiff diff = new JsopDiff(store);
-                    if (headRevision == null) {
-                        // no branch created yet, commit directly
-                        head.compareAgainstBaseState(base, diff);
-                        newRoot = store.commit(diff.toString(), base.getRevision());
-                    } else {
-                        // commit into branch and merge
-                        head.compareAgainstBaseState(store.getRootState(headRevision), diff);
-                        String jsop = diff.toString();
-                        if (!jsop.isEmpty()) {
-                            headRevision = store.getKernel().commit(
-                                    "", jsop, headRevision, null);
-                        }
-                        newRoot = store.merge(headRevision);
-                        headRevision = null;
+                    // commit into branch and merge
+                    head.compareAgainstBaseState(store.getRootState(headRevision), diff);
+                    String jsop = diff.toString();
+                    if (!jsop.isEmpty()) {
+                        headRevision = store.getKernel().commit(
+                                "", jsop, headRevision, null);
                     }
-                    head = null;  // Mark as merged
-                    committed.contentChanged(base, newRoot);
-                    return newRoot;
+                    newRoot = store.merge(headRevision);
+                    headRevision = null;
                 }
-            } catch (MicroKernelException e) {
-                head = oldRoot;
-                throw new CommitFailedException(
-                        "Kernel", 1,
-                        "Failed to merge changes to the underlying MicroKernel", e);
+                head = null;  // Mark as merged
+                committed.contentChanged(base, newRoot);
+                return newRoot;
             }
+        } catch (MicroKernelException e) {
+            head = oldRoot;
+            throw new CommitFailedException(
+                    "Kernel", 1,
+                    "Failed to merge changes to the underlying MicroKernel", e);
+        } finally {
+            mergeLock.unlock();
         }
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeStoreBranch.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeStoreBranch.java
index 8dbc6dfe98..ef5893c300 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeStoreBranch.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeStoreBranch.java
@@ -118,9 +118,10 @@ class SegmentNodeStoreBranch extends AbstractNodeStoreBranch {
                 // someone else has a pessimistic lock on the journal,
                 // so we should not try to commit anything
             } else if (store.setHead(base, newHead)) {
+                NodeState previousBase = base;
                 base = newHead;
                 head = newHead;
-                committed.contentChanged(originalBase.getChildNode(ROOT), newHead.getChildNode(ROOT));
+                committed.contentChanged(previousBase.getChildNode(ROOT), newHead.getChildNode(ROOT));
                 return -1;
             }
 
@@ -176,9 +177,10 @@ class SegmentNodeStoreBranch extends AbstractNodeStoreBranch {
                             writer.writeNode(builder.getNodeState());
                     writer.flush();
                     if (store.setHead(after, newHead)) {
+                        NodeState previousBase = base;
                         base = newHead;
                         head = newHead;
-                        committed.contentChanged(originalBase.getChildNode(ROOT), newHead.getChildNode(ROOT));
+                        committed.contentChanged(previousBase.getChildNode(ROOT), newHead.getChildNode(ROOT));
                         return;
                     } else {
                         // something else happened, perhaps a timeout, so
