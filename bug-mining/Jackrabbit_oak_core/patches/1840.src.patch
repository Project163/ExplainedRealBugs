diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java
index d8233ce0a5..93e7375dc0 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java
@@ -21,12 +21,17 @@ import java.security.Principal;
 import java.util.Collections;
 import java.util.HashMap;
 import java.util.Map;
+import java.util.Objects;
 import java.util.Set;
+import java.util.stream.Collectors;
+import java.util.stream.Stream;
 import javax.jcr.Credentials;
+import javax.security.auth.Subject;
 import javax.security.auth.callback.Callback;
 import javax.security.auth.callback.UnsupportedCallbackException;
 import javax.security.auth.login.LoginException;
 
+import com.google.common.collect.Iterables;
 import org.apache.jackrabbit.api.security.authentication.token.TokenCredentials;
 import org.apache.jackrabbit.oak.api.AuthInfo;
 import org.apache.jackrabbit.oak.api.Root;
@@ -119,6 +124,8 @@ public final class TokenLoginModule extends AbstractLoginModule {
     private TokenCredentials tokenCredentials;
     private TokenInfo tokenInfo;
     private Principal principal;
+    private Set<? extends Principal> principals;
+    private AuthInfo authInfo;
 
     //--------------------------------------------------------< LoginModule >---
     @Override
@@ -149,12 +156,13 @@ public final class TokenLoginModule extends AbstractLoginModule {
     @Override
     public boolean commit() throws LoginException {
         if (tokenCredentials != null && tokenInfo != null) {
-            Set<? extends Principal> principals = (principal != null) ? getPrincipals(principal) : getPrincipals(tokenInfo.getUserId());
-            updateSubject(tokenCredentials, getAuthInfo(tokenInfo, principals), principals);
-            clearState();
+            principals = (principal != null) ? getPrincipals(principal) : getPrincipals(tokenInfo.getUserId());
+            authInfo = getAuthInfo(tokenInfo, Iterables.concat(principals, subject.getPrincipals()));
+            updateSubject(subject, tokenCredentials, authInfo);
+            clearState(); // FIXME see OAK-8803
             return true;
         }
-        try{
+        try {
             if (tokenProvider != null && sharedState.containsKey(SHARED_KEY_CREDENTIALS)) {
                 Credentials shared = getSharedCredentials();
                 if (shared != null && tokenProvider.doCreateToken(shared)) {
@@ -168,7 +176,7 @@ public final class TokenLoginModule extends AbstractLoginModule {
                         ti.getPrivateAttributes().forEach((key, value) -> tc.setAttribute(key, value));
                         ti.getPublicAttributes().forEach((key, value) -> tc.setAttribute(key, value));
                         sharedState.put(SHARED_KEY_ATTRIBUTES, ti.getPublicAttributes());
-                        updateSubject(tc, null, null);
+                        updateSubject(subject, tc, null);
                     } else {
                         // failed to create token -> fail commit()
                         onError();
@@ -200,6 +208,9 @@ public final class TokenLoginModule extends AbstractLoginModule {
         tokenCredentials = null;
         tokenInfo = null;
         tokenProvider = null;
+        principal = null;
+        principals = null;
+        authInfo = null;
     }
 
     //------------------------------------------------------------< private >---
@@ -238,22 +249,17 @@ public final class TokenLoginModule extends AbstractLoginModule {
      * @return The {@code AuthInfo} resulting from the successful login.
      */
     @NotNull
-    private static AuthInfo getAuthInfo(@NotNull TokenInfo tokenInfo, @NotNull Set<? extends Principal> principals) {
+    private static AuthInfo getAuthInfo(@NotNull TokenInfo tokenInfo, @NotNull Iterable<? extends Principal> principals) {
         Map<String, Object> attributes = new HashMap<>();
         tokenInfo.getPublicAttributes().forEach((key, value) -> attributes.put(key, value));
         return new AuthInfoImpl(tokenInfo.getUserId(), attributes, principals);
     }
 
-    private void updateSubject(@NotNull TokenCredentials tc, @Nullable AuthInfo authInfo,
-                               @Nullable Set<? extends Principal> principals) {
+    private static void updateSubject(@NotNull Subject subject, @NotNull TokenCredentials tc, @Nullable AuthInfo authInfo) {
         if (!subject.isReadOnly()) {
             subject.getPublicCredentials().add(tc);
-
-            if (principals != null) {
-                subject.getPrincipals().addAll(principals);
-            }
-
             if (authInfo != null) {
+                subject.getPrincipals().addAll(authInfo.getPrincipals());
                 setAuthInfo(authInfo, subject);
             }
         }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModuleTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModuleTest.java
index ad3857cef2..a9e4ff4a13 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModuleTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModuleTest.java
@@ -17,8 +17,11 @@
 package org.apache.jackrabbit.oak.security.authentication.token;
 
 import java.io.IOException;
+import java.security.Principal;
 import java.util.Collections;
+import java.util.HashMap;
 import java.util.Map;
+import java.util.Set;
 import javax.jcr.Credentials;
 import javax.jcr.GuestCredentials;
 import javax.jcr.SimpleCredentials;
@@ -36,6 +39,7 @@ import com.google.common.collect.Maps;
 import org.apache.jackrabbit.api.security.authentication.token.TokenCredentials;
 import org.apache.jackrabbit.api.security.user.User;
 import org.apache.jackrabbit.oak.AbstractSecurityTest;
+import org.apache.jackrabbit.oak.api.AuthInfo;
 import org.apache.jackrabbit.oak.api.ContentSession;
 import org.apache.jackrabbit.oak.api.Root;
 import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
@@ -48,6 +52,7 @@ import org.apache.jackrabbit.oak.spi.security.authentication.token.TokenInfo;
 import org.apache.jackrabbit.oak.spi.security.authentication.token.TokenProvider;
 import org.apache.jackrabbit.oak.spi.security.principal.EveryonePrincipal;
 import org.apache.jackrabbit.oak.spi.security.principal.PrincipalConfiguration;
+import org.apache.jackrabbit.oak.spi.security.principal.PrincipalImpl;
 import org.jetbrains.annotations.NotNull;
 import org.jetbrains.annotations.Nullable;
 import org.junit.Test;
@@ -69,6 +74,16 @@ import static org.mockito.Mockito.when;
 
 public class TokenLoginModuleTest extends AbstractSecurityTest {
 
+    private static TokenProvider mockTokenProvider(@NotNull String userId) {
+        TokenInfo info = mock(TokenInfo.class);
+        when(info.isExpired(anyLong())).thenReturn(false);
+        when(info.matches(any(TokenCredentials.class))).thenReturn(true);
+        when(info.getUserId()).thenReturn(userId);
+
+        TokenProvider tp = when(mock(TokenProvider.class).getTokenInfo(anyString())).thenReturn(info).getMock();
+        return tp;
+    }
+
     @Override
     protected Configuration getConfiguration() {
         return new Configuration() {
@@ -251,12 +266,7 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
 
     @Test
     public void testMissingUserPrincipal() throws Exception {
-        TokenInfo info = mock(TokenInfo.class);
-        when(info.isExpired(anyLong())).thenReturn(false);
-        when(info.matches(any(TokenCredentials.class))).thenReturn(true);
-        when(info.getUserId()).thenReturn(getTestUser().getID());
-
-        TokenProvider tp = when(mock(TokenProvider.class).getTokenInfo(anyString())).thenReturn(info).getMock();
+        TokenProvider tp = mockTokenProvider(getTestUser().getID());
         TokenCredentials tc = new TokenCredentials("token");
 
         TokenLoginModule lm = new TokenLoginModule();
@@ -383,6 +393,27 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         verify(tp, times(1)).createToken(sc);
     }
 
+    @Test
+    public void testSuccessCommitRespectsSubjectPrincipals() throws Exception {
+        Principal principal = new PrincipalImpl("subjetPrincipal");
+        Subject subject = new Subject();
+        subject.getPrincipals().add(principal);
+
+        Map<String, Object> shared = Maps.newHashMap();
+        shared.put(AbstractLoginModule.SHARED_KEY_CREDENTIALS, new TokenCredentials("token"));
+
+        TokenLoginModule lm = new TokenLoginModule();
+        lm.initialize(subject, new TestCallbackHandler(mockTokenProvider("userId")), shared, new HashMap<>());
+
+        assertTrue(lm.login());
+        assertTrue(lm.commit());
+
+        Set<AuthInfo> authInfoSet = subject.getPublicCredentials(AuthInfo.class);
+        assertFalse(authInfoSet.isEmpty());
+        AuthInfo info = authInfoSet.iterator().next();
+        assertTrue(info.getPrincipals().contains(principal));
+    }
+
     private final class TestCallbackHandler implements CallbackHandler {
 
         private final TokenProvider tokenProvider;
