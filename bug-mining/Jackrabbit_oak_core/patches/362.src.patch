diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
index 6510cbc0ff..2cf5544743 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
@@ -89,11 +89,11 @@ public class Query {
 
     final SourceImpl source;
     final String statement;
-    final ConstraintImpl constraint;
     final HashMap<String, PropertyValue> bindVariableMap = new HashMap<String, PropertyValue>();
     final HashMap<String, Integer> selectorIndexes = new HashMap<String, Integer>();
     final ArrayList<SelectorImpl> selectors = new ArrayList<SelectorImpl>();
-
+    ConstraintImpl constraint;
+    
     private QueryEngineImpl queryEngine;
     private final OrderingImpl[] orderings;
     private ColumnImpl[] columns;
@@ -291,6 +291,9 @@ public class Query {
             }
 
         }.visit(this);
+        if (constraint != null) {
+            constraint = constraint.simplify();
+        }
         source.setQueryConstraint(constraint);
         source.init(this);
         for (ColumnImpl column : columns) {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AndImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AndImpl.java
index 14b0f2c973..97d9d7de2c 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AndImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AndImpl.java
@@ -46,6 +46,14 @@ public class AndImpl extends ConstraintImpl {
     public ConstraintImpl getConstraint2() {
         return constraint2;
     }
+
+    @Override
+    public ConstraintImpl simplify() {
+        if (constraint1.equals(constraint2)) {
+            return constraint1;
+        }
+        return this;
+    }
     
     @Override
     public Set<PropertyExistenceImpl> getPropertyExistenceConditions() {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ConstraintImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ConstraintImpl.java
index d0c4a6ce36..2cc9f14141 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ConstraintImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ConstraintImpl.java
@@ -25,6 +25,16 @@ import org.apache.jackrabbit.oak.query.index.FilterImpl;
  * The base class for constraints.
  */
 public abstract class ConstraintImpl extends AstElement {
+    
+    /**
+     * Simplify the expression if possible, for example by removing duplicate expressions.
+     * For example, "x=1 or x=1" should be simplified to "x=1".
+     * 
+     * @return the simplified constraint, or "this" if it is not possible to simplify
+     */
+    public ConstraintImpl simplify() {
+        return this;
+    }
 
     /**
      * Evaluate the result using the currently set values.
@@ -79,5 +89,20 @@ public abstract class ConstraintImpl extends AstElement {
      * @param s the selector
      */
     public abstract void restrictPushDown(SelectorImpl s);
+    
+    @Override
+    public boolean equals(Object other) {
+        if (other == this) {
+            return true;
+        } else if (!(other instanceof ConstraintImpl)) {
+            return false;
+        }
+        return toString().equals(other.toString());
+    }
+
+    @Override
+    public int hashCode() {
+        return toString().hashCode();
+    }
 
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/OrImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/OrImpl.java
index 950f459b57..ca1872be60 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/OrImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/OrImpl.java
@@ -49,6 +49,14 @@ public class OrImpl extends ConstraintImpl {
         return constraint2;
     }
     
+    @Override
+    public ConstraintImpl simplify() {
+        if (constraint1.equals(constraint2)) {
+            return constraint1;
+        }
+        return this;
+    }
+    
     @Override
     public Set<PropertyExistenceImpl> getPropertyExistenceConditions() {
         // for the condition "x=1 or x=2", the existence condition
diff --git a/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/sql2_index.txt b/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/sql2_index.txt
index 7e854f2243..d6af47b1d2 100644
--- a/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/sql2_index.txt
+++ b/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/sql2_index.txt
@@ -28,6 +28,9 @@
 explain select excerpt(.) from [nt:resource] where contains(*, 'jackrabbit')
 [nt:resource] as [nt:resource] /* traverse "*" where contains([nt:resource].[*], cast('jackrabbit' as string)) */
 
+explain select excerpt(.) from [nt:resource] where contains(*, 'jackrabbit') or contains(*, 'jackrabbit')
+[nt:resource] as [nt:resource] /* traverse "*" where contains([nt:resource].[*], cast('jackrabbit' as string)) */
+
 explain select * from [nt:base] where [jcr:uuid]=1 or [b]=2
 [nt:base] as [nt:base] /* traverse "*" */
 
