diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentTracker.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentTracker.java
index 014b342d8a..050af1a581 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentTracker.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentTracker.java
@@ -152,7 +152,7 @@ public class SegmentTracker {
         writer.flush(); // force the current segment to have root record info
         while (!queue.isEmpty()) {
             SegmentId id = queue.remove();
-            if (id.isDataSegmentId() && !processed.add(id)) {
+            if (id.isDataSegmentId() && processed.add(id)) {
                 Segment segment = id.getSegment();
 
                 segment.collectBlobReferences(collector);
