diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/SecureNodeBuilder.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/SecureNodeBuilder.java
index 12837d5573..0292aa5569 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/SecureNodeBuilder.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/SecureNodeBuilder.java
@@ -136,6 +136,13 @@ class SecureNodeBuilder implements NodeBuilder, FastCopyMove {
                 || (builder.isReplaced() && !getTreePermission().canRead());
     }
 
+    @Override
+    public boolean isNew(String name) {
+        return builder.isNew(name)
+                || (builder.isReplaced(name)
+                        && !getTreePermission().canRead(builder.getProperty(name)));
+    }
+
     @Override
     public boolean isModified() {
         return builder.isModified();
@@ -146,6 +153,11 @@ class SecureNodeBuilder implements NodeBuilder, FastCopyMove {
         return builder.isReplaced() && !isNew();
     }
 
+    @Override
+    public boolean isReplaced(String name) {
+        return builder.isReplaced(name) && !isNew(name);
+    }
+
     public void baseChanged() {
         checkState(parent == null);
         treePermission = null; // trigger re-evaluation of the context
@@ -173,7 +185,7 @@ class SecureNodeBuilder implements NodeBuilder, FastCopyMove {
     public PropertyState getProperty(String name) {
         PropertyState property = builder.getProperty(name);
         if (property != null
-                && (getTreePermission().canRead(property) || isNew())) {
+                && new ReadablePropertyPredicate().apply(property)) {
             return property;
         } else {
             return null;
@@ -376,7 +388,8 @@ class SecureNodeBuilder implements NodeBuilder, FastCopyMove {
     private class ReadablePropertyPredicate implements Predicate<PropertyState> {
         @Override
         public boolean apply(@Nonnull PropertyState property) {
-            return getTreePermission().canRead(property);
+            return getTreePermission().canRead(property)
+                    || isNew(property.getName());
         }
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeBuilder.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeBuilder.java
index 0523696bf6..e3fc32bb69 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeBuilder.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeBuilder.java
@@ -263,6 +263,11 @@ public class MemoryNodeBuilder implements NodeBuilder {
         return exists() && !getBaseState().exists();
     }
 
+    @Override
+    public boolean isNew(String name) {
+        return hasProperty(name) && !getBaseState().hasProperty(name);
+    }
+
     @Override
     public boolean isModified() {
         return head().isModified();
@@ -273,6 +278,11 @@ public class MemoryNodeBuilder implements NodeBuilder {
         return head().isReplaced();
     }
 
+    @Override
+    public boolean isReplaced(String name) {
+        return head().isReplaced(name);
+    }
+
     @Override
     public long getChildNodeCount(long max) {
         return head().getCurrentNodeState().getChildNodeCount(max);
@@ -547,6 +557,13 @@ public class MemoryNodeBuilder implements NodeBuilder {
          */
         public abstract boolean isReplaced();
 
+        /**
+         * Check whether the named property is replaced.
+         *
+         * @param name property name
+         * @return {@code true} for a replaced property
+         */
+        public abstract boolean isReplaced(String name);
 
     }
 
@@ -603,6 +620,11 @@ public class MemoryNodeBuilder implements NodeBuilder {
             return false;
         }
 
+        @Override
+        public boolean isReplaced(String name) {
+            return false;
+        }
+
         @Override
         public String toString() {
             return toStringHelper(this).add("path", getPath()).toString();
@@ -656,6 +678,11 @@ public class MemoryNodeBuilder implements NodeBuilder {
             return state.isReplaced(base());
         }
 
+        @Override
+        public boolean isReplaced(String name) {
+            return state.isReplaced(base(), name);
+        }
+
         @Override
         public String toString() {
             return toStringHelper(this).add("path", getPath()).toString();
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MutableNodeState.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MutableNodeState.java
index 441fafa159..f455195c8a 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MutableNodeState.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MutableNodeState.java
@@ -146,6 +146,11 @@ class MutableNodeState extends AbstractNodeState {
         return base != before;
     }
 
+    boolean isReplaced(NodeState before, String name) {
+        return before.hasProperty(name)
+                && (base != before || properties.containsKey(name));
+    }
+
     /**
      * Remove the child node with the given {@code name}.
      * @param name  name of the child node to remove
@@ -302,4 +307,5 @@ class MutableNodeState extends AbstractNodeState {
     public NodeBuilder builder() {
         throw new UnsupportedOperationException();
     }
+
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeBuilder.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeBuilder.java
index fb2107fd3c..3fcb6b2720 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeBuilder.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeBuilder.java
@@ -106,6 +106,14 @@ public interface NodeBuilder {
      */
     boolean isNew();
 
+    /**
+     * Check whether the named property is new, i.e. not present in the base state.
+     *
+     * @param name property name
+     * @return {@code true} for a new property
+     */
+    boolean isNew(String name);
+
     /**
      * Check whether this builder represents a modified node, which has either modified properties
      * or removed or added child nodes.
@@ -122,6 +130,16 @@ public interface NodeBuilder {
      */
     boolean isReplaced();
 
+    /**
+     * Check whether the named property exists in the base state but is
+     * replaced with other content, for example as a result of
+     * a {@link #setProperty(PropertyState)} call.
+     *
+     * @param name property name
+     * @return {@code true} for a replaced property
+     */
+    boolean isReplaced(String name);
+
     /**
      * Returns the current number of child nodes.
      * <p>
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/ReadOnlyBuilder.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/ReadOnlyBuilder.java
index 1b56a4fced..07a72e0fb7 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/ReadOnlyBuilder.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/ReadOnlyBuilder.java
@@ -55,6 +55,11 @@ public class ReadOnlyBuilder implements NodeBuilder {
         return false;
     }
 
+    @Override
+    public boolean isNew(String name) {
+        return false;
+    }
+
     @Override
     public boolean isModified() {
         return false;
@@ -65,6 +70,11 @@ public class ReadOnlyBuilder implements NodeBuilder {
         return false;
     }
 
+    @Override
+    public boolean isReplaced(String name) {
+        return false;
+    }
+
     @Override @Nonnull
     public NodeState getNodeState() {
         return state;
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/evaluation/ShadowInvisibleContentTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/evaluation/ShadowInvisibleContentTest.java
index 94f44b6369..928ea48332 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/evaluation/ShadowInvisibleContentTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/evaluation/ShadowInvisibleContentTest.java
@@ -61,20 +61,20 @@ public class ShadowInvisibleContentTest extends AbstractOakCoreTest {
     }
 
     @Test
-    @Ignore  // TODO incomplete implementation of PermissionValidator.childNodeChanged()
     public void testShadowInvisibleProperty() throws Exception {
         setupPermission("/a", testPrincipal, true, PrivilegeConstants.JCR_ALL);
         setupPermission("/a", testPrincipal, false, PrivilegeConstants.REP_READ_PROPERTIES);
+        setupPermission("/a", testPrincipal, false, PrivilegeConstants.REP_ALTER_PROPERTIES);
 
         Root testRoot = getTestRoot();
         Tree a = testRoot.getTree("/a");
 
         // /a/x not visible to this session
-        assertNull(a.getProperty("x"));
+        assertNull(a.getProperty("aProp"));
 
         // shadow /a/x with transient property of the same name
-        a.setProperty("x", "xValue1");
-        assertNotNull(a.getProperty("x"));
+        a.setProperty("aProp", "aValue1");
+        assertNotNull(a.getProperty("aProp"));
 
         try {
             testRoot.commit();
