diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/mongo/MongoJournal.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/mongo/MongoJournal.java
index cb10522817..d2b3f4a13f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/mongo/MongoJournal.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/mongo/MongoJournal.java
@@ -142,6 +142,9 @@ class MongoJournal implements Journal {
             return false;
         }
 
+        // Flush any pending records
+        store.getWriter().flush();
+
         BasicDBObjectBuilder builder = BasicDBObjectBuilder.start();
         builder.add("_id", name);
         if (state.containsField("parent")) {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/mongo/MongoStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/mongo/MongoStore.java
index 4d465c41af..41d0523666 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/mongo/MongoStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/mongo/MongoStore.java
@@ -82,8 +82,11 @@ public class MongoStore extends AbstractStore {
     @Override
     public void writeSegment(
             UUID segmentId, byte[] data, int offset, int length) {
-        byte[] d = new byte[length];
-        System.arraycopy(data, offset, d, 0, length);
+        if (offset != 0 || length != data.length) {
+            byte[] b = new byte[length];
+            System.arraycopy(data, offset, b, 0, length);
+            data = b;
+        }
 
         BasicDBObject segment = new BasicDBObject();
         segment.put("_id", segmentId.toString());
