diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ChildNodeJoinConditionImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ChildNodeJoinConditionImpl.java
index 6213557f38..00ba5ff9da 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ChildNodeJoinConditionImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ChildNodeJoinConditionImpl.java
@@ -93,4 +93,9 @@ public class ChildNodeJoinConditionImpl extends JoinConditionImpl {
         // nothing to do
     }
 
+    @Override
+    public boolean isParent(SourceImpl source) {
+        return source == parentSelector;
+    }
+
 }
\ No newline at end of file
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DescendantNodeJoinConditionImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DescendantNodeJoinConditionImpl.java
index 8e5f945dcb..a091bd54a9 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DescendantNodeJoinConditionImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DescendantNodeJoinConditionImpl.java
@@ -93,4 +93,9 @@ public class DescendantNodeJoinConditionImpl extends JoinConditionImpl {
         // nothing to do
     }
 
+    @Override
+    public boolean isParent(SourceImpl source) {
+        return source == ancestorSelector;
+    }
+
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java
index 01d1ce29d4..588c5aa294 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java
@@ -142,5 +142,10 @@ public class EquiJoinConditionImpl extends JoinConditionImpl {
             s.restrictSelector(ex);
         }
     }
+    
+    @Override
+    public boolean isParent(SourceImpl source) {
+        return false;
+    }
 
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinConditionImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinConditionImpl.java
index f5c82986d4..c39e6dab81 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinConditionImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinConditionImpl.java
@@ -51,4 +51,14 @@ public abstract class JoinConditionImpl extends AstElement {
      */
     public abstract void restrictPushDown(SelectorImpl s);
 
+    /**
+     * Check whether the given source is the parent of the join condition, as
+     * selector "[b]" is the parent of the join condition
+     * "isdescendantnode([a], [b])".
+     * 
+     * @param source the source
+     * @return true if the source is the parent
+     */
+    public abstract boolean isParent(SourceImpl source);
+
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinImpl.java
index ff6a4d8ca1..8ad8a00913 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinImpl.java
@@ -106,9 +106,16 @@ public class JoinImpl extends SourceImpl {
         }
         left.setQueryConstraint(queryConstraint);
         right.setQueryConstraint(queryConstraint);
+        setParent(joinCondition);
         right.init(query);
         left.init(query);
     }
+    
+    @Override
+    protected void setParent(JoinConditionImpl joinCondition) {
+        left.setParent(joinCondition);
+        right.setParent(joinCondition);
+    }
 
     @Override
     public void prepare() {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SameNodeJoinConditionImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SameNodeJoinConditionImpl.java
index 7ab0cbee9b..550466251d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SameNodeJoinConditionImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SameNodeJoinConditionImpl.java
@@ -117,5 +117,10 @@ public class SameNodeJoinConditionImpl extends JoinConditionImpl {
     public void restrictPushDown(SelectorImpl s) {
         // nothing to do
     }
+    
+    @Override
+    public boolean isParent(SourceImpl source) {
+        return false;
+    }
 
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
index a3689559b6..e1b7f68a2b 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
@@ -266,11 +266,32 @@ public class SelectorImpl extends SourceImpl {
         while (cursor != null && cursor.hasNext()) {
             scanCount++;
             currentRow = cursor.next();
-            Tree tree = getTree(currentRow.getPath());
-            if (tree == null || !tree.exists()) {
-                continue;
+            if (isParent) {
+                // we must not check whether the _parent_ is readable
+                // for joins of type
+                // "select [b].[jcr:primaryType]
+                // from [nt:base] as [a] 
+                // inner join [nt:base] as [b] 
+                // on isdescendantnode([b], [a]) 
+                // where [b].[jcr:path] = $path"
+                // because if we did, we would filter out
+                // correct results
+            } else {
+                // we must check whether the _child_ is readable
+                // (even if no properties are read) for joins of type
+                // "select [a].[jcr:primaryType]
+                // from [nt:base] as [a] 
+                // inner join [nt:base] as [b] 
+                // on isdescendantnode([b], [a]) 
+                // where [a].[jcr:path] = $path"
+                // because not checking would reveal existence
+                // of the child node
+                Tree tree = getTree(currentRow.getPath());
+                if (tree == null || !tree.exists()) {
+                    continue;
+                }
             }
-            if (!matchesAllTypes && !evaluateTypeMatch(tree)) {
+            if (!matchesAllTypes && !evaluateTypeMatch()) {
                 continue;
             }
             if (selectorCondition != null && !selectorCondition.evaluate()) {
@@ -286,7 +307,11 @@ public class SelectorImpl extends SourceImpl {
         return false;
     }
 
-    private boolean evaluateTypeMatch(Tree tree) {
+    private boolean evaluateTypeMatch() {
+        Tree tree = getTree(currentRow.getPath());
+        if (tree == null || !tree.exists()) {
+            return false;
+        }
         PropertyState primary = tree.getProperty(JCR_PRIMARYTYPE);
         if (primary != null && primary.getType() == NAME) {
             String name = primary.getValue(NAME);
@@ -401,4 +426,11 @@ public class SelectorImpl extends SourceImpl {
         return selectorName.hashCode();
     }
 
+    @Override
+    protected void setParent(JoinConditionImpl joinCondition) {
+        if (joinCondition.isParent(this)) {
+            isParent = true;
+        }
+    }
+
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SourceImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SourceImpl.java
index c332f24cb7..d1964a6529 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SourceImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SourceImpl.java
@@ -68,6 +68,13 @@ public abstract class SourceImpl extends AstElement {
      */
     protected boolean outerJoinRightHandSide;
     
+    /**
+     * Whether this selector is the parent of a descendent or parent-child join.
+     * Access rights don't need to be checked in such selectors (unless there
+     * are conditions on the selector).
+     */
+    protected boolean isParent;
+    
     /**
      * Set the complete constraint of the query (the WHERE ... condition).
      *
@@ -161,4 +168,6 @@ public abstract class SourceImpl extends AstElement {
      */
     public abstract boolean next();
 
+    abstract void setParent(JoinConditionImpl joinCondition);
+
 }
