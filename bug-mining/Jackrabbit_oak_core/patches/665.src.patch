diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/Oak.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/Oak.java
index 76d4ea2164..144008c142 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/Oak.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/Oak.java
@@ -83,6 +83,7 @@ import org.apache.jackrabbit.oak.spi.state.NodeStore;
 import org.apache.jackrabbit.oak.spi.whiteboard.DefaultWhiteboard;
 import org.apache.jackrabbit.oak.spi.whiteboard.Registration;
 import org.apache.jackrabbit.oak.spi.whiteboard.Whiteboard;
+import org.apache.jackrabbit.oak.spi.whiteboard.WhiteboardAware;
 import org.apache.jackrabbit.oak.spi.whiteboard.WhiteboardUtils;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -400,6 +401,9 @@ public class Oak {
     @Nonnull
     public Oak with(@Nonnull SecurityProvider securityProvider) {
         this.securityProvider = checkNotNull(securityProvider);
+        if (securityProvider instanceof WhiteboardAware) {
+            ((WhiteboardAware) securityProvider).setWhiteboard(whiteboard);
+        }
         for (SecurityConfiguration sc : securityProvider.getConfigurations()) {
             RepositoryInitializer ri = sc.getRepositoryInitializer();
             if (ri != RepositoryInitializer.DEFAULT) {
@@ -444,6 +448,10 @@ public class Oak {
     @Nonnull
     public Oak with(@Nonnull Whiteboard whiteboard) {
         this.whiteboard = checkNotNull(whiteboard);
+        if (securityProvider instanceof WhiteboardAware) {
+            ((WhiteboardAware) securityProvider).setWhiteboard(whiteboard);
+        }
+
         return this;
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/SecurityProviderImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/SecurityProviderImpl.java
index 153f407d36..a3a9cbce06 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/SecurityProviderImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/SecurityProviderImpl.java
@@ -58,18 +58,20 @@ import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeConfiguration;
 import org.apache.jackrabbit.oak.spi.security.user.AuthorizableNodeName;
 import org.apache.jackrabbit.oak.spi.security.user.UserConfiguration;
 import org.apache.jackrabbit.oak.spi.security.user.UserConstants;
-import org.apache.jackrabbit.oak.spi.whiteboard.DefaultWhiteboard;
 import org.apache.jackrabbit.oak.spi.whiteboard.Whiteboard;
 import org.apache.jackrabbit.oak.spi.whiteboard.WhiteboardAuthorizableActionProvider;
+import org.apache.jackrabbit.oak.spi.whiteboard.WhiteboardAware;
 import org.apache.jackrabbit.oak.spi.whiteboard.WhiteboardRestrictionProvider;
 import org.osgi.framework.ServiceReference;
 import org.osgi.service.component.ComponentContext;
 
 import com.google.common.collect.ImmutableMap;
 
+import static com.google.common.base.Preconditions.checkNotNull;
+
 @Component(immediate = true)
 @Service
-public class SecurityProviderImpl implements SecurityProvider {
+public class SecurityProviderImpl implements SecurityProvider, WhiteboardAware {
 
     @Reference(bind = "bindAuthorizationConfiguration",
             cardinality = ReferenceCardinality.MANDATORY_UNARY, // FIXME OAK-1268
@@ -116,12 +118,12 @@ public class SecurityProviderImpl implements SecurityProvider {
 
     private ConfigurationParameters configuration;
 
-    private Whiteboard whiteboard = new DefaultWhiteboard();
+    private Whiteboard whiteboard;
 
     /**
      * Default constructor used in OSGi environments.
      */
-    protected SecurityProviderImpl() {
+    public SecurityProviderImpl() {
         this(ConfigurationParameters.EMPTY);
     }
 
@@ -129,7 +131,8 @@ public class SecurityProviderImpl implements SecurityProvider {
      * Constructor used for non OSGi environments.
      * @param configuration security configuration
      */
-    public SecurityProviderImpl(ConfigurationParameters configuration) {
+    public SecurityProviderImpl(@Nonnull ConfigurationParameters configuration) {
+        checkNotNull(configuration);
         this.configuration = configuration;
 
         authenticationConfiguration = new AuthenticationConfigurationImpl(this);
@@ -138,12 +141,22 @@ public class SecurityProviderImpl implements SecurityProvider {
         principalConfiguration = new PrincipalConfigurationImpl(this);
         privilegeConfiguration = new PrivilegeConfigurationImpl();
         tokenConfiguration = new TokenConfigurationImpl(this);
+    }
+
+    @Override
+    public void setWhiteboard(@Nonnull Whiteboard whiteboard) {
+        this.whiteboard = whiteboard;
 
         // register non-OSGi managers
         whiteboard.register(SyncManager.class, new SyncManagerImpl(whiteboard), Collections.emptyMap());
         whiteboard.register(ExternalIdentityProviderManager.class, new ExternalIDPManagerImpl(whiteboard), Collections.emptyMap());
     }
 
+    @Override
+    public Whiteboard getWhiteboard() {
+        return whiteboard;
+    }
+
     @Nonnull
     @Override
     public ConfigurationParameters getParameters(@Nullable String name) {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/whiteboard/WhiteboardAware.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/whiteboard/WhiteboardAware.java
new file mode 100644
index 0000000000..8380bd8205
--- /dev/null
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/whiteboard/WhiteboardAware.java
@@ -0,0 +1,39 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.jackrabbit.oak.spi.whiteboard;
+
+import javax.annotation.CheckForNull;
+import javax.annotation.Nonnull;
+
+/**
+ * Marker interface for services than can hold a whiteboard.
+ */
+public interface WhiteboardAware {
+
+    /**
+     * Sets the whiteboard.
+     * @param whiteboard the whiteboard
+     */
+    void setWhiteboard(@Nonnull Whiteboard whiteboard);
+
+    /**
+     * Returns the whiteboard
+     * @return the whiteboard
+     */
+    @CheckForNull
+    Whiteboard getWhiteboard();
+}
\ No newline at end of file
