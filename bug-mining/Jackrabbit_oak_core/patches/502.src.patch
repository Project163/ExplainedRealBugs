diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
index bbde54e3c9..c9b006c8da 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
@@ -631,7 +631,11 @@ public class QueryImpl implements Query {
         if (namePathMapper == null) {
             return path;
         }
-        return namePathMapper.getOakPath(path);
+        String p = namePathMapper.getOakPath(path);
+        if (p == null) {
+            throw new IllegalArgumentException("Invalid path or namespace prefix: " + path);
+        }
+        return p;
     }
 
     @Override
