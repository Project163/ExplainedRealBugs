diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/IdentityNameMapper.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/IdentityNameMapper.java
new file mode 100644
index 0000000000..711bf65263
--- /dev/null
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/IdentityNameMapper.java
@@ -0,0 +1,70 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.jackrabbit.oak.namepath;
+
+import java.util.Map;
+
+import javax.annotation.CheckForNull;
+
+import org.apache.jackrabbit.oak.api.Tree;
+import org.apache.jackrabbit.oak.plugins.name.Namespaces;
+
+/**
+ * Name mapper with no local prefix remappings. URI to prefix mappings
+ * are read from the repository when needed.
+ */
+public class IdentityNameMapper implements NameMapper {
+
+    private final Tree root;
+
+    public IdentityNameMapper(Tree root) {
+        this.root = root;
+    }
+
+    @Override @CheckForNull
+    public String getJcrName(String oakName) {
+        assert !oakName.startsWith(":"); // hidden name
+        return oakName;
+    }
+
+    @Override @CheckForNull
+    public String getOakName(String jcrName) {
+        if (jcrName.startsWith("{")) { // Could it be an expanded name?
+            int colon = jcrName.indexOf(':');
+            int brace = jcrName.indexOf('}');
+            if (0 < colon && colon < brace) { // Yes, it looks like one
+                String uri = jcrName.substring(1, brace);
+                String name = jcrName.substring(brace + 1);
+                for (Map.Entry<String, String> entry
+                        : Namespaces.getNamespaceMap(root).entrySet()) {
+                    if (uri.equals(entry.getValue())) {
+                        return entry.getKey() + ':' + name;
+                    }
+                }
+                return null;
+            }
+        }
+
+        return jcrName;
+    }
+
+    @Override
+    public boolean hasSessionLocalMappings() {
+        return false;
+    }
+
+}
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/NameMapperImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/NameMapperImpl.java
deleted file mode 100644
index 233bdaaa90..0000000000
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/NameMapperImpl.java
+++ /dev/null
@@ -1,70 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-package org.apache.jackrabbit.oak.namepath;
-
-import javax.annotation.CheckForNull;
-import javax.jcr.NamespaceRegistry;
-import javax.jcr.RepositoryException;
-
-import org.apache.jackrabbit.oak.api.Tree;
-import org.apache.jackrabbit.oak.plugins.name.ReadOnlyNamespaceRegistry;
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-
-public class NameMapperImpl extends AbstractNameMapper {
-    private static final Logger log = LoggerFactory.getLogger(NameMapperImpl.class);
-
-    private final Tree root;
-    private final NamespaceRegistry nsReg = new ReadOnlyNamespaceRegistry() {
-        @Override
-        protected Tree getReadTree() {
-            return root;
-        }
-    };
-
-    public NameMapperImpl(Tree root) {
-        this.root = root;
-    }
-
-    @Override
-    @CheckForNull
-    protected String getJcrPrefix(String oakPrefix) {
-        return oakPrefix;
-    }
-
-    @Override
-    @CheckForNull
-    protected String getOakPrefix(String jcrPrefix) {
-        return jcrPrefix;
-    }
-
-    @Override
-    @CheckForNull
-    protected String getOakPrefixFromURI(String uri) {
-        try {
-            return nsReg.getPrefix(uri);
-        } catch (RepositoryException e) {
-            log.debug("Could not get OAK prefix for URI " + uri);
-            return null;
-        }
-    }
-
-    @Override
-    public boolean hasSessionLocalMappings() {
-        return false;
-    }
-}
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/nodetype/DefBuilderFactory.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/nodetype/DefBuilderFactory.java
index 383d3fd7ee..a314bd92ff 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/nodetype/DefBuilderFactory.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/nodetype/DefBuilderFactory.java
@@ -23,7 +23,7 @@ import javax.jcr.nodetype.NodeTypeTemplate;
 import org.apache.jackrabbit.JcrConstants;
 import org.apache.jackrabbit.commons.cnd.DefinitionBuilderFactory;
 import org.apache.jackrabbit.oak.api.Tree;
-import org.apache.jackrabbit.oak.namepath.NameMapperImpl;
+import org.apache.jackrabbit.oak.namepath.IdentityNameMapper;
 import org.apache.jackrabbit.oak.plugins.name.NamespaceConstants;
 import org.apache.jackrabbit.oak.plugins.name.Namespaces;
 
@@ -38,7 +38,7 @@ class DefBuilderFactory extends
 
     @Override
     public NodeTypeTemplateImpl newNodeTypeDefinitionBuilder() {
-        return new NodeTypeTemplateImpl(new NameMapperImpl(root));
+        return new NodeTypeTemplateImpl(new IdentityNameMapper(root));
     }
 
     @Override
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/nodetype/TypeValidatorProvider.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/nodetype/TypeValidatorProvider.java
index 34e8e30b9e..b97cb0f449 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/nodetype/TypeValidatorProvider.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/nodetype/TypeValidatorProvider.java
@@ -19,7 +19,7 @@ package org.apache.jackrabbit.oak.plugins.nodetype;
 import org.apache.felix.scr.annotations.Component;
 import org.apache.felix.scr.annotations.Service;
 import org.apache.jackrabbit.oak.core.ReadOnlyTree;
-import org.apache.jackrabbit.oak.namepath.NameMapperImpl;
+import org.apache.jackrabbit.oak.namepath.IdentityNameMapper;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
 import org.apache.jackrabbit.oak.namepath.NamePathMapperImpl;
 import org.apache.jackrabbit.oak.spi.commit.Validator;
@@ -34,7 +34,7 @@ public class TypeValidatorProvider implements ValidatorProvider {
     public Validator getRootValidator(NodeState before, final NodeState after) {
         ReadOnlyNodeTypeManager ntm = new ValidatingNodeTypeManager(after);
         ReadOnlyTree root = new ReadOnlyTree(after);
-        final NamePathMapper mapper = new NamePathMapperImpl(new NameMapperImpl(root));
+        final NamePathMapper mapper = new NamePathMapperImpl(new IdentityNameMapper(root));
         return new TypeValidator(ntm, root, mapper);
     }
 
