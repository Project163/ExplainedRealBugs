diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
index 9b926734af..461c567de9 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
@@ -192,19 +192,19 @@ public class FileStore implements SegmentStore {
                 String.format(FILE_NAME_FORMAT, writeNumber, "a"));
         this.writer = new TarWriter(writeFile);
 
-        LinkedList<RecordId> heads = newLinkedList();
+        LinkedList<String> heads = newLinkedList();
         String line = journalFile.readLine();
         while (line != null) {
             int space = line.indexOf(' ');
             if (space != -1) {
-                heads.add(RecordId.fromString(tracker, line.substring(0, space)));
+                heads.add(line.substring(0, space));
             }
             line = journalFile.readLine();
         }
 
         RecordId id = null;
         while (id == null && !heads.isEmpty()) {
-            RecordId last = heads.removeLast();
+            RecordId last = RecordId.fromString(tracker, heads.removeLast());
             SegmentId segmentId = last.getSegmentId();
             if (containsSegment(
                     segmentId.getMostSignificantBits(),
@@ -629,6 +629,12 @@ public class FileStore implements SegmentStore {
         compactionThread.trigger();
     }
 
+    public void accept(TarEntryVisitor visitor) throws IOException {
+        for (TarReader reader : readers) {
+            reader.accept(visitor);
+        }
+    }
+
     public Map<String, Set<UUID>> getTarReaderIndex() {
         Map<String, Set<UUID>> index = new HashMap<String, Set<UUID>>();
         for (TarReader reader : readers) {
