diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Compactor.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Compactor.java
index 3e1a5b16b7..5214f66ec8 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Compactor.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Compactor.java
@@ -144,11 +144,12 @@ public class Compactor {
             if (state.getChildNodeCount(2) > 1) {
                 return true;
             }
-            int count = 0;
+            long count = 0;
             for (PropertyState ps : state.getProperties()) {
                 for (int i = 0; i < ps.count(); i++) {
-                    count += ps.size(i);
-                    if (count >= threshold) {
+                    long size = ps.size(i);
+                    count += size;
+                    if (size >= threshold || count >= threshold) {
                         return true;
                     }
                 }
