diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImpl.java
index a257e6904a..910896626d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImpl.java
@@ -239,46 +239,49 @@ public class NamePathMapperImpl implements NamePathMapper {
         int colon = -1; // index of the last colon in the path
 
         switch (path.charAt(0)) {
-        case '{': // possibly an expanded name
-        case '[': // starts with an identifier
-        case '.': // possibly "." or ".."
-        case ':': // colon as the first character
-            return true;
-        case '/':
-            if (length == 1) {
-                return false; // the root path
-            }
-            slash = 0;
-            break;
-        }
-
-        for (int i = 1; i < length; i++) {
-            switch (path.charAt(i)) {
             case '{': // possibly an expanded name
-            case '[': // possibly an index
+            case '[': // starts with an identifier
+            case '.': // possibly "." or ".."
+            case ':': // colon as the first character
                 return true;
-            case '.':
-                if (i == slash + 1) {
-                    return true; // possibly "." or ".."
-                }
-                break;
-            case ':':
-                if (i == slash + 1              // "x/:y"
-                        || i == colon + i       // "x::y"
-                        || colon > slash        // "x:y:z"
-                        || i + 1 == length) {   // "x:"
-                    return true;
-                }
-                colon = i;
-                break;
             case '/':
-                if (i == slash + 1              // "x//y"
-                        || i == colon + i       // "x:/y"
-                        || i + 1 == length) {   // "x/"
-                    return true;
+                if (length == 1) {
+                    return false; // the root path
                 }
-                slash = i;
+                slash = 0;
                 break;
+        }
+
+        for (int i = 1; i < length; i++) {
+            switch (path.charAt(i)) {
+                case '{': // possibly an expanded name
+                case '[': // possibly an index
+                case ']': // illegal character if not part of index
+                case '|': // illegal character
+                case '*': // illegal character
+                    return true;
+                case '.':
+                    if (i == slash + 1) {
+                        return true; // possibly "." or ".."
+                    }
+                    break;
+                case ':':
+                    if (i == slash + 1              // "x/:y"
+                            || i == colon + i       // "x::y"
+                            || colon > slash        // "x:y:z"
+                            || i + 1 == length) {   // "x:"
+                        return true;
+                    }
+                    colon = i;
+                    break;
+                case '/':
+                    if (i == slash + 1              // "x//y"
+                            || i == colon + i       // "x:/y"
+                            || i + 1 == length) {   // "x/"
+                        return true;
+                    }
+                    slash = i;
+                    break;
             }
         }
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImplTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImplTest.java
index 6414faef48..e227fe298e 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImplTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImplTest.java
@@ -16,23 +16,21 @@
  */
 package org.apache.jackrabbit.oak.namepath;
 
-import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNull;
-import static org.junit.Assert.fail;
-
 import java.util.ArrayList;
 import java.util.Collections;
 import java.util.List;
 import java.util.Map;
-
 import javax.jcr.RepositoryException;
 
 import com.google.common.collect.ImmutableMap;
-
 import org.apache.jackrabbit.oak.plugins.identifier.IdentifierManager;
 import org.junit.Test;
 
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertNull;
+import static org.junit.Assert.fail;
+
 public class NamePathMapperImplTest {
 
     private static final Map<String, String> GLOBAL = ImmutableMap.of(
@@ -167,7 +165,10 @@ public class NamePathMapperImplTest {
                 "/foo/../..",
                 "foo::bar",
                 "foo:bar:baz",
-//                "foo:bar]baz",  FIXME OAK-1168
+                "foo:bar]baz",
+                "foo:bar[baz",
+                "foo:bar|baz",
+                "foo:bar*baz"
         };
 
         NamePathMapper[] mappers = {
