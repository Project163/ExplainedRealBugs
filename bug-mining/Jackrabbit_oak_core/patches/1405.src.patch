diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserAuthentication.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserAuthentication.java
index f7b3b693a9..95fd76ae33 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserAuthentication.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserAuthentication.java
@@ -169,7 +169,7 @@ class UserAuthentication implements Authentication, UserConstants {
                 }
             }
         } catch (PasswordHistoryException e) {
-            credentials.setAttribute(e.getClass().getName(), e.getMessage());
+            credentials.setAttribute(e.getClass().getSimpleName(), e.getMessage());
             log.error("Failed to change password for user " + userId, e.getMessage());
         } catch (RepositoryException e) {
             log.error("Failed to change password for user " + userId, e.getMessage());
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/PasswordExpiryHistoryTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/PasswordExpiryHistoryTest.java
index dbbc0864fd..b683acbb25 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/PasswordExpiryHistoryTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/PasswordExpiryHistoryTest.java
@@ -98,7 +98,7 @@ public class PasswordExpiryHistoryTest extends AbstractSecurityTest {
                 fail("User password changed in spite of enabled pw history");
             } catch (CredentialExpiredException c) {
                 // success, pw found in history
-                Object attr = pwChangeCreds.getAttribute(PasswordHistoryException.class.getName());
+                Object attr = pwChangeCreds.getAttribute(PasswordHistoryException.class.getSimpleName());
                 assertEquals(
                         "credentials should contain pw change failure reason",
                         "New password is identical to the current password.",
@@ -129,7 +129,7 @@ public class PasswordExpiryHistoryTest extends AbstractSecurityTest {
                 fail("User password changed in spite of enabled pw history");
             } catch (CredentialExpiredException c) {
                 // success, pw found in history
-                Object attr = pwChangeCreds.getAttribute(PasswordHistoryException.class.getName());
+                Object attr = pwChangeCreds.getAttribute(PasswordHistoryException.class.getSimpleName());
                 assertEquals(
                         "credentials should contain pw change failure reason",
                         "New password was found in password history.",
@@ -159,7 +159,7 @@ public class PasswordExpiryHistoryTest extends AbstractSecurityTest {
                 fail("User password changed in spite of expected validation failure");
             } catch (CredentialExpiredException c) {
                 // success, pw found in history
-                assertNull(pwChangeCreds.getAttribute(PasswordHistoryException.class.getName()));
+                assertNull(pwChangeCreds.getAttribute(PasswordHistoryException.class.getSimpleName()));
             }
         }
     }
