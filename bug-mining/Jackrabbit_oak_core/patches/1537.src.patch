diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/AuthorizableBaseProvider.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/AuthorizableBaseProvider.java
index 66452c700e..4a3e81dc2e 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/AuthorizableBaseProvider.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/AuthorizableBaseProvider.java
@@ -48,7 +48,7 @@ abstract class AuthorizableBaseProvider implements UserConstants {
 
     @CheckForNull
     Tree getByID(@Nonnull String authorizableId, @Nonnull AuthorizableType authorizableType) {
-        return getByContentID(getContentID(authorizableId), authorizableType);
+        return getByContentID(getContentID(authorizableId, config.getConfigValue(PARAM_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE, DEFAULT_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE)), authorizableType);
     }
 
     @CheckForNull
@@ -77,7 +77,11 @@ abstract class AuthorizableBaseProvider implements UserConstants {
     }
 
     @Nonnull
-    static String getContentID(@Nonnull String authorizableId) {
-        return generateUUID(authorizableId.toLowerCase());
+    static String getContentID(@Nonnull String authorizableId, boolean usercaseMappedProfile) {
+        String s = authorizableId.toLowerCase();
+        if (usercaseMappedProfile) {
+            s = java.text.Normalizer.normalize(s, java.text.Normalizer.Form.NFKC);
+        }
+        return generateUUID(s);
     }
 }
\ No newline at end of file
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/GroupImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/GroupImpl.java
index 46c27fcd26..893ebfb2a4 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/GroupImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/GroupImpl.java
@@ -283,7 +283,7 @@ class GroupImpl extends AuthorizableImpl implements Group {
             }
 
             idIterator.remove();
-            updateMap.put(AuthorizableBaseProvider.getContentID(memberId), memberId);
+            updateMap.put(AuthorizableBaseProvider.getContentID(memberId, getUserManager().getConfig().getConfigValue(PARAM_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE, DEFAULT_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE)), memberId);
         }
 
         Set<String> processedIds = Sets.newHashSet(updateMap.values());
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserConfigurationImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserConfigurationImpl.java
index eddba3a3c7..f6d96de7d7 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserConfigurationImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserConfigurationImpl.java
@@ -120,7 +120,11 @@ import org.apache.jackrabbit.oak.spi.xml.ProtectedItemImporter;
                 description = "Optional configuration defining the number of milliseconds " +
                         "until the principal cache expires (NOTE: currently only respected for principal resolution with the internal system session such as used for login). " +
                         "If not set or equal/lower than zero no caches are created/evaluated.",
-                longValue = UserPrincipalProvider.EXPIRATION_NO_CACHE)
+                longValue = UserPrincipalProvider.EXPIRATION_NO_CACHE),
+        @Property(name = UserConstants.PARAM_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE,
+                label = "RFC7613 Username Comparison Profile",
+                description = "Enable the UsercaseMappedProfile defined in RFC7613 for username comparison.",
+                boolValue = false)
 })
 public class UserConfigurationImpl extends ConfigurationBase implements UserConfiguration, SecurityConfiguration {
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserProvider.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserProvider.java
index f9a4d26f91..7c6b51737c 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserProvider.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserProvider.java
@@ -270,7 +270,7 @@ class UserProvider extends AuthorizableBaseProvider {
         String userId = Strings.nullToEmpty(root.getContentSession().getAuthInfo().getUserID());
         Tree authorizableNode = TreeUtil.addChild(folder, nodeName, ntName, typeRoot, userId);
         authorizableNode.setProperty(REP_AUTHORIZABLE_ID, authorizableId);
-        authorizableNode.setProperty(JcrConstants.JCR_UUID, getContentID(authorizableId));
+        authorizableNode.setProperty(JcrConstants.JCR_UUID, getContentID(authorizableId, config.getConfigValue(PARAM_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE, DEFAULT_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE)));
 
         return authorizableNode;
     }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserValidator.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserValidator.java
index 4c33f3c451..2282cbd7a1 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserValidator.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/UserValidator.java
@@ -223,9 +223,9 @@ class UserValidator extends DefaultValidator implements UserConstants {
         }
     }
 
-    private static boolean isValidUUID(@Nonnull Tree parent, @Nonnull String uuid) {
+    private boolean isValidUUID(@Nonnull Tree parent, @Nonnull String uuid) {
         String id = UserUtil.getAuthorizableId(parent);
-        return id != null && uuid.equals(UserProvider.getContentID(id));
+        return id != null && uuid.equals(UserProvider.getContentID(id, provider.getConfig().getConfigValue(PARAM_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE, DEFAULT_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE)));
     }
 
     private static boolean isUser(@Nullable Tree tree) {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/UserConstants.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/UserConstants.java
index c58471e45a..ac8729ba40 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/UserConstants.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/UserConstants.java
@@ -169,6 +169,19 @@ public interface UserConstants {
      */
     String PARAM_PASSWORD_SALT_SIZE = "passwordSaltSize";
 
+    /**
+     * Optionally enables the UsernameCaseMapped profile defined in
+     * https://tools.ietf.org/html/rfc7613#section-3.2 for user name comparison.
+     * Use this if half-width and full-width user names should be considered
+     * equal.
+     */
+    String PARAM_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE = "enableRFC7613UsercaseMappedProfile";
+
+    /**
+     * Default value for {@link #PARAM_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE}
+     */
+    boolean DEFAULT_ENABLE_RFC7613_USERCASE_MAPPED_PROFILE = false;
+
     /**
      * Optional configuration parameter defining how to generate the name of the
      * authorizable node from the ID of the new authorizable that is being created.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/package-info.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/package-info.java
index 1b60fe3573..5e9de12817 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/package-info.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/user/package-info.java
@@ -14,7 +14,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-@Version("2.1.0")
+@Version("2.2.0")
 @Export(optional = "provide:=true")
 package org.apache.jackrabbit.oak.spi.security.user;
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/AddMembersByIdBestEffortTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/AddMembersByIdBestEffortTest.java
index a92074671e..8e46883f64 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/AddMembersByIdBestEffortTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/AddMembersByIdBestEffortTest.java
@@ -126,7 +126,8 @@ public class AddMembersByIdBestEffortTest extends AbstractAddMembersByIdTest {
 
     @Test
     public void testAddByContentID() throws Exception {
-        Set<String> failed = testGroup.addMembers(AuthorizableBaseProvider.getContentID(getTestUser().getID()));
+        //TODO
+        Set<String> failed = testGroup.addMembers(AuthorizableBaseProvider.getContentID(getTestUser().getID(), false));
         assertTrue(failed.isEmpty());
 
         assertFalse(testGroup.isMember(getTestUser()));
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/MembershipProviderTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/MembershipProviderTest.java
index 2d67491d9f..f09c72260e 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/MembershipProviderTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/MembershipProviderTest.java
@@ -518,8 +518,9 @@ public class MembershipProviderTest extends AbstractSecurityTest implements User
 
         // 4. remove members from the initial set => ref nodes as before, rep:members prop on group modified
         memberIds.clear();
-        memberIds.put(MembershipProvider.getContentID("member1"), "member1");
-        memberIds.put(MembershipProvider.getContentID("member2"), "member2");
+        //TODO
+        memberIds.put(MembershipProvider.getContentID("member1", false), "member1");
+        memberIds.put(MembershipProvider.getContentID("member2", false), "member2");
         mp.removeMembers(groupTree, Maps.newHashMap(memberIds));
 
         assertMemberList(groupTree, 3, 5);
@@ -570,7 +571,8 @@ public class MembershipProviderTest extends AbstractSecurityTest implements User
         Map<String, String> memberIds = Maps.newLinkedHashMap();
         for (int i = start; i < end; i++) {
             String memberId = "member" + i;
-            memberIds.put(MembershipProvider.getContentID(memberId), memberId);
+            //TODO
+            memberIds.put(MembershipProvider.getContentID(memberId, false), memberId);
         }
         return memberIds;
     }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/UserValidatorTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/UserValidatorTest.java
index 9dfe08c80e..d9effa9ecc 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/UserValidatorTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/UserValidatorTest.java
@@ -287,7 +287,8 @@ public class UserValidatorTest extends AbstractSecurityTest implements UserConst
                 }
                 Tree userTree = parent.addChild("testUser");
                 userTree.setProperty(JcrConstants.JCR_PRIMARYTYPE, NT_REP_USER, Type.NAME);
-                userTree.setProperty(JcrConstants.JCR_UUID, UserProvider.getContentID("testUser"));
+                //TODO
+                userTree.setProperty(JcrConstants.JCR_UUID, UserProvider.getContentID("testUser", false));
                 userTree.setProperty(REP_PRINCIPAL_NAME, "testUser");
                 root.commit();
                 fail("Invalid hierarchy should be detected");
