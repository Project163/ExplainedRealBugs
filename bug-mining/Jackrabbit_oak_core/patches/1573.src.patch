diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/XPathToSQL2Converter.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/XPathToSQL2Converter.java
index 27274c2876..c1ffdc970f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/XPathToSQL2Converter.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/XPathToSQL2Converter.java
@@ -1095,10 +1095,12 @@ public class XPathToSQL2Converter {
             parseIndex = converter.parseIndex;
             if (converter.readIf("(")) {
                 level++;
-            } else if (converter.readIf(")") && level-- <= 0) {
-                break;
+            } else if (converter.readIf(")")) {
+                if (level-- <= 0) {
+                    break;
+                }
             } else if (converter.readIf("|") && level == 0) {
-                String or = partList.substring(lastOrIndex, lastParseIndex);
+                String or = partList.substring(lastOrIndex, parseIndex - 1);
                 parts.add(or);
                 lastOrIndex = parseIndex;
             } else if (converter.currentTokenType == END) {
@@ -1106,9 +1108,8 @@ public class XPathToSQL2Converter {
             } else {
                 converter.read();
             }
-            lastParseIndex = parseIndex;
         }
-        String or = partList.substring(lastOrIndex, lastParseIndex);
+        String or = partList.substring(lastOrIndex, parseIndex - 1);
         parts.add(or);        
         String end = partList.substring(parseIndex);
         Statement result = null;
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/XPathTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/XPathTest.java
index 4f1782e8de..645d761ecc 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/XPathTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/XPathTest.java
@@ -87,6 +87,33 @@ public class XPathTest {
     
     @Test
     public void union() throws ParseException {
+        verify("//(a|(b|c))",
+                "select [jcr:path], [jcr:score], * " +
+                "from [nt:base] as a " +
+                "where name(a) = 'a' " +
+                "/* xpath: //a */ " +
+                "union select [jcr:path], [jcr:score], * " +
+                "from [nt:base] as a " +
+                "where name(a) = 'b' " +
+                "/* xpath: //b */ " +
+                "union select [jcr:path], [jcr:score], * " +
+                "from [nt:base] as a " +
+                "where name(a) = 'c' " +
+                "/* xpath: //c */");
+        verify("(//*[jcr:contains(., 'some')])",
+                "select [jcr:path], [jcr:score], * " + 
+                "from [nt:base] as a " + 
+                "where contains(*, 'some') " + 
+                "/* xpath: //*[jcr:contains(., 'some')] */");
+        verify("(//*[jcr:contains(., 'x')] | //*[jcr:contains(., 'y')])",
+                "select [jcr:path], [jcr:score], * " + 
+                "from [nt:base] as a " + 
+                "where contains(*, 'x') " + 
+                "/* xpath: //*[jcr:contains(., 'x')] */ " + 
+                "union select [jcr:path], [jcr:score], * " + 
+                "from [nt:base] as a " + 
+                "where contains(*, 'y') " + 
+                "/* xpath: //*[jcr:contains(., 'y')] */");
         try {
             verify("(/jcr:root/x[@a][@b][@c]","");
             fail();
@@ -99,7 +126,7 @@ public class XPathTest {
                 "where [a] is not null " +
                 "and [c] is not null " +
                 "and issamenode(a, '/x') " +
-                "/* xpath: /jcr:root/x[@a][@c] */ " +
+                "/* xpath: /jcr:root/x[@a] [@c] */ " +
                 "union select [jcr:path], [jcr:score], * " +
                 "from [nt:base] as a " +
                 "where [b] is not null " +
@@ -129,7 +156,7 @@ public class XPathTest {
                 "from [nt:base] as a " + 
                 "where [a] is not null " + 
                 "and isdescendantnode(a, '/content') " + 
-                "/* xpath: /jcr:root/content//*[@a] " + 
+                "/* xpath: /jcr:root/content//*[@a]  " + 
                 "order by @c */ " + 
                 "union select [jcr:path], [jcr:score], * " + 
                 "from [nt:base] as a " + 
