diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Segment.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Segment.java
index c6dbadca98..29778c5054 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Segment.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Segment.java
@@ -229,7 +229,7 @@ public class Segment {
         for (int i = 0; i < blobrefcount; i++) {
             int offset = (data.getShort(blobrefpos + i * 2) & 0xffff) << 2;
             SegmentBlob blob = new SegmentBlob(new RecordId(id, offset));
-            collector.addReference(blob.getReference());
+            collector.addReference(blob.getBlobId());
         }
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentBlob.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentBlob.java
index 02a07996b3..f5c139f067 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentBlob.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentBlob.java
@@ -26,6 +26,7 @@ import javax.annotation.Nonnull;
 
 import org.apache.jackrabbit.oak.api.Blob;
 import org.apache.jackrabbit.oak.plugins.memory.AbstractBlob;
+import org.apache.jackrabbit.oak.spi.blob.BlobStore;
 
 import java.io.InputStream;
 
@@ -102,8 +103,24 @@ class SegmentBlob extends Record implements Blob {
         }
     }
 
-    @Override @CheckForNull
+    @Override
+    @CheckForNull
     public String getReference() {
+        String blobId = getBlobId();
+        if (blobId != null) {
+            BlobStore blobStore = getSegment().getSegmentId().getTracker().
+                    getStore().getBlobStore();
+            if (blobStore != null) {
+                return blobStore.getReference(blobId);
+            }else{
+                throw new IllegalStateException("Attempt to read external blob with blobId [" + blobId + "] " +
+                        "without specifying BlobStore");
+            }
+        }
+        return null;
+    }
+
+    public String getBlobId() {
         Segment segment = getSegment();
         int offset = getOffset();
         byte head = segment.readByte(offset);
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeStore.java
index f1dc2778ec..869a0bba84 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentNodeStore.java
@@ -39,6 +39,7 @@ import javax.annotation.Nullable;
 import org.apache.jackrabbit.oak.api.Blob;
 import org.apache.jackrabbit.oak.api.CommitFailedException;
 import org.apache.jackrabbit.oak.plugins.segment.memory.MemoryStore;
+import org.apache.jackrabbit.oak.spi.blob.BlobStore;
 import org.apache.jackrabbit.oak.spi.commit.ChangeDispatcher;
 import org.apache.jackrabbit.oak.spi.commit.CommitHook;
 import org.apache.jackrabbit.oak.spi.commit.CommitInfo;
@@ -176,7 +177,20 @@ public class SegmentNodeStore implements NodeStore, Observable {
 
     @Override
     public Blob getBlob(@Nonnull String reference) {
-        return store.readBlob(reference);
+        //Use of 'reference' here is bit overloaded. In terms of NodeStore API
+        //a blob reference refers to the secure reference obtained from Blob#getReference()
+        //However in SegmentStore terminology a blob is referred via 'external reference'
+        //That 'external reference' would map to blobId obtained from BlobStore#getBlobId
+        BlobStore blobStore = store.getBlobStore();
+        if (blobStore != null) {
+            String blobId = blobStore.getBlobId(reference);
+            if (blobId != null) {
+                return store.readBlob(blobId);
+            }
+            return null;
+        }
+        throw new IllegalStateException("Attempt to read external blob with blobId [" + reference + "] " +
+                "without specifying BlobStore");
     }
 
     @Override @Nonnull
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentWriter.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentWriter.java
index ea5e4a94a5..1b0a70e917 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentWriter.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentWriter.java
@@ -68,6 +68,8 @@ import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
 import com.google.common.io.ByteStreams;
 import com.google.common.io.Closeables;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 public class SegmentWriter {
 
@@ -97,6 +99,8 @@ public class SegmentWriter {
 
     private final SegmentStore store;
 
+    private final Logger log = LoggerFactory.getLogger(getClass());
+
     /**
      * Cache of recently stored string and template records, used to
      * avoid storing duplicates of frequently occurring data.
@@ -687,9 +691,14 @@ public class SegmentWriter {
         }
 
         String reference = blob.getReference();
-        if (reference != null) {
-            RecordId id = writeValueRecord(reference);
-            return new SegmentBlob(id);
+        if (reference != null && store.getBlobStore() != null) {
+            String blobId = store.getBlobStore().getBlobId(reference);
+            if(blobId != null) {
+                RecordId id = writeValueRecord(blobId);
+                return new SegmentBlob(id);
+            }else{
+                log.debug("No blobId found matching reference [{}]", reference);
+            }
         }
 
         return writeStream(blob.getNewStream());
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
index e1e8562754..8f1a5953da 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
@@ -399,11 +399,11 @@ public class FileStore implements SegmentStore {
     }
 
     @Override
-    public Blob readBlob(String reference) {
-        if(blobStore != null){
-            return new BlobStoreBlob(blobStore, reference);
+    public Blob readBlob(String blobId) {
+        if (blobStore != null) {
+            return new BlobStoreBlob(blobStore, blobId);
         }
-        throw new IllegalStateException("Attempt to read external reference ["+reference+"] " +
+        throw new IllegalStateException("Attempt to read external blob with blobId [" + blobId + "] " +
                 "without specifying BlobStore");
     }
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/ExternalBlobTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/ExternalBlobTest.java
index dc6f49b162..6b51bc5866 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/ExternalBlobTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/ExternalBlobTest.java
@@ -69,14 +69,15 @@ public class ExternalBlobTest {
         new Random().nextBytes(data);
         Blob b1 = testCreateAndRead(nodeStore.createBlob(new ByteArrayInputStream(data)));
         assertTrue(b1 instanceof SegmentBlob);
-        assertNull(b1.getReference());
+        assertNull(((SegmentBlob) b1).getBlobId());
 
         //Test for Blob which need to be pushed to BlobStore
         byte[] data2 = new byte[Segment.MEDIUM_LIMIT + 1];
         new Random().nextBytes(data2);
         Blob b2 = testCreateAndRead(nodeStore.createBlob(new ByteArrayInputStream(data2)));
+        assertTrue(b2 instanceof SegmentBlob);
         assertNotNull(b2.getReference());
-        assertNotNull(dbs.getRecordIfStored(new DataIdentifier(b2.getReference())));
+        assertNotNull(dbs.getRecordIfStored(new DataIdentifier(((SegmentBlob) b2).getBlobId())));
     }
 
     public Blob testCreateAndRead(Blob blob) throws Exception {
@@ -156,5 +157,15 @@ public class ExternalBlobTest {
             }
             return null;
         }
+
+        @Override
+        public String getBlobId(String reference) {
+            return reference;
+        }
+
+        @Override
+        public String getReference(String blobId) {
+            return blobId;
+        }
     }
 }
