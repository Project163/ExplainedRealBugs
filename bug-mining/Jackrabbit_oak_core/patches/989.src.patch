diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeState.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeState.java
index edab174e55..89049e5eec 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeState.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeState.java
@@ -106,7 +106,9 @@ class DocumentNodeState extends AbstractNodeState implements CacheValue {
         } else if (that instanceof DocumentNodeState) {
             DocumentNodeState other = (DocumentNodeState) that;
             if (getPath().equals(other.getPath())) {
-                return lastRevision.equals(other.lastRevision);
+                if (revisionEquals(other)) {
+                    return true;
+                }
             }
         } else if (that instanceof ModifiedNodeState) {
             ModifiedNodeState modified = (ModifiedNodeState) that;
@@ -244,7 +246,7 @@ class DocumentNodeState extends AbstractNodeState implements CacheValue {
             DocumentNodeState mBase = (DocumentNodeState) base;
             if (store == mBase.store) {
                 if (getPath().equals(mBase.getPath())) {
-                    if (lastRevision.equals(mBase.lastRevision)) {
+                    if (revisionEquals(mBase)) {
                         // no differences
                         return true;
                     } else {
@@ -372,6 +374,19 @@ class DocumentNodeState extends AbstractNodeState implements CacheValue {
 
     //------------------------------< internal >--------------------------------
 
+    /**
+     * Returns {@code true} if this state has the same revision as the
+     * {@code other} state. This method first compares the read {@link #rev}
+     * and then the {@link #lastRevision}.
+     *
+     * @param other the other state to compare with.
+     * @return {@code true} if the revisions are equal, {@code false} otherwise.
+     */
+    private boolean revisionEquals(DocumentNodeState other) {
+        return this.rev.equals(other.rev)
+                || this.lastRevision.equals(other.lastRevision);
+    }
+
     private boolean dispatch(@Nonnull String jsonDiff,
                              @Nonnull DocumentNodeState base,
                              @Nonnull NodeStateDiff diff) {
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/NodeStoreDiffTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/NodeStoreDiffTest.java
index f9c9413099..4b2a625ac4 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/NodeStoreDiffTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/NodeStoreDiffTest.java
@@ -39,7 +39,6 @@ import org.apache.jackrabbit.oak.spi.state.NodeBuilder;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeStore;
 import org.junit.Before;
-import org.junit.Ignore;
 import org.junit.Test;
 
 import static org.junit.Assert.assertFalse;
@@ -58,7 +57,6 @@ public class NodeStoreDiffTest {
                 .getNodeStore();
     }
 
-    @Ignore("OAK-2020")
     @Test
     public void diffWithConflict() throws Exception{
         //Last rev on /var would be 1-0-1
@@ -95,7 +93,6 @@ public class NodeStoreDiffTest {
      * which are not affected by the commit
      * @throws Exception
      */
-    @Ignore("OAK-2020")
     @Test
     public void testDiff() throws Exception{
         createNodes("/oak:index/prop-a", "/oak:index/prop-b", "/etc/workflow");
