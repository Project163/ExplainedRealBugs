diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/IdentifierManager.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/IdentifierManager.java
index be41492c83..c7a2bcd5a7 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/IdentifierManager.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/IdentifierManager.java
@@ -95,14 +95,12 @@ public class IdentifierManager {
      */
     @Nonnull
     public String getIdentifier(Tree tree) {
-        PropertyState property = tree.getProperty(JcrConstants.JCR_UUID);
-        if (property != null) {
-            return property.getValue(STRING);
-        } else if (tree.isRoot()) {
-            return tree.getPath();
+        if (tree instanceof TreeImpl) {
+            return ((TreeImpl) tree).getIdentifier();
+        } else if (tree instanceof ReadOnlyTree) {
+            return ((ReadOnlyTree) tree).getIdentifier();
         } else {
-            // FIXME parent might not be accessible
-            return PathUtils.concat(getIdentifier(tree.getParent()), tree.getName());
+            return tree.getPath();
         }
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/ReadOnlyTree.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/ReadOnlyTree.java
index 00ba65e5fa..31d709b406 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/ReadOnlyTree.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/ReadOnlyTree.java
@@ -23,16 +23,19 @@ import java.util.Iterator;
 import javax.annotation.Nonnull;
 import javax.annotation.Nullable;
 
+import org.apache.jackrabbit.JcrConstants;
 import org.apache.jackrabbit.oak.api.PropertyState;
 import org.apache.jackrabbit.oak.api.Root;
 import org.apache.jackrabbit.oak.api.Tree;
 import org.apache.jackrabbit.oak.api.TreeLocation;
 import org.apache.jackrabbit.oak.api.Type;
+import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.spi.state.ChildNodeEntry;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
 
 import static com.google.common.base.Preconditions.checkArgument;
 import static com.google.common.base.Preconditions.checkNotNull;
+import static org.apache.jackrabbit.oak.api.Type.STRING;
 
 public class ReadOnlyTree implements Tree {
 
@@ -243,6 +246,20 @@ public class ReadOnlyTree implements Tree {
         throw new UnsupportedOperationException();
     }
 
+    //------------------------------------------------------------< internal >---
+
+    @Nonnull
+    String getIdentifier() {
+        PropertyState property = state.getProperty(JcrConstants.JCR_UUID);
+        if (property != null) {
+            return property.getValue(STRING);
+        } else if (parent == null) {
+            return "/";
+        } else {
+            return PathUtils.concat(parent.getIdentifier(), name);
+        }
+    }
+
     //-------------------------------------------------------< TreeLocation >---
 
     private final class NodeLocation extends AbstractNodeLocation<ReadOnlyTree> {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/TreeImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/TreeImpl.java
index 241cd9b5fc..e8f5b159e9 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/TreeImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/TreeImpl.java
@@ -30,10 +30,12 @@ import com.google.common.base.Function;
 import com.google.common.base.Predicate;
 import com.google.common.collect.Iterables;
 import com.google.common.collect.Sets;
+import org.apache.jackrabbit.JcrConstants;
 import org.apache.jackrabbit.oak.api.PropertyState;
 import org.apache.jackrabbit.oak.api.Tree;
 import org.apache.jackrabbit.oak.api.TreeLocation;
 import org.apache.jackrabbit.oak.api.Type;
+import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.plugins.memory.MemoryPropertyBuilder;
 import org.apache.jackrabbit.oak.plugins.memory.MultiStringPropertyState;
 import org.apache.jackrabbit.oak.spi.state.NodeBuilder;
@@ -43,6 +45,7 @@ import org.apache.jackrabbit.oak.spi.state.PropertyBuilder;
 
 import static com.google.common.base.Preconditions.checkArgument;
 import static com.google.common.base.Preconditions.checkNotNull;
+import static org.apache.jackrabbit.oak.api.Type.STRING;
 import static org.apache.jackrabbit.oak.commons.PathUtils.elements;
 
 public class TreeImpl implements Tree {
@@ -489,6 +492,18 @@ public class TreeImpl implements Tree {
         nodeBuilder.setProperty(builder.getPropertyState());
     }
 
+    @Nonnull
+    String getIdentifier() {
+        PropertyState property = internalGetProperty(JcrConstants.JCR_UUID);
+        if (property != null) {
+            return property.getValue(STRING);
+        } else if (parent == null) {
+            return "/";
+        } else {
+            return PathUtils.concat(parent.getIdentifier(), name);
+        }
+    }
+
     //------------------------------------------------------------< private >---
 
     private TreeImpl internalGetChild(String childName) {
