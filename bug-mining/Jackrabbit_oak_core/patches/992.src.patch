diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Compactor.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Compactor.java
index c7a534f4fc..3e1a5b16b7 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Compactor.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/Compactor.java
@@ -51,6 +51,11 @@ public class Compactor {
     /** Logger instance */
     private static final Logger log = LoggerFactory.getLogger(Compactor.class);
 
+    /**
+     * over 64K in size, not will be included in the compaction map
+     */
+    private static final long threshold = 65536;
+
     /**
      * Locks down the RecordId persistence structure
      */
@@ -127,7 +132,7 @@ public class Compactor {
             if (success) {
                 SegmentNodeState state = writer.writeNode(child.getNodeState());
                 builder.setChildNode(name, state);
-                if (id != null && state.getChildNodeCount(2) > 1) {
+                if (id != null && includeInMap(state)) {
                     map.put(id, state.getRecordId());
                 }
             }
@@ -135,6 +140,22 @@ public class Compactor {
             return success;
         }
 
+        private boolean includeInMap(SegmentNodeState state) {
+            if (state.getChildNodeCount(2) > 1) {
+                return true;
+            }
+            int count = 0;
+            for (PropertyState ps : state.getProperties()) {
+                for (int i = 0; i < ps.count(); i++) {
+                    count += ps.size(i);
+                    if (count >= threshold) {
+                        return true;
+                    }
+                }
+            }
+            return false;
+        }
+
         @Override
         public boolean childNodeChanged(
                 String name, NodeState before, NodeState after) {
