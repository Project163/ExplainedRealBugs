diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/Statement.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/Statement.java
index 1ec6e5eccc..2b1a6efbeb 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/Statement.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/Statement.java
@@ -283,6 +283,17 @@ public class Statement {
             this.s2 = s2;
         }
         
+        @Override
+        public Statement optimize() {
+            Statement s1b = s1.optimize();
+            Statement s2b = s2.optimize();
+            if (s1 == s1b && s2 == s2b) {
+                // no change
+                return this;
+            }
+            return new UnionStatement(s1b, s2b);
+        }
+        
         @Override
         public String toString() {
             StringBuilder buff = new StringBuilder();
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/XPathTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/XPathTest.java
index 3f810c264e..b643912ebf 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/XPathTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/XPathTest.java
@@ -105,6 +105,18 @@ public class XPathTest {
     
     @Test
     public void union() throws ParseException {
+        verify("(//*[@a=1 or @b=1] | //*[@c=1])",
+                "select [jcr:path], [jcr:score], * " +
+                "from [nt:base] as a " +
+                "where [a] = 1 " +
+                "union select [jcr:path], [jcr:score], * " +
+                "from [nt:base] as a " +
+                "where [b] = 1 " +
+                "/* xpath: //*[@a=1 or @b=1] */ " +
+                "union select [jcr:path], [jcr:score], * " +
+                "from [nt:base] as a " +
+                "where [c] = 1 " +
+                "/* xpath: //*[@c=1] */");
         verify("//(a|(b|c))",
                 "select [jcr:path], [jcr:score], * " +
                 "from [nt:base] as a " +
