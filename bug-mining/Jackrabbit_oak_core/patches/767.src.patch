diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
index 489b5d254c..086d3a060a 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
@@ -38,6 +38,7 @@ import org.apache.jackrabbit.oak.spi.security.authentication.AbstractLoginModule
 import org.apache.jackrabbit.oak.spi.security.authentication.AuthInfoImpl;
 import org.apache.jackrabbit.oak.spi.security.authentication.Authentication;
 import org.apache.jackrabbit.oak.spi.security.authentication.ImpersonationCredentials;
+import org.apache.jackrabbit.oak.spi.security.authentication.PreAuthenticatedLogin;
 import org.apache.jackrabbit.oak.spi.security.user.UserConfiguration;
 import org.apache.jackrabbit.oak.spi.security.user.util.UserUtil;
 import org.slf4j.Logger;
@@ -111,23 +112,31 @@ public final class LoginModuleImpl extends AbstractLoginModule {
 
     @Override
     public boolean login() throws LoginException {
+        final boolean success;
         credentials = getCredentials();
-        userId = getUserId();
 
-        if (credentials == null || userId == null) {
-            log.debug("Could not extract userId/credentials");
-            return false;
+        // check if we have a pre authenticated login from a previous login module
+        PreAuthenticatedLogin preAuthLogin = getSharedPreAuthLogin();
+        if (preAuthLogin != null) {
+            userId = preAuthLogin.getUserId();
+            Authentication authentication = new UserAuthentication(userId, getUserManager());
+            success = authentication.authenticate(UserAuthentication.PRE_AUTHENTICATED);
+
+        } else {
+            userId = getUserId();
+            Authentication authentication = new UserAuthentication(userId, getUserManager());
+            success = authentication.authenticate(credentials);
         }
 
-        Authentication authentication = new UserAuthentication(userId, getUserManager());
-        boolean success = authentication.authenticate(credentials);
         if (success) {
             principals = getPrincipals(userId);
 
             log.debug("Adding Credentials to shared state.");
+            //noinspection unchecked
             sharedState.put(SHARED_KEY_CREDENTIALS, credentials);
 
             log.debug("Adding login name to shared state.");
+            //noinspection unchecked
             sharedState.put(SHARED_KEY_LOGIN_NAME, userId);
         }
         return success;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/UserAuthentication.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/UserAuthentication.java
index 5b826c4291..e42fe80704 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/UserAuthentication.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/UserAuthentication.java
@@ -58,6 +58,8 @@ import org.slf4j.LoggerFactory;
  */
 class UserAuthentication implements Authentication {
 
+    static final Credentials PRE_AUTHENTICATED = new Credentials() { };
+
     private static final Logger log = LoggerFactory.getLogger(UserAuthentication.class);
 
     private final String userId;
@@ -71,7 +73,7 @@ class UserAuthentication implements Authentication {
     //-----------------------------------------------------< Authentication >---
     @Override
     public boolean authenticate(Credentials credentials) throws LoginException {
-        if (userId == null || userManager == null) {
+        if (userId == null || userManager == null || credentials == null) {
             return false;
         }
 
@@ -105,7 +107,7 @@ class UserAuthentication implements Authentication {
                 checkSuccess(success, "Impersonation not allowed.");
             } else {
                 // guest login is allowed if an anonymous user exists in the content (see get user above)
-                success = (credentials instanceof GuestCredentials);
+                success = (credentials instanceof GuestCredentials) || credentials == PRE_AUTHENTICATED;
             }
         } catch (RepositoryException e) {
             throw new LoginException(e.getMessage());
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/AbstractLoginModule.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/AbstractLoginModule.java
index dfe39c407b..cb06f09794 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/AbstractLoginModule.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/AbstractLoginModule.java
@@ -163,6 +163,12 @@ public abstract class AbstractLoginModule implements LoginModule {
      */
     public static final String SHARED_KEY_ATTRIBUTES = "javax.security.auth.login.attributes";
 
+    /**
+     * Key of the sharedState entry referring to pre authenticated login information that is shared
+     * between multiple login modules.
+     */
+    public static final String SHARED_KEY_PRE_AUTH_LOGIN = PreAuthenticatedLogin.class.getName();
+
     protected Subject subject;
     protected CallbackHandler callbackHandler;
     protected Map sharedState;
@@ -311,6 +317,20 @@ public abstract class AbstractLoginModule implements LoginModule {
         }
     }
 
+    /**
+     * @return The pre authenticated login or {@code null}
+     * @see #SHARED_KEY_PRE_AUTH_LOGIN
+     */
+    @CheckForNull
+    protected PreAuthenticatedLogin getSharedPreAuthLogin() {
+        Object login = sharedState.get(SHARED_KEY_PRE_AUTH_LOGIN);
+        if (login instanceof PreAuthenticatedLogin) {
+            return (PreAuthenticatedLogin) login;
+        } else {
+            return null;
+        }
+    }
+
     /**
      * Tries to obtain the {@code SecurityProvider} object from the callback
      * handler using a new SecurityProviderCallback and keeps the value as
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/PreAuthenticatedLogin.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/PreAuthenticatedLogin.java
new file mode 100644
index 0000000000..fa8264538e
--- /dev/null
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/PreAuthenticatedLogin.java
@@ -0,0 +1,35 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.jackrabbit.oak.spi.security.authentication;
+
+/**
+ * {@code PreAuthenticatedLogin} is used as marker in the shared map of the login context. it indicates that the
+ * respective user is pre authenticated on an external system. Note that is class is only used internally by the
+ * login modules and cannot be "abused" from outside.
+ */
+final public class PreAuthenticatedLogin {
+
+    private final String userId;
+
+    public PreAuthenticatedLogin(String userId) {
+        this.userId = userId;
+    }
+
+    public String getUserId() {
+        return userId;
+    }
+}
\ No newline at end of file
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/package-info.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/package-info.java
index 607089c811..e9dac208c3 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/package-info.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authentication/package-info.java
@@ -14,8 +14,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-@Version("0.16")
-@Export(optional = "provide:=true")
+@Version("0.17")
 package org.apache.jackrabbit.oak.spi.security.authentication;
 
 import aQute.bnd.annotation.Version;
