diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/datastore/DataStoreTextWriter.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/datastore/DataStoreTextWriter.java
index ae5bac9472..e49147c580 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/datastore/DataStoreTextWriter.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/datastore/DataStoreTextWriter.java
@@ -35,6 +35,7 @@ import com.google.common.io.Files;
 import org.apache.commons.io.FileUtils;
 import org.apache.jackrabbit.oak.api.Blob;
 import org.apache.jackrabbit.oak.plugins.blob.datastore.DataStoreBlobStore;
+import org.apache.jackrabbit.oak.plugins.blob.datastore.InMemoryDataRecord;
 import org.apache.jackrabbit.oak.plugins.blob.datastore.TextWriter;
 import org.apache.jackrabbit.oak.plugins.index.fulltext.ExtractedText;
 import org.apache.jackrabbit.oak.plugins.index.fulltext.ExtractedText.ExtractionResult;
@@ -95,6 +96,12 @@ public class DataStoreTextWriter implements TextWriter, Closeable, PreExtractedT
         }
 
         blobId = stripLength(blobId);
+        //Check for ref being non null to ensure its not an inlined binary
+        if (InMemoryDataRecord.isInstance(blobId)) {
+            log.debug("Pre extraction is not supported for in memory records. Path {}, BlobId {}", propertyPath, blobId);
+            return null;
+        }
+
         ExtractedText result = null;
         if (getEmptyBlobs().contains(blobId)) {
             result = ExtractedText.EMPTY;
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/datastore/DataStoreTextWriterTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/datastore/DataStoreTextWriterTest.java
index bdc652a75d..a20422e517 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/datastore/DataStoreTextWriterTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/datastore/DataStoreTextWriterTest.java
@@ -25,10 +25,13 @@ import java.io.File;
 import org.apache.commons.io.IOUtils;
 import org.apache.jackrabbit.core.data.DataRecord;
 import org.apache.jackrabbit.core.data.FileDataStore;
+import org.apache.jackrabbit.oak.plugins.blob.BlobStoreBlob;
+import org.apache.jackrabbit.oak.plugins.blob.datastore.DataStoreBlobStore;
 import org.apache.jackrabbit.oak.plugins.blob.datastore.DataStoreUtils;
 import org.apache.jackrabbit.oak.plugins.blob.datastore.TextWriter;
 import org.apache.jackrabbit.oak.plugins.index.fulltext.ExtractedText;
 import org.apache.jackrabbit.oak.plugins.index.fulltext.ExtractedText.ExtractionResult;
+import org.apache.jackrabbit.oak.plugins.index.fulltext.PreExtractedTextProvider;
 import org.apache.jackrabbit.oak.plugins.memory.ArrayBasedBlob;
 import org.junit.Rule;
 import org.junit.Test;
@@ -108,6 +111,19 @@ public class DataStoreTextWriterTest {
         assertTrue(w.isProcessed("a"));
 
     }
+    
+    @Test
+    public void inMemoryRecord() throws Exception{
+        File fdsDir = temporaryFolder.newFolder();
+        FileDataStore fds = DataStoreUtils.createFDS(fdsDir, 10000);
+        DataStoreBlobStore dbs = new DataStoreBlobStore(fds);
+        ByteArrayInputStream is = new ByteArrayInputStream("".getBytes());
+        String blobId = dbs.writeBlob(is);
+
+        File writerDir = temporaryFolder.newFolder();
+        PreExtractedTextProvider textProvider = new DataStoreTextWriter(writerDir, true);
+        assertNull(textProvider.getText("/content", new BlobStoreBlob(dbs, blobId)));
+    }
 
     private static class IdBlob extends ArrayBasedBlob {
         final String id;
