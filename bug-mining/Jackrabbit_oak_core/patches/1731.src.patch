diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositePermissionProvider.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositePermissionProvider.java
index 1c2d5ce7de..96c7fb72ba 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositePermissionProvider.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositePermissionProvider.java
@@ -104,9 +104,11 @@ class CompositePermissionProvider implements AggregatedPermissionProvider {
                 if (!granted.isEmpty()) {
                     result.add(granted);
                 }
-                // update the set of denied privs by comparing the granted privs
-                // with the complete set of supported privileges
-                denied.add(supported.diff(granted));
+                if (compositionType == AND) {
+                    // update the set of denied privs by comparing the granted privs
+                    // with the complete set of supported privileges
+                    denied.add(supported.diff(granted));
+                }
             }
         }
         // subtract all denied privileges from the result
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositeProviderAllTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositeProviderAllTest.java
index d0a0f66e45..c11f5f16ba 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositeProviderAllTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositeProviderAllTest.java
@@ -231,7 +231,7 @@ public class CompositeProviderAllTest extends AbstractCompositeProviderTest {
             Set<String> expected = defPrivileges.get(p);
             Tree tree = root.getTree(p);
             assertEquals(p, expected, cpp.getPrivileges(tree));
-            assertEquals(p, expected, cppO.getPrivileges(tree));
+            assertEquals(p, ImmutableSet.of(JCR_ALL), cppO.getPrivileges(tree));
         }
     }
 
@@ -240,7 +240,7 @@ public class CompositeProviderAllTest extends AbstractCompositeProviderTest {
         Set<String> privilegeNames = cpp.getPrivileges(null);
         assertEquals(ImmutableSet.of(JCR_NAMESPACE_MANAGEMENT, JCR_NODE_TYPE_DEFINITION_MANAGEMENT), privilegeNames);
         Set<String> privilegeNamesO = cppO.getPrivileges(null);
-        assertEquals(ImmutableSet.of(JCR_NAMESPACE_MANAGEMENT, JCR_NODE_TYPE_DEFINITION_MANAGEMENT), privilegeNamesO);
+        assertEquals(ImmutableSet.of(JCR_ALL), privilegeNamesO);
     }
 
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositeProviderEmptyTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositeProviderEmptyTest.java
index a1c13f8518..fe76e40569 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositeProviderEmptyTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/CompositeProviderEmptyTest.java
@@ -36,6 +36,9 @@ import org.apache.jackrabbit.oak.spi.security.authorization.permission.Repositor
 import org.apache.jackrabbit.oak.spi.security.authorization.permission.TreePermission;
 import org.junit.Test;
 
+import com.google.common.collect.ImmutableSet;
+
+import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertTrue;
 
@@ -84,14 +87,14 @@ public class CompositeProviderEmptyTest extends AbstractCompositeProviderTest {
     public void testGetPrivileges() throws Exception {
         for (String p : NODE_PATHS) {
             assertTrue(cpp.getPrivileges(readOnlyRoot.getTree(p)).isEmpty());
-            assertTrue(cppO.getPrivileges(readOnlyRoot.getTree(p)).isEmpty());
+            assertEquals(ImmutableSet.of(JCR_ALL), cppO.getPrivileges(readOnlyRoot.getTree(p)));
         }
     }
 
     @Test
     public void testGetPrivilegesOnRepo() throws Exception {
         assertTrue(cpp.getPrivileges(null).isEmpty());
-        assertTrue(cppO.getPrivileges(null).isEmpty());
+        assertEquals(ImmutableSet.of(JCR_ALL), cppO.getPrivileges(null));
     }
 
     @Test
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/MutiplexingProviderRandomTestIT.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/MutiplexingProviderRandomTestIT.java
index 331dc974c1..c85203b349 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/MutiplexingProviderRandomTestIT.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/composite/MutiplexingProviderRandomTestIT.java
@@ -31,6 +31,7 @@ import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
 import org.apache.jackrabbit.oak.spi.security.authorization.AuthorizationConfiguration;
 import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.AccessControlConstants;
 import org.apache.jackrabbit.oak.spi.security.authorization.permission.PermissionProvider;
+import org.junit.Assert;
 
 import com.google.common.base.Preconditions;
 import com.google.common.collect.Iterators;
@@ -58,9 +59,12 @@ public class MutiplexingProviderRandomTestIT extends AbstractPermissionRandomTes
             @Nonnull Set<Principal> principals) {
         ConfigurationParameters authConfig = ConfigurationParameters.of(Collections.singletonMap(
                 AccessControlConstants.PARAM_MOUNT_PROVIDER, Preconditions.checkNotNull(mountInfoProvider)));
-        SecurityProviderImpl sp = new SecurityProviderImpl(authConfig);
+        ConfigurationParameters config = ConfigurationParameters.of(Collections.singletonMap(
+                AuthorizationConfiguration.NAME, authConfig));
+        SecurityProviderImpl sp = new SecurityProviderImpl(config);
         AuthorizationConfiguration acConfig = sp.getConfiguration(AuthorizationConfiguration.class);
-        return acConfig.getPermissionProvider(root, workspaceName, principals);
+        PermissionProvider composite = acConfig.getPermissionProvider(root, workspaceName, principals);
+        Assert.assertTrue(composite instanceof MultiplexingPermissionProvider);
+        return composite;
     }
-
 }
\ No newline at end of file
