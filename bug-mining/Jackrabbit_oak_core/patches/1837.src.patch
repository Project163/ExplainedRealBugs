diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java
index d8233ce0a5..8b37f654b1 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java
@@ -193,6 +193,12 @@ public final class TokenLoginModule extends AbstractLoginModule {
         return Collections.singleton(TokenCredentials.class);
     }
 
+    @Nullable
+    @Override
+    protected Credentials getCommittedCredentials() {
+        return tokenCredentials;
+    }
+
     @Override
     protected void clearState() {
         super.clearState();
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
index e4354ac352..be5781d4ac 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
@@ -182,6 +182,12 @@ public final class LoginModuleImpl extends AbstractLoginModule {
         return SUPPORTED_CREDENTIALS;
     }
 
+    @Nullable
+    @Override
+    protected Credentials getCommittedCredentials() {
+        return credentials;
+    }
+
     @Override
     protected void clearState() {
         super.clearState();
