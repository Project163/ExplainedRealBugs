diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/Checkpoints.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/Checkpoints.java
index cae6f761c3..f011336964 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/Checkpoints.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/Checkpoints.java
@@ -33,6 +33,7 @@ import org.apache.jackrabbit.oak.commons.json.JsopBuilder;
 import org.apache.jackrabbit.oak.commons.json.JsopReader;
 import org.apache.jackrabbit.oak.commons.json.JsopTokenizer;
 import org.apache.jackrabbit.oak.commons.json.JsopWriter;
+import org.apache.jackrabbit.oak.plugins.document.util.Utils;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -128,15 +129,18 @@ class Checkpoints {
         final long currentTime = nodeStore.getClock().getTime();
         UpdateOp op = new UpdateOp(ID, false);
         Revision lastAliveRevision = null;
-        long oldestExpiryTime = 0;
 
         for (Map.Entry<Revision, Info> e : checkpoints.entrySet()) {
-            final long expiryTime = e.getValue().getExpiryTime();
+            long expiryTime = e.getValue().getExpiryTime();
             if (currentTime > expiryTime) {
                 op.removeMapEntry(PROP_CHECKPOINT, e.getKey());
-            } else if (expiryTime > oldestExpiryTime) {
-                oldestExpiryTime = expiryTime;
-                lastAliveRevision = e.getKey();
+            } else {
+                Revision cpRev = e.getKey();
+                RevisionVector rv = e.getValue().getCheckpoint();
+                if (rv != null) {
+                    cpRev = rv.getRevision(cpRev.getClusterId());
+                }
+                lastAliveRevision = Utils.min(lastAliveRevision, cpRev);
             }
         }
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CheckpointsTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CheckpointsTest.java
index 75b4d3a1f9..a794ece0f5 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CheckpointsTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CheckpointsTest.java
@@ -29,7 +29,6 @@ import org.apache.jackrabbit.oak.spi.state.NodeBuilder;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.stats.Clock;
 import org.junit.Before;
-import org.junit.Ignore;
 import org.junit.Rule;
 import org.junit.Test;
 
@@ -61,8 +60,9 @@ public class CheckpointsTest {
     @Test
     public void testCheckpointPurge() throws Exception {
         long expiryTime = 1000;
-        Revision r1 = Revision.fromString(store.checkpoint(expiryTime));
-        assertEquals(r1, store.getCheckpoints().getOldestRevisionToKeep());
+        String r1 = store.getHeadRevision().toString();
+        store.checkpoint(expiryTime);
+        assertEquals(r1, store.getCheckpoints().getOldestRevisionToKeep().toString());
 
         //Trigger expiry by forwarding the clock to future
         clock.waitUntil(clock.getTime() + expiryTime + 1);
@@ -72,12 +72,12 @@ public class CheckpointsTest {
     @Test
     public void testCheckpointPurgeByCount() throws Exception {
         long expiryTime = TimeUnit.HOURS.toMillis(1);
-        Revision r1 = null;
+        String head = store.getHeadRevision().toString();
         for(int i = 0; i < Checkpoints.CLEANUP_INTERVAL; i++){
-            r1 = Revision.fromString(store.checkpoint(expiryTime));
+            store.checkpoint(expiryTime);
             store.setRoot(new RevisionVector(Revision.newRevision(store.getClusterId())));
         }
-        assertEquals(r1, store.getCheckpoints().getOldestRevisionToKeep());
+        assertEquals(head, store.getCheckpoints().getOldestRevisionToKeep().toString());
         assertEquals(Checkpoints.CLEANUP_INTERVAL, store.getCheckpoints().size());
 
         //Trigger expiry by forwarding the clock to future
@@ -96,42 +96,51 @@ public class CheckpointsTest {
 
         //Create CP with higher expiry first and then one with
         //lower expiry
-        Revision r2 = Revision.fromString(store.checkpoint(e2));
-        Revision r1 = Revision.fromString(store.checkpoint(e1));
+        String r2 = store.getHeadRevision().toString();
+        String c2 = store.checkpoint(e2);
+
+        //Do some commit to change headRevision
+        NodeBuilder b2 = store.getRoot().builder();
+        b2.child("x");
+        store.merge(b2, EmptyHook.INSTANCE, CommitInfo.EMPTY);
+
+        String c1 = store.checkpoint(e1);
 
         clock.waitUntil(clock.getTime() + e1 + 1);
 
         //The older checkpoint was for greater duration so checkpoint
         //must not be GC
-        assertEquals(r2, store.getCheckpoints().getOldestRevisionToKeep());
+        assertEquals(r2, store.getCheckpoints().getOldestRevisionToKeep().toString());
         // after getOldestRevisionToKeep() only one must be remaining
         assertEquals(1, store.getCheckpoints().size());
-        assertNull(store.retrieve(r1.toString()));
-        assertNotNull(store.retrieve(r2.toString()));
+        assertNull(store.retrieve(c1));
+        assertNotNull(store.retrieve(c2));
     }
 
     @Test
     public void testGetOldestRevisionToKeep() throws Exception {
         long et1 = 1000, et2 = et1 + 1000;
 
-        Revision r1 = Revision.fromString(store.checkpoint(et1));
+        String r1 = store.getHeadRevision().toString();
+        Revision c1 = Revision.fromString(store.checkpoint(et1));
 
         //Do some commit to change headRevision
         NodeBuilder b2 = store.getRoot().builder();
         b2.child("x");
         store.merge(b2, EmptyHook.INSTANCE, CommitInfo.EMPTY);
 
-        Revision r2 = Revision.fromString(store.checkpoint(et2));
-        assertNotSame(r1, r2);
+        String r2 = store.getHeadRevision().toString();
+        Revision c2 = Revision.fromString(store.checkpoint(et2));
+        assertNotEquals(c1, c2);
 
-        //r2 has the later expiry
-        assertEquals(r2, store.getCheckpoints().getOldestRevisionToKeep());
+        // r1 is older
+        assertEquals(r1, store.getCheckpoints().getOldestRevisionToKeep().toString());
 
         long starttime = clock.getTime();
 
         //Trigger expiry by forwarding the clock to future e1
         clock.waitUntil(starttime + et1 + 1);
-        assertEquals(r2, store.getCheckpoints().getOldestRevisionToKeep());
+        assertEquals(r2, store.getCheckpoints().getOldestRevisionToKeep().toString());
 
         //Trigger expiry by forwarding the clock to future e2
         //This time no valid checkpoint
@@ -140,7 +149,6 @@ public class CheckpointsTest {
     }
 
     // OAK-4552
-    @Ignore("OAK-4552")
     @Test
     public void testGetOldestRevisionToKeep2() throws Exception {
         long lifetime = TimeUnit.HOURS.toMillis(1);
@@ -164,25 +172,29 @@ public class CheckpointsTest {
 
     @Test
     public void checkpointRemove() throws Exception{
-        long et1 = 1000, et2 = et1 + 1000;
-        String cp1 = store.checkpoint(et1);
-        Revision r1 = Revision.fromString(cp1);
+        long lifetime = TimeUnit.HOURS.toMillis(1);
+        String r1 = store.getHeadRevision().toString();
+        String cp1 = store.checkpoint(lifetime);
 
         //Do some commit to change headRevision
         NodeBuilder b2 = store.getRoot().builder();
         b2.child("x");
         store.merge(b2, EmptyHook.INSTANCE, CommitInfo.EMPTY);
 
-        String cp2 = store.checkpoint(et2);
-        Revision r2 = Revision.fromString(cp2);
+        String r2 = store.getHeadRevision().toString();
+        String cp2 = store.checkpoint(lifetime);
 
         assertEquals(2, store.getCheckpoints().size());
-        assertEquals(r2, store.getCheckpoints().getOldestRevisionToKeep());
+        assertEquals(r1, store.getCheckpoints().getOldestRevisionToKeep().toString());
 
-        store.release(cp2);
+        store.release(cp1);
 
         assertEquals(1, store.getCheckpoints().size());
-        assertEquals(r1, store.getCheckpoints().getOldestRevisionToKeep());
+        assertEquals(r2, store.getCheckpoints().getOldestRevisionToKeep().toString());
+
+        store.release(cp2);
+        assertEquals(0, store.getCheckpoints().size());
+        assertNull(store.getCheckpoints().getOldestRevisionToKeep());
     }
 
     @Test
