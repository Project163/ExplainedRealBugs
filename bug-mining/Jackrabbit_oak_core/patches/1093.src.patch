diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/compaction/CompactionStrategy.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/compaction/CompactionStrategy.java
index ad2f2225c1..056b8ecd06 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/compaction/CompactionStrategy.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/compaction/CompactionStrategy.java
@@ -30,7 +30,7 @@ import javax.annotation.Nonnull;
 import org.apache.jackrabbit.oak.plugins.segment.CompactionMap;
 import org.apache.jackrabbit.oak.plugins.segment.SegmentId;
 
-public class CompactionStrategy {
+public abstract class CompactionStrategy {
 
     public enum CleanupType {
 
@@ -76,6 +76,17 @@ public class CompactionStrategy {
 
     public static final byte MEMORY_THRESHOLD_DEFAULT = 5;
 
+    /**
+     * No compaction at all
+     */
+    public static CompactionStrategy NO_COMPACTION = new CompactionStrategy(
+            true, false, CleanupType.CLEAN_NONE, 0, MEMORY_THRESHOLD_DEFAULT) {
+        @Override
+        public boolean compacted(@Nonnull Callable<Boolean> setHead) throws Exception {
+            return false;
+        }
+    };
+
     private boolean paused;
 
     private boolean cloneBinaries;
@@ -97,7 +108,7 @@ public class CompactionStrategy {
 
     private long compactionStart = currentTimeMillis();
 
-    public CompactionStrategy(boolean paused,
+    protected CompactionStrategy(boolean paused,
             boolean cloneBinaries, @Nonnull CleanupType cleanupType, long olderThan, byte memoryThreshold) {
         checkArgument(olderThan >= 0);
         this.paused = paused;
@@ -180,7 +191,6 @@ public class CompactionStrategy {
         this.memoryThreshold = memoryThreshold;
     }
 
-    public boolean compacted(@Nonnull Callable<Boolean> setHead) throws Exception {
-        return checkNotNull(setHead).call();
-    }
+    public abstract boolean compacted(@Nonnull Callable<Boolean> setHead) throws Exception;
+
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
index 200d4a571c..df08f52c88 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
@@ -28,8 +28,7 @@ import static java.util.Collections.emptyMap;
 import static java.util.Collections.singletonMap;
 import static org.apache.jackrabbit.oak.commons.IOUtils.humanReadableByteCount;
 import static org.apache.jackrabbit.oak.plugins.memory.EmptyNodeState.EMPTY_NODE;
-import static org.apache.jackrabbit.oak.plugins.segment.compaction.CompactionStrategy.CleanupType.CLEAN_NONE;
-import static org.apache.jackrabbit.oak.plugins.segment.compaction.CompactionStrategy.MEMORY_THRESHOLD_DEFAULT;
+import static org.apache.jackrabbit.oak.plugins.segment.compaction.CompactionStrategy.NO_COMPACTION;
 
 import java.io.File;
 import java.io.IOException;
@@ -137,8 +136,7 @@ public class FileStore implements SegmentStore {
      */
     private final BackgroundThread compactionThread;
 
-    private CompactionStrategy compactionStrategy = new CompactionStrategy(
-            true, false, CLEAN_NONE, 0, MEMORY_THRESHOLD_DEFAULT);
+    private CompactionStrategy compactionStrategy = NO_COMPACTION;
 
     /**
      * Flag to request revision cleanup during the next flush.
@@ -741,6 +739,9 @@ public class FileStore implements SegmentStore {
 
     @Override
     public void gc() {
+        if (compactionStrategy == NO_COMPACTION) {
+            log.warn("Call to gc while compaction strategy set to {}. ", NO_COMPACTION);
+        }
         compactionThread.trigger();
     }
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/CompactionAndCleanupTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/CompactionAndCleanupTest.java
index e25e9ae5b3..8aa8836b7c 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/CompactionAndCleanupTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/CompactionAndCleanupTest.java
@@ -40,6 +40,8 @@ import java.util.concurrent.Callable;
 import java.util.concurrent.TimeUnit;
 import java.util.concurrent.atomic.AtomicReference;
 
+import javax.annotation.Nonnull;
+
 import com.google.common.io.ByteStreams;
 import org.apache.jackrabbit.oak.api.Blob;
 import org.apache.jackrabbit.oak.api.CommitFailedException;
@@ -79,11 +81,16 @@ public class CompactionAndCleanupTest {
         final int dataNodes = 10000;
 
         // really long time span, no binary cloning
-        CompactionStrategy custom = new CompactionStrategy(false,
-                false, CLEAN_OLD, TimeUnit.HOURS.toMillis(1), (byte) 0);
 
         FileStore fileStore = new FileStore(directory, 1);
-        SegmentNodeStore nodeStore = new SegmentNodeStore(fileStore);
+        final SegmentNodeStore nodeStore = new SegmentNodeStore(fileStore);
+                CompactionStrategy custom = new CompactionStrategy(false,
+                false, CLEAN_OLD, TimeUnit.HOURS.toMillis(1), (byte) 0) {
+                    @Override
+                    public boolean compacted(@Nonnull Callable<Boolean> setHead) throws Exception {
+                        return nodeStore.locked(setHead);
+                    }
+                };
         fileStore.setCompactionStrategy(custom);
 
         // 1a. Create a bunch of data
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/HeavyWriteIT.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/HeavyWriteIT.java
index 614ee4674a..ca1266af0a 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/HeavyWriteIT.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/HeavyWriteIT.java
@@ -26,8 +26,11 @@ import java.io.ByteArrayInputStream;
 import java.io.File;
 import java.io.IOException;
 import java.util.Random;
+import java.util.concurrent.Callable;
 import java.util.concurrent.atomic.AtomicBoolean;
 
+import javax.annotation.Nonnull;
+
 import org.apache.jackrabbit.oak.api.Blob;
 import org.apache.jackrabbit.oak.api.CommitFailedException;
 import org.apache.jackrabbit.oak.plugins.segment.compaction.CompactionStrategy;
@@ -60,9 +63,14 @@ public class HeavyWriteIT {
     @Test
     public void heavyWrite() throws IOException, CommitFailedException, InterruptedException {
         final FileStore store = new FileStore(directory, 128, false);
-        store.setCompactionStrategy(new CompactionStrategy(false, false,
-                CLEAN_OLD, 30000, (byte) 0));
         final SegmentNodeStore nodeStore = new SegmentNodeStore(store);
+        store.setCompactionStrategy(new CompactionStrategy(false, false,
+                CLEAN_OLD, 30000, (byte) 0) {
+            @Override
+            public boolean compacted(@Nonnull Callable<Boolean> setHead) throws Exception {
+                return nodeStore.locked(setHead);
+            }
+        });
 
         int writes = 100;
         final AtomicBoolean run = new AtomicBoolean(true);
