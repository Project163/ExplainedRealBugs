diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java
index dab3fbf896..563a7943ec 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModule.java
@@ -21,7 +21,10 @@ import java.security.Principal;
 import java.util.Collections;
 import java.util.HashMap;
 import java.util.Map;
+import java.util.Objects;
 import java.util.Set;
+import java.util.stream.Collectors;
+import java.util.stream.Stream;
 import javax.jcr.Credentials;
 import javax.security.auth.Subject;
 import javax.security.auth.callback.Callback;
@@ -191,6 +194,12 @@ public final class TokenLoginModule extends AbstractLoginModule {
         return false;
     }
 
+    @Override
+    public boolean logout() throws LoginException {
+        Set creds = Stream.of(tokenCredentials, authInfo).filter(Objects::nonNull).collect(Collectors.toSet());
+        return logout((creds.isEmpty() ? null : creds), principals);
+    }
+
     //------------------------------------------------< AbstractLoginModule >---
     @NotNull
     @Override
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
index ee0e7ebf03..fccb013f53 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
@@ -44,7 +44,10 @@ import java.util.Collections;
 import java.util.HashMap;
 import java.util.HashSet;
 import java.util.Map;
+import java.util.Objects;
 import java.util.Set;
+import java.util.stream.Collectors;
+import java.util.stream.Stream;
 
 /**
  * Default login module implementation that authenticates JCR {@code Credentials}
@@ -181,6 +184,12 @@ public final class LoginModuleImpl extends AbstractLoginModule {
         }
     }
 
+    @Override
+    public boolean logout() throws LoginException {
+        Set creds = Stream.of(credentials, authInfo).filter(Objects::nonNull).collect(Collectors.toSet());
+        return logout((creds.isEmpty() ? null : creds), principals);
+    }
+
     //------------------------------------------------< AbstractLoginModule >---
     @NotNull
     @Override
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TestLoginModule.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TestLoginModule.java
index 5d3bdccbdf..a4505d105f 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TestLoginModule.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TestLoginModule.java
@@ -16,23 +16,29 @@
  */
 package org.apache.jackrabbit.oak.security.authentication.token;
 
-import java.util.Map;
-import java.util.Set;
-import javax.jcr.Credentials;
-import javax.security.auth.Subject;
-import javax.security.auth.callback.CallbackHandler;
-
+import com.google.common.collect.ImmutableSet;
+import org.apache.jackrabbit.oak.api.AuthInfo;
 import org.apache.jackrabbit.oak.spi.security.authentication.AbstractLoginModule;
 import org.apache.jackrabbit.oak.spi.security.authentication.AuthInfoImpl;
 import org.apache.jackrabbit.oak.spi.security.authentication.credentials.CredentialsSupport;
 import org.apache.jackrabbit.oak.spi.security.principal.EveryonePrincipal;
 import org.jetbrains.annotations.NotNull;
 
+import javax.jcr.Credentials;
+import javax.security.auth.Subject;
+import javax.security.auth.callback.CallbackHandler;
+import javax.security.auth.login.LoginException;
+import java.security.Principal;
+import java.util.Collections;
+import java.util.Map;
+import java.util.Set;
+
 public class TestLoginModule extends AbstractLoginModule {
 
     private CredentialsSupport credentialsSupport;
     private Credentials credentials;
     private String userId;
+    private AuthInfo info;
 
     @Override
     public void initialize(Subject subject, CallbackHandler callbackHandler, Map<String, ?> sharedState, Map<String, ?> options) {
@@ -47,6 +53,16 @@ public class TestLoginModule extends AbstractLoginModule {
         return new TestCredentialsSupport().getCredentialClasses();
     }
 
+    @Override
+    public boolean logout() throws LoginException {
+        if (credentials != null) {
+            Set<? extends Principal> s = Collections.singleton(EveryonePrincipal.getInstance());
+            return logout(ImmutableSet.of(credentials), s);
+        } else {
+            return false;
+        }
+    }
+
     @Override
     public boolean login() {
         credentials = getCredentials();
@@ -64,9 +80,11 @@ public class TestLoginModule extends AbstractLoginModule {
     public boolean commit() {
         if (userId != null) {
             subject.getPrincipals().add(EveryonePrincipal.getInstance());
-            setAuthInfo(new AuthInfoImpl(userId, credentialsSupport.getAttributes(credentials), subject.getPrincipals()), subject);
+            info = new AuthInfoImpl(userId, credentialsSupport.getAttributes(credentials), subject.getPrincipals());
+            setAuthInfo(info, subject);
             return true;
         } else {
+            clearState();
             return false;
         }
     }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModuleTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModuleTest.java
index a9e4ff4a13..68e393db63 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModuleTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/token/TokenLoginModuleTest.java
@@ -59,7 +59,6 @@ import org.junit.Test;
 
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
-import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertTrue;
 import static org.junit.Assert.fail;
 import static org.mockito.ArgumentMatchers.any;
@@ -196,6 +195,8 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         lm.initialize(new Subject(), null, ImmutableMap.<String, Object>of(), ImmutableMap.<String, Object>of());
 
         assertFalse(lm.login());
+        assertFalse(lm.commit());
+        assertFalse(lm.logout());
     }
 
     @Test
@@ -204,6 +205,8 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         lm.initialize(new Subject(), new TestCallbackHandler(null), ImmutableMap.<String, Object>of(), ImmutableMap.<String, Object>of());
 
         assertFalse(lm.login());
+        assertFalse(lm.commit());
+        assertFalse(lm.logout());
     }
 
 
@@ -216,6 +219,7 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
 
         assertFalse(lm.login());
         assertFalse(lm.commit());
+        assertFalse(lm.logout());
     }
 
     @Test
@@ -226,6 +230,8 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         lm.initialize(new Subject(), new TestCallbackHandler(tp), ImmutableMap.<String, Object>of(), ImmutableMap.<String, Object>of());
 
         assertFalse(lm.login());
+        assertFalse(lm.commit());
+        assertFalse(lm.logout());
     }
 
     @Test
@@ -234,6 +240,8 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         lm.initialize(new Subject(), new ThrowingCallbackHandler(UnsupportedCallbackException.class), ImmutableMap.<String, Object>of(), ImmutableMap.<String, Object>of());
 
         assertFalse(lm.login());
+        assertFalse(lm.commit());
+        assertFalse(lm.logout());
     }
 
     @Test
@@ -242,6 +250,8 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         lm.initialize(new Subject(), new ThrowingCallbackHandler(IOException.class), ImmutableMap.<String, Object>of(), ImmutableMap.<String, Object>of());
 
         assertFalse(lm.login());
+        assertFalse(lm.commit());
+        assertFalse(lm.logout());
     }
 
     @Test(expected = LoginException.class)
@@ -261,6 +271,7 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
             lm.commit();
         } finally {
             verify(tp, times(1)).doCreateToken(any(Credentials.class));
+            assertFalse(lm.logout());
         }
     }
 
@@ -288,6 +299,12 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         assertTrue(lm.commit());
 
         assertEquals(ImmutableSet.of(getTestUser().getPrincipal(), EveryonePrincipal.getInstance()), subject.getPrincipals());
+        assertFalse(subject.getPublicCredentials(AuthInfo.class).isEmpty());
+        assertFalse(subject.getPublicCredentials(TokenCredentials.class).isEmpty());
+
+        assertTrue(lm.logout());
+        assertTrue(subject.getPublicCredentials().isEmpty());
+        assertTrue(subject.getPrincipals().isEmpty());
     }
 
     @Test
@@ -311,6 +328,8 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         assertFalse(lm.commit());
         verify(tp, times(1)).createToken(sc);
         assertTrue(subject.getPublicCredentials(TokenCredentials.class).isEmpty());
+
+        assertFalse(lm.logout());
     }
 
     @Test
@@ -325,6 +344,7 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         assertFalse(lm.login());
         assertFalse(lm.commit());
         verify(tp, never()).createToken(any(Credentials.class));
+        assertFalse(lm.logout());
     }
 
     @Test
@@ -339,6 +359,7 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         assertFalse(lm.login());
         assertFalse(lm.commit());
         verify(tp, never()).doCreateToken(any(Credentials.class));
+        assertFalse(lm.logout());
     }
 
     @Test
@@ -365,6 +386,7 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         assertFalse(lm.login());
         assertFalse(lm.commit());
         verify(tp, times(1)).createToken(sc);
+        assertFalse(lm.logout());
     }
 
     @Test
@@ -391,6 +413,7 @@ public class TokenLoginModuleTest extends AbstractSecurityTest {
         assertFalse(lm.login());
         assertFalse(lm.commit());
         verify(tp, times(1)).createToken(sc);
+        assertFalse(lm.logout());
     }
 
     @Test
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java
index b72cd11b0f..d3a96834db 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java
@@ -19,7 +19,6 @@ package org.apache.jackrabbit.oak.security.authentication.user;
 import com.google.common.collect.ImmutableSet;
 import com.google.common.collect.Maps;
 import com.google.common.collect.Sets;
-import org.apache.jackrabbit.api.security.authentication.token.TokenCredentials;
 import org.apache.jackrabbit.api.security.user.Authorizable;
 import org.apache.jackrabbit.api.security.user.User;
 import org.apache.jackrabbit.api.security.user.UserManager;
@@ -28,8 +27,8 @@ import org.apache.jackrabbit.oak.api.AuthInfo;
 import org.apache.jackrabbit.oak.api.CommitFailedException;
 import org.apache.jackrabbit.oak.api.ContentSession;
 import org.apache.jackrabbit.oak.api.Root;
-import org.apache.jackrabbit.oak.security.authentication.token.TokenLoginModule;
-import org.apache.jackrabbit.oak.security.authentication.token.TokenLoginModuleTest;
+import org.apache.jackrabbit.oak.commons.junit.LogCustomizer;
+import org.apache.jackrabbit.oak.namepath.NamePathMapper;
 import org.apache.jackrabbit.oak.security.internal.SecurityProviderBuilder;
 import org.apache.jackrabbit.oak.security.user.UserAuthenticationFactoryImpl;
 import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
@@ -42,6 +41,7 @@ import org.apache.jackrabbit.oak.spi.security.authentication.ImpersonationCreden
 import org.apache.jackrabbit.oak.spi.security.authentication.PreAuthenticatedLogin;
 import org.apache.jackrabbit.oak.spi.security.authentication.callback.CredentialsCallback;
 import org.apache.jackrabbit.oak.spi.security.authentication.callback.RepositoryCallback;
+import org.apache.jackrabbit.oak.spi.security.principal.PrincipalConfiguration;
 import org.apache.jackrabbit.oak.spi.security.principal.PrincipalImpl;
 import org.apache.jackrabbit.oak.spi.security.user.UserAuthenticationFactory;
 import org.apache.jackrabbit.oak.spi.security.user.UserConfiguration;
@@ -50,6 +50,7 @@ import org.apache.jackrabbit.oak.spi.security.user.util.UserUtil;
 import org.jetbrains.annotations.NotNull;
 import org.jetbrains.annotations.Nullable;
 import org.junit.Test;
+import org.slf4j.event.Level;
 
 import javax.jcr.Credentials;
 import javax.jcr.GuestCredentials;
@@ -63,11 +64,13 @@ import javax.security.auth.login.Configuration;
 import javax.security.auth.login.LoginException;
 import java.lang.reflect.Field;
 import java.security.Principal;
+import java.security.PrivilegedExceptionAction;
 import java.util.Arrays;
-import java.util.HashMap;
+import java.util.Collections;
 import java.util.Map;
 import java.util.Set;
 
+import static org.apache.jackrabbit.oak.spi.security.authentication.AbstractLoginModule.SHARED_KEY_CREDENTIALS;
 import static org.apache.jackrabbit.oak.spi.security.authentication.AbstractLoginModule.SHARED_KEY_PRE_AUTH_LOGIN;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
@@ -76,13 +79,8 @@ import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertTrue;
 import static org.junit.Assert.fail;
 import static org.mockito.ArgumentMatchers.any;
-import static org.mockito.ArgumentMatchers.anyList;
 import static org.mockito.ArgumentMatchers.anyString;
 import static org.mockito.Mockito.mock;
-import static org.mockito.Mockito.never;
-import static org.mockito.Mockito.spy;
-import static org.mockito.Mockito.times;
-import static org.mockito.Mockito.verify;
 import static org.mockito.Mockito.when;
 
 public class LoginModuleImplTest extends AbstractSecurityTest {
@@ -292,27 +290,43 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
 
     @Test
     public void testLoginPreAuthenticated() throws Exception {
+        User testUser = getTestUser();
+        Set<? extends Principal> principals = getConfig(PrincipalConfiguration.class).getPrincipalProvider(root, NamePathMapper.DEFAULT).getPrincipals(testUser.getID());
+
         Authentication authentication = mock(Authentication.class);
         when(authentication.authenticate(any(Credentials.class))).thenReturn(true).getMock();
-        when(authentication.getUserId()).thenReturn("uid"); // but getUserPrincipal returns null
+        when(authentication.getUserId()).thenReturn(testUser.getID()); // but getUserPrincipal returns null
+
+        Principal foreignPrincipal = new PrincipalImpl("foreign");
 
         UserAuthenticationFactory uaf = when(mock(UserAuthenticationFactory.class).getAuthentication(any(UserConfiguration.class), any(Root.class), anyString())).thenReturn(authentication).getMock();
         Map<String, Object> sharedState = Maps.newHashMap();
         sharedState.put(SHARED_KEY_PRE_AUTH_LOGIN, new PreAuthenticatedLogin("uid"));
 
-        Subject subject = new Subject();
+        Subject subject = new Subject(false, ImmutableSet.of(foreignPrincipal), ImmutableSet.of(), ImmutableSet.of());
         LoginModuleImpl lm = new LoginModuleImpl();
         lm.initialize(subject, new TestCallbackHandler(uaf), sharedState, Maps.newHashMap());
         assertTrue(lm.login());
         assertTrue(lm.commit());
 
-        assertTrue(subject.getPrincipals().isEmpty());
+        // verify subject has been updated with test-user principals
+        Set<Principal> expected = new ImmutableSet.Builder().add(foreignPrincipal).addAll(principals).build();
+        assertEquals(expected, subject.getPrincipals());
         // no other public credentials than the AuthInfo
         assertEquals(1, subject.getPublicCredentials().size());
+
         // verify AuthInfo
         Set<AuthInfo> authInfos = subject.getPublicCredentials(AuthInfo.class);
         assertFalse(authInfos.isEmpty());
-        assertEquals("uid", authInfos.iterator().next().getUserID());
+        AuthInfo ai = authInfos.iterator().next();
+        assertEquals(testUser.getID(), ai.getUserID());
+        assertEquals(expected, ai.getPrincipals());
+
+        // verify logout only removes credentials/principals associated with this very login module
+        assertTrue(lm.logout());
+        assertTrue(subject.getPublicCredentials().isEmpty());
+        assertTrue(subject.getPrincipals().contains(foreignPrincipal));
+        assertFalse(subject.getPrincipals().containsAll(principals));
     }
 
     @Test
@@ -332,6 +346,31 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
 
         assertTrue(subject.getPrincipals().isEmpty());
         assertTrue(subject.getPublicCredentials().isEmpty());
+
+        assertTrue(lm.logout());
+    }
+
+    @Test
+    public void testLoginWithReadOnlySubject() throws Exception {
+        Map<String, Object> sharedState = Maps.newHashMap();
+        sharedState.put(SHARED_KEY_CREDENTIALS, getAdminCredentials());
+
+        Principal unknownPrincipal = new PrincipalImpl("unknown");
+        Subject subject = new Subject(true, Collections.singleton(unknownPrincipal), Collections.emptySet(), Collections.emptySet());
+
+        LoginModuleImpl lm = new LoginModuleImpl();
+        lm.initialize(subject, new TestCallbackHandler(new UserAuthenticationFactoryImpl()), sharedState, Maps.newHashMap());
+
+        assertTrue(lm.login());
+        assertTrue(lm.commit());
+
+        assertFalse(subject.getPrincipals().isEmpty());
+        assertTrue(subject.getPublicCredentials().isEmpty());
+
+        assertTrue(lm.logout());
+
+        assertFalse(subject.getPrincipals().isEmpty());
+        assertTrue(subject.getPublicCredentials().isEmpty());
     }
 
     @Test
@@ -342,6 +381,7 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
 
         assertFalse(loginModule.login());
         assertFalse(loginModule.commit());
+        assertFalse(loginModule.logout());
     }
 
     @Test
@@ -364,6 +404,7 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
 
         assertFalse(loginModule.login());
         assertFalse(loginModule.commit());
+        assertFalse(loginModule.logout());
     }
 
     @Test
@@ -384,6 +425,7 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
 
         assertFalse(loginModule.login());
         assertFalse(loginModule.commit());
+        assertFalse(loginModule.logout());
     }
 
     @Test
@@ -404,6 +446,7 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
 
         assertFalse(loginModule.login());
         assertFalse(loginModule.commit());
+        assertFalse(loginModule.logout());
     }
 
     @Test
@@ -424,6 +467,7 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
 
         assertFalse(loginModule.login());
         assertFalse(loginModule.commit());
+        assertFalse(loginModule.logout());
     }
 
     @Test
@@ -433,6 +477,7 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
 
         assertFalse(loginModule.login());
         assertFalse(loginModule.commit());
+        assertFalse(loginModule.logout());
     }
 
     @Test
@@ -468,6 +513,10 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
         // authinfo falls back to loginId because Authentication.getUserId returned null
         AuthInfo authInfo = subject.getPublicCredentials(AuthInfo.class).iterator().next();
         assertEquals("loginId", authInfo.getUserID());
+
+        assertTrue(loginModule.logout());
+        assertTrue(subject.getPrincipals().isEmpty());
+        assertTrue(subject.getPublicCredentials().isEmpty());
     }
 
     @Test
@@ -502,6 +551,10 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
         AuthInfo authInfo = subject.getPublicCredentials(AuthInfo.class).iterator().next();
         assertNull(authInfo.getUserID());
         assertTrue(subject.getPrincipals().isEmpty());
+
+        assertTrue(loginModule.logout());
+        assertTrue(subject.getPublicCredentials().isEmpty());
+        assertTrue(subject.getPrincipals().isEmpty());
     }
 
     @Test
@@ -527,6 +580,28 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
         assertTrue(ai.getPrincipals().contains(getTestUser().getPrincipal()));
     }
 
+    @Test
+    public void testLoginLogoutPreexistingReadonlySubject() throws Exception {
+        createTestUser();
+        Subject subject = new Subject(true, Collections.singleton(() -> "JMXPrincipal: foo"), Collections.EMPTY_SET, Collections.EMPTY_SET);
+        Subject.doAs(subject, (PrivilegedExceptionAction<Void>) () -> {
+            LogCustomizer logCustomizer = LogCustomizer
+                    .forLogger("org.apache.jackrabbit.oak.core.ContentSessionImpl")
+                    .enable(Level.ERROR)
+                    .create();
+
+            ContentSession cs = login(new SimpleCredentials(USER_ID, USER_PW.toCharArray()));
+            try {
+                logCustomizer.starting();
+                cs.close();
+            } finally {
+                //verify that ContentSessionImpl.close() did not log anything
+                assertEquals(0, logCustomizer.getLogs().size());
+                logCustomizer.finished();
+            }
+            return null;
+        });
+    }
 
     private class TestCallbackHandler implements CallbackHandler {
 
