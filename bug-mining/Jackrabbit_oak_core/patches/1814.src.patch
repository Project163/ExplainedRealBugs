diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
index 73d2507453..f5bb3f0b42 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImpl.java
@@ -203,27 +203,16 @@ public final class LoginModuleImpl extends AbstractLoginModule {
         }
 
         String uid = null;
-        if (credentials != null) {
-            if (credentials instanceof SimpleCredentials) {
-                uid = ((SimpleCredentials) credentials).getUserID();
-            } else if (credentials instanceof GuestCredentials) {
-                uid = getAnonymousId();
-            } else if (credentials instanceof ImpersonationCredentials) {
-                Credentials bc = ((ImpersonationCredentials) credentials).getBaseCredentials();
-                if (bc instanceof SimpleCredentials) {
-                    uid = ((SimpleCredentials) bc).getUserID();
-                }
-            } else {
-                try {
-                    NameCallback callback = new NameCallback("User-ID: ");
-                    callbackHandler.handle(new Callback[] { callback });
-                    uid = callback.getName();
-                } catch (IOException | UnsupportedCallbackException e) {
-                    onError();
-                    log.error(e.getMessage(), e);
-                }
+        if (credentials instanceof SimpleCredentials) {
+            uid = ((SimpleCredentials) credentials).getUserID();
+        } else if (credentials instanceof GuestCredentials) {
+            uid = getAnonymousId();
+        } else if (credentials instanceof ImpersonationCredentials) {
+            Credentials bc = ((ImpersonationCredentials) credentials).getBaseCredentials();
+            if (bc instanceof SimpleCredentials) {
+                uid = ((SimpleCredentials) bc).getUserID();
             }
-        }
+        } // null or other (unsupported) type of credentials (see SUPPORTED_CREDENTIALS)
 
         if (uid == null) {
             uid = getSharedLoginName();
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java
index 3d316245fe..c5a3056a65 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authentication/user/LoginModuleImplTest.java
@@ -35,6 +35,7 @@ import org.apache.jackrabbit.oak.spi.security.authentication.Authentication;
 import org.apache.jackrabbit.oak.spi.security.authentication.ConfigurationUtil;
 import org.apache.jackrabbit.oak.spi.security.authentication.ImpersonationCredentials;
 import org.apache.jackrabbit.oak.spi.security.authentication.PreAuthenticatedLogin;
+import org.apache.jackrabbit.oak.spi.security.authentication.callback.CredentialsCallback;
 import org.apache.jackrabbit.oak.spi.security.authentication.callback.RepositoryCallback;
 import org.apache.jackrabbit.oak.spi.security.user.UserAuthenticationFactory;
 import org.apache.jackrabbit.oak.spi.security.user.UserConfiguration;
@@ -253,6 +254,29 @@ public class LoginModuleImplTest extends AbstractSecurityTest {
         }
     }
 
+    @Test
+    public void LoginUnsupportedCredentials() throws Exception {
+        Credentials unsupportedCredentials = mock(Credentials.class);
+
+        CallbackHandler cbh = callbacks -> {
+            for (Callback callback : callbacks) {
+                if (callback instanceof RepositoryCallback) {
+                    ((RepositoryCallback) callback).setSecurityProvider(getSecurityProvider());
+                    ((RepositoryCallback) callback).setContentRepository(getContentRepository());
+                } else if (callback instanceof CredentialsCallback) {
+                    ((CredentialsCallback) callback).setCredentials(unsupportedCredentials);
+                } else {
+                    throw new UnsupportedCallbackException(callback);
+                }
+            }
+        };
+
+        Subject subject = new Subject(false, ImmutableSet.of(), ImmutableSet.of(unsupportedCredentials), ImmutableSet.of());
+        LoginModuleImpl lm = new LoginModuleImpl();
+        lm.initialize(subject, cbh, Maps.newHashMap(), Maps.newHashMap());
+        assertFalse(lm.login());
+    }
+
     @Test
     public void testLoginPreAuthenticated() throws Exception {
         Authentication authentication = mock(Authentication.class);
