diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/osgi/ObserverTracker.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/osgi/ObserverTracker.java
index f3662c6167..cf3dfbfb56 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/osgi/ObserverTracker.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/osgi/ObserverTracker.java
@@ -80,8 +80,9 @@ public class ObserverTracker implements ServiceTrackerCustomizer {
 
     @Override
     public void removedService(ServiceReference reference, Object service) {
-        if (subscriptions.containsKey(reference)) {
-            Closeables.closeQuietly(subscriptions.get(reference));
+        Closeable subscription = subscriptions.remove(reference);
+        if (subscription != null) {
+            Closeables.closeQuietly(subscription);
             bundleContext.ungetService(reference);
         }
     }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/osgi/ObserverTrackerTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/osgi/ObserverTrackerTest.java
index 55afc24429..d32bd0679e 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/osgi/ObserverTrackerTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/osgi/ObserverTrackerTest.java
@@ -34,7 +34,6 @@ import org.apache.jackrabbit.oak.spi.commit.Observable;
 import org.apache.jackrabbit.oak.spi.commit.Observer;
 import org.junit.After;
 import org.junit.Before;
-import org.junit.Ignore;
 import org.junit.Test;
 import org.osgi.framework.BundleContext;
 import org.osgi.framework.ServiceReference;
@@ -109,7 +108,6 @@ public class ObserverTrackerTest {
     }
 
     @Test
-    @Ignore("OAK-2845")  // FIXME OAK-2845
     public void unregisterTwice() {
         tracker.addingService(ref1);
         assertEquals(ImmutableSet.of(observer1), observers);
