diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/CompactionGainEstimate.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/CompactionGainEstimate.java
index d3f31afb21..a3c2301f8a 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/CompactionGainEstimate.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/CompactionGainEstimate.java
@@ -17,6 +17,7 @@
 package org.apache.jackrabbit.oak.plugins.segment.file;
 
 import static org.apache.jackrabbit.oak.api.Type.BINARIES;
+import static org.apache.jackrabbit.oak.api.Type.BINARY;
 
 import java.io.File;
 import java.util.UUID;
@@ -24,8 +25,10 @@ import java.util.UUID;
 import com.google.common.hash.BloomFilter;
 import com.google.common.hash.Funnel;
 import com.google.common.hash.PrimitiveSink;
+
 import org.apache.jackrabbit.oak.api.Blob;
 import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.plugins.segment.RecordIdSet;
 import org.apache.jackrabbit.oak.plugins.segment.SegmentBlob;
 import org.apache.jackrabbit.oak.plugins.segment.SegmentId;
@@ -62,10 +65,18 @@ class CompactionGainEstimate implements TarEntryVisitor {
                     collectUUID(((SegmentPropertyState) property)
                             .getRecordId().getSegmentId());
                 }
-                for (Blob blob : property.getValue(BINARIES)) {
+                Type<?> type = property.getType();
+                if (type == BINARY) {
+                    Blob blob = property.getValue(BINARY);
                     for (SegmentId id : SegmentBlob.getBulkSegmentIds(blob)) {
                         collectUUID(id);
                     }
+                } else if (type == BINARIES) {
+                    for (Blob blob : property.getValue(BINARIES)) {
+                        for (SegmentId id : SegmentBlob.getBulkSegmentIds(blob)) {
+                            collectUUID(id);
+                        }
+                    }
                 }
             }
             for (ChildNodeEntry child : node.getChildNodeEntries()) {
