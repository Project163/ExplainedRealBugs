diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
index 28ad90e731..d3e1ae9745 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStore.java
@@ -425,14 +425,19 @@ public class FileStore implements SegmentStore {
         try {
             Iterator<String> heads = journalReader.iterator();
             while (id == null && heads.hasNext()) {
-                RecordId last = RecordId.fromString(tracker, heads.next());
-                SegmentId segmentId = last.getSegmentId();
-                if (containsSegment(
-                        segmentId.getMostSignificantBits(),
-                        segmentId.getLeastSignificantBits())) {
-                    id = last;
-                } else {
-                    log.warn("Unable to access revision {}, rewinding...", last);
+                String head = heads.next();
+                try {
+                    RecordId last = RecordId.fromString(tracker, head);
+                    SegmentId segmentId = last.getSegmentId();
+                    if (containsSegment(
+                            segmentId.getMostSignificantBits(),
+                            segmentId.getLeastSignificantBits())) {
+                        id = last;
+                    } else {
+                        log.warn("Unable to access revision {}, rewinding...", last);
+                    }
+                } catch (IllegalArgumentException e) {
+                    log.warn("Skipping invalid record id {}", head);
                 }
             }
         } finally {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/tooling/ConsistencyChecker.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/tooling/ConsistencyChecker.java
index c03fe879d0..0dc325d152 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/tooling/ConsistencyChecker.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/tooling/ConsistencyChecker.java
@@ -78,19 +78,23 @@ public class ConsistencyChecker {
         try {
             int revisionCount = 0;
             for (String revision : journal) {
-                print("Checking revision {}", revision);
-                revisionCount++;
-                String badPath = checker.check(revision, badPaths, binLen);
-                if (badPath == null && fullTraversal) {
-                    badPath = checker.traverse(revision, binLen);
-                }
-                if (badPath == null) {
-                    print("Found latest good revision {}", revision);
-                    print("Searched through {} revisions", revisionCount);
-                    return revision;
-                } else {
-                    badPaths.add(badPath);
-                    print("Broken revision {}", revision);
+                try {
+                    print("Checking revision {}", revision);
+                    revisionCount++;
+                    String badPath = checker.check(revision, badPaths, binLen);
+                    if (badPath == null && fullTraversal) {
+                        badPath = checker.traverse(revision, binLen);
+                    }
+                    if (badPath == null) {
+                        print("Found latest good revision {}", revision);
+                        print("Searched through {} revisions", revisionCount);
+                        return revision;
+                    } else {
+                        badPaths.add(badPath);
+                        print("Broken revision {}", revision);
+                    }
+                } catch (IllegalArgumentException e) {
+                    print("Skipping invalid record id {}", revision);
                 }
             }
         } finally {
