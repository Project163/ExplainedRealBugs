diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/CommitQueue.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/CommitQueue.java
index a5a8676f4c..1e3a7bba04 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/CommitQueue.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/CommitQueue.java
@@ -77,8 +77,11 @@ class CommitQueue {
     void done(@Nonnull Commit commit, boolean isBranch, @Nullable CommitInfo info) {
         checkNotNull(commit);
         if (isBranch) {
-            commit.applyToCache(commit.getBaseRevision(), true);
-            removeCommit(commit.getRevision());
+            try {
+                commit.applyToCache(commit.getBaseRevision(), true);
+            } finally {
+                removeCommit(commit.getRevision());
+            }
         } else {
             afterTrunkCommit(commit, info);
         }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CommitQueueTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CommitQueueTest.java
index 41147fa953..8dddbe0874 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CommitQueueTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CommitQueueTest.java
@@ -26,11 +26,16 @@ import java.util.concurrent.atomic.AtomicBoolean;
 import javax.annotation.Nonnull;
 import javax.annotation.Nullable;
 
+import org.apache.jackrabbit.oak.spi.commit.ChangeDispatcher;
 import org.apache.jackrabbit.oak.spi.commit.CommitInfo;
 import org.apache.jackrabbit.oak.spi.commit.Observer;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.junit.Test;
 
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.fail;
+
 /**
  * Tests for {@link CommitQueue}.
  */
@@ -106,4 +111,41 @@ public class CommitQueueTest {
         }
     }
 
+    // OAK-2867
+    @Test
+    public void doneFailsWithException() throws Exception {
+        final DocumentNodeStore store = new DocumentMK.Builder().getNodeStore();
+        final CommitQueue commits = new CommitQueue(store,
+                new ChangeDispatcher(store.getRoot()));
+        Revision r = commits.createRevision();
+        Commit c = new Commit(store, r, store.getHeadRevision(),
+                store.createBranch(store.getRoot())) {
+            @Override
+            public void applyToCache(Revision before, boolean isBranchCommit) {
+                throw new RuntimeException("applyToCache");
+            }
+        };
+
+        try {
+            commits.done(c, true, null);
+            fail("must fail with RuntimeException");
+        } catch (Exception e) {
+            assertEquals("applyToCache", e.getMessage());
+        }
+
+        Thread t = new Thread(new Runnable() {
+            @Override
+            public void run() {
+                Commit c = new Commit(store, commits.createRevision(),
+                        store.getHeadRevision(), null);
+                commits.done(c, false, null);
+            }
+        });
+        t.start();
+        t.join(3000);
+        assertFalse("Commit did not succeed within 3 seconds", t.isAlive());
+
+        store.dispose();
+    }
+
 }
