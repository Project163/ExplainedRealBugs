diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/SharedDataStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/SharedDataStore.java
index f23c321d68..08e4ce1995 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/SharedDataStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/SharedDataStore.java
@@ -79,7 +79,7 @@ public interface SharedDataStore {
      *
      * @return iterator over DataRecords
      */
-    Iterator<DataRecord> getAllRecords();
+    Iterator<DataRecord> getAllRecords() throws DataStoreException;
 
     /**
      * Gets the type.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java
index dff4355098..d0b35e0eda 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java
@@ -454,11 +454,23 @@ public class DataStoreBlobStore implements DataStore, SharedDataStore, BlobStore
     }
 
     @Override
-    public Iterator<DataRecord> getAllRecords() {
+    public Iterator<DataRecord> getAllRecords() throws DataStoreException {
         if (delegate instanceof SharedDataStore) {
             return ((SharedDataStore) delegate).getAllRecords();
+        } else {
+            return Iterators.transform(delegate.getAllIdentifiers(),
+                new Function<DataIdentifier, DataRecord>() {
+                    @Nullable @Override
+                    public DataRecord apply(@Nullable DataIdentifier input) {
+                        try {
+                            return delegate.getRecord(input);
+                        } catch (DataStoreException e) {
+                            log.warn("Error occurred while fetching DataRecord for identifier {}", input, e);
+                        }
+                        return null;
+                    }
+            });
         }
-        return Iterators.emptyIterator();
     }
 
     @Override
