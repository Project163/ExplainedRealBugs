diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
index 957160242a..f2b5ff2359 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
@@ -1243,14 +1243,17 @@ public class SQL2Parser {
             readDecimal(i - 1, i);
             return;
         case CHAR_BRACKETED:
+            currentTokenQuoted = true;
             readString(i, ']');
             currentTokenType = IDENTIFIER;
             currentToken = currentValue.getValue(Type.STRING);
             return;
         case CHAR_STRING:
+            currentTokenQuoted = true;
             readString(i, '\'');
             return;
         case CHAR_QUOTED:
+            currentTokenQuoted = true;
             readString(i, '\"');
             if (supportSQL1) {
                 // for SQL-2, this is a literal, as defined in
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/XPathToSQL2Converter.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/XPathToSQL2Converter.java
index 90bfaaa7e5..bcbc20e930 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/XPathToSQL2Converter.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/XPathToSQL2Converter.java
@@ -980,6 +980,7 @@ public class XPathToSQL2Converter {
             readDecimal(i - 1, i);
             return;
         case CHAR_STRING:
+            currentTokenQuoted = true;
             if (chars[i - 1] == '\'') {
                 readString(i, '\'');
             } else {
diff --git a/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/sql2_measure.txt b/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/sql2_measure.txt
index bbf7121a02..0f0b8e288f 100644
--- a/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/sql2_measure.txt
+++ b/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/sql2_measure.txt
@@ -24,6 +24,10 @@
 # * new tests are typically be added on top, after the syntax docs
 # * use ascii character only
 
+# OAK-5949
+explain [SELECT] * from [nt:base]
+java.text.ParseException: Query: explain [SELECT](*)* from [nt:base]; expected: SELECT
+
 commit / + "testRoot": { }
 commit /testRoot + "parents": { "p0": {"id": "0"}, "p1": {"id": "1"}, "p2": {"id": "2"}}
 commit /testRoot + "children": { "c1": {"p": "1"}, "c2": {"p": "1"}, "c3": {"p": "2"}, "c4": {"p": "3"}}
diff --git a/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/xpath.txt b/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/xpath.txt
index 98d4b853fe..51cd080fb7 100644
--- a/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/xpath.txt
+++ b/oak-core/src/test/resources/org/apache/jackrabbit/oak/query/xpath.txt
@@ -24,6 +24,15 @@
 # * new tests are typically be added on top, after the syntax docs
 # * use ascii character only
 
+# OAK-5949
+
+xpath2sql /jcr:root/home//element(*,rep:Authorizable)[jcr:like(@rep:authorizableId,'@')]
+select [jcr:path], [jcr:score], *
+  from [rep:Authorizable] as a
+  where [rep:authorizableId] like '@'
+  and isdescendantnode(a, '/home')
+  /* xpath ... */
+
 # OAK-4387
 xpath2sql /jcr:root/content/text/element/rep:excerpt/jcr:content//element(*,nt:unstructured)
 select [jcr:path], [jcr:score], *
