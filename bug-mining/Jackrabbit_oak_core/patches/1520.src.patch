diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/internal/ConfigurationInitializer.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/internal/ConfigurationInitializer.java
new file mode 100644
index 0000000000..f2a59620fd
--- /dev/null
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/internal/ConfigurationInitializer.java
@@ -0,0 +1,56 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.jackrabbit.oak.security.internal;
+
+import java.util.List;
+import javax.annotation.Nonnull;
+
+import org.apache.jackrabbit.oak.spi.security.CompositeConfiguration;
+import org.apache.jackrabbit.oak.spi.security.ConfigurationBase;
+import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
+import org.apache.jackrabbit.oak.spi.security.SecurityConfiguration;
+import org.apache.jackrabbit.oak.spi.security.SecurityProvider;
+
+class ConfigurationInitializer {
+
+    private ConfigurationInitializer() {}
+
+    @Nonnull
+    static <T extends SecurityConfiguration> T initializeConfiguration(@Nonnull SecurityProvider securityProvider, @Nonnull T configuration) {
+        return initializeConfiguration(securityProvider, configuration, ConfigurationParameters.EMPTY);
+    }
+
+    @Nonnull
+    static <T extends SecurityConfiguration> T initializeConfiguration(@Nonnull SecurityProvider securityProvider, @Nonnull T configuration, @Nonnull ConfigurationParameters parameters) {
+        if (configuration instanceof ConfigurationBase) {
+            ConfigurationBase base = (ConfigurationBase) configuration;
+            base.setSecurityProvider(securityProvider);
+            base.setParameters(ConfigurationParameters.of(base.getParameters(), parameters));
+        }
+        return configuration;
+    }
+
+    static void initializeConfigurations(@Nonnull SecurityProvider securityProvider,
+                                         @Nonnull CompositeConfiguration configuration,
+                                         @Nonnull ConfigurationParameters parameters) {
+        configuration.setSecurityProvider(securityProvider);
+        List<? extends SecurityConfiguration> configs = configuration.getConfigurations();
+        for (SecurityConfiguration config : configs) {
+            initializeConfiguration(securityProvider, config, parameters);
+        }
+    }
+}
\ No newline at end of file
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/internal/SecurityProviderRegistration.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/internal/SecurityProviderRegistration.java
index efa76ca451..1e38db459c 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/internal/SecurityProviderRegistration.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/internal/SecurityProviderRegistration.java
@@ -16,6 +16,12 @@
  */
 package org.apache.jackrabbit.oak.security.internal;
 
+import java.util.Dictionary;
+import java.util.Hashtable;
+import java.util.List;
+import java.util.Map;
+import javax.annotation.Nonnull;
+
 import org.apache.felix.scr.annotations.Activate;
 import org.apache.felix.scr.annotations.Component;
 import org.apache.felix.scr.annotations.Deactivate;
@@ -32,7 +38,6 @@ import org.apache.jackrabbit.oak.osgi.OsgiWhiteboard;
 import org.apache.jackrabbit.oak.security.authorization.composite.CompositeAuthorizationConfiguration;
 import org.apache.jackrabbit.oak.security.user.UserConfigurationImpl;
 import org.apache.jackrabbit.oak.spi.security.CompositeConfiguration;
-import org.apache.jackrabbit.oak.spi.security.ConfigurationBase;
 import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
 import org.apache.jackrabbit.oak.spi.security.SecurityConfiguration;
 import org.apache.jackrabbit.oak.spi.security.SecurityProvider;
@@ -60,13 +65,6 @@ import org.osgi.framework.ServiceRegistration;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
-import java.util.Dictionary;
-import java.util.Hashtable;
-import java.util.List;
-import java.util.Map;
-
-import javax.annotation.Nonnull;
-
 import static com.google.common.collect.Lists.newArrayList;
 import static com.google.common.collect.Lists.newCopyOnWriteArrayList;
 
@@ -482,25 +480,25 @@ public class SecurityProviderRegistration {
 
         // Static, mandatory references
 
-        securityProvider.setAuthenticationConfiguration(initializeConfiguration(securityProvider, authenticationConfiguration));
-        securityProvider.setPrivilegeConfiguration(initializeConfiguration(securityProvider, privilegeConfiguration));
+        securityProvider.setAuthenticationConfiguration(ConfigurationInitializer.initializeConfiguration(securityProvider, authenticationConfiguration));
+        securityProvider.setPrivilegeConfiguration(ConfigurationInitializer.initializeConfiguration(securityProvider, privilegeConfiguration));
 
         ConfigurationParameters userParams = ConfigurationParameters.of(
                 ConfigurationParameters.of(UserConstants.PARAM_AUTHORIZABLE_ACTION_PROVIDER, createWhiteboardAuthorizableActionProvider()),
                 ConfigurationParameters.of(UserConstants.PARAM_AUTHORIZABLE_NODE_NAME, createWhiteboardAuthorizableNodeName()),
                 ConfigurationParameters.of(UserConstants.PARAM_USER_AUTHENTICATION_FACTORY, createWhiteboardUserAuthenticationFactory()));
-        securityProvider.setUserConfiguration(initializeConfiguration(securityProvider, userConfiguration, userParams));
+        securityProvider.setUserConfiguration(ConfigurationInitializer.initializeConfiguration(securityProvider, userConfiguration, userParams));
 
         // Multiple, dynamic references
 
         ConfigurationParameters restrictionParams = ConfigurationParameters.of(AccessControlConstants.PARAM_RESTRICTION_PROVIDER, createWhiteboardRestrictionProvider());
-        initializeConfigurations(securityProvider, authorizationConfiguration, restrictionParams);
+        ConfigurationInitializer.initializeConfigurations(securityProvider, authorizationConfiguration, restrictionParams);
         securityProvider.setAuthorizationConfiguration(authorizationConfiguration);
 
-        initializeConfigurations(securityProvider, principalConfiguration, ConfigurationParameters.EMPTY);
+        ConfigurationInitializer.initializeConfigurations(securityProvider, principalConfiguration, ConfigurationParameters.EMPTY);
         securityProvider.setPrincipalConfiguration(principalConfiguration);
 
-        initializeConfigurations(securityProvider, tokenConfiguration, ConfigurationParameters.EMPTY);
+        ConfigurationInitializer.initializeConfigurations(securityProvider, tokenConfiguration, ConfigurationParameters.EMPTY);
         securityProvider.setTokenConfiguration(tokenConfiguration);
 
         // Whiteboard
@@ -510,30 +508,6 @@ public class SecurityProviderRegistration {
         return securityProvider;
     }
 
-    private static <T extends SecurityConfiguration> T initializeConfiguration(@Nonnull SecurityProvider securityProvider, @Nonnull T configuration) {
-        return initializeConfiguration(securityProvider, configuration, ConfigurationParameters.EMPTY);
-    }
-
-    private static <T extends SecurityConfiguration> T initializeConfiguration(@Nonnull SecurityProvider securityProvider, @Nonnull T configuration, @Nonnull ConfigurationParameters parameters) {
-        if (configuration instanceof ConfigurationBase) {
-            ConfigurationBase base = (ConfigurationBase) configuration;
-            base.setSecurityProvider(securityProvider);
-            base.setParameters(ConfigurationParameters.of(parameters, base.getParameters()));
-        }
-
-        return configuration;
-    }
-
-    private static void initializeConfigurations(@Nonnull SecurityProvider securityProvider,
-                                                 @Nonnull CompositeConfiguration configuration,
-                                                 @Nonnull ConfigurationParameters parameters) {
-        configuration.setSecurityProvider(securityProvider);
-        List<? extends SecurityConfiguration> configs = configuration.getConfigurations();
-        for (SecurityConfiguration config : configs) {
-            initializeConfiguration(securityProvider, config, parameters);
-        }
-    }
-
     private RestrictionProvider createWhiteboardRestrictionProvider() {
         return new WhiteboardRestrictionProvider() {
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/internal/ConfigurationInitializerTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/internal/ConfigurationInitializerTest.java
new file mode 100644
index 0000000000..a8043cd719
--- /dev/null
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/internal/ConfigurationInitializerTest.java
@@ -0,0 +1,165 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.jackrabbit.oak.security.internal;
+
+import javax.annotation.Nonnull;
+
+import org.apache.jackrabbit.oak.spi.security.CompositeConfiguration;
+import org.apache.jackrabbit.oak.spi.security.ConfigurationBase;
+import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
+import org.apache.jackrabbit.oak.spi.security.SecurityConfiguration;
+import org.apache.jackrabbit.oak.spi.security.SecurityProvider;
+import org.junit.Test;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertSame;
+import static org.junit.Assert.assertTrue;
+
+public class ConfigurationInitializerTest {
+
+    private final SecurityProvider sp = new InternalSecurityProvider();
+    private final ConfigurationParameters params = ConfigurationParameters.of("key", "value");
+
+    @Test
+    public void testInitConfigurationReturnsSame() {
+        SecurityConfiguration sc = new SecurityConfiguration.Default();
+
+        assertSame(sc, ConfigurationInitializer.initializeConfiguration(sp, sc));
+    }
+
+    @Test
+    public void testInitBaseConfigurationReturnsSame() {
+        SecurityConfiguration sc = new TestConfiguration();
+
+        assertSame(sc, ConfigurationInitializer.initializeConfiguration(sp, sc));
+    }
+
+    @Test
+    public void testInitConfigurationWithParamReturnsSame() {
+        SecurityConfiguration sc = new SecurityConfiguration.Default();
+        assertSame(sc, ConfigurationInitializer.initializeConfiguration(sp, sc, params));
+    }
+
+    @Test
+    public void testInitBaseConfigurationWithParamReturnsSame() {
+        SecurityConfiguration sc = new TestConfiguration();
+        assertSame(sc, ConfigurationInitializer.initializeConfiguration(sp, sc, params));
+    }
+
+    @Test
+    public void testInitNonBaseConfiguration() {
+        SecurityConfiguration sc = new SecurityConfiguration.Default();
+
+        ConfigurationInitializer.initializeConfiguration(sp, sc);
+        assertFalse(sc.getParameters().containsKey("key"));
+    }
+
+    @Test
+    public void testInitBaseConfiguration() {
+        TestConfiguration sc = new TestConfiguration();
+
+        SecurityConfiguration afterInit = ConfigurationInitializer.initializeConfiguration(sp, sc);
+        assertSame(sc, afterInit);
+
+        // verify securityprovider
+        assertSame(sp, sc.getSecurityProvider());
+
+        // verify params
+        ConfigurationParameters parameters = afterInit.getParameters();
+        assertTrue(parameters.containsKey("key"));
+        assertTrue(parameters.containsKey("key2"));
+        assertEquals("initialValue", parameters.get("key"));
+        assertEquals("initialValue", parameters.get("key2"));
+    }
+
+    @Test
+    public void testInitBaseConfigurationWithParam() {
+        TestConfiguration sc = new TestConfiguration();
+
+        SecurityConfiguration afterInit = ConfigurationInitializer.initializeConfiguration(sp, sc, params);
+        assertSame(sc, afterInit);
+
+        // verify securityprovider
+        assertSame(sp, sc.getSecurityProvider());
+
+        // verify params
+        ConfigurationParameters parameters = afterInit.getParameters();
+        assertTrue(parameters.containsKey("key"));
+        assertTrue(parameters.containsKey("key2"));
+        assertEquals("value", parameters.get("key"));
+        assertEquals("initialValue", parameters.get("key2"));
+    }
+
+    @Test
+    public void testInitCompositeConfiguration() {
+        TestComposite<SecurityConfiguration.Default> composite = new TestComposite<SecurityConfiguration.Default>();
+        composite.addConfiguration(new SecurityConfiguration.Default());
+        composite.addConfiguration(new SecurityConfiguration.Default());
+
+        ConfigurationInitializer.initializeConfigurations(sp, composite, params);
+
+        // verify securityprovider
+        assertSame(sp, composite.getSecurityProvider());
+
+        // verify params
+        for (SecurityConfiguration.Default sc : composite.getConfigurations()) {
+            assertFalse(sc.getParameters().containsKey("key"));
+        }
+    }
+
+    @Test
+    public void testInitCompositeBaseConfiguration() {
+        TestComposite<TestConfiguration> composite = new TestComposite<TestConfiguration>();
+        composite.addConfiguration(new TestConfiguration());
+        composite.addConfiguration(new TestConfiguration());
+
+        ConfigurationInitializer.initializeConfigurations(sp, composite, params);
+
+        // verify securityprovider
+        assertSame(sp, composite.getSecurityProvider());
+
+        // verify params
+        for (SecurityConfiguration sc : composite.getConfigurations()) {
+            ConfigurationParameters parameters = sc.getParameters();
+            assertTrue(parameters.containsKey("key"));
+            assertTrue(parameters.containsKey("key2"));
+            assertEquals("value", parameters.get("key"));
+            assertEquals("initialValue", parameters.get("key2"));
+        }
+    }
+
+    private final class TestConfiguration extends ConfigurationBase {
+
+        TestConfiguration() {
+            super(sp, ConfigurationParameters.of("key", "initialValue", "key2", "initialValue"));
+        }
+    }
+
+    private final class TestComposite<T extends SecurityConfiguration> extends CompositeConfiguration<T> {
+
+        public TestComposite() {
+            super("name");
+        }
+
+        @Nonnull
+        @Override
+        public SecurityProvider getSecurityProvider() {
+            return super.getSecurityProvider();
+        }
+    }
+}
\ No newline at end of file
