diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/name/NamespaceRegistryImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/name/NamespaceRegistryImpl.java
index 2828240589..4c37da53f6 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/name/NamespaceRegistryImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/name/NamespaceRegistryImpl.java
@@ -26,6 +26,7 @@ import javax.jcr.RepositoryException;
 
 import org.apache.jackrabbit.JcrConstants;
 import org.apache.jackrabbit.oak.api.CommitFailedException;
+import org.apache.jackrabbit.oak.api.PropertyState;
 import org.apache.jackrabbit.oak.plugins.memory.StringValue;
 import org.apache.jackrabbit.oak.api.Root;
 import org.apache.jackrabbit.oak.api.Tree;
@@ -81,6 +82,12 @@ public abstract class NamespaceRegistryImpl
             Root root = getWriteRoot();
             Tree namespaces =
                     getOrCreate(root, JcrConstants.JCR_SYSTEM, REP_NAMESPACES);
+            // remove existing mapping to given uri
+            for (PropertyState p : namespaces.getProperties()) {
+                if (!p.isArray() && p.getValue().getString().equals(uri)) {
+                    namespaces.removeProperty(p.getName());
+                }
+            }
             namespaces.setProperty(prefix, new StringValue(uri));
             root.commit(DefaultConflictHandler.OURS);
             refresh();
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/name/NamespaceValidator.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/name/NamespaceValidator.java
index eed6b8b858..cd2820b646 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/name/NamespaceValidator.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/name/NamespaceValidator.java
@@ -49,7 +49,12 @@ class NamespaceValidator extends DefaultValidator {
             } else if (prefix.toLowerCase(Locale.ENGLISH).startsWith("xml")) {
                 throw new NamespaceValidatorException(
                         "XML prefixes are reserved", prefix);
+            } else if (map.containsValue(after.getValue().getString())) {
+                throw modificationNotAllowed(prefix);
             }
+        } else {
+            throw new NamespaceValidatorException(
+                    "Not a valid namespace prefix", prefix);
         }
     }
 
@@ -57,8 +62,7 @@ class NamespaceValidator extends DefaultValidator {
     public void propertyChanged(PropertyState before, PropertyState after)
             throws CommitFailedException {
         if (map.containsKey(after.getName())) {
-            throw new NamespaceValidatorException(
-                    "Namespace modification not allowed", after.getName());
+            throw modificationNotAllowed(after.getName());
         }
     }
 
@@ -70,4 +74,9 @@ class NamespaceValidator extends DefaultValidator {
         }
     }
 
+    private static NamespaceValidatorException modificationNotAllowed(String prefix) {
+        return new NamespaceValidatorException(
+                "Namespace modification not allowed", prefix);
+    }
+
 }
