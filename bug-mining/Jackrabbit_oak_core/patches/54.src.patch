diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/RootImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/RootImpl.java
index a3f2c2a047..6c940ebdbb 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/core/RootImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/core/RootImpl.java
@@ -38,8 +38,8 @@ import org.apache.jackrabbit.oak.spi.commit.ValidatorProvider;
 import org.apache.jackrabbit.oak.spi.security.authorization.AccessControlContext;
 import org.apache.jackrabbit.oak.spi.security.authorization.CompiledPermissions;
 import org.apache.jackrabbit.oak.spi.security.user.UserManagerConfig;
-import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeBuilder;
+import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeStateDiff;
 import org.apache.jackrabbit.oak.spi.state.NodeStore;
 import org.apache.jackrabbit.oak.spi.state.NodeStoreBranch;
@@ -157,7 +157,7 @@ public class RootImpl implements Root {
 
     @Override
     public final void refresh() {
-        branch = store.branch(commitEditor);
+        branch = store.branch();
         rootTree = TreeImpl.createRoot(this);
         permissions = this.accessControlContext.getPermissions();
     }
@@ -166,7 +166,7 @@ public class RootImpl implements Root {
     public void commit(ConflictHandler conflictHandler) throws CommitFailedException {
         rebase(conflictHandler);
         purgePendingChanges();
-        branch.merge();
+        branch.merge(commitEditor);
         refresh();
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStore.java
index a9bbdbf9d5..1782905ce0 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStore.java
@@ -25,8 +25,8 @@ import org.apache.jackrabbit.oak.spi.commit.CommitEditor;
 import org.apache.jackrabbit.oak.spi.commit.EmptyEditor;
 import org.apache.jackrabbit.oak.spi.commit.EmptyObserver;
 import org.apache.jackrabbit.oak.spi.commit.Observer;
-import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeBuilder;
+import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeStore;
 import org.apache.jackrabbit.oak.spi.state.NodeStoreBranch;
 
@@ -97,8 +97,8 @@ public class KernelNodeStore implements NodeStore {
     }
 
     @Override
-    public NodeStoreBranch branch(CommitEditor commitEditor) {
-        return new KernelNodeStoreBranch(this, commitEditor);
+    public NodeStoreBranch branch() {
+        return new KernelNodeStoreBranch(this);
     }
 
     @Override
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java
index 2de6cef156..8508c543c0 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreBranch.java
@@ -38,9 +38,6 @@ class KernelNodeStoreBranch implements NodeStoreBranch {
     /** The underlying store to which this branch belongs */
     private final KernelNodeStore store;
 
-    /** The commit editor */
-    private final CommitEditor editor;
-
     /** Base state of this branch */
     private final NodeState base;
 
@@ -53,14 +50,8 @@ class KernelNodeStoreBranch implements NodeStoreBranch {
     /** Last state which was committed to this branch */
     private NodeState committed;
 
-    KernelNodeStoreBranch(KernelNodeStore store, CommitEditor editor) {
+    KernelNodeStoreBranch(KernelNodeStore store) {
         this.store = store;
-        if (editor == null) {
-            this.editor = store.getEditor();
-        } else {
-            this.editor = new CompositeEditor(store.getEditor(), editor);
-        }
-
         MicroKernel kernel = store.getKernel();
         this.branchRevision = kernel.branch(null);
         this.currentRoot = new KernelNodeState(kernel, "/", branchRevision);
@@ -129,9 +120,12 @@ class KernelNodeStoreBranch implements NodeStoreBranch {
     }
 
     @Override
-    public KernelNodeState merge() throws CommitFailedException {
+    public KernelNodeState merge(CommitEditor editor) throws CommitFailedException {
         NodeState oldRoot = base;
-        NodeState toCommit = editor.editCommit(store, oldRoot, currentRoot);
+        CommitEditor commitEditor = editor == null
+                ? store.getEditor()
+                : new CompositeEditor(store.getEditor(), editor);
+        NodeState toCommit = commitEditor.editCommit(store, oldRoot, currentRoot);
         setRoot(toCommit);
 
         try {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeStore.java
index f4ffcd18ed..14c6c5a924 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/memory/MemoryNodeStore.java
@@ -21,9 +21,8 @@ import java.util.concurrent.atomic.AtomicReference;
 import org.apache.jackrabbit.oak.api.CommitFailedException;
 import org.apache.jackrabbit.oak.api.CoreValueFactory;
 import org.apache.jackrabbit.oak.spi.commit.CommitEditor;
-import org.apache.jackrabbit.oak.spi.commit.EmptyEditor;
-import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeBuilder;
+import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeStore;
 import org.apache.jackrabbit.oak.spi.state.NodeStoreBranch;
 
@@ -47,7 +46,7 @@ public class MemoryNodeStore implements NodeStore {
     }
 
     @Override
-    public NodeStoreBranch branch(CommitEditor editor) {
+    public NodeStoreBranch branch() {
         return new MemoryNodeStoreBranch(root.get());
     }
 
@@ -83,7 +82,7 @@ public class MemoryNodeStore implements NodeStore {
         }
 
         @Override
-        public NodeState merge() throws CommitFailedException {
+        public NodeState merge(CommitEditor editor) throws CommitFailedException {
             while (!MemoryNodeStore.this.root.compareAndSet(base, root)) {
                 // TODO: rebase();
                 throw new UnsupportedOperationException();
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeStore.java
index 3748586393..df61cc24e8 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeStore.java
@@ -19,7 +19,6 @@ package org.apache.jackrabbit.oak.spi.state;
 import javax.annotation.Nonnull;
 
 import org.apache.jackrabbit.oak.api.CoreValueFactory;
-import org.apache.jackrabbit.oak.spi.commit.CommitEditor;
 
 /**
  * Storage abstraction for trees. At any given point in time the stored
@@ -45,7 +44,7 @@ public interface NodeStore {
      * @return branch
      */
     @Nonnull
-    NodeStoreBranch branch(CommitEditor commitEditor);
+    NodeStoreBranch branch();
 
     /**
      * Returns a builder for constructing a new or modified node state.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeStoreBranch.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeStoreBranch.java
index c5aadf1c7c..feb0879e09 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeStoreBranch.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/state/NodeStoreBranch.java
@@ -19,6 +19,7 @@ package org.apache.jackrabbit.oak.spi.state;
 import javax.annotation.Nonnull;
 
 import org.apache.jackrabbit.oak.api.CommitFailedException;
+import org.apache.jackrabbit.oak.spi.commit.CommitEditor;
 
 public interface NodeStoreBranch {
 
@@ -65,12 +66,13 @@ public interface NodeStoreBranch {
 
     /**
      * Merges the changes in this branch to the main content tree.
+     * @param editor  commit editor to apply
      * @return the node state resulting from the merge.
      *
      * @throws CommitFailedException if the merge failed
      */
     @Nonnull
-    NodeState merge() throws CommitFailedException;
+    NodeState merge(CommitEditor editor) throws CommitFailedException;
 
 }
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreTest.java
index f189a85d5e..f89cd75a61 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/kernel/KernelNodeStoreTest.java
@@ -26,8 +26,8 @@ import org.apache.jackrabbit.oak.plugins.memory.MemoryNodeState;
 import org.apache.jackrabbit.oak.spi.commit.CommitEditor;
 import org.apache.jackrabbit.oak.spi.commit.EmptyEditor;
 import org.apache.jackrabbit.oak.spi.commit.Observer;
-import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeBuilder;
+import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.spi.state.NodeStore;
 import org.apache.jackrabbit.oak.spi.state.NodeStoreBranch;
 import org.junit.Before;
@@ -70,7 +70,7 @@ public class KernelNodeStoreTest {
 
     @Test
     public void branch() throws CommitFailedException {
-        NodeStoreBranch branch = store.branch(EmptyEditor.INSTANCE);
+        NodeStoreBranch branch = store.branch();
 
         NodeBuilder rootBuilder = store.getBuilder(branch.getRoot());
         NodeBuilder testBuilder = rootBuilder.getChildBuilder("test");
@@ -105,7 +105,7 @@ public class KernelNodeStoreTest {
         assertNull(testState.getChildNode("newNode"));
         assertNotNull(testState.getChildNode("x"));
 
-        branch.merge();
+        branch.merge(EmptyEditor.INSTANCE);
 
         // Assert changes are present in the trunk
         testState = store.getRoot().getChildNode("test");
@@ -138,9 +138,9 @@ public class KernelNodeStoreTest {
 
         NodeState newRoot = rootBuilder.getNodeState();
 
-        NodeStoreBranch branch = store.branch(EmptyEditor.INSTANCE);
+        NodeStoreBranch branch = store.branch();
         branch.setRoot(newRoot);
-        branch.merge();
+        branch.merge(EmptyEditor.INSTANCE);
         store.getRoot(); // triggers the observer
 
         NodeState before = states[0];
@@ -181,9 +181,9 @@ public class KernelNodeStoreTest {
 
         NodeState newRoot = rootBuilder.getNodeState();
 
-        NodeStoreBranch branch = store.branch(EmptyEditor.INSTANCE);
+        NodeStoreBranch branch = store.branch();
         branch.setRoot(newRoot);
-        branch.merge();
+        branch.merge(EmptyEditor.INSTANCE);
 
         NodeState test = store.getRoot().getChildNode("test");
         assertNotNull(test.getChildNode("newNode"));
