diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/XPathConditionVisitor.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/XPathConditionVisitor.java
index e057eed26d..30687fa9c4 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/XPathConditionVisitor.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/user/query/XPathConditionVisitor.java
@@ -59,7 +59,7 @@ class XPathConditionVisitor implements ConditionVisitor {
                 .append("')")
                 .append(" or ")
                 .append("jcr:like(fn:name(),'")
-                .append(QueryUtil.escapeNodeName(condition.getPattern()))
+                .append(QueryUtil.escapeForQuery(QueryUtil.escapeNodeName(condition.getPattern())))
                 .append("')")
                 .append(')');
     }
