diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/AbstractSecurityTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/AbstractSecurityTest.java
index 06fae3f710..167f269d59 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/AbstractSecurityTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/AbstractSecurityTest.java
@@ -196,6 +196,13 @@ public abstract class AbstractSecurityTest {
         return new ValueFactoryImpl(root, getNamePathMapper());
     }
 
+    protected long waitForSystemTimeIncrement(long old) {
+        while (old == System.currentTimeMillis()) {
+            // wait for system timer to move
+        }
+        return System.currentTimeMillis();
+    }
+
     protected User getTestUser() throws Exception {
         if (testUser == null) {
             String uid = "testUser" + UUID.randomUUID();
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/PasswordExpiryTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/PasswordExpiryTest.java
index 84a14cae38..4d6a3909b7 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/PasswordExpiryTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/user/PasswordExpiryTest.java
@@ -99,6 +99,7 @@ public class PasswordExpiryTest extends AbstractSecurityTest {
         PropertyState p1 = root.getTree(user.getPath()).getChild(UserConstants.REP_PWD).getProperty(UserConstants.REP_PASSWORD_LAST_MODIFIED);
         long oldModTime = p1.getValue(Type.LONG, 0);
         assertTrue(oldModTime > 0);
+        waitForSystemTimeIncrement(oldModTime);
         user.changePassword(userId);
         root.commit();
         PropertyState p2 = root.getTree(user.getPath()).getChild(UserConstants.REP_PWD).getProperty(UserConstants.REP_PASSWORD_LAST_MODIFIED);
