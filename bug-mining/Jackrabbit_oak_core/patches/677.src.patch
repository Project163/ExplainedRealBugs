diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/TarFile.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/TarFile.java
index b29bd952c6..6041da2679 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/TarFile.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/file/TarFile.java
@@ -81,6 +81,8 @@ class TarFile {
 
             if (name.isEmpty() && size == 0) {
                 break; // no more entries in this file
+            } else if (position + BLOCK_SIZE + size > len) {
+                break; // invalid entry, truncate the file at this point
             }
 
             try {
