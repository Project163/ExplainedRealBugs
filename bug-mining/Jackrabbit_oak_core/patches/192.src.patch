diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/nodetype/NodeTypeIndex.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/nodetype/NodeTypeIndex.java
index 8489d5c172..b6a4cc023d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/nodetype/NodeTypeIndex.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/nodetype/NodeTypeIndex.java
@@ -71,7 +71,7 @@ class NodeTypeIndex implements QueryIndex, JcrConstants {
                     "NodeType index is used even when no index is available for filter " + filter);
         }
         return Cursors.newPathCursorDistinct(lookup.query(
-                resolveNodeType(root, filter.getNodeType())));
+                filter, resolveNodeType(root, filter.getNodeType())));
     }
     
     @Override
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/nodetype/NodeTypeIndexLookup.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/nodetype/NodeTypeIndexLookup.java
index fbd5ad3b11..7eb90f83e1 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/nodetype/NodeTypeIndexLookup.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/nodetype/NodeTypeIndexLookup.java
@@ -19,6 +19,7 @@ package org.apache.jackrabbit.oak.plugins.index.nodetype;
 import org.apache.jackrabbit.JcrConstants;
 import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.plugins.index.p2.Property2IndexLookup;
+import org.apache.jackrabbit.oak.spi.query.Filter;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
 
@@ -74,15 +75,16 @@ class NodeTypeIndexLookup implements JcrConstants {
     /**
      * Returns the paths that match the given node types.
      *
+     * @param filter the filter (used for logging)
      * @param nodeTypes the names of the node types to match.
      * @return the matched paths (the result might contain duplicate entries)
      */
-    public Iterable<String> query(Iterable<String> nodeTypes) {
+    public Iterable<String> query(Filter filter, Iterable<String> nodeTypes) {
         final PropertyValue ntNames = PropertyValues.newName(nodeTypes);
         Property2IndexLookup lookup = new Property2IndexLookup(root);
         return Iterables.concat(
-                lookup.query(JCR_PRIMARYTYPE, ntNames),
-                lookup.query(JCR_MIXINTYPES, ntNames));
+                lookup.query(filter, JCR_PRIMARYTYPE, ntNames),
+                lookup.query(filter, JCR_MIXINTYPES, ntNames));
     }
 
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2Index.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2Index.java
index 69a30cc47e..7551ee6912 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2Index.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2Index.java
@@ -139,11 +139,11 @@ class Property2Index implements QueryIndex {
                 if (pr.firstIncluding && pr.lastIncluding
                     && pr.first != null && pr.first.equals(pr.last)) {
                     // "[property] = $value"
-                    paths = lookup.query(pr.propertyName, pr.first);
+                    paths = lookup.query(filter, pr.propertyName, pr.first);
                     break;
                 } else if (pr.first == null && pr.last == null) {
                     // "[property] is not null"
-                    paths = lookup.query(pr.propertyName, null);
+                    paths = lookup.query(filter, pr.propertyName, null);
                     break;
                 }
             }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2IndexLookup.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2IndexLookup.java
index 1c5e160b2c..52859ad2b0 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2IndexLookup.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2IndexLookup.java
@@ -30,6 +30,7 @@ import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.plugins.index.IndexConstants;
 import org.apache.jackrabbit.oak.plugins.index.p2.strategy.ContentMirrorStoreStrategy;
 import org.apache.jackrabbit.oak.plugins.index.p2.strategy.IndexStoreStrategy;
+import org.apache.jackrabbit.oak.spi.query.Filter;
 import org.apache.jackrabbit.oak.spi.state.ChildNodeEntry;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
 
@@ -91,13 +92,13 @@ public class Property2IndexLookup {
         return false;
     }
     
-    public Iterable<String> query(String name, PropertyValue value) {
+    public Iterable<String> query(Filter filter, String name, PropertyValue value) {
         NodeState state = getIndexDataNode(root, name);
         if (state == null) {
             throw new IllegalArgumentException("No index for " + name);
         }
         List<String> values = value == null ? null : Property2Index.encode(value);
-        return store.query(name, state, values);
+        return store.query(filter, name, state, values);
     }
 
     public double getCost(String name, PropertyValue value) {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/strategy/ContentMirrorStoreStrategy.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/strategy/ContentMirrorStoreStrategy.java
index 4a30e30bae..f1e0617d5c 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/strategy/ContentMirrorStoreStrategy.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/strategy/ContentMirrorStoreStrategy.java
@@ -28,6 +28,7 @@ import org.apache.jackrabbit.oak.api.PropertyState;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.plugins.memory.MemoryChildNodeEntry;
+import org.apache.jackrabbit.oak.spi.query.Filter;
 import org.apache.jackrabbit.oak.spi.state.ChildNodeEntry;
 import org.apache.jackrabbit.oak.spi.state.NodeBuilder;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
@@ -149,12 +150,12 @@ public class ContentMirrorStoreStrategy implements IndexStoreStrategy {
     }
     
     @Override
-    public Iterable<String> query(final String indexName, 
+    public Iterable<String> query(final Filter filter, final String indexName, 
             final NodeState index, final Iterable<String> values) {
         return new Iterable<String>() {
             @Override
             public Iterator<String> iterator() {
-                PathIterator it = new PathIterator(indexName);
+                PathIterator it = new PathIterator(filter, indexName);
                 if (values == null) {
                     it.setPathContainsValue(true);
                     it.enqueue(index.getChildNodeEntries().iterator());
@@ -202,6 +203,7 @@ public class ContentMirrorStoreStrategy implements IndexStoreStrategy {
      */
     static class PathIterator implements Iterator<String> {
         
+        private final Filter filter;
         private final String indexName;
         private final Deque<Iterator<? extends ChildNodeEntry>> nodeIterators =
                 Queues.newArrayDeque();
@@ -217,7 +219,8 @@ public class ContentMirrorStoreStrategy implements IndexStoreStrategy {
          */
         private final Set<String> knownPaths = Sets.newHashSet();
         
-        PathIterator(String indexName) {
+        PathIterator(Filter filter, String indexName) {
+            this.filter = filter;
             this.indexName = indexName;
             parentPath = "";
             currentPath = "/";
@@ -247,8 +250,8 @@ public class ContentMirrorStoreStrategy implements IndexStoreStrategy {
                     ChildNodeEntry entry = iterator.next();
 
                     readCount++;
-                    if (readCount % 100 == 0) {
-                        LOG.warn("Traversed " + readCount + " nodes using index " + indexName);
+                    if (readCount % 1000 == 0) {
+                        LOG.warn("Traversed " + readCount + " nodes using index " + indexName + " with filter " + filter);
                     }
 
                     NodeState node = entry.getNodeState();
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/strategy/IndexStoreStrategy.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/strategy/IndexStoreStrategy.java
index dc13063191..35d00fdfbe 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/strategy/IndexStoreStrategy.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/p2/strategy/IndexStoreStrategy.java
@@ -17,6 +17,7 @@
 package org.apache.jackrabbit.oak.plugins.index.p2.strategy;
 
 import org.apache.jackrabbit.oak.api.CommitFailedException;
+import org.apache.jackrabbit.oak.spi.query.Filter;
 import org.apache.jackrabbit.oak.spi.state.NodeBuilder;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
 
@@ -53,12 +54,13 @@ public interface IndexStoreStrategy {
     /**
      * Search for a given set of values.
      * 
+     * @param filter the filter (used for logging)
      * @param indexName the name of the index (for logging)
      * @param index index node (may not be null)
      * @param values values to look for (null to check for property existence)
      * @return an iterator of paths
      */
-    Iterable<String> query(String indexName, NodeState index, Iterable<String> values);
+    Iterable<String> query(Filter filter, String indexName, NodeState index, Iterable<String> values);
 
     /**
      * Count the occurrence of a given set of values. Used in calculating the
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/Cursors.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/Cursors.java
index f71cffdf4c..65cbb23e6d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/Cursors.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/Cursors.java
@@ -233,7 +233,7 @@ public class Cursors {
                     ChildNodeEntry entry = iterator.next();
 
                     readCount++;
-                    if (readCount % 100 == 0) {
+                    if (readCount % 1000 == 0) {
                         LOG.warn("Traversed " + readCount + " nodes with filter " + filter + "; consider creating an index or changing the query");
                     }
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/IndexHookManagerTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/IndexHookManagerTest.java
index 0b4c070033..2cce2fba49 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/IndexHookManagerTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/IndexHookManagerTest.java
@@ -100,7 +100,7 @@ public class IndexHookManagerTest {
     }
     
     private static Set<String> find(Property2IndexLookup lookup, String name, String value) {
-        return Sets.newHashSet(lookup.query(name, PropertyValues.newString(value)));
+        return Sets.newHashSet(lookup.query(null, name, PropertyValues.newString(value)));
     }
 
     /**
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2IndexTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2IndexTest.java
index 331b9a0fc1..cbb2892c1d 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2IndexTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/index/p2/Property2IndexTest.java
@@ -85,7 +85,7 @@ public class Property2IndexTest {
     }
     
     private static Set<String> find(Property2IndexLookup lookup, String name, String value) {
-        return Sets.newHashSet(lookup.query(name, value == null ? null : PropertyValues.newString(value)));
+        return Sets.newHashSet(lookup.query(null, name, value == null ? null : PropertyValues.newString(value)));
     }
 
     @Test
