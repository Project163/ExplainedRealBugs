diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/ACL.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/ACL.java
index f5886b0521..8e511e8f81 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/ACL.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/ACL.java
@@ -39,10 +39,10 @@ import org.apache.jackrabbit.api.security.principal.PrincipalManager;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
 import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.ACE;
 import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.AbstractAccessControlList;
-import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits;
-import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBitsProvider;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restriction;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionDefinition;
+import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits;
+import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBitsProvider;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -70,6 +70,8 @@ abstract class ACL extends AbstractAccessControlList {
 
     abstract PrivilegeBitsProvider getPrivilegeBitsProvider();
 
+    abstract ACE createACE(Principal principal, PrivilegeBits privilegeBits, boolean isAllow, Set<Restriction> restrictions, NamePathMapper namePathMapper) throws RepositoryException;
+
     //------------------------------------------< AbstractAccessControlList >---
     @Nonnull
     @Override
@@ -96,7 +98,10 @@ abstract class ACL extends AbstractAccessControlList {
             throw new AccessControlException("Privileges may not be null nor an empty array");
         }
         for (Privilege p : privileges) {
-            getPrivilegeManager().getPrivilege(p.getName());
+            Privilege pv = getPrivilegeManager().getPrivilege(p.getName());
+            if (pv.isAbstract()) {
+                throw new AccessControlException("Privilege " + p + " is abstract.");
+            }
         }
 
         Util.checkValidPrincipal(principal, getPrincipalManager());
@@ -119,7 +124,7 @@ abstract class ACL extends AbstractAccessControlList {
             }
         }
 
-        ACE entry = new ACE(principal, privileges, isAllow, rs, getNamePathMapper());
+        ACE entry = createACE(principal, getPrivilegeBits(privileges), isAllow, rs, getNamePathMapper());
         if (entries.contains(entry)) {
             log.debug("Entry is already contained in policy -> no modification.");
             return false;
@@ -189,8 +194,8 @@ abstract class ACL extends AbstractAccessControlList {
         }));
 
         for (ACE existing : subList) {
-            PrivilegeBits existingBits = getPrivilegeBits(existing);
-            PrivilegeBits entryBits = getPrivilegeBits(entry);
+            PrivilegeBits existingBits = PrivilegeBits.getInstance(existing.getPrivilegeBits());
+            PrivilegeBits entryBits = entry.getPrivilegeBits();
             if (entry.getRestrictions().equals(existing.getRestrictions())) {
                 if (entry.isAllow() == existing.isAllow()) {
                     if (existingBits.includes(entryBits)) {
@@ -225,23 +230,11 @@ abstract class ACL extends AbstractAccessControlList {
         return true;
     }
 
-    private ACE createACE(ACE existing, PrivilegeBits newPrivilegeBits) throws RepositoryException {
-        return new ACE(existing.getPrincipal(), getPrivileges(newPrivilegeBits), existing.isAllow(), existing.getRestrictions(), getNamePathMapper());
+    private ACE createACE(@Nonnull ACE existing, @Nonnull PrivilegeBits newPrivilegeBits) throws RepositoryException {
+        return createACE(existing.getPrincipal(), newPrivilegeBits, existing.isAllow(), existing.getRestrictions(), getNamePathMapper());
     }
 
-    private Set<Privilege> getPrivileges(PrivilegeBits bits) throws RepositoryException {
-        Set<Privilege> privileges = new HashSet<Privilege>();
-        for (String name : getPrivilegeBitsProvider().getPrivilegeNames(bits)) {
-            privileges.add(getPrivilegeManager().getPrivilege(name));
-        }
-        return privileges;
-    }
-
-    private PrivilegeBits getPrivilegeBits(ACE entry) {
-        PrivilegeBits bits = PrivilegeBits.getInstance();
-        for (Privilege privilege : entry.getPrivileges()) {
-            bits.add(getPrivilegeBitsProvider().getBits(privilege.getName()));
-        }
-        return bits;
+    private PrivilegeBits getPrivilegeBits(Privilege[] privileges) {
+        return getPrivilegeBitsProvider().getBits(privileges, getNamePathMapper());
     }
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImpl.java
index 5d033b6156..b8d8af9c1d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImpl.java
@@ -78,6 +78,7 @@ import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restrict
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionProvider;
 import org.apache.jackrabbit.oak.spi.security.principal.PrincipalConfiguration;
 import org.apache.jackrabbit.oak.spi.security.principal.PrincipalImpl;
+import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits;
 import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBitsProvider;
 import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeConfiguration;
 import org.apache.jackrabbit.oak.spi.state.PropertyBuilder;
@@ -105,6 +106,7 @@ public class AccessControlManagerImpl implements JackrabbitAccessControlManager,
     private final AuthorizationConfiguration acConfig;
 
     private final PrivilegeManager privilegeManager;
+    private final PrivilegeBitsProvider bitsProvider;
     private final PrincipalManager principalManager;
     private final RestrictionProvider restrictionProvider;
     private final ReadOnlyNodeTypeManager ntMgr;
@@ -119,6 +121,7 @@ public class AccessControlManagerImpl implements JackrabbitAccessControlManager,
         this.namePathMapper = namePathMapper;
 
         privilegeManager = getConfig(securityProvider, PrivilegeConfiguration.class).getPrivilegeManager(root, namePathMapper);
+        bitsProvider = new PrivilegeBitsProvider(root);
         principalManager = getConfig(securityProvider, PrincipalConfiguration.class).getPrincipalManager(root, namePathMapper);
 
         acConfig = getConfig(securityProvider, AuthorizationConfiguration.class);
@@ -571,7 +574,8 @@ public class AccessControlManagerImpl implements JackrabbitAccessControlManager,
                           @Nonnull RestrictionProvider restrictionProvider) throws RepositoryException {
         boolean isAllow = NT_REP_GRANT_ACE.equals(TreeUtil.getPrimaryTypeName(aceTree));
         Set<Restriction> restrictions = restrictionProvider.readRestrictions(oakPath, aceTree);
-        return new ACE(getPrincipal(aceTree), getPrivileges(aceTree), isAllow, restrictions, namePathMapper);
+        Iterable<String> privNames = checkNotNull(TreeUtil.getStrings(aceTree, REP_PRIVILEGES));
+        return new Entry(getPrincipal(aceTree), bitsProvider.getBits(privNames), isAllow, restrictions, namePathMapper);
     }
 
     @Nonnull
@@ -728,7 +732,12 @@ public class AccessControlManagerImpl implements JackrabbitAccessControlManager,
 
         @Override
         PrivilegeBitsProvider getPrivilegeBitsProvider() {
-            return new PrivilegeBitsProvider(root);
+            return bitsProvider;
+        }
+
+        @Override
+        ACE createACE(Principal principal, PrivilegeBits privilegeBits, boolean isAllow, Set<Restriction> restrictions, NamePathMapper namePathMapper) throws RepositoryException {
+            return new Entry(principal, privilegeBits, isAllow, restrictions, namePathMapper);
         }
 
         @Override
@@ -785,7 +794,12 @@ public class AccessControlManagerImpl implements JackrabbitAccessControlManager,
 
         @Override
         PrivilegeBitsProvider getPrivilegeBitsProvider() {
-            return new PrivilegeBitsProvider(root);
+            return bitsProvider;
+        }
+
+        @Override
+        ACE createACE(Principal principal, PrivilegeBits privilegeBits, boolean isAllow, Set<Restriction> restrictions, NamePathMapper namePathMapper) throws RepositoryException {
+            return new Entry(principal, privilegeBits, isAllow, restrictions, namePathMapper);
         }
 
         @Override
@@ -812,6 +826,26 @@ public class AccessControlManagerImpl implements JackrabbitAccessControlManager,
         }
     }
 
+    private final class Entry extends ACE {
+
+        private Entry(Principal principal, PrivilegeBits privilegeBits, boolean isAllow, Set<Restriction> restrictions, NamePathMapper namePathMapper) throws AccessControlException {
+            super(principal, privilegeBits, isAllow, restrictions, namePathMapper);
+        }
+
+        @Override
+        public Privilege[] getPrivileges() {
+            Set<Privilege> privileges = new HashSet<Privilege>();
+            for (String name : bitsProvider.getPrivilegeNames(getPrivilegeBits())) {
+                try {
+                    privileges.add(privilegeManager.getPrivilege(name));
+                } catch (RepositoryException e) {
+                    log.warn("Unable to get privilege with name : " + name, e);
+                }
+            }
+            return privileges.toArray(new Privilege[privileges.size()]);
+        }
+    }
+
     private static final class ReadPolicy implements NamedAccessControlPolicy {
 
         private static final NamedAccessControlPolicy INSTANCE = new ReadPolicy();
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ACE.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ACE.java
index 194e40a163..4855744db3 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ACE.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ACE.java
@@ -18,7 +18,6 @@ package org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol;
 
 import java.security.Principal;
 import java.util.Collections;
-import java.util.HashSet;
 import java.util.List;
 import java.util.Set;
 import javax.annotation.CheckForNull;
@@ -27,7 +26,6 @@ import javax.jcr.RepositoryException;
 import javax.jcr.Value;
 import javax.jcr.ValueFormatException;
 import javax.jcr.security.AccessControlException;
-import javax.jcr.security.Privilege;
 
 import com.google.common.base.Function;
 import com.google.common.base.Objects;
@@ -37,51 +35,44 @@ import org.apache.jackrabbit.api.security.JackrabbitAccessControlEntry;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
 import org.apache.jackrabbit.oak.plugins.value.ValueFactoryImpl;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restriction;
+import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits;
 
 /**
  * Default implementation of the {@code JackrabbitAccessControlEntry} interface.
  * It asserts that the basic contract is fulfilled but does perform any additional
  * validation on the principal, the privileges or the specified restrictions.
  */
-public class ACE implements JackrabbitAccessControlEntry {
+public abstract class ACE implements JackrabbitAccessControlEntry {
 
     private final Principal principal;
-    private final Set<Privilege> privileges;
+    private final PrivilegeBits privilegeBits;
     private final boolean isAllow;
     private final Set<Restriction> restrictions;
     private final NamePathMapper namePathMapper;
 
-    private Set<String> aggrPrivNames;
     private int hashCode;
 
-    public ACE(Principal principal, Privilege[] privileges,
-               boolean isAllow, Set<Restriction> restrictions,
-               NamePathMapper namePathMapper) throws AccessControlException {
-        this(principal, (privileges == null) ? null : ImmutableSet.copyOf(privileges), isAllow, restrictions, namePathMapper);
-    }
-
-    public ACE(Principal principal, Set<Privilege> privileges,
+    public ACE(Principal principal, PrivilegeBits privilegeBits,
                boolean isAllow, Set<Restriction> restrictions, NamePathMapper namePathMapper) throws AccessControlException {
-        if (principal == null || privileges == null || privileges.isEmpty()) {
+        if (principal == null || privilegeBits == null || privilegeBits.isEmpty()) {
             throw new AccessControlException();
         }
-        // make sure no abstract privileges are passed.
-        for (Privilege privilege : privileges) {
-            if (privilege == null) {
-                throw new AccessControlException("Null Privilege.");
-            }
-            if (privilege.isAbstract()) {
-                throw new AccessControlException("Privilege " + privilege + " is abstract.");
-            }
-        }
 
         this.principal = principal;
-        this.privileges = ImmutableSet.copyOf(privileges);
+        this.privilegeBits = privilegeBits;
         this.isAllow = isAllow;
         this.restrictions = (restrictions == null) ? Collections.<Restriction>emptySet() : ImmutableSet.copyOf(restrictions);
         this.namePathMapper = namePathMapper;
     }
 
+
+
+    //--------------------------------------------------------------------------
+    @Nonnull
+    public PrivilegeBits getPrivilegeBits() {
+        return privilegeBits;
+    }
+
     @Nonnull
     public Set<Restriction> getRestrictions() {
         return restrictions;
@@ -94,12 +85,6 @@ public class ACE implements JackrabbitAccessControlEntry {
         return principal;
     }
 
-    @Nonnull
-    @Override
-    public Privilege[] getPrivileges() {
-        return privileges.toArray(new Privilege[privileges.size()]);
-    }
-
     //---------------------------------------< JackrabbitAccessControlEntry >---
     @Override
     public boolean isAllow() {
@@ -158,7 +143,7 @@ public class ACE implements JackrabbitAccessControlEntry {
     @Override
     public int hashCode() {
         if (hashCode == 0) {
-            hashCode = Objects.hashCode(principal.getName(), aggrPrivNames(), isAllow, restrictions);
+            hashCode = Objects.hashCode(principal.getName(), privilegeBits, isAllow, restrictions);
         }
         return hashCode;
     }
@@ -172,7 +157,7 @@ public class ACE implements JackrabbitAccessControlEntry {
             ACE other = (ACE) obj;
             return principal.getName().equals(other.principal.getName())
                     && isAllow == other.isAllow
-                    && aggrPrivNames().equals(other.aggrPrivNames())
+                    && privilegeBits.equals(other.privilegeBits)
                     && restrictions.equals(other.restrictions);
         }
         return false;
@@ -182,29 +167,11 @@ public class ACE implements JackrabbitAccessControlEntry {
     public String toString() {
         StringBuilder sb = new StringBuilder();
         sb.append(principal.getName()).append('-').append(isAllow).append('-');
-        sb.append(privileges.toString()).append('-').append(restrictions.toString());
+        sb.append(privilegeBits.toString()).append('-').append(restrictions.toString());
         return sb.toString();
     }
 
     //------------------------------------------------------------< private >---
-    private Set<String> aggrPrivNames() {
-        if (aggrPrivNames == null) {
-            aggrPrivNames = new HashSet<String>();
-            for (Privilege priv : privileges) {
-                if (priv.isAggregate()) {
-                    for (Privilege aggr : priv.getAggregatePrivileges()) {
-                        if (!aggr.isAggregate()) {
-                            aggrPrivNames.add(aggr.getName());
-                        }
-                    }
-                } else {
-                    aggrPrivNames.add(priv.getName());
-                }
-            }
-        }
-        return aggrPrivNames;
-    }
-
     private String getJcrName(Restriction restriction) {
         return namePathMapper.getJcrName(restriction.getDefinition().getName());
     }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/privilege/PrivilegeBitsProvider.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/privilege/PrivilegeBitsProvider.java
index 7a99a55c5d..73172c9dc3 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/privilege/PrivilegeBitsProvider.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/privilege/PrivilegeBitsProvider.java
@@ -16,18 +16,25 @@
  */
 package org.apache.jackrabbit.oak.spi.security.privilege;
 
+import java.util.Arrays;
 import java.util.Collections;
 import java.util.HashMap;
 import java.util.HashSet;
 import java.util.Map;
 import java.util.Set;
 import javax.annotation.Nonnull;
+import javax.annotation.Nullable;
+import javax.jcr.RepositoryException;
+import javax.jcr.security.Privilege;
 
+import com.google.common.base.Function;
 import com.google.common.collect.ImmutableSet;
+import com.google.common.collect.Iterables;
 import org.apache.jackrabbit.oak.api.Root;
 import org.apache.jackrabbit.oak.api.Tree;
-
-import static com.google.common.base.Preconditions.checkNotNull;
+import org.apache.jackrabbit.oak.namepath.NameMapper;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 /**
  * Reads and writes privilege definitions from and to the repository content
@@ -35,6 +42,8 @@ import static com.google.common.base.Preconditions.checkNotNull;
  */
 public final class PrivilegeBitsProvider implements PrivilegeConstants {
 
+    private static final Logger log = LoggerFactory.getLogger(PrivilegeBitsProvider.class);
+
     private final Map<PrivilegeBits, Set<String>> bitsToNames = new HashMap<PrivilegeBits, Set<String>>();
 
     private final Root root;
@@ -62,20 +71,9 @@ public final class PrivilegeBitsProvider implements PrivilegeConstants {
     public PrivilegeBits getBits(@Nonnull String... privilegeNames) {
         if (privilegeNames.length == 0) {
             return PrivilegeBits.EMPTY;
+        } else {
+            return getBits(Arrays.asList(privilegeNames));
         }
-
-        Tree privilegesTree = getPrivilegesTree();
-        if (!privilegesTree.exists()) {
-            return PrivilegeBits.EMPTY;
-        }
-        PrivilegeBits bits = PrivilegeBits.getInstance();
-        for (String privilegeName : privilegeNames) {
-            Tree defTree = privilegesTree.getChild(checkNotNull(privilegeName));
-            if (defTree.exists()) {
-                bits.add(PrivilegeBits.getInstance(defTree));
-            }
-        }
-        return bits.unmodifiable();
     }
 
     /**
@@ -94,14 +92,43 @@ public final class PrivilegeBitsProvider implements PrivilegeConstants {
         }
         PrivilegeBits bits = PrivilegeBits.getInstance();
         for (String privilegeName : privilegeNames) {
-            Tree defTree = privilegesTree.getChild(checkNotNull(privilegeName));
-            if (defTree.exists()) {
-                bits.add(PrivilegeBits.getInstance(defTree));
+            if (privilegeName != null) {
+                Tree defTree = privilegesTree.getChild(privilegeName);
+                if (defTree.exists()) {
+                    bits.add(PrivilegeBits.getInstance(defTree));
+                }
+            } else {
+                log.debug("Ignoring 'null' privilege name");
             }
         }
         return bits.unmodifiable();
     }
 
+    /**
+     *
+     * @param privileges
+     * @param nameMapper
+     * @return
+     */
+    @Nonnull
+    public PrivilegeBits getBits(@Nonnull Privilege[] privileges, final @Nonnull NameMapper nameMapper) {
+        return getBits(Iterables.transform(Arrays.asList(privileges), new Function<Privilege, String>() {
+
+            @Override
+            public String apply(@Nullable Privilege privilege) {
+                if (privilege != null) {
+                    try {
+                        return nameMapper.getOakName(privilege.getName());
+                    } catch (RepositoryException e) {
+                        log.debug("Unable to resolve OAK name of privilege " + privilege, e);
+                    }
+                }
+                // null privilege or failed to resolve the privilege name
+                return null;
+            }
+        }));
+    }
+
     /**
      * Resolve the given privilege bits to a set of privilege names.
      *
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/ACLTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/ACLTest.java
index cf37f0259d..e4d0f6fb18 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/ACLTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/ACLTest.java
@@ -28,6 +28,7 @@ import java.util.Set;
 import javax.annotation.Nonnull;
 import javax.annotation.Nullable;
 import javax.jcr.PropertyType;
+import javax.jcr.RepositoryException;
 import javax.jcr.Value;
 import javax.jcr.security.AccessControlEntry;
 import javax.jcr.security.AccessControlException;
@@ -53,6 +54,7 @@ import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restrict
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionProvider;
 import org.apache.jackrabbit.oak.spi.security.principal.EveryonePrincipal;
 import org.apache.jackrabbit.oak.spi.security.principal.PrincipalImpl;
+import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits;
 import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBitsProvider;
 import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeConstants;
 import org.junit.Before;
@@ -114,7 +116,12 @@ public class ACLTest extends AbstractAccessControlListTest implements PrivilegeC
 
             @Override
             PrivilegeBitsProvider getPrivilegeBitsProvider() {
-                return new PrivilegeBitsProvider(root);
+                return getBitsProvider();
+            }
+
+            @Override
+            ACE createACE(Principal principal, PrivilegeBits privilegeBits, boolean isAllow, Set<Restriction> restrictions, NamePathMapper namePathMapper) throws RepositoryException {
+                return createEntry(principal, privilegeBits, isAllow, restrictions);
             }
         };
     }
@@ -244,7 +251,7 @@ public class ACLTest extends AbstractAccessControlListTest implements PrivilegeC
     @Test
     public void testRemoveNonExisting() throws Exception {
         try {
-            acl.removeAccessControlEntry(new ACE(testPrincipal, testPrivileges, true, null, namePathMapper));
+            acl.removeAccessControlEntry(createEntry(testPrincipal, testPrivileges, true));
             fail("Removing a non-existing ACE should fail.");
         } catch (AccessControlException e) {
             // success
@@ -309,7 +316,7 @@ public class ACLTest extends AbstractAccessControlListTest implements PrivilegeC
         acl.addAccessControlEntry(testPrincipal, read);
         acl.addAccessControlEntry(EveryonePrincipal.getInstance(), write);
 
-        AccessControlEntry invalid = new ACE(testPrincipal, write, false, Collections.<Restriction>emptySet(), namePathMapper);
+        AccessControlEntry invalid = createEntry(testPrincipal, false, null, JCR_WRITE);
         try {
             acl.orderBefore(invalid, acl.getEntries().get(0));
             fail("src entry not contained in list -> reorder should fail.");
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImplTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImplTest.java
index 4578ecbb39..b1b9355e65 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImplTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImplTest.java
@@ -62,12 +62,15 @@ import org.apache.jackrabbit.oak.namepath.NamePathMapperImpl;
 import org.apache.jackrabbit.oak.plugins.name.Namespaces;
 import org.apache.jackrabbit.oak.plugins.nodetype.NodeTypeConstants;
 import org.apache.jackrabbit.oak.plugins.value.ValueFactoryImpl;
+import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.ACE;
 import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.AbstractAccessControlTest;
 import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.AccessControlConstants;
 import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.TestACL;
+import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restriction;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionProvider;
 import org.apache.jackrabbit.oak.spi.security.principal.EveryonePrincipal;
 import org.apache.jackrabbit.oak.spi.security.principal.PrincipalImpl;
+import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits;
 import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBitsProvider;
 import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeConstants;
 import org.apache.jackrabbit.oak.util.NodeUtil;
@@ -191,6 +194,11 @@ public class AccessControlManagerImplTest extends AbstractAccessControlTest impl
                 return new PrivilegeBitsProvider(root);
             }
 
+            @Override
+            ACE createACE(Principal principal, PrivilegeBits privilegeBits, boolean isAllow, Set<Restriction> restrictions, NamePathMapper namePathMapper) throws RepositoryException {
+                throw new UnsupportedOperationException();
+            }
+
             @Nonnull
             @Override
             public RestrictionProvider getRestrictionProvider() {
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ACETest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ACETest.java
index 98da0277cb..0f7c7a2ac9 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ACETest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ACETest.java
@@ -40,6 +40,7 @@ import org.apache.jackrabbit.api.security.JackrabbitAccessControlEntry;
 import org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils;
 import org.apache.jackrabbit.oak.plugins.value.ValueFactoryImpl;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restriction;
+import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits;
 import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeConstants;
 import org.junit.Before;
 import org.junit.Test;
@@ -87,24 +88,16 @@ public class ACETest extends AbstractAccessControlTest {
 
     private ACE createEntry(String... privilegeNames)
             throws RepositoryException {
-        Privilege[] privs = AccessControlUtils.privilegesFromNames(acMgr, privilegeNames);
-        return createEntry(testPrincipal, privs, true);
+        return createEntry(testPrincipal, true, null, privilegeNames);
     }
 
     private ACE createEntry(String[] privilegeNames, boolean isAllow)
             throws RepositoryException {
-        Privilege[] privs = AccessControlUtils.privilegesFromNames(acMgr, privilegeNames);
-        return createEntry(testPrincipal, privs, isAllow);
-    }
-
-    private ACE createEntry(Principal principal, Privilege[] privileges, boolean isAllow) throws AccessControlException {
-        return new ACE(principal, privileges, isAllow, null, namePathMapper);
+        return createEntry(testPrincipal, isAllow, null, privilegeNames);
     }
 
     private ACE createEntry(Set<Restriction> restrictions) throws Exception {
-        return new ACE(testPrincipal,
-                privilegesFromNames(PrivilegeConstants.JCR_READ), true,
-                restrictions, namePathMapper);
+        return createEntry(testPrincipal, true, restrictions, PrivilegeConstants.JCR_READ);
     }
 
     private Restriction createRestriction(String name, Value value) throws Exception {
@@ -169,14 +162,38 @@ public class ACETest extends AbstractAccessControlTest {
         Privilege[] expected = AccessControlUtils.privilegesFromNames(acMgr,
                 PrivilegeConstants.JCR_ADD_CHILD_NODES,
                 PrivilegeConstants.JCR_REMOVE_CHILD_NODES);
-        assertEquals(Arrays.asList(expected), Arrays.asList(privs));
+        assertEquals(ImmutableSet.copyOf(expected), ImmutableSet.copyOf(privs));
+    }
+
+    @Test
+    public void testGetPrivilegeBits() throws RepositoryException {
+        ACE entry = createEntry(new String[]{PrivilegeConstants.JCR_READ}, true);
+
+        PrivilegeBits bits = entry.getPrivilegeBits();
+        assertNotNull(bits);
+        assertEquals(bits, getBitsProvider().getBits(PrivilegeConstants.JCR_READ));
+
+        entry = createEntry(new String[]{PrivilegeConstants.REP_WRITE}, true);
+        bits = entry.getPrivilegeBits();
+        assertNotNull(bits);
+        assertEquals(bits, getBitsProvider().getBits(PrivilegeConstants.REP_WRITE));
+
+        entry = createEntry(new String[]{PrivilegeConstants.JCR_ADD_CHILD_NODES,
+                PrivilegeConstants.JCR_REMOVE_CHILD_NODES}, true);
+        bits = entry.getPrivilegeBits();
+        assertNotNull(bits);
+
+        PrivilegeBits expected = getBitsProvider().getBits(
+                PrivilegeConstants.JCR_ADD_CHILD_NODES,
+                PrivilegeConstants.JCR_REMOVE_CHILD_NODES);
+        assertEquals(expected, bits);
     }
 
     @Test
     public void testNullPrivileges() throws Exception {
         try {
-            createEntry(testPrincipal, null, true);
-            fail("Principal must not be null");
+            ACE empty = new EmptyACE(null);
+            fail("Privileges must not be null");
         } catch (AccessControlException e) {
             // success
         }
@@ -185,8 +202,8 @@ public class ACETest extends AbstractAccessControlTest {
     @Test
     public void testEmptyPrivileges() throws Exception {
         try {
-            createEntry(testPrincipal, new Privilege[0], true);
-            fail("Privilege array must not be null.");
+            ACE empty = new EmptyACE(PrivilegeBits.EMPTY);
+            fail("Privileges must not be empty.");
         } catch (AccessControlException e) {
             // success
         }
@@ -195,9 +212,7 @@ public class ACETest extends AbstractAccessControlTest {
     @Test
     public void testRedundantPrivileges() throws Exception {
         ACE ace = createEntry(PrivilegeConstants.JCR_READ, PrivilegeConstants.JCR_READ);
-        Privilege[] privs = ace.getPrivileges();
-        assertEquals(1, privs.length);
-        assertEquals(PrivilegeConstants.JCR_READ, privs[0].getName());
+        assertEquals(getBitsProvider().getBits(PrivilegeConstants.JCR_READ), ace.getPrivilegeBits());
     }
 
     /**
@@ -227,7 +242,16 @@ public class ACETest extends AbstractAccessControlTest {
             }
         };
         Privilege[] privs = new Privilege[]{invalidPriv, acMgr.privilegeFromName(PrivilegeConstants.JCR_READ)};
-        createEntry(testPrincipal, privs, true);
+        ACE entry = createEntry(testPrincipal, privs, true);
+        assertEquals(getBitsProvider().getBits(PrivilegeConstants.JCR_READ), entry.getPrivilegeBits());
+    }
+
+    @Test
+    public void testAggregatePrivileges() throws Exception {
+        ACE ace = createEntry(PrivilegeConstants.REP_READ_NODES, PrivilegeConstants.REP_READ_PROPERTIES);
+
+        assertEquals(getBitsProvider().getBits(PrivilegeConstants.JCR_READ), ace.getPrivilegeBits());
+        assertArrayEquals(privilegesFromNames(PrivilegeConstants.JCR_READ), ace.getPrivileges());
     }
 
     @Test
@@ -564,4 +588,16 @@ public class ACETest extends AbstractAccessControlTest {
         }
 
     }
+
+    private class EmptyACE extends ACE {
+
+        public EmptyACE(PrivilegeBits privilegeBits) throws AccessControlException {
+            super(testPrincipal, privilegeBits, true, null, namePathMapper);
+        }
+
+        @Override
+        public Privilege[] getPrivileges() {
+            return new Privilege[0];
+        }
+    }
 }
\ No newline at end of file
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlListTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlListTest.java
index ceb8854c66..72b7e80d17 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlListTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlListTest.java
@@ -87,10 +87,8 @@ public abstract class AbstractAccessControlListTest extends AbstractAccessContro
     protected List<ACE> createTestEntries() throws RepositoryException {
         List<ACE> entries = new ArrayList<ACE>(3);
         for (int i = 0; i < 3; i++) {
-            entries.add(new ACE(
-                    new PrincipalImpl("testPrincipal" + i),
-                    new Privilege[]{getPrivilegeManager(root).getPrivilege(PrivilegeConstants.JCR_READ)},
-                    true, null, namePathMapper));
+            entries.add(createEntry(
+                    new PrincipalImpl("testPrincipal" + i), true, null, PrivilegeConstants.JCR_READ));
         }
         return entries;
     }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlTest.java
index 9e82e1d355..f329e4676a 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlTest.java
@@ -17,18 +17,27 @@
 package org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol;
 
 import java.security.Principal;
+import java.util.HashSet;
+import java.util.Set;
 import javax.jcr.NamespaceRegistry;
+import javax.jcr.RepositoryException;
+import javax.jcr.security.AccessControlException;
+import javax.jcr.security.Privilege;
 
 import org.apache.jackrabbit.oak.AbstractSecurityTest;
 import org.apache.jackrabbit.oak.api.Root;
 import org.apache.jackrabbit.oak.api.Tree;
 import org.apache.jackrabbit.oak.plugins.name.ReadWriteNamespaceRegistry;
 import org.apache.jackrabbit.oak.spi.security.authorization.AuthorizationConfiguration;
+import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restriction;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionProvider;
+import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits;
+import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBitsProvider;
 
 public abstract class AbstractAccessControlTest extends AbstractSecurityTest {
 
     private RestrictionProvider restrictionProvider;
+    private PrivilegeBitsProvider bitsProvider;
 
     protected void registerNamespace(String prefix, String uri) throws Exception {
         NamespaceRegistry nsRegistry = new ReadWriteNamespaceRegistry() {
@@ -52,7 +61,49 @@ public abstract class AbstractAccessControlTest extends AbstractSecurityTest {
         return restrictionProvider;
     }
 
+    protected PrivilegeBitsProvider getBitsProvider() {
+        if (bitsProvider == null) {
+            bitsProvider = new PrivilegeBitsProvider(root);
+        }
+        return bitsProvider;
+    }
+
     protected Principal getTestPrincipal() throws Exception {
         return getTestUser().getPrincipal();
     }
+
+    protected ACE createEntry(Principal principal, boolean isAllow, Set<Restriction> restrictions, String... privilegeNames) throws RepositoryException {
+        return new TestACE(principal, getBitsProvider().getBits(privilegeNames), isAllow, restrictions);
+    }
+
+    protected ACE createEntry(Principal principal, Privilege[] privileges, boolean isAllow)
+            throws RepositoryException {
+        PrivilegeBits bits = getBitsProvider().getBits(privileges, getNamePathMapper());
+        return new TestACE(principal, bits, isAllow, null);
+    }
+
+    protected ACE createEntry(Principal principal, PrivilegeBits bits, boolean isAllow, Set<Restriction> restrictions) throws AccessControlException {
+        return new TestACE(principal, bits, isAllow, restrictions);
+    }
+
+    private final class TestACE extends ACE {
+
+    private TestACE(Principal principal, PrivilegeBits privilegeBits, boolean isAllow, Set<Restriction> restrictions) throws AccessControlException {
+        super(principal, privilegeBits, isAllow, restrictions, getNamePathMapper());
+    }
+
+    @Override
+    public Privilege[] getPrivileges() {
+        Set<Privilege> privileges = new HashSet<Privilege>();
+            for (String name : bitsProvider.getPrivilegeNames(getPrivilegeBits())) {
+                try {
+                    privileges.add(getPrivilegeManager(root).getPrivilege(name));
+                } catch (RepositoryException e) {
+                    throw new RuntimeException(e);
+                }
+            }
+            return privileges.toArray(new Privilege[privileges.size()]);
+    }
+}
+
 }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ImmutableACLTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ImmutableACLTest.java
index f2e031a93e..86cff135ec 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ImmutableACLTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/ImmutableACLTest.java
@@ -29,7 +29,6 @@ import org.apache.jackrabbit.api.security.JackrabbitAccessControlEntry;
 import org.apache.jackrabbit.api.security.JackrabbitAccessControlList;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
 import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeConstants;
-import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restriction;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionProvider;
 import org.junit.Before;
 import org.junit.Test;
@@ -117,8 +116,8 @@ public class ImmutableACLTest extends AbstractAccessControlListTest {
     @Test
     public void testImmutable() throws Exception {
         List<ACE> entries = new ArrayList<ACE>();
-        entries.add(new ACE(testPrincipal, testPrivileges, true, null, namePathMapper));
-        entries.add(new ACE(testPrincipal, privilegesFromNames(PrivilegeConstants.JCR_LIFECYCLE_MANAGEMENT), false, null, namePathMapper));
+        entries.add(createEntry(testPrincipal, testPrivileges, true));
+        entries.add(createEntry(testPrincipal, privilegesFromNames(PrivilegeConstants.JCR_LIFECYCLE_MANAGEMENT), false));
 
         JackrabbitAccessControlList acl = createACL(entries);
         assertFalse(acl.isEmpty());
@@ -143,16 +142,17 @@ public class ImmutableACLTest extends AbstractAccessControlListTest {
         JackrabbitAccessControlList acl = createEmptyACL();
 
         assertEquals(acl, createEmptyACL());
-        assertFalse(acl.equals(createACL(new ACE(testPrincipal, testPrivileges, true, Collections.<Restriction>emptySet(), namePathMapper))));
+        ACE entry = createEntry(testPrincipal, testPrivileges, true);
+        assertFalse(acl.equals(createACL(entry)));
         assertFalse(acl.equals(new TestACL(getTestPath(), getRestrictionProvider(), Collections.<JackrabbitAccessControlEntry>emptyList())));
     }
 
     @Test
     public void testEquals() throws Exception {
         RestrictionProvider rp = getRestrictionProvider();
-        ACE ace1 = new ACE(testPrincipal, privilegesFromNames(PrivilegeConstants.JCR_VERSION_MANAGEMENT), false, null, namePathMapper);
-        ACE ace2 = new ACE(testPrincipal, testPrivileges, true, null, namePathMapper);
-        ACE ace2b = new ACE(testPrincipal, getAggregatedPrivileges(testPrivileges), true, null, namePathMapper);
+        ACE ace1 = createEntry(testPrincipal, false, null, PrivilegeConstants.JCR_VERSION_MANAGEMENT);
+        ACE ace2 = createEntry(testPrincipal, testPrivileges, true);
+        ACE ace2b = createEntry(testPrincipal, getAggregatedPrivileges(testPrivileges), true);
 
         JackrabbitAccessControlList acl = createACL(ace1, ace2);
         JackrabbitAccessControlList repoAcl = createACL((String) null, ace1, ace2);
@@ -175,9 +175,9 @@ public class ImmutableACLTest extends AbstractAccessControlListTest {
     @Test
     public void testHashCode() throws Exception {
         RestrictionProvider rp = getRestrictionProvider();
-        ACE ace1 = new ACE(testPrincipal, privilegesFromNames(PrivilegeConstants.JCR_VERSION_MANAGEMENT), false, null, namePathMapper);
-        ACE ace2 = new ACE(testPrincipal, testPrivileges, true, null, namePathMapper);
-        ACE ace2b = new ACE(testPrincipal, getAggregatedPrivileges(testPrivileges), true, null, namePathMapper);
+        ACE ace1 = createEntry(testPrincipal, privilegesFromNames(PrivilegeConstants.JCR_VERSION_MANAGEMENT), false);
+        ACE ace2 = createEntry(testPrincipal, testPrivileges, true);
+        ACE ace2b = createEntry(testPrincipal, getAggregatedPrivileges(testPrivileges), true);
 
         JackrabbitAccessControlList acl = createACL(ace1, ace2);
         JackrabbitAccessControlList repoAcl = createACL((String) null, ace1, ace2);
