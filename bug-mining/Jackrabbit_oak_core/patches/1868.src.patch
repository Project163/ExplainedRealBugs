diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/UnsupportedRestrictionTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/UnsupportedRestrictionTest.java
index 98a5ece8c8..955a4476f1 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/UnsupportedRestrictionTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/UnsupportedRestrictionTest.java
@@ -26,6 +26,8 @@ import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
 import org.apache.jackrabbit.oak.spi.security.authorization.AuthorizationConfiguration;
 import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.AccessControlConstants;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.AbstractRestrictionProvider;
+import org.apache.jackrabbit.oak.spi.security.authorization.restriction.AggregationAware;
+import org.apache.jackrabbit.oak.spi.security.authorization.restriction.CompositeRestrictionProvider;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restriction;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionDefinition;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionDefinitionImpl;
@@ -35,15 +37,20 @@ import org.apache.jackrabbit.oak.spi.security.principal.EveryonePrincipal;
 import org.jetbrains.annotations.NotNull;
 import org.jetbrains.annotations.Nullable;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
 
 import javax.jcr.RepositoryException;
 import javax.jcr.Value;
 import javax.jcr.ValueFactory;
 import java.security.Principal;
+import java.util.Arrays;
+import java.util.Collection;
 import java.util.Collections;
 import java.util.Map;
 import java.util.Set;
 
+import static org.apache.jackrabbit.oak.api.Type.STRINGS;
 import static org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeConstants.JCR_READ;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertSame;
@@ -52,17 +59,41 @@ import static org.junit.Assert.assertTrue;
 /**
  * Tests for OAK-9775
  */
+@RunWith(Parameterized.class)
 public class UnsupportedRestrictionTest extends AbstractAccessControlTest {
-    
-    private final TestRestrictionProvider rp = new TestRestrictionProvider();
 
+    private static final String RESTRICTION_NAME = "testRestriction";
+    private static final String RESTRICTION_NAME_2 = "mvTestRestriction";
+
+    private final boolean useCompositeRestrictionProvider;
+    private final TestRestrictionProvider testRestrictionProvider;
+    private final RestrictionProvider rp;
+    
     private JackrabbitAccessControlManager acMgr;
+
+    @Parameterized.Parameters(name = "name={1}")
+    public static Collection<Object[]> parameters() {
+        return Arrays.asList(
+                new Object[]{false, "Singular restriction provider"},
+                new Object[]{true, "Composite restriction provider"});
+    }
+
+    public UnsupportedRestrictionTest(boolean useCompositeRestrictionProvider, @NotNull String name) {
+        this.useCompositeRestrictionProvider = useCompositeRestrictionProvider;
+        this.testRestrictionProvider = new TestRestrictionProvider(new RestrictionDefinitionImpl(RESTRICTION_NAME, Type.STRING, false));
+
+        if (useCompositeRestrictionProvider) {
+            rp = CompositeRestrictionProvider.newInstance(testRestrictionProvider, new TestRestrictionProvider(new RestrictionDefinitionImpl(RESTRICTION_NAME_2, STRINGS, false)));
+        } else {
+            rp = testRestrictionProvider;
+        }
+    }
     
     @Override
     public void before() throws Exception {
         super.before();
         
-        assertSame(rp, getRestrictionProvider());
+        assertRestrictionProvider();
 
         acMgr = getAccessControlManager(root);
 
@@ -76,16 +107,24 @@ public class UnsupportedRestrictionTest extends AbstractAccessControlTest {
         acl = AccessControlUtils.getAccessControlList(acMgr, TEST_PATH);
         assertEquals(2, acl.size());
 
-        // make sure the test-restriction is no longer supported (but not removed from the repo content)
-        rp.disable();
-        assertSame(rp, getRestrictionProvider());
-        assertTrue(rp.base instanceof RestrictionProviderImpl);
+        // make sure the test-restriction is no longer supported (but restrictions not removed from the repo content)
+        testRestrictionProvider.disable();
+        assertRestrictionProvider();
+        assertTrue(testRestrictionProvider.base instanceof RestrictionProviderImpl);
     }
 
+    private void assertRestrictionProvider() {
+        if (useCompositeRestrictionProvider) {
+            assertTrue(rp instanceof CompositeRestrictionProvider);
+        } else {
+            assertSame(rp, getRestrictionProvider());
+        }
+    }
+    
     @NotNull
     private Map<String, Value> createRestrictions(@NotNull String value) {
         ValueFactory vf = getValueFactory(root);
-        return Collections.singletonMap(TestRestrictionProvider.NAME, vf.createValue(value));
+        return Collections.singletonMap(RESTRICTION_NAME, vf.createValue(value));
     }
 
     @Override
@@ -134,14 +173,12 @@ public class UnsupportedRestrictionTest extends AbstractAccessControlTest {
         assertTrue(acMgr.hasPrivileges(TEST_PATH, Collections.singleton(EveryonePrincipal.getInstance()), privilegesFromNames(JCR_READ)));
     }
     
-    private static final class TestRestrictionProvider implements RestrictionProvider {
+    private static final class TestRestrictionProvider implements RestrictionProvider, AggregationAware {
         
-        private static final String NAME = "testRestriction";
-        
-        private RestrictionProvider base;
+        private AbstractRestrictionProvider base;
 
-        public TestRestrictionProvider() {
-            base = new AbstractRestrictionProvider(Collections.singletonMap(NAME, new RestrictionDefinitionImpl(NAME, Type.STRING, false))) {
+        public TestRestrictionProvider(@NotNull RestrictionDefinition definition) {
+            base = new AbstractRestrictionProvider(Collections.singletonMap(definition.getName(), definition)) {
                 @Override
                 public @NotNull RestrictionPattern getPattern(@Nullable String oakPath, @NotNull Tree tree) {
                     return RestrictionPattern.EMPTY;
@@ -197,5 +234,10 @@ public class UnsupportedRestrictionTest extends AbstractAccessControlTest {
         public @NotNull RestrictionPattern getPattern(@Nullable String oakPath, @NotNull Set<Restriction> restrictions) {
             return base.getPattern(oakPath, restrictions);
         }
+
+        @Override
+        public void setComposite(@NotNull CompositeRestrictionProvider composite) {
+            base.setComposite(composite);
+        }
     }
 }
\ No newline at end of file
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/restriction/RestrictionProviderImplTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/restriction/RestrictionProviderImplTest.java
index 1150c889bc..92a1a92b48 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/restriction/RestrictionProviderImplTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/restriction/RestrictionProviderImplTest.java
@@ -29,18 +29,25 @@ import org.apache.jackrabbit.oak.plugins.memory.PropertyStates;
 import org.apache.jackrabbit.oak.plugins.tree.TreeUtil;
 import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.AccessControlConstants;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.CompositePattern;
+import org.apache.jackrabbit.oak.spi.security.authorization.restriction.CompositeRestrictionProvider;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restriction;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionDefinition;
+import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionDefinitionImpl;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionImpl;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionPattern;
+import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionProvider;
 import org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeConstants;
 import org.junit.Before;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
 
 import javax.jcr.Value;
 import javax.jcr.ValueFactory;
 import javax.jcr.security.AccessControlException;
 import javax.jcr.security.AccessControlManager;
+import java.util.Arrays;
+import java.util.Collection;
 import java.util.Collections;
 import java.util.List;
 import java.util.Map;
@@ -58,15 +65,35 @@ import static org.mockito.Mockito.mock;
 /**
  * Tests for {@link RestrictionProviderImpl}
  */
+@RunWith(Parameterized.class)
 public class RestrictionProviderImplTest extends AbstractSecurityTest implements AccessControlConstants {
 
-    private RestrictionProviderImpl provider;
+    private static final String TEST_RESTR_NAME = "test";
+    
+    private final boolean asComposite;
+    private RestrictionProvider provider;
+
+    @Parameterized.Parameters(name = "name={1}")
+    public static Collection<Object[]> parameters() {
+        return Arrays.asList(
+                new Object[]{false, "RestrictionProviderImpl as singular provider"},
+                new Object[]{true, "RestrictionProviderImpl as part of a composite restriction provider"});
+    }
+    
+    public RestrictionProviderImplTest(boolean asComposite, String name) {
+        this.asComposite = asComposite;
+    }
 
     @Before
     public void before() throws Exception {
         super.before();
 
-        provider = new RestrictionProviderImpl();
+        RestrictionProviderImpl rp = new RestrictionProviderImpl();
+        if (asComposite) {
+            provider = CompositeRestrictionProvider.newInstance(rp, new TestProvider(Collections.singletonMap(TEST_RESTR_NAME, new RestrictionDefinitionImpl("test", Type.STRING, false))));
+        } else {
+            provider = rp;
+        }
     }
 
     @Test
@@ -75,7 +102,8 @@ public class RestrictionProviderImplTest extends AbstractSecurityTest implements
 
         Set<RestrictionDefinition> defs = provider.getSupportedRestrictions("/testPath");
         assertNotNull(defs);
-        assertEquals(7, defs.size());
+        int expectedSize = (asComposite) ? 8 : 7;
+        assertEquals(expectedSize, defs.size());
 
         Set<String> stringsPropNames = ImmutableSet.of(REP_PREFIXES, REP_CURRENT, REP_GLOBS, REP_SUBTREES);
         for (RestrictionDefinition def : defs) {
@@ -92,7 +120,11 @@ public class RestrictionProviderImplTest extends AbstractSecurityTest implements
                 assertEquals(Type.STRINGS, def.getRequiredType());
                 assertFalse(def.isMandatory());
             } else {
-                fail("unexpected restriction " + def.getName());
+                if (asComposite) {
+                    assertEquals(TEST_RESTR_NAME, def.getName());
+                } else {
+                    fail("unexpected restriction " + def.getName());
+                }
             }
         }
     }
