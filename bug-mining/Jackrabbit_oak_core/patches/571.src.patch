diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/identifier/IdentifierManager.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/identifier/IdentifierManager.java
index 820815949b..506204bf1e 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/identifier/IdentifierManager.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/identifier/IdentifierManager.java
@@ -218,7 +218,10 @@ public class IdentifierManager {
             Result result = root.getQueryEngine().executeQuery(
                     "SELECT * FROM [nt:base] WHERE PROPERTY([" + pName + "], '" + reference + "') = $uuid",
                     Query.JCR_SQL2, Long.MAX_VALUE, 0, bindings, new NamePathMapper.Default());
-            return findPaths(result, uuid, propertyName, nodeTypeNames, weak ? Type.WEAKREFERENCE : Type.REFERENCE);
+            return findPaths(result, uuid, propertyName, nodeTypeNames,
+                    weak ? Type.WEAKREFERENCE : Type.REFERENCE,
+                    weak ? Type.WEAKREFERENCES : Type.REFERENCES
+                    );
         } catch (ParseException e) {
             log.error("query failed", e);
             return Collections.emptySet();
@@ -226,7 +229,7 @@ public class IdentifierManager {
     }
 
     private Iterable<String> findPaths(final Result result, final String uuid, final String propertyName,
-            final String[] nodeTypeNames, final Type<?> propertyType) {
+            final String[] nodeTypeNames, final Type<?> type, final Type<?> types) {
         return new Iterable<String>() {
             @Override
             public Iterator<String> iterator() {
@@ -242,15 +245,19 @@ public class IdentifierManager {
                     class PropertyToPath implements Function<PropertyState, String> {
                         @Override
                         public String apply(PropertyState pState) {
-                            if (pState.getType() == propertyType) {
-                                if (pState.isArray()) {
+                            if (pState.isArray()) {
+                                if (pState.getType() == types) {
                                     for (String value : pState.getValue(Type.STRINGS)) {
                                         if (uuid.equals(value)) {
                                             return PathUtils.concat(rowPath, pState.getName());
                                         }
                                     }
-                                } else if (uuid.equals(pState.getValue(Type.STRING))) {
-                                    return PathUtils.concat(rowPath, pState.getName());
+                                }
+                            } else {
+                                if (pState.getType() == type) {
+                                    if (uuid.equals(pState.getValue(Type.STRING))) {
+                                        return PathUtils.concat(rowPath, pState.getName());
+                                    }
                                 }
                             }
                             return null;
