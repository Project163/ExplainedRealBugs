diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/NodeCollectionProvider.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/NodeCollectionProvider.java
index b4b0f5b600..314cb09b81 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/NodeCollectionProvider.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/NodeCollectionProvider.java
@@ -16,6 +16,7 @@
  */
 package org.apache.jackrabbit.oak.plugins.document.mongo.replica;
 
+import static com.google.common.collect.ImmutableSet.copyOf;
 import static com.google.common.collect.Sets.difference;
 
 import java.net.UnknownHostException;
@@ -59,7 +60,7 @@ public class NodeCollectionProvider {
     }
 
     public void retain(Set<String> hostNames) {
-        close(difference(collections.keySet(), hostNames));
+        close(copyOf(difference(collections.keySet(), hostNames)));
     }
 
     public void close() {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/ReplicaSetInfo.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/ReplicaSetInfo.java
index abeba8a3a9..2a7e6c53e1 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/ReplicaSetInfo.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/ReplicaSetInfo.java
@@ -261,8 +261,9 @@ public class ReplicaSetInfo implements Runnable {
         }
 
         Map<String, Timestamped<RevisionVector>> vectors = null;
+        Set<String> hostsToCheck = union(secondaries, of(primary));
         if (!unknownState) {
-            vectors = getRootRevisions(union(secondaries, of(primary)));
+            vectors = getRootRevisions(hostsToCheck);
             if (vectors.containsValue(null)) {
                 unknownState = true;
             }
@@ -284,7 +285,7 @@ public class ReplicaSetInfo implements Runnable {
         }
 
         LOG.debug("Minimum root revisions: {}. Current lag: {}", rootRevisions, getLag());
-        nodeCollections.retain(secondaries);
+        nodeCollections.retain(hostsToCheck);
     }
 
     /**
