diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/counter/jmx/NodeCounter.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/counter/jmx/NodeCounter.java
index c840e8f1e2..10954f0b6b 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/counter/jmx/NodeCounter.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/counter/jmx/NodeCounter.java
@@ -102,12 +102,12 @@ public class NodeCounter implements NodeCounterMBean {
         // check in the counter index (if it exists)
         s = child(root,
                 IndexConstants.INDEX_DEFINITIONS_NAME,
-                "counter",
-                NodeCounterEditor.DATA_NODE_NAME);
-        if (s == null) {
+                "counter");
+        if (s == null || !s.exists()) {
             // no index
             return -1;
         }
+        s = child(s, NodeCounterEditor.DATA_NODE_NAME);
         s = child(s, PathUtils.elements(path));
         if (s == null || !s.exists()) {
             // we have an index, but no data
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
index 3365c7931d..9d22621755 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
@@ -99,6 +99,13 @@ public interface Query {
      */
     String getPlan();
 
+    /**
+     * Get the index cost. The query must already be prepared.
+     * 
+     * @return the index cost
+     */
+    String getIndexCost();
+
     /**
      * Get the estimated cost.
      * 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
index 8d47b8ab5b..61b70da773 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryImpl.java
@@ -466,6 +466,9 @@ public class QueryImpl implements Query {
         prepare();
         if (explain) {
             String plan = getPlan();
+            if (measure) {
+                plan += " cost: { " + getIndexCost() + " }";
+            }
             columns = new ColumnImpl[] { new ColumnImpl("explain", "plan", "plan")};
             ResultRowImpl r = new ResultRowImpl(this,
                     Tree.EMPTY_ARRAY,
@@ -572,6 +575,11 @@ public class QueryImpl implements Query {
         return source.getPlan(context.getBaseState());
     }
     
+    @Override
+    public String getIndexCost() {
+        return source.getIndexCost(context.getBaseState());
+    }
+
     @Override
     public double getEstimatedCost() {
         return estimatedCost;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
index 6f3191a01d..4b6fa43e8a 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
@@ -140,7 +140,8 @@ public class SQL2Parser {
         boolean explain = false, measure = false;
         if (readIf("EXPLAIN")) {
             explain = true;
-        } else if (readIf("MEASURE")) {
+        }
+        if (readIf("MEASURE")) {
             measure = true;
         }
         Query q = parseSelect();
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/UnionQueryImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/UnionQueryImpl.java
index 8884e96d35..c7e5b57030 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/UnionQueryImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/UnionQueryImpl.java
@@ -235,6 +235,17 @@ public class UnionQueryImpl implements Query {
         return buff.toString();
     }
     
+    @Override
+    public String getIndexCost() {
+        StringBuilder buff = new StringBuilder();
+        buff.append("{ ");
+        buff.append(left.getIndexCost());
+        buff.append(", ");
+        buff.append(right.getIndexCost());
+        buff.append(" }");
+        return buff.toString();
+    }
+
     @Override
     public Tree getTree(String path) {
         return left.getTree(path);
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElement.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElement.java
index 6e6d81e4f3..109d7d51d6 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElement.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElement.java
@@ -46,6 +46,10 @@ abstract class AstElement {
         return '[' + pathOrName + ']';
     }
 
+    protected String quoteJson(String string) {
+        return '"' + string.replaceAll("\"", "\"\"") + '"';
+    }
+
     public void setQuery(QueryImpl query) {
         this.query = query;
     }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinImpl.java
index c905ab9c5e..d9338bb333 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/JoinImpl.java
@@ -109,6 +109,18 @@ public class JoinImpl extends SourceImpl {
         return buff.toString();
     }
 
+    @Override
+    public String getIndexCost(NodeState rootState) {
+        StringBuilder buff = new StringBuilder();
+        buff.append(toString());
+        buff.append("{ ");
+        buff.append(left.getIndexCost(rootState));
+        buff.append(", ");
+        buff.append(right.getIndexCost(rootState));
+        buff.append(" }");
+        return buff.toString();
+    }
+
     @Override
     public String toString() {
         return left + " " + joinType +
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
index 65179e80b6..e38069398f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
@@ -352,6 +352,25 @@ public class SelectorImpl extends SourceImpl {
         return buff.toString();
     }
 
+    @Override
+    public String getIndexCost(NodeState rootState) {
+        StringBuilder buff = new StringBuilder();
+        buff.append(quoteJson(selectorName)).append(": ");
+        QueryIndex index = getIndex();
+        if (index != null) {
+            if (index instanceof AdvancedQueryIndex) {
+                IndexPlan p = plan.getIndexPlan();
+                buff.append("{ perEntry: ").append(p.getCostPerEntry());
+                buff.append(", perExecution: ").append(p.getCostPerExecution());
+                buff.append(", count: ").append(p.getEstimatedEntryCount());
+                buff.append(" }");
+            } else {
+                buff.append(index.getCost(createFilter(true), rootState));
+            }
+        }
+        return buff.toString();
+    }
+
     /**
      * Create the filter condition for planning or execution.
      * 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SourceImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SourceImpl.java
index 56d23ea89c..40c8741113 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SourceImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SourceImpl.java
@@ -85,6 +85,14 @@ public abstract class SourceImpl extends AstElement {
      */
     public abstract String getPlan(NodeState rootState);
 
+    /**
+     * Get the index cost as a JSON string.
+     *
+     * @param rootState the root
+     * @return the cost
+     */
+    public abstract String getIndexCost(NodeState rootState);
+
     /**
      * Prepare executing the query (recursively). This will 'wire' the
      * selectors with the join constraints, and decide which index to use.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/package-info.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/package-info.java
index e4806c39fa..5354d4790b 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/package-info.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/package-info.java
@@ -14,7 +14,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-@Version("2.2")
+@Version("2.3")
 @Export(optional = "provide:=true")
 package org.apache.jackrabbit.oak.query;
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/Statement.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/Statement.java
index 85f306f59b..81db2ed515 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/Statement.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/xpath/Statement.java
@@ -118,7 +118,8 @@ public class Statement {
         // explain | measure ...
         if (explain) {
             buff.append("explain ");
-        } else if (measure) {
+        } 
+        if (measure) {
             buff.append("measure ");
         }
         
@@ -250,9 +251,10 @@ public class Statement {
         public String toString() {
             StringBuilder buff = new StringBuilder();
             // explain | measure ...
-            if (this.explain) {
+            if (explain) {
                 buff.append("explain ");
-            } else if (measure) {
+            } 
+            if (measure) {
                 buff.append("measure ");
             }
             buff.append(s1).append(" union ").append(s2);
