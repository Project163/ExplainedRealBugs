diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/MarkSweepGarbageCollector.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/MarkSweepGarbageCollector.java
index 38d30f9a76..ad389893e9 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/MarkSweepGarbageCollector.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/MarkSweepGarbageCollector.java
@@ -57,6 +57,7 @@ import org.apache.commons.io.LineIterator;
 import org.apache.jackrabbit.core.data.DataRecord;
 import org.apache.jackrabbit.core.data.DataStoreException;
 import org.apache.jackrabbit.oak.commons.IOUtils;
+import org.apache.jackrabbit.oak.commons.sort.ExternalSort;
 import org.apache.jackrabbit.oak.plugins.blob.datastore.SharedDataStoreUtils;
 import org.apache.jackrabbit.oak.plugins.blob.datastore.SharedDataStoreUtils.SharedStoreRecordType;
 import org.apache.jackrabbit.oak.spi.blob.GarbageCollectableBlobStore;
@@ -453,8 +454,10 @@ public class MarkSweepGarbageCollector implements BlobGarbageCollector {
      * Save batch to file.
      */
     static void saveBatchToFile(List<String> ids, BufferedWriter writer) throws IOException {
-        writer.append(Joiner.on(NEWLINE).join(ids));
-        writer.append(NEWLINE);
+        for (String id : ids) {
+            ExternalSort.writeLine(writer, id);
+            writer.append(NEWLINE);
+        }
         ids.clear();
         writer.flush();
     }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/MongoBlobGCTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/MongoBlobGCTest.java
index 55c27c65c7..936b956329 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/MongoBlobGCTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/MongoBlobGCTest.java
@@ -147,6 +147,24 @@ public class MongoBlobGCTest extends AbstractMongoConnectionTest {
         return set;
     }
 
+    private HashSet<String> addNodeSpecialChars() throws Exception {
+        HashSet<String> set = new HashSet<String>();
+        DocumentNodeStore s = mk.getNodeStore();
+        NodeBuilder a = s.getRoot().builder();
+        int number = 1;
+        for (int i = 0; i < number; i++) {
+            Blob b = s.createBlob(randomStream(i, 18432));
+            NodeBuilder n = a.child("cspecial");
+            n.child("q\\%22afdg\\%22").setProperty("x", b);
+            Iterator<String> idIter =
+                ((GarbageCollectableBlobStore) s.getBlobStore())
+                    .resolveChunks(b.toString());
+            set.addAll(Lists.newArrayList(idIter));
+        }
+        s.merge(a, EmptyHook.INSTANCE, CommitInfo.EMPTY);
+        return set;
+    }
+
     private void deleteFromMongo(String nodeId) {
         DBCollection coll = mongoConnection.getDB().getCollection("nodes");
         BasicDBObject blobNodeObj = new BasicDBObject();
@@ -160,6 +178,17 @@ public class MongoBlobGCTest extends AbstractMongoConnectionTest {
         Set<String> existingAfterGC = gc(0);
         assertTrue(Sets.symmetricDifference(state.blobsPresent, existingAfterGC).isEmpty());
     }
+
+    @Test
+    public void gcSpecialChar() throws Exception {
+        DataStoreState state = setUp(true);
+        Set<String> specialCharNodeBlobs = addNodeSpecialChars();
+        state.blobsAdded.addAll(specialCharNodeBlobs);
+        state.blobsPresent.addAll(specialCharNodeBlobs);
+        Set<String> existingAfterGC = gc(0);
+        assertTrue(Sets.symmetricDifference(state.blobsPresent, existingAfterGC).isEmpty());
+    }
+
     
     @Test
     public void noGc() throws Exception {
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/SharedBlobStoreGCTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/SharedBlobStoreGCTest.java
index e5b8b79b4b..acedd45d91 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/SharedBlobStoreGCTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/SharedBlobStoreGCTest.java
@@ -134,6 +134,22 @@ public class SharedBlobStoreGCTest {
             cluster1.getExistingBlobIds()).isEmpty());
     }
 
+    @Test
+    public void testGCWithNodeSpecialChars() throws Exception {
+        log.debug("Running testGC()");
+        // Only run the mark phase on both the clusters
+        cluster1.initBlobs.addAll(cluster1.addNodeSpecialChars());
+        cluster2.initBlobs.addAll(cluster1.addNodeSpecialChars());
+        cluster1.gc.collectGarbage(true);
+        cluster2.gc.collectGarbage(true);
+
+        // Execute the gc with sweep
+        cluster1.gc.collectGarbage(false);
+
+        Assert.assertEquals(true, Sets.symmetricDifference(Sets.union(cluster1.getInitBlobs(), cluster2.getInitBlobs()),
+            cluster1.getExistingBlobIds()).isEmpty());
+    }
+
     @Test
     public void testGCStats() throws Exception {
         log.debug("Running testGCStats()");
@@ -284,6 +300,24 @@ public class SharedBlobStoreGCTest {
             }
         }
 
+        private HashSet<String> addNodeSpecialChars() throws Exception {
+            HashSet<String> set = new HashSet<String>();
+            NodeBuilder a = ds.getRoot().builder();
+            int number = 1;
+            for (int i = 0; i < number; i++) {
+                Blob b = ds.createBlob(randomStream(i, 18432));
+                NodeBuilder n = a.child("cspecial");
+                n.child("q\\%22afdg\\%22").setProperty("x", b);
+                Iterator<String> idIter =
+                    ((GarbageCollectableBlobStore) ds.getBlobStore())
+                        .resolveChunks(b.toString());
+                set.addAll(Lists.newArrayList(idIter));
+            }
+            ds.merge(a, EmptyHook.INSTANCE, CommitInfo.EMPTY);
+            return set;
+        }
+
+
         public Set<String> getExistingBlobIds() throws Exception {
             GarbageCollectableBlobStore store = (GarbageCollectableBlobStore) ds.getBlobStore();
             Iterator<String> cur = store.getAllChunkIds(0);
