diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CacheConsistencyTestBase.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CacheConsistencyTestBase.java
index f79771421b..ec750e6cfe 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CacheConsistencyTestBase.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/CacheConsistencyTestBase.java
@@ -53,10 +53,12 @@ public abstract class CacheConsistencyTestBase {
 
     @After
     public void after() throws Exception {
-        for (String id : removeMe) {
-            ds.remove(Collection.NODES, id);
+        if (ds != null) {
+            for (String id : removeMe) {
+                ds.remove(Collection.NODES, id);
+            }
+            ds.dispose();
         }
-        ds.dispose();
         fixture.dispose();
     }
 
