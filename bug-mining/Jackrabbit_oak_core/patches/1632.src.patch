diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/BlobIdTracker.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/BlobIdTracker.java
index 985a8c94c4..d10a74f44f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/BlobIdTracker.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/BlobIdTracker.java
@@ -312,10 +312,14 @@ public class BlobIdTracker implements Closeable, BlobTracker {
         /* Lock for operations on references file */
         private final ReentrantLock refLock;
 
+        /* Lock for snapshot */
+        private final ReentrantLock snapshotLock;
+
         BlobIdStore(File rootDir, String prefix) throws IOException {
             this.rootDir = rootDir;
             this.prefix = prefix;
             this.refLock = new ReentrantLock();
+            this.snapshotLock = new ReentrantLock();
 
             // Retrieve the process file if it exists
             processFile =
@@ -443,6 +447,9 @@ public class BlobIdTracker implements Closeable, BlobTracker {
          * @throws IOException
          */
         protected void removeRecords(File recs) throws IOException {
+            // do a snapshot
+            snapshot();
+
             refLock.lock();
             try {
                 sort(getBlobRecordsFile());
@@ -520,8 +527,13 @@ public class BlobIdTracker implements Closeable, BlobTracker {
          * @throws IOException
          */
         protected void snapshot() throws IOException {
-            nextGeneration();
-            merge(generations, false);
+            snapshotLock.lock();
+            try {
+                nextGeneration();
+                merge(generations, false);
+            } finally {
+                snapshotLock.unlock();
+            }
         }
 
         @Override
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreTrackerGCTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreTrackerGCTest.java
index 41ead18b61..1e0aab6ef9 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreTrackerGCTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreTrackerGCTest.java
@@ -143,6 +143,13 @@ public class DataStoreTrackerGCTest {
         assertEquals(state.blobsPresent, existingAfterGC);
         // Tracked blobs should reflect deletions after gc
         assertEquals(state.blobsPresent, retrieveTracked(tracker));
+
+        // Create a snapshot
+        ScheduledFuture<?> scheduledFuture = newSingleThreadScheduledExecutor()
+            .schedule(tracker.new SnapshotJob(), 0, MILLISECONDS);
+        scheduledFuture.get();
+        // Tracked blobs should reflect deletions after gc and the deleted should not get resurrected
+        assertEquals(state.blobsPresent, retrieveTracked(tracker));
     }
 
     private HashSet<String> addNodeSpecialChars(DocumentNodeStore ds) throws Exception {
@@ -206,6 +213,13 @@ public class DataStoreTrackerGCTest {
         assertEquals(state.blobsPresent, existingAfterGC);
         // Tracked blobs should reflect deletions after gc and also the additions after
         assertEquals(state.blobsPresent, retrieveTracked(tracker));
+
+        // Create a snapshot
+        scheduledFuture = newSingleThreadScheduledExecutor()
+            .schedule(tracker.new SnapshotJob(), 0, MILLISECONDS);
+        scheduledFuture.get();
+        // Tracked blobs should reflect deletions after gc and the deleted should not get resurrected
+        assertEquals(state.blobsPresent, retrieveTracked(tracker));
     }
 
     @Test
