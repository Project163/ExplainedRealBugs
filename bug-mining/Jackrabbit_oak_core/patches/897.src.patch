diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentWriter.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentWriter.java
index 0552b3342b..16c3f83777 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentWriter.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/segment/SegmentWriter.java
@@ -219,7 +219,7 @@ public class SegmentWriter {
                 data.put(buffer, buffer.length - length, length);
                 data.rewind();
             } else {
-                data = ByteBuffer.wrap(buffer);
+                data = ByteBuffer.wrap(buffer, buffer.length - length, length);
             }
             tracker.setSegment(id, new Segment(tracker, id, data));
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/ExternalBlobTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/ExternalBlobTest.java
index 715f0a7272..00d2321903 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/ExternalBlobTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/ExternalBlobTest.java
@@ -82,7 +82,6 @@ public class ExternalBlobTest {
         is.close();
     }
 
-    @Ignore("OAK-1817")
     @Test
     public void testNullBlobId() throws Exception{
         FileDataStore fds = createFileDataStore();
