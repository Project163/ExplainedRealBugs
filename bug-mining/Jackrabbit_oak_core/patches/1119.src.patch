diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/privilege/JcrAllCommitHook.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/privilege/JcrAllCommitHook.java
index 18b75f6f24..734b6fb531 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/privilege/JcrAllCommitHook.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/privilege/JcrAllCommitHook.java
@@ -31,6 +31,8 @@ import org.apache.jackrabbit.oak.spi.state.NodeState;
 import org.apache.jackrabbit.oak.plugins.memory.PropertyBuilder;
 import org.apache.jackrabbit.util.Text;
 
+import static org.apache.jackrabbit.oak.plugins.memory.EmptyNodeState.EMPTY_NODE;
+
 /**
  * JcrAllCommitHook is responsible for updating the jcr:all privilege definition
  * upon successful registration of a new privilege.
@@ -61,28 +63,35 @@ class JcrAllCommitHook implements PostValidationHook, PrivilegeConstants {
 
         @Override
         public boolean childNodeAdded(String name, NodeState after) {
-            if (PRIVILEGES_PATH.equals(path) && !JCR_ALL.equals(name)) {
-                // a new privilege was registered -> update the jcr:all privilege
-                NodeBuilder jcrAll = nodeBuilder.child(JCR_ALL);
-                PropertyState aggregates = jcrAll.getProperty(REP_AGGREGATES);
+            if (PRIVILEGES_PATH.equals(path)) {
+                if (!JCR_ALL.equals(name)) {
+                    // a new privilege was registered -> update the jcr:all privilege
+                    NodeBuilder jcrAll = nodeBuilder.child(JCR_ALL);
+                    PropertyState aggregates = jcrAll.getProperty(REP_AGGREGATES);
 
-                PropertyBuilder<String> propertyBuilder;
-                if (aggregates == null) {
-                    propertyBuilder = PropertyBuilder.array(Type.NAME, REP_AGGREGATES);
-                } else {
-                    propertyBuilder = PropertyBuilder.copy(Type.NAME, aggregates);
-                }
-                if (!propertyBuilder.hasValue(name)) {
-                    propertyBuilder.addValue(name);
-                    jcrAll.setProperty(propertyBuilder.getPropertyState());
-                }
+                    PropertyBuilder<String> propertyBuilder;
+                    if (aggregates == null) {
+                        propertyBuilder = PropertyBuilder.array(Type.NAME, REP_AGGREGATES);
+                    } else {
+                        propertyBuilder = PropertyBuilder.copy(Type.NAME, aggregates);
+                    }
+                    if (!propertyBuilder.hasValue(name)) {
+                        propertyBuilder.addValue(name);
+                        jcrAll.setProperty(propertyBuilder.getPropertyState());
+                    }
 
-                // update the privilege bits of the jcr:all in case the new
-                // privilege isn't an aggregate
-                if (!after.hasProperty(REP_AGGREGATES)) {
-                    PrivilegeBits bits = PrivilegeBits.getInstance(after.getProperty(REP_BITS));
-                    PrivilegeBits all = PrivilegeBits.getInstance(jcrAll.getProperty(REP_BITS));
-                    jcrAll.setProperty(PrivilegeBits.getInstance(all).add(bits).asPropertyState(REP_BITS));
+                    // update the privilege bits of the jcr:all in case the new
+                    // privilege isn't an aggregate
+                    if (!after.hasProperty(REP_AGGREGATES)) {
+                        PrivilegeBits bits = PrivilegeBits.getInstance(after.getProperty(REP_BITS));
+                        PrivilegeBits all = PrivilegeBits.getInstance(jcrAll.getProperty(REP_BITS));
+                        jcrAll.setProperty(PrivilegeBits.getInstance(all).add(bits).asPropertyState(REP_BITS));
+                    }
+                } // else: jcr:all privilege has been added -> ignore
+            } else {
+                String p = path  + '/' + name;
+                if (Text.isDescendantOrEqual(p, PRIVILEGES_PATH)) {
+                    after.compareAgainstBaseState(EMPTY_NODE, new PrivilegeDiff(this, name, nodeBuilder.child(name)));
                 }
             }
             return true;
