diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java
index f3e405d48c..b0552783dc 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java
@@ -172,6 +172,7 @@ public class DataStoreBlobStore implements DataStore, BlobStore, GarbageCollecta
 
     @Override
     public String getBlobId(String reference) {
+        checkNotNull(reference);
         DataRecord record;
         try {
             record = delegate.getRecordFromReference(reference);
@@ -186,6 +187,12 @@ public class DataStoreBlobStore implements DataStore, BlobStore, GarbageCollecta
 
     @Override
     public String getReference(String blobId) {
+        checkNotNull(blobId);
+        //Reference are not created for in memory record
+        if(InMemoryDataRecord.isInstance(blobId)){
+            return null;
+        }
+
         DataRecord record;
         try {
             record = delegate.getRecord(new DataIdentifier(blobId));
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/OakFileDataStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/OakFileDataStore.java
index 6082ac4dc7..78d9433462 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/OakFileDataStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/OakFileDataStore.java
@@ -19,6 +19,7 @@
 
 package org.apache.jackrabbit.oak.plugins.blob.datastore;
 
+import com.google.common.base.Charsets;
 import com.google.common.io.BaseEncoding;
 import org.apache.jackrabbit.core.data.DataStoreException;
 import org.apache.jackrabbit.core.data.FileDataStore;
@@ -28,12 +29,12 @@ import org.apache.jackrabbit.core.data.FileDataStore;
  *  provisioning the signing key via OSGi config
  */
 public class OakFileDataStore extends FileDataStore {
-    private byte[] signingKey;
+    private byte[] referenceKey;
 
     @Override
     protected byte[] getOrCreateReferenceKey() throws DataStoreException {
-        if(signingKey != null){
-            return signingKey;
+        if(referenceKey != null){
+            return referenceKey;
         }
         return super.getOrCreateReferenceKey();
     }
@@ -41,7 +42,27 @@ public class OakFileDataStore extends FileDataStore {
     /**
      * Set Base64 encoded signing key
      */
-    public void setSigningKey(String encodedKey) {
-        this.signingKey = BaseEncoding.base64().decode(encodedKey);
+    public void setReferenceKeyEncoded(String encodedKey) {
+        this.referenceKey = BaseEncoding.base64().decode(encodedKey);
+    }
+
+    /**
+     * Set the referenceKey from plain text. Key content would be
+     * UTF-8 encoding of the string.
+     *
+     * <p>This is useful when setting key via generic
+     *  bean property manipulation from string properties. User can specify the
+     *  key in plain text and that would be passed on this object via
+     *  {@link org.apache.jackrabbit.oak.commons.PropertiesUtil#populate(Object, java.util.Map, boolean)}
+     *
+     * @param textKey base64 encoded key
+     * @see org.apache.jackrabbit.oak.commons.PropertiesUtil#populate(Object, java.util.Map, boolean)
+     */
+    public void setReferenceKeyPlainText(String textKey) {
+        this.referenceKey = textKey.getBytes(Charsets.UTF_8);
+    }
+
+    public void setReferenceKey(byte[] referenceKey) {
+        this.referenceKey = referenceKey;
     }
 }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStoreTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStoreTest.java
index f34ac88c05..8cc8165792 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStoreTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStoreTest.java
@@ -34,6 +34,7 @@ import org.junit.Test;
 
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertTrue;
 import static org.mockito.Matchers.any;
 import static org.mockito.Mockito.mock;
@@ -75,7 +76,7 @@ public class DataStoreBlobStoreTest {
         new Random().nextBytes(data);
 
         DataIdentifier testDI = new DataIdentifier("test");
-        DataRecord testDR = new ByteArrayDataRecord(data, testDI);
+        DataRecord testDR = new ByteArrayDataRecord(data, testDI, "testReference");
 
         DataStore mockedDS = mock(DataStore.class);
         when(mockedDS.getMinRecordLength()).thenReturn(maxInlineSize);
@@ -99,13 +100,37 @@ public class DataStoreBlobStoreTest {
         assertEquals(testDI.toString(), ds.writeBlob(new ByteArrayInputStream(data)));
     }
 
+    @Test
+    public void testReference() throws DataStoreException, IOException {
+        String reference = "testReference";
+        String blobId = "test";
+        DataIdentifier testDI = new DataIdentifier(blobId);
+        DataRecord testDR = new ByteArrayDataRecord("foo".getBytes(), testDI, reference);
+
+        DataStore mockedDS = mock(DataStore.class);
+        when(mockedDS.getRecordFromReference(reference)).thenReturn(testDR);
+        when(mockedDS.getRecord(testDI)).thenReturn(testDR);
+        DataStoreBlobStore ds = new DataStoreBlobStore(mockedDS);
+
+        assertEquals(reference,ds.getReference(blobId));
+        assertEquals(blobId, ds.getBlobId(reference));
+
+        String inMemBlobId = InMemoryDataRecord.getInstance("foo".getBytes())
+                .getIdentifier().toString();
+
+        //For in memory record the reference should be null
+        assertNull(ds.getReference(inMemBlobId));
+    }
+
     private static class ByteArrayDataRecord implements DataRecord {
         private final byte[] data;
         private final DataIdentifier identifier;
+        private final String reference;
 
-        private ByteArrayDataRecord(byte[] data, DataIdentifier di) {
+        private ByteArrayDataRecord(byte[] data, DataIdentifier di, String reference) {
             this.data = data;
             this.identifier = di;
+            this.reference = reference;
         }
 
         @Override
@@ -115,7 +140,7 @@ public class DataStoreBlobStoreTest {
 
         @Override
         public String getReference() {
-            return null;
+            return reference;
         }
 
         @Override
