diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStoreTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStoreTest.java
index 1ff080ce7d..2908dc2de1 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStoreTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/segment/file/FileStoreTest.java
@@ -27,17 +27,23 @@ import java.io.File;
 import java.io.FileOutputStream;
 import java.io.IOException;
 import java.io.RandomAccessFile;
+import java.util.Collections;
+import java.util.List;
 import java.util.Map;
 import java.util.Random;
 
+import com.google.common.base.Strings;
 import org.apache.jackrabbit.oak.api.Blob;
 import org.apache.jackrabbit.oak.plugins.memory.EmptyNodeState;
 import org.apache.jackrabbit.oak.plugins.segment.Compactor;
+import org.apache.jackrabbit.oak.plugins.segment.RecordId;
+import org.apache.jackrabbit.oak.plugins.segment.Segment;
 import org.apache.jackrabbit.oak.plugins.segment.SegmentBlob;
 import org.apache.jackrabbit.oak.plugins.segment.SegmentNodeBuilder;
 import org.apache.jackrabbit.oak.plugins.segment.SegmentNodeState;
 import org.apache.jackrabbit.oak.plugins.segment.SegmentWriter;
 import org.junit.Before;
+import org.junit.Ignore;
 import org.junit.Test;
 
 public class FileStoreTest {
@@ -216,4 +222,32 @@ public class FileStoreTest {
                 newArrayList(newTreeSet(files.keySet())));
     }
 
+    @Ignore("OAK-2049")
+    @Test  // See OAK-2049
+    public void segmentOverflow() throws IOException {
+        FileStore store = new FileStore(directory, 1, false);
+        SegmentWriter writer = store.getTracker().getWriter();
+        // writer.length == 32  (from the root node)
+
+        // adding 15 strings with 16516 bytes each
+        for (int k = 0; k < 15; k++) {
+            // 16516 = (Segment.MEDIUM_LIMIT - 1 + 2 + 3)
+            // 1 byte per char, 2 byte to store the length and 3 bytes for the
+            // alignment to the integer boundary
+            writer.writeString(Strings.repeat("abcdefghijklmno".substring(k, k + 1),
+                    Segment.MEDIUM_LIMIT - 1));
+        }
+
+        // adding 14280 bytes. 1 byte per char, and 2 bytes to store the length
+        RecordId x = writer.writeString(Strings.repeat("x", 14278));
+        // writer.length == 262052
+
+        // Adding 765 bytes (255 recordIds)
+        // This should cause the current segment to flush
+        List<RecordId> list = Collections.nCopies(255, x);  // 255 = ListRecord.LEVEL_SIZE
+        writer.writeList(list);
+
+        writer.flush();
+    }
+
 }
