diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/cache/EmpiricalWeigher.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/cache/EmpiricalWeigher.java
index 485019f953..bf12d85396 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/cache/EmpiricalWeigher.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/cache/EmpiricalWeigher.java
@@ -19,6 +19,8 @@
 package org.apache.jackrabbit.oak.cache;
 
 import com.google.common.cache.Weigher;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 /**
  * Determines the weight of object based on the memory taken by them. The memory estimates
@@ -26,12 +28,18 @@ import com.google.common.cache.Weigher;
  */
 public class EmpiricalWeigher implements Weigher<CacheValue, CacheValue> {
 
+    static final Logger LOG = LoggerFactory.getLogger(EmpiricalWeigher.class);
+
     @Override
     public int weigh(CacheValue key, CacheValue value) {
-        int size = 168;                 // overhead for each cache entry
+        long size = 168;                // overhead for each cache entry
         size += key.getMemory();        // key
         size += value.getMemory();      // value
-        return size;
+        if (size > Integer.MAX_VALUE) {
+            LOG.debug("Calculated weight larger than Integer.MAX_VALUE: {}.", size);
+            size = Integer.MAX_VALUE;
+        }
+        return (int) size;
     }
     
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/CachingBlobStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/CachingBlobStore.java
index 293ab7ce3f..0d2e507d29 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/CachingBlobStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/CachingBlobStore.java
@@ -24,12 +24,16 @@ import org.apache.jackrabbit.oak.commons.StringUtils;
 import org.apache.jackrabbit.oak.spi.blob.AbstractBlobStore;
 
 import com.google.common.cache.Weigher;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 /**
  * A blob store with a cache.
  */
 public abstract class CachingBlobStore extends AbstractBlobStore {
 
+    private static final Logger LOG = LoggerFactory.getLogger(CachingBlobStore.class);
+
     protected static final long DEFAULT_CACHE_SIZE = 16 * 1024 * 1024;
 
     protected final CacheLIRS<String, byte[]> cache;
@@ -39,7 +43,12 @@ public abstract class CachingBlobStore extends AbstractBlobStore {
     private final Weigher<String, byte[]> weigher = new Weigher<String, byte[]>() {
         @Override
         public int weigh(@Nonnull String key, @Nonnull byte[] value) {
-            return StringUtils.estimateMemoryUsage(key) + value.length;
+            long weight = (long)StringUtils.estimateMemoryUsage(key) + value.length;
+            if (weight > Integer.MAX_VALUE) {
+                LOG.debug("Calculated weight larger than Integer.MAX_VALUE: {}.", weight);
+                weight = Integer.MAX_VALUE;
+            }
+            return (int) weight;
         }
     };
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java
index 8a40989021..9d0054d7eb 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/blob/datastore/DataStoreBlobStore.java
@@ -109,7 +109,12 @@ public class DataStoreBlobStore
     private final Weigher<String, byte[]> weigher = new Weigher<String, byte[]>() {
         @Override
         public int weigh(@Nonnull String key, @Nonnull byte[] value) {
-            return StringUtils.estimateMemoryUsage(key) + value.length;
+            long weight = (long)StringUtils.estimateMemoryUsage(key) + value.length;
+            if (weight > Integer.MAX_VALUE) {
+                log.debug("Calculated weight larger than Integer.MAX_VALUE: {}.", weight);
+                weight = Integer.MAX_VALUE;
+            }
+            return (int) weight;
         }
     };
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeState.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeState.java
index d63bb16469..abdb804ae5 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeState.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/DocumentNodeState.java
@@ -56,6 +56,9 @@ import com.google.common.base.Function;
 import com.google.common.collect.Iterables;
 import com.google.common.collect.Iterators;
 
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+
 import static com.google.common.base.Preconditions.checkNotNull;
 import static org.apache.jackrabbit.oak.commons.PathUtils.concat;
 import static org.apache.jackrabbit.oak.commons.StringUtils.estimateMemoryUsage;
@@ -65,6 +68,8 @@ import static org.apache.jackrabbit.oak.commons.StringUtils.estimateMemoryUsage;
  */
 public class DocumentNodeState extends AbstractDocumentNodeState implements CacheValue {
 
+    private static final Logger log = LoggerFactory.getLogger(DocumentNodeState.class);
+
     public static final Children NO_CHILDREN = new Children();
 
     /**
@@ -419,7 +424,7 @@ public class DocumentNodeState extends AbstractDocumentNodeState implements Cach
 
     @Override
     public int getMemory() {
-        int size = 40 // shallow
+        long size = 40 // shallow
                 + (lastRevision != null ? lastRevision.getMemory() : 0)
                 + rootRevision.getMemory()
                 + estimateMemoryUsage(path);
@@ -443,10 +448,14 @@ public class DocumentNodeState extends AbstractDocumentNodeState implements Cach
                 // referencing the binary in the blob store
                 // double the size because the parsed PropertyState
                 // will have a similarly sized blobId as well
-                size += estimateMemoryUsage(getPropertyAsString(entry.getKey())) * 2;
+                size += (long)estimateMemoryUsage(getPropertyAsString(entry.getKey())) * 2;
             }
         }
-        return size;
+        if (size > Integer.MAX_VALUE) {
+            log.debug("Estimated memory footprint larger than Integer.MAX_VALUE: {}.", size);
+            size = Integer.MAX_VALUE;
+        }
+        return (int) size;
     }
 
     //------------------------------< internal >--------------------------------
@@ -602,22 +611,27 @@ public class DocumentNodeState extends AbstractDocumentNodeState implements Cach
          * Ascending sorted list of names of child nodes.
          */
         final ArrayList<String> children = new ArrayList<String>();
-        int cachedMemory;
+        long cachedMemory;
         boolean hasMore;
 
         @Override
         public int getMemory() {
             if (cachedMemory == 0) {
-                int size = 48;
+                long size = 48;
                 if (!children.isEmpty()) {
                     size = 114;
                     for (String c : children) {
-                        size += estimateMemoryUsage(c) + 8;
+                        size += (long)estimateMemoryUsage(c) + 8;
                     }
                 }
                 cachedMemory = size;
             }
-            return cachedMemory;
+            if (cachedMemory > Integer.MAX_VALUE) {
+                log.debug("Estimated memory footprint larger than Integer.MAX_VALUE: {}.", cachedMemory);
+                return Integer.MAX_VALUE;
+            } else {
+                return (int)cachedMemory;
+            }
         }
 
         @Override
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/LocalDiffCache.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/LocalDiffCache.java
index 6a3b182ae6..b1ded99215 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/LocalDiffCache.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/LocalDiffCache.java
@@ -80,7 +80,7 @@ public class LocalDiffCache extends DiffCache {
                           boolean local /*ignored*/) {
         return new Entry() {
             private final Map<String, String> changesPerPath = Maps.newHashMap();
-            private int size;
+            private long size;
             @Override
             public void append(@Nonnull String path, @Nonnull String changes) {
                 if (exceedsSize()){
@@ -119,9 +119,9 @@ public class LocalDiffCache extends DiffCache {
     public static final class Diff implements CacheValue {
 
         private final Map<String, String> changes;
-        private int memory;
+        private long memory;
 
-        public Diff(Map<String, String> changes, int memory) {
+        public Diff(Map<String, String> changes, long memory) {
             this.changes = changes;
             this.memory = memory;
         }
@@ -161,13 +161,18 @@ public class LocalDiffCache extends DiffCache {
         @Override
         public int getMemory() {
             if (memory == 0) {
-                int m = 0;
+                long m = 0;
                 for (Map.Entry<String, String> e : changes.entrySet()){
                     m += size(e.getKey()) + size(e.getValue());
                 }
                 memory = m;
             }
-            return memory;
+            if (memory > Integer.MAX_VALUE) {
+                LOG.debug("Estimated memory footprint larger than Integer.MAX_VALUE: {}.", memory);
+                return Integer.MAX_VALUE;
+            } else {
+                return (int) memory;
+            }
         }
 
         String get(String path) {
@@ -192,7 +197,7 @@ public class LocalDiffCache extends DiffCache {
         }
     }
 
-    private static int size(String s){
+    private static long size(String s){
         return StringValue.getMemory(s);
     }
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/NodeDocument.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/NodeDocument.java
index ea858fbfc7..747a84ed69 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/NodeDocument.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/NodeDocument.java
@@ -2217,11 +2217,15 @@ public final class NodeDocument extends Document implements CachedNodeDocument{
 
         @Override
         public int getMemory() {
-            int size = 114;
+            long size = 114;
             for (String name : childNames) {
-                size += name.length() * 2 + 56;
+                size += (long)name.length() * 2 + 56;
             }
-            return size;
+            if (size > Integer.MAX_VALUE) {
+                LOG.debug("Estimated memory footprint larger than Integer.MAX_VALUE: {}.", size);
+                size = Integer.MAX_VALUE;
+            }
+            return (int) size;
         }
 
         @SuppressWarnings("unchecked")
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/PathRev.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/PathRev.java
index 9018be74a9..eb0ba300f9 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/PathRev.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/PathRev.java
@@ -22,6 +22,8 @@ import javax.annotation.Nonnull;
 
 import org.apache.jackrabbit.oak.cache.CacheValue;
 import org.apache.jackrabbit.oak.commons.StringUtils;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 import static com.google.common.base.Preconditions.checkNotNull;
 
@@ -31,6 +33,8 @@ import static com.google.common.base.Preconditions.checkNotNull;
  */
 public final class PathRev implements CacheValue {
 
+    private static final Logger LOG = LoggerFactory.getLogger(PathRev.class);
+
     private final String path;
 
     private final RevisionVector revision;
@@ -46,9 +50,14 @@ public final class PathRev implements CacheValue {
 
     @Override
     public int getMemory() {
-        return 24                                       // shallow size
-                + StringUtils.estimateMemoryUsage(path) // path
-                + revision.getMemory();                 // revision
+        long size =  24                                               // shallow size
+                       + (long)StringUtils.estimateMemoryUsage(path)  // path
+                       + revision.getMemory();                        // revision
+        if (size > Integer.MAX_VALUE) {
+            LOG.debug("Estimated memory footprint larger than Integer.MAX_VALUE: {}.", size);
+            size = Integer.MAX_VALUE;
+        }
+        return (int) size;
     }
 
     //----------------------------< Object >------------------------------------
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/RevisionVector.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/RevisionVector.java
index b9c832f4eb..3576b1096b 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/RevisionVector.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/RevisionVector.java
@@ -32,6 +32,8 @@ import com.google.common.collect.Sets;
 import com.google.common.primitives.Ints;
 import org.apache.jackrabbit.oak.cache.CacheValue;
 import org.apache.jackrabbit.oak.plugins.document.util.Utils;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 import static com.google.common.base.Preconditions.checkNotNull;
 import static com.google.common.collect.Iterables.toArray;
@@ -51,6 +53,8 @@ import static java.util.Arrays.sort;
  */
 public final class RevisionVector implements Iterable<Revision>, Comparable<RevisionVector>, CacheValue {
 
+    private static final Logger log = LoggerFactory.getLogger(RevisionVector.class);
+
     private final static RevisionVector EMPTY = new RevisionVector();
 
     private final Revision[] revisions;
@@ -423,8 +427,13 @@ public final class RevisionVector implements Iterable<Revision>, Comparable<Revi
 
     @Override
     public int getMemory() {
-        return 32 // shallow size
-                + revisions.length * (Revision.SHALLOW_MEMORY_USAGE + 4);
+        long size = 32 // shallow size
+                      + (long)revisions.length * (Revision.SHALLOW_MEMORY_USAGE + 4);
+        if (size > Integer.MAX_VALUE) {
+            log.debug("Estimated memory footprint larger than Integer.MAX_VALUE: {}.", size);
+            size = Integer.MAX_VALUE;
+        }
+        return (int) size;
     }
 
     //------------------------< Comparable >------------------------------------
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/RevisionsKey.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/RevisionsKey.java
index 4aece63334..95c6775e4c 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/RevisionsKey.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/RevisionsKey.java
@@ -21,6 +21,8 @@ import javax.annotation.Nonnull;
 import org.apache.jackrabbit.oak.cache.CacheValue;
 import org.apache.jackrabbit.oak.plugins.document.Revision;
 import org.apache.jackrabbit.oak.plugins.document.RevisionVector;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 import static com.google.common.base.Preconditions.checkNotNull;
 
@@ -29,6 +31,8 @@ import static com.google.common.base.Preconditions.checkNotNull;
  */
 public final class RevisionsKey implements CacheValue, Comparable<RevisionsKey> {
 
+    private static final Logger log = LoggerFactory.getLogger(RevisionsKey.class);
+
     private final RevisionVector r1, r2;
 
     public RevisionsKey(RevisionVector r1, RevisionVector r2) {
@@ -38,7 +42,12 @@ public final class RevisionsKey implements CacheValue, Comparable<RevisionsKey>
 
     @Override
     public int getMemory() {
-        return 32 + r1.getMemory() + r2.getMemory();
+        long size = 32 + (long)r1.getMemory() + (long)r2.getMemory();
+        if (size > Integer.MAX_VALUE) {
+            log.debug("Estimated memory footprint larger than Integer.MAX_VALUE: {}.", size);
+            size = Integer.MAX_VALUE;
+        }
+        return (int) size;
     }
 
     @Override
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/StringValue.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/StringValue.java
index 78e36b0635..8b99e9f4b2 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/StringValue.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/StringValue.java
@@ -21,6 +21,8 @@ package org.apache.jackrabbit.oak.plugins.document.util;
 import javax.annotation.Nonnull;
 
 import org.apache.jackrabbit.oak.cache.CacheValue;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 import static com.google.common.base.Preconditions.checkNotNull;
 
@@ -29,6 +31,8 @@ import static com.google.common.base.Preconditions.checkNotNull;
  */
 public final class StringValue implements CacheValue {
 
+    private static final Logger log = LoggerFactory.getLogger(StringValue.class);
+
     private final String value;
 
     public StringValue(@Nonnull String value) {
@@ -41,8 +45,13 @@ public final class StringValue implements CacheValue {
     }
 
     public static int getMemory(@Nonnull String s) {
-        return 16                           // shallow size
-                + 40 + s.length() * 2;  // value
+        long size = 16                            // shallow size
+                    + 40 + (long)s.length() * 2;  // value
+        if (size > Integer.MAX_VALUE) {
+            log.debug("Estimated memory footprint larger than Integer.MAX_VALUE: {}.", size);
+            size = Integer.MAX_VALUE;
+        }
+        return (int) size;
     }
 
     @Override
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/Utils.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/Utils.java
index aa5b9fb398..8883db020c 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/Utils.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/Utils.java
@@ -130,7 +130,7 @@ public class Utils {
         if (map == null) {
             return 0;
         }
-        int size = 0;
+        long size = 0;
 
         for (Entry<?, Object> e : map.entrySet()) {
             if (e.getKey() instanceof Revision) {
@@ -148,7 +148,7 @@ public class Utils {
             } else if (o instanceof Integer) {
                 size += 8;
             } else if (o instanceof Map) {
-                size += 8 + estimateMemoryUsage((Map<String, Object>) o);
+                size += 8 + (long)estimateMemoryUsage((Map<String, Object>) o);
             } else if (o == null) {
                 // zero
             } else {
@@ -160,9 +160,13 @@ public class Utils {
         // TreeMap (80) + unmodifiable wrapper (32)
         size += 112;
         // 64 bytes per entry
-        size += map.size() * 64;
+        size += (long)map.size() * 64;
 
-        return size;
+        if (size > Integer.MAX_VALUE) {
+            LOG.debug("Estimated memory footprint larger than Integer.MAX_VALUE: {}.", size);
+            size = Integer.MAX_VALUE;
+        }
+        return (int) size;
     }
 
     public static String escapePropertyName(String propertyName) {
