diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/NodeDocument.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/NodeDocument.java
index 8f5e1ab94a..920cb9c5a6 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/NodeDocument.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/NodeDocument.java
@@ -51,10 +51,12 @@ import org.slf4j.LoggerFactory;
 import com.google.common.collect.Iterables;
 import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
+import com.google.common.collect.Sets;
 
 import static com.google.common.base.Preconditions.checkNotNull;
 import static com.google.common.collect.Iterables.filter;
 import static com.google.common.collect.Iterables.transform;
+import static java.util.Collections.disjoint;
 import static org.apache.jackrabbit.oak.plugins.document.UpdateOp.Key;
 import static org.apache.jackrabbit.oak.plugins.document.UpdateOp.Operation;
 
@@ -1339,7 +1341,7 @@ public final class NodeDocument extends Document implements CachedNodeDocument{
         setSplitDocMaxRev(old, maxRev);
 
         SplitDocType type = SplitDocType.DEFAULT;
-        if(!mainDoc.hasChildren()){
+        if(!mainDoc.hasChildren() && !referencesOldDocAfterSplit(mainDoc, oldDoc)){
             type = SplitDocType.DEFAULT_NO_CHILD;
         } else if (oldDoc.getLocalRevisions().isEmpty()){
             type = SplitDocType.PROP_COMMIT_ONLY;
@@ -1353,6 +1355,31 @@ public final class NodeDocument extends Document implements CachedNodeDocument{
         setSplitDocType(old,type);
     }
 
+    /**
+     * Checks if the main document has changes referencing {@code oldDoc} after
+     * the split.
+     *
+     * @param mainDoc the main document before the split.
+     * @param oldDoc  the old document created by the split.
+     * @return {@code true} if the main document contains references to the
+     *         old document after the split; {@code false} otherwise.
+     */
+    private static boolean referencesOldDocAfterSplit(NodeDocument mainDoc,
+                                                      NodeDocument oldDoc) {
+        Set<Revision> revs = oldDoc.getLocalRevisions().keySet();
+        for (String property : mainDoc.data.keySet()) {
+            if (IGNORE_ON_SPLIT.contains(property)) {
+                continue;
+            }
+            Set<Revision> changes = Sets.newHashSet(mainDoc.getLocalMap(property).keySet());
+            changes.removeAll(oldDoc.getLocalMap(property).keySet());
+            if (!disjoint(changes, revs)) {
+                return true;
+            }
+        }
+        return false;
+    }
+
     /**
      * Set various properties for intermediate split document
      *
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/VersionGarbageCollector.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/VersionGarbageCollector.java
index 320afb7746..e671b66d0d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/VersionGarbageCollector.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/VersionGarbageCollector.java
@@ -46,8 +46,7 @@ public class VersionGarbageCollector {
      */
     private static final Set<NodeDocument.SplitDocType> GC_TYPES = EnumSet.of(
             NodeDocument.SplitDocType.DEFAULT_NO_CHILD,
-            NodeDocument.SplitDocType.PROP_COMMIT_ONLY,
-            NodeDocument.SplitDocType.INTERMEDIATE);
+            NodeDocument.SplitDocType.PROP_COMMIT_ONLY);
 
 
     VersionGarbageCollector(DocumentNodeStore nodeStore) {
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/DocumentStoreFixture.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/DocumentStoreFixture.java
index 7435eb6be1..97a2edbae0 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/DocumentStoreFixture.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/DocumentStoreFixture.java
@@ -51,8 +51,6 @@ public abstract class DocumentStoreFixture {
 
     public static class MemoryFixture extends DocumentStoreFixture {
 
-        DocumentStore ds = new MemoryDocumentStore();
-
         @Override
         public String getName() {
             return "Memory";
@@ -60,7 +58,7 @@ public abstract class DocumentStoreFixture {
 
         @Override
         public DocumentStore createDocumentStore() {
-            return ds;
+            return new MemoryDocumentStore();
         }
     }
 
@@ -75,7 +73,7 @@ public abstract class DocumentStoreFixture {
                 DataSource datas = RDBDataSourceFactory.forJdbcUrl(url, username, passwd);
                 this.ds = new RDBDocumentStore(datas, new DocumentMK.Builder());
             } catch (Exception ex) {
-                LOG.info("Database instance not available at " + url + ", skipping tests...", ex);
+                LOG.info("Database instance not available at " + url + ", skipping tests...");
             }
         }
 
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/VersionGarbageCollectorTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/VersionGarbageCollectorTest.java
index 199ee82135..68b5ee1bef 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/VersionGarbageCollectorTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/VersionGarbageCollectorTest.java
@@ -20,15 +20,19 @@
 package org.apache.jackrabbit.oak.plugins.document;
 
 import java.io.IOException;
-import java.util.*;
 import java.util.Collection;
+import java.util.List;
+import java.util.Map;
 import java.util.concurrent.TimeUnit;
 
-import static org.apache.jackrabbit.oak.plugins.document.Collection.*;
+import static org.apache.jackrabbit.oak.plugins.document.Collection.NODES;
+import static org.apache.jackrabbit.oak.plugins.document.NodeDocument.NUM_REVS_THRESHOLD;
+import static org.apache.jackrabbit.oak.plugins.document.NodeDocument.PREV_SPLIT_FACTOR;
 import static org.apache.jackrabbit.oak.plugins.document.NodeDocument.SplitDocType;
 import static org.apache.jackrabbit.oak.plugins.document.VersionGarbageCollector.VersionGCStats;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertNotNull;
 import static org.junit.Assert.assertNull;
 import static org.junit.Assert.assertTrue;
 
@@ -206,6 +210,53 @@ public class VersionGarbageCollectorTest {
         //assertTrue(ImmutableList.copyOf(getDoc("/test2/foo").getAllPreviousDocs()).isEmpty());
     }
 
+    // OAK-1729
+    @Test
+    public void gcIntermediateDocs() throws Exception {
+        long maxAge = 1; //hrs
+        long delta = TimeUnit.MINUTES.toMillis(10);
+
+        NodeBuilder b1 = store.getRoot().builder();
+        // adding the foo node will cause the commit root to be placed
+        // on the rood document, because the children flag is set on the
+        // root document
+        b1.child("foo");
+        store.merge(b1, EmptyHook.INSTANCE, CommitInfo.EMPTY);
+        // adding test afterwards will use the new test document as the
+        // commit root. this what we want for the test.
+        b1.child("test");
+        store.merge(b1, EmptyHook.INSTANCE, CommitInfo.EMPTY);
+        assertTrue(!getDoc("/test").getLocalRevisions().isEmpty());
+
+        for (int i = 0; i < PREV_SPLIT_FACTOR + 1; i++) {
+            for (int j = 0; j < NUM_REVS_THRESHOLD; j++) {
+                b1 = store.getRoot().builder();
+                b1.child("test").setProperty("prop", i * NUM_REVS_THRESHOLD + j);
+                store.merge(b1, EmptyHook.INSTANCE, CommitInfo.EMPTY);
+            }
+            store.runBackgroundOperations();
+        }
+
+        Map<Revision, Range> prevRanges = getDoc("/test").getPreviousRanges();
+        boolean hasIntermediateDoc = false;
+        for (Map.Entry<Revision, Range> entry : prevRanges.entrySet()) {
+            if (entry.getValue().getHeight() > 0) {
+                hasIntermediateDoc = true;
+                break;
+            }
+        }
+        assertTrue("Test data does not have intermediate previous docs",
+                hasIntermediateDoc);
+
+        clock.waitUntil(clock.getTime() + TimeUnit.HOURS.toMillis(maxAge) + delta);
+        VersionGCStats stats = gc.gc(maxAge, TimeUnit.HOURS);
+        assertEquals(10, stats.splitDocGCCount);
+
+        DocumentNodeState test = getDoc("/test").getNodeAtRevision(
+                store, store.getHeadRevision(), null);
+        assertNotNull(test);
+    }
+
     private NodeDocument getDoc(String path){
         return store.getDocumentStore().find(NODES, Utils.getIdFromPath(path), 0);
     }
