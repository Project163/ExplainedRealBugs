diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/CompositeConfiguration.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/CompositeConfiguration.java
index 8a83039242..68434ceeb0 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/CompositeConfiguration.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/CompositeConfiguration.java
@@ -20,7 +20,9 @@ package org.apache.jackrabbit.oak.spi.security;
 
 import java.security.Principal;
 import java.util.List;
+import java.util.Map;
 import java.util.Set;
+import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.CopyOnWriteArrayList;
 import javax.annotation.CheckForNull;
 import javax.annotation.Nonnull;
@@ -66,6 +68,8 @@ public abstract class CompositeConfiguration<T extends SecurityConfiguration> im
 
     private final List<T> configurations = new CopyOnWriteArrayList<T>();
 
+    private final Ranking rankings = new Ranking();
+
     private final String name;
     private final CompositeContext ctx = new CompositeContext();
 
@@ -106,7 +110,7 @@ public abstract class CompositeConfiguration<T extends SecurityConfiguration> im
         } else {
             int i = 0;
             for (T c : configurations) {
-                int r = c.getParameters().getConfigValue(PARAM_RANKING, NO_RANKING);
+                int r = rankings.get(c);
                 if (ranking > r) {
                     break;
                 } else {
@@ -115,11 +119,13 @@ public abstract class CompositeConfiguration<T extends SecurityConfiguration> im
             }
             configurations.add(i, configuration);
         }
+        rankings.set(configuration, ranking);
         ctx.add(configuration);
     }
 
     public void removeConfiguration(@Nonnull T configuration) {
         configurations.remove(configuration);
+        rankings.remove(configuration);
         ctx.refresh(configurations);
     }
 
@@ -223,6 +229,30 @@ public abstract class CompositeConfiguration<T extends SecurityConfiguration> im
         return ctx;
     }
 
+    private static final class Ranking {
+
+        private Map<SecurityConfiguration, Integer> m = new ConcurrentHashMap();
+
+        private int get(@Nonnull SecurityConfiguration configuration) {
+            Integer ranking = m.get(configuration);
+            if (ranking == null) {
+                return NO_RANKING;
+            } else {
+                return ranking.intValue();
+            }
+        }
+
+        private void set(@Nonnull SecurityConfiguration configuration, int ranking) {
+            if (ranking != NO_RANKING) {
+                m.put(configuration, ranking);
+            }
+        }
+
+        private void remove(@Nonnull SecurityConfiguration configuration) {
+            m.remove(configuration);
+        }
+    }
+
     private static final class CompositeContext implements Context {
 
         @Nonnull
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImplTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImplTest.java
index 8208f3cc2d..c84ac56d43 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImplTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/security/authorization/accesscontrol/AccessControlManagerImplTest.java
@@ -29,6 +29,7 @@ import java.util.Set;
 import javax.annotation.Nonnull;
 import javax.annotation.Nullable;
 import javax.jcr.AccessDeniedException;
+import javax.jcr.NamespaceRegistry;
 import javax.jcr.PathNotFoundException;
 import javax.jcr.PropertyType;
 import javax.jcr.RepositoryException;
@@ -61,6 +62,7 @@ import org.apache.jackrabbit.oak.namepath.LocalNameMapper;
 import org.apache.jackrabbit.oak.namepath.NameMapper;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
 import org.apache.jackrabbit.oak.namepath.NamePathMapperImpl;
+import org.apache.jackrabbit.oak.plugins.name.ReadWriteNamespaceRegistry;
 import org.apache.jackrabbit.oak.plugins.nodetype.NodeTypeConstants;
 import org.apache.jackrabbit.oak.plugins.value.ValueFactoryImpl;
 import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.ACE;
@@ -120,6 +122,16 @@ public class AccessControlManagerImplTest extends AbstractAccessControlManagerTe
         return npMapper;
     }
 
+    private void registerNamespace(String prefix, String uri) throws Exception {
+        NamespaceRegistry nsRegistry = new ReadWriteNamespaceRegistry(root) {
+            @Override
+            protected Root getWriteRoot() {
+                return root;
+            }
+        };
+        nsRegistry.registerNamespace(prefix, uri);
+    }
+
     @Override
     protected AccessControlManagerImpl createAccessControlManager(@Nonnull Root root, @Nonnull NamePathMapper namePathMapper) {
         return new AccessControlManagerImpl(root, namePathMapper, getSecurityProvider());
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/CompositeConfigurationTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/CompositeConfigurationTest.java
index cafc831d85..36b6dec5c8 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/CompositeConfigurationTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/CompositeConfigurationTest.java
@@ -22,9 +22,14 @@ import java.util.List;
 import javax.annotation.Nonnull;
 import javax.annotation.Nullable;
 
+import com.google.common.collect.ImmutableList;
+import org.apache.jackrabbit.oak.spi.xml.ProtectedItemImporter;
 import org.junit.Before;
 import org.junit.Test;
+import org.mockito.Mockito;
+import org.osgi.framework.Constants;
 
+import static org.junit.Assert.assertArrayEquals;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertNotSame;
@@ -70,6 +75,16 @@ public class CompositeConfigurationTest extends AbstractCompositeConfigurationTe
         assertTrue(getConfigurations().isEmpty());
     }
 
+    @Test
+    public void testGetDefaultConfig() {
+        assertNull(compositeConfiguration.getDefaultConfig());
+
+        SecurityConfiguration sc = new SecurityConfiguration.Default();
+        setDefault(sc);
+
+        assertSame(sc, compositeConfiguration.getDefaultConfig());
+    }
+
     @Test
     public void testSetDefaultConfig() {
         SecurityConfiguration sc = new SecurityConfiguration.Default();
@@ -98,6 +113,53 @@ public class CompositeConfigurationTest extends AbstractCompositeConfigurationTe
         assertFalse(configurations.contains(def));
     }
 
+    @Test
+    public void testAddConfigurationWithRanking() {
+        SecurityConfiguration r100 = new SecurityConfiguration.Default();
+        compositeConfiguration.addConfiguration(r100, ConfigurationParameters.of(Constants.SERVICE_RANKING, 100));
+
+        SecurityConfiguration r200 = new SecurityConfiguration.Default();
+        compositeConfiguration.addConfiguration(r200, ConfigurationParameters.of(Constants.SERVICE_RANKING, 200));
+
+        SecurityConfiguration r150 = new SecurityConfiguration.Default() {
+            @Nonnull
+            @Override
+            public ConfigurationParameters getParameters() {
+                return ConfigurationParameters.of(CompositeConfiguration.PARAM_RANKING, 150);
+            }
+        };
+        compositeConfiguration.addConfiguration(r150, ConfigurationParameters.EMPTY);
+
+        SecurityConfiguration r50 = new SecurityConfiguration.Default() {
+            @Nonnull
+            @Override
+            public ConfigurationParameters getParameters() {
+                return ConfigurationParameters.of(CompositeConfiguration.PARAM_RANKING, 50);
+            }
+        };
+        compositeConfiguration.addConfiguration(r50, ConfigurationParameters.EMPTY);
+
+        SecurityConfiguration rUndef = new SecurityConfiguration.Default();
+        compositeConfiguration.addConfiguration(rUndef, ConfigurationParameters.EMPTY);
+
+        SecurityConfiguration r200second = new SecurityConfiguration.Default();
+        compositeConfiguration.addConfiguration(r200second, ConfigurationParameters.of(Constants.SERVICE_RANKING, 200));
+
+        List l = getConfigurations();
+        assertArrayEquals(new SecurityConfiguration[]{r200, r200second, r150, r100, r50, rUndef}, l.toArray(new SecurityConfiguration[l.size()]));
+
+        // remove and add new
+        removeConfiguration(r150);
+        removeConfiguration(r50);
+        removeConfiguration(r100);
+
+        SecurityConfiguration r75 = new SecurityConfiguration.Default();
+        compositeConfiguration.addConfiguration(r75, ConfigurationParameters.of(Constants.SERVICE_RANKING, 75));
+
+        l = getConfigurations();
+        assertArrayEquals(new SecurityConfiguration[]{r200, r200second, r75, rUndef}, l.toArray(new SecurityConfiguration[l.size()]));
+    }
+
     @Test
     public void testRemoveConfiguration() {
         SecurityConfiguration def = new SecurityConfiguration.Default();
@@ -165,6 +227,41 @@ public class CompositeConfigurationTest extends AbstractCompositeConfigurationTe
         assertNull(delegatees.get(compositeConfiguration.getContext()));
     }
 
+    @Test(expected = IllegalStateException.class)
+    public void testGetSecurityProviderNotInitialized() {
+        CompositeConfiguration cc = new CompositeConfiguration("name") {};
+        cc.getSecurityProvider();
+    }
+
+    @Test()
+    public void testSetSecurityProvider() {
+        CompositeConfiguration cc = new CompositeConfiguration("name") {};
+
+        SecurityProvider securityProvider = Mockito.mock(SecurityProvider.class);
+        cc.setSecurityProvider(securityProvider);
+
+        assertSame(securityProvider, cc.getSecurityProvider());
+    }
+
+    @Test
+    public void testGetProtectedItemImporter() {
+        assertTrue(compositeConfiguration.getProtectedItemImporters().isEmpty());
+
+        addConfiguration(new SecurityConfiguration.Default());
+        assertTrue(compositeConfiguration.getProtectedItemImporters().isEmpty());
+
+        SecurityConfiguration withImporter = new SecurityConfiguration.Default() {
+            @Nonnull
+            @Override
+            public List<ProtectedItemImporter> getProtectedItemImporters() {
+                return ImmutableList.of(Mockito.mock(ProtectedItemImporter.class));
+            }
+        };
+        addConfiguration(withImporter);
+
+        assertEquals(1, compositeConfiguration.getProtectedItemImporters().size());
+    }
+
     private static final class TestConfiguration extends SecurityConfiguration.Default {
 
         private final Context ctx = new TestContext();
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/ConfigurationBaseTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/ConfigurationBaseTest.java
new file mode 100644
index 0000000000..b75c77a0ac
--- /dev/null
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/ConfigurationBaseTest.java
@@ -0,0 +1,54 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.jackrabbit.oak.spi.security;
+
+import org.junit.Test;
+import org.mockito.Mockito;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertSame;
+
+public class ConfigurationBaseTest {
+
+    private final ConfigurationBase base = new ConfigurationBase() {};
+
+    @Test(expected = IllegalStateException.class)
+    public void testGetSecurityProvider() {
+        base.getSecurityProvider();
+    }
+
+    @Test
+    public void testSetSecurityProvider() {
+        SecurityProvider securityProvider = Mockito.mock(SecurityProvider.class);
+        base.setSecurityProvider(securityProvider);
+
+        assertSame(securityProvider, base.getSecurityProvider());
+    }
+
+    @Test
+    public void testGetParameters() {
+        assertSame(ConfigurationParameters.EMPTY, base.getParameters());
+    }
+
+    @Test
+    public void testSetParameters() {
+        ConfigurationParameters params = ConfigurationParameters.of("key", "value");
+
+        base.setParameters(params);
+        assertEquals(params, base.getParameters());
+    }
+}
\ No newline at end of file
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/DefaultContextTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/DefaultContextTest.java
new file mode 100644
index 0000000000..6cbe817f28
--- /dev/null
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/DefaultContextTest.java
@@ -0,0 +1,56 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.jackrabbit.oak.spi.security;
+
+import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.Tree;
+
+import org.apache.jackrabbit.oak.plugins.tree.TreeLocation;
+import org.junit.Test;
+import org.mockito.Mockito;
+
+import static org.junit.Assert.assertFalse;
+
+public class DefaultContextTest {
+
+    private final Tree tree = Mockito.mock(Tree.class);
+
+    @Test
+    public void testDefinesProperty() {
+        assertFalse(Context.DEFAULT.definesProperty(tree, Mockito.mock(PropertyState.class)));
+    }
+
+    @Test
+    public void testDefinesContextRoot() {
+        assertFalse(Context.DEFAULT.definesContextRoot(tree));
+    }
+
+    @Test
+    public void testDefinesTree() {
+        assertFalse(Context.DEFAULT.definesTree(tree));
+    }
+
+    @Test
+    public void testDefinesLocation() {
+        assertFalse(Context.DEFAULT.definesLocation(TreeLocation.create(tree)));
+    }
+
+    @Test
+    public void testDefinesInternal() {
+        assertFalse(Context.DEFAULT.definesInternal(tree));
+    }
+}
\ No newline at end of file
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/OpenSecurityProviderTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/OpenSecurityProviderTest.java
new file mode 100644
index 0000000000..11a58b377d
--- /dev/null
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/OpenSecurityProviderTest.java
@@ -0,0 +1,67 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.jackrabbit.oak.spi.security;
+
+import com.google.common.collect.Iterables;
+import org.apache.jackrabbit.oak.spi.security.authentication.AuthenticationConfiguration;
+import org.apache.jackrabbit.oak.spi.security.authentication.OpenAuthenticationConfiguration;
+import org.apache.jackrabbit.oak.spi.security.authorization.AuthorizationConfiguration;
+import org.apache.jackrabbit.oak.spi.security.authorization.OpenAuthorizationConfiguration;
+import org.apache.jackrabbit.oak.spi.security.principal.PrincipalConfiguration;
+import org.apache.jackrabbit.oak.spi.security.user.UserConfiguration;
+import org.junit.Test;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertSame;
+import static org.junit.Assert.assertTrue;
+
+public class OpenSecurityProviderTest {
+
+    private final OpenSecurityProvider securityProvider = new OpenSecurityProvider();
+
+    @Test
+    public void testGetParameters() {
+        assertSame(ConfigurationParameters.EMPTY, securityProvider.getParameters(null));
+        assertSame(ConfigurationParameters.EMPTY, securityProvider.getParameters(AuthorizationConfiguration.NAME));
+    }
+
+    @Test
+    public void testGetAuthorizationConfiguration() {
+        assertTrue(securityProvider.getConfiguration(AuthorizationConfiguration.class) instanceof OpenAuthorizationConfiguration);
+    }
+
+    @Test
+    public void testGetAuthenticationConfiguration() {
+        assertTrue(securityProvider.getConfiguration(AuthenticationConfiguration.class) instanceof OpenAuthenticationConfiguration);
+    }
+
+    @Test(expected = IllegalArgumentException.class)
+    public void testGetUserConfiguration() {
+        securityProvider.getConfiguration(UserConfiguration.class);
+    }
+
+    @Test(expected = IllegalArgumentException.class)
+    public void testGetPrincipalConfiguration() {
+        securityProvider.getConfiguration(PrincipalConfiguration.class);
+    }
+
+    @Test
+    public void testGetConfigurations() {
+        Iterable<? extends SecurityConfiguration> configurations = securityProvider.getConfigurations();
+        assertEquals(2, Iterables.size(configurations));
+    }
+}
\ No newline at end of file
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlTest.java
index 2c5b5ad3a8..12bfe7f9df 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/accesscontrol/AbstractAccessControlTest.java
@@ -19,14 +19,11 @@ package org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol;
 import java.security.Principal;
 import java.util.HashSet;
 import java.util.Set;
-import javax.jcr.NamespaceRegistry;
 import javax.jcr.RepositoryException;
 import javax.jcr.security.AccessControlException;
 import javax.jcr.security.Privilege;
 
 import org.apache.jackrabbit.oak.AbstractSecurityTest;
-import org.apache.jackrabbit.oak.api.Root;
-import org.apache.jackrabbit.oak.plugins.name.ReadWriteNamespaceRegistry;
 import org.apache.jackrabbit.oak.spi.security.authorization.AuthorizationConfiguration;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.Restriction;
 import org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionProvider;
@@ -38,16 +35,6 @@ public abstract class AbstractAccessControlTest extends AbstractSecurityTest {
     private RestrictionProvider restrictionProvider;
     private PrivilegeBitsProvider bitsProvider;
 
-    protected void registerNamespace(String prefix, String uri) throws Exception {
-        NamespaceRegistry nsRegistry = new ReadWriteNamespaceRegistry(root) {
-            @Override
-            protected Root getWriteRoot() {
-                return root;
-            }
-        };
-        nsRegistry.registerNamespace(prefix, uri);
-    }
-
     protected RestrictionProvider getRestrictionProvider() {
         if (restrictionProvider == null) {
             restrictionProvider = getConfig(AuthorizationConfiguration.class).getRestrictionProvider();
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/restriction/RestrictionDefinitionImplTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/restriction/RestrictionDefinitionImplTest.java
index 0c7167a6fd..1ced514d22 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/restriction/RestrictionDefinitionImplTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/restriction/RestrictionDefinitionImplTest.java
@@ -18,11 +18,9 @@ package org.apache.jackrabbit.oak.spi.security.authorization.restriction;
 
 import java.util.ArrayList;
 import java.util.List;
-
 import javax.annotation.Nonnull;
 
 import org.apache.jackrabbit.oak.api.Type;
-import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.AbstractAccessControlTest;
 import org.junit.Before;
 import org.junit.Test;
 
@@ -34,15 +32,13 @@ import static org.junit.Assert.fail;
 /**
  * Tests for {@link RestrictionDefinitionImpl}.
  */
-public class RestrictionDefinitionImplTest extends AbstractAccessControlTest {
+public class RestrictionDefinitionImplTest {
 
     private String name;
     private RestrictionDefinitionImpl definition;
 
     @Before
     public void before() throws Exception {
-        super.before();
-
         name = "test:defName";
         definition = new RestrictionDefinitionImpl(name, Type.NAME, true);
     }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/restriction/RestrictionImplTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/restriction/RestrictionImplTest.java
index eaa52768ae..0db0ee9c2b 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/restriction/RestrictionImplTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/authorization/restriction/RestrictionImplTest.java
@@ -24,7 +24,6 @@ import com.google.common.collect.ImmutableList;
 import org.apache.jackrabbit.oak.api.PropertyState;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.plugins.memory.PropertyStates;
-import org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.AbstractAccessControlTest;
 import org.junit.Before;
 import org.junit.Test;
 
@@ -37,7 +36,7 @@ import static org.junit.Assert.fail;
 /**
  * Tests for {@link RestrictionImpl}
  */
-public class RestrictionImplTest extends AbstractAccessControlTest {
+public class RestrictionImplTest {
 
     private final Type type = Type.NAME;
     private final String name = "test:defName";
@@ -47,8 +46,6 @@ public class RestrictionImplTest extends AbstractAccessControlTest {
 
     @Before
     public void before() throws Exception {
-        super.before();
-
         PropertyState property = createProperty(name, value, type);
         restriction = new RestrictionImpl(property, isMandatory);
     }
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/user/action/DefaultAuthorizableActionProviderTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/user/action/DefaultAuthorizableActionProviderTest.java
index f814196732..8187f3c336 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/user/action/DefaultAuthorizableActionProviderTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/user/action/DefaultAuthorizableActionProviderTest.java
@@ -20,6 +20,7 @@ import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
 
+import org.apache.jackrabbit.oak.AbstractSecurityTest;
 import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;
 import org.apache.jackrabbit.oak.spi.security.SecurityProvider;
 import org.apache.jackrabbit.oak.spi.security.authorization.AuthorizationConfiguration;
