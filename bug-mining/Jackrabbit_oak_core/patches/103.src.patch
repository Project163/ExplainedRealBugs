diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/PropertyState.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/PropertyState.java
index 582dd66edd..eea77a409e 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/PropertyState.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/PropertyState.java
@@ -40,14 +40,14 @@ public interface PropertyState {
     String getName();
 
     /**
-     * Determine whether the value if an array of atoms
-     * @return  {@code true} if and only if the value is an array of atoms.
+     * Determine whether the value is an array of atoms
+     * @return {@code true} if and only if the value is an array of atoms.
      */
     boolean isArray();
 
     /**
      * Determine the type of this property
-     * @return  the type of this property
+     * @return the type of this property
      */
     Type<?> getType();
 
@@ -66,7 +66,7 @@ public interface PropertyState {
      * @throws IllegalStateException  if {@code type.isArray() == false} and
      *         {@code this.isArray() == true}. In other words, when trying to convert
      *         from an array to an atom.
-     * @throws IllegalArgumentException  if {@code type} refers to an unkown type.
+     * @throws IllegalArgumentException  if {@code type} refers to an unknown type.
      * @throws NumberFormatException  if conversion to a number failed.
      * @throws UnsupportedOperationException  if conversion to boolean failed.
      */
@@ -80,13 +80,13 @@ public interface PropertyState {
      * If the target type is not the same as the type of this property an attempt
      * is made to convert the value to the target type. If the conversion fails an
      * exception is thrown.
-     * @param type  target type
+     * @param type target type
      * @param index
      * @param <T>
      * @return the value of this property at the given {@code index}
      * @throws IndexOutOfBoundsException  if {@code index} is less than {@code 0} or
      *         greater or equals {@code count()}.
-     * @throws IllegalArgumentException  if {@code type} refers to an unkown type or if
+     * @throws IllegalArgumentException  if {@code type} refers to an unknown type or if
      *         {@code type.isArray()} is true.
      */
     @Nonnull
@@ -94,15 +94,15 @@ public interface PropertyState {
 
     /**
      * The size of the value of this property.
-     * @return  size of the value of this property
-     * @throws  IllegalStateException  if the value is an array
+     * @return size of the value of this property
+     * @throws IllegalStateException  if the value is an array
      */
     long size();
 
     /**
      * The size of the value at the given {@code index}.
      * @param index
-     * @return  size of the value at the given {@code index}.
+     * @return size of the value at the given {@code index}.
      * @throws IndexOutOfBoundsException  if {@code index} is less than {@code 0} or
      *         greater or equals {@code count()}.
      */
@@ -110,7 +110,7 @@ public interface PropertyState {
 
     /**
      * The number of values of this property. {@code 1} for atoms.
-     * @return  number of values
+     * @return number of values
      */
     int count();
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/PropertyValue.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/PropertyValue.java
new file mode 100644
index 0000000000..b0e34775de
--- /dev/null
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/PropertyValue.java
@@ -0,0 +1,103 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.jackrabbit.oak.api;
+
+import javax.annotation.Nonnull;
+
+/**
+ * Immutable property value.
+ * A value is either an atom or an array of atoms.
+ *
+ */
+public interface PropertyValue extends Comparable<PropertyValue> {
+
+    /**
+     * Determine whether the value is an array of atoms
+     * @return {@code true} if and only if the value is an array of atoms.
+     */
+    boolean isArray();
+
+    /**
+     * Determine the type of this value
+     * @return the type of this value
+     */
+    Type<?> getType();
+
+    /**
+     * Value of this object.
+     * The type of the return value is determined by the target {@code type}
+     * argument. If {@code type.isArray()} is true, this method returns an
+     * {@code Iterable} of the {@link Type#getBaseType() base type} of
+     * {@code type} containing all values of this property.
+     * If the target type is not the same as the type of this property an attempt
+     * is made to convert the value to the target type. If the conversion fails an
+     * exception is thrown.
+     * @param type target type
+     * @param <T>
+     * @return the value of this property
+     * @throws IllegalStateException  if {@code type.isArray() == false} and
+     *         {@code this.isArray() == true}. In other words, when trying to convert
+     *         from an array to an atom.
+     * @throws IllegalArgumentException  if {@code type} refers to an unknown type.
+     * @throws NumberFormatException  if conversion to a number failed.
+     * @throws UnsupportedOperationException  if conversion to boolean failed.
+     */
+    @Nonnull
+    <T> T getValue(Type<T> type);
+
+    /**
+     * Value at the given {@code index}.
+     * The type of the return value is determined by the target {@code type}
+     * argument.
+     * If the target type is not the same as the type of this property an attempt
+     * is made to convert the value to the target type. If the conversion fails an
+     * exception is thrown.
+     * @param type target type
+     * @param index
+     * @param <T>
+     * @return the value of this object at the given {@code index}
+     * @throws IndexOutOfBoundsException  if {@code index} is less than {@code 0} or
+     *         greater or equals {@code count()}.
+     * @throws IllegalArgumentException  if {@code type} refers to an unknown type or if
+     *         {@code type.isArray()} is true.
+     */
+    @Nonnull
+    <T> T getValue(Type<T> type, int index);
+
+    /**
+     * The size of the value of this object.
+     * @return size of the value of this property
+     * @throws IllegalStateException  if the value is an array
+     */
+    long size();
+
+    /**
+     * The size of the value at the given {@code index}.
+     * @param index
+     * @return size of the value at the given {@code index}.
+     * @throws IndexOutOfBoundsException  if {@code index} is less than {@code 0} or
+     *         greater or equals {@code count()}.
+     */
+    long size(int index);
+
+    /**
+     * The number of values of this object. {@code 1} for atoms.
+     * @return number of values
+     */
+    int count();
+
+}
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/ResultRow.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/ResultRow.java
index abe895b254..9e9ba939b1 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/ResultRow.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/ResultRow.java
@@ -16,7 +16,6 @@
  */
 package org.apache.jackrabbit.oak.api;
 
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 
 /**
  * A query result row.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/SessionQueryEngine.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/SessionQueryEngine.java
index 8908b9a6fe..44c33ddb74 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/api/SessionQueryEngine.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/api/SessionQueryEngine.java
@@ -21,7 +21,6 @@ import java.util.List;
 import java.util.Map;
 
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 
 /**
  * The query engine allows to parse and execute queries.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/identifier/IdentifierManager.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/identifier/IdentifierManager.java
index 421383be01..9138108130 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/identifier/IdentifierManager.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/identifier/IdentifierManager.java
@@ -34,6 +34,7 @@ import com.google.common.collect.Iterables;
 import com.google.common.collect.Sets;
 import org.apache.jackrabbit.JcrConstants;
 import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Result;
 import org.apache.jackrabbit.oak.api.ResultRow;
 import org.apache.jackrabbit.oak.api.Root;
@@ -42,7 +43,6 @@ import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
 import org.apache.jackrabbit.oak.plugins.memory.PropertyStates;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/old/PropertyContentIndex.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/old/PropertyContentIndex.java
index a63bbe810c..ed190d2a4f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/old/PropertyContentIndex.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/old/PropertyContentIndex.java
@@ -20,12 +20,12 @@ package org.apache.jackrabbit.oak.plugins.index.old;
 
 import java.util.Iterator;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.query.index.IndexRowImpl;
 import org.apache.jackrabbit.oak.spi.query.Cursor;
 import org.apache.jackrabbit.oak.spi.query.Filter;
 import org.apache.jackrabbit.oak.spi.query.IndexRow;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.QueryIndex;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndex.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndex.java
index 5abe954014..b9ac788135 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndex.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndex.java
@@ -24,7 +24,7 @@ import java.util.Iterator;
 import java.util.List;
 import java.util.Set;
 
-import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.query.index.IndexRowImpl;
 import org.apache.jackrabbit.oak.query.index.TraversingCursor;
@@ -42,7 +42,7 @@ public class PropertyIndex implements QueryIndex {
 
     private static final int MAX_STRING_LENGTH = 100; // TODO: configurable
 
-    static List<String> encode(PropertyState value) {
+    static List<String> encode(PropertyValue value) {
         List<String> values = new ArrayList<String>();
 
         for (String v : value.getValue(Type.STRINGS)) {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexLookup.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexLookup.java
index 189da7476d..a82a25dc7a 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexLookup.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexLookup.java
@@ -19,8 +19,8 @@ package org.apache.jackrabbit.oak.plugins.index.property;
 import java.util.Set;
 
 import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Type;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.apache.jackrabbit.oak.spi.state.ChildNodeEntry;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
@@ -79,7 +79,7 @@ public class PropertyIndexLookup {
                 state = state.getChildNode(":index");
                 if (state != null) {
                     //TODO what happens when I search using an mvp?
-                    property = state.getProperty(PropertyIndex.encode(value.unwrap()).get(0));
+                    property = state.getProperty(PropertyIndex.encode(value).get(0));
                 }
             }
         }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexUpdate.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexUpdate.java
index ecc2516038..ff592a8a90 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexUpdate.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/index/property/PropertyIndexUpdate.java
@@ -30,6 +30,7 @@ import org.apache.jackrabbit.oak.api.CommitFailedException;
 import org.apache.jackrabbit.oak.api.PropertyState;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.plugins.memory.PropertyStates;
+import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.apache.jackrabbit.oak.spi.state.NodeBuilder;
 
 class PropertyIndexUpdate {
@@ -62,7 +63,7 @@ class PropertyIndexUpdate {
     private static void putValues(Map<String, Set<String>> map, String path,
             PropertyState value) {
         if (value.getType().tag() != PropertyType.BINARY) {
-            List<String> keys = PropertyIndex.encode(value);
+            List<String> keys = PropertyIndex.encode(PropertyValues.create(value));
             for (String key : keys) {
                 Set<String> paths = map.get(key);
                 if (paths == null) {
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
index 536bc4cfc6..1735211da0 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/Query.java
@@ -20,6 +20,7 @@ import java.util.HashMap;
 import java.util.Iterator;
 import java.util.List;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Root;
 import org.apache.jackrabbit.oak.api.Tree;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
@@ -49,7 +50,6 @@ import org.apache.jackrabbit.oak.query.ast.SelectorImpl;
 import org.apache.jackrabbit.oak.query.ast.SourceImpl;
 import org.apache.jackrabbit.oak.query.ast.UpperCaseImpl;
 import org.apache.jackrabbit.oak.spi.query.Filter;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.apache.jackrabbit.oak.spi.query.QueryIndex;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryEngineImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryEngineImpl.java
index 072ec8860b..7b2ce2bb8e 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryEngineImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/QueryEngineImpl.java
@@ -22,11 +22,11 @@ import java.util.List;
 import java.util.Map;
 import java.util.Map.Entry;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Root;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
 import org.apache.jackrabbit.oak.query.index.TraversingIndex;
 import org.apache.jackrabbit.oak.spi.query.Filter;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.QueryIndex;
 import org.apache.jackrabbit.oak.spi.query.QueryIndexProvider;
 import org.apache.jackrabbit.oak.spi.state.NodeStore;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java
index 42d4aee1dc..388e1cefa9 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ResultRowImpl.java
@@ -16,10 +16,10 @@
  */
 package org.apache.jackrabbit.oak.query;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.ResultRow;
 import org.apache.jackrabbit.oak.query.ast.ColumnImpl;
 import org.apache.jackrabbit.oak.query.ast.SelectorImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 
 /**
  * A query result row that keeps all data in memory.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
index d7fd577f5c..ef7737e54e 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SQL2Parser.java
@@ -16,6 +16,7 @@
  */
 package org.apache.jackrabbit.oak.query;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.query.ast.AstElementFactory;
@@ -33,7 +34,6 @@ import org.apache.jackrabbit.oak.query.ast.PropertyValueImpl;
 import org.apache.jackrabbit.oak.query.ast.SelectorImpl;
 import org.apache.jackrabbit.oak.query.ast.SourceImpl;
 import org.apache.jackrabbit.oak.query.ast.StaticOperandImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 
 import javax.jcr.PropertyType;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SessionQueryEngineImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SessionQueryEngineImpl.java
index 2c6660cd9a..f023a2717b 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SessionQueryEngineImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/SessionQueryEngineImpl.java
@@ -20,11 +20,11 @@ import java.text.ParseException;
 import java.util.List;
 import java.util.Map;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Result;
 import org.apache.jackrabbit.oak.api.Root;
 import org.apache.jackrabbit.oak.api.SessionQueryEngine;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.QueryIndexProvider;
 import org.apache.jackrabbit.oak.spi.state.NodeStore;
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElementFactory.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElementFactory.java
index d817086df6..cf854e8be4 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElementFactory.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/AstElementFactory.java
@@ -13,7 +13,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 
 /**
  * A factory for syntax tree elements.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/BindVariableValueImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/BindVariableValueImpl.java
index daa08ae855..c59cc0467e 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/BindVariableValueImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/BindVariableValueImpl.java
@@ -18,7 +18,8 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
+import org.apache.jackrabbit.oak.api.PropertyValue;
+
 
 /**
  * A bind variable.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java
index b9db40e1f0..e0e7282e8d 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ColumnImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 
 /**
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ComparisonImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ComparisonImpl.java
index 3a4867f037..21356e8da9 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ComparisonImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/ComparisonImpl.java
@@ -18,9 +18,9 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 
 /**
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DynamicOperandImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DynamicOperandImpl.java
index 17a220e7af..268637d3e6 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DynamicOperandImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/DynamicOperandImpl.java
@@ -16,8 +16,8 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 
 /**
  * The base class for dynamic operands (such as a function or property).
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java
index bf37f7af0e..0fbd39df07 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/EquiJoinConditionImpl.java
@@ -18,8 +18,8 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 
 /**
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchImpl.java
index 6fb159ee62..cb1f426d5f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchImpl.java
@@ -22,11 +22,12 @@ import java.text.ParseException;
 import java.util.ArrayList;
 
 import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Tree;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.query.ast.ComparisonImpl.LikePattern;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
+import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 
 import static org.apache.jackrabbit.oak.api.Type.STRING;
 import static org.apache.jackrabbit.oak.api.Type.STRINGS;
@@ -82,14 +83,14 @@ public class FullTextSearchImpl extends ConstraintImpl {
             if (p == null) {
                 return false;
             }
-            appendString(buff, p.unwrap());
+            appendString(buff, p);
         } else {
             Tree tree = getTree(selector.currentPath());
             if (tree == null) {
                 return false;
             }
             for (PropertyState p : tree.getProperties()) {
-                appendString(buff, p);
+                appendString(buff, PropertyValues.create(p));
             }
         }
         // TODO fulltext conditions: need a way to disable evaluation
@@ -105,7 +106,7 @@ public class FullTextSearchImpl extends ConstraintImpl {
         }
     }
 
-    private static void appendString(StringBuilder buff, PropertyState p) {
+    private static void appendString(StringBuilder buff, PropertyValue p) {
         if (p.isArray()) {
             for (String v : p.getValue(STRINGS)) {
                 buff.append(v).append(' ');
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchScoreImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchScoreImpl.java
index 655728922d..0aa5050350 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchScoreImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/FullTextSearchScoreImpl.java
@@ -18,9 +18,9 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.query.Query;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 
 /**
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LengthImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LengthImpl.java
index 85080c535f..477ea27cce 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LengthImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LengthImpl.java
@@ -20,8 +20,8 @@ package org.apache.jackrabbit.oak.query.ast;
 
 import javax.jcr.PropertyType;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 
 /**
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LiteralImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LiteralImpl.java
index 7a40938638..7501208ae4 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LiteralImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LiteralImpl.java
@@ -22,9 +22,9 @@ import java.util.Locale;
 
 import javax.jcr.PropertyType;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.query.SQL2Parser;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 
 /**
  * A literal of a certain data type, possibly "cast(..)" of a literal.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LowerCaseImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LowerCaseImpl.java
index bf9396dd56..26ca88cb7a 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LowerCaseImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/LowerCaseImpl.java
@@ -18,8 +18,8 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 
 import static org.apache.jackrabbit.oak.api.Type.STRING;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeLocalNameImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeLocalNameImpl.java
index 0a5d188115..7afebdf562 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeLocalNameImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeLocalNameImpl.java
@@ -18,9 +18,9 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.apache.jackrabbit.util.ISO9075;
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeNameImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeNameImpl.java
index 920ab2344b..e9b1cb99e9 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeNameImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/NodeNameImpl.java
@@ -20,10 +20,10 @@ package org.apache.jackrabbit.oak.query.ast;
 
 import javax.jcr.PropertyType;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.apache.jackrabbit.util.ISO9075;
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyValueImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyValueImpl.java
index 6bbaa21fdf..8126fd1b22 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyValueImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/PropertyValueImpl.java
@@ -25,12 +25,12 @@ import java.util.Locale;
 import javax.jcr.PropertyType;
 
 import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Tree;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.query.SQL2Parser;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 
 import com.google.common.collect.Iterables;
@@ -87,7 +87,7 @@ public class PropertyValueImpl extends DynamicOperandImpl {
         boolean asterisk = propertyName.equals("*");
         if (!relative && !asterisk) {
             PropertyValue p = selector.currentProperty(propertyName);
-            return p != null && matchesPropertyType(p.unwrap()) ? p : null;
+            return matchesPropertyType(p) ? p : null;
         }
         Tree tree = getTree(selector.currentPath());
         if (tree == null) {
@@ -130,6 +130,16 @@ public class PropertyValueImpl extends DynamicOperandImpl {
         return PropertyValues.newString(values);
     }
 
+    private boolean matchesPropertyType(PropertyValue value) {
+        if (value == null) {
+            return false;
+        }
+        if (propertyType == PropertyType.UNDEFINED) {
+            return true;
+        }
+        return value.getType().tag() == propertyType;
+    }
+
     private boolean matchesPropertyType(PropertyState state) {
         if (state == null) {
             return false;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
index a2276b4938..0fee34c133 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/SelectorImpl.java
@@ -29,6 +29,7 @@ import javax.jcr.nodetype.NodeTypeIterator;
 import javax.jcr.nodetype.NodeTypeManager;
 
 import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Tree;
 import org.apache.jackrabbit.oak.plugins.nodetype.NodeTypeConstants;
 import org.apache.jackrabbit.oak.plugins.nodetype.ReadOnlyNodeTypeManager;
@@ -37,7 +38,6 @@ import org.apache.jackrabbit.oak.query.index.FilterImpl;
 import org.apache.jackrabbit.oak.spi.query.Cursor;
 import org.apache.jackrabbit.oak.spi.query.Filter;
 import org.apache.jackrabbit.oak.spi.query.IndexRow;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.apache.jackrabbit.oak.spi.query.QueryIndex;
 import org.apache.jackrabbit.oak.spi.state.NodeState;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/StaticOperandImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/StaticOperandImpl.java
index 32f3e96a63..21b060b5d3 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/StaticOperandImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/StaticOperandImpl.java
@@ -18,7 +18,7 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 
 /**
  * The base class for static operands (literal, bind variables).
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/UpperCaseImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/UpperCaseImpl.java
index 0366b83328..42fe512f2f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/UpperCaseImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/ast/UpperCaseImpl.java
@@ -18,8 +18,8 @@
  */
 package org.apache.jackrabbit.oak.query.ast;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.query.index.FilterImpl;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 
 import static org.apache.jackrabbit.oak.api.Type.STRING;
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/FilterImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/FilterImpl.java
index 97c3e2bbc8..adc4420654 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/FilterImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/FilterImpl.java
@@ -26,11 +26,11 @@ import java.util.Map.Entry;
 
 import javax.jcr.PropertyType;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.query.ast.Operator;
 import org.apache.jackrabbit.oak.query.ast.SelectorImpl;
 import org.apache.jackrabbit.oak.spi.query.Filter;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 
 /**
  * A filter or lookup condition.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/IndexRowImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/IndexRowImpl.java
index 80d372320c..4a4664bbfb 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/IndexRowImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/query/index/IndexRowImpl.java
@@ -19,7 +19,7 @@
 package org.apache.jackrabbit.oak.query.index;
 
 import org.apache.jackrabbit.oak.spi.query.IndexRow;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
+import org.apache.jackrabbit.oak.spi.query.PropertyStateValue;
 
 /**
  * A simple index row implementation.
@@ -38,7 +38,7 @@ public class IndexRowImpl implements IndexRow {
     }
 
     @Override
-    public PropertyValue getValue(String columnName) {
+    public PropertyStateValue getValue(String columnName) {
         return null;
     }
 
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/Filter.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/Filter.java
index fff713cdab..189554b001 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/Filter.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/Filter.java
@@ -19,9 +19,10 @@
 package org.apache.jackrabbit.oak.spi.query;
 
 import java.util.Collection;
+
 import javax.jcr.PropertyType;
 
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 
 /**
  * The filter for an index lookup.
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/IndexRow.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/IndexRow.java
index edbe966f75..95fe2cdb22 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/IndexRow.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/IndexRow.java
@@ -19,7 +19,7 @@
 package org.apache.jackrabbit.oak.spi.query;
 
 
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
+import org.apache.jackrabbit.oak.spi.query.PropertyStateValue;
 
 /**
  * A row returned by the index.
@@ -41,6 +41,6 @@ public interface IndexRow {
      * @param columnName the column name
      * @return the value, or null if not available
      */
-    PropertyValue getValue(String columnName);
+    PropertyStateValue getValue(String columnName);
 
 }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/PropertyValue.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/PropertyStateValue.java
similarity index 92%
rename from oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/PropertyValue.java
rename to oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/PropertyStateValue.java
index 68fbd37821..861206a1bd 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/PropertyValue.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/PropertyStateValue.java
@@ -26,14 +26,19 @@ import javax.annotation.Nonnull;
 import javax.jcr.PropertyType;
 
 import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.util.ISO8601;
 
-public class PropertyValue implements Comparable<PropertyValue> {
+/**
+ * A {@link PropertyValue} implementation that wraps a {@link PropertyState}
+ * 
+ */
+public class PropertyStateValue implements PropertyValue {
 
     private final PropertyState ps;
 
-    protected PropertyValue(PropertyState ps) {
+    protected PropertyStateValue(PropertyState ps) {
         this.ps = ps;
     }
 
@@ -161,8 +166,8 @@ public class PropertyValue implements Comparable<PropertyValue> {
     public boolean equals(Object o) {
         if (o == this) {
             return true;
-        } else if (o instanceof PropertyValue) {
-            return compareTo((PropertyValue) o) == 0;
+        } else if (o instanceof PropertyStateValue) {
+            return compareTo((PropertyStateValue) o) == 0;
         } else {
             return false;
         }
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/PropertyValues.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/PropertyValues.java
index 0074d98b43..e39f4e8f1f 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/PropertyValues.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/query/PropertyValues.java
@@ -27,89 +27,103 @@ import javax.annotation.Nonnull;
 import javax.jcr.PropertyType;
 
 import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
 import org.apache.jackrabbit.oak.plugins.memory.PropertyStates;
 
-public class PropertyValues {
+/**
+ * Utility class for creating {@link PropertyValue} instances.
+ */
+public final class PropertyValues {
 
     private PropertyValues() {
     }
 
-    // TODO consistent naming
-
     @CheckForNull
     public static PropertyValue create(PropertyState property) {
         if (property == null) {
             return null;
         }
-        return new PropertyValue(property);
+        return new PropertyStateValue(property);
+    }
+
+    @CheckForNull
+    public static PropertyState create(PropertyValue value) {
+        if (value == null) {
+            return null;
+        }
+        if (value instanceof PropertyStateValue) {
+            return ((PropertyStateValue) value).unwrap();
+        }
+        return null;
     }
 
     @Nonnull
     public static PropertyValue newString(String value) {
-        return new PropertyValue(PropertyStates.stringProperty("", value));
+        return new PropertyStateValue(PropertyStates.stringProperty("", value));
     }
 
     @Nonnull
     public static PropertyValue newString(Iterable<String> value) {
-        return new PropertyValue(PropertyStates.stringProperty("", value));
+        return new PropertyStateValue(PropertyStates.stringProperty("", value));
     }
 
     @Nonnull
     public static PropertyValue newLong(Long value) {
-        return new PropertyValue(PropertyStates.longProperty("", value));
+        return new PropertyStateValue(PropertyStates.longProperty("", value));
     }
 
     @Nonnull
     public static PropertyValue newDouble(Double value) {
-        return new PropertyValue(PropertyStates.doubleProperty("", value));
+        return new PropertyStateValue(PropertyStates.doubleProperty("", value));
     }
 
     @Nonnull
     public static PropertyValue newDecimal(BigDecimal value) {
-        return new PropertyValue(PropertyStates.decimalProperty("", value));
+        return new PropertyStateValue(PropertyStates.decimalProperty("", value));
     }
 
     @Nonnull
     public static PropertyValue newBoolean(boolean value) {
-        return new PropertyValue(PropertyStates.booleanProperty("", value));
+        return new PropertyStateValue(PropertyStates.booleanProperty("", value));
     }
 
     @Nonnull
     public static PropertyValue newDate(String value) {
-        return new PropertyValue(PropertyStates.dateProperty("", value));
+        return new PropertyStateValue(PropertyStates.dateProperty("", value));
     }
 
     @Nonnull
     public static PropertyValue newName(String value) {
-        return new PropertyValue(PropertyStates.nameProperty("", value));
+        return new PropertyStateValue(PropertyStates.nameProperty("", value));
     }
 
     @Nonnull
     public static PropertyValue newPath(String value) {
-        return new PropertyValue(PropertyStates.pathProperty("", value));
+        return new PropertyStateValue(PropertyStates.pathProperty("", value));
     }
 
     @Nonnull
     public static PropertyValue newReference(String value) {
-        return new PropertyValue(PropertyStates.referenceProperty("", value));
+        return new PropertyStateValue(PropertyStates.referenceProperty("",
+                value));
     }
 
     @Nonnull
     public static PropertyValue newWeakReference(String value) {
-        return new PropertyValue(
-                PropertyStates.weakreferenceProperty("", value));
+        return new PropertyStateValue(PropertyStates.weakreferenceProperty("",
+                value));
     }
 
     @Nonnull
     public static PropertyValue newUri(String value) {
-        return new PropertyValue(PropertyStates.uriProperty("", value));
+        return new PropertyStateValue(PropertyStates.uriProperty("", value));
     }
 
     @Nonnull
     public static PropertyValue newBinary(byte[] value) {
-        return new PropertyValue(PropertyStates.binaryProperty("", value));
+        return new PropertyStateValue(PropertyStates.binaryProperty("", value));
     }
 
     // --
diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/value/ValueFactoryImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/value/ValueFactoryImpl.java
index c9643c00ed..32b3c50db2 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/value/ValueFactoryImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/value/ValueFactoryImpl.java
@@ -37,10 +37,12 @@ import com.google.common.collect.Lists;
 import org.apache.jackrabbit.oak.api.Blob;
 import org.apache.jackrabbit.oak.api.ContentSession;
 import org.apache.jackrabbit.oak.api.PropertyState;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.namepath.NamePathMapper;
 import org.apache.jackrabbit.oak.plugins.identifier.IdentifierManager;
 import org.apache.jackrabbit.oak.plugins.memory.PropertyStates;
 import org.apache.jackrabbit.oak.plugins.memory.StringPropertyState;
+import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.apache.jackrabbit.util.ISO8601;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -77,6 +79,18 @@ public class ValueFactoryImpl implements ValueFactory {
         return new ValueImpl(property, namePathMapper);
     }
 
+    /**
+     * Utility method for creating a {@code Value} based on a {@code PropertyValue}.
+     * @param property  The property value
+     * @param namePathMapper The name/path mapping used for converting JCR names/paths to
+     * the internal representation.
+     * @return  New {@code Value} instance
+     * @throws IllegalArgumentException if {@code property.isArray()} is {@code true}.
+     */
+    public static Value createValue(PropertyValue property, NamePathMapper namePathMapper) {
+        return new ValueImpl(PropertyValues.create(property), namePathMapper);
+    }
+
     /**
      * Utility method for creating {@code Value}s based on a {@code PropertyState}.
      * @param property  The property state
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/AbstractQueryTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/AbstractQueryTest.java
index a7cda24606..57593866f6 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/AbstractQueryTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/AbstractQueryTest.java
@@ -34,6 +34,7 @@ import java.util.Map;
 import org.apache.jackrabbit.JcrConstants;
 import org.apache.jackrabbit.oak.AbstractOakTest;
 import org.apache.jackrabbit.oak.api.ContentSession;
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.api.Result;
 import org.apache.jackrabbit.oak.api.ResultRow;
 import org.apache.jackrabbit.oak.api.Root;
@@ -42,7 +43,6 @@ import org.apache.jackrabbit.oak.api.Tree;
 import org.apache.jackrabbit.oak.api.Type;
 import org.apache.jackrabbit.oak.commons.PathUtils;
 import org.apache.jackrabbit.oak.plugins.index.IndexConstants;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.junit.Before;
 import org.junit.Ignore;
diff --git a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/FilterTest.java b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/FilterTest.java
index 94438a2150..3b354435f5 100644
--- a/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/FilterTest.java
+++ b/oak-core/src/test/java/org/apache/jackrabbit/oak/query/index/FilterTest.java
@@ -25,9 +25,9 @@ import static org.junit.Assert.fail;
 import java.util.ArrayList;
 import java.util.Random;
 
+import org.apache.jackrabbit.oak.api.PropertyValue;
 import org.apache.jackrabbit.oak.query.ast.Operator;
 import org.apache.jackrabbit.oak.spi.query.Filter;
-import org.apache.jackrabbit.oak.spi.query.PropertyValue;
 import org.apache.jackrabbit.oak.spi.query.PropertyValues;
 import org.junit.Test;
 
