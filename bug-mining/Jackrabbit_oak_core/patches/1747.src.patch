diff --git a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenConfigurationImpl.java b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenConfigurationImpl.java
index 10bb3f44bf..d65f255d54 100644
--- a/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenConfigurationImpl.java
+++ b/oak-core/src/main/java/org/apache/jackrabbit/oak/security/authentication/token/TokenConfigurationImpl.java
@@ -158,10 +158,13 @@ public class TokenConfigurationImpl extends ConfigurationBase implements TokenCo
     }
 
     private CredentialsSupport newCredentialsSupport() {
-        if (!credentialsSupport.isEmpty()) {
-            return CompositeCredentialsSupport.newInstance(() -> ImmutableSet.copyOf(credentialsSupport.values()));
-        } else {
+        int size = credentialsSupport.size();
+        if (size == 0) {
             return SimpleCredentialsSupport.getInstance();
+        } else if (size == 1) {
+            return credentialsSupport.values().iterator().next();
+        } else {
+            return CompositeCredentialsSupport.newInstance(() -> ImmutableSet.copyOf(credentialsSupport.values()));
         }
     }
 }
\ No newline at end of file
