{"url":"https://api.github.com/repos/mvdan/gofumpt/issues/135","repository_url":"https://api.github.com/repos/mvdan/gofumpt","labels_url":"https://api.github.com/repos/mvdan/gofumpt/issues/135/labels{/name}","comments_url":"https://api.github.com/repos/mvdan/gofumpt/issues/135/comments","events_url":"https://api.github.com/repos/mvdan/gofumpt/issues/135/events","html_url":"https://github.com/mvdan/gofumpt/issues/135","id":950170820,"node_id":"MDU6SXNzdWU5NTAxNzA4MjA=","number":135,"title":"document \"reserved standard library\" module paths","user":{"login":"twmb","id":1283109,"node_id":"MDQ6VXNlcjEyODMxMDk=","avatar_url":"https://avatars.githubusercontent.com/u/1283109?v=4","gravatar_id":"","url":"https://api.github.com/users/twmb","html_url":"https://github.com/twmb","followers_url":"https://api.github.com/users/twmb/followers","following_url":"https://api.github.com/users/twmb/following{/other_user}","gists_url":"https://api.github.com/users/twmb/gists{/gist_id}","starred_url":"https://api.github.com/users/twmb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twmb/subscriptions","organizations_url":"https://api.github.com/users/twmb/orgs","repos_url":"https://api.github.com/users/twmb/repos","events_url":"https://api.github.com/users/twmb/events{/privacy}","received_events_url":"https://api.github.com/users/twmb/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2021-07-21T23:02:55Z","updated_at":"2022-02-05T23:44:26Z","closed_at":"2021-09-08T15:55:23Z","author_association":"NONE","active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"If I have the following directory structure:\r\n\r\n```\r\ngo.mod\r\nmain.go\r\npkg/thing/thing.go\r\n```\r\n\r\nwith the following file contents:\r\n\r\ngo.mod:\r\n```go\r\nmodule foo\r\n\r\ngo 1.16\r\n```\r\n\r\nmain.go:\r\n```go\r\npackage main\r\n\r\nimport (\r\n\t\"fmt\"\r\n\r\n\t\"foo/pkg/thing\"\r\n)\r\n\r\nfunc main() {\r\n\tfmt.Println(\"hello\")\r\n\tthing.Print()\r\n}\r\n```\r\n\r\npkg/thing/thing.go:\r\n```go\r\npackage thing\r\n\r\nfunc Print() {\r\n\tprintln(\"foo\")\r\n}\r\n```\r\n\r\nThen gofumpt will change main.go's import block such that the foo/pkg/thing import is tied to the stdlib fmt import.\r\n\r\nI think this is only possible to detect with the current gofumpt implementation if gofumpt reads the go.mod file to know what module it is in. If `import == module || strings.HasPrefix(import, module + \"/\")`, then the import is non-standard. I do not see a way to have this same logic if just relying on the ast. Another potential option is to just have a list of stdlib imports, but this obviously is not future proof for when the stdlib adds new modules (a user would have to update gofumpt, which also would then have the obligation of staying up to date with Go releases).\r\n\r\n","closed_by":{"login":"mvdan","id":3576549,"node_id":"MDQ6VXNlcjM1NzY1NDk=","avatar_url":"https://avatars.githubusercontent.com/u/3576549?v=4","gravatar_id":"","url":"https://api.github.com/users/mvdan","html_url":"https://github.com/mvdan","followers_url":"https://api.github.com/users/mvdan/followers","following_url":"https://api.github.com/users/mvdan/following{/other_user}","gists_url":"https://api.github.com/users/mvdan/gists{/gist_id}","starred_url":"https://api.github.com/users/mvdan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mvdan/subscriptions","organizations_url":"https://api.github.com/users/mvdan/orgs","repos_url":"https://api.github.com/users/mvdan/repos","events_url":"https://api.github.com/users/mvdan/events{/privacy}","received_events_url":"https://api.github.com/users/mvdan/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/mvdan/gofumpt/issues/135/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/mvdan/gofumpt/issues/135/timeline","performed_via_github_app":null,"state_reason":"completed"}