diff --git a/internal/gofumpt.go b/internal/gofumpt.go
index abc99da..bc0f099 100644
--- a/internal/gofumpt.go
+++ b/internal/gofumpt.go
@@ -464,6 +464,7 @@ func (f *fumpter) joinStdImports(d *ast.GenDecl) {
 	var std, other []ast.Spec
 	firstGroup := true
 	lastLine := 0
+	needsSort := false
 	for i, spec := range d.Specs {
 		spec := spec.(*ast.ImportSpec)
 		if i > 0 && firstGroup && f.Line(spec.Pos()) > lastLine+1 {
@@ -492,15 +493,27 @@ func (f *fumpter) joinStdImports(d *ast.GenDecl) {
 		// position, to avoid breaking comments.
 		if !firstGroup {
 			setPos(reflect.ValueOf(spec), d.Pos())
+			needsSort = true
 		}
 		std = append(std, spec)
 	}
 	// Ensure there is an empty line between std imports and other imports.
 	if len(std) > 0 && len(other) > 0 && f.Line(std[len(std)-1].End())+1 >= f.Line(other[0].Pos()) {
+		// We add two newlines, as that's necessary in some edge cases.
+		// For example, if the std and non-std imports were together and
+		// without indentation, adding one newline isn't enough. Two
+		// empty lines will be printed as one by go/printer, anyway.
+		f.addNewline(other[0].Pos() - 1)
 		f.addNewline(other[0].Pos())
 	}
 	// Finally, join the imports, keeping std at the top.
 	d.Specs = append(std, other...)
+
+	// If we moved any std imports to the first group, we need to sort them
+	// again.
+	if needsSort {
+		ast.SortImports(f.fset, f.astFile)
+	}
 }
 
 var posType = reflect.TypeOf(token.NoPos)
diff --git a/testdata/scripts/block-empty.txt b/testdata/scripts/block-empty.txt
index 5b92ebc..87c0ae9 100644
--- a/testdata/scripts/block-empty.txt
+++ b/testdata/scripts/block-empty.txt
@@ -1,4 +1,4 @@
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
diff --git a/testdata/scripts/block-single.txt b/testdata/scripts/block-single.txt
index 6c51624..d23d0f7 100644
--- a/testdata/scripts/block-single.txt
+++ b/testdata/scripts/block-single.txt
@@ -1,4 +1,4 @@
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
diff --git a/testdata/scripts/comment-spaced.txt b/testdata/scripts/comment-spaced.txt
index 92f1fe4..7c44f74 100644
--- a/testdata/scripts/comment-spaced.txt
+++ b/testdata/scripts/comment-spaced.txt
@@ -1,4 +1,4 @@
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
diff --git a/testdata/scripts/composite-multiline.txt b/testdata/scripts/composite-multiline.txt
index 3c2087d..688dac9 100644
--- a/testdata/scripts/composite-multiline.txt
+++ b/testdata/scripts/composite-multiline.txt
@@ -1,4 +1,4 @@
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
diff --git a/testdata/scripts/decl-group-many.txt b/testdata/scripts/decl-group-many.txt
index 586c5b4..098e272 100644
--- a/testdata/scripts/decl-group-many.txt
+++ b/testdata/scripts/decl-group-many.txt
@@ -1,6 +1,6 @@
 [gofumports] skip 'would remove the unused imports'
 
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
diff --git a/testdata/scripts/decls-separated.txt b/testdata/scripts/decls-separated.txt
index 926023c..c405c30 100644
--- a/testdata/scripts/decls-separated.txt
+++ b/testdata/scripts/decls-separated.txt
@@ -1,4 +1,4 @@
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
diff --git a/testdata/scripts/func-newlines.txt b/testdata/scripts/func-newlines.txt
index 322084b..fed7bdf 100644
--- a/testdata/scripts/func-newlines.txt
+++ b/testdata/scripts/func-newlines.txt
@@ -1,4 +1,4 @@
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
diff --git a/testdata/scripts/missing-import.txt b/testdata/scripts/missing-import.txt
index 50c010a..614fe69 100644
--- a/testdata/scripts/missing-import.txt
+++ b/testdata/scripts/missing-import.txt
@@ -1,4 +1,4 @@
-gofumpt -w foo.go .
+gofumpt -w .
 [gofumpt] cmp foo.go foo.go.gofumpt
 [gofumports] cmp foo.go foo.go.gofumports
 
diff --git a/testdata/scripts/newline-errcheck.txt b/testdata/scripts/newline-errcheck.txt
index 4f96b3f..200f6d2 100644
--- a/testdata/scripts/newline-errcheck.txt
+++ b/testdata/scripts/newline-errcheck.txt
@@ -1,4 +1,4 @@
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
diff --git a/testdata/scripts/short-case.txt b/testdata/scripts/short-case.txt
index 5b8c430..19cb9ef 100644
--- a/testdata/scripts/short-case.txt
+++ b/testdata/scripts/short-case.txt
@@ -1,4 +1,4 @@
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
diff --git a/testdata/scripts/short-decl.txt b/testdata/scripts/short-decl.txt
index 57e5032..24d7e2d 100644
--- a/testdata/scripts/short-decl.txt
+++ b/testdata/scripts/short-decl.txt
@@ -1,4 +1,4 @@
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
diff --git a/testdata/scripts/std-imports.txt b/testdata/scripts/std-imports.txt
index 6234a5e..061220f 100644
--- a/testdata/scripts/std-imports.txt
+++ b/testdata/scripts/std-imports.txt
@@ -1,6 +1,6 @@
 [gofumports] skip 'don''t add or remove imports'
 
-gofumpt -w foo.go .
+gofumpt -w .
 cmp foo.go foo.go.golden
 
 -- foo.go --
