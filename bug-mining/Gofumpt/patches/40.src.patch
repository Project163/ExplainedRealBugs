diff --git a/format/format.go b/format/format.go
index f11633c..30dc37c 100644
--- a/format/format.go
+++ b/format/format.go
@@ -62,10 +62,23 @@ func Source(src []byte, opts Options) ([]byte, error) {
 	return buf.Bytes(), nil
 }
 
+var rxCodeGenerated = regexp.MustCompile(`^// Code generated .* DO NOT EDIT\.$`)
+
 // File modifies a file and fset in place to follow gofumpt's format. The
 // changes might include manipulating adding or removing newlines in fset,
 // modifying the position of nodes, or modifying literal values.
 func File(fset *token.FileSet, file *ast.File, opts Options) {
+	for _, cg := range file.Comments {
+		if cg.Pos() > file.Package {
+			break
+		}
+		for _, line := range cg.List {
+			if rxCodeGenerated.MatchString(line.Text) {
+				return
+			}
+		}
+	}
+
 	if opts.LangVersion == "" {
 		opts.LangVersion = "v1"
 	} else if opts.LangVersion[0] != 'v' {
diff --git a/testdata/scripts/generated.txt b/testdata/scripts/generated.txt
new file mode 100644
index 0000000..1b40ad9
--- /dev/null
+++ b/testdata/scripts/generated.txt
@@ -0,0 +1,27 @@
+cp foo.go foo.go.orig
+cp foo.go foo.go.golden
+exec gofmt -w foo.go.golden
+
+gofumpt -w foo.go
+cmp foo.go foo.go.golden
+
+cp foo.go.orig foo.go
+gofumpt -w .
+cmp foo.go foo.go.golden
+
+-- foo.go --
+// foo is a package about bar.
+
+// Code generated by foo. DO NOT EDIT.
+// versions:
+// 	foo v1.26.0
+package foo
+
+type i interface {
+
+	a(x int) int
+
+	b(x int) int
+
+	c(x int) int
+}
