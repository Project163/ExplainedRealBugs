diff --git a/gofmt.go b/gofmt.go
index 5e8fcec..1a9841b 100644
--- a/gofmt.go
+++ b/gofmt.go
@@ -297,6 +297,11 @@ func processFile(filename string, info fs.FileInfo, in io.Reader, r *reporter, e
 		mod, ok := moduleCacheByDir.Load(dir)
 		if ok && mod != nil {
 			mod := mod.(*module)
+			if mod.Go == "" {
+				// If the go directive is missing, go 1.16 is assumed.
+				// https://go.dev/ref/mod#go-mod-file-go
+				mod.Go = "1.16"
+			}
 			if lang == "" {
 				lang = "go" + mod.Go
 			}
diff --git a/testdata/script/gomod.txtar b/testdata/script/gomod.txtar
index e3c0258..e6bde48 100644
--- a/testdata/script/gomod.txtar
+++ b/testdata/script/gomod.txtar
@@ -6,6 +6,9 @@ stdout '//gofumpt:diagnose.* -lang=go1.21'
 exec gofumpt toolchain-unstable/a.go
 stdout '//gofumpt:diagnose.* -lang=go1.21'
 
+exec gofumpt missing-go-directive/a.go
+stdout '//gofumpt:diagnose.* -lang=go1.16'
+
 -- toolchain-stable/go.mod --
 module a
 
@@ -23,3 +26,11 @@ go 1.21rc3
 package a
 
 //gofumpt:diagnose
+
+-- missing-go-directive/go.mod --
+module a
+
+-- missing-go-directive/a.go --
+package a
+
+//gofumpt:diagnose
