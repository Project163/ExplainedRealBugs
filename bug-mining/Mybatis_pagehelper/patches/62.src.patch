diff --git a/src/main/java/com/github/pagehelper/parser/CountSqlParser.java b/src/main/java/com/github/pagehelper/parser/CountSqlParser.java
index d41cb85..be32000 100644
--- a/src/main/java/com/github/pagehelper/parser/CountSqlParser.java
+++ b/src/main/java/com/github/pagehelper/parser/CountSqlParser.java
@@ -28,6 +28,7 @@ import com.github.pagehelper.util.StringUtil;
 import net.sf.jsqlparser.expression.Alias;
 import net.sf.jsqlparser.expression.Expression;
 import net.sf.jsqlparser.expression.Function;
+import net.sf.jsqlparser.expression.Parenthesis;
 import net.sf.jsqlparser.parser.CCJSqlParserUtil;
 import net.sf.jsqlparser.schema.Column;
 import net.sf.jsqlparser.statement.Statement;
@@ -263,6 +264,10 @@ public class CountSqlParser {
         if (select.getDistinct() != null) {
             return false;
         }
+        //#606,包含having时不可以
+        if (select.getHaving() != null) {
+            return false;
+        }
         for (SelectItem item : select.getSelectItems()) {
             //select列中包含参数的时候不可以，否则会引起参数个数错误
             if (item.toString().contains("?")) {
@@ -281,7 +286,7 @@ public class CountSqlParser {
                             return false;
                         } else {
                             for (String aggregateFunction : AGGREGATE_FUNCTIONS) {
-                                if(NAME.startsWith(aggregateFunction)){
+                                if (NAME.startsWith(aggregateFunction)) {
                                     falseFunctions.add(NAME);
                                     return false;
                                 }
@@ -289,6 +294,10 @@ public class CountSqlParser {
                             skipFunctions.add(NAME);
                         }
                     }
+                } else if (expression instanceof Parenthesis && ((SelectExpressionItem) item).getAlias() != null) {
+                    //#555，当存在 (a+b) as c 时，c 如果出现了 order by 或者 having 中时，会找不到对应的列，
+                    // 这里想要更智能，需要在整个SQL中查找别名出现的位置，暂时不考虑，直接排除
+                    return false;
                 }
             }
         }
diff --git a/src/test/java/com/github/pagehelper/sql/SqlTest.java b/src/test/java/com/github/pagehelper/sql/SqlTest.java
index d3dd9d0..7d16e44 100644
--- a/src/test/java/com/github/pagehelper/sql/SqlTest.java
+++ b/src/test/java/com/github/pagehelper/sql/SqlTest.java
@@ -170,4 +170,14 @@ public class SqlTest {
         CountSqlParser countSqlParser = new CountSqlParser();
         System.out.println(countSqlParser.getSmartCountSql("SELECT (a.column1+a.column2) as popCount  FROM peaf_staff AS a ORDER BY FIELD(a.`store_id`, ?, ?), popCount DESC\n"));
     }
+
+    @Test
+    public void testSql606() throws JSQLParserException {
+        CountSqlParser countSqlParser = new CountSqlParser();
+        System.out.println(countSqlParser.getSmartCountSql("select\n" +
+            "(SELECT COUNT(1) FROM test1 WHERE test1.id = test.test1_id )as successCount ,\n" +
+            "(SELECT COUNT(1) FROM test1 ) as Total\n" +
+            "from test\n" +
+            "Having successCount = Total"));
+    }
 }
