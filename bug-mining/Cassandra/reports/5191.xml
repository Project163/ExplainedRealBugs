<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:13:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-15120] Nodes that join the ring while another node is MOVING build an invalid view of the token ring</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-15120</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Gossip only updates the token metadata for nodes in the NORMAL, SHUTDOWN or LEAVING* statuses. &#160;MOVING and REMOVING_TOKEN nodes do not have their ring information updated (nor do others, but these other states &lt;em&gt;should&lt;/em&gt; only be taken by nodes that are not members of the ring). &#160;&lt;/p&gt;

&lt;p&gt;If a node missed the most recent token-modifying events because they were not a member of the ring when they happened (or because Gossip was delayed to them), they will retain an invalid view of the ring until the node enters the one of the NORMAL, SHUTDOWN or LEAVING states.&lt;/p&gt;

&lt;p&gt;*LEAVING is populated differently, however, and in a probably unsafe manner that this work will also address.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13232031">CASSANDRA-15120</key>
            <summary>Nodes that join the ring while another node is MOVING build an invalid view of the token ring</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="benedict">Benedict Elliott Smith</assignee>
                                    <reporter username="benedict">Benedict Elliott Smith</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 May 2019 14:32:08 +0000</created>
                <updated>Fri, 15 May 2020 08:00:17 +0000</updated>
                            <resolved>Mon, 3 Jun 2019 15:07:21 +0000</resolved>
                                        <fixVersion>3.0.19</fixVersion>
                    <fixVersion>3.11.5</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Cluster/Gossip</component>
                    <component>Cluster/Membership</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16834825" author="benedict" created="Tue, 7 May 2019 14:44:16 +0000"  >&lt;p&gt;An initial patch is available &lt;a href=&quot;https://github.com/belliottsmith/cassandra/tree/15120-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&#160;for 3.0.  Some work is needed still to support switching the in-jvm dtest behaviour to disable/enable gossip and networking, as well as to port this capability to other versions of the dtests.&lt;/p&gt;

&lt;p&gt;Since this work touches gossip, while the patch appears simple we need to take a great deal of care.  I have attempted to verify the state transitions that may precede one of these presently broken events, so that I have confidence the patch does not degrade gossip&apos;s correctness, but this can only be a best effort without a significant investment in evaluating the correctness of gossip more holistically.  I also intend to do another round of analysis before we commit the patch.&lt;/p&gt;</comment>
                            <comment id="16839636" author="beobal" created="Tue, 14 May 2019 17:26:22 +0000"  >&lt;p&gt;I share your concerns around making changes to this area in 3.0, but I&apos;ve spent some time working through this and I believe that this change is correct. I haven&apos;t really looked at any of non-test changes made to support gossip/networking in the tests yet, but I&apos;ll make another pass at it when you&apos;re done with those.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16840344" author="benedict" created="Wed, 15 May 2019 12:20:14 +0000"  >&lt;p&gt;Ok, I&apos;ve pushed a version with feature flags introduced to the dtests, so that gossip is only enabled for those tests that need it.  Once you confirm it looks OK to you, I&apos;ll port it to the other versions (though I may defer &lt;em&gt;implementation&lt;/em&gt; of this capability on trunk until after &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15066&quot; title=&quot;Improvements to Internode Messaging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15066&quot;&gt;&lt;del&gt;CASSANDRA-15066&lt;/del&gt;&lt;/a&gt;, which already implements a lot of this)&lt;/p&gt;</comment>
                            <comment id="16844940" author="beobal" created="Tue, 21 May 2019 15:18:14 +0000"  >&lt;p&gt;So everything looks reasonable to me, except for the changes to &lt;tt&gt;MessagingService::listen&lt;/tt&gt;. I presume these were not intended to be left in the patch, and it seems to work fine with them reverted.&lt;/p&gt;

&lt;p&gt;Nit: the comment on &lt;tt&gt;SEPW&lt;/tt&gt; line 112 is no longer 100% correct as it isn&apos;t explicitly concerned about the shutdown state of the &lt;tt&gt;SEPE&lt;/tt&gt; any more.&lt;/p&gt;

&lt;p&gt;Also, it isn&apos;t new but the logging in the catch block of &lt;tt&gt;SEPW::run&lt;/tt&gt; may not happen depending on the stability inspector.&lt;/p&gt;</comment>
                            <comment id="16854690" author="beobal" created="Mon, 3 Jun 2019 15:07:21 +0000"  >&lt;p&gt;Committed to 3.0 in &lt;tt&gt;e4b5d9818f003be2b9091c48f8435d29202ffe2d&lt;/tt&gt; and merged to 3.11 and trunk. The trunk version does not include the dtest, as much of the plumbing to support that is going to land in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15066&quot; title=&quot;Improvements to Internode Messaging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15066&quot;&gt;&lt;del&gt;CASSANDRA-15066&lt;/del&gt;&lt;/a&gt;. The change to 3.0 also breaks backward compatibility of the cross version dtests with 2.2. &lt;/p&gt;

&lt;p&gt;There are a couple of unrelated, but new-ish test failures.&lt;br/&gt;
In the unit tests, &lt;tt&gt;RowFilterTest&lt;/tt&gt;, which was recently added for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15126&quot; title=&quot;Resource leak when queries apply a RowFilter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15126&quot;&gt;&lt;del&gt;CASSANDRA-15126&lt;/del&gt;&lt;/a&gt;, appears to be failing on 3.11 only. &lt;br/&gt;
In the dtests, &lt;tt&gt;jmx_auth_test.TestJMXAuth.test_basic_auth&lt;/tt&gt; looks like it was broken by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-14305&quot; title=&quot;Use $CASSANDRA_CONF not $CASSANDRA_HOME/conf in cassandra-env.sh &quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-14305&quot;&gt;&lt;del&gt;CASSANDRA-14305&lt;/del&gt;&lt;/a&gt;. &lt;br/&gt;
I&apos;ll follow up all of these separately.&lt;/p&gt;</comment>
                            <comment id="16854730" author="beobal" created="Mon, 3 Jun 2019 15:40:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;The trunk version does not include the dtest, as much of the plumbing to support that is going to land in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15066&quot; title=&quot;Improvements to Internode Messaging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15066&quot;&gt;&lt;del&gt;CASSANDRA-15066&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15148&quot; title=&quot;Add in-jvm dtest for Gossip to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15148&quot;&gt;&lt;del&gt;CASSANDRA-15148&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The change to 3.0 also breaks backward compatibility of the cross version dtests with 2.2.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15147&quot; title=&quot;Backport in-jvm dtest feature flags to 2.2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15147&quot;&gt;CASSANDRA-15147&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;In the unit tests, RowFilterTest, which was recently added for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15126&quot; title=&quot;Resource leak when queries apply a RowFilter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15126&quot;&gt;&lt;del&gt;CASSANDRA-15126&lt;/del&gt;&lt;/a&gt;, appears to be failing on 3.11 only. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ninja&apos;d a fix in &lt;a href=&quot;https://github.com/apache/cassandra/commit/7f4ecb01247088e27ff2ae15aa5375805bada53a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;7f4ecb0&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[benedict]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12989" cascade-level="1"><![CDATA[Consistency]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12966"><![CDATA[Challenging]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 24 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02guo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333891">3.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/e4b5d9818f003be2b9091c48f8435d29202ffe2d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/e4b5d9818f003be2b9091c48f8435d29202ffe2d&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;regression test&#160;included&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>