<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:24:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-17571] Config upper bound should be handled earlier</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-17571</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Config upper bound should be handled on startup/config setup and not during conversion&lt;/p&gt;</description>
                <environment></environment>
        <key id="13440951">CASSANDRA-17571</key>
            <summary>Config upper bound should be handled earlier</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="edimitrova">Ekaterina Dimitrova</assignee>
                                    <reporter username="edimitrova">Ekaterina Dimitrova</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Apr 2022 15:11:17 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:58 +0000</updated>
                            <resolved>Fri, 20 May 2022 19:42:35 +0000</resolved>
                                        <fixVersion>4.1-alpha1</fixVersion>
                    <fixVersion>4.1</fixVersion>
                                    <component>Local/Config</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17525782" author="edimitrova" created="Thu, 21 Apr 2022 15:19:04 +0000"  >&lt;p&gt;Marking as 4.1 block as there was a discussion to add extended classes for Int to handle old int parameters upper bound and changing those in Config will be considered breaking change after a release. CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;&#160;and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;I will push the suggested classes in the next few hours for approval before moving any config to them.&#160;&lt;/p&gt;</comment>
                            <comment id="17526150" author="edimitrova" created="Fri, 22 Apr 2022 01:50:58 +0000"  >&lt;p&gt;Prototype in this &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/1ab9f32ef34402a0f74036d768a22449170052b6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;commit &lt;/a&gt; - only a few parameters were migrated for test purposes and to see how it will look like.&lt;br/&gt;
Also, I will split in separate commits the parameters in groups on migration with attached tests to them and CI to be sure gradually nothing Is missed but I want to confirm that the approach is still what we want. CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&#160;in case he has time to provide input.&lt;/p&gt;

&lt;p&gt;Currently if people provide the new config with the new format we handle the former int parameters by returning cast value from their getters, &#160;but on startup the user might set a bigger long value and think wrongly that one will be used when in practice the Integer.MAX_VALUE will be used. We need just to fail the user they can&apos;t set that big value, mimic the behavior of when they provide old value bigger than int. We also limit with these classes that people cannot set anything that will overflow during conversion to the smallest allowed unit instead of setting MAX_VALUE silently.&#160;&lt;/p&gt;</comment>
                            <comment id="17527229" author="edimitrova" created="Sun, 24 Apr 2022 18:00:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&#160;is anyone of you available to confirm &#160;the drafted prototype and do review this week or should I ask anyone else from the community if you won&apos;t have time?&#160;&lt;/p&gt;</comment>
                            <comment id="17527572" author="maedhroz" created="Mon, 25 Apr 2022 15:32:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; I&apos;ll take a look at the prototype today or tomorrow.&lt;/p&gt;</comment>
                            <comment id="17528372" author="edimitrova" created="Tue, 26 Apr 2022 19:29:08 +0000"  >&lt;p&gt;Thanks, looking forward for your feedback. I am on standby ready to incorporate any feedback and move the former int config to the extended classes before the 1st is here. Unfortunately, it will become noisy but it should be quick type change, using the old methods.&#160;&lt;/p&gt;</comment>
                            <comment id="17528472" author="edimitrova" created="Wed, 27 Apr 2022 01:24:42 +0000"  >&lt;p&gt;I spent my evening again thinking about this as really those extensions become convoluted but I don&apos;t see a better way at this point.&#160;&lt;/p&gt;

&lt;p&gt;Like I can get back validation utility methods in the DD and leave considering better general handling with next version but this is error-prone.&#160;&lt;/p&gt;

&lt;p&gt;Creating a new range max annotation to all new properties in Config is not really easy option as we would need conversions... The best is to do it in the constructors at this point.&#160;&lt;/p&gt;

&lt;p&gt;I will sleep on it and finish tomorrow morning. In case someone has something better in the meantime - I am open to hear it.&#160;&lt;/p&gt;</comment>
                            <comment id="17528475" author="edimitrova" created="Wed, 27 Apr 2022 01:35:07 +0000"  >&lt;p&gt;On the bright side, this is not a regression as we handle the old config input types in Converters(former ints cannot be set long value) so in my humble opinion even if we fix the new config upper bound after the freeze on the 1st, this is not a regression we have here and no API change will be involved. &#160;I don&apos;t plan too prolong it but if we want more time to shape the solution a bit or for final review - I think we have it. CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;&#160;in case he disagrees with this statement&lt;/p&gt;</comment>
                            <comment id="17528792" author="edimitrova" created="Wed, 27 Apr 2022 13:33:53 +0000"  >&lt;p&gt;Working to migrate the parameters to the extended classes so we can do upper bound (former int type Config parameters and overflow of big value bigger unit to smaller supported internally) checks in the constructors. Might be not most beautiful but at least we will be more consistent and less error-prone then utility methods in the DD.&#160;&lt;/p&gt;</comment>
                            <comment id="17529705" author="edimitrova" created="Fri, 29 Apr 2022 00:46:47 +0000"  >&lt;p&gt;WIP:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/new/17571-trunk-rebased&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ekaterinadimitrova2/cassandra/pull/new/17571-trunk-rebased&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Intermediate CI runs:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1569/workflows/f67be620-844b-4151-9cd9-e7b16b9e0578&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1569/workflows/f67be620-844b-4151-9cd9-e7b16b9e0578&lt;/a&gt;&#160;- the DD test was fixed after that but didn&apos;t rerun the whole suite only for it...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1570/workflows/a8f6c673-a5e6-4986-8077-e2955d6ab949&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1570/workflows/a8f6c673-a5e6-4986-8077-e2955d6ab949&lt;/a&gt; &#8211;&amp;gt; I probably need to loop the test before and after the patch, known to be flaky but just to ensure frequency and errors match&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1571/workflows/90ef96bd-daa8-4a65-8915-d3ca746bd10d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1571/workflows/90ef96bd-daa8-4a65-8915-d3ca746bd10d&lt;/a&gt;&#160;- known failures&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;So the biggest part is done. I need to verify that ConnectionTest, that I didn&apos;t contribute in a way for more flakiness but I doubt it.&#160;&lt;/p&gt;

&lt;p&gt;Other ToDos - there are two former int parameters unreleased that were directly switched to the new types, I have them ready locally, need to double check and commit.&lt;/p&gt;

&lt;p&gt;News.txt, CHANGES.txt and docs need update; also JavaDoc. I had in ToDo to move the *AsInt methods from the parent classes to the extensions but I am not sure I will have to. I will check tomorrow morning and push for final review.&lt;/p&gt;

&lt;p&gt;AND full CI. I was testing now just J11 midres, but I will push at the end both J8 and J11, all tests&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17535063" author="edimitrova" created="Wed, 11 May 2022 18:43:23 +0000"  >&lt;p&gt;For the record, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&#160;suggested nested classes as we might need also other numeric types in the future and that refactoring will help us to maintain the types easily. Also, the code shrinks nicely and all upper bound validations will be in the constructors.&lt;/p&gt;

&lt;p&gt;I will post the final version for review later today.&lt;/p&gt;</comment>
                            <comment id="17535879" author="edimitrova" created="Thu, 12 May 2022 05:38:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-4.1...ekaterinadimitrova2:17571-squashed&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1 patch&lt;/a&gt;| &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=17571-squashed&amp;amp;filter=all&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI&lt;/a&gt;&#160;| &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/199&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I will update the docs when we confirm the details during review.&#160;&lt;/p&gt;</comment>
                            <comment id="17536794" author="maedhroz" created="Fri, 13 May 2022 17:53:03 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17537881" author="edimitrova" created="Tue, 17 May 2022 02:27:22 +0000"  >&lt;p&gt;Thanks, I just addressed the review comments and &#160;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=review&amp;amp;filter=all&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ran CI&lt;/a&gt; on 4.1. 2 known failures and 2 unit tests that I have missed to update. Added to the PR a fix now.&lt;/p&gt;

&lt;p&gt;A few things to mention here:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I also updated the docs plus added min unit in cassandra.yaml for the properties where it made sense. What I mean - if a property default value is in B in the yaml, it is obvious we can set all units, so it didn&apos;t make sense to me to pollute the yaml for those properties.&lt;/li&gt;
	&lt;li&gt;Worth to mention here that now all three main classes (DataRateSpec, DurationSpec, DataStorageSpec) are abstract and people should use the extended classes which are now tested. I added a test to validate Config types, that people didn&apos;t use as type abstract class with constructor of a nested class. This will compile fine and if no value is set in cassandra.yaml, everything will be fine, BUT if someone adds a value in the yaml - then Cassandra won&apos;t start because SnakeYAML will want to use abstract class constructor. &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/199/files#diff-392bbe6df967db1b9b2c70cb97bbd84779fa847b11573ed11ca601578ebf2936R48-R59&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;The test&lt;/a&gt; I added checks that no parameter has as a type any of the three abstract classes to prevent us from future bugs. In that sense, paxos_purge_grace_period is fixed now as the author has done the mistake I mentioned originally. (using the main class and because the main classes were not abstract this was even worse as de facto the smallest Duration unit was set to nanoseconds).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The patch is noisy because a big part of it is moving things around and renaming of the classes, the actual code is 200-300 lines of code.&#160;&lt;/p&gt;</comment>
                            <comment id="17538537" author="edimitrova" created="Wed, 18 May 2022 01:40:10 +0000"  >&lt;p&gt;I addressed review comments from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;. New CI run &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=review-2&amp;amp;filter=all&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. There is one issue with DTest which is kind of weird and I will have to investigate it but other community members confirmed they&apos;ve seen it too so it is not this patch. Might be even environmental. Also, one of the CQLSH run tests failed because of timeout during test docker image being pulled so it was not the patch.&#160;&lt;/p&gt;

&lt;p&gt;Also, for the record, based on offline discussion, we limited the conversions in the nested classes to only to the base internal min unit. This actually led me to discover a new parameter added which was converting to other units internally and probably relying on cassandra.yaml for the precision (there was a note on allowed units in cassandra.yaml without actually ensuring a lower unit was not provided by the user). I think this is a bug and I fixed it by making auto_snapshot_ttl internally in seconds as we have SNAPSHOT_MIN_ALLOWED_TTL_SECONDS.&lt;/p&gt;

&lt;p&gt;This led to this &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/199/files#diff-20db300621aef19985cb1752835ab00d37ed18a4abc23e3b67c769633d41a9a6L61&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;change&lt;/a&gt;. Please let me know if you agree with this and I will update also cassandra.yaml. I think the other option based on the yaml is to do it minutes but then I guess we need to change also SNAPSHOT_MIN_ALLOWED_TTL_SECONDS and we are already in code freeze so I think setting min unit seconds is a good compromise. Considering we didn&apos;t announce in the yaml accepted units less than minutes for that property I do not consider this change a breaking one. More like preventive and fixing internally a possible precision issue/bug.&#160;&lt;/p&gt;

&lt;p&gt;&lt;del&gt;The story of this property is that it was added during Google Summer of Code with a WIP version of my DurationSpec class. When it came the time for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15234&quot; title=&quot;Standardise config and JVM parameters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15234&quot;&gt;&lt;del&gt;CASSANDRA-15234&lt;/del&gt;&lt;/a&gt; we changed the name of the class. Then I asked the mentors to check the property if there are any concerns and it seems they missed the point for precision described in the docs.&lt;/del&gt; So long story short - thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&#160;for suggesting to tighten even more these classes! It is definitely worth it as a preventive action!&lt;/p&gt;

&lt;p&gt;EDIT: It was introduced in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16790&quot; title=&quot;Add auto_snapshot_ttl configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16790&quot;&gt;&lt;del&gt;CASSANDRA-16790&lt;/del&gt;&lt;/a&gt; just before the freeze, mixed it with another one.&#160;&lt;/p&gt;</comment>
                            <comment id="17538776" author="adelapena" created="Wed, 18 May 2022 12:01:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; I see that the conversion methods in&#160;&lt;tt&gt;DataStorageSpec&lt;/tt&gt; &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/blob/f2d56d54bf62f18e8daea7736639119c3fe1b89a/src/java/org/apache/cassandra/config/DataStorageSpec.java#L137-L189&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;are still present&lt;/a&gt;, and the leaf classes override them.&lt;/p&gt;

&lt;p&gt;Also, if we are going to move the conversion methods to the leaf classes, we can probably get rid of the &lt;tt&gt;to*AsInt&lt;/tt&gt; methods, and instead have, for example:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A &lt;tt&gt;DataStorageSpec.LongMebibytesBound#toMebibytes&lt;/tt&gt; that returns &lt;tt&gt;long&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;A &lt;tt&gt;DataStorageSpec.IntMebibytesBound#toMebibytes&lt;/tt&gt; that returns &lt;tt&gt;int&lt;/tt&gt;.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;That would be possible because we don&apos;t have a common inherited &lt;tt&gt;DataStorageSpec#toMebibytes&lt;/tt&gt; anymore. I gave it a quick try in &lt;a href=&quot;https://github.com/adelapena/cassandra/commit/a7485d88a434dc321a60a006d4f36b294a139d49&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this commit&lt;/a&gt;, which is just a sketch to show how it would look like.&lt;/p&gt;</comment>
                            <comment id="17538911" author="edimitrova" created="Wed, 18 May 2022 15:33:16 +0000"  >&lt;blockquote&gt;&lt;blockquote&gt;&lt;p&gt;&#160;the conversion methods in&#160;&lt;tt&gt;DataStorageSpec&lt;/tt&gt; &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/blob/f2d56d54bf62f18e8daea7736639119c3fe1b89a/src/java/org/apache/cassandra/config/DataStorageSpec.java#L137-L189&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;are still present&lt;/a&gt;, and the leaf classes override them.&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;I knew it this green CI hides something &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;Totally not meant to keep them. I will work it out, thanks.&#160;&lt;/p&gt;

&lt;p&gt;The commit looks good to me&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17539109" author="edimitrova" created="Wed, 18 May 2022 22:04:30 +0000"  >&lt;p&gt;Rebased and addressed your feedback and fixed a few nits I noticed.&lt;/p&gt;

&lt;p&gt;There are a few warnings in the new types tests around equals but I don&apos;t think we should do any changes there. Maybe those assertions can be removed, they prove 5s are 5s no matter what. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17539588" author="edimitrova" created="Thu, 19 May 2022 14:38:55 +0000"  >&lt;p&gt;Rebased and pushed the latest round of feedback being addressed.&#160;&lt;/p&gt;</comment>
                            <comment id="17540196" author="edimitrova" created="Fri, 20 May 2022 16:10:16 +0000"  >&lt;p&gt;Rebased &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/new/17571-final&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&#160; in a new branch to preserve the unsquashed version for reference.&lt;/p&gt;

&lt;p&gt;(there were unfortunately merge conflicts after the exception handling patch committed yesterday but I think things are fine, at least unit tests Guardrails, setGet* and config are passing locally). The move of the static conversion methods led to IntKibibytesBoundToBytes which led to the need of change in the DatabaseDescriptor &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:17571-final?expand=1#diff-054af65b8d690b0fddc3e0a4ef05a80d8f1d6689b4f77912795fec019200666cR551&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&#160;and &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:17571-final?expand=1#diff-054af65b8d690b0fddc3e0a4ef05a80d8f1d6689b4f77912795fec019200666cR3706&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&#160;which should be fine as Integer.MAX_VALUE cannot be divided by 1024 to an integer so we don&apos;t need it.&lt;/p&gt;

&lt;p&gt;I also removed one of the non-negative validations in the constructor which doesn&apos;t need it because that is ensured already by the pattern matching. I added a test for that too &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:17571-final?expand=1#diff-b02560e1a47ddce2e07855a3aaf2931b1987e17d75ff99d01d44fedcaf2d83b1R87&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CI running &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=17571-final&amp;amp;filter=all&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;trunk comes in 10 minutes I hope as I don&apos;t expect the cherry-picked commit to have many conflicts there.&#160;&lt;/p&gt;</comment>
                            <comment id="17540201" author="edimitrova" created="Fri, 20 May 2022 16:24:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/new/17571-trunk-final&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&#160;patch, &#160;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=17571-trunk-final&amp;amp;filter=all&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI&lt;/a&gt;&#160;started&#160;&lt;/p&gt;

&lt;p&gt;If everything is fine, I will add CHANGES.txt entry, add &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&#160;as co-author and also add to the entry that we fixed two properties - auto_snapshot_ttl &#160;and paxos_purge_grace_period&lt;/p&gt;</comment>
                            <comment id="17540274" author="edimitrova" created="Fri, 20 May 2022 19:51:24 +0000"  >&lt;p&gt;The patch was committed after checking offline with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;&#160; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&#160;for final +1.&lt;/p&gt;

&lt;p&gt;Special thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&#160;for helping me to verify CI and double checking the rebase which had some conflicts.&lt;/p&gt;

&lt;p&gt;There were a few unknown to me failures but we verified that they are not new by looping both with and without the patch:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;4.1 - &lt;em&gt;basicRangeTombstones&lt;/em&gt; - without the patch failed a few times here - &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1585/workflows/70aa2792-56ca-49e3-8fc7-749270041edc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/adelapena/cassandra/1585/workflows/70aa2792-56ca-49e3-8fc7-749270041edc&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;with the patch I found it once by looking at the logs of the failing containers as UI was not showing which are the failing tests - &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=17571-more-tests&amp;amp;filter=all&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=17571-more-tests&amp;amp;filter=all&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;trunk -&#160;&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1638/workflows/eb0712f6-d19e-4b0a-b0df-30e5107f880c/jobs/11342/tests#failed-test-0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;handleCorruptionOfLargeMessageFrame-compression&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1638/workflows/eb0712f6-d19e-4b0a-b0df-30e5107f880c/jobs/11342/tests#failed-test-1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testNegativeEnvelopeBodySize-compression&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1638/workflows/eb0712f6-d19e-4b0a-b0df-30e5107f880c/jobs/11342/tests#failed-test-2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testUnrecoverableMessageDecodingErrors-compression&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1638/workflows/eb0712f6-d19e-4b0a-b0df-30e5107f880c/jobs/11342/tests#failed-test-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testRecoverableEnvelopeDecodingErrors-compression&lt;/a&gt;&#160;all those were proved as failing as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16677&quot; title=&quot;Test Failure: Fix flaky ConnectionTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16677&quot;&gt;CASSANDRA-16677&lt;/a&gt;. Multiplexer run - &#160;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1405/workflows/88fb8e4f-7a3f-42f9-a6db-5d14a652b54e/jobs/14141/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/adelapena/cassandra/1405/workflows/88fb8e4f-7a3f-42f9-a6db-5d14a652b54e/jobs/14141/tests&lt;/a&gt;&#160;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17540301" author="edimitrova" created="Fri, 20 May 2022 21:07:25 +0000"  >&lt;p&gt;Ticket for the flaky tests in TopPartitionsTest opened&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17649&quot; title=&quot;Fix flaky tests in TopPartitionsTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17649&quot;&gt;&lt;del&gt;CASSANDRA-17649&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                            <outwardlinks description="Testing discovered">
                                        <issuelink>
            <issuekey id="13446118">CASSANDRA-17649</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[edimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="13163" cascade-level=""><![CDATA[Code]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z11ojc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[adelapena]]></customfieldvalue>
        <customfieldvalue><![CDATA[maedhroz]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12350145">4.1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/a67a2a2441589e8bf41498c426fddacd7b9719cf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/a67a2a2441589e8bf41498c426fddacd7b9719cf&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Current tests plus additional unit tests&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>