<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:05:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-12815] cqlsh may throw AttributeError due to no table metadata</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-12815</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Since &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11534&quot; title=&quot;cqlsh fails to format collections when using aliases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11534&quot;&gt;&lt;del&gt;CASSANDRA-11534&lt;/del&gt;&lt;/a&gt; there is a potential bug in this code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; result.column_types:
            ks_meta = self.conn.metadata.keyspaces[table_meta.keyspace_name]
            cql_types = [CqlType(cql_typename(t), ks_meta) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; t in result.column_types]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It cannot be reproduced with any of our tests but there is a code path that could cause &lt;tt&gt;table_meta&lt;/tt&gt; to be &lt;tt&gt;None&lt;/tt&gt; when the statement cannot be parsed. Given that the code before 11534 used to check on &lt;tt&gt;table_meta&lt;/tt&gt; not being &lt;tt&gt;None&lt;/tt&gt;, I prefer to put back the same check in order to avoid any possible regressions once 3.10 is released. Also, since we check in all other places, this helps with consistency too.&lt;/p&gt;

&lt;p&gt;The only reason we need the table metadata in that code block is to get the keyspace name. We should fallback to the current keyspace name if we have no table metadata.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13013732">CASSANDRA-12815</key>
            <summary>cqlsh may throw AttributeError due to no table metadata</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="stefania">Stefania Alborghetti</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Oct 2016 02:03:57 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:16 +0000</updated>
                            <resolved>Tue, 25 Oct 2016 02:05:20 +0000</resolved>
                                        <fixVersion>3.10</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15590515" author="stefania" created="Thu, 20 Oct 2016 02:11:58 +0000"  >&lt;p&gt;The patch is trivial and applies cleanly into trunk, CI pending: &lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.X&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/tree/12815-cqlsh-3.X&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/tree/12815-cqlsh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12815-cqlsh-3.X-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;cqlsh tests&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12815-cqlsh-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;cqlsh tests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snazy&quot; class=&quot;user-hover&quot; rel=&quot;snazy&quot;&gt;snazy&lt;/a&gt; would you mind reviewing this given that you reviewed &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11534&quot; title=&quot;cqlsh fails to format collections when using aliases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11534&quot;&gt;&lt;del&gt;CASSANDRA-11534&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="15590628" author="stefania" created="Thu, 20 Oct 2016 03:20:01 +0000"  >&lt;p&gt;CI is clean.&lt;/p&gt;</comment>
                            <comment id="15601216" author="snazy" created="Mon, 24 Oct 2016 07:22:37 +0000"  >&lt;p&gt;Any special reason why you&apos;re using &lt;tt&gt;self.conn.metadata.keyspaces.get(ks_name, None)&lt;/tt&gt; instead of &lt;tt&gt;self.conn.metadata.keyspaces&lt;span class=&quot;error&quot;&gt;&amp;#91;ks_name&amp;#93;&lt;/span&gt;&lt;/tt&gt;? I&apos;d prefer the &quot;simple&quot; syntax.&lt;/p&gt;

&lt;p&gt;Otherwise +1.&lt;/p&gt;</comment>
                            <comment id="15601235" author="stefania" created="Mon, 24 Oct 2016 07:30:59 +0000"  >&lt;p&gt;Thank you for the review. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Any special reason why you&apos;re using &lt;tt&gt;self.conn.metadata.keyspaces.get(ks_name, None)&lt;/tt&gt; instead of &lt;tt&gt;self.conn.metadata.keyspaces[ks_name]&lt;/tt&gt;?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, the latter will throw an exception if &lt;tt&gt;ks_name&lt;/tt&gt; is &lt;tt&gt;None&lt;/tt&gt;, since &lt;tt&gt;self.conn.metadata.keyspaces&lt;/tt&gt; contains no value mapped to &lt;tt&gt;None&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15601252" author="snazy" created="Mon, 24 Oct 2016 07:41:02 +0000"  >&lt;p&gt;OK, makes sense.&lt;/p&gt;</comment>
                            <comment id="15603900" author="stefania" created="Tue, 25 Oct 2016 02:05:21 +0000"  >&lt;p&gt;Thank you for the review, committed to 3.X as 13b7362494c4c0ff3c5ce80b8e7ee7fe64d65785 and merged into trunk.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12957218">CASSANDRA-11534</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i354p3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>snazy</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[snazy]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12337348">3.10</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>