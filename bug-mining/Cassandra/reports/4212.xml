<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:02:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11470] dtest failure in materialized_views_test.TestMaterializedViews.base_replica_repair_test</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11470</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;base_replica_repair_test has failed on trunk with the following exception in the log of node2:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [main] 2016-03-31 08:48:46,949 CassandraDaemon.java:708 - Exception encountered during startup
java.lang.RuntimeException: Failed to list files in /mnt/tmp/dtest-du964e/test/node2/data0/system_schema/views-9786ac1cdd583201a7cdad556410c985
        at org.apache.cassandra.db.lifecycle.LogAwareFileLister.list(LogAwareFileLister.java:53) ~[main/:na]
        at org.apache.cassandra.db.lifecycle.LifecycleTransaction.getFiles(LifecycleTransaction.java:547) ~[main/:na]
        at org.apache.cassandra.db.Directories$SSTableLister.filter(Directories.java:725) ~[main/:na]
        at org.apache.cassandra.db.Directories$SSTableLister.list(Directories.java:690) ~[main/:na]
        at org.apache.cassandra.db.ColumnFamilyStore.createColumnFamilyStore(ColumnFamilyStore.java:567) ~[main/:na]
        at org.apache.cassandra.db.ColumnFamilyStore.createColumnFamilyStore(ColumnFamilyStore.java:555) ~[main/:na]
        at org.apache.cassandra.db.Keyspace.initCf(Keyspace.java:383) ~[main/:na]
        at org.apache.cassandra.db.Keyspace.&amp;lt;init&amp;gt;(Keyspace.java:320) ~[main/:na]
        at org.apache.cassandra.db.Keyspace.open(Keyspace.java:130) ~[main/:na]
        at org.apache.cassandra.db.Keyspace.open(Keyspace.java:107) ~[main/:na]
        at org.apache.cassandra.cql3.restrictions.StatementRestrictions.&amp;lt;init&amp;gt;(StatementRestrictions.java:139) ~[main/:na]
        at org.apache.cassandra.cql3.statements.SelectStatement$RawStatement.prepareRestrictions(SelectStatement.java:864) ~[main/:na]
        at org.apache.cassandra.cql3.statements.SelectStatement$RawStatement.prepare(SelectStatement.java:811) ~[main/:na]
        at org.apache.cassandra.cql3.statements.SelectStatement$RawStatement.prepare(SelectStatement.java:799) ~[main/:na]
        at org.apache.cassandra.cql3.QueryProcessor.getStatement(QueryProcessor.java:505) ~[main/:na]
        at org.apache.cassandra.cql3.QueryProcessor.parseStatement(QueryProcessor.java:242) ~[main/:na]
        at org.apache.cassandra.cql3.QueryProcessor.prepareInternal(QueryProcessor.java:286) ~[main/:na]
        at org.apache.cassandra.cql3.QueryProcessor.executeInternal(QueryProcessor.java:294) ~[main/:na]
        at org.apache.cassandra.schema.SchemaKeyspace.query(SchemaKeyspace.java:1246) ~[main/:na]
        at org.apache.cassandra.schema.SchemaKeyspace.fetchKeyspacesWithout(SchemaKeyspace.java:875) ~[main/:na]
        at org.apache.cassandra.schema.SchemaKeyspace.fetchNonSystemKeyspaces(SchemaKeyspace.java:867) ~[main/:na]
        at org.apache.cassandra.config.Schema.loadFromDisk(Schema.java:134) ~[main/:na]
        at org.apache.cassandra.config.Schema.loadFromDisk(Schema.java:124) ~[main/:na]
        at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:229) [main/:na]
        at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:562) [main/:na]
        at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:691) [main/:na]
Caused by: java.lang.RuntimeException: Failed to list directory files in /mnt/tmp/dtest-du964e/test/node2/data0/system_schema/views-9786ac1cdd583201a7cdad556410c985, inconsistent disk state &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; transaction [ma_txn_flush_58db56b0-f71d-11e5-bf68-03a01adb9f11.log in /mnt/tmp/dtest-du964e/test/node2/data0/system_schema/views-9786ac1cdd583201a7cdad556410c985]
        at org.apache.cassandra.db.lifecycle.LogAwareFileLister.classifyFiles(LogAwareFileLister.java:149) ~[main/:na]
        at org.apache.cassandra.db.lifecycle.LogAwareFileLister.classifyFiles(LogAwareFileLister.java:103) ~[main/:na]
        at org.apache.cassandra.db.lifecycle.LogAwareFileLister$$Lambda$48/35984028.accept(Unknown Source) ~[na:na]
        at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184) ~[na:1.8.0_45]
        at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175) ~[na:1.8.0_45]
        at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1374) ~[na:1.8.0_45]
        at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:512) ~[na:1.8.0_45]
        at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:502) ~[na:1.8.0_45]
        at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151) ~[na:1.8.0_45]
        at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174) ~[na:1.8.0_45]
        at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[na:1.8.0_45]
        at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418) ~[na:1.8.0_45]
        at org.apache.cassandra.db.lifecycle.LogAwareFileLister.innerList(LogAwareFileLister.java:71) ~[main/:na]
        at org.apache.cassandra.db.lifecycle.LogAwareFileLister.list(LogAwareFileLister.java:49) ~[main/:na]
        ... 25 common frames omitted
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;example failure:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/job/trunk_dtest/1092/testReport/materialized_views_test/TestMaterializedViews/base_replica_repair_test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_dtest/1092/testReport/materialized_views_test/TestMaterializedViews/base_replica_repair_test&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Failed on CassCI build trunk_dtest #1092&lt;/p&gt;

&lt;p&gt;I&apos;ve attached the logs from the failure in build 1092.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12955019">CASSANDRA-11470</key>
            <summary>dtest failure in materialized_views_test.TestMaterializedViews.base_replica_repair_test</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="philipthompson">Philip Thompson</reporter>
                        <labels>
                            <label>dtest</label>
                    </labels>
                <created>Thu, 31 Mar 2016 16:59:54 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:37 +0000</updated>
                            <resolved>Mon, 11 Apr 2016 11:33:08 +0000</resolved>
                                        <fixVersion>3.0.6</fixVersion>
                    <fixVersion>3.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15220248" author="philipthompson" created="Thu, 31 Mar 2016 17:17:09 +0000"  >&lt;p&gt;This appears to have nothing to do with MV. I am now also seeing in in readrepair_test on trunk&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/job/trunk_offheap_dtest/100/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_offheap_dtest/100/testReport/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15229849" author="stefania" created="Thu, 7 Apr 2016 07:44:01 +0000"  >&lt;p&gt;I fixed a problem in &lt;tt&gt;LogAwareFileLister.classifyFiles&lt;/tt&gt;, which would have affected transactions spread across multiple disks. However, this is not what is causing these tests to fail unless we are using multiple disks and I haven&apos;t noticed.&lt;/p&gt;

&lt;p&gt;I&apos;ve also fixed another problem with the existing logic, in that we should only check that OLD sstable files still exist to determine if there is a race, we don&apos;t need to look at NEW sstable files.  Since we cannot tell in advance how many NEW sstables files will be created and when, this might explain the problems we are seeing although I would have expected them on 3.0 as well.&lt;/p&gt;

&lt;p&gt;Finally, if we fail to classify files due to an inconsistent disk state, I&apos;ve added a log message showing the list of files detected and the content of the transaction.&lt;/p&gt;

&lt;p&gt;Patch and CI results for trunk:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11470-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11470-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Depending on the CI results, we may need to run &lt;tt&gt;base_replica_repair_test&lt;/tt&gt; multiple times to see if the problem is fixed and to gather more information if it isn&apos;t. &lt;/p&gt;</comment>
                            <comment id="15230178" author="stefania" created="Thu, 7 Apr 2016 12:48:08 +0000"  >&lt;p&gt;CI results are fine. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=philipthompson&quot; class=&quot;user-hover&quot; rel=&quot;philipthompson&quot;&gt;philipthompson&lt;/a&gt; could you set-up a job that runs &lt;tt&gt;base_replica_repair_test&lt;/tt&gt; several times against the patch above?&lt;/p&gt;</comment>
                            <comment id="15230643" author="philipthompson" created="Thu, 7 Apr 2016 17:30:46 +0000"  >&lt;p&gt;Done so here:&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/view/Parameterized/job/parameterized_dtest_multiplexer/62/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Parameterized/job/parameterized_dtest_multiplexer/62/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It will run 450 times. Hopefully that&apos;s enough.&lt;/p&gt;</comment>
                            <comment id="15231492" author="stefania" created="Fri, 8 Apr 2016 02:05:39 +0000"  >&lt;p&gt;Thanks for setting this up so quickly. No failures, which is good I suppose. However, I really would like to understand if this is because of the patch of because of some other reason. Could we run it another 150 times perhaps, against &lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11470-debug&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this patch&lt;/a&gt;, which is just trunk + the log message. If we find a failure, this should tell us what the problem is and confirm that indeed the patch has fixed it. If it doesn&apos;t fail, then it may be that for some reason we are not able to reproduce the problem when running the test in isolation. What do you think?&lt;/p&gt;</comment>
                            <comment id="15232365" author="philipthompson" created="Fri, 8 Apr 2016 15:48:44 +0000"  >&lt;p&gt;That makes sense. Running here: &lt;a href=&quot;http://cassci.datastax.com/view/Parameterized/job/parameterized_dtest_multiplexer/63/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Parameterized/job/parameterized_dtest_multiplexer/63/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15234394" author="stefania" created="Mon, 11 Apr 2016 01:27:12 +0000"  >&lt;p&gt;Thanks for rerunning. We can see several failures and they are caused by missing NEW files, so looking at OLD files definitely fixes the problem.&lt;/p&gt;

&lt;p&gt;I don&apos;t know why it only happens on trunk, IMO the problem exists in 3.0 as well and so I&apos;ve produced a patch for both branches:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11470-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11470&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11470-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11470-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11470-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11470-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;The two patches are slightly different because on trunk we have a method in LogTransaction that prints the txn contents, whilst on 3.0 we need to access the records in order to print them.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krummas&quot; class=&quot;user-hover&quot; rel=&quot;krummas&quot;&gt;krummas&lt;/a&gt; would you be OK reviewing this?&lt;/p&gt;</comment>
                            <comment id="15234797" author="krummas" created="Mon, 11 Apr 2016 09:40:02 +0000"  >&lt;p&gt;+1, but could you update the branches with better CHANGES.txt entry? Since the bug is not related to materialized views it is a bit confusing.&lt;/p&gt;</comment>
                            <comment id="15234815" author="stefania" created="Mon, 11 Apr 2016 09:56:29 +0000"  >&lt;p&gt;Thanks, I&apos;ve changed commit message and entry in CHANGES.txt to &lt;tt&gt;LogAwareFileLister should only use OLD sstable files in current folder to determine disk consistency&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15234906" author="krummas" created="Mon, 11 Apr 2016 11:33:08 +0000"  >&lt;p&gt;thanks, committed&lt;/p&gt;</comment>
                            <comment id="15253732" author="anechiporuk" created="Fri, 22 Apr 2016 10:47:05 +0000"  >&lt;p&gt;Hi, probably issue still exists in 3.0.5, but appears in different place.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;nodetool cfstats XXX.YYY
Keyspace: XXX
        Read Count: 75443752
        Read Latency: 27.975226176251148 ms.
        Write Count: 66394239
        Write Latency: 0.03455783252519846 ms.
        Pending Flushes: 0
                Table: YYYY
                SSTable count: 778
                SSTables in each level: [20/4, 109/10, 105/100, 542, 0, 0, 0, 0, 0]
                Space used (live): 152332003329
                Space used (total): 152332003329
error: Failed to list directory files in /place/cassandra/data/XXXX/YYYY inconsistent disk state &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; transaction [/place/cassandra/data/XXXX/YYYY/ma_txn_compaction_2695f850-0874-11e6-b5e6-1335f8eceb06.log]
-- StackTrace --
java.lang.RuntimeException: Failed to list directory files in /place/cassandra/data/XXX/YYY, inconsistent disk state &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; transaction [/place/cassan
dra/data/XXX/YYY/ma_txn_compaction_2695f850-0874-11e6-b5e6-1335f8eceb06.log]
        at org.apache.cassandra.db.lifecycle.LogAwareFileLister.classifyFiles(LogAwareFileLister.java:149)
        at org.apache.cassandra.db.lifecycle.LogAwareFileLister.classifyFiles(LogAwareFileLister.java:103)
        at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
        at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
        at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1374)
        at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
        at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
        at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
        at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
        at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
        at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
        at org.apache.cassandra.db.lifecycle.LogAwareFileLister.innerList(LogAwareFileLister.java:71)
        at org.apache.cassandra.db.lifecycle.LogAwareFileLister.list(LogAwareFileLister.java:49)
        at org.apache.cassandra.db.lifecycle.LifecycleTransaction.getFiles(LifecycleTransaction.java:547)
        at org.apache.cassandra.db.Directories$SSTableLister.filter(Directories.java:691)
        at org.apache.cassandra.db.Directories$SSTableLister.listFiles(Directories.java:662)
        at org.apache.cassandra.db.Directories$TrueFilesSizeVisitor.&amp;lt;init&amp;gt;(Directories.java:981)
        at org.apache.cassandra.db.Directories.getTrueAllocatedSizeIn(Directories.java:893)
        at org.apache.cassandra.db.Directories.trueSnapshotsSize(Directories.java:883)
        at org.apache.cassandra.db.ColumnFamilyStore.trueSnapshotsSize(ColumnFamilyStore.java:2332)
        at org.apache.cassandra.metrics.TableMetrics$32.getValue(TableMetrics.java:637)
        at org.apache.cassandra.metrics.TableMetrics$32.getValue(TableMetrics.java:634)
        at org.apache.cassandra.metrics.CassandraMetricsRegistry$JmxGauge.getValue(CassandraMetricsRegistry.java:235)
        at sun.reflect.GeneratedMethodAccessor25.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:71)
        at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:275)
        at com.sun.jmx.mbeanserver.StandardMBeanIntrospector.invokeM2(StandardMBeanIntrospector.java:112)
        at com.sun.jmx.mbeanserver.StandardMBeanIntrospector.invokeM2(StandardMBeanIntrospector.java:46)
        at com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:237)
        at com.sun.jmx.mbeanserver.PerInterface.getAttribute(PerInterface.java:83)
        at com.sun.jmx.mbeanserver.MBeanSupport.getAttribute(MBeanSupport.java:206)
        at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(DefaultMBeanServerInterceptor.java:647)
        at com.sun.jmx.mbeanserver.JmxMBeanServer.getAttribute(JmxMBeanServer.java:678)
        at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1445)
        at javax.management.remote.rmi.RMIConnectionImpl.access$300(RMIConnectionImpl.java:76)
        at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1309)
        at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1401)
        at javax.management.remote.rmi.RMIConnectionImpl.getAttribute(RMIConnectionImpl.java:639)
        at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:323)
        at sun.rmi.transport.Transport$1.run(Transport.java:200)
        at sun.rmi.transport.Transport$1.run(Transport.java:197)
        at java.security.AccessController.doPrivileged(Native Method)
        at sun.rmi.transport.Transport.serviceCall(Transport.java:196)
        at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:568)
        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:826)
        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:683)
        at java.security.AccessController.doPrivileged(Native Method)
        at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:682)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It happens every time if compaction is in progress&lt;/p&gt;</comment>
                            <comment id="15255493" author="stefania" created="Sun, 24 Apr 2016 04:49:47 +0000"  >&lt;p&gt;The release version was incorrect, this patch was delivered in 3.0.6, not 3.0.5. Please try again with 3.0.6. &lt;/p&gt;

&lt;p&gt;The patch has added an extended log error message that should help debugging any more issues. This message should appear just before the exception. Please make sure to include it if you still have problems with 3.0.6.&lt;/p&gt;</comment>
                            <comment id="15278665" author="ostefano" created="Tue, 10 May 2016 18:44:41 +0000"  >&lt;p&gt;I am having the same exception triggered after a runtime exception thrown by the graphitereporter:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;ERROR [metrics-graphite-reporter-1-thread-1] 2016-05-10 18:41:21,672 ScheduledReporter.java:119 - RuntimeException thrown from GraphiteReporter#report. Exception was suppressed.
java.lang.RuntimeException: Failed to list files in /data/cassandra/data/schema_test/cf_test-e32122c0800c11e48a94fb3921529dd4
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15280906" author="ostefano" created="Wed, 11 May 2016 22:11:38 +0000"  >&lt;p&gt;I see it happening quite consistently during AntiCompactions.&lt;/p&gt;</comment>
                            <comment id="15281036" author="stefania" created="Thu, 12 May 2016 00:14:55 +0000"  >&lt;p&gt;This would make sense, since during anti-compactions several new sstable files would be created and it is new files that are logged in the txn but do not yet exist on disk, that would incorrectly cause the inconsistent disk state. This patch should have rectified this. Please do let us know if this problem persists with 3.0.6.&lt;/p&gt;</comment>
                            <comment id="15288481" author="ostefano" created="Wed, 18 May 2016 05:50:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Stefania&quot; class=&quot;user-hover&quot; rel=&quot;stefania&quot;&gt;Stefania&lt;/a&gt; I can confirm that 3.0.6 seems to be fixing the bug (repairing and no exceptions triggered so far). I have though seen a possible race exhibited by the reporter when creating a table (happened on 3/4 nodes out of 13). Opened a ticket here: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11823&quot; title=&quot;Creating a table leads to a race with GraphiteReporter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11823&quot;&gt;&lt;del&gt;CASSANDRA-11823&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15288493" author="stefania" created="Wed, 18 May 2016 06:13:12 +0000"  >&lt;p&gt;Thank you for letting us know, it&apos;s really appreciated, and for reporting the concurrent modification exception in the table metrics (&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11823&quot; title=&quot;Creating a table leads to a race with GraphiteReporter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11823&quot;&gt;&lt;del&gt;CASSANDRA-11823&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="15298522" author="ostefano" created="Tue, 24 May 2016 17:05:14 +0000"  >&lt;p&gt;I am not sure it&apos;s related, but I noticed another exception while checking my logs. &lt;br/&gt;
Note that, unlike with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11823&quot; title=&quot;Creating a table leads to a race with GraphiteReporter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11823&quot;&gt;&lt;del&gt;CASSANDRA-11823&lt;/del&gt;&lt;/a&gt;, it&apos;s not related to creating a new column family.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;WARN  [CompactionExecutor:2006] 2016-05-23 18:23:31,694 BigTableWriter.java:171 - Writing large partition test_keyspace/test_columnfamily:eda6b9c36f8df6fe596492c3438d7a38e9b109a6 (123663388 bytes)
INFO  [IndexSummaryManager:1] 2016-05-23 18:24:23,731 IndexSummaryRedistribution.java:74 - Redistributing index summaries
WARN  [CompactionExecutor:2006] 2016-05-23 18:24:56,669 BigTableWriter.java:171 - Writing large partition test_keyspace/test_columnfamily:05b6b424194dd19ab7cfbcd53c4979768cd859e9 (256286063 bytes)
WARN  [CompactionExecutor:2006] 2016-05-23 18:26:23,575 BigTableWriter.java:171 - Writing large partition test_keyspace/test_columnfamily:04e9fac15552b9ae77c27a6cb8d0fd11fdcc24d7 (212445557 bytes)
INFO  [CompactionExecutor:2005] 2016-05-23 18:29:26,839 LeveledManifest.java:437 - Adding high-level (L3) BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/data/cassandra/data/test_keyspace/test_columnfamily_2-d29dd71045a811e59aff6776bf484396/ma-61041-big-Data.db&apos;&lt;/span&gt;) to candidates
WARN  [CompactionExecutor:2006] 2016-05-23 18:30:34,154 BigTableWriter.java:171 - Writing large partition test_keyspace/test_columnfamily:edbe6f178503be90911dbf29a55b97a4b095a9ec (183852539 bytes)
INFO  [CompactionExecutor:2006] 2016-05-23 18:31:21,080 LeveledManifest.java:437 - Adding high-level (L3) BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/data/cassandra/data/test_keyspace/test_columnfamily_2-d29dd71045a811e59aff6776bf484396/ma-61042-big-Data.db&apos;&lt;/span&gt;) to candidates
ERROR [metrics-graphite-reporter-1-thread-1] 2016-05-23 18:31:21,207 LogFile.java:173 - Unexpected files detected for sstable [ma-91034-big], record [REMOVE:[/data/cassandra/data/test_keyspace/test_columnfamily-3996ce80b7ac11e48a9b6776bf484396/ma-91034-big,1463992176000,8][457420186]]: last update time [00:00:00] should have been [08:29:36]
ERROR [metrics-graphite-reporter-1-thread-1] 2016-05-23 18:31:21,208 ScheduledReporter.java:119 - RuntimeException thrown from GraphiteReporter#report. Exception was suppressed.
java.lang.RuntimeException: Failed to list files in /data/cassandra/data/test_keyspace/test_columnfamily-3996ce80b7ac11e48a9b6776bf484396
	at org.apache.cassandra.db.lifecycle.LogAwareFileLister.list(LogAwareFileLister.java:57) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.db.lifecycle.LifecycleTransaction.getFiles(LifecycleTransaction.java:547) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.db.Directories$SSTableLister.filter(Directories.java:691) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.db.Directories$SSTableLister.listFiles(Directories.java:662) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.db.Directories$TrueFilesSizeVisitor.&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;init&amp;gt;&lt;/span&gt;(Directories.java:981) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.db.Directories.getTrueAllocatedSizeIn(Directories.java:893) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.db.Directories.trueSnapshotsSize(Directories.java:883) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.db.ColumnFamilyStore.trueSnapshotsSize(ColumnFamilyStore.java:2332) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.metrics.TableMetrics$32.getValue(TableMetrics.java:637) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.metrics.TableMetrics$32.getValue(TableMetrics.java:634) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.metrics.TableMetrics$33.getValue(TableMetrics.java:692) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.metrics.TableMetrics$33.getValue(TableMetrics.java:686) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at com.codahale.metrics.graphite.GraphiteReporter.reportGauge(GraphiteReporter.java:281) ~[metrics-graphite-3.1.0.jar:3.1.0]
	at com.codahale.metrics.graphite.GraphiteReporter.report(GraphiteReporter.java:158) ~[metrics-graphite-3.1.0.jar:3.1.0]
	at com.codahale.metrics.ScheduledReporter.report(ScheduledReporter.java:162) ~[metrics-core-3.1.0.jar:3.1.0]
	at com.codahale.metrics.ScheduledReporter$1.run(ScheduledReporter.java:117) ~[metrics-core-3.1.0.jar:3.1.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_91]
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) [na:1.8.0_91]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) [na:1.8.0_91]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) [na:1.8.0_91]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [na:1.8.0_91]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_91]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_91]
Caused by: org.apache.cassandra.db.lifecycle.LogTransaction$CorruptTransactionLogException: Some records failed verification. See earlier in log for details.
	at org.apache.cassandra.db.lifecycle.LogAwareFileLister.readTxnLog(LogAwareFileLister.java:114) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.db.lifecycle.LogAwareFileLister.classifyFiles(LogAwareFileLister.java:106) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184) ~[na:1.8.0_91]
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175) ~[na:1.8.0_91]
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1374) ~[na:1.8.0_91]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481) ~[na:1.8.0_91]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471) ~[na:1.8.0_91]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151) ~[na:1.8.0_91]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174) ~[na:1.8.0_91]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[na:1.8.0_91]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418) ~[na:1.8.0_91]
	at org.apache.cassandra.db.lifecycle.LogAwareFileLister.innerList(LogAwareFileLister.java:75) ~[apache-cassandra-3.0.6.jar:3.0.6]
	at org.apache.cassandra.db.lifecycle.LogAwareFileLister.list(LogAwareFileLister.java:53) ~[apache-cassandra-3.0.6.jar:3.0.6]
	... 22 common frames omitted
INFO  [CompactionExecutor:2005] 2016-05-23 18:32:27,284 LeveledManifest.java:437 - Adding high-level (L3) BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/data/cassandra/data/test_keyspace/test_columnfamily_3-37a9cb90b7ac11e48a9b6776bf484396/ma-98189-big-Data.db&apos;&lt;/span&gt;) to candidates
INFO  [CompactionExecutor:2005] 2016-05-23 18:34:42,562 LeveledManifest.java:437 - Adding high-level (L3) BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/data/cassandra/data/test_keyspace/test_columnfamily_3-37a9cb90b7ac11e48a9b6776bf484396/ma-98210-big-Data.db&apos;&lt;/span&gt;) to candidates
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15299327" author="stefania" created="Wed, 25 May 2016 02:09:19 +0000"  >&lt;p&gt;It&apos;s a different issue, thanks for reporting it! I&apos;ve opened &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11889&quot; title=&quot;LogRecord: file system race condition may cause verify() to fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11889&quot;&gt;&lt;del&gt;CASSANDRA-11889&lt;/del&gt;&lt;/a&gt; for it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12796340" name="node1.log" size="39095" author="philipthompson" created="Thu, 31 Mar 2016 16:59:54 +0000"/>
                            <attachment id="12796342" name="node2.log" size="63679" author="philipthompson" created="Thu, 31 Mar 2016 16:59:54 +0000"/>
                            <attachment id="12796341" name="node2_debug.log" size="425878" author="philipthompson" created="Thu, 31 Mar 2016 16:59:54 +0000"/>
                            <attachment id="12796344" name="node3.log" size="42630" author="philipthompson" created="Thu, 31 Mar 2016 16:59:54 +0000"/>
                            <attachment id="12796343" name="node3_debug.log" size="361805" author="philipthompson" created="Thu, 31 Mar 2016 16:59:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2vgvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>marcuse</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>