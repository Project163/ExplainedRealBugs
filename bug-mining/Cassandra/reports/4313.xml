<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:03:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11749] CQLSH gets SSL exception following a COPY FROM</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11749</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;When running Cassandra and cqlsh with SSL, the following command occasionally results in the exception below:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh --ssl -f kv.cql
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [SharedPool-Worker-2] 2016-05-11 12:41:03,583 Message.java:538 - Unexpected exception during request; channel = [id: 0xeb75e05d, /127.0.0.1:51083 =&amp;gt; /127.0.0.1:9042]
io.netty.handler.codec.DecoderException: javax.net.ssl.SSLException: bad record MAC
        at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:280) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:149) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:333) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:319) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:787) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.channel.epoll.EpollSocketChannel$EpollSocketUnsafe.epollInReady(EpollSocketChannel.java:722) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:326) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:264) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:137) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_91]
Caused by: javax.net.ssl.SSLException: bad record MAC
        at sun.security.ssl.Alerts.getSSLException(Alerts.java:208) ~[na:1.8.0_91]
        at sun.security.ssl.SSLEngineImpl.fatal(SSLEngineImpl.java:1728) ~[na:1.8.0_91]
        at sun.security.ssl.SSLEngineImpl.readRecord(SSLEngineImpl.java:981) ~[na:1.8.0_91]
        at sun.security.ssl.SSLEngineImpl.readNetRecord(SSLEngineImpl.java:907) ~[na:1.8.0_91]
        at sun.security.ssl.SSLEngineImpl.unwrap(SSLEngineImpl.java:781) ~[na:1.8.0_91]
        at javax.net.ssl.SSLEngine.unwrap(SSLEngine.java:624) ~[na:1.8.0_91]
        at io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:982) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:908) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.handler.ssl.SslHandler.decode(SslHandler.java:854) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:249) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
        ... 10 common frames omitted
Caused by: javax.crypto.BadPaddingException: bad record MAC
        at sun.security.ssl.InputRecord.decrypt(InputRecord.java:219) ~[na:1.8.0_91]
        at sun.security.ssl.EngineInputRecord.decrypt(EngineInputRecord.java:177) ~[na:1.8.0_91]
        at sun.security.ssl.SSLEngineImpl.readRecord(SSLEngineImpl.java:974) ~[na:1.8.0_91]
        ... 17 common frames omitted
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;where&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cat kv.cql 
create keyspace &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; not exists cvs_copy_ks with replication = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;replication_factor&apos;&lt;/span&gt;:1};
create table &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; not exists cvs_copy_ks.kv (key &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; primary key, value text);
truncate cvs_copy_ks.kv;
copy cvs_copy_ks.kv (key, value) from &lt;span class=&quot;code-quote&quot;&gt;&apos;kv.csv&apos;&lt;/span&gt; with header=&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;;
select * from cvs_copy_ks.kv;
drop keyspace cvs_copy_ks;
stefi@cuoricina:~/git/cstar/cassandra$ cat kv.c
kv.cql  kv.csv  

cat kv.csv 
key,value
1,&lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;
2,&lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;
3,&lt;span class=&quot;code-quote&quot;&gt;&apos;c&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The COPY FROM succeeds, however the following select does not. &lt;/p&gt;

&lt;p&gt;The easiest way to reproduce this is to restart the Cassandra process, it seems to happen in preference after a restart.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12967293">CASSANDRA-11749</key>
            <summary>CQLSH gets SSL exception following a COPY FROM</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="stefania">Stefania Alborghetti</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 May 2016 05:55:12 +0000</created>
                <updated>Tue, 14 Oct 2025 12:13:59 +0000</updated>
                            <resolved>Fri, 10 Jun 2016 21:02:05 +0000</resolved>
                                        <fixVersion>2.1.15</fixVersion>
                    <fixVersion>2.2.7</fixVersion>
                    <fixVersion>3.0.8</fixVersion>
                    <fixVersion>3.8</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15279714" author="stefania" created="Wed, 11 May 2016 07:30:24 +0000"  >&lt;p&gt;This is not caused by a recent code change that we&apos;ve made, I&apos;ve reproduced it even with COPY FROM before &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9302&quot; title=&quot;Optimize cqlsh COPY FROM, part 3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9302&quot;&gt;&lt;del&gt;CASSANDRA-9302&lt;/del&gt;&lt;/a&gt;. I suspect a recent update in either the JDK, or a library, or Python.&lt;/p&gt;

&lt;p&gt;I&apos;m attaching &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12803378/12803378_stdout.txt.zip&quot; title=&quot;stdout.txt.zip attached to CASSANDRA-11749&quot;&gt;stdout.txt.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; for the Cassandra process with &lt;tt&gt;export JVM_OPTS=-Djavax.net.debug=ssl&lt;/tt&gt;. &lt;/p&gt;

&lt;p&gt;It seems to me that the problem happens when Java receives a &lt;tt&gt;TLSv1 Alert&lt;/tt&gt; from Python:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;0040: 81 D5 CA 4A 67 15 CF 7A         epollEventLoopGroup-2-2, READ: TLSv1 Alert, length = 32
.h....k....x....
0040                   ...Jg..z
epollEventLoopGroup-2-2, fatal error: 20: bad record MAC
javax.crypto.BadPaddingException: bad record MAC
[...]
epollEventLoopGroup-2-8, READ: TLSv1 Handshake, length = 262
epollEventLoopGroup-2-6, WRITE: TLSv1 Application Data, length = 1
*** CertificateVerify
epollEventLoopGroup-2-2, SEND TLSv1 ALERT:  fatal, description = bad_record_mac
60 FC 50 9A 4FepollEventLoopGroup-2-2, WRITE: TLSv1 Alert, length = 32
epollEventLoopGroup-2-6, WRITE: TLSv1 Application Data, length = 8
epollEventLoopGroup-2-2, fatal: engine already closed.  Rethrowing javax.net.ssl.SSLException: bad record MAC
 E9 81 D5epollEventLoopGroup-2-2, called closeOutbound()
epollEventLoopGroup-2-2, closeOutboundInternal()
                            `.P.O...
epollEventLoopGroup-2-2, called closeInbound()
epollEventLoopGroup-2-2, fatal: engine already closed.  Rethrowing javax.net.ssl.SSLException: Inbound closed before receiving peer&apos;s close_notify: possible truncation attack?
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Do you have any suggestions &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="15280220" author="beobal" created="Wed, 11 May 2016 14:32:53 +0000"  >&lt;p&gt;I don&apos;t I&apos;m afraid &amp;amp; as far as I am aware, &lt;tt&gt;bad_record_mac&lt;/tt&gt; is basically a catch-all for any error with the encryption handshake. I did find a &lt;a href=&quot;https://github.com/netty/netty/issues/4116&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;netty issue&lt;/a&gt; presenting similar symptoms, but it was only affecting Android clients. Perhaps &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=norman&quot; class=&quot;user-hover&quot; rel=&quot;norman&quot;&gt;norman&lt;/a&gt; has more of an idea?&lt;/p&gt;

&lt;p&gt;One other thing, in &lt;tt&gt;stdout.txt&lt;/tt&gt; there do seem to be quite a few warnings prior to that too which suggest the client is shutting down the connection prematurely, but I don&apos;t know if that&apos;s at all relevant:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;epollEventLoopGroup-2-4, fatal error: 80: Inbound closed before receiving peer&apos;s close_notify: possible truncation attack?
javax.net.ssl.SSLException: Inbound closed before receiving peer&apos;s close_notify: possible truncation attack?
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15281206" author="stefania" created="Thu, 12 May 2016 04:45:34 +0000"  >&lt;p&gt;Thank you for the information Sam. &lt;/p&gt;

&lt;p&gt;The Android netty issue is similar but, if there is a problem with Netty, it must be for an entirely different reason. So far I&apos;ve reproduced this exception with Netty 4.0.23 and 4.0.36 using JDK 1.8.0_91 and various versions of Python/OpenSSL (Python 2.7.6 with openssl 1.0.1f-1ubuntu2.19, which is the default on Ubuntu Trusty, Python 2.7.10 custom built with openssl 1.0.2h or 1.0.2g). I know that Datastax have also reproduced it with JDK 1.8.0_40 and netty 4.0.34. I&apos;ve also verified that the exception exists with SSLv3 as well, so it is not a TLS bug.&lt;/p&gt;

&lt;p&gt;Adding a pause of 1 second between the end of the COPY FROM and the next SELECT statement makes the exception disappear. &lt;/p&gt;

&lt;p&gt;Reducing the pause makes the exception gradually easier to reproduce. Without any pause the exception occurs once every 10 times approximately. Therefore I suspect a concurrency bug server side, possibly in Netty. I think closing the SSL connections from the COPY FROM Python processes somehow overlaps with the main session from the cqlsh SELECT. A single COPY FROM process is sufficient to reproduce the exception, and in fact makes it easier to debug server side (attached &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12803570/12803570_stdout_single_process.txt.zip&quot; title=&quot;stdout_single_process.txt.zip attached to CASSANDRA-11749&quot;&gt;stdout_single_process.txt.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;). &lt;/p&gt;

&lt;p&gt;If &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=norman&quot; class=&quot;user-hover&quot; rel=&quot;norman&quot;&gt;norman&lt;/a&gt; has any suggestions I can test them or I can provide further debug information by adding debug statements to the Netty SSLHandler. &lt;/p&gt;

&lt;p&gt;If we cannot understand what the problem is, as a workaround we can introduce a pause after a COPY FROM when using SSL.&lt;/p&gt;</comment>
                            <comment id="15282697" author="norman" created="Fri, 13 May 2016 13:44:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Stefania&quot; class=&quot;user-hover&quot; rel=&quot;stefania&quot;&gt;Stefania&lt;/a&gt; if you can give me &quot;step-by-step&quot; way to reproduce this in my laptop I will have a look and try to figure out what is wrong&lt;/p&gt;</comment>
                            <comment id="15284053" author="stefania" created="Mon, 16 May 2016 01:31:49 +0000"  >&lt;p&gt;Thank you Norman.&lt;/p&gt;

&lt;p&gt;You can use &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...stef1927:11749-cqlsh-2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this branch&lt;/a&gt;. It&apos;s configured to run Cassandra with SSL, it contains the test files and it links to Netty 4.0.36 (rather than 4.0.23). It&apos;s otherwise identical to cassandra-2.1 HEAD (the workaround mentioned above has been commented out). &lt;/p&gt;

&lt;p&gt;Here are the instructions:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Dependencies: Java 8 JDK, Python 2.7, ant 1.9+&lt;/li&gt;
	&lt;li&gt;Get the branch: &lt;tt&gt;git clone &lt;a href=&quot;http://github.com/stef1927/cassandra.git&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://github.com/stef1927/cassandra.git&lt;/a&gt; --branch 11749-cqlsh-2.1 --single-branch&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Set the &lt;tt&gt;CASSANDRA_DIR&lt;/tt&gt; environment to the location of the branch and add &lt;tt&gt;CASSANDRA_DIR/bin&lt;/tt&gt; to the PATH&lt;/li&gt;
	&lt;li&gt;Build: &lt;tt&gt;ant build&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;If you need an IntelliJ project: &lt;tt&gt;ant generate-idea-files&lt;/tt&gt; or Eclipse: &lt;tt&gt;ant generate-eclipse-files&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Generate the certificates by following &lt;a href=&quot;http://docs.datastax.com/en/cassandra/2.1/cassandra/security/secureSSLCertificates_t.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;these instructions&lt;/a&gt;. These are the certificates you should end up with:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;keystore.node0
node0.cer
node0.cer.pem
node0.key.pem
node0.p12
truststore.node0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Edit &lt;tt&gt;$CASSANDRA_DIR/cqlshrc&lt;/tt&gt; and &lt;tt&gt;$CASSANDRA_DIR/conf/cassandra.yaml&lt;/tt&gt; to point to your certificates. The easiest is to search for my absolute path &lt;tt&gt;/home/stefi&lt;/tt&gt; and change all occurrences. There are 3 occurrences in &lt;tt&gt;cqlshrc&lt;/tt&gt; and 2 in &lt;tt&gt;cassandra.yaml&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;Download the &lt;a href=&quot;http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JCE&lt;/a&gt;, unzip and copy the 2 jars to &lt;tt&gt;$JAVA_HOME/jre/lib/security/&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Set any additional JVM properties via the &lt;tt&gt;JVM_OPTS&lt;/tt&gt; environment variable, for example: &lt;tt&gt;export JVM_OPTS=-Djavax.net.debug=ssl&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Launch cassandra in the foreground: &lt;tt&gt;cassandra -f&lt;/tt&gt;. Stop with CTRL-C.&lt;/li&gt;
	&lt;li&gt;If you need to run in IntelliJ you can use the Cassandra run config.&lt;/li&gt;
	&lt;li&gt;The log file containing the exception is &lt;tt&gt;CASSANDRA_DIR/logs/system.log&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Run the test with &lt;tt&gt;cqlsh --debug --ssl --cqlshrc=./conf/cqlshrc -f kv.cql&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;This is a sample output when it works:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Using CQL driver: &amp;lt;module &lt;span class=&quot;code-quote&quot;&gt;&apos;cassandra&apos;&lt;/span&gt; from &lt;span class=&quot;code-quote&quot;&gt;&apos;/home/stefi/git/cstar/cassandra/bin/../lib/cassandra-driver-internal-only-2.7.2.zip/cassandra-driver-2.7.2/cassandra/__init__.py&apos;&lt;/span&gt;&amp;gt;
Using connect timeout: 5 seconds
Reading options from the command line: {&lt;span class=&quot;code-quote&quot;&gt;&apos;header&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;numprocesses&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;}
Using options: &lt;span class=&quot;code-quote&quot;&gt;&apos;{&apos;&lt;/span&gt;header&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos;, &apos;&lt;/span&gt;numprocesses&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;1&lt;span class=&quot;code-quote&quot;&gt;&apos;}&apos;&lt;/span&gt;
Using 1 child processes

Starting copy of cvs_copy_ks.kv with columns [&lt;span class=&quot;code-quote&quot;&gt;&apos;key&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;value&apos;&lt;/span&gt;].
Closing queues...; Rate:      12 rows/s; Avg. rate:      12 rows/s
Processed: 3 rows; Rate:       6 rows/s; Avg. rate:       8 rows/s
3 rows imported from 1 files in 0.358 seconds (0 skipped).

 key | value
-----+-------
   1 |   &lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;
   2 |   &lt;span class=&quot;code-quote&quot;&gt;&apos;b&apos;&lt;/span&gt;
   3 |   &lt;span class=&quot;code-quote&quot;&gt;&apos;c&apos;&lt;/span&gt;

(3 rows)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is a sample output when it fails, plus the exception will be visible in logs/system.log:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;stefi@cuoricina:~/git/cstar/cassandra$ cqlsh --debug --ssl --cqlshrc=./conf/cqlshrc -f kv.cql
Using CQL driver: &amp;lt;module &lt;span class=&quot;code-quote&quot;&gt;&apos;cassandra&apos;&lt;/span&gt; from &lt;span class=&quot;code-quote&quot;&gt;&apos;/home/stefi/git/cstar/cassandra/bin/../lib/cassandra-driver-internal-only-2.7.2.zip/cassandra-driver-2.7.2/cassandra/__init__.py&apos;&lt;/span&gt;&amp;gt;
Using connect timeout: 5 seconds
Reading options from the command line: {&lt;span class=&quot;code-quote&quot;&gt;&apos;header&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;numprocesses&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;}
Using options: &lt;span class=&quot;code-quote&quot;&gt;&apos;{&apos;&lt;/span&gt;header&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos;, &apos;&lt;/span&gt;numprocesses&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;1&lt;span class=&quot;code-quote&quot;&gt;&apos;}&apos;&lt;/span&gt;
Using 1 child processes

Starting copy of cvs_copy_ks.kv with columns [&lt;span class=&quot;code-quote&quot;&gt;&apos;key&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;value&apos;&lt;/span&gt;].
Closing queues...; Rate:       9 rows/s; Avg. rate:       9 rows/s
Processed: 3 rows; Rate:       4 rows/s; Avg. rate:       7 rows/s
3 rows imported from 1 files in 0.449 seconds (0 skipped).
kv.cql:6:NoHostAvailable: (&lt;span class=&quot;code-quote&quot;&gt;&apos;Unable to complete the operation against any hosts&apos;&lt;/span&gt;, {})
kv.cql:7:NoHostAvailable: (&lt;span class=&quot;code-quote&quot;&gt;&apos;Unable to complete the operation against any hosts&apos;&lt;/span&gt;, {})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You should be able to reproduce this fairly easily since the workaround has been commented out. I typically run it 5 or 6 times before reproducing it. To give you some context on the test, &lt;tt&gt;copy cvs_copy_ks.kv (key, value) from &apos;kv.csv&apos; with header=&apos;true&apos; and numprocesses=1;&lt;/tt&gt; will spawn a Python child process to import kv.csv into Cassandra. This command works but the two following commands fail with &lt;tt&gt;NoHostAvailable&lt;/tt&gt;, which indicate that the server did not respond to cqlsh, plus we see the exception in the logs. You also find a file called &lt;tt&gt;loop.sh&lt;/tt&gt; if you want to run the test several times.&lt;/p&gt;

&lt;p&gt;I hope I haven&apos;t forgotten any steps, if you run into trouble do not hesitate to let me know. The instructions on generating certificates have a couple of typos, unfortunately I did not save the exact commands I&apos;ve used. You are probably familiar with those commands but if not let me know and I&apos;ll recreate the certificates and give you the exact commands.&lt;/p&gt;</comment>
                            <comment id="15302207" author="JIRAUSER308715" created="Thu, 26 May 2016 15:11:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=norman&quot; class=&quot;user-hover&quot; rel=&quot;norman&quot;&gt;norman&lt;/a&gt; have you had a chance to look into this at all?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Stefania&quot; class=&quot;user-hover&quot; rel=&quot;stefania&quot;&gt;Stefania&lt;/a&gt; maybe we should put the hack in place for now?&lt;/p&gt;</comment>
                            <comment id="15302311" author="norman" created="Thu, 26 May 2016 16:04:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jjordan&quot; class=&quot;user-hover&quot; rel=&quot;jjordan&quot;&gt;jjordan&lt;/a&gt; Only very briefly but my suspection so far is that it is actually a race in cqlsh where two multiple threads write to the same connection concurrently. Like one writes and the second starts to write as well before the first is complete. Could this be possible ? This would also explain why a sleep may &quot;workaround&quot; this.&lt;/p&gt;</comment>
                            <comment id="15303485" author="stefania" created="Fri, 27 May 2016 04:57:45 +0000"  >&lt;p&gt;Thanks for the pointer &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=norman&quot; class=&quot;user-hover&quot; rel=&quot;norman&quot;&gt;norman&lt;/a&gt;: it&apos;s not a race amongst multiple threads but something similar. There is an out-of-band connection that the clients create so that the server can push notifications for things like schema changes and so forth. The forked copy processes are inheriting the socket handle from the parent cqlsh process. Releasing these socket handles in the forked processes fixes it &lt;em&gt;provided it is done as soon as possible&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aholmber&quot; class=&quot;user-hover&quot; rel=&quot;aholmber&quot;&gt;aholmber&lt;/a&gt;: We can fix this by calling &lt;tt&gt;cluster.shutdown()&lt;/tt&gt; as soon as the child processes start running but, I think we could still have a small window if a notification is received before the sockets have been closed. I&apos;m not sure I understood the driver debug messages entirely, I&apos;ve attached them in this file here &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12806559/12806559_driver_debug.txt&quot; title=&quot;driver_debug.txt attached to CASSANDRA-11749&quot;&gt;driver_debug.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;. We can see &lt;tt&gt;[control connection] Waiting for schema agreement&lt;/tt&gt; logged by the parent process and then the bad record MAC received by both parent and child process. Is there anything else that could be done to avoid this race totally?&lt;/p&gt;

&lt;p&gt;The fix in cqlsh copyutil is &lt;a href=&quot;https://github.com/stef1927/cassandra/commit/3fb2e0c286f5f4ae42e1e877d7635604b1896a09&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15303499" author="norman" created="Fri, 27 May 2016 05:08:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Stefania&quot; class=&quot;user-hover&quot; rel=&quot;stefania&quot;&gt;Stefania&lt;/a&gt; no problems... Sorry that it took me so long &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15303588" author="stefania" created="Fri, 27 May 2016 06:08:48 +0000"  >&lt;p&gt;No worries, thanks for taking the time to look into this! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15303660" author="JIRAUSER308715" created="Fri, 27 May 2016 06:55:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Stefania&quot; class=&quot;user-hover&quot; rel=&quot;stefania&quot;&gt;Stefania&lt;/a&gt; I can think of a couple ways.&lt;br/&gt;
1. Don&apos;t fork to do copy, make a new process&lt;br/&gt;
2. Fork right at startup before opening the connection&lt;br/&gt;
3. Shutdown the cluster object before forking to start new ones in both parent and child.&lt;/p&gt;

&lt;p&gt;Of the 3 I would probably think just doing shutdown, fork, connect is easiest.&lt;/p&gt;</comment>
                            <comment id="15303688" author="stefania" created="Fri, 27 May 2016 07:14:30 +0000"  >&lt;p&gt;Thanks for the suggestions &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jjordan&quot; class=&quot;user-hover&quot; rel=&quot;jjordan&quot;&gt;jjordan&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;1. This is only available with Python 3.4+ unfortunately (doc &lt;a href=&quot;https://docs.python.org/3/library/multiprocessing.html#multiprocessing.set_start_method&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;) and also forking is much faster than spawing.&lt;/p&gt;

&lt;p&gt;2. This seems a bit too complicated and wasteful if I understood it correctly, unless we somehow use a fork server, which again is only available in Python 3.4, we need to know in advance how many child processes we need, which could change depending on the copy command options.&lt;/p&gt;

&lt;p&gt;3. This is the easiest and safest solution. I thought about it as well but it seems wrong to me that we need to shut down the main cqlsh connection only to reopen it later on, that&apos;s why I wanted &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aholmber&quot; class=&quot;user-hover&quot; rel=&quot;aholmber&quot;&gt;aholmber&lt;/a&gt;&apos;s opinion. Maybe there is a way to stop the control connection only, or maybe the child control connection is trying to write to the socket as well, and this can be avoided by detecting the fork. It does not show in the logs but maybe there aren&apos;t any logs printed at all and hence I wanted confirmation first.&lt;/p&gt;</comment>
                            <comment id="15308147" author="aholmber" created="Tue, 31 May 2016 17:13:16 +0000"  >&lt;p&gt;The driver should handle this better. There is fork detection, but it doesn&apos;t go far enough when examined in the context of this issue. I created &lt;a href=&quot;https://datastax-oss.atlassian.net/browse/PYTHON-577&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PYTHON-577&lt;/a&gt; to address this. In the mean time, your approach of shutting down the parent cluster in the child process should remove the problem without a race, provided the shutdown is before the child Cluster/Session is created. This effectively cleans up inherited sockets before the new child event loop is started.&lt;/p&gt;</comment>
                            <comment id="15309486" author="stefania" created="Wed, 1 Jun 2016 07:15:52 +0000"  >&lt;p&gt;Thanks for looking into this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aholmber&quot; class=&quot;user-hover&quot; rel=&quot;aholmber&quot;&gt;aholmber&lt;/a&gt;. You&apos;re correct: when I experienced races I was definitely shutting down the cluster after creating the new session.&lt;/p&gt;

&lt;p&gt;Here is the full patch, the 2.1 patch applies to 2.2 as well, and the 3.0 patch up-merges without conflicts:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.7&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11749-cqlsh-2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11749-cqlsh-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11749-cqlsh-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11749-cqlsh-3.7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11749-cqlsh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11749-cqlsh-2.1-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11749-cqlsh-2.2-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11749-cqlsh-3.0-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11749-cqlsh-3.7-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11749-cqlsh-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I&apos;ve also launched the dtests for 2.2 on Windows &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11749-cqlsh-2.2-windows-dtest_win32/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thobbs&quot; class=&quot;user-hover&quot; rel=&quot;thobbs&quot;&gt;thobbs&lt;/a&gt; would you mind reviewing this small patch to shut down the parent cluster after forking child processes? The parent cluster is shutdown also in the feeding process even though we strictly don&apos;t need to do this for this process, since it does not connect to Cassandra. However, it is cleaner to shut it down. Also, we now create a new &lt;tt&gt;PlainTextAuthProvider&lt;/tt&gt; rather than sharing the one of the parent. On Windows, to avoid pickle-ability problems, we don&apos;t pass the parent connection to the child processes, we don&apos;t need to shutdown the parent connections on Windows because processes are spawned and not forked.&lt;/p&gt;</comment>
                            <comment id="15310349" author="stefania" created="Wed, 1 Jun 2016 14:00:15 +0000"  >&lt;p&gt;I&apos;ve reverted the changes for &lt;tt&gt;PlainTextAuthProvider&lt;/tt&gt; since they were not necessary and were causing problems. I&apos;ve restarted the tests for 2.1, if they are OK I&apos;ll restart the other branches as well.&lt;/p&gt;</comment>
                            <comment id="15310596" author="thobbs" created="Wed, 1 Jun 2016 16:35:35 +0000"  >&lt;p&gt;Sure, I can review.&lt;/p&gt;</comment>
                            <comment id="15314722" author="thobbs" created="Fri, 3 Jun 2016 20:17:01 +0000"  >&lt;p&gt;The patch looks good to me.  However, it looks like the Windows dtest run needs to be done again (I&apos;m guessing it didn&apos;t get the &lt;tt&gt;PlainTextAuthProvider&lt;/tt&gt; revert).  Assuming that test has no problems, +1 from me.&lt;/p&gt;</comment>
                            <comment id="15316239" author="stefania" created="Mon, 6 Jun 2016 06:30:53 +0000"  >&lt;p&gt;Thanks for the review. You&apos;re correct regarding Windows dtests: I aborted them before the &lt;tt&gt;PlainTextAuthProvider&lt;/tt&gt; revert, and then forgot to restart them.&lt;/p&gt;

&lt;p&gt;I&apos;ve just started them now, I will commit if the results on Windows are also good.&lt;/p&gt;</comment>
                            <comment id="15325275" author="stefania" created="Fri, 10 Jun 2016 21:01:33 +0000"  >&lt;p&gt;Committed to 2.1 as 68319f7c3be232a58e68ca91206283076aa3dedb and merged upwards.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13323097">CASSANDRA-16053</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12806559" name="driver_debug.txt" size="14132" author="stefania" created="Fri, 27 May 2016 04:10:01 +0000"/>
                            <attachment id="12803378" name="stdout.txt.zip" size="534198" author="stefania" created="Wed, 11 May 2016 07:30:24 +0000"/>
                            <attachment id="12803570" name="stdout_single_process.txt.zip" size="55263" author="stefania" created="Thu, 12 May 2016 04:35:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 23 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2xjxb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>thobbs</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>