<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:11:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-14388] Fix setting min/max compaction threshold with LCS</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-14388</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;To be able to actually set max/min_threshold in compaction options we need to remove it from the options map when validating.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13152896">CASSANDRA-14388</key>
            <summary>Fix setting min/max compaction threshold with LCS</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marcuse">Marcus Eriksson</assignee>
                                    <reporter username="marcuse">Marcus Eriksson</reporter>
                        <labels>
                            <label>lcs</label>
                    </labels>
                <created>Tue, 17 Apr 2018 05:43:58 +0000</created>
                <updated>Fri, 15 May 2020 08:00:00 +0000</updated>
                            <resolved>Tue, 19 Jun 2018 16:04:16 +0000</resolved>
                                        <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Local/Compaction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16440430" author="krummas" created="Tue, 17 Apr 2018 05:55:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/14388&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/14388&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This patch also replaces the use of &lt;tt&gt;MAX_COMPACTING_L0&lt;/tt&gt; with &lt;tt&gt;max_threshold&lt;/tt&gt; in &lt;tt&gt;LeveledManifest&lt;/tt&gt; - not 100% sure this is the best way since it will increase the number of sstables needed to run STCS in L0, but at the same time it will run actual LCS with more sstables. An alternative would be to check if there is more than 32 (&lt;tt&gt;MAX_COMPACTING_L0&lt;/tt&gt;) sstables in L0, if so, grab &lt;tt&gt;max_threshold&lt;/tt&gt; sstables and run STCS on them, wdyt &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnlwsu&quot; class=&quot;user-hover&quot; rel=&quot;cnlwsu&quot;&gt;cnlwsu&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="16440896" author="cnlwsu" created="Tue, 17 Apr 2018 14:11:15 +0000"  >&lt;p&gt;I like the&#160;alternative personally&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;An alternative would be to check if there is more than 32 (&lt;tt&gt;MAX_COMPACTING_L0&lt;/tt&gt;) sstables in L0, if so, grab &lt;tt&gt;max_threshold&lt;/tt&gt; sstables and run STCS on them&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Thinking mostly for cases when its critically&#160;far behind (ie 50k in L0) and a lot are tiny (from bad repairs), just want to quickly reduce the number of them. The &lt;tt&gt;MAX_COMPACTING_L0&lt;/tt&gt; I&#160;think makes sense for normal use, but when theres a huge backlog just want STCS to chew up backlog faster than 32 at a time. But if increase L0 max compacting to 1000 it may not kick off STCS until already negatively impacting things.&lt;/p&gt;

&lt;p&gt;Might be nice to have &lt;tt&gt;MAX_COMPACTING_L0&lt;/tt&gt;&#160;as another table option but that could be done another ticket.&lt;/p&gt;</comment>
                            <comment id="16442014" author="krummas" created="Wed, 18 Apr 2018 07:12:19 +0000"  >&lt;p&gt;pushed a commit with MAX_COMPACTING_L0 as the trigger for STCS in L0: &lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/14388&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/14388&lt;/a&gt;&lt;br/&gt;
tests: &lt;a href=&quot;https://circleci.com/gh/krummas/cassandra/tree/marcuse%2F14388&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/gh/krummas/cassandra/tree/marcuse%2F14388&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16494790" author="ifesdjeen" created="Wed, 30 May 2018 07:21:15 +0000"  >&lt;p&gt;Should we add a news entry about the fact that &lt;tt&gt;MAX_COMPACTING_L0&lt;/tt&gt; will now be overridden by the CFS max compaction threshold? And/or a ticket to make &lt;tt&gt;MAX_COMPACTING_L0&lt;/tt&gt; configurable.&lt;/p&gt;</comment>
                            <comment id="16494894" author="krummas" created="Wed, 30 May 2018 08:55:25 +0000"  >&lt;p&gt;setting &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt; as reviewer&lt;/p&gt;

&lt;p&gt;Pushed a commit with an updated NEWS.txt entry - we could make MAX_COMPACTING_L0 configurable later if someone thinks it is necessary but 32 seems to be a good value right now, especially after this since it will only decide when to run a STCS compaction&lt;/p&gt;</comment>
                            <comment id="16517264" author="ifesdjeen" created="Tue, 19 Jun 2018 16:03:56 +0000"  >&lt;p&gt;Committed as d52bdaefda366b4485acb4e8852b3c0549b184bd to &lt;a href=&quot;https://github.com/apache/cassandra/commit/d52bdaefda366b4485acb4e8852b3c0549b184bd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;.&lt;br/&gt;
Thank you for the patch!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12999380">CASSANDRA-12526</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 22 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3smnb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ifesdjeen</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>