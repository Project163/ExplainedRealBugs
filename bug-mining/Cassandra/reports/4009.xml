<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:59:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10541] cqlshlib tests cannot run on Windows</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10541</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;If I try to run the &lt;tt&gt;cqlshlib&lt;/tt&gt; tests on Windows, I got the following error:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;======================================================================&lt;br/&gt;
ERROR: Failure: AttributeError (&apos;module&apos; object has no attribute &apos;symlink&apos;)&lt;br/&gt;
----------------------------------------------------------------------&lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
  File &quot;C:\Python27\lib\site-packages\nose\loader.py&quot;, line 414, in loadTestsFromName&lt;br/&gt;
    addr.filename, addr.module)&lt;br/&gt;
  File &quot;C:\Python27\lib\site-packages\nose\importer.py&quot;, line 47, in importFromPath&lt;br/&gt;
    return self.importFromDir(dir_path, fqname)&lt;br/&gt;
  File &quot;C:\Python27\lib\site-packages\nose\importer.py&quot;, line 94, in importFromDir&lt;br/&gt;
    mod = load_module(part_fqname, fh, filename, desc)&lt;br/&gt;
  File &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;\pylib\cqlshlib\test&amp;#95;&lt;em&gt;init&lt;/em&gt;_.py&quot;, line 17, in &amp;lt;module&amp;gt;&lt;br/&gt;
    from .cassconnect import create_test_db, remove_test_db&lt;br/&gt;
  File &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;\pylib\cqlshlib\test\cassconnect.py&quot;, line 22, in &amp;lt;module&amp;gt;&lt;br/&gt;
    from .basecase import cql, cqlsh, cqlshlog, TEST_HOST, TEST_PORT, rundir&lt;br/&gt;
  File &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;\pylib\cqlshlib\test\basecase.py&quot;, line 43, in &amp;lt;module&amp;gt;&lt;br/&gt;
    os.symlink(path_to_cqlsh, modulepath)&lt;br/&gt;
AttributeError: &apos;module&apos; object has no attribute &apos;symlink&apos;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------------&lt;br/&gt;
Ran 1 test in 0.002s&lt;/p&gt;

&lt;p&gt;FAILED (errors=1)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The problem comes from the fact tha Windows has no support for symlinks.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12905451">CASSANDRA-10541</key>
            <summary>cqlshlib tests cannot run on Windows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pauloricardomg">Paulo Motta</assignee>
                                    <reporter username="blerer">Benjamin Lerer</reporter>
                        <labels>
                            <label>cqlsh</label>
                            <label>windows</label>
                    </labels>
                <created>Fri, 16 Oct 2015 09:06:10 +0000</created>
                <updated>Wed, 15 Oct 2025 09:49:07 +0000</updated>
                            <resolved>Fri, 18 Dec 2015 22:52:08 +0000</resolved>
                                        <fixVersion>2.2.5</fixVersion>
                    <fixVersion>3.0.3</fixVersion>
                    <fixVersion>3.2</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14981638" author="pauloricardomg" created="Fri, 30 Oct 2015 00:23:34 +0000"  >&lt;p&gt;I fixed the symlink problem quite easily with this &lt;a href=&quot;https://github.com/pauloricardomg/cassandra/commit/a8b59ca76d454b6d5eedf49145833e4cb3ed7632&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;commit&lt;/a&gt;, then I hit a dead end: the cqlsh tests are all based on the &lt;a href=&quot;https://docs.python.org/2/library/pty.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pty&lt;/a&gt; &lt;b&gt;linux-only&lt;/b&gt; module to interact with the cqlsh terminal, and I didn&apos;t find any suitable replacement on WIndows. So, I see 3 bad options here:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Do our own interacting with the shell via python ctypes and Win32 API (dangerous territory)&lt;/li&gt;
	&lt;li&gt;Reimplement the tests using deprecated/unmaintained and possibly broken libraries &lt;a href=&quot;https://bitbucket.org/geertj/winpexpect/overview&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;winpexpect&lt;/a&gt; or &lt;a href=&quot;https://gist.github.com/anthonyeden/8488763&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;WExpect&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Run interactive pseudo-terminal based cqlsh tests only on linux, and use &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/tree/master/cqlsh_tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;cqlsh dtests&lt;/a&gt; for non-interactive tests on both platforms.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Any suggestions &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=JoshuaMcKenzie&quot; class=&quot;user-hover&quot; rel=&quot;JoshuaMcKenzie&quot;&gt;JoshuaMcKenzie&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="14982858" author="mambocab" created="Fri, 30 Oct 2015 16:50:16 +0000"  >&lt;p&gt;Is there a reason this can&apos;t be rewritten using &lt;tt&gt;Popen&lt;/tt&gt; or other cross-platform tools in &lt;tt&gt;subprocess&lt;/tt&gt;? I believe that&apos;s is what the dtests and &lt;tt&gt;ccmlib&lt;/tt&gt; use to programmatically run cqlsh.&lt;/p&gt;</comment>
                            <comment id="14982964" author="jmckenzie" created="Fri, 30 Oct 2015 17:49:09 +0000"  >&lt;p&gt;I&apos;d be inclined to go the route of opening an external process w/a specific command-line and checking return value if it&apos;s possible. If not, option #3 above is the only real palatable one, and take into consideration what tests / functionality we already have or could get coverage for via dtests.&lt;/p&gt;</comment>
                            <comment id="15008770" author="pauloricardomg" created="Tue, 17 Nov 2015 14:54:20 +0000"  >&lt;p&gt;Most of the tests (except the auto-completion suite) were fixed on Windows with &lt;tt&gt;subprocess&lt;/tt&gt;. Luckily the code was well modularized and allowed to replace the posix-only pty terminal-access module with a custom WinPty emulation based on &lt;tt&gt;subprocess&lt;/tt&gt;. &lt;/p&gt;

&lt;p&gt;The problem of accessing a subprocess interactively with &lt;tt&gt;subprocess.PIPE&lt;/tt&gt; is that &lt;tt&gt;subproc.stdout.read&lt;/tt&gt; blocks until new data is present, so I used a trick (described in &lt;a href=&quot;http://eyalarubas.com/python-subproc-nonblock.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this blog post&lt;/a&gt;) that uses another thread to read characters in the background from stdout and put them in a queue which is consumed by the testing thread without blocking. This trick is not necessary in dtests because all input is piped to the process, which processes it and exits, and then all the output is verified at once. The cqlshlib tests executes each command interactively and checks the output after each command.&lt;/p&gt;

&lt;p&gt;Some other fixes:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Replace the symlink trick to load cqlsh as a module with creating an empty &lt;tt&gt;_&lt;em&gt;init&lt;/em&gt;_.py&lt;/tt&gt; file during tests on &lt;tt&gt;cassandra/bin&lt;/tt&gt;, so python will allow loading &lt;tt&gt;cqlsh.py&lt;/tt&gt; as a module on both windows and Linux.&lt;/li&gt;
	&lt;li&gt;Replaced the signal-based timeout handling on Windows with the eventlet library, which is now necessary to run cqlshlib tests on Windows.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Although this was sufficient to fix the &lt;tt&gt;test_cqlsh_output.py&lt;/tt&gt; and &lt;tt&gt;test_cql_parsing.py&lt;/tt&gt; suites, it did not fix the command completion tests of &lt;tt&gt;test_cqlsh_completion.py&lt;/tt&gt;, probably because readline disables auto-completing from stdin piped input. For now, I disabled these tests on Windows and created &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10720&quot; title=&quot;Create platform-independent cqlsh auto-completion tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10720&quot;&gt;CASSANDRA-10720&lt;/a&gt; to create platform-independent auto-completion tests.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mambocab&quot; class=&quot;user-hover&quot; rel=&quot;mambocab&quot;&gt;mambocab&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=philipthompson&quot; class=&quot;user-hover&quot; rel=&quot;philipthompson&quot;&gt;philipthompson&lt;/a&gt; any volunteer to review? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Also, could we set up a Windows/Linux cqlshlib cassci run with this branch?&lt;/p&gt;

&lt;p&gt;Tests will appear shortly below:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...pauloricardomg:2.2-10541&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.0...pauloricardomg:3.0-10541&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...pauloricardomg:trunk-10541&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.2-10541-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10541-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-10541-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.2-10541-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10541-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-10541-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15011889" author="mambocab" created="Wed, 18 Nov 2015 20:27:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; I&apos;ve set up jobs for your branch on on Windows and Linux&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Windows&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://cassci.datastax.com/job/mambocab-scratch_cqlshlib_tests-linux-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Linux&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15012019" author="mambocab" created="Wed, 18 Nov 2015 21:29:05 +0000"  >&lt;p&gt;Review:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...pauloricardomg:2.2-10541#diff-d282de1646d1226964b9253414b38069R531&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;This logic&lt;/a&gt; would be easier to read as&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; c.realtty:
    ...
    i = 1
&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;:
    i = 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;also, &lt;tt&gt;i&lt;/tt&gt; should have a more descriptive name.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;spelling errors in the comments &lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...pauloricardomg:2.2-10541#diff-43a61e69174a5b963a3b61acaf2c1d5fR29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here (pottentially -&amp;gt; potentially)&lt;/a&gt; and &lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...pauloricardomg:2.2-10541#diff-43a61e69174a5b963a3b61acaf2c1d5fR38&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here (assynchronously -&amp;gt; assynchronously)&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Was &lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...pauloricardomg:2.2-10541#diff-d282de1646d1226964b9253414b38069L372&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this assertion&lt;/a&gt; deleted intentionally?&lt;/li&gt;
	&lt;li&gt;Could you run the WinPty file through PEP8? There are definitely some style errors in there; I&apos;m not sure why the dtest that PEP8s the cqlshlib module passes. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=philipthompson&quot; class=&quot;user-hover&quot; rel=&quot;philipthompson&quot;&gt;philipthompson&lt;/a&gt; any thoughts on that one?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Other than those comments, these look good! That WinPty implementation is impressive. I&apos;ll set up CassCI jobs for the other branches as well and post links here.&lt;/p&gt;</comment>
                            <comment id="15012062" author="mambocab" created="Wed, 18 Nov 2015 21:45:20 +0000"  >&lt;p&gt;Tests:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Linux&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Windows&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-linux-2.2-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-2.2-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-linux-3.0-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-3.0-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-linux-trunk-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-trunk-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15023476" author="pauloricardomg" created="Tue, 24 Nov 2015 00:35:46 +0000"  >&lt;p&gt;Windows test results are a bit strange. There was &lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-3.0-paulomotta/12/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;one success&lt;/a&gt; in the 3.0 branch, and different failures on different test runs:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-trunk-paulomotta/2/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build/checkout failures&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-2.2-paulomotta/2/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;control connection errors&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-2.2-paulomotta/1/testReport/junit/cqlshlib.test.test_cqlsh_output/TestCqlshOutput/test_describe_columnfamily_output/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;assertion errors&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-2.2-paulomotta/1/testReport/junit/cqlshlib.test.test_cqlsh_output/TestCqlshOutput/test_describe_schema_output/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;type parsing errors&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;m not able to reproduce any of these errors locally. I wonder if there&apos;s something strange with the environment? Is the environment setup in the same way as on Linux? What python version is it running? How is the cassandra test instance instantiated? Any thoughts &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mambocab&quot; class=&quot;user-hover&quot; rel=&quot;mambocab&quot;&gt;mambocab&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="15041706" author="pauloricardomg" created="Fri, 4 Dec 2015 16:30:20 +0000"  >&lt;p&gt;I rebased and fixed minor conflicts. It seems the 2.2 windows branch is &lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-2.2-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;fixed&lt;/a&gt;, while &lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-3.0-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt; and &lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-trunk-paulomotta/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt; are not able to checkout the rebased version with the following error:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;16:16:27 FATAL: Could not checkout 0be57425173f9afa12864ac830ddfeb0b38e0421
16:16:27 hudson.plugins.git.GitException: Could not checkout 0be57425173f9afa12864ac830ddfeb0b38e0421
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That&apos;s super-strange, since 2.2 is correctly fetching the new version. Any idea of what might be happening here? Could you maybe reset the state somehow so it would make a clean pull? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mambocab&quot; class=&quot;user-hover&quot; rel=&quot;mambocab&quot;&gt;mambocab&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="15041733" author="mambocab" created="Fri, 4 Dec 2015 16:41:48 +0000"  >&lt;p&gt;The problem seems to be here:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;16:16:27 Caused by: hudson.plugins.git.GitException: Command &lt;span class=&quot;code-quote&quot;&gt;&quot;git checkout -f 0be57425173f9afa12864ac830ddfeb0b38e0421&quot;&lt;/span&gt; returned status code 128:
16:16:27 stdout: 
16:16:27 stderr: fatal: cannot create directory at &lt;span class=&quot;code-quote&quot;&gt;&apos;test/data/migration-sstables/2.2/system/compactions_in_progress-55080ab05d9c388690a4acb25fe1f77b/snapshots/1435298241281-upgrade-3.0.0-SNAPSHOT-2.2.0-rc1-SNAPSHOT&apos;&lt;/span&gt;: Filename too &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(from &lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-3.0-paulomotta/19/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-3.0-paulomotta/19/console&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; I believe you&apos;re a more experienced Windows admin than I am &amp;#8211; what&apos;s a good workaround for this? A quick search turns up this:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/22575662/filename-too-long-in-git-for-windows&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/22575662/filename-too-long-in-git-for-windows&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There are a number of suggestions here, but I don&apos;t know how to evaluate them.&lt;/p&gt;</comment>
                            <comment id="15050952" author="pauloricardomg" created="Thu, 10 Dec 2015 13:18:10 +0000"  >&lt;p&gt;I updated the branch addressing your review, rebased and resubmitted tests.&lt;/p&gt;

&lt;p&gt;The windows tests are still a bit unstable due to environment problems which I believe will be fixed with &lt;a href=&quot;https://github.com/pcmanus/ccm/issues/423&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ccm PR #423&lt;/a&gt;. When they do not fail due to these problems they are working correctly on &lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-3.0-paulomotta/53/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt; and &lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-3.0-paulomotta/53/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;. However, on &lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-2.2-paulomotta/14/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt; the &lt;a href=&quot;http://cassci.datastax.com/view/All_Jobs/job/mambocab-scratch_cqlshlib_tests-windows-2.2-paulomotta/14/testReport/cqlshlib.test.test_cqlsh_output/TestCqlshOutput/test_describe_columnfamily_output/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;test_describe_columnfamily_output&lt;/a&gt; is failing only on CI with:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;First differing element 19:
    AND caching = {&apos;keys&apos;: &apos;ALL&apos;, &apos;rows_per_partition&apos;: &apos;NONE&apos;}
    AND caching = &apos;{&quot;keys&quot;:&quot;ALL&quot;, &quot;rows_per_partition&quot;:&quot;NONE&quot;}&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This problem was &lt;a href=&quot;https://github.com/apache/cassandra/commit/f3cd3ed7bba7146c1410bc6b3e15b5cad3311f76&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;fixed before&lt;/a&gt; on &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-3.0/pylib/cqlshlib/test/test_cqlsh_output.py#L598&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt; on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10289&quot; title=&quot;Fix cqlshlib tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10289&quot;&gt;&lt;del&gt;CASSANDRA-10289&lt;/del&gt;&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mambocab&quot; class=&quot;user-hover&quot; rel=&quot;mambocab&quot;&gt;mambocab&lt;/a&gt; do you remember why that happened in the first place and why it did not affect &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-2.2/pylib/cqlshlib/test/test_cqlsh_output.py#L598&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt; ? The funny thing is that on 2.2 that test works on both Linux and Windows locally, and fails only on CI on Windows, so I suspect this is an environmental problem. Could you maybe compare the python versions and libraries installed on Windows and Linux boxes?&lt;/p&gt;</comment>
                            <comment id="15051745" author="mambocab" created="Thu, 10 Dec 2015 22:16:18 +0000"  >&lt;blockquote&gt;&lt;p&gt;do you remember why that happened in the first place and why it did not affect 2.2 ? The funny thing is that on 2.2 that test works on both Linux and Windows locally, and fails only on CI on Windows, so I suspect this is an environmental problem. Could you maybe compare the python versions and libraries installed on Windows and Linux boxes?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That is odd. I&apos;d be surprised if it weren&apos;t environmental. I&apos;ve looked at the cqlshlib tests and I&apos;d be comfortable having these changes merged and dealing with environmental issues in a separate ticket. Are you? If so, ping me and I will file followup tickets for investigating that failure and setting up templated jobs for the cqlshlib tests on Windows.&lt;/p&gt;</comment>
                            <comment id="15053744" author="pauloricardomg" created="Fri, 11 Dec 2015 22:59:11 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;ve looked at the cqlshlib tests and I&apos;d be comfortable having these changes merged and dealing with environmental issues in a separate ticket.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That would be better I think. I rebased and fixed a conflict with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10799&quot; title=&quot;2 cqlshlib tests still failing with cythonized driver installation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10799&quot;&gt;&lt;del&gt;CASSANDRA-10799&lt;/del&gt;&lt;/a&gt; and tests look good. Can we mark as ready to commit then?&lt;/p&gt;

&lt;p&gt;We also need to address &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10720&quot; title=&quot;Create platform-independent cqlsh auto-completion tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10720&quot;&gt;CASSANDRA-10720&lt;/a&gt; separately, since completion tests are being currently skipped on Windows.&lt;/p&gt;</comment>
                            <comment id="15056063" author="mambocab" created="Mon, 14 Dec 2015 14:53:23 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can we mark as ready to commit then?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Done.&lt;/p&gt;</comment>
                            <comment id="15064906" author="iamaleksey" created="Fri, 18 Dec 2015 22:51:30 +0000"  >&lt;p&gt;Committed without a CHANGES.txt entry as &lt;a href=&quot;https://github.com/apache/cassandra/commit/9dd2b5ea0f842eb465ad38ac98f9dd987ba6b7d2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;9dd2b5ea0f842eb465ad38ac98f9dd987ba6b7d2&lt;/a&gt; to 2.2, merged with 3.0 and trunk. Thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12913714">CASSANDRA-10720</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2n3sv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>mambocab</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[mambocab]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>