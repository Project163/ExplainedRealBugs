<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:39:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5702] ALTER RENAME is broken in trunk</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5702</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5125&quot; title=&quot;Support indexes on composite column components (clustered columns)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5125&quot;&gt;&lt;del&gt;CASSANDRA-5125&lt;/del&gt;&lt;/a&gt; has broken &lt;tt&gt;ALTER RENAME&lt;/tt&gt; when the column is a default alias (for thrift column families where the PK columns haven&apos;t been renamed yet).&lt;/p&gt;

&lt;p&gt;The problem is basically that while we assign default aliases to PK columns when they don&apos;t have one, we currently &quot;fake&quot; those default aliases and do not persist them. Concretely, CFDefinition is aware of them, but CFMetaData is not, which break renaming post &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5125&quot; title=&quot;Support indexes on composite column components (clustered columns)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5125&quot;&gt;&lt;del&gt;CASSANDRA-5125&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We could fix rename punctually, but there is another related problem: for the same reason, if you try to create an index on a column that is a non-renamed default alias, this doesn&apos;t work with the arguably confusing message &quot;No column definition found for column X&quot;. Here again, we could fix it punctually, but it starts to sound like we need a more general fix.&lt;/p&gt;

&lt;p&gt;So I suggest stopping to &quot;fake&quot; those default aliases, but instead to just create &quot;real&quot; aliases (that are known of CFMetaData and persisted in the schema) when there is none. After all, from a user point of view, why should a default column name be any special. And on top of fixing the issues above, this also:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;fix &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5489&quot; title=&quot;Fix 2.0 key and column aliases serialization and cqlsh DESC SCHEMA&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5489&quot;&gt;&lt;del&gt;CASSANDRA-5489&lt;/del&gt;&lt;/a&gt; in a somewhat simpler way&lt;/li&gt;
	&lt;li&gt;makes it easier for clients reading the schema CFs. They won&apos;t to infer the default aliases anymore.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;The only theoretical downside is that we lose the information that a given CQL3 column name is one assigned by default versus one set up by the user, but given the user can rename those column names anyway, not sure this matters in any way.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12654893">CASSANDRA-5702</key>
            <summary>ALTER RENAME is broken in trunk</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="slebresne">Sylvain Lebresne</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Jun 2013 09:02:39 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:10 +0000</updated>
                            <resolved>Thu, 4 Jul 2013 13:33:52 +0000</resolved>
                                        <fixVersion>2.0 beta 1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13693902" author="iamaleksey" created="Wed, 26 Jun 2013 10:44:36 +0000"  >&lt;p&gt;Thought about this as well (in the context of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5489&quot; title=&quot;Fix 2.0 key and column aliases serialization and cqlsh DESC SCHEMA&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5489&quot;&gt;&lt;del&gt;CASSANDRA-5489&lt;/del&gt;&lt;/a&gt;) and came to the same conclusion.&lt;/p&gt;</comment>
                            <comment id="13693956" author="slebresne" created="Wed, 26 Jun 2013 13:22:20 +0000"  >&lt;p&gt;Attaching patch for this. Note that persisting those default columns implied to only rebuild CQL3 metadata once the CFMetaData is basically complete, hence the patch moves the calls to said rebuild a bit (it&apos;s a good thing anyway, we were calling that rebuild way too often). Also:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the patch fixes a small bug in CFMetaData.isThriftCompatible(). It was excluding way too much stuff post &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5125&quot; title=&quot;Support indexes on composite column components (clustered columns)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5125&quot;&gt;&lt;del&gt;CASSANDRA-5125&lt;/del&gt;&lt;/a&gt;.&lt;/li&gt;
	&lt;li&gt;this happen to lift the limitation introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5531&quot; title=&quot;Disallow renaming columns one at a time when when the table don&amp;#39;t have CQL3 metadata yet&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5531&quot;&gt;&lt;del&gt;CASSANDRA-5531&lt;/del&gt;&lt;/a&gt; (not a big deal but not a bad thing either).&lt;/li&gt;
	&lt;li&gt;I&apos;ve also rewritten CFMetaData.isDense(). I don&apos;t think that was strictly necessary, but while trying to check it wasn&apos;t broken by the patch it felt it could be simplified/clarified.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13694099" author="iamaleksey" created="Wed, 26 Jun 2013 17:25:30 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13694106" author="slebresne" created="Wed, 26 Jun 2013 17:37:10 +0000"  >&lt;p&gt;Committed, thanks&lt;/p&gt;</comment>
                            <comment id="13699226" author="brandon.williams" created="Wed, 3 Jul 2013 17:36:58 +0000"  >&lt;p&gt;This broke the wide_slice_test dtest (which admittedly is using cql2, but we shouldn&apos;t regress there)&lt;/p&gt;</comment>
                            <comment id="13700069" author="slebresne" created="Thu, 4 Jul 2013 13:33:44 +0000"  >&lt;p&gt;Had forgot a toUppercase() call when checking the CQL2 key alias. I&apos;ve committed the trivial fix as b7e49b3.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12589744" name="5702.txt" size="41254" author="slebresne" created="Wed, 26 Jun 2013 13:22:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>335170</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 20 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ltd3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>335494</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aleksey</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>