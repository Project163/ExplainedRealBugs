<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:27:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3424] Selecting just the row_key returns nil instead of just the row_key</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3424</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;CREATE KEYSPACE CassandraCQLTestKeyspace WITH strategy_class=&apos;org.apache.cassandra.locator.SimpleStrategy&apos; AND strategy_options:replication_factor=1&lt;br/&gt;
USE CassandraCQLTestKeyspace&lt;br/&gt;
CREATE COLUMNFAMILY row_key_validation_cf_ascii (id ascii PRIMARY KEY, test_column text)&lt;br/&gt;
INSERT INTO row_key_validation_cf_ascii (id, test_column) VALUES (&apos;test string&apos;, &apos;test&apos;)&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Works as expected&lt;br/&gt;
SELECT * FROM row_key_validation_cf_ascii WHERE id = &apos;test string&apos;&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;Returns an empty result, unexpected&lt;br/&gt;
SELECT id FROM row_key_validation_cf_ascii WHERE id = &apos;test string&apos;&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="12529403">CASSANDRA-3424</key>
            <summary>Selecting just the row_key returns nil instead of just the row_key</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="kreynolds">Kelley Reynolds</reporter>
                        <labels>
                            <label>cql</label>
                    </labels>
                <created>Sun, 30 Oct 2011 12:22:41 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:47 +0000</updated>
                            <resolved>Mon, 2 Apr 2012 16:27:28 +0000</resolved>
                                        <fixVersion>1.0.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13141214" author="jbellis" created="Tue, 1 Nov 2011 14:54:46 +0000"  >&lt;p&gt;Odd, that should be handled by this code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;.                           &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (term.getText().equalsIgnoreCase(keyString))
                            {
                                &lt;span class=&quot;code-comment&quot;&gt;// preserve &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; of key as it was requested
&lt;/span&gt;                                ByteBuffer requestedKey = ByteBufferUtil.bytes(term.getText());
                                thriftColumns.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Column(requestedKey).setValue(row.key.key).setTimestamp(-1));
                                result.schema.name_types.put(requestedKey, TypeParser.getShortName(AsciiType.instance));
                                result.schema.value_types.put(requestedKey, TypeParser.getShortName(metadata.getKeyValidator()));
                                &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
                            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13145954" author="jbellis" created="Mon, 7 Nov 2011 23:50:47 +0000"  >&lt;p&gt;I think we can do a simpler fix actually (v2).  We actually &lt;b&gt;always&lt;/b&gt; want a row in the resultset for each row that exists in the database; the original &quot;skip null CF&quot; code is flat out wrong.  Consider these cases:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SELECT * FROM foo WHERE key = &apos;bar&apos;;
SELECT x..y FROM foo WHERE key = &apos;bar&apos;;
SELECT key, x, y FROM foo WHERE key = &apos;bar&apos;;
SELECT x, y FROM foo WHERE key = &apos;bar&apos;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In none of these cases should we leave the row out of the resultset if there were no columns found (but the row exists).  (Possible exception for the * case aka &quot;range ghosts&quot; but for now that is the behavior we deliver.)&lt;/p&gt;

&lt;p&gt;So, v2 removes the &quot;leave nulls out entirely&quot; check and adds NPE protection to the columnRange case.&lt;/p&gt;</comment>
                            <comment id="13145974" author="xedin" created="Tue, 8 Nov 2011 00:02:28 +0000"  >&lt;p&gt;I was relying on the current logic but in case we always wan&apos;t results than +1.&lt;/p&gt;</comment>
                            <comment id="13145980" author="jbellis" created="Tue, 8 Nov 2011 00:07:55 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                            <comment id="13169740" author="urandom" created="Wed, 14 Dec 2011 21:58:38 +0000"  >&lt;blockquote&gt;
&lt;p&gt;In none of these cases should we leave the row out of the resultset if there were no columns found (but the row exists).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The effect of this change is that a SELECT by-key will always return at least one row result, no matter the key.&lt;/p&gt;

&lt;p&gt;Other than the &lt;tt&gt;row.cf == null&lt;/tt&gt; test, I&apos;m not sure how you would distinguish between a row that existed, or not, when there are no column results to return.&lt;/p&gt;</comment>
                            <comment id="13173306" author="urandom" created="Tue, 20 Dec 2011 16:56:58 +0000"  >&lt;p&gt;This change didn&apos;t do what it was supposed to, and it introduced a breaking CQL change, (which has since made it into stable release updates&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;).  If we&apos;d have caught this before it was rolled into a release, I&apos;d say it warranted an immediate -1 and a revert.&lt;/p&gt;

&lt;p&gt;We haven&apos;t been doing nearly as well as I&apos;d hoped in keeping stability promises, but I might be satisfied to call the original behavior buggy, and the intended behavior of this change as the fix, if it could be made to work the way intended (to return the result &lt;em&gt;if&lt;/em&gt; the row exists).  Can anyone see a way to accomplish that?&lt;/p&gt;</comment>
                            <comment id="13173427" author="jbellis" created="Tue, 20 Dec 2011 19:02:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;This change didn&apos;t do what it was supposed to&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;To be clear, it &lt;b&gt;did&lt;/b&gt; fix the reported problem, of rows not being returned when they &lt;b&gt;did&lt;/b&gt; exist. Of course, now we have the opposite problem, as reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3505&quot; title=&quot;Explicitly requested keys will always be present in resultset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3505&quot;&gt;&lt;del&gt;CASSANDRA-3505&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13173432" author="xedin" created="Tue, 20 Dec 2011 19:06:03 +0000"  >&lt;p&gt;It doesn&apos;t seem possible to distinguish between existing and non-existant keys currently, would it be the good idea to revert this one? Or just close it and move all discussion to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3505&quot; title=&quot;Explicitly requested keys will always be present in resultset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3505&quot;&gt;&lt;del&gt;CASSANDRA-3505&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13174349" author="urandom" created="Wed, 21 Dec 2011 19:39:40 +0000"  >&lt;p&gt;OK, so stepping a back a bit...&lt;/p&gt;

&lt;p&gt;If we have semantics which are stable and expected in some version, and we alter those in a future version (for anything other than a major version change), that is a regression.  So even if this patch had done what it intended to do, it would be a regression, and we have always fixed regressions as quickly as possible.&lt;/p&gt;

&lt;p&gt;While it would make it no less of a regression, if this change had resulted in SQL semantics, it could be considered an improvement, but that is not the case.  The pre-3424 behavior at least benefits from being consistent with how the RPC interface works, and every prior CQL-enabled version of Cassandra.&lt;/p&gt;

&lt;p&gt;So I believe we should revert this change because:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;It signals that we are serious about maintaining the contract we&apos;ve made with our users&lt;/li&gt;
	&lt;li&gt;The original behavior (while not ideal) better satisfies the element of least-surprise&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13174359" author="jbellis" created="Wed, 21 Dec 2011 19:53:00 +0000"  >&lt;p&gt;My point is that by your definition, changing behavior that is &quot;stable and expected&quot; in 1.0.4+, is &lt;b&gt;also&lt;/b&gt; a regression, whether or not it was introduced by a regression itself.&lt;/p&gt;

&lt;p&gt;I do not agree that the original behavior better satisfied least surprise.&lt;/p&gt;</comment>
                            <comment id="13174367" author="jbellis" created="Wed, 21 Dec 2011 19:57:51 +0000"  >&lt;p&gt;I look at it this way: Are there more users of 1.0.0 .. 1.0.3 out there, who will be surprised when they upgrade to 1.0.7 if we leave it be?  Or users of 1.0.4 .. 1.0.6, who will be surprised when they upgrade if we change it?  &lt;b&gt;That&apos;s&lt;/b&gt; the most responsible way to signal we&apos;re taking stability seriously.&lt;/p&gt;

&lt;p&gt;I don&apos;t know for sure, but 1.0.0 .. 1.0.3 had enough problems that I doubt many people are still using them.&lt;/p&gt;</comment>
                            <comment id="13174382" author="urandom" created="Wed, 21 Dec 2011 20:15:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;I look at it this way: Are there more users of 1.0.0 .. 1.0.3 out there, who will be surprised when they upgrade to 1.0.7 if we leave it be?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Shouldn&apos;t we include the versions from the 0.8 series in this as well?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Or users of 1.0.4 .. 1.0.6, who will be surprised when they upgrade if we change it? That&apos;s the most responsible way to signal we&apos;re taking stability seriously.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If you&apos;re suggesting that we fix regressions as soon as they are identified as such, instead of propagating them across 3 more releases because we prefer the new behavior, then I emphatically agree.&lt;/p&gt;</comment>
                            <comment id="13174388" author="jbellis" created="Wed, 21 Dec 2011 20:24:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;Shouldn&apos;t we include the versions from the 0.8 series in this as well?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;IMO?  No, because we changed enough other CQL behavior from 0.8 to 1.0 that they have bigger things to worry about.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If you&apos;re suggesting that we fix regressions as soon as they are identified as such, instead of propagating them across 3 more releases because we prefer the new behavior, then I emphatically agree.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Fine, mea culpa.  We should have reverted this for 1.0.5.  I&apos;m sorry that I had other priorities at the time.  But today the relevant issue is what the responsible thing to do is for 1.0.7 given the background I outlined, not what I should have done a month ago.&lt;/p&gt;</comment>
                            <comment id="13174400" author="jbellis" created="Wed, 21 Dec 2011 20:47:16 +0000"  >&lt;p&gt;I was off on the dates &amp;#8211; I thought 1.0.4 was released before we realized &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3505&quot; title=&quot;Explicitly requested keys will always be present in resultset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3505&quot;&gt;&lt;del&gt;CASSANDRA-3505&lt;/del&gt;&lt;/a&gt; was caused by this, but it was not.  I had time to revert before this regression got into the wild, but didn&apos;t.  Sorry!&lt;/p&gt;</comment>
                            <comment id="13178423" author="urandom" created="Mon, 2 Jan 2012 15:25:18 +0000"  >&lt;p&gt;Updated documentation:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/eevans/cassandra/commit/a8d0135fe008dcb8754dcb9d5a173228bef30e0c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eevans/cassandra/commit/a8d0135fe008dcb8754dcb9d5a173228bef30e0c&lt;/a&gt; (diff) &lt;a href=&quot;https://github.com/eevans/cassandra/tree/3424&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eevans/cassandra/tree/3424&lt;/a&gt; (branch)&lt;/p&gt;</comment>
                            <comment id="13244299" author="jbellis" created="Mon, 2 Apr 2012 16:27:28 +0000"  >&lt;p&gt;Re-resolving as incomplete since &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3982&quot; title=&quot;Explore not returning range ghosts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3982&quot;&gt;&lt;del&gt;CASSANDRA-3982&lt;/del&gt;&lt;/a&gt; is open for the more general problem of range ghosts in general.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12531892">CASSANDRA-3505</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12502844" name="3424-v2.txt" size="2041" author="jbellis" created="Mon, 7 Nov 2011 23:50:47 +0000"/>
                            <attachment id="12502132" name="CASSANDRA-3424.patch" size="2480" author="xedin" created="Thu, 3 Nov 2011 11:43:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>215263</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 34 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gjq7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94626</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>xedin</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[xedin]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>