<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:18:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2081] Consistency QUORUM does not work anymore (hector:Could not fullfill request on this host)</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2081</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I&apos;m using apache-cassandra-2011-01-28_20-06-01.jar and hector 7.0.25.&lt;/p&gt;

&lt;p&gt;Using consistency level Quorum won&apos;t work anymore (tested it on read). Consisteny level ONE still works though&lt;/p&gt;

&lt;p&gt;I have tried this with one dead node in my cluster.&lt;/p&gt;

&lt;p&gt;If I restart cassandra with an older svn revision (apache-cassandra-2011-01-28_20-06-01.jar), I can access the cluster with consistency level QUORUM again, while still using apache-cassandra-2011-01-28_20-06-01.jar and hector 7.0.25 in my application.&lt;/p&gt;


&lt;p&gt;11/01/31 19:54:38 ERROR connection.CassandraHostRetryService: Downed intr1n18(192.168.0.18):9160 host still appears to be down: Unable to open transport to intr1n18(192.168.0.18):9160 , java.net.NoRouteToHostException: No route to host&lt;br/&gt;
11/01/31 19:54:38 INFO connection.CassandraHostRetryService: Downed Host retry status false with host: intr1n18(192.168.0.18):9160&lt;br/&gt;
11/01/31 19:54:45 ERROR connection.HConnectionManager: Could not fullfill request on this host CassandraClient&amp;lt;intr1n11:9160-483&amp;gt;&lt;/p&gt;

&lt;p&gt;intr1n11 is marked as up however and I can also access the node through the cassandra cli.&lt;/p&gt;


&lt;p&gt;192.168.0.1     Up     Normal  8.02 GB         5.00%   0cc&lt;br/&gt;
192.168.0.2     Up     Normal  7.96 GB         5.00%   199&lt;br/&gt;
192.168.0.3     Up     Normal  8.24 GB         5.00%   266&lt;br/&gt;
192.168.0.4     Up     Normal  4.94 GB         5.00%   333&lt;br/&gt;
192.168.0.5     Up     Normal  5.02 GB         5.00%   400&lt;br/&gt;
192.168.0.6     Up     Normal  5 GB            5.00%   4cc&lt;br/&gt;
192.168.0.7     Up     Normal  5.1 GB          5.00%   599&lt;br/&gt;
192.168.0.8     Up     Normal  5.07 GB         5.00%   666&lt;br/&gt;
192.168.0.9     Up     Normal  4.78 GB         5.00%   733&lt;br/&gt;
192.168.0.10    Up     Normal  4.34 GB         5.00%   7ff&lt;br/&gt;
192.168.0.11    Up     Normal  5.01 GB         5.00%   8cc&lt;br/&gt;
192.168.0.12    Up     Normal  5.31 GB         5.00%   999&lt;br/&gt;
192.168.0.13    Up     Normal  5.56 GB         5.00%   a66&lt;br/&gt;
192.168.0.14    Up     Normal  5.82 GB         5.00%   b33&lt;br/&gt;
192.168.0.15    Up     Normal  5.57 GB         5.00%   c00&lt;br/&gt;
192.168.0.16    Up     Normal  5.03 GB         5.00%   ccc&lt;br/&gt;
192.168.0.17    Up     Normal  4.77 GB         5.00%   d99&lt;br/&gt;
192.168.0.18    Down   Normal  ?               5.00%   e66&lt;br/&gt;
192.168.0.19    Up     Normal  4.78 GB         5.00%   f33&lt;br/&gt;
192.168.0.20    Up     Normal  4.83 GB         5.00%   ffffffffffffffff&lt;/p&gt;



</description>
                <environment>&lt;p&gt;linux, hector + cassandra&lt;/p&gt;</environment>
        <key id="12497245">CASSANDRA-2081</key>
            <summary>Consistency QUORUM does not work anymore (hector:Could not fullfill request on this host)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="amorton">Aaron Morton</assignee>
                                    <reporter username="tbritz">Thibaut</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Jan 2011 19:40:13 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:08 +0000</updated>
                            <resolved>Mon, 7 Feb 2011 16:06:12 +0000</resolved>
                                        <fixVersion>0.6.12</fixVersion>
                    <fixVersion>0.7.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12988865" author="jbellis" created="Mon, 31 Jan 2011 19:55:45 +0000"  >&lt;p&gt;What kind of &quot;doesn&apos;t work&quot; are you seeing?&lt;/p&gt;</comment>
                            <comment id="12988867" author="tbritz" created="Mon, 31 Jan 2011 20:01:34 +0000"  >&lt;p&gt;My application hangs/blocks forever as I catch all the Hector exceptions and retry when there was an error.&lt;/p&gt;

&lt;p&gt;Above log file messages will repeat itself again and again.&lt;/p&gt;

&lt;p&gt;There are also no error messages in the cassandra log file.&lt;/p&gt;

&lt;p&gt;Also &quot;Could not fullfill request on this host CassandraClient&quot; is an error message I have never seen before. &lt;/p&gt;</comment>
                            <comment id="12988879" author="jbellis" created="Mon, 31 Jan 2011 20:38:17 +0000"  >&lt;p&gt;Is this RF=3?&lt;/p&gt;

&lt;p&gt;What do you see in the Cassandra log when you set log level to debug, for the queries that Hector gives up on?&lt;/p&gt;

&lt;p&gt;What are the versions you tried that works/doesn&apos;t work?  (In description above both versions are given as apache-cassandra-2011-01-28_20-06-01.jar.)&lt;/p&gt;</comment>
                            <comment id="12988885" author="tbritz" created="Mon, 31 Jan 2011 21:00:39 +0000"  >&lt;p&gt;RF=3&lt;/p&gt;

&lt;p&gt;I will enable the debug log level tomorrow for cassandra, switch back to apache-cassandra-2011-01-28_20-06-01.jar and post you the results.&lt;/p&gt;

&lt;p&gt;The last version that I tried that worked was apache-cassandra-2011-01-24_06-01-26.jar. apache-cassandra-2011-01-28_20-06-01.jar doesn&apos;t work anymore.&lt;/p&gt;</comment>
                            <comment id="12988894" author="brandon.williams" created="Mon, 31 Jan 2011 21:22:00 +0000"  >&lt;p&gt;I&apos;m not able to reproduce with contrib/stress, can you try that?&lt;/p&gt;</comment>
                            <comment id="12989032" author="amorton" created="Tue, 1 Feb 2011 04:46:02 +0000"  >&lt;p&gt;I&apos;ve sort of stumbled onto something similar with an 0.7 install. I need to go home now so cannot dig any deeper and rule out human error, but this is what I have.&lt;/p&gt;

&lt;p&gt;5 node 0.7.0 install&lt;/p&gt;

&lt;p&gt;1) Load data in using&lt;/p&gt;

&lt;p&gt;python stress.py -d jb-cass1,jb-cass2,jb-cass3,jb-cass4,jb-cass5 -o insert -n 1000000 -e QUORUM -t 10 -i 1 -l 3&lt;br/&gt;
(use all 5 nodes, insert 1,000,000 rows with RF 3 and QUORUM and 10 threads, report progress every second)&lt;/p&gt;

&lt;p&gt;2) Read back using &lt;/p&gt;

&lt;p&gt;python stress.py -d jb-cass2,jb-cass3,jb-cass4,jb-cass5 -o read -n 1000000 -e QUORUM -t 10 -i 1&lt;br/&gt;
(note that jb-cass1 is removed from the list)&lt;/p&gt;

&lt;p&gt;3) make big bang&lt;/p&gt;

&lt;p&gt;Once the read has run a few seconds I ran &quot;reboot -f&quot; on node 1. I expect the read operations to complete, output was &lt;/p&gt;

&lt;p&gt;11270,1315,1315,0.00839671943578,9&lt;br/&gt;
11631,361,361,0.00746133188792,11&lt;br/&gt;
11631,0,0,NaN,12&lt;br/&gt;
11631,0,0,NaN,13&lt;br/&gt;
11631,0,0,NaN,14&lt;br/&gt;
11631,0,0,NaN,15&lt;br/&gt;
11631,0,0,NaN,16&lt;br/&gt;
11631,0,0,NaN,17&lt;br/&gt;
11631,0,0,NaN,18&lt;br/&gt;
11631,0,0,NaN,19&lt;br/&gt;
Process Reader-10:&lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
  File &quot;/vol/apps/python-2.6.4_64/lib/python2.6/multiprocessing/process.py&quot;, line 232, in _bootstrap&lt;br/&gt;
    self.run()&lt;br/&gt;
  File &quot;stress.py&quot;, line 279, in run&lt;br/&gt;
    r = self.cclient.get_slice(key, parent, p, consistency)&lt;br/&gt;
  File &quot;/local1/frameworks/cassandra/apache-cassandra-0.7.0-src/contrib/py_stress/cassandra/Cassandra.py&quot;, line 432, in get_slice&lt;br/&gt;
    return self.recv_get_slice()&lt;br/&gt;
  File &quot;/local1/frameworks/cassandra/apache-cassandra-0.7.0-src/contrib/py_stress/cassandra/Cassandra.py&quot;, line 462, in recv_get_slice&lt;br/&gt;
    raise result.te&lt;/p&gt;

&lt;p&gt;All clients died. stress.py is not setting a timeout on the thrift socket, so am guessing this is server side.&lt;/p&gt;

&lt;p&gt;I was running DEBUG on all the nodes (but had turned off the line numbers), this is from one. the 114.63 machine is obviously the one I killed. &lt;/p&gt;


&lt;p&gt;DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,186 StorageService.java (line org.apache.cassandra.service.StorageService) Sorted endpoints are /192.168.114.63,jb08.wetafx.co.nz/192.168.114.67,/192.168.114.64&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,186 QuorumResponseHandler.java (line org.apache.cassandra.service.QuorumResponseHandler) QuorumResponseHandler blocking for 2 responses&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,186 StorageProxy.java (line org.apache.cassandra.service.StorageProxy) strongread reading digest for SliceFromReadCommand(table=&apos;Keyspace1&apos;, key=&apos;30323334343534&apos;, column_parent=&apos;QueryPath(columnFamilyName=&apos;Standard1&apos;, superColumnName=&apos;null&apos;, columnName=&apos;null&apos;)&apos;, start=&apos;&apos;, finish=&apos;&apos;, reversed=false, count=5) from 6624@jb08.wetafx.co.nz/192.168.114.67&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,187 StorageProxy.java (line org.apache.cassandra.service.StorageProxy) strongread reading data for SliceFromReadCommand(table=&apos;Keyspace1&apos;, key=&apos;30323334343534&apos;, column_parent=&apos;QueryPath(columnFamilyName=&apos;Standard1&apos;, superColumnName=&apos;null&apos;, columnName=&apos;null&apos;)&apos;, start=&apos;&apos;, finish=&apos;&apos;, reversed=false, count=5) from 6623@/192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,187 StorageProxy.java (line org.apache.cassandra.service.StorageProxy) strongread reading digest for SliceFromReadCommand(table=&apos;Keyspace1&apos;, key=&apos;30323334343534&apos;, column_parent=&apos;QueryPath(columnFamilyName=&apos;Standard1&apos;, superColumnName=&apos;null&apos;, columnName=&apos;null&apos;)&apos;, start=&apos;&apos;, finish=&apos;&apos;, reversed=false, count=5) from 6624@/192.168.114.64&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:19&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,187 SliceQueryFilter.java (line org.apache.cassandra.db.filter.SliceQueryFilter) collecting 0 of 5: 4330:false:34@1296532428248604&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:19&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,187 SliceQueryFilter.java (line org.apache.cassandra.db.filter.SliceQueryFilter) collecting 1 of 5: 4331:false:34@1296532428248637&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:19&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,187 SliceQueryFilter.java (line org.apache.cassandra.db.filter.SliceQueryFilter) collecting 2 of 5: 4332:false:34@1296532428248640&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:19&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,187 SliceQueryFilter.java (line org.apache.cassandra.db.filter.SliceQueryFilter) collecting 3 of 5: 4333:false:34@1296532428248642&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:19&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,187 SliceQueryFilter.java (line org.apache.cassandra.db.filter.SliceQueryFilter) collecting 4 of 5: 4334:false:34@1296532428248656&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:19&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,187 ReadVerbHandler.java (line org.apache.cassandra.db.ReadVerbHandler) digest is 220b82e28c2bb4be869c168243d75f01&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:19&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,187 ReadVerbHandler.java (line org.apache.cassandra.db.ReadVerbHandler) Read key 30323334343534; sending response to 7D8FA1FD-A2FE-6A54-7BB0-3B129206D1E1@jb08.wetafx.co.nz/192.168.114.67&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:13&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,188 ResponseVerbHandler.java (line org.apache.cassandra.net.ResponseVerbHandler) Processing response on a callback from 7D8FA1FD-A2FE-6A54-7BB0-3B129206D1E1@jb08.wetafx.co.nz/192.168.114.67&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:13&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,188 ReadResponseResolver.java (line org.apache.cassandra.service.ReadResponseResolver) Preprocessed digest response&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:16&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,188 ResponseVerbHandler.java (line org.apache.cassandra.net.ResponseVerbHandler) Processing response on a callback from 7D8FA1FD-A2FE-6A54-7BB0-3B129206D1E1@/192.168.114.64&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:16&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,188 ReadResponseResolver.java (line org.apache.cassandra.service.ReadResponseResolver) Preprocessed digest response&lt;br/&gt;
 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 17:14:15,438 Gossiper.java (line org.apache.cassandra.gms.Gossiper) InetAddress /192.168.114.63 is now dead.&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 17:14:15,440 MessagingService.java (line org.apache.cassandra.net.MessagingService) Resetting pool for /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:14:17,442 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 17:14:18,183 CassandraServer.java (line org.apache.cassandra.thrift.CassandraServer) ... timed out&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; 2011-02-01 17:14:18,189 CassandraServer.java (line org.apache.cassandra.thrift.CassandraServer) ... timed out&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 17:14:18,232 ClientState.java (line org.apache.cassandra.service.ClientState) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; 2011-02-01 17:14:18,232 ClientState.java (line org.apache.cassandra.service.ClientState) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 17:14:29,811 StorageLoadBalancer.java (line org.apache.cassandra.service.StorageLoadBalancer) Disseminating load info ...&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 17:15:29,814 StorageLoadBalancer.java (line org.apache.cassandra.service.StorageLoadBalancer) Disseminating load info ...&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:15:53,637 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:16:08,667 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:16:23,697 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 17:16:29,816 StorageLoadBalancer.java (line org.apache.cassandra.service.StorageLoadBalancer) Disseminating load info ...&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:16:36,723 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:16:50,751 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:17:03,775 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:17:19,807 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 17:17:29,818 StorageLoadBalancer.java (line org.apache.cassandra.service.StorageLoadBalancer) Disseminating load info ...&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:17:32,834 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:17:42,852 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/192.168.114.63&amp;#93;&lt;/span&gt; 2011-02-01 17:17:56,880 OutboundTcpConnection.java (line org.apache.cassandra.net.OutboundTcpConnection) attempting to connect to /192.168.114.63&lt;/p&gt;


&lt;p&gt;need to leave work now so may not be able to get further into this until tomorrow. &lt;/p&gt;</comment>
                            <comment id="12989100" author="amorton" created="Tue, 1 Feb 2011 08:48:51 +0000"  >&lt;p&gt;Had a read through the code for think I have an idea what my problem was, not sure if it applies to the previous issue and not sure if its a real bug. &lt;/p&gt;

&lt;p&gt;o.a.c.service.ReadCallback.response() will only signal the o.a.c.utils.SimpleCondition if the data request has been received. If the signal is not set after rpc_timeout then ReadCallback.get() will raise a j.u.c.TimeoutException() which comes out of the StorageProxy and is caught in CassandraServer and turned into a o.a.c.thrift.TimedOutException. &lt;/p&gt;

&lt;p&gt;So if the node that is asked for the data fails to return, the entire request will timeout even if there are enough nodes to serve the request. I think I&apos;ve seen this discussed before as by design, and the client should just retry in response to the timeout. Is that correct ? &lt;/p&gt;</comment>
                            <comment id="12989150" author="tbritz" created="Tue, 1 Feb 2011 11:04:37 +0000"  >&lt;p&gt;Brandon, I haven&apos;t yet run stress test. I can reproduce this error every single time with a single thread accessing my idle cluster.&lt;/p&gt;

&lt;p&gt;I also reverted to an older version of hector, but this won&apos;t help. As noted before, this error doesn&apos;t occur running apache-cassandra-2011-01-24_06-01-26.jar.&lt;/p&gt;

&lt;p&gt;Here is the debug output of one of the nodes timing out in my application and not returning an answer:&lt;/p&gt;

&lt;p&gt;I only try to access (read/iterator) one single table  &quot;table_usersources&quot;.&lt;/p&gt;

&lt;p&gt;The application runs on node intr1n5 (192.168.0.5) and I added the debug output of intr1n19 (192.168.0.19). The node intr1n18(192.168.0.18) is down and not responding.&lt;/p&gt;

&lt;p&gt;Please let me know if you need more information in order to fix this bug. Thanks!&lt;/p&gt;


&lt;p&gt;Intr1n19:&lt;/p&gt;

&lt;p&gt; INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;HintedHandoff:1&amp;#93;&lt;/span&gt; 2011-02-01 11:47:39,772 HintedHandOffManager.java (line 249) Finished hinted handoff of 0 rows to endpoint /192.168.0.15&lt;br/&gt;
 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 11:47:40,773 Gossiper.java (line 205) InetAddress /192.168.0.10 is now dead.&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 11:47:40,773 MessagingService.java (line 176) Resetting pool for /192.168.0.10&lt;br/&gt;
 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;HintedHandoff:1&amp;#93;&lt;/span&gt; 2011-02-01 11:47:40,775 HintedHandOffManager.java (line 192) Started hinted handoff for endpoint /192.168.0.10&lt;br/&gt;
 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;GossipStage:1&amp;#93;&lt;/span&gt; 2011-02-01 11:47:40,775 Gossiper.java (line 579) InetAddress /192.168.0.10 is now UP&lt;br/&gt;
 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;HintedHandoff:1&amp;#93;&lt;/span&gt; 2011-02-01 11:47:40,775 HintedHandOffManager.java (line 249) Finished hinted handoff of 0 rows to endpoint /192.168.0.10&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-intr1n4/192.168.0.4&amp;#93;&lt;/span&gt; 2011-02-01 11:47:41,479 OutboundTcpConnection.java (line 159) attempting to connect to intr1n4/192.168.0.4&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-intr1n20/192.168.0.20&amp;#93;&lt;/span&gt; 2011-02-01 11:47:42,729 OutboundTcpConnection.java (line 159) attempting to connect to intr1n20/192.168.0.20&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-intr1n11/192.168.0.11&amp;#93;&lt;/span&gt; 2011-02-01 11:47:42,776 OutboundTcpConnection.java (line 159) attempting to connect to intr1n11/192.168.0.11&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-intr1n18/192.168.0.18&amp;#93;&lt;/span&gt; 2011-02-01 11:47:46,781 OutboundTcpConnection.java (line 159) attempting to connect to intr1n18/192.168.0.18&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-intr1n15/192.168.0.15&amp;#93;&lt;/span&gt; 2011-02-01 11:47:50,786 OutboundTcpConnection.java (line 159) attempting to connect to intr1n15/192.168.0.15&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-intr1n10/192.168.0.10&amp;#93;&lt;/span&gt; 2011-02-01 11:47:53,698 OutboundTcpConnection.java (line 159) attempting to connect to intr1n10/192.168.0.10&lt;/p&gt;

&lt;p&gt;DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:15,413 GCInspector.java (line 135) GC for ParNew: 32 ms, 124741344 reclaimed leaving 880060312 used; max is 3289776128&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:24,853 FileUtils.java (line 48) Deleting LocationInfo-f-79-Index.db&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:24,853 FileUtils.java (line 48) Deleting LocationInfo-f-79-Filter.db&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:24,854 FileUtils.java (line 48) Deleting LocationInfo-f-79-Statistics.db&lt;br/&gt;
 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:24,854 SSTable.java (line 147) Deleted /hd2/cassandra_md5/data/system/LocationInfo-f-79&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-intr1n18/192.168.0.18&amp;#93;&lt;/span&gt; 2011-02-01 11:48:28,820 OutboundTcpConnection.java (line 159) attempting to connect to intr1n18/192.168.0.18&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:28,936 CassandraServer.java (line 445) range_slice&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:28,943 StorageProxy.java (line 514) RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,], max_keys=250}
&lt;p&gt;DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:28,943 StorageProxy.java (line 705) restricted ranges for query &lt;span class=&quot;error&quot;&gt;&amp;#91;,&amp;#93;&lt;/span&gt; are [&lt;span class=&quot;error&quot;&gt;&amp;#91;,0cc&amp;#93;&lt;/span&gt;, (0cc,199], (199,266], (266,333], (333,400], (400,4cc], (4cc,599], (599,666], (666,733], (733,7ff], (7ff,8cc], (8cc,999], (999,a66], (a66,b33], (b33,c00], (c00,ccc], (ccc,d99], (d99,e66], (e66,f33], (f33,ffffffffffffffff], (ffffffffffffffff,]]&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:28,949 ReadCallback.java (line 58) ReadCallback blocking for 2 responses&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:28,949 StorageProxy.java (line 562) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,0cc], max_keys=250}
&lt;p&gt; from 269@/192.168.0.1&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:28,949 StorageProxy.java (line 562) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,0cc], max_keys=250}
&lt;p&gt; from 269@/192.168.0.2&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:28,950 StorageProxy.java (line 562) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,0cc], max_keys=250}
&lt;p&gt; from 269@/192.168.0.3&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:28,954 ResponseVerbHandler.java (line 48) Processing response on a callback from 269@/192.168.0.1&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:38,771 StorageLoadBalancer.java (line 349) Disseminating load info ...&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:38,950 CassandraServer.java (line 483) ... timed out&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:38,957 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-intr1n18/192.168.0.18&amp;#93;&lt;/span&gt; 2011-02-01 11:48:44,835 OutboundTcpConnection.java (line 159) attempting to connect to intr1n18/192.168.0.18&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-3&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,275 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-6&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,275 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-7&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-11&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-5&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,277 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-8&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-10&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,277 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-12&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-15&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-14&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-9&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-16&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-13&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-4&amp;#93;&lt;/span&gt; 2011-02-01 11:48:56,278 ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-intr1n18/192.168.0.18&amp;#93;&lt;/span&gt; 2011-02-01 11:48:57,845 OutboundTcpConnection.java (line 159) attempting to connect to intr1n18/192.168.0.18&lt;/p&gt;


&lt;p&gt;Application:&lt;/p&gt;

&lt;p&gt;11:48:25,616 INFO  ~ Registering JMX me.prettyprint.cassandra.service:ServiceType=hector,MonitorType=hector&lt;br/&gt;
11:48:25,652 INFO  ~ get connection for table_lists: consistency: ONE&lt;br/&gt;
11:48:25,695 INFO  ~ get connection for table_lists: consistency: ONE&lt;br/&gt;
11:48:25,825 INFO  ~ Downed Host Retry service started with queue size -1 and retry delay 10s&lt;br/&gt;
11:48:28,887 ERROR ~ Unable to open transport to intr1n18(192.168.0.18):9160&lt;br/&gt;
org.apache.thrift.transport.TTransportException: java.net.NoRouteToHostException: No route to host&lt;br/&gt;
        at org.apache.thrift.transport.TSocket.open(TSocket.java:185)&lt;br/&gt;
        at org.apache.thrift.transport.TFramedTransport.open(TFramedTransport.java:81)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.HThriftClient.open(HThriftClient.java:111)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.ConcurrentHClientPool.&amp;lt;init&amp;gt;(ConcurrentHClientPool.java:44)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.HConnectionManager.&amp;lt;init&amp;gt;(HConnectionManager.java:63)&lt;br/&gt;
        at me.prettyprint.cassandra.service.AbstractCluster.&amp;lt;init&amp;gt;(AbstractCluster.java:62)&lt;br/&gt;
        at me.prettyprint.cassandra.service.AbstractCluster.&amp;lt;init&amp;gt;(AbstractCluster.java:58)&lt;br/&gt;
        at me.prettyprint.cassandra.service.ThriftCluster.&amp;lt;init&amp;gt;(ThriftCluster.java:17)&lt;br/&gt;
        at me.prettyprint.hector.api.factory.HFactory.createCluster(HFactory.java:157)&lt;br/&gt;
        at me.prettyprint.hector.api.factory.HFactory.getOrCreateCluster(HFactory.java:136)&lt;br/&gt;
     ....&lt;br/&gt;
Caused by: java.net.NoRouteToHostException: No route to host&lt;br/&gt;
        at java.net.PlainSocketImpl.socketConnect(Native Method)&lt;br/&gt;
        at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)&lt;br/&gt;
        at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)&lt;br/&gt;
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)&lt;br/&gt;
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)&lt;br/&gt;
        at java.net.Socket.connect(Socket.java:529)&lt;br/&gt;
        at org.apache.thrift.transport.TSocket.open(TSocket.java:180)&lt;br/&gt;
        ... 23 more&lt;br/&gt;
11:48:28,889 ERROR ~ Could not start connection pool for host intr1n18(192.168.0.18):9160&lt;br/&gt;
11:48:28,889 INFO  ~ Host detected as down was added to retry queue: intr1n18(192.168.0.18):9160&lt;br/&gt;
11:48:28,897 INFO  ~ get connection for table_usersources: consistency: QUORUM&lt;br/&gt;
11:48:38,014 ERROR ~ Unable to open transport to intr1n18(192.168.0.18):9160&lt;br/&gt;
org.apache.thrift.transport.TTransportException: java.net.NoRouteToHostException: No route to host&lt;br/&gt;
        at org.apache.thrift.transport.TSocket.open(TSocket.java:185)&lt;br/&gt;
        at org.apache.thrift.transport.TFramedTransport.open(TFramedTransport.java:81)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.HThriftClient.open(HThriftClient.java:111)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.CassandraHostRetryService$RetryRunner.verifyConnection(CassandraHostRetryService.java:116)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.CassandraHostRetryService$RetryRunner.run(CassandraHostRetryService.java:96)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)&lt;br/&gt;
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;br/&gt;
Caused by: java.net.NoRouteToHostException: No route to host&lt;br/&gt;
        at java.net.PlainSocketImpl.socketConnect(Native Method)&lt;br/&gt;
        at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)&lt;br/&gt;
        at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)&lt;br/&gt;
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)&lt;br/&gt;
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)&lt;br/&gt;
        at java.net.Socket.connect(Socket.java:529)&lt;br/&gt;
        at org.apache.thrift.transport.TSocket.open(TSocket.java:180)&lt;br/&gt;
        ... 13 more&lt;br/&gt;
11:48:38,019 ERROR ~ Downed intr1n18(192.168.0.18):9160 host still appears to be down: Unable to open transport to intr1n18(192.168.0.18):9160 , java.net.NoRouteToHostException: No route to host&lt;br/&gt;
11:48:38,020 INFO  ~ Downed Host retry status false with host: intr1n18(192.168.0.18):9160&lt;br/&gt;
11:48:38,956 ERROR ~ Could not fullfill request on this host CassandraClient&amp;lt;intr1n19:9160-594&amp;gt;&lt;br/&gt;
11:48:38,956 ERROR ~ Exception:&lt;br/&gt;
me.prettyprint.hector.api.exceptions.HTimedOutException: TimedOutException()&lt;br/&gt;
        at me.prettyprint.cassandra.service.ExceptionsTranslatorImpl.translate(ExceptionsTranslatorImpl.java:32)&lt;br/&gt;
        at me.prettyprint.cassandra.service.KeyspaceServiceImpl$3.execute(KeyspaceServiceImpl.java:161)&lt;br/&gt;
        at me.prettyprint.cassandra.service.KeyspaceServiceImpl$3.execute(KeyspaceServiceImpl.java:143)&lt;br/&gt;
        at me.prettyprint.cassandra.service.Operation.executeAndSetResult(Operation.java:101)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.HConnectionManager.operateWithFailover(HConnectionManager.java:159)&lt;br/&gt;
        at me.prettyprint.cassandra.service.KeyspaceServiceImpl.operateWithFailover(KeyspaceServiceImpl.java:129)&lt;br/&gt;
        at me.prettyprint.cassandra.service.KeyspaceServiceImpl.getRangeSlices(KeyspaceServiceImpl.java:165)&lt;br/&gt;
        at me.prettyprint.cassandra.model.thrift.ThriftRangeSlicesQuery$1.doInKeyspace(ThriftRangeSlicesQuery.java:67)&lt;br/&gt;
        at me.prettyprint.cassandra.model.thrift.ThriftRangeSlicesQuery$1.doInKeyspace(ThriftRangeSlicesQuery.java:63)&lt;br/&gt;
        at me.prettyprint.cassandra.model.KeyspaceOperationCallback.doInKeyspaceAndMeasure(KeyspaceOperationCallback.java:20)&lt;br/&gt;
        at me.prettyprint.cassandra.model.ExecutingKeyspace.doExecute(ExecutingKeyspace.java:85)&lt;br/&gt;
        at me.prettyprint.cassandra.model.thrift.ThriftRangeSlicesQuery.execute(ThriftRangeSlicesQuery.java:62)&lt;br/&gt;
    ...&lt;br/&gt;
Caused by: TimedOutException()&lt;br/&gt;
        at org.apache.cassandra.thrift.Cassandra$get_range_slices_result.read(Cassandra.java:12104)&lt;br/&gt;
        at org.apache.cassandra.thrift.Cassandra$Client.recv_get_range_slices(Cassandra.java:732)&lt;br/&gt;
        at org.apache.cassandra.thrift.Cassandra$Client.get_range_slices(Cassandra.java:704)&lt;br/&gt;
        at me.prettyprint.cassandra.service.KeyspaceServiceImpl$3.execute(KeyspaceServiceImpl.java:149)&lt;br/&gt;
        ... 23 more&lt;br/&gt;
11:48:48,961 ERROR ~ Could not fullfill request on this host CassandraClient&amp;lt;intr1n17:9160-577&amp;gt;&lt;br/&gt;
11:48:48,961 ERROR ~ Exception:&lt;br/&gt;
me.prettyprint.hector.api.exceptions.HTimedOutException: TimedOutException()&lt;br/&gt;
        at me.prettyprint.cassandra.service.ExceptionsTranslatorImpl.translate(ExceptionsTranslatorImpl.java:32)&lt;br/&gt;
        at me.prettyprint.cassandra.service.KeyspaceServiceImpl$3.execute(KeyspaceServiceImpl.java:161)&lt;br/&gt;
        at me.prettyprint.cassandra.service.KeyspaceServiceImpl$3.execute(KeyspaceServiceImpl.java:143)&lt;br/&gt;
        at me.prettyprint.cassandra.service.Operation.executeAndSetResult(Operation.java:101)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.HConnectionManager.operateWithFailover(HConnectionManager.java:159)&lt;br/&gt;
        at me.prettyprint.cassandra.service.KeyspaceServiceImpl.operateWithFailover(KeyspaceServiceImpl.java:129)&lt;br/&gt;
        at me.prettyprint.cassandra.service.KeyspaceServiceImpl.getRangeSlices(KeyspaceServiceImpl.java:165)&lt;br/&gt;
        at me.prettyprint.cassandra.model.thrift.ThriftRangeSlicesQuery$1.doInKeyspace(ThriftRangeSlicesQuery.java:67)&lt;br/&gt;
        at me.prettyprint.cassandra.model.thrift.ThriftRangeSlicesQuery$1.doInKeyspace(ThriftRangeSlicesQuery.java:63)&lt;br/&gt;
        at me.prettyprint.cassandra.model.KeyspaceOperationCallback.doInKeyspaceAndMeasure(KeyspaceOperationCallback.java:20)&lt;br/&gt;
        at me.prettyprint.cassandra.model.ExecutingKeyspace.doExecute(ExecutingKeyspace.java:85)&lt;br/&gt;
        at me.prettyprint.cassandra.model.thrift.ThriftRangeSlicesQuery.execute(ThriftRangeSlicesQuery.java:62)&lt;br/&gt;
       ...&lt;br/&gt;
Caused by: TimedOutException()&lt;br/&gt;
        at org.apache.cassandra.thrift.Cassandra$get_range_slices_result.read(Cassandra.java:12104)&lt;br/&gt;
        at org.apache.cassandra.thrift.Cassandra$Client.recv_get_range_slices(Cassandra.java:732)&lt;br/&gt;
        at org.apache.cassandra.thrift.Cassandra$Client.get_range_slices(Cassandra.java:704)&lt;br/&gt;
        at me.prettyprint.cassandra.service.KeyspaceServiceImpl$3.execute(KeyspaceServiceImpl.java:149)&lt;br/&gt;
        ... 23 more&lt;br/&gt;
11:48:51,025 ERROR ~ Unable to open transport to intr1n18(192.168.0.18):9160&lt;br/&gt;
org.apache.thrift.transport.TTransportException: java.net.NoRouteToHostException: No route to host&lt;br/&gt;
        at org.apache.thrift.transport.TSocket.open(TSocket.java:185)&lt;br/&gt;
        at org.apache.thrift.transport.TFramedTransport.open(TFramedTransport.java:81)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.HThriftClient.open(HThriftClient.java:111)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.CassandraHostRetryService$RetryRunner.verifyConnection(CassandraHostRetryService.java:116)&lt;br/&gt;
        at me.prettyprint.cassandra.connection.CassandraHostRetryService$RetryRunner.run(CassandraHostRetryService.java:96)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)&lt;br/&gt;
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;br/&gt;
Caused by: java.net.NoRouteToHostException: No route to host&lt;br/&gt;
        at java.net.PlainSocketImpl.socketConnect(Native Method)&lt;br/&gt;
        at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)&lt;br/&gt;
        at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)&lt;br/&gt;
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)&lt;br/&gt;
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)&lt;br/&gt;
        at java.net.Socket.connect(Socket.java:529)&lt;br/&gt;
        at org.apache.thrift.transport.TSocket.open(TSocket.java:180)&lt;br/&gt;
        ... 13 more&lt;br/&gt;
11:48:51,025 ERROR ~ Downed intr1n18(192.168.0.18):9160 host still appears to be down: Unable to open transport to intr1n18(192.168.0.18):9160 , java.net.NoRouteToHostException: No route to host&lt;br/&gt;
11:48:51,025 INFO  ~ Downed Host retry status false with host: intr1n18(192.168.0.18):9160&lt;/p&gt;



&lt;p&gt;Address         Status State   Load            Owns    Token&lt;br/&gt;
                                                       ffffffffffffffff&lt;br/&gt;
192.168.0.1     Up     Normal  11.26 GB        5.00%   0cc&lt;br/&gt;
192.168.0.2     Up     Normal  11.23 GB        5.00%   199&lt;br/&gt;
192.168.0.3     Up     Normal  11.58 GB        5.00%   266&lt;br/&gt;
192.168.0.4     Up     Normal  6.77 GB         5.00%   333&lt;br/&gt;
192.168.0.5     Up     Normal  6.86 GB         5.00%   400&lt;br/&gt;
192.168.0.6     Up     Normal  6.81 GB         5.00%   4cc&lt;br/&gt;
192.168.0.7     Up     Normal  6.88 GB         5.00%   599&lt;br/&gt;
192.168.0.8     Up     Normal  6.84 GB         5.00%   666&lt;br/&gt;
192.168.0.9     Up     Normal  6.52 GB         5.00%   733&lt;br/&gt;
192.168.0.10    Up     Normal  5.17 GB         5.00%   7ff&lt;br/&gt;
192.168.0.11    Up     Normal  6.75 GB         5.00%   8cc&lt;br/&gt;
192.168.0.12    Up     Normal  7.06 GB         5.00%   999&lt;br/&gt;
192.168.0.13    Up     Normal  7.27 GB         5.00%   a66&lt;br/&gt;
192.168.0.14    Up     Normal  7.71 GB         5.00%   b33&lt;br/&gt;
192.168.0.15    Up     Normal  7.46 GB         5.00%   c00&lt;br/&gt;
192.168.0.16    Up     Normal  6.94 GB         5.00%   ccc&lt;br/&gt;
192.168.0.17    Up     Normal  6.45 GB         5.00%   d99&lt;br/&gt;
192.168.0.18    Down   Normal  ?               5.00%   e66&lt;br/&gt;
192.168.0.19    Up     Normal  6.26 GB         5.00%   f33&lt;br/&gt;
192.168.0.20    Up     Normal  6.33 GB         5.00%   ffffffffffffffff&lt;/p&gt;
</comment>
                            <comment id="12989375" author="amorton" created="Tue, 1 Feb 2011 20:35:42 +0000"  >&lt;p&gt;My understanding here is the 0.19 node is sending read requests to the 0.1, 0.2 and 0.3 nodes and only getting a reply from the 0.1 node before timing out. The 0.1 node is the first node the request is sent to, so this is the data request the others are digest. &lt;/p&gt;

&lt;p&gt;The timeout is the rpc_timeout, and can be seen here...&lt;/p&gt;

&lt;p&gt;DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:28,949 ReadCallback.java (line 58) ReadCallback blocking for 2 responses&lt;br/&gt;
...10 seconds... &lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-01 11:48:38,950 CassandraServer.java (line 483) ... timed out&lt;/p&gt;

&lt;p&gt;Whats happening on the 0.2 and 0.3 nodes at this point? Are they logging errors or WARN messages about dropped messages ? Can you see any logs about processing messages from the 0.19 node? I&apos;m not sure the down 0.18 node is a factor here.&lt;/p&gt;

&lt;p&gt;The client should be retrying when it gets a timeout, which I think you said Hector was doing. &lt;/p&gt;

</comment>
                            <comment id="12989400" author="tbritz" created="Tue, 1 Feb 2011 21:46:48 +0000"  >&lt;p&gt;There is absolutely no load on the cluster, so it&apos;s strange that the timeout is being triggered. I will put the other nodes into debug mode tomorrow as well and post the DEBUG output of 0.1, 0.2, and 0.3&lt;/p&gt;
</comment>
                            <comment id="12989689" author="tbritz" created="Wed, 2 Feb 2011 16:08:35 +0000"  >&lt;p&gt;Debug Output:&lt;/p&gt;



&lt;p&gt;========================================&lt;br/&gt;
192.168.0.1&lt;br/&gt;
--------------------&lt;br/&gt;
2011-02-02 12:54:29,117 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; StorageLoadBalancer.java (line 349) Disseminating load info ...&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:35,016 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:8&amp;#93;&lt;/span&gt; RangeSliceVerbHandler.java (line 55) Sending RangeSliceReply&lt;/p&gt;
{rows=} to 567@/192.168.0.7&lt;br/&gt;
2011-02-02 12:54:45,015 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:9&amp;#93;&lt;/span&gt; RangeSliceVerbHandler.java (line 55) Sending RangeSliceReply{rows=}
&lt;p&gt; to 600@/192.168.0.7&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:49,679 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-5&amp;#93;&lt;/span&gt; ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;/p&gt;

&lt;p&gt;========================================&lt;br/&gt;
192.168.0.2&lt;br/&gt;
--------------------&lt;br/&gt;
2011-02-02 12:54:30,147 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; StorageLoadBalancer.java (line 349) Disseminating load info ...&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:34,789 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:5&amp;#93;&lt;/span&gt; RowMutationVerbHandler.java (line 52) Applying RowMutation(keyspace=&apos;table_lists&apos;, key=&apos;32383663623561363162363164306231333162326264656232303730303866625f7777772e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313432315f36346334613666322d333737392d343331642d623334382d663636383533316233656334&apos;, modifications=[ColumnFamily(table_lists &lt;span class=&quot;error&quot;&gt;&amp;#91;7461626c655f6c69737473:false:116@1296647674390000!2419199,&amp;#93;&lt;/span&gt;), ColumnFamily(table_lists_meta &lt;span class=&quot;error&quot;&gt;&amp;#91;6e6578745f72657175657374:false:8@1296647674391000!2419199,&amp;#93;&lt;/span&gt;)])&lt;br/&gt;
2011-02-02 12:54:34,790 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:5&amp;#93;&lt;/span&gt; Table.java (line 397) applying mutation of row 32383663623561363162363164306231333162326264656232303730303866625f7777772e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313432315f36346334613666322d333737392d343331642d623334382d663636383533316233656334&lt;br/&gt;
2011-02-02 12:54:34,792 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:5&amp;#93;&lt;/span&gt; RowMutationVerbHandler.java (line 81) RowMutation(keyspace=&apos;table_lists&apos;, key=&apos;32383663623561363162363164306231333162326264656232303730303866625f7777772e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313432315f36346334613666322d333737392d343331642d623334382d663636383533316233656334&apos;, modifications=[ColumnFamily(table_lists &lt;span class=&quot;error&quot;&gt;&amp;#91;7461626c655f6c69737473:false:116@1296647674390000!2419199,&amp;#93;&lt;/span&gt;), ColumnFamily(table_lists_meta &lt;span class=&quot;error&quot;&gt;&amp;#91;6e6578745f72657175657374:false:8@1296647674391000!2419199,&amp;#93;&lt;/span&gt;)]) applied.  Sending response to 566@/192.168.0.7&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:34,953 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:8&amp;#93;&lt;/span&gt; RangeSliceVerbHandler.java (line 55) Sending RangeSliceReply&lt;/p&gt;
{rows=} to 567@/192.168.0.7&lt;br/&gt;
2011-02-02 12:54:44,965 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:9&amp;#93;&lt;/span&gt; RangeSliceVerbHandler.java (line 55) Sending RangeSliceReply{rows=}
&lt;p&gt; to 600@/192.168.0.7&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:45,057 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; GCInspector.java (line 135) GC for ParNew: 14 ms, 13086296 reclaimed leaving 2087311488 used; max is 4856348672&lt;br/&gt;
2011-02-02 12:54:49,613 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-11&amp;#93;&lt;/span&gt; ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;/p&gt;

&lt;p&gt;========================================&lt;br/&gt;
192.168.0.3&lt;br/&gt;
--------------------&lt;br/&gt;
2011-02-02 12:54:30,920 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; StorageLoadBalancer.java (line 349) Disseminating load info ...&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:34,368 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:8&amp;#93;&lt;/span&gt; RowMutationVerbHandler.java (line 52) Applying RowMutation(keyspace=&apos;table_lists&apos;, key=&apos;36306463373934666139396136366665303539636130373063333366323066615f2e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313636345f65626263303033372d356639612d343066382d383833382d356436336433616233366165&apos;, modifications=[ColumnFamily(table_lists &lt;span class=&quot;error&quot;&gt;&amp;#91;7461626c655f6c69737473:false:116@1296647674314000!2419199,&amp;#93;&lt;/span&gt;), ColumnFamily(table_lists_meta &lt;span class=&quot;error&quot;&gt;&amp;#91;6e6578745f72657175657374:false:8@1296647674322000!2419199,&amp;#93;&lt;/span&gt;)])&lt;br/&gt;
2011-02-02 12:54:34,369 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:8&amp;#93;&lt;/span&gt; Table.java (line 397) applying mutation of row 36306463373934666139396136366665303539636130373063333366323066615f2e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313636345f65626263303033372d356639612d343066382d383833382d356436336433616233366165&lt;br/&gt;
2011-02-02 12:54:34,371 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:8&amp;#93;&lt;/span&gt; RowMutationVerbHandler.java (line 81) RowMutation(keyspace=&apos;table_lists&apos;, key=&apos;36306463373934666139396136366665303539636130373063333366323066615f2e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313636345f65626263303033372d356639612d343066382d383833382d356436336433616233366165&apos;, modifications=[ColumnFamily(table_lists &lt;span class=&quot;error&quot;&gt;&amp;#91;7461626c655f6c69737473:false:116@1296647674314000!2419199,&amp;#93;&lt;/span&gt;), ColumnFamily(table_lists_meta &lt;span class=&quot;error&quot;&gt;&amp;#91;6e6578745f72657175657374:false:8@1296647674322000!2419199,&amp;#93;&lt;/span&gt;)]) applied.  Sending response to 562@/192.168.0.7&lt;br/&gt;
2011-02-02 12:54:34,381 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:9&amp;#93;&lt;/span&gt; RowMutationVerbHandler.java (line 52) Applying RowMutation(keyspace=&apos;table_lists&apos;, key=&apos;32383663623561363162363164306231333162326264656232303730303866625f7777772e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313432315f36346334613666322d333737392d343331642d623334382d663636383533316233656334&apos;, modifications=[ColumnFamily(table_lists &lt;span class=&quot;error&quot;&gt;&amp;#91;7461626c655f6c69737473:false:116@1296647674390000!2419199,&amp;#93;&lt;/span&gt;), ColumnFamily(table_lists_meta &lt;span class=&quot;error&quot;&gt;&amp;#91;6e6578745f72657175657374:false:8@1296647674391000!2419199,&amp;#93;&lt;/span&gt;)])&lt;br/&gt;
2011-02-02 12:54:34,382 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:9&amp;#93;&lt;/span&gt; Table.java (line 397) applying mutation of row 32383663623561363162363164306231333162326264656232303730303866625f7777772e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313432315f36346334613666322d333737392d343331642d623334382d663636383533316233656334&lt;br/&gt;
2011-02-02 12:54:34,383 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:9&amp;#93;&lt;/span&gt; RowMutationVerbHandler.java (line 81) RowMutation(keyspace=&apos;table_lists&apos;, key=&apos;32383663623561363162363164306231333162326264656232303730303866625f7777772e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313432315f36346334613666322d333737392d343331642d623334382d663636383533316233656334&apos;, modifications=[ColumnFamily(table_lists &lt;span class=&quot;error&quot;&gt;&amp;#91;7461626c655f6c69737473:false:116@1296647674390000!2419199,&amp;#93;&lt;/span&gt;), ColumnFamily(table_lists_meta &lt;span class=&quot;error&quot;&gt;&amp;#91;6e6578745f72657175657374:false:8@1296647674391000!2419199,&amp;#93;&lt;/span&gt;)]) applied.  Sending response to 564@/192.168.0.7&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:34,539 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:8&amp;#93;&lt;/span&gt; RangeSliceVerbHandler.java (line 55) Sending RangeSliceReply&lt;/p&gt;
{rows=} to 567@/192.168.0.7&lt;br/&gt;
2011-02-02 12:54:44,540 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:9&amp;#93;&lt;/span&gt; RangeSliceVerbHandler.java (line 55) Sending RangeSliceReply{rows=}
&lt;p&gt; to 600@/192.168.0.7&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:49,202 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-13&amp;#93;&lt;/span&gt; ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;/p&gt;

&lt;p&gt;========================================&lt;br/&gt;
192.168.0.7&lt;br/&gt;
--------------------&lt;br/&gt;
2011-02-02 12:54:34,059 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; StorageLoadBalancer.java (line 349) Disseminating load info ...&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:34,356 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; CassandraServer.java (line 355) batch_mutate&lt;br/&gt;
2011-02-02 12:54:34,375 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; StorageProxy.java (line 154) insert writing key 36306463373934666139396136366665303539636130373063333366323066615f2e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313636345f65626263303033372d356639612d343066382d383833382d356436336433616233366165 to 561@/192.168.0.5&lt;br/&gt;
2011-02-02 12:54:34,375 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; StorageProxy.java (line 154) insert writing key 36306463373934666139396136366665303539636130373063333366323066615f2e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313636345f65626263303033372d356639612d343066382d383833382d356436336433616233366165 to 562@/192.168.0.3&lt;br/&gt;
2011-02-02 12:54:34,381 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; StorageProxy.java (line 154) insert writing key 36306463373934666139396136366665303539636130373063333366323066615f2e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313636345f65626263303033372d356639612d343066382d383833382d356436336433616233366165 to 563@/94.242.198.13&lt;br/&gt;
2011-02-02 12:54:34,384 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:3&amp;#93;&lt;/span&gt; ResponseVerbHandler.java (line 48) Processing response on a callback from 561@/192.168.0.5&lt;br/&gt;
2011-02-02 12:54:34,386 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:5&amp;#93;&lt;/span&gt; ResponseVerbHandler.java (line 48) Processing response on a callback from 563@/192.168.0.4&lt;br/&gt;
2011-02-02 12:54:34,386 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:4&amp;#93;&lt;/span&gt; ResponseVerbHandler.java (line 48) Processing response on a callback from 562@/192.168.0.3&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:34,391 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; CassandraServer.java (line 355) batch_mutate&lt;br/&gt;
2011-02-02 12:54:34,393 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; StorageProxy.java (line 154) insert writing key 32383663623561363162363164306231333162326264656232303730303866625f7777772e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313432315f36346334613666322d333737392d343331642d623334382d663636383533316233656334 to 564@/192.168.0.3&lt;br/&gt;
2011-02-02 12:54:34,394 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; StorageProxy.java (line 154) insert writing key 32383663623561363162363164306231333162326264656232303730303866625f7777772e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313432315f36346334613666322d333737392d343331642d623334382d663636383533316233656334 to 565@/192.168.0.4&lt;br/&gt;
2011-02-02 12:54:34,394 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-2&amp;#93;&lt;/span&gt; StorageProxy.java (line 154) insert writing key 32383663623561363162363164306231333162326264656232303730303866625f7777772e7768617469736d79697076362e6e65745f686f7374726571756573746c6973745f393232333337303734303230373130313432315f36346334613666322d333737392d343331642d623334382d663636383533316233656334 to 566@/192.168.0.2&lt;br/&gt;
2011-02-02 12:54:34,398 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:6&amp;#93;&lt;/span&gt; ResponseVerbHandler.java (line 48) Processing response on a callback from 564@/192.168.0.3&lt;br/&gt;
2011-02-02 12:54:34,398 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:7&amp;#93;&lt;/span&gt; ResponseVerbHandler.java (line 48) Processing response on a callback from 565@/192.168.0.4&lt;br/&gt;
2011-02-02 12:54:34,399 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:8&amp;#93;&lt;/span&gt; ResponseVerbHandler.java (line 48) Processing response on a callback from 566@/192.168.0.2&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:34,531 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-3&amp;#93;&lt;/span&gt; CassandraServer.java (line 445) range_slice&lt;br/&gt;
2011-02-02 12:54:34,533 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-3&amp;#93;&lt;/span&gt; StorageProxy.java (line 514) RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,], max_keys=250}
&lt;p&gt;2011-02-02 12:54:34,534 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-3&amp;#93;&lt;/span&gt; StorageProxy.java (line 705) restricted ranges for query &lt;span class=&quot;error&quot;&gt;&amp;#91;,&amp;#93;&lt;/span&gt; are [&lt;span class=&quot;error&quot;&gt;&amp;#91;,24&amp;#93;&lt;/span&gt;, (24,49], (49,6d], (6d,92], (92,b6], (b6,db], (db,ffffffffffffffff], (ffffffffffffffff,]]&lt;br/&gt;
2011-02-02 12:54:34,536 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-3&amp;#93;&lt;/span&gt; ReadCallback.java (line 58) ReadCallback blocking for 2 responses&lt;br/&gt;
2011-02-02 12:54:34,536 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-3&amp;#93;&lt;/span&gt; StorageProxy.java (line 562) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,24], max_keys=250}
&lt;p&gt; from 567@/192.168.0.1&lt;br/&gt;
2011-02-02 12:54:34,537 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-3&amp;#93;&lt;/span&gt; StorageProxy.java (line 562) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,24], max_keys=250}
&lt;p&gt; from 567@/192.168.0.2&lt;br/&gt;
2011-02-02 12:54:34,537 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-3&amp;#93;&lt;/span&gt; StorageProxy.java (line 562) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,24], max_keys=250}
&lt;p&gt; from 567@/192.168.0.3&lt;br/&gt;
2011-02-02 12:54:34,554 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:1&amp;#93;&lt;/span&gt; ResponseVerbHandler.java (line 48) Processing response on a callback from 567@/192.168.0.3&lt;br/&gt;
2011-02-02 12:54:44,537 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-3&amp;#93;&lt;/span&gt; CassandraServer.java (line 483) ... timed out&lt;br/&gt;
2011-02-02 12:54:44,548 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-3&amp;#93;&lt;/span&gt; ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:44,549 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-4&amp;#93;&lt;/span&gt; CassandraServer.java (line 445) range_slice&lt;br/&gt;
2011-02-02 12:54:44,550 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-4&amp;#93;&lt;/span&gt; StorageProxy.java (line 514) RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,], max_keys=250}
&lt;p&gt;2011-02-02 12:54:44,550 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-4&amp;#93;&lt;/span&gt; StorageProxy.java (line 705) restricted ranges for query &lt;span class=&quot;error&quot;&gt;&amp;#91;,&amp;#93;&lt;/span&gt; are [&lt;span class=&quot;error&quot;&gt;&amp;#91;,24&amp;#93;&lt;/span&gt;, (24,49], (49,6d], (6d,92], (92,b6], (b6,db], (db,ffffffffffffffff], (ffffffffffffffff,]]&lt;br/&gt;
2011-02-02 12:54:44,550 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-4&amp;#93;&lt;/span&gt; ReadCallback.java (line 58) ReadCallback blocking for 2 responses&lt;br/&gt;
2011-02-02 12:54:44,552 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-4&amp;#93;&lt;/span&gt; StorageProxy.java (line 562) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,24], max_keys=250}
&lt;p&gt; from 600@/192.168.0.1&lt;br/&gt;
2011-02-02 12:54:44,552 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-4&amp;#93;&lt;/span&gt; StorageProxy.java (line 562) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,24], max_keys=250}
&lt;p&gt; from 600@/192.168.0.2&lt;br/&gt;
2011-02-02 12:54:44,552 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-4&amp;#93;&lt;/span&gt; StorageProxy.java (line 562) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;table_usersources&apos;, column_family=&apos;table_usersources_meta&apos;, super_column=null, predicate=SlicePredicate(column_names:[java.nio.HeapByteBuffer[pos=76 lim=88 cap=65536]]), range=[,24], max_keys=250}
&lt;p&gt; from 600@/192.168.0.3&lt;br/&gt;
2011-02-02 12:54:44,554 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:5&amp;#93;&lt;/span&gt; ResponseVerbHandler.java (line 48) Processing response on a callback from 600@/192.168.0.1&lt;br/&gt;
2011-02-02 12:54:54,550 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-4&amp;#93;&lt;/span&gt; CassandraServer.java (line 483) ... timed out&lt;br/&gt;
2011-02-02 12:54:54,552 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-4&amp;#93;&lt;/span&gt; ClientState.java (line 91) logged out: #&amp;lt;User allow_all groups=[]&amp;gt;&lt;/p&gt;

</comment>
                            <comment id="12989804" author="amorton" created="Wed, 2 Feb 2011 21:25:23 +0000"  >&lt;p&gt;There is something odd about the way the messages are been described in the logs, e.g. yours say&lt;/p&gt;

&lt;p&gt;2011-02-02 12:54:44,554 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:5&amp;#93;&lt;/span&gt; ResponseVerbHandler.java (line 48) Processing response on a callback from 600@/192.168.0.1&lt;/p&gt;

&lt;p&gt;mine say&lt;/p&gt;

&lt;p&gt;DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:16&amp;#93;&lt;/span&gt; 2011-02-01 17:14:08,188 ResponseVerbHandler.java (line org.apache.cassandra.net.ResponseVerbHandler) Processing response on a callback from 7D8FA1FD-A2FE-6A54-7BB0-3B129206D1E1@/192.168.114.6 &lt;/p&gt;

&lt;p&gt;The MessagingService.sendRR() overload that takes an array (and is called when there are multiple messages) should be updating the message ID for all messages to a shared GUID before sending. This happens the log message about &quot;StorageProxy.java (line 562) reading RangeSliceCommand...&quot; It should be present in the ResponseVerbHandler log message.&lt;/p&gt;

&lt;p&gt;Perhaps this means the callback for the message cannot be found. To test the theory can you apply the 2081-logging.patch to the node your are running the request on? It updates ResponseVernHandler to log when a message is lost.&lt;/p&gt;

</comment>
                            <comment id="12989805" author="amorton" created="Wed, 2 Feb 2011 21:26:51 +0000"  >&lt;p&gt;adds logging to ResponseVerbHandler to log is the message is received but there is no callback&lt;/p&gt;</comment>
                            <comment id="12989808" author="jbellis" created="Wed, 2 Feb 2011 21:31:30 +0000"  >&lt;p&gt;Thibaut is using a 0.7.1 prerelease version where the uuid messages from sendRR have been replaced with unique per-host messages (which are standard int IDs like the old non-shared messages were).&lt;/p&gt;</comment>
                            <comment id="12989818" author="tbritz" created="Wed, 2 Feb 2011 21:58:27 +0000"  >&lt;p&gt;Is there an archive of older builds from hudson? I could try out a few versions between 24th january and the 28th to pinpoint the revision that is causing this. This won&apos;t take long.&lt;/p&gt;</comment>
                            <comment id="12989828" author="amorton" created="Wed, 2 Feb 2011 22:17:54 +0000"  >&lt;p&gt;Looking at the right code now. &lt;/p&gt;

&lt;p&gt;In StorageProxy.fetchRows() line 395 the digestMessage is shared for all non local digest requests. &lt;/p&gt;

&lt;p&gt;And I just realised the log messages above are coming from StorageProxy.getRangeSlice() where the message object is shared for all endpoints. The log messages from Thibaut show the same message ID on nodes 0.1 0.2 and 0.3.&lt;/p&gt;

&lt;p&gt;My reading of the MessagingService and ResponseVerbHandler is that once a message with ID X has been received, if others are received with the same ID they will be ignored. Is that correct? If so this looks like a bug in the two methods above. &lt;/p&gt;</comment>
                            <comment id="12989834" author="jbellis" created="Wed, 2 Feb 2011 22:28:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;In StorageProxy.fetchRows() line 395 the digestMessage is shared for all non local digest requests. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2094&quot; title=&quot;fix regression in CL.ALL read&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2094&quot;&gt;&lt;del&gt;CASSANDRA-2094&lt;/del&gt;&lt;/a&gt;, but shouldn&apos;t break quorum for RF=3 (since a single digest is all we need)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;the log messages above are coming from StorageProxy.getRangeSlice() where the message object is shared for all endpoints&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Aha, I didn&apos;t notice that.  I think this is our bug.  Patch attached.&lt;/p&gt;</comment>
                            <comment id="12989841" author="amorton" created="Wed, 2 Feb 2011 22:39:26 +0000"  >&lt;p&gt;Out of interest, how about making the ExpiringMap check the return of NonBlockingHashMap.put() and assert it was the value passed in. May catch future problems. &lt;/p&gt;</comment>
                            <comment id="12990040" author="mconrad" created="Thu, 3 Feb 2011 10:11:24 +0000"  >&lt;p&gt;Jonathan, I tried your patch and it fixes the problem. Thanks.&lt;/p&gt;</comment>
                            <comment id="12990078" author="tbritz" created="Thu, 3 Feb 2011 12:59:14 +0000"  >&lt;p&gt;As Michel noted, this fixes the problem. Thanks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12990148" author="jbellis" created="Thu, 3 Feb 2011 16:02:04 +0000"  >&lt;p&gt;Thanks for helping track that down everyone!&lt;/p&gt;</comment>
                            <comment id="12990152" author="hudson" created="Thu, 3 Feb 2011 16:16:47 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #237 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/237/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/237/&lt;/a&gt;)&lt;br/&gt;
    fix range slice ConsistencyLevel &amp;gt; ONE&lt;br/&gt;
patch by jbellis; tested by Michel Conrad and Thibaut for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2081&quot; title=&quot;Consistency QUORUM does not work anymore (hector:Could not fullfill request on this host)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2081&quot;&gt;&lt;del&gt;CASSANDRA-2081&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12990156" author="hudson" created="Thu, 3 Feb 2011 16:24:18 +0000"  >&lt;p&gt;Integrated in Cassandra-0.6 #56 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.6/56/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.6/56/&lt;/a&gt;)&lt;br/&gt;
    fix range slice ConsistencyLevel &amp;gt; ONE&lt;br/&gt;
patch by jbellis; tested by Michel Conrad and Thibaut for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2081&quot; title=&quot;Consistency QUORUM does not work anymore (hector:Could not fullfill request on this host)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2081&quot;&gt;&lt;del&gt;CASSANDRA-2081&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12990162" author="hudson" created="Thu, 3 Feb 2011 16:37:40 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #238 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/238/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/238/&lt;/a&gt;)&lt;br/&gt;
    add debug log message for missing callback&lt;br/&gt;
patch by Aaron Morton and jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2081&quot; title=&quot;Consistency QUORUM does not work anymore (hector:Could not fullfill request on this host)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2081&quot;&gt;&lt;del&gt;CASSANDRA-2081&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12991359" author="amorton" created="Mon, 7 Feb 2011 12:48:36 +0000"  >&lt;p&gt;StorageProxy.scan() is also reusing Message objects, with the same result of requests at QUORUM timing out for get_indexed_slice()&lt;/p&gt;

&lt;p&gt;Log messages below show a get_indexed_slice() in a 3 node cluster @ QUORUM. The new log message shows the callback has already been removed. &lt;/p&gt;



&lt;p&gt;DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-12&amp;#93;&lt;/span&gt; 2011-02-08 01:46:32,893 CassandraServer.java (line 509) scan&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-12&amp;#93;&lt;/span&gt; 2011-02-08 01:46:32,894 StorageProxy.java (line 703) restricted ranges for query &lt;span class=&quot;error&quot;&gt;&amp;#91;-1,-1&amp;#93;&lt;/span&gt; are [&lt;span class=&quot;error&quot;&gt;&amp;#91;-1,85070591730234615865843651857942052864&amp;#93;&lt;/span&gt;, (85070591730234615865843651857942052864,95070591730234615865843651857942052864], (95070591730234615865843651857942052864,108074891939685041992920030907211891412], (108074891939685041992920030907211891412,-1]]&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-12&amp;#93;&lt;/span&gt; 2011-02-08 01:46:32,919 StorageProxy.java (line 796) scan ranges are &lt;span class=&quot;error&quot;&gt;&amp;#91;-1,85070591730234615865843651857942052864&amp;#93;&lt;/span&gt;,(85070591730234615865843651857942052864,95070591730234615865843651857942052864],(95070591730234615865843651857942052864,108074891939685041992920030907211891412],(108074891939685041992920030907211891412,-1]&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-12&amp;#93;&lt;/span&gt; 2011-02-08 01:46:32,919 ReadCallback.java (line 58) ReadCallback blocking for 2 responses&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-12&amp;#93;&lt;/span&gt; 2011-02-08 01:46:32,923 StorageProxy.java (line 819) reading org.apache.cassandra.db.IndexScanCommand@26a1b248 from 6289@/127.0.0.3&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-12&amp;#93;&lt;/span&gt; 2011-02-08 01:46:32,923 StorageProxy.java (line 819) reading org.apache.cassandra.db.IndexScanCommand@26a1b248 from 6289@/127.0.0.2&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:1&amp;#93;&lt;/span&gt; 2011-02-08 01:46:32,926 ResponseVerbHandler.java (line 51) Processing response on a callback from 6289@/127.0.0.3&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:2&amp;#93;&lt;/span&gt; 2011-02-08 01:46:32,928 ResponseVerbHandler.java (line 41) Callback already removed for 6289&lt;/p&gt;</comment>
                            <comment id="12991360" author="amorton" created="Mon, 7 Feb 2011 12:48:56 +0000"  >&lt;p&gt;Am trying to fix this now. &lt;/p&gt;</comment>
                            <comment id="12991373" author="amorton" created="Mon, 7 Feb 2011 13:17:08 +0000"  >&lt;p&gt;patch 2081-2.txt is against the current 0.7 branch. I&apos;ve added an assert in the MessageService that looks like this when a callback is added for an existing message ID. &lt;/p&gt;

&lt;p&gt;RROR &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; 2011-02-08 02:07:46,763 Cassandra.java (line 2918) Internal error processing get_indexed_slices&lt;br/&gt;
java.lang.AssertionError&lt;br/&gt;
	at org.apache.cassandra.net.MessagingService.addCallback(MessagingService.java:262)&lt;br/&gt;
	at org.apache.cassandra.net.MessagingService.sendRR(MessagingService.java:278)&lt;br/&gt;
	at org.apache.cassandra.service.StorageProxy.scan(StorageProxy.java:817)&lt;br/&gt;
	at org.apache.cassandra.thrift.CassandraServer.get_indexed_slices(CassandraServer.java:520)&lt;br/&gt;
	at org.apache.cassandra.thrift.Cassandra$Processor$get_indexed_slices.process(Cassandra.java:2910)&lt;br/&gt;
	at org.apache.cassandra.thrift.Cassandra$Processor.process(Cassandra.java:2555)&lt;br/&gt;
	at org.apache.cassandra.thrift.CustomTThreadPoolServer$WorkerProcess.run(CustomTThreadPoolServer.java:167)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:680)&lt;/p&gt;


&lt;p&gt;Have also modified StorageProxy.scan() to create a message for each endpoint. &lt;/p&gt;

&lt;p&gt;I&apos;ve read through StorageProxy and think their might be an problem in .sendMessages() line 236, it looks like it sends the same message to all endpoints in the local DC. It&apos;s late/early and I&apos;m not sure so can someone else take a look please. &lt;/p&gt;</comment>
                            <comment id="12991397" author="hudson" created="Mon, 7 Feb 2011 14:47:04 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #252 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/252/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/252/&lt;/a&gt;)&lt;br/&gt;
    avoid re-using Message object in index queries&lt;br/&gt;
patch by Aaron Morton; reviewed by jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2081&quot; title=&quot;Consistency QUORUM does not work anymore (hector:Could not fullfill request on this host)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2081&quot;&gt;&lt;del&gt;CASSANDRA-2081&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12991399" author="jbellis" created="Mon, 7 Feb 2011 14:48:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;it looks like it sends the same message to all endpoints in the local DC&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It sends the same message to each entry in the list...  which is always going to be a list of size one.  So the good news is I don&apos;t think it&apos;s incorrect, but the bad news is we broke &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1530&quot; title=&quot;More-efficient cross-DC replication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1530&quot;&gt;&lt;del&gt;CASSANDRA-1530&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12991430" author="jbellis" created="Mon, 7 Feb 2011 16:06:12 +0000"  >&lt;p&gt;will re-open 1530&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12470443" name="2081-2.txt" size="2370" author="amorton" created="Mon, 7 Feb 2011 13:18:11 +0000"/>
                            <attachment id="12470072" name="2081-logging.patch" size="842" author="amorton" created="Wed, 2 Feb 2011 21:26:51 +0000"/>
                            <attachment id="12470078" name="2081.txt" size="1410" author="jbellis" created="Wed, 2 Feb 2011 22:29:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[amorton]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20431</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 42 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g973:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>92920</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>