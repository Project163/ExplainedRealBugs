<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:06:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13124] Abort or retry on failed hints delivery</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13124</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12905&quot; title=&quot;Retry acquire MV lock on failure instead of throwing WTE on streaming&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12905&quot;&gt;&lt;del&gt;CASSANDRA-12905&lt;/del&gt;&lt;/a&gt; changed the hints path to be asynchronous in the normal case, but when the hint is non-local and should be stored (ie. on decommission) an ack is not sent so the operation does not complete successfully.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13058&quot; title=&quot;dtest failure in hintedhandoff_test.TestHintedHandoff.hintedhandoff_decom_test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13058&quot;&gt;&lt;del&gt;CASSANDRA-13058&lt;/del&gt;&lt;/a&gt; fixed this for 3.0+, but for 3.11+ but there is an additional concern which on 3.0 is that non-acked hints are being completed successfully so we should probably look into this as well here.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13035067">CASSANDRA-13124</key>
            <summary>Abort or retry on failed hints delivery</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="spod">Stefan Podkowinski</assignee>
                                    <reporter username="pauloricardomg">Paulo Motta</reporter>
                        <labels>
                            <label>hintedhandoff</label>
                    </labels>
                <created>Mon, 16 Jan 2017 01:03:26 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:11 +0000</updated>
                            <resolved>Mon, 6 Feb 2017 20:04:46 +0000</resolved>
                                        <fixVersion>3.0.11</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15823340" author="pauloricardomg" created="Mon, 16 Jan 2017 01:24:17 +0000"  >&lt;p&gt;continue discussion from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13058&quot; title=&quot;dtest failure in hintedhandoff_test.TestHintedHandoff.hintedhandoff_decom_test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13058&quot;&gt;&lt;del&gt;CASSANDRA-13058&lt;/del&gt;&lt;/a&gt; (cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spodxx%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;spodxx@gmail.com&quot;&gt;spodxx@gmail.com&lt;/a&gt;):&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;and terminate with a successful return value afterwards&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Does this mean retry is broken on 3.0? Should we file a ticket for this? From what I understood &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11960&quot; title=&quot;Hints are not seekable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11960&quot;&gt;&lt;del&gt;CASSANDRA-11960&lt;/del&gt;&lt;/a&gt; only affected 3.X so I guess retry should be working on 3.0?&lt;/p&gt;

&lt;p&gt;If my understanding above is correct we should probably also fix this on 3.0 to reinstate the same behavior before &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12905&quot; title=&quot;Retry acquire MV lock on failure instead of throwing WTE on streaming&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12905&quot;&gt;&lt;del&gt;CASSANDRA-12905&lt;/del&gt;&lt;/a&gt;? Can you create a 3.0 patch and submit CI?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;That being said, it&apos;s less than ideal that dtests annotated with &quot;@no_vnodes&quot; are simply skipped during ad-hoc job scheduling during reviews.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agreed, created the following &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/issues/1422&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;issue&lt;/a&gt; on cassandra-dtest to address this, feel welcome to give feedback there.&lt;/p&gt;</comment>
                            <comment id="15825832" author="spodxx@gmail.com" created="Tue, 17 Jan 2017 10:48:46 +0000"  >

&lt;blockquote&gt;&lt;p&gt;Does this mean retry is broken on 3.0? Should we file a ticket for this? From what I understood &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11960&quot; title=&quot;Hints are not seekable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11960&quot;&gt;&lt;del&gt;CASSANDRA-11960&lt;/del&gt;&lt;/a&gt; only affected 3.X so I guess retry should be working on 3.0?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You can just test it by commenting out all code in &lt;tt&gt;HintVerbHandler&lt;/tt&gt;. Afterwards the &lt;tt&gt;hintedhandoff_decom_test&lt;/tt&gt; will fail due to data loss (that was supposed to be prevented by the transferred hints). Although no hints have been handled at all, decom will happily proceed and there won&apos;t be any exceptions or errors in the logs.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If my understanding above is correct we should probably also fix this on 3.0 to reinstate the same behavior before &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12905&quot; title=&quot;Retry acquire MV lock on failure instead of throwing WTE on streaming&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12905&quot;&gt;&lt;del&gt;CASSANDRA-12905&lt;/del&gt;&lt;/a&gt;? Can you create a 3.0 patch and submit CI?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This plus removing the retry loop in the dispatcher, due to the broken behaviour described in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13058?focusedCommentId=15818371&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15818371&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;my comment&lt;/a&gt;, which is what has been done for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11960&quot; title=&quot;Hints are not seekable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11960&quot;&gt;&lt;del&gt;CASSANDRA-11960&lt;/del&gt;&lt;/a&gt; as well. Afterwards retrying hints on page basis should happen just once as initiated by &lt;tt&gt;TransferHintsTask&lt;/tt&gt; and periodically for regular hinting, executed by the HintsDispatcher executor. &lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/spodkowinski/cassandra/tree/CASSANDRA-13124-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/spodkowinski/job/spodkowinski-CASSANDRA-13124-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/spodkowinski/job/spodkowinski-CASSANDRA-13124-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

</comment>
                            <comment id="15854651" author="pauloricardomg" created="Mon, 6 Feb 2017 20:04:46 +0000"  >&lt;p&gt;LGTM, thanks! Committed as dab0e31ba0294ccc5e8af35cbbe0a6733f35794e.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[spod]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 41 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38qj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>pauloricardomg</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>