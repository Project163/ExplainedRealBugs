<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:02:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11631] cqlsh COPY FROM fails for null values with non-prepared statements</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11631</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;cqlsh&apos;s &lt;tt&gt;COPY FROM ... WITH PREPAREDSTATEMENTS = False&lt;/tt&gt; fails if the row contains null values. Reason is that the &lt;tt&gt;&apos;,&apos;.join(r)&lt;/tt&gt; in &lt;tt&gt;make_non_prepared_batch_statement&lt;/tt&gt; doesn&apos;t seem to handle &lt;tt&gt;None&lt;/tt&gt;, which results in this error message.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Failed to &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; 1 rows: TypeError - sequence item 2: expected string, NoneType found,  given up without retries
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Attached patch should fix the problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12961585">CASSANDRA-11631</key>
            <summary>cqlsh COPY FROM fails for null values with non-prepared statements</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="snazy">Robert Stupp</reporter>
                        <labels>
                            <label>cqlsh</label>
                    </labels>
                <created>Fri, 22 Apr 2016 09:27:40 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:35 +0000</updated>
                            <resolved>Wed, 27 Apr 2016 01:13:33 +0000</resolved>
                                        <fixVersion>2.1.15</fixVersion>
                    <fixVersion>2.2.7</fixVersion>
                    <fixVersion>3.0.6</fixVersion>
                    <fixVersion>3.6</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15253617" author="snazy" created="Fri, 22 Apr 2016 09:29:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...snazy:11631-copy-from-None-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/snazy/job/snazy-11631-copy-from-None-trunk-dtest/lastBuild/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15253662" author="stefania" created="Fri, 22 Apr 2016 09:54:51 +0000"  >&lt;p&gt;The patch looks good.&lt;/p&gt;

&lt;p&gt;We need to extend the dtests introduced for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11549&quot; title=&quot;cqlsh: COPY FROM ignores NULL values in conversion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11549&quot;&gt;&lt;del&gt;CASSANDRA-11549&lt;/del&gt;&lt;/a&gt; to cover non prepared statements and nested types with null sub-fields as well. I can work on the tests next week.&lt;/p&gt;</comment>
                            <comment id="15253677" author="snazy" created="Fri, 22 Apr 2016 10:04:14 +0000"  >&lt;p&gt;Is the fix version 3.6 correct? Or would it be 3.0?&lt;/p&gt;</comment>
                            <comment id="15253757" author="snazy" created="Fri, 22 Apr 2016 11:13:00 +0000"  >&lt;p&gt;(canceling patch, requires back port to 2.1)&lt;/p&gt;</comment>
                            <comment id="15255811" author="stefania" created="Mon, 25 Apr 2016 02:54:07 +0000"  >&lt;p&gt;Thanks for the patch, I&apos;ve backported it and enhanced it to cover composite types and better error reporting:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11631-2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11631-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11631-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11631&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11631-2.1-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11631-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11631-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11631-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Here are the new tests: &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/949&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/riptano/cassandra-dtest/pull/949&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Inserting &lt;tt&gt;None&lt;/tt&gt; values in collections, e.g. lists, resulted in server side assertion errors. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snazy&quot; class=&quot;user-hover&quot; rel=&quot;snazy&quot;&gt;snazy&lt;/a&gt; could you review the final patch and do you think we should do anything about empty values in collections (like ignoring them) or is a parse error indicating the problematic field sufficient?&lt;/p&gt;</comment>
                            <comment id="15256075" author="stefania" created="Mon, 25 Apr 2016 08:36:13 +0000"  >&lt;p&gt;There are &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11631-dtest/lastCompletedBuild/testReport/cqlsh_tests.cqlsh_copy_tests/CqlshCopyTest/test_default_null_indicator_no_prepared_statements/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;some failures&lt;/a&gt; on trunk due to the timestamp format with microseconds that was introduced in 3.4. I&apos;m working on a fix.&lt;/p&gt;</comment>
                            <comment id="15256079" author="snazy" created="Mon, 25 Apr 2016 08:41:02 +0000"  >&lt;p&gt;I think it&apos;s fine to go with the patch as it is - so not adding any special &quot;ignore element if empty&quot;.&lt;/p&gt;

&lt;p&gt;+1 for the patch, if CI is fine&lt;/p&gt;</comment>
                            <comment id="15256169" author="stefania" created="Mon, 25 Apr 2016 09:50:47 +0000"  >&lt;p&gt;I&apos;ve fixed the CI problems on trunk in &lt;a href=&quot;https://github.com/stef1927/cassandra/commit/f0e3bd1be35519c31e0055b14cb697459237b1ac&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this commit&lt;/a&gt;. We need to round microseconds to milliseconds in the timestamp format when exporting with COPY TO, to ensure we can import the same files with a COPY FROM without prepared statements.&lt;/p&gt;

&lt;p&gt;CI pending on all branches since I&apos;ve also added more tests with prepared statements disabled.&lt;/p&gt;</comment>
                            <comment id="15256201" author="snazy" created="Mon, 25 Apr 2016 10:43:41 +0000"  >&lt;p&gt;LGTM&lt;/p&gt;</comment>
                            <comment id="15257524" author="stefania" created="Tue, 26 Apr 2016 03:56:48 +0000"  >&lt;p&gt;Two dtest failed on all non-trunk branches, fixed in the test code and restarted CI. &lt;/p&gt;

&lt;p&gt;Also fixed a pep8 compliance issue in the latest trunk patch (just an extra space, no need to review) and fixed two more dtests that were failing on trunk. &lt;/p&gt;

&lt;p&gt;If CI is good I will commit.&lt;/p&gt;
</comment>
                            <comment id="15259304" author="stefania" created="Wed, 27 Apr 2016 01:13:06 +0000"  >&lt;p&gt;CI is good now.&lt;/p&gt;

&lt;p&gt;Committed to 2.1 as 72057c6971abf40e2d1a545c4b511be84a4eb69f and merged upwards.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12963264">CASSANDRA-11675</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12957944">CASSANDRA-11549</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 29 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2wkwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>snazy</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[snazy]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>