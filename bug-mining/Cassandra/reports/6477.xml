<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:30:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-19401] Nodetool import expects directory structure</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-19401</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;According to the &lt;a href=&quot;https://cassandra.apache.org/doc/4.1/cassandra/operating/bulk_loading.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;documentation&lt;/a&gt; the nodetool import should not rely on the folder structure of the imported sst files:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Because the keyspace and table are specified on the command line for nodetool import, there is not the same requirement as with sstableloader, to have the SSTables in a specific directory path. When importing snapshots or incremental backups with nodetool import, the SSTables don&#8217;t need to be copied to another directory.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;However when importing old cassandra snapshots, we figured out, that sstables still need to be in a directory called like $KEYSPACE/$TABLENAME files, even when keyspace and table name are already present as parameters for the nodetool import call.&lt;/p&gt;

&lt;p&gt;Call we used:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
nodetool &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; --copy-data mykeyspace mytable /full_path_to/test1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Log:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
INFO  [RMI TCP Connection(21)-127.0.0.1] 2024-02-15 10:41:06,565 SSTableImporter.java:72 - Loading &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SSTables &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mykeyspace/mytable: Options{srcPaths=&lt;span class=&quot;code-quote&quot;&gt;&apos;[/full_path_to/test1]&apos;&lt;/span&gt;, resetLevel=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, clearRepaired=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, verifySSTables=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, verifyTokens=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, invalidateCaches=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, extendedVerify=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, copyData= &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;}
INFO  [RMI TCP Connection(21)-127.0.0.1] 2024-02-15 10:41:06,566 SSTableImporter.java:173 - No &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SSTables were found &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mykeyspace/mytable
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, when we move the sstables (.db-Files) to &lt;tt&gt;alternative/mykeyspace/mytable&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;and import with&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
nodetool &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; --copy-data mykeyspace mytable /fullpath/alternative/mykeyspace/mytable
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the import works&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
INFO  [RMI TCP Connection(23)-127.0.0.1] 2024-02-15 10:43:36,093 SSTableImporter.java:177 - Loading &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SSTables and building secondary indexes &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mykeyspace/mytable: [BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/mnt/ramdisk/cassandra4/data/mykeyspace/mytable-561a12d0cbe611eead78fbfd293cee40/me-2-big-Data.db&apos;&lt;/span&gt;), BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/mnt/ramdisk/cassandra4/data/mykeyspace/mytable-561a12d0cbe611eead78fbfd293cee40/me-1-big-Data.db&apos;&lt;/span&gt;)]
INFO  [RMI TCP Connection(23)-127.0.0.1] 2024-02-15 10:43:36,093 SSTableImporter.java:190 - Done loading load &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SSTables &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mykeyspace/mytable
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;We experienced this in Cassandra 4.1.3 on Java 11 (Linux)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13568565">CASSANDRA-19401</key>
            <summary>Nodetool import expects directory structure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="smiklosovic">Stefan Miklosovic</assignee>
                                    <reporter username="nob13">Norbert Schultz</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 Feb 2024 09:48:39 +0000</created>
                <updated>Thu, 2 May 2024 09:24:00 +0000</updated>
                            <resolved>Thu, 2 May 2024 08:56:58 +0000</resolved>
                                        <fixVersion>4.0.13</fixVersion>
                    <fixVersion>4.1.5</fixVersion>
                    <fixVersion>5.0-rc1</fixVersion>
                    <fixVersion>5.1-alpha1</fixVersion>
                                    <component>Local/SSTable</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="9000">2.5h</timespent>
                                <comments>
                            <comment id="17817632" author="smiklosovic" created="Thu, 15 Feb 2024 10:49:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nob13&quot; class=&quot;user-hover&quot; rel=&quot;nob13&quot;&gt;nob13&lt;/a&gt; this fixes your issue &lt;a href=&quot;https://github.com/apache/cassandra/pull/3106&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/3106&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I have not provided any formal builds yet and it might error something else but with this patch, it just &quot;nodetool import ks tb /tmp/mysstables&quot; fine into ks tb &lt;/p&gt;

&lt;p&gt;Could you test it too?&lt;/p&gt;</comment>
                            <comment id="17818375" author="nob13" created="Mon, 19 Feb 2024 08:31:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; Hi Stefan, I tested your PR and the nodetool import is working there &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I cannot say to much about the PR itself. From my perspective It looks as if removing the desired check could have other implications.&lt;/p&gt;

&lt;p&gt;Thanks alot for your rapid response!&lt;/p&gt;</comment>
                            <comment id="17818379" author="smiklosovic" created="Mon, 19 Feb 2024 08:38:48 +0000"  >&lt;p&gt;The problem here is that we construct a Descriptor and its inner logic will still look into the directory structure on the disk from which it derives a keyspace and a table. Then it is used upon import, but since a keyspace / table from descriptor is not same as what was specified on the command line, it will skip it as it thinks it is for a different keyspace / table. All I am doing is that whatever Descriptor resolves, we will set there keyspace / table from the command line so it will not skip that.&lt;/p&gt;

&lt;p&gt;If we say that a user does not need to have SSTables in a directory structure where parent is table and parent of parent is keyspace and it will load all what is in the directory, then I do not see what we have that extra check (I removed) for.&lt;/p&gt;

&lt;p&gt;I will run a full build to see what else it breaks if anything and let you know.&lt;/p&gt;</comment>
                            <comment id="17837992" author="nob13" created="Wed, 17 Apr 2024 06:56:03 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; are there any updates on this?&lt;/p&gt;

&lt;p&gt;We can workaround on this issue, now that we know, but maybe the rest of the community is happy if it&apos;s not happening anymore.&lt;/p&gt;</comment>
                            <comment id="17838054" author="smiklosovic" created="Wed, 17 Apr 2024 09:07:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nob13&quot; class=&quot;user-hover&quot; rel=&quot;nob13&quot;&gt;nob13&lt;/a&gt; this one is more complete patch &lt;a href=&quot;https://github.com/apache/cassandra/pull/3259&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/3259&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;would you verify that? I will create patches for other branches as well.&lt;/p&gt;</comment>
                            <comment id="17838115" author="smiklosovic" created="Wed, 17 Apr 2024 11:13:48 +0000"  >&lt;p&gt;4.1 build seems reasonably fine&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-19401-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-19401-4.1&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java11_pre-commit_tests                         
  &#10003; j11_build                                        1m 28s
  &#10003; j11_cqlsh_dtests_py3                             5m 24s
  &#10003; j11_cqlsh_dtests_py311                           5m 25s
  &#10003; j11_cqlsh_dtests_py311_vnode                     6m 14s
  &#10003; j11_cqlsh_dtests_py38                            5m 47s
  &#10003; j11_cqlsh_dtests_py38_vnode                      5m 57s
  &#10003; j11_cqlsh_dtests_py3_vnode                       5m 33s
  &#10003; j11_cqlshlib_cython_tests                        6m 55s
  &#10003; j11_cqlshlib_tests                                6m 9s
  &#10003; j11_dtests                                      33m 37s
  &#10003; j11_jvm_dtests                                   19m 2s
  &#10003; j11_jvm_dtests_vnode                            11m 38s
  &#10003; j11_unit_tests_repeat                             8m 4s
  &#10005; j11_dtests_vnode                                33m 39s
      rebuild_test.TestRebuild test_simple_rebuild
  &#10005; j11_unit_tests                                   7m 34s
      org.apache.cassandra.cql3.MemtableSizeTest testSize[skiplist]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4187/workflows/9164b340-3472-4ba7-a1ae-6ab5cbf695cb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java11_pre-commit_tests&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17838135" author="nob13" created="Wed, 17 Apr 2024 12:00:02 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; I tested your patch it it works for the nodetool import use case &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Thanks alot!&lt;/p&gt;</comment>
                            <comment id="17838225" author="smiklosovic" created="Wed, 17 Apr 2024 14:41:00 +0000"  >&lt;p&gt;5.0 looks fine too. cqlsh_dtests failed on some circle / github networking issue.&lt;/p&gt;

&lt;p&gt;ImportTest.testImportCorruptWithoutValidationWithCopying is just flaky and we discovered it here.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-19401-5.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-19401-5.0&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java17_pre-commit_tests                         
  &#10003; j17_build                                        3m 55s
  &#10003; j17_cqlsh_dtests_py311                           6m 18s
  &#10003; j17_cqlsh_dtests_py311_vnode                      6m 6s
  &#10003; j17_cqlsh_dtests_py38                             6m 9s
  &#10003; j17_cqlshlib_cython_tests                        7m 47s
  &#10003; j17_cqlshlib_tests                               6m 34s
  &#10003; j17_dtests                                      33m 27s
  &#10003; j17_dtests_latest                               32m 34s
  &#10003; j17_dtests_vnode                                33m 32s
  &#10003; j17_jvm_dtests                                  17m 57s
  &#10003; j17_jvm_dtests_latest_vnode                      16m 3s
  &#10003; j17_unit_tests                                  16m 12s
  &#10003; j17_utests_latest                               14m 15s
  &#10003; j17_utests_latest_repeat                          6m 0s
  &#10003; j17_utests_oa                                   14m 36s
  &#10003; j17_utests_oa_repeat                              6m 3s
  &#10005; j17_cqlsh_dtests_py38_vnode                      6m 31s
  &#10005; j17_unit_tests_repeat                           12m 43s
      org.apache.cassandra.db.ImportTest testImportCorruptWithoutValidationWithCopying
      org.apache.cassandra.db.ImportTest testImportCorruptWithoutValidationWithCopying
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4189/workflows/06a9fd1f-a7c6-4be4-bb45-ad09f1bc6e79&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java17_pre-commit_tests&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17838237" author="smiklosovic" created="Wed, 17 Apr 2024 14:53:25 +0000"  >&lt;p&gt;for reviewers: I did it in such a way that only nodetool import will behave like it does not skip when the dir structure does not match. The listing is done elsewhere too and I have not touched that. It behaves as it was.&lt;/p&gt;</comment>
                            <comment id="17838244" author="brandon.williams" created="Wed, 17 Apr 2024 15:07:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;ImportTest.testImportCorruptWithoutValidationWithCopying is just flaky and we discovered it here.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If you are saying that failure is unrelated to this ticket, I don&apos;t think that&apos;s accurate: &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1584/workflows/7797df46-e331-46de-ba5e-885814d8f9a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/driftx/cassandra/1584/workflows/7797df46-e331-46de-ba5e-885814d8f9a8&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17838501" author="smiklosovic" created="Thu, 18 Apr 2024 07:31:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-19401-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-19401-trunk&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java11_pre-commit_tests                         
  &#10003; j11_build                                        8m 35s
  &#10003; j11_cqlsh_dtests_py311                          10m 43s
  &#10003; j11_cqlsh_dtests_py311_vnode                     8m 33s
  &#10003; j11_cqlsh_dtests_py38                            8m 37s
  &#10003; j11_cqlsh_dtests_py38_vnode                      9m 16s
  &#10003; j11_cqlshlib_cython_tests                       12m 31s
  &#10003; j11_cqlshlib_tests                               10m 9s
  &#10003; j11_jvm_dtests_latest_vnode                     22m 51s
  &#10003; j11_unit_tests                                  19m 22s
  &#10003; j11_unit_tests_repeat                           10m 45s
  &#10003; j11_utests_latest                                17m 4s
  &#10003; j11_utests_latest_repeat                         9m 50s
  &#10003; j11_utests_oa_repeat                            10m 37s
  &#10003; j11_utests_system_keyspace_directory_repeat     10m 12s
  &#10003; j17_cqlsh_dtests_py311                           7m 19s
  &#10003; j17_cqlsh_dtests_py311_vnode                     7m 34s
  &#10003; j17_cqlsh_dtests_py38                            6m 55s
  &#10003; j17_cqlsh_dtests_py38_vnode                      7m 38s
  &#10003; j17_cqlshlib_cython_tests                        7m 54s
  &#10003; j17_cqlshlib_tests                               6m 16s
  &#10003; j17_unit_tests                                  13m 45s
  &#10003; j17_unit_tests_repeat                             6m 7s
  &#10003; j17_utests_latest                                16m 6s
  &#10003; j17_utests_latest_repeat                         6m 42s
  &#10003; j17_utests_oa                                   17m 23s
  &#10003; j17_utests_oa_repeat                              6m 6s
  &#10005; j11_dtests                                      38m 56s
      gossip_test.TestGossip test_assassinate_valid_node
  &#10005; j11_dtests_latest                               37m 52s
      configuration_test.TestConfiguration test_change_durable_writes
      gossip_test.TestGossip test_assassinate_valid_node
  &#10005; j11_dtests_vnode                                37m 21s
      gossip_test.TestGossip test_assassinate_valid_node
  &#10005; j11_jvm_dtests                                  39m 56s
      org.apache.cassandra.distributed.test.log.FetchLogFromPeersTest testCMSCatchupTest TIMEOUTED
  &#10005; j11_simulator_dtests                            36m 28s
      org.apache.cassandra.simulator.test.HarrySimulatorTest test
      org.apache.cassandra.simulator.test.ShortPaxosSimulationTest simulationTest
  &#10005; j11_utests_oa                                   19m 44s
      org.apache.cassandra.net.ConnectionTest testTimeout
  &#10005; j11_utests_system_keyspace_directory             21m 5s
      org.apache.cassandra.tools.TopPartitionsTest testServiceTopPartitionsSingleTable
  &#10005; j17_dtests                                      37m 14s
      gossip_test.TestGossip test_assassinate_valid_node
  &#10005; j17_dtests_latest                               36m 41s
      configuration_test.TestConfiguration test_change_durable_writes
      gossip_test.TestGossip test_assassinate_valid_node
  &#10005; j17_dtests_vnode                                 37m 1s
      gossip_test.TestGossip test_assassinate_valid_node
  &#10005; j17_jvm_dtests                                  27m 32s
      org.apache.cassandra.distributed.test.NativeTransportEncryptionOptionsTest testOptionalMtlsModeDoNotAllowNonSSLConnections TIMEOUTED
      org.apache.cassandra.distributed.test.log.FetchLogFromPeersTest testCMSCatchupTest
      org.apache.cassandra.distributed.test.tcm.SplitBrainTest testSplitBrainStartup TIMEOUTED
  &#10005; j17_jvm_dtests_latest_vnode                     22m 24s
      junit.framework.TestSuite org.apache.cassandra.fuzz.harry.integration.model.InJVMTokenAwareExecutorTest TIMEOUTED
java11_separate_tests                            
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4192/workflows/09240a96-74db-4549-bb0d-7ad9a6776b09&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java11_pre-commit_tests&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17838623" author="smiklosovic" created="Thu, 18 Apr 2024 11:49:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-19401-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-19401-4.0&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;                            
java8_pre-commit_tests                          
  &#10003; j8_build                                         4m 54s
  &#10003; j8_cqlsh-dtests-py2-no-vnodes                    6m 22s
  &#10003; j8_cqlsh-dtests-py2-with-vnodes                  8m 30s
  &#10003; j8_cqlsh_dtests_py3                              6m 22s
  &#10003; j8_cqlsh_dtests_py311                             9m 1s
  &#10003; j8_cqlsh_dtests_py311_vnode                      6m 20s
  &#10003; j8_cqlsh_dtests_py38                             8m 37s
  &#10003; j8_cqlsh_dtests_py38_vnode                        7m 2s
  &#10003; j8_cqlsh_dtests_py3_vnode                        5m 44s
  &#10003; j8_cqlshlib_tests                                8m 13s
  &#10003; j8_dtests                                       32m 11s
  &#10003; j8_dtests_vnode                                 37m 10s
  &#10003; j8_jvm_dtests                                   12m 46s
  &#10003; j8_unit_tests_repeat                             8m 12s
  &#10003; j11_unit_tests_repeat                            7m 42s
  &#10003; j11_dtests_vnode                                 35m 3s
  &#10003; j11_dtests                                      31m 14s
  &#10003; j11_cqlsh_dtests_py3_vnode                       5m 29s
  &#10003; j11_cqlsh_dtests_py38_vnode                      5m 51s
  &#10003; j11_cqlsh_dtests_py38                            5m 26s
  &#10003; j11_cqlsh_dtests_py311_vnode                     5m 43s
  &#10003; j11_cqlsh_dtests_py311                           5m 56s
  &#10003; j11_cqlsh_dtests_py3                              6m 3s
  &#10003; j11_cqlsh-dtests-py2-with-vnodes                 5m 47s
  &#10003; j11_cqlsh-dtests-py2-no-vnodes                   5m 51s
  &#10005; j8_unit_tests                                   10m 58s
      org.apache.cassandra.cql3.MemtableSizeTest testTruncationReleasesLogSpace
  &#10005; j8_utests_system_keyspace_directory             10m 52s
      org.apache.cassandra.index.sasi.SASICQLTest testPagingWithClustering
      org.apache.cassandra.cql3.MemtableSizeTest testTruncationReleasesLogSpace
  &#10005; j8_utests_system_keyspace_directory_repeat       8m 56s
      org.apache.cassandra.db.ImportTest testImportInvalidateCache
  &#10005; j11_unit_tests                                   8m 13s
      org.apache.cassandra.net.ConnectionTest testMessageDeliveryOnReconnect
      org.apache.cassandra.cql3.MemtableSizeTest testTruncationReleasesLogSpace
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4197/workflows/fa55d5f0-4ed8-4125-bb9e-f83a22446050&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java8_pre-commit_tests&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;org.apache.cassandra.db.ImportTest testImportInvalidateCache seem to be a flaky one, similar case as for 5.0 build&lt;/p&gt;</comment>
                            <comment id="17838627" author="brandon.williams" created="Thu, 18 Apr 2024 12:20:26 +0000"  >&lt;p&gt;The flakiness in the ImportTests seems to be caused by this patch, as without it 5.0 can pass 5k times &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1586/workflows/2f172253-80a8-4c5f-b299-174067f0c4c6/jobs/84768/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; and &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1589/workflows/868187b9-32e5-49ce-98a4-db4b9c48d148/jobs/85046/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17838756" author="smiklosovic" created="Thu, 18 Apr 2024 17:51:46 +0000"  >&lt;p&gt;We need to postpone the merging of this patch until we resolve the flakiness of ImportTest across all branches.&#160;&lt;/p&gt;</comment>
                            <comment id="17838771" author="smiklosovic" created="Thu, 18 Apr 2024 19:14:49 +0000"  >&lt;p&gt;OK so given &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-19572&quot; title=&quot;Test failure: org.apache.cassandra.db.ImportTest flakiness&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-19572&quot;&gt;&lt;del&gt;CASSANDRA-19572&lt;/del&gt;&lt;/a&gt; I think we can merge this. Moving to ready to commit, correct me if not desirable.&#160;&lt;/p&gt;</comment>
                            <comment id="17838772" author="brandon.williams" created="Thu, 18 Apr 2024 19:15:19 +0000"  >&lt;p&gt;No, we have to fix those tests first.&lt;/p&gt;</comment>
                            <comment id="17840373" author="smiklosovic" created="Wed, 24 Apr 2024 10:17:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;4.0 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4223/workflows/a82d0483-a0df-44ed-8127-088b303c78ba/jobs/225432/steps&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4223/workflows/a82d0483-a0df-44ed-8127-088b303c78ba/jobs/225432/steps&lt;/a&gt;&lt;br/&gt;
4.1 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4224/workflows/eae7a5e2-89dd-46cd-aaca-1e4250d0fa8b/jobs/225531/steps&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4224/workflows/eae7a5e2-89dd-46cd-aaca-1e4250d0fa8b/jobs/225531/steps&lt;/a&gt;&lt;br/&gt;
5.0 j11 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4226/workflows/9805ec75-fd02-4c5a-8996-fa5bce71e8c2/jobs/225728/steps&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4226/workflows/9805ec75-fd02-4c5a-8996-fa5bce71e8c2/jobs/225728/steps&lt;/a&gt;&lt;br/&gt;
5.0 j17 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4226/workflows/9805ec75-fd02-4c5a-8996-fa5bce71e8c2/jobs/225727/steps&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4226/workflows/9805ec75-fd02-4c5a-8996-fa5bce71e8c2/jobs/225727/steps&lt;/a&gt;&lt;br/&gt;
trunk &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4240/workflows/b931bc9e-23f8-4b3c-b3b3-86de9029bed6/jobs/227089&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/4240/workflows/b931bc9e-23f8-4b3c-b3b3-86de9029bed6/jobs/227089&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;not increasing number of tokens from 5 to 15 tends to fail on this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
INFO  [main] 2024-04-23 10:50:01,832 Verifying BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/tmp/importtest6316811178601946178/cql_test_keyspace/table_09/nb-1-big-Data.db&apos;&lt;/span&gt;) (29.151KiB)
INFO  [main] 2024-04-23 10:50:01,832 Deserializing sstable metadata &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/tmp/importtest6316811178601946178/cql_test_keyspace/table_09/nb-1-big-Data.db&apos;&lt;/span&gt;) 
WARN  [main] 2024-04-23 10:50:01,835 Key DecoratedKey(-9202596579742833778, 00000301) is not contained in the given ranges
java.lang.RuntimeException: Key DecoratedKey(-9202596579742833778, 00000301) is not contained in the given ranges
	at org.apache.cassandra.db.compaction.Verifier$RangeOwnHelper.validate(Verifier.java:381)
	at org.apache.cassandra.db.compaction.Verifier.verify(Verifier.java:197)
	at org.apache.cassandra.db.SSTableImporter.verifySSTableForImport(SSTableImporter.java:347)
	at org.apache.cassandra.db.SSTableImporter.importNewSSTables(SSTableImporter.java:96)
	at org.apache.cassandra.db.ImportTest.testImportOutOfRange(ImportTest.java:429)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All branches are prepared, once merged, we can close &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-19572&quot; title=&quot;Test failure: org.apache.cassandra.db.ImportTest flakiness&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-19572&quot;&gt;&lt;del&gt;CASSANDRA-19572&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;added 2s sleep also seem to improve the non-flakiness of the other test across the branches.&lt;/p&gt;</comment>
                            <comment id="17842693" author="brandon.williams" created="Wed, 1 May 2024 15:43:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;added 2s sleep also seem to improve the non-flakiness of the other test across the branches.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Can you explain what you mean here?  Do we know why 2s is needed?&lt;/p&gt;</comment>
                            <comment id="17842715" author="smiklosovic" created="Wed, 1 May 2024 16:30:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; if you look into testImportInvalidateCache, when that sleep is not added here (1), the very next assert&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
assertEquals(10, CacheService.instance.rowCache.size());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;might fail because CacheService.instance.rowCache.size() might see 20.&lt;/p&gt;

&lt;p&gt;(1) &lt;a href=&quot;https://github.com/apache/cassandra/blob/f8929d62ee565b612df00cd9ee8825918d0e359e/test/unit/org/apache/cassandra/db/ImportTest.java#L550&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/f8929d62ee565b612df00cd9ee8825918d0e359e/test/unit/org/apache/cassandra/db/ImportTest.java#L550&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17842718" author="brandon.williams" created="Wed, 1 May 2024 16:47:53 +0000"  >&lt;p&gt;I see.  I&apos;m not crazy about sleeping but I don&apos;t see a better path currently.  +1&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310060">
                    <name>Container</name>
                                            <outwardlinks description="contains">
                                        <issuelink>
            <issuekey id="13576420">CASSANDRA-19572</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13576420">CASSANDRA-19572</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[smiklosovic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12986" cascade-level="1"><![CDATA[Recoverable Corruption / Loss]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12313826" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Change Category</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13005"><![CDATA[Operability]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 27 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1nexc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12350367">4.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/334ca05730d8088f27323166e3ee1505db5cb202&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/334ca05730d8088f27323166e3ee1505db5cb202&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;CI&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>