<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:07:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13103] incorrect jvm metric names</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13103</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Some jvm metrics have a double dot in name like:&lt;br/&gt;
jvm.memory..total.max , jvm.memory..total.init (etc).&lt;br/&gt;
it seems that an extra dot is added at the end of the name in CassandraDaemon.java, around line 367 (in 3.0.10):&lt;br/&gt;
...&lt;br/&gt;
                // enable metrics provided by metrics-jvm.jar&lt;br/&gt;
                CassandraMetricsRegistry.Metrics.register(&quot;jvm.buffers.&quot;, new BufferPoolMetricSet(ManagementFactory.getPlatformMBeanServer()));&lt;br/&gt;
                CassandraMetricsRegistry.Metrics.register(&quot;jvm.gc.&quot;, new GarbageCollectorMetricSet());&lt;br/&gt;
                CassandraMetricsRegistry.Metrics.register(&quot;jvm.memory.&quot;, new MemoryUsageGaugeSet());&lt;/p&gt;

&lt;p&gt;and also added in append method of MetricRegistry.&lt;br/&gt;
Call stack is:&lt;br/&gt;
MetricRegistry&amp;gt;&amp;gt;registerAll(String prefix, MetricSet metrics)&lt;br/&gt;
MetricRegistry&amp;gt;&amp;gt;static String name(String name, String... names)&lt;br/&gt;
MetricRegistry&amp;gt;&amp;gt;static void append(StringBuilder builder, String part)&lt;/p&gt;

&lt;p&gt;and in append the dot is also added:&lt;br/&gt;
...&lt;br/&gt;
            if(builder.length() &amp;gt; 0) &lt;/p&gt;
{
                builder.append(&apos;.&apos;);
            }
&lt;p&gt;            builder.append(part);&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;The codahale MetricRegistry class seems to have no recent modification of name or append methods, so it look like a small bug.&lt;br/&gt;
May be the fix could be to simply not to add  the final dot in the metric name, ie  &quot;jvm.buffers&quot;  instead of &quot;jvm.buffers.&quot;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13032357">CASSANDRA-13103</key>
            <summary>incorrect jvm metric names</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="arastoul">Alain Rastoul</assignee>
                                    <reporter username="arastoul">Alain Rastoul</reporter>
                        <labels>
                            <label>lhf</label>
                    </labels>
                <created>Thu, 5 Jan 2017 19:30:04 +0000</created>
                <updated>Fri, 15 May 2020 08:02:33 +0000</updated>
                            <resolved>Mon, 3 Apr 2017 18:08:26 +0000</resolved>
                                        <fixVersion>2.2.10</fixVersion>
                    <fixVersion>3.0.13</fixVersion>
                    <fixVersion>3.11.0</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Legacy/Observability</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15802580" author="zznate" created="Thu, 5 Jan 2017 21:30:34 +0000"  >&lt;p&gt;From &quot;weird jvm metrics&quot; thread on user ML, from OP this appeared somewhere between 3.5 and 3.9. ML Thread: &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://lists.apache.org/thread.html/558bd7c1f9eff0be60939bae620e13dbbef3a819846e2c4735aa2cfa@%3Cuser.cassandra.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread.html/558bd7c1f9eff0be60939bae620e13dbbef3a819846e2c4735aa2cfa@%3Cuser.cassandra.apache.org%3E&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="15809186" author="arastoul" created="Sun, 8 Jan 2017 10:53:15 +0000"  >&lt;p&gt;The problem has been introduced in 3.9, &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12312&quot; title=&quot;Restore JVM metric export for metric reporters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12312&quot;&gt;&lt;del&gt;CASSANDRA-12312&lt;/del&gt;&lt;/a&gt; : Add JVM metrics for custom metrics reporter, 2016-07-26.&lt;/p&gt;

&lt;p&gt;It should be present in cassandra-2.2, cassandra-3.0, cassandra-3.11, cassandra-3.X, trunk&lt;/p&gt;

&lt;p&gt;I have attached a patch for 3.9 (and 3.X) which removes the unnecessary &apos;.&apos; and added a unit test for jvm metrics registration.&lt;/p&gt;

&lt;p&gt;I followed the &apos;How to contribute&apos; wiki notes but was unable to assign myself the issue. &lt;br/&gt;
May be an ASF member can tell me what to do or add me as assignable, in case I could work on other LHF?&lt;br/&gt;
TIA&lt;/p&gt;

</comment>
                            <comment id="15844509" author="lvkr10" created="Sun, 29 Jan 2017 16:29:31 +0000"  >&lt;p&gt;Sorry I accidentally committed it.&lt;br/&gt;
The issue is still unresolved&lt;/p&gt;</comment>
                            <comment id="15844850" author="jjirsa" created="Mon, 30 Jan 2017 06:06:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arastoul&quot; class=&quot;user-hover&quot; rel=&quot;arastoul&quot;&gt;arastoul&lt;/a&gt; - Ticket&apos;s assigned to you (was a bit ago), and I&apos;ve reopened it after the accidental closing. We&apos;ll set it as patch-available, and hopefully a reviewer finds time to check it.&lt;/p&gt;

&lt;p&gt;Thanks for the help!&lt;/p&gt;</comment>
                            <comment id="15853952" author="spodxx@gmail.com" created="Mon, 6 Feb 2017 13:03:39 +0000"  >&lt;p&gt;Thanks for the patch, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arastoul&quot; class=&quot;user-hover&quot; rel=&quot;arastoul&quot;&gt;arastoul&lt;/a&gt;! This is a little strange. I remember that I had to add that single dot character while working on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12312&quot; title=&quot;Restore JVM metric export for metric reporters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12312&quot;&gt;&lt;del&gt;CASSANDRA-12312&lt;/del&gt;&lt;/a&gt;, or else the dot would have been absent between the two names. But I can&apos;t really reproduce this and the code and netcat clearly indicates otherwise. So I&apos;d suggest to go with the proposed patch (2.2 upwards), as the code is clearly not working as intended now.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/spodkowinski/cassandra/tree/CASSANDRA-13103-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/spodkowinski/cassandra/tree/CASSANDRA-13103-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/spodkowinski/cassandra/tree/CASSANDRA-13103-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/spodkowinski/job/spodkowinski-CASSANDRA-13103-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/spodkowinski/job/spodkowinski-CASSANDRA-13103-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/spodkowinski/job/spodkowinski-CASSANDRA-13103-trunk-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/spodkowinski/job/spodkowinski-CASSANDRA-13103-2.2-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/spodkowinski/job/spodkowinski-CASSANDRA-13103-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/spodkowinski/job/spodkowinski-CASSANDRA-13103-trunk-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;(please note that trunk contains extra code for unit test)&lt;/p&gt;</comment>
                            <comment id="15856725" author="arastoul" created="Tue, 7 Feb 2017 20:27:23 +0000"  >&lt;p&gt;Thank you for the review, Stefan. &lt;br/&gt;
I checked the codahale metrics registry and the append method who adds the dot has been added&lt;br/&gt;
in mars 2013 : &lt;a href=&quot;https://github.com/dropwizard/metrics/commit/0ae1fc0292fa2f7509ab7f237f6a752e316a0d86&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/dropwizard/metrics/commit/0ae1fc0292fa2f7509ab7f237f6a752e316a0d86&lt;/a&gt;&lt;br/&gt;
so IMHO this patch should be useful for any recent codahale library version use.&lt;/p&gt;</comment>
                            <comment id="15953929" author="spodxx@gmail.com" created="Mon, 3 Apr 2017 18:08:26 +0000"  >&lt;p&gt;Merged as a79cc9840d8c5a400e9838e0a366bb371ff5d918&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12846220" name="Fix-incorrect-jvm-metric-names-CASSANDRA-13103.patch" size="4541" author="arastoul" created="Sun, 8 Jan 2017 10:41:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[arastoul]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 33 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38blj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12338291">3.0.10</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>spod</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[spod]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>