<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:44:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-7033] new stress errors on reads with native protocol</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-7033</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Getting errors when performing reads on native protocol (possible due to using prepared statements). Generate writes with this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cassandra-stress write -schema replication\(factor\=2\) -mode &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt; prepared cql3 -port &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;=9043 thrift=9161 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then trying to read gives this error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cassandra-stress read -schema replication\(factor\=2\) -mode &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt; prepared cql3 -port &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;=9043 thrift=9161  

com.datastax.driver.core.exceptions.SyntaxError: line 1:7 no viable alternative at input &lt;span class=&quot;code-quote&quot;&gt;&apos;?&apos;&lt;/span&gt;
	at com.datastax.driver.core.exceptions.SyntaxError.copy(SyntaxError.java:35)
	at com.datastax.driver.core.DefaultResultSetFuture.extractCauseFromExecutionException(DefaultResultSetFuture.java:256)
	at com.datastax.driver.core.SessionManager.prepare(SessionManager.java:110)
	at org.apache.cassandra.stress.util.JavaDriverClient.prepare(JavaDriverClient.java:57)
	at org.apache.cassandra.stress.operations.CqlOperation$JavaDriverWrapper.createPreparedStatement(CqlOperation.java:325)
	at org.apache.cassandra.stress.operations.CqlOperation.run(CqlOperation.java:74)
	at org.apache.cassandra.stress.operations.CqlOperation.run(CqlOperation.java:106)
	at org.apache.cassandra.stress.operations.CqlOperation.run(CqlOperation.java:269)
	at org.apache.cassandra.stress.StressAction$Consumer.run(StressAction.java:296)
Caused by: com.datastax.driver.core.exceptions.SyntaxError: line 1:7 no viable alternative at input &lt;span class=&quot;code-quote&quot;&gt;&apos;?&apos;&lt;/span&gt;
	at com.datastax.driver.core.Responses$Error.asException(Responses.java:94)
	at com.datastax.driver.core.SessionManager$2.apply(SessionManager.java:209)
	at com.datastax.driver.core.SessionManager$2.apply(SessionManager.java:184)
	at com.google.common.util.concurrent.Futures$1.apply(Futures.java:713)
	at com.google.common.util.concurrent.Futures$ChainingListenableFuture.run(Futures.java:861)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12708354">CASSANDRA-7033</key>
            <summary>new stress errors on reads with native protocol</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="benedict">Benedict Elliott Smith</assignee>
                                    <reporter username="jasobrown">Jason Brown</reporter>
                        <labels>
                            <label>native_protocol</label>
                            <label>stress</label>
                    </labels>
                <created>Mon, 14 Apr 2014 19:25:50 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:48 +0000</updated>
                            <resolved>Tue, 22 Apr 2014 17:38:56 +0000</resolved>
                                        <fixVersion>2.1 rc2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13975104" author="benedict" created="Sun, 20 Apr 2014 10:54:12 +0000"  >&lt;p&gt;Simple patch attached&lt;/p&gt;</comment>
                            <comment id="13975779" author="jasobrown" created="Mon, 21 Apr 2014 17:52:04 +0000"  >&lt;p&gt;Running with patch now and it looks likes it&apos;s working. However, as long as we&apos;re here, can you go ahead and see if you can eliminate this warning:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;WARN  17:49:28 Re-preparing already prepared query SELECT &lt;span class=&quot;code-quote&quot;&gt;&quot;C0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;C1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;C2&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;C3&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;C4&quot;&lt;/span&gt; FROM &lt;span class=&quot;code-quote&quot;&gt;&quot;Standard1&quot;&lt;/span&gt; WHERE KEY=?. Please note that preparing the same query more than once is generally an anti-pattern and will likely affect performance. Consider preparing the statement only once.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It&apos;s printed once for for every thread that executes. and is kind of an annoyance when 913 threads are running &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. Note: it happens on both reads and writes&lt;/p&gt;</comment>
                            <comment id="13976150" author="benedict" created="Mon, 21 Apr 2014 23:01:06 +0000"  >&lt;p&gt;Really I just want to suppress that warning. What we&apos;re doing is perfectly harmless and not an anti-pattern, so I begrudge changing the code to avoid it. I deliberately prepare it once per thread, I don&apos;t really want to have the complexity of an intermediate inter-thread cache.&lt;/p&gt;</comment>
                            <comment id="13977054" author="jasobrown" created="Tue, 22 Apr 2014 17:00:20 +0000"  >&lt;p&gt;While I agree that it&apos;s harmless in this case, the authors of the library felt otherwise about it being an anti-pattern (hence the logging). That being said adding the following line to my conf/logback.xml shuts up the java driver rather easily:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;logger name=&lt;span class=&quot;code-quote&quot;&gt;&quot;com.datastax.driver.core&quot;&lt;/span&gt; level=&lt;span class=&quot;code-quote&quot;&gt;&quot;ERROR&quot;&lt;/span&gt;/&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m doubtful we want to add that to the main logging file for cassandra (as it would introduce some, albeit minor, confusion), but leaving it here for posterity.&lt;/p&gt;</comment>
                            <comment id="13977060" author="jasobrown" created="Tue, 22 Apr 2014 17:04:55 +0000"  >&lt;p&gt;+1, otherwise&lt;/p&gt;</comment>
                            <comment id="13977096" author="jasobrown" created="Tue, 22 Apr 2014 17:38:56 +0000"  >&lt;p&gt;Committed to cassandra-2.1 and trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12640987" name="7033.txt" size="5039" author="benedict" created="Sun, 20 Apr 2014 10:54:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[benedict]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>386677</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 31 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1um1z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>386941</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jasobrown</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jasobrown]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>