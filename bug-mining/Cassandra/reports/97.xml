<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:10:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-212] Range queries do not yet span multiple nodes</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-212</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Need ability to continue a query on the next node in the ring, if necessary&lt;/p&gt;</description>
                <environment></environment>
        <key id="12427015">CASSANDRA-212</key>
            <summary>Range queries do not yet span multiple nodes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="phatduckk">Arin Sarkissian</assignee>
                                    <reporter username="jbellis">Jonathan Ellis</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Jun 2009 09:22:56 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:37 +0000</updated>
                            <resolved>Fri, 31 Jul 2009 18:28:27 +0000</resolved>
                                        <fixVersion>0.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="12725775" author="jbellis" created="Tue, 30 Jun 2009 20:02:39 +0000"  >&lt;p&gt;All this needs is a bool added to RangeReply that is true if it stopped b/c the next local key was not part of the range, or the asked-for limit was reached.&lt;/p&gt;

&lt;p&gt;If a reply comes back with that bool false, then the coordinator node, the one talking to the client, sends the query to the next node in the ring down from the one it just got a reply from and appends those results to the list it&apos;s going to return to the client.&lt;/p&gt;

&lt;p&gt;Repeat until the i&apos;m-done-bool comes back true.&lt;/p&gt;</comment>
                            <comment id="12730887" author="markr" created="Tue, 14 Jul 2009 14:49:11 +0000"  >&lt;p&gt;Sounds like a pretty serious bug in the general case, but might not happen very often in practice.&lt;/p&gt;</comment>
                            <comment id="12733875" author="jbellis" created="Tue, 21 Jul 2009 22:47:03 +0000"  >&lt;p&gt;(the relevant starting point is StorageProxy.getKeyRange)&lt;/p&gt;</comment>
                            <comment id="12733896" author="junrao" created="Tue, 21 Jul 2009 23:24:17 +0000"  >&lt;p&gt;This can be a bit tricky because the key ranges btw 2 consecutive nodes overlap (because of replication). When moving to the next node, you want to be careful not to pick up duplicated keys.&lt;/p&gt;

&lt;p&gt;Also, the approach that Jonathan described forces nodes to be scanned sequentially. Sometimes, it is more efficient to scan multiple nodes in parallel, especially if maxResult is unspecified.&lt;/p&gt;</comment>
                            <comment id="12733913" author="jbellis" created="Tue, 21 Jul 2009 23:52:46 +0000"  >&lt;p&gt;&amp;gt; When moving to the next node, you want to be careful not to pick up duplicated keys. &lt;/p&gt;

&lt;p&gt;that is why you give the last value received from node #1 as the start_with parameter to node #2.  so at most there will be one duplicate.&lt;/p&gt;

&lt;p&gt;&amp;gt; Sometimes, it is more efficient to scan multiple nodes in parallel&lt;/p&gt;

&lt;p&gt;Unless you have trivially small amounts of data on each node, in which case it doesn&apos;t matter, any number that&apos;s going to fit in memory is going to be better served by sequential scanning since the odds are excellent that you won&apos;t have to cross to another node.&lt;/p&gt;</comment>
                            <comment id="12735873" author="phatduckk" created="Tue, 28 Jul 2009 01:07:31 +0000"  >&lt;p&gt;first cut at &lt;a href=&quot;http://github.com/phatduckk/Cassandra/commit/b535b00f2917995f93f5838a98e08931e2b52680&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://github.com/phatduckk/Cassandra/commit/b535b00f2917995f93f5838a98e08931e2b52680&lt;/a&gt;&lt;br/&gt;
I did a bunch of refactoring to get a lot of the get*Endpoint*() type methods to take an offset.&lt;/p&gt;

&lt;p&gt;still need to work on the replicas.&lt;/p&gt;

&lt;p&gt;anyways... wanted feedback on the approach. anyone wanna take a look and lemme know what you think?&lt;/p&gt;</comment>
                            <comment id="12735899" author="jbellis" created="Tue, 28 Jul 2009 02:57:54 +0000"  >&lt;p&gt;looks good, modulo the headers being in all the diffs (whitespace?)&lt;/p&gt;

&lt;p&gt;&amp;gt; still need to work on the replicas&lt;/p&gt;

&lt;p&gt;all you need to do is change&lt;/p&gt;

&lt;p&gt;command = new RangeCommand(command.table, command.columnFamily, command.startWith, command.stopAt, command.maxResults - rangeKeys.size());&lt;/p&gt;

&lt;p&gt;to pass in the last key from the previous node as the start.  right?  or are you talking about something else?&lt;/p&gt;</comment>
                            <comment id="12736321" author="phatduckk" created="Tue, 28 Jul 2009 21:39:34 +0000"  >&lt;p&gt;attempt at #212&lt;/p&gt;

&lt;p&gt;unit tests and nosetests pass&lt;/p&gt;</comment>
                            <comment id="12736426" author="jbellis" created="Wed, 29 Jul 2009 03:10:37 +0000"  >&lt;p&gt;i&apos;m a little confused by the git commit message.&lt;/p&gt;

&lt;p&gt;which of those are &quot;mission accomplished&quot; and which are &quot;to-dos&quot; if any? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12736429" author="jbellis" created="Wed, 29 Jul 2009 03:21:09 +0000"  >&lt;p&gt;we still need this part&lt;/p&gt;

&lt;p&gt;&amp;gt; this needs a bool added to RangeReply that is true if it stopped b/c the next local key was not part of the range, or the asked-for limit was reached&lt;/p&gt;

&lt;p&gt;otherwise we have to do extra queries for every range command that doesn&apos;t hit the max results or the end key.&lt;/p&gt;

&lt;p&gt;also,&lt;/p&gt;

&lt;p&gt;            while (endPoint != null)&lt;/p&gt;

&lt;p&gt;                if (endPoint.toString().equals(firstEndpoint)) break&lt;/p&gt;

&lt;p&gt;these seem redundant, shouldn&apos;t it be while (true) if (endpoint == null) &lt;/p&gt;
{ throw }
&lt;p&gt; ?&lt;/p&gt;</comment>
                            <comment id="12736887" author="phatduckk" created="Wed, 29 Jul 2009 22:55:47 +0000"  >&lt;p&gt;created an object called RangeResult that encapsulates the keys and a boolean flag called isInRange.&lt;/p&gt;

&lt;p&gt;i plumbed this thru RangeReply and to StorageProxy.getKeyRange&lt;/p&gt;

&lt;p&gt;there&apos;s a squashed commit with all changes at:&lt;br/&gt;
&lt;a href=&quot;http://github.com/phatduckk/Cassandra/commit/a5b2d264a1567a97b04e6d7874e0114a3ebd32d8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://github.com/phatduckk/Cassandra/commit/a5b2d264a1567a97b04e6d7874e0114a3ebd32d8&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;is the RangeResult stuff ok? It seemed to be the best way to flag whether a node had gone thru its entire range or not&lt;/p&gt;

&lt;p&gt;(ignore ws diff - i&apos;ll prune those when i make a patch)&lt;/p&gt;</comment>
                            <comment id="12736968" author="jbellis" created="Thu, 30 Jul 2009 02:46:50 +0000"  >&lt;p&gt;Looks good to me overall.&lt;/p&gt;

&lt;p&gt;RangeResult looks an awful lot like RangeReply w/ less methods.  Could we just use RangeReply and cut out the middleman?  I dunno.  Java feels so clunky here.&lt;/p&gt;

&lt;p&gt;One way to return multiple values would be like this&lt;/p&gt;

&lt;p&gt;        return new HashMap&amp;lt;String, Object&amp;gt;() {{&lt;br/&gt;
            put(&quot;keys&quot;, listOfStrings);&lt;br/&gt;
            put(&quot;finished&quot;, true);&lt;br/&gt;
        }};&lt;/p&gt;

&lt;p&gt;Who says constructor blocks aren&apos;t useful? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Can we the bool in RangeReply it something besides isInRange?  In the range does not imply &quot;contains the entire range&quot; to me.  Rather the opposite relationship.  If you don&apos;t like &quot;finished&quot; maybe isComplete, rangeComplete, rangeCompletedLocally, ...&lt;/p&gt;</comment>
                            <comment id="12736981" author="phatduckk" created="Thu, 30 Jul 2009 04:02:26 +0000"  >&lt;p&gt;i thought about the HashMap thing but Sammy and I thought that was kinda hacky. I&apos;ll see about merging RangeResult with RangeReply.&lt;/p&gt;

&lt;p&gt;I&apos;ll have some alternative(s) tomorrow. &lt;/p&gt;

&lt;p&gt;Also - i have no problem renaming the boolean. rangeCompletedLocally sounds most descriptive to me so ill go with that&lt;/p&gt;</comment>
                            <comment id="12737376" author="phatduckk" created="Fri, 31 Jul 2009 00:15:24 +0000"  >&lt;p&gt;single patch file to address the range queries&lt;/p&gt;</comment>
                            <comment id="12737378" author="phatduckk" created="Fri, 31 Jul 2009 00:23:26 +0000"  >&lt;p&gt;new patch with previous comments addressed&lt;/p&gt;</comment>
                            <comment id="12737565" author="jbellis" created="Fri, 31 Jul 2009 15:09:18 +0000"  >&lt;p&gt;does not apply to trunk (because of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-111&quot; title=&quot;Mixed line endings in the codebase&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-111&quot;&gt;&lt;del&gt;CASSANDRA-111&lt;/del&gt;&lt;/a&gt; maybe?), can you rebase?&lt;/p&gt;</comment>
                            <comment id="12737624" author="phatduckk" created="Fri, 31 Jul 2009 18:10:31 +0000"  >&lt;p&gt;rabased my last patch against trunk @ 9164940f41972e3611d1ad38a903ca39562e6feb&lt;/p&gt;</comment>
                            <comment id="12737643" author="jbellis" created="Fri, 31 Jul 2009 18:28:26 +0000"  >&lt;p&gt;committed, thanks!&lt;/p&gt;</comment>
                            <comment id="12737874" author="hudson" created="Sat, 1 Aug 2009 12:34:01 +0000"  >&lt;p&gt;Integrated in Cassandra #154 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/154/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/154/&lt;/a&gt;)&lt;br/&gt;
    Make range queries continue on the next node when necessary.&lt;br/&gt;
Patch by Arin Sarkissian; reviewed by jbellis for &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12415079" name="0001-All-patches-for-212.-All-comments-in-https-issues.patch" size="26341" author="phatduckk" created="Fri, 31 Jul 2009 00:23:26 +0000"/>
                            <attachment id="12414807" name="0001-Cassandra-212.patch" size="17752" author="phatduckk" created="Tue, 28 Jul 2009 21:39:34 +0000"/>
                            <attachment id="12415135" name="rebased-212-against-9164940f41972e3611d1ad38a903ca39562e6feb.patch" size="26165" author="phatduckk" created="Fri, 31 Jul 2009 18:10:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[phatduckk]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19596</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 17 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0fxjz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>91034</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>