<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:17:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-1678] describe_schema_versions does not list downed hosts</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-1678</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;According to the description unreachable hosts should be listed. It does not seem like they are.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; map&amp;lt;string, list&amp;lt;string&amp;gt;&amp;gt; describe_schema_versions()

  [java] key:c3f38ebc-e1c5-11df-95a0-e700f669bcfc
     [java] 	127.0.0.2
     [java] 	127.0.0.3
     [java] 	127.0.0.4
     [java] 	127.0.0.1

Address         Status State   Load            Token                                       
                                       105444142448428656124184491892431731479    
127.0.0.3       Up     Normal  56.53 KB        43021486531749787992103274496183765897      
127.0.0.1       Up     Normal  56.24 KB        49910048177093876350019363877113991186      
127.0.0.5       Down   Normal  52.49 KB        64377498999076014343862177049497951437      
127.0.0.2       Up     Normal  65.27 KB        84713069031498515281943177906254878023      
127.0.0.4       Up     Normal  55.95 KB        105444142448428656124184491892431731479
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The code looks like this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; Cassandra.Client client = fcw.getClient();
    Map&amp;lt;String,List&amp;lt;String&amp;gt;&amp;gt; sv =client.describe_schema_versions();
    for (Map.Entry&amp;lt;String,List&amp;lt;String&amp;gt;&amp;gt; mapEntry: sv.entrySet()){
      System.out.println(&quot;key:&quot;+mapEntry.getKey());
      for (String listForKey : mapEntry.getValue()){
        System.out.println(&quot;\t&quot;+listForKey);
      }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12478609">CASSANDRA-1678</key>
            <summary>describe_schema_versions does not list downed hosts</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gdusbabek">Gary Dusbabek</assignee>
                                    <reporter username="appodictic">Edward Capriolo</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Oct 2010 18:15:02 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:14 +0000</updated>
                            <resolved>Tue, 2 Nov 2010 14:05:53 +0000</resolved>
                                        <fixVersion>0.7.0 rc 1</fixVersion>
                                    <component>Legacy/CQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12925904" author="jbellis" created="Thu, 28 Oct 2010 18:30:14 +0000"  >&lt;p&gt;Odd, I see the code trying to add the missing hosts in describeSchemaVersions:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            results.put(DatabaseDescriptor.INITIAL_VERSION.toString(), missingHostNames);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But IMO the right fix is to avoid that entirely and do the simple thing instead:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  /**
   * &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; each schema version present in the cluster, returns a list of nodes at that version.
   * hosts that &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not respond will not be included.
   * the cluster is all on the same version &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the size of the map is 1 and the
   * length of the list	in that map value is the number of nodes in the cluster.
   */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12926174" author="appodictic" created="Fri, 29 Oct 2010 04:53:21 +0000"  >&lt;p&gt;Yes changing the description would &quot;Fix&quot; the problem. At minimum the description should match what the method actually does. I imagine this is used by applications that want to ensure the schema is in place before doing writes. Ignoring downed hosts could be misleading, as users would have to ensure the list size matches the size it should be. You could view that as a separate problem but I think users would want both in one method.&lt;/p&gt;</comment>
                            <comment id="12926412" author="gdusbabek" created="Fri, 29 Oct 2010 19:16:37 +0000"  >&lt;p&gt;the &apos;missing hosts&apos; Jonathan referred to were the live hosts that did not respond to the version query.  There could be other missing hosts that getLiveMembers() didn&apos;t return because they were down.&lt;/p&gt;

&lt;p&gt;Would it suit everybody if we included the unreachable members at version=DD.INITIAL_VERSION?&lt;/p&gt;</comment>
                            <comment id="12926419" author="jbellis" created="Fri, 29 Oct 2010 19:28:01 +0000"  >&lt;p&gt;wfm, although not having a distinction between &quot;responded that he was at INITIAL_VERSION&quot; and &quot;didn&apos;t respond&quot; feels a little unsavory.&lt;/p&gt;</comment>
                            <comment id="12926423" author="gdusbabek" created="Fri, 29 Oct 2010 19:33:55 +0000"  >&lt;p&gt;Since they&apos;re just strings I could just give them the value &quot;UNREACHABLE&quot;?&lt;/p&gt;</comment>
                            <comment id="12926427" author="jbellis" created="Fri, 29 Oct 2010 19:41:44 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12926437" author="appodictic" created="Fri, 29 Oct 2010 20:01:19 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12926464" author="jbellis" created="Fri, 29 Oct 2010 21:31:27 +0000"  >&lt;p&gt;seems to me it would be simpler to just loop through all hosts after versions are received; if host is not in ackedhosts then add it to the unreachable set.  this avoids problems caused by FD moving a node from live to dead or vice versa between requests being sent and processed.&lt;/p&gt;</comment>
                            <comment id="12927209" author="jbellis" created="Mon, 1 Nov 2010 22:57:06 +0000"  >&lt;p&gt;minor point: allHosts can be replaced with Iterables.concat(live, unreachable)&lt;/p&gt;

&lt;p&gt;is the &quot;check for version disagreement&quot; loop still useful now?&lt;/p&gt;</comment>
                            <comment id="12927396" author="gdusbabek" created="Tue, 2 Nov 2010 13:17:29 +0000"  >&lt;p&gt;The check is still useful for logging the disagreeing hosts.  When the feature was first created I seem to recall someone wanting it to be logged (didn&apos;t make sense to me).&lt;/p&gt;

&lt;p&gt;v4 uses the Iterables call.&lt;/p&gt;</comment>
                            <comment id="12927412" author="jbellis" created="Tue, 2 Nov 2010 14:00:35 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12927838" author="hudson" created="Wed, 3 Nov 2010 12:49:55 +0000"  >&lt;p&gt;Integrated in Cassandra #585 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra/585/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra/585/&lt;/a&gt;)&lt;br/&gt;
    include dead hosts in unreachable. patch by gdusbabek, reviewed by jbellis. &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1678&quot; title=&quot;describe_schema_versions does not list downed hosts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1678&quot;&gt;&lt;del&gt;CASSANDRA-1678&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12458631" name="ASF.LICENSE.NOT.GRANTED--v4-0001-include-dead-hosts-in-unreachable.txt" size="5364" author="gdusbabek" created="Tue, 2 Nov 2010 13:15:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[gdusbabek]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>699</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 3 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g6pr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>92518</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>