<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:25:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-17668] Fix leak of non-standard Java types in our Exceptions as clients using JMX are unable to handle them</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-17668</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;This is a continuation of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17638&quot; title=&quot;Clients using JMX are unable to handle non-standard java types but we leak this into our Exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17638&quot;&gt;&lt;del&gt;CASSANDRA-17638&lt;/del&gt;&lt;/a&gt; where we fixed leaks introduced during development of 4.1 to ensure no regressions.&lt;/p&gt;

&lt;p&gt;This ticket is to fix a few leakages which are there since previous major versions, not 4.1 regressions.&#160;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;setRepairSessionMaxTreeDepth&lt;/em&gt;(exists since 3.0) and&#160;&lt;em&gt;setRepairSessionSpaceInMegabytes(since 4.0)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&#160;in the DatabaseDescriptor.&#160;&lt;/p&gt;

&lt;p&gt;checkValidForByteConversion and&#160;&lt;em&gt;validateMaxConcurrentAutoUpgradeTasksConf (both since 4.0)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&#160;are used in both setters and on startup. They shouldn&apos;t throw ConfigurationException in the setters.&#160;&lt;/p&gt;

&lt;p&gt;There might be more but those are at least a few obvious I found in the DatabaseDescriptor.&lt;/p&gt;

&lt;p&gt;CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13447269">CASSANDRA-17668</key>
            <summary>Fix leak of non-standard Java types in our Exceptions as clients using JMX are unable to handle them</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lmtrombone">Leonard Ma</assignee>
                                    <reporter username="edimitrova">Ekaterina Dimitrova</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 May 2022 18:30:11 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:53 +0000</updated>
                            <resolved>Mon, 26 Sep 2022 15:43:51 +0000</resolved>
                                        <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Legacy/Observability</component>
                    <component>Observability/JMX</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="10800">3h</timespent>
                                <comments>
                            <comment id="17579456" author="JIRAUSER292010" created="Sun, 14 Aug 2022 22:32:01 +0000"  >&lt;p&gt;I believe I have a fix for this now - &#160;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1788&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1788&lt;/a&gt; .&#160;&lt;/p&gt;

&lt;p&gt;Some notes/observations:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&apos;&lt;em&gt;validateMaxConcurrentAutoUpgradeTasksConf&lt;/em&gt;&#160;&apos; has been left alone as we have some try catch logic for one of the functions that calls this and &apos;ConfigurationExceptions&apos; will get converted to &apos;IllegalArgumentException&apos;&lt;/li&gt;
	&lt;li&gt;&apos;checkValidForByteConversion&apos; seems to be used in tandem with the constructor &apos;DataStorageSpec.IntKibibytesBound&apos; for the jmx setters
	&lt;ul&gt;
		&lt;li&gt;&apos;StorageService.setColumnIndexSize&apos; (added in 4.1)&lt;/li&gt;
		&lt;li&gt;&apos;StorageService.setColumnIndexCacheSize&apos; (added in 4.0)&lt;/li&gt;
		&lt;li&gt;&apos;StorageService.setBatchSizeWarnThreshold&apos; (added in 4.0)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;There were some recent changes to this constructor ( &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17571&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-17571&lt;/a&gt; ) in 4.1 that will cause the aforementioned jmx setters to throw &apos;IllegalArgumentException&apos; when certain values are encountered.&#160; I was tempted to just modify &apos;checkValidForByteConversion&apos; so it throws &apos;IllegalArgumentException&apos; as this will make my solution much simpler/cleaner and because it already throws it elsewhere.&#160; However, for now I have opted to create new methods as from my understanding, modifying the exceptions thrown is still a breaking change to two of the APIs that have been released in 4.0.&lt;/p&gt;</comment>
                            <comment id="17580861" author="edimitrova" created="Wed, 17 Aug 2022 16:08:57 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lmtrombone&quot; class=&quot;user-hover&quot; rel=&quot;lmtrombone&quot;&gt;lmtrombone&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thank you for the patch and the extensive explanation!&lt;/p&gt;

&lt;p&gt;Overall it looks good on a quick skim, I left some tiny suggestions. Just to confirm, did you have the chance to verify whether there are other setters/getters in the DatabaseDescriptor that can suffer from this problem, out of the list/examples suggested on the ticket?&#160;&lt;br/&gt;
Also, I would like to suggest to add some basic unit tests to DatabaseDescriptorTest class?&#160;&lt;br/&gt;
Also, I think we need patches for previous versions and we normally merge them from lower affected version upwards to trunk - for more info &lt;a href=&quot;https://cassandra.apache.org/_/development/patches.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cassandra.apache.org/_/development/patches.html&lt;/a&gt; (Bug Fixes section). There might be also the case we need different patches for the different versions as things diverged between them. I can run a full CI for you when we get things into shape.&lt;br/&gt;
One more thing is to check whether our docs need some relevant update, at minimum we need to update the Deprecation section in NEWS.txt. Thank you for your work!&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&#160;I was tempted to just modify &apos;checkValidForByteConversion&apos; so it throws &apos;IllegalArgumentException&apos; as this will make my solution much simpler/cleaner and because it already throws it elsewhere.&#160; However, for now I have opted to create new methods as from my understanding, modifying the exceptions thrown is still a breaking change to two of the APIs that have been released in 4.0.&#160;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The breaking change is one very valid point. Another one is that checkValidForByteConversion is also used on startup. We throw ConfigurationException on startup, JMX setters/getters should throw IllegalArgumentException though&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;, do you mind to be a second reviewer for this ticket as you were the one who initially raised the point and worked on fixing breaking changes?&lt;/p&gt;</comment>
                            <comment id="17581194" author="JIRAUSER292010" created="Thu, 18 Aug 2022 06:59:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; Thanks for your feedback! I have a few follow-up comments/questions:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Just to confirm, did you have the chance to verify whether there are other setters/getters in the DatabaseDescriptor that can suffer from this problem, out of the list/examples suggested on the ticket? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I did try to look for other other getter/setters that could have this problem when I initially worked on the ticket, but wasn&apos;t able to find others.  I&apos;ll give it another go tomorrow, now that I&apos;m a bit more familiar with this part of the code.  Is this the only place that has this problem and if not, do you want me to try to see if I can find other places too?&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Also, I would like to suggest to add some basic unit tests to DatabaseDescriptorTest class? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;In my pull request, I didn&apos;t touch the DatabaseDescriptor class at all and looking at the that file, I think any unit tests I add there might be out of place.  I think StorageServiceTest and ActiveRepairServiceTest seem like a better place for them?&lt;/p&gt;

&lt;p&gt;A recent thought is that with my changes, we now have different names for setters vs getters e.g. &apos;RepairSessionMaxTreeDepth&apos; for getting vs &apos;RepairSessionMaximumTreeDepth&apos; for setting.  Is this something that will still be acceptable?&lt;/p&gt;</comment>
                            <comment id="17581356" author="edimitrova" created="Thu, 18 Aug 2022 13:20:12 +0000"  >&lt;blockquote&gt;&lt;p&gt;Is this the only place that has this problem and if not, do you want me to try to see if I can find other places too?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I would say this will be enough for the scope of this ticket but if you are curious to play around more with the code, I wouldn&apos;t discourage you. I will leave it to you to decide how much time you want to invest in this task. We can also spin follow up tickets.&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;In my pull request, I didn&apos;t touch the DatabaseDescriptor class at all and looking at the that file, I think any unit tests I add there might be out of place. I think StorageServiceTest and ActiveRepairServiceTest seem like a better place for them?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Correct, I wanted to say similar to what some of the tests in the DatabaseDescriptorTest but I messed up.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;A recent thought is that with my changes, we now have different names for setters vs getters e.g. &apos;RepairSessionMaxTreeDepth&apos; for getting vs &apos;RepairSessionMaximumTreeDepth&apos; for setting. Is this something that will still be acceptable?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Another good point. Yes, for consistency the practice is to deprecate the old pair getter/setter and create both new ones. Thanks&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17585170" author="JIRAUSER292010" created="Fri, 26 Aug 2022 06:21:29 +0000"  >&lt;p&gt;I checked all the other methods in DatabaseDescriptor and their usages and I didn&apos;t find any others. I have updated the original pull request ( &lt;a href=&quot;https://github.com/apache/cassandra/pull/1788&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1788&lt;/a&gt; ) and incorporated the feedback given.&lt;/p&gt;

&lt;p&gt;Here are the pull requests for the other versions:&lt;br/&gt;
3.0 - &lt;a href=&quot;https://github.com/apache/cassandra/pull/1817&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1817&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;3.11 - &lt;a href=&quot;https://github.com/apache/cassandra/pull/1818&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1818&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4.0 - &lt;a href=&quot;https://github.com/apache/cassandra/pull/1819&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1819&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4.1 - &lt;a href=&quot;https://github.com/apache/cassandra/pull/1825&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1825&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; Could you give the pull requests a look when you get the chance?&lt;/p&gt;</comment>
                            <comment id="17597277" author="edimitrova" created="Mon, 29 Aug 2022 16:18:46 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lmtrombone&quot; class=&quot;user-hover&quot; rel=&quot;lmtrombone&quot;&gt;lmtrombone&lt;/a&gt;&#160;! I just wanted to push your branches to CI but I noticed they are not rebased since quite some time. Also, the 4.1 patch is not propagated to trunk.&lt;/p&gt;

&lt;p&gt;Can you, please, do it? Thanks in advance&lt;/p&gt;</comment>
                            <comment id="17597319" author="dcapwell" created="Mon, 29 Aug 2022 17:24:37 +0000"  >&lt;p&gt;The patch asks users to &quot;migrate&quot; to a new method that does the same thing but fixes the bug... rather than asking users to migrate we should just fix the bug... can we just catch ConfigurationException and throw the new exception without changing the methods?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The breaking change is one very valid point.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The examples found do not document this behavior, so we are not changing the documented APIs but instead fixing a bug in JMX.  There may be some users that talk to JMX and can handle the ConfigurationException and check for it, so they would no longer catch what they expect, but that was also an internal detail that they are depending on...  The only cases I remember where we asked users to migrate to the new methods were when the methods actually documented this behavior...&lt;/p&gt;</comment>
                            <comment id="17597333" author="edimitrova" created="Mon, 29 Aug 2022 18:06:50 +0000"  >&lt;p&gt;I am pretty sure we said we shouldn&#8217;t break users in long ago released versions for those exceptions. Also, whoever doesn&#8217;t want to migrate will keep on using the old ones. &#160;But also people will be using tools that were broken before. There is choice.&lt;/p&gt;

&lt;p&gt;Yes, it is not documented in the API but if it breaks someone&#8217;s tools in a patch release and we know it It is not nice to break them if it was there for years.&#160;&lt;br/&gt;
Another suggestion is to keep the deprecation in old branches and only fix in 4.1/trunk? &#160;WDYT? That I would accept after being well documented&lt;/p&gt;</comment>
                            <comment id="17597336" author="dcapwell" created="Mon, 29 Aug 2022 18:16:18 +0000"  >&lt;blockquote&gt;&lt;p&gt;Yes, it is not documented in the API but if it breaks someone&#8217;s tools in a patch release and we know it It is not nice to break them if it was there for years. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Another suggestion is to keep the deprecation in old branches and only fix in 4.1/trunk?  WDYT? That I would accept after being well documented&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Older branches are for critical bug fixes, so I feel that we should leave them be for now (and not mark @Deprecated there), I can be more neutral to adding to trunk but not sure I even agree with 4.1....  &lt;/p&gt;

&lt;p&gt;If we limit the patch to only trunk, I am +0 to the idea...  not a fan but get the point about breaking anyone who used the undocumented behavior...&lt;/p&gt;</comment>
                            <comment id="17597338" author="edimitrova" created="Mon, 29 Aug 2022 18:28:29 +0000"  >&lt;p&gt;If it is only trunk &#160;probably it is fine to just fix it there. But I know we didn&#8217;t fix those before as we wanted to fix them in the older versions too. So I am a bit confused now, but I also understand your point&#8230; I wanted to go for the deprecation because of the old versions&lt;/p&gt;</comment>
                            <comment id="17598109" author="dcapwell" created="Tue, 30 Aug 2022 23:12:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;If it is only trunk  probably it is fine to just fix it there&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If the concern is backwards compatibility then the arguments don&apos;t go away because its trunk... I am cool fixing or adding new and marking old as Deprecated; will leave it up to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lmtrombone&quot; class=&quot;user-hover&quot; rel=&quot;lmtrombone&quot;&gt;lmtrombone&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I wanted to go for the deprecation because of the old versions&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Well, I guess I would ask &quot;when do we want to remove them?&quot;  To me trunk is currently 4.2 so earliest we could drop is 5.0 (or was it 6.0? Forget exactly what we agreed in terms of minor and Deprecated)... back porting to add the Deprecated doesn&apos;t change that...&lt;/p&gt;</comment>
                            <comment id="17598169" author="JIRAUSER292010" created="Wed, 31 Aug 2022 04:53:22 +0000"  >&lt;p&gt;I don&apos;t really have a preference and am okay with whatever we decide&#160;&lt;/p&gt;</comment>
                            <comment id="17599573" author="edimitrova" created="Fri, 2 Sep 2022 15:44:23 +0000"  >&lt;p&gt;It seems the decision will be on me, then trunk with deprecation and be nice to our end users.&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Well, I guess I would ask &quot;when do we want to remove them?&quot; To me trunk is currently 4.2 so earliest we could drop is 5.0 (or was it 6.0? Forget exactly what we agreed in terms of minor and Deprecated)... back porting to add the Deprecated doesn&apos;t change that...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Very good question that I also struggle with sometimes... In general we would say deprecate, keep in 5, remove in 6. Although, I see people keep on deprecating and when it comes to just method or config parameter it seems they prefer to keep it without deadline. So I am not sure. I guess in this case it will depend until when we keep JMX around too. I guess that will be the main guideline in this case.&#160;&lt;/p&gt;</comment>
                            <comment id="17599600" author="dcapwell" created="Fri, 2 Sep 2022 16:20:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;then trunk with deprecation &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Works for me.&lt;/p&gt;</comment>
                            <comment id="17599602" author="dcapwell" created="Fri, 2 Sep 2022 16:26:00 +0000"  >&lt;p&gt;Overall I am +1 to &lt;a href=&quot;https://github.com/apache/cassandra/pull/1788&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1788&lt;/a&gt; if we add comments explaining why we have 2 methods with identical bodies... &lt;/p&gt;</comment>
                            <comment id="17599757" author="JIRAUSER292010" created="Sat, 3 Sep 2022 01:36:13 +0000"  >&lt;p&gt;Ok, sounds good to me.&#160; I closed the pull requests for the other branches, rebased the trunk MR, and added comments to the getters with duplicate bodies.&lt;/p&gt;</comment>
                            <comment id="17601059" author="dcapwell" created="Tue, 6 Sep 2022 23:52:37 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17601369" author="edimitrova" created="Wed, 7 Sep 2022 15:49:10 +0000"  >&lt;p&gt;Thanks, I just pushed it rebased with the last 6 commits from trunk into Jenkins. (a few days passed, sorry about that)&lt;/p&gt;

&lt;p&gt;There is a limit on number of Jenkins dev runs in parallel which is currently reached so it will take time to start but it should be #1913 &lt;a href=&quot;https://jenkins-cm4.apache.org/view/patches/job/Cassandra-devbranch/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17601874" author="edimitrova" created="Thu, 8 Sep 2022 15:02:57 +0000"  >&lt;p&gt;It started but it is still running... seems like Jenkins is very busy these days. Will check back again later&lt;/p&gt;</comment>
                            <comment id="17601942" author="JIRAUSER292010" created="Thu, 8 Sep 2022 17:43:09 +0000"  >&lt;p&gt;No worries, that&apos;s fine with me.&#160; &#160;I&apos;ll try periodically checking it too for when it completes&lt;/p&gt;</comment>
                            <comment id="17602161" author="JIRAUSER292010" created="Fri, 9 Sep 2022 07:10:11 +0000"  >&lt;p&gt;Looks like the run finally completed and there are some failures.&#160; A few of them are the intermittent failures that have been actively discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17461&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-17461&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&#160; &#160;For the remaining failures though, from what I can tell from a glance, there are only one or two tests that are potentially related to the changes made in this ticket.&#160; I&apos;ll try to take a closer look tomorrow to try to confirm if this is the case.&lt;/p&gt;</comment>
                            <comment id="17602571" author="edimitrova" created="Fri, 9 Sep 2022 22:28:07 +0000"  >&lt;p&gt;Great! Let me know if you have any questions. Also, not sure whether you know about &lt;a href=&quot;https://butler.cassandra.apache.org/#/ci/upstream/compare/Cassandra-trunk/trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Butler&lt;/a&gt;, you can consult it together with Jira(in case there was already a ticket opened but not linked in Butler yet). It shows a history of the latest test failures per branch(I shared the link for trunk) and you can click on the links to check the actual error in Jira for the respective run.&lt;/p&gt;</comment>
                            <comment id="17603904" author="JIRAUSER292010" created="Wed, 14 Sep 2022 06:38:05 +0000"  >&lt;p&gt;As far as I can tell, I still think the failures are unassociated with my changes.&#160; Here&apos;s what I found on the failures though:&lt;/p&gt;

&lt;p&gt;The following tests has ticket associated with them&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&#160;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&#160;&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest.configuration_test.TestConfiguration.test_change_durable_writes&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;https://issues.apache.org/jira/browse/CASSANDRA-17872&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.net.ConnectionTest.testMessageDeliveryOnReconnect-compression&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;https://issues.apache.org/jira/browse/CASSANDRA-16677&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.distributed.test.CASTest.testSucccessfulWriteDuringRangeMovementFollowedByRead&lt;br/&gt;
org.apache.cassandra.distributed.test.CASTest.testSuccessfulWriteBeforeRangeMovement&lt;br/&gt;
org.apache.cassandra.distributed.test.CASTest.testConflictingWritesWithStaleRingInformation&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;https://issues.apache.org/jira/browse/CASSANDRA-17461&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&#160;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The following failures don&apos;t have tickets associated with them, but has been marked flaky one way or another&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&#160;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&#160;&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest.materialized_views_test.TestMaterializedViews.test_no_base_column_in_view_pk_complex_timestamp_with_flush&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Consistently passing on Cassandra CI and locally too, but apparently has a flaky annotation added some time ago&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.net.ProxyHandlerConnectionsTest.testExpireSome-cdc&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Has &apos;Flaky&apos; tag on Butler and has history of flakiness&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&#160;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The following failures don&apos;t have any markings on them, but in the test results, it seems we might be running some of the tests twice?&#160; Not sure if this is a sign of flakiness, since it&apos;s a sample size of 2.&#160; I was not able find anything wrong from running them repeatedly locally either:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;org.apache.cassandra.distributed.test.metrics.StreamingMetricsTest.testMetricsWithRepairAndStreamingToTwoNodes&lt;/li&gt;
	&lt;li&gt;org.apache.cassandra.distributed.test.UnableToParseClientMessageTest.badHeader&lt;span class=&quot;error&quot;&gt;&amp;#91;version=3/v3&amp;#93;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;org.apache.cassandra.distributed.test.repair.ForceRepairTest.forceWithDifference&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13049269/13049269_Screen+Shot+2022-09-13+at+11.27.30+PM.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;BinAuditLoggerTest.testSelectRoundTripQuery-compression - no idea at all.&#160; It does seem to pass consistently locally too.&lt;/p&gt;</comment>
                            <comment id="17608916" author="edimitrova" created="Fri, 23 Sep 2022 22:04:36 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lmtrombone&quot; class=&quot;user-hover&quot; rel=&quot;lmtrombone&quot;&gt;lmtrombone&lt;/a&gt;&#160;,&lt;/p&gt;

&lt;p&gt;I agree with your analysis plus I am adding the following to confirm your patch has nothing to do with the failures we saw:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://jenkins-cm4.apache.org/view/patches/job/Cassandra-devbranch/1913/testReport/junit/dtest.materialized_views_test/TestMaterializedViews/test_no_base_column_in_view_pk_complex_timestamp_with_flush/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;test_no_base_column_in_view_pk_complex_timestamp_with_flush&lt;/a&gt;&#160;- I fixed this one already in another ticket&lt;/li&gt;
	&lt;li&gt;testMetricsWithRepairAndStreamingToTwoNodes &#8211; seen in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17608&quot; title=&quot;Fix testMetricsWithRebuildAndStreamingToTwoNodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17608&quot;&gt;CASSANDRA-17608&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;badHeader -&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17488&quot; title=&quot;Intermittent failure on org.apache.cassandra.distributed.test.UnableToParseClientMessageTest.badHeader&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17488&quot;&gt;CASSANDRA-17488&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;forceWitDifference - seen in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17566&quot; title=&quot;Fix flaky test - org.apache.cassandra.distributed.test.repair.ForceRepairTest.force&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17566&quot;&gt;&lt;del&gt;CASSANDRA-17566&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;As it&apos;s been some time since we ran that CI, I just did a &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-17668&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;rebase&lt;/a&gt; and started final &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=CASSANDRA-17668&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI run&lt;/a&gt;. I will check that one later and commit, overall I do not expect surprises.&lt;/p&gt;</comment>
                            <comment id="17609077" author="JIRAUSER292010" created="Sun, 25 Sep 2022 03:56:24 +0000"  >&lt;p&gt;Sounds good to me. &#160;Thanks&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;&#160;!&lt;/p&gt;</comment>
                            <comment id="17609551" author="edimitrova" created="Mon, 26 Sep 2022 15:42:46 +0000"  >&lt;p&gt;Committed to trunk:&lt;/p&gt;

&lt;p&gt;To &lt;a href=&quot;https://github.com/apache/cassandra.git&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra.git&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&#160; 7adfdc85cf..e5c9cf4cbe&#160; trunk -&amp;gt; trunk&lt;/p&gt;

&lt;p&gt;The only issues seen were known:&lt;/p&gt;

&lt;p&gt;test_move_backwards_and_cleanup - &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16061&quot; title=&quot;Test failure: transient_replication_ring_test.py::TestTransientReplicationRing::test_move_forwards_and_cleanup&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16061&quot;&gt;&lt;del&gt;CASSANDRA-16061&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;test_multiple_repair - &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17005&quot; title=&quot;Fix test dtest.repair_tests.incremental_repair_test.TestIncRepair.test_multiple_repair&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17005&quot;&gt;&lt;del&gt;CASSANDRA-17005&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also, for the record - I didn&apos;t run in the multiplexer the unit tests because they cannot be more deterministic than that. Saved some resources here.&#160;&lt;/p&gt;

&lt;p&gt;Thank you for your work &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lmtrombone&quot; class=&quot;user-hover&quot; rel=&quot;lmtrombone&quot;&gt;lmtrombone&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13445705">CASSANDRA-17638</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13049269" name="Screen Shot 2022-09-13 at 11.27.30 PM.png" size="98541" author="lmtrombone" created="Wed, 14 Sep 2022 06:30:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[lmtrombone]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 7 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z12r9k:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[dcapwell]]></customfieldvalue>
        <customfieldvalue><![CDATA[e.dimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/e5c9cf4cbe6634ba9e148b6e27b6bad98648e597&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/e5c9cf4cbe6634ba9e148b6e27b6bad98648e597&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Test using JConsole and added new unit tests&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>