<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:39:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5454] Changing column_index_size_in_kb on different nodes might corrupt files</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5454</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;RangeTombstones requires that we sometimes repeat a few markers in the data file at index boundaries. Meaning that the same row with different column_index_size_in_kb will not have the same data size.&lt;/p&gt;

&lt;p&gt;This is a problem for streaming, because if the column_index_size_in_kb is different in the source and the destination, the resulting row should have a different size on the destination, but streaming rely on the data size not changing in 1.2.&lt;/p&gt;

&lt;p&gt;Now, while having different column_index_size on different nodes is probably not extremely useful in the long run, you may still have temporal discrepancies because there is no real way to change the setting on all node atomically. Besides, it&apos;s not to hard to get different setting on different nodes due to human error. And currently, the result is that if a file is stream while the setting is not consistent, then we&apos;ll end up corrupting the received file (due to the fix from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5418&quot; title=&quot;streaming fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5418&quot;&gt;&lt;del&gt;CASSANDRA-5418&lt;/del&gt;&lt;/a&gt; to be precise).&lt;/p&gt;

&lt;p&gt;I don&apos;t see a good way to fix this in 1.2, so users will have to be careful not to have streaming happening while they change the column_index_size_in_kb setting. But in 2.0, once &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4180&quot; title=&quot;Single-pass compaction for LCR&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4180&quot;&gt;&lt;del&gt;CASSANDRA-4180&lt;/del&gt;&lt;/a&gt; is committed, we won&apos;t have the problem of having to respect the dataSize from the source on the destination anymore. So basically we should revert the fix from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5418&quot; title=&quot;streaming fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5418&quot;&gt;&lt;del&gt;CASSANDRA-5418&lt;/del&gt;&lt;/a&gt; (though we may still want to avoid repeating unneeded marker, but the tombstoneTracker can give us that easily).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12642024">CASSANDRA-5454</key>
            <summary>Changing column_index_size_in_kb on different nodes might corrupt files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="slebresne">Sylvain Lebresne</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Apr 2013 12:29:35 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:14 +0000</updated>
                            <resolved>Mon, 1 Jul 2013 07:41:58 +0000</resolved>
                                        <fixVersion>1.2.7</fixVersion>
                    <fixVersion>2.0 beta 1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13694755" author="slebresne" created="Thu, 27 Jun 2013 14:28:30 +0000"  >&lt;p&gt;Attaching patch for this. As said above, this basically revert the changes from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5418&quot; title=&quot;streaming fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5418&quot;&gt;&lt;del&gt;CASSANDRA-5418&lt;/del&gt;&lt;/a&gt;, which is ok now that we don&apos;t write the row size or column count at the start of the row.&lt;/p&gt;

&lt;p&gt;I&apos;ve checked that the test added by Yukim for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5418&quot; title=&quot;streaming fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5418&quot;&gt;&lt;del&gt;CASSANDRA-5418&lt;/del&gt;&lt;/a&gt; does pass with this patch. &lt;/p&gt;</comment>
                            <comment id="13696056" author="jbellis" created="Sat, 29 Jun 2013 05:38:36 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13696633" author="slebresne" created="Mon, 1 Jul 2013 07:41:58 +0000"  >&lt;p&gt;Committed, thanks&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12551799">CASSANDRA-4180</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12589912" name="5454.txt" size="3783" author="slebresne" created="Thu, 27 Jun 2013 14:28:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322438</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 21 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jmrj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322783</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324301">1.2.5</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>