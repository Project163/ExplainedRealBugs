<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:31:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-20312] Long running repairs autofail prematurely</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-20312</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Repairs will autofail after a long period of inactivity but very long-running repairs may be incorrectly auto failed. Capture status pings as liveness info.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13607965">CASSANDRA-20312</key>
            <summary>Long running repairs autofail prematurely</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bereng">Berenguer Blasi</assignee>
                                    <reporter username="bereng">Berenguer Blasi</reporter>
                        <labels>
                    </labels>
                <created>Mon, 10 Feb 2025 08:29:38 +0000</created>
                <updated>Fri, 30 May 2025 08:09:24 +0000</updated>
                            <resolved>Wed, 12 Feb 2025 10:19:54 +0000</resolved>
                                        <fixVersion>4.0.18</fixVersion>
                    <fixVersion>4.1.9</fixVersion>
                    <fixVersion>5.0.4</fixVersion>
                    <fixVersion>5.1</fixVersion>
                                    <component>Consistency/Repair</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17925564" author="bereng" created="Mon, 10 Feb 2025 12:24:58 +0000"  >&lt;p&gt;Submitting the 4.0 PR to validate the approach. The rest of the PRs will come when we&apos;re happy with it.&lt;/p&gt;</comment>
                            <comment id="17925581" author="bereng" created="Mon, 10 Feb 2025 13:53:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt; you&apos;re familiar with this area. It&apos;s probably a quick review for you.&lt;/p&gt;</comment>
                            <comment id="17925602" author="michaelsembwever" created="Mon, 10 Feb 2025 15:04:56 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;As said, the update timestamp is only updated from state changes, so we&#8217;re only checking the amount of time since repair phase starts. The fix changes this to the amount of time since &lt;em&gt;any&lt;/em&gt; activity.  This has been confirmed with one user in production to fix the situation of repairs (consistently) prematurely timing out.&lt;/p&gt;</comment>
                            <comment id="17926023" author="JIRAUSER285406" created="Tue, 11 Feb 2025 14:49:11 +0000"  >&lt;p&gt;+1 (nb)&lt;/p&gt;</comment>
                            <comment id="17955061" author="jonmeredith" created="Thu, 29 May 2025 23:15:29 +0000"  >&lt;p&gt;This change is preventing incremental repairs that are not making any progress from being auto-failed as every hour `org.apache.cassandra.repair.consistent.LocalSessions#cleanup()` triggers sending a status check to all participants, which resets that last updated time causing the `repair_fail_timeout` (default 24 hours) to never expire, leaving sessions around that conflict with new incremental repairs.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt; you mentioned &quot;This has been confirmed with one user in production to fix the situation of repairs (consistently) prematurely timing out.&quot; Were they timing out before the 24 hour timer hit due to dropped messages? If so, did the user try configuring repair retries(&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18816&quot; title=&quot;Add support for repair coordinator to retry messages that timeout&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18816&quot;&gt;&lt;del&gt;CASSANDRA-18816&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;I think we should revert this change and look for another solution.&lt;/p&gt;</comment>
                            <comment id="17955127" author="bereng" created="Fri, 30 May 2025 07:26:57 +0000"  >&lt;p&gt;I don&apos;t have cycles right now apologies but I will look into this soon. If this is causing a major problem please feel free to revert as we can always add it back in or look for a different solution.&lt;/p&gt;</comment>
                            <comment id="17955139" author="michaelsembwever" created="Fri, 30 May 2025 08:00:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18816&quot; title=&quot;Add support for repair coordinator to retry messages that timeout&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18816&quot;&gt;&lt;del&gt;CASSANDRA-18816&lt;/del&gt;&lt;/a&gt; is available in 5.0, so we might have missed it, and if it addresses the issue would mean this issue still applies to 4.x&lt;/p&gt;</comment>
                            <comment id="17955141" author="michaelsembwever" created="Fri, 30 May 2025 08:09:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;This change is preventing incremental repairs that are not making any progress from being auto-failed as every hour `org.apache.cassandra.repair.consistent.LocalSessions#cleanup()` triggers sending a status check to all participants&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Can `cleanup()` only send the status check if there&apos;s been local activity any non FINALISED or FAILED state ? &lt;br/&gt;
(If one node has progressed its session in the 24 hour window, isn&apos;t that a valid cleanup status check message to propagate?)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bereng]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1u4jc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bernardo.botella]]></customfieldvalue>
        <customfieldvalue><![CDATA[mck]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12336842">4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/914046ae469a43ef0ec5940ac9fa6b0eda3707b2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/914046ae469a43ef0ec5940ac9fa6b0eda3707b2&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;See PR&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>