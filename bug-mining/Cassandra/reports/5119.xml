<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:12:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-14910] Don&apos;t skip entire sstables when reading backwards with mixed clustering column order</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-14910</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In 2.x, if a table has clustering columns in &lt;tt&gt;DESC&lt;/tt&gt; order, any SSTable that doesn&#8217;t have any static rows in it will be skipped altogether when iterated in reverse.&lt;/p&gt;

&lt;p&gt;This occurs due to the logic in &lt;tt&gt;ColumnSlice.compare()&lt;/tt&gt; errorneusly sorting any empty &lt;tt&gt;ByteBuffer&lt;/tt&gt; after non-empty values due to the way &lt;tt&gt;ReversedType&lt;/tt&gt; operates. In case that empty &lt;tt&gt;ByteBuffer&lt;/tt&gt; is coming from a static &lt;tt&gt;Composite&lt;/tt&gt;, however, the logic breaks down. Static &lt;tt&gt;Composite&lt;/tt&gt; components must &lt;b&gt;always&lt;/b&gt; sort before any non-empty value, no matter the table&#8217;s comparator.&lt;/p&gt;

&lt;p&gt;2.0, 2.1, and 2.2 are all affected. 3.0 isn&#8217;t, but only because we skip slice intersection logic entirely if static rows are present in the filter.&lt;/p&gt;

&lt;p&gt;Introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8502&quot; title=&quot;Static columns returning null for pages after first&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8502&quot;&gt;&lt;del&gt;CASSANDRA-8502&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13200244">CASSANDRA-14910</key>
            <summary>Don&apos;t skip entire sstables when reading backwards with mixed clustering column order</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aleksey">Aleksey Yeschenko</assignee>
                                    <reporter username="aleksey">Aleksey Yeschenko</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Nov 2018 12:54:34 +0000</created>
                <updated>Tue, 16 Apr 2019 09:29:43 +0000</updated>
                            <resolved>Mon, 10 Dec 2018 18:28:44 +0000</resolved>
                                        <fixVersion>2.2.14</fixVersion>
                                    <component>Legacy/Local Write-Read Paths</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16697107" author="iamaleksey" created="Fri, 23 Nov 2018 13:00:25 +0000"  >&lt;p&gt;Code &lt;a href=&quot;https://github.com/iamaleksey/cassandra/commits/14910-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;, CI &lt;a href=&quot;https://circleci.com/workflow-run/0c915d7b-e94a-4c47-b604-9f938e659b28&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16699017" author="iamaleksey" created="Mon, 26 Nov 2018 14:23:48 +0000"  >&lt;p&gt;As spotted by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt; during review, fixing comparison logic with static slices exposes another breakage - specifically the scenario when a static row is present in the sstable. With reversed comparator, when trying to read just the static row, such sstables would now be skipped.&lt;/p&gt;

&lt;p&gt;Pushed the fix to the same branch.&lt;/p&gt;</comment>
                            <comment id="16700215" author="ifesdjeen" created="Tue, 27 Nov 2018 10:49:11 +0000"  >&lt;p&gt;The new version looks much better, the only thing is that current tests do not cover &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...iamaleksey:14910-2.2#diff-82e58a7c5bec8818f2e88a982725690fR113&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this&lt;/a&gt; part (e.g. &lt;tt&gt;compare&lt;/tt&gt; is now not called on static bounds since we&apos;re returning &lt;tt&gt;true&lt;/tt&gt; before calling &lt;tt&gt;intersect&lt;/tt&gt; which would invoke comparator), so while I&apos;m not saying that the change is wrong, I&apos;m not 100% sure if we should keep it unless we have a test or at least an example scenario where this one is required. Can you comment on where we need it?&lt;/p&gt;

&lt;p&gt;UPDATE: I&apos;ve ran some more tests and so far could only land into &lt;tt&gt;comparison != null&lt;/tt&gt; clause but couldn&apos;t do it with static bounds.&lt;/p&gt;</comment>
                            <comment id="16701035" author="iamaleksey" created="Tue, 27 Nov 2018 21:06:46 +0000"  >&lt;p&gt;Force-pushed an updated version that just avoids making any decisions regarding skipping sstables based on static slice bounds - start or end. Can&apos;t rely on them, can&apos;t trust them, they are as dodgy as our recording of min/max cell names if static rows are involved.&lt;/p&gt;</comment>
                            <comment id="16707607" author="ifesdjeen" created="Mon, 3 Dec 2018 18:08:59 +0000"  >&lt;p&gt;Thank you for the patch, &lt;/p&gt;

&lt;p&gt;Latest version looks good! +1&lt;/p&gt;</comment>
                            <comment id="16715312" author="iamaleksey" created="Mon, 10 Dec 2018 18:28:35 +0000"  >&lt;p&gt;Committed to 2.2 as &lt;a href=&quot;https://github.com/apache/cassandra/commit/afa4563864889c78569e29466047b411cd866b38&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;afa4563864889c78569e29466047b411cd866b38&lt;/a&gt; and merged (the unit tests) upwards. Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 49 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s00t28:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12341717">2.1.20</customfieldvalue>
    <customfieldvalue id="12342777">2.2.13</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12332369">2.0.16</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>