<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:31:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3883] CFIF WideRowIterator only returns batch size columns</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3883</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Most evident with the word count, where there are 1250 &apos;word1&apos; items in two rows (1000 in one, 250 in another) and it counts 198 with the batch size set to 99.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12541989">CASSANDRA-3883</key>
            <summary>CFIF WideRowIterator only returns batch size columns</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="brandon.williams">Brandon Williams</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Feb 2012 16:15:14 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:40 +0000</updated>
                            <resolved>Wed, 11 Apr 2012 18:28:36 +0000</resolved>
                                        <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13206502" author="brandon.williams" created="Sun, 12 Feb 2012 20:02:51 +0000"  >&lt;p&gt;At least one problem here is that after retrieving the first page of a row, we set the startToken to the token of the last row:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;startToken = partitioner.getTokenFactory().toString(partitioner.getToken(lastRow.key));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which is exclusive and thus advances to the next row, without completely paging through the first.&lt;/p&gt;</comment>
                            <comment id="13206888" author="brandon.williams" created="Mon, 13 Feb 2012 14:06:24 +0000"  >&lt;p&gt;My original description here is incorrect; I can&apos;t repro the 198 count (not sure what happened there) but now the wide row tests counts 1033 &apos;word1&apos; items.  As far as I can tell, WordCountSetup actually inserts a total of 2002 &apos;word1&apos; matches, one in each of text1 and text2, and a thousand in each of text3 and text4.  I&apos;m not sure what is causing the count discrepancy, but in any case 1033 is far above the batch size of 99, and and the 4th word count test using a secondary index is counting 197 items, so I think something may be fundamentally wrong with word count.&lt;/p&gt;

&lt;p&gt;That said, I&apos;ve been adding wide row support to pig and testing with that, and the problem of not being able to completely paginate wide rows is a definite problem.&lt;/p&gt;</comment>
                            <comment id="13206952" author="brandon.williams" created="Mon, 13 Feb 2012 16:02:23 +0000"  >&lt;p&gt;v1 isn&apos;t perfect but it&apos;s a start; if the batch starts on a wide row, we reuse the token and iterate until we&apos;re done.  Unfortunately if we don&apos;t start on one, I&apos;m not sure if there&apos;s a way to detect that we&apos;re in a wide row without making an extra rpc against the last row seen every time.&lt;/p&gt;</comment>
                            <comment id="13207055" author="jbellis" created="Mon, 13 Feb 2012 18:41:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;Unfortunately if we don&apos;t start on one, I&apos;m not sure if there&apos;s a way to detect that we&apos;re in a wide row without making an extra rpc against the last row seen every time.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If we can easily address this w/ some extra logic in get_paged_slice then great, otherwise doing one extra rpc call out of (split size * pages per row in split) doesn&apos;t seem like a big deal to me.&lt;/p&gt;</comment>
                            <comment id="13207843" author="brandon.williams" created="Tue, 14 Feb 2012 17:24:59 +0000"  >&lt;p&gt;There&apos;s no sane way to do this with get_paged_slice as it currently is.  We can do the extra rpc to determine if we&apos;re at the end of a row, but then we can end up in an ugly situation where there&apos;s only one or two more columns outside of the batch size, but when we slice those on the next iteration those are the only columns we can return because our slice predicate is invalid for anything else; even if we happen to get a full batch back.&lt;/p&gt;</comment>
                            <comment id="13224486" author="slebresne" created="Wed, 7 Mar 2012 16:35:46 +0000"  >&lt;p&gt;How would get_paged_slice need to be to make that sane, and is there any short term solution to get this fixed for 1.1.0?&lt;/p&gt;</comment>
                            <comment id="13224622" author="brandon.williams" created="Wed, 7 Mar 2012 19:25:20 +0000"  >&lt;p&gt;Optimally, we&apos;d have a way to express &quot;I&apos;m at this column offset in this row, give me the next X number of columns, even if it requires going to the next row.&quot;  But I&apos;m not sure how to do that sanely, either.  I know Jake is using a special CFIF for hive to handle wide rows that basically just grabs one row at a time and paginates it, which is fine if all the rows are wide, but will take a performance hit if they are not.  Still, that might be the best thing to do since using get_page_slices is currently so hairy.&lt;/p&gt;</comment>
                            <comment id="13249013" author="jbellis" created="Fri, 6 Apr 2012 22:40:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;Optimally, we&apos;d have a way to express &quot;I&apos;m at this column offset in this row, give me the next X number of columns, even if it requires going to the next row.&quot; But I&apos;m not sure how to do that sanely, either&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;What if we allowed mixing (start key, end token) in KeyRange?  Wouldn&apos;t that fix it?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;1st get_paged_slice call: ((start token, end token), empty start column) from slice&lt;/li&gt;
	&lt;li&gt;subsequent get_paged_slice calls: ((last row key, end token), last column name)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13249019" author="brandon.williams" created="Fri, 6 Apr 2012 22:47:00 +0000"  >&lt;p&gt;That sounds like it could work.&lt;/p&gt;</comment>
                            <comment id="13249993" author="jbellis" created="Mon, 9 Apr 2012 17:41:06 +0000"  >&lt;p&gt;v2 attached w/ that approach&lt;/p&gt;</comment>
                            <comment id="13250218" author="jbellis" created="Mon, 9 Apr 2012 21:59:03 +0000"  >&lt;p&gt;v3 to avoid double-counting the startColumn.  also cleans up lastRow cruftiness a bit.&lt;/p&gt;</comment>
                            <comment id="13251071" author="jbellis" created="Tue, 10 Apr 2012 21:16:44 +0000"  >&lt;p&gt;Latest is at &lt;a href=&quot;https://github.com/jbellis/cassandra/branches/3383-5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jbellis/cassandra/branches/3383-5&lt;/a&gt;. I think it&apos;s working now, except for being blocked by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4136&quot; title=&quot;get_paged_slices doesn&amp;#39;t reset startColumn after first row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4136&quot;&gt;&lt;del&gt;CASSANDRA-4136&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13251625" author="jbellis" created="Wed, 11 Apr 2012 14:29:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/jbellis/cassandra/branches/3883-6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jbellis/cassandra/branches/3883-6&lt;/a&gt; is up, with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4136&quot; title=&quot;get_paged_slices doesn&amp;#39;t reset startColumn after first row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4136&quot;&gt;&lt;del&gt;CASSANDRA-4136&lt;/del&gt;&lt;/a&gt; incorporated.  the results look good for the word_count test, as posted on 4136.&lt;/p&gt;

&lt;p&gt;(the other minor change with -6 is adding conf/ to the classpath for log4j.)&lt;/p&gt;</comment>
                            <comment id="13251703" author="brandon.williams" created="Wed, 11 Apr 2012 16:21:04 +0000"  >&lt;p&gt;LGTM, +1&lt;/p&gt;</comment>
                            <comment id="13251818" author="jbellis" created="Wed, 11 Apr 2012 18:28:36 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12542535">CASSANDRA-3909</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12514368" name="3883-v1.txt" size="4977" author="brandon.williams" created="Mon, 13 Feb 2012 16:02:23 +0000"/>
                            <attachment id="12521974" name="3883-v2.txt" size="5439" author="jbellis" created="Mon, 9 Apr 2012 17:41:06 +0000"/>
                            <attachment id="12522025" name="3883-v3.txt" size="11926" author="jbellis" created="Mon, 9 Apr 2012 21:59:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227276</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 32 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gpe7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95544</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>brandon.williams</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>