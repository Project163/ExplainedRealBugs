<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:06:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-12100] Compactions are stuck after TRUNCATE</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-12100</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;since the upgrade to C* 3.0.7 I see compaction tasks getting stuck when truncating the column family. I verified this on all nodes of the cluster.&lt;br/&gt;
Pending compactions seem to disappear after restarting the node.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;root@node10:~# nodetool -h localhost compactionstats
pending tasks: 6
                                     id   compaction type              keyspace                table   completed      total    unit   progress
   24e1ad30-3cac-11e6-870d-5de740693258        Compaction   		     schema		         table_1           0   57558382   bytes      0.00%
   2be2e3b0-3cac-11e6-870d-5de740693258        Compaction   		     schema		         table_2           0   65063705   bytes      0.00%
   54de38f0-3cac-11e6-870d-5de740693258        Compaction   		     schema		         table_3           0     187031   bytes      0.00%
   31926ce0-3cac-11e6-870d-5de740693258        Compaction   		     schema		         table_4           0   42951119   bytes      0.00%
   3911ad00-3cac-11e6-870d-5de740693258        Compaction   		     schema		         table_5           0   25918949   bytes      0.00%
   3e6a8ab0-3cac-11e6-870d-5de740693258        Compaction   		     schema		         table_6           0   65466210   bytes      0.00%
Active compaction remaining time :   0h00m15s
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12984297">CASSANDRA-12100</key>
            <summary>Compactions are stuck after TRUNCATE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="ostefano">Stefano Ortolani</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Jun 2016 08:46:27 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:28 +0000</updated>
                            <resolved>Thu, 11 Aug 2016 01:16:16 +0000</resolved>
                                        <fixVersion>2.2.10</fixVersion>
                    <fixVersion>3.0.9</fixVersion>
                    <fixVersion>3.8</fixVersion>
                                    <component>Local/Compaction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="15352614" author="ostefano" created="Tue, 28 Jun 2016 08:51:39 +0000"  >&lt;p&gt;I see nothing weird in the logs but the following two things:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;system.log&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;INFO  [SharedPool-Worker-2] 2016-06-27 22:12:06,323 Message.java:605 - Unexpected exception during request; channel = [id: 0x6f0c2f56, /10.0.0.8:47592 :&amp;gt; /10.0.0.5:9042]
java.io.IOException: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; read(...): Connection reset by peer
	at io.netty.channel.epoll.Native.readAddress(Native Method) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollSocketChannel$EpollSocketUnsafe.doReadBytes(EpollSocketChannel.java:675) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollSocketChannel$EpollSocketUnsafe.epollInReady(EpollSocketChannel.java:714) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:326) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:264) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:137) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_91]
INFO  [CompactionExecutor:3] 2016-06-27 22:45:47,213 AutoSavingCache.java:386 - Saved CounterCache (1 items) in 169 ms
INFO  [CompactionExecutor:4] 2016-06-27 22:45:47,713 AutoSavingCache.java:386 - Saved KeyCache (15158 items) in 671 ms
INFO  [IndexSummaryManager:1] 2016-06-27 22:45:58,397 IndexSummaryRedistribution.java:74 - Redistributing index summaries
INFO  [IndexSummaryManager:1] 2016-06-27 23:45:58,440 IndexSummaryRedistribution.java:74 - Redistributing index summaries
INFO  [SharedPool-Worker-17] 2016-06-28 00:33:57,301 Message.java:605 - Unexpected exception during request; channel = [id: 0x52e03a04, /10.0.0.8:53218 :&amp;gt; /10.0.0.5:9042]
java.io.IOException: Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; read(...): Connection reset by peer
	at io.netty.channel.epoll.Native.readAddress(Native Method) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollSocketChannel$EpollSocketUnsafe.doReadBytes(EpollSocketChannel.java:675) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollSocketChannel$EpollSocketUnsafe.epollInReady(EpollSocketChannel.java:714) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:326) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:264) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:137) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_91]
INFO  [SharedPool-Worker-4] 2016-06-28 00:33:57,687 Message.java:605 - Unexpected exception during request; channel = [id: 0x21eeb0b8, /10.0.0.8:53251 :&amp;gt; /10.0.0.5:9042]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;debug.log&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;DEBUG [GossipStage:1] 2016-06-27 22:12:06,112 FailureDetector.java:456 - Ignoring interval time of 2713433121 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.0.0.7
INFO  [SharedPool-Worker-2] 2016-06-27 22:12:06,323 Message.java:605 - Unexpected exception during request; channel = [id: 0x6f0c2f56, /10.0.0.8:47592 :&amp;gt; /10.0.0.5:9042]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15352641" author="ostefano" created="Tue, 28 Jun 2016 09:08:36 +0000"  >&lt;p&gt;Another weird bit. &lt;br/&gt;
It seems that before restarting CFSTATS shows no SSTABLES associated to the CF.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;root@node13:~# nodetool -h localhost cfstats schema.table_5
Keyspace: schema
	Read Count: 9
	Read Latency: 0.06611111111111112 ms.
	Write Count: 293023
	Write Latency: 0.03773653603983305 ms.
	Pending Flushes: 0
		Table: table_5
		SSTable count: 0
		SSTables in each level: [0, 0, 0, 0, 0, 0, 0, 0, 0]
		Space used (live): 0
		Space used (total): 0
		Space used by snapshots (total): 28906766
		Off heap memory used (total): 0
		SSTable Compression Ratio: 0.0
		Number of keys (estimate): 1530
		Memtable cell count: 193038
		Memtable data size: 459060
		Memtable off heap memory used: 0
		Memtable switch count: 2
		Local read count: 9
		Local read latency: 0.073 ms
		Local write count: 293023
		Local write latency: 0.042 ms
		Pending flushes: 0
		Bloom filter false positives: 0
		Bloom filter false ratio: 0.00000
		Bloom filter space used: 0
		Bloom filter off heap memory used: 0
		Index summary off heap memory used: 0
		Compression metadata off heap memory used: 0
		Compacted partition minimum bytes: 0
		Compacted partition maximum bytes: 0
		Compacted partition mean bytes: 0
		Average live cells per slice (last five minutes): 1.1993243243243243
		Maximum live cells per slice (last five minutes): 60
		Average tombstones per slice (last five minutes): 1.0
		Maximum tombstones per slice (last five minutes): 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Afterwards the whole thing is a bit different:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;root@node13:~# nodetool -h localhost cfstats schema.table_5
Keyspace: schema
	Read Count: 0
	Read Latency: NaN ms.
	Write Count: 432
	Write Latency: 0.02398611111111111 ms.
	Pending Flushes: 0
		Table: table_5
		SSTable count: 1
		SSTables in each level: [1, 0, 0, 0, 0, 0, 0, 0, 0]
		Space used (live): 262893
		Space used (total): 262893
		Space used by snapshots (total): 28906766
		Off heap memory used (total): 1344
		SSTable Compression Ratio: 0.6389608871615797
		Number of keys (estimate): 1551
		Memtable cell count: 432
		Memtable data size: 4518
		Memtable off heap memory used: 0
		Memtable switch count: 0
		Local read count: 0
		Local read latency: NaN ms
		Local write count: 432
		Local write latency: 0.027 ms
		Pending flushes: 0
		Bloom filter false positives: 0
		Bloom filter false ratio: 0.00000
		Bloom filter space used: 968
		Bloom filter off heap memory used: 960
		Index summary off heap memory used: 336
		Compression metadata off heap memory used: 48
		Compacted partition minimum bytes: 30
		Compacted partition maximum bytes: 51012
		Compacted partition mean bytes: 242
		Average live cells per slice (last five minutes): NaN
		Maximum live cells per slice (last five minutes): 0
		Average tombstones per slice (last five minutes): NaN
		Maximum tombstones per slice (last five minutes): 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15355725" author="ostefano" created="Wed, 29 Jun 2016 19:38:18 +0000"  >&lt;p&gt;Had to TRUNCATE the tables again, and the bug re-appeared.&lt;br/&gt;
This time I took a thread dump (attached).&lt;/p&gt;</comment>
                            <comment id="15355799" author="ostefano" created="Wed, 29 Jun 2016 21:19:58 +0000"  >&lt;p&gt;Also, in the logs this time I can see the following.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;INFO  [CompactionExecutor:529] 2016-06-29 19:17:49,255 CompactionManager.java:1518 - Compaction interrupted: Compaction@685a9350-14a3-11e6-9af3-cdff32bdcb0d(schema, table_1, 0/97492039)bytes
INFO  [CompactionExecutor:529] 2016-06-29 19:17:51,050 CompactionManager.java:1518 - Compaction interrupted: Compaction@7d2f3790-14a3-11e6-9af3-cdff32bdcb0d(schema, table_2, 0/1871440)bytes
INFO  [CompactionExecutor:529] 2016-06-29 19:17:52,481 CompactionManager.java:1518 - Compaction interrupted: Compaction@e06f37a0-10bc-11e6-bb23-6776bf484396(schema, table_3, 0/2251297)bytes
INFO  [CompactionExecutor:530] 2016-06-29 19:17:53,547 CompactionManager.java:1518 - Compaction interrupted: Compaction@e1ede860-10bc-11e6-bb23-6776bf484396(schema, table_4, 0/1373193)bytes
INFO  [CompactionExecutor:530] 2016-06-29 19:17:54,586 CompactionManager.java:1518 - Compaction interrupted: Compaction@8d398280-14a3-11e6-9af3-cdff32bdcb0d(schema, table_5, 0/1646136)bytes
INFO  [CompactionExecutor:530] 2016-06-29 19:17:57,093 CompactionManager.java:1518 - Compaction interrupted: Compaction@432af280-29e0-11e6-80c2-e524daec2815(schema, table_6, 0/7144)bytes
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15355814" author="ostefano" created="Wed, 29 Jun 2016 21:25:26 +0000"  >&lt;p&gt;Also, on some nodes I can still see that exception (timestamp is exactly when I issues the TRUNCATE).&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;INFO  [SharedPool-Worker-1] 2016-06-29 18:38:54,102 Message.java:605 - Unexpected exception during request; channel = [id: 0x0722dbef, /10.12.81.8:59994 :&amp;gt; /10.12.33.4:9042]
java.io.IOException: Error while read(...): Connection reset by peer
	at io.netty.channel.epoll.Native.readAddress(Native Method) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollSocketChannel$EpollSocketUnsafe.doReadBytes(EpollSocketChannel.java:675) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollSocketChannel$EpollSocketUnsafe.epollInReady(EpollSocketChannel.java:714) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:326) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:264) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$2.run(SingleThreadEventExecutor.java:116) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:137) ~[netty-all-4.0.23.Final.jar:4.0.23.Final]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_91]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15356826" author="ostefano" created="Thu, 30 Jun 2016 09:37:33 +0000"  >&lt;p&gt;For what is worth, I can&apos;t replicate it locally (one node) but I can replicate it on the cluster in production.&lt;/p&gt;</comment>
                            <comment id="15357107" author="rha" created="Thu, 30 Jun 2016 13:53:00 +0000"  >&lt;p&gt;Out of curiosity, what&apos;s happen if you run &lt;tt&gt;nodetool stop COMPACTION&lt;/tt&gt;?&lt;/p&gt;</comment>
                            <comment id="15357148" author="ostefano" created="Thu, 30 Jun 2016 14:16:57 +0000"  >&lt;p&gt;Would a node restart void that command?&lt;/p&gt;</comment>
                            <comment id="15357978" author="rha" created="Thu, 30 Jun 2016 22:35:23 +0000"  >&lt;p&gt;The command will only stop the in-flight compactions (if it works in this case). I was just wondering if a &lt;tt&gt;stop&lt;/tt&gt; would be a possible workaround to avoid a rolling restart of the cluster. &lt;/p&gt;</comment>
                            <comment id="15358677" author="ostefano" created="Fri, 1 Jul 2016 08:57:58 +0000"  >&lt;p&gt;I&apos;ve tried it but no change whatsoever.&lt;br/&gt;
Ended up restarting the node :/&lt;/p&gt;</comment>
                            <comment id="15405595" author="stefania" created="Wed, 3 Aug 2016 09:00:04 +0000"  >&lt;p&gt;I&apos;ll write a distributed test with 3 nodes to see if we can reproduce this.&lt;/p&gt;

&lt;p&gt;From a code inspection, I can already see a problem at this line &lt;a href=&quot;https://github.com/stef1927/cassandra/blob/cassandra-3.0/src/java/org/apache/cassandra/db/compaction/CompactionTask.java#L171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. If we interrupt the compaction here, then &lt;tt&gt;collector.finishCompaction()&lt;/tt&gt; is never called as it should be in the &lt;tt&gt;finally&lt;/tt&gt; block of the outer &lt;tt&gt;try&lt;/tt&gt; block. We should definitely fix this. This only affects the compaction stats however, the actual compaction operation should have been aborted. If you can reproduce it, you can verify this by checking that there are no compaction log files in the table directories.&lt;/p&gt;

&lt;p&gt;Regarding the &lt;tt&gt;Unexpected exception during request;&lt;/tt&gt;, I have no idea how it could be related. How do you issue the truncate command, via cqlsh or via nodetool?&lt;/p&gt;</comment>
                            <comment id="15405614" author="ostefano" created="Wed, 3 Aug 2016 09:19:51 +0000"  >&lt;p&gt;Unfortunately I can&apos;t reproduce it right now (issue was happening on the production cluster, and app reqs dictate when running a TRUNCATE).&lt;br/&gt;
I am fairly confident there was no log though, but I can&apos;t be sure 100%.&lt;/p&gt;

&lt;p&gt;Re the second issue, the only thing I can say is that the truncate was always issued via cqlsh.&lt;/p&gt;</comment>
                            <comment id="15407313" author="stefania" created="Thu, 4 Aug 2016 06:57:44 +0000"  >&lt;p&gt;I&apos;ve prepared the fix for the problem mentioned above:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;3.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/12100-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12100-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12100-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I&apos;ve also written &lt;a href=&quot;https://github.com/stef1927/cassandra-dtest/commits/12100&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this test&lt;/a&gt; to try an reproduce the issue. It iterates 40 times, each time starting compactions on 5 nodes and a truncate request from cqlsh on one of the nodes, at randomized times during the same second.&lt;/p&gt;

&lt;p&gt;I&apos;m running a multiplex job &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-dtest-multiplex/1/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;, it should run the test 25 times, giving a total of 1000 iterations. &lt;/p&gt;</comment>
                            <comment id="15408756" author="stefania" created="Fri, 5 Aug 2016 01:46:59 +0000"  >&lt;p&gt;I could not reproduce the problem despite the multiplexed run. There were several compaction interrupted exceptions, but none thrown at the line that would have caused the compaction stats to get stuck.&lt;/p&gt;

&lt;p&gt;Nonetheless I think we should commit this patch anyway since it clearly fixes a problem. &lt;/p&gt;

&lt;p&gt;It is trivial and it up-merges without conflicts, so I did not run CI on 3.9 and trunk, but I can do so if required.&lt;/p&gt;</comment>
                            <comment id="15408757" author="stefania" created="Fri, 5 Aug 2016 01:50:07 +0000"  >&lt;p&gt;Thanks for clarifying. Regarding the second issue, a client closed the connection whilst Cassandra was still reading, I don&apos;t think it&apos;s related to compaction or truncate operations.&lt;/p&gt;</comment>
                            <comment id="15415098" author="krummas" created="Wed, 10 Aug 2016 10:40:06 +0000"  >&lt;p&gt;LGTM, +1&lt;/p&gt;</comment>
                            <comment id="15416324" author="stefania" created="Thu, 11 Aug 2016 01:15:50 +0000"  >&lt;p&gt;Thank you for the review. Committed to 3.0 as 05483a962c64c350315fc738c697980b22361cc3 and merged upwards.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ostefano&quot; class=&quot;user-hover&quot; rel=&quot;ostefano&quot;&gt;ostefano&lt;/a&gt;, let us know if you still have problems with this in 3.0.9.&lt;/p&gt;</comment>
                            <comment id="15416917" author="ostefano" created="Thu, 11 Aug 2016 09:09:01 +0000"  >&lt;p&gt;Will do, thx!&lt;/p&gt;</comment>
                            <comment id="15832261" author="s_delima" created="Fri, 20 Jan 2017 19:04:57 +0000"  >&lt;p&gt;Any chance you can backport this to 2.2.9? (Referring to &lt;a href=&quot;https://github.com/apache/cassandra/commit/05483a962c64c350315fc738c697980b22361cc3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this commit&lt;/a&gt;.)&lt;/p&gt;</comment>
                            <comment id="15878484" author="stefania" created="Wed, 22 Feb 2017 15:31:45 +0000"  >&lt;p&gt;2.2.9 is closed, the next 2.2 release is 2.2.10.  The 2.2.x series is generally accepting only critical fixes, but this patch is so trivial and safe to backport that I think we can make an exception. The patch only fixes the compaction stats, nothing else, no real compaction is actually stuck and fixed by this patch.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=s_delima&quot; class=&quot;user-hover&quot; rel=&quot;s_delima&quot;&gt;s_delima&lt;/a&gt; if you still want it in 2.2.10 I can start the tests:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/tree/12100-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12100-2.2-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12100-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Sorry for the late reply.&lt;/p&gt;</comment>
                            <comment id="15878636" author="s_delima" created="Wed, 22 Feb 2017 16:27:59 +0000"  >&lt;p&gt;Yes, please.&lt;/p&gt;</comment>
                            <comment id="15878643" author="stefania" created="Wed, 22 Feb 2017 16:30:28 +0000"  >&lt;p&gt;Tests launched. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krummas&quot; class=&quot;user-hover&quot; rel=&quot;krummas&quot;&gt;krummas&lt;/a&gt;, are you also +1 to back-port this to 2.2?&lt;/p&gt;</comment>
                            <comment id="15878831" author="krummas" created="Wed, 22 Feb 2017 17:41:03 +0000"  >&lt;p&gt;sure!&lt;/p&gt;</comment>
                            <comment id="15880149" author="stefania" created="Thu, 23 Feb 2017 09:06:48 +0000"  >&lt;p&gt;Thanks, committed to 2.2 as &lt;tt&gt;dffb1a6da8e2c3a9c08bb94bfd12130b9ddded74&lt;/tt&gt; and merged upwards with &lt;tt&gt;-s ours&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15880853" author="s_delima" created="Thu, 23 Feb 2017 17:12:26 +0000"  >&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12999571">CASSANDRA-12529</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12814874" name="node3_jstack.log" size="206904" author="ostefano" created="Wed, 29 Jun 2016 19:39:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 38 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i308tb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>marcuse</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12335694">3.0.7</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>