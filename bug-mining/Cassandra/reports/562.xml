<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:17:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-1732] nodetool move throws Assertion Error</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-1732</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Started from a clean slate 3 node cluster. I first started 1 node and bootstrapped the second and third node into the cluster. I created some Keyspaces and inserted some test data, I ended up with this ring:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;agoudarzi@cas-test1 ~&amp;#93;&lt;/span&gt;$ nodetool --host localhost ring&lt;br/&gt;
Address         Status State   Load            Token                                       &lt;br/&gt;
                                       142685436305748685139980028665762955655    &lt;br/&gt;
10.50.26.133    Up     Normal  160.51 KB       57614844575514069274136376807820902791      &lt;br/&gt;
10.50.26.134    Up     Normal  160.51 KB       100150140440631377207058202736791929223     &lt;br/&gt;
10.50.26.132    Up     Normal  165.48 KB       142685436305748685139980028665762955655     &lt;/p&gt;

&lt;p&gt;Now I wanted to test manual moving nodes to balanced tokens:&lt;br/&gt;
stage1:agoudarzi:~:$ python test.py 3&lt;br/&gt;
56713727820156410577229101238628035242&lt;br/&gt;
113427455640312821154458202477256070484&lt;br/&gt;
170141183460469231731687303715884105727&lt;/p&gt;

&lt;p&gt;So I did nodetool move on 10.50.26.132:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;agoudarzi@cas-test1 ~&amp;#93;&lt;/span&gt;$ nodetool --host localhost move 56713727820156410577229101238628035242&lt;/p&gt;

&lt;p&gt;All went fine. &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;agoudarzi@cas-test1 ~&amp;#93;&lt;/span&gt;$ nodetool --host localhost ring&lt;br/&gt;
Address         Status State   Load            Token                                       &lt;br/&gt;
                                       100150140440631377207058202736791929223    &lt;br/&gt;
10.50.26.132    Up     Normal  603.03 KB       56713727820156410577229101238628035242      &lt;br/&gt;
10.50.26.133    Up     Normal  15.18 MB        57614844575514069274136376807820902791      &lt;br/&gt;
10.50.26.134    Up     Normal  15.19 MB        100150140440631377207058202736791929223     &lt;/p&gt;

&lt;p&gt;Now I wanted to move the second node 10.50.26.133:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;agoudarzi@cas-test2 ~&amp;#93;&lt;/span&gt;$ nodetool --host localhost move 113427455640312821154458202477256070484&lt;br/&gt;
Exception in thread &quot;main&quot; java.lang.AssertionError&lt;br/&gt;
	at org.apache.cassandra.service.StorageService.getLocalToken(StorageService.java:1128)&lt;br/&gt;
	at org.apache.cassandra.service.StorageService.startLeaving(StorageService.java:1527)&lt;br/&gt;
	at org.apache.cassandra.service.StorageService.move(StorageService.java:1666)&lt;br/&gt;
	at org.apache.cassandra.service.StorageService.move(StorageService.java:1641)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:616)&lt;br/&gt;
	at com.sun.jmx.mbeanserver.StandardMBeanIntrospector.invokeM2(StandardMBeanIntrospector.java:111)&lt;br/&gt;
	at com.sun.jmx.mbeanserver.StandardMBeanIntrospector.invokeM2(StandardMBeanIntrospector.java:45)&lt;br/&gt;
	at com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(MBeanIntrospector.java:226)&lt;br/&gt;
	at com.sun.jmx.mbeanserver.PerInterface.invoke(PerInterface.java:138)&lt;br/&gt;
	at com.sun.jmx.mbeanserver.MBeanSupport.invoke(MBeanSupport.java:251)&lt;br/&gt;
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:857)&lt;br/&gt;
	at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:795)&lt;br/&gt;
	at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1449)&lt;br/&gt;
	at javax.management.remote.rmi.RMIConnectionImpl.access$200(RMIConnectionImpl.java:90)&lt;br/&gt;
	at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1284)&lt;br/&gt;
	at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1382)&lt;br/&gt;
	at javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:807)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:616)&lt;br/&gt;
	at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:322)&lt;br/&gt;
	at sun.rmi.transport.Transport$1.run(Transport.java:177)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at sun.rmi.transport.Transport.serviceCall(Transport.java:173)&lt;br/&gt;
	at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:553)&lt;br/&gt;
	at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:808)&lt;br/&gt;
	at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:667)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:636)&lt;/p&gt;

&lt;p&gt; I am attacking the logs for my 3 nodes. For your reference I refer to these IPs as these nodes:&lt;/p&gt;

&lt;p&gt;node1: 10.50.26.132&lt;br/&gt;
node2: 10.50.26.133&lt;br/&gt;
node3: 10.50.26.134&lt;/p&gt;

&lt;p&gt;I have seen similar exception being thrown in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1670&quot; title=&quot;cannot move a node&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1670&quot;&gt;&lt;del&gt;CASSANDRA-1670&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Please investigate.&lt;/p&gt;

&lt;p&gt;-Arya&lt;/p&gt;</description>
                <environment>&lt;p&gt;CentOS 5.4&lt;br/&gt;
Cassandra Trunk SVN Revision #1034158&lt;/p&gt;</environment>
        <key id="12479762">CASSANDRA-1732</key>
            <summary>nodetool move throws Assertion Error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tjake">T Jake Luciani</assignee>
                                    <reporter username="arya">Arya Goudarzi</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Nov 2010 00:34:05 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:13 +0000</updated>
                            <resolved>Fri, 19 Nov 2010 14:34:16 +0000</resolved>
                                        <fixVersion>0.7.0 rc 1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12931858" author="jbellis" created="Sun, 14 Nov 2010 18:54:51 +0000"  >&lt;p&gt;Does this work on 0.6.8?&lt;/p&gt;</comment>
                            <comment id="12933652" author="tjake" created="Fri, 19 Nov 2010 01:52:36 +0000"  >&lt;p&gt;Attached fix.&lt;/p&gt;

&lt;p&gt;in 0.7 bootstrapping a clean node takes a slightly different code path due to the fact that there are no non-system CFs defined.  This new code wasn&apos;t setting the nodes token.&lt;/p&gt;

&lt;p&gt;This seems to be the same issue as &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1738&quot; title=&quot;Decommission fails after original bootstrap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1738&quot;&gt;&lt;del&gt;CASSANDRA-1738&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12933817" author="jbellis" created="Fri, 19 Nov 2010 14:34:16 +0000"  >&lt;p&gt;committed, combining tokenMetadata_.updateNormalToken + SystemTable.updateToken into SS.setToken call&lt;/p&gt;</comment>
                            <comment id="12933831" author="hudson" created="Fri, 19 Nov 2010 15:12:34 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #16 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/16/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/16/&lt;/a&gt;)&lt;br/&gt;
    fix for bootstrap when no non-system tables are defined&lt;br/&gt;
patch by tjake; reviewed by jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1732&quot; title=&quot;nodetool move throws Assertion Error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1732&quot;&gt;&lt;del&gt;CASSANDRA-1732&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12459963" name="1732_v1.txt" size="764" author="tjake" created="Fri, 19 Nov 2010 01:52:36 +0000"/>
                            <attachment id="12459409" name="node1.log" size="53064" author="arya" created="Fri, 12 Nov 2010 00:36:34 +0000"/>
                            <attachment id="12459410" name="node2.log" size="46504" author="arya" created="Fri, 12 Nov 2010 00:36:34 +0000"/>
                            <attachment id="12459411" name="node3.log" size="44056" author="arya" created="Fri, 12 Nov 2010 00:36:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[tjake]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20280</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 1 week, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g71r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>92572</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>