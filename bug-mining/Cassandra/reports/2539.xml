<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:42:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-6554] During upgrade from 1.2 -&gt; 2.0, upgraded node sees other nodes as Down</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-6554</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;During an upgrade from 1.2.13 to 2.0.3/2.0.4, the upgraded node sees the remaining nodes of the cluster as Down.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;automaton@ip-10-139-1-113:~$ nodetool status
Datacenter: datacenter1
=======================
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address         Load       Owns   Host ID                               Token                                    Rack
UN  10.139.1.113    98.94 MB   33.3%  33b1cd06-e17b-4332-8066-0c6c401e0cf3  -9223372036854775808                     rack1
DN  10.139.11.168   97.51 MB   33.3%  ec97c163-8f2d-4019-a3d1-55df5e4037d4  -3074457345618258603                     rack1
DN  10.238.221.115  97.34 MB   33.3%  73a76d3f-73ef-481d-b603-0833c0ff80c2  3074457345618258602                      rack1
automaton@ip-10-139-1-113:~$ nodetool gossipinfo
/10.238.221.115
  SEVERITY:0.0
  RPC_ADDRESS:0.0.0.0
  DC:datacenter1
  RELEASE_VERSION:1.2.13
  LOAD:1.02066255E8
  STATUS:NORMAL,3074457345618258602
  SCHEMA:8b351435-81ef-3a14-adf7-8555e2f19ecd
  NET_VERSION:6
  RACK:rack1
  HOST_ID:73a76d3f-73ef-481d-b603-0833c0ff80c2
/10.139.1.113
  RPC_ADDRESS:0.0.0.0
  SEVERITY:0.0
  DC:datacenter1
  RELEASE_VERSION:2.0.4
  LOAD:1.03750451E8
  STATUS:NORMAL,-9223372036854775808
  SCHEMA:dfafb212-5b8f-31cb-a80b-2ba58fcef73d
  NET_VERSION:7
  RACK:rack1
  HOST_ID:33b1cd06-e17b-4332-8066-0c6c401e0cf3
/10.139.11.168
  SEVERITY:0.0
  RPC_ADDRESS:0.0.0.0
  DC:datacenter1
  RELEASE_VERSION:1.2.13
  LOAD:1.02245066E8
  STATUS:NORMAL,-3074457345618258603
  SCHEMA:8b351435-81ef-3a14-adf7-8555e2f19ecd
  NET_VERSION:6
  RACK:rack1
  HOST_ID:ec97c163-8f2d-4019-a3d1-55df5e4037d4
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;EC2 Ubuntu Precise 12.04&lt;br/&gt;
Oracle JRE 1.7_25&lt;br/&gt;
C* 1.2.13 upgrade to 2.0.4&lt;/p&gt;</environment>
        <key id="12687583">CASSANDRA-6554</key>
            <summary>During upgrade from 1.2 -&gt; 2.0, upgraded node sees other nodes as Down</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="mshuler">Michael Shuler</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Jan 2014 03:11:56 +0000</created>
                <updated>Tue, 14 Oct 2025 12:13:59 +0000</updated>
                            <resolved>Thu, 9 Jan 2014 23:02:51 +0000</resolved>
                                        <fixVersion>2.0.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13864403" author="mshuler" created="Tue, 7 Jan 2014 17:08:02 +0000"  >&lt;p&gt;So... this morning, while carefully running through my steps to reproduce, the upgraded node0 accepts writes via stress, as well as node1 and node2.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mshuler@hana:~$ ctool launch -i m1.medium -j 1.7_25 upgradetest 3
mshuler@hana:~$ ctool install -v 1.2.13 -i tar -t http:&lt;span class=&quot;code-comment&quot;&gt;//www.us.apache.org/dist/cassandra/1.2.13/apache-cassandra-1.2.13-bin.tar.gz upgradetest cassandra
&lt;/span&gt;Entering the API (tail -f /home/mshuler/.automaton/automaton.log &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more info)
mshuler@hana:~$ ctool start upgradetest cassandra

----

mshuler@hana:~$ ctool ssh upgradetest 0
&amp;lt;...&amp;gt;
automaton@ip-10-139-1-113:~$ ./dsc-cassandra/tools/bin/cassandra-stress
Created keyspaces. Sleeping 1s &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; propagation.
total,interval_op_rate,interval_key_rate,latency/95th/99.9th,elapsed_time
3869,386,386,104.3,210.7,327.0,10
10832,696,696,84.9,187.9,292.6,20
19889,905,905,72.8,168.2,275.7,30
&amp;lt;...&amp;gt;
966878,2595,2595,24.1,31.1,195.2,435
994244,2736,2736,24.0,31.1,195.2,445
1000000,575,575,23.8,31.1,195.2,447
END
automaton@ip-10-139-1-113:~$ nodetool status
Datacenter: datacenter1
=======================
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address         Load       Owns (effective)  Host ID                               Token                                    Rack
UN  10.139.11.168   97.51 MB   33.3%             ec97c163-8f2d-4019-a3d1-55df5e4037d4  -3074457345618258603                     rack1
UN  10.139.1.113    97.44 MB   33.3%             33b1cd06-e17b-4332-8066-0c6c401e0cf3  -9223372036854775808                     rack1
UN  10.238.221.115  97.34 MB   33.3%             73a76d3f-73ef-481d-b603-0833c0ff80c2  3074457345618258602                      rack1
automaton@ip-10-139-1-113:~$ nodetool gossipinfo
/10.238.221.115
  RELEASE_VERSION:1.2.13
  DC:datacenter1
  STATUS:NORMAL,3074457345618258602
  RPC_ADDRESS:0.0.0.0
  NET_VERSION:6
  LOAD:1.02066255E8
  SCHEMA:8b351435-81ef-3a14-adf7-8555e2f19ecd
  RACK:rack1
  SEVERITY:0.0
  HOST_ID:73a76d3f-73ef-481d-b603-0833c0ff80c2
/10.139.1.113
  RELEASE_VERSION:1.2.13
  DC:datacenter1
  STATUS:NORMAL,-9223372036854775808
  RPC_ADDRESS:0.0.0.0
  NET_VERSION:6
  LOAD:9.2039687E7
  SCHEMA:8b351435-81ef-3a14-adf7-8555e2f19ecd
  RACK:rack1
  SEVERITY:0.0
  HOST_ID:33b1cd06-e17b-4332-8066-0c6c401e0cf3
/10.139.11.168
  RELEASE_VERSION:1.2.13
  DC:datacenter1
  STATUS:NORMAL,-3074457345618258603
  RPC_ADDRESS:0.0.0.0
  NET_VERSION:6
  LOAD:1.02245066E8
  SCHEMA:8b351435-81ef-3a14-adf7-8555e2f19ecd
  RACK:rack1
  SEVERITY:0.0
  HOST_ID:ec97c163-8f2d-4019-a3d1-55df5e4037d4

----

automaton@ip-10-139-1-113:~$ wget -q http:&lt;span class=&quot;code-comment&quot;&gt;//www.us.apache.org/dist/cassandra/2.0.4/apache-cassandra-2.0.4-bin.tar.gz
&lt;/span&gt;automaton@ip-10-139-1-113:~$ tar xzf apache-cassandra-2.0.4-bin.tar.gz
automaton@ip-10-139-1-113:~$ cp -p apache-cassandra-2.0.4/conf/cassandra.yaml apache-cassandra-2.0.4/conf/cassandra.yaml.dist

automaton@ip-10-139-1-113:~$ vi apache-cassandra-2.0.4/conf/cassandra.yaml
[transfer values from 1.2.13 config]

automaton@ip-10-139-1-113:~$ diff apache-cassandra-2.0.4/conf/cassandra.yaml.dist apache-cassandra-2.0.4/conf/cassandra.yaml
10c10
&amp;lt; cluster_name: &lt;span class=&quot;code-quote&quot;&gt;&apos;Test Cluster&apos;&lt;/span&gt;
---
&amp;gt; cluster_name: upgradetest
24c24
&amp;lt; num_tokens: 256
---
&amp;gt; #num_tokens: 256
30c30
&amp;lt; # initial_token:
---
&amp;gt; initial_token: -9223372036854775808
227c227
&amp;lt;           - seeds: &lt;span class=&quot;code-quote&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;
---
&amp;gt;           - seeds: 10.139.1.113,10.139.11.168
297c297
&amp;lt; listen_address: localhost
---
&amp;gt; listen_address: 10.139.1.113
335c335
&amp;lt; rpc_address: localhost
---
&amp;gt; rpc_address: 0.0.0.0

----

automaton@ip-10-139-1-113:~$ nodetool drain
automaton@ip-10-139-1-113:~$ ps aux | grep [j]ava
automaton@ip-10-139-1-113:~$ mv dsc-cassandra/ dsc-cassandra_1.2.13
automaton@ip-10-139-1-113:~$ mv apache-cassandra-2.0.4 dsc-cassandra

----

mshuler@hana:~$ ctool start upgradetest -n 0 cassandra

----

automaton@ip-10-139-1-113:~$ nodetool status
Datacenter: datacenter1
=======================
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address         Load       Owns   Host ID                               Token                                    Rack
UN  10.139.1.113    98.94 MB   33.3%  33b1cd06-e17b-4332-8066-0c6c401e0cf3  -9223372036854775808                     rack1
DN  10.139.11.168   97.51 MB   33.3%  ec97c163-8f2d-4019-a3d1-55df5e4037d4  -3074457345618258603                     rack1
DN  10.238.221.115  97.34 MB   33.3%  73a76d3f-73ef-481d-b603-0833c0ff80c2  3074457345618258602                      rack1
automaton@ip-10-139-1-113:~$ nodetool gossipinfo
/10.238.221.115
  SEVERITY:0.0
  RPC_ADDRESS:0.0.0.0
  DC:datacenter1
  RELEASE_VERSION:1.2.13
  LOAD:1.02066255E8
  STATUS:NORMAL,3074457345618258602
  SCHEMA:8b351435-81ef-3a14-adf7-8555e2f19ecd
  NET_VERSION:6
  RACK:rack1
  HOST_ID:73a76d3f-73ef-481d-b603-0833c0ff80c2
/10.139.1.113
  RPC_ADDRESS:0.0.0.0
  SEVERITY:0.0
  DC:datacenter1
  RELEASE_VERSION:2.0.4
  LOAD:1.03750451E8
  STATUS:NORMAL,-9223372036854775808
  SCHEMA:dfafb212-5b8f-31cb-a80b-2ba58fcef73d
  NET_VERSION:7
  RACK:rack1
  HOST_ID:33b1cd06-e17b-4332-8066-0c6c401e0cf3
/10.139.11.168
  SEVERITY:0.0
  RPC_ADDRESS:0.0.0.0
  DC:datacenter1
  RELEASE_VERSION:1.2.13
  LOAD:1.02245066E8
  STATUS:NORMAL,-3074457345618258603
  SCHEMA:8b351435-81ef-3a14-adf7-8555e2f19ecd
  NET_VERSION:6
  RACK:rack1
  HOST_ID:ec97c163-8f2d-4019-a3d1-55df5e4037d4

automaton@ip-10-139-1-113:~$ ./dsc-cassandra/tools/bin/cassandra-stress
Unable to create stress keyspace: Keyspace names must be &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;-insensitively unique (&lt;span class=&quot;code-quote&quot;&gt;&quot;Keyspace1&quot;&lt;/span&gt; conflicts with &lt;span class=&quot;code-quote&quot;&gt;&quot;Keyspace1&quot;&lt;/span&gt;)
total,interval_op_rate,interval_key_rate,latency,95th,99.9th,elapsed_time
3553,355,355,111.6,195.9,452.3,10
8296,474,474,119.8,199.8,449.7,21
13498,520,520,117.9,197.3,438.7,31
&amp;lt;...&amp;gt;
940610,2883,2883,22.3,29.2,159.4,395
971153,3054,3054,22.3,29.0,159.4,405
1000000,2884,2884,22.0,28.8,160.0,415


Averages from the middle 80% of values:
interval_op_rate          : 2835
interval_key_rate         : 2835
latency median            : 24.2
latency 95th percentile   : 46.5
latency 99.9th percentile : 385.9
Total operation time      : 00:06:55
END
automaton@ip-10-139-1-113:~$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13864419" author="brandon.williams" created="Tue, 7 Jan 2014 17:28:26 +0000"  >&lt;p&gt;So you&apos;re saying you can&apos;t repro?&lt;/p&gt;</comment>
                            <comment id="13864425" author="mshuler" created="Tue, 7 Jan 2014 17:30:45 +0000"  >&lt;p&gt;So stress seems to write data (today, for whatever reason, which outright failed last night), but the nodes do not appear to be talking nicely to one another:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;node0 (upgraded)

automaton@ip-10-139-1-113:~$ nodetool ring
Note: Ownership information does not include topology; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; complete information, specify a keyspace

Datacenter: datacenter1
==========
Address         Rack        Status State   Load            Owns                Token                                       
                                                                               3074457345618258602                         
10.139.1.113    rack1       Up     Normal  22.56 MB        33.33%              -9223372036854775808                        
10.139.11.168   rack1       Down   Normal  241.09 MB       33.33%              -3074457345618258603                        
10.238.221.115  rack1       Down   Normal  243.86 MB       33.33%              3074457345618258602                         

automaton@ip-10-139-1-113:~$ cqlsh
Connected to upgradetest at localhost:9160.
[cqlsh 4.1.0 | Cassandra 2.0.4 | CQL spec 3.1.1 | Thrift protocol 19.39.0]
Use HELP &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; help.
cqlsh&amp;gt; DROP KEYSPACE &lt;span class=&quot;code-quote&quot;&gt;&quot;Keyspace1&quot;&lt;/span&gt;;
cqlsh&amp;gt; DESC KEYSPACES 

system  system_traces

cqlsh&amp;gt; 
automaton@ip-10-139-1-113:~$ nodetool ring

Datacenter: datacenter1
==========
Address         Rack        Status State   Load            Owns                Token                                       
                                                                               -9223372036854775808                        
10.139.11.168   rack1       Down   Normal  241.08 MB       66.67%              -3074457345618258603                        
10.238.221.115  rack1       Down   Normal  243.86 MB       66.67%              3074457345618258602                         
10.139.1.113    rack1       Up     Normal  97.75 KB        66.67%              -9223372036854775808                        

automaton@ip-10-139-1-113:~$

node1

automaton@ip-10-139-11-168:~$ nodetool ring

Datacenter: datacenter1
==========
Replicas: 0

Address         Rack        Status State   Load            Owns                Token                                       
                                                                               3074457345618258602                         
10.139.11.168   rack1       Up     Normal  241.08 MB       33.33%              -3074457345618258603                        
10.139.1.113    rack1       Up     Normal  22.56 MB        33.33%              -9223372036854775808                        
10.238.221.115  rack1       Up     Normal  243.86 MB       33.33%              3074457345618258602                         

automaton@ip-10-139-11-168:~$ cqlsh
Connected to upgradetest at localhost:9160.
[cqlsh 3.1.8 | Cassandra 1.2.13 | CQL spec 3.0.0 | Thrift protocol 19.36.2]
Use HELP &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; help.
cqlsh&amp;gt; DESC KEYSPACES 

system  Keyspace1  system_traces

cqlsh&amp;gt; 
automaton@ip-10-139-11-168:~$ nodetool ring

Datacenter: datacenter1
==========
Replicas: 0

Address         Rack        Status State   Load            Owns                Token                                       
                                                                               3074457345618258602                         
10.139.11.168   rack1       Up     Normal  241.08 MB       33.33%              -3074457345618258603                        
10.139.1.113    rack1       Up     Normal  97.75 KB        33.33%              -9223372036854775808                        
10.238.221.115  rack1       Up     Normal  243.86 MB       33.33%              3074457345618258602                         

automaton@ip-10-139-11-168:~$

node2

automaton@ip-10-238-221-115:~$ nodetool ring

Datacenter: datacenter1
==========
Replicas: 0

Address         Rack        Status State   Load            Owns                Token                                       
                                                                               3074457345618258602                         
10.139.11.168   rack1       Up     Normal  241.08 MB       33.33%              -3074457345618258603                        
10.139.1.113    rack1       Up     Normal  22.56 MB        33.33%              -9223372036854775808                        
10.238.221.115  rack1       Up     Normal  243.86 MB       33.33%              3074457345618258602                         

automaton@ip-10-238-221-115:~$ cqlsh
Connected to upgradetest at localhost:9160.
[cqlsh 3.1.8 | Cassandra 1.2.13 | CQL spec 3.0.0 | Thrift protocol 19.36.2]
Use HELP &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; help.
cqlsh&amp;gt; DESC KEYSPACES 

system  Keyspace1  system_traces

cqlsh&amp;gt; 
automaton@ip-10-238-221-115:~$ nodetool ring

Datacenter: datacenter1
==========
Replicas: 0

Address         Rack        Status State   Load            Owns                Token                                       
                                                                               3074457345618258602                         
10.139.11.168   rack1       Up     Normal  241.08 MB       33.33%              -3074457345618258603                        
10.139.1.113    rack1       Up     Normal  97.75 KB        33.33%              -9223372036854775808                        
10.238.221.115  rack1       Up     Normal  243.86 MB       33.33%              3074457345618258602                         

automaton@ip-10-238-221-115:~$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13864450" author="mshuler" created="Tue, 7 Jan 2014 17:53:06 +0000"  >&lt;p&gt;I understand the above, due to schema not being able to propogate, is expected, until all the nodes are upgraded.&lt;/p&gt;</comment>
                            <comment id="13864489" author="mshuler" created="Tue, 7 Jan 2014 18:15:47 +0000"  >&lt;p&gt;Aha!  Running stress with the whole cluster online, prior to upgrading node0 (above), meant that all nodes had Keyspace1.&lt;/p&gt;

&lt;p&gt;The write failure that I believe both of us were seeing last night was running stress on the upgraded node and other nodes without ever having run it prior, so the schemas don&apos;t agree and cannot propogate the keyspace:&lt;/p&gt;

&lt;p&gt;node0 (upgraded)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;automaton@ip-10-180-239-135:~$ ./dsc-cassandra/tools/bin/cassandra-stress
Created keyspaces. Sleeping 1s &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; propagation.
total,interval_op_rate,interval_key_rate,latency,95th,99.9th,elapsed_time
25,2,2,238.9,263.2,263.3,10
25,0,0,238.9,263.2,263.3,20
Operation [26] retried 10 times - error inserting key 0000026 ((TimedOutException))

Operation [19] retried 10 times - error inserting key 0000019 ((TimedOutException))

Operation [18] retried 10 times - error inserting key 0000018 ((TimedOutException))

Operation [3] retried 10 times - error inserting key 0000003 ((TimedOutException))

Operation [46] retried 10 times - error inserting key 0000046 ((TimedOutException))

Operation [47] retried 10 times - error inserting key 0000047 ((TimedOutException))

Operation [15] retried 10 times - error inserting key 0000015 ((TimedOutException))

Operation [6] retried 10 times - error inserting key 0000006 ((TimedOutException))

Operation [2] retried 10 times - error inserting key 0000002 ((TimedOutException))

Operation [37] retried 10 times - error inserting key 0000037 ((TimedOutException))

Operation [14] retried 10 times - error inserting key 0000014 ((TimedOutException))

Operation [41] retried 10 times - error inserting key 0000041 ((TimedOutException))

Operation [39] retried 10 times - error inserting key 0000039 ((TimedOutException))

Operation [22] retried 10 times - error inserting key 0000022 ((TimedOutException))

Operation [0] retried 10 times - error inserting key 0000000 ((TimedOutException))

Operation [16] retried 10 times - error inserting key 0000016 ((TimedOutException))

Operation [45] retried 10 times - error inserting key 0000045 ((TimedOutException))

Operation [12] retried 10 times - error inserting key 0000012 ((TimedOutException))

Operation [32] retried 10 times - error inserting key 0000032 ((TimedOutException))

Operation [9] retried 10 times - error inserting key 0000009 ((TimedOutException))

Operation [10] retried 10 times - error inserting key 0000010 ((TimedOutException))

Operation [44] retried 10 times - error inserting key 0000044 ((TimedOutException))

Operation [34] retried 10 times - error inserting key 0000034 ((TimedOutException))

Operation [5] retried 10 times - error inserting key 0000005 ((TimedOutException))

Operation [49] retried 10 times - error inserting key 0000049 ((TimedOutException))

Operation [11] retried 10 times - error inserting key 0000011 ((TimedOutException))

Operation [54] retried 10 times - error inserting key 0000054 ((TimedOutException))

Operation [33] retried 10 times - error inserting key 0000033 ((TimedOutException))

Operation [51] retried 10 times - error inserting key 0000051 ((TimedOutException))

Operation [57] retried 10 times - error inserting key 0000057 ((TimedOutException))

Operation [58] retried 10 times - error inserting key 0000058 ((TimedOutException))

Operation [53] retried 10 times - error inserting key 0000053 ((TimedOutException))

Operation [55] retried 10 times - error inserting key 0000055 ((TimedOutException))

Operation [8] retried 10 times - error inserting key 0000008 ((TimedOutException))

Operation [42] retried 10 times - error inserting key 0000042 ((TimedOutException))

Operation [52] retried 10 times - error inserting key 0000052 ((TimedOutException))

Operation [20] retried 10 times - error inserting key 0000020 ((TimedOutException))

Operation [31] retried 10 times - error inserting key 0000031 ((TimedOutException))

Operation [63] retried 10 times - error inserting key 0000063 ((TimedOutException))

Operation [59] retried 10 times - error inserting key 0000059 ((TimedOutException))

Operation [64] retried 10 times - error inserting key 0000064 ((TimedOutException))

Operation [66] retried 10 times - error inserting key 0000066 ((TimedOutException))

Operation [61] retried 10 times - error inserting key 0000061 ((TimedOutException))

Operation [67] retried 10 times - error inserting key 0000067 ((TimedOutException))

Operation [60] retried 10 times - error inserting key 0000060 ((TimedOutException))

Operation [70] retried 10 times - error inserting key 0000070 ((TimedOutException))

Operation [71] retried 10 times - error inserting key 0000071 ((TimedOutException))

Operation [73] retried 10 times - error inserting key 0000073 ((TimedOutException))

Operation [72] retried 10 times - error inserting key 0000072 ((TimedOutException))

Operation [74] retried 10 times - error inserting key 0000074 ((TimedOutException))

25,0,0,238.9,263.2,263.3,21
FAILURE
automaton@ip-10-180-239-135:~$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;node1 and node2 error the same way:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;automaton@ip-10-180-230-58:~$ ./dsc-cassandra/tools/bin/cassandra-stress
Unable to create stress keyspace: Keyspace names must be &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;-insensitively unique (&lt;span class=&quot;code-quote&quot;&gt;&quot;Keyspace1&quot;&lt;/span&gt; conflicts with &lt;span class=&quot;code-quote&quot;&gt;&quot;Keyspace1&quot;&lt;/span&gt;)
total,interval_op_rate,interval_key_rate,latency/95th/99.9th,elapsed_time
Operation [9] retried 10 times - error inserting key 0000009 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [31] retried 10 times - error inserting key 0000031 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [27] retried 10 times - error inserting key 0000027 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [46] retried 10 times - error inserting key 0000046 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [11] retried 10 times - error inserting key 0000011 ((InvalidRequestException): unconfigured columnfamily Standard1)                                                                                              
                                                                                                              
Operation [39] retried 10 times - error inserting key 0000039 ((InvalidRequestException): unconfigured columnfamily Standard1)                                                                                              
                                                                                                              
Operation [43] retried 10 times - error inserting key 0000043 ((InvalidRequestException): unconfigured columnfamily Standard1)                                                                                              
                                                                                                              
Operation [2] retried 10 times - error inserting key 0000002 ((InvalidRequestException): unconfigured columnfamily Standard1)                                                                                               

Operation [13] retried 10 times - error inserting key 0000013 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [37] retried 10 times - error inserting key 0000037 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [49] retried 10 times - error inserting key 0000049 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [15] retried 10 times - error inserting key 0000015 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [19] retried 10 times - error inserting key 0000019 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [28] retried 10 times - error inserting key 0000028 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [21] retried 10 times - error inserting key 0000021 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [10] retried 10 times - error inserting key 0000010 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [17] retried 10 times - error inserting key 0000017 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [18] retried 10 times - error inserting key 0000018 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [30] retried 10 times - error inserting key 0000030 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [7] retried 10 times - error inserting key 0000007 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [42] retried 10 times - error inserting key 0000042 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [6] retried 10 times - error inserting key 0000006 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [25] retried 10 times - error inserting key 0000025 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [5] retried 10 times - error inserting key 0000005 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [44] retried 10 times - error inserting key 0000044 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [41] retried 10 times - error inserting key 0000041 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [16] retried 10 times - error inserting key 0000016 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [36] retried 10 times - error inserting key 0000036 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [14] retried 10 times - error inserting key 0000014 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [23] retried 10 times - error inserting key 0000023 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [29] retried 10 times - error inserting key 0000029 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [40] retried 10 times - error inserting key 0000040 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [1] retried 10 times - error inserting key 0000001 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [24] retried 10 times - error inserting key 0000024 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [8] retried 10 times - error inserting key 0000008 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [32] retried 10 times - error inserting key 0000032 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [4] retried 10 times - error inserting key 0000004 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [33] retried 10 times - error inserting key 0000033 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [48] retried 10 times - error inserting key 0000048 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [35] retried 10 times - error inserting key 0000035 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [45] retried 10 times - error inserting key 0000045 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [22] retried 10 times - error inserting key 0000022 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [34] retried 10 times - error inserting key 0000034 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [26] retried 10 times - error inserting key 0000026 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [47] retried 10 times - error inserting key 0000047 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [3] retried 10 times - error inserting key 0000003 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [20] retried 10 times - error inserting key 0000020 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [12] retried 10 times - error inserting key 0000012 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [38] retried 10 times - error inserting key 0000038 ((InvalidRequestException): unconfigured columnfamily Standard1)

Operation [0] retried 10 times - error inserting key 0000000 ((InvalidRequestException): unconfigured columnfamily Standard1)

0,0,0,0.0,0.0,0.0,1
FAILURE
automaton@ip-10-180-230-58:~$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I believe the answer to this is notabug and &quot;Don&apos;t do that.&quot;  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13864494" author="JIRAUSER308715" created="Tue, 7 Jan 2014 18:21:10 +0000"  >&lt;p&gt;So sounds like the write failures aren&apos;t a bug.  Yes, schema changes are not supported in a mixed cluster, so you have to run stress (or make the tables) before upgrading.&lt;/p&gt;

&lt;p&gt;But that fact that the other nodes are shown as DOWN while doing the upgrade is an issue.  So I would either keep this open for that, or make a new ticket for it.&lt;/p&gt;</comment>
                            <comment id="13864499" author="brandon.williams" created="Tue, 7 Jan 2014 18:25:36 +0000"  >&lt;p&gt;Jeremiah is right, up/down status is independent of schema.&lt;/p&gt;</comment>
                            <comment id="13864564" author="brandon.williams" created="Tue, 7 Jan 2014 19:07:08 +0000"  >&lt;p&gt;Can you bump o.a.c.gms up to TRACE and see what&apos;s going on with gossip/FD?&lt;/p&gt;</comment>
                            <comment id="13864642" author="mshuler" created="Tue, 7 Jan 2014 20:20:50 +0000"  >&lt;p&gt;6554_trace_system.log is the complete system log from:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;1.2.13 startup and stop&lt;/li&gt;
	&lt;li&gt;grab 2.0.4, configure c*.yaml and set log4j.logger.org.apache.cassandra.gms=TRACE&lt;/li&gt;
	&lt;li&gt;start 2.0.4&lt;/li&gt;
	&lt;li&gt;run nodetool status:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;automaton@ip-10-91-137-10:~$ nodetool status
Datacenter: datacenter1
=======================
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address         Load       Owns (effective)  Host ID                               Token                                    Rack
DN  10.180.236.244  55.18 KB   66.7%             fbee6d5a-b5de-4bdb-81ac-0fa69bab9e7e  -3074457345618258603                     rack1
UN  10.91.137.10    63.04 KB   66.7%             d1161fd0-b612-4070-8a03-400d2c12c4d1  -9223372036854775808                     rack1
DN  10.182.208.161  63.22 KB   66.7%             03b1e32d-fdaf-4374-afad-6aeee1ffec0a  3074457345618258603                      rack1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;stop cassandra&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13864657" author="mshuler" created="Tue, 7 Jan 2014 20:32:40 +0000"  >&lt;p&gt;Just the relevant portion:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ sudo echo &lt;span class=&quot;code-quote&quot;&gt;&quot;== Begin ==&quot;&lt;/span&gt; &amp;gt;&amp;gt; /&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/log/cassandra/system.log ; nodetool status ; sudo echo &lt;span class=&quot;code-quote&quot;&gt;&quot;== End ==&quot;&lt;/span&gt; &amp;gt;&amp;gt; /&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/log/cassandra/system.log
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;== Begin ==
TRACE [GossipTasks:1] 2014-01-07 20:29:59,731 Gossiper.java (line 133) My heartbeat is now 438
TRACE [GossipTasks:1] 2014-01-07 20:29:59,732 Gossiper.java (line 398) Gossip Digests are : /10.180.236.244:1389124753:2428 /10.91.137.10:1389126546:438 /10.182.208.161:1389124753:2265 
TRACE [GossipTasks:1] 2014-01-07 20:29:59,732 Gossiper.java (line 530) Sending a GossipDigestSyn to /10.182.208.161 ...
TRACE [GossipTasks:1] 2014-01-07 20:29:59,732 Gossiper.java (line 530) Sending a GossipDigestSyn to /10.180.236.244 ...
TRACE [GossipTasks:1] 2014-01-07 20:29:59,733 Gossiper.java (line 598) Performing status check ...
TRACE [GossipTasks:1] 2014-01-07 20:29:59,733 FailureDetector.java (line 215) PHI &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.180.236.244 : 0.5008780617528535
TRACE [GossipTasks:1] 2014-01-07 20:29:59,733 FailureDetector.java (line 215) PHI &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.182.208.161 : 0.6590114452533097
TRACE [GossipStage:1] 2014-01-07 20:29:59,734 GossipDigestAckVerbHandler.java (line 41) Received a GossipDigestAckMessage from /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:29:59,735 GossipDigestAckVerbHandler.java (line 52) Received ack with 1 digests and 2 states
TRACE [GossipStage:1] 2014-01-07 20:29:59,735 FailureDetector.java (line 189) reporting /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:29:59,735 Gossiper.java (line 932) /10.180.236.244local generation 1389124753, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:29:59,735 Gossiper.java (line 978) Updating heartbeat state version to 2428 from 2428 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.180.236.244 ...
TRACE [GossipStage:1] 2014-01-07 20:29:59,749 Gossiper.java (line 932) /10.182.208.161local generation 1389124753, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:29:59,749 Gossiper.java (line 978) Updating heartbeat state version to 2269 from 2265 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.182.208.161 ...
TRACE [GossipStage:1] 2014-01-07 20:29:59,751 Gossiper.java (line 730) local heartbeat version 438 greater than 433 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.91.137.10
TRACE [GossipStage:1] 2014-01-07 20:29:59,751 Gossiper.java (line 744) Adding state SEVERITY: 0.0
TRACE [GossipStage:1] 2014-01-07 20:29:59,751 Gossiper.java (line 744) Adding state SCHEMA: 9f0f4c3b-b568-3650-8ff7-39ae0d5be671
TRACE [GossipStage:1] 2014-01-07 20:29:59,752 GossipDigestAckVerbHandler.java (line 84) Sending a GossipDigestAck2Message to /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:29:59,775 GossipDigestAckVerbHandler.java (line 41) Received a GossipDigestAckMessage from /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:29:59,775 GossipDigestAckVerbHandler.java (line 52) Received ack with 1 digests and 2 states
TRACE [GossipStage:1] 2014-01-07 20:29:59,775 Gossiper.java (line 932) /10.180.236.244local generation 1389124753, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:29:59,775 Gossiper.java (line 952) Ignoring remote version 2431 &amp;lt;= 2431 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:29:59,776 Gossiper.java (line 932) /10.182.208.161local generation 1389124753, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:29:59,776 Gossiper.java (line 952) Ignoring remote version 2269 &amp;lt;= 2270 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:29:59,790 Gossiper.java (line 730) local heartbeat version 438 greater than 433 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.91.137.10
TRACE [GossipStage:1] 2014-01-07 20:29:59,791 Gossiper.java (line 744) Adding state SEVERITY: 0.0
TRACE [GossipStage:1] 2014-01-07 20:29:59,791 Gossiper.java (line 744) Adding state SCHEMA: 9f0f4c3b-b568-3650-8ff7-39ae0d5be671
TRACE [GossipStage:1] 2014-01-07 20:29:59,791 GossipDigestAckVerbHandler.java (line 84) Sending a GossipDigestAck2Message to /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:29:59,971 GossipDigestSynVerbHandler.java (line 40) Received a GossipDigestSynMessage from /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:29:59,971 GossipDigestSynVerbHandler.java (line 71) Gossip syn digests are : /10.182.208.161:1389124753:2269 /10.91.137.10:1389126546:438 /10.180.236.244:1389124753:2432 
TRACE [GossipStage:1] 2014-01-07 20:29:59,971 Gossiper.java (line 744) Adding state SCHEMA: 9f0f4c3b-b568-3650-8ff7-39ae0d5be671
TRACE [GossipStage:1] 2014-01-07 20:29:59,972 Gossiper.java (line 744) Adding state SCHEMA: 59adb24e-f3cd-3e02-97f0-5b395827453f
TRACE [GossipStage:1] 2014-01-07 20:29:59,972 GossipDigestSynVerbHandler.java (line 79) sending 1 digests and 2 deltas
TRACE [GossipStage:1] 2014-01-07 20:29:59,972 GossipDigestSynVerbHandler.java (line 84) Sending a GossipDigestAckMessage to /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:29:59,986 GossipDigestAck2VerbHandler.java (line 38) Received a GossipDigestAck2Message from /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:29:59,987 FailureDetector.java (line 189) reporting /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:29:59,987 Gossiper.java (line 932) /10.180.236.244local generation 1389124753, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:29:59,987 Gossiper.java (line 978) Updating heartbeat state version to 2432 from 2428 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.180.236.244 ...
TRACE [GossipStage:1] 2014-01-07 20:30:00,594 GossipDigestSynVerbHandler.java (line 40) Received a GossipDigestSynMessage from /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:30:00,594 GossipDigestSynVerbHandler.java (line 71) Gossip syn digests are : /10.182.208.161:1389124753:2276 /10.91.137.10:1389126546:438 /10.180.236.244:1389124753:2432 
TRACE [GossipStage:1] 2014-01-07 20:30:00,594 Gossiper.java (line 744) Adding state SEVERITY: 0.0
TRACE [GossipStage:1] 2014-01-07 20:30:00,594 Gossiper.java (line 744) Adding state SCHEMA: 9f0f4c3b-b568-3650-8ff7-39ae0d5be671
TRACE [GossipStage:1] 2014-01-07 20:30:00,595 GossipDigestSynVerbHandler.java (line 79) sending 1 digests and 1 deltas
TRACE [GossipStage:1] 2014-01-07 20:30:00,595 GossipDigestSynVerbHandler.java (line 84) Sending a GossipDigestAckMessage to /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:30:00,607 GossipDigestAck2VerbHandler.java (line 38) Received a GossipDigestAck2Message from /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:30:00,607 FailureDetector.java (line 189) reporting /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:30:00,607 Gossiper.java (line 932) /10.182.208.161local generation 1389124753, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:30:00,607 Gossiper.java (line 978) Updating heartbeat state version to 2276 from 2269 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.182.208.161 ...
TRACE [GossipTasks:1] 2014-01-07 20:30:00,750 Gossiper.java (line 133) My heartbeat is now 445
TRACE [GossipTasks:1] 2014-01-07 20:30:00,751 Gossiper.java (line 398) Gossip Digests are : /10.91.137.10:1389126546:445 /10.180.236.244:1389124753:2432 /10.182.208.161:1389124753:2276 
TRACE [GossipTasks:1] 2014-01-07 20:30:00,751 Gossiper.java (line 530) Sending a GossipDigestSyn to /10.182.208.161 ...
TRACE [GossipTasks:1] 2014-01-07 20:30:00,751 Gossiper.java (line 530) Sending a GossipDigestSyn to /10.180.236.244 ...
TRACE [GossipTasks:1] 2014-01-07 20:30:00,752 Gossiper.java (line 598) Performing status check ...
TRACE [GossipTasks:1] 2014-01-07 20:30:00,752 FailureDetector.java (line 215) PHI &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.180.236.244 : 0.503756137674087
TRACE [GossipTasks:1] 2014-01-07 20:30:00,753 FailureDetector.java (line 215) PHI &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.182.208.161 : 0.09675013184828929
TRACE [GossipStage:1] 2014-01-07 20:30:00,753 GossipDigestAckVerbHandler.java (line 41) Received a GossipDigestAckMessage from /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:30:00,754 GossipDigestAckVerbHandler.java (line 52) Received ack with 1 digests and 1 states
TRACE [GossipStage:1] 2014-01-07 20:30:00,754 Gossiper.java (line 932) /10.182.208.161local generation 1389124753, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:30:00,754 Gossiper.java (line 978) Updating heartbeat state version to 2276 from 2276 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.182.208.161 ...
TRACE [GossipStage:1] 2014-01-07 20:30:00,762 Gossiper.java (line 730) local heartbeat version 445 greater than 444 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.91.137.10
TRACE [GossipStage:1] 2014-01-07 20:30:00,763 GossipDigestAckVerbHandler.java (line 84) Sending a GossipDigestAck2Message to /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:30:00,763 GossipDigestAckVerbHandler.java (line 41) Received a GossipDigestAckMessage from /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:30:00,763 GossipDigestAckVerbHandler.java (line 52) Received ack with 2 digests and 1 states
TRACE [GossipStage:1] 2014-01-07 20:30:00,764 Gossiper.java (line 932) /10.180.236.244local generation 1389124753, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:30:00,764 Gossiper.java (line 978) Updating heartbeat state version to 2432 from 2432 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.180.236.244 ...
TRACE [GossipStage:1] 2014-01-07 20:30:00,765 Gossiper.java (line 730) local heartbeat version 445 greater than 440 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.91.137.10
TRACE [GossipStage:1] 2014-01-07 20:30:00,765 Gossiper.java (line 744) Adding state SEVERITY: 0.0
TRACE [GossipStage:1] 2014-01-07 20:30:00,765 Gossiper.java (line 744) Adding state SCHEMA: 9f0f4c3b-b568-3650-8ff7-39ae0d5be671
TRACE [GossipStage:1] 2014-01-07 20:30:00,766 Gossiper.java (line 730) local heartbeat version 2276 greater than 2272 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:30:00,766 Gossiper.java (line 744) Adding state SEVERITY: 0.0
TRACE [GossipStage:1] 2014-01-07 20:30:00,766 Gossiper.java (line 744) Adding state SCHEMA: 59adb24e-f3cd-3e02-97f0-5b395827453f
TRACE [GossipStage:1] 2014-01-07 20:30:00,766 GossipDigestAckVerbHandler.java (line 84) Sending a GossipDigestAck2Message to /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:30:00,961 GossipDigestSynVerbHandler.java (line 40) Received a GossipDigestSynMessage from /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:30:00,962 GossipDigestSynVerbHandler.java (line 71) Gossip syn digests are : /10.91.137.10:1389126546:445 /10.180.236.244:1389124753:2441 /10.182.208.161:1389124753:2279 
TRACE [GossipStage:1] 2014-01-07 20:30:00,962 GossipDigestSynVerbHandler.java (line 79) sending 1 digests and 0 deltas
TRACE [GossipStage:1] 2014-01-07 20:30:00,962 GossipDigestSynVerbHandler.java (line 84) Sending a GossipDigestAckMessage to /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:30:00,964 GossipDigestAck2VerbHandler.java (line 38) Received a GossipDigestAck2Message from /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:30:00,964 FailureDetector.java (line 189) reporting /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:30:00,964 Gossiper.java (line 932) /10.180.236.244local generation 1389124753, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:30:00,964 Gossiper.java (line 978) Updating heartbeat state version to 2441 from 2432 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /10.180.236.244 ...
== End ==
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13864672" author="brandon.williams" created="Tue, 7 Jan 2014 20:48:59 +0000"  >&lt;p&gt;The strange this is, it does mark the other non-upgraded nodes as up:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TRACE [GossipStage:1] 2014-01-07 20:07:53,456 GossipDigestAck2VerbHandler.java (line 38) Received a GossipDigestAck2Message from /10.180.236.244
DEBUG [GossipStage:1] 2014-01-07 20:07:53,456 Gossiper.java (line 790) Clearing interval times for /10.180.236.244 due to generation change
TRACE [GossipStage:1] 2014-01-07 20:07:53,457 FailureDetector.java (line 189) reporting /10.180.236.244
DEBUG [GossipStage:1] 2014-01-07 20:07:53,467 Gossiper.java (line 790) Clearing interval times for /10.182.208.161 due to generation change
TRACE [GossipStage:1] 2014-01-07 20:07:53,468 FailureDetector.java (line 189) reporting /10.182.208.161
TRACE [GossipStage:1] 2014-01-07 20:07:53,468 Gossiper.java (line 932) /10.180.236.244local generation 0, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:07:53,468 Gossiper.java (line 937) Updating heartbeat state generation to 1389124753 from 0 for /10.180.236.244
 INFO [GossipStage:1] 2014-01-07 20:07:53,468 Gossiper.java (line 868) Node /10.180.236.244 has restarted, now UP
TRACE [GossipStage:1] 2014-01-07 20:07:53,468 Gossiper.java (line 873) Adding endpoint state for /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:07:53,506 Gossiper.java (line 815) Sending a EchoMessage to /10.180.236.244
 INFO [HANDSHAKE-/10.180.236.244] 2014-01-07 20:07:53,534 OutboundTcpConnection.java (line 386) Handshaking version with /10.180.236.244
TRACE [GossipStage:1] 2014-01-07 20:07:53,559 TokenSerializer.java (line 56) Reading token of 8 bytes
 INFO [GossipStage:1] 2014-01-07 20:07:53,562 StorageService.java (line 1445) Node /10.180.236.244 state jump to normal
TRACE [GossipStage:1] 2014-01-07 20:07:53,570 Gossiper.java (line 932) /10.182.208.161local generation 0, remote generation 1389124753
TRACE [GossipStage:1] 2014-01-07 20:07:53,571 Gossiper.java (line 937) Updating heartbeat state generation to 1389124753 from 0 for /10.182.208.161
 INFO [GossipStage:1] 2014-01-07 20:07:53,571 Gossiper.java (line 868) Node /10.182.208.161 has restarted, now UP
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And never marks them down after that.  Can you get a gms trace from one of the other nodes too?&lt;/p&gt;</comment>
                            <comment id="13864686" author="mshuler" created="Tue, 7 Jan 2014 21:01:01 +0000"  >&lt;p&gt;Added full system.log from node1 and node2&lt;/p&gt;</comment>
                            <comment id="13864709" author="brandon.williams" created="Tue, 7 Jan 2014 21:27:27 +0000"  >&lt;p&gt;Totally baffled, these logs show the same thing: everything&apos;s working normally.&lt;/p&gt;</comment>
                            <comment id="13866905" author="brandon.williams" created="Thu, 9 Jan 2014 18:52:30 +0000"  >&lt;p&gt;What I&apos;m seeing is that on the first boot of 2.0, ring/status show the other nodes as down, even though the logs indicate everything is fine.  And indeed, it is, reads and writes work normally.  The other nodes on 1.2 see the 2.0 node as up.  If you restart the 2.0 node at this point, the cosmetic problem goes away and everything appears normal.  This appears to stem from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3533&quot; title=&quot;TimeoutException when there is a firewall issue.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3533&quot;&gt;&lt;del&gt;CASSANDRA-3533&lt;/del&gt;&lt;/a&gt; unconditionally sending echo commands and only adding the node to liveMembers if it responds, which cannot happen with nodes &amp;lt; 2.0.  Patch to conditionally mark anything &amp;lt; 2.0 up without the echo.&lt;/p&gt;</comment>
                            <comment id="13867222" author="thobbs" created="Thu, 9 Jan 2014 22:52:45 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13867233" author="brandon.williams" created="Thu, 9 Jan 2014 23:02:51 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12622232" name="6554.txt" size="2978" author="brandon.williams" created="Thu, 9 Jan 2014 18:52:30 +0000"/>
                            <attachment id="12621846" name="6554_trace_system.log" size="441690" author="mshuler" created="Tue, 7 Jan 2014 20:20:50 +0000"/>
                            <attachment id="12621854" name="6554_trace_system.node1.log" size="1013436" author="mshuler" created="Tue, 7 Jan 2014 21:01:01 +0000"/>
                            <attachment id="12621855" name="6554_trace_system.node2.log" size="761597" author="mshuler" created="Tue, 7 Jan 2014 21:01:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>366584</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 45 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1r6tj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>366895</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>thobbs</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>