<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:12:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-14915] Handle ant-optional dependency</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-14915</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13117&quot; title=&quot;Dump threads when unit test times out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13117&quot;&gt;&lt;del&gt;CASSANDRA-13117&lt;/del&gt;&lt;/a&gt; added a JUnit task which dumps threads on unit test timeout, and it depends on a class in &lt;tt&gt;org.apache.tools.ant.taskdefs.optional&lt;/tt&gt; which seems to not always be present depending on how &lt;tt&gt;ant&lt;/tt&gt; was installed. It can cause this error when building;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Throws: cassandra-trunk/build.xml:1134: taskdef A &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;needed by &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.krummas.junit.JStackJUnitTask cannot be found:
org/apache/tools/ant/taskdefs/optional/junit/JUnitTask  using the classloader
AntClassLoader[/.../cassandra-trunk/lib/jstackjunit-0.0.1.jar]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13201256">CASSANDRA-14915</key>
            <summary>Handle ant-optional dependency</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marcuse">Marcus Eriksson</assignee>
                                    <reporter username="marcuse">Marcus Eriksson</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Nov 2018 06:43:36 +0000</created>
                <updated>Fri, 15 May 2020 08:05:40 +0000</updated>
                            <resolved>Thu, 20 Dec 2018 12:48:52 +0000</resolved>
                                        <fixVersion>3.0.18</fixVersion>
                    <fixVersion>3.11.4</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Build</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16702815" author="krummas" created="Thu, 29 Nov 2018 07:46:06 +0000"  >&lt;p&gt;tested on Debian, Linux Mint and Fedora and with the ant 1.10 tarball, it fails only on Fedora, workaround for now is to &lt;tt&gt;yum install ant-optional&lt;/tt&gt;, but working on a patch to not fail the build if it is not available.&lt;/p&gt;</comment>
                            <comment id="16704412" author="krummas" created="Fri, 30 Nov 2018 08:39:05 +0000"  >&lt;p&gt;patch: &lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/junit&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/junit&lt;/a&gt;&lt;br/&gt;
tests: &lt;a href=&quot;https://circleci.com/workflow-run/85f433df-51f5-4b93-9c56-38788064041e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/workflow-run/85f433df-51f5-4b93-9c56-38788064041e&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;this will allow users to build cassandra without ant-optional&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmeredithco&quot; class=&quot;user-hover&quot; rel=&quot;jmeredithco&quot;&gt;jmeredithco&lt;/a&gt; do you have time to review? (you made some changes to build.xml lately so figured you would be a good candidate)&lt;/p&gt;</comment>
                            <comment id="16705028" author="jmeredithco" created="Fri, 30 Nov 2018 17:00:42 +0000"  >&lt;p&gt;I&apos;ve confirmed the patch allows you to get beyond the initial error in the description on Fedora 26 and complete an &lt;tt&gt;ant build&lt;/tt&gt;. However, it still requires ant-junit to be installed to get any of the test targets to complete (which are needed for &lt;tt&gt;jar&lt;/tt&gt;/&lt;tt&gt;package&lt;/tt&gt; targets).&lt;/p&gt;

&lt;p&gt;Is this what you were hoping to achieve, or did you also expect the unit tests to be able to run with just &lt;tt&gt;ant&lt;/tt&gt; and &lt;tt&gt;java-1.8.0-openjdk-devel&lt;/tt&gt; installed?&lt;/p&gt;

&lt;p&gt;An alternative would be to be more explicit about which dependencies are needed to build on Fedora in the docs.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16705065" author="krummas" created="Fri, 30 Nov 2018 17:40:46 +0000"  >&lt;p&gt;yeah we need to document that tests depend on ant-optional on fedora, I&apos;ll update the patch with that next week&lt;/p&gt;</comment>
                            <comment id="16705169" author="jmeredithco" created="Fri, 30 Nov 2018 18:53:55 +0000"  >&lt;p&gt;I think that class is always packaged up in&#160;the &lt;tt&gt;ant-junit&lt;/tt&gt; dependency, I grabbed the rpm and expanded it and checked the class is there.  I couldn&apos;t find an &lt;tt&gt;ant-optional&lt;/tt&gt; package that included it under the standard repos.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[jmeredith@localhost x]$ jar tvf ./usr/share/java/ant/ant-junit.jar | grep JUnitTask
1746 Wed Mar 01 08:56:26 MST 2017 org/apache/tools/ant/taskdefs/optional/junit/JUnitTask$1.class
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you always need to install &lt;tt&gt;ant-junit&lt;/tt&gt; on Fedora, does this patch still have value other than permitting the build task to succeed (and none of the test tasks)?&lt;/p&gt;</comment>
                            <comment id="16705226" author="jmeredithco" created="Fri, 30 Nov 2018 20:06:02 +0000"  >&lt;p&gt;I worked out you meant ant-optional on the Debian derived ones - agreed we&apos;ll just need document requiring ant-junit on Fedora et al, and will test the patch against a distro with ant-optional available too.&lt;/p&gt;</comment>
                            <comment id="16705252" author="krummas" created="Fri, 30 Nov 2018 20:38:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;I worked out you meant ant-optional&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ah sorry about that&lt;/p&gt;</comment>
                            <comment id="16705253" author="jmeredithco" created="Fri, 30 Nov 2018 20:41:03 +0000"  >&lt;p&gt;Gave Ubuntu 16.04 a go - if you don&apos;t have &lt;tt&gt;ant-optionals&lt;/tt&gt; installed the patch allows the &lt;tt&gt;ant build&lt;/tt&gt; command to succeed, however the tests still won&apos;t run without &lt;tt&gt;ant-optionals&lt;/tt&gt; installed as that contains the junit integration.&#160;&lt;/p&gt;

&lt;p&gt;Anyway, patch works as advertised (lowering the test timeout still triggers stack traces) - however I&apos;m not sure why somebody would want to run without ant-junit available.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16725012" author="krummas" created="Wed, 19 Dec 2018 13:52:11 +0000"  >&lt;p&gt;3.0 branch: &lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/14915-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/14915-3.0&lt;/a&gt;&lt;br/&gt;
3.0 test run: &lt;a href=&quot;https://circleci.com/workflow-run/6328c243-e81d-48cb-bb46-75920200d73e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/workflow-run/6328c243-e81d-48cb-bb46-75920200d73e&lt;/a&gt;&lt;br/&gt;
3.11 branch: &lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/14915-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/14915-3.11&lt;/a&gt;&lt;br/&gt;
3.11 test run: &lt;a href=&quot;https://circleci.com/workflow-run/eeed3f28-4230-48e7-8fc0-41db30df45da&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/workflow-run/eeed3f28-4230-48e7-8fc0-41db30df45da&lt;/a&gt;&lt;br/&gt;
trunk branch: &lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/14915-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/14915-trunk&lt;/a&gt;&lt;br/&gt;
trunk test run: &lt;a href=&quot;https://circleci.com/workflow-run/6ae5b998-caa5-41ff-b172-f74c9a266950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/workflow-run/6ae5b998-caa5-41ff-b172-f74c9a266950&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;note the documentation update on the trunk branch:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...krummas:marcuse/14915-trunk?expand=1#diff-1a8570f8bfa11221c5ea6eb81bf4f22eR55&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...krummas:marcuse/14915-trunk?expand=1#diff-1a8570f8bfa11221c5ea6eb81bf4f22eR55&lt;/a&gt;&lt;br/&gt;
I only added it to the trunk branch since we don&apos;t have any in-tree docs in the other branches, but users will most likely google the error and find this^&lt;/p&gt;</comment>
                            <comment id="16725089" author="jmeredithco" created="Wed, 19 Dec 2018 15:11:01 +0000"  >&lt;p&gt;Patches all look good. &#160;Does&#160;org.apache.cassandra.distributed.DistributedReadWritePathTest on trunk experience intermittent failures? I had a quick look but couldn&apos;t see much more than abnormal VM exit as the reason.&lt;/p&gt;</comment>
                            <comment id="16725101" author="krummas" created="Wed, 19 Dec 2018 15:25:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmeredithco&quot; class=&quot;user-hover&quot; rel=&quot;jmeredithco&quot;&gt;jmeredithco&lt;/a&gt; yeah I think it might be because I ran on the low resource circle config - there is &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-14922&quot; title=&quot;In JVM dtests need to clean up after instance shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-14922&quot;&gt;&lt;del&gt;CASSANDRA-14922&lt;/del&gt;&lt;/a&gt; which seems to be addressing those issues&lt;/p&gt;</comment>
                            <comment id="16725814" author="krummas" created="Thu, 20 Dec 2018 12:48:32 +0000"  >&lt;p&gt;and committed as &lt;tt&gt;23d722ee3a7b91bfe5ee6fe64d090ff247e80438&lt;/tt&gt;, thanks!&lt;/p&gt;

&lt;p&gt;of course I messed up the commit message and said ant-junit instead of ant-optional, the doc change should be correct though&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 47 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s00za8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jmeredithco</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jmeredithco]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>