<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:04:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-9507] range metrics are not updated for timeout and unavailable in StorageProxy</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-9507</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Looking at the code, it looks like range metrics are not updated for timeouts and unavailable. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12833633">CASSANDRA-9507</key>
            <summary>range metrics are not updated for timeout and unavailable in StorageProxy</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nachiket_patil">Nachiket Patil</assignee>
                                    <reporter username="kohlisankalp">Sankalp Kohli</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 May 2015 00:59:57 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:09 +0000</updated>
                            <resolved>Fri, 12 Aug 2016 13:56:27 +0000</resolved>
                                        <fixVersion>2.2.8</fixVersion>
                    <fixVersion>3.0.9</fixVersion>
                    <fixVersion>3.8</fixVersion>
                                    <component>Legacy/Observability</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15342085" author="blerer" created="Tue, 21 Jun 2016 16:20:50 +0000"  >&lt;p&gt;Thanks for the patch.&lt;/p&gt;

&lt;p&gt;It seems that range metrics are also not updated for &lt;tt&gt;failure&lt;/tt&gt;. Could you update your patch and provide one for 3.0 and trunk (the current one does not apply).&lt;/p&gt;

&lt;p&gt;I guessed that the patch was for 2.2 but it would be nice if you could specify the version next time.It simplify the review process.&lt;/p&gt;
</comment>
                            <comment id="15342618" author="nachiket_patil" created="Tue, 21 Jun 2016 20:37:36 +0000"  >&lt;p&gt;Thanks Benjamin for the feedback. I have attached new diffs one for v2.x and another for v 3.0 and trunk.&lt;/p&gt;</comment>
                            <comment id="15343937" author="blerer" created="Wed, 22 Jun 2016 08:52:33 +0000"  >&lt;p&gt;Thanks for the quick update.&lt;br/&gt;
It seems to me that patch for 3.x will not work.&lt;br/&gt;
&lt;tt&gt;RequestExecutionException&lt;/tt&gt; extends &lt;tt&gt;RuntimeException&lt;/tt&gt; which means that you cannot rely anymore on the method declaration to know which &lt;tt&gt;RequestExecutionExceptions&lt;/tt&gt; are thrown.&lt;br/&gt;
&lt;tt&gt;StorageProxy::getRangeSlice&lt;/tt&gt; do not throw those exceptions and they should be removed from the method signature. I believe that they are thrown by the returned &lt;tt&gt;RangeCommandIterator&lt;/tt&gt; but I just looked at &lt;tt&gt;UnavailableException&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Otherwise, your patch for 2.2 does not handle &lt;tt&gt;ReadFailureException&lt;/tt&gt; and the &lt;tt&gt;final&lt;/tt&gt; keywords in the &lt;tt&gt;catch&lt;/tt&gt; blocks can be removed.&lt;/p&gt;</comment>
                            <comment id="15385004" author="nachiket_patil" created="Tue, 19 Jul 2016 22:37:51 +0000"  >&lt;p&gt;New patches attached with changes accommodating feedback.&lt;/p&gt;</comment>
                            <comment id="15401901" author="ifesdjeen" created="Mon, 1 Aug 2016 11:42:47 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nachiket_patil&quot; class=&quot;user-hover&quot; rel=&quot;nachiket_patil&quot;&gt;nachiket_patil&lt;/a&gt;, you mentioned that new patches attached, although unfortunately I can still only see patches from 5 of July. I might be missing something. &lt;/p&gt;

&lt;p&gt;Since I could only look at those patches, I have one more comment in addition to what Benjamin has mentioned: do we want to report time as we do with other metircs with &lt;tt&gt;addNano&lt;/tt&gt; and time diff? &lt;/p&gt;

&lt;p&gt;As a sidenote, as far as I can say this issue does not qualify for &quot;critical&quot;, and according to the &lt;a href=&quot;https://mail-archives.apache.org/mod_mbox/cassandra-dev/201607.mbox/%3CCALdd-zjg%2Ba73VncPkU2rw_UpFPVsw0yNwO-yBqUQfK8H8FpiKw%40mail.gmail.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;discussion&lt;/a&gt; we probably should leave it out for 2.1.&lt;/p&gt;</comment>
                            <comment id="15402754" author="nachiket_patil" created="Mon, 1 Aug 2016 20:28:13 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt;, I had uploaded patches but didn&apos;t check if the status of the JIRA changed to Patch Available. The patches you are looking at are correct. &lt;br/&gt;
The Latency is added in the RangeCommandIterator::close() method which is for reading complete range.  Not sure we should be measuring individual read.&lt;br/&gt;
I agree this is not a critical patch. We are not patching only 2.1 branch with non-critical fixes right? We can still get this patch in 2.2, 3.0 - trunk.&lt;/p&gt;</comment>
                            <comment id="15403091" author="kohlisankalp" created="Tue, 2 Aug 2016 00:18:07 +0000"  >&lt;p&gt;This is not a critical fix so its fine to leave it out for 2.1 and 2.2...we are fine doing this in 3.0&lt;/p&gt;</comment>
                            <comment id="15403562" author="ifesdjeen" created="Tue, 2 Aug 2016 07:50:54 +0000"  >&lt;p&gt;Yes, I meant we should leave it out for &lt;tt&gt;2.1&lt;/tt&gt;. Sorry I forgot to mention the version number, added now.&lt;/p&gt;

&lt;p&gt;As regards the patch, I still can see Benjamin&apos;s comments there:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;final&lt;/tt&gt; keywords in &lt;tt&gt;catch&lt;/tt&gt; blocks in &lt;a href=&quot;https://github.com/ifesdjeen/cassandra/commit/4e6a45a0ffc11a8e0589fd4b48d9d3850ed535ab#diff-71f06c193f5b5e270cf8ac695164f43aR2066&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0 patch&lt;/a&gt; (btw, it merges clean to trunk) (if it was the only thing we could just fix it on commit)&lt;/li&gt;
	&lt;li&gt;exceptions thrown in &lt;tt&gt;StorageProxy::getRangeSlice&lt;/tt&gt; are &lt;a href=&quot;https://github.com/ifesdjeen/cassandra/blob/4e6a45a0ffc11a8e0589fd4b48d9d3850ed535ab/src/java/org/apache/cassandra/service/StorageProxy.java#L2165&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;still there&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt; has suggested to remove them since they&apos;re not thrown there. As he mentioned, for example, the &lt;tt&gt;UnavailableException&lt;/tt&gt; is thrown in &lt;tt&gt;RangeCommandIterator#query&lt;/tt&gt; (since it calls &lt;tt&gt;assureSufficientLiveNodes&lt;/tt&gt; originally and bubbled up. As far as I can say, they&apos;re thrown in a different way/different place in &lt;tt&gt;2.2&lt;/tt&gt;.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15408765" author="nachiket_patil" created="Fri, 5 Aug 2016 02:00:50 +0000"  >&lt;p&gt;I have removed 2.1 patch and attached new patches for other branches.&lt;/p&gt;</comment>
                            <comment id="15417342" author="ifesdjeen" created="Thu, 11 Aug 2016 14:37:51 +0000"  >&lt;p&gt;I&apos;m sorry it took me so long.&lt;/p&gt;

&lt;p&gt;+1 &lt;/p&gt;

&lt;p&gt;CI for reference: &lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ifesdjeen/cassandra/tree/9507-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-9507-2.2-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-9507-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ifesdjeen/cassandra/tree/9507-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-9507-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-9507-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ifesdjeen/cassandra/tree/9507-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-9507-trunk-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-9507-trunk-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15418857" author="blerer" created="Fri, 12 Aug 2016 13:54:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nachiket_patil&quot; class=&quot;user-hover&quot; rel=&quot;nachiket_patil&quot;&gt;nachiket_patil&lt;/a&gt; Thanks for the patch.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt; Thanks for taking over the review&lt;/p&gt;</comment>
                            <comment id="15418859" author="blerer" created="Fri, 12 Aug 2016 13:56:27 +0000"  >&lt;p&gt;Commited into 2.2 at e86d531ec2bf831a68d0bb448e5ed6ad623bbcf7 and merged into 3.0, 3.9 and trunk&lt;/p&gt;</comment>
                            <comment id="15418899" author="ifesdjeen" created="Fri, 12 Aug 2016 14:22:50 +0000"  >&lt;p&gt;Thanks! &lt;br/&gt;
Once again, sorry it took longer. I&apos;ve tried several different things, including bubbling exceptions from originating methods, but ended up leaving it out since they&apos;re unchecked anyways, would be impossible to force that.&lt;/p&gt;</comment>
                            <comment id="15419197" author="nachiket_patil" created="Fri, 12 Aug 2016 17:45:46 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt; for the reviews. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12822219" name="CASSANDRA-9507-2.2.diff" size="1199" author="nachiket_patil" created="Fri, 5 Aug 2016 01:36:36 +0000"/>
                            <attachment id="12822220" name="CASSANDRA-9507-3.0.diff" size="3585" author="nachiket_patil" created="Fri, 5 Aug 2016 01:36:36 +0000"/>
                            <attachment id="12822221" name="CASSANDRA-9507-trunk.diff" size="3585" author="nachiket_patil" created="Fri, 5 Aug 2016 01:36:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[nachiket_patil]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fcrz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ifesdjeen</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>