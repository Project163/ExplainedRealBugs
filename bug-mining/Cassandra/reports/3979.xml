<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:59:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10753] Fix completion problems breaking clqshlib tests</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10753</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;The recent changes in the python driver APIs have caused some completion problems as indicated by 2 of these failing tests:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/job/trunk_cqlshlib/579/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_cqlshlib/579/testReport/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The third failing test, &lt;tt&gt;test_timestamp_output&lt;/tt&gt;, has been failing for some time due to uncertainty on what to do regarding timezone conversion but it too can be changed to reflect the fact that we convert the timestamp to UTC.&lt;/p&gt;

&lt;p&gt;Finally, &lt;tt&gt;max_window_size_seconds&lt;/tt&gt; was recently added to the compaction properties and this caused 2 more tests to fail. It cannot be seen on Jenkins because of the relative import problem introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9304&quot; title=&quot;COPY TO improvements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9304&quot;&gt;&lt;del&gt;CASSANDRA-9304&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12915207">CASSANDRA-10753</key>
            <summary>Fix completion problems breaking clqshlib tests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="stefania">Stefania Alborghetti</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Nov 2015 02:05:55 +0000</created>
                <updated>Wed, 15 Oct 2025 09:49:06 +0000</updated>
                            <resolved>Tue, 1 Dec 2015 18:59:07 +0000</resolved>
                                        <fixVersion>2.2.4</fixVersion>
                    <fixVersion>3.0.1</fixVersion>
                    <fixVersion>3.1</fixVersion>
                                    <component>Legacy/Testing</component>
                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15021381" author="stefania" created="Mon, 23 Nov 2015 02:15:26 +0000"  >&lt;p&gt;I&apos;ve attached a 3.0 patch but it is based also on a fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9304&quot; title=&quot;COPY TO improvements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9304&quot;&gt;&lt;del&gt;CASSANDRA-9304&lt;/del&gt;&lt;/a&gt;, without which the cqlshlib tests do not run due to import problems. The patch applies to trunk without conflicts.&lt;/p&gt;

&lt;p&gt;Here are the dtests:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10753-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10753-3.0-dtest/&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10753-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10753-dtest/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; I think you did some related work can you take this ticket for review?&lt;/p&gt;</comment>
                            <comment id="15028923" author="pauloricardomg" created="Thu, 26 Nov 2015 14:49:28 +0000"  >&lt;p&gt;Looks good. Minor nits:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;In &lt;tt&gt;test_timestamp_output&lt;/tt&gt; since the &lt;tt&gt;TZ&lt;/tt&gt; property is ignored I guess we can just remove the second equals statement which is the same as the first. What do you think?&lt;/li&gt;
	&lt;li&gt;The &lt;tt&gt;max_window_size_seconds&lt;/tt&gt; problem is also affecting 2.2, could you provide a 2.2 patch? (It&apos;s not on jenkins but since we&apos;ll still maintain 2.2 for some time, I guess we should fix it).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;After that should be good to go. Thanks!&lt;/p&gt;</comment>
                            <comment id="15029366" author="stefania" created="Fri, 27 Nov 2015 03:01:23 +0000"  >&lt;p&gt;Thanks for your review:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;In test_timestamp_output since the TZ property is ignored I guess we can just remove the second equals statement which is the same as the first. What do you think?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agreed, removed.    &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The max_window_size_seconds problem is also affecting 2.2, could you provide a 2.2 patch? (It&apos;s not on jenkins but since we&apos;ll still maintain 2.2 for some time, I guess we should fix it).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;To fix 2.2 I think we need the entire patch since according to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aholmber&quot; class=&quot;user-hover&quot; rel=&quot;aholmber&quot;&gt;aholmber&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9302?focusedCommentId=15027191&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15027191&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;comment&lt;/a&gt; on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9302&quot; title=&quot;Optimize cqlsh COPY FROM, part 3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9302&quot;&gt;&lt;del&gt;CASSANDRA-9302&lt;/del&gt;&lt;/a&gt; we should be running the current driver. So I backported the entire patch to 2.2 (via cherry-pick of individual commits) and then upgraded the bundled driver to the same as 3.0. By the way, do you know which version it is? I could not even find commit &lt;tt&gt;3f15725&lt;/tt&gt; on any branch in the driver repository. Shouldn&apos;t we upgrade to a later and more official version instead?&lt;/p&gt;

&lt;p&gt;I also started noticing some timeout failures in the cqlshlib tests, on all branches, when dropping keyspaces. I did not notice them before and I think it&apos;s because I just migrated to a loan laptop where I installed Linux on an hybrid HDD rather than SSD. It takes a crazy long time to flush all tables before the final KEYSPACE DROPPED notification is sent to the driver. For 2.2 I needed at least 20 seconds but for 3.0+ it took up to 35 seconds so I increased the timeout to 45 seconds in 3.0+. Do you think this is normal?&lt;/p&gt;

&lt;p&gt;Here are the patches and CI, but CASSCI is currently down so I cannot start any jobs:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/10753-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/10753-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/10753&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10753-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10753-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10753-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I verified the cqlshlib tests pass locally on all branches &lt;em&gt;provided the driver version installed is the same as the bundled version&lt;/em&gt;. With 3.0rc1 installed, &lt;tt&gt;TestCqlshCompletion.test_complete_in_delete&lt;/tt&gt; failed the completion of a clustering key in the where clause. I did not look further into this, we need to confirm the correct driver version first.&lt;/p&gt;

&lt;p&gt;I&apos;ll start the dtests as soon as CASSCI is back.&lt;/p&gt;</comment>
                            <comment id="15029749" author="stefania" created="Fri, 27 Nov 2015 10:30:20 +0000"  >&lt;p&gt;I managed to launch the jobs once but there was an issue on 2.2 (should be fixed now) and an unrelated failure on 3.0. We should restart &lt;tt&gt;stef1927-10753-2.2-dtest&lt;/tt&gt; and &lt;tt&gt;stef1927-10753-3.0-dtest&lt;/tt&gt; but cassci is not responding right now.&lt;/p&gt;</comment>
                            <comment id="15030001" author="pauloricardomg" created="Fri, 27 Nov 2015 15:46:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;By the way, do you know which version it is? I could not even find commit 3f15725 on any branch in the driver repository. Shouldn&apos;t we upgrade to a later and more official version instead?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think this was a custom build before c5354507aab471bd9f9f017138302693ea9e48ed was merged into master. I guess we should be safe to update to the released 3.0.0 tag. There are some &lt;a href=&quot;https://github.com/datastax/python-driver/blob/master/README-dev.rst#packaging-for-cassandra&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;instructions here&lt;/a&gt; here for creating the artifact.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I also started noticing some timeout failures in the cqlshlib tests, on all branches, when dropping keyspaces. Do you think this is normal?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s strange, it shouldn&apos;t take that long with such a small amount of data even on HDDs IMO. Maybe it&apos;s a ccm problem? &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8816&quot; title=&quot;Dropping Keyspace too slow on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8816&quot;&gt;&lt;del&gt;CASSANDRA-8816&lt;/del&gt;&lt;/a&gt; reported slowness on keyspace drop on Windows, so maybe you could run those tests and check if they&apos;re failing in your machine? Is it possible to enable tracing on drop keyspace statements? It would may be nice see what&apos;s making it so slow.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I&apos;ll start the dtests as soon as CASSCI is back.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Seems cassci is still not back, so we can restart it after it&apos;s back.&lt;/p&gt;</comment>
                            <comment id="15030277" author="pauloricardomg" created="Fri, 27 Nov 2015 22:26:54 +0000"  >&lt;p&gt;Submitted cassci runs for &lt;tt&gt;stef1927-10753-2.2-dtest&lt;/tt&gt; and &lt;tt&gt;stef1927-10753-3.0-dtest&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15030805" author="stefania" created="Sun, 29 Nov 2015 05:35:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;I guess we should be safe to update to the released 3.0.0 tag.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;OK. There was a little bit of work to do because &lt;tt&gt;ColumnMetadata&lt;/tt&gt; no longer has a property called &lt;tt&gt;index&lt;/tt&gt;. I still have some cqlshlib IO errors on trunk that I haven&apos;t had time to investigate. I will resume mid next week.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;That&apos;s strange, it shouldn&apos;t take that long with such a small amount of data even on HDDs IMO. Maybe it&apos;s a ccm problem? &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8816&quot; title=&quot;Dropping Keyspace too slow on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8816&quot;&gt;&lt;del&gt;CASSANDRA-8816&lt;/del&gt;&lt;/a&gt; reported slowness on keyspace drop on Windows, so maybe you could run those tests and check if they&apos;re failing in your machine? Is it possible to enable tracing on drop keyspace statements? It would may be nice see what&apos;s making it so slow.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s not a ccm problem because I am not using it; I&apos;m using a simple &lt;tt&gt;cassandra -f&lt;/tt&gt;. I cannot reproduce the failures of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8816&quot; title=&quot;Dropping Keyspace too slow on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8816&quot;&gt;&lt;del&gt;CASSANDRA-8816&lt;/del&gt;&lt;/a&gt;. From what I could see so far, the driver notifications were sent after several flush operations. I will add more trace messages and investigate next week. For now I&apos;ve left the time-out to 20 seconds on all branches.&lt;/p&gt;

&lt;p&gt;CI resubmitted on 2.2, 3.0 and trunk.&lt;/p&gt;</comment>
                            <comment id="15031239" author="stefania" created="Mon, 30 Nov 2015 02:03:12 +0000"  >&lt;blockquote&gt;&lt;p&gt;I still have some cqlshlib IO errors on trunk that I haven&apos;t had time to investigate.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;These were just problems introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7225&quot; title=&quot;show CQL help in cqlsh in web browser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7225&quot;&gt;&lt;del&gt;CASSANDRA-7225&lt;/del&gt;&lt;/a&gt;, where a patch is already available but not yet committed. I&apos;ve rebased all patches to just before the 7225 commit to exclude these issues.&lt;/p&gt;

&lt;p&gt;The timeouts when dropping keyspaces have also disappeared. The tests themselves seem to run faster. My best guess is a chance in the driver.&lt;/p&gt;

&lt;p&gt;All cqlshlib tests are clean on all branches now, at least locally on my box.&lt;/p&gt;

&lt;p&gt;CI resubmitted and pending.&lt;/p&gt;</comment>
                            <comment id="15031357" author="stefania" created="Mon, 30 Nov 2015 05:59:02 +0000"  >&lt;p&gt;CI has completed and it looks OK.&lt;/p&gt;</comment>
                            <comment id="15032349" author="pauloricardomg" created="Mon, 30 Nov 2015 19:54:38 +0000"  >&lt;p&gt;LGTM, marking as &quot;ready to commit!. Thanks!&lt;/p&gt;</comment>
                            <comment id="15034363" author="jmckenzie" created="Tue, 1 Dec 2015 18:59:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=cassandra.git;a=commit;h=1b81ad19d33710bfa1724262f76cd3cd8114b162&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Committed&lt;/a&gt; and merged up.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12827319">CASSANDRA-9304</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2orl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>pauloricardomg</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>