<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:20:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-16682] Cassandra 4.0 RC1 ... Audit Logs going to wrong location</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-16682</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Version : Cassandra 4.0 RC1&lt;/p&gt;

&lt;p&gt;Settings in my : &amp;lt;CASSANDRA_HOME&amp;gt;/conf/cassandra.yaml&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-yaml&quot;&gt;
audit_logging_&lt;span class=&quot;code-keyword&quot;&gt;options: &lt;/span&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;enabled: &lt;/span&gt;true
     &lt;span class=&quot;code-keyword&quot;&gt;logger: &lt;/span&gt;
      - class_&lt;span class=&quot;code-keyword&quot;&gt;name: &lt;/span&gt;FileAuditLogger
     excluded_&lt;span class=&quot;code-keyword&quot;&gt;categories: &lt;/span&gt;QUERY, DML
     audit_logs_&lt;span class=&quot;code-keyword&quot;&gt;dir: &lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;/apps/opt/cassandra/logs/audit&quot;&lt;/span&gt;
     roll_&lt;span class=&quot;code-keyword&quot;&gt;cycle: &lt;/span&gt;DAILY
     &lt;span class=&quot;code-keyword&quot;&gt;block: &lt;/span&gt;false
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;After restart of Cassandra ... I can see the Audit Logs. But they are going into system.log and debug.log. They are NOT going into&#160;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&quot;/apps/opt/cassandra/logs/audit/audit.log&quot;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Also noticed that : it does not ignore the &quot;excluded_categories&quot; and logs everything ...&lt;/p&gt;</description>
                <environment></environment>
        <key id="13379485">CASSANDRA-16682</key>
            <summary>Cassandra 4.0 RC1 ... Audit Logs going to wrong location</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="edimitrova">Ekaterina Dimitrova</assignee>
                                    <reporter username="oramad">Sarma Pydipally</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 May 2021 10:29:21 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:54 +0000</updated>
                            <resolved>Fri, 21 May 2021 19:01:08 +0000</resolved>
                                        <fixVersion>4.0-rc2</fixVersion>
                    <fixVersion>4.0</fixVersion>
                    <fixVersion>4.1-alpha1</fixVersion>
                    <fixVersion>4.1</fixVersion>
                                    <component>Tool/auditlogging</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17348525" author="oramad" created="Thu, 20 May 2021 13:27:27 +0000"  >&lt;p&gt;also noticed that : it does not ignore the &quot;excluded_categories&quot; and logs everything ...&lt;/p&gt;</comment>
                            <comment id="17348541" author="edimitrova" created="Thu, 20 May 2021 14:04:24 +0000"  >&lt;p&gt;Hi&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=oramad&quot; class=&quot;user-hover&quot; rel=&quot;oramad&quot;&gt;oramad&lt;/a&gt;, thank you for the report and the ticket, really appreciate it!&lt;/p&gt;

&lt;p&gt;I will look into this today. In the meanwhile - you use the default cassandra.yaml config? Or if you come up with any other specifics you might want to share, &#160;that will be appreciated. Thanks again&lt;/p&gt;</comment>
                            <comment id="17348562" author="oramad" created="Thu, 20 May 2021 14:31:46 +0000"  >&lt;p&gt;Settings in my : &amp;lt;CASSANDRA_HOME&amp;gt;/conf/cassandra.yaml&lt;/p&gt;

&lt;p&gt;audit_logging_options:&lt;br/&gt;
&#160; &#160; enabled: true&lt;br/&gt;
 &#160; &#160; &#160;logger:&lt;br/&gt;
&#160; &#160; &#160; - class_name: FileAuditLogger&lt;br/&gt;
 &#160; &#160; &#160;excluded_categories: QUERY, DML&lt;br/&gt;
&#160; &#160; &#160;audit_logs_dir: &quot;/apps/opt/cassandra/logs/audit&quot;&lt;br/&gt;
&#160; &#160; &#160;roll_cycle: DAILY&lt;br/&gt;
&#160; &#160; &#160;block: false&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17348705" author="edimitrova" created="Thu, 20 May 2021 19:26:28 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=oramad&quot; class=&quot;user-hover&quot; rel=&quot;oramad&quot;&gt;oramad&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I think you might be missing to follow this instruction maybe:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cassandra.apache.org/doc/latest/operating/audit_logging.html?highlight=audit%20logging#configuring-fileauditlogger&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cassandra.apache.org/doc/latest/operating/audit_logging.html?highlight=audit%20logging#configuring-fileauditlogger&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After I made this addition to my logback.xml, everything worked as expected, logging to audit.log. Can you, please, verify this?&lt;/p&gt;

&lt;p&gt;In the meanwhile I am looking at the other issue about ignoring&#160;the &quot;excluded_categories&quot;.&lt;/p&gt;</comment>
                            <comment id="17348789" author="oramad" created="Thu, 20 May 2021 20:39:56 +0000"  >&lt;p&gt;OK. After modifying my logback.xml it is working.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;audit is now going into audit.log&lt;/li&gt;
	&lt;li&gt;documentation has provided sample entry for audit into logback.xml &#8212; however documentation has no mention where to add it ... by looking at formatting of that xml i know it is logback.xml file ... others might not know.&lt;/li&gt;
	&lt;li&gt;Cassandra 4.x software itself should ship with default logback.xml with these required entries ... it does not harm to have the logback.xml entries ... since auditing is enabled or disabled via cassandra.yaml&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;It is still not honoring my request to &quot;excluded_categories: QUERY, DML&quot; and still recording everything.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17348796" author="oramad" created="Thu, 20 May 2021 20:56:23 +0000"  >&lt;p&gt;I might have identified the issue with&#160;excluded_categories ... please give me some time ... i will provide update.&lt;/p&gt;</comment>
                            <comment id="17348797" author="edimitrova" created="Thu, 20 May 2021 20:56:53 +0000"  >&lt;p&gt;Thank you for confirming!&lt;/p&gt;

&lt;p&gt;All valid points and on my list already. Looking to fix the issue and improve docs and logback.xml.&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="17348833" author="oramad" created="Thu, 20 May 2021 23:07:21 +0000"  >&lt;p&gt;$ cat ~/conf/cassandra.yaml | grep excluded_categories&lt;/p&gt;

&lt;p&gt;&#8211; bad settings : only uses first entry and ignores other values after first space&lt;br/&gt;
 excluded_categories: OTHER, QUERY, DDL&lt;br/&gt;
 excluded_categories: &quot;OTHER, QUERY, DDL&quot;&lt;/p&gt;

&lt;p&gt;&#8211; correct setting : string_comma_separated_without_spaces&lt;br/&gt;
 excluded_categories: OTHER,DML,DDL&lt;br/&gt;
 $&lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
 MY TEST RESULTS :&lt;br/&gt;
 excluded_categories: QUERY,DML&lt;br/&gt;
 Duration : 90 minutes&lt;br/&gt;
 Various # Transactions : 80,000&lt;/p&gt;

&lt;p&gt;following type of audit logs are recorded :&lt;br/&gt;
 type:LOGIN_ERROR|category:AUTH&lt;br/&gt;
 type:LOGIN_SUCCESS|category:AUTH&lt;br/&gt;
 type:PREPARE_STATEMENT|category:PREPARE&lt;br/&gt;
 type:USE_KEYSPACE|category:OTHER&lt;/p&gt;

&lt;p&gt;NO QUERIES AND DMLS in the audit.log&lt;/p&gt;

&lt;p&gt;TEST RESULT : SUCCESSFUL&lt;br/&gt;
 ----------------------------&lt;/p&gt;</comment>
                            <comment id="17348834" author="oramad" created="Thu, 20 May 2021 23:08:28 +0000"  >&lt;p&gt;I think this ticket can be CLOSED.&lt;/p&gt;</comment>
                            <comment id="17348836" author="edimitrova" created="Thu, 20 May 2021 23:32:53 +0000"  >&lt;p&gt;I confirm I didn&apos;t find any other issue with the &lt;em&gt;AuditLogFilter&lt;/em&gt;. We also have a unit test for that one.&#160;&lt;/p&gt;

&lt;p&gt;I will use this ticket to improve the docs and logback.xml tomorrow. Thank you!&#160;&lt;/p&gt;</comment>
                            <comment id="17349383" author="edimitrova" created="Fri, 21 May 2021 17:07:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/5c4f035e611c448ed6e2afa49c7b9c60ec2feb48&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Patch &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=oramad&quot; class=&quot;user-hover&quot; rel=&quot;oramad&quot;&gt;oramad&lt;/a&gt;, do you mind to review it if you have a bit of time, please? Your feedback is really valuable.&lt;/p&gt;

&lt;p&gt;In any case we will need one more committer to review it. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;, will anyone of you have a bit of time to check it, please?&lt;/p&gt;

&lt;p&gt;Thank you in advance.&lt;/p&gt;</comment>
                            <comment id="17349387" author="brandon.williams" created="Fri, 21 May 2021 17:13:30 +0000"  >&lt;p&gt;LGTM, with one super-duper-ultra-nit: &quot;time stamp&quot; could be &quot;timestamp&quot;&lt;/p&gt;</comment>
                            <comment id="17349397" author="oramad" created="Fri, 21 May 2021 17:23:15 +0000"  >&lt;p&gt;thinking ....&lt;/p&gt;

&lt;p&gt;in default &quot;logback.xml&quot; ... do we need to keep the new default entries for audit logging in COMMENTED OUT mode ?&lt;/p&gt;

&lt;p&gt;can we leave it in there WITHOUT commenting it out ? because on/off switch is somewhere else &quot;cassandra.yaml&#160; : audit_logging_options :&#160;enabled: true/false&quot; + it will require &quot;logger : class_name: FileAuditLogger&quot;.&lt;/p&gt;</comment>
                            <comment id="17349398" author="oramad" created="Fri, 21 May 2021 17:23:41 +0000"  >&lt;p&gt;BTW ... rest of changes looking good.&lt;/p&gt;</comment>
                            <comment id="17349411" author="edimitrova" created="Fri, 21 May 2021 17:44:27 +0000"  >&lt;p&gt;Thank you both for the quick reviews.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;can we leave it in there WITHOUT commenting it out ? because on/off switch is somewhere else &quot;cassandra.yaml&#160; : audit_logging_options :&#160;enabled: true/false&quot; + it will require &quot;logger : class_name: FileAuditLogger&quot;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I thought about it, but this will be a change to the original default behavior which is as per design for audit logs to be directed to system logs and separated only on user decision (by adding the config in logback.xml). I am not sure we should change it now before the release.&#160;&lt;/p&gt;</comment>
                            <comment id="17349420" author="oramad" created="Fri, 21 May 2021 18:03:25 +0000"  >&lt;p&gt;got it ... i was not aware of the original design and decisions.&lt;/p&gt;

&lt;p&gt;we should not introduce new flow before the major release.&lt;/p&gt;

&lt;p&gt;please leave the new entries in logback.xml in COMMENTED OUT section.&lt;/p&gt;</comment>
                            <comment id="17349445" author="edimitrova" created="Fri, 21 May 2021 19:00:21 +0000"  >&lt;p&gt;Thank you both, the patch was committed to 4.0 and trunk. I also checked locally the doc build. I took care of the&#160; super-duper-ultra-nit on commit &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[edimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0r7kw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
        <customfieldvalue><![CDATA[oramad]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12349532">4.0-rc1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/658f3e11a66aca7333157a9b20bf7189005329cf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/658f3e11a66aca7333157a9b20bf7189005329cf&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16682?focusedCommentId=17349383&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17349383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-16682?focusedCommentId=17349383&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17349383&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>