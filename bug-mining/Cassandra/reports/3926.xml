<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:59:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10650] Store UDA initcond as CQL literal in the schema table, instead of a blob</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10650</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10365&quot; title=&quot;Store types by their CQL names in schema tables instead of fully-qualified internal class names&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10365&quot;&gt;&lt;del&gt;CASSANDRA-10365&lt;/del&gt;&lt;/a&gt; changed UDA&apos;s &lt;em&gt;initcond&lt;/em&gt; type to text. That required &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10617&quot; title=&quot;Provide functionality to create CQL term from bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10617&quot;&gt;&lt;del&gt;CASSANDRA-10617&lt;/del&gt;&lt;/a&gt; to be able to transform the serialized data to a valid CQL3 literal.&lt;/p&gt;

&lt;p&gt;This ticket is about to fix the &lt;em&gt;initcond&lt;/em&gt; thing broken in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10365&quot; title=&quot;Store types by their CQL names in schema tables instead of fully-qualified internal class names&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10365&quot;&gt;&lt;del&gt;CASSANDRA-10365&lt;/del&gt;&lt;/a&gt; after &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10617&quot; title=&quot;Provide functionality to create CQL term from bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10617&quot;&gt;&lt;del&gt;CASSANDRA-10617&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12910343">CASSANDRA-10650</key>
            <summary>Store UDA initcond as CQL literal in the schema table, instead of a blob</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="snazy">Robert Stupp</assignee>
                                    <reporter username="snazy">Robert Stupp</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Nov 2015 13:21:50 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:51 +0000</updated>
                            <resolved>Fri, 6 Nov 2015 17:31:16 +0000</resolved>
                                        <fixVersion>3.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14989796" author="snazy" created="Wed, 4 Nov 2015 16:05:33 +0000"  >&lt;p&gt;/cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adutra&quot; class=&quot;user-hover&quot; rel=&quot;adutra&quot;&gt;adutra&lt;/a&gt; : This is the ticket that will actually change the type of &lt;em&gt;initcond&lt;/em&gt; in the schema table for aggregates&lt;/p&gt;</comment>
                            <comment id="14989867" author="andrew.tolbert" created="Wed, 4 Nov 2015 16:43:12 +0000"  >&lt;p&gt;This change can be somewhat breaking/loss of functionality since not all of the drivers have the capability to parse a text in their deserializers to the expected types, but they all have and need the capability to parse bytes.   The java driver does have this capability, but the nodejs driver doesn&apos;t for example.   Implementing a &lt;tt&gt;cqltype.decode(text) -&amp;gt; instanceoflangtype&lt;/tt&gt; in each driver for this would be a non-trivial amount of work just to support properly parsing initcond.  In the nodejs driver we are currently opting to have &apos;initcond&apos; in our metadata classes to return a text, but it would be nice if we could return the actual type (as it did previously).   Could we have 2 separate columns (initcond and initcond_literal like you mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10365&quot; title=&quot;Store types by their CQL names in schema tables instead of fully-qualified internal class names&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10365&quot;&gt;&lt;del&gt;CASSANDRA-10365&lt;/del&gt;&lt;/a&gt;) for this?&lt;/p&gt;</comment>
                            <comment id="14989871" author="iamaleksey" created="Wed, 4 Nov 2015 16:46:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.tolbert&quot; class=&quot;user-hover&quot; rel=&quot;andrew.tolbert&quot;&gt;andrew.tolbert&lt;/a&gt; And why exactly does it matter at all? The drivers aren&apos;t supposed to be working with that value directly - only when recreating DESCRIBE output.&lt;/p&gt;</comment>
                            <comment id="14989892" author="andrew.tolbert" created="Wed, 4 Nov 2015 16:53:35 +0000"  >&lt;p&gt;It doesn&apos;t matter too much, we had already made the change to accommodate this in the nodejs driver, if user retrieves a UDAs metadata using the drivers API the initcond field is now a string rather then the associated type.  Previously were were able to grok the type and properly parse so it seems like a loss of functionality, even if minor.&lt;/p&gt;</comment>
                            <comment id="14989898" author="snazy" created="Wed, 4 Nov 2015 16:55:15 +0000"  >&lt;p&gt;Also: byte representation&apos;s major disadvantage is that it depends on the &lt;b&gt;latest&lt;/b&gt; native protocol version used by the node a driver&apos;s currently querying the schema from. I.e. in the future it would add more burden to the drivers when the serialized representation changes - up to the probable situation that an (older) driver version is not able to use the byte representation of a (newer) C* version correctly.&lt;/p&gt;</comment>
                            <comment id="14989901" author="iamaleksey" created="Wed, 4 Nov 2015 16:56:10 +0000"  >&lt;p&gt;Got it. Honestly, I really believe that losing that minor bit of functionality is fine, it&apos;s better than adding extra complication to server&apos;s schema handling code. Protocol version-dependency is not something I want to have there.&lt;/p&gt;</comment>
                            <comment id="14989975" author="andrew.tolbert" created="Wed, 4 Nov 2015 17:25:41 +0000"  >&lt;p&gt;Sounds good, I think it&apos;s ok to not have the byte representation, but just wanted to indicate the (very) minor loss of functionality.   There really isn&apos;t much of a use case that I can think of right now on the client side for parsing this other than for describe output / recreating the cql schema.&lt;/p&gt;</comment>
                            <comment id="14990170" author="aholmber" created="Wed, 4 Nov 2015 18:53:35 +0000"  >&lt;p&gt;Python driver integration tests run cleanly against Robert&apos;s latest @ ec655f38&lt;/p&gt;</comment>
                            <comment id="14991437" author="adutra" created="Thu, 5 Nov 2015 10:00:27 +0000"  >&lt;p&gt;Updated Java driver &lt;a href=&quot;https://github.com/datastax/java-driver/pull/467&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. Note that the driver doesn&apos;t depend anymore on jgrapht.&lt;/p&gt;</comment>
                            <comment id="14993991" author="iamaleksey" created="Fri, 6 Nov 2015 17:07:39 +0000"  >&lt;p&gt;Not a fan of naming (throughout). &lt;tt&gt;buildCQLLiteral&lt;/tt&gt; should not be calling &lt;tt&gt;validate&lt;/tt&gt;. Or handling &lt;tt&gt;null&lt;/tt&gt; at all. &lt;tt&gt;Collection&lt;/tt&gt;&apos;s &lt;tt&gt;buildCQLLiteral()&lt;/tt&gt; probably handles some redundant cases.&lt;/p&gt;

&lt;p&gt;I&apos;ve started changing some things, but went (a bit) too deep. Truth is, this will do, and we can polish it later, after 3.0.0 is out, in a separate ticket.&lt;/p&gt;

&lt;p&gt;Ship it.&lt;/p&gt;</comment>
                            <comment id="14994044" author="snazy" created="Fri, 6 Nov 2015 17:31:16 +0000"  >&lt;p&gt;Thanks!&lt;br/&gt;
Committed as e94032a2346ac07b4d2c0d2e4de6d88b16da05d2 to 3.0.&lt;br/&gt;
As discussed on IRC:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;renamed &lt;tt&gt;buildCQLLiteral&lt;/tt&gt; to &lt;tt&gt;toCQLLiteral&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;removed superfluous calls to &lt;tt&gt;validate()&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310060">
                    <name>Container</name>
                                            <outwardlinks description="contains">
                                        <issuelink>
            <issuekey id="12908728">CASSANDRA-10617</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12913729">CASSANDRA-10721</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[snazy]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2nxtj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aleksey</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>