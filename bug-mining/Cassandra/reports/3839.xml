<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:58:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10369] cqlsh prompt includes name of keyspace after failed `use` statement</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10369</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I found this while addressing &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10289&quot; title=&quot;Fix cqlshlib tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10289&quot;&gt;&lt;del&gt;CASSANDRA-10289&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In cqlsh, if the user enters &lt;tt&gt;USE ks&lt;/tt&gt;, but there is no keyspace named &lt;tt&gt;ks&lt;/tt&gt;, the prompt will read &lt;tt&gt;cqlsh:ks&amp;gt;&lt;/tt&gt;. It should just read &lt;tt&gt;cqlsh&amp;gt;&lt;/tt&gt;, since the underlying session did not actually switch to use &lt;tt&gt;ks&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;I believe the bug is in cqlsh and not, e.g., the driver, because the statement, as expected, raises an &lt;tt&gt;InvalidRequest&lt;/tt&gt; error.&lt;/p&gt;

&lt;p&gt;The behavior shows in a test in the cqlshlib nosetests here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/blob/03f556ffa8718754fe4eb329af2002d83ffc7147/pylib/cqlshlib/test/test_cqlsh_output.py#L545&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/03f556ffa8718754fe4eb329af2002d83ffc7147/pylib/cqlshlib/test/test_cqlsh_output.py#L545&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;An example failure on CassCI is here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/job/scratch_mambocab-fix_cqlsh/11/testReport/cqlshlib.test.test_cqlsh_output/TestCqlshOutput/test_prompt/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/scratch_mambocab-fix_cqlsh/11/testReport/cqlshlib.test.test_cqlsh_output/TestCqlshOutput/test_prompt/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can also reproduce it trivially in ccm, or however you choose to run clusters locally:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ccm create cqlsh -v git:trunk -n 1 ; ccm start --wait-&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;-binary-proto ; ccm node1 cqlsh
http:&lt;span class=&quot;code-comment&quot;&gt;//git-wip-us.apache.org/repos/asf/cassandra.git git:trunk
&lt;/span&gt;Fetching Cassandra updates...
Current cluster is now: cqlsh
Connected to cqlsh at 127.0.0.1:9042.
[cqlsh 5.0.1 | Cassandra 3.0.0-beta2-SNAPSHOT | CQL spec 3.3.1 | Native protocol v4]
Use HELP &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; help.
cqlsh&amp;gt; use nonexistentkeyspace;
InvalidRequest: code=2200 [Invalid query] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;Keyspace &lt;span class=&quot;code-quote&quot;&gt;&apos;nonexistentkeyspace&apos;&lt;/span&gt; does not exist&quot;&lt;/span&gt;
cqlsh:nonexistentkeyspace&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That last line should read &lt;tt&gt;cqlsh&amp;gt;&lt;/tt&gt; instead.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12875682">CASSANDRA-10369</key>
            <summary>cqlsh prompt includes name of keyspace after failed `use` statement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="snazy">Robert Stupp</assignee>
                                    <reporter username="mambocab">Jim Witschey</reporter>
                        <labels>
                            <label>cqlsh</label>
                    </labels>
                <created>Thu, 17 Sep 2015 21:10:28 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:55 +0000</updated>
                            <resolved>Tue, 29 Sep 2015 11:26:13 +0000</resolved>
                                        <fixVersion>2.2.2</fixVersion>
                    <fixVersion>3.0.0 rc2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14877219" author="snazy" created="Sat, 19 Sep 2015 17:28:25 +0000"  >&lt;p&gt;2.2 is also affected; 2.1 is fine.&lt;/p&gt;

&lt;p&gt;The fix is trivial.&lt;/p&gt;</comment>
                            <comment id="14900727" author="snazy" created="Mon, 21 Sep 2015 14:01:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mambocab&quot; class=&quot;user-hover&quot; rel=&quot;mambocab&quot;&gt;mambocab&lt;/a&gt;,wanna review?&lt;/p&gt;</comment>
                            <comment id="14900792" author="iamaleksey" created="Mon, 21 Sep 2015 15:05:14 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14903338" author="mambocab" created="Tue, 22 Sep 2015 20:00:28 +0000"  >&lt;p&gt;Works on my machine; +1. Thanks!&lt;/p&gt;</comment>
                            <comment id="14934936" author="slebresne" created="Tue, 29 Sep 2015 09:56:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snazy&quot; class=&quot;user-hover&quot; rel=&quot;snazy&quot;&gt;snazy&lt;/a&gt; mentions above that this affects 2.2 but the fix version doesn&apos;t seem to agree. Which one is it?&lt;/p&gt;</comment>
                            <comment id="14935009" author="snazy" created="Tue, 29 Sep 2015 11:18:08 +0000"  >&lt;p&gt;It&apos;s 2.2.x&lt;/p&gt;</comment>
                            <comment id="14935018" author="snazy" created="Tue, 29 Sep 2015 11:26:13 +0000"  >&lt;p&gt;Committed as 13b4bb41c7e35502ae36e4ec77252c5ec9a9945b&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[snazy]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 8 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2kcwv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12332541">3.0.x</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aleksey</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>