<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:49:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-7563] UserType, TupleType and collections in UDFs</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-7563</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;ul&gt;
	&lt;li&gt;is Java Driver as a dependency required ?&lt;/li&gt;
	&lt;li&gt;is it possible to extract parts of the Java Driver for UDT/TT/coll support ?&lt;/li&gt;
	&lt;li&gt;CQL &lt;tt&gt;DROP TYPE&lt;/tt&gt; must check UDFs&lt;/li&gt;
	&lt;li&gt;must check keyspace access permissions (if those exist)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12727897">CASSANDRA-7563</key>
            <summary>UserType, TupleType and collections in UDFs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="snazy">Robert Stupp</assignee>
                                    <reporter username="snazy">Robert Stupp</reporter>
                        <labels>
                            <label>cql</label>
                            <label>udf</label>
                    </labels>
                <created>Thu, 17 Jul 2014 10:55:50 +0000</created>
                <updated>Wed, 6 Nov 2019 21:58:23 +0000</updated>
                            <resolved>Wed, 26 Nov 2014 23:51:27 +0000</resolved>
                                        <fixVersion>2.2.0 beta 1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14084624" author="slebresne" created="Mon, 4 Aug 2014 13:04:58 +0000"  >&lt;p&gt;I&apos;m going to mark that a &quot;bug&quot; to emphasis that while I won&apos;t mind it too much if this is a separated commit of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7395&quot; title=&quot;Support for pure user-defined functions (UDF)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7395&quot;&gt;&lt;del&gt;CASSANDRA-7395&lt;/del&gt;&lt;/a&gt;, I think we should &lt;b&gt;not&lt;/b&gt; release &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7395&quot; title=&quot;Support for pure user-defined functions (UDF)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7395&quot;&gt;&lt;del&gt;CASSANDRA-7395&lt;/del&gt;&lt;/a&gt; until we have this.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;is it possible to extract parts of the Java Driver for UDT/TT/coll support ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We currently already include the java driver for hadoop and for stress so I wouldn&apos;t worry about that here. I&apos;m happy to work on splitting the relevant part in the driver into a separate jar if this ever become a problem but It probably won&apos;t be one and is definitively not one today.&lt;/p&gt;</comment>
                            <comment id="14091869" author="snazy" created="Sat, 9 Aug 2014 19:25:02 +0000"  >&lt;p&gt;Shall we delay this ticket until Java Driver 2.1.0 GA is out, used in C* 2.1.x and merged into trunk ?&lt;/p&gt;</comment>
                            <comment id="14092535" author="slebresne" created="Mon, 11 Aug 2014 07:45:58 +0000"  >&lt;p&gt;There&apos;s no reason to. The driver 2.1 will definitively be GA by the time 3.0 is out so if we need it here, let&apos;s just add it.&lt;/p&gt;</comment>
                            <comment id="14093488" author="snazy" created="Mon, 11 Aug 2014 23:16:12 +0000"  >&lt;p&gt;Crazy - it works. Patch needs some cleanup and partial rework. Altogether it wasn&apos;t much work.&lt;/p&gt;</comment>
                            <comment id="14094590" author="snazy" created="Tue, 12 Aug 2014 20:03:49 +0000"  >&lt;p&gt;Patch working with tuples, user-types and all collections&lt;/p&gt;

&lt;p&gt;Added java-driver 2.1.0-rc1 (just needed to add missing methods to CqlRecordReader to fix compile error).&lt;/p&gt;

&lt;p&gt;UDFs are not marked as references in UDTs. Instead, upon UDT changes, the UDFs are checked if they use that UDT and recreate the UFMetaData instance if necessary.&lt;/p&gt;

&lt;p&gt;Unit tests cover following scenarios for UDTs:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;create type, create function with udt argument, select&lt;/li&gt;
	&lt;li&gt;create type, create function, drop type - user function is invalid&lt;/li&gt;
	&lt;li&gt;create type, create function, add field&lt;/li&gt;
	&lt;li&gt;create type, create function, rename field used by udf&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Note: &lt;tt&gt;ant realclean&lt;/tt&gt; required due to dependency change&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thobbs&quot; class=&quot;user-hover&quot; rel=&quot;thobbs&quot;&gt;thobbs&lt;/a&gt;] do you want to take a look at it?&lt;/p&gt;</comment>
                            <comment id="14102958" author="snazy" created="Tue, 19 Aug 2014 22:27:47 +0000"  >&lt;p&gt;patch against 7740&lt;/p&gt;</comment>
                            <comment id="14119969" author="thobbs" created="Wed, 3 Sep 2014 15:29:54 +0000"  >&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7812&quot; title=&quot;DROP FUNCTION drops all function with a given name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7812&quot;&gt;&lt;del&gt;CASSANDRA-7812&lt;/del&gt;&lt;/a&gt; committed, dropping a function with bad types gives the following error:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh:ks1&amp;gt; DROP FUNCTION foo(afeawefawef);
&amp;lt;ErrorMessage code=0000 [Server error] message=&quot;java.lang.AssertionError&quot;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should make sure that case is handled well in this ticket.&lt;/p&gt;</comment>
                            <comment id="14120024" author="snazy" created="Wed, 3 Sep 2014 16:16:53 +0000"  >&lt;p&gt;I did not update the patches for this ticket (due to dependency &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7692&quot; title=&quot;Upgrade Cassandra Java Driver to 2.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7692&quot;&gt;&lt;del&gt;CASSANDRA-7692&lt;/del&gt;&lt;/a&gt;).&lt;br/&gt;
It&apos;s about &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7791&quot; title=&quot;Consider re-allowing to refer to UDT outside of their keyspace&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7791&quot;&gt;&lt;del&gt;CASSANDRA-7791&lt;/del&gt;&lt;/a&gt; to fix the assertion error (DropFunctionStatement:92 : &quot;We have no proper keyspace to give, which means that this will break (NPE currently) for UDT: #7791 is open to fix this&quot;).&lt;/p&gt;</comment>
                            <comment id="14168653" author="snazy" created="Sun, 12 Oct 2014 13:42:19 +0000"  >&lt;p&gt;Initial version for user-types, tuple-types, lists, sets, maps as argument &amp;amp; return types available in linked git branch.&lt;br/&gt;
EDIT: working with Java + JavaScript UDFs&lt;/p&gt;</comment>
                            <comment id="14168667" author="snazy" created="Sun, 12 Oct 2014 14:39:50 +0000"  >&lt;p&gt;Patch &lt;tt&gt;7563.txt&lt;/tt&gt; for user-types, tuple-types and collections.&lt;/p&gt;

&lt;p&gt;Requires &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7692&quot; title=&quot;Upgrade Cassandra Java Driver to 2.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7692&quot;&gt;&lt;del&gt;CASSANDRA-7692&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8104&quot; title=&quot;frozen broken / frozen collections in frozen tuple type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8104&quot;&gt;&lt;del&gt;CASSANDRA-8104&lt;/del&gt;&lt;/a&gt; (this patch includes these)&lt;/p&gt;

&lt;p&gt;Functionality:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;adds &lt;tt&gt;DataType&lt;/tt&gt; for argument and return types to &lt;tt&gt;UDFunction&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;(de)serialization performed via &lt;tt&gt;DataType&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;no need to check for changed user types changed UTs (e.g. ALTER TYPE ADD) in UDFs - see &lt;tt&gt;UFTest.testJavaUserTypeMutation()&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14169314" author="slebresne" created="Mon, 13 Oct 2014 13:59:26 +0000"  >&lt;p&gt;I&apos;ve only scanned this very quickly, but why bother with special casing UDT, Tupe and collections in &lt;tt&gt;JavaTypesHelper.driverType()&lt;/tt&gt;? Using &lt;tt&gt;parseOne()&lt;/tt&gt; should work with any type (at which point I&apos;m not sure having a separate &lt;tt&gt;JavaTypesHelper&lt;/tt&gt; is really justified (I&apos;ve committed &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8063&quot; title=&quot;Consider removing UDF-as-class functionality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8063&quot;&gt;&lt;del&gt;CASSANDRA-8063&lt;/del&gt;&lt;/a&gt; so &lt;tt&gt;javaType&lt;/tt&gt; goes away too I believe), this could all stay into UDFunction imo, but that&apos;s a detail).&lt;/p&gt;</comment>
                            <comment id="14169327" author="snazy" created="Mon, 13 Oct 2014 14:14:22 +0000"  >&lt;p&gt;Cancelling patch because committed &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8063&quot; title=&quot;Consider removing UDF-as-class functionality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8063&quot;&gt;&lt;del&gt;CASSANDRA-8063&lt;/del&gt;&lt;/a&gt; will produce merge conflicts and justifies some code cleanup &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14170621" author="snazy" created="Tue, 14 Oct 2014 07:22:08 +0000"  >&lt;p&gt;new patch version - note: includes patches from the required/blocking tickets&lt;/p&gt;</comment>
                            <comment id="14193497" author="snazy" created="Sat, 1 Nov 2014 21:32:14 +0000"  >&lt;p&gt;ping for review &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14212882" author="thobbs" created="Fri, 14 Nov 2014 21:43:54 +0000"  >&lt;p&gt;Sorry for the slow response, I have some time to review your patch now.&lt;/p&gt;</comment>
                            <comment id="14212965" author="snazy" created="Fri, 14 Nov 2014 22:27:54 +0000"  >&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Attached v3 of the patch (rebased against current trunk).&lt;/p&gt;</comment>
                            <comment id="14213046" author="thobbs" created="Fri, 14 Nov 2014 23:15:21 +0000"  >&lt;p&gt;Good work so far!  Here&apos;s my preliminary feedback:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Using &lt;tt&gt;ProtocolVersion.NEWEST_SUPPORTED&lt;/tt&gt; for serializing and deserializing is not correct.  (I noticed a similiar issue when working on json functions.)  The protocol version used by the current connection needs to be passed into function executions for proper serialization and deserialization.&lt;/li&gt;
	&lt;li&gt;Can you add test cases for calling a UDF on a collection type with a null value (empty cell)?  The code looks like it should handle this, but it&apos;s good to test.&lt;/li&gt;
	&lt;li&gt;The new unit tests are really hard to parse.  Do you have any ideas for making them a little more readable?&lt;/li&gt;
	&lt;li&gt;Do you already have a C* ticket open for replacing the reflection calls after JAVA-502 is done?  If not, can you go ahead and make that?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14213070" author="snazy" created="Fri, 14 Nov 2014 23:33:08 +0000"  >&lt;p&gt;I&apos;ve created the ticket (and updated JAVA-502 for that).&lt;br/&gt;
Will try to improve readability of all tests in &lt;tt&gt;UFTest&lt;/tt&gt; - some support in CQLTester would be nice - especially after &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7813&quot; title=&quot;Decide how to deal with conflict between native and user-defined functions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7813&quot;&gt;&lt;del&gt;CASSANDRA-7813&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
Another unit test is no problem &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Regarding that protocol version issue. Maybe I&apos;m a bit too tired, but isn&apos;t that problem a bit more complex? UDFs can get parameters from CQL statements as &apos;constants&apos;, from CQL bound variables (I think these depend on the protocol version) and from tables (guess these are always &lt;tt&gt;ProtocolVersion.NEWEST_SUPPORTED&lt;/tt&gt;).&lt;/p&gt;

&lt;p&gt;Edit: Good catch with that protocol version thing &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14213105" author="thobbs" created="Sat, 15 Nov 2014 00:00:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;Will try to improve readability of all tests in UFTest - some support in CQLTester would be nice - especially after &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7813&quot; title=&quot;Decide how to deal with conflict between native and user-defined functions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7813&quot;&gt;&lt;del&gt;CASSANDRA-7813&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, feel free to add some utility functions, options, etc to CQLTester if those would make the tests clearer.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;isn&apos;t that problem a bit more complex? UDFs can get parameters from CQL statements as &apos;constants&apos;, from CQL bound variables (I think these depend on the protocol version) and from tables (guess these are always ProtocolVersion.NEWEST_SUPPORTED).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Literals/constants will end up as Lists.Value, Sets.Value, etc.  In the Value classes, &lt;tt&gt;getWithProtocolVersion()&lt;/tt&gt; will use the current connection&apos;s protocol version to serialize the list as a ByteBuffer.  Somthing similar happens for bound variables.&lt;/p&gt;

&lt;p&gt;When we fetch them from tables, they get serialized based on the current connection&apos;s protocol version &lt;em&gt;before&lt;/em&gt; functions are applied.  So the function needs to deserialize them using the same protocol version.&lt;/p&gt;</comment>
                            <comment id="14213523" author="snazy" created="Sat, 15 Nov 2014 11:03:54 +0000"  >&lt;p&gt;Ah - got it (hopefully all places).&lt;br/&gt;
Since we have the java driver in classpath now, we can use it for unit test - especially to test that protocol-version thing - maybe useful for json stuff, too &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14214609" author="snazy" created="Mon, 17 Nov 2014 12:43:11 +0000"  >&lt;p&gt;Attached v4 of the patch.&lt;/p&gt;

&lt;p&gt;The protocol version stuff got a bit bigger than I expected. But the new tests in UFTest pass. These test execution using &lt;tt&gt;executeInternal&lt;/tt&gt; and using protocol version 2 + 3 via the Java Driver.&lt;/p&gt;

&lt;p&gt;Calling a UDF with a null value in a collection does not work - the Java Driver does not support that. Added a test for that (but with &lt;tt&gt;@Ignore&lt;/tt&gt; annotation.&lt;/p&gt;

&lt;p&gt;I tried to make the new tests a bit more readable - hope it looks better now.&lt;/p&gt;

&lt;p&gt;Also added support in CQLTester to create UDFs (createFunction, createFunctionOverload).&lt;/p&gt;</comment>
                            <comment id="14218503" author="thobbs" created="Wed, 19 Nov 2014 21:10:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;The protocol version stuff got a bit bigger than I expected. But the new tests in UFTest pass. These test execution using executeInternal and using protocol version 2 + 3 via the Java Driver.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Looks good!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I tried to make the new tests a bit more readable - hope it looks better now.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks, this is definitely easier to read.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Calling a UDF with a null value in a collection does not work - the Java Driver does not support that. Added a test for that (but with @Ignore annotation.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sorry, I meant testing where the entire collection is null/empty.  For example, something like &lt;tt&gt;SELECT myfunc(mycollection) FROM ...&lt;/tt&gt; where &lt;tt&gt;mycollection&lt;/tt&gt; may be null/empty.&lt;/p&gt;

&lt;p&gt;Some more review comments:&lt;/p&gt;

&lt;p&gt;JavaSourceUDFFactory:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Can you add quick docs explaining argDataTypes, returnDataType vs javaParamTypes, javaReturnType&lt;/li&gt;
	&lt;li&gt;The example generated function for generateExecuteMethod() needs to be updated for protocolVersion in a couple of places&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;ScriptBasedUDF:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Directly return &lt;tt&gt;decompose()&lt;/tt&gt; result at the end of &lt;tt&gt;execute()&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;UDFunction:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Can you add basic javadocs on type-related methods plus &lt;tt&gt;compose()&lt;/tt&gt; and &lt;tt&gt;decompose()&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;UFTest:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;You mentioned that you had test coverage for various changes to UDTs used by functions, but I only see one that covers adding a field.  Can you add coverage for the other cases?  With the existing test, what happens if the UDT is altered and the function isn&apos;t replaced?  Make sure to cover failure scenarios in the tests.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;It&apos;s getting close! Thanks for your hard work &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14218614" author="snazy" created="Wed, 19 Nov 2014 22:26:35 +0000"  >&lt;p&gt;Heh - it all started with a &quot;simple pure&quot; approach &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Attached v5 with changes regarding the comments.&lt;br/&gt;
Just one enhancement: you can no longer drop a type that is used by a UDF&apos;s return or argument type (updated DropTypeStatement for that).&lt;/p&gt;</comment>
                            <comment id="14220311" author="thobbs" created="Fri, 21 Nov 2014 00:40:18 +0000"  >&lt;p&gt;This is almost good to go, but it looks like there are some problems with Javascript in Java 7:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    [junit] Testcase: testJavascriptTupleTypeCollection(org.apache.cassandra.cql3.UFTest):	Caused an ERROR
    [junit] Failed to compile function &apos;cql_test_keyspace_alt.function_75&apos; for language javascript: javax.script.ScriptException: sun.org.mozilla.javascript.internal.EvaluatorException: missing name after . operator (&amp;lt;Unknown Source&amp;gt;#1)
    [junit] org.apache.cassandra.exceptions.InvalidRequestException: Failed to compile function &apos;cql_test_keyspace_alt.function_75&apos; for language javascript: javax.script.ScriptException: sun.org.mozilla.javascript.internal.EvaluatorException: missing name after . operator (&amp;lt;Unknown Source&amp;gt;#1)
    [junit] 	at org.apache.cassandra.cql3.functions.ScriptBasedUDF.&amp;lt;init&amp;gt;(ScriptBasedUDF.java:86)
    [junit] 	at org.apache.cassandra.cql3.functions.UDFunction.create(UDFunction.java:202)
    [junit] 	at org.apache.cassandra.cql3.statements.CreateFunctionStatement.announceMigration(CreateFunctionStatement.java:132)
    [junit] 	at org.apache.cassandra.cql3.statements.SchemaAlteringStatement.executeInternal(SchemaAlteringStatement.java:92)
    [junit] 	at org.apache.cassandra.cql3.QueryProcessor.executeOnceInternal(QueryProcessor.java:349)
    [junit] 	at org.apache.cassandra.cql3.CQLTester.execute(CQLTester.java:436)
    [junit] 	at org.apache.cassandra.cql3.CQLTester.createFunctionOverload(CQLTester.java:298)
    [junit] 	at org.apache.cassandra.cql3.CQLTester.createFunction(CQLTester.java:289)
    [junit] 	at org.apache.cassandra.cql3.UFTest.testJavascriptTupleTypeCollection(UFTest.java:1138)
    [junit] 
    [junit] 
    [junit] Testcase: testJavascriptUTCollections(org.apache.cassandra.cql3.UFTest):	Caused an ERROR
    [junit] Execution of user-defined function &apos;cql_test_keyspace.function_83&apos; failed: javax.script.ScriptException: sun.org.mozilla.javascript.internal.EcmaError: TypeError: Cannot call method &quot;getString&quot; of null (&amp;lt;Unknown Source&amp;gt;#1) in &amp;lt;Unknown Source&amp;gt; at line number 1
    [junit] org.apache.cassandra.exceptions.InvalidRequestException: Execution of user-defined function &apos;cql_test_keyspace.function_83&apos; failed: javax.script.ScriptException: sun.org.mozilla.javascript.internal.EcmaError: TypeError: Cannot call method &quot;getString&quot; of null (&amp;lt;Unknown Source&amp;gt;#1) in &amp;lt;Unknown Source&amp;gt; at line number 1
    [junit] 	at org.apache.cassandra.cql3.functions.ScriptBasedUDF.execute(ScriptBasedUDF.java:142)
    [junit] 	at org.apache.cassandra.cql3.selection.ScalarFunctionSelector.getOutput(ScalarFunctionSelector.java:60)
    [junit] 	at org.apache.cassandra.cql3.selection.Selection$SelectionWithProcessing$1.getOutputRow(Selection.java:397)
    [junit] 	at org.apache.cassandra.cql3.selection.Selection$ResultSetBuilder.build(Selection.java:241)
    [junit] 	at org.apache.cassandra.cql3.statements.SelectStatement.process(SelectStatement.java:1168)
    [junit] 	at org.apache.cassandra.cql3.statements.SelectStatement.processResults(SelectStatement.java:304)
    [junit] 	at org.apache.cassandra.cql3.statements.SelectStatement.executeInternal(SelectStatement.java:328)
    [junit] 	at org.apache.cassandra.cql3.statements.SelectStatement.executeInternal(SelectStatement.java:65)
    [junit] 	at org.apache.cassandra.cql3.QueryProcessor.executeOnceInternal(QueryProcessor.java:349)
    [junit] 	at org.apache.cassandra.cql3.CQLTester.execute(CQLTester.java:436)
    [junit] 	at org.apache.cassandra.cql3.UFTest.testJavascriptUTCollections(UFTest.java:1278)
    [junit] 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I believe we are considering requiring Java 8 for Cassandra 3.0, so if there&apos;s not a straightforward fix for whatever the underlying problem is, we could potentially just advertise the limitation.&lt;/p&gt;</comment>
                            <comment id="14220342" author="snazy" created="Fri, 21 Nov 2014 01:04:33 +0000"  >&lt;p&gt;Updated patch as v6 with that rhino stuff passing - don&apos;t ask me why that works that way in the one case but not in the other... I think that&apos;s one of the reasons why nashorn has been developed. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14220348" author="snazy" created="Fri, 21 Nov 2014 01:08:12 +0000"  >&lt;p&gt;FYI - diff for the rhino &quot;fix&quot; : &lt;a href=&quot;https://github.com/snazy/cassandra/commit/4268d2ac148bcda407fc407ae4f5f9d498ee81da&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/snazy/cassandra/commit/4268d2ac148bcda407fc407ae4f5f9d498ee81da&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14221331" author="thobbs" created="Fri, 21 Nov 2014 19:47:30 +0000"  >&lt;p&gt;When playing around with this, I discovered that you can trigger an assertion error when creating a function with a UDT without an explicit keyspace:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; use ks1;
cqlsh:ks1&amp;gt; create type mytype (a int);
cqlsh:ks1&amp;gt; create function bar (a mytype) RETURNS mytype LANGUAGE java AS $$return a;$$;
&amp;lt;ErrorMessage code=0000 [Server error] message=&quot;java.lang.AssertionError&quot;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.AssertionError: null
	at org.apache.cassandra.config.Schema.getKSMetaData(Schema.java:222) ~[main/:na]
	at org.apache.cassandra.cql3.CQL3Type$Raw$RawUT.prepare(CQL3Type.java:510) ~[main/:na]
	at org.apache.cassandra.cql3.statements.CreateFunctionStatement.announceMigration(CreateFunctionStatement.java:115) ~[main/:na]
	at org.apache.cassandra.cql3.statements.SchemaAlteringStatement.execute(SchemaAlteringStatement.java:80) ~[main/:na]
	at org.apache.cassandra.cql3.QueryProcessor.processStatement(QueryProcessor.java:226) ~[main/:na]
	at org.apache.cassandra.cql3.QueryProcessor.process(QueryProcessor.java:248) ~[main/:na]
	at org.apache.cassandra.transport.messages.QueryMessage.execute(QueryMessage.java:118) ~[main/:na]
	at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:439) [main/:na]
	at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:335) [main/:na]
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105) [netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:333) [netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.AbstractChannelHandlerContext.access$700(AbstractChannelHandlerContext.java:32) [netty-all-4.0.23.Final.jar:4.0.23.Final]
	at io.netty.channel.AbstractChannelHandlerContext$8.run(AbstractChannelHandlerContext.java:324) [netty-all-4.0.23.Final.jar:4.0.23.Final]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_25]
	at org.apache.cassandra.concurrent.AbstractTracingAwareExecutorService$FutureTask.run(AbstractTracingAwareExecutorService.java:164) [main/:na]
	at org.apache.cassandra.concurrent.SEPWorker.run(SEPWorker.java:105) [main/:na]
	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_25]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A quick investigation shows that the keyspace being passed to &lt;tt&gt;prepare()&lt;/tt&gt; is null.&lt;/p&gt;

&lt;p&gt;Other than that, the post-test cleanup seems to have problems dropping some of the functions.  I believe it&apos;s due to a signature mismatch.  This doesn&apos;t show up as an error, since &lt;tt&gt;DROP IF EXISTS&lt;/tt&gt; is used, but it causes &lt;tt&gt;DROP TYPE&lt;/tt&gt; statements to fail later.  I&apos;m not sure if this is due to the way the tests are working, or if it&apos;s an actual problem with dropping functions.  (I haven&apos;t narrowed it down to a particular set of functions, yet.)&lt;/p&gt;</comment>
                            <comment id="14221922" author="snazy" created="Sat, 22 Nov 2014 11:44:06 +0000"  >&lt;p&gt;Attached v7 of the patch with the fix for that. Also added a unit test for that using &lt;tt&gt;USE&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;After that fix:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh&amp;gt; use foo ;
cqlsh:foo&amp;gt; create type mytype (a &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;);
cqlsh:foo&amp;gt; create function bar (a mytype) RETURNS mytype LANGUAGE java AS $$&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; a;$$;
code=2200 [Invalid query] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;Non-frozen User-Defined types are not supported, please use frozen&amp;lt;&amp;gt;&quot;&lt;/span&gt;
cqlsh:foo&amp;gt; create function bar (a frozen&amp;lt;mytype&amp;gt;) RETURNS frozen&amp;lt;mytype&amp;gt; LANGUAGE java AS $$&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; a;$$;
cqlsh:foo&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14225200" author="thobbs" created="Tue, 25 Nov 2014 21:02:33 +0000"  >&lt;p&gt;Hmm, I&apos;m still getting the failure to drop a type due to a function still referencing it (because a &lt;tt&gt;DROP FUNCTION&lt;/tt&gt; didn&apos;t work, as described in my previous comment):&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    [junit] ERROR 20:54:34 Fatal exception in thread Thread[OptionalTasks:1,5,main]
    [junit] java.lang.RuntimeException: java.lang.RuntimeException: Error setting schema for test (query was: DROP TYPE IF EXISTS cql_test_keyspace.type_4)
    [junit] 	at org.apache.cassandra.cql3.CQLTester$1.run(CQLTester.java:188) ~[classes/:na]
    [junit] 	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_25]
    [junit] 	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_25]
    [junit] 	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) ~[na:1.8.0_25]
    [junit] 	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) ~[na:1.8.0_25]
    [junit] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_25]
    [junit] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_25]
    [junit] 	at java.lang.Thread.run(Thread.java:745) [na:1.8.0_25]
    [junit] Caused by: java.lang.RuntimeException: Error setting schema for test (query was: DROP TYPE IF EXISTS cql_test_keyspace.type_4)
    [junit] 	at org.apache.cassandra.cql3.CQLTester.schemaChange(CQLTester.java:404) ~[classes/:na]
    [junit] 	at org.apache.cassandra.cql3.CQLTester.access$000(CQLTester.java:63) ~[classes/:na]
    [junit] 	at org.apache.cassandra.cql3.CQLTester$1.run(CQLTester.java:167) ~[classes/:na]
    [junit] 	... 7 common frames omitted
    [junit] Caused by: java.lang.RuntimeException: Error validating query DROP TYPE IF EXISTS cql_test_keyspace.type_4
    [junit] 	at org.apache.cassandra.cql3.QueryProcessor.executeOnceInternal(QueryProcessor.java:374) ~[main/:na]
    [junit] 	at org.apache.cassandra.cql3.CQLTester.schemaChange(CQLTester.java:400) ~[classes/:na]
    [junit] 	... 9 common frames omitted
    [junit] Caused by: org.apache.cassandra.exceptions.InvalidRequestException: Cannot drop user type cql_test_keyspace.type_4 as it is still used by function cql_test_keyspace.function_6
    [junit] 	at org.apache.cassandra.cql3.statements.DropTypeStatement.validate(DropTypeStatement.java:83) ~[main/:na]
    [junit] 	at org.apache.cassandra.cql3.QueryProcessor.executeOnceInternal(QueryProcessor.java:361) ~[main/:na]
    [junit] 	... 10 common frames omitted
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note that this doesn&apos;t cause the test to fail because it happens during cleanup.&lt;/p&gt;

&lt;p&gt;DROP FUNCTION statements also seem to have a problem with UDTs in a different keyspace:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; create keyspace ks1 WITH replication = {&apos;class&apos;: &apos;SimpleStrategy&apos;, &apos;replication_factor&apos;: &apos;1&apos;};
cqlsh&amp;gt; create keyspace ks2 WITH replication = {&apos;class&apos;: &apos;SimpleStrategy&apos;, &apos;replication_factor&apos;: &apos;2&apos;};
cqlsh&amp;gt; create type ks1.foo (a int);
cqlsh&amp;gt; create function ks2.myfunc (a frozen&amp;lt;ks1.foo&amp;gt;) RETURNS frozen&amp;lt;ks1.foo&amp;gt; LANGUAGE java AS $$return a;$$;
cqlsh&amp;gt; drop function ks2.myfunc (frozen&amp;lt;ks1.foo&amp;gt;);
code=2200 [Invalid query] message=&quot;Statement on keyspace ks2 cannot refer to a user type in keyspace ks1; user types can only be used in the keyspace they are defined in&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14225504" author="snazy" created="Wed, 26 Nov 2014 00:52:33 +0000"  >&lt;p&gt;Problem is the following sequence of statements:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE TYPE foo ...
CREATE FUNCTION bar ( par foo ) RETURNS foo ...
ALTER TYPE foo ADD ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ALTER TYPE foo ALTER ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ALTER TYPE foo RENAME ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fix to use &lt;tt&gt;AbstractType.asCQL3Type().toString().equals()&lt;/tt&gt; instead of &lt;tt&gt;AbstractType.equals()&lt;/tt&gt; - this is (should be) what the user has typed. &lt;tt&gt;UserType.equals()&lt;/tt&gt; also compares the embedded field names and types - so changes on the UDT effectively &quot;hides&quot; UDFs using that UDT (even no longer droppable -  that&apos;s what Tyler saw).&lt;/p&gt;

&lt;p&gt;&quot;Breaking&quot; change: value of &lt;tt&gt;signuture&lt;/tt&gt; column is now computed from &lt;tt&gt;AbstractType.asCQL3Type().toString()&lt;/tt&gt; instead of &lt;tt&gt;AbstractType.toString()&lt;/tt&gt; - so I&apos;d recommend to &lt;tt&gt;rm -rf }} the {{schema_functions&lt;/tt&gt; table for trunk installations &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14225507" author="snazy" created="Wed, 26 Nov 2014 00:54:00 +0000"  >&lt;p&gt;Attached v8 of the patch.&lt;br/&gt;
&lt;tt&gt;7563v8-diff-diff.txt&lt;/tt&gt; just contains the changes to v7 for reference ; v8 is rebased against trunk.&lt;/p&gt;</comment>
                            <comment id="14226557" author="thobbs" created="Wed, 26 Nov 2014 18:11:29 +0000"  >&lt;p&gt;There&apos;s one oddity around renaming a field in a UDT that&apos;s used by a UDFs.  The function will continue to work, even if it uses the old name for the renamed field.  For example:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; CREATE TYPE ks1.type1 (a int);
cqlsh&amp;gt; CREATE FUNCTION ks1.func1 (a frozen&amp;lt;ks1.type1&amp;gt;) RETURNS int LANGUAGE java AS $$ return Integer.valueOf(a.getInt(&quot;a&quot;)); $$;
cqlsh&amp;gt; CREATE TABLE ks1.table1 (a int PRIMARY KEY, b frozen&amp;lt;ks1.type1&amp;gt;);
cqlsh&amp;gt; INSERT INTO ks1.table1 (a, b) VALUES (0, {a: 0});
cqlsh&amp;gt; SELECT ks1.func1(b) FROM ks1.table1;

 ks1.func1(b)
--------------
            0

(1 rows)
cqlsh&amp;gt; ALTER TEYPE ks1.type1 RENAME a TO b;
cqlsh&amp;gt; SELECT ks1.func1(b) FROM ks1.table1;

 ks1.func1(b)
--------------
            0

(1 rows)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that the function gets field &quot;a&quot;, which was renamed to &quot;b&quot;.  I think I&apos;m okay with this behavior, but I&apos;d like to check with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt; as well.&lt;/p&gt;</comment>
                            <comment id="14226815" author="snazy" created="Wed, 26 Nov 2014 21:08:33 +0000"  >&lt;p&gt;v9 (with changes in diff-diff) attached&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;listens for UDT changes and updates the UserType instances in &lt;tt&gt;UDFunction&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;change in CQLTester to unwrap &lt;tt&gt;InvalidRequestException&lt;/tt&gt; from &lt;tt&gt;RuntimeException&lt;/tt&gt; (wrapped in &lt;tt&gt;executeOnceInternal&lt;/tt&gt;)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14227011" author="thobbs" created="Wed, 26 Nov 2014 23:51:27 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Committed v9 with some whitespace cleanup as 794d68b.  Thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12755520">CASSANDRA-8323</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12747581">CASSANDRA-8104</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12731986">CASSANDRA-7692</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12720964">CASSANDRA-7395</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12662877" name="7563-7740.txt" size="32893" author="snazy" created="Tue, 19 Aug 2014 22:27:47 +0000"/>
                            <attachment id="12674414" name="7563.txt" size="41722" author="snazy" created="Sun, 12 Oct 2014 14:39:50 +0000"/>
                            <attachment id="12674715" name="7563v2.txt" size="37824" author="snazy" created="Tue, 14 Oct 2014 07:22:08 +0000"/>
                            <attachment id="12681631" name="7563v3.txt" size="35254" author="snazy" created="Fri, 14 Nov 2014 22:27:54 +0000"/>
                            <attachment id="12681887" name="7563v4.txt" size="133599" author="snazy" created="Mon, 17 Nov 2014 12:38:38 +0000"/>
                            <attachment id="12682506" name="7563v5.txt" size="147059" author="snazy" created="Wed, 19 Nov 2014 22:19:22 +0000"/>
                            <attachment id="12682787" name="7563v6.txt" size="147571" author="snazy" created="Fri, 21 Nov 2014 01:04:32 +0000"/>
                            <attachment id="12683047" name="7563v7.txt" size="150386" author="snazy" created="Sat, 22 Nov 2014 11:44:06 +0000"/>
                            <attachment id="12683806" name="7563v8-diff-diff.txt" size="16744" author="snazy" created="Wed, 26 Nov 2014 09:20:27 +0000"/>
                            <attachment id="12683807" name="7563v8.txt" size="158247" author="snazy" created="Wed, 26 Nov 2014 09:20:27 +0000"/>
                            <attachment id="12683952" name="7563v9.txt" size="162704" author="snazy" created="Thu, 27 Nov 2014 00:00:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[snazy]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>406002</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13101"><![CDATA[Clients]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 51 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xv8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>406022</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>thobbs</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>