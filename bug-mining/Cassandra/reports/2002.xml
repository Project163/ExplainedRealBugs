<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:36:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5167] Node isn&apos;t removed from system.peers after &apos;nodetool removenode&apos;</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5167</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In a 3 node live cluster - After a replacement of a dead node, the old node remains in the system.peers table, even after running &apos;nodetool removenode &amp;lt;ID&amp;gt;&apos;.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Ubuntu 12.10, Java 1.7.0_09 (OpenJDK)&lt;/p&gt;</environment>
        <key id="12628028">CASSANDRA-5167</key>
            <summary>Node isn&apos;t removed from system.peers after &apos;nodetool removenode&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="ng@issuu.com">Nicolai Gylling</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jan 2013 12:20:50 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:19 +0000</updated>
                            <resolved>Fri, 18 Jan 2013 16:20:02 +0000</resolved>
                                        <fixVersion>1.2.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13556496" author="brandon.williams" created="Thu, 17 Jan 2013 19:22:10 +0000"  >&lt;p&gt;I&apos;m not sure why we ever made a &apos;removeTokens&apos; method instead of &apos;removeEndpoint&apos; since we&apos;re never going to want to remove some subset of a node&apos;s tokens.  Patch to delete endpoints.&lt;/p&gt;</comment>
                            <comment id="13557084" author="slebresne" created="Fri, 18 Jan 2013 09:37:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m not sure why we ever made a &apos;removeTokens&apos; method instead of &apos;removeEndpoint&apos;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That slightly confused me too in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4351&quot; title=&quot;Consider storing more informations on peers in system tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4351&quot;&gt;&lt;del&gt;CASSANDRA-4351&lt;/del&gt;&lt;/a&gt;, though I went for the lazy option of maintaining behavior blindly.&lt;/p&gt;

&lt;p&gt;So definitely agreed on the idea. Two tiny remark on the patch though:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;in SS.handleStateRemoving, we call Gossiper.instance.removeEndpoint() but shouldn&apos;t we called SystemTable.removeEndpoint() too? In fact, it seems to me we may want to group both in a small utility method since at least when we call the Gossiper one, I think we always should call SystemTable one.&lt;/li&gt;
	&lt;li&gt;in SS.handleStateNormal, ST.removeEndpoint should probably only be call if &lt;tt&gt;!isClient&lt;/tt&gt; like in SS.excise().&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13557304" author="brandon.williams" created="Fri, 18 Jan 2013 15:57:19 +0000"  >&lt;p&gt;v2 incorporates both ideas.&lt;/p&gt;</comment>
                            <comment id="13557312" author="slebresne" created="Fri, 18 Jan 2013 16:08:23 +0000"  >&lt;p&gt;+1 with the nit that in excise I think we can call the new removeEndpoint instead of doing both call separately.&lt;/p&gt;</comment>
                            <comment id="13557324" author="brandon.williams" created="Fri, 18 Jan 2013 16:20:02 +0000"  >&lt;p&gt;Committed w/nit fixed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12629473">CASSANDRA-5190</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12565490" name="5167-v2.txt" size="5285" author="brandon.williams" created="Fri, 18 Jan 2013 15:57:19 +0000"/>
                            <attachment id="12565366" name="5167.txt" size="4330" author="brandon.williams" created="Thu, 17 Jan 2013 19:52:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>304876</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 44 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17wjz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>254243</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>