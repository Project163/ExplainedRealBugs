<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:02:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11137] JSON datetime formatting needs timezone</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11137</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;The JSON date time string representation lacks the timezone information:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh:events&amp;gt; select toJson(created_at) AS created_at from event_by_user_timestamp ;

 created_at
---------------------------
 &lt;span class=&quot;code-quote&quot;&gt;&quot;2016-01-04 16:05:47.123&quot;&lt;/span&gt;

(1 rows)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;vs.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh:events&amp;gt; select created_at FROM event_by_user_timestamp ;

 created_at
--------------------------
 2016-01-04 15:05:47+0000

(1 rows)
cqlsh:events&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To make things even more complicated the JSON timestamp is not returned in UTC.&lt;/p&gt;

&lt;p&gt;At the moment &lt;tt&gt;DateType&lt;/tt&gt; picks this formatting string &lt;tt&gt;&quot;yyyy-MM-dd HH:mm:ss.SSS&quot;&lt;/tt&gt;. Shouldn&apos;t we somehow make this configurable by users or at a minimum add the timezone?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12937739">CASSANDRA-11137</key>
            <summary>JSON datetime formatting needs timezone</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ifesdjeen">Alex Petrov</assignee>
                                    <reporter username="stefania">Stefania Alborghetti</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Feb 2016 00:54:55 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:43 +0000</updated>
                            <resolved>Wed, 27 Apr 2016 09:18:39 +0000</resolved>
                                        <fixVersion>2.2.7</fixVersion>
                    <fixVersion>3.0.6</fixVersion>
                    <fixVersion>3.6</fixVersion>
                                    <component>Legacy/CQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15138469" author="ralfsteppacher" created="Tue, 9 Feb 2016 07:22:57 +0000"  >&lt;p&gt;My original issue was with the Java driver. I just used cqlsh to demonstrate the issue.&lt;/p&gt;

&lt;p&gt;Personally I think that adding the timezone is the correct fix. Every datetime library will do the &quot;right thing&quot; if the information is included. &lt;/p&gt;</comment>
                            <comment id="15138492" author="stefania" created="Tue, 9 Feb 2016 07:48:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;My original issue was with the Java driver. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I suspect the Java driver simply prints the JSON string like cqlsh does so the fix is definitely in Cassandra.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The examples in the ticket description use two different table names but they should be the same table. I cannot edit the description.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Description amended, thank you.&lt;/p&gt;</comment>
                            <comment id="15138556" author="adutra" created="Tue, 9 Feb 2016 08:53:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;I suspect the Java driver simply prints the JSON string like cqlsh does so the fix is definitely in Cassandra.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Correct.&lt;/p&gt;</comment>
                            <comment id="15245993" author="ifesdjeen" created="Mon, 18 Apr 2016 16:55:14 +0000"  >&lt;p&gt;We could fix it by making &lt;tt&gt;toJson&lt;/tt&gt; with two arities: &lt;tt&gt;toJson(item)&lt;/tt&gt; and &lt;tt&gt;toJson(item, format)&lt;/tt&gt;. &lt;/p&gt;

&lt;p&gt;Format can be passed as literals when &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10783&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;10783&lt;/a&gt; is implemented. WDYT &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Stefania&quot; class=&quot;user-hover&quot; rel=&quot;stefania&quot;&gt;Stefania&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="15246829" author="stefania" created="Tue, 19 Apr 2016 00:23:43 +0000"  >&lt;p&gt;Ideally &lt;tt&gt;toJson(item, dateTimeFormat=&apos;my-format&apos;)&lt;/tt&gt; but if this cannot be done with UDFs then perhaps a map of options can be supported just as easily as a single parameter?&lt;/p&gt;</comment>
                            <comment id="15246835" author="iamaleksey" created="Tue, 19 Apr 2016 00:30:11 +0000"  >&lt;p&gt;For now, really, just add the timezone, locked down to UTC, until there is enough demand to allow overriding it.&lt;/p&gt;</comment>
                            <comment id="15249254" author="stefania" created="Wed, 20 Apr 2016 05:12:17 +0000"  >&lt;p&gt;I agree with Aleksey, adding a timezone is sufficient for now.&lt;/p&gt;</comment>
                            <comment id="15249343" author="ifesdjeen" created="Wed, 20 Apr 2016 06:11:33 +0000"  >&lt;p&gt;Sure, I agree too. Already done, just have to adjust several tests.&lt;/p&gt;</comment>
                            <comment id="15249481" author="ifesdjeen" created="Wed, 20 Apr 2016 08:25:12 +0000"  >&lt;p&gt;It&apos;s true that adding format without big necessity for users would be an overkill, it was just first thing that came into my mind.&lt;/p&gt;

&lt;p&gt;Hope I&apos;ve understood &quot;locked down to UTC&quot; correctly (i.e. always convert to UTC timezone). &lt;br/&gt;
I&apos;ve used the &lt;tt&gt;yyyy-MM-dd HH:mm:ss.SSSX&lt;/tt&gt; (to handle timezone similarly to used UTC format).&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ifesdjeen/cassandra/tree/11137-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ifesdjeen/cassandra-dtest/tree/11137-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests code&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-11137-trunk-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-11137-trunk-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15251231" author="stefania" created="Thu, 21 Apr 2016 04:22:50 +0000"  >&lt;p&gt;LGTM, committed as ae063e806191f8285f1f3bcab068b2c4bfbc257b.&lt;/p&gt;

&lt;p&gt;The failing json dtests pass locally provided the dtest patch is applied. For future reference, you can launch a CASSCI job with a different dtest repo and branch as follows:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;!build my-job DTEST_REPO=my-gh-repo DTEST_BRANCH=my-branch
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve created the dtest pull request &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/944&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;, I&apos;ll let the test eng team review it before merging it.&lt;/p&gt;</comment>
                            <comment id="15259663" author="ifesdjeen" created="Wed, 27 Apr 2016 07:00:22 +0000"  >&lt;p&gt;Provided fix causes test failures for 2.2 and 3.0.&lt;/p&gt;</comment>
                            <comment id="15259837" author="ifesdjeen" created="Wed, 27 Apr 2016 09:18:32 +0000"  >&lt;p&gt;I&apos;ve also branch changes to 2.2 and 3.0 (merged mostly seamlessly), in case we would like to have backported versions: &lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ifesdjeen/cassandra/tree/11137-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-11137-2.2-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-11137-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ifesdjeen/cassandra/tree/11137-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-11137-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-11137-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;And &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/955&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;opened up an PR that fix tests&lt;/a&gt;. I&apos;ll track the progress in corresponding &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11650&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;test team issue&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="15259946" author="stefania" created="Wed, 27 Apr 2016 10:35:20 +0000"  >&lt;p&gt;I&apos;m +1 on the dtest PR, assuming the test team is also OK with using ellipses to relax the output checks.&lt;/p&gt;

&lt;p&gt;We shouldn&apos;t backport a patch because of test limitations but, I&apos;ve noticed that this ticket is classified as a bug, so back-porting it might be the correct thing to do after all. Do you agree that it should be back-ported to 2.2 and 3.0, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=iamaleksey&quot; class=&quot;user-hover&quot; rel=&quot;iamaleksey&quot;&gt;iamaleksey&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="15259985" author="iamaleksey" created="Wed, 27 Apr 2016 11:21:34 +0000"  >&lt;p&gt;It is a bug, and something that should normally be backported. It&apos;s also potentially a breaking behaviour change for JSON consumers. That said, I think benefits of fixing the bug outweigh that risk.&lt;/p&gt;</comment>
                            <comment id="15261352" author="stefania" created="Thu, 28 Apr 2016 01:26:14 +0000"  >&lt;p&gt;Code and tests look good: all dtests passed and failing utests were either unrelated timeouts or also failing on unpatched branches.&lt;/p&gt;

&lt;p&gt;Committed to 2.2 as 88f22b9692c6fdddf837556f13140d949afe0d28 and up-merged (with -s ours for trunk).  Also added a section to NEWS.txt.&lt;/p&gt;

&lt;p&gt;Test PR closed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 29 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2sl9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>stefania</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>