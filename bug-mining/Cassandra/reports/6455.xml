<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:29:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-19185] Vector search tests are failing on recall accuracy</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-19185</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Vector tests are failing randomly because they do not meet recall assertion values. Currently, the following tests have been reported as failing:&lt;/p&gt;

&lt;p&gt;VectorSegmentationTest.testMultipleSegmentsForCompaction&lt;br/&gt;
VectorDistributedTest.rangeRestrictedTest&lt;br/&gt;
VectorDistributedTest.testPartitionRestrictedVectorSearch&lt;/p&gt;

&lt;p&gt;Since the vector searches are approximate and the vectors used in the tests are random, it is unlikely that they will always meet a high recall. The recall assertions are looking for recall values of 0.9 and above. Part of this issue is related to the use of random values in the vectors being tested. We have seen, with other tests, that the vector search performs better with non-random generated datasets like the Glove datasets. As such, there are the following available to fix these tests.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Downgrade the assertions to a value that is likely to always pass. The problem is that there is no guarantee that a test will always pass any recall value we give it.&lt;/li&gt;
	&lt;li&gt;Use generated datasets for these tests to see if that improves the recall results.&lt;/li&gt;
	&lt;li&gt;Remove the recall assertions unless they are specifically asked for. We could use a system property to enable recall testing for targeted vector testing.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I don&apos;t think option 1 is a viable long-term solution as we can never be certain that it will always work. Option 2 has more promise but it could still result in failures because of the approximate nature of the vector searches. As such, option 3 seems the only viable solution here but means that, in most cases, we are only really testing that we are returning results from the search, not how accurate those results are.&lt;br/&gt;
&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13561145">CASSANDRA-19185</key>
            <summary>Vector search tests are failing on recall accuracy</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mike_tr_adamson">Mike Adamson</assignee>
                                    <reporter username="mike_tr_adamson">Mike Adamson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Dec 2023 12:48:05 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:53 +0000</updated>
                            <resolved>Thu, 21 Mar 2024 13:11:15 +0000</resolved>
                                        <fixVersion>5.0-rc1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Feature/SAI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17794790" author="JIRAUSER298386" created="Fri, 8 Dec 2023 16:15:57 +0000"  >&lt;p&gt;I think #2 makes the most sense. There are several established test data sets for vector search and we could adopt one of them or make our own for tests.&lt;/p&gt;</comment>
                            <comment id="17794805" author="mike_tr_adamson" created="Fri, 8 Dec 2023 16:56:24 +0000"  >&lt;p&gt;We are already using the Glove 50 dataset in other tests, so it makes sense to roll those changes over to all tests doing recall assertions. I&apos;ll get onto this next week.&lt;/p&gt;</comment>
                            <comment id="17811028" author="edimitrova" created="Thu, 25 Jan 2024 21:08:05 +0000"  >&lt;p&gt;Being a test issue, this is not an rc blocker. Removing 5.0-rc from fix version.&#160;&lt;/p&gt;</comment>
                            <comment id="17821632" author="mike_tr_adamson" created="Wed, 28 Feb 2024 12:26:01 +0000"  >&lt;p&gt;Patch for this is here &lt;a href=&quot;https://github.com/apache/cassandra/pull/3151&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;5.0&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17823573" author="mike_tr_adamson" created="Tue, 5 Mar 2024 11:35:55 +0000"  >&lt;p&gt;CI runs for the failing tests are here:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/mike-tr-adamson/cassandra/454/workflows/deb42480-75d7-434f-8c8e-9f4dfef93947/jobs/42518&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Unit repeat&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/mike-tr-adamson/cassandra/454/workflows/08488082-c35d-4102-8518-4603c648a4b3/jobs/42520&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Unit repeat&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/mike-tr-adamson/cassandra/454/workflows/deb42480-75d7-434f-8c8e-9f4dfef93947/jobs/42519&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JVM DTest repeat&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/mike-tr-adamson/cassandra/454/workflows/41f0954c-f09b-47c3-b22f-cd15ea7cc1d9/jobs/42521&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JVM DTest repeat&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; This patch is now ready for review&lt;/p&gt;</comment>
                            <comment id="17823797" author="edimitrova" created="Tue, 5 Mar 2024 23:03:03 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mike_tr_adamson&quot; class=&quot;user-hover&quot; rel=&quot;mike_tr_adamson&quot;&gt;mike_tr_adamson&lt;/a&gt;, I&apos;ll take a look at it tomorrow. &lt;/p&gt;</comment>
                            <comment id="17824178" author="edimitrova" created="Wed, 6 Mar 2024 21:13:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mike_tr_adamson&quot; class=&quot;user-hover&quot; rel=&quot;mike_tr_adamson&quot;&gt;mike_tr_adamson&lt;/a&gt;, the patch looks good to me.&lt;br/&gt;
I left only one configuration-related question here - &lt;a href=&quot;https://github.com/apache/cassandra/pull/3151#discussion_r1515139272&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/3151#discussion_r1515139272&lt;/a&gt;&lt;br/&gt;
Or was there a specific reason that VectorDistributedTest is run with offheap_objects, which I am missing? &lt;/p&gt;</comment>
                            <comment id="17827800" author="edimitrova" created="Sun, 17 Mar 2024 17:35:09 +0000"  >&lt;p&gt;The config question was addressed and the new CI repeated runs are all green. +1&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mike_tr_adamson&quot; class=&quot;user-hover&quot; rel=&quot;mike_tr_adamson&quot;&gt;mike_tr_adamson&lt;/a&gt; , please propagate it to the trunk, too, and test, and if everything is green there too (which I am 99% sure it will be), we can commit it.&lt;/p&gt;

&lt;p&gt;Do you need help to commit it, or do you have everything already set?&lt;/p&gt;

&lt;p&gt;We follow the below guideline:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cassandra.apache.org/_/development/how_to_commit.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cassandra.apache.org/_/development/how_to_commit.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The template we use for the commit message is at the bottom and there is procedure how to merge the patch between branches. Please ping me if you have questions or anything. I am not sure whether you already did your first commits in the Cassandra repo, etc, and the multi-branch strategy is not fun. Happy to help&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17828055" author="mike_tr_adamson" created="Mon, 18 Mar 2024 17:24:19 +0000"  >&lt;p&gt;Thanks, I&apos;ve done a few commits now so should be good, but thanks for the offer.&lt;/p&gt;

&lt;p&gt;I&apos;ll get trunk propagated and tested and commit if good.&lt;/p&gt;</comment>
                            <comment id="17829553" author="mike_tr_adamson" created="Thu, 21 Mar 2024 13:11:15 +0000"  >&lt;p&gt;Committed as&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/7aab61b06357ce0b59977715f82fed1ad24474b4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/7aab61b06357ce0b59977715f82fed1ad24474b4&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13559394">CASSANDRA-19095</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[mike_tr_adamson]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12990" cascade-level="1"><![CDATA[Test Failure]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311120" key="com.pyxis.greenhopper.jira:gh-epic-link">
                        <customfieldname>Epic Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>CASSANDRA-19224</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 33 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1m55k:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[e.dimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12353513">5.0-alpha1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/7aab61b06357ce0b59977715f82fed1ad24474b4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/7aab61b06357ce0b59977715f82fed1ad24474b4&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Test results in ticket comments&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>