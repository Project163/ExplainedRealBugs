<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:40:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-6119] IndexedSliceReader can skip columns when fetching multiple contiguous slices</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-6119</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;This was observed using SliceQueryFilter with multiple slices.&lt;/p&gt;

&lt;p&gt;Let&apos;s have a row &quot;a&quot; having the following column list : &quot;colA&quot;, &quot;colB&quot;, &quot;colC&quot;, &quot;colD&quot;&lt;br/&gt;
Then select 2 ranges : &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;colA&amp;quot;, &amp;quot;colB&amp;quot;&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;colC&amp;quot;, &amp;quot;colD&amp;quot;&amp;#93;&lt;/span&gt;&lt;br/&gt;
Expected result is the four columns&lt;br/&gt;
But only 3 are returned (&quot;colA&quot;, &quot;colB&quot;, &quot;colD&quot;)&lt;/p&gt;

&lt;p&gt;To reproduce the above scenario in the unit tests, you can modify the test &quot;ColumnFamilyStoreTest.testMultiRangeIndexed&quot; by replacing the original line :&lt;br/&gt;
        String[] letters = new String[] &lt;/p&gt;
{ &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;i&quot; }
&lt;p&gt;;&lt;br/&gt;
by this one (&quot;f&quot; letter has been removed) :&lt;br/&gt;
        String[] letters = new String[] &lt;/p&gt;
{ &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;g&quot;, &quot;h&quot;, &quot;i&quot; }
&lt;p&gt;;&lt;/p&gt;

&lt;p&gt;Anyway, a patch is attached which adds more unit tests, and modifies IndexedSliceReader.IndexedBlockFetcher &amp;amp; IndexedSliceReader.SimpleBlockFetcher &lt;/p&gt;</description>
                <environment></environment>
        <key id="12671547">CASSANDRA-6119</key>
            <summary>IndexedSliceReader can skip columns when fetching multiple contiguous slices</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="frousseau">Fabien Rousseau</assignee>
                                    <reporter username="frousseau">Fabien Rousseau</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Oct 2013 10:32:47 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:04 +0000</updated>
                            <resolved>Thu, 3 Oct 2013 09:11:21 +0000</resolved>
                                        <fixVersion>1.2.11</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13783107" author="slebresne" created="Tue, 1 Oct 2013 16:40:28 +0000"  >&lt;p&gt;Thanks Fabien, you&apos;re right, ISR can skip columns.&lt;/p&gt;

&lt;p&gt;On the patch itself, it seems to me the actual bug if about dealing with the last column when exiting the main loop of both fetcher, the setNextSlice seem unrelated to the bug itself. And I believe those setNextSlice changes mainly inline in setNextSlice the tests that would be done by the next iterator of the main loop otherwise, so I&apos;m not sure they are really optimisations. If I&apos;m right about that, I&apos;d really rather leave those changes away because the logic of ISR is already not the easier to follow, so I&apos;d rather limit the number of cases as much as possible (unless there is a clear benefit performance wise).&lt;/p&gt;

&lt;p&gt;As for the stopping conditions of the &quot;main&quot; BlockFetcher loops, I believe that for IndexedBlockFetcher it&apos;s enough to just not exit the loop until &lt;tt&gt;column != null&lt;/tt&gt;, which avoids having to add a new case at the end. As for SimpleBlockFetcher, figured we could slightly refactor the loop to mimic the method of IndexedBlockFetcher too. Attaching a v2 with what I have in mind.&lt;/p&gt;</comment>
                            <comment id="13783806" author="frousseau" created="Wed, 2 Oct 2013 10:33:52 +0000"  >&lt;p&gt;After having reviewed your patch, it has definitely a better approach minimising code change and better readability&lt;/p&gt;

&lt;p&gt;So I&apos;m +1 for your patch&lt;/p&gt;</comment>
                            <comment id="13784938" author="slebresne" created="Thu, 3 Oct 2013 09:11:21 +0000"  >&lt;p&gt;Committed, thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12606130" name="6119-v2.txt" size="13784" author="slebresne" created="Tue, 1 Oct 2013 16:40:28 +0000"/>
                            <attachment id="12606075" name="6119.patch" size="17609" author="frousseau" created="Tue, 1 Oct 2013 10:36:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[frousseau]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>351257</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 7 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1okaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>351549</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324948">1.2.10</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>