<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:20:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2428] Running cleanup on a node with join_ring=false removes all data</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2428</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;If you need to bring up a node with join_ring=false for operator maintenance, and this node already has data, it will end up removing the data on the node. We noticed this when we were calling cleanup on a specific CF.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12503560">CASSANDRA-2428</key>
            <summary>Running cleanup on a node with join_ring=false removes all data</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="lenn0x">Chris Goffinet</reporter>
                        <labels>
                    </labels>
                <created>Wed, 6 Apr 2011 21:58:45 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:02 +0000</updated>
                            <resolved>Thu, 7 Apr 2011 21:00:57 +0000</resolved>
                                        <fixVersion>0.7.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13016569" author="lenn0x" created="Wed, 6 Apr 2011 21:58:50 +0000"  >&lt;p&gt;If curious why we were running join_ring = false after the node had data, it was because we had ran out of space on a node, and many SSTables had been created, but unable to compact. When we brought the node back online after moving some data off, the number of SSTables being read w/ live traffic caused us to run out of file descriptors. So we decided to run join_ring=false on bootup, and let compaction run without taking on traffic. This worked really well, and we wanted to finalize our cleanup process.&lt;/p&gt;</comment>
                            <comment id="13017111" author="slebresne" created="Thu, 7 Apr 2011 20:01:45 +0000"  >&lt;p&gt;The ability of not joining on startup is a convenience feature but is honestly a bit half backed. In particular the token ranges are not set correctly. That&apos;s the reason why cleanup gets an empty list of ranges when querying the local ranges and thus clean everything.&lt;/p&gt;

&lt;p&gt;Attached patch band-aid this by refusing to do a cleanup compaction. I don&apos;t think we want to do more for 0.7. We could make join_ring=false better so that it sets the ranges based and what&apos;s in the system tables, but let&apos;s fix the dangerous behavior first and let that for another ticket.&lt;/p&gt;</comment>
                            <comment id="13017137" author="kingryan" created="Thu, 7 Apr 2011 20:38:00 +0000"  >&lt;p&gt;Sylvain-&lt;/p&gt;

&lt;p&gt;That seems like the right plan.&lt;/p&gt;</comment>
                            <comment id="13017139" author="jbellis" created="Thu, 7 Apr 2011 20:40:45 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13017144" author="slebresne" created="Thu, 7 Apr 2011 21:00:57 +0000"  >&lt;p&gt;Committed as r1090007&lt;/p&gt;</comment>
                            <comment id="13017205" author="hudson" created="Thu, 7 Apr 2011 23:44:17 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #426 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/426/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/426/&lt;/a&gt;)&lt;br/&gt;
    Fix unit tests for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2428&quot; title=&quot;Running cleanup on a node with join_ring=false removes all data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2428&quot;&gt;&lt;del&gt;CASSANDRA-2428&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12475742" name="0001-Don-t-allow-cleanup-when-node-hasn-t-join-the-ring.patch" size="1099" author="slebresne" created="Thu, 7 Apr 2011 20:01:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20619</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 33 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gbbj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>93264</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>