<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:50:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-8406] Add option to set max_sstable_age in fractional days in DTCS</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-8406</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Using days as the unit for max_sstable_age in DTCS might be too much, add option to set it in seconds&lt;/p&gt;</description>
                <environment></environment>
        <key id="12758861">CASSANDRA-8406</key>
            <summary>Add option to set max_sstable_age in fractional days in DTCS</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marcuse">Marcus Eriksson</assignee>
                                    <reporter username="marcuse">Marcus Eriksson</reporter>
                        <labels>
                            <label>doc-impacting</label>
                            <label>dtcs</label>
                    </labels>
                <created>Tue, 2 Dec 2014 10:46:05 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:26 +0000</updated>
                            <resolved>Tue, 17 Feb 2015 09:37:47 +0000</resolved>
                                        <fixVersion>2.1.5</fixVersion>
                                    <component>Local/Compaction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14231295" author="krummas" created="Tue, 2 Dec 2014 10:47:53 +0000"  >&lt;p&gt;_days is still prioritized above _seconds, you get a warning if you set both&lt;/p&gt;</comment>
                            <comment id="14236478" author="jbellis" created="Sat, 6 Dec 2014 02:02:27 +0000"  >&lt;p&gt;I&apos;m still -0 on adding two options for the same functionality.  And I still think days is usually the &quot;right&quot; unit to encourage in production.&lt;/p&gt;</comment>
                            <comment id="14241369" author="bj0rn" created="Wed, 10 Dec 2014 16:50:56 +0000"  >&lt;p&gt;I proposed another approach in my last comment on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8340&quot; title=&quot;Use sstable min timestamp when deciding if an sstable should be included in DTCS compactions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8340&quot;&gt;&lt;del&gt;CASSANDRA-8340&lt;/del&gt;&lt;/a&gt; (which, by the way, is very tightly coupled to this ticket). The idea is to specify max window re-merge instead of max sstable age. That option would mean, very nearly, &quot;how many times do you want each value to be rewritten?&quot;. The good thing about that option in this context is that it scales relatively to window size. If small time windows are used (low baseTime), then a small max_window_exponent will indeed lead to a max SSTable age far lower than a day. Consider min_threshold=4 and base_time_seconds=60. Then max_window_exponent=3 would create all the way up to 64-minute windows, and stop after that. With max_window_exponent=10, the largest windows will be ~2 years (actually ~1.995 years, coincidentally).&lt;/p&gt;

&lt;p&gt;I can implement this. It would not be difficult. But what do you think? Is this option too confusing? Is it a bad thing that changing base_time_seconds also changes the max SSTable age (linearly)? And that min_threshold does the same (polynomially)? It&apos;s just that the number of recompactions is what this is all about anyway. So why not be explicit about it?&lt;/p&gt;

&lt;p&gt;On a second note, would it make sense for some other behavior than &quot;no more compactions ever&quot; after SSTables get too old? For instance, how about a flag that makes DTCS create infinitely many same-size windows preceding the max window size? So in my first example, infinite 64-minute windows would be produced. In the event of a repair or out-of-order write, a window many days old may be touched and a compaction would trigger in that window. I&apos;m not suggesting this as a default, but maybe it&apos;s useful for something?&lt;/p&gt;</comment>
                            <comment id="14296904" author="krummas" created="Thu, 29 Jan 2015 14:20:12 +0000"  >&lt;p&gt;attaching patch to allow fractional days&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Bj0rn&quot; class=&quot;user-hover&quot; rel=&quot;Bj0rn&quot;&gt;Bj0rn&lt;/a&gt; it sounds neat, but I think that might be too complicated for users (is using max_sstable_age in days enough for you in your &lt;del&gt;testing&lt;/del&gt; setup?)&lt;/p&gt;</comment>
                            <comment id="14306403" author="jshook" created="Thu, 5 Feb 2015 01:32:13 +0000"  >&lt;p&gt;+1 on 0001-8406.patch&lt;/p&gt;</comment>
                            <comment id="14308037" author="bj0rn" created="Thu, 5 Feb 2015 21:35:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krummas&quot; class=&quot;user-hover&quot; rel=&quot;krummas&quot;&gt;krummas&lt;/a&gt; well we did try max_sstable_age_days=1 in a new table, just the other day. This table has a default_time_to_live at 1 day, and the hope was that SSTables older than that would just disappear. That&apos;s not the case, and it may be timely for me to address this ticket now: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8359&quot; title=&quot;Make DTCS consider removing SSTables much more frequently&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8359&quot;&gt;&lt;del&gt;CASSANDRA-8359&lt;/del&gt;&lt;/a&gt;. With that fixed, I think that having max_sstable_age equal to the default_time_to_live of the table is the obviously right setting, giving very efficient behavior. Why compact something that&apos;s about to go away? If it works as well as I hope, the next logical step might be to set max_sstable_age automatically when default_time_to_live is set. And if someone wants to use default_time_to_live &amp;lt; 1 day, I don&apos;t see why they shouldn&apos;t be able to use max_sstable_age &amp;lt; 1 day. So I do see a case for max_sstable_age being less than days. And for something like this, having the setting in seconds seems most appropriate. But the floating point solution is probably a viable compromise.&lt;/p&gt;

&lt;p&gt;I suppose the main argument for having the setting in seconds is: why is default_time_to_live in seconds when max_sstable_age is not?&lt;/p&gt;</comment>
                            <comment id="14323995" author="krummas" created="Tue, 17 Feb 2015 09:37:47 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12695275" name="0001-8406.patch" size="5893" author="marcuse" created="Thu, 29 Jan 2015 14:20:12 +0000"/>
                            <attachment id="12684616" name="0001-patch.patch" size="5316" author="marcuse" created="Tue, 2 Dec 2014 10:47:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 40 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i22yjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jshook</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jshook]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>