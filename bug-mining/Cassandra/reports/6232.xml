<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:27:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-17918] DESCRIBE output does not quote column names using reserved keywords</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-17918</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;The DESCRIBE output of the column names that using reserved keywords are not quoted for UDTs. The following test reproduces. Reading the code, it looks like that the such columns names are not quoted in materialized view, UDF and user defined aggregation.&#160;&lt;br/&gt;
The impact of the bug is that schema described cannot be imported due to the usage of reserved keywords as column names.&#160;&lt;br/&gt;
&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &#160; @Test
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testUsingReservedInCreateType() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Throwable
&#160; &#160; {
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; type = createType(KEYSPACE_PER_TEST, &lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TYPE %s (\&quot;&lt;/span&gt;token\&lt;span class=&quot;code-quote&quot;&gt;&quot; text, \&quot;&lt;/span&gt;desc\&lt;span class=&quot;code-quote&quot;&gt;&quot; text);&quot;&lt;/span&gt;);&#160; &#160; &#160; &#160;        assertRowsNet(executeDescribeNet(KEYSPACE_PER_TEST, &lt;span class=&quot;code-quote&quot;&gt;&quot;DESCRIBE TYPE &quot;&lt;/span&gt; + type),
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; row(KEYSPACE_PER_TEST, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;, type, &lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TYPE &quot;&lt;/span&gt; + KEYSPACE_PER_TEST + &lt;span class=&quot;code-quote&quot;&gt;&quot;.&quot;&lt;/span&gt; + type + &lt;span class=&quot;code-quote&quot;&gt;&quot; (\n&quot;&lt;/span&gt; +
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot; &#160; &#160;\&quot;&lt;/span&gt;token\&lt;span class=&quot;code-quote&quot;&gt;&quot; text,\n&quot;&lt;/span&gt; +
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot; &#160; &#160;\&quot;&lt;/span&gt;desc\&lt;span class=&quot;code-quote&quot;&gt;&quot; text\n&quot;&lt;/span&gt; +
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;);&quot;&lt;/span&gt;));
&#160; &#160; } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;ins&gt;Additional information for newcomers:&lt;/ins&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Unit tests for DESCRIBE statements are in &lt;tt&gt;DescribeStatementTest&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;The statement implementation is in &lt;tt&gt;DescribeStatement and fetch the create statement from the different schema element using&#160; SchemaElement.toCqlString&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13482820">CASSANDRA-17918</key>
            <summary>DESCRIBE output does not quote column names using reserved keywords</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="smiklosovic">Stefan Miklosovic</assignee>
                                    <reporter username="yifanc">Yifan Cai</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Sep 2022 19:55:54 +0000</created>
                <updated>Sun, 12 Nov 2023 20:59:18 +0000</updated>
                            <resolved>Thu, 11 May 2023 14:16:58 +0000</resolved>
                                        <fixVersion>4.0.10</fixVersion>
                    <fixVersion>4.1.2</fixVersion>
                    <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Legacy/CQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3000">50m</timespent>
                                <comments>
                            <comment id="17615385" author="JIRAUSER285406" created="Mon, 10 Oct 2022 23:08:40 +0000"  >&lt;p&gt;Proposed fix:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;PR&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;trunk&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1907&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1905&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;3.11&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1906&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/bbotella/cassandra/43/workflows/5652e192-67e3-4f1c-b6c7-95b9e3326178&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Circle 1&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/bbotella/cassandra/42/workflows/7f7171c6-075b-4bb0-b394-d92a2e201827&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Circle 2&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17615579" author="blerer" created="Tue, 11 Oct 2022 08:13:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bernardo.botella&quot; class=&quot;user-hover&quot; rel=&quot;bernardo.botella&quot;&gt;bernardo.botella&lt;/a&gt; Thanks a lot for the patches &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. Unfortunately, the approach you took for the patches is not the correct one (the C* code base isconfusing). Internally C* does not keep the quotes. It eliminates them on input and add them back when recreating the statements for the DESCRIBE.&lt;/p&gt;

&lt;p&gt;I added some information in the &lt;b&gt;Description&lt;/b&gt; section to help you find the parts of the code that need to be modified.&lt;/p&gt;

&lt;p&gt;We changed the way DESCRIBE was working in C* 4.0 and moved it on the server side before that DESCRIBE was implemented at the CQLSH level using the python driver. This bug only affect 4.0, 4.1 and trunk. No need to worry about 3.11 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17617349" author="JIRAUSER285406" created="Thu, 13 Oct 2022 23:26:42 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt; thanks a lot for the directions! Hopefully this will make more sense.&lt;/p&gt;

&lt;p&gt;Proposed fix:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;PR&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;trunk&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1907&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1905&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17623438" author="JIRAUSER285406" created="Mon, 24 Oct 2022 22:04:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yifanc&quot; class=&quot;user-hover&quot; rel=&quot;yifanc&quot;&gt;yifanc&lt;/a&gt; I just updated the trunk PR with a new unit test covering (hopefully) the missing cases.&lt;/p&gt;</comment>
                            <comment id="17636060" author="JIRAUSER285406" created="Fri, 18 Nov 2022 22:10:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yifanc&quot; class=&quot;user-hover&quot; rel=&quot;yifanc&quot;&gt;yifanc&lt;/a&gt; New revision updated.&lt;/p&gt;</comment>
                            <comment id="17640986" author="yifanc" created="Tue, 29 Nov 2022 23:22:19 +0000"  >&lt;p&gt;+1 on the patch to trunk. We will need an additional patch for cassandra-4.1 branch :|&lt;/p&gt;</comment>
                            <comment id="17641010" author="JIRAUSER285406" created="Wed, 30 Nov 2022 00:44:19 +0000"  >&lt;p&gt;Here are the patches for the 3 branches:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;PR&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Circle&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;trunk&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1907&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/bbotella/cassandra?branch=CASSANDRA-17918-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/2035&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/bbotella/cassandra?branch=CASSANDRA-17918-cassandra-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4.1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/2034&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/bbotella/cassandra?branch=CASSANDRA-17918-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Link&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17642208" author="yifanc" created="Thu, 1 Dec 2022 23:56:35 +0000"  >&lt;p&gt;+1 on all the patches.&lt;/p&gt;

&lt;p&gt;The entries in changes.txt need to be modified so it reflects the patched is merged up from 4.0 branch. I will modify changes.txt and run CI once again on committing.&#160;&lt;/p&gt;</comment>
                            <comment id="17642629" author="yifanc" created="Fri, 2 Dec 2022 17:43:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;&#160;, can you take another look?&#160;&lt;/p&gt;</comment>
                            <comment id="17644253" author="blerer" created="Wed, 7 Dec 2022 09:42:19 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bernardo.botella&quot; class=&quot;user-hover&quot; rel=&quot;bernardo.botella&quot;&gt;bernardo.botella&lt;/a&gt;. The patch looks good to me. &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yifanc&quot; class=&quot;user-hover&quot; rel=&quot;yifanc&quot;&gt;yifanc&lt;/a&gt; were the new tests checked for flakiness?&lt;/p&gt;</comment>
                            <comment id="17644956" author="yifanc" created="Thu, 8 Dec 2022 19:38:51 +0000"  >&lt;p&gt;Rebased all branches and started the full CI runs. I will run the repeated test for the new tests after those finishes. &lt;/p&gt;

&lt;p&gt;CI Results (pending):&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Source&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Circle CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;cassandra-4.0&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/yifan-c/cassandra/tree/commit_remote_branch/CASSANDRA-17918-cassandra-4.0-F5705D26-0685-449B-98DB-523066CDC82C&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/yifan-c/cassandra?branch=commit_remote_branch%2FCASSANDRA-17918-cassandra-4.0-F5705D26-0685-449B-98DB-523066CDC82C&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;cassandra-4.1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/yifan-c/cassandra/tree/commit_remote_branch/CASSANDRA-17918-cassandra-4.1-F5705D26-0685-449B-98DB-523066CDC82C&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/yifan-c/cassandra?branch=commit_remote_branch%2FCASSANDRA-17918-cassandra-4.1-F5705D26-0685-449B-98DB-523066CDC82C&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;trunk&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/yifan-c/cassandra/tree/commit_remote_branch/CASSANDRA-17918-trunk-F5705D26-0685-449B-98DB-523066CDC82C&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/yifan-c/cassandra?branch=commit_remote_branch%2FCASSANDRA-17918-trunk-F5705D26-0685-449B-98DB-523066CDC82C&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17644991" author="yifanc" created="Thu, 8 Dec 2022 21:17:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bernardo.botella&quot; class=&quot;user-hover&quot; rel=&quot;bernardo.botella&quot;&gt;bernardo.botella&lt;/a&gt;, bunch of tests failed. Can you take a look? (See the circle CI links in my comment).&lt;/p&gt;</comment>
                            <comment id="17717161" author="smiklosovic" created="Thu, 27 Apr 2023 12:23:37 +0000"  >&lt;p&gt;I will try to refresh this work, I will assign this to myself for a while due to the inactivity of the author.&#160;&lt;/p&gt;</comment>
                            <comment id="17719367" author="smiklosovic" created="Thu, 4 May 2023 14:47:48 +0000"  >&lt;p&gt;The problem with tests is that the patch introduces this result of aggregate description, for example it would describe an aggregate like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
CREATE AGGREGATE cqlshtests_dligxmowmx.aggmax(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)
&#160; &#160; SFUNC cqlshtests_dligxmowmx.&lt;span class=&quot;code-quote&quot;&gt;&quot;fmax&quot;&lt;/span&gt;
&#160; &#160; STYPE &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This does not work because the the value of SFUNC is in form &quot;keyspace.name&quot; and it does not accept this. There can not be &quot;.&quot;. It just expects name of the function.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/antlr/Parser.g#L671&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/trunk/src/antlr/Parser.g#L671&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/antlr/Parser.g#L1567&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/trunk/src/antlr/Parser.g#L1567&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So the original author introduced something to CQL but parser was not modified.&lt;/p&gt;

&lt;p&gt;I do not know how to fix this. I think we should just leave it out as it was and we should just quote the function name. If we are creating an aggregate on some keyspace, I do not think that SFUNC is going to ever be something else from a function in that keyspace. So the further distinction what keyspace that SFUNC is from does not make a lot of sense.&lt;/p&gt;

&lt;p&gt;my PR for trunk is here which builds on top of the original work:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/2308&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2308&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2177/workflows/36b2e8b5-1ea8-4579-bc4a-5dca6db4e07f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2177/workflows/36b2e8b5-1ea8-4579-bc4a-5dca6db4e07f&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17719776" author="blerer" created="Fri, 5 May 2023 09:48:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; I would just add some function and aggregate to the &lt;tt&gt;testDescribeRoundtrip&lt;/tt&gt; testcase as a safety net to the problem you raised but otherwise your patch looks good to me.&lt;/p&gt;</comment>
                            <comment id="17719777" author="smiklosovic" created="Fri, 5 May 2023 09:49:12 +0000"  >&lt;p&gt;Thanks, I ll look at that.&lt;/p&gt;</comment>
                            <comment id="17720792" author="smiklosovic" created="Tue, 9 May 2023 06:00:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt; would you formally +1 it, please?&lt;/p&gt;

&lt;p&gt;4.0 &lt;a href=&quot;https://github.com/apache/cassandra/pull/2316&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2316&lt;/a&gt;&lt;br/&gt;
4.1 &lt;a href=&quot;https://github.com/apache/cassandra/pull/2315&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2315&lt;/a&gt;&lt;br/&gt;
trunk &lt;a href=&quot;https://github.com/apache/cassandra/pull/2308&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2308&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4.0 j8 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2182/workflows/4318dee4-ecbe-4bd2-9b16-19b95ef0a908&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2182/workflows/4318dee4-ecbe-4bd2-9b16-19b95ef0a908&lt;/a&gt;&lt;br/&gt;
4.0 j11 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2182/workflows/0a057ebc-7ddc-405d-a799-28e755b16430&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2182/workflows/0a057ebc-7ddc-405d-a799-28e755b16430&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4.1 j8 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2187/workflows/5b533e45-dc6b-4321-9989-be75512d4b80&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2187/workflows/5b533e45-dc6b-4321-9989-be75512d4b80&lt;/a&gt;&lt;br/&gt;
4.1 j11 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2187/workflows/4e175503-d295-4bfb-9bdd-bede3748ccfe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2187/workflows/4e175503-d295-4bfb-9bdd-bede3748ccfe&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;trunk j8 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2186/workflows/a3d43d13-482d-4925-84a2-ea618961ecaa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2186/workflows/a3d43d13-482d-4925-84a2-ea618961ecaa&lt;/a&gt;&lt;br/&gt;
trunk j11 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2186/workflows/eba2fa9a-93b2-4362-8b39-64f11909d53f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2186/workflows/eba2fa9a-93b2-4362-8b39-64f11909d53f&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17721076" author="yifanc" created="Tue, 9 May 2023 20:09:13 +0000"  >&lt;p&gt;+1 on the patch. Thanks you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; for taking it up and finding the issue with SFUNC/FINALFUNC/etc.&#160;&lt;/p&gt;</comment>
                            <comment id="17721839" author="blerer" created="Thu, 11 May 2023 16:06:51 +0000"  >&lt;p&gt;Sorry, I am late but adding my +1 for the record. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310660">
                    <name>Completes</name>
                                            <outwardlinks description="fixes">
                                        <issuelink>
            <issuekey id="13557620">CASSANDRA-19019</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[smiklosovic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12988" cascade-level="1"><![CDATA[API / Semantic Implementation]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12970"><![CDATA[Unit Test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 26 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z18s0o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
        <customfieldvalue><![CDATA[ycai]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12350367">4.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/75194201f1f06d120f246f6fad025ca5f672943d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/75194201f1f06d120f246f6fad025ca5f672943d&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Submitting fixes for the different branches&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>