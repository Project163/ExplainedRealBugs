<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:25:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-17575] forceCompactionForTokenRange when using a wrapped range may include sstables not within that range</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-17575</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;This was found in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17537&quot; title=&quot;nodetool compact should support using a key string to find the range to avoid operators having to manually do this&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17537&quot;&gt;&lt;del&gt;CASSANDRA-17537&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;When you compact the range (32, 31] this should include everything BUT 32, but in the test org.apache.cassandra.db.compaction.LeveledCompactionStrategyTest#testTokenRangeCompaction it found that SSTables with the bounds (32, 32) were getting included in the set of SSTables to compact&lt;/p&gt;</description>
                <environment></environment>
        <key id="13441229">CASSANDRA-17575</key>
            <summary>forceCompactionForTokenRange when using a wrapped range may include sstables not within that range</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="adelapena">Andres de la Pe&#241;a</assignee>
                                    <reporter username="dcapwell">David Capwell</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Apr 2022 20:50:47 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:59 +0000</updated>
                            <resolved>Fri, 12 Aug 2022 09:46:10 +0000</resolved>
                                        <fixVersion>3.11.14</fixVersion>
                    <fixVersion>4.0.6</fixVersion>
                    <fixVersion>4.1-beta1</fixVersion>
                    <fixVersion>4.1</fixVersion>
                    <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Local/Compaction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4200">1h 10m</timespent>
                                <comments>
                            <comment id="17536178" author="edimitrova" created="Thu, 12 May 2022 15:11:54 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;, I am triaging tickets and I am a bit confused here - (32,31] and (32,32) are kind of the same, no?&lt;/p&gt;

&lt;p&gt;Did you mean to say 32 was also included during testing?&lt;/p&gt;</comment>
                            <comment id="17544960" author="edimitrova" created="Wed, 1 Jun 2022 15:02:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;, I was wondering whether you had the chance to look at this?&#160;&lt;/p&gt;</comment>
                            <comment id="17546805" author="edimitrova" created="Fri, 3 Jun 2022 19:32:20 +0000"  >&lt;p&gt;Talked to&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;about this one yesterday, he will get back to it to clarify the exact issue.&lt;/p&gt;</comment>
                            <comment id="17566922" author="brandon.williams" created="Thu, 14 Jul 2022 17:21:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt; can you clarify what this ticket needs?&lt;/p&gt;</comment>
                            <comment id="17569174" author="dcapwell" created="Wed, 20 Jul 2022 21:10:43 +0000"  >&lt;p&gt;sorry never got the time to work on this.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; the test linked, if you change to do (32, 31] you see that compaction included a partition it shouldn&apos;t have; we include partition 32 even though the range filters out that partition.  This ticket should figure out why we include the wrong partition and attempt to fix it so we stop&lt;/p&gt;</comment>
                            <comment id="17569529" author="adelapena" created="Thu, 21 Jul 2022 16:53:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;if you change to do (32, 31] you see that compaction included a partition it shouldn&apos;t have; we include partition 32 even though the range filters out that partition. This ticket should figure out why we include the wrong partition and attempt to fix it so we stop&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think that&#160;&lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-4.1/test/unit/org/apache/cassandra/db/compaction/LeveledCompactionStrategyTest.java#L503-L511&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;wrappingRange&lt;/tt&gt;&lt;/a&gt; in that test actually is &lt;tt&gt;(32, 31]&lt;/tt&gt; without changing it. I understand that &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-4.1/test/unit/org/apache/cassandra/db/compaction/LeveledCompactionStrategyTest.java#L520-L521&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the asserted value&lt;/a&gt; should be 11 instead of 1, because we don&apos;t compact the ten &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;32, 32&amp;#93;&lt;/span&gt;&lt;/tt&gt; sstables, but only the the ten &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;31,32&amp;#93;&lt;/span&gt;&lt;/tt&gt; and the ten &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;31, 31&amp;#93;&lt;/span&gt;&lt;/tt&gt; sstables. So 20 sstables compacted into one single sstable, plus 10 uncompacted sstables, makes 11 sstables. Is that right?&lt;/p&gt;

&lt;p&gt;Probably the issue is on &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/db/compaction/CompactionManager.java#L991&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;CompactionManger#sstablesInBounds&lt;/tt&gt;&lt;/a&gt;, where it passes token ranges that exclude the start bound to &lt;a href=&quot;https://github.com/apache/cassandra/blob/e4e19e33faf9ac7cf27a9779c8083a7f5c5b865a/src/java/org/apache/cassandra/db/lifecycle/View.java#L181-L185&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;View.sstablesInBounds&lt;/tt&gt;&lt;/a&gt;, which includes both bounds.&lt;/p&gt;

&lt;p&gt;Also, what token range should we use to compact a single token? &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-4.1/test/unit/org/apache/cassandra/db/compaction/LeveledCompactionStrategyTest.java#L446-L447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Here&lt;/a&gt; the test uses &lt;tt&gt;(32, 32]&lt;/tt&gt;, although for the comment it seems that the intention in the past was to use &lt;tt&gt;(31, 32])&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17570030" author="adelapena" created="Fri, 22 Jul 2022 13:48:15 +0000"  >&lt;p&gt;Ok, it seems that the problem is that &lt;tt&gt;CompactionManager.sstablesInBounds&lt;/tt&gt; does&apos;t correctly use the half-open token intervals to select the sstable closed intervals, &lt;a href=&quot;https://github.com/apache/cassandra/blob/ab9ab903fa590409251e97fe075e02a64c8aa4f3/src/java/org/apache/cassandra/db/compaction/CompactionManager.java#L982&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; and &lt;a href=&quot;https://github.com/apache/cassandra/blob/ab9ab903fa590409251e97fe075e02a64c8aa4f3/src/java/org/apache/cassandra/db/compaction/CompactionManager.java#L991&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. That indeed translates the token range &lt;tt&gt;(32, 31]&lt;/tt&gt; to a selection of &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;32, 31&amp;#93;&lt;/span&gt;&lt;/tt&gt;, which means the entire token range.&lt;/p&gt;

&lt;p&gt;Also, the test uses the range &lt;tt&gt;(32, 32]&lt;/tt&gt; to compact only the sstables containing the token &lt;tt&gt;32&lt;/tt&gt;. That incidentally works because the range is somehow translated to &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;32, 32&amp;#93;&lt;/span&gt;&lt;/tt&gt;. However, I think that the meaning of &lt;tt&gt;(32, 32]&lt;/tt&gt; is that it&apos;s a wrapping range that selects all the tokens. So the way of compacting just the token &lt;tt&gt;32&lt;/tt&gt; should be using the previous token, as in &lt;tt&gt;(31, 32]&lt;/tt&gt;. This is suggested by &lt;a href=&quot;https://github.com/apache/cassandra/blob/ab9ab903fa590409251e97fe075e02a64c8aa4f3/test/unit/org/apache/cassandra/db/compaction/LeveledCompactionStrategyTest.java#L446&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this comment&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Note that currently &lt;tt&gt;nodetool compact -st 32 -et 32&lt;/tt&gt; compacts only the token &lt;tt&gt;32&lt;/tt&gt;. If we fix &lt;tt&gt;CompactionManager.sstablesInBounds&lt;/tt&gt; to properly interpret the token ranges, that command would change to compact the entire ring, which is dramatically different.&lt;/p&gt;

&lt;p&gt;The proposed patch modifies the behaviour of &lt;tt&gt;CompactionManager.sstablesInBounds&lt;/tt&gt; to properly interpret token ranges. It accordingly changes the expectations of &lt;tt&gt;LeveledCompactionStrategyTest#testTokenRangeCompaction&lt;/tt&gt;. I have also updated the help of &lt;tt&gt;nodetool compact&lt;/tt&gt; to document when a token is inclusive or exclusive, similarly to what was done in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15545&quot; title=&quot;update nodetool repair help command to document when a token is inclusive or exclusive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15545&quot;&gt;&lt;del&gt;CASSANDRA-15545&lt;/del&gt;&lt;/a&gt;. Maybe we should also add a note on &lt;tt&gt;NEWS.txt&lt;/tt&gt;.&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Patch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1742/commits/02cbeb2713d9c6c9d98ad9e2e5cce8f92c041a7a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11 &lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1948/workflows/65b64c73-adb0-4fb7-bf7d-e3fdce9577f4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1743/commits/734644d91fc7d0f00c199d3eed766b984c92e86b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0 &lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1947/workflows/8ad79cc7-2656-4afb-917b-9fd890418995&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1947/workflows/e775dd2f-5733-4b1c-8e11-3970daafe7c6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1744/commits/a989b594dff18180d912403ffec1474321856227&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1 &lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1946/workflows/71fc99c5-994d-4133-bf4f-57aa712c6542&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1946/workflows/49d782ac-e162-419b-bd3e-a5f3086d474c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1745/commits/f34e675a008358bc9156c23e5fbb1fa345a9c138&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1945/workflows/3ae3bcec-301e-440d-a55f-20b99890c57b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1945/workflows/716c2a1f-8eea-4fb9-9109-278d74e1b276&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;An alternative approach would be just preserving the current behaviour and add documentation about how the token ranges used in manual compaction are interpreted as closed. That would have the problem doing an odd use of the &lt;tt&gt;Range&lt;/tt&gt; class across the codebase, and been inconsistent with other tools such as repair.&lt;/p&gt;</comment>
                            <comment id="17571890" author="adelapena" created="Wed, 27 Jul 2022 12:29:29 +0000"  >&lt;p&gt;As pointed out by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jjordan&quot; class=&quot;user-hover&quot; rel=&quot;jjordan&quot;&gt;jjordan&lt;/a&gt; on &lt;a href=&quot;https://lists.apache.org/list.html?dev@cassandra.apache.org&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the mail list&lt;/a&gt;, using closed intervals for token range compactions actually makes sense. The token ranges passed to &lt;tt&gt;nodetool compact&lt;/tt&gt; would probably come from &lt;tt&gt;sstablemetadata&lt;/tt&gt;, which presents the first and last tokens in the sstable. This is a closed interval, matched by &lt;tt&gt;nodetool compact&lt;/tt&gt; closed intervals.&lt;/p&gt;

&lt;p&gt;Also, a common use case is compacting a sstable with a single big partition. Half-open intervals don&apos;t allow to compact a single token, whereas closed intervals do allow it.&lt;/p&gt;

&lt;p&gt;What it is quite confusing, besides the lack of documentation, is that manual compaction uses &lt;tt&gt;Range&amp;lt;Token&amp;gt;&lt;/tt&gt; as argument, and the &lt;tt&gt;Range&lt;/tt&gt; class is half-open by definition (see &lt;a href=&quot;https://github.com/apache/cassandra/blob/1f067051537618804ca9d0c66b903be74b942b22/src/java/org/apache/cassandra/dht/Range.java#L33&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; and &lt;a href=&quot;https://github.com/apache/cassandra/blob/1f067051537618804ca9d0c66b903be74b942b22/src/java/org/apache/cassandra/dht/Range.java#L236-L239&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;). However, when compacting we interpret those ranges as if they where closed.&lt;/p&gt;

&lt;p&gt;We could use the closed interval &lt;tt&gt;Bounds&lt;/tt&gt; instead of &lt;tt&gt;Range&lt;/tt&gt; to better represent the intervals, but unfortunately &lt;tt&gt;Bounds&lt;/tt&gt; are not-wrapping whereas the manual compaction methods support wrapping ranges. Also, even if we moved to &lt;tt&gt;Bounds&lt;/tt&gt; we would still need to keep the ranges on the JMX methods for backwards compatibility.&lt;/p&gt;

&lt;p&gt;So I&apos;m just modifying the help of &lt;tt&gt;nodetool compact&lt;/tt&gt; and adding some comments on the related methods about how the ranges are interpreted:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;PR&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1742&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11 &lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1959/workflows/3f391a29-a6b3-4c3a-927f-b33bf8ababf0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1743&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0 &lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1958/workflows/120ace71-13ef-4968-b50c-3d1cc899eef4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1958/workflows/49e528f0-7203-4e53-b240-fca559724296&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1744&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1 &lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1960/workflows/d03a643e-e180-40ff-9700-bd9ab5b093bb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1960/workflows/03a70f7e-155a-43fb-97c2-cfb64fb35937&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1957/workflows/93336e6a-f6ef-4476-90ab-f678b898385d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1957/workflows/fdd6d458-2eea-4e4c-9330-771ff2f8b50b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17575824" author="edimitrova" created="Fri, 5 Aug 2022 12:49:33 +0000"  >&lt;p&gt;Thanks&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&#160;for getting to the bottom of this. I can review it next week if no one beats me to that. In the meantime removing it from the Kanban as a beta blocker&lt;/p&gt;</comment>
                            <comment id="17576990" author="edimitrova" created="Mon, 8 Aug 2022 21:40:00 +0000"  >&lt;p&gt;Overall LGTM.&lt;/p&gt;

&lt;p&gt;From what I see the patch is the same for all branches (4.0 link in the table is broken but I found it from the CI run), I left just two tiny suggestions on the 3.11 PR.&lt;/p&gt;

&lt;p&gt;CI also good. All known failures, some will disappear after rebase, like the simulator one which was recently fixed.&lt;/p&gt;</comment>
                            <comment id="17577418" author="adelapena" created="Tue, 9 Aug 2022 13:40:57 +0000"  >&lt;p&gt;Thanks for the review, I have addressed the suggestions, rebased and run CI:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;PR&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1742&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11 &lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1978/workflows/daea157d-071d-46e4-be96-a5035cb5e2a4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1743&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0  &lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1977/workflows/af17c3e8-d48e-4da4-bc89-7ef60bcec53b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1977/workflows/fb5a4071-d713-41fc-946d-50e6507d67be&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1744&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1  &lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1976/workflows/73720f5c-2a47-44ed-8b16-97a281d6ebcf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1976/workflows/d26aa01f-5d98-4e38-991c-313c052546ec&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1975/workflows/7d8af703-ef47-4fa9-abd0-c750644d6041&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/1975/workflows/46086c73-53c5-4d2c-9a5b-6e2a5a23b0bb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17578891" author="adelapena" created="Fri, 12 Aug 2022 09:43:57 +0000"  >&lt;p&gt;Committed to 3.11 as &lt;a href=&quot;https://github.com/apache/cassandra/commit/4e410fc46da5d6759463230ab09a718178dbd4d9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4e410fc46da5d6759463230ab09a718178dbd4d9&lt;/a&gt; and merged to &lt;a href=&quot;https://github.com/apache/cassandra/commit/174e0dc399c998a61eff670bd4980308a239482f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;, &lt;a href=&quot;https://github.com/apache/cassandra/commit/16be1ab073f6fac7df1ac838c7a89e862cf9f2e1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1&lt;/a&gt; and &lt;a href=&quot;https://github.com/apache/cassandra/commit/5279d7f57edf8760ccfb0b388b750b020dd97ac2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="12910075">CASSANDRA-10643</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13438468">CASSANDRA-17537</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[adelapena]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12988" cascade-level="1"><![CDATA[API / Semantic Implementation]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12970"><![CDATA[Unit Test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 13 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z11q8o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[e.dimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12337348">3.10</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/4e410fc46da5d6759463230ab09a718178dbd4d9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/4e410fc46da5d6759463230ab09a718178dbd4d9&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;tt&gt;LeveledCompactionStrategyTest#testTokenRangeCompaction&lt;/tt&gt; should be enough to cover this. The documentation&#160;of &lt;tt&gt;nodetool compact&lt;/tt&gt; and &lt;tt&gt;StorageServiceMBean.forceKeyspaceCompactionForTokenRange&lt;/tt&gt; should be updated.&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>