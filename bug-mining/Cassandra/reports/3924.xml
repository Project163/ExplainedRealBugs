<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:59:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10491] Inconsistent &quot;position&quot; numbering for keys in &quot;system_schema.columns&quot;</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10491</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;A single component partition key starts off with a -1 position.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh&amp;gt; CREATE TABLE test.table1 (key1 text, value1 text, value2 text, PRIMARY KEY(key1));
cqlsh&amp;gt; SELECT keyspace_name, table_name, column_name, kind, position FROM system_schema.columns WHERE keyspace_name = &lt;span class=&quot;code-quote&quot;&gt;&apos;test&apos;&lt;/span&gt; and  table_name = &lt;span class=&quot;code-quote&quot;&gt;&apos;table1&apos;&lt;/span&gt; ;

 keyspace_name | table_name | column_name | kind          | position
---------------+------------+-------------+---------------+----------
          test |     table1 |        key1 | partition_key |       -1
          test |     table1 |      value1 |       regular |       -1
          test |     table1 |      value2 |       regular |       -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A single component clustering key starts off with a 0 position.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh&amp;gt; CREATE TABLE test.table2 (key1 text, value1 text, value2 text, PRIMARY KEY(key1, value1));
cqlsh&amp;gt; SELECT keyspace_name, table_name, column_name, kind, position FROM system_schema.columns WHERE keyspace_name = &lt;span class=&quot;code-quote&quot;&gt;&apos;test&apos;&lt;/span&gt; and  table_name = &lt;span class=&quot;code-quote&quot;&gt;&apos;table2&apos;&lt;/span&gt; ;

 keyspace_name | table_name | column_name | kind          | position
---------------+------------+-------------+---------------+----------
          test |     table2 |        key1 | partition_key |       -1
          test |     table2 |      value1 |    clustering |        0
          test |     table2 |      value2 |       regular |       -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When another component is added to the partition key it starts at 0.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh&amp;gt; CREATE TABLE test.table3 (key1 text, value1 text, value2 text, PRIMARY KEY((key1, value1)));
cqlsh&amp;gt; SELECT keyspace_name, table_name, column_name, kind, position FROM system_schema.columns WHERE keyspace_name = &lt;span class=&quot;code-quote&quot;&gt;&apos;test&apos;&lt;/span&gt; and  table_name = &lt;span class=&quot;code-quote&quot;&gt;&apos;table3&apos;&lt;/span&gt; ;

 keyspace_name | table_name | column_name | kind          | position
---------------+------------+-------------+---------------+----------
          test |     table3 |        key1 | partition_key |        0
          test |     table3 |      value1 | partition_key |        1
          test |     table3 |      value2 |       regular |       -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which is the same as a multiple component clustering key.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh&amp;gt; CREATE TABLE test.table4 (key1 text, value1 text, value2 text, PRIMARY KEY(key1, value1, value2));
cqlsh&amp;gt; SELECT keyspace_name, table_name, column_name, kind, position FROM system_schema.columns WHERE keyspace_name = &lt;span class=&quot;code-quote&quot;&gt;&apos;test&apos;&lt;/span&gt; and  table_name = &lt;span class=&quot;code-quote&quot;&gt;&apos;table4&apos;&lt;/span&gt; ;

 keyspace_name | table_name | column_name | kind          | position
---------------+------------+-------------+---------------+----------
          test |     table4 |        key1 | partition_key |       -1
          test |     table4 |      value1 |    clustering |        0
          test |     table4 |      value2 |    clustering |        1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Shouldn&apos;t a single component partition key start off with a position of 0?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12903526">CASSANDRA-10491</key>
            <summary>Inconsistent &quot;position&quot; numbering for keys in &quot;system_schema.columns&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="mpenick">Michael Penick</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Oct 2015 22:29:21 +0000</created>
                <updated>Wed, 6 Nov 2019 21:57:09 +0000</updated>
                            <resolved>Fri, 6 Nov 2015 14:04:31 +0000</resolved>
                                        <fixVersion>3.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14950051" author="slebresne" created="Fri, 9 Oct 2015 08:02:15 +0000"  >&lt;p&gt;I tend to agree, there is no particular reason not to use 0 in that case.&lt;/p&gt;

&lt;p&gt;More generally, I think we should never use &lt;tt&gt;ColumnDefinition.NO_POSITION&lt;/tt&gt; for partition keys internally as we don&apos;t really need it and it doesn&apos;t make much sense (it only make sense from a historical point of view but that&apos;s not a good enough reason to keep it imo).&lt;/p&gt;</comment>
                            <comment id="14950448" author="iamaleksey" created="Fri, 9 Oct 2015 14:14:46 +0000"  >&lt;p&gt;What do you suggest doing instead? -1 there is a replacement for &lt;tt&gt;null&lt;/tt&gt;. The goal is to be able to let people have large numbers of columns (combined, in all of their tables in all keyspaces) and still be able to have a low tombstone warning/error threshold.&lt;/p&gt;</comment>
                            <comment id="14950483" author="slebresne" created="Fri, 9 Oct 2015 14:37:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;What do you suggest doing instead? -1 there is a replacement for &lt;tt&gt;null&lt;/tt&gt;.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Well, I have thinking 0. From a client perspective, for partition keys, the position means the position in the partition key, so it &lt;em&gt;is&lt;/em&gt; inconsistent to have the first partition key be 0 when there is 2 of them and -1 when there is only 1. Even internally, we used to use &lt;tt&gt;null&lt;/tt&gt; when there is a single partition key because internally the type is not a &lt;tt&gt;CompositeType&lt;/tt&gt;, but it&apos;s more logical to have partition key always have a position (and so never &lt;tt&gt;ColumnDefinition.NO_POSITION&lt;/tt&gt;), the same way clustering columns always have one.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The goal is to be able to let people have large numbers of columns (combined, in all of their tables in all keyspaces) and still be able to have a low tombstone warning/error threshold.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m either completely missing something or you&apos;re thinking of changes I&apos;m not suggesting, cause I fail to see how using a 0 instead of -1 would impact tombstone warning thresholds.&lt;/p&gt;</comment>
                            <comment id="14950488" author="iamaleksey" created="Fri, 9 Oct 2015 14:40:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m either completely missing something or you&apos;re thinking of changes I&apos;m not suggesting&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The latter. I assumed you suggested going back to &lt;tt&gt;null&lt;/tt&gt; there. My bad.&lt;/p&gt;</comment>
                            <comment id="14989558" author="slebresne" created="Wed, 4 Nov 2015 13:54:57 +0000"  >&lt;p&gt;Pushed patch for this &lt;a href=&quot;https://github.com/pcmanus/cassandra/commits/10491&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. Test results: &lt;a href=&quot;https://github.com/pcmanus/cassandra/commits/10491&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt; and &lt;a href=&quot;https://github.com/pcmanus/cassandra/commits/10491&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14993591" author="beobal" created="Fri, 6 Nov 2015 12:34:08 +0000"  >&lt;p&gt;+1 LGTM.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;LegacySSTableTest&lt;/tt&gt; was failing on the branch, and not on 3.0 but rebasing fixes that. I&apos;ve pushed that rebased version &lt;a href=&quot;https://github.com/beobal/cassandra/tree/10491&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;, where I&apos;ve also made a trivial change to a comment (but that&apos;s very much a nit &amp;amp; I won&apos;t complain if you disregard it).&lt;/p&gt;</comment>
                            <comment id="14993707" author="slebresne" created="Fri, 6 Nov 2015 14:04:31 +0000"  >&lt;p&gt;Committed (with the comment&apos;s fixes, which I&apos;m good with), thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12695662">CASSANDRA-6717</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13101"><![CDATA[Clients]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ms47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12332955">3.0.0 rc1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>samt</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>