<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:26:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-18294] die disk failure policy will not kill jvm as documented</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-18294</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;After Cassandra has successfully starts up with disk_failure_policy die, when encounter a file system error, Cassandra server will only throw exception instead of shut down gossip and client transport and kill JVM. Document: &lt;a href=&quot;https://cassandra.apache.org/doc/latest/cassandra/configuration/cass_yaml_file.html#disk_failure_policy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cassandra.apache.org/doc/latest/cassandra/configuration/cass_yaml_file.html#disk_failure_policy&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The reason for this is the default FS error handler is not handing policy die correctly. Instead of shutting down gossip and native transport, it throws an error.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The&#160;JVMStabilityInspectorTest is passing because the error handler is not set so no exception is thrown.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13526756">CASSANDRA-18294</key>
            <summary>die disk failure policy will not kill jvm as documented</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="curlylrt">Runtian Liu</assignee>
                                    <reporter username="curlylrt">Runtian Liu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Mar 2023 23:02:53 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:48 +0000</updated>
                            <resolved>Thu, 9 Mar 2023 16:07:58 +0000</resolved>
                                        <fixVersion>3.0.29</fixVersion>
                    <fixVersion>4.0.9</fixVersion>
                    <fixVersion>4.1.1</fixVersion>
                    <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Local/Config</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17695427" author="maxwellguo" created="Thu, 2 Mar 2023 03:29:19 +0000"  >&lt;p&gt;can you show more details on the error ? like the stack message or some thing else.&lt;/p&gt;</comment>
                            <comment id="17695436" author="JIRAUSER291682" created="Thu, 2 Mar 2023 03:48:01 +0000"  >&lt;p&gt;The error is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
j.lang.IllegalStateException:&#160;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; at&#160;o.a.c.s.DefaultFSErrorHandler.handleFSError(DefaultFSErrorHandler.java:88) at&#160;o.a.c.io.util.FileUtils.handleFSError(FileUtils.java:499) at&#160;o.a.c.u.JVMStabilityInspector.inspectDiskError(JVMStabilityInspector.java:73) at&#160;o.a.c.u.JVMStabilityInspector.inspectThrowable(JVMStabilityInspector.java:111) at&#160;o.a.c.u.JVMStabilityInspector.inspectThrowable(JVMStabilityInspector.java:60) at&#160;o.a.c.d.ColumnFamilyStore$Flush.run(ColumnFamilyStore.java:1104) at&#160;j.u.c.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at&#160;j.u.c.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at&#160;o.a.c.c.NamedThreadFactory.lambda$threadLocalDeallocator$0(NamedThreadFactory.java:83) at&#160;i.n.u.c.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) at&#160;java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)  &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We are running Cassandra with policy die but the Cassandra java process is not shutting down after this error.&lt;/p&gt;</comment>
                            <comment id="17695437" author="maxwellguo" created="Thu, 2 Mar 2023 03:50:30 +0000"  >&lt;p&gt;What is the version of your cassandra ?&lt;/p&gt;</comment>
                            <comment id="17695438" author="JIRAUSER291682" created="Thu, 2 Mar 2023 03:53:51 +0000"  >&lt;p&gt;I think this is the commit which breaks it: &lt;a href=&quot;https://github.com/apache/cassandra/commit/db034609554a3185c0808cc67e9f0c148cc912c4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/db034609554a3185c0808cc67e9f0c148cc912c4&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Previously, there is no error handler call in JVMStabilityInspector::inspectThrowable.&lt;/p&gt;

&lt;p&gt;The above commit introduces the error handler before shutting down JVM. With &quot;die&quot; disk failure policy, the error handler will throw exception so the jvm shutdown code won&apos;t be reached.&lt;/p&gt;</comment>
                            <comment id="17695439" author="JIRAUSER291682" created="Thu, 2 Mar 2023 03:56:45 +0000"  >&lt;p&gt;Cassandra version is 3.0.27.&lt;/p&gt;</comment>
                            <comment id="17695443" author="JIRAUSER291682" created="Thu, 2 Mar 2023 04:01:23 +0000"  >&lt;p&gt;Creating a pull request here: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2189&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2189&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I think this is affecting all the fix versions listed here: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15191&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-15191&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17695456" author="maxwellguo" created="Thu, 2 Mar 2023 05:18:48 +0000"  >&lt;p&gt;I just run your ut, and it seems the bug exist.&lt;br/&gt;
I think you should add some more jvm-dtest as &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15191&quot; title=&quot;stop_paranoid disk failure policy is ignored on CorruptSSTableException after node is up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15191&quot;&gt;&lt;del&gt;CASSANDRA-15191&lt;/del&gt;&lt;/a&gt; &apos;s JVMStabilityInspectorCorruptSSTableExceptionTest .&lt;br/&gt;
For your ut can just cover gossip is stopped, also I left some comments on this pr.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; can you take a look at this ?&lt;/p&gt;</comment>
                            <comment id="17695571" author="smiklosovic" created="Thu, 2 Mar 2023 09:11:23 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=curlylrt&quot; class=&quot;user-hover&quot; rel=&quot;curlylrt&quot;&gt;curlylrt&lt;/a&gt; for reporting this. I am trying to figure out why this has slipped. For example, we do not have &quot;die&quot; policy in handleCorruptSSTable method in DefaultFSErrorHandler either. If there is not some not-so-obvious reason behind that, I think we should add it as well. The documentation in cassandra.yaml says that jvm will be killed with &quot;die&quot; policy on &quot;single-sstable errors&quot; which seems to be the case when CorruptSSTableException is thrown.&lt;/p&gt;</comment>
                            <comment id="17695839" author="smiklosovic" created="Thu, 2 Mar 2023 17:44:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=curlylrt&quot; class=&quot;user-hover&quot; rel=&quot;curlylrt&quot;&gt;curlylrt&lt;/a&gt; could you please prepare patches for 3.11, 4.0, 4.1 and trunk as well?&lt;/p&gt;</comment>
                            <comment id="17695944" author="JIRAUSER291682" created="Fri, 3 Mar 2023 00:36:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; sure, once people think the pull request looks good. I think I can prepare pull request for 3.11, 4.0, 4.1 and trunk. Thanks!&lt;/p&gt;</comment>
                            <comment id="17696996" author="brandon.williams" created="Mon, 6 Mar 2023 15:30:17 +0000"  >&lt;p&gt;The PR looks fine to me, but&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I am trying to figure out why this has slipped.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Did you figure this out, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="17697494" author="smiklosovic" created="Tue, 7 Mar 2023 15:37:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maxwellguo&quot; class=&quot;user-hover&quot; rel=&quot;maxwellguo&quot;&gt;maxwellguo&lt;/a&gt; mentioned here (1) it seems we are OK already?&lt;/p&gt;

&lt;p&gt;added &quot;die&quot; is there so we would not throw IllegalStateException as it would reach &quot;default&quot; in these switches which this ticket solves.&lt;/p&gt;

&lt;p&gt;(1) &lt;a href=&quot;https://github.com/apache/cassandra/pull/2189/files#r1122779198&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2189/files#r1122779198&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17697499" author="brandon.williams" created="Tue, 7 Mar 2023 15:42:23 +0000"  >&lt;p&gt;I see, and think it makes sense to be explicit with &apos;die&apos; too.  I think we&apos;re ready for PRs for the other branches.&lt;/p&gt;</comment>
                            <comment id="17697608" author="JIRAUSER291682" created="Tue, 7 Mar 2023 19:33:00 +0000"  >&lt;p&gt;3.0 PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2189&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2189&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;3.11 PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2200&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2200&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4.0 PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2201&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2201&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4.1 PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2202&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2202&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;trunk PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2203&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2203&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17697617" author="brandon.williams" created="Tue, 7 Mar 2023 20:24:22 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-18294-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/894/workflows/2afa7943-477d-426c-9f0f-48a861845e0d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-18294-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/896/workflows/51b2f936-6b00-4d89-a284-b21b250e2ef1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-18294-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/892/workflows/e8e34bbb-e2e0-4074-9eb4-6a24e7c43b79&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/892/workflows/73210bd7-1a92-43ca-bf83-548716ecc90a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-18294-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/895/workflows/89afae54-8308-41f0-b45f-5464d61486fe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/895/workflows/801d5316-5b14-4522-8b91-b6189493827b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-18294-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/893/workflows/f04714f6-746f-4065-a9e3-4804c1722f21&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/893/workflows/0d8342e2-390b-40d0-8274-2e04846659e7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17697675" author="maxwellguo" created="Wed, 8 Mar 2023 01:44:27 +0000"  >&lt;p&gt;I am + 1 on this patch , but there are some very small problems about code format.&lt;br/&gt;
such as : some constructor should start a new line with &apos;{&apos;, I have already pointed out , &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=curlylrt&quot; class=&quot;user-hover&quot; rel=&quot;curlylrt&quot;&gt;curlylrt&lt;/a&gt;can you help to take a look at them ? thanks.&lt;/p&gt;</comment>
                            <comment id="17697681" author="JIRAUSER291682" created="Wed, 8 Mar 2023 02:07:21 +0000"  >&lt;p&gt;Updated the format.&lt;/p&gt;</comment>
                            <comment id="17697684" author="maxwellguo" created="Wed, 8 Mar 2023 02:11:16 +0000"  >&lt;p&gt;there is one left &lt;/p&gt;</comment>
                            <comment id="17697696" author="JIRAUSER291682" created="Wed, 8 Mar 2023 02:47:38 +0000"  >&lt;p&gt;which one?&lt;/p&gt;</comment>
                            <comment id="17697704" author="maxwellguo" created="Wed, 8 Mar 2023 03:02:19 +0000"  >&lt;p&gt;&quot;private FSError throwFSError(){ &quot; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=curlylrt&quot; class=&quot;user-hover&quot; rel=&quot;curlylrt&quot;&gt;curlylrt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17697711" author="JIRAUSER291682" created="Wed, 8 Mar 2023 03:22:10 +0000"  >&lt;p&gt;updated&lt;/p&gt;</comment>
                            <comment id="17697712" author="maxwellguo" created="Wed, 8 Mar 2023 03:23:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt;can you help to take a look agagin ?&lt;/p&gt;</comment>
                            <comment id="17697744" author="smiklosovic" created="Wed, 8 Mar 2023 06:41:51 +0000"  >&lt;p&gt;I believe that can be addressed upon merge.&lt;/p&gt;</comment>
                            <comment id="17698304" author="smiklosovic" created="Thu, 9 Mar 2023 10:18:53 +0000"  >&lt;p&gt;builds in Circle looks fine, &quot;test_sstableverify&quot; which fails on 4.0 and 4.1 is fixed already &lt;/p&gt;</comment>
                            <comment id="17698336" author="brandon.williams" created="Thu, 9 Mar 2023 12:01:05 +0000"  >&lt;p&gt;I am +1, nits can be handled on commit.&lt;/p&gt;</comment>
                            <comment id="17698355" author="smiklosovic" created="Thu, 9 Mar 2023 12:25:59 +0000"  >&lt;p&gt;+1 too, would you mind to merge, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;? &lt;/p&gt;</comment>
                            <comment id="17698357" author="brandon.williams" created="Thu, 9 Mar 2023 12:29:35 +0000"  >&lt;p&gt;I can get to it a bit later.&lt;/p&gt;</comment>
                            <comment id="17698476" author="brandon.williams" created="Thu, 9 Mar 2023 16:07:58 +0000"  >&lt;p&gt;Committed, thanks everyone!&lt;/p&gt;</comment>
                            <comment id="17699031" author="edimitrova" created="Fri, 10 Mar 2023 16:51:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=curlylrt&quot; class=&quot;user-hover&quot; rel=&quot;curlylrt&quot;&gt;curlylrt&lt;/a&gt;, &#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&#160;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt;&#160;I think this patch broke one simulator test. I can see it also failing in the published CI run here. &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/893/workflows/f04714f6-746f-4065-a9e3-4804c1722f21/jobs/12882/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/driftx/cassandra/893/workflows/f04714f6-746f-4065-a9e3-4804c1722f21/jobs/12882/tests&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The previous trunk commit does not have it broken in its final CI run and I do see the test failing consistently now in my CI runs.&#160;&lt;/p&gt;

&lt;p&gt;Please check.&lt;/p&gt;</comment>
                            <comment id="17699061" author="smiklosovic" created="Fri, 10 Mar 2023 17:51:45 +0000"  >&lt;p&gt;Nothing we can not fix! I ll take a look next week. Thanks.&lt;/p&gt;</comment>
                            <comment id="17699081" author="brandon.williams" created="Fri, 10 Mar 2023 19:06:57 +0000"  >&lt;p&gt;Worse news, it&apos;s just flaky now.&lt;/p&gt;</comment>
                            <comment id="17699082" author="edimitrova" created="Fri, 10 Mar 2023 19:11:42 +0000"  >&lt;p&gt;Thank you guys, I will open a ticket&lt;/p&gt;</comment>
                            <comment id="17699083" author="smiklosovic" created="Fri, 10 Mar 2023 19:15:56 +0000"  >&lt;p&gt;It says that it can not recursively remove a directory because it was not empty. This is happening after Cluster (as in dtest jvm api) is being closed.&lt;/p&gt;

&lt;p&gt;I wonder how that is related to what we did here. There are two ways of removing stuff, &quot;Java way&quot; (whatever that means) and calling &quot;rm&quot; command in *nix by means of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17427&quot; title=&quot;Improve unit tests performance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17427&quot;&gt;&lt;del&gt;CASSANDRA-17427&lt;/del&gt;&lt;/a&gt; which adds this CassandraRelevantProperty:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    /** When enabled, recursive directory deletion will be executed using a unix command `rm -rf` instead of traversing
     * and removing individual files. This is now used only tests, but eventually we will make it &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; by &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.*/
    USE_NIX_RECURSIVE_DELETE(&lt;span class=&quot;code-quote&quot;&gt;&quot;cassandra.use_nix_recursive_delete&quot;&lt;/span&gt;),
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When I set this to true before that cleanup logic in simulator kicks in, it will just remove it without any error.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1980/workflows/9cbd06eb-4333-485c-ad38-5986cd4870c6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1980/workflows/9cbd06eb-4333-485c-ad38-5986cd4870c6&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/instaclustr/cassandra/commit/d7c44651d63a75ca017414b172538bd9246e4b98&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/instaclustr/cassandra/commit/d7c44651d63a75ca017414b172538bd9246e4b98&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This property is set only in IDEA test run config but you see that there is the intention to set it by default to true in tests without setting any flag.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/io/util/PathUtils.java#L391&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/io/util/PathUtils.java#L391&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17699088" author="edimitrova" created="Fri, 10 Mar 2023 19:27:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;I wonder how that is related to what we did here.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I haven&apos;t checked in details your patch or the test failing, I just noticed it started failing in all runs I saw after this ticket. Maybe it just got more flaky from all latest changes? We can and I guess we should spin the multiplexer jobs for the win.&lt;/p&gt;

&lt;p&gt;I opened a ticket &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18320&quot; title=&quot;Incompatible file system thrown while running Simulator&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18320&quot;&gt;&lt;del&gt;CASSANDRA-18320&lt;/del&gt;&lt;/a&gt; for this to be checked properly. Thank you and I hope you have a great weekend &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17699090" author="edimitrova" created="Fri, 10 Mar 2023 19:30:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; should we move your findings and runs to the other ticket?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&#160;said it is flaky so I guess we need also to spin it in a loop&lt;/p&gt;

&lt;p&gt;Also, thank you for taking the time to look into it!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13242414">CASSANDRA-15191</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[curlylrt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12975"><![CDATA[Code Inspection]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1ga6o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
        <customfieldvalue><![CDATA[maxwellguo]]></customfieldvalue>
        <customfieldvalue><![CDATA[smiklosovic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348584">3.0.22</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/be574fc34ba9834929f1618ab63dd74446cd2683&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/be574fc34ba9834929f1618ab63dd74446cd2683&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;run CI&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>