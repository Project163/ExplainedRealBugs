<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:31:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-19101] Test Failure: org.apache.cassandra.db.commitlog.CommitlogShutdownTest failed on trunk</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-19101</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.AssertionError
	at org.junit.Assert.fail(Assert.java:86)
	at org.junit.Assert.assertTrue(Assert.java:41)
	at org.junit.Assert.assertTrue(Assert.java:52)
	at org.apache.cassandra.db.commitlog.CommitlogShutdownTest.testShutdownWithPendingTasks(CommitlogShutdownTest.java:96)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.jboss.byteman.contrib.bmunit.BMUnitRunner$10.evaluate(BMUnitRunner.java:393)
	at org.jboss.byteman.contrib.bmunit.BMUnitRunner$6.evaluate(BMUnitRunner.java:263)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.jboss.byteman.contrib.bmunit.BMUnitRunner$1.evaluate(BMUnitRunner.java:97)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Manual testing to confirm issues found by CircleCI when testing &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18464&quot; title=&quot;Enable Direct I/O For CommitLog Files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18464&quot;&gt;&lt;del&gt;CASSANDRA-18464&lt;/del&gt;&lt;/a&gt;. Run with Java 11 / IntelliJ&lt;/p&gt;</description>
                <environment></environment>
        <key id="13559545">CASSANDRA-19101</key>
            <summary>Test Failure: org.apache.cassandra.db.commitlog.CommitlogShutdownTest failed on trunk</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dnk">Dmitry Konstantinov</assignee>
                                    <reporter username="jlewandowski">Jacek Lewandowski</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Nov 2023 11:21:41 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:42 +0000</updated>
                            <resolved>Thu, 27 Mar 2025 16:10:13 +0000</resolved>
                                        <fixVersion>4.0.18</fixVersion>
                    <fixVersion>4.1.9</fixVersion>
                    <fixVersion>5.1</fixVersion>
                                    <component>Test/unit</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17812037" author="edimitrova" created="Mon, 29 Jan 2024 19:51:50 +0000"  >&lt;p&gt;Now failing like this on trunk:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
junit.framework.AssertionFailedError at org.apache.cassandra.db.commitlog.CommitlogShutdownTest.testShutdownWithPendingTasks(CommitlogShutdownTest.java:97) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at org.jboss.byteman.contrib.bmunit.BMUnitRunner$10.evaluate(BMUnitRunner.java:393) at org.jboss.byteman.contrib.bmunit.BMUnitRunner$6.evaluate(BMUnitRunner.java:263) at org.jboss.byteman.contrib.bmunit.BMUnitRunner$1.evaluate(BMUnitRunner.java:97)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;Seen here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/2635/workflows/541cb2e0-01e5-4e5a-9559-da51e92b3757/jobs/54694/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/2635/workflows/541cb2e0-01e5-4e5a-9559-da51e92b3757/jobs/54694/tests&lt;/a&gt;&lt;br/&gt;
and here:&lt;br/&gt;
&lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-trunk/1821/testReport/org.apache.cassandra.db.commitlog/CommitlogShutdownTest/testShutdownWithPendingTasks_system_keyspace_directory_jdk11_x86_64/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/job/Cassandra-trunk/1821/testReport/org.apache.cassandra.db.commitlog/CommitlogShutdownTest/testShutdownWithPendingTasks_system_keyspace_directory_jdk11_x86_64/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17911186" author="smiklosovic" created="Wed, 8 Jan 2025 17:45:16 +0000"  >&lt;p&gt;interesting ... this fails once from 500 times (1). I added some tweaks to wait for more than 2 commit logs before shutting it down (2). After shutdown, there were still three files.&lt;/p&gt;

&lt;p&gt;(1) &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5154/workflows/4ee7c2c4-2f61-473b-b3ae-4a9c12676dbc/jobs/316081/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5154/workflows/4ee7c2c4-2f61-473b-b3ae-4a9c12676dbc/jobs/316081/tests&lt;/a&gt;&lt;br/&gt;
(2) &lt;a href=&quot;https://github.com/instaclustr/cassandra/commit/2c484121e86627c6e131bded17ed3d0b9a503989&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/instaclustr/cassandra/commit/2c484121e86627c6e131bded17ed3d0b9a503989&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17911474" author="smiklosovic" created="Thu, 9 Jan 2025 12:50:30 +0000"  >&lt;p&gt;It happens very rarely. Out of 150000 times, it failed 4 times. It looks like this (after adding some debugging)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[junit-timeout] INFO  [NonPeriodicTasks:1] 2025-01-09 09:48:00,746 LogTransaction.java:254 - Unfinished transaction log, deleting /tmp/cassandra/build/test/cassandra/data/system/local-7ad54392bcdd35a684174e047860b377/oa_txn_compaction_d0236640-ce6e-11ef-9879-67efd17c5925.log 
[junit-timeout] DEBUG [main] 2025-01-09 09:48:00,891 CommitLog.java:369 - Commit log segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1736416077190.log) is unused
[junit-timeout] DEBUG [main] 2025-01-09 09:48:00,891 AbstractCommitLogSegmentManager.java:412 - Segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1736416077190.log) is no longer active and will be deleted now
[junit-timeout] DEBUG [PERIODIC-COMMIT-LOG-SYNCER] 2025-01-09 09:48:00,966 HeapUtils.java:133 - Heap dump creation on uncaught exceptions is disabled.
[junit-timeout] INFO  [main] 2025-01-09 09:48:01,065 CommitlogShutdownTest.java:110 - Content of commit log location after shutdown is : [build/test/cassandra/commitlog/CommitLog-9-1736416077189.log, build/test/cassandra/commitlog/CommitLog-9-1736416077191.log, build/test/cassandra/commitlog/CommitLog-9-1736416077192.log]
[junit-timeout] ------------- ---------------- ---------------
[junit-timeout] Testcase: testShutdownWithPendingTasks(org.apache.cassandra.db.commitlog.CommitlogShutdownTest)-oa_jdk17:       FAILED
[junit-timeout] number of commit logs is 3
[junit-timeout] junit.framework.AssertionFailedError: number of commit logs is 3
[junit-timeout]         at org.apache.cassandra.db.commitlog.CommitlogShutdownTest.testShutdownWithPendingTasks(CommitlogShutdownTest.java:112)
[junit-timeout]         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[junit-timeout]         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
[junit-timeout]         at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[junit-timeout]         at org.jboss.byteman.contrib.bmunit.BMUnitRunner$10.evaluate(BMUnitRunner.java:393)
[junit-timeout]         at org.jboss.byteman.contrib.bmunit.BMUnitRunner$6.evaluate(BMUnitRunner.java:263)
[junit-timeout]         at org.jboss.byteman.contrib.bmunit.BMUnitRunner$1.evaluate(BMUnitRunner.java:97)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17911475" author="smiklosovic" created="Thu, 9 Jan 2025 12:52:54 +0000"  >&lt;p&gt;I am not completely sure where it is said that we will always end up with two commit logs only after the shutdown. Why two?&lt;/p&gt;

&lt;p&gt;In the test, there is&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-comment&quot;&gt;// schedule discarding completed segments and immediately issue a shutdown
&lt;/span&gt;        TableId tableId = m.getTableIds().iterator().next();
        CommitLog.instance.discardCompletedSegments(tableId, CommitLogPosition.NONE, CommitLog.instance.getCurrentPosition());

        &lt;span class=&quot;code-comment&quot;&gt;// why &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; we think that after the last line, there will be 2 commit logs only?
&lt;/span&gt;
        CommitLog.instance.shutdownBlocking();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;One possible reason it fails is that discardCompletedSegments contains this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-comment&quot;&gt;// Don&lt;span class=&quot;code-quote&quot;&gt;&apos;t mark or &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to delete any newer segments once we&apos;&lt;/span&gt;ve reached the one containing the
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// position of the flush.
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (segment.contains(upperBound))
                &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;upperBound is &quot;CommitLog.instance.getCurrentPosition()&quot;.&lt;/p&gt;

&lt;p&gt;So what might happen is that it will discard only commit log segments up to current position, but then, after returning from discardCompletedSegments and before shutdownBlocking is done, there is yet another commit log segment created.&lt;/p&gt;


&lt;p&gt;If we carefully inspect the logs, we see:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[junit-timeout] DEBUG [main] 2025-01-09 09:48:00,891 CommitLog.java:369 - Commit log segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1736416077190.log) is unused
[junit-timeout] DEBUG [main] 2025-01-09 09:48:00,891 AbstractCommitLogSegmentManager.java:412 - Segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1736416077190.log) is no longer active and will be deleted now
[junit-timeout] DEBUG [PERIODIC-COMMIT-LOG-SYNCER] 2025-01-09 09:48:00,966 HeapUtils.java:133 - Heap dump creation on uncaught exceptions is disabled.
[junit-timeout] INFO  [main] 2025-01-09 09:48:01,065 CommitlogShutdownTest.java:110 - Content of commit log location after shutdown is : [build/test/cassandra/commitlog/CommitLog-9-1736416077189.log, build/test/cassandra/commitlog/CommitLog-9-1736416077191.log, build/test/cassandra/commitlog/CommitLog-9-1736416077192.log]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, 7190 is removed. &quot; Commit log segment is unused&quot; message is part of CommitLog.discardCompletedSegments, but we also see that there are two additional logs created, 7191 and 7192. On top of already present 7189 - failing the assert about having two logs only.&lt;/p&gt;</comment>
                            <comment id="17911504" author="smiklosovic" created="Thu, 9 Jan 2025 13:56:44 +0000"  >&lt;p&gt;Yet another example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[junit-timeout] DEBUG [main] 2025-01-09 13:22:05,679 AbstractCommitLogSegmentManager.java:412 - Segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1736428921873.log) is no longer active and will be deleted now
[junit-timeout] DEBUG [PERIODIC-COMMIT-LOG-SYNCER] 2025-01-09 13:22:05,681 HeapUtils.java:133 - Heap dump creation on uncaught exceptions is disabled.
[junit-timeout] INFO  [MemtableFlushWriter:1] 2025-01-09 13:22:05,723 LogTransaction.java:254 - Unfinished transaction log, deleting /tmp/cassandra/build/test/cassandra/data/system/local-7ad54392bcdd35a684174e047860b377/oa_txn_flush_b85d4bc0-ce8c-11ef-b24a-8141841bac15.log 
[junit-timeout] INFO  [main] 2025-01-09 13:22:05,734 CommitlogShutdownTest.java:110 - Content of commit log location after shutdown is : [build/test/cassandra/commitlog/CommitLog-9-1736428921871.log, build/test/cassandra/commitlog/CommitLog-9-1736428921872.log, build/test/cassandra/commitlog/CommitLog-9-1736428921874.log]
[junit-timeout] DEBUG [MemtableFlushWriter:1] 2025-01-09 13:22:05,744 CompactionManager.java:245 - Autocompaction on system.local is disabled (disabled: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, paused: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
[junit-timeout] DEBUG [MemtableFlushWriter:1] 2025-01-09 13:22:05,745 ColumnFamilyStore.java:1377 - Flushed to [BigTableReader:big(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/tmp/cassandra/build/test/cassandra/data/system/local-7ad54392bcdd35a684174e047860b377/oa-5-big-Data.db&apos;&lt;/span&gt;)] (1 sstables, 5.035KiB), biggest 5.035KiB, smallest 5.035KiB
[junit-timeout] DEBUG [MemtablePostFlush:1] 2025-01-09 13:22:05,745 CommitLog.java:370 - Commit log segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1736428921872.log) is unused
[junit-timeout] DEBUG [MemtablePostFlush:1] 2025-01-09 13:22:05,745 AbstractCommitLogSegmentManager.java:412 - Segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1736428921872.log) is no longer active and will be deleted now
[junit-timeout] DEBUG [MemtablePostFlush:1] 2025-01-09 13:22:05,745 CommitLog.java:370 - Commit log segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1736428921874.log) is unused
[junit-timeout] DEBUG [MemtablePostFlush:1] 2025-01-09 13:22:05,745 AbstractCommitLogSegmentManager.java:412 - Segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1736428921874.log) is no longer active and will be deleted now
[junit-timeout] INFO  [OptionalTasks:1] 2025-01-09 13:22:05,771 SecondaryIndexManager.java:947 - Executing pre-join post-bootstrap tasks &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;: CFS(Keyspace=&lt;span class=&quot;code-quote&quot;&gt;&apos;CommitLogTest&apos;&lt;/span&gt;, ColumnFamily=&lt;span class=&quot;code-quote&quot;&gt;&apos;Standard1&apos;&lt;/span&gt;)
[junit-timeout] ------------- ---------------- ---------------
[junit-timeout] Testcase: testShutdownWithPendingTasks(org.apache.cassandra.db.commitlog.CommitlogShutdownTest)-oa_jdk17:       FAILED
[junit-timeout] number of commit logs is 3
[junit-timeout] junit.framework.AssertionFailedError: number of commit logs is 3
[junit-timeout]         at org.apache.cassandra.db.commitlog.CommitlogShutdownTest.testShutdownWithPendingTasks(CommitlogShutdownTest.java:112)
[junit-timeout]         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[junit-timeout]         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
[junit-timeout]         at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
[junit-timeout]         at org.jboss.byteman.contrib.bmunit.BMUnitRunner$10.evaluate(BMUnitRunner.java:393)
[junit-timeout]         at org.jboss.byteman.contrib.bmunit.BMUnitRunner$6.evaluate(BMUnitRunner.java:263)
[junit-timeout]         at org.jboss.byteman.contrib.bmunit.BMUnitRunner$1.evaluate(BMUnitRunner.java:97)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will print that log segments are unused AFTER we shut down CommitLog which is super suspicious. &lt;/p&gt;</comment>
                            <comment id="17911699" author="smiklosovic" created="Thu, 9 Jan 2025 23:12:40 +0000"  >&lt;p&gt;for the record, this passed 20k times&lt;/p&gt;

&lt;p&gt;CommitLog.discardCompletedSegments method is only ever called in production code in PostFlush class (inner class of ColumnFamilyStore). I guess what that does is that if a memtable is flushed to disk, it will go over segments and discard these which are completed.&lt;/p&gt;

&lt;p&gt;CommitLog.discardCompletedSegments is called in CommitlogShutdownTest too as a mean to get rid of completed segments directly, just like that ... &lt;/p&gt;

&lt;p&gt;I think that what happens is that flushing of memtables is done independently of what we do in the test. So when we flush, randomly, it can create other commitlogs, so we see more than 2 of them. However, if I force flush every keyspace before shutting down CommitLog, that will get rid of completed segments ... and we finally see just 2 of them.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/commit/5ef1e249cd1a09148b2e71039d35c1d4c96dba37&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/instaclustr/cassandra/commit/5ef1e249cd1a09148b2e71039d35c1d4c96dba37&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I am not completely sure if me doing that does not beat the goal of that test. I see we use byteman like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Test
    @BMRule(name = &lt;span class=&quot;code-quote&quot;&gt;&quot;Make removing commitlog segments slow&quot;&lt;/span&gt;,
    targetClass = &lt;span class=&quot;code-quote&quot;&gt;&quot;CommitLogSegment&quot;&lt;/span&gt;,
    targetMethod = &lt;span class=&quot;code-quote&quot;&gt;&quot;discard&quot;&lt;/span&gt;,
    action = &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(50)&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testShutdownWithPendingTasks() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I am not completely sure what we want to achieve by this. I mean ... I can read, but it just does connect the dots, huh ... &lt;/p&gt;</comment>
                            <comment id="17933625" author="dnk" created="Sun, 9 Mar 2025 10:29:40 +0000"  >&lt;p&gt;Hi, I have got this test failed recently (&lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-trunk/2057/#showFailuresLink&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/job/Cassandra-trunk/2057/#showFailuresLink&lt;/a&gt; ), so I decided to analyze it deeper.&lt;br/&gt;
I think the cause why the test is failing sometimes: additionally to the writing to CommitLogTest.Standard1 table we implicitly write to system tables such as system.local, system_schema.keyspaces, sstable_activity, etc. These writes also are captured in commit log and we do not force flushing of them to release the correspondent commit log segments, so depends on timing we may have additional commit log segments are hold by these dirty tables.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13075350/13075350_Cassandra-trunk_2057_CommitlogShutdownTest.log&quot; title=&quot;Cassandra-trunk_2057_CommitlogShutdownTest.log attached to CASSANDRA-19101&quot;&gt;Cassandra-trunk_2057_CommitlogShutdownTest.log&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; - in the CI log we can see that there is some parallel background activity while we execute our test logic in &quot;main&quot; thread. For example, after the discard check in main thread:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
DEBUG [main] 2025-03-07 21:55:22,733 AbstractCommitLogSegmentManager.java:412 - Segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1741384520601.log) is no longer active and will be deleted now
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;we see in the log a completion of system.local table flushing (which means that at that moment commit log data for system.local cannot be discarded yet.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
INFO &#160;[PerDiskMemtableFlushWriter_0:2] 2025-03-07 21:55:22,736 Flushing.java:153 - Writing Memtable-local@1560781103(89B serialized bytes, 2 ops, 672B (0%) on-heap, 0B (0%) off-heap), flushed range = [&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)

INFO &#160;[PerDiskMemtableFlushWriter_0:2] 2025-03-07 21:55:22,736 Flushing.java:179 - Completed flushing /home/cassandra/cassandra/build/test/cassandra/data/system/local-7ad54392bcdd35a684174e047860b377/oa-5-big-Data.db (37B) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; commitlog position CommitLogPosition(segmentId=1741384520600, position=786787) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Also, I am lucky to be able to reproduce the issue quite frequently on my laptop and I have changed temporary logging in org.apache.cassandra.db.commitlog.CommitLog#discardCompletedSegments from tracing to debug level, so I can see what prevents commit log segments from discarding:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
DEBUG [main] 2025-03-08 11:49:11,145 CommitLog.java:375 - Not safe to delete commit log segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1741423746535.log); dirty is keyspaces (abac5682-dea6-31c5-b535-b3d6cffd0fb6, dirty: [89,15547], clean: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;), columns (24101c25-a2ae-3af7-87c1-b40ee1aca33f, dirty: [89,15547], clean: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;), tables (afddfb9d-bc1e-3068-8056-eed6c302ba09, dirty: [89,15547], clean: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;), column_masks (738cc5ed-0168-3268-b9d1-853d4bc278af, dirty: [15547,15547], clean: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;), 
DEBUG [main] 2025-03-08 11:49:11,146 CommitLog.java:375 - Not safe to delete commit log segment CommitLogSegment(build/test/cassandra/commitlog/CommitLog-9-1741423746536.log); dirty is local (7ad54392-bcdd-35a6-8417-4e047860b377, dirty: [786713,786713], clean: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;), 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So, it is an additional proof for the hypothesis which I listed before.&lt;/p&gt;

&lt;p&gt;I see the following possible ways to deal with the issue:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Try to flush all system tables + to disable their modifications by disabling background activities. While it looks possible&#160; I think it is a fragile approach: we need to find all such background activities/tables to make the test reliable + if later some feature introduces a new activity/table our test will become unstable again. So, I would prefer to not go in this way.&lt;/li&gt;
	&lt;li&gt;Change the test: instead of attempts to synthetically emulate writes to commit log for a table to check if segments are discarded after it we can test that the whole drain operation does the discarding (this was the original reason to introduce this test: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13123&quot; title=&quot;Draining a node might fail to delete all inactive commitlogs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13123&quot;&gt;&lt;del&gt;CASSANDRA-13123&lt;/del&gt;&lt;/a&gt;). It may reduce the probability of catching concurrency bugs because drain operation is more complex and have other steps but it is more reliable way to test it as a black box and do not make assumptions about the system.&lt;/li&gt;
	&lt;li&gt;Just delete the test. It was introduced a long time ago in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13123&quot; title=&quot;Draining a node might fail to delete all inactive commitlogs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13123&quot;&gt;&lt;del&gt;CASSANDRA-13123&lt;/del&gt;&lt;/a&gt; to check async discarding logic which we had in 3.0 but now org.apache.cassandra.db.commitlog.AbstractCommitLogSegmentManager#discard method is not submitting any tasks to a separate &quot;segment management thread&quot; and does the discarding logic by itself. This change happened in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8844&quot; title=&quot;Change Data Capture (CDC)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8844&quot;&gt;&lt;del&gt;CASSANDRA-8844&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13075351/13075351_diff_discard_logic.png&quot; width=&quot;500&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;br/&gt;
So, the original failure scenario the test tries to check does not exist anymore.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; Regarding your confusion about the injection. The original async logic mentioned here is the reason why the sleep was injected by the test: it is used to increase time to process tasks by this management thread and in this way to increase the probability to get the state when CommitLog.instance.shutdownBlocking() is invoked and we have not processed yet tasks within the queue, so the test can assert the shutdown logic waiting for the tasks completion instead of just dropping/ignore them.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; &#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmckenzie&quot; class=&quot;user-hover&quot; rel=&quot;jmckenzie&quot;&gt;jmckenzie&lt;/a&gt; do you have a preference for the listed options? (I would prefer to go with 2 or 3)&lt;/p&gt;</comment>
                            <comment id="17933834" author="jmckenzie" created="Mon, 10 Mar 2025 11:43:12 +0000"  >&lt;p&gt;System table writes hitting the CommitLog have long been a source of non-determinism in CommitLog tests and a real pain for flakiness. I agree that approach 1 is brittle and prone to failure so should be avoided.&lt;/p&gt;

&lt;p&gt;Right now we&apos;re checking the &lt;em&gt;count&lt;/em&gt; of commit log segments to ensure things are in the &quot;correct&quot; state:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// the shutdown should block until all logs except the currently active one and perhaps a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;, empty one are gone
&lt;/span&gt;Assert.assertTrue(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(DatabaseDescriptor.getCommitLogLocation()).tryList().length &amp;lt;= 2); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;What about iterating through the &lt;tt&gt;CommitLogSegment&lt;/tt&gt;s and confirming &lt;tt&gt;isUnused()&lt;/tt&gt; is false for all of them? If the goal is simply &quot;make sure on CommitLog shutdown we don&apos;t leave behind any unused or unflushed segments&quot; that should give us that signal right?&lt;/p&gt;</comment>
                            <comment id="17933972" author="dnk" created="Mon, 10 Mar 2025 16:49:35 +0000"  >&lt;p&gt;Yes, I agree, it should make the check more reliable and self-explainable, so I will try to make option 2) + the adjusted check logic&lt;/p&gt;</comment>
                            <comment id="17936954" author="dnk" created="Wed, 19 Mar 2025 21:34:50 +0000"  >&lt;p&gt;I have adjusted the test to drain + added a check for unused segments and it is failing &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Mutation m = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RowUpdateBuilder(cfs1.metadata.get(), 0, &lt;span class=&quot;code-quote&quot;&gt;&quot;k&quot;&lt;/span&gt;)
                           .clustering(&lt;span class=&quot;code-quote&quot;&gt;&quot;bytes&quot;&lt;/span&gt;)
                           .add(&lt;span class=&quot;code-quote&quot;&gt;&quot;val&quot;&lt;/span&gt;, ByteBuffer.wrap(entropy))
                           .build();

        &lt;span class=&quot;code-comment&quot;&gt;// force creating several commitlog files
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; 10; i++)
        {
            m.apply();
        }

        StorageService.instance.drain();

        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (CommitLogSegment segment : CommitLog.instance.segmentManager.getActiveSegments())
        {
            Assert.assertFalse(&lt;span class=&quot;code-quote&quot;&gt;&quot;An unused segment is left after drain: &quot;&lt;/span&gt; + segment.getName()
                               + &lt;span class=&quot;code-quote&quot;&gt;&quot;, dirty tables: &quot;&lt;/span&gt; + segment.dirtyString()
                               + &lt;span class=&quot;code-quote&quot;&gt;&quot;, total segments: &quot;&lt;/span&gt; + CommitLog.instance.segmentManager.getActiveSegments().size()
                               + &lt;span class=&quot;code-quote&quot;&gt;&quot;, commit log files: &quot;&lt;/span&gt; + Arrays.toString(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(DatabaseDescriptor.getCommitLogLocation()).listFiles()),
                               segment.isUnused());
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.AssertionError: An unused segment is left after drain: CommitLog-7-1742418190647.log, dirty tables: , total segments: 1, commit log files: [build/test/cassandra/commitlog/CommitLog-7-1742418190647.log]

	at org.junit.Assert.fail(Assert.java:88)
	at org.junit.Assert.assertTrue(Assert.java:41)
	at org.junit.Assert.assertFalse(Assert.java:64)
	at org.apache.cassandra.db.commitlog.CommitlogShutdownTest.testShutdownWithPendingTasks(CommitlogShutdownTest.java:100)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;We have 1 remaining unused segment which is remaining after drain (in a queue and on disk).&lt;br/&gt;
drain() invokes org.apache.cassandra.db.commitlog.CommitLog#forceRecycleAllSegments()&lt;br/&gt;
forceRecycleAllSegments method iterates over all active segments to check if they are unused:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (CommitLogSegment segment : activeSegments)
            {
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (segment.isUnused())
                    archiveAndDiscard(segment);
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but for the last segment: isStillAllocating() = allocatePosition.get() &amp;lt; endOfBuffer returns true when segment.isUnused() is invoked in this loop, so it is skipped here.&lt;br/&gt;
Later during org.apache.cassandra.db.commitlog.AbstractCommitLogSegmentManager#awaitTermination&lt;br/&gt;
we invoke CommitLogSegment#close for the last remaining segment which as a part of discardUnusedTail() logic and it changes allocatePosition, so isStillAllocating() now is false. As a result when we check segment.isUnused() after drain - it now returns true.&lt;/p&gt;

&lt;p&gt;So, it looks like we need to skip at least the last segment in the test check (if we consider keeping the last segment as an expected behaviour).&lt;/p&gt;
</comment>
                            <comment id="17936960" author="dnk" created="Wed, 19 Mar 2025 22:06:52 +0000"  >&lt;p&gt;MR for 4.0: &lt;a href=&quot;https://github.com/apache/cassandra/pull/3996&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/3996&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17937981" author="jmckenzie" created="Mon, 24 Mar 2025 18:44:54 +0000"  >&lt;p&gt;+1 on the patch; changing the test to actually fully smoke test the &lt;tt&gt;drain&lt;/tt&gt; functionality and allow leaving 1 segment is solid, since that&apos;s what &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13123&quot; title=&quot;Draining a node might fail to delete all inactive commitlogs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13123&quot;&gt;&lt;del&gt;CASSANDRA-13123&lt;/del&gt;&lt;/a&gt; was originally about.&lt;/p&gt;</comment>
                            <comment id="17938998" author="smiklosovic" created="Thu, 27 Mar 2025 15:58:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-19101-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-19101-trunk&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java17_separate_tests                            
  &#10003; j17_build                                        6m 33s
  &#10003; j17_unit_tests_repeat                             4m 2s
  &#10003; j17_utests_cdc_repeat                            3m 33s
  &#10003; j17_utests_latest_repeat                         3m 42s
  &#10003; j17_utests_oa_repeat                             3m 27s

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5693/workflows/551af040-bc38-4a62-9c44-fe8d73062a9b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java17_separate_tests&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-19101-5.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-19101-5.0&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;            
java17_separate_tests                            
  &#10003; j17_build                                        5m 40s
  &#10003; j17_unit_tests_repeat                            2m 42s
  &#10003; j17_utests_cdc_repeat                             3m 1s
  &#10003; j17_utests_compression_repeat                    3m 39s
  &#10003; j17_utests_latest_repeat                         3m 14s
java11_pre-commit_tests                         
java11_separate_tests                            
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5692/workflows/157bc22c-6f78-409f-9d3d-89379f35fdb7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java17_separate_tests&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-19101-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-19101-4.1&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java11_separate_tests                            
  &#10003; j11_build                                        1m 34s
  &#10003; j11_unit_tests_repeat                            2m 34s
  &#10003; j11_utests_cdc_repeat                            2m 38s
  &#10003; j11_utests_compression_repeat                     4m 3s    
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5691/workflows/5127df43-4633-4a67-b8c2-6ad5ac739b6d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java11_separate_tests&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-19101-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-19101-4.0&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java11_separate_tests                            
  &#10003; j11_build                                        1m 30s
  &#10003; j11_unit_tests_repeat                            2m 54s
  &#10003; j11_utests_cdc_repeat                            3m 14s
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5690/workflows/2cf3992a-b0a3-45ae-bb2f-fe04c1737053&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java11_separate_tests&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13075350" name="Cassandra-trunk_2057_CommitlogShutdownTest.log" size="58576" author="dnk" created="Sun, 9 Mar 2025 09:47:49 +0000"/>
                            <attachment id="13075351" name="diff_discard_logic.png" size="340115" author="dnk" created="Sun, 9 Mar 2025 10:18:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[dnk]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12990" cascade-level="1"><![CDATA[Test Failure]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            32 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1lva8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jmckenzie]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12336842">4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/bc8941e377db8d48ad70142ad94524743c3ef897&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/bc8941e377db8d48ad70142ad94524743c3ef897&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Existing junit test is changed&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>