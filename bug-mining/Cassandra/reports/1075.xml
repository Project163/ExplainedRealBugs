<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:22:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3071] Gossip state is not removed after a new IP takes over a token</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3071</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;When a new node takes over a token, the endpoint state in the gossiper is never removed for the old node.  &lt;/p&gt;</description>
                <environment></environment>
        <key id="12519848">CASSANDRA-3071</key>
            <summary>Gossip state is not removed after a new IP takes over a token</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="brandon.williams">Brandon Williams</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Aug 2011 16:59:35 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:53 +0000</updated>
                            <resolved>Tue, 23 Aug 2011 18:11:49 +0000</resolved>
                                        <fixVersion>0.7.9</fixVersion>
                    <fixVersion>0.8.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13089579" author="brandon.williams" created="Tue, 23 Aug 2011 17:00:22 +0000"  >&lt;p&gt;This was originally part of a patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-957&quot; title=&quot;convenience workflow for replacing dead node&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-957&quot;&gt;&lt;del&gt;CASSANDRA-957&lt;/del&gt;&lt;/a&gt;, but looks worthy enough to break out and get committed in older versions.&lt;/p&gt;</comment>
                            <comment id="13089588" author="jbellis" created="Tue, 23 Aug 2011 17:10:03 +0000"  >&lt;p&gt;Is it possible for this to remove an endpoint that it shouldn&apos;t?&lt;/p&gt;

&lt;p&gt;E.g., X has token T&lt;/p&gt;

&lt;p&gt;X moves to token U but node N was down&lt;/p&gt;

&lt;p&gt;N comes back up, thinks T and U are both owned by X&lt;/p&gt;

&lt;p&gt;node Y takes token T&lt;/p&gt;

&lt;p&gt;we remove X from gossip&lt;/p&gt;</comment>
                            <comment id="13089594" author="brandon.williams" created="Tue, 23 Aug 2011 17:17:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;N comes back up, thinks T and U are both owned by X&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t think this can happen.  When N starts up, it will load the persisted tokens, BUT they won&apos;t be associated with IPs.  It can only learn that U is owned by X via gossip, and T will be down until it learns about Y.&lt;/p&gt;</comment>
                            <comment id="13089601" author="jbellis" created="Tue, 23 Aug 2011 17:21:41 +0000"  >&lt;p&gt;what behavior does this fix?  just gossip trying to reach the old node?&lt;/p&gt;</comment>
                            <comment id="13089604" author="brandon.williams" created="Tue, 23 Aug 2011 17:29:08 +0000"  >&lt;p&gt;I think it solves this: &lt;a href=&quot;http://cassandra-user-incubator-apache-org.3065146.n2.nabble.com/Completely-removing-a-node-from-the-cluster-td6705079.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassandra-user-incubator-apache-org.3065146.n2.nabble.com/Completely-removing-a-node-from-the-cluster-td6705079.html&lt;/a&gt;  Jeremy also reported a problem with a large amount of hints that I think this solves since SP.shouldHint is directly impacted by this.&lt;/p&gt;</comment>
                            <comment id="13089610" author="brandon.williams" created="Tue, 23 Aug 2011 17:38:03 +0000"  >&lt;p&gt;v2 adds more protection around shouldHint by checking that the endpoint is a member.  &lt;/p&gt;</comment>
                            <comment id="13089613" author="jbellis" created="Tue, 23 Aug 2011 17:45:24 +0000"  >&lt;p&gt;If the node doesn&apos;t have a token, it doesn&apos;t matter if it&apos;s a gossip member, it won&apos;t be part of getWriteEndpoints and won&apos;t be hinted anyway.&lt;/p&gt;</comment>
                            <comment id="13089619" author="jbellis" created="Tue, 23 Aug 2011 17:51:14 +0000"  >&lt;p&gt;+1 on v1, -1 on conflating gossip membership w/ token ownership as in v2&lt;/p&gt;</comment>
                            <comment id="13089628" author="brandon.williams" created="Tue, 23 Aug 2011 18:11:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;If the node doesn&apos;t have a token, it doesn&apos;t matter if it&apos;s a gossip member, it won&apos;t be part of getWriteEndpoints and won&apos;t be hinted anyway.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I can&apos;t see a way for that either, but I&apos;m still suspicious of the link to shouldHint.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;+1 on v1, -1 on conflating gossip membership w/ token ownership as in v2&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Fair enough, committed v1.&lt;/p&gt;</comment>
                            <comment id="13089648" author="hudson" created="Tue, 23 Aug 2011 18:29:18 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #541 (See &lt;a href=&quot;https://builds.apache.org/job/Cassandra-0.7/541/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Cassandra-0.7/541/&lt;/a&gt;)&lt;br/&gt;
    Remove gossip state when a new IP takes over a token.&lt;br/&gt;
Patch by brandonwilliams, reviewed by jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3071&quot; title=&quot;Gossip state is not removed after a new IP takes over a token&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3071&quot;&gt;&lt;del&gt;CASSANDRA-3071&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;brandonwilliams : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1160825&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1160825&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/cassandra/branches/cassandra-0.7/src/java/org/apache/cassandra/service/StorageService.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12491369" name="3071-v2.txt" size="1408" author="brandon.williams" created="Tue, 23 Aug 2011 17:38:03 +0000"/>
                            <attachment id="12491359" name="3071.txt" size="804" author="brandon.williams" created="Tue, 23 Aug 2011 17:00:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20956</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gfbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>93914</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>