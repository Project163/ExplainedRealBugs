<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:01:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11304] Stack overflow when querying 2ndary index</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11304</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;When reading data through a secondary index &lt;em&gt;select * from tableName where secIndexField = &apos;foo&apos;&lt;/em&gt;  (from a Java application) I get the following stacktrace on all nodes; after the query read fails. It happens repeatably when  I rerun the same query:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;SharedPool-Worker-8&amp;#93;&lt;/span&gt; 2016-03-04 13:26:28,041 AbstractLocalAwareExecutorService.java:169 - Uncaught exception on thread Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;SharedPool-Worker-8,5,main&amp;#93;&lt;/span&gt;: {}&lt;br/&gt;
java.lang.StackOverflowError: null&lt;br/&gt;
        at org.apache.cassandra.db.rows.BTreeRow$Builder.build(BTreeRow.java:653) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.db.rows.UnfilteredSerializer.deserializeRowBody(UnfilteredSerializer.java:436) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.db.UnfilteredDeserializer$CurrentDeserializer.readNext(UnfilteredDeserializer.java:211) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.db.columniterator.SSTableIterator$ForwardIndexedReader.computeNext(SSTableIterator.java:266) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.db.columniterator.SSTableIterator$ForwardReader.hasNextInternal(SSTableIterator.java:153) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.db.columniterator.AbstractSSTableIterator$Reader.hasNext(AbstractSSTableIterator.java:340) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.db.columniterator.AbstractSSTableIterator.hasNext(AbstractSSTableIterator.java:219) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.db.columniterator.SSTableIterator.hasNext(SSTableIterator.java:32) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.utils.MergeIterator$Candidate.advance(MergeIterator.java:369) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.utils.MergeIterator$ManyToOne.advance(MergeIterator.java:189) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.utils.MergeIterator$ManyToOne.computeNext(MergeIterator.java:158) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.utils.AbstractIterator.hasNext(AbstractIterator.java:47) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.db.rows.UnfilteredRowIterators$UnfilteredRowMergeIterator.computeNext(UnfilteredRowIterators.java:428) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.db.rows.UnfilteredRowIterators$UnfilteredRowMergeIterator.computeNext(UnfilteredRowIterators.java:288) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.utils.AbstractIterator.hasNext(AbstractIterator.java:47) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.db.transform.BaseRows.hasNext(BaseRows.java:108) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.index.internal.composites.CompositesSearcher$1.prepareNext(CompositesSearcher.java:128) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.index.internal.composites.CompositesSearcher$1.prepareNext(CompositesSearcher.java:133) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.index.internal.composites.CompositesSearcher$1.prepareNext(CompositesSearcher.java:133) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;apache-cassandra-3.0.3.jar:3.0.3&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment>&lt;p&gt;3 Node cluster / Ubuntu 14.04 / Cassandra 3.0.3&lt;/p&gt;</environment>
        <key id="12946968">CASSANDRA-11304</key>
            <summary>Stack overflow when querying 2ndary index</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="samt">Sam Tunnicliffe</assignee>
                                    <reporter username="jobtg">Job Tiel Groenestege</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Mar 2016 12:56:23 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:40 +0000</updated>
                            <resolved>Wed, 9 Mar 2016 15:06:20 +0000</resolved>
                                        <fixVersion>3.0.5</fixVersion>
                                    <component>Legacy/Core</component>
                    <component>Legacy/CQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15179910" author="beobal" created="Fri, 4 Mar 2016 14:01:10 +0000"  >&lt;p&gt;Can you share the schema of indexed table?&lt;/p&gt;</comment>
                            <comment id="15179955" author="jobtg" created="Fri, 4 Mar 2016 14:39:17 +0000"  >&lt;p&gt;Modified some column-names - manually - for readability so I could accidentally have created duplicate row names; the original names are a bit longer (but I assume that is not the issue here)&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;CREATE TABLE keyspace.tablename (&lt;br/&gt;
    t ascii,&lt;br/&gt;
    time timestamp,&lt;br/&gt;
    aid ascii,&lt;br/&gt;
    adid int,&lt;br/&gt;
    ap int,&lt;br/&gt;
    adc ascii,&lt;br/&gt;
    aiseid ascii,&lt;br/&gt;
    aisip boolean,&lt;br/&gt;
    bpacn int,&lt;br/&gt;
    bppcn int,&lt;br/&gt;
    bpusn int,&lt;br/&gt;
    bcacn int,&lt;br/&gt;
    bcpcn int,&lt;br/&gt;
    bcun int,&lt;br/&gt;
    bid int,&lt;br/&gt;
    btom int,&lt;br/&gt;
    cid int,&lt;br/&gt;
    c ascii,&lt;br/&gt;
    cacacn int,&lt;br/&gt;
    cacpcn int,&lt;br/&gt;
    cacun int,&lt;br/&gt;
    cac2acn int,&lt;br/&gt;
    cac2pcn int,&lt;br/&gt;
    cacun int,&lt;br/&gt;
    cac3acn int,&lt;br/&gt;
    cac3pcn int,&lt;br/&gt;
    cac3un int,&lt;br/&gt;
    cac4acn int,&lt;br/&gt;
    cac4pcn int,&lt;br/&gt;
    cac4un int,&lt;br/&gt;
    cac5acn int,&lt;br/&gt;
    cac5pcn int,&lt;br/&gt;
    cac5un int,&lt;br/&gt;
    crid int,&lt;br/&gt;
    dcacn int,&lt;br/&gt;
    dcpcn int,&lt;br/&gt;
    dcun int,&lt;br/&gt;
    dt int,&lt;br/&gt;
    dc ascii,&lt;br/&gt;
    du ascii,&lt;br/&gt;
    est ascii,&lt;br/&gt;
    et bigint,&lt;br/&gt;
    evt ascii,&lt;br/&gt;
    ex ascii,&lt;br/&gt;
    fp uuid,&lt;br/&gt;
    flid int,&lt;br/&gt;
    grid int,&lt;br/&gt;
    ioid int,&lt;br/&gt;
    ip ascii,&lt;br/&gt;
    isp_id int,&lt;br/&gt;
    l ascii,&lt;br/&gt;
    liid int,&lt;br/&gt;
    mtk text,&lt;br/&gt;
    mts ascii,&lt;br/&gt;
    mmid int,&lt;br/&gt;
    mmid int,&lt;br/&gt;
    ns int,&lt;br/&gt;
    osid int,&lt;br/&gt;
    pracn int,&lt;br/&gt;
    prpcn int,&lt;br/&gt;
    prusn int,&lt;br/&gt;
    pmac1acn int,&lt;br/&gt;
    pmac1pcn int,&lt;br/&gt;
    pmac1un int,&lt;br/&gt;
    pmac2acn int,&lt;br/&gt;
    pmac2pcn int,&lt;br/&gt;
    pmac2un int,&lt;br/&gt;
    pmac3acn int,&lt;br/&gt;
    pmac3pcn int,&lt;br/&gt;
    pmac3un int,&lt;br/&gt;
    pmac4acn int,&lt;br/&gt;
    pmac4pcn int,&lt;br/&gt;
    pmac5un int,&lt;br/&gt;
    pmac5acn int,&lt;br/&gt;
    pmac5pcn int,&lt;br/&gt;
    pmac6un int,    &lt;br/&gt;
    pc ascii,&lt;br/&gt;
    rt bigint,&lt;br/&gt;
    tmcacn int,&lt;br/&gt;
    tmcpcn int,&lt;br/&gt;
    tmcun int,&lt;br/&gt;
    usid int,&lt;br/&gt;
    url text,&lt;br/&gt;
    vt bigint,&lt;br/&gt;
    wpacn int,&lt;br/&gt;
    wppcn int,&lt;br/&gt;
    wpusn int,&lt;br/&gt;
    PRIMARY KEY (uid, time, aid, adid)&lt;br/&gt;
) WITH CLUSTERING ORDER BY (time ASC, aid ASC, adid ASC)&lt;br/&gt;
    AND bloom_filter_fp_chance = 0.01&lt;br/&gt;
    AND caching = &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {&amp;#39;keys&amp;#39;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;    AND comment = &apos;&apos;&lt;br/&gt;
    AND compaction = &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {&amp;#39;class&amp;#39;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;    AND compression = &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {&amp;#39;chunk_length_in_kb&amp;#39;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;    AND crc_check_chance = 1.0&lt;br/&gt;
    AND dclocal_read_repair_chance = 0.1&lt;br/&gt;
    AND default_time_to_live = 0&lt;br/&gt;
    AND gc_grace_seconds = 864000&lt;br/&gt;
    AND max_index_interval = 2048&lt;br/&gt;
    AND memtable_flush_period_in_ms = 0&lt;br/&gt;
    AND min_index_interval = 128&lt;br/&gt;
    AND read_repair_chance = 0.0&lt;br/&gt;
    AND speculative_retry = &apos;99PERCENTILE&apos;;&lt;br/&gt;
CREATE INDEX fileindex ON keyspace.tablename (fp);&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="15179983" author="slebresne" created="Fri, 4 Mar 2016 15:01:09 +0000"  >&lt;p&gt;For info, seems the recursive call to &lt;tt&gt;prepareNext&lt;/tt&gt; that is the cause of this has already been fixed on trunk by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10750&quot; title=&quot;Minor code improvements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10750&quot;&gt;&lt;del&gt;CASSANDRA-10750&lt;/del&gt;&lt;/a&gt; (which somehow doesn&apos;t have a proper fix version) but not on 3.0. We might just want to backport that change here.&lt;/p&gt;</comment>
                            <comment id="15185028" author="beobal" created="Tue, 8 Mar 2016 15:06:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt; is right, the recursion that seems to be causing this has been removed in trunk. I&apos;ve attached a patch which backports that particular fix from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10750&quot; title=&quot;Minor code improvements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10750&quot;&gt;&lt;del&gt;CASSANDRA-10750&lt;/del&gt;&lt;/a&gt;). &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jobtg&quot; class=&quot;user-hover&quot; rel=&quot;jobtg&quot;&gt;jobtg&lt;/a&gt;, the patch applies cleanly to 3.0.3 if you wanted an interim fix, seeing as we&apos;ve unfortunately just missed the 3.0.4 release.&lt;/p&gt;

&lt;p&gt;CI based on latest 3.0:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;testall&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/11304-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;11304-3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-11304-3.0-testall&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-11304-3.0-dtest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15186407" author="stefania" created="Wed, 9 Mar 2016 03:12:06 +0000"  >&lt;p&gt;Both patch and CI results LGTM, +1.&lt;/p&gt;</comment>
                            <comment id="15187211" author="beobal" created="Wed, 9 Mar 2016 15:06:20 +0000"  >&lt;p&gt;Thanks, committed to 3.0 in &lt;tt&gt;d0b7a02b230f65a3ba2665a8327b6e6cc585dde9&lt;/tt&gt; and merged with &lt;tt&gt;-s ours&lt;/tt&gt; to 3.5 &amp;amp; trunk.&lt;/p&gt;</comment>
                            <comment id="15213923" author="ohene.kwasi@gmail.com" created="Mon, 28 Mar 2016 07:38:23 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt;. I&apos;ve been severely bitten by this issue, having recently upgraded from 2.2 (which means downgrading back to 2.2 from 3.0 is going to be a royal pain). Does this issue affect all 3.0.x versions? I am seeing it in 3.0.4, and the bug reporter is seeing it in 3.0.3, but not sure if by downgrading to 3.0.0, I can temporarily avoid this issue. &lt;/p&gt;

&lt;p&gt;Thanks a lot!&lt;/p&gt;</comment>
                            <comment id="15213939" author="beobal" created="Mon, 28 Mar 2016 08:00:06 +0000"  >&lt;p&gt;yes, it has the potential to affect all 3.x and 3.0.x version up until 3.5 &amp;amp; 3.0.5 are released. So I&apos;m afraid 3.0.0 isn&apos;t likely to be much help to you.&lt;/p&gt;</comment>
                            <comment id="15213966" author="ohene.kwasi@gmail.com" created="Mon, 28 Mar 2016 08:42:21 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt;. I managed to get around this by upgrading to 3.2.1. So far, it&apos;s looking good.&lt;/p&gt;</comment>
                            <comment id="15213976" author="beobal" created="Mon, 28 Mar 2016 08:52:17 +0000"  >&lt;p&gt;Sorry, I misspoke there. The issue was fixed in the 3.x line by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10750&quot; title=&quot;Minor code improvements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10750&quot;&gt;&lt;del&gt;CASSANDRA-10750&lt;/del&gt;&lt;/a&gt; in 3.2, this patch for this ticket was to backport it to 3.0.x&lt;/p&gt;</comment>
                            <comment id="15214005" author="ohene.kwasi@gmail.com" created="Mon, 28 Mar 2016 09:26:03 +0000"  >&lt;p&gt;Understood. Thanks.&lt;/p&gt;</comment>
                            <comment id="15249417" author="gpengtao" created="Wed, 20 Apr 2016 07:30:25 +0000"  >&lt;p&gt;I&apos;m using Cassandra version 3.0.5, just upgraded from 3.0.4 recently for this bug.&lt;br/&gt;
But after upgrade I find under the query speed of very low CPU utilization of 100%. &lt;br/&gt;
Blow is the stack info:&lt;/p&gt;

&lt;p&gt;&quot;SharedPool-Worker-28&quot; #205 daemon prio=5 os_prio=0 tid=0x00007f1610cc8780 nid=0xe7c0 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00007f0ed566f000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
    at org.apache.cassandra.utils.MurmurHash.hash3_x64_128(MurmurHash.java:191)&lt;br/&gt;
    at org.apache.cassandra.dht.Murmur3Partitioner.getHash(Murmur3Partitioner.java:181)&lt;br/&gt;
    at org.apache.cassandra.dht.Murmur3Partitioner.decorateKey(Murmur3Partitioner.java:53)&lt;br/&gt;
    at org.apache.cassandra.db.PartitionPosition$ForKey.get(PartitionPosition.java:49)&lt;br/&gt;
    at org.apache.cassandra.db.marshal.PartitionerDefinedOrder.compareCustom(PartitionerDefinedOrder.java:93)&lt;br/&gt;
    at org.apache.cassandra.db.marshal.AbstractType.compare(AbstractType.java:158)&lt;br/&gt;
    at org.apache.cassandra.db.ClusteringComparator.compareComponent(ClusteringComparator.java:166)&lt;br/&gt;
    at org.apache.cassandra.db.ClusteringComparator.compare(ClusteringComparator.java:137)&lt;br/&gt;
    at org.apache.cassandra.db.ClusteringComparator.compare(ClusteringComparator.java:126)&lt;br/&gt;
    at org.apache.cassandra.db.ClusteringComparator.compare(ClusteringComparator.java:44)&lt;br/&gt;
    at org.apache.cassandra.utils.MergeIterator$Candidate.compareTo(MergeIterator.java:378)&lt;br/&gt;
    at org.apache.cassandra.utils.MergeIterator$ManyToOne.replaceAndSink(MergeIterator.java:266)&lt;br/&gt;
    at org.apache.cassandra.utils.MergeIterator$ManyToOne.advance(MergeIterator.java:189)&lt;br/&gt;
    at org.apache.cassandra.utils.MergeIterator$ManyToOne.computeNext(MergeIterator.java:158)&lt;br/&gt;
    at org.apache.cassandra.utils.AbstractIterator.hasNext(AbstractIterator.java:47)&lt;br/&gt;
    at org.apache.cassandra.db.rows.UnfilteredRowIterators$UnfilteredRowMergeIterator.computeNext(UnfilteredRowIterators.java:428)&lt;br/&gt;
    at org.apache.cassandra.db.rows.UnfilteredRowIterators$UnfilteredRowMergeIterator.computeNext(UnfilteredRowIterators.java:288)&lt;br/&gt;
    at org.apache.cassandra.utils.AbstractIterator.hasNext(AbstractIterator.java:47)&lt;br/&gt;
    at org.apache.cassandra.db.transform.BaseRows.hasNext(BaseRows.java:108)&lt;br/&gt;
    at org.apache.cassandra.index.internal.composites.CompositesSearcher$1.prepareNext(CompositesSearcher.java:130)&lt;br/&gt;
    at org.apache.cassandra.index.internal.composites.CompositesSearcher$1.hasNext(CompositesSearcher.java:83)&lt;br/&gt;
    at org.apache.cassandra.db.transform.BasePartitions.hasNext(BasePartitions.java:72)&lt;br/&gt;
    at org.apache.cassandra.db.partitions.UnfilteredPartitionIterators$Serializer.serialize(UnfilteredPartitionIterators.java:295)&lt;br/&gt;
    at org.apache.cassandra.db.ReadResponse$LocalDataResponse.build(ReadResponse.java:134)&lt;br/&gt;
    at org.apache.cassandra.db.ReadResponse$LocalDataResponse.&amp;lt;init&amp;gt;(ReadResponse.java:127)&lt;br/&gt;
    at org.apache.cassandra.db.ReadResponse$LocalDataResponse.&amp;lt;init&amp;gt;(ReadResponse.java:123)&lt;br/&gt;
    at org.apache.cassandra.db.ReadResponse.createDataResponse(ReadResponse.java:65)&lt;br/&gt;
    at org.apache.cassandra.db.ReadCommand.createResponse(ReadCommand.java:289)&lt;br/&gt;
    at org.apache.cassandra.db.ReadCommandVerbHandler.doVerb(ReadCommandVerbHandler.java:47)&lt;br/&gt;
    at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:67)&lt;br/&gt;
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)&lt;br/&gt;
    at org.apache.cassandra.concurrent.AbstractLocalAwareExecutorService$FutureTask.run(AbstractLocalAwareExecutorService.java:164)&lt;br/&gt;
    at org.apache.cassandra.concurrent.AbstractLocalAwareExecutorService$LocalSessionFutureTask.run(AbstractLocalAwareExecutorService.java:136)&lt;br/&gt;
    at org.apache.cassandra.concurrent.SEPWorker.run(SEPWorker.java:105)&lt;br/&gt;
    at java.lang.Thread.run(Thread.java:745)&lt;/p&gt;

&lt;p&gt;I find the busy running threads are all from &quot;SharedPool-Worker&quot;.&lt;br/&gt;
They are all in &quot;org.apache.cassandra.db.partitions.UnfilteredPartitionIterator#prepareNext&quot; or deeper than the method.&lt;/p&gt;

&lt;p&gt;Is it a new bug?&lt;/p&gt;</comment>
                            <comment id="15249545" author="jobtg" created="Wed, 20 Apr 2016 09:20:20 +0000"  >&lt;p&gt;Same here, after the upgrade to 3.0.5 I&apos;m getting ReadTimeoutException while the server seems very busy for just the query.&lt;/p&gt;</comment>
                            <comment id="15250086" author="beobal" created="Wed, 20 Apr 2016 15:28:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gpengtao&quot; class=&quot;user-hover&quot; rel=&quot;gpengtao&quot;&gt;gpengtao&lt;/a&gt; opened &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11616&quot; title=&quot;cassandra very high cpu rate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11616&quot;&gt;&lt;del&gt;CASSANDRA-11616&lt;/del&gt;&lt;/a&gt; for this regression, thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12792016" name="11304-3.0.txt" size="9140" author="samt" created="Tue, 8 Mar 2016 15:06:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2u5m7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>stefania</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>