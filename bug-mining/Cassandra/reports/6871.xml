<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:34:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-20829] Secondary index implementations do not integrate with IndexGCTransaction when compaction contains fully expired SSTables</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-20829</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;There is a test (1) which ensures that when data are TTLed and compacted, IndexGCTransaction is aware of that and it will invoke Indexer.removeRow() method eventually.&lt;/p&gt;

&lt;p&gt;However, this is not working properly when we have fully expired SSTables, e.g. as the result of a table being on TWCS and having TTL on that.&#160;&lt;/p&gt;

&lt;p&gt;The reason is that in CompactionTask, we are filtering out fully expired ones (2). These then do not go to the compaction process and then they are not reacted on in listener() (3) which contains this logic (4). Eventually, onRowMerge in IndexGCTransaction will make the diff and in its commit indexer.removeRow(row); will notify 2i about its removal.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This integration is missing and it is quite a big problem because if there are custom secondary index implementations the fact that SSTables were fully expired is not propagated to them which means that data are never removed from whatever backend they use.&lt;/p&gt;

&lt;p&gt;The solution is to go to the compaction with fully expired SSTables as well &lt;em&gt;but only if we detected that respective column family has some indexes&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;(1) &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-4.1/test/unit/org/apache/cassandra/index/CustomIndexTest.java#L583-L607&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-4.1/test/unit/org/apache/cassandra/index/CustomIndexTest.java#L583-L607&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(2) &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-4.1/src/java/org/apache/cassandra/db/compaction/CompactionTask.java#L174&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-4.1/src/java/org/apache/cassandra/db/compaction/CompactionTask.java#L174&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(3) &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-4.1/src/java/org/apache/cassandra/db/compaction/CompactionIterator.java#L130&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-4.1/src/java/org/apache/cassandra/db/compaction/CompactionIterator.java#L130&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(4) &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-4.1/src/java/org/apache/cassandra/db/compaction/CompactionIterator.java#L235-L252&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-4.1/src/java/org/apache/cassandra/db/compaction/CompactionIterator.java#L235-L252&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13626159">CASSANDRA-20829</key>
            <summary>Secondary index implementations do not integrate with IndexGCTransaction when compaction contains fully expired SSTables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="smiklosovic">Stefan Miklosovic</assignee>
                                    <reporter username="smiklosovic">Stefan Miklosovic</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Aug 2025 13:02:14 +0000</created>
                <updated>Wed, 20 Aug 2025 09:22:17 +0000</updated>
                            <resolved>Wed, 20 Aug 2025 09:21:17 +0000</resolved>
                                        <fixVersion>4.0.19</fixVersion>
                    <fixVersion>4.1.10</fixVersion>
                    <fixVersion>5.0.6</fixVersion>
                    <fixVersion>5.1</fixVersion>
                                    <component>Feature/2i Index</component>
                    <component>Local/Compaction</component>
                    <component>Local/Compaction/TWCS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="18600">5h 10m</timespent>
                                <comments>
                            <comment id="18013426" author="smiklosovic" created="Tue, 12 Aug 2025 13:06:20 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blambov&quot; class=&quot;user-hover&quot; rel=&quot;blambov&quot;&gt;blambov&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="18013632" author="blambov" created="Wed, 13 Aug 2025 09:16:50 +0000"  >&lt;p&gt;I don&apos;t think the cost of this approach is acceptable.&lt;/p&gt;

&lt;p&gt;It basically means that we will perform a full compaction on the obsolete sstables, i.e. fully read and compact them, then turn the data into tombstones because it is expired, and then remove it via the purger, potentially also checking for overlapping sstables. In other words it would kill all benefits of whole-sstable-expiration.&lt;/p&gt;

&lt;p&gt;SAI (which will be fine just dropping the files without being notified of expirations) for one would be badly and unnecessarily hurt by this. For the other cases, a simpler walk over the file, listing all data as deleted, will be a much better performing solution, and we should only apply this if the secondary index requests it (this can be an addition to the interface that defaults to return true, overridden for SAI and SASI).&lt;/p&gt;

&lt;p&gt;Personally, I&apos;m quite unhappy with the way that the expirations are bundled with compaction tasks, which is a problem on its own that means that we have to choose between:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;deleting expired sstables waiting for the completion of the compaction, which can be days later;&lt;/li&gt;
	&lt;li&gt;being unable to abort a compaction that includes expired sstables.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In the datastax branch we switched to &lt;a href=&quot;https://github.com/datastax/cassandra/blob/main/src/java/org/apache/cassandra/db/compaction/UnifiedCompactionStrategy.java#L329...L371&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;extracting expirations as separate operations for UCS&lt;/a&gt;. Perhaps this is a good opportunity to apply a similar approach to all compaction strategies, which would also offer &lt;a href=&quot;https://github.com/datastax/cassandra/blob/main/src/java/org/apache/cassandra/db/compaction/ExpirationTask.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;a good place&lt;/a&gt; to implement that simple walk?&lt;/p&gt;</comment>
                            <comment id="18013635" author="smiklosovic" created="Wed, 13 Aug 2025 09:27:55 +0000"  >&lt;p&gt;&amp;gt; In other words it would kill all benefits of whole-sstable-expiration.&lt;/p&gt;

&lt;p&gt;Not always, only when table has an index, right? Also we might further narrow this down e.g. it would do it like that only in case it does not have any SAI indexes etc, just old 2i implementations. &lt;/p&gt;

&lt;p&gt;&amp;gt; SAI (which will be fine just dropping the files without being notified of expirations) for one would be badly and unnecessarily hurt by this&lt;/p&gt;

&lt;p&gt;Yes, we can leave out SAI from this, no problems.&lt;/p&gt;

&lt;p&gt;&amp;gt;  For the other cases, a simpler walk over the file, listing all data as deleted, will be a much better performing solution, and we should only apply this if the secondary index requests it &lt;/p&gt;

&lt;p&gt;I am not completely sure what you mean by this. The primary reason this patch exists is that when you have a custom 2i implementation (e.g. Stratio Lucene plugin), then when SSTables are fully expired, because it does not integrate with IndexGCTransaction, these custom implementations are never notified about rows expired. It is like that index implementation is completely blind to the fact that SSTables expired in their entirety. This in turn means that we can not use TWCS on tables because in this index the data will never be purged which will make that index which has its own data structures which handle indexed data to grow beyond any limit. &lt;/p&gt;

&lt;p&gt;Basically it is like we have API which indexes are meant to integrate with but on server side we never cover that case for fully expired sstables. This is clearly Cassandra&apos;s fault. &lt;/p&gt;

&lt;p&gt;We are particularly interested in patching this in 4.1 and I do not think that such a refactorisation you are suggesting would be justifiable given these are just older maintenance branches not a lot of effort should go into anymore. &lt;/p&gt;</comment>
                            <comment id="18013639" author="smiklosovic" created="Wed, 13 Aug 2025 09:38:38 +0000"  >&lt;p&gt;btw we might limit this to 4.0 / 4.1 only. We can just not do this for 5.0+ at all if that makes things better. Completely OK to drop this from 5.0 and trunk.&lt;/p&gt;

&lt;p&gt;We could also wrap this in some kind of a configuration parameter a user would need to explicitly turn on to behave like this (system property?)&lt;/p&gt;</comment>
                            <comment id="18013644" author="blambov" created="Wed, 13 Aug 2025 09:59:21 +0000"  >&lt;p&gt;How about adding a new method in the secondary index interface, so that we don&apos;t do this when we know we don&apos;t need to?&lt;/p&gt;

&lt;p&gt;I&apos;m not sure going through the compaction path will work well for 4.1, because we might find overlaps and leave some tombstones in, especially if things like unsafe aggressive expiration are in use (which we often have to turn on for a while to solve a problem). Those tombstones would be placed in random buckets, which will make things worse.&lt;/p&gt;

&lt;p&gt;My opinion is that it would be better to implement the expiration as a separate step, during the initialization of the compaction task if necessary (and preferably separately for trunk).&lt;/p&gt;</comment>
                            <comment id="18013648" author="smiklosovic" created="Wed, 13 Aug 2025 10:10:51 +0000"  >&lt;p&gt;Happy to investigate more proper way for trunk. Just reiterating that I do not want to refactor this behavior significantly in 4.1 for obvious reasons. I agree this is not perfect but we are just trying to somehow salvage this. &lt;/p&gt;

&lt;p&gt;I will investigate how to add that method to 2i but given we will likely rewrite things in trunk, once we introduce such method to 4.1 we will need to live with it since then. Or no? Can we just introduce default method in 4.1 and &lt;em&gt;not&lt;/em&gt; introduce it later on? &lt;/p&gt;</comment>
                            <comment id="18013654" author="smiklosovic" created="Wed, 13 Aug 2025 10:36:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blambov&quot; class=&quot;user-hover&quot; rel=&quot;blambov&quot;&gt;blambov&lt;/a&gt; added &quot;method on Index&quot; approach &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/4300/files#diff-7b08ce424088efb0b16757928dcd1d3417333bd27145439f3664c2a6e3ea8254&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/4300/files#diff-7b08ce424088efb0b16757928dcd1d3417333bd27145439f3664c2a6e3ea8254&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;if we are OK here I will apply this to 4.0 as well. 5.0 and trunk can be left out. &lt;/p&gt;</comment>
                            <comment id="18013685" author="blambov" created="Wed, 13 Aug 2025 13:19:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;&amp;gt; For the other cases, a simpler walk over the file, listing all data as deleted, will be a much better performing solution, and we should only apply this if the secondary index requests it&lt;/p&gt;

&lt;p&gt;I am not completely sure what you mean by this.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Something as simple as&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
expiredSSTables.forEach(sstable -&amp;gt; 
    sstable.getScanner().forEachRemaining(partition -&amp;gt; 
        partition.forEachRemaining(unfiltered -&amp;gt; 
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (unfiltered &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; Row)
                sendToIndexAsDeleted((Row) unfiltered))))&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="18013690" author="smiklosovic" created="Wed, 13 Aug 2025 13:57:37 +0000"  >&lt;p&gt;What&apos;s wrong with the &quot;method on index approach&quot;? Not sure why you changed your mind suddenly. We would need to check that index to send it to is CassandraIndex etc. Also not sure if we want to impose this logic on every index from now on. &lt;/p&gt;

&lt;p&gt;Also I think that integrating that with IndeGCTransaction etc. is more appropriate than to just &quot;remove rows&quot; like that. &lt;/p&gt;</comment>
                            <comment id="18013699" author="blambov" created="Wed, 13 Aug 2025 14:39:53 +0000"  >&lt;p&gt;There&apos;s nothing wrong with that, but it needs to be in addition to a change to explicitly go through the expired sstables. Going through the compaction path is not just inefficient, but also not entirely correct (because of the problem of retaining tombstones for various reasons).&lt;/p&gt;

&lt;p&gt;Instead of going through the compaction path, we need to walk the expired sstables as described above and call &lt;tt&gt;IndexGCTransaction&lt;/tt&gt;&apos;s methods (perhaps I should have been more explicit on that above, &lt;tt&gt;sendToIndexAsDeleted&lt;/tt&gt; should be doing &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-4.1/src/java/org/apache/cassandra/db/compaction/CompactionIterator.java#L247&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the same thing the listener would&lt;/a&gt; for these rows).&lt;/p&gt;</comment>
                            <comment id="18013720" author="smiklosovic" created="Wed, 13 Aug 2025 15:54:37 +0000"  >&lt;p&gt;OK, I will finish tomorrow, need to play with it a bit. &lt;/p&gt;</comment>
                            <comment id="18013723" author="smiklosovic" created="Wed, 13 Aug 2025 16:01:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blambov&quot; class=&quot;user-hover&quot; rel=&quot;blambov&quot;&gt;blambov&lt;/a&gt; OK, pushed the branch.&lt;/p&gt;

&lt;p&gt;How I tried to do that is that we will run through all expired rows just once. So I am iterating over SSTableReaders first, and then for each row I need to iterate over all indices, then create Indexer for each such row and remove.&lt;/p&gt;

&lt;p&gt;If I iterated over Indexes first, then each pass would effectively run through expired SSTables multiple times. Reading it all in one pass is better.&lt;/p&gt;</comment>
                            <comment id="18014067" author="smiklosovic" created="Fri, 15 Aug 2025 08:19:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-20829-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-20829-4.0&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java11_pre-commit_tests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#160;
&#160; &#10003; j11_build &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;1m 46s
&#160; &#10003; j11_cqlsh-dtests-py2-no-vnodes &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 25s
&#160; &#10003; j11_cqlsh-dtests-py2-with-vnodes &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 44s
&#160; &#10003; j11_cqlsh_dtests_py3 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 20s
&#160; &#10003; j11_cqlsh_dtests_py311 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 46s
&#160; &#10003; j11_cqlsh_dtests_py311_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 30s
&#160; &#10003; j11_cqlsh_dtests_py38 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;5m 37s
&#160; &#10003; j11_cqlsh_dtests_py38_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 6m 0s
&#160; &#10003; j11_cqlsh_dtests_py3_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 59s
&#160; &#10003; j11_cqlshlib_tests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;9m 4s
&#160; &#10003; j11_dtests_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;43m 48s
&#160; &#10003; j11_jvm_dtests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;13m 46s
&#160; &#10003; j11_unit_tests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 7m 58s
&#160; &#10005; j11_dtests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 55m 5s
&#160; &#160; &#160; refresh_test.TestRefresh test_refresh_deadlock_startup
&#160; &#10005; j11_unit_tests_repeat &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 31m 43s
&#160; &#160; &#160; org.apache.cassandra.index.CustomIndexTest testFailing2iFlush
java8_pre-commit_tests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;
&#160; &#10003; j8_build &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 2m 31s
&#160; &#10003; j8_cqlsh-dtests-py2-no-vnodes &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;5m 35s
&#160; &#10003; j8_cqlsh-dtests-py2-with-vnodes &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;6m 39s
&#160; &#10003; j8_cqlsh_dtests_py3 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;5m 22s
&#160; &#10003; j8_cqlsh_dtests_py38 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 6m 25s
&#160; &#10003; j8_cqlsh_dtests_py38_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;7m 7s
&#160; &#10003; j8_cqlsh_dtests_py3_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;6m 21s
&#160; &#10003; j8_cqlshlib_tests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;9m 51s
&#160; &#10003; j8_dtests_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;42m 9s
&#160; &#10003; j8_jvm_dtests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 15m 14s
&#160; &#10003; j8_unit_tests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;7m 50s
&#160; &#10003; j8_utests_system_keyspace_directory &#160; &#160; &#160; &#160; &#160; &#160; &#160;7m 46s
&#160; &#10003; j8_utests_system_keyspace_directory_repeat &#160; &#160; &#160;30m 58s
&#160; &#10003; j11_unit_tests_repeat &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 30m 28s
&#160; &#10003; j11_unit_tests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 8m 35s
&#160; &#10003; j11_dtests_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;42m 43s
&#160; &#10003; j11_cqlsh_dtests_py3_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 25s
&#160; &#10003; j11_cqlsh_dtests_py38_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;5m 45s
&#160; &#10003; j11_cqlsh_dtests_py38 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;5m 22s
&#160; &#10003; j11_cqlsh_dtests_py311_vnode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 54s
&#160; &#10003; j11_cqlsh_dtests_py311 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 28s
&#160; &#10003; j11_cqlsh_dtests_py3 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 42s
&#160; &#10003; j11_cqlsh-dtests-py2-with-vnodes &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 48s
&#160; &#10003; j11_cqlsh-dtests-py2-no-vnodes &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 5m 21s
&#160; &#10005; j8_dtests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 54m 47s
&#160; &#160; &#160; refresh_test.TestRefresh test_refresh_deadlock_startup
&#160; &#10005; j8_unit_tests_repeat &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;31m 19s
&#160; &#160; &#160; org.apache.cassandra.index.CustomIndexTest testFailing2iFlush
&#160; &#10005; j11_dtests &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;54m 50s
&#160; &#160; &#160; refresh_test.TestRefresh test_refresh_deadlock_startup
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5939/workflows/51d1a5a2-3338-4def-9437-f7fc01d441ce&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java11_pre-commit_tests&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5939/workflows/80f1331a-4621-4885-b256-2993974989c6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java8_pre-commit_tests&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;org.apache.cassandra.index.CustomIndexTest testFailing2iFlush is just flaky and multiplexer just reveiled that. &lt;/p&gt;</comment>
                            <comment id="18014093" author="smiklosovic" created="Fri, 15 Aug 2025 11:39:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-20829-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-20829-4.1&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java11_pre-commit_tests                         
  &#10003; j11_build                                        1m 58s
  &#10003; j11_cqlsh_dtests_py311                           5m 44s
  &#10003; j11_cqlsh_dtests_py311_vnode                     6m 42s
  &#10003; j11_cqlshlib_cython_tests                        11m 8s
  &#10003; j11_cqlshlib_tests                               7m 25s
  &#10003; j11_dtests_vnode                                41m 39s
  &#10003; j11_jvm_dtests                                  18m 38s
  &#10003; j11_jvm_dtests_vnode                            12m 10s
  &#10003; j11_unit_tests                                  10m 31s
  &#10003; j11_unit_tests_repeat                            32m 8s
  &#10005; j11_cqlsh_dtests_py3                             5m 42s
      cql_tracing_test.TestCqlTracing test_tracing_simple
      cql_tracing_test.TestCqlTracing test_tracing_unknown_impl
  &#10005; j11_cqlsh_dtests_py38                            5m 51s
      cql_tracing_test.TestCqlTracing test_tracing_default_impl
  &#10005; j11_cqlsh_dtests_py38_vnode                       6m 1s
      cql_tracing_test.TestCqlTracing test_tracing_unknown_impl
  &#10005; j11_cqlsh_dtests_py3_vnode                        6m 1s
      cql_tracing_test.TestCqlTracing test_tracing_default_impl
  &#10005; j11_dtests                                      55m 31s
      refresh_test.TestRefresh test_refresh_deadlock_startup
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I am not sure what&apos;s up with TestCqlTracing, that is hardly related to what we do here. It does not fail in Jenkins.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5946/workflows/599c24f0-d47b-49d8-b76d-c9bdfb00fda1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java11_pre-commit_tests&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18014155" author="smiklosovic" created="Fri, 15 Aug 2025 15:50:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-20829-5.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-20829-5.0&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java17_pre-commit_tests                         
  &#10003; j17_build                                        5m 44s
  &#10003; j17_cqlsh_dtests_py311                            6m 5s
  &#10003; j17_cqlsh_dtests_py311_vnode                     6m 38s
  &#10003; j17_cqlsh_dtests_py38                            6m 17s
  &#10003; j17_cqlsh_dtests_py38_vnode                       6m 3s
  &#10003; j17_cqlshlib_cython_tests                       10m 25s
  &#10003; j17_cqlshlib_tests                               6m 55s
  &#10003; j17_dtests_latest                                40m 6s
  &#10003; j17_dtests_vnode                                40m 46s
  &#10003; j17_jvm_dtests                                  19m 45s
  &#10003; j17_jvm_dtests_latest_vnode                     19m 58s
  &#10003; j17_unit_tests                                  14m 14s
  &#10003; j17_unit_tests_repeat                           33m 45s
  &#10003; j17_utests_latest                               16m 29s
  &#10003; j17_utests_oa                                   15m 43s
  &#10003; j17_utests_oa_repeat                            33m 35s
  &#10005; j17_dtests                                      36m 34s
      refresh_test.TestRefresh test_refresh_deadlock_startup
  &#10005; j17_utests_latest_repeat                        32m 19s
      org.apache.cassandra.index.CustomIndexTest testFailing2iFlush &amp;lt;- multiplexer discovered, not related though
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5948/workflows/31c92686-74b0-495a-a1c1-0b5b5f93920e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java17_pre-commit_tests&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="18014622" author="smiklosovic" created="Mon, 18 Aug 2025 14:05:36 +0000"  >&lt;p&gt;trunk &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5951/workflows/34d7dfc3-842d-481b-882b-a928d347413a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5951/workflows/34d7dfc3-842d-481b-882b-a928d347413a&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18014655" author="blambov" created="Mon, 18 Aug 2025 15:43:43 +0000"  >&lt;p&gt;All branches LGTM.&lt;/p&gt;</comment>
                            <comment id="18015080" author="smiklosovic" created="Wed, 20 Aug 2025 08:16:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-20829-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-20829-trunk&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java17_pre-commit_tests                         
  &#10003; j17_build                                        9m 38s
  &#10003; j17_cqlsh_dtests_py311                           7m 35s
  &#10003; j17_cqlsh_dtests_py311_vnode                     7m 10s
  &#10003; j17_cqlsh_dtests_py38                            6m 51s
  &#10003; j17_cqlsh_dtests_py38_vnode                      7m 10s
  &#10003; j17_cqlshlib_cython_tests                       12m 37s
  &#10003; j17_cqlshlib_tests                              11m 52s
  &#10003; j17_dtests_latest                               45m 34s
  &#10003; j17_dtests_vnode                                44m 21s
  &#10003; j17_unit_tests_repeat                           32m 51s
  &#10003; j17_utests_oa_repeat                            33m 25s
  &#10005; j17_dtests                                     1h 0m 5s
  &#10005; j17_jvm_dtests                                  34m 59s
      org.apache.cassandra.distributed.test.SSTableLoaderEncryptionOptionsTest bulkLoaderSuccessfullyStreamsOverSslWithDeprecatedSslStoragePort
  &#10005; j17_jvm_dtests_latest_vnode                     37m 42s
      org.apache.cassandra.distributed.test.streaming.IndexBuildFailsAfterStreamingTest test
      junit.framework.TestSuite org.apache.cassandra.distributed.test.accord.MigrationFromAccordReadRaceTest
      junit.framework.TestSuite org.apache.cassandra.distributed.test.accord.MigrationFromAccordReadRaceTest
      junit.framework.TestSuite org.apache.cassandra.distributed.test.accord.MigrationFromAccordWriteRaceTest
      junit.framework.TestSuite org.apache.cassandra.distributed.test.accord.MigrationFromAccordWriteRaceTest
      junit.framework.TestSuite org.apache.cassandra.distributed.test.accord.MigrationToAccordWriteRaceTest
      junit.framework.TestSuite org.apache.cassandra.distributed.test.accord.MigrationToAccordWriteRaceTest
      org.apache.cassandra.distributed.test.sai.IndexHintsDistributedTest testIndexHintsWithAllOldVersion
      junit.framework.TestSuite org.apache.cassandra.distributed.test.accord.AccordMigrationTest
      junit.framework.TestSuite org.apache.cassandra.distributed.test.accord.AccordMigrationTest
      org.apache.cassandra.distributed.test.SSTableLoaderEncryptionOptionsTest bulkLoaderSuccessfullyStreamsOverSslWithDeprecatedSslStoragePort
      org.apache.cassandra.distributed.test.cql3.FullAccordInteropMultiNodeTokenConflictTest test
  &#10005; j17_unit_tests                                  18m 22s
      org.apache.cassandra.service.accord.EpochSyncTest test
  &#10005; j17_utests_latest                               19m 37s
      org.apache.cassandra.service.accord.EpochSyncTest test
      org.apache.cassandra.net.ConnectionTest testTimeout
      org.apache.cassandra.index.CustomIndexTest testFailing2iFlush
  &#10005; j17_utests_oa                                   19m 43s
      org.apache.cassandra.service.accord.EpochSyncTest test
java17_separate_tests                            
  &#10003; j17_build                                        10m 2s
  &#10003; j17_unit_tests_repeat                            33m 3s
  &#10005; j17_dtests                                      40m 14s
      refresh_test.TestRefresh test_refresh_deadlock_startup
java11_pre-commit_tests                         
java11_separate_tests                            
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5965/workflows/b17be3ae-0fef-45fb-b6a6-15784db853dd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java17_pre-commit_tests&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5965/workflows/bb172371-5d84-4caf-952c-383212b4fc81&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java17_separate_tests&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[smiklosovic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12989" cascade-level="1"><![CDATA[Consistency]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1x7yo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blambov]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348835">NA</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/eb9586dc68444d204a5347ef6814b2f041a81559&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/eb9586dc68444d204a5347ef6814b2f041a81559&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;ci&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>