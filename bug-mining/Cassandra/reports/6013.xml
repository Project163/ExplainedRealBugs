<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:24:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-17563] Fix CircleCI Midres config</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-17563</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;During CircleCI addition of a new job to the config, the midres file got messy. Two of the immediate issues (but we need to verify all jobs will use the right executors and resources):&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the new job needs to use higher parallelism as the original in-jvm job&lt;/li&gt;
	&lt;li&gt;&#160;j8_dtests_with_vnodes should get from midres 50 large but currently midres makes it run with 25 and medium which fails around 100 tests&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13440541">CASSANDRA-17563</key>
            <summary>Fix CircleCI Midres config</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="edimitrova">Ekaterina Dimitrova</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Apr 2022 22:41:31 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:59 +0000</updated>
                            <resolved>Wed, 4 May 2022 16:08:32 +0000</resolved>
                                        <fixVersion>4.1-alpha1</fixVersion>
                    <fixVersion>4.1</fixVersion>
                                    <component>CI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17524622" author="edimitrova" created="Tue, 19 Apr 2022 22:43:28 +0000"  >&lt;p&gt;I identified the issue with trunk but we need to check all branches where the breaking config was committed.&lt;/p&gt;

&lt;p&gt;CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17525162" author="dcapwell" created="Wed, 20 Apr 2022 18:10:12 +0000"  >&lt;p&gt;MIDRES: &lt;a href=&quot;https://app.circleci.com/pipelines/github/dcapwell/cassandra/1367/workflows/43edfcf2-229f-4650-874b-bc1faccf77af&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/dcapwell/cassandra/1367/workflows/43edfcf2-229f-4650-874b-bc1faccf77af&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17525173" author="dcapwell" created="Wed, 20 Apr 2022 18:21:27 +0000"  >&lt;p&gt;MIDRES attempt 2 (missing new script): &lt;a href=&quot;https://app.circleci.com/pipelines/github/dcapwell/cassandra/1368/workflows/41c514ca-1435-4e71-b808-f848b375b268&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/dcapwell/cassandra/1368/workflows/41c514ca-1435-4e71-b808-f848b375b268&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17525204" author="edimitrova" created="Wed, 20 Apr 2022 18:40:24 +0000"  >&lt;ul&gt;
	&lt;li&gt;&quot;highers&quot; should be &quot;highres&quot; everywhere, same &quot;lowers&quot; should be &quot;lowres&quot;&lt;/li&gt;
	&lt;li&gt;I believe there is some forgotten commented out code&lt;/li&gt;
	&lt;li&gt;we need to update readme&lt;/li&gt;
	&lt;li&gt;we need to verify all branches&lt;/li&gt;
	&lt;li&gt;we need to verify this works smoothly also with highres&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;These are immediate comments. I will check in detail the midres config after CI shows good results. By the way the new link leads to a canceled CI run&lt;/p&gt;</comment>
                            <comment id="17525209" author="dcapwell" created="Wed, 20 Apr 2022 18:44:43 +0000"  >&lt;p&gt;don&apos;t know why but attempt 2 wasn&apos;t on the updated commit, &lt;/p&gt;

&lt;p&gt;MIDRES attempt 3: &lt;a href=&quot;https://app.circleci.com/pipelines/github/dcapwell/cassandra/1370/workflows/96cb49ae-1bad-4412-a04a-3431a66cd641&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/dcapwell/cassandra/1370/workflows/96cb49ae-1bad-4412-a04a-3431a66cd641&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17525287" author="dcapwell" created="Wed, 20 Apr 2022 21:01:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;Bereng&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandonwilliams&quot; class=&quot;user-hover&quot; rel=&quot;brandonwilliams&quot;&gt;brandonwilliams&lt;/a&gt; mind reviewing?  You are all familiar with circle ci so value your feedback&lt;/p&gt;

&lt;p&gt;MIDRES: &lt;a href=&quot;https://app.circleci.com/pipelines/github/dcapwell/cassandra/1372/workflows/942cf870-c90d-4a29-ab97-b335caf2d08f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/dcapwell/cassandra/1372/workflows/942cf870-c90d-4a29-ab97-b335caf2d08f&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17525288" author="dcapwell" created="Wed, 20 Apr 2022 21:02:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmckenzie&quot; class=&quot;user-hover&quot; rel=&quot;jmckenzie&quot;&gt;jmckenzie&lt;/a&gt; cc&lt;/p&gt;</comment>
                            <comment id="17525291" author="dcapwell" created="Wed, 20 Apr 2022 21:05:12 +0000"  >&lt;p&gt;Created a script to dump the resources (type + parallel) for each job, used this to diff old configs to make sure they matched; below is the output as of 20175bf77e2c6f72c25240ee445b583805a37630 (before vnode patch)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ diff midres.resources midres.resources.&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;
9a10
&amp;gt; j11_jvm_dtests_vnode  medium  10
22a24
&amp;gt; j8_jvm_dtests_vnode   large   10
(CASSANDRA-17563) $ diff higher.resources higher.resources.&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;
9a10
&amp;gt; j11_jvm_dtests_vnode  xlarge  5
22a24
&amp;gt; j8_jvm_dtests_vnode   xlarge  5
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17525292" author="brandon.williams" created="Wed, 20 Apr 2022 21:06:21 +0000"  >&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17525294" author="dcapwell" created="Wed, 20 Apr 2022 21:10:56 +0000"  >&lt;p&gt;marking 4.1 as I broke trunk, so need to fix so CI works for everyone&lt;/p&gt;</comment>
                            <comment id="17525606" author="bereng" created="Thu, 21 Apr 2022 10:07:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt; I am in the middle of sthg but I will try to look into this asap&lt;/p&gt;</comment>
                            <comment id="17525764" author="edimitrova" created="Thu, 21 Apr 2022 14:54:41 +0000"  >&lt;p&gt;My previous point still stands that we need to be sure everything on all branches works as before.&#160;&lt;/p&gt;

&lt;p&gt;IMHO what we really need to see is that every new highres and midres on every branch has only an addition of a new job in_jvm which match as resource usage the old single in_jvm job and no other changes applied.&#160;&lt;/p&gt;

&lt;p&gt;Thanks for all the updates and adding the docs, etc. I understand and really appreciate your good intentions for improvement and ease of maintenance. Unfortunately, I have a few immediate concerns w which make me think we need to have immediate fix for midres and rewrites of the scripts after the release:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;There are changes to the other generate.sh script I haven&apos;t looked at but any change there need to be tested that it didn&apos;t break any of the options added and tested one by one by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&#160;&lt;/li&gt;
	&lt;li&gt;My concern is we don&apos;t know who was using what and how and it was working fine for quite some time. Do we want to rewrite the whole approach one week before freeze when people highly utilize CI to push their latest work? What do others think?&lt;/li&gt;
	&lt;li&gt;Also, now we will have a mix of python and shell scripts, are we sure the community will accept that?&#160;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I really like and appreciate how you added diff but I am confused &#160;from the output what I am seeing actually. I see the new name and resource change.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17525883" author="dcapwell" created="Thu, 21 Apr 2022 17:31:44 +0000"  >&lt;blockquote&gt;&lt;p&gt;has only an addition of a new job in_jvm which match as resource usage the old single in_jvm job and no other changes applied.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Currently this is a massive amount of manual work to confirm, and there isn&apos;t a good source of truth to compare against; this patch moves the source of truth into a map so we know what happens (if you don&apos;t update you get default for the level, else you add an override)&lt;/p&gt;

&lt;p&gt;We talked about this a lot in slack, and my personal feeling is every step in a manual process is another chance for error, so the more steps done the higher risk to do it incorrectly; the current process as I can find is the following&lt;/p&gt;

&lt;p&gt;1) create config-2_1.yml.MIDRES and config-2_1.yml.HIGHER using the current patches&lt;br/&gt;
2) update config-2_1.yml with your change&lt;br/&gt;
3) update config-2_1.yml.MIDRES with your change, and figure out how to apply the updated resources&lt;br/&gt;
4) update config-2_1.yml.HIGHER with your change and figure out how to apply the updated resources (method does not match step 3, so the &quot;how&quot; is different here)&lt;br/&gt;
5) generate diff for MIDRES and update patch&lt;br/&gt;
6) generate diff for HIGHER and update patch&lt;br/&gt;
7) test LOWER - success is defined as &quot;what failed before is the only thing failing now&quot;&lt;br/&gt;
8) test MIDRES - success is defined as &quot;what failed before is the only thing failing now&quot;&lt;br/&gt;
9) test HIGHER - success is defined as &quot;what failed before is the only thing failing now&quot;&lt;/p&gt;

&lt;p&gt;did I miss anything?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;There are changes to the other generate.sh script I haven&apos;t looked at but any change there need to be tested&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;given there are 0 tests for the script, 2 different people &quot;testing&quot; could yield different results, so we would need to have some way to define success that is agreed upon.  &lt;/p&gt;

&lt;p&gt;For example, I fixed what I saw was a bug, when you ask it to generate LOWER, MIDRES, or HIGHER it doesn&apos;t actually update those files and instead only updates config.yml; the help page says this but to me this is unexpected behavior&lt;/p&gt;

&lt;p&gt;-a updates config.yml.LOWER, config.yml.MIDRES, and config.yml.HIGHER,&lt;br/&gt;
-h updates config.yml only!&lt;/p&gt;

&lt;p&gt;I am totally cool with -h updating config.yml as well, but it feels like a bug that config.yml.HIGHER isn&apos;t updated... so my patch changing that... which one of us is the bug?&lt;/p&gt;

&lt;p&gt;Now, if we want to define it as &quot;they did the same thing regardless of personal feelings about correct behavior&quot; then I do know for a fact my patch is different; I am 100% ok reverting that difference&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;My concern is we don&apos;t know who was using what and how and it was working fine for quite some time&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I feel like a politician... can you define the word &quot;what&quot;?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Do we want to rewrite the whole approach one week before freeze when people highly utilize CI to push their latest work?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;the core change is moving away from patch to modifying the yaml tree; there are other changes but those are personal preference and 100% fine to drop... &lt;/p&gt;

&lt;p&gt;To me I ask the following question &quot;if you yaml diff the old and new files, are there a difference?&quot; if the answer is no, then there isn&apos;t much of a risk other than the script not working on an unknown laptop (which impacts generate.sh only, not CI configs).&lt;/p&gt;

&lt;p&gt;Now, if you want to de-risk that, we could use this script to generate the patches, but we don&apos;t solve the real problem of patches applying when they shouldn&apos;t (which is how I broke MIDRES).  If we want to do that to lower risk before 4.1 freeze I am cool with that, but do not think that is a valid long term solution&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;now we will have a mix of python and shell scripts, are we sure the community will accept that? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;that is something anyone who touches this needs to answer, which is why I tried to pull in anyone who touched this logic to get their feedback.  I do know that many in the community basically do this already (can tell by looking at circle ci as my private scripts rename things and cleanup our DAG), so its just moving part of that private logic into OSS to help maintain these files.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I really like and appreciate how you added diff but I am confused  from the output what I am seeing actually. I see the new name and resource change.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;do you mean the output of the dump of what each job&apos;s resource is?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ diff midres.resources midres.resources.&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;
9a10
&amp;gt; j11_jvm_dtests_vnode  medium  10
22a24
&amp;gt; j8_jvm_dtests_vnode   large   10
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;so this is diff output, so &quot;&amp;gt;&quot; means that the right-hand-side has the following, but there is no matching on the left hand side... aka &quot;new job&quot;&lt;/p&gt;

&lt;p&gt;you see that MIDRES j8 and j11 do not have matching resources!  This is because they don&apos;t now (as defined before the vnode patch), so I am pointing out that j11 and j8 run with different resources on MIDRES and that I am not changing that behavior in this patch (more than glad to if you desire)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
j11_jvm_dtests  medium  10
j11_jvm_dtests_vnode  medium  10
j8_jvm_dtests large 10
j8_jvm_dtests_vnode large 10
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;they match in HIGHER but not MIDRES, I do not know if there was a reason for this before so I left it to be true still.&lt;/p&gt;</comment>
                            <comment id="17526016" author="dcapwell" created="Thu, 21 Apr 2022 19:29:12 +0000"  >&lt;p&gt;Speaking with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; in slack, I moved the patch to not touch generate.sh and instead the scripts are used to create the patches (created script to create the patches and updated docs to show how)&lt;/p&gt;</comment>
                            <comment id="17526048" author="edimitrova" created="Thu, 21 Apr 2022 19:44:12 +0000"  >&lt;p&gt;Thanks, so now everything will be the same in the setup, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;only adds a tool to help to create new patches with minimum efforts. If someone prefers to do it manually - that is fine. In all cases we need to verify after that the generated MIDRES and HIGHRES files have exactly what we want for &quot;happy&quot; CI &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;

&lt;p&gt;The only thing to be mentioned is that the tool might rearrange the attributes, so if someone feels bad about that, they can just use the old way and skip seeing those rearrangements being just additional noise.&#160;&lt;/p&gt;</comment>
                            <comment id="17528869" author="jmckenzie" created="Wed, 27 Apr 2022 16:04:59 +0000"  >&lt;p&gt;When I diff MIDRES pre and post &lt;tt&gt;20175bf77e2c6f72c25240ee445b583805a37630&lt;/tt&gt; I get the following (along with vnode in-jvm changes I&apos;d expect):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-          set -eo pipefail &amp;amp;&amp;amp; circleci tests glob &lt;span class=&quot;code-quote&quot;&gt;&quot;$HOME/cassandra/test/distributed&lt;span class=&quot;code-comment&quot;&gt;/**/&lt;/span&gt;*.java&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;$HOME/cassandra/test/simulator/test&lt;span class=&quot;code-comment&quot;&gt;/**/&lt;/span&gt;*.java&quot;&lt;/span&gt; &amp;gt; /tmp/all_java_unit_tests.txt
+          set -eo pipefail &amp;amp;&amp;amp; circleci tests glob &lt;span class=&quot;code-quote&quot;&gt;&quot;$HOME/cassandra/test/distributed&lt;span class=&quot;code-comment&quot;&gt;/**/&lt;/span&gt;*.java&quot;&lt;/span&gt; &amp;gt; /tmp/all_java_unit_tests.txt
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is this change (dropping simulator tests from all test enumeration, assuming I&apos;m understanding this correctly) intentional?&lt;/p&gt;</comment>
                            <comment id="17528884" author="edimitrova" created="Wed, 27 Apr 2022 16:43:59 +0000"  >&lt;p&gt;They should be returned too. Only change from that patch should be adding the new in-jvm job with resources matching the ones used for the original in-jvm job on every level - lowres, midres and highres&lt;/p&gt;</comment>
                            <comment id="17529005" author="jmckenzie" created="Wed, 27 Apr 2022 19:11:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;Only change from that patch should be adding the new in-jvm job&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;There&apos;s quite a bit more going on in &lt;a href=&quot;https://github.com/apache/cassandra/pull/1579&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this PR&lt;/a&gt; than a simple revert of resource allocation in midres. What am I reviewing here? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17529393" author="edimitrova" created="Thu, 28 Apr 2022 12:03:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;raised the point that the current way to update these resource files is error-prone and he suggested also a new tool with the idea that it can help prevent such mistakes in the future.&lt;/p&gt;

&lt;p&gt;I feel that there was more of misunderstanding around what MIDRES is and that it is not just a matter of up and down the resources, there are also different executors as the idea behind that file was tuned usage of resources, while HIGHRES is just bump to the max as far as I know. Also no matter of any automations, apply a clean patch should be considered as - content also verified by a human (more or less as every patch we work in), not only apply patch without failure. If this is ambiguous - let&apos;s update the readme.&#160;&lt;/p&gt;

&lt;p&gt;I am all in for improvements but I think we can split at this point the work at least in two commits - one to urgently fix MIDRES so people stop looking for workarounds, abuse their credits with HIGHRES or troubleshoot why they see 100 python tests failing before the freeze.&lt;/p&gt;

&lt;p&gt;And the other one we can continue reviewing - the supplemental tool.&lt;/p&gt;

&lt;p&gt;I already said what I want to see - only addition of a new job as per the intentions of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17332&quot; title=&quot;Add support for vnodes in jvm-dtest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17332&quot;&gt;&lt;del&gt;CASSANDRA-17332&lt;/del&gt;&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;If &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;doesn&apos;t have the time, I suggest again I do at least the fix as this config is really important.&#160;&lt;/p&gt;</comment>
                            <comment id="17529395" author="brandon.williams" created="Thu, 28 Apr 2022 12:08:36 +0000"  >&lt;blockquote&gt;&lt;p&gt;I am all in for improvements but I think we can split at this point the work at least in two commits - one to urgently fix MIDRES so people stop looking for workarounds, abuse their credits with HIGHRES or troubleshoot why they see 100 python tests failing before the freeze.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree that bringing MIDRES back to a functioning state like before should be the priority, this was our default configuration and used heavily.&lt;/p&gt;</comment>
                            <comment id="17529400" author="adelapena" created="Thu, 28 Apr 2022 12:19:53 +0000"  >&lt;p&gt;+1 to fix MIDRES as soon as possible and do the improvements in a separate followup ticket. That way those of us using MIDRES will be able to not use more resources than intended, especially since we are close to a release.&lt;/p&gt;</comment>
                            <comment id="17529505" author="dcapwell" created="Thu, 28 Apr 2022 15:49:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;Is this change (dropping simulator tests from all test enumeration, assuming I&apos;m understanding this correctly) intentional?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmckenzie&quot; class=&quot;user-hover&quot; rel=&quot;jmckenzie&quot;&gt;jmckenzie&lt;/a&gt; they were removed in the vnode patch, I spoke with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; and the patch manually modified the config.yml* files and not config-2.1.yml due to confusion; the simulator tests were not added at the time so that statement was a no-op&lt;/p&gt;

&lt;p&gt;It wasn&apos;t intentional as it was done by running &quot;generate.sh -a&quot;; I feel this should be fixed in a patch to enable simulator tests, I don&apos;t see the benefit to have it as its dead code atm.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If David Capwell doesn&apos;t have the time, I suggest again I do at least the fix as this config is really important. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I have 0 issue taking the patch from this and making its own commit, but I do have concerns for me to manually create a new MIDRES as that thing I found out the hard way is brittle; hence this patch.  If you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; are confident I am ok with you fixing the patch, but I am not confident about doing it myself.&lt;/p&gt;</comment>
                            <comment id="17529509" author="edimitrova" created="Thu, 28 Apr 2022 16:03:03 +0000"  >&lt;p&gt;I will fix the midres for all branches tonight, at latest tomorrow morning. It needs to be revised/fixed on all branches.&lt;/p&gt;

&lt;p&gt;Shall we open a ticket for the simulator tests to be revised and added everywhere?&lt;/p&gt;</comment>
                            <comment id="17529510" author="benedict" created="Thu, 28 Apr 2022 16:04:38 +0000"  >&lt;p&gt;Yes, I will enable them in another patch - there is an outstanding ticket fixing a bug with Paxos_v2 that will address this.&lt;/p&gt;</comment>
                            <comment id="17529511" author="edimitrova" created="Thu, 28 Apr 2022 16:05:54 +0000"  >&lt;p&gt;Great, thanks! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17529514" author="jmckenzie" created="Thu, 28 Apr 2022 16:21:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;I do have concerns for me to manually create a new MIDRES as that thing I found out the hard way is brittle; hence this patch. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;100% agree; hence my feedback about us making the UX a little clearer / smoother for folks so the scripted creation becomes the One True Way going forward.&lt;/p&gt;

&lt;p&gt;Breaking out the &quot;revert MIDRES to working state&quot; from &quot;make this less brittle going forward&quot; gets a conceptual / philosophical +1 from me.&lt;/p&gt;</comment>
                            <comment id="17530294" author="edimitrova" created="Sat, 30 Apr 2022 01:25:56 +0000"  >&lt;p&gt;For the record, this was a merge patch but the midres changes were done only for trunk. No issue with previous branches.&lt;/p&gt;

&lt;p&gt;Also, &#160;noticed all in_jvm for midres have to be large, p10. J11 was left medium. Checked the old records where large was decided.&#160;&lt;/p&gt;

&lt;p&gt;So the current patch reverts the two additional changes we see in MIDRES after adding the new job plus raise to large the J11 in_jvm.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/new/CASSANDRA-16677-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Patch&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=CASSANDRA-16677-trunk&amp;amp;filter=all&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI&lt;/a&gt; just started&lt;/p&gt;</comment>
                            <comment id="17530295" author="edimitrova" created="Sat, 30 Apr 2022 01:28:38 +0000"  >&lt;p&gt;How I fixed it: applied the midres patch to  the config file before &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&apos;s patch and then applied his patch (check the new jobs with the old in_jvm that they use same resources), then recreated the patch with diff and created the MIDRES file. Visual double-check to see only what I want was applied. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Plus quick compare with his changes&lt;/p&gt;</comment>
                            <comment id="17530438" author="adelapena" created="Sat, 30 Apr 2022 19:19:37 +0000"  >&lt;p&gt;The latter patch fixing the patch and MIDRES looks good to me, +1. Good catch on the usage of &lt;tt&gt;medium&lt;/tt&gt; in&#160;&lt;tt&gt;j11_jvm_dtests&lt;/tt&gt;, I think that particular one is also wrong in 4.0, where j8 uses &lt;tt&gt;large&lt;/tt&gt; and j11 uses &lt;tt&gt;medium&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17530567" author="edimitrova" created="Sun, 1 May 2022 20:43:58 +0000"  >&lt;p&gt;Thank you for the quick review! I see &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt; opened a ticket for the branching with a lot of tasks so I will hold off committing this one until tomorrow to ensure I don&#8217;t interrupt him. &lt;br/&gt;
About 4.0 - yes, I will fix it with another ticket I have for moving the circle config images to be  listed with &#8220;latest&#8221; tag, same as Jenkins, so we don&#8217;t have to update every time there is a new test image pushed. I can do it later this week. &lt;/p&gt;</comment>
                            <comment id="17531417" author="edimitrova" created="Tue, 3 May 2022 21:11:12 +0000"  >&lt;p&gt;Now when the CI and branches are back on track, I am going to rebase and run again the patch with our brand new cassandra-4.1 and trunk. Commit pending CI&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-4.1...ekaterinadimitrova2:16677-4.1?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1&lt;/a&gt;&#160;| &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=16677-4.1&amp;amp;filter=all&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:trunk-17589?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk &lt;/a&gt;| &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra?branch=trunk-17589&amp;amp;filter=all&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17531466" author="edimitrova" created="Wed, 4 May 2022 00:59:53 +0000"  >&lt;p&gt;The usual suspects... nothing new and related to this patch or the branching as issue.&lt;/p&gt;

&lt;p&gt;I will commit it soon. Then wen can move back to discussing the newly suggested scripts.&lt;/p&gt;</comment>
                            <comment id="17531468" author="edimitrova" created="Wed, 4 May 2022 01:15:28 +0000"  >&lt;p&gt;Committed to cassandra-4.1 -&amp;gt; &lt;a href=&quot;https://github.com/apache/cassandra/commit/523d38095f6c7f33c602616db3a7373bbeb0cde9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/523d38095f6c7f33c602616db3a7373bbeb0cde9&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Merged to trunk.&#160;&lt;/p&gt;</comment>
                            <comment id="17531976" author="dcapwell" created="Wed, 4 May 2022 22:41:14 +0000"  >&lt;p&gt;moved the script to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17600&quot; title=&quot;CircleCI should rely on well known behavior rather than manual patch files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17600&quot;&gt;CASSANDRA-17600&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13443209">CASSANDRA-17600</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13426035">CASSANDRA-17332</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[dcapwell]]></customfieldvalue>
        <customfieldvalue><![CDATA[e.dimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 27 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z11m14:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[adelapena]]></customfieldvalue>
        <customfieldvalue><![CDATA[e.dimitrova]]></customfieldvalue>
        <customfieldvalue><![CDATA[jmckenzie]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12336842">4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/523d38095f6c7f33c602616db3a7373bbeb0cde9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/523d38095f6c7f33c602616db3a7373bbeb0cde9&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;validated the diff matches resources as of commit 20175bf77e2c6f72c25240ee445b583805a37630, before the vnode changes were merged&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>