<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:18:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-16143] Streaming fails when s SSTable writer finish() exceeds internode_tcp_user_timeout</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-16143</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;tl;dr The internode TCP user timeout that provides more responsive detection of dead nodes for internode message will cause streaming to fail if system calls to fsync/fdatasync exceed the timeout (default 30s).&lt;/p&gt;

&lt;p&gt;To workaround, explicitly set internode_tcp_user_timeout to longer than fsync/fdatasync, or to zero to revert to the operating system default.&lt;/p&gt;

&lt;p&gt;Details:&lt;/p&gt;

&lt;p&gt;While bootstrapping a replacement 4.0beta3 node in an existing cluster, bootstrap streaming repeatedly failed with the streaming follower logging&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ERROR 2020-09-10T14:29:34,711 [NettyStreaming-Outbound-1.1.1.1.7000:1] org.apache.cassandra.streaming.StreamSession:693 - [Stream #7cb67c00-f3ac-11ea-b940-f7836f164528] Streaming error occurred on session with peer 1.1.1.1:7000
org.apache.cassandra.net.AsyncChannelOutputPlus$FlushException: The channel &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; output stream was writing to has been closed
       at org.apache.cassandra.net.AsyncChannelOutputPlus.propagateFailedFlush(AsyncChannelOutputPlus.java:200)
       at org.apache.cassandra.net.AsyncChannelOutputPlus.waitUntilFlushed(AsyncChannelOutputPlus.java:158)
       at org.apache.cassandra.net.AsyncChannelOutputPlus.waitForSpace(AsyncChannelOutputPlus.java:140)
       at org.apache.cassandra.net.AsyncChannelOutputPlus.beginFlush(AsyncChannelOutputPlus.java:97)
       at org.apache.cassandra.net.AsyncStreamingOutputPlus.lambda$writeToChannel$0(AsyncStreamingOutputPlus.java:142)
       at org.apache.cassandra.db.streaming.CassandraCompressedStreamWriter.lambda$write$0(CassandraCompressedStreamWriter.java:90)
       at org.apache.cassandra.net.AsyncStreamingOutputPlus.writeToChannel(AsyncStreamingOutputPlus.java:138)
       at org.apache.cassandra.db.streaming.CassandraCompressedStreamWriter.write(CassandraCompressedStreamWriter.java:89)
       at org.apache.cassandra.db.streaming.CassandraOutgoingFile.write(CassandraOutgoingFile.java:180)
       at org.apache.cassandra.streaming.messages.OutgoingStreamMessage.serialize(OutgoingStreamMessage.java:87)
       at org.apache.cassandra.streaming.messages.OutgoingStreamMessage$1.serialize(OutgoingStreamMessage.java:45)
       at org.apache.cassandra.streaming.messages.OutgoingStreamMessage$1.serialize(OutgoingStreamMessage.java:34)
       at org.apache.cassandra.streaming.messages.StreamMessage.serialize(StreamMessage.java:40)
       at org.apache.cassandra.streaming.async.NettyStreamingMessageSender$FileStreamTask.run(NettyStreamingMessageSender.java:347)
       at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) [?:?]
       at java.util.concurrent.FutureTask.run(FutureTask.java:264) [?:?]
       at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]
       at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]
       at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-all-4.1.50.Final.jar:4.1.50.Final]
       at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834) [?:?]
       Suppressed: java.nio.channels.ClosedChannelException
               at org.apache.cassandra.net.AsyncStreamingOutputPlus.doFlush(AsyncStreamingOutputPlus.java:78)
               at org.apache.cassandra.net.AsyncChannelOutputPlus.flush(AsyncChannelOutputPlus.java:229)
               at org.apache.cassandra.net.AsyncChannelOutputPlus.close(AsyncChannelOutputPlus.java:248)
               at org.apache.cassandra.streaming.async.NettyStreamingMessageSender$FileStreamTask.run(NettyStreamingMessageSender.java:348)
               at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) [?:?]
               at java.util.concurrent.FutureTask.run(FutureTask.java:264) [?:?]
               at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]
               at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]
               at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-all-4.1.50.Final.jar:4.1.50.Final]
               at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834) [?:?]
Caused by: io.netty.channel.unix.Errors$NativeIoException: writeAddress(..) failed: Connection timed out
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and the boostrapping node (the streaming initiator) logging (times are from two separate attempts, pattern was very similar each time, IP addresses doctored to protect the innocent)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ERROR 2020-09-11T09:45:54,720 [Stream-Deserializer-2.2.2.2:7000-93837c82] org.apache.cassandra.streaming.StreamSession:917 - [Stream #f921ea30-f44d-11ea-b7f1-356e3edd6247] Remote peer 2.2.2.2:7000 failed stream session.
DEBUG 2020-09-11T09:45:54,721 [Stream-Deserializer-2.2.2.2:7000-93837c82] org.apache.cassandra.streaming.StreamSession:510 - [Stream #f921ea30-f44d-11ea-b7f1-356e3edd6247] Will close attached channels {93837c82=[id: 0x93837c82, L:/1.1.1.1:56859 ! R:2.2.2.2/2.2.2.2:7000], a608109b=[id: 0xa608109b, L:/1.1.1.1:7000 - R:/2.2.2.2:49426]}
INFO  2020-09-11T09:45:54,722 [Stream-Deserializer-2.2.2.2:7000-93837c82] org.apache.cassandra.streaming.StreamResultFuture:192 - [Stream #f921ea30-f44d-11ea-b7f1-356e3edd6247] Session with 2.2.2.2:7000 is complete
DEBUG 2020-09-11T09:45:54,723 [Messaging-EventLoop-3-15] org.apache.cassandra.streaming.async.NettyStreamingMessageSender:553 - [Stream #f921ea30-f44d-11ea-b7f1-356e3edd6247] Closing stream connection channels on 2.2.2.2:7000
ERROR 2020-09-11T09:45:55,121 [Stream-Deserializer-2.2.2.2:7000-a608109b] org.apache.cassandra.streaming.StreamSession:693 - [Stream #f921ea30-f44d-11ea-b7f1-356e3edd6247] Streaming error occurred on session with peer 2.2.2.2:7000
org.apache.cassandra.streaming.StreamReceiveException: java.io.EOFException
       at org.apache.cassandra.streaming.messages.IncomingStreamMessage$1.deserialize(IncomingStreamMessage.java:60)
       at org.apache.cassandra.streaming.messages.IncomingStreamMessage$1.deserialize(IncomingStreamMessage.java:38)
       at org.apache.cassandra.streaming.messages.StreamMessage.deserialize(StreamMessage.java:51)
       at org.apache.cassandra.streaming.async.StreamingInboundHandler$StreamDeserializingTask.run(StreamingInboundHandler.java:172)
       at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-all-4.1.50.Final.jar:4.1.50.Final]
       at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834) [?:?]
Caused by: java.io.EOFException
       at org.apache.cassandra.net.AsyncStreamingInputPlus.reBuffer(AsyncStreamingInputPlus.java:133)
       at org.apache.cassandra.io.util.RebufferingInputStream.readByte(RebufferingInputStream.java:178)
       at org.apache.cassandra.io.util.RebufferingInputStream.readPrimitiveSlowly(RebufferingInputStream.java:142)
       at org.apache.cassandra.io.util.RebufferingInputStream.readLong(RebufferingInputStream.java:231)
       at org.apache.cassandra.io.compress.CompressionMetadata$ChunkSerializer.deserialize(CompressionMetadata.java:538)
       at org.apache.cassandra.io.compress.CompressionMetadata$ChunkSerializer.deserialize(CompressionMetadata.java:528)
       at org.apache.cassandra.db.streaming.CompressionInfo$CompressionInfoSerializer.deserialize(CompressionInfo.java:88)
       at org.apache.cassandra.db.streaming.CompressionInfo$CompressionInfoSerializer.deserialize(CompressionInfo.java:61)
       at org.apache.cassandra.db.streaming.CassandraStreamHeader$CassandraStreamHeaderSerializer.deserialize(CassandraStreamHeader.java:230)
       at org.apache.cassandra.db.streaming.CassandraStreamHeader$CassandraStreamHeaderSerializer.deserialize(CassandraStreamHeader.java:210)
       at org.apache.cassandra.db.streaming.CassandraStreamHeader$CassandraStreamHeaderSerializer.deserialize(CassandraStreamHeader.java:178)
       at org.apache.cassandra.db.streaming.CassandraIncomingFile.read(CassandraIncomingFile.java:69)
       at org.apache.cassandra.streaming.messages.IncomingStreamMessage$1.deserialize(IncomingStreamMessage.java:53)
       ... 5 more
DEBUG 2020-09-11T09:45:55,123 [Stream-Deserializer-2.2.2.2:7000-93837c82] org.apache.cassandra.streaming.StreamSession:657 - [Stream #f921ea30-f44d-11ea-b7f1-356e3edd6247] Socket closed after session completed with state FAILED
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The issue was repeatable across many attempts to bootstrap. Cluster was deployed on Linux hosts running a 4.1.x kernel.&lt;/p&gt;

&lt;p&gt;Investigating the cause of the NativeIoException error message showed that a write(2) call return must have been ETIMEDOUT, which occurs when a TCP user timeout is set on the socket. &#160;In 4.0 connections now do that when EPOLL is available, with a default of 30s to detect failures faster.&lt;/p&gt;

&lt;p&gt;Investigating the socket buffers around the time of crash showed the send buffer filling on the streaming follower and the receive buffer filling on the streaming initiator.&lt;/p&gt;

&lt;p&gt;Capturing a heap dump and analyzing with MAT showed a thread in this state until the stream failed.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; / Stack Frame |Name |
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 io.netty.util.concurrent.FastThreadLocalThread @ 0x6916ea170 |Stream-Deserializer-2.2.2.2:7000-a608109b|
| - at sun.nio.ch.FileDispatcherImpl.force0(Ljava/io/FileDescriptor;Z)I (Native Method)|&#160;|
| - at sun.nio.ch.FileDispatcherImpl.force(Ljava/io/FileDescriptor;Z)I (FileDispatcherImpl.java:82)|&#160;|
| - at sun.nio.ch.FileChannelImpl.force(Z)V (FileChannelImpl.java:461)|&#160;|
| - at org.apache.cassandra.utils.SyncUtil.force(Ljava/nio/channels/FileChannel;Z)V (SyncUtil.java:172)|&#160;|
| - at org.apache.cassandra.io.util.SequentialWriter.syncDataOnlyInternal()V (SequentialWriter.java:190)|&#160;|
| - at org.apache.cassandra.io.util.SequentialWriter.syncInternal()V (SequentialWriter.java:206)|&#160;|
| - at org.apache.cassandra.io.compress.CompressedSequentialWriter.access$100(Lorg/apache/cassandra/io/compress/CompressedSequentialWriter;)V (CompressedSequentialWriter.java:39)|&#160;|
| - at org.apache.cassandra.io.compress.CompressedSequentialWriter$TransactionalProxy.doPrepare()V (CompressedSequentialWriter.java:353)|&#160;|
| - at org.apache.cassandra.utils.concurrent.Transactional$AbstractTransactional.prepareToCommit()V (Transactional.java:168)|&#160;|
| - at org.apache.cassandra.io.util.SequentialWriter.prepareToCommit()V (SequentialWriter.java:379)|&#160;|
| - at org.apache.cassandra.io.sstable.format.big.BigTableWriter$TransactionalProxy.doPrepare()V (BigTableWriter.java:409)|&#160;|
| - at org.apache.cassandra.utils.concurrent.Transactional$AbstractTransactional.prepareToCommit()V (Transactional.java:168)|&#160;|
| - at org.apache.cassandra.utils.concurrent.Transactional$AbstractTransactional.finish()Ljava/lang/&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;; (Transactional.java:179)|&#160;|
| - at org.apache.cassandra.io.sstable.format.SSTableWriter.finish(Z)Lorg/apache/cassandra/io/sstable/format/SSTableReader; (SSTableWriter.java:266)|&#160;|
| - at org.apache.cassandra.io.sstable.SimpleSSTableMultiWriter.finish(Z)Ljava/util/Collection; (SimpleSSTableMultiWriter.java:59)|&#160;|
| - at org.apache.cassandra.io.sstable.format.RangeAwareSSTableWriter.finish(Z)Ljava/util/Collection; (RangeAwareSSTableWriter.java:135)|&#160;|
| - at org.apache.cassandra.db.streaming.CassandraStreamReceiver.received(Lorg/apache/cassandra/streaming/IncomingStream;)V (CassandraStreamReceiver.java:108)|&#160;|
| - at org.apache.cassandra.streaming.StreamReceiveTask.received(Lorg/apache/cassandra/streaming/IncomingStream;)V (StreamReceiveTask.java:91)|&#160;|
| - at org.apache.cassandra.streaming.StreamSession.receive(Lorg/apache/cassandra/streaming/messages/IncomingStreamMessage;)V (StreamSession.java:848)|&#160;|
| - at org.apache.cassandra.streaming.StreamSession.messageReceived(Lorg/apache/cassandra/streaming/messages/StreamMessage;)V (StreamSession.java:597)|&#160;|
| - at org.apache.cassandra.streaming.async.StreamingInboundHandler$StreamDeserializingTask.run()V (StreamingInboundHandler.java:189)|&#160;|
| - at io.netty.util.concurrent.FastThreadLocalRunnable.run()V (FastThreadLocalRunnable.java:30)|&#160;|
| - at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run()V (&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834)|&#160;|

&apos;- Total: 23 entries | |
 ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Looking at the Java sources, the &lt;tt&gt;force0&lt;/tt&gt; function calls &lt;tt&gt;fdatasync&lt;/tt&gt; under Linux. Using &lt;tt&gt;perf trace record&lt;/tt&gt; showed that some fdatasyncs were exceeding the socket user timeout threshold, explaining the failures.&lt;/p&gt;

&lt;p&gt;This issue required significant effort to determine the root cause, so at least it would be good to improve the ability to diagnose this for an operator that may not have access to system call profiling.&lt;/p&gt;

&lt;p&gt;Obviously &lt;tt&gt;fdatasync&lt;/tt&gt; going away for 30s+ is a system tuning issue but I do not know of a way to guarantee an upper bound on fdatasync time, just make it more probable it completes.&lt;/p&gt;

&lt;p&gt;One workaround is to increase the TCP user timeout from 30s to whatever the host needs to complete, or to reset to the system default with &lt;tt&gt;0&lt;/tt&gt;, however this impacts regular internode messaging as well as streaming, and it&apos;s desirable to discover dead nodes as early as possible.&lt;/p&gt;

&lt;p&gt;Possible improvements:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Separate the user timeout thresholds for internode messaging and streaming.&lt;/li&gt;
	&lt;li&gt;Create a metric for FileChannel.force times by unique filesystem to surface that as a possible timeout.&lt;/li&gt;
	&lt;li&gt;Introduce a log warning when FileChannel.force times exceed a threshold.&lt;/li&gt;
	&lt;li&gt;Run FileChannel.force on a separate (unbounded) excecutor service and either continue to stream while force completes in the background with at least some backpressure on the stream, or throw on the initiator to improve diagnosis.&lt;/li&gt;
	&lt;li&gt;Periodically call force by time and/or volume written on a background thread.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13329044">CASSANDRA-16143</key>
            <summary>Streaming fails when s SSTable writer finish() exceeds internode_tcp_user_timeout</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yifanc">Yifan Cai</assignee>
                                    <reporter username="jmeredithco">Jon Meredith</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Sep 2020 17:35:36 +0000</created>
                <updated>Sun, 3 Jan 2021 16:58:28 +0000</updated>
                            <resolved>Wed, 9 Dec 2020 13:09:52 +0000</resolved>
                                        <fixVersion>4.0-beta4</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Messaging/Internode</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="15000">4h 10m</timespent>
                                <comments>
                            <comment id="17233146" author="yifanc" created="Mon, 16 Nov 2020 23:13:38 +0000"  >&lt;p&gt;Made a jvm dtest that is able to reproduce the TCP connection timeout during streaming reliably. The test code can be found &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...yifan-c:C-16143/test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. The test blocks CassandraCompressedStreamReader.read in the receiver for 10 seconds to simulate the slow disk, and reduces the send/receive buffer to keep the connection active. &lt;/p&gt;

&lt;p&gt;Run the &lt;tt&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16143&quot; title=&quot;Streaming fails when s SSTable writer finish() exceeds internode_tcp_user_timeout&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16143&quot;&gt;&lt;del&gt;CASSANDRA-16143&lt;/del&gt;&lt;/a&gt;.sh&lt;/tt&gt; and it will start the test within a docker container. The container is needed in order to enable EPOLL. (Not necessary if you are already running on Linux).&lt;/p&gt;

&lt;p&gt;The test should fail with stacktrace like the following&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[junit-timeout] ERROR 21:16:18 [Stream #f4c1ac00-2850-11eb-9cb2-ed254fd63997] Streaming error occurred on session with peer 127.0.0.2:7012
[junit-timeout] org.apache.cassandra.net.AsyncChannelOutputPlus$FlushException: The channel &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; output stream was writing to has been closed
[junit-timeout] 	at org.apache.cassandra.net.AsyncChannelOutputPlus.propagateFailedFlush(AsyncChannelOutputPlus.java:200)
[junit-timeout] 	at org.apache.cassandra.net.AsyncChannelOutputPlus.waitUntilFlushed(AsyncChannelOutputPlus.java:158)
[junit-timeout] 	at org.apache.cassandra.net.AsyncChannelOutputPlus.flush(AsyncChannelOutputPlus.java:230)
[junit-timeout] 	at org.apache.cassandra.db.streaming.CassandraOutgoingFile.write(CassandraOutgoingFile.java:179)
[junit-timeout] 	at org.apache.cassandra.streaming.messages.OutgoingStreamMessage.serialize(OutgoingStreamMessage.java:87)
[junit-timeout] 	at org.apache.cassandra.streaming.messages.OutgoingStreamMessage$1.serialize(OutgoingStreamMessage.java:45)
[junit-timeout] 	at org.apache.cassandra.streaming.messages.OutgoingStreamMessage$1.serialize(OutgoingStreamMessage.java:34)
[junit-timeout] 	at org.apache.cassandra.streaming.messages.StreamMessage.serialize(StreamMessage.java:42)
[junit-timeout] 	at org.apache.cassandra.streaming.async.NettyStreamingMessageSender$FileStreamTask.run(NettyStreamingMessageSender.java:347)
[junit-timeout] 	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
[junit-timeout] 	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
[junit-timeout] 	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
[junit-timeout] 	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
[junit-timeout] 	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
[junit-timeout] 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
[junit-timeout] 	Suppressed: java.nio.channels.ClosedChannelException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
[junit-timeout] 		at org.apache.cassandra.net.AsyncStreamingOutputPlus.doFlush(AsyncStreamingOutputPlus.java:81)
[junit-timeout] 		at org.apache.cassandra.net.AsyncChannelOutputPlus.flush(AsyncChannelOutputPlus.java:229)
[junit-timeout] 		at org.apache.cassandra.net.AsyncChannelOutputPlus.close(AsyncChannelOutputPlus.java:248)
[junit-timeout] 		at org.apache.cassandra.streaming.async.NettyStreamingMessageSender$FileStreamTask.run(NettyStreamingMessageSender.java:348)
[junit-timeout] 		... 6 common frames omitted
[junit-timeout] Caused by: io.netty.channel.unix.Errors$NativeIoException: writeAddress(..) failed: Connection timed out
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17233175" author="yifanc" created="Tue, 17 Nov 2020 01:05:48 +0000"  >&lt;p&gt;Talked with Jon on Slack. Assigning it to me. &lt;/p&gt;</comment>
                            <comment id="17234216" author="yifanc" created="Wed, 18 Nov 2020 04:17:39 +0000"  >&lt;p&gt;PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/824&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/824&lt;/a&gt;&lt;br/&gt;
CI: &lt;a href=&quot;https://app.circleci.com/pipelines/github/yifan-c/cassandra/164/workflows/a1fee16c-b4cd-4e67-b52f-f2e649ea33da&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/yifan-c/cassandra/164/workflows/a1fee16c-b4cd-4e67-b52f-f2e649ea33da&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The patch &lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;adds a dedicated TCP user timeout (defaults to 0) for streaming.&lt;/li&gt;
	&lt;li&gt;collects the processing time for the received incoming stream messages.&lt;/li&gt;
	&lt;li&gt;logs warning when the processing time exceeds the tcp user timeout.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I chose to not add &quot;a separate (unbounded) excecutor service&quot; for FileChannel.force and &quot;periodically call force&quot;. &lt;br/&gt;
In the code base, the incoming stream messages are consumed in a dedicated thread that polls from &lt;tt&gt;AsyncStreamingInputPlus&lt;/tt&gt;. It does not block the netty event loop. The &lt;tt&gt;AsyncStreamingInputPlus&lt;/tt&gt; intentionally disables auto read from netty channel to avoid OOM. If we starts an executor service to consume the bytes and FileChannel.force clogs, we end up with keeping more deserialized messages in memory with the risk of OOM. The timeout is actually related to the auto read being disabled. The receiver is blocked at flushing and not able to issue newer channel read. &lt;br/&gt;
I am also concerned about calling force periodically. According to the java doc of FileChannel.force (quoted below), do so may increase the I/O ops that are not necessary. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;     &amp;lt;p&amp;gt; Invoking this method may cause an I/O operation to occur even if the&lt;br/&gt;
     channel was only opened for reading.  Some operating systems, for&lt;br/&gt;
     example, maintain a last-access time as part of a file&apos;s metadata, and&lt;br/&gt;
     this time is updated whenever the file is read.  Whether or not this is&lt;br/&gt;
     actually done is system-dependent and is therefore unspecified.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17241732" author="aholmber" created="Tue, 1 Dec 2020 17:42:51 +0000"  >&lt;p&gt;I&apos;m taking a look today as a non-committer reviewer. Meanwhile leaving in &quot;Ready for Review&quot; to invite other reviewers.&lt;/p&gt;</comment>
                            <comment id="17241905" author="aholmber" created="Tue, 1 Dec 2020 22:17:44 +0000"  >&lt;p&gt;Added a few comments and questions to the PR.&lt;br/&gt;
I just noticed the PR is somehow linked and updating the Work Log section of this ticket. Is that new?&lt;/p&gt;</comment>
                            <comment id="17241918" author="yifanc" created="Tue, 1 Dec 2020 22:46:31 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aholmber&quot; class=&quot;user-hover&quot; rel=&quot;aholmber&quot;&gt;aholmber&lt;/a&gt;. So the bot links the PR, if its title starts with the ticket number. &lt;/p&gt;</comment>
                            <comment id="17243251" author="jmeredithco" created="Thu, 3 Dec 2020 15:15:11 +0000"  >&lt;p&gt;Bringing the discussion on what the default should be set to back here.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I&apos;m fine with zero, however given Yifan added the log message to explain to operators why streaming failed I think they have a fighting chance of tracking down failures and think something like 5 minutes would provide for faster failure than system default TCP timeouts while tolerating the majority of messy server tuning like the cluster I found this on.&lt;/p&gt;</comment>
                            <comment id="17243316" author="blerer" created="Thu, 3 Dec 2020 16:27:49 +0000"  >&lt;p&gt;That sound like a good compromise to me.&lt;/p&gt;</comment>
                            <comment id="17243433" author="dcapwell" created="Thu, 3 Dec 2020 18:35:46 +0000"  >&lt;p&gt;I can pick up review Monday unless enough committers +1 by then.&lt;/p&gt;</comment>
                            <comment id="17244454" author="yifanc" created="Sat, 5 Dec 2020 10:06:00 +0000"  >&lt;p&gt;Thanks for having the discussion about the timeout default. 5 minutes also sounds good to me.&lt;/p&gt;

&lt;p&gt;I would like to bring up one concern that the netty/streaming behaves oddly when tcp_user_timeout is large. &lt;br/&gt;
The docker test (posted above) was updated with &lt;em&gt;tcp_user_timeout == 300 seconds and artificial delay == 290 seconds&lt;/em&gt;. &lt;br/&gt;
The test should pass with the settings, but it failed with the same error, &quot;writeAddress(..) failed: Connection timed out&quot;. &lt;br/&gt;
The log indicates that after the receiver (node2) completed blocking, the sender did not continue writing into channel. The last flush took 302096082 micros == 302 seconds &amp;gt; tcp_user_timeout, so it failed expectedly. &lt;/p&gt;

&lt;p&gt;Although failed, the test proves that the tcp_user_timeout closes the connection at the right moment. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
...
[junit-timeout] node2 &amp;lt;--- block CassandraCompressedStreamReader.read &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 290 seconds
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.1:7012-10b5986c] node2 2020-12-05 09:45:02,468 CassandraCompressedStreamReader.java:73 - [Stream #ddd04ba0-36dd-11eb-800f-855dcc8aaeeb] Start receiving file #0 from /127.0.0.1:7012, repairedAt = 0, size = 5421, ks = &lt;span class=&quot;code-quote&quot;&gt;&apos;distributed_test_keyspace&apos;&lt;/span&gt;, pendingRepair = &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&apos;&lt;/span&gt;, table = &lt;span class=&quot;code-quote&quot;&gt;&apos;cf&apos;&lt;/span&gt;.
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.1:7012-10b5986c] node2 2020-12-05 09:45:02,573 StreamingInboundHandler.java:187 - [Stream #ddd04ba0-36dd-11eb-800f-855dcc8aaeeb channel: 10b5986c] Received IncomingStreamMessage{header=Header (tableId: db5364c0-36dd-11eb-ab7f-6fd7ea8cef30, #0, repairedAt: 0, pendingRepair: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, sendByFollower: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;), stream=CassandraIncomingFile{sstable=distributed_test_keyspace/cf}}
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.1:7012-10b5986c] node2 2020-12-05 09:45:02,575 NettyStreamingMessageSender.java:258 - [Stream #ddd04ba0-36dd-11eb-800f-855dcc8aaeeb channel: acbcbd5e] Sending Received (db5364c0-36dd-11eb-ab7f-6fd7ea8cef30, #0)
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.1:7012-10b5986c] node2 2020-12-05 09:45:02,577 StreamReceiveTask.java:88 - received 1 of 5 total files, 5421 of total bytes 5421
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.1:7012-10b5986c] node2 2020-12-05 09:45:02,599 AsyncStreamingInputPlus.java:197 - Issueing a channel read.
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.2:7012-61a7772e] node1 2020-12-05 09:45:02,924 StreamingInboundHandler.java:187 - [Stream #ddd04ba0-36dd-11eb-800f-855dcc8aaeeb channel: 61a7772e] Received Received (db5364c0-36dd-11eb-ab7f-6fd7ea8cef30, #0)
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.2:7012-61a7772e] node1 2020-12-05 09:45:02,927 StreamTransferTask.java:95 - recevied sequenceNumber 0, remaining files [1, 2, 3, 4]
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.2:7012-61a7772e] node1 2020-12-05 09:45:02,929 AsyncStreamingInputPlus.java:197 - Issueing a channel read.
[junit-timeout] DEBUG [Streaming-EventLoop-4-1] node2 2020-12-05 09:45:10,299 NettyStreamingMessageSender.java:258 - [Stream #ddd04ba0-36dd-11eb-800f-855dcc8aaeeb channel: acbcbd5e] Sending keep-alive
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.2:7012-61a7772e] node1 2020-12-05 09:45:10,532 StreamingInboundHandler.java:179 - [Stream #ddd04ba0-36dd-11eb-800f-855dcc8aaeeb channel: 61a7772e] Received keep-alive
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.2:7012-61a7772e] node1 2020-12-05 09:45:10,534 AsyncStreamingInputPlus.java:197 - Issueing a channel read.
[junit-timeout] DEBUG [node1_Messaging-EventLoop-3-7] node1 2020-12-05 09:45:11,169 NettyStreamingMessageSender.java:258 - [Stream #ddd04ba0-36dd-11eb-800f-855dcc8aaeeb channel: 61a7772e] Sending keep-alive
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.1:7012-acbcbd5e] node2 2020-12-05 09:45:11,386 StreamingInboundHandler.java:179 - [Stream #ddd04ba0-36dd-11eb-800f-855dcc8aaeeb channel: acbcbd5e] Received keep-alive
[junit-timeout] DEBUG [Stream-Deserializer-/127.0.0.1:7012-acbcbd5e] node2 2020-12-05 09:45:11,387 AsyncStreamingInputPlus.java:197 - Issueing a channel read.
[junit-timeout] DEBUG [node1_NettyStreaming-Outbound-/127.0.0.2.7012:1] node1 2020-12-05 09:45:14,167 AsyncChannelOutputPlus.java:165 - flush took micros: 302096082
[junit-timeout] ERROR 09:45:14 [Stream #ddd04ba0-36dd-11eb-800f-855dcc8aaeeb] Streaming error occurred on session with peer 127.0.0.2:7012
[junit-timeout] org.apache.cassandra.net.AsyncChannelOutputPlus$FlushException: The channel &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; output stream was writing to has been closed
[junit-timeout]     at org.apache.cassandra.net.AsyncChannelOutputPlus.propagateFailedFlush(AsyncChannelOutputPlus.java:208)
[junit-timeout]     at org.apache.cassandra.net.AsyncChannelOutputPlus.waitUntilFlushed(AsyncChannelOutputPlus.java:166)
[junit-timeout]     at org.apache.cassandra.net.AsyncChannelOutputPlus.flush(AsyncChannelOutputPlus.java:238)
[junit-timeout]     at org.apache.cassandra.db.streaming.CassandraOutgoingFile.write(CassandraOutgoingFile.java:179)
[junit-timeout]     at org.apache.cassandra.streaming.messages.OutgoingStreamMessage.serialize(OutgoingStreamMessage.java:87)
[junit-timeout]     at org.apache.cassandra.streaming.messages.OutgoingStreamMessage$1.serialize(OutgoingStreamMessage.java:45)
[junit-timeout]     at org.apache.cassandra.streaming.messages.OutgoingStreamMessage$1.serialize(OutgoingStreamMessage.java:34)
[junit-timeout]     at org.apache.cassandra.streaming.messages.StreamMessage.serialize(StreamMessage.java:42)
[junit-timeout]     at org.apache.cassandra.streaming.async.NettyStreamingMessageSender$FileStreamTask.run(NettyStreamingMessageSender.java:347)
[junit-timeout]     at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
[junit-timeout]     at java.util.concurrent.FutureTask.run(FutureTask.java:266)
[junit-timeout]     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
[junit-timeout]     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
[junit-timeout]     at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
[junit-timeout]     at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
[junit-timeout]     Suppressed: java.nio.channels.ClosedChannelException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
[junit-timeout]         at org.apache.cassandra.net.AsyncStreamingOutputPlus.doFlush(AsyncStreamingOutputPlus.java:81)
[junit-timeout]         at org.apache.cassandra.net.AsyncChannelOutputPlus.flush(AsyncChannelOutputPlus.java:237)
[junit-timeout]         at org.apache.cassandra.net.AsyncChannelOutputPlus.close(AsyncChannelOutputPlus.java:256)
[junit-timeout]         at org.apache.cassandra.streaming.async.NettyStreamingMessageSender$FileStreamTask.run(NettyStreamingMessageSender.java:348)
[junit-timeout]         ... 6 common frames omitted
[junit-timeout] Caused by: io.netty.channel.unix.Errors$NativeIoException: writeAddress(..) failed: Connection timed out
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17244588" author="jmeredithco" created="Sat, 5 Dec 2020 22:20:22 +0000"  >&lt;p&gt;Thanks for raising the concern and testing. I&apos;m ok with it taking longer, as long as it times out eventually. Even if it&apos;s 10 minutes it&apos;s likely better than default TCP settings.&lt;/p&gt;</comment>
                            <comment id="17245014" author="yifanc" created="Mon, 7 Dec 2020 07:15:25 +0000"  >&lt;p&gt;Thanks all for the feedback! &lt;br/&gt;
New commits were just pushed to address the comments. The patch is ready to be re-reviewed. &lt;/p&gt;</comment>
                            <comment id="17245562" author="dcapwell" created="Mon, 7 Dec 2020 22:33:48 +0000"  >&lt;p&gt;Finished first round of review, overall LGTM; only minor comments.&lt;/p&gt;

&lt;p&gt;1) typo in docs; have an extra 0&lt;br/&gt;
2) should we use NoSpamLogger vs normal logger?&lt;/p&gt;</comment>
                            <comment id="17245585" author="yifanc" created="Tue, 8 Dec 2020 00:19:01 +0000"  >&lt;p&gt;Thanks David! &lt;br/&gt;
Pushed a new commit. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;should we use NoSpamLogger vs normal logger?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Using &lt;tt&gt;NoSpamLogger&lt;/tt&gt; sounds better. The warning message emits when disk goes slow. In that case, we can expect a lot of those warnings. Logging every warning does not provide more help, from the operators&apos; perspective. I have changed the logging interval to 1 minute. &lt;/p&gt;</comment>
                            <comment id="17245600" author="dcapwell" created="Tue, 8 Dec 2020 00:57:37 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17246495" author="blerer" created="Wed, 9 Dec 2020 12:35:36 +0000"  >&lt;p&gt;+1 Thanks a lot for the patch&lt;/p&gt;</comment>
                            <comment id="17246522" author="blerer" created="Wed, 9 Dec 2020 13:09:52 +0000"  >&lt;p&gt;Committed into trunk at c6ea8fabf9f726a58b76ff6e41d21b650941f880&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yifanc]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="13163" cascade-level=""><![CDATA[Code]]></customfieldvalue>
                                <customfieldvalue key="13164" cascade-level="1"><![CDATA[Bug - Unclear Impact]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12976"><![CDATA[Shadow Traffic]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 48 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0iutc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aholmber]]></customfieldvalue>
        <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
        <customfieldvalue><![CDATA[bereng]]></customfieldvalue>
        <customfieldvalue><![CDATA[dcapwell]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348281">4.0-alpha1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/c6ea8fabf9f726a58b76ff6e41d21b650941f880&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/c6ea8fabf9f726a58b76ff6e41d21b650941f880&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;ci, unit test, jvm dtest, adhoc test&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>