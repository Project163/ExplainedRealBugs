<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:39:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5851] Fix 2i on composite components omissions</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5851</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;There some edge-cases, not covered by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5125&quot; title=&quot;Support indexes on composite column components (clustered columns)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5125&quot;&gt;&lt;del&gt;CASSANDRA-5125&lt;/del&gt;&lt;/a&gt;, the attached patch fixes those:&lt;/p&gt;

&lt;p&gt;(Assuming CREATE TABLE test (pk0 int, pk1 int, ck0 int, ck1 int, val int, PRIMARY KEY ((pk0, pk1), ck0, ck1)))&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;could not create a 2i on the first part of a composite partition key (pk0)&lt;/li&gt;
	&lt;li&gt;if created, it couldn&apos;t work because of getKeyBounds() returning non-empty bounds&lt;/li&gt;
	&lt;li&gt;could create an index on the first clustering key column (ck0), but it would never actually be triggered on reads&lt;/li&gt;
	&lt;li&gt;queries like SELECT * FROM test WHERE pk0 = x AND pk1 = y AND ck1 = z would throw an exception because COCK.makeIndexColumnNameBuilder() couldn&apos;t handle empty provided columnName&lt;/li&gt;
	&lt;li&gt;cqlsh could not describe any of these indexes because it was taking column aliases and key aliases from schema_columnfamilies and not reading them directly from schema_columns (had to do the related refactoring).&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12662147">CASSANDRA-5851</key>
            <summary>Fix 2i on composite components omissions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aleksey">Aleksey Yeschenko</assignee>
                                    <reporter username="aleksey">Aleksey Yeschenko</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Aug 2013 16:03:02 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:08 +0000</updated>
                            <resolved>Mon, 12 Aug 2013 10:58:32 +0000</resolved>
                                        <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13731657" author="duyleekun" created="Wed, 7 Aug 2013 05:27:03 +0000"  >&lt;p&gt;I got this when I query on 2 indexed column. Is this expected?&lt;/p&gt;

&lt;p&gt;SELECT * FROM gurugara.outgoing_edge WHERE source_id = 3 AND dest_id = 1 AND type = &apos;meh&apos;  ALLOW FILTERING;&lt;br/&gt;
`dest_id` and `type` are secondary indexed column&lt;/p&gt;


&lt;p&gt;ERROR 07:23:13,702 Exception in thread Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:4,5,main&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.RuntimeException: java.lang.RuntimeException: Unable to search across multiple secondary index types&lt;br/&gt;
	at org.apache.cassandra.service.StorageProxy$DroppableRunnable.run(StorageProxy.java:1867)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:722)&lt;br/&gt;
Caused by: java.lang.RuntimeException: Unable to search across multiple secondary index types&lt;br/&gt;
	at org.apache.cassandra.db.index.SecondaryIndexManager.search(SecondaryIndexManager.java:523)&lt;br/&gt;
	at org.apache.cassandra.db.ColumnFamilyStore.search(ColumnFamilyStore.java:1627)&lt;br/&gt;
	at org.apache.cassandra.db.RangeSliceCommand.executeLocally(RangeSliceCommand.java:135)&lt;br/&gt;
	at org.apache.cassandra.service.StorageProxy$LocalRangeSliceRunnable.runMayThrow(StorageProxy.java:1358)&lt;br/&gt;
	at org.apache.cassandra.service.StorageProxy$DroppableRunnable.run(StorageProxy.java:1863)&lt;br/&gt;
	... 3 more&lt;/p&gt;</comment>
                            <comment id="13731664" author="iamaleksey" created="Wed, 7 Aug 2013 05:31:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;I got this when I query on 2 indexed column. Is this expected?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Unfortunately, yes.&lt;/p&gt;</comment>
                            <comment id="13732786" author="iamaleksey" created="Wed, 7 Aug 2013 21:44:47 +0000"  >&lt;p&gt;Attached 5851-extra.txt that handles non-complete column names in CIOCK.makeIndexColumnNameBuilder() when used for searches.&lt;/p&gt;</comment>
                            <comment id="13733099" author="jbellis" created="Thu, 8 Aug 2013 03:07:22 +0000"  >&lt;p&gt;Can you add a unit test?&lt;/p&gt;</comment>
                            <comment id="13734196" author="iamaleksey" created="Thu, 8 Aug 2013 23:49:12 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can you add a unit test?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/riptano/cassandra-dtest/commit/26f9cc6ff5e6d95d44784f034a3d8ed974f415b3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/riptano/cassandra-dtest/commit/26f9cc6ff5e6d95d44784f034a3d8ed974f415b3&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13736195" author="jbellis" created="Sun, 11 Aug 2013 05:11:00 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13736750" author="iamaleksey" created="Mon, 12 Aug 2013 10:58:32 +0000"  >&lt;p&gt;Committed, thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12662177">CASSANDRA-5854</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12596720" name="5851-extra.txt" size="1093" author="aleksey" created="Wed, 7 Aug 2013 21:43:03 +0000"/>
                            <attachment id="12596362" name="5851.txt" size="37365" author="aleksey" created="Tue, 6 Aug 2013 16:04:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>342151</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 15 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n0a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>342456</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>