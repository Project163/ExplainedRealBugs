<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:12:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-629] antientropyservice patchset nearly doubles compaction time</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-629</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;CompactionsTest goes from 2.9s to 5.7s for me, before/after the 193 patchset.  This is not an acceptable speed hit for when no repair work is actually being done, assuming it is representative of &quot;real&quot; compactions.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12443145">CASSANDRA-629</key>
            <summary>antientropyservice patchset nearly doubles compaction time</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stuhood">Stu Hood</assignee>
                                    <reporter username="jbellis">Jonathan Ellis</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Dec 2009 20:55:29 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:30 +0000</updated>
                            <resolved>Wed, 16 Dec 2009 18:00:08 +0000</resolved>
                                        <fixVersion>0.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12789853" author="stuhood" created="Sun, 13 Dec 2009 08:02:27 +0000"  >&lt;p&gt;After benchmarking and trying to optimize the current code as much as possible, I gave up on trying to generate the full range down to hash depth.&lt;/p&gt;

&lt;p&gt;Jun suggested using XOR on 193, both for speed and simplicity, but I was worried about hash collisions. In order to make using XOR a little more secure, I bumped the digests we generate in AEService to SHA-256, so that we minimize the chance of collision as much as possible.&lt;/p&gt;

&lt;p&gt;Time to validate 1 million rows dropped from 84 seconds to 1.9 seconds (including hashing).&lt;/p&gt;</comment>
                            <comment id="12789867" author="stuhood" created="Sun, 13 Dec 2009 09:59:06 +0000"  >&lt;p&gt;Also, I noticed that in trunk a node won&apos;t broadcast a tree to neighbors unless they requested it, which means that when a major compaction happens naturally, the tree is wasted. Another quick patch.&lt;/p&gt;</comment>
                            <comment id="12790312" author="jbellis" created="Mon, 14 Dec 2009 19:50:48 +0000"  >&lt;p&gt;does not appreciably reduce CompactionsTest runtime for me&lt;/p&gt;</comment>
                            <comment id="12790365" author="jbellis" created="Mon, 14 Dec 2009 21:01:00 +0000"  >&lt;p&gt;from IRC:&lt;/p&gt;

&lt;p&gt;stuhood: 193 added another testcase to CompactionsTest &lt;/p&gt;

&lt;p&gt;... and sure enough, removing testCompactionReadonly makes it fast again.  Sorry for the false alarm.&lt;/p&gt;

&lt;p&gt;I&apos;m still +1 on reducing validation time, though. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12790410" author="junrao" created="Mon, 14 Dec 2009 22:23:19 +0000"  >&lt;p&gt;The last sentence of TODO above AES.validator.add() is confusing. Other than that, the patch looks good to me.&lt;/p&gt;

&lt;p&gt;Also, don&apos;t forget to add a comment saying that hash of inner nodes in Merkle tree are calculated on demand.&lt;/p&gt;</comment>
                            <comment id="12790411" author="stuhood" created="Mon, 14 Dec 2009 22:23:27 +0000"  >&lt;p&gt;At Jun&apos;s request, add a comment on the lazy calculation of the hashes of inner nodes.&lt;/p&gt;</comment>
                            <comment id="12790420" author="stuhood" created="Mon, 14 Dec 2009 22:38:19 +0000"  >&lt;p&gt;&amp;gt; The last sentence of TODO above AES.validator.add() is confusing&lt;br/&gt;
Ah. That should read &quot;we do not bother*&quot;.&lt;/p&gt;</comment>
                            <comment id="12790998" author="junrao" created="Tue, 15 Dec 2009 22:33:52 +0000"  >&lt;p&gt;Committed to trunk. Thanks Stu.&lt;/p&gt;</comment>
                            <comment id="12791014" author="jbellis" created="Tue, 15 Dec 2009 23:02:12 +0000"  >&lt;p&gt;IMO we should backport this to 0.5 too.  Any objections?&lt;/p&gt;</comment>
                            <comment id="12791044" author="stuhood" created="Tue, 15 Dec 2009 23:45:13 +0000"  >&lt;p&gt;I think that would be wise.&lt;/p&gt;</comment>
                            <comment id="12791490" author="jbellis" created="Wed, 16 Dec 2009 18:00:08 +0000"  >&lt;p&gt;also committed to 0.5&lt;/p&gt;</comment>
                            <comment id="12792161" author="hudson" created="Thu, 17 Dec 2009 22:03:04 +0000"  >&lt;p&gt;Integrated in Cassandra #291 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/291/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/291/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12427846" name="629-1-utility-changes.diff" size="2500" author="stuhood" created="Sun, 13 Dec 2009 08:02:27 +0000"/>
                            <attachment id="12427847" name="629-2-use-xor-in-merkletree.diff" size="21287" author="stuhood" created="Sun, 13 Dec 2009 08:02:27 +0000"/>
                            <attachment id="12427849" name="629-3-notify-neighbors.diff" size="1398" author="stuhood" created="Sun, 13 Dec 2009 09:59:06 +0000"/>
                            <attachment id="12427962" name="629-4-comment-on-laziness.diff" size="1516" author="stuhood" created="Mon, 14 Dec 2009 22:23:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stuhood]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19788</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g03z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>91448</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>