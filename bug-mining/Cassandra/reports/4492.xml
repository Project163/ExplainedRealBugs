<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:05:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-12700] During writing data into Cassandra 3.7.0 using Python driver 3.7 sometimes Connection get lost, because of Server NullPointerException</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-12700</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In our C* cluster we are using the latest Cassandra 3.7.0 (datastax-ddc.3.70) with Python driver 3.7. Trying to insert 2 million row or more data into the database, but sometimes we are getting &quot;Null pointer Exception&quot;. &lt;/p&gt;

&lt;p&gt;We are using Python 2.7.11 and Java 1.8.0_73 in the Cassandra nodes and in the client its Python 2.7.12.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;cassandra server log&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [SharedPool-Worker-6] 2016-09-23 09:42:55,002 Message.java:611 - Unexpected exception during request; channel = [id: 0xc208da86, L:/IP1.IP2.IP3.IP4:9042 - R:/IP5.IP6.IP7.IP8:58418]
java.lang.NullPointerException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
    at org.apache.cassandra.serializers.BooleanSerializer.deserialize(BooleanSerializer.java:33) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.serializers.BooleanSerializer.deserialize(BooleanSerializer.java:24) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.db.marshal.AbstractType.compose(AbstractType.java:113) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.cql3.UntypedResultSet$Row.getBoolean(UntypedResultSet.java:273) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.auth.CassandraRoleManager$1.apply(CassandraRoleManager.java:85) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.auth.CassandraRoleManager$1.apply(CassandraRoleManager.java:81) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.auth.CassandraRoleManager.getRoleFromTable(CassandraRoleManager.java:503) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.auth.CassandraRoleManager.getRole(CassandraRoleManager.java:485) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.auth.CassandraRoleManager.canLogin(CassandraRoleManager.java:298) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.service.ClientState.login(ClientState.java:227) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.transport.messages.AuthResponse.execute(AuthResponse.java:79) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:507) [apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:401) [apache-cassandra-3.7.0.jar:3.7.0]
    at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105) [netty-all-4.0.36.Final.jar:4.0.36.Final]
    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:292) [netty-all-4.0.36.Final.jar:4.0.36.Final]
    at io.netty.channel.AbstractChannelHandlerContext.access$600(AbstractChannelHandlerContext.java:32) [netty-all-4.0.36.Final.jar:4.0.36.Final]
    at io.netty.channel.AbstractChannelHandlerContext$7.run(AbstractChannelHandlerContext.java:283) [netty-all-4.0.36.Final.jar:4.0.36.Final]
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_73]
    at org.apache.cassandra.concurrent.AbstractLocalAwareExecutorService$FutureTask.run(AbstractLocalAwareExecutorService.java:164) [apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.concurrent.SEPWorker.run(SEPWorker.java:105) [apache-cassandra-3.7.0.jar:3.7.0]
    at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_73]
ERROR [SharedPool-Worker-1] 2016-09-23 09:42:56,238 Message.java:611 - Unexpected exception during request; channel = [id: 0x8e2eae00, L:/IP1.IP2.IP3.IP4:9042 - R:/IP5.IP6.IP7.IP8:58421]
java.lang.NullPointerException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
    at org.apache.cassandra.serializers.BooleanSerializer.deserialize(BooleanSerializer.java:33) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.serializers.BooleanSerializer.deserialize(BooleanSerializer.java:24) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.db.marshal.AbstractType.compose(AbstractType.java:113) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.cql3.UntypedResultSet$Row.getBoolean(UntypedResultSet.java:273) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.auth.CassandraRoleManager$1.apply(CassandraRoleManager.java:85) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.auth.CassandraRoleManager$1.apply(CassandraRoleManager.java:81) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.auth.CassandraRoleManager.getRoleFromTable(CassandraRoleManager.java:503) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.auth.CassandraRoleManager.getRole(CassandraRoleManager.java:485) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.auth.CassandraRoleManager.canLogin(CassandraRoleManager.java:298) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.service.ClientState.login(ClientState.java:227) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.transport.messages.AuthResponse.execute(AuthResponse.java:79) ~[apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:507) [apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:401) [apache-cassandra-3.7.0.jar:3.7.0]
    at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105) [netty-all-4.0.36.Final.jar:4.0.36.Final]
    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:292) [netty-all-4.0.36.Final.jar:4.0.36.Final]
    at io.netty.channel.AbstractChannelHandlerContext.access$600(AbstractChannelHandlerContext.java:32) [netty-all-4.0.36.Final.jar:4.0.36.Final]
    at io.netty.channel.AbstractChannelHandlerContext$7.run(AbstractChannelHandlerContext.java:283) [netty-all-4.0.36.Final.jar:4.0.36.Final]
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_73]
    at org.apache.cassandra.concurrent.AbstractLocalAwareExecutorService$FutureTask.run(AbstractLocalAwareExecutorService.java:164) [apache-cassandra-3.7.0.jar:3.7.0]
    at org.apache.cassandra.concurrent.SEPWorker.run(SEPWorker.java:105) [apache-cassandra-3.7.0.jar:3.7.0]
    at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_73]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;python client error&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Traceback (most recent call last):
 File &lt;span class=&quot;code-quote&quot;&gt;&quot;vssandra_v5.py&quot;&lt;/span&gt;, line 132, in &amp;lt;module&amp;gt;
   db.insert_batch()
 File &lt;span class=&quot;code-quote&quot;&gt;&quot;vssandra_v5.py&quot;&lt;/span&gt;, line 60, in insert_batch
   self.session.execute(self.batch, timeout=None)
 File &lt;span class=&quot;code-quote&quot;&gt;&quot;cassandra/cluster.py&quot;&lt;/span&gt;, line 1998, in cassandra.cluster.Session.execute (cassandra/cluster.c:34869)
 File &lt;span class=&quot;code-quote&quot;&gt;&quot;cassandra/cluster.py&quot;&lt;/span&gt;, line 3781, in cassandra.cluster.ResponseFuture.result (cassandra/cluster.c:73073)
cassandra.protocol.ServerError: &amp;lt;Error from server: code=0000 [Server error] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;com.google.common.util.concurrent.UncheckedExecutionException: com.google.common.util.concurrent.UncheckedExecutionException: java.lang.NullPointerException&quot;&lt;/span&gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;cassandra config&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; Node configuration:[allocate_tokens_for_keyspace=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; authenticator=PasswordAuthenticator; authorizer=CassandraAuthorizer; auto_bootstrap=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; auto_snapshot=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; batch_size_fail_threshold_in_kb=100; batch_size_warn_threshold_in_kb=10; batchlog_replay_throttle_in_kb=1024; broadcast_address=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; broadcast_rpc_address=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; buffer_pool_use_heap_if_exhausted=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; cas_contention_timeout_in_ms=5000; client_encryption_options=&amp;lt;REDACTED&amp;gt;; cluster_name=VCF Stress Cluster; column_index_cache_size_in_kb=2; column_index_size_in_kb=64; commit_failure_policy=stop; commitlog_compression=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; commitlog_directory=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; commitlog_max_compression_buffers_in_pool=3; commitlog_periodic_queue_size=-1; commitlog_segment_size_in_mb=32; commitlog_sync=periodic; commitlog_sync_batch_window_in_ms=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; commitlog_sync_period_in_ms=10000; commitlog_total_space_in_mb=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; compaction_large_partition_warning_threshold_mb=150; compaction_throughput_mb_per_sec=20; concurrent_compactors=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; concurrent_counter_writes=32; concurrent_materialized_view_writes=32; concurrent_reads=32; concurrent_replicates=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; concurrent_writes=32; counter_cache_keys_to_save=2147483647; counter_cache_save_period=7200; counter_cache_size_in_mb=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; counter_write_request_timeout_in_ms=5000; credentials_cache_max_entries=1000; credentials_update_interval_in_ms=-1; credentials_validity_in_ms=2000; cross_node_timeout=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; data_file_directories=[Ljava.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;@36fc695d; disk_access_mode=auto; disk_failure_policy=stop; disk_optimization_estimate_percentile=0.95; disk_optimization_page_cross_chance=0.1; disk_optimization_strategy=spinning; dynamic_snitch=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; dynamic_snitch_badness_threshold=0.1; dynamic_snitch_reset_interval_in_ms=600000; dynamic_snitch_update_interval_in_ms=100; enable_scripted_user_defined_functions=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; enable_user_defined_functions=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; enable_user_defined_functions_threads=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; encryption_options=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; endpoint_snitch=SimpleSnitch; file_cache_size_in_mb=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; gc_warn_threshold_in_ms=1000; hinted_handoff_disabled_datacenters=[]; hinted_handoff_enabled=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; hinted_handoff_throttle_in_kb=1024; hints_compression=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; hints_directory=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; hints_flush_period_in_ms=10000; incremental_backups=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; index_interval=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; index_summary_capacity_in_mb=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; index_summary_resize_interval_in_minutes=60; initial_token=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; inter_dc_stream_throughput_outbound_megabits_per_sec=200; inter_dc_tcp_nodelay=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; internode_authenticator=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; internode_compression=dc; internode_recv_buff_size_in_bytes=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; internode_send_buff_size_in_bytes=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; key_cache_keys_to_save=2147483647; key_cache_save_period=14400; key_cache_size_in_mb=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; listen_address=IP.251; listen_interface=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; listen_interface_prefer_ipv6=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; listen_on_broadcast_address=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; max_hint_window_in_ms=10800000; max_hints_delivery_threads=2; max_hints_file_size_in_mb=128; max_mutation_size_in_kb=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; max_streaming_retries=3; max_value_size_in_mb=256; memtable_allocation_type=offheap_objects; memtable_cleanup_threshold=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; memtable_flush_writers=1; memtable_heap_space_in_mb=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; memtable_offheap_space_in_mb=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; native_transport_max_concurrent_connections=-1; native_transport_max_concurrent_connections_per_ip=-1; native_transport_max_frame_size_in_mb=256; native_transport_max_threads=128; native_transport_port=9042; native_transport_port_ssl=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; num_tokens=256; otc_coalescing_strategy=TIMEHORIZON; otc_coalescing_window_us=200; partitioner=org.apache.cassandra.dht.Murmur3Partitioner; permissions_cache_max_entries=1000; permissions_update_interval_in_ms=-1; permissions_validity_in_ms=2000; phi_convict_threshold=8.0; prepared_statements_cache_size_mb=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; range_request_timeout_in_ms=11000; read_request_timeout_in_ms=6000; request_scheduler=org.apache.cassandra.scheduler.NoScheduler; request_scheduler_id=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; request_scheduler_options=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; request_timeout_in_ms=20000; role_manager=CassandraRoleManager; roles_cache_max_entries=1000; roles_update_interval_in_ms=-1; roles_validity_in_ms=2000; row_cache_class_name=org.apache.cassandra.cache.OHCProvider; row_cache_keys_to_save=2147483647; row_cache_save_period=0; row_cache_size_in_mb=0; rpc_address=IP.251; rpc_interface=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; rpc_interface_prefer_ipv6=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; rpc_keepalive=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; rpc_listen_backlog=50; rpc_max_threads=2147483647; rpc_min_threads=16; rpc_port=9160; rpc_recv_buff_size_in_bytes=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; rpc_send_buff_size_in_bytes=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; rpc_server_type=sync; saved_caches_directory=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; seed_provider=org.apache.cassandra.locator.SimpleSeedProvider{seeds=IP.251}; server_encryption_options=&amp;lt;REDACTED&amp;gt;; snapshot_before_compaction=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; ssl_storage_port=7001; sstable_preemptive_open_interval_in_mb=50; start_native_transport=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; start_rpc=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; storage_port=7000; stream_throughput_outbound_megabits_per_sec=250; streaming_socket_timeout_in_ms=86400000; thrift_framed_transport_size_in_mb=15; thrift_max_message_length_in_mb=16; thrift_prepared_statements_cache_size_mb=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; tombstone_failure_threshold=100000; tombstone_warn_threshold=1000; tracetype_query_ttl=86400; tracetype_repair_ttl=604800; transparent_data_encryption_options=org.apache.cassandra.config.TransparentDataEncryptionOptions@28701274; trickle_fsync=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;; trickle_fsync_interval_in_kb=10240; truncate_request_timeout_in_ms=60000; unlogged_batch_across_partitions_warn_threshold=10; user_defined_function_fail_timeout=1500; user_defined_function_warn_timeout=500; user_function_timeout_policy=die; windows_timer_interval=1; write_request_timeout_in_ms=10000]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Cassandra cluster with two nodes running C* version 3.7.0 and Python Driver 3.7 using Python 2.7.11. &lt;br/&gt;
OS: Red Hat Enterprise Linux 6.x x64, &lt;br/&gt;
RAM :8GB&lt;br/&gt;
DISK :210GB&lt;br/&gt;
Cores: 2&lt;br/&gt;
Java 1.8.0_73 JRE&lt;/p&gt;</environment>
        <key id="13007145">CASSANDRA-12700</key>
            <summary>During writing data into Cassandra 3.7.0 using Python driver 3.7 sometimes Connection get lost, because of Server NullPointerException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jjirsa">Jeff Jirsa</assignee>
                                    <reporter username="rajesh_con">Rajesh Radhakrishnan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Sep 2016 13:09:20 +0000</created>
                <updated>Tue, 14 Oct 2025 12:13:57 +0000</updated>
                            <resolved>Wed, 12 Oct 2016 04:31:58 +0000</resolved>
                                        <fixVersion>2.2.9</fixVersion>
                    <fixVersion>3.0.10</fixVersion>
                    <fixVersion>3.10</fixVersion>
                                    <component>Legacy/Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="15516710" author="jjirsa" created="Fri, 23 Sep 2016 15:06:28 +0000"  >&lt;p&gt;NPE coming from a null is_superuser - &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-3.7/src/java/org/apache/cassandra/auth/CassandraRoleManager.java#L85&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-3.7/src/java/org/apache/cassandra/auth/CassandraRoleManager.java#L85&lt;/a&gt; - can you paste the output of:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;DESCRIBE TABLE system_auth.roles; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For the user/role you&apos;re using with the python driver, does there exist an entry for that role in system_auth.roles?&lt;/p&gt;</comment>
                            <comment id="15516749" author="rajesh_con" created="Fri, 23 Sep 2016 15:27:00 +0000"  >&lt;p&gt;Thank you Jeff for looking into this!&lt;/p&gt;

&lt;p&gt;DESCRIBE TABLE system_auth.roles; &lt;/p&gt;

&lt;p&gt;-----------------------------------------------&lt;br/&gt;
CREATE TABLE system_auth.roles (&lt;br/&gt;
    role text PRIMARY KEY,&lt;br/&gt;
    can_login boolean,&lt;br/&gt;
    is_superuser boolean,&lt;br/&gt;
    member_of set&amp;lt;text&amp;gt;,&lt;br/&gt;
    salted_hash text&lt;br/&gt;
) WITH bloom_filter_fp_chance = 0.01&lt;br/&gt;
    AND caching = &lt;/p&gt;
{&apos;keys&apos;: &apos;ALL&apos;, &apos;rows_per_partition&apos;: &apos;NONE&apos;}
&lt;p&gt;    AND comment = &apos;role definitions&apos;&lt;br/&gt;
    AND compaction = &lt;/p&gt;
{&apos;class&apos;: &apos;org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy&apos;, &apos;max_threshold&apos;: &apos;32&apos;, &apos;min_threshold&apos;: &apos;4&apos;}
&lt;p&gt;    AND compression = &lt;/p&gt;
{&apos;chunk_length_in_kb&apos;: &apos;64&apos;, &apos;class&apos;: &apos;org.apache.cassandra.io.compress.LZ4Compressor&apos;}
&lt;p&gt;    AND crc_check_chance = 1.0&lt;br/&gt;
    AND dclocal_read_repair_chance = 0.0&lt;br/&gt;
    AND default_time_to_live = 0&lt;br/&gt;
    AND gc_grace_seconds = 7776000&lt;br/&gt;
    AND max_index_interval = 2048&lt;br/&gt;
    AND memtable_flush_period_in_ms = 3600000&lt;br/&gt;
    AND min_index_interval = 128&lt;br/&gt;
    AND read_repair_chance = 0.0&lt;br/&gt;
    AND speculative_retry = &apos;99PERCENTILE&apos;;&lt;br/&gt;
-----------------------------------------------&lt;/p&gt;</comment>
                            <comment id="15516753" author="rajesh_con" created="Fri, 23 Sep 2016 15:29:01 +0000"  >&lt;p&gt;Yes we are using user cassandra_test with Python driver.&lt;/p&gt;

&lt;p&gt;select * from system_auth.roles;&lt;/p&gt;

&lt;p&gt;--------------------------------------&lt;/p&gt;

&lt;p&gt; role           | can_login | is_superuser | member_of | salted_hash&lt;br/&gt;
---------------&lt;del&gt;&lt;ins&gt;&lt;/del&gt;---------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;------------&lt;del&gt;&lt;ins&gt;&lt;/del&gt;---------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;-------------------------------------------------------------&lt;br/&gt;
      cassandra |      True |        False |      null | $blumblum&lt;br/&gt;
 cassandra_test |      True |         True |      null | $blahblah&lt;/p&gt;</comment>
                            <comment id="15518286" author="jjirsa" created="Sat, 24 Sep 2016 03:41:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh_con&quot; class=&quot;user-hover&quot; rel=&quot;rajesh_con&quot;&gt;rajesh_con&lt;/a&gt; - I have a suspicion I know what&apos;s going on, let&apos;s try to disprove it before I dig in -  how many nodes in the cluster? What&apos;s the replication strategy / factor on system_auth? Have you run repair on system_auth since you added any users? &lt;/p&gt;
</comment>
                            <comment id="15519697" author="rajesh_con" created="Sat, 24 Sep 2016 22:00:23 +0000"  >&lt;p&gt;Only two nodes in this cluster, and replication strategy/factor for the keyspace we are using is SimpleStratery/2. I didnt run any repair on system_auth.&lt;/p&gt;</comment>
                            <comment id="15525125" author="jjirsa" created="Tue, 27 Sep 2016 05:31:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh_con&quot; class=&quot;user-hover&quot; rel=&quot;rajesh_con&quot;&gt;rajesh_con&lt;/a&gt; - As a workaround, try executing (via cqlsh):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt; CONSISTENCY ALL;
&amp;gt; UPDATE system_auth.roles SET is_superuser=True where role=&lt;span class=&quot;code-quote&quot;&gt;&apos;cassandra_test&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That should work around the NPE until it&apos;s fixed (the NPE is coming from a missing is_superuser field).&lt;/p&gt;


</comment>
                            <comment id="15525408" author="rajesh_con" created="Tue, 27 Sep 2016 07:53:59 +0000"  >&lt;p&gt;Thank you Jeff! &lt;br/&gt;
I will set the consistency / update system_auth too and let you know how it went by!&lt;/p&gt;

&lt;p&gt;In between did you meant to update system_auth.roles table?&lt;/p&gt;</comment>
                            <comment id="15526470" author="jjirsa" created="Tue, 27 Sep 2016 15:29:18 +0000"  >&lt;p&gt;Yes, sorry, system_auth.roles&lt;/p&gt;</comment>
                            <comment id="15526531" author="rajesh_con" created="Tue, 27 Sep 2016 15:51:50 +0000"  >&lt;p&gt;Yes I assumed and did executed those CQL too.&lt;br/&gt;
So far no more NPE. I will keep an eye on the system.log&lt;/p&gt;</comment>
                            <comment id="15528139" author="jjirsa" created="Wed, 28 Sep 2016 02:20:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh_con&quot; class=&quot;user-hover&quot; rel=&quot;rajesh_con&quot;&gt;rajesh_con&lt;/a&gt; - just to be clear - do you recall what mechanism you used to create these users/roles? Did you perhaps use &lt;tt&gt;CREATE ROLE&lt;/tt&gt; , or &lt;tt&gt;INSERT INTO system_auth.roles...&lt;/tt&gt; ? &lt;/p&gt;</comment>
                            <comment id="15528422" author="jjirsa" created="Wed, 28 Sep 2016 05:06:15 +0000"  >&lt;p&gt;Regardless of how you managed to get &lt;tt&gt;system_auth.roles&lt;/tt&gt; into this state, Cassandra should do something more intelligent than throwing an NPE here.&lt;/p&gt;

&lt;p&gt;In this case, I think the most sane answer is that if &lt;tt&gt;is_superuser&lt;/tt&gt; or &lt;tt&gt;can_login&lt;/tt&gt; is somehow null, we treat that null as false. I&apos;ve uploaded a patch that makes exactly that assumption:&lt;/p&gt;

&lt;p&gt;Pushed a branch here for trunk: &lt;a href=&quot;https://github.com/jeffjirsa/cassandra/commit/cf4d744f1a2e29497fe5dca1246f2d14c0ab6375&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeffjirsa/cassandra/commit/cf4d744f1a2e29497fe5dca1246f2d14c0ab6375&lt;/a&gt;&lt;br/&gt;
UTest output: &lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-testall/lastCompletedBuild/testReport/&lt;/a&gt;&lt;br/&gt;
Dtest change:  &lt;a href=&quot;https://github.com/jeffjirsa/cassandra-dtest/commit/aa1bd2ffdfdd88307068b02506930b1183ed738d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeffjirsa/cassandra-dtest/commit/aa1bd2ffdfdd88307068b02506930b1183ed738d&lt;/a&gt;&lt;br/&gt;
Dtest output: &lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-dtest/lastCompletedBuild/testReport/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Will review test output in the morning, and hopefully we can get a review and get this fixed shortly thereafter. &lt;/p&gt;</comment>
                            <comment id="15528829" author="beobal" created="Wed, 28 Sep 2016 08:11:54 +0000"  >&lt;blockquote&gt;&lt;p&gt;do you recall what mechanism you used to create these users/roles?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is definitely the most important question here, as on the &quot;normal&quot; path using &lt;tt&gt;CREATE/ALTER ROLE&lt;/tt&gt; it shouldn&apos;t be possible to construct an insert or update mutation in which any field is unset (including data migration for users created on pre-2.2 clusters). My concern is that if this isn&apos;t due to a flaw in the design/impl of &lt;tt&gt;CassandraRoleManager&lt;/tt&gt; (though it most certainly could be) then it might be indicative of a deeper issue which may affect reads from other tables. So I&apos;d say it was worth trying to figure out, or even repro, the root cause. &lt;/p&gt;

&lt;p&gt;Assuming for now that the a given role was created or modified by directly updating the roles table (or if it was in some other way corrupted for that matter), I don&apos;t agree that silently &quot;correcting&quot; missing values is the right thing to do. In that scenario, I&apos;d argue that we should loudly inform the user/operator that the system metadata is in a screwed up state by logging a warning and throwing an appropriate exception (i.e. not an NPE). &lt;/p&gt;</comment>
                            <comment id="15528845" author="rajesh_con" created="Wed, 28 Sep 2016 08:16:55 +0000"  >&lt;p&gt;Thank you Jeff!&lt;br/&gt;
I did created the user &apos;cassandra_test&apos; using the following CQL:&lt;/p&gt;

&lt;p&gt;CREATE USER cassandra_user WITH PASSWORD &apos;&amp;lt;password&amp;gt;&apos; SUPERUSER;&lt;/p&gt;</comment>
                            <comment id="15528860" author="rajesh_con" created="Wed, 28 Sep 2016 08:22:16 +0000"  >&lt;p&gt;Thanks Sam and Jeff, I was using the older Datastax Cassandra documentation(2.x) which is replaced by this &lt;a href=&quot;https://docs.datastax.com/en/cql/3.3/cql/cql_reference/create_user_r.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.datastax.com/en/cql/3.3/cql/cql_reference/create_user_r.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here there is a note at the beginning which I quote &quot;Note: CREATE USER is supported for backwards compatibility. Authentication and authorization for Cassandra 2.2 and later are based on ROLES, and CREATE ROLE should be used.&quot;&lt;/p&gt;

&lt;p&gt;I didn&apos;t used CREATE ROLE but instead used CREATE USER. &lt;/p&gt;</comment>
                            <comment id="15528925" author="beobal" created="Wed, 28 Sep 2016 08:38:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;I didn&apos;t used CREATE ROLE but instead used CREATE USER&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s cool, it&apos;s just a syntax thing really, under the hood &lt;tt&gt;CREATE USER&lt;/tt&gt; is translated to &lt;tt&gt;CREATE ROLE&lt;/tt&gt; with the &lt;tt&gt;LOGIN&lt;/tt&gt; option set to true. &lt;br/&gt;
So as I mentioned, my concern here is how can we come to read a row with a null value?&lt;/p&gt;</comment>
                            <comment id="15530143" author="jjirsa" created="Wed, 28 Sep 2016 16:25:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt; thanks for the feedback - the decision in my mind was &quot;make it work safely&quot; or &quot;make it fail nicer&quot; - I went with &quot;make it work safely&quot;, but since we don&apos;t understand how it got this way, I agree with you that we should be noisy about it. &lt;/p&gt;

&lt;p&gt;Pushed a new change to be more conservative - instead of silently correcting (by inferring false), we&apos;ll throw an RTE and log a message at &lt;tt&gt;WARN&lt;/tt&gt; to let the operator know that something&apos;s very wrong. This is the new behavior:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;MLSEA-JJIRSA01:~ jjirsa$ ccm node1 cqlsh
Connection error: (&lt;span class=&quot;code-quote&quot;&gt;&apos;Unable to connect to any servers&apos;&lt;/span&gt;, {&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1&apos;&lt;/span&gt;: AuthenticationFailed(&lt;span class=&quot;code-quote&quot;&gt;&apos;Remote end requires authentication.&apos;&lt;/span&gt;,)})
MLSEA-JJIRSA01:~ jjirsa$ ccm node1 cqlsh -u cassandra -p cassandra
Connected to test at 127.0.0.1:9042.
[cqlsh 5.0.1 | Cassandra 3.10-SNAPSHOT | CQL spec 3.4.3 | Native protocol v4]
Use HELP &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; help.
cassandra@cqlsh&amp;gt; select * from system_auth.roles;

 role      | can_login | is_superuser | member_of | salted_hash
-----------+-----------+--------------+-----------+--------------------------------------------------------------
 cassandra |      True |         True |      &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; | $2a$10$2.WsdTj8JoDCUHuVVe367Oth8XA3JYn1jTDX03eaEBkxwRTOuQKB.

(1 rows)
cassandra@cqlsh&amp;gt; insert into system_auth.roles(role, salted_hash) values(&lt;span class=&quot;code-quote&quot;&gt;&apos;test&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;$2a$10$2.WsdTj8JoDCUHuVVe367Oth8XA3JYn1jTDX03eaEBkxwRTOuQKB.&apos;&lt;/span&gt;);
cassandra@cqlsh&amp;gt; select * from system_auth.roles;

 role      | can_login | is_superuser | member_of | salted_hash
-----------+-----------+--------------+-----------+--------------------------------------------------------------
      test |      &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; |         &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; |      &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; | $2a$10$2.WsdTj8JoDCUHuVVe367Oth8XA3JYn1jTDX03eaEBkxwRTOuQKB.
 cassandra |      True |         True |      &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; | $2a$10$2.WsdTj8JoDCUHuVVe367Oth8XA3JYn1jTDX03eaEBkxwRTOuQKB.

(2 rows)
cassandra@cqlsh&amp;gt; ^D
MLSEA-JJIRSA01:~ jjirsa$ ccm node1 cqlsh -u test -p cassandra
Connection error: (&lt;span class=&quot;code-quote&quot;&gt;&apos;Unable to connect to any servers&apos;&lt;/span&gt;, {&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1&apos;&lt;/span&gt;: AuthenticationFailed(&lt;span class=&quot;code-quote&quot;&gt;&apos;Failed to authenticate to 127.0.0.1: Error from server: code=0000 [Server error] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;java.lang.RuntimeException: Invalid metadata has been detected &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; role test&quot;&lt;/span&gt;&apos;&lt;/span&gt;,)})
MLSEA-JJIRSA01:~ jjirsa$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ll update the dtest to match shortly.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt; - if you guys have resources to try to repro, I won&apos;t mind seeing that Assignee field change to you or your test engineering folks.&lt;/p&gt;</comment>
                            <comment id="15530203" author="philipthompson" created="Wed, 28 Sep 2016 16:50:21 +0000"  >&lt;p&gt;Jeff, we can maybe get to it in several weeks? There&apos;s quite a number of &quot;C* tickets to repro&quot; on my backlog.&lt;/p&gt;</comment>
                            <comment id="15533132" author="JIRAUSER308715" created="Thu, 29 Sep 2016 15:47:28 +0000"  >&lt;p&gt;I don&apos;t think this is any different for 3.0, so what ever we do to fix the bug here, we should probably apply it to cassandra-3.0 and maybe even cassandra-2.2.&lt;/p&gt;</comment>
                            <comment id="15536517" author="jjirsa" created="Fri, 30 Sep 2016 17:23:35 +0000"  >&lt;p&gt;The patch merges cleanly all the way from 2.2 -&amp;gt; trunk. I&apos;m finishing off the dtest, then I&apos;ll kicking off CI with the links below (won&apos;t work for a few hours):&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jeffjirsa/cassandra/tree/cassandra-12700-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-2.2-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-2.2-dtest/lastCompletedBuild/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jeffjirsa/cassandra/tree/cassandra-12700-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-3.0-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-3.0-dtest/lastCompletedBuild/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jeffjirsa/cassandra/tree/cassandra-12700-3.X&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.X&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-3.X-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-3.X-dtest/lastCompletedBuild/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jeffjirsa/cassandra/tree/cassandra-12700&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12700-dtest/lastCompletedBuild/testReport&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15562240" author="beobal" created="Mon, 10 Oct 2016 12:56:12 +0000"  >&lt;p&gt;+1, the CI is not pretty, but the change is so safe &amp;amp; minor I&apos;m sure there&apos;s no risk of further regressions. It still makes me uneasy that we have no explanation for how we are able to read a row with null values, but in the absense of that, handling it better is still worthwhile.&lt;/p&gt;</comment>
                            <comment id="15567536" author="jjirsa" created="Wed, 12 Oct 2016 04:31:58 +0000"  >&lt;p&gt;Committed in &lt;tt&gt;ff5c497d1fc553f3dcc57a5b0f1329d66082c1d3&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh_con&quot; class=&quot;user-hover&quot; rel=&quot;rajesh_con&quot;&gt;rajesh_con&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15568006" author="rajesh_con" created="Wed, 12 Oct 2016 08:13:27 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jjirsa&quot; class=&quot;user-hover&quot; rel=&quot;jjirsa&quot;&gt;jjirsa&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt; for the help. I will be getting the patched release soon when ever it is ready.&lt;/p&gt;</comment>
                            <comment id="16073821" author="jasonstack" created="Tue, 4 Jul 2017 15:28:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh_con&quot; class=&quot;user-hover&quot; rel=&quot;rajesh_con&quot;&gt;rajesh_con&lt;/a&gt; could you still reproduce it? &lt;/p&gt;</comment>
                            <comment id="16406360" author="prnvjndl" created="Tue, 20 Mar 2018 13:58:20 +0000"  >&lt;p&gt;Using cassandra 3.10, facing below issue.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jjirsa&quot; class=&quot;user-hover&quot; rel=&quot;jjirsa&quot;&gt;jjirsa&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonstack&quot; class=&quot;user-hover&quot; rel=&quot;jasonstack&quot;&gt;jasonstack&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
WARN [Native-Transport-Requests-1] 2018-03-20 13:37:17,894 CassandraRoleManager.java:96 - An invalid value has been detected in the roles table &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; role utorjwcnruzzlzafxffgyqmlvkxiqcgb. If you are unable to login, you may need to disable authentication and confirm that values in that table are accurate
ERROR [Native-Transport-Requests-1] 2018-03-20 13:37:17,895 Message.java:623 - Unexpected exception during request; channel = [id: 0xdfc3604f, L:/10.180.0.150:9042 - R:/10.180.0.150:51668]
java.lang.RuntimeException: Invalid metadata has been detected &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; role utorjwcnruzzlzafxffgyqmlvkxiqcgb
at org.apache.cassandra.auth.CassandraRoleManager$1.apply(CassandraRoleManager.java:99) ~[apache-cassandra-3.10.jar:3.10]
at org.apache.cassandra.auth.CassandraRoleManager$1.apply(CassandraRoleManager.java:82) ~[apache-cassandra-3.10.jar:3.10]
at org.apache.cassandra.auth.CassandraRoleManager.getRoleFromTable(CassandraRoleManager.java:528) ~[apache-cassandra-3.10.jar:3.10]
at org.apache.cassandra.auth.CassandraRoleManager.getRole(CassandraRoleManager.java:503) ~[apache-cassandra-3.10.jar:3.10]
at org.apache.cassandra.auth.CassandraRoleManager.canLogin(CassandraRoleManager.java:310) ~[apache-cassandra-3.10.jar:3.10]
at org.apache.cassandra.service.ClientState.login(ClientState.java:271) ~[apache-cassandra-3.10.jar:3.10]
at org.apache.cassandra.transport.messages.AuthResponse.execute(AuthResponse.java:80) ~[apache-cassandra-3.10.jar:3.10]
at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:517) [apache-cassandra-3.10.jar:3.10]
at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:410) [apache-cassandra-3.10.jar:3.10]
at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105) [netty-all-4.0.39.Final.jar:4.0.39.Final]
at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:366) [netty-all-4.0.39.Final.jar:4.0.39.Final]
at io.netty.channel.AbstractChannelHandlerContext.access$600(AbstractChannelHandlerContext.java:35) [netty-all-4.0.39.Final.jar:4.0.39.Final]
at io.netty.channel.AbstractChannelHandlerContext$7.run(AbstractChannelHandlerContext.java:357) [netty-all-4.0.39.Final.jar:4.0.39.Final]
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_121]
at org.apache.cassandra.concurrent.AbstractLocalAwareExecutorService$FutureTask.run(AbstractLocalAwareExecutorService.java:162) [apache-cassandra-3.10.jar:3.10]
at org.apache.cassandra.concurrent.SEPWorker.run(SEPWorker.java:109) [apache-cassandra-3.10.jar:3.10]
at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_121]
Caused by: java.lang.NullPointerException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
at org.apache.cassandra.cql3.UntypedResultSet$Row.getBoolean(UntypedResultSet.java:273) ~[apache-cassandra-3.10.jar:3.10]
at org.apache.cassandra.auth.CassandraRoleManager$1.apply(CassandraRoleManager.java:88) ~[apache-cassandra-3.10.jar:3.10]
... 16 common frames omitted

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16701825" author="alexander.pugachev" created="Wed, 28 Nov 2018 12:35:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh_con&quot; class=&quot;user-hover&quot; rel=&quot;rajesh_con&quot;&gt;rajesh_con&lt;/a&gt;&#160;How did you apply the workaround with CONSISTENCY above when cqlsh was blocked by NPE?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jjirsa]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3407b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>samt</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12335693">3.7</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>