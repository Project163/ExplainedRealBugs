<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:23:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2810] RuntimeException in Pig when using &quot;dump&quot; command on column name</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2810</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;This bug was previously report on &lt;a href=&quot;https://datastax.jira.com/browse/BRISK-232&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Brisk bug tracker&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In cassandra-cli:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@unknown] create keyspace Test
    with placement_strategy = &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.locator.SimpleStrategy&apos;&lt;/span&gt;
    and strategy_options = [{replication_factor:1}];

[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@unknown] use Test;
Authenticated to keyspace: Test

[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Test] create column family test;

[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Test] set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row1&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(1)]=integer(35);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row1&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(2)]=integer(36);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row1&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(3)]=integer(38);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row2&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(1)]=integer(45);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row2&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(2)]=integer(42);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row2&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(3)]=integer(33);

[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Test] list test;
Using &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; limit of 100
-------------------
RowKey: 726f7731
=&amp;gt; (column=0000000000000001, value=35, timestamp=1308744931122000)
=&amp;gt; (column=0000000000000002, value=36, timestamp=1308744931124000)
=&amp;gt; (column=0000000000000003, value=38, timestamp=1308744931125000)
-------------------
RowKey: 726f7732
=&amp;gt; (column=0000000000000001, value=45, timestamp=1308744931127000)
=&amp;gt; (column=0000000000000002, value=42, timestamp=1308744931128000)
=&amp;gt; (column=0000000000000003, value=33, timestamp=1308744932722000)

2 Rows Returned.

[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Test] describe keyspace;
Keyspace: Test:
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Durable Writes: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
    Options: [replication_factor:1]
  Column Families:
    ColumnFamily: test
      Key Validation &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;: org.apache.cassandra.db.marshal.BytesType
      Default column value validator: org.apache.cassandra.db.marshal.BytesType
      Columns sorted by: org.apache.cassandra.db.marshal.BytesType
      Row cache size / save period in seconds: 0.0/0
      Key cache size / save period in seconds: 200000.0/14400
      Memtable thresholds: 0.571875/122/1440 (millions of ops/MB/minutes)
      GC grace seconds: 864000
      Compaction min/max thresholds: 4/32
      Read repair chance: 1.0
      Replicate on write: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
      Built indexes: []
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In Pig command line:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;grunt&amp;gt; test = LOAD &lt;span class=&quot;code-quote&quot;&gt;&apos;cassandra:&lt;span class=&quot;code-comment&quot;&gt;//Test/test&apos;&lt;/span&gt; USING CassandraStorage() AS (rowkey:chararray, columns: bag {T: (name:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;, value:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)});
&lt;/span&gt;
grunt&amp;gt; value_test = foreach test generate rowkey, columns.name, columns.value;

grunt&amp;gt; dump value_test;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In /var/log/cassandra/system.log, I have severals time this exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;INFO [IPC Server handler 3 on 8012] 2011-06-22 15:03:28,533 TaskInProgress.java (line 551) Error from attempt_201106210955_0051_m_000000_3: java.lang.RuntimeException: Unexpected data type -1 found in stream.
	at org.apache.pig.data.BinInterSedes.writeDatum(BinInterSedes.java:478)
	at org.apache.pig.data.BinInterSedes.writeTuple(BinInterSedes.java:541)
	at org.apache.pig.data.BinInterSedes.writeBag(BinInterSedes.java:522)
	at org.apache.pig.data.BinInterSedes.writeDatum(BinInterSedes.java:361)
	at org.apache.pig.data.BinInterSedes.writeTuple(BinInterSedes.java:541)
	at org.apache.pig.data.BinInterSedes.writeDatum(BinInterSedes.java:357)
	at org.apache.pig.impl.io.InterRecordWriter.write(InterRecordWriter.java:73)
	at org.apache.pig.impl.io.InterStorage.putNext(InterStorage.java:87)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigOutputFormat$PigRecordWriter.write(PigOutputFormat.java:138)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigOutputFormat$PigRecordWriter.write(PigOutputFormat.java:97)
	at org.apache.hadoop.mapred.MapTask$NewDirectOutputCollector.write(MapTask.java:638)
	at org.apache.hadoop.mapreduce.TaskInputOutputContext.write(TaskInputOutputContext.java:80)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapOnly$Map.collect(PigMapOnly.java:48)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapBase.runPipeline(PigMapBase.java:239)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapBase.map(PigMapBase.java:232)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapBase.map(PigMapBase.java:53)
	at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:144)
	at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:763)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:369)
	at org.apache.hadoop.mapred.Child$4.run(Child.java:259)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:396)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1059)
	at org.apache.hadoop.mapred.Child.main(Child.java:253)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and the request failed.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;grunt&amp;gt; test = LOAD &lt;span class=&quot;code-quote&quot;&gt;&apos;cassandra:&lt;span class=&quot;code-comment&quot;&gt;//Test/test&apos;&lt;/span&gt; USING CassandraStorage() AS (rowkey:chararray, columns: bag {T: (name:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;, value:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)});
&lt;/span&gt;
grunt&amp;gt; value_test = foreach test generate rowkey, columns.value;

grunt&amp;gt; dump value_test;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This time, without the column name, it&apos;s work (but the value are displayed as char instead of integer). Result:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;(row1,{(#),($),(&amp;amp;)})
(row2,{(-),(*),(!)})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we do the same test but we set a comparator to the CF.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Test] create column family test with comparator = &lt;span class=&quot;code-quote&quot;&gt;&apos;LongType&apos;&lt;/span&gt;;

[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Test] set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row1&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(1)]=integer(35);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row1&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(2)]=integer(36);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row1&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(3)]=integer(38);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row2&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(1)]=integer(45);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row2&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(2)]=integer(42);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row2&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(3)]=integer(33);

[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Test] list test;
Using &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; limit of 100
-------------------
RowKey: 726f7731
=&amp;gt; (column=1, value=35, timestamp=1308748643506000)
=&amp;gt; (column=2, value=36, timestamp=1308748643508000)
=&amp;gt; (column=3, value=38, timestamp=1308748643509000)
-------------------
RowKey: 726f7732
=&amp;gt; (column=1, value=45, timestamp=1308748643510000)
=&amp;gt; (column=2, value=42, timestamp=1308748643512000)
=&amp;gt; (column=3, value=33, timestamp=1308748645138000)

2 Rows Returned.

[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Test] describe keyspace;
Keyspace: Test:
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Durable Writes: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
    Options: [replication_factor:1]
  Column Families:
    ColumnFamily: test
      Key Validation &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;: org.apache.cassandra.db.marshal.BytesType
      Default column value validator: org.apache.cassandra.db.marshal.BytesType
      Columns sorted by: org.apache.cassandra.db.marshal.LongType
      Row cache size / save period in seconds: 0.0/0
      Key cache size / save period in seconds: 200000.0/14400
      Memtable thresholds: 0.571875/122/1440 (millions of ops/MB/minutes)
      GC grace seconds: 864000
      Compaction min/max thresholds: 4/32
      Read repair chance: 1.0
      Replicate on write: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
      Built indexes: []
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;grunt&amp;gt; test = LOAD &lt;span class=&quot;code-quote&quot;&gt;&apos;cassandra:&lt;span class=&quot;code-comment&quot;&gt;//Test/test&apos;&lt;/span&gt; USING CassandraStorage() AS (rowkey:chararray, columns: bag {T: (name:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;, value:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)});
&lt;/span&gt;
grunt&amp;gt; value_test = foreach test generate rowkey, columns.name, columns.value;

grunt&amp;gt; dump value_test;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This time it&apos;s work as expected (appart from the value displayed as char). Result:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;(row1,{(1),(2),(3)},{(#),($),(&amp;amp;)})
(row2,{(1),(2),(3)},{(-),(*),(!)})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Ubuntu 10.10, 32 bits&lt;br/&gt;
java version &quot;1.6.0_24&quot;&lt;br/&gt;
Brisk beta-2 installed from Debian packages&lt;/p&gt;</environment>
        <key id="12511243">CASSANDRA-2810</key>
            <summary>RuntimeException in Pig when using &quot;dump&quot; command on column name</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="silvere">Silv&#232;re Lestang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Jun 2011 14:49:36 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:56 +0000</updated>
                            <resolved>Wed, 28 Sep 2011 22:01:22 +0000</resolved>
                                        <fixVersion>0.8.7</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13054479" author="brandon.williams" created="Fri, 24 Jun 2011 14:45:15 +0000"  >&lt;p&gt;Patch to use a custom AbstractType in place of BytesType to nip this in the bud, rather than have a bunch of one-off checks.  Also fixes a bug where the supercolumn name is never set.&lt;/p&gt;</comment>
                            <comment id="13054485" author="jbellis" created="Fri, 24 Jun 2011 14:52:20 +0000"  >&lt;p&gt;DataByteArray is some kind of Pig thing?&lt;/p&gt;</comment>
                            <comment id="13054494" author="brandon.williams" created="Fri, 24 Jun 2011 15:07:17 +0000"  >&lt;p&gt;Yes, basically a byte array, but it&apos;s the pig type.&lt;/p&gt;</comment>
                            <comment id="13055521" author="silvere" created="Mon, 27 Jun 2011 13:07:56 +0000"  >&lt;p&gt;I try again after applying &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12483714/12483714_2810.txt&quot; title=&quot;2810.txt attached to CASSANDRA-2810&quot;&gt;2810.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; and the patch from bug &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2777&quot; title=&quot;Pig storage handler should implement LoadMetadata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2777&quot;&gt;&lt;del&gt;CASSANDRA-2777&lt;/del&gt;&lt;/a&gt; and the bug is still here.&lt;br/&gt;
With the patch, you need to replace&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;test = LOAD &lt;span class=&quot;code-quote&quot;&gt;&apos;cassandra:&lt;span class=&quot;code-comment&quot;&gt;//Test/test&apos;&lt;/span&gt; USING CassandraStorage() AS (rowkey:chararray, columns: bag {T: (name:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;, value:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)});&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;by&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;test = LOAD &lt;span class=&quot;code-quote&quot;&gt;&apos;cassandra:&lt;span class=&quot;code-comment&quot;&gt;//Test/test&apos;&lt;/span&gt; USING CassandraStorage() AS ();&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;because CassandraStorage takes care of the schema.&lt;/p&gt;

&lt;p&gt;I try:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;grunt&amp;gt; describe test;
test: {key: chararray,columns: {(name: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,value: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;so we can see that the patch from bug 2777 works correctly (I also test with different types for value).&lt;br/&gt;
But when I dump test, I still have the same exception.&lt;/p&gt;</comment>
                            <comment id="13055585" author="silvere" created="Mon, 27 Jun 2011 14:47:23 +0000"  >&lt;p&gt;After more test (with both patches), path &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12483714/12483714_2810.txt&quot; title=&quot;2810.txt attached to CASSANDRA-2810&quot;&gt;2810.txt&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; doesn&apos;t seems to solve the bug.&lt;br/&gt;
Here is a new test case:&lt;br/&gt;
Create a &lt;em&gt;Test&lt;/em&gt; keyspace and a &lt;em&gt;test&lt;/em&gt; column family with key_validation_class = &apos;AsciiType&apos; and comparator = &apos;LongType&apos; and default_validation_class = &apos;IntegerType&apos; (don&apos;t use the cli because of &lt;a href=&quot;#CASSANDRA-2831&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CASSANDRA-2831&lt;/a&gt;).&lt;br/&gt;
Insert some data:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row1&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(1)]=integer(35);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row1&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(2)]=integer(36);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row1&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(3)]=integer(38);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row2&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(1)]=integer(45);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row2&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(2)]=integer(42);
set test[ascii(&lt;span class=&quot;code-quote&quot;&gt;&apos;row2&apos;&lt;/span&gt;)][&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(3)]=integer(33);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In Pig cli:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;test = LOAD &lt;span class=&quot;code-quote&quot;&gt;&apos;cassandra:&lt;span class=&quot;code-comment&quot;&gt;//Test/test&apos;&lt;/span&gt; USING CassandraStorage() AS ();
&lt;/span&gt;dump test;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The same exception as before is raised:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; INFO [IPC Server handler 4 on 8012] 2011-06-27 16:40:28,562 TaskInProgress.java (line 551) Error from attempt_201106271436_0012_m_000000_1: java.lang.RuntimeException: Unexpected data type -1 found in stream.
	at org.apache.pig.data.BinInterSedes.writeDatum(BinInterSedes.java:478)
	at org.apache.pig.data.BinInterSedes.writeTuple(BinInterSedes.java:541)
	at org.apache.pig.data.BinInterSedes.writeBag(BinInterSedes.java:522)
	at org.apache.pig.data.BinInterSedes.writeDatum(BinInterSedes.java:361)
	at org.apache.pig.data.BinInterSedes.writeTuple(BinInterSedes.java:541)
	at org.apache.pig.data.BinInterSedes.writeDatum(BinInterSedes.java:357)
	at org.apache.pig.impl.io.InterRecordWriter.write(InterRecordWriter.java:73)
	at org.apache.pig.impl.io.InterStorage.putNext(InterStorage.java:87)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigOutputFormat$PigRecordWriter.write(PigOutputFormat.java:138)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigOutputFormat$PigRecordWriter.write(PigOutputFormat.java:97)
	at org.apache.hadoop.mapred.MapTask$NewDirectOutputCollector.write(MapTask.java:638)
	at org.apache.hadoop.mapreduce.TaskInputOutputContext.write(TaskInputOutputContext.java:80)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapOnly$Map.collect(PigMapOnly.java:48)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapBase.map(PigMapBase.java:224)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapBase.map(PigMapBase.java:53)
	at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:144)
	at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:763)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:369)
	at org.apache.hadoop.mapred.Child$4.run(Child.java:259)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:396)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1059)
	at org.apache.hadoop.mapred.Child.main(Child.java:253)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13062128" author="brandon.williams" created="Fri, 8 Jul 2011 19:41:16 +0000"  >&lt;p&gt;So is the conclusion that this patch by itself works fine, but there is a problem with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2777&quot; title=&quot;Pig storage handler should implement LoadMetadata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2777&quot;&gt;&lt;del&gt;CASSANDRA-2777&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13063906" author="silvere" created="Tue, 12 Jul 2011 13:54:27 +0000"  >&lt;p&gt;No, from my test I arrived to the inverse conclusion: &lt;a href=&quot;#CASSANDRA-2777&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CASSANDRA-2777&lt;/a&gt; seems to works fine (Pig has the good type for my column family) but the bug is still here despite the 2 patches.&lt;/p&gt;</comment>
                            <comment id="13082031" author="brandon.williams" created="Wed, 10 Aug 2011 00:55:40 +0000"  >&lt;p&gt;It looks like the final problem here is that IntegerType always returns a BigInteger, which pig does not like.  This is unfortunate since IntegerType can&apos;t be easily subclassed and overridden to return ints.&lt;/p&gt;

&lt;p&gt;v2 instead adds a setTupleValue method that is always used for adding values to tuples, and houses all the special-casing currently needed and provides a spot for more in the future, rather than proliferating custom type converters since I&apos;m sure IntegerType won&apos;t be alone here.&lt;/p&gt;</comment>
                            <comment id="13089566" author="brandon.williams" created="Tue, 23 Aug 2011 16:25:53 +0000"  >&lt;p&gt;v3 also removes decomposing the values before inserting and instead forces them into a ByteBuffer with objToBB, since we actually don&apos;t care about the type. (why did we ever change this?)&lt;/p&gt;

&lt;p&gt;This means that a UDF that doesn&apos;t preserve the schema and hands us back DataByteArrays when we fed it specific types can&apos;t make us fail anymore.&lt;/p&gt;</comment>
                            <comment id="13116818" author="steeve" created="Wed, 28 Sep 2011 21:30:30 +0000"  >&lt;p&gt;Fixed it for me on Pig 0.9 and Cassandra 0.8.6 (Brisk).&lt;/p&gt;</comment>
                            <comment id="13116825" author="jeromatron" created="Wed, 28 Sep 2011 21:35:39 +0000"  >&lt;p&gt;+1 - if we find any issues with it in production, we&apos;ll submit bug reports.&lt;/p&gt;</comment>
                            <comment id="13116843" author="brandon.williams" created="Wed, 28 Sep 2011 22:01:22 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="13116856" author="hudson" created="Wed, 28 Sep 2011 22:19:49 +0000"  >&lt;p&gt;Integrated in Cassandra-0.8 #348 (See &lt;a href=&quot;https://builds.apache.org/job/Cassandra-0.8/348/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Cassandra-0.8/348/&lt;/a&gt;)&lt;br/&gt;
    Fix handling of integer types in pig.&lt;br/&gt;
Patch by brandonwilliams, reviewed by Jeremy Hanna for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2810&quot; title=&quot;RuntimeException in Pig when using &amp;quot;dump&amp;quot; command on column name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2810&quot;&gt;&lt;del&gt;CASSANDRA-2810&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;brandonwilliams : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1177084&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1177084&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/cassandra/branches/cassandra-0.8/contrib/pig/src/java/org/apache/cassandra/hadoop/pig/CassandraStorage.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489923" name="2810-v2.txt" size="3758" author="brandon.williams" created="Wed, 10 Aug 2011 00:55:40 +0000"/>
                            <attachment id="12491357" name="2810-v3.txt" size="4481" author="brandon.williams" created="Tue, 23 Aug 2011 16:25:53 +0000"/>
                            <attachment id="12483714" name="2810.txt" size="5522" author="brandon.williams" created="Fri, 24 Jun 2011 14:45:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20841</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 8 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gdlj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>93633</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jeromatron</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jeromatron]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>