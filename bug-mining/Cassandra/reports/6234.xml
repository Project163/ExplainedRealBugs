<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:27:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-16718] Changing listen_address with prefer_local may lead to issues</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-16718</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Many container based solution function by assigning new listen_addresses when nodes are stopped. Changing the listen_address is usually as simple as turning off the node and changing the yaml file.&#160;&lt;/p&gt;

&lt;p&gt;However, if prefer_local is enabled, I observed that nodes were unable to join the cluster and fail with &apos;Unable to gossip with any seeds&apos;. &lt;/p&gt;

&lt;p&gt;Trace shows that the changing node will try to communicate with the existing node but the response is never received. I assume it is because the existing node attempts to communicate with the local address during the shadow round.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13382473">CASSANDRA-16718</key>
            <summary>Changing listen_address with prefer_local may lead to issues</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="Jan Karlsson">Jan Karlsson</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Jun 2021 12:49:19 +0000</created>
                <updated>Tue, 12 Sep 2023 13:02:50 +0000</updated>
                            <resolved>Tue, 16 May 2023 14:04:36 +0000</resolved>
                                        <fixVersion>4.0.10</fixVersion>
                    <fixVersion>4.1.2</fixVersion>
                    <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Local/Config</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="17358575" author="jan karlsson" created="Mon, 7 Jun 2021 12:57:00 +0000"  >&lt;p&gt;dtest to repro can be found &lt;a href=&quot;https://github.com/itskarlsson/cassandra-dtest/tree/CASSANDRA-16718&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. It works if prefer_local is set to false.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17392196" author="jan karlsson" created="Tue, 3 Aug 2021 09:31:51 +0000"  >&lt;p&gt;Took a look at the code base. It seems to be quite a difficult thing to change as it is intertwined with the message pools per node. Maybe someone with more experience with the networking can shed some light on the issue.&lt;/p&gt;</comment>
                            <comment id="17404538" author="brandon.williams" created="Wed, 25 Aug 2021 14:56:00 +0000"  >&lt;p&gt;Can you describe the network configuration here that requires prefer_local?&lt;/p&gt;</comment>
                            <comment id="17407896" author="esimfon" created="Wed, 1 Sep 2021 07:09:53 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Jan asked me to answer since I have a deeper knowledge in the issue at hand.&lt;/p&gt;

&lt;p&gt;We deploy Cassandra in a Kubernetes cluster. To achieve external connectivity to remote DCs (Cassandra DCs in different Kubernetes clusters) we use MetalLB (one LoadBalancer Service per Pod). Some of our deployments use traffic policy &quot;Cluster&quot; which doesn&apos;t preserve source IP.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;However, kube-proxy will obscure the source IP address of the connection when it does load balancing, so your pod logs will show that external traffic appears to be coming from the service&#8217;s leader node.&lt;/p&gt;&lt;/blockquote&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://metallb.universe.tf/usage/#cluster-traffic-policy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://metallb.universe.tf/usage/#cluster-traffic-policy&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We have a Cassandra plugin which uses the IP for its execution logic. With prefer_local=false all traffic (incl. local traffic) will go through the load balancer and therefore obscures the source IP. With prefer_local the source IP for local nodes is preserved so it&apos;s available to our plugin.&lt;/p&gt;

&lt;p&gt;Let me know if you need more details.&lt;/p&gt;</comment>
                            <comment id="17408197" author="brandon.williams" created="Wed, 1 Sep 2021 14:26:12 +0000"  >&lt;p&gt;Adjusting fixvers as this passes on 3.0, but not 3.11 or 4.0.&lt;/p&gt;</comment>
                            <comment id="17408402" author="brandon.williams" created="Wed, 1 Sep 2021 22:15:20 +0000"  >&lt;p&gt;&lt;del&gt;This has been broken since &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10134&quot; title=&quot;Always require replace_address to replace existing address&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10134&quot;&gt;&lt;del&gt;CASSANDRA-10134&lt;/del&gt;&lt;/a&gt;, though I&apos;m not sure how yet&lt;/del&gt;.  What is strange to me is that this issue persists even if both nodes are restarted, so something is being persisted incorrectly here.&lt;/p&gt;</comment>
                            <comment id="17409614" author="brandon.williams" created="Fri, 3 Sep 2021 17:05:45 +0000"  >&lt;p&gt;&lt;del&gt;This issue boils down to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10134&quot; title=&quot;Always require replace_address to replace existing address&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10134&quot;&gt;&lt;del&gt;CASSANDRA-10134&lt;/del&gt;&lt;/a&gt; loading the ring state, which includes preferred_ip.&lt;/del&gt;  OTC then queries this directly if it exists and uses it before any changes can be learned.  Given this, I&apos;m not sure it even makes sense to store the preferred_ip, since if we try to use it eagerly we&apos;ll never be able to learn of the change to it, as this issue exemplifies.  I think the best plan is just to remove this optimization and do the reconnection dance every time, which still shouldn&apos;t be super-often. WDYT, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt;?&lt;/p&gt;

&lt;p&gt;&lt;del&gt;In the meantime, operators may add &lt;tt&gt;-Dcassandra.load_ring_state=false&lt;/tt&gt; if that&apos;s an acceptable workaround.&lt;/del&gt;&lt;/p&gt;</comment>
                            <comment id="17411468" author="brandon.williams" created="Tue, 7 Sep 2021 20:33:35 +0000"  >&lt;p&gt;Actually, &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10134&quot; title=&quot;Always require replace_address to replace existing address&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10134&quot;&gt;&lt;del&gt;CASSANDRA-10134&lt;/del&gt;&lt;/a&gt; didn&apos;t break this, but it fixed the server&apos;s behavior such that the test was deterministic after it; before we will mark the node up, but then fail to connect to the old IP forever and eventually mark the node back down due to lack of communication, tricking the test into thinking it passed. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  I will keep digging, but I suspect the solution is likely the same: don&apos;t persist and use preferred_ip, only the gossip state that is present.&lt;/p&gt;</comment>
                            <comment id="17411763" author="jan karlsson" created="Wed, 8 Sep 2021 08:07:53 +0000"  >&lt;p&gt;Great findings so far. Thank you for taking the time to dig into this.&lt;/p&gt;

&lt;p&gt;I agree that the old local address is persisted somewhere and therefore used by the existing node. However, in an attempt to verify your findings I modified my test case to manually change the preferred_ip before I start the last node so that it points to the correct address. The test still fails even with an updated preferred_ip.&lt;/p&gt;

&lt;p&gt;My original thought was that the Gossiper was persisting this ip in endpointStateMap. During checkEndpointCollison, the UP node will attempt to connect through the local address before this address is updated by the ShadowRound.&lt;/p&gt;</comment>
                            <comment id="17412872" author="brandon.williams" created="Thu, 9 Sep 2021 22:54:39 +0000"  >&lt;p&gt;What I have discovered is that with all persistence removed and every call relying what information the Gossiper has for the node, this will &lt;em&gt;still&lt;/em&gt; use the old address, because only a SYN has been received from the updated node, so checks on the internal state will use the stale information.  This is going to be trickier than I suspected.&lt;/p&gt;</comment>
                            <comment id="17413402" author="brandon.williams" created="Fri, 10 Sep 2021 21:55:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Here&lt;/a&gt; is a 3.11 branch that passes a slightly more thorough &lt;a href=&quot;https://github.com/driftx/cassandra-dtest/tree/CASSANDRA-16718&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest that reads at ALL&lt;/a&gt; in a &lt;a href=&quot;https://ci-cassandra.apache.org/blue/organizations/jenkins/Cassandra-devbranch/detail/Cassandra-devbranch/1109/pipeline&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI run&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This works by removing the &lt;em&gt;use&lt;/em&gt; of persistence in OutboundTcpConnectionPool, but still persists the IP for later usage, and ReconnectingSnitchHelper &lt;em&gt;removes&lt;/em&gt; the INTERNAL_IP state upon the node being marked down so that changes can be learned in the next connection.&lt;/p&gt;

&lt;p&gt;I&apos;ll have to come up with something similar for 4.0 and trunk, since they don&apos;t have OTCP after the messaging service refactoring.&lt;/p&gt;</comment>
                            <comment id="17414572" author="brandon.williams" created="Mon, 13 Sep 2021 20:19:25 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Jenkins&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Circle&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://ci-cassandra.apache.org/blue/organizations/jenkins/Cassandra-devbranch/detail/Cassandra-devbranch/1116/pipeline&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://ci-cassandra.apache.org/job/Cassandra-devbranch/1116/badge/icon&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra?branch=CASSANDRA-16718&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://ci-cassandra.apache.org/blue/organizations/jenkins/Cassandra-devbranch/detail/Cassandra-devbranch/1113/pipeline&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://ci-cassandra.apache.org/job/Cassandra-devbranch/1113/badge/icon&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra?branch=CASSANDRA-16718-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8, j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://ci-cassandra.apache.org/blue/organizations/jenkins/Cassandra-devbranch/detail/Cassandra-devbranch/1115/pipeline&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://ci-cassandra.apache.org/job/Cassandra-devbranch/1115/badge/icon&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra?branch=CASSANDRA-16718-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8, j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17415134" author="brandon.williams" created="Tue, 14 Sep 2021 20:08:53 +0000"  >&lt;p&gt;There are a couple of tests that are now too synthetic to pass like the EC2SnitchTest.testEc2MRSnitch and OutboundConnectionsTest.reconnectWithNewIp since both try to pass an arbitrary IP address to reconnect to, where now only the live gossip value is used.  I&apos;m not sure it&apos;s worth fleshing those into more thorough tests like the dtest in the patch that covers this.&lt;/p&gt;</comment>
                            <comment id="17416038" author="jan karlsson" created="Thu, 16 Sep 2021 10:42:46 +0000"  >&lt;p&gt;LGTM. Seems to fix the issue completely. However, preferred_ip is null after your patch throughout the test. Is this an intended side effect?&lt;/p&gt;</comment>
                            <comment id="17416192" author="brandon.williams" created="Thu, 16 Sep 2021 15:48:41 +0000"  >&lt;p&gt;Hmm, no.  I left the &lt;a href=&quot;https://github.com/driftx/cassandra/commit/f2b7b335a89c64eb478424eb6a9a027e59995c4a#diff-3fe65944fc6b986688040b3a9400cd5a0bd798cca29e0f3b399db5ece33dc1f1L108&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;call in reconnect that updates it&lt;/a&gt; intentionally so &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8084&quot; title=&quot;GossipFilePropertySnitch and EC2MultiRegionSnitch when used in AWS/GCE clusters doesnt use the PRIVATE IPS for Intra-DC communications - When running nodetool repair&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8084&quot;&gt;&lt;del&gt;CASSANDRA-8084&lt;/del&gt;&lt;/a&gt; would continue to work, I only removed an earlier call to retrieve it.  How did you observe this?&lt;/p&gt;

&lt;p&gt;This raises a greater question though, perhaps we should remove the persistence altogether and rework &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8084&quot; title=&quot;GossipFilePropertySnitch and EC2MultiRegionSnitch when used in AWS/GCE clusters doesnt use the PRIVATE IPS for Intra-DC communications - When running nodetool repair&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8084&quot;&gt;&lt;del&gt;CASSANDRA-8084&lt;/del&gt;&lt;/a&gt;&apos;s bits to work like this too.  I&apos;ll wait for reviewer feedback before pulling that trigger though.&lt;/p&gt;</comment>
                            <comment id="17416492" author="jan karlsson" created="Fri, 17 Sep 2021 06:54:08 +0000"  >&lt;p&gt;Observed this by fetching the peers table before stopping node2 in my dtest.&lt;/p&gt;

&lt;p&gt;Without the patch I observed preferred_ip populated but with the patch it is null throughout the test.&lt;/p&gt;</comment>
                            <comment id="17528707" author="jan karlsson" created="Wed, 27 Apr 2022 09:57:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; The ticket has been quiet for awhile now. What is the status on this? Are we waiting for a reviewer?&lt;/p&gt;</comment>
                            <comment id="17528744" author="brandon.williams" created="Wed, 27 Apr 2022 11:30:21 +0000"  >&lt;p&gt;Yes and I don&apos;t imagine we will get one at this point until after 4.1 releases.  After that I will come back to this and see if it can be driven forward.&lt;/p&gt;</comment>
                            <comment id="17679090" author="tommy_s" created="Fri, 20 Jan 2023 10:10:19 +0000"  >&lt;p&gt;Any status updates on this issue? since 4.1 has been release for a while.&lt;/p&gt;</comment>
                            <comment id="17679119" author="brandon.williams" created="Fri, 20 Jan 2023 11:54:09 +0000"  >&lt;p&gt;Let me refresh this for the current branches and locate a reviewer.&lt;/p&gt;</comment>
                            <comment id="17680245" author="brandon.williams" created="Tue, 24 Jan 2023 14:57:20 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/816/workflows/dba0aab7-0267-49bf-8306-19720c065b92&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/815/workflows/e84f0d6c-6497-45f8-b81f-9443c59762a3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/815/workflows/c131fd88-74e7-46d6-869d-5199c11d898b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/814/workflows/82a2acd8-d124-4c93-b018-e29642655e33&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/814/workflows/754fe3ba-a08f-4ceb-b95f-65596e1710b0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/813/workflows/bf6e0bcf-53a2-4888-bc8d-3234af2b3c23&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/813/workflows/4df118dc-b1a7-4034-bc2e-114c5676126a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;The current state here is the 3.11 patch breaks test_prefer_local_reconnect_on_listen_address and seems to legitimately not reconnect (but does pass the restart test), and the 4.x patch doesn&apos;t seem to work, it&apos;s still holding on to the old address somewhere.&lt;/p&gt;</comment>
                            <comment id="17682123" author="JIRAUSER285315" created="Mon, 30 Jan 2023 14:40:34 +0000"  >&lt;p&gt;I&apos;ve tried your patch for 4.0 Brandon. What still holds the old address are the connectionPools that are cached in MessagingService.&lt;/p&gt;

&lt;p&gt;When the affected connectionPools are removed the dtest is green. Here&apos;s &lt;a href=&quot;https://github.com/masokol/cassandra/tree/CASSANDRA-16718-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;my branch&lt;/a&gt; for reference.&lt;/p&gt;</comment>
                            <comment id="17683078" author="brandon.williams" created="Wed, 1 Feb 2023 16:04:53 +0000"  >&lt;p&gt;Thanks, Maciej!  That&apos;s very helpful and I&apos;ve incorporated your patch into my branch.  I think I also figured out what was wrong with 3.11, let&apos;s see what circle thinks.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/848/workflows/9bc58300-b9ab-4676-b850-5fbedd6221d9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/849/workflows/28bb4215-1a9c-4cc5-a1cf-91140dd8f998&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/849/workflows/ad575adc-a991-4290-a221-b0d1031fef7c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/846/workflows/42d858fc-66ea-473c-9315-92c1da75c1ed&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/846/workflows/226864ea-73a0-4bb5-94f2-96abcf0a3331&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/847/workflows/1e8c1c54-3ddc-4184-a592-46912379e4c4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/847/workflows/c4cdccb4-8318-4dd7-8279-806c66acf14e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17683104" author="brandon.williams" created="Wed, 1 Feb 2023 17:17:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think I also figured out what was wrong with 3.11&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Well, partially.  Now the reconnect test fails.  We can probably just remove testEc2MRSnitch since that was done in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8457&quot; title=&quot;nio MessagingService&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8457&quot;&gt;&lt;del&gt;CASSANDRA-8457&lt;/del&gt;&lt;/a&gt; and it&apos;s covered by the other reconnection tests.  Then there&apos;s the HandshakeTest in trunk.&lt;/p&gt;</comment>
                            <comment id="17684731" author="JIRAUSER285315" created="Mon, 6 Feb 2023 15:00:57 +0000"  >&lt;p&gt;There&apos;s a Jira for the handshake being flaky &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17979&quot; title=&quot;Fix flaky test:org.apache.cassandra.net.HandshakeTest.testOutboundConnectionfFallbackDuringUpgrades&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17979&quot;&gt;&lt;del&gt;CASSANDRA-17979&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17690213" author="JIRAUSER285315" created="Fri, 17 Feb 2023 07:52:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; could you rebase and rerun CI? I think the ticket i linked in previous comment should resolve the failing test in trunk. If that&apos;s the case then I guess we only need to decide what to do with testEc2MRSnitch and then the patch should be ready?&lt;/p&gt;</comment>
                            <comment id="17690357" author="brandon.williams" created="Fri, 17 Feb 2023 11:23:34 +0000"  >&lt;p&gt;We can remove testEc2MRSnitch since that is removed in 4.0 and later anyway... but the real issue is 3.11 doesn&apos;t work correctly.  Either test_prefer_local_reconnect_on_listen_address or test_prefer_local_reconnect_on_restart fails depending on which approach is attempted.&lt;/p&gt;

&lt;p&gt;Given this, and that the message service was &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15066&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;rewritten&lt;/a&gt; for 4.0, and with 4.2/5.0 releasing in the coming months which will EOL it, I think we should just quit targeting 3.11.&lt;/p&gt;

&lt;p&gt;Then we can rebase and run CI and we should be ready.&lt;/p&gt;</comment>
                            <comment id="17715009" author="JIRAUSER285315" created="Fri, 21 Apr 2023 13:32:42 +0000"  >&lt;p&gt;You are right, it feels strange to break existing functionality in an older branch. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; could you rebase and run CI when you get the time? Or are we waiting for something?&lt;/p&gt;</comment>
                            <comment id="17716848" author="brandon.williams" created="Wed, 26 Apr 2023 18:07:09 +0000"  >&lt;p&gt;Rebased:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/987/workflows/10f7377e-82a4-4e3c-a1ef-9a4434cf2dec&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/987/workflows/62eee3b3-b51b-4f86-bdaf-77e102787b47&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/985/workflows/5341072c-542e-4f0a-af90-98624e59cc07&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/985/workflows/5e3a1e1f-7004-48fc-b0c6-faff7ef95914&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/986/workflows/9ab17625-3937-4daf-9c73-ffa77cc0f703&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/986/workflows/1d17e818-b3b2-4732-bb11-75f77d6de8d3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17719165" author="bereng" created="Thu, 4 May 2023 06:13:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; are those branch links correct? the latest commit in the history takes me to a massive merge commit.&lt;/p&gt;</comment>
                            <comment id="17719257" author="brandon.williams" created="Thu, 4 May 2023 10:34:32 +0000"  >&lt;p&gt;Heh, it&apos;s actually in there, it&apos;s just the code is from 2021 at this point.  Let me recreate the branches so it&apos;s easy to find.&lt;/p&gt;</comment>
                            <comment id="17719261" author="brandon.williams" created="Thu, 4 May 2023 10:51:56 +0000"  >&lt;p&gt;Branch links above updated so the commit you need is first; no code changes.&lt;/p&gt;</comment>
                            <comment id="17719534" author="mfleming" created="Thu, 4 May 2023 21:37:35 +0000"  >&lt;p&gt;Patch looks good to me. nb +1&lt;/p&gt;</comment>
                            <comment id="17719704" author="bereng" created="Fri, 5 May 2023 07:24:13 +0000"  >&lt;p&gt;^Can you please trigger upgrade tests &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;? I&apos;ve had some re-connect errors show in them that wouldn&apos;t otherwise.&lt;/p&gt;</comment>
                            <comment id="17719781" author="brandon.williams" created="Fri, 5 May 2023 10:03:28 +0000"  >&lt;p&gt;Upgrade tests started.&lt;/p&gt;</comment>
                            <comment id="17719846" author="bereng" created="Fri, 5 May 2023 12:55:30 +0000"  >&lt;p&gt;Idk if circle is having issues, if there are legit bootstrap failures or both. Looks like the bootstrap tests are failing. You should also trigger the jvm_upgrade ones in light of those failures.&lt;/p&gt;</comment>
                            <comment id="17719875" author="brandon.williams" created="Fri, 5 May 2023 13:57:11 +0000"  >&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;node1: ERROR [main] 2023-05-05 10:29:38,129 CassandraDaemon.java:910 - Exception encountered during startup
org.apache.cassandra.exceptions.ConfigurationException: JavaScript user-defined functions were removed in CASSANDRA-18252. Hooks are planned to be introduced as part of CASSANDRA-17280
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m not sure what&apos;s going on here, it doesn&apos;t seem to be from this patch.  I see other upgrade issues on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18499&quot; title=&quot;Test Failure: upgrade_through_versions_test.py::TestUpgrade::test_rolling_upgrade_with_internode_ssl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18499&quot;&gt;&lt;del&gt;CASSANDRA-18499&lt;/del&gt;&lt;/a&gt;, perhaps this is related.  I started the jvm upgrade tests anyway, let&apos;s see how that goes.&lt;/p&gt;</comment>
                            <comment id="17719888" author="brandon.williams" created="Fri, 5 May 2023 14:15:09 +0000"  >&lt;p&gt;Ekaterina pointed out I completely hosed the circle config when I rebased and my dtest branch wasn&apos;t rebased.  I&apos;ve fixed both of those, let&apos;s try again:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1005/workflows/40522429-d127-4625-88ec-c95756012745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1005/workflows/831b59b2-6414-4e67-a01f-1ec2dc4a54fe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1006/workflows/458edc48-bff7-41be-82ee-e1cd5aaf604a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1006/workflows/4b14c842-4962-453d-a7b8-4230e5aa8ddb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-16718-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1004/workflows/855c944b-a0b2-4d04-b635-6a4a6aed2c14&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1004/workflows/201189e7-637d-429c-90bd-98adf9b3f3fc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17720386" author="bereng" created="Mon, 8 May 2023 05:24:06 +0000"  >&lt;p&gt;It seems there is a failure in trunk that doesn&apos;t align with current trunk CI. It would be good to also put up the link to the dtests branch and amend that one so the latest commit is just the changes from the branch, rather than the big merge?&lt;/p&gt;</comment>
                            <comment id="17722924" author="brandon.williams" created="Mon, 15 May 2023 20:45:00 +0000"  >&lt;p&gt;Those failures are &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18499&quot; title=&quot;Test Failure: upgrade_through_versions_test.py::TestUpgrade::test_rolling_upgrade_with_internode_ssl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18499&quot;&gt;&lt;del&gt;CASSANDRA-18499&lt;/del&gt;&lt;/a&gt;.  I&apos;ve rebased the dtest branch &lt;a href=&quot;https://github.com/driftx/cassandra-dtest/tree/CASSANDRA-16718&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; with Jan&apos;s commit (and my addition to it) as the latest.&lt;/p&gt;</comment>
                            <comment id="17722989" author="bereng" created="Tue, 16 May 2023 05:18:02 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17723143" author="brandon.williams" created="Tue, 16 May 2023 14:04:36 +0000"  >&lt;p&gt;Finally committed!  Thanks for the review!&lt;/p&gt;</comment>
                            <comment id="17741658" author="brandon.williams" created="Mon, 10 Jul 2023 15:08:37 +0000"  >&lt;p&gt;This was reverted in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18560&quot; title=&quot;Incorrect IP used for gossip across DCs with prefer_local=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18560&quot;&gt;&lt;del&gt;CASSANDRA-18560&lt;/del&gt;&lt;/a&gt;.  We will make another attempt on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18657&quot; title=&quot;Changing listen_address with prefer_local may lead to issues, second attempt&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18657&quot;&gt;CASSANDRA-18657&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13538448">CASSANDRA-18560</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12983" cascade-level=""><![CDATA[Availability]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 18 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0rpy8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bereng]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348835">NA</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/b791644fda91b343a679bb0c2c1e33e594524636&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/b791644fda91b343a679bb0c2c1e33e594524636&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;test included, CI&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>