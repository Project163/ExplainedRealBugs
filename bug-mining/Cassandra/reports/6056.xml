<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:25:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-17083] testsome target doesn&apos;t work with wildcards</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-17083</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Running &lt;tt&gt;ant test -Dtest.name=PasswordObfuscator*Test&lt;/tt&gt; runs the test correctly. But &lt;tt&gt;ant testsome -Dtest.name=PasswordObfuscator*Test&lt;/tt&gt; will make it fail like&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[junit-timeout] Testsuite: org.apache.cassandra.cql3.PasswordObfuscatorTest
[junit-timeout] Testsuite: org.apache.cassandra.cql3.PasswordObfuscatorTest Tests run: 18, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.038 sec
[junit-timeout] 
[junit-timeout] Testsuite: PasswordObfuscator*Test
[junit-timeout] Testsuite: PasswordObfuscator*Test Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0 sec
[junit-timeout] 
[junit-timeout] Null Test: 	Caused an ERROR
[junit-timeout] PasswordObfuscator*Test
[junit-timeout] java.lang.ClassNotFoundException: PasswordObfuscator*Test
[junit-timeout] 	at java.net.URLClassLoader.findClass(URLClassLoader.java:382)
[junit-timeout] 	at java.lang.ClassLoader.loadClass(ClassLoader.java:418)
[junit-timeout] 	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:352)
[junit-timeout] 	at java.lang.ClassLoader.loadClass(ClassLoader.java:351)
[junit-timeout] 	at java.lang.Class.forName0(Native Method)
[junit-timeout] 	at java.lang.Class.forName(Class.java:348)
[junit-timeout] 
[junit-timeout] 
[junit-timeout] Test PasswordObfuscator*Test FAILED
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should fix testsome as this is a useful feature for &apos;families&apos; of tests such as &lt;tt&gt;ViewComplex*Test&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13409068">CASSANDRA-17083</key>
            <summary>testsome target doesn&apos;t work with wildcards</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bernardo.botella">Bernardo Botella Corbi</assignee>
                                    <reporter username="bereng">Berenguer Blasi</reporter>
                        <labels>
                            <label>low-hanging-fruit</label>
                    </labels>
                <created>Fri, 29 Oct 2021 08:10:52 +0000</created>
                <updated>Tue, 12 Sep 2023 13:02:58 +0000</updated>
                            <resolved>Wed, 22 Jun 2022 05:16:28 +0000</resolved>
                                        <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Build</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4200">1h 10m</timespent>
                                <comments>
                            <comment id="17532558" author="JIRAUSER285406" created="Thu, 5 May 2022 23:45:40 +0000"  >&lt;p&gt;I don&apos;t think what we are trying to accomplish here is possible with current ant version. Right now, the ant JUnit task we are using provides two different attributes:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;test -&amp;gt; it has a required field called name, and which represents the FQDN of the test class. It has an optional methods parameter that can be used to define a list of methods to be run. We are using this attribute in the &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/build.xml#L1658-L1668&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testsome target&lt;/a&gt;. Name field does not support wildcards, and that is the reason the testsome target fails as described in the ticket.&lt;/li&gt;
	&lt;li&gt;batchtest -&amp;gt; it receives a series of filters that are used to determine which test classes will be run, and doesn&apos;t accept any concept of methods. We are using this attribute in the &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/build.xml#L1925-L1931&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;test target&lt;/a&gt;, you&apos;ll see that if you follow the macros definitions. Those filters support wildcards, and that is the reason the test target works as described in the ticket.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Full documentation of these two attributes can be found &lt;a href=&quot;https://ant.apache.org/manual/Tasks/junit.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Now, as I understand this ticket, we would need to be able to filter by two different dimensions on the batchtest approach (the goal is to perform several test), class name AND methods. As we have just seen, this is not supported at this point as batchtest only supports class names.&lt;/p&gt;

&lt;p&gt;Hence, in my opinion, the correct path forward would be:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/bugzilla/enter_bug.cgi?product=Ant&amp;amp;bug_severity=enhancement&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Create an enhancement report&lt;/a&gt; for Ant. This should mention the need to modify the &lt;a href=&quot;https://github.com/apache/ant/blob/master/src/main/org/apache/tools/ant/taskdefs/optional/junit/JUnitTask.java#L604-L609&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;batchtest logic&lt;/a&gt; in order to support filter by method names.&lt;/li&gt;
	&lt;li&gt;Work with Ant team members to have this implemented and released.&lt;/li&gt;
	&lt;li&gt;Update the version Cassandra is using to have support for this.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;The alternative of extending the &lt;a href=&quot;https://github.com/apache/ant/blob/master/src/main/org/apache/tools/ant/taskdefs/optional/junit/JUnitTask.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JUnitTask class&lt;/a&gt; in our own project to add support to that seems hardly maintainable on the long run, and I would definitely discourage it.&lt;/p&gt;</comment>
                            <comment id="17532579" author="yifanc" created="Fri, 6 May 2022 01:44:49 +0000"  >&lt;p&gt;Thank you Bernardo for the detailed explanation! It makes sense to me. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;bereng&lt;/a&gt;, is the goal of this ticket to make `testsome` to be able to filter with both class name and method names? If so, it feels a bit unclear semantically, when running the command. The method names may or may not be the same across test classes. If the goal is to run all tests from different test classes, `test` is able to do it and the CI config is able to point to a different target. Looks like it is applied during the work on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17070&quot; title=&quot;ViewComplexTest hardening&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17070&quot;&gt;&lt;del&gt;CASSANDRA-17070&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="17532673" author="bereng" created="Fri, 6 May 2022 06:55:09 +0000"  >&lt;p&gt;Hi all,&lt;/p&gt;

&lt;p&gt;Thanks for looking into this. This is only about &lt;tt&gt;testsome&lt;/tt&gt; not failing the build when using wildcards. Not about test methods, shared method names across test classes, workarounds with &lt;tt&gt;test&lt;/tt&gt; etc. Don&apos;t look so much into it.&lt;/p&gt;

&lt;p&gt;It&apos;s just a plain fix of the above bug so you don&apos;t get failed runs with &lt;tt&gt;testsome&lt;/tt&gt; bc of that nonsense error.&lt;/p&gt;</comment>
                            <comment id="17532766" author="brandon.williams" created="Fri, 6 May 2022 10:25:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bernardo.botella&quot; class=&quot;user-hover&quot; rel=&quot;bernardo.botella&quot;&gt;bernardo.botella&lt;/a&gt; thanks for your analysis.  I recall when I first added the testsome target I was trying to allow wildcards and not require the FQDN for the class, but wasn&apos;t able to figure either one out.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;This is only about testsome not failing the build when using wildcards.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It looks like it does fail when you do this?&lt;/p&gt;</comment>
                            <comment id="17532801" author="bereng" created="Fri, 6 May 2022 11:34:23 +0000"  >&lt;p&gt;Yes, it fails when you do use &lt;tt&gt;testsome&lt;/tt&gt; and succeeds when you do &lt;tt&gt;test&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;testsome:
    [mkdir] Created dir: /home/bereng/work/repos/bdpWS/17605/build/test/cassandra
    [mkdir] Created dir: /home/bereng/work/repos/bdpWS/17605/build/test/output
[junit-timeout] Testsuite: org.apache.cassandra.cql3.PasswordObfuscatorTest
[junit-timeout] Testsuite: org.apache.cassandra.cql3.PasswordObfuscatorTest Tests run: 19, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.045 sec
[junit-timeout] 
[junit-timeout] Testsuite: PasswordObfuscator*Test
[junit-timeout] Testsuite: PasswordObfuscator*Test Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0 sec
[junit-timeout] 
[junit-timeout] Null Test: 	Caused an ERROR
[junit-timeout] PasswordObfuscator*Test
[junit-timeout] java.lang.ClassNotFoundException: PasswordObfuscator*Test
[junit-timeout] 	at java.net.URLClassLoader.findClass(URLClassLoader.java:387)
[junit-timeout] 	at java.lang.ClassLoader.loadClass(ClassLoader.java:418)
[junit-timeout] 	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:352)
[junit-timeout] 	at java.lang.ClassLoader.loadClass(ClassLoader.java:351)
[junit-timeout] 	at java.lang.Class.forName0(Native Method)
[junit-timeout] 	at java.lang.Class.forName(Class.java:348)
[junit-timeout] 
[junit-timeout] 
[junit-timeout] Test PasswordObfuscator*Test FAILED

BUILD FAILED
/home/bereng/work/repos/bdpWS/17605/build.xml:1659: The following error occurred while executing this line:
/home/bereng/work/repos/bdpWS/17605/build.xml:1912: Some test(s) failed.

Total time: 20 seconds

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17532805" author="brandon.williams" created="Fri, 6 May 2022 11:41:46 +0000"  >&lt;p&gt;I don&apos;t think that&apos;s surprising given it does not work.  I don&apos;t think the effort required here is worth investing, shall we close?&lt;/p&gt;</comment>
                            <comment id="17532814" author="bereng" created="Fri, 6 May 2022 11:56:04 +0000"  >&lt;p&gt;It sort of &lt;em&gt;does&lt;/em&gt; work. It picks up all the test classes and runs them, see the output. Only it tries to run the class with a wildcard as well. The only job to do here is to see if adding that exclusion is low cost. Which, finger in the air, I would presume it&apos;s doable? So I wouldn&apos;t close without looking into it. It&apos;s probably just adding an &lt;tt&gt;&amp;lt;exclude&amp;gt;&lt;/tt&gt; somewhere. I can take a look when I get a gap, I&apos;d rather have a look than just closing.&lt;/p&gt;</comment>
                            <comment id="17532917" author="JIRAUSER285406" created="Fri, 6 May 2022 15:12:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;bereng&lt;/a&gt;&#160;you will see the same output if you run the same command without the wildcard. Something like:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;testsome:
[junit-timeout] OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
[junit-timeout] Testsuite: org.apache.cassandra.cql3.PasswordObfuscatorTest
[junit-timeout] Testsuite: org.apache.cassandra.cql3.PasswordObfuscatorTest Tests run: 19, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.269 sec
[junit-timeout]
[junit-timeout] OpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.
[junit-timeout] Testsuite: PasswordObfuscatorTest
[junit-timeout] Testsuite: PasswordObfuscatorTest Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0 sec
[junit-timeout]
[junit-timeout] Null Test: 	Caused an ERROR
[junit-timeout] PasswordObfuscatorTest
[junit-timeout] java.lang.ClassNotFoundException: PasswordObfuscatorTest
[junit-timeout] 	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:581)
[junit-timeout] 	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178)
[junit-timeout] 	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:522)
[junit-timeout] 	at java.base/java.lang.Class.forName0(Native Method)
[junit-timeout] 	at java.base/java.lang.Class.forName(Class.java:398)
[junit-timeout]
[junit-timeout]
[junit-timeout] Test PasswordObfuscatorTest FAILED

BUILD FAILED
&#160;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The reason for that, I believe, is that whenever you try to run testsome not using the FQDN name of the class it runs both batchtest and test. You can see this following the &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/build.xml#L1659&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;used macro definition&lt;/a&gt; brings us to this other &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/build.xml#L1906&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;macro definition&lt;/a&gt; which in turn &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/build.xml#L1538-L1541&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;uses batchtest&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Now, if we want to fix that, we need a way to not execute the batchtest and just stick to the test lines of testsome to prevent that double execution, and fail fast. To do so, we need to modify the default filter on &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/build.xml#L1659&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this line&lt;/a&gt; for the batchtest defined on the macro to ignore the run. I can post the PRs for that. Thanks for the clarification!&lt;/p&gt;</comment>
                            <comment id="17532951" author="JIRAUSER285406" created="Fri, 6 May 2022 16:06:11 +0000"  >&lt;p&gt;I posted the 3 PRs&lt;/p&gt;



&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;PR&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1609&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1608&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/1610&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

</comment>
                            <comment id="17533608" author="bereng" created="Mon, 9 May 2022 04:58:49 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bernardo.botella&quot; class=&quot;user-hover&quot; rel=&quot;bernardo.botella&quot;&gt;bernardo.botella&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;thanks for looking into this. But it seems to still be failing:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ant testsome -Dtest.name=PasswordObfuscator*Test

...

testsome:
    [mkdir] Created dir: /tmp/cassandra-CASSANDRA-17083-4.0/build/test/cassandra
    [mkdir] Created dir: /tmp/cassandra-CASSANDRA-17083-4.0/build/test/output
[junit-timeout] Testsuite: PasswordObfuscator*Test
[junit-timeout] Testsuite: PasswordObfuscator*Test Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0 sec
[junit-timeout] 
[junit-timeout] Null Test: 	Caused an ERROR
[junit-timeout] PasswordObfuscator*Test
[junit-timeout] java.lang.ClassNotFoundException: PasswordObfuscator*Test
[junit-timeout] 	at java.net.URLClassLoader.findClass(URLClassLoader.java:387)
[junit-timeout] 	at java.lang.ClassLoader.loadClass(ClassLoader.java:418)
[junit-timeout] 	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:352)
[junit-timeout] 	at java.lang.ClassLoader.loadClass(ClassLoader.java:351)
[junit-timeout] 	at java.lang.Class.forName0(Native Method)
[junit-timeout] 	at java.lang.Class.forName(Class.java:348)
[junit-timeout] 
[junit-timeout] 
[junit-timeout] Test PasswordObfuscator*Test FAILED
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We&apos;d also need a 4.1 branch.&lt;/p&gt;</comment>
                            <comment id="17533855" author="JIRAUSER285406" created="Mon, 9 May 2022 15:26:12 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;bereng&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thanks for following up!&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Yes, it fails as expected (as I mentioned before, the testsome target will need the FQDN passed on the test.name parameter to work). My change is just preventing the double execution that was happening before which is, the batchtest part of the macro AND the test part of the testsome target. With my change, only the test part of the testsome target is executed, and fails because the wildcard is not a valid FQDN. If you still want to execute tests with a wildcard, you can always use the test target instead.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I will post the new change for the 4.1 branch.&lt;/p&gt;</comment>
                            <comment id="17534174" author="bereng" created="Tue, 10 May 2022 06:43:11 +0000"  >&lt;p&gt;Ok icwym. But wdyt about this?&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;diff --git a/build.xml b/build.xml
index 343f7e87a0..b32f5b45b7 100644
--- a/build.xml
+++ b/build.xml
@@ -1656,9 +1656,27 @@
     ant testsome -Dtest.name=org.apache.cassandra.service.StorageServiceServerTest -Dtest.methods=testRegularMode,testGetAllRangesEmpty
   --&amp;gt;
   &amp;lt;target name=&quot;testsome&quot; depends=&quot;build-test&quot; description=&quot;Execute specific unit tests&quot; &amp;gt;
+    &amp;lt;condition property=&quot;withoutMethods&quot;&amp;gt;
+      &amp;lt;and&amp;gt;
+        &amp;lt;equals arg1=&quot;${test.methods}&quot; arg2=&quot;&quot;/&amp;gt;
+        &amp;lt;not&amp;gt;
+          &amp;lt;contains string=&quot;${test.name}&quot; substring=&quot;*&quot;/&amp;gt;
+        &amp;lt;/not&amp;gt;
+      &amp;lt;/and&amp;gt;
+    &amp;lt;/condition&amp;gt;
+    &amp;lt;condition property=&quot;withMethods&quot;&amp;gt;
+      &amp;lt;and&amp;gt;
+        &amp;lt;not&amp;gt;
+         &amp;lt;equals arg1=&quot;${test.methods}&quot; arg2=&quot;&quot;/&amp;gt;
+        &amp;lt;/not&amp;gt;
+        &amp;lt;not&amp;gt;
+          &amp;lt;contains string=&quot;${test.name}&quot; substring=&quot;*&quot;/&amp;gt;
+        &amp;lt;/not&amp;gt;
+      &amp;lt;/and&amp;gt;
+    &amp;lt;/condition&amp;gt;
     &amp;lt;testmacro inputdir=&quot;${test.unit.src}&quot; timeout=&quot;${test.timeout}&quot;&amp;gt;
-      &amp;lt;test unless:blank=&quot;${test.methods}&quot; name=&quot;${test.name}&quot; methods=&quot;${test.methods}&quot; outfile=&quot;build/test/output/TEST-${test.name}-${test.methods}&quot;/&amp;gt;
-      &amp;lt;test if:blank=&quot;${test.methods}&quot; name=&quot;${test.name}&quot; outfile=&quot;build/test/output/TEST-${test.name}&quot;/&amp;gt;
+         &amp;lt;test if=&quot;withMethods&quot; name=&quot;${test.name}&quot; methods=&quot;${test.methods}&quot; outfile=&quot;build/test/output/TEST-${test.name}-${test.methods}&quot;/&amp;gt;
+      &amp;lt;test if=&quot;withoutMethods&quot; name=&quot;${test.name}&quot; outfile=&quot;build/test/output/TEST-${test.name}&quot;/&amp;gt;
       &amp;lt;jvmarg value=&quot;-Dlegacy-sstable-root=${test.data}/legacy-sstables&quot;/&amp;gt;
       &amp;lt;jvmarg value=&quot;-Dinvalid-legacy-sstable-root=${test.data}/invalid-legacy-sstables&quot;/&amp;gt;
       &amp;lt;jvmarg value=&quot;-Dcassandra.ring_delay_ms=1000&quot;/&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Takes a FQDN and doesn&apos;t fail, takes a wildcard running all matching tests and doesn&apos;t fail, also doesn&apos;t do double execution. If I didn&apos;t miss anything this has all the advantages and none of the limitations?&lt;/p&gt;</comment>
                            <comment id="17534414" author="JIRAUSER285406" created="Tue, 10 May 2022 15:34:05 +0000"  >&lt;p&gt;I like the idea of the flexibility that provides, but it comes with a cost. For example, as is, if you pass both a wildcard on the test.name and some test.methods, it will silently ignore the test.methods and may lead to confusion on whoever is trying to run that command. That of course can be checked with yet another set of conditions in the target definition (IF we have have a wildcard AND some test methods, then fail).&#160;&lt;/p&gt;

&lt;p&gt;My issue with this is that the target becomes somehow harder to understand by adding so many conditions and alternative flows, therefore, harder to maintain. Given that we have the alternative of using&#160;&quot;ant test&quot; what do you think about just failing fast if someone tries to use testsome with a wildcard? Something like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/build.xml b/build.xml
index d0466578ac..e65909fe67 100644
--- a/build.xml
+++ b/build.xml
@@ -1656,7 +1656,12 @@
     ant testsome -Dtest.name=org.apache.cassandra.service.StorageServiceServerTest -Dtest.methods=testRegularMode,testGetAllRangesEmpty
   --&amp;gt;
   &amp;lt;target name=&lt;span class=&quot;code-quote&quot;&gt;&quot;testsome&quot;&lt;/span&gt; depends=&lt;span class=&quot;code-quote&quot;&gt;&quot;build-test&quot;&lt;/span&gt; description=&lt;span class=&quot;code-quote&quot;&gt;&quot;Execute specific unit tests&quot;&lt;/span&gt; &amp;gt;
-    &amp;lt;testmacro inputdir=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.unit.src}&quot;&lt;/span&gt; timeout=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.timeout}&quot;&lt;/span&gt;&amp;gt;
+    &amp;lt;fail message=&lt;span class=&quot;code-quote&quot;&gt;&quot;testsome target does not support the use of wildcards. To use wildcards, please use &lt;span class=&quot;code-quote&quot;&gt;&apos;ant test&apos;&lt;/span&gt;.&quot;&lt;/span&gt;&amp;gt;
+      &amp;lt;condition&amp;gt;
+        &amp;lt;contains string=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.name}&quot;&lt;/span&gt; substring=&lt;span class=&quot;code-quote&quot;&gt;&quot;*&quot;&lt;/span&gt;/&amp;gt;
+      &amp;lt;/condition&amp;gt;
+    &amp;lt;/fail&amp;gt;
+    &amp;lt;testmacro inputdir=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.unit.src}&quot;&lt;/span&gt; timeout=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.timeout}&quot;&lt;/span&gt; filter=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.name}&quot;&lt;/span&gt;&amp;gt;
       &amp;lt;test unless:blank=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.methods}&quot;&lt;/span&gt; name=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.name}&quot;&lt;/span&gt; methods=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.methods}&quot;&lt;/span&gt; outfile=&lt;span class=&quot;code-quote&quot;&gt;&quot;build/test/output/TEST-${test.name}-${test.methods}&quot;&lt;/span&gt;/&amp;gt;
       &amp;lt;test &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;:blank=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.methods}&quot;&lt;/span&gt; name=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.name}&quot;&lt;/span&gt; outfile=&lt;span class=&quot;code-quote&quot;&gt;&quot;build/test/output/TEST-${test.name}&quot;&lt;/span&gt;/&amp;gt;
       &amp;lt;jvmarg value=&lt;span class=&quot;code-quote&quot;&gt;&quot;-Dlegacy-sstable-root=${test.data}/legacy-sstables&quot;&lt;/span&gt;/&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I guess it is just a matter of preference at this point, but I find this &quot;fail fast use this alternative instead&quot; approach simple enough and easier to maintain in the long run. In any case, happy to hear your thoughts on this.&lt;/p&gt;</comment>
                            <comment id="17534676" author="bereng" created="Wed, 11 May 2022 05:12:26 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bernardo.botella&quot; class=&quot;user-hover&quot; rel=&quot;bernardo.botella&quot;&gt;bernardo.botella&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;thanks for looking. My preference would be to support wildcards in the test name which is why I opened the ticket in the first place and what I needed at the time. That comes from working on some features like the &lt;tt&gt;View*Test&lt;/tt&gt; family. Going back &amp;amp; forth test/testsome was a pain, I&apos;ve never hit the need to use wildcards in methods and imo 2 simple conditions don&apos;t hit readability, it&apos;s just ant&apos;s syntax being very verbose.&lt;/p&gt;

&lt;p&gt;Let me know if you want to try to put up a PR for trunk, probably my quick &amp;amp; dirty draft can be written more elegantly , or if you prefer me to take over?&lt;/p&gt;

&lt;p&gt;On second thoughts I am going to constrain this to trunk only as it doesn&apos;t seem severe/critical enough/worth it to go disturb branches being released atm :thinking:&lt;/p&gt;</comment>
                            <comment id="17537376" author="bereng" created="Mon, 16 May 2022 07:15:15 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bernardo.botella&quot; class=&quot;user-hover&quot; rel=&quot;bernardo.botella&quot;&gt;bernardo.botella&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;just double checking if you need anything from me here?&lt;/p&gt;</comment>
                            <comment id="17537853" author="JIRAUSER285406" created="Tue, 17 May 2022 00:25:30 +0000"  >&lt;p&gt;Nope, I&apos;ve got everything I need. Sorry for the delay, I&apos;ve been just busy this last week. Will take a shot at it hopefully by tomorrow.&lt;/p&gt;</comment>
                            <comment id="17537952" author="bereng" created="Tue, 17 May 2022 05:46:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bernardo.botella&quot; class=&quot;user-hover&quot; rel=&quot;bernardo.botella&quot;&gt;bernardo.botella&lt;/a&gt; please take the time you need, no hurries. I was doing my sort of weekly check on tickets to make sure I wasn&apos;t blocking anything &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Take all the time you need.&lt;/p&gt;</comment>
                            <comment id="17545818" author="bereng" created="Fri, 3 Jun 2022 09:49:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bernardo.botella&quot; class=&quot;user-hover&quot; rel=&quot;bernardo.botella&quot;&gt;bernardo.botella&lt;/a&gt; I was going around trying to close loose ends I had on my list. I created a PR &lt;a href=&quot;https://github.com/apache/cassandra/pull/1665&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; with the suggested changes. Again feel free to disagree or suggest changes. But if we&apos;re not against these going in we could merge them and then open a new ticket for any improvements you have in your mind. These are always welcomed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Wdyt?&lt;/p&gt;</comment>
                            <comment id="17553897" author="bereng" created="Tue, 14 Jun 2022 05:22:44 +0000"  >&lt;p&gt;Hi, moving this to review for the small original fix just to close loose ends. We can always open a new ticket for any further improvements which are always welcomed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17556908" author="brandon.williams" created="Tue, 21 Jun 2022 13:29:36 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17557243" author="bereng" created="Wed, 22 Jun 2022 05:16:50 +0000"  >&lt;p&gt;Thx &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bernardo.botella&quot; class=&quot;user-hover&quot; rel=&quot;bernardo.botella&quot;&gt;bernardo.botella&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; for your help here &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                                                <inwardlinks description="Discovered while testing">
                                        <issuelink>
            <issuekey id="13408819">CASSANDRA-17070</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bereng]]></customfieldvalue>
        <customfieldvalue><![CDATA[bernardo.botella]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 20 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0w9ww:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12336842">4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/92069ec0932774357f5a7babaf3ec28ca1255286&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/92069ec0932774357f5a7babaf3ec28ca1255286&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;See PR&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>