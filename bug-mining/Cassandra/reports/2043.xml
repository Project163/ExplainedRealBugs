<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:37:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-4916] Starting Cassandra throws EOF while reading saved cache</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-4916</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Currently seeing nodes throw an EOF while reading a saved cache on the system schema when starting cassandra&lt;/p&gt;

&lt;p&gt; WARN 14:25:54,896 error reading saved cache /ssd/saved_caches/system-schema_columns-KeyCache-b.db&lt;br/&gt;
java.io.EOFException&lt;br/&gt;
	at java.io.DataInputStream.readInt(DataInputStream.java:392)&lt;br/&gt;
	at org.apache.cassandra.utils.ByteBufferUtil.readWithLength(ByteBufferUtil.java:349)&lt;br/&gt;
	at org.apache.cassandra.service.CacheService$KeyCacheSerializer.deserialize(CacheService.java:378)&lt;br/&gt;
	at org.apache.cassandra.cache.AutoSavingCache.loadSaved(AutoSavingCache.java:144)&lt;br/&gt;
	at org.apache.cassandra.db.ColumnFamilyStore.&amp;lt;init&amp;gt;(ColumnFamilyStore.java:278)&lt;br/&gt;
	at org.apache.cassandra.db.ColumnFamilyStore.createColumnFamilyStore(ColumnFamilyStore.java:393)&lt;br/&gt;
	at org.apache.cassandra.db.ColumnFamilyStore.createColumnFamilyStore(ColumnFamilyStore.java:365)&lt;br/&gt;
	at org.apache.cassandra.db.Table.initCf(Table.java:334)&lt;br/&gt;
	at org.apache.cassandra.db.Table.&amp;lt;init&amp;gt;(Table.java:272)&lt;br/&gt;
	at org.apache.cassandra.db.Table.open(Table.java:102)&lt;br/&gt;
	at org.apache.cassandra.db.Table.open(Table.java:80)&lt;br/&gt;
	at org.apache.cassandra.db.SystemTable.checkHealth(SystemTable.java:320)&lt;br/&gt;
	at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:203)&lt;br/&gt;
	at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:395)&lt;br/&gt;
	at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:438)&lt;/p&gt;


&lt;p&gt;to reproduce delete all data files, start a cluster, leave cluster up long enough to build a cache. nodetool drain, kill cassandra process. start cassandra process in foreground and note EOF thrown (see above for stack trace)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12614862">CASSANDRA-4916</key>
            <summary>Starting Cassandra throws EOF while reading saved cache</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dbrosius">David Brosius</assignee>
                                    <reporter username="mkjellman">Michael Kjellman</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 Nov 2012 22:28:51 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:23 +0000</updated>
                            <resolved>Tue, 8 Jan 2013 05:21:39 +0000</resolved>
                                        <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13495738" author="jbellis" created="Mon, 12 Nov 2012 23:17:02 +0000"  >&lt;p&gt;Wouldn&apos;t be the first time I&apos;ve seen InputStream.available lie.  But we don&apos;t want to write the number of items in the cache at the start of the file (the approach we usually take) because that would require making a copy of the cache&apos;s keySet which might be more memory than we can afford.&lt;/p&gt;

&lt;p&gt;Suggested workarounds: write some kind of EOF value when we&apos;re done instead of just closing the file, and check for that on read.  Alternatively, just catch the EOF and log it at debug; a partially-read cache is harmless.&lt;/p&gt;</comment>
                            <comment id="13495983" author="jbellis" created="Tue, 13 Nov 2012 05:58:53 +0000"  >&lt;p&gt;Michael, can you test Dave&apos;s patch?&lt;/p&gt;</comment>
                            <comment id="13495987" author="dbrosius" created="Tue, 13 Nov 2012 06:14:36 +0000"  >&lt;p&gt;oops fix formatting&lt;/p&gt;</comment>
                            <comment id="13496291" author="mkjellman" created="Tue, 13 Nov 2012 16:12:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbellis&quot; class=&quot;user-hover&quot; rel=&quot;jbellis&quot;&gt;jbellis&lt;/a&gt; yes, will test now&lt;/p&gt;</comment>
                            <comment id="13496534" author="mkjellman" created="Tue, 13 Nov 2012 20:59:25 +0000"  >&lt;p&gt;patch looks good. Ship it!&lt;/p&gt;</comment>
                            <comment id="13546615" author="dbrosius" created="Tue, 8 Jan 2013 05:21:32 +0000"  >&lt;p&gt;committed to trunk as 1d641f5111613a5a049042a8723d0dd9ffc29c02&lt;/p&gt;</comment>
                            <comment id="13577276" author="drew_kutchar" created="Wed, 13 Feb 2013 01:59:58 +0000"  >&lt;p&gt;I just saw this same exception happen on Cassandra 1.2.1. Was this part of the 1.2.1 release?&lt;br/&gt;
I&apos;m on Mac OS X 10.8.2, Oracle JDK 1.7.0_11, using snappy-java 1.0.5-M3 from Maven (not sure if that&apos;s the cause).&lt;/p&gt;

&lt;p&gt;I&apos;m attaching my data and log directory as data.zip.&lt;/p&gt;</comment>
                            <comment id="13581890" author="dbrosius" created="Wed, 20 Feb 2013 02:36:19 +0000"  >&lt;p&gt;no mistakenly only applied to trunk... It is now applied to the cassandra-1.2 branch&lt;/p&gt;</comment>
                            <comment id="13581969" author="jbellis" created="Wed, 20 Feb 2013 05:30:51 +0000"  >&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12632291">CASSANDRA-5252</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12632384">CASSANDRA-5253</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12632291">CASSANDRA-5252</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12553274" name="4916.txt" size="5846" author="dbrosius" created="Tue, 13 Nov 2012 06:14:36 +0000"/>
                            <attachment id="12569138" name="data.zip" size="258276" author="drew_kutchar" created="Wed, 13 Feb 2013 02:00:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[dbrosius]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>255360</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 39 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0eran:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>84184</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>