<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:18:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-16213] Cannot replace_address /X because it doesn&apos;t exist in gossip</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-16213</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;We see this exception around nodes crashing and trying to do a host replacement; this error appears to be correlated around multiple node failures.&lt;/p&gt;

&lt;p&gt;A simplified case to trigger this is the following&lt;/p&gt;

&lt;p&gt;*) Have a N node cluster&lt;br/&gt;
*) Shutdown all N nodes&lt;br/&gt;
*) Bring up N-1 nodes (at least 1 seed, else replace seed)&lt;br/&gt;
*) Host replace the N-1th node -&amp;gt; this will fail with the above&lt;/p&gt;

&lt;p&gt;The reason this happens is that the N-1th node isn&#8217;t gossiping anymore, and the existing nodes do not have its details in gossip (but have the details in the peers table), so the host replacement fails as the node isn&#8217;t known in gossip.&lt;/p&gt;

&lt;p&gt;This affects all versions (tested 3.0 and trunk, assume 2.2 as well)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13335664">CASSANDRA-16213</key>
            <summary>Cannot replace_address /X because it doesn&apos;t exist in gossip</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dcapwell">David Capwell</assignee>
                                    <reporter username="dcapwell">David Capwell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 Oct 2020 19:11:56 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:54 +0000</updated>
                            <resolved>Tue, 15 Dec 2020 22:55:02 +0000</resolved>
                                        <fixVersion>4.0-beta4</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Cluster/Gossip</component>
                    <component>Cluster/Membership</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17214935" author="brandon.williams" created="Thu, 15 Oct 2020 19:23:40 +0000"  >&lt;p&gt;This affects all versions since the inception of replacement.  If you shutdown the entire ring in non-rolling fashion then it is no surprise that any gossip state not persisted (and specific to an existing live node, which will repopulate it) will be lost.  You can no longer replace as a consequence. A node injecting states that don&apos;t belong to itself is generally forbidden as it is dangerous, with the except that proves the rule be assassinate (which also sleeps to careful.)  No node should need to know about any dead states upon a full ring restart,  with the exception of replacement.&lt;/p&gt;
</comment>
                            <comment id="17214963" author="dcapwell" created="Thu, 15 Oct 2020 19:50:40 +0000"  >&lt;p&gt;Thanks for the replay &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If you shutdown the entire ring in non-rolling fashion then it is no surprise&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We see this in rolling fashion as well, full cluster was easier to reproduce; so the issue isn&apos;t isolated to full cluster outage.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;You can no longer replace as a consequence&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;What is the recommendation in these cases?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;A node injecting states that don&apos;t belong to itself is generally forbidden as it is dangerous&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In the case I call out we don&apos;t add the node to the ring, but we do add it to gossip, see &lt;a href=&quot;https://github.com/apache/cassandra/blob/699a1f74fcc1da1952da6b2b0309c9e2474c67f4/src/java/org/apache/cassandra/gms/Gossiper.java#L1754-L1780&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/699a1f74fcc1da1952da6b2b0309c9e2474c67f4/src/java/org/apache/cassandra/gms/Gossiper.java#L1754-L1780&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We will try to evict it from gossip (see &lt;a href=&quot;https://github.com/apache/cassandra/blob/699a1f74fcc1da1952da6b2b0309c9e2474c67f4/src/java/org/apache/cassandra/gms/Gossiper.java#L960-L969&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/699a1f74fcc1da1952da6b2b0309c9e2474c67f4/src/java/org/apache/cassandra/gms/Gossiper.java#L960-L969&lt;/a&gt;), but we also see in the wild that this eviction doesn&apos;t happen and it stays there forever; here is a sample from gossipinfo on a real cluster&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/&amp;lt;ip&amp;gt;
  generation:0
  heartbeat:0
  TOKENS: not present
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="17214966" author="dcapwell" created="Thu, 15 Oct 2020 19:54:08 +0000"  >&lt;p&gt;Sorry, I misspoke, on startup we do add it back into the ring, see &lt;a href=&quot;https://github.com/apache/cassandra/blob/699a1f74fcc1da1952da6b2b0309c9e2474c67f4/src/java/org/apache/cassandra/service/StorageService.java#L604-L617&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/699a1f74fcc1da1952da6b2b0309c9e2474c67f4/src/java/org/apache/cassandra/service/StorageService.java#L604-L617&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;So currently, each node will add it back into the ring, and will add it back into gossip.&lt;/p&gt;</comment>
                            <comment id="17214972" author="dcapwell" created="Thu, 15 Oct 2020 20:01:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt;. Brandon told me in slack you would be a good person to review as well, would you be able to?&lt;/p&gt;</comment>
                            <comment id="17220413" author="paulo" created="Sun, 25 Oct 2020 23:20:35 +0000"  >&lt;p&gt;Overall I like the proposed approach, I would just limit propagating state about the downed host &lt;b&gt;only&lt;/b&gt; during shadow gossip response (and &lt;b&gt;not&lt;/b&gt; during normal gossip) to limit the potential surface area of this change. I think we should extract the shadow gossip response from &lt;tt&gt;examineGossiper&lt;/tt&gt; to make this cleaner.&lt;/p&gt;

&lt;p&gt;A natural consequence of this is that we will never need to handle the state &quot;UNKNOWN&quot; on &lt;tt&gt;StorageService.onChange&lt;/tt&gt; so it would be nice to add an assertion there if we ever get a notification about this change on a live node.&lt;/p&gt;

&lt;p&gt;I like the tests but I&apos;m not very familiar with in-jvm dtest infrastructure so it would be nice to get a pair of eyes on that to make sure the framework changes look good.&lt;/p&gt;</comment>
                            <comment id="17220881" author="dcapwell" created="Mon, 26 Oct 2020 18:10:17 +0000"  >&lt;p&gt;Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I would just limit propagating state about the downed host only during shadow gossip response&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I will test this out&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I&apos;m not very familiar with in-jvm dtest infrastructure so it would be nice to get a pair of eyes on that to make sure the framework changes look good.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agree.  Jvm-dtest forked a lot of CassandraDaemon so took a while to make sure the logic matched, this was a good chunk of this patch =(.&lt;/p&gt;</comment>
                            <comment id="17223882" author="dcapwell" created="Fri, 30 Oct 2020 20:45:52 +0000"  >&lt;p&gt;Started down the path of only modifying shadow round and hitting a wall.&lt;/p&gt;

&lt;p&gt;When we are starting a fresh host, we do not have anything in the peers table, so we do not populate TokenMetadata and rely on gossip, but we only rely on normal gossip and not shadow gossip for this.  I tried notifying StorageService about the shadow round but it fails as it polls Gossiper for endpointStateMap, which won&apos;t have this data.  I can try to refactor storage service, or populate endpointStateMap when shadow round completes...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt; is this what you had in mind?  Seeing that shadow round is mostly ignored, so would need to change this in order to isolate to that.&lt;/p&gt;
</comment>
                            <comment id="17223916" author="dcapwell" created="Fri, 30 Oct 2020 21:22:25 +0000"  >&lt;p&gt;I made the changes pass in &lt;a href=&quot;https://github.com/dcapwell/cassandra/commit/e7af378ce4b491d0126b6d9f67b746e2d62ff19a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/dcapwell/cassandra/commit/e7af378ce4b491d0126b6d9f67b746e2d62ff19a&lt;/a&gt;, but not a fan of this change&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;storage service registers early&lt;/li&gt;
	&lt;li&gt;we apply the shadow round state to the gossip state&lt;/li&gt;
	&lt;li&gt;removed &apos;unknown&apos;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17224346" author="paulo" created="Sun, 1 Nov 2020 22:23:10 +0000"  >&lt;p&gt;Thanks, added some comments to the commit. Please let me know what do you think.&lt;/p&gt;</comment>
                            <comment id="17225015" author="dcapwell" created="Tue, 3 Nov 2020 00:02:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt; and I chatted in GH and slack, dumping a summary here.&lt;/p&gt;

&lt;p&gt;1) shadow round will now return these &quot;empty&quot; states, but these states do NOT have the status state defined&lt;br/&gt;
2) the receiver side will now see these empty states and check a flag to see if it should handle this case or fall back to previous state&lt;br/&gt;
3) if true, then apply just the endpoint state to gossip then call org.apache.cassandra.service.StorageService#handleStateNormal&lt;br/&gt;
4) added logic to reject nodes with specific gossip states from being replaced, and added flags to alter and/or disable this behavior&lt;br/&gt;
5) when gossiping, the &quot;empty&quot; states will be filtered out and not sent around (to match previous logic).&lt;/p&gt;

&lt;p&gt;the empty state is defined as the following&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
heartbeat version = -1
applicationState does NOT contain STATUS_WITH_PORT or STATUS
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I have cleaned up the code and made the changes; code is ready to review again.&lt;/p&gt;</comment>
                            <comment id="17225842" author="edimitrova" created="Wed, 4 Nov 2020 04:39:46 +0000"  >&lt;p&gt;I left a few small comments/questions on the CASSANDRA_RELEVANT_PROPERTIES&apos; new methods, as per request. I see you already have two reviewers committers but let me know if you want me to do a review of the full ticket.&#160;&lt;/p&gt;</comment>
                            <comment id="17228291" author="paulo" created="Sun, 8 Nov 2020 21:56:40 +0000"  >&lt;p&gt;Thanks for the update &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;. I think 5) is not required as endpoint states with heartbeat version -1 need not be sent by &lt;tt&gt;examineGossiper&lt;/tt&gt;, just by &lt;tt&gt;examineShadowState&lt;/tt&gt; where all states are sent. I made this update &lt;a href=&quot;https://github.com/dcapwell/cassandra/pull/1/commits/35802d68c6fa195a93b92e7bc779d3d8c94f07e6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;on this commit&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I don&apos;t think we need the property &lt;tt&gt;cassandra.allow_non_normal_replace_address&lt;/tt&gt; is needed since we can achieve this via the property &lt;tt&gt;cassandra.replacement_allowed_gossip_statuses&lt;/tt&gt;, so I removed it &lt;a href=&quot;https://github.com/dcapwell/cassandra/pull/1/commits/8f23a70948ef020dba222cfb80a21e2d5322c672&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;on this commit&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I opened &lt;a href=&quot;https://github.com/dcapwell/cassandra/pull/1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this PR&lt;/a&gt; to your branch with these suggestions and some other minor nits.&lt;/p&gt;

&lt;p&gt;As far as I understood &lt;tt&gt;HostReplacementOfDowedClusterTest.hostReplacementOfDeadNode&lt;/tt&gt; tests an orderly shutdown, that is, when the node announces it&apos;s going to leave the cluster by broadcasting the shutdown state. Can we maybe also test with an abrupt shutdown, that is when the shutdown state is not broadcast and the node to be replaced is on NORMAL state?&lt;/p&gt;

&lt;p&gt;Other than that, this patch looks good to me.&lt;/p&gt;</comment>
                            <comment id="17228747" author="dcapwell" created="Mon, 9 Nov 2020 17:55:09 +0000"  >&lt;p&gt;Thanks for the feedback&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;not required as endpoint states with heartbeat version -1 need not be sent by examineGossiper&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think that was important for assassinate, so will try to look closer at your patch and how it works with assassinate&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;HostReplacementOfDowedClusterTest.hostReplacementOfDeadNode tests an orderly shutdown, ... Can we maybe also test with an abrupt shutdown, that is when the shutdown state is not broadcast and the node to be replaced is on NORMAL state?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Makes a lot of sense, I can try working on this test (I assume I can just block gossip messages as I can&apos;t kill -9 in jvm-dtest).&lt;/p&gt;</comment>
                            <comment id="17231097" author="dcapwell" created="Fri, 13 Nov 2020 02:10:35 +0000"  >&lt;p&gt;I have been working on the test but its flaky; half the time it passes, the other half it acts like an infinite loop waiting on schema during bootstrap...  trying to figure out what&apos;s going on there, though it does look unrelated to the patch (all the nodes expected in gossip are present).&lt;/p&gt;</comment>
                            <comment id="17231736" author="dcapwell" created="Fri, 13 Nov 2020 18:29:12 +0000"  >&lt;p&gt;Found the issue, it was caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15158&quot; title=&quot;Wait for schema agreement rather than in flight schema requests when bootstrapping&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15158&quot;&gt;&lt;del&gt;CASSANDRA-15158&lt;/del&gt;&lt;/a&gt; where it creates a config of milliseconds, calls a delay which takes milliseconds, but converts the mills as if they were seconds, causing a much longer delay than expected.&lt;/p&gt;

&lt;p&gt;Once I fix that I then hit the next issue, we now block waiting on schema which will fail since it has a downed node.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; SCHEMA:
                        SystemKeyspace.updatePeerInfo(endpoint, &lt;span class=&quot;code-quote&quot;&gt;&quot;schema_version&quot;&lt;/span&gt;, UUID.fromString(value.value));
                        MigrationCoordinator.instance.reportEndpointVersion(endpoint, UUID.fromString(value.value));
                        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; schemasReceived = MigrationCoordinator.instance.awaitSchemaRequests(SCHEMA_DELAY_MILLIS);

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (schemasReceived)
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;

        logger.warn(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;There are nodes in the cluster with a different schema version than us we did not merged schemas from, &quot;&lt;/span&gt; +
                                  &lt;span class=&quot;code-quote&quot;&gt;&quot;our version : (%s), outstanding versions -&amp;gt; endpoints : %s&quot;&lt;/span&gt;,
                                  Schema.instance.getVersion(),
                                  MigrationCoordinator.instance.outstandingVersions()));

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (REQUIRE_SCHEMAS)
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Didn&apos;t receive schemas &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all known versions within the timeout&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;when we get the gossip info from the peers it will have node2 (the node that crashed abruptly) and wait until it gets the schema, but this won&apos;t happen since node2 is down and we are replacing it.&lt;/p&gt;

&lt;p&gt;This looks unrelated to this patch, but also is a bad condition as any schema change with a downed node will cause nodes to fail to start up...&lt;/p&gt;</comment>
                            <comment id="17231767" author="dcapwell" created="Fri, 13 Nov 2020 19:01:08 +0000"  >&lt;p&gt;I plan to fix the schema wait logic in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15158?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=17231757#comment-17231757&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-15158?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=17231757#comment-17231757&lt;/a&gt; to keep this patch clean of it, but for the moment the logic is in this branch to get a stable test.&lt;/p&gt;</comment>
                            <comment id="17231832" author="dcapwell" created="Fri, 13 Nov 2020 21:12:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt;&#160;added the test and rebased to latest trunk as 2 recent commits impact this logic.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I am going to run the tests in a loop to make sure they are not flaky, if they are will split the class files or change the bootstrap schema properties.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The last thing on my plate is to validate assassinate; forgot to do this.&lt;/p&gt;</comment>
                            <comment id="17231934" author="dcapwell" created="Sat, 14 Nov 2020 05:01:48 +0000"  >&lt;p&gt;Finished assassinate and made sure to flesh out the different cases I could see. &#160;org.apache.cassandra.gms.EndpointState#isEmpty does need to check for status in order for assassinate with this patch.&lt;/p&gt;

&lt;p&gt;If you stop all nodes and bring up all but the host to remove, then assassinate the node to remove, it will still be &quot;empty&quot; based off version, but will have a status. &#160;If we do not check the status when we check for empty, we would then treat this endpoint as normal and move on, which isn&apos;t correct as its in the LEFT state.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt;&#160;I added&#160;org.apache.cassandra.distributed.test.hostreplacement.AssassinatedEmptyNodeTest to flesh this case out if you want to take a closer look. EndpointState.isEmpty is only use in one spot now since we removed the filter, so feel its still best to check the state to make sure it is this specific case.&lt;/p&gt;</comment>
                            <comment id="17233070" author="dcapwell" created="Mon, 16 Nov 2020 20:56:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt;&#160;the patch should be ready to review again.&lt;/p&gt;</comment>
                            <comment id="17233571" author="paulo" created="Tue, 17 Nov 2020 13:08:08 +0000"  >&lt;p&gt;Thanks! I&apos;ll take another look this week.&lt;/p&gt;</comment>
                            <comment id="17238836" author="beobal" created="Wed, 25 Nov 2020 17:32:00 +0000"  >&lt;p&gt;Sorry I&apos;m a bit late to the party here.&lt;/p&gt;

&lt;p&gt;I think the general approach of using the shadow round to learn persisted peer info about a down host is sound, but I believe this implementation is a bit overcomplicated. I don&apos;t think we need to modify the behaviour of assassinate or make any changes regarding which &lt;tt&gt;STATUS&lt;/tt&gt; we can replace.&lt;/p&gt;

&lt;p&gt;I&apos;ve pushed a simplified version here: &lt;a href=&quot;https://github.com/beobal/cassandra/tree/beobal/16213-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/beobal/cassandra/tree/beobal/16213-trunk&lt;/a&gt; (I kept all your tests, but removed the fix from the first commit).&lt;br/&gt;
 It doesn&apos;t currently pass your new dtests, but I think that&apos;s mostly to do with the expectations being specific to your implementation. I&apos;ve checked that all the scenarios your tests cover work as expected using ccm clusters. Also, aside from the fix for replacing down nodes, all other behaviour is the same as current trunk wrt assasinate, eviction of fat clients etc.&lt;/p&gt;

&lt;p&gt;I&apos;ll try and dig into the dtests this week and update them.&lt;/p&gt;</comment>
                            <comment id="17240385" author="paulo" created="Sun, 29 Nov 2020 22:52:40 +0000"  >&lt;p&gt;I really like the alternative implementation and descriptive comments. I&apos;d just extract the shadow round response logic to its own method (ie.&#160;&lt;tt&gt;replyShadowRound&lt;/tt&gt; vs &lt;tt&gt;examineGossiper)&lt;/tt&gt; as done in the previous implementation since they don&apos;t have a lot in common. Maybe add debug logs when gossip state is injected during replace or returned during shadow round response to make it easier to debug this if someone run into issues. Also, make sure to remove the new properties added to&#160;&lt;tt&gt;CassandraRelevantProperties&lt;/tt&gt; in the previous implementation.&lt;/p&gt;</comment>
                            <comment id="17240979" author="dcapwell" created="Mon, 30 Nov 2020 19:00:47 +0000"  >&lt;p&gt;Thanks sam for the review, ill try to look closer at your changes as the original logic is no longer fresh in my head, will try to replay later today, if not then tomorrow.&lt;/p&gt;</comment>
                            <comment id="17241059" author="dcapwell" created="Mon, 30 Nov 2020 21:20:59 +0000"  >&lt;p&gt;I left comments on the commit &lt;a href=&quot;https://github.com/beobal/cassandra/commit/b33d3aaf01326e49bacda2410c0fa6fc17677ae5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/beobal/cassandra/commit/b33d3aaf01326e49bacda2410c0fa6fc17677ae5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To summarize I think these are the following changes&lt;/p&gt;

&lt;p&gt;1) size of the patch&lt;br/&gt;
2) avoid injecting the host_id + token on startup, but keep the &quot;empty&quot; node in gossip as is.  On shadow round, query table to repopulate this in order to reply&lt;br/&gt;
3) removed the allowed state logic&lt;/p&gt;

&lt;p&gt;For #1 it looks like this is only done by removing the explicit &quot;empty&quot; flags and replaced access with logic which tries to detect it based off symptoms (generation and version == 0, absents from gossip, etc.).  I personally feel this logic is justifiable as it makes it easy to see how/where we handle the logic, by scattering the handling it gets harder to see how its handled.&lt;/p&gt;

&lt;p&gt;For #2 I am not sure why, would love to hear from you on what you are thinking.  I do love the extra comments but it isn&apos;t clear the motivation between the two versions.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt; thanks for the review.  If it helps we can chat on slack tomorrow (or when you are free) and can summaries here after.&lt;/p&gt;</comment>
                            <comment id="17241760" author="dcapwell" created="Tue, 1 Dec 2020 18:24:24 +0000"  >&lt;p&gt;booo... rebased and now getting &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception: java.lang.OutOfMemoryError thrown from the UncaughtExceptionHandler in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;node2_COMMIT-LOG-WRITER&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Looks like &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16212&quot; title=&quot;Cassandra version above 3.11.0 failing for ARM64 &quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16212&quot;&gt;&lt;del&gt;CASSANDRA-16212&lt;/del&gt;&lt;/a&gt; isn&apos;t fixed yet so will need to disable metaspace cleaning when running the test (CI does this but not IntelliJ)&lt;/p&gt;</comment>
                            <comment id="17241853" author="dcapwell" created="Tue, 1 Dec 2020 20:40:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt; pushed changes based off your version.  I made a few changes (we spoke in slack about them)&lt;br/&gt;
1) rather than modify the block which checks the downed host is &quot;old enough&quot;, we inject the node while doing prepare; this keeps the logic centralized&lt;br/&gt;
2) keep the isEmpty logic and flag to enable/disable this feature.  If feature is disabled then this patch has no affect (outside of shadow round sending empty).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt; would be good to get your eyes as well!&lt;/p&gt;</comment>
                            <comment id="17241860" author="dcapwell" created="Tue, 1 Dec 2020 20:48:00 +0000"  >&lt;p&gt;To keep history clear for review, I split each change into different commits&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;removed blocking replace on state: &lt;a href=&quot;https://github.com/apache/cassandra/pull/780/commits/ebc844428d928789835f2a839ebbe1230aed68fd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/780/commits/ebc844428d928789835f2a839ebbe1230aed68fd&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;load token/host_id lazy during shadow round rather than startup: &lt;a href=&quot;https://github.com/apache/cassandra/pull/780/commits/748d437028843de50b0e271cdacec4dfd27af2df&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/780/commits/748d437028843de50b0e271cdacec4dfd27af2df&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;host replacement no longer injects a &quot;normal&quot; state transition, but updates token metadata and gossip state explicitly: &lt;a href=&quot;https://github.com/apache/cassandra/pull/780/commits/650a3541da65a367cbce8a623e040c2f4776f23f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/780/commits/650a3541da65a367cbce8a623e040c2f4776f23f&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17243453" author="dcapwell" created="Thu, 3 Dec 2020 19:07:17 +0000"  >&lt;p&gt;rebased to trunk, which fixed some of the test failures.  ATM the build is clean (minus the streaming test, but that is known)&lt;/p&gt;</comment>
                            <comment id="17243602" author="jmeredithco" created="Fri, 4 Dec 2020 00:30:41 +0000"  >&lt;p&gt;Posted a review.&lt;/p&gt;

&lt;p&gt;I&apos;m chasing down a second&#160;related issue if multiple nodes are starting up with &lt;tt&gt;replace_address_first_boot&lt;/tt&gt; at the same time and one of the replacement nodes is also marked as a seed for the others.  Seems to be the root cause of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16159&quot; title=&quot;Concurrent host replacements can exchange incomplete gossip state if one is a seed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16159&quot;&gt;CASSANDRA-16159&lt;/a&gt; so will handle on that ticket.&lt;/p&gt;</comment>
                            <comment id="17244160" author="jmeredithco" created="Fri, 4 Dec 2020 17:40:53 +0000"  >&lt;p&gt;Thanks for addressing nits. &#160;+1 from me.&lt;/p&gt;</comment>
                            <comment id="17244284" author="brandon.williams" created="Fri, 4 Dec 2020 20:54:11 +0000"  >&lt;p&gt;Finally got this all straight in my head again (I think.) LGTM, +1.&lt;/p&gt;</comment>
                            <comment id="17244295" author="dcapwell" created="Fri, 4 Dec 2020 21:38:28 +0000"  >&lt;p&gt;Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&#160;and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmeredithco&quot; class=&quot;user-hover&quot; rel=&quot;jmeredithco&quot;&gt;jmeredithco&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="17245458" author="beobal" created="Mon, 7 Dec 2020 19:04:29 +0000"  >&lt;p&gt;+1 from me too, thanks for incorporating my suggestions.&lt;/p&gt;

&lt;p&gt;Nit typo: &lt;tt&gt;HostReplacementOfDowedClusterTest&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17245464" author="dcapwell" created="Mon, 7 Dec 2020 19:27:49 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Will wait for &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt; to review.&lt;/p&gt;</comment>
                            <comment id="17245983" author="paulo" created="Tue, 8 Dec 2020 16:36:11 +0000"  >&lt;p&gt;Just a heads up that I&apos;ll take a final look at this tomorrow.&lt;/p&gt;</comment>
                            <comment id="17249377" author="paulo" created="Mon, 14 Dec 2020 22:58:55 +0000"  >&lt;p&gt;Sorry for the delay. Approved PR with one minor nit.&lt;/p&gt;

&lt;p&gt;One last thing I wanted to discuss before we commit is if we need the &lt;tt&gt;cassandra.allow_empty_replace_address&lt;/tt&gt; property defaulting to false, now that we have the collision check in place. I think it should be pretty safe to have this enabled by default, or even remove this knob altogether, since it&apos;s the correct behavior and I don&apos;t see where it can be useful to have it disabled.&lt;/p&gt;</comment>
                            <comment id="17249435" author="dcapwell" created="Tue, 15 Dec 2020 01:43:31 +0000"  >&lt;p&gt;Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think it should be pretty safe to have this enabled by default&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;For our environment, the plan is to default to true, so I am ok with this. Another option is to default this to false for now and after &quot;some time&quot; we change the default to true... the hard part is when &quot;some time&quot; is as this is super edge case-y (small number of times within a year).&lt;/p&gt;

&lt;p&gt;Ill leave this open for now, give time for &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt; to comment as well.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;or even remove this knob altogether&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I am a fan of feature flags, so rather keep it to revert back if there is ever seen a reason to.&lt;/p&gt;</comment>
                            <comment id="17249805" author="beobal" created="Tue, 15 Dec 2020 17:22:56 +0000"  >&lt;p&gt;+1 to keeping the flag and defaulting it to true.&lt;/p&gt;</comment>
                            <comment id="17249815" author="dcapwell" created="Tue, 15 Dec 2020 17:40:12 +0000"  >&lt;p&gt;Thanks for the feedback, ill keep the flag and switch to true.&lt;/p&gt;</comment>
                            <comment id="17249911" author="dcapwell" created="Tue, 15 Dec 2020 20:13:38 +0000"  >&lt;p&gt;Starting commit&lt;/p&gt;

&lt;p&gt;CI Results (pending):&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Source&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Circle CI&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Jenkins&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;trunk&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/dcapwell/cassandra/tree/commit_remote_branch/CASSANDRA-16213-trunk-699BF5AE-697A-4899-A74F-38E44BCB85C7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/dcapwell/cassandra?branch=commit_remote_branch%2FCASSANDRA-16213-trunk-699BF5AE-697A-4899-A74F-38E44BCB85C7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-devbranch/269/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;build&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17250004" author="dcapwell" created="Tue, 15 Dec 2020 22:55:02 +0000"  >&lt;p&gt;Thanks all for the review!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[dcapwell]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12983" cascade-level=""><![CDATA[Availability]]></customfieldvalue>
                                <customfieldvalue key="12994" cascade-level="1"><![CDATA[Unavailable]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12966"><![CDATA[Challenging]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 48 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0jqow:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
        <customfieldvalue><![CDATA[jmeredithco]]></customfieldvalue>
        <customfieldvalue><![CDATA[paulo]]></customfieldvalue>
        <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324629">2.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/d61710d5b2623f0c1ebf4dbcbfaaf6c8d3a3ab91&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/d61710d5b2623f0c1ebf4dbcbfaaf6c8d3a3ab91&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;tests added&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>