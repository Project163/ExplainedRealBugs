<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:35:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-4594] COPY TO and COPY FROM don&apos;t default to consistent ordering of columns</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-4594</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Here is the input:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                                                         
CREATE KEYSPACE test WITH strategy_class = &lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt; AND strategy_options:replication_factor = 1;
USE test;                                                                       
                                                                                
CREATE TABLE airplanes (                                                        
                name text PRIMARY KEY,                                          
                manufacturer ascii,                                             
                year &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,                                                       
                mach &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;                                                      
            );                                                                  
                                                                                
INSERT INTO airplanes (name, manufacturer, year, mach) VALUES (&lt;span class=&quot;code-quote&quot;&gt;&apos;P38-Lightning&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;Lockheed&apos;&lt;/span&gt;, 1937, &lt;span class=&quot;code-quote&quot;&gt;&apos;.7&apos;&lt;/span&gt;);
                                                                                
COPY airplanes TO &lt;span class=&quot;code-quote&quot;&gt;&apos;temp.cfg&apos;&lt;/span&gt; WITH HEADER=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;                                  
                                                                                
TRUNCATE airplanes;                                                                
                                                                                   
COPY airplanes FROM &lt;span class=&quot;code-quote&quot;&gt;&apos;temp.cfg&apos;&lt;/span&gt; WITH HEADER=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;                                
                                                                                   
SELECT * FROM airplanes;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is what happens when executed. Note how it tried to import the float into the int column:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh:test&amp;gt; DROP KEYSPACE test;                                                                
cqlsh:test&amp;gt; CREATE KEYSPACE test WITH strategy_class = &lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt; AND strategy_options:replication_factor = 1;
cqlsh:test&amp;gt; USE test;                                                                       
cqlsh:test&amp;gt;                                                                                    
cqlsh:test&amp;gt; CREATE TABLE airplanes (                                            
        ...                 name text PRIMARY KEY,                              
        ...                 manufacturer ascii,                                 
        ...                 year &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,                                           
        ...                 mach &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;                                          
        ...             );                                                      
cqlsh:test&amp;gt;                                                                     
cqlsh:test&amp;gt; INSERT INTO airplanes (name, manufacturer, year, mach) VALUES (&lt;span class=&quot;code-quote&quot;&gt;&apos;P38-Lightning&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;Lockheed&apos;&lt;/span&gt;, 1937, &lt;span class=&quot;code-quote&quot;&gt;&apos;.7&apos;&lt;/span&gt;);
cqlsh:test&amp;gt;                                                                     
cqlsh:test&amp;gt; COPY airplanes TO &lt;span class=&quot;code-quote&quot;&gt;&apos;temp.cfg&apos;&lt;/span&gt; WITH HEADER=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;                      
1 rows exported in 0.003 seconds.                                               
cqlsh:test&amp;gt; TRUNCATE airplanes;                                                 
cqlsh:test&amp;gt;                                                                     
cqlsh:test&amp;gt; COPY airplanes FROM &lt;span class=&quot;code-quote&quot;&gt;&apos;temp.cfg&apos;&lt;/span&gt; WITH HEADER=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;                    
Bad Request: unable to make &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; from &lt;span class=&quot;code-quote&quot;&gt;&apos;0.7&apos;&lt;/span&gt;                                      
Aborting &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; at record #0 (line 1). Previously-inserted values still present.
0 rows imported in 0.002 seconds.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Happens in CQLSH 2, may or may not happen in CQLSH 3&lt;/p&gt;</environment>
        <key id="12605617">CASSANDRA-4594</key>
            <summary>COPY TO and COPY FROM don&apos;t default to consistent ordering of columns</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thepaul">paul cannon</assignee>
                                    <reporter username="tpatterson">Tyler Patterson</reporter>
                        <labels>
                            <label>cqlsh</label>
                    </labels>
                <created>Thu, 30 Aug 2012 23:13:10 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:28 +0000</updated>
                            <resolved>Tue, 18 Sep 2012 19:03:48 +0000</resolved>
                                        <fixVersion>1.1.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13445584" author="thepaul" created="Fri, 31 Aug 2012 02:33:41 +0000"  >&lt;p&gt;This is because a &lt;tt&gt;select * from airplanes;&lt;/tt&gt; does not give the columns in the order they were defined. I&apos;m not sure why not; if that&apos;s a bug in C*, then we should fix that. If there isn&apos;t supposed to be any expectation of order, then cqlsh should be inspecting the columns and specifying them explicitly.&lt;/p&gt;</comment>
                            <comment id="13447531" author="slebresne" created="Tue, 4 Sep 2012 07:21:53 +0000"  >&lt;blockquote&gt;&lt;p&gt;This is because a select * from airplanes; does not give the columns in the order they were defined.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No it doesn&apos;t. The vaguely technical reason is that we don&apos;t keep internally the order of definition of columns, so we would have to start keeping that information (which honestly wouldn&apos;t be that much of a burden now that we have the list support, but was a tad more annoying to do at the time I wrote the code for select *). And I think that it&apos;s one place where it&apos;s not worth committing to any specific order but rather left it unspecified, so I don&apos;t see the point in bothering to record said definition order.&lt;/p&gt;

&lt;p&gt;For the record though, the order of * is not completely random. It returns first the columns composing the PK (in the order of the PK) and then the rest of the columns in lexicographic order. But really it&apos;s mostly because it&apos;s convenient for the implementation to do it that way.&lt;/p&gt;</comment>
                            <comment id="13450322" author="thepaul" created="Fri, 7 Sep 2012 04:01:31 +0000"  >&lt;p&gt;Seems worth it to fix this in the 1.1 branch too.&lt;/p&gt;</comment>
                            <comment id="13454297" author="thepaul" created="Wed, 12 Sep 2012 19:58:44 +0000"  >&lt;p&gt;Fixed in my github clone, in the 4594-1.1 branch:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://github.com/thepaul/cassandra/tree/4594-1.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://github.com/thepaul/cassandra/tree/4594-1.1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Current version is tagged pending/4594-1.1.&lt;/p&gt;

&lt;p&gt;And since the merge forward of this change will conflict with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4491&quot; title=&quot;cqlsh needs to use system.local instead of system.Versions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4491&quot;&gt;&lt;del&gt;CASSANDRA-4491&lt;/del&gt;&lt;/a&gt;, and the proper resolution isn&apos;t obvious, I&apos;ve also made a branch with this change for 1.2 on top of 4491:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://github.com/thepaul/cassandra/tree/4594-1.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://github.com/thepaul/cassandra/tree/4594-1.2&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13455144" author="brandon.williams" created="Thu, 13 Sep 2012 18:58:47 +0000"  >&lt;p&gt;Committed your 1.1 fix, and committed 4491 to 1.2 but I can&apos;t get your 1.2 branch to apply to cql3handling.py.&lt;/p&gt;</comment>
                            <comment id="13457594" author="thepaul" created="Tue, 18 Sep 2012 04:41:34 +0000"  >&lt;p&gt;Ah, sorry, I didn&apos;t make it clear on 4491 that the github branch had multiple commits from off of trunk. Looks like you only cherry-picked the last. I&apos;ll make a note there.&lt;/p&gt;</comment>
                            <comment id="13457917" author="iamaleksey" created="Tue, 18 Sep 2012 16:20:07 +0000"  >&lt;p&gt;trunk, cql3, python 2.7:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;cqlsh:test&amp;gt; COPY airplanes TO &apos;temp.cfg&apos; WITH HEADER=true;                                  &lt;br/&gt;
CQL query must be bytes, not unicode&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;cqlsh:test&amp;gt; COPY airplanes FROM &apos;temp.cfg&apos; WITH HEADER=true; &lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
  File &quot;bin/cqlsh&quot;, line 914, in perform_statement&lt;br/&gt;
    self.cursor.execute(statement, decoder=decoder)&lt;br/&gt;
  File &quot;bin/../lib/cql-internal-only-1.2.0.zip/cql-1.2.0/cql/cursor.py&quot;, line 75, in execute&lt;br/&gt;
    raise ValueError(&quot;CQL query must be bytes, not unicode&quot;)&lt;br/&gt;
ValueError: CQL query must be bytes, not unicode&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;ve attached a patch that fixes the issue but probably isn&apos;t the best possible solution.&lt;/p&gt;</comment>
                            <comment id="13457999" author="thepaul" created="Tue, 18 Sep 2012 17:56:33 +0000"  >&lt;p&gt;Aleksey: you must be missing the patch for this ticket. It includes a change to the cql_protect_name function to encode unicode names in utf8 when necessary. Using &lt;tt&gt;str&lt;/tt&gt; won&apos;t work when there are non-ascii characters and the default encoding is not utf8.&lt;/p&gt;</comment>
                            <comment id="13458019" author="iamaleksey" created="Tue, 18 Sep 2012 18:18:21 +0000"  >&lt;p&gt;Paul: if it&apos;s in the trunk then I&apos;m not missing it. Just double-checked it, still got exact same exceptions.&lt;/p&gt;</comment>
                            <comment id="13458022" author="thepaul" created="Tue, 18 Sep 2012 18:23:29 +0000"  >&lt;p&gt;It&apos;s not yet in trunk. See above; Brandon couldn&apos;t get the commit to apply, because it was missing two of the commits from 4491.&lt;/p&gt;</comment>
                            <comment id="13458023" author="iamaleksey" created="Tue, 18 Sep 2012 18:26:10 +0000"  >&lt;p&gt;Ah. Then I misunderstood you. Sorry.&lt;/p&gt;</comment>
                            <comment id="13458026" author="brandon.williams" created="Tue, 18 Sep 2012 18:28:26 +0000"  >&lt;p&gt;Sylvain said he committed those and I think I see them there, maybe you just need to pull.&lt;/p&gt;</comment>
                            <comment id="13458028" author="iamaleksey" created="Tue, 18 Sep 2012 18:31:06 +0000"  >&lt;p&gt;I pulled, of course. So unless git is lying to me, I should have the latest trunk.&lt;/p&gt;</comment>
                            <comment id="13458039" author="thepaul" created="Tue, 18 Sep 2012 18:40:50 +0000"  >&lt;p&gt;Yes, the commits from 4491 are there. The patch for &lt;em&gt;this commit&lt;/em&gt; is not.&lt;/p&gt;</comment>
                            <comment id="13458045" author="brandon.williams" created="Tue, 18 Sep 2012 18:48:54 +0000"  >&lt;p&gt;Ok, I got it to merge cleanly and committed it to trunk.&lt;/p&gt;</comment>
                            <comment id="13458059" author="iamaleksey" created="Tue, 18 Sep 2012 18:58:19 +0000"  >&lt;p&gt;The problem is now gone.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thepaul]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>256275</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 10 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gxhj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96855</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>brandon.williams</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>