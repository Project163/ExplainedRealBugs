<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:00:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11045] Legacy SSTables for KEYS indexes can&apos;t be read in 3.0+</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11045</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Trying to read an SSTable for a KEYS index created in 2.1 throws a deserialization error when being read following an upgrade to 3.0. This occurs whether the read comes via the query path or by running &lt;tt&gt;nodetool upgradesstables&lt;/tt&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12932696">CASSANDRA-11045</key>
            <summary>Legacy SSTables for KEYS indexes can&apos;t be read in 3.0+</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="samt">Sam Tunnicliffe</assignee>
                                    <reporter username="samt">Sam Tunnicliffe</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Jan 2016 12:53:16 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:44 +0000</updated>
                            <resolved>Wed, 27 Jan 2016 11:46:10 +0000</resolved>
                                        <fixVersion>3.0.3</fixVersion>
                    <fixVersion>3.3</fixVersion>
                                    <component>Legacy/Distributed Metadata</component>
                    <component>Legacy/Local Write-Read Paths</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15108477" author="beobal" created="Wed, 20 Jan 2016 12:55:40 +0000"  >&lt;p&gt;The legacy tables are dense and non-compound but &lt;tt&gt;CassandraIndex::indexCfsMetadata&lt;/tt&gt; wasn&apos;t creating the metadata as such, leading to an exception in &lt;tt&gt;OldFormatSeserializer&lt;/tt&gt; when reading tables in the old format. KEYS indexes created on 3.0+ (for COMPACT STORAGE tables) are not affected. &lt;a href=&quot;https://github.com/beobal/cassandra/tree/11045-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;This branch&lt;/a&gt; includes a fix to create the index metadata correctly and again, KEYS indexes created with 3.0+ use &lt;tt&gt;CurrentFormatDeserializer&lt;/tt&gt; and so work as expected. I&apos;m working on an upgrade dtest and will update with details shortly. &lt;/p&gt;

&lt;p&gt;The patch is valid for 3.0 -&amp;gt; trunk and merges cleanly, so I&apos;ve only linked a single branch.&lt;/p&gt;</comment>
                            <comment id="15115366" author="beobal" created="Mon, 25 Jan 2016 15:17:00 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;testall&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/11046-5.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;11045-3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-11045-3.0-testall&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-11045-3.0-dtest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;(dtests currently running)&lt;/p&gt;</comment>
                            <comment id="15115403" author="slebresne" created="Mon, 25 Jan 2016 15:32:23 +0000"  >&lt;p&gt;+1 (pending test results of course)&lt;/p&gt;</comment>
                            <comment id="15119104" author="beobal" created="Wed, 27 Jan 2016 11:46:10 +0000"  >&lt;p&gt;&lt;tt&gt;sstableutil_test:SSTableUtilTest.abortedcompaction_test&lt;/tt&gt; is consistenly failing for me both locally &amp;amp; on jenkins. However, it&apos;s also failing on the unpatched 3.0, 3.3 and trunk branches locally too. I see it was also failing on those branches on Jenkins until 5 days ago. This was roughly around when &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10979&quot; title=&quot;LCS doesn&amp;#39;t do L0 STC on new tables while an L0-&amp;gt;L1 compaction is in progress&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10979&quot;&gt;&lt;del&gt;CASSANDRA-10979&lt;/del&gt;&lt;/a&gt; was committed, but I can&apos;t see how that can be relevant seeing as my branches (and local mainline branches) also contain it. &lt;/p&gt;

&lt;p&gt;I&apos;ve committed to 3.0 anyway in &lt;tt&gt;5ec40a35958aefed9ae7a791751526d3eefb17a4&lt;/tt&gt; but will check on subsequent dtest runs for regressions here, perhaps it&apos;s something environmental which is configured differently for the mainline branch CI builds. &lt;/p&gt;

&lt;p&gt;FTR, I&apos;m also seeing the same behaviour for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11046&quot; title=&quot;Existing indexes are always rebuilt on upgrade to 3.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11046&quot;&gt;&lt;del&gt;CASSANDRA-11046&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 42 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2rqfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>