<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:09:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13959] Add yaml flag for disabling MVs, log warnings on creation</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13959</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;As discussed on dev@, we should give operators the option to disable materialized view creation, and log warnings when they&apos;re created.&lt;/p&gt;

&lt;p&gt;Update - Adding link for posterity: &lt;a href=&quot;https://lists.apache.org/thread.html/d81a61da48e1b872d7599df4edfa8e244d34cbd591a18539f724796f@%3Cdev.cassandra.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread.html/d81a61da48e1b872d7599df4edfa8e244d34cbd591a18539f724796f@%3Cdev.cassandra.apache.org%3E&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13109748">CASSANDRA-13959</key>
            <summary>Add yaml flag for disabling MVs, log warnings on creation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bdeggleston">Blake Eggleston</assignee>
                                    <reporter username="bdeggleston">Blake Eggleston</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Oct 2017 17:19:16 +0000</created>
                <updated>Wed, 15 Oct 2025 09:49:05 +0000</updated>
                            <resolved>Thu, 26 Oct 2017 21:07:23 +0000</resolved>
                                        <fixVersion>3.0.16</fixVersion>
                    <fixVersion>3.11.2</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Feature/Materialized Views</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="16206670" author="bdeggleston" created="Mon, 16 Oct 2017 22:11:23 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/bdeggleston/cassandra/tree/13959-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://circleci.com/gh/bdeggleston/cassandra/138&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/bdeggleston/cassandra/tree/13959-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/bdeggleston/cassandra/139&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/bdeggleston/cassandra/tree/13959-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/bdeggleston/cassandra/137&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="16207702" author="iamaleksey" created="Tue, 17 Oct 2017 14:25:23 +0000"  >&lt;p&gt;Had a quick conversation about this with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt;. He raised a point that logging a warning every time we load an MV is unreasonable - and I agree that it is. Can we only keep the warning on creation?&lt;/p&gt;

&lt;p&gt;Could add a small dtest (or utest if you so prefer) to show that:&lt;br/&gt;
1. Setting the flag to &lt;tt&gt;false&lt;/tt&gt; really disables creation, and&lt;br/&gt;
2. That a client warning is emitted&lt;/p&gt;

&lt;p&gt;Aside from this, looks good to me. Maybe give it a week before committing (till next Tue/Wed), to let people with binding -1s have a chance to change their mind since dev@ discussion though.&lt;/p&gt;</comment>
                            <comment id="16208226" author="bdeggleston" created="Tue, 17 Oct 2017 19:50:22 +0000"  >&lt;p&gt;removed the warning on schema load and added dtests &lt;a href=&quot;https://github.com/bdeggleston/cassandra-dtest/tree/13959&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Without thinking about it, I squashed the review fixes. Sorry that makes verifying the changes a bit harder.&lt;/p&gt;</comment>
                            <comment id="16211077" author="iamaleksey" created="Thu, 19 Oct 2017 14:00:11 +0000"  >&lt;p&gt;I would add a link to ML archives for that discussion in NEWS.txt (can be done on commit), but +1 (still, give it time till next Tue/Wed though).&lt;/p&gt;</comment>
                            <comment id="16211792" author="kurtg" created="Thu, 19 Oct 2017 21:43:02 +0000"  >&lt;p&gt;Interesting. At least you took the advice to keep it enabled in a patch release. I&apos;m still a bit confused at how you can make claims it&apos;s experimental without providing any evidence other then some developers having some &quot;feelings&quot;. Especially when it&apos;s quite doubtful that any of said developers 1. run 3.x, and 2. use MV&apos;s. &lt;/p&gt;

&lt;p&gt;I&apos;m really still not sure what benefit you see in saying it&apos;s experimental rather than just fixing whatever these problems are that you can&apos;t actually describe.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I would add a link to ML archives for that discussion in NEWS.txt&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Anyone who reads that discussion isn&apos;t going to be convinced some well educated decision was made. They are just going to see a thread which contained a lot of disagreement that went nowhere. &lt;/p&gt;
</comment>
                            <comment id="16211978" author="jjirsa" created="Fri, 20 Oct 2017 00:33:17 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I&apos;m really still not sure what benefit you see in saying it&apos;s experimental rather than just fixing whatever these problems are that you can&apos;t actually describe.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;and:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Anyone who reads that discussion isn&apos;t going to be convinced some well educated decision was made. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Both addressed by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; in one paragraph:&lt;br/&gt;
 &lt;a href=&quot;https://lists.apache.org/thread.html/de6b92f62eb93e6f424f6a846177f31980e2f1f8ac5e7bde29550a4f@%3Cdev.cassandra.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;MVs are by far and away the most complicated feature we have ever delivered. We do not fully understand it, even in theory, let alone can we be sure we have the implementation right.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The only way to know all of the problems is to formally model it, and then verify the implementation matches the model. That hasn&apos;t happened.&lt;/p&gt;

&lt;p&gt;The next best way (which is still insufficient) is to run it at scale and actually hunt for flaws. That hasn&apos;t happened. I know it hasn&apos;t happened, because if that sort of testing did happen, whoever did it would have necessarily stumbled across all sorts bugs like ( &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13595&quot; title=&quot;Implement short read protection on partition boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13595&quot;&gt;&lt;del&gt;CASSANDRA-13595&lt;/del&gt;&lt;/a&gt; , &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13911&quot; title=&quot;IllegalStateException thrown by UPI.Serializer.hasNext() for some SELECT queries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13911&quot;&gt;&lt;del&gt;CASSANDRA-13911&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13880&quot; title=&quot;Fix short read protection for tables with no clustering columns&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13880&quot;&gt;&lt;del&gt;CASSANDRA-13880&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12872&quot; title=&quot;Fix short read protection when more than one row is missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12872&quot;&gt;&lt;del&gt;CASSANDRA-12872&lt;/del&gt;&lt;/a&gt; , &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13747&quot; title=&quot;Fix AssertionError in short read protection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13747&quot;&gt;&lt;del&gt;CASSANDRA-13747&lt;/del&gt;&lt;/a&gt; ). &lt;/p&gt;

&lt;p&gt;I &lt;b&gt;strongly encourage&lt;/b&gt; you to spend time and effort to find and fix the bugs you know about, but until someone can provide some level of confidence that it&apos;s safe, we shouldn&apos;t let users ASSUME it&apos;s safe.&lt;/p&gt;
</comment>
                            <comment id="16221237" author="bdeggleston" created="Thu, 26 Oct 2017 21:07:23 +0000"  >&lt;p&gt;committed as &lt;tt&gt;b8697441d7a051e7ff68def6aa9cf14bd92ace9e&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="16234052" author="jmckenzie" created="Wed, 1 Nov 2017 13:17:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;The only way to know all of the problems is to formally model it, and then verify the implementation matches the model. That hasn&apos;t happened.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;At the risk of beating a dead horse - by this measure, most of the features in C* should be flagged experimental. I&apos;m all for us having more rigor in terms of proving the correctness of behaviors in a distributed system, but this looks an awful lot like arbitrarily applying that standard to this feature and not to others.&lt;/p&gt;</comment>
                            <comment id="16234057" author="jjirsa" created="Wed, 1 Nov 2017 13:21:37 +0000"  >&lt;p&gt;You&apos;re cherry-picking sentences &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=JoshuaMcKenzie&quot; class=&quot;user-hover&quot; rel=&quot;JoshuaMcKenzie&quot;&gt;JoshuaMcKenzie&lt;/a&gt; . That statement is true, but the previous line (quoted from Benedict) and the following paragraph is why it needs to be marked experimental.&lt;/p&gt;



</comment>
                            <comment id="16234064" author="jmckenzie" created="Wed, 1 Nov 2017 13:26:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;MVs are by far and away the most complicated feature we have ever delivered. We do not fully understand it, even in theory, let alone can we be sure we have the implementation right.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Both claims from Benedict on that email thread are &apos;citation needed&apos;, and I believe what Kurt refers to when he&apos;s talking about developer&apos;s &apos;feelings&apos;. To be very clear, I&apos;m not even saying I disagree with Benedict on his &lt;b&gt;intuition&lt;/b&gt; here, just that we have no precedent for formal analysis whatsoever on things like this and marking a feature experimental that&apos;s in use by people in production systems smells knee-jerk. Again, this is largely beating a dead horse from what was on the mailing list so I&apos;m not looking to re-litigate here.&lt;/p&gt;

&lt;p&gt;As for the latter paragraph, making the claim that you know nobody is running MV&apos;s at scale in the wild is a pretty bold claim, seeing as how we don&apos;t have concrete data on the full adoption of the project in the wild as a whole, much less the scale of usage of individual features. So no, my intention wasn&apos;t to just cherry-pick sentences, but instead to point out that we&apos;re making broadly user-impacting decisions that are not backed by data.&lt;/p&gt;</comment>
                            <comment id="16234068" author="jjirsa" created="Wed, 1 Nov 2017 13:34:48 +0000"  >&lt;p&gt;I didn&apos;t say nobody was running MVs at scale - I said nobody was doing it AND looking for errors. I&apos;m confident in that assertion because had they done so, they would have found the 5 8099 correctness-impacting bugs I linked, which you would certainly hit as you did range through a table (or view) to check the data matched. Those bugs and ~8 years of intuition are all I need to vote in favor of this.&lt;/p&gt;

&lt;p&gt;If you&apos;re willing to assert that there exists a competent team running MVs in multiple DCs with multiple racks, writing data into the table with nontrivial volumes and non-trivial patterns (new rows, overwrites, TTLs, range deletes, partition deletes), adding/removing nodes, growing the cluster, shrinking the cluster, running full repair, running incremental repair, killing disks, replacing instances, and then verifying that EVERY SINGLE WRITE &lt;b&gt;and&lt;/b&gt; EVERY SINGLE DELETE is present with the expected consistency guarantees, by all means, say so and I&apos;ll vote to remove the flag in 4.0. &lt;/p&gt;

&lt;p&gt;I&apos;m sure people are running MVs at scale, I just don&apos;t believe that they&apos;re actively hunting for bugs or trying to prove correctness. But you&apos;ve got a binding -1 now, if you really believe this is hurting users, you know what to do.&lt;/p&gt;</comment>
                            <comment id="16234157" author="bdeggleston" created="Wed, 1 Nov 2017 14:41:47 +0000"  >&lt;blockquote&gt;&lt;p&gt;this looks an awful lot like arbitrarily applying that standard to this feature and not to others&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Do we have other features that, by design, can get themselves into an inconsistent state and can&#8217;t be fixed without downtime?&lt;/p&gt;</comment>
                            <comment id="16234164" author="iamaleksey" created="Wed, 1 Nov 2017 14:46:41 +0000"  >&lt;p&gt;Are you guys all bored or something?&lt;/p&gt;</comment>
                            <comment id="16235024" author="kurtg" created="Thu, 2 Nov 2017 00:50:32 +0000"  >&lt;p&gt;It seems fair to me that all the people who are adamant about marking MV&apos;s experimental should be pushing to fix them by 4.0, instead of trying to absolve themselves of the responsibility by throwing existing users of MV&apos;s under the bus. Especially considering these are the people who let MV through in the first place.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bdeggleston]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 2 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3lbg7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aleksey</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>