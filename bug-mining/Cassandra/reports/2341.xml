<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:40:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5909] CommitLogReplayer date time issue</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5909</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;First off I am sorry if the component is not right for this. &lt;/p&gt;

&lt;p&gt;I am trying to get the point-in-time backup to work. And I ran into the following issues: &lt;/p&gt;

&lt;p&gt;1. The documentation in the commitlog_archiving.properties seems to be out of date, as the example date format is no more valid and can&apos;t be parsed. &lt;/p&gt;

&lt;p&gt;2. &lt;/p&gt;

&lt;p&gt;The restore_point_in_time property seems to differ from the actual maxTimeStamp. I added additional logging to the codebase in the class CommitLogReplayer like that: &lt;/p&gt;

&lt;p&gt;protected boolean pointInTimeExceeded(RowMutation frm)&lt;br/&gt;
    {&lt;br/&gt;
        long restoreTarget = CommitLog.instance.archiver.restorePointInTime;&lt;br/&gt;
        logger.info(String.valueOf(restoreTarget));&lt;br/&gt;
        for (ColumnFamily families : frm.getColumnFamilies())&lt;/p&gt;
        {
            logger.info(String.valueOf(families.maxTimestamp()));
        	if (families.maxTimestamp() &amp;gt; restoreTarget)
                return true;
        }
&lt;p&gt;        return false;&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;The following output can be seen: &lt;/p&gt;

&lt;p&gt;The restoreTarget timestamp is: 1377015783000&lt;br/&gt;
This has been correctly parsed as I added this date to the properties: &lt;br/&gt;
2013:08:20 17:23:03&lt;/p&gt;

&lt;p&gt;the value for families.maxTimestamp() is: 1377009021033000&lt;br/&gt;
This date corresponds to: Mon 45605-09-05 10:50:33 BST (44 millennia from now)&lt;/p&gt;

&lt;p&gt;It seems like the timestamp has 3 additional zeros. This also means that the code can never return false on the call, as the restoreTarget will always be smaller then the maxTimestamp(). Therefore the Replayer can never replay any of my commitlog files. &lt;br/&gt;
The timestamp minus the 3 zeros corresponds to &quot;Tue 2013-08-20 15:30:21 BST (23 hours ago)&quot; which makes more sense and would allow for the replay to work. &lt;/p&gt;

&lt;p&gt;My config: &lt;/p&gt;

&lt;p&gt;Cassandra-1.2.4&lt;br/&gt;
Java 1.6&lt;br/&gt;
Ubuntu 12.04 64bit &lt;/p&gt;

&lt;p&gt;If you need any more information let me know and I&apos;ll be happy to suply whatever info I can. &lt;/p&gt;

&lt;p&gt;&amp;#8211; artur &lt;/p&gt;

</description>
                <environment></environment>
        <key id="12664833">CASSANDRA-5909</key>
            <summary>CommitLogReplayer date time issue</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vijay2win@yahoo.com">Vijay</assignee>
                                    <reporter username="artur.kronenberg">Artur Kronenberg</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Aug 2013 13:12:28 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:07 +0000</updated>
                            <resolved>Sun, 15 Sep 2013 00:59:59 +0000</resolved>
                                        <fixVersion>1.2.10</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13750875" author="vijay2win@yahoo.com" created="Tue, 27 Aug 2013 01:52:53 +0000"  >&lt;p&gt;Ahaaa looks like we need a configuration for Milli/Micro second precisions, &lt;br/&gt;
Users should not mix those in a cluster to have a reliable delete and updates, so it should be fine. The other option is to write additional long field while storing the RM in the commit log.  &lt;/p&gt;</comment>
                            <comment id="13751057" author="vijay2win@yahoo.com" created="Tue, 27 Aug 2013 07:35:39 +0000"  >&lt;p&gt;Attached patch and test case as a fix to add precision. Thanks!&lt;/p&gt;</comment>
                            <comment id="13766328" author="jbellis" created="Fri, 13 Sep 2013 08:22:38 +0000"  >&lt;p&gt;Comments:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Default in the config file is millis, but default in the code is micros.  For 1.2, should both be whatever it was before, for compatibility &lt;span class=&quot;error&quot;&gt;&amp;#91;think this is millis&amp;#93;&lt;/span&gt;; for 2.0 should be micros (add NEWS of change)&lt;/li&gt;
	&lt;li&gt;Extra no-op eol semicolon in the test code; extra unused imports as well&lt;/li&gt;
	&lt;li&gt;Formatting of ?: in archiver is nonstandard&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Otherwise, LGTM.&lt;/p&gt;</comment>
                            <comment id="13767636" author="vijay2win@yahoo.com" created="Sun, 15 Sep 2013 00:59:59 +0000"  >&lt;p&gt;Fixed the comments and Committed to 1.2, 2.0 and trunk, Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12600113" name="0001-CASSANDRA-5909.patch" size="8261" author="vijay2win@yahoo.com" created="Tue, 27 Aug 2013 07:35:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[vijay2win@yahoo.com]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>344776</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 10 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ngf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>345076</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324157">1.2.4</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>