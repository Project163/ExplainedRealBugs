<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:54:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-7787] 2i index indexing the cql3 row marker throws NPE</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-7787</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;If you have a secondary index implementation that &apos;indexes()&apos; the cql3 row marker you get a NPE in SecondaryIndexManager/deleteFromIndexes() as the call to getColumnDefinitionFromColumnName() returns null which is not checked for.&lt;/p&gt;

&lt;p&gt;This has been detected in the context of inserting PK only rows, where the row marker is expected to be present. When &apos;indexes()&apos; returned &apos;false&apos;, the row would mistakenly get deleted as the row marker didn&apos;t go through.&lt;/p&gt;

&lt;p&gt;If &apos;indexes()&apos; returns &apos;true&apos; the row marker goes through but you get a NPE.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12734780">CASSANDRA-7787</key>
            <summary>2i index indexing the cql3 row marker throws NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bereng">Berenguer Blasi</assignee>
                                    <reporter username="bereng">Berenguer Blasi</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Aug 2014 15:37:44 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:36 +0000</updated>
                            <resolved>Tue, 19 Aug 2014 13:28:32 +0000</resolved>
                                        <fixVersion>2.0.10</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14100750" author="bereng" created="Mon, 18 Aug 2014 15:43:20 +0000"  >&lt;p&gt;Patch added.&lt;/p&gt;</comment>
                            <comment id="14100837" author="slebresne" created="Mon, 18 Aug 2014 16:48:02 +0000"  >&lt;p&gt;I&apos;ll note that imo indexing the CQL3 row marker is a very bad idea as the row marker is an implementation detail and there is no guarantee whatsoever on when/if it will be present.&lt;/p&gt;</comment>
                            <comment id="14100839" author="slebresne" created="Mon, 18 Aug 2014 16:50:01 +0000"  >&lt;p&gt;And to be clear, I&apos;m not strongly against fixing this if it&apos;s easy and makes your life easier. I&apos;m just warning you.&lt;/p&gt;</comment>
                            <comment id="14100846" author="bereng" created="Mon, 18 Aug 2014 16:54:36 +0000"  >&lt;p&gt;A PK only row should always be accompanied by a row marker I believe?&lt;/p&gt;</comment>
                            <comment id="14100851" author="bereng" created="Mon, 18 Aug 2014 16:58:35 +0000"  >&lt;p&gt;Let me give some more context: In Keyspace.java/indexRow() it will try to index a PKOnly+RowMarker row only passing through the PK bit and not the row marker. So if you &apos;fix&apos; the indexes() method on the 2index to allow for the row marker to get through you get the NPE. I hope this gives a better picture.&lt;/p&gt;</comment>
                            <comment id="14102066" author="sbtourist" created="Tue, 19 Aug 2014 09:39:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt;, we don&apos;t actually &lt;b&gt;index&lt;/b&gt; the row marker, we rather need it among the indexed columns (hence indexes() needs to return true for us) in order to detect pk-only rows.&lt;/p&gt;</comment>
                            <comment id="14102197" author="iamaleksey" created="Tue, 19 Aug 2014 13:28:32 +0000"  >&lt;p&gt;Committed, thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12662508" name="cassandra-2.0-7787.txt" size="1755" author="bereng" created="Mon, 18 Aug 2014 16:20:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bereng]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>412720</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1yzzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>412706</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326830">2.0.9</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aleksey</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>