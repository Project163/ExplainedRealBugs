<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:53:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-9374] Remove thrift dependency in stress schema creation</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-9374</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9319&quot; title=&quot;Don&amp;#39;t start Thrift RPC server by default in 2.2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9319&quot;&gt;&lt;del&gt;CASSANDRA-9319&lt;/del&gt;&lt;/a&gt; the thrift server is turned off by default, which makes stress no longer work out of the box. Even though stress uses native CQL3 by default, there is still some remaining piece that uses thrift for schema creation.&lt;/p&gt;

&lt;p&gt;This is what you get by default now:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ JAVA_HOME=~/fab/java ~/fab/stress/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/tools/bin/cassandra-stress write n=19000000 -rate threads=300 -node blade-11-4a,blade-11-3a,blade-11-2a
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.RuntimeException: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused
        at org.apache.cassandra.stress.settings.StressSettings.getRawThriftClient(StressSettings.java:144)
        at org.apache.cassandra.stress.settings.StressSettings.getRawThriftClient(StressSettings.java:110)
        at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpacesThrift(SettingsSchema.java:111)
        at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:59)
        at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:205)
        at org.apache.cassandra.stress.StressAction.run(StressAction.java:55)
        at org.apache.cassandra.stress.Stress.main(Stress.java:109)
Caused by: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused
        at org.apache.thrift.transport.TSocket.open(TSocket.java:187)
        at org.apache.thrift.transport.TFramedTransport.open(TFramedTransport.java:81)
        at org.apache.cassandra.thrift.TFramedTransportFactory.openTransport(TFramedTransportFactory.java:41)
        at org.apache.cassandra.stress.settings.StressSettings.getRawThriftClient(StressSettings.java:124)
        ... 6 more
Caused by: java.net.ConnectException: Connection refused
        at java.net.PlainSocketImpl.socketConnect(Native Method)
        at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
        at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)
        at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
        at java.net.Socket.connect(Socket.java:579)
        at org.apache.thrift.transport.TSocket.open(TSocket.java:182)
        ... 9 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12829596">CASSANDRA-9374</key>
            <summary>Remove thrift dependency in stress schema creation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tjake">T Jake Luciani</assignee>
                                    <reporter username="enigmacurry">Ryan McGuire</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 May 2015 16:48:25 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:11 +0000</updated>
                            <resolved>Fri, 15 May 2015 13:40:48 +0000</resolved>
                                        <fixVersion>2.2.0 beta 1</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14542261" author="jbellis" created="Wed, 13 May 2015 17:14:57 +0000"  >&lt;p&gt;(Marking 2.2.x since consensus is this should not block beta.)&lt;/p&gt;</comment>
                            <comment id="14542394" author="nickmbailey" created="Wed, 13 May 2015 18:37:25 +0000"  >&lt;p&gt;It seems fine that this doesn&apos;t block a beta release but I&apos;d say this needs to target an rc at least. Requiring turning on thrift and doing a rolling restart to run stress doesn&apos;t seem very friendly.&lt;/p&gt;</comment>
                            <comment id="14542488" author="brandon.williams" created="Wed, 13 May 2015 19:13:59 +0000"  >&lt;p&gt;I think a nodetool enablethrift would at least eliminate the restart, but I agree with you.&lt;/p&gt;</comment>
                            <comment id="14543953" author="tjake" created="Thu, 14 May 2015 16:24:04 +0000"  >&lt;p&gt;Branch &lt;a href=&quot;https://github.com/tjake/cassandra/tree/9374-nothriftschema&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/tjake/cassandra/tree/9374-nothriftschema&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The CQL generated is compatible thrift but it doesn&apos;t let you modify the column names across runs.&lt;/p&gt;

&lt;p&gt;I verified write/read and counter_write/counter_read works from -mode native and thrift&lt;/p&gt;
</comment>
                            <comment id="14545403" author="iamaleksey" created="Fri, 15 May 2015 12:15:17 +0000"  >&lt;p&gt;I haven&apos;t verified it operating, since you already have, and code LGTM overall.&lt;/p&gt;

&lt;p&gt;Some potential issues:&lt;br/&gt;
1. in &lt;tt&gt;createKeyspaceNative()&lt;/tt&gt; we should quote the name of the keyspace&lt;br/&gt;
2. in &lt;tt&gt;createKeyspaceStatementCQL3()&lt;/tt&gt; we should quote it as well&lt;br/&gt;
3. same goes for &lt;tt&gt;createStandard1StatementCQL3()&lt;/tt&gt; and &lt;tt&gt;createCounter1StatementCQL3()&lt;/tt&gt;, although there we can drop the keyspace name from &lt;tt&gt;CREATE TABLE&lt;/tt&gt; entirely, since we&apos;d have set it by calling &lt;tt&gt;USE&lt;/tt&gt; anyway&lt;/p&gt;

&lt;p&gt;Nit: in &lt;tt&gt;createKeySpacesThrift()&lt;/tt&gt; , in the try/catch block, could clean up counters  related comments and also get rid of all &lt;tt&gt;set_cql_version()&lt;/tt&gt; calls - those are no-op.&lt;/p&gt;</comment>
                            <comment id="14545508" author="tjake" created="Fri, 15 May 2015 13:40:48 +0000"  >&lt;p&gt;committed with suggestions&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12827753">CASSANDRA-9319</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[tjake]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 27 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2eos7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aleksey</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>