<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:47:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-7506] querying secondary index using complete collection should warn/error</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-7506</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Cassandra does not seem to support querying a set literal like so:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;select * from testtable where pkey=&apos;foo&apos; and mycollection = {&apos;one&apos;, &apos;two&apos;};
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We currently don&apos;t let the user know this query is problematic, rather we just return no rows.&lt;/p&gt;

&lt;p&gt;To reproduce:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;create keyspace test with replication = {&apos;class&apos;: &apos;SimpleStrategy&apos;, &apos;replication_factor&apos;:1} ;

use test ;

create table testtable (pkey text PRIMARY KEY, mycollection set&amp;lt;text&amp;gt;);

create index on testtable (mycollection);

insert into testtable (pkey, mycollection) VALUES ( &apos;foo&apos;, {&apos;one&apos;,&apos;two&apos;};

cqlsh:test&amp;gt; select * from testtable where pkey=&apos;foo&apos; and mycollection = {&apos;one&apos;, &apos;two&apos;};

(0 rows)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;cassandra 2.1.0-rc2, java 1.7.0_60&lt;/p&gt;</environment>
        <key id="12725833">CASSANDRA-7506</key>
            <summary>querying secondary index using complete collection should warn/error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thobbs">Tom Hobbs</assignee>
                                    <reporter username="rhatch">Russ Hatch</reporter>
                        <labels>
                            <label>qa-resolved</label>
                    </labels>
                <created>Mon, 7 Jul 2014 20:16:37 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:41 +0000</updated>
                            <resolved>Tue, 19 Aug 2014 16:22:12 +0000</resolved>
                                        <fixVersion>2.0.10</fixVersion>
                    <fixVersion>2.1.1</fixVersion>
                                    <component>Feature/2i Index</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14091370" author="thobbs" created="Fri, 8 Aug 2014 22:16:20 +0000"  >&lt;p&gt;7506.txt (and &lt;a href=&quot;https://github.com/thobbs/cassandra/tree/CASSANDRA-7506&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;) throws an IRE when an equality relation is used on a collection column.&lt;/p&gt;

&lt;p&gt;The cqlsh grammar also had problems parsing the select statement, so I made a minor fix around the &lt;tt&gt;&amp;lt;term&amp;gt;&lt;/tt&gt; definition.&lt;/p&gt;</comment>
                            <comment id="14091380" author="thobbs" created="Fri, 8 Aug 2014 22:21:20 +0000"  >&lt;p&gt;I accidentally missed a unit test in my first patch, so v2 adds that.&lt;/p&gt;</comment>
                            <comment id="14092653" author="slebresne" created="Mon, 11 Aug 2014 10:31:47 +0000"  >&lt;p&gt;The fix looks good, but I think we should move the test up to apply to all relations. For instance:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;CREATE TABLE foo (a int PRIMARY KEY, b set&amp;lt;int&amp;gt;, c int);
CREATE INDEX ON foo(c)&quot;);

INSERT INTO foo(a, b, c) VALUES (0, 2, {1});
SELECT * FROM foo WHERE c = 2 AND b &amp;gt; {0} ALLOW FILTERING;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is currently not properly rejected, and end up with&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.cassandra.exceptions.InvalidRequestException: Not enough bytes to read a list
    at org.apache.cassandra.cql3.Sets$Value.fromSerialized(Sets.java:158)
    at org.apache.cassandra.cql3.Sets$Marker.bind(Sets.java:237)
    at org.apache.cassandra.cql3.Sets$Marker.bind(Sets.java:226)
    at org.apache.cassandra.cql3.Sets$Adder.doAdd(Sets.java:271)
    at org.apache.cassandra.cql3.Sets$Setter.execute(Sets.java:253)
    at org.apache.cassandra.cql3.statements.UpdateStatement.addUpdateForKey(UpdateStatement.java:97)
    at org.apache.cassandra.cql3.statements.ModificationStatement.getMutations(ModificationStatement.java:672)
    at org.apache.cassandra.cql3.statements.ModificationStatement.executeInternal(ModificationStatement.java:639)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Haven&apos;t checked 2.0 but I wonder if it&apos;s affected too (we can&apos;t create index on collections in 2.0 but that&apos;s really not necessary for this bug).&lt;/p&gt;</comment>
                            <comment id="14094320" author="thobbs" created="Tue, 12 Aug 2014 17:09:36 +0000"  >&lt;p&gt;The v3 patch checks for non-EQ relations as well (besides CONTAINS and CONTAINS KEY) with some test coverage.  The branch is also updated.&lt;/p&gt;

&lt;p&gt;You were correct about 2.0 also having this problem.  The 7506-2.0.txt patch fixes 2.0 (without unit tests, due to CqlTester being in 2.1+).&lt;/p&gt;</comment>
                            <comment id="14100594" author="slebresne" created="Mon, 18 Aug 2014 12:42:49 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14100830" author="rhatch" created="Mon, 18 Aug 2014 16:43:10 +0000"  >&lt;p&gt;Tested patch with basic tests above, works as expected.&lt;/p&gt;</comment>
                            <comment id="14102406" author="thobbs" created="Tue, 19 Aug 2014 16:22:12 +0000"  >&lt;p&gt;Thanks, committed to 2.0 and 2.1 (but not 2.1.0).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12661241" name="7506-2.0.txt" size="1066" author="thobbs" created="Tue, 12 Aug 2014 17:09:36 +0000"/>
                            <attachment id="12660732" name="7506-v2.txt" size="4875" author="thobbs" created="Fri, 8 Aug 2014 22:21:20 +0000"/>
                            <attachment id="12661242" name="7506-v3.txt" size="5615" author="thobbs" created="Tue, 12 Aug 2014 17:09:36 +0000"/>
                            <attachment id="12660731" name="7506.txt" size="3071" author="thobbs" created="Fri, 8 Aug 2014 22:16:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403991</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xj2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>404033</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327111">2.1 rc2</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311124" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Tester</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>rhatch</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>