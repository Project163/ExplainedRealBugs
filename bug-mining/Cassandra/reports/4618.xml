<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:06:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13013] Potential regression from CASSANDRA-6377</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13013</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;As noted by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thobbs&quot; class=&quot;user-hover&quot; rel=&quot;thobbs&quot;&gt;thobbs&lt;/a&gt; in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12768&quot; title=&quot;CQL often queries static columns unnecessarily&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12768&quot;&gt;&lt;del&gt;CASSANDRA-12768&lt;/del&gt;&lt;/a&gt;, in 3.0 (and prior) &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-3.0/src/java/org/apache/cassandra/cql3/statements/SelectStatement.java#L753-L754&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;we return static results&lt;/a&gt; for a partition if it is the only results when the query is a 2ndary index query. This doesn&apos;t seem to happen anymore in 3.X and that was removed by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6377&quot; title=&quot;ALLOW FILTERING should allow seq scan filtering&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6377&quot;&gt;&lt;del&gt;CASSANDRA-6377&lt;/del&gt;&lt;/a&gt; (see the &lt;a href=&quot;https://github.com/apache/cassandra/commit/8c83c8edab4f1c23c382bb0ac076cab44d5f4dda#diff-75ebe654dcf6c8c474f787abaf47bb68L705&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;merge commit&lt;/a&gt;, but that removal is actually part of the original &lt;a href=&quot;https://github.com/blerer/cassandra/commit/e22a311a6d379a9f81668b7995501962ba705380#diff-75ebe654dcf6c8c474f787abaf47bb68L705&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk patch for CASSANDRA-6377&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;The removal looks intentional but it&apos;s unclear to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thobbs&quot; class=&quot;user-hover&quot; rel=&quot;thobbs&quot;&gt;thobbs&lt;/a&gt; and myself why it&apos;s not a potentially breaking change, and even if it&apos;s a legit change, why it was done in 3.X (then trunk) but not 3.0?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;, can you enlighten us?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13026322">CASSANDRA-13013</key>
            <summary>Potential regression from CASSANDRA-6377</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blerer">Benjamin Lerer</assignee>
                                    <reporter username="slebresne">Sylvain Lebresne</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Dec 2016 10:50:35 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:13 +0000</updated>
                            <resolved>Fri, 27 Jan 2017 17:56:36 +0000</resolved>
                                        <fixVersion>3.10</fixVersion>
                                    <component>Legacy/CQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15728692" author="blerer" created="Wed, 7 Dec 2016 12:53:27 +0000"  >&lt;p&gt;To be honest, I am not sure to fully understand the problem. Do you have an example of a query on which we could have a regression?&lt;/p&gt;
</comment>
                            <comment id="15835912" author="blerer" created="Tue, 24 Jan 2017 09:45:29 +0000"  >&lt;p&gt;All my apologizes. I found the regression. It can be reproduced with the following test:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testIndexOnRegularColumnWithPartitionWithoutRows() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Throwable
    {
        createTable(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE %s (pk &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, c &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, s &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt;, v &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, PRIMARY KEY(pk, c))&quot;&lt;/span&gt;);
        createIndex(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE INDEX ON %s (v)&quot;&lt;/span&gt;);

        execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT INTO %s (pk, c, s, v) VALUES (?, ?, ?, ?)&quot;&lt;/span&gt;, 1, 1, 9, 1);
        execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT INTO %s (pk, c, s, v) VALUES (?, ?, ?, ?)&quot;&lt;/span&gt;, 1, 2, 9, 2);
        execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT INTO %s (pk, s) VALUES (?, ?)&quot;&lt;/span&gt;, 2, 9);
        execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT INTO %s (pk, c, s, v) VALUES (?, ?, ?, ?)&quot;&lt;/span&gt;, 3, 1, 9, 1);
        flush();

        execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;DELETE FROM %s WHERE pk = ? and c = ?&quot;&lt;/span&gt;, 3, 1);

        assertRows(execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM %s WHERE v = ?&quot;&lt;/span&gt;, 1),
                   row(1, 1, 9, 1));
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Waiting for CI to validate my patch.&lt;/p&gt;</comment>
                            <comment id="15836150" author="blerer" created="Tue, 24 Jan 2017 13:48:39 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.11&lt;/th&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...blerer:13013-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/blerer/job/blerer-13013-3.11-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/blerer/job/blerer-13013-3.11-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...blerer:13013-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/blerer/job/blerer-13013-trunk-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/blerer/job/blerer-13013-trunk-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;The patch restore the original check and add a some unit tests to ensure the correct behavior.&lt;/p&gt;</comment>
                            <comment id="15842446" author="slebresne" created="Fri, 27 Jan 2017 09:34:28 +0000"  >&lt;p&gt;The attached patch does properly revert things to the pre-&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6377&quot; title=&quot;ALLOW FILTERING should allow seq scan filtering&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6377&quot;&gt;&lt;del&gt;CASSANDRA-6377&lt;/del&gt;&lt;/a&gt; state for 3.X/trunk, but I&apos;ll note that the comment doesn&apos;t correspond exactly to the condition anymore (both because it doesn&apos;t mention the regular restriction conditions, but also because the comment suggests the &quot;static compact&quot; condition should take precedence on any other) and I&apos;d like to suggest we simplify this code by:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;creating a new &lt;tt&gt;StatementRestrictions.queriesFullPartitions()&lt;/tt&gt; method (that in practice would be &lt;tt&gt;!hasClusteringRestriction &amp;amp;&amp;amp; !hasRegularRestrictions&lt;/tt&gt;).&lt;/li&gt;
	&lt;li&gt;make the condition be &lt;tt&gt;queriesFullPartitions() || isStaticCompactTable&lt;/tt&gt;, which is more readable.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;But those are trivial changes and I&apos;m +1 on the patch in general so I&apos;m fine if you do those changes on commit.&lt;/p&gt;
</comment>
                            <comment id="15843187" author="blerer" created="Fri, 27 Jan 2017 17:56:36 +0000"  >&lt;p&gt;Committed into 3.11 at 77f0f68313a4c36bf86363e71f4775e36ccf85bc and merged into trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37adr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>