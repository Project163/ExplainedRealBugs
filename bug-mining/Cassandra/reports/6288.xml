<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:27:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-18741] Some unit tests create a heap dump each time</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-18741</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I noticed this by running out of space while working on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18706&quot; title=&quot;Test failure: org.apache.cassandra.cql3.ViewTest.testIgnoreUpdate-compression.jdk11 (from org.apache.cassandra.cql3.ViewTest-compression.jdk11)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18706&quot;&gt;&lt;del&gt;CASSANDRA-18706&lt;/del&gt;&lt;/a&gt;.  Something must be calling HeaupUtils.maybeCreateHeapDump because the build/test directory is littered with pidxxxx-epochxxxxxxxx.hprof files despite the tests not crashing.  I checked a couple other random tests, RandomSchemaTest also generates a dump but KeywordSplitTest does not.&lt;/p&gt;

&lt;p&gt;This behavior does not occur on 4.1.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13546817">CASSANDRA-18741</key>
            <summary>Some unit tests create a heap dump each time</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="maedhroz">Caleb Rackliffe</assignee>
                                    <reporter username="brandon.williams">Brandon Williams</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Aug 2023 11:32:16 +0000</created>
                <updated>Fri, 10 Oct 2025 19:07:13 +0000</updated>
                            <resolved>Fri, 11 Aug 2023 15:42:15 +0000</resolved>
                                        <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                    <fixVersion>5.1</fixVersion>
                                    <component>Test/unit</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17752812" author="brandon.williams" created="Thu, 10 Aug 2023 14:16:07 +0000"  >&lt;p&gt;This bisected to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17795&quot; title=&quot;Add ability to generate a one-time heap dump output to a file on Unhandled Exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17795&quot;&gt;&lt;del&gt;CASSANDRA-17795&lt;/del&gt;&lt;/a&gt;, which makes sense. /cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmckenzie&quot; class=&quot;user-hover&quot; rel=&quot;jmckenzie&quot;&gt;jmckenzie&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17752815" author="edimitrova" created="Thu, 10 Aug 2023 14:24:02 +0000"  >&lt;p&gt;The maybeCreateHeapDump was added only in 5.0 as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17795&quot; title=&quot;Add ability to generate a one-time heap dump output to a file on Unhandled Exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17795&quot;&gt;&lt;del&gt;CASSANDRA-17795&lt;/del&gt;&lt;/a&gt; - Add ability to generate a one-time heap dump output to a file on Unhandled Exceptions.&lt;br/&gt;
While running RandomSchemaTest, a breakpoint points to the JVMStabilityInspector and the Commit Log Service.&lt;br/&gt;
By default dump_heap_on_uncaught_exception is false.&lt;br/&gt;
Though in the logs of RandomSchemaTest it is indeed dump_heap_on_uncaught_exception=true and I can see that &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17795&quot; title=&quot;Add ability to generate a one-time heap dump output to a file on Unhandled Exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17795&quot;&gt;&lt;del&gt;CASSANDRA-17795&lt;/del&gt;&lt;/a&gt; set the flag to true for unit tests.&lt;/p&gt;</comment>
                            <comment id="17752816" author="edimitrova" created="Thu, 10 Aug 2023 14:24:42 +0000"  >&lt;p&gt;It seems our comments crashed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="17752823" author="brandon.williams" created="Thu, 10 Aug 2023 14:37:33 +0000"  >&lt;p&gt;I can see how setting it to true made sense for tests since if they do crash we probably want the dump, but I think in practice this instead just generates a lot of cruft we don&apos;t need or want.  I propose setting it to false in test/conf/cassandra.yaml.&lt;/p&gt;</comment>
                            <comment id="17752827" author="edimitrova" created="Thu, 10 Aug 2023 14:43:58 +0000"  >&lt;p&gt;It seems HeapUtilsTest sets it explicitly to true for testing  and then sets it back to false.&lt;br/&gt;
I agree we can probably set it to false iin the unit tests cassandra.yaml and revert only during debugging but let&apos;s see what &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmckenzie&quot; class=&quot;user-hover&quot; rel=&quot;jmckenzie&quot;&gt;jmckenzie&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt; miight have to say here. &lt;/p&gt;</comment>
                            <comment id="17752850" author="maedhroz" created="Thu, 10 Aug 2023 15:53:55 +0000"  >&lt;p&gt;That sounds fine to me...will push up a patch shortly...&lt;/p&gt;</comment>
                            <comment id="17752852" author="brandon.williams" created="Thu, 10 Aug 2023 15:55:34 +0000"  >&lt;p&gt;If we&apos;re just flipping a boolean in a config I think you&apos;re good to commit.&lt;/p&gt;</comment>
                            <comment id="17752854" author="edimitrova" created="Thu, 10 Aug 2023 15:57:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;If we&apos;re just flipping a boolean in a config I think you&apos;re good to commit.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17752856" author="maedhroz" created="Thu, 10 Aug 2023 15:58:38 +0000"  >&lt;p&gt;Patch: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2569&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2569&lt;/a&gt;&lt;br/&gt;
CI (unit tests only): &lt;a href=&quot;https://app.circleci.com/pipelines/github/maedhroz/cassandra?branch=CASSANDRA-18741-5.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/maedhroz/cassandra?branch=CASSANDRA-18741-5.0&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17753262" author="maedhroz" created="Fri, 11 Aug 2023 15:42:15 +0000"  >&lt;p&gt;Committed in &lt;a href=&quot;https://github.com/apache/cassandra/commit/f8d4e2a3c80d5d2be1e270e7ac601f4bc0a17fe7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/f8d4e2a3c80d5d2be1e270e7ac601f4bc0a17fe7&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13631261">CASSANDRA-20974</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[maedhroz]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 13 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1jphc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
        <customfieldvalue><![CDATA[e.dimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12351720">5.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/f8d4e2a3c80d5d2be1e270e7ac601f4bc0a17fe7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/f8d4e2a3c80d5d2be1e270e7ac601f4bc0a17fe7&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;n/a&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>