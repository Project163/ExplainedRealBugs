<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:37:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5211] Migrating Clusters with gossip tables that have old dead nodes causes NPE, inability to join cluster</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5211</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I had done a removetoken on this cluster when it was 1.1.x, and it had a &quot;ghost&quot; entry for the removed node still in the stored ring data. When the nodes loaded the table up after conversion to 1.2 and attempting to migrate to VNodes, I got the following traceback:&lt;/p&gt;

&lt;p&gt;ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/10.0.0.0&amp;#93;&lt;/span&gt; 2013-01-31 18:35:44,788 CassandraDaemon.java (line 133) Exception in thread Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/10.0.0.0,5,main&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.cassandra.utils.ByteBufferUtil.string(ByteBufferUtil.java:167)&lt;br/&gt;
	at org.apache.cassandra.utils.ByteBufferUtil.string(ByteBufferUtil.java:124)&lt;br/&gt;
	at org.apache.cassandra.cql.jdbc.JdbcUTF8.getString(JdbcUTF8.java:73)&lt;br/&gt;
	at org.apache.cassandra.cql.jdbc.JdbcUTF8.compose(JdbcUTF8.java:93)&lt;br/&gt;
	at org.apache.cassandra.db.marshal.UTF8Type.compose(UTF8Type.java:32)&lt;br/&gt;
	at org.apache.cassandra.cql3.UntypedResultSet$Row.getString(UntypedResultSet.java:96)&lt;br/&gt;
	at org.apache.cassandra.db.SystemTable.loadDcRackInfo(SystemTable.java:402)&lt;br/&gt;
	at org.apache.cassandra.locator.Ec2Snitch.getDatacenter(Ec2Snitch.java:117)&lt;br/&gt;
	at org.apache.cassandra.locator.DynamicEndpointSnitch.getDatacenter(DynamicEndpointSnitch.java:127)&lt;br/&gt;
	at org.apache.cassandra.net.OutboundTcpConnection.isLocalDC(OutboundTcpConnection.java:74)&lt;br/&gt;
	at org.apache.cassandra.net.OutboundTcpConnection.connect(OutboundTcpConnection.java:270)&lt;br/&gt;
	at org.apache.cassandra.net.OutboundTcpConnection.run(OutboundTcpConnection.java:142)&lt;/p&gt;

&lt;p&gt;This is because these ghost nodes had a NULL tokens list in the system/peers table. A workaround was to delete the offending row in the system/peers table and restart the node.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12630218">CASSANDRA-5211</key>
            <summary>Migrating Clusters with gossip tables that have old dead nodes causes NPE, inability to join cluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="rbranson">Rick Branson</reporter>
                        <labels>
                    </labels>
                <created>Thu, 31 Jan 2013 21:18:23 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:18 +0000</updated>
                            <resolved>Tue, 12 Feb 2013 22:55:49 +0000</resolved>
                                        <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13572413" author="brandon.williams" created="Wed, 6 Feb 2013 13:56:10 +0000"  >&lt;p&gt;Rick, I don&apos;t suppose you might happen to have one of these problem system tables left anywhere?  The trace indicates that the rack was missing but the dc wasn&apos;t, and we only write those together in a single insert.&lt;/p&gt;</comment>
                            <comment id="13572439" author="brandon.williams" created="Wed, 6 Feb 2013 14:20:44 +0000"  >&lt;p&gt;Confirmed that a null tokens list won&apos;t cause this.  Regardless of how we got here, it&apos;s more correct to confirm the existence of the dc and rack than just the dc, so patch to do so.&lt;/p&gt;</comment>
                            <comment id="13577101" author="jbellis" created="Tue, 12 Feb 2013 22:17:53 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13577134" author="brandon.williams" created="Tue, 12 Feb 2013 22:55:49 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12568226" name="5211.txt" size="756" author="brandon.williams" created="Wed, 6 Feb 2013 14:20:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>310714</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1hmfb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>311059</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>