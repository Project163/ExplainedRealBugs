<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:41:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-6260] Cassandra 2.0.1 OutOfMemoryError:  Requested array size exceeds VM limit</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-6260</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I am running cassandra 2.0.1 server with cascading client &lt;a href=&quot;https://github.com/ifesdjeen/cascading-cassandra/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ifesdjeen/cascading-cassandra/&lt;/a&gt; (v 1.0.0-rc6). I am running a problem on restarting one of the nodes in the cassandra cluster. All other nodes in the cluster started properly without any issues. I had originally assigned 8G of RAM to heap space. I tried starting the node with 12G of RAM but it still fails with the following error. This is currently blocking a production release so appreciate your quick response.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;(bloomreach-ami) ubuntu@ip-10-179-26-169 :/mnt/cassandra_latest&amp;#93;&lt;/span&gt;# ERROR 20:55:58,738 Exception encountered during startup&lt;br/&gt;
java.lang.OutOfMemoryError: Requested array size exceeds VM limit&lt;br/&gt;
        at org.apache.cassandra.utils.ByteBufferUtil.read(ByteBufferUtil.java:394)&lt;br/&gt;
        at org.apache.cassandra.utils.ByteBufferUtil.readWithLength(ByteBufferUtil.java:355)&lt;br/&gt;
        at org.apache.cassandra.service.CacheService$KeyCacheSerializer.deserialize(CacheService.java:352)&lt;br/&gt;
        at org.apache.cassandra.cache.AutoSavingCache.loadSaved(AutoSavingCache.java:119)&lt;br/&gt;
        at org.apache.cassandra.db.ColumnFamilyStore.&amp;lt;init&amp;gt;(ColumnFamilyStore.java:267)&lt;br/&gt;
        at org.apache.cassandra.db.ColumnFamilyStore.createColumnFamilyStore(ColumnFamilyStore.java:411)&lt;br/&gt;
        at org.apache.cassandra.db.ColumnFamilyStore.createColumnFamilyStore(ColumnFamilyStore.java:383)&lt;br/&gt;
        at org.apache.cassandra.db.Keyspace.initCf(Keyspace.java:314)&lt;br/&gt;
        at org.apache.cassandra.db.Keyspace.&amp;lt;init&amp;gt;(Keyspace.java:268)&lt;br/&gt;
        at org.apache.cassandra.db.Keyspace.open(Keyspace.java:110)&lt;br/&gt;
        at org.apache.cassandra.db.Keyspace.open(Keyspace.java:88)&lt;br/&gt;
        at org.apache.cassandra.db.SystemKeyspace.checkHealth(SystemKeyspace.java:474)&lt;br/&gt;
        at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:226)&lt;br/&gt;
        at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:442)&lt;br/&gt;
        at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:485)&lt;br/&gt;
 INFO 20:55:58,739 Initializing system.schema_triggers&lt;br/&gt;
java.lang.OutOfMemoryError: Requested array size exceeds VM limit&lt;br/&gt;
        at org.apache.cassandra.utils.ByteBufferUtil.read(ByteBufferUtil.java:394)&lt;br/&gt;
        at org.apache.cassandra.utils.ByteBufferUtil.readWithLength(ByteBufferUtil.java:355)&lt;br/&gt;
        at org.apache.cassandra.service.CacheService$KeyCacheSerializer.deserialize(CacheService.java:352)&lt;br/&gt;
        at org.apache.cassandra.cache.AutoSavingCache.loadSaved(AutoSavingCache.java:119)&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Cassandra server 2.0.1&lt;/p&gt;</environment>
        <key id="12676213">CASSANDRA-6260</key>
            <summary>Cassandra 2.0.1 OutOfMemoryError:  Requested array size exceeds VM limit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mishail">Mikhail Stepura</assignee>
                                    <reporter username="prateek@bloomreach.com">Prateek</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Oct 2013 20:57:49 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:01 +0000</updated>
                            <resolved>Thu, 31 Oct 2013 13:43:21 +0000</resolved>
                                        <fixVersion>2.0.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13808113" author="iflatness" created="Tue, 29 Oct 2013 15:51:18 +0000"  >&lt;p&gt;I have gotten the same error with the nodes on my cluster.&lt;/p&gt;

&lt;p&gt;The cluster is running 2.0.1, and the error started on 28.10.2013 for me as well.&lt;br/&gt;
My machines are each running with heaps of 512mb, and that was consistent with how they were before the restart. On initialization system memory drops extremely low right before the error output (after which java stops and the memory is freed). There are 4 machines in my cluster and the partitioner is Murmur3.&lt;/p&gt;

&lt;p&gt;&lt;del&gt;On 2 of the nodes, a different error is thrown&lt;/del&gt; Upgrading to 2.0.2 fixed the other error. The heap error is unchanged with the upgrade to 2.0.2&lt;/p&gt;
</comment>
                            <comment id="13808436" author="jbellis" created="Tue, 29 Oct 2013 20:48:37 +0000"  >&lt;p&gt;Since the problem is reading the key cache, deleting it is an easy workaround.&lt;/p&gt;</comment>
                            <comment id="13808793" author="mishail" created="Wed, 30 Oct 2013 06:38:51 +0000"  >&lt;p&gt;Patch to check if the length of array from DataInput doesn&apos;t exceed the limit&lt;/p&gt;</comment>
                            <comment id="13809216" author="jbellis" created="Wed, 30 Oct 2013 15:26:43 +0000"  >&lt;p&gt;Seriously, people are corrupting their key cache files with a length between maxint and maxint-8?  Isn&apos;t that ridiculously unlikely?&lt;/p&gt;</comment>
                            <comment id="13809504" author="mishail" created="Wed, 30 Oct 2013 19:16:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbellis&quot; class=&quot;user-hover&quot; rel=&quot;jbellis&quot;&gt;jbellis&lt;/a&gt; Should we validate that key size is under 64K? (&lt;a href=&quot;http://wiki.apache.org/cassandra/FAQ#max_key_size&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/cassandra/FAQ#max_key_size&lt;/a&gt;) &lt;/p&gt;</comment>
                            <comment id="13809509" author="brandon.williams" created="Wed, 30 Oct 2013 19:31:07 +0000"  >&lt;p&gt;Sounds reasonable to me.&lt;/p&gt;</comment>
                            <comment id="13809950" author="mishail" created="Thu, 31 Oct 2013 05:42:40 +0000"  >&lt;p&gt;Validate that &lt;tt&gt;keyLength &amp;lt;= FBUtilities.MAX_UNSIGNED_SHORT&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="13810244" author="jbellis" created="Thu, 31 Oct 2013 13:43:21 +0000"  >&lt;p&gt;committed; thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12611255" name="cassandra-2.0-6260-keyLength.patch" size="2275" author="mishail" created="Thu, 31 Oct 2013 05:42:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[mishail]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>355710</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 3 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1pbn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>355998</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324542">2.0.1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>