<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:06:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13233] Improve testing on macOS by eliminating sigar logging</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13233</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;The changes introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7838&quot; title=&quot;Warn user when OS settings are poor / integrate sigar&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7838&quot;&gt;&lt;del&gt;CASSANDRA-7838&lt;/del&gt;&lt;/a&gt; (Resolved; Fixed; 2.2.0 beta 1): &quot;Warn user when OS settings are poor / integrate sigar&quot; are not Mac friendly.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
INFO  [main] 2016-10-18T11:20:10,330 SigarLibrary.java:44 - Initializing SIGAR library
DEBUG [main] 2016-10-18T11:20:10,342 SigarLog.java:60 - no libsigar-universal64-macosx.dylib in java.library.path
org.hyperic.sigar.SigarException: no libsigar-universal64-macosx.dylib in java.library.path
        at org.hyperic.sigar.Sigar.loadLibrary(Sigar.java:172) ~[sigar-1.6.4.jar:?]
        at org.hyperic.sigar.Sigar.&amp;lt;clinit&amp;gt;(Sigar.java:100) [sigar-1.6.4.jar:?]
        at org.apache.cassandra.utils.SigarLibrary.&amp;lt;init&amp;gt;(SigarLibrary.java:47) [main/:?]
        at org.apache.cassandra.utils.SigarLibrary.&amp;lt;clinit&amp;gt;(SigarLibrary.java:28) [main/:?]
        at org.apache.cassandra.utils.UUIDGen.hash(UUIDGen.java:363) [main/:?]
        at org.apache.cassandra.utils.UUIDGen.makeNode(UUIDGen.java:342) [main/:?]
        at org.apache.cassandra.utils.UUIDGen.makeClockSeqAndNode(UUIDGen.java:291) [main/:?]
        at org.apache.cassandra.utils.UUIDGen.&amp;lt;clinit&amp;gt;(UUIDGen.java:42) [main/:?]
        at org.apache.cassandra.config.CFMetaData$Builder.build(CFMetaData.java:1278) [main/:?]
        at org.apache.cassandra.SchemaLoader.standardCFMD(SchemaLoader.java:369) [classes/:?]
        at org.apache.cassandra.SchemaLoader.standardCFMD(SchemaLoader.java:356) [classes/:?]
        at org.apache.cassandra.SchemaLoader.standardCFMD(SchemaLoader.java:351) [classes/:?]
        at org.apache.cassandra.batchlog.BatchTest.defineSchema(BatchTest.java:59) [classes/:?]
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_66]
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_66]
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_66]
        at java.lang.reflect.Method.invoke(Method.java:497) ~[?:1.8.0_66]
        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44) [junit-4.6.jar:?]
        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15) [junit-4.6.jar:?]
        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41) [junit-4.6.jar:?]
        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27) [junit-4.6.jar:?]
        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31) [junit-4.6.jar:?]
        at org.junit.runners.ParentRunner.run(ParentRunner.java:220) [junit-4.6.jar:?]
        at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39) [junit-4.6.jar:?]
        at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:535) [ant-junit.jar:?]
        at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:1182) [ant-junit.jar:?]
        at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:1033) [ant-junit.jar:?]
INFO  [main] 2016-10-18T11:20:10,350 SigarLibrary.java:57 - Could not initialize SIGAR library org.hyperic.sigar.Sigar.getFileSystemListNative()[Lorg/hyperic/sigar/FileSystem;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There are 2 issues addressed by the attached patch:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Create platform aware (windows, Darwin, linux) implementations of CLibrary (for instance CLibrary today assumes all platforms have support for posix_fadvise but this doesn&apos;t exist in the Darwin kernel). If methods are defined with the &quot;native&quot; JNI keyword in java when the class is loaded it will cause our jna check to fail incorrectly making all of CLibrary &quot;disabled&quot; even though because jnaAvailable = false even though on a platform like Darwin all of the native methods except posix_fadvise are supported.&lt;/li&gt;
	&lt;li&gt;Replace sigar usage to get current pid with calls to CLibrary/native equivalent &amp;#8211; and fall back to Sigar for platforms like Windows who don&apos;t have that support with JDK8 (and without a CLibrary equivalent)&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="13043791">CASSANDRA-13233</key>
            <summary>Improve testing on macOS by eliminating sigar logging</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mkjellman">Michael Kjellman</assignee>
                                    <reporter username="mkjellman">Michael Kjellman</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Feb 2017 23:14:41 +0000</created>
                <updated>Fri, 15 May 2020 08:00:48 +0000</updated>
                            <resolved>Thu, 16 Mar 2017 20:50:41 +0000</resolved>
                                        <fixVersion>3.0.12</fixVersion>
                    <fixVersion>3.11.0</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15893144" author="jasobrown" created="Thu, 2 Mar 2017 22:18:33 +0000"  >&lt;p&gt;Created branches for testing&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.11&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasobrown/cassandra/tree/13233-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasobrown/cassandra/tree/13233-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasobrown/cassandra/tree/13233-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/jasobrown/job/jasobrown-13233-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/jasobrown/job/jasobrown-13233-3.11-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/jasobrown/job/jasobrown-13233-trunk-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/jasobrown/job/jasobrown-13233-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/jasobrown/job/jasobrown-13233-3.11-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/jasobrown/job/jasobrown-13233-trunk-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15893167" author="jasobrown" created="Thu, 2 Mar 2017 22:34:24 +0000"  >&lt;p&gt;On the whole, this is pretty good, but why did you remove the class member constants &lt;tt&gt;FILE_DESCRIPTOR_FD_FIELD&lt;/tt&gt; and &lt;tt&gt;FILE_CHANNEL_FD_FIELD&lt;/tt&gt; from &lt;tt&gt;CLIbrary&lt;/tt&gt;? The code now needs to get the protected field on every invocation of &lt;tt&gt;getfd(FileChannel)&lt;/tt&gt; and  &lt;tt&gt;getfd(FileDescriptor)&lt;/tt&gt;. Is there something inherently more safe in fetching the reference to the &lt;tt&gt;Field&lt;/tt&gt; on every invocation?&lt;/p&gt;</comment>
                            <comment id="15893189" author="mkjellman" created="Thu, 2 Mar 2017 22:51:01 +0000"  >&lt;p&gt;No, I don&apos;t know why I did that looking at it now. Weird I&apos;d do that though... Testing it now...&lt;/p&gt;</comment>
                            <comment id="15893204" author="mkjellman" created="Thu, 2 Mar 2017 23:07:37 +0000"  >&lt;p&gt;Attaching an updated patch to add the class member constants back. Looks like this was changed to use a static constant vs calling getField each time in some 3.x version &amp;#8211; which was after I did the initial patch back on 2.1 and I just didn&apos;t catch it when I rebased the patch for trunk.&lt;/p&gt;</comment>
                            <comment id="15893232" author="jasobrown" created="Thu, 2 Mar 2017 23:25:55 +0000"  >&lt;p&gt;Alright cool, looks like those changes came in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12342&quot; title=&quot;CLibrary improvements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12342&quot;&gt;&lt;del&gt;CASSANDRA-12342&lt;/del&gt;&lt;/a&gt;. As I&apos;m planning to fix this for 3.0+, in 3.0 we&apos;ll leave it as the functions keep fetching the &lt;tt&gt;Field&lt;/tt&gt; ref on every invocation, and 3.11/trunk we&apos;ll use the class member constants. I&apos;ll update branches for cassci and rerun the tests shortly.&lt;/p&gt;</comment>
                            <comment id="15894885" author="jasobrown" created="Fri, 3 Mar 2017 19:23:39 +0000"  >&lt;p&gt;Committed as sha &lt;tt&gt;e3968cfd1e786f260029cf8cde4164719ae56c53&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mkjellman&quot; class=&quot;user-hover&quot; rel=&quot;mkjellman&quot;&gt;mkjellman&lt;/a&gt; feel free to change to subject of this ticket to something more apropos. It&apos;ll be the current name in the git history and CHANGES.txt, but the jira could have more more descriptive if you think it&apos;ll help. naming is hard &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15926227" author="blerer" created="Wed, 15 Mar 2017 14:08:23 +0000"  >&lt;p&gt;Reopening as the patch prevent Cassandra to start on Windows.&lt;/p&gt;</comment>
                            <comment id="15926420" author="mkjellman" created="Wed, 15 Mar 2017 16:00:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt; Can you create/clone to another JIRA for us to track the Windows regression you&apos;re seeing instead please? Do you have a stack trace?&lt;/p&gt;</comment>
                            <comment id="15926515" author="blerer" created="Wed, 15 Mar 2017 16:32:33 +0000"  >&lt;p&gt;I have opened: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13333&quot; title=&quot;Cassandra does not start on Windows due to &amp;#39;JNA link failure&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13333&quot;&gt;&lt;del&gt;CASSANDRA-13333&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12853155" name="28827709.diff" size="28257" author="mkjellman" created="Thu, 16 Feb 2017 23:14:41 +0000"/>
                            <attachment id="12855721" name="CASSANDRA-13233-trunk-v2.diff" size="27419" author="mkjellman" created="Thu, 2 Mar 2017 23:04:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[mkjellman]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 35 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3a7dr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jasobrown</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jasobrown]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>