<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:11:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-337] Make BinaryMemtable work</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-337</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description></description>
                <environment></environment>
        <key id="12432082">CASSANDRA-337</key>
            <summary>Make BinaryMemtable work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lenn0x">Chris Goffinet</assignee>
                                    <reporter username="jbellis">Jonathan Ellis</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Aug 2009 19:42:57 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:35 +0000</updated>
                            <resolved>Fri, 28 Aug 2009 16:28:31 +0000</resolved>
                                        <fixVersion>0.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12738546" author="jbellis" created="Mon, 3 Aug 2009 20:03:12 +0000"  >&lt;p&gt;my humble contribution to the cleanup: use CFS executor for BMt flushes&lt;/p&gt;</comment>
                            <comment id="12741891" author="jbellis" created="Tue, 11 Aug 2009 14:19:10 +0000"  >&lt;p&gt;rebased&lt;/p&gt;</comment>
                            <comment id="12741949" author="urandom" created="Tue, 11 Aug 2009 16:35:02 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12741962" author="euphoria" created="Tue, 11 Aug 2009 16:55:32 +0000"  >&lt;p&gt;I don&apos;t understand the scope of this issue and the submitted patches.  Can anyone elaborate?&lt;/p&gt;</comment>
                            <comment id="12741968" author="jbellis" created="Tue, 11 Aug 2009 17:16:44 +0000"  >&lt;p&gt;BinaryMemtable is intended to allow writing pre-serialized data, but FB never really cleaned it up to make it useful for anyone but them.  Chris has done that and this ticket is to remind him to post diffs.&lt;/p&gt;

&lt;p&gt;My patch just removes an unnecessary extra executor and class and has BMt use the CFS executor for flushes like normal Mt.&lt;/p&gt;</comment>
                            <comment id="12741970" author="jbellis" created="Tue, 11 Aug 2009 17:17:34 +0000"  >&lt;p&gt;committed the CFS patch.&lt;/p&gt;</comment>
                            <comment id="12741987" author="lenn0x" created="Tue, 11 Aug 2009 17:41:47 +0000"  >&lt;p&gt;-1&lt;/p&gt;

&lt;p&gt;This should be reverted. As my discussion with Jonathan,  we want to make the Binary Memtable Flusher thread configurable, and we wouldn&apos;t want to have it under the same path as cfStore, since that should be a different tunable. I&apos;ll have my patches ready later this week for Binary Memtable work we have done at Digg.&lt;/p&gt;</comment>
                            <comment id="12742333" author="hudson" created="Wed, 12 Aug 2009 13:08:26 +0000"  >&lt;p&gt;Integrated in Cassandra #165 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/165/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/165/&lt;/a&gt;)&lt;br/&gt;
    use CFS executor for BMt flushes.&lt;br/&gt;
patch by jbellis; reviewed by Eric Evans for &lt;/p&gt;</comment>
                            <comment id="12747210" author="lenn0x" created="Tue, 25 Aug 2009 03:37:39 +0000"  >&lt;p&gt;Working version of BMT that we are running at Digg. Hopefully I didn&apos;t miss anything. Wanted to post this before I forget about it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12747212" author="lenn0x" created="Tue, 25 Aug 2009 03:43:00 +0000"  >&lt;p&gt;Example of using BMT:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://github.com/lenn0x/Cassandra-Hadoop-BMT/tree/master&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://github.com/lenn0x/Cassandra-Hadoop-BMT/tree/master&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12747642" author="jbellis" created="Tue, 25 Aug 2009 21:07:34 +0000"  >&lt;p&gt;is there overlap b/t this and &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-342&quot; title=&quot;hadoop integration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-342&quot;&gt;&lt;del&gt;CASSANDRA-342&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="12747713" author="lenn0x" created="Tue, 25 Aug 2009 23:47:06 +0000"  >&lt;p&gt;Looking at his code, no. I made some minor interface changes such as flushBinary() public but everything I have done affects the BMT work already there. He seems to be adding functionality, I have no Hadoop code in my BMT.&lt;/p&gt;</comment>
                            <comment id="12747783" author="jmhodges" created="Wed, 26 Aug 2009 05:23:55 +0000"  >&lt;p&gt;Yeah, this looks to be clear of any interaction with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-342&quot; title=&quot;hadoop integration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-342&quot;&gt;&lt;del&gt;CASSANDRA-342&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12747798" author="lenn0x" created="Wed, 26 Aug 2009 06:39:34 +0000"  >&lt;p&gt;Forgot to add the flushAndShutdown method&lt;/p&gt;</comment>
                            <comment id="12747948" author="johanoskarsson" created="Wed, 26 Aug 2009 13:57:25 +0000"  >&lt;p&gt;I assume the two last patches are to be applied together? If I try to build trunk + those patches I get the following error:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; /home/cassandra/cassandra-trunk/src/java/org/apache/cassandra/net/MessagingService.java:505: cannot find symbol&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; symbol  : method getConnections()&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; location: class org.apache.cassandra.net.TcpConnectionManager&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;             for(TcpConnection connection: entry.getValue().getConnections())&lt;/p&gt;</comment>
                            <comment id="12747991" author="lenn0x" created="Wed, 26 Aug 2009 15:47:40 +0000"  >&lt;p&gt;Fixed, forgot the getConnections&lt;/p&gt;</comment>
                            <comment id="12748466" author="lenn0x" created="Thu, 27 Aug 2009 17:29:31 +0000"  >&lt;p&gt;Removed decorateKey() in writer.append&lt;/p&gt;</comment>
                            <comment id="12748551" author="jbellis" created="Thu, 27 Aug 2009 20:17:02 +0000"  >&lt;p&gt;I still don&apos;t see any reason to use separate executors for BMT flush and normal MT.  In fact I was thinking normal MT should probably have threads = #disks.  (Why do you use 2x?)  I&apos;d favor keeping a single executor, with configurable thread count.&lt;/p&gt;</comment>
                            <comment id="12748578" author="lenn0x" created="Thu, 27 Aug 2009 21:23:06 +0000"  >&lt;p&gt;I can live with merging the executors for BMT flush and normal MT. Though I want the ability to specify a min and max for the threads in storage-conf.xml. During an import, we would want the ability to have a certain quality of service (I want a min of 4 threads during normal usage, but when we start binary import, I want a higher thread count). &lt;/p&gt;

&lt;p&gt;Merging both executors makes it a little harder, but the benefit is less code/cruft to manage &amp;#8211; that&apos;s a win for sure. When we were benchmarking our 7 node cluster with 600-800Mb/s per node we saw lower memory usage/better throughput on the flushing by having 2 threads per disk.&lt;/p&gt;

&lt;p&gt;If this is acceptable (above) I can submit a patch.&lt;/p&gt;</comment>
                            <comment id="12748581" author="jbellis" created="Thu, 27 Aug 2009 21:29:02 +0000"  >&lt;p&gt;&amp;gt; I want the ability to specify a min and max for the threads in storage-conf.xml&lt;/p&gt;

&lt;p&gt;works for me.&lt;/p&gt;</comment>
                            <comment id="12748633" author="lenn0x" created="Fri, 28 Aug 2009 01:18:11 +0000"  >&lt;p&gt;Refactored, and merged BMT to MT codepath. Added FlushMinThreads and FlushMaxThreads.&lt;/p&gt;</comment>
                            <comment id="12748866" author="jbellis" created="Fri, 28 Aug 2009 15:48:00 +0000"  >&lt;p&gt;looking good.  here is my version with light cleanup done.&lt;/p&gt;

&lt;p&gt;but I don&apos;t see a way to check if a flushandshutdown is complete, and it&apos;s safe to kill the node?&lt;/p&gt;

&lt;p&gt;should we make           logger_.debug(&quot;Shutdown invocation complete.&quot;);&lt;/p&gt;

&lt;p&gt;run at info level instead of debug?  or something more sophisticated?&lt;/p&gt;</comment>
                            <comment id="12748871" author="lenn0x" created="Fri, 28 Aug 2009 16:08:54 +0000"  >&lt;p&gt;I think going to logger_.info would be fine. Me and Sammy plan on opening another ticket for better shutdown support in Cassandra. We could get more sophisticated there.&lt;/p&gt;</comment>
                            <comment id="12748883" author="jbellis" created="Fri, 28 Aug 2009 16:28:30 +0000"  >&lt;p&gt;committed v3 w/ the log info change.&lt;/p&gt;

&lt;p&gt;do you want to submit the demo from github for contrib/ in another ticket?&lt;/p&gt;</comment>
                            <comment id="12748895" author="lenn0x" created="Fri, 28 Aug 2009 16:43:04 +0000"  >&lt;p&gt;Sure thing. See &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-398&quot; title=&quot;Submit BinaryMemtable Example for contrib/&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-398&quot;&gt;&lt;del&gt;CASSANDRA-398&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12749118" author="hudson" created="Sat, 29 Aug 2009 12:35:41 +0000"  >&lt;p&gt;Integrated in Cassandra #181 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/181/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/181/&lt;/a&gt;)&lt;br/&gt;
    Fixes to make BinaryMemtable useful.  Highlights are configurable threads for &lt;span class=&quot;error&quot;&gt;&amp;#91;binary&amp;#93;&lt;/span&gt;memtable flushing and flushAndShutdown JMX/nodeprobe directive.&lt;br/&gt;
patch by Chris Goffinet; reviewed by jbellis for &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12417945" name="0001-Refactored-and-merged-BMT-to-MT-codepath-v3.patch" size="14740" author="lenn0x" created="Fri, 28 Aug 2009 01:18:11 +0000"/>
                            <attachment id="12417565" name="0001-Working-version-of-BMT.patch" size="14390" author="lenn0x" created="Tue, 25 Aug 2009 03:37:38 +0000"/>
                            <attachment id="12417746" name="0002-Added-flushAndshutdown-v2.patch" size="2336" author="lenn0x" created="Wed, 26 Aug 2009 15:47:40 +0000"/>
                            <attachment id="12417901" name="0003-Removed-decorateKey-in-writer.append-in-BMT.patch" size="1035" author="lenn0x" created="Thu, 27 Aug 2009 17:29:31 +0000"/>
                            <attachment id="12416204" name="337-rebased.patch" size="5321" author="jbellis" created="Tue, 11 Aug 2009 14:19:10 +0000"/>
                            <attachment id="12417996" name="337-v3.patch" size="13524" author="jbellis" created="Fri, 28 Aug 2009 15:45:34 +0000"/>
                            <attachment id="12415399" name="337.patch" size="5314" author="jbellis" created="Mon, 3 Aug 2009 20:03:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[lenn0x]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19640</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 13 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0fybj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>91158</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>