<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:13:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-1147] cassandra cannot bootstrap when using DatacenterShardStrategy</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-1147</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;If C is configured to use DSS, the bootstrap process never completes.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12465832">CASSANDRA-1147</key>
            <summary>cassandra cannot bootstrap when using DatacenterShardStrategy</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mdennis">Matthew F. Dennis</assignee>
                                    <reporter username="mdennis">Matthew F. Dennis</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Jun 2010 07:03:34 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:22 +0000</updated>
                            <resolved>Mon, 14 Jun 2010 21:52:45 +0000</resolved>
                                        <fixVersion>0.7 beta 1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12873902" author="mdennis" created="Tue, 1 Jun 2010 07:08:07 +0000"  >&lt;p&gt;patch caches endpoints for getNaturalEndpoints (cleared on config or ring change) without requiring dcTokens/loadEndpoints and removes the need for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1137&quot; title=&quot;add ability to update DSS.dcTokens as new endpoints are added&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1137&quot;&gt;&lt;del&gt;CASSANDRA-1137&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12873983" author="jbellis" created="Tue, 1 Jun 2010 13:15:29 +0000"  >&lt;p&gt;how does&lt;/p&gt;

&lt;p&gt;         assert strategy.getReplicationFactor(&quot;DC1&quot;, table) == 3;&lt;/p&gt;

&lt;p&gt;work when you&apos;re hardcoding it to 6 in the subclass?&lt;/p&gt;</comment>
                            <comment id="12874032" author="mdennis" created="Tue, 1 Jun 2010 14:35:38 +0000"  >&lt;p&gt;different methods.  the assert is for grf(String dc, String table) and corresponds to datacenters.properties the override is for grf(String table) and corresponds to replication_factor in cassandra.yaml&lt;/p&gt;</comment>
                            <comment id="12874060" author="jbellis" created="Tue, 1 Jun 2010 15:15:32 +0000"  >&lt;p&gt;could we just make DSS return sum(dc replication for table) as RF(table), for now?&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1066&quot; title=&quot;DatacenterShardStrategy needs enforceable and keyspace based RF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1066&quot;&gt;&lt;del&gt;CASSANDRA-1066&lt;/del&gt;&lt;/a&gt; should resolve this eventually by allowing us to move datacenter.properties into cassandra.yaml, and drop the per-table RF for strategies that it doesn&apos;t make sense for)&lt;/p&gt;</comment>
                            <comment id="12874221" author="mdennis" created="Tue, 1 Jun 2010 20:29:58 +0000"  >&lt;p&gt;patch2 against trunk r950215&lt;/p&gt;</comment>
                            <comment id="12875447" author="jbellis" created="Fri, 4 Jun 2010 03:06:21 +0000"  >&lt;p&gt;caching natural endpoints seems like something we should put in AbstractReplicationStrategy for everyone.  what do you think?&lt;/p&gt;

&lt;p&gt;(Given &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1014&quot; title=&quot;GC storming, possible memory leak&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1014&quot;&gt;&lt;del&gt;CASSANDRA-1014&lt;/del&gt;&lt;/a&gt; I&apos;m mildly excited about the opportunity to reduce the per-request garbage generated, by not rebuilding a fresh list every time.)&lt;/p&gt;

&lt;p&gt;+        //is a new list required each time? (other strats do it)&lt;br/&gt;
+        //perhaps just an unmodifiable list?&lt;/p&gt;

&lt;p&gt;yes, it&apos;s required, because it&apos;s going to be passed to sortByProximity.&lt;/p&gt;

&lt;p&gt;+            total+=repFactor;&lt;/p&gt;

&lt;p&gt;operator spacing please &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;+        System.out.println(&quot;endpoints: &quot; + endpoints);&lt;/p&gt;

&lt;p&gt;r/m this.&lt;/p&gt;</comment>
                            <comment id="12878502" author="mdennis" created="Mon, 14 Jun 2010 07:31:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1147&quot; title=&quot;cassandra cannot bootstrap when using DatacenterShardStrategy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1147&quot;&gt;&lt;del&gt;CASSANDRA-1147&lt;/del&gt;&lt;/a&gt;.patch3 implements caching and tests for all replication strategies&lt;/p&gt;</comment>
                            <comment id="12878630" author="jbellis" created="Mon, 14 Jun 2010 16:20:20 +0000"  >&lt;p&gt;please fix re-ordering imports incorrectly.  correct order is&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;java&lt;/li&gt;
	&lt;li&gt;org.apache.commons&lt;/li&gt;
	&lt;li&gt;org.apache.slf4j&lt;/li&gt;
	&lt;li&gt;org.junit&lt;/li&gt;
	&lt;li&gt;everything else alphabetically&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;(&lt;a href=&quot;http://wiki.apache.org/cassandra/CodeStyle&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/cassandra/CodeStyle&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12878653" author="mdennis" created="Mon, 14 Jun 2010 17:40:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1147&quot; title=&quot;cassandra cannot bootstrap when using DatacenterShardStrategy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1147&quot;&gt;&lt;del&gt;CASSANDRA-1147&lt;/del&gt;&lt;/a&gt;.patch4 follows coding convention for imports&lt;/p&gt;

&lt;p&gt;(note: the patch produced by &quot;svn diff&quot; was not originally usable because of the line endings in RackAwareStrategyTest so dos2unix was run on the patch)&lt;/p&gt;</comment>
                            <comment id="12878760" author="jbellis" created="Mon, 14 Jun 2010 21:51:27 +0000"  >&lt;p&gt;Fix using rack as a key to datacenters map&lt;/p&gt;

&lt;p&gt;Fix returning multiple copies of the same endpoint from DSS; refactored calculateNaturalEndpoints to return a Set to make it more clear that this is not allowed&lt;/p&gt;

&lt;p&gt;simplified DSS.cNE and made it not put more replicas in a DC than are configured&lt;/p&gt;

&lt;p&gt;Use NBHM instead of ConcurrentHM in ARS&lt;/p&gt;

&lt;p&gt;Use map.clear instead of AtomicReference + creating a new map in ARS (clear is a very rare operation, better to make that a little slower in exchange for not having to do an extra, fenced dereference on the common ops)&lt;/p&gt;

&lt;p&gt;Removed unused unregister method from IEPS&lt;/p&gt;

&lt;p&gt;Removed interfaces with a single implementor (ARS)&lt;/p&gt;

&lt;p&gt;Cleaned up formatting&lt;/p&gt;</comment>
                            <comment id="12878761" author="jbellis" created="Mon, 14 Jun 2010 21:52:45 +0000"  >&lt;p&gt;committed w/ above changes&lt;/p&gt;</comment>
                            <comment id="12878965" author="hudson" created="Tue, 15 Jun 2010 12:51:23 +0000"  >&lt;p&gt;Integrated in Cassandra #466 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/466/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/466/&lt;/a&gt;)&lt;br/&gt;
    avoid allowing endpoints computed from old token map to persist after clearCachedEndpoints.  patch by mdennis and jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1147&quot; title=&quot;cassandra cannot bootstrap when using DatacenterShardStrategy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1147&quot;&gt;&lt;del&gt;CASSANDRA-1147&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
Fix bootstrap with DSS and add endpoint caching.&lt;br/&gt;
patch by mdennis and jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1147&quot; title=&quot;cassandra cannot bootstrap when using DatacenterShardStrategy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1147&quot;&gt;&lt;del&gt;CASSANDRA-1147&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12447071" name="0002-1147.txt" size="28641" author="jbellis" created="Mon, 14 Jun 2010 21:51:27 +0000"/>
                            <attachment id="12446001" name="CASSANDRA-1147.patch" size="14521" author="mdennis" created="Tue, 1 Jun 2010 07:08:07 +0000"/>
                            <attachment id="12446061" name="CASSANDRA-1147.patch2" size="13787" author="mdennis" created="Tue, 1 Jun 2010 20:29:58 +0000"/>
                            <attachment id="12447007" name="CASSANDRA-1147.patch3" size="62037" author="mdennis" created="Mon, 14 Jun 2010 07:31:15 +0000"/>
                            <attachment id="12447043" name="CASSANDRA-1147.patch4" size="67259" author="mdennis" created="Mon, 14 Jun 2010 17:40:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[mdennis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20008</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 24 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g3a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>91962</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>