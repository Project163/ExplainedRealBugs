<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:05:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-12651] Failure in SecondaryIndexTest.testAllowFilteringOnPartitionKeyWithSecondaryIndex</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-12651</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;This has failed with/without compression.&lt;/p&gt;

&lt;p&gt;Stacktrace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;junit.framework.AssertionFailedError: Got less rows than expected. Expected 2 but got 0
	at org.apache.cassandra.cql3.CQLTester.assertRows(CQLTester.java:909)
	at org.apache.cassandra.cql3.validation.entities.SecondaryIndexTest.lambda$testAllowFilteringOnPartitionKeyWithSecondaryIndex$78(SecondaryIndexTest.java:1228)
	at org.apache.cassandra.cql3.validation.entities.SecondaryIndexTest$$Lambda$293/218688965.apply(Unknown Source)
	at org.apache.cassandra.cql3.CQLTester.beforeAndAfterFlush(CQLTester.java:1215)
	at org.apache.cassandra.cql3.validation.entities.SecondaryIndexTest.testAllowFilteringOnPartitionKeyWithSecondaryIndex(SecondaryIndexTest.java:1218)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Examples:&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/job/trunk_testall/1176/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_testall/1176/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/job/trunk_testall/1176/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex_compression/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_testall/1176/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex_compression/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/job/trunk_testall/1219/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_testall/1219/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/job/trunk_testall/1216/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_testall/1216/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/job/trunk_testall/1208/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_testall/1208/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/job/trunk_testall/1176/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_testall/1176/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/job/trunk_testall/1175/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_testall/1175/testReport/org.apache.cassandra.cql3.validation.entities/SecondaryIndexTest/testAllowFilteringOnPartitionKeyWithSecondaryIndex/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;May or may not be related, but there&apos;s a test failure (index duplicate):&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/carlyeks/job/carlyeks-ticket-11803-3.X-testall/lastCompletedBuild/testReport/org.apache.cassandra.index.internal/CassandraIndexTest/indexOnFirstClusteringColumn_compression/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Dev/view/carlyeks/job/carlyeks-ticket-11803-3.X-testall/lastCompletedBuild/testReport/org.apache.cassandra.index.internal/CassandraIndexTest/indexOnFirstClusteringColumn_compression/&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/job/ifesdjeen-11803-test-fix-trunk-testall/1/testReport/junit/org.apache.cassandra.index.internal/CassandraIndexTest/indexOnFirstClusteringColumn_compression/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/ifesdjeen-11803-test-fix-trunk-testall/1/testReport/junit/org.apache.cassandra.index.internal/CassandraIndexTest/indexOnFirstClusteringColumn_compression/&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13005339">CASSANDRA-12651</key>
            <summary>Failure in SecondaryIndexTest.testAllowFilteringOnPartitionKeyWithSecondaryIndex</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="samt">Sam Tunnicliffe</assignee>
                                    <reporter username="jkni">Joel Knighton</reporter>
                        <labels>
                            <label>test-failure</label>
                    </labels>
                <created>Fri, 16 Sep 2016 05:19:50 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:19 +0000</updated>
                            <resolved>Tue, 29 Nov 2016 17:26:53 +0000</resolved>
                                        <fixVersion>3.0.11</fixVersion>
                    <fixVersion>3.10</fixVersion>
                                    <component>Legacy/Testing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15604660" author="ifesdjeen" created="Tue, 25 Oct 2016 08:34:38 +0000"  >&lt;p&gt;I&apos;ve tried to track the problem down, although it&apos;s flaking quite infrequently. So far I have several &quot;working hypotheses&quot;, one of them is that that we have name clashes. There&apos;s some evidence to name clashes &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/carlyeks/job/carlyeks-ticket-11803-3.X-testall/lastCompletedBuild/testReport/org.apache.cassandra.index.internal/CassandraIndexTest/indexOnFirstClusteringColumn_compression/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; and &lt;a href=&quot;http://cassci.datastax.com/job/ifesdjeen-11803-test-fix-trunk-testall/1/testReport/junit/org.apache.cassandra.index.internal/CassandraIndexTest/indexOnFirstClusteringColumn_compression/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. &lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ifesdjeen/cassandra/commits/12651-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-12651-trunk-improved-testall/4/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;(dtest is not applicable since only test code was changed)&lt;/p&gt;

&lt;p&gt;Since the test fails quite infrequently, I just keep re-running with some code wrapped around the mentioned failure to re-try multiple times to gather more data. However, with this patch I could not reproduce after 30 test runs. I&apos;ll keep trying though.&lt;/p&gt;</comment>
                            <comment id="15651477" author="beobal" created="Wed, 9 Nov 2016 17:11:01 +0000"  >&lt;p&gt;I&apos;m not convinced that the issue is a name clash. Where we&apos;ve previously seen name clashes (&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12834&quot; title=&quot;testall failure in org.apache.cassandra.index.internal.CassandraIndexTest.indexOnFirstClusteringColumn&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12834&quot;&gt;&lt;del&gt;CASSANDRA-12834&lt;/del&gt;&lt;/a&gt; for instance, which is the same failure as reported in the 2 supplementary CI runs mentioned above), the problem is reuse of an identifier by different tests within a fixture. In that case, the async cleanup in the teardown races with a CREATE statement. Here though, the index name is not reused anywhere and if it were, the CREATE INDEX has no IF NOT EXISTS, so we&apos;d likely see that request rejected rather than spurious query results. &lt;/p&gt;

&lt;p&gt;What seems odd to me is that in all of the SecondaryIndexTest failures above, the invalid results are returned only after flush. That is, the test does: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;run query X;
flush;
run query X;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So on each occasion, the exact same query executes and returns the expected results almost immediately prior to failure. I accept that 7 test runs is a small sample, but to me it points towards something flush related. &lt;/p&gt;

&lt;p&gt;I&apos;ve added some logging to try and pin down the cause a bit better, but as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt; noted, this is pretty damn hard to repro on demand, so I&apos;ve been running the test in pretty much a constant loop, but so far had no luck. I&apos;ll update if/when I see a failure.&lt;/p&gt;</comment>
                            <comment id="15652018" author="ifesdjeen" created="Wed, 9 Nov 2016 20:58:00 +0000"  >&lt;p&gt;I&apos;ve added some retrying and additional logging as well. I&apos;ll keep re-running as well.&lt;/p&gt;</comment>
                            <comment id="15674407" author="beobal" created="Thu, 17 Nov 2016 18:09:31 +0000"  >&lt;p&gt;The root cause essentially what &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cam1982&quot; class=&quot;user-hover&quot; rel=&quot;cam1982&quot;&gt;cam1982&lt;/a&gt; described in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12590&quot; title=&quot;Segfault reading secondary index&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12590&quot;&gt;&lt;del&gt;CASSANDRA-12590&lt;/del&gt;&lt;/a&gt; (specifically, &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12590?focusedCommentId=15484088&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15484088&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;). &lt;br/&gt;
Index tables use &lt;tt&gt;LocalPartitioner/LocalToken&lt;/tt&gt; and &lt;tt&gt;LocalToken&lt;/tt&gt; holds a reference to value object used to construct it. In this case, that value is a &lt;tt&gt;ByteBuffer&lt;/tt&gt; representing a cell in the base table (i.e. the indexed value). When &lt;tt&gt;offheap_buffers&lt;/tt&gt; or &lt;tt&gt;offheap_objects&lt;/tt&gt; are in play (as they are in &lt;tt&gt;test/conf/cassandra.yaml&lt;/tt&gt; on 3.X/trunk), this indexed cell value may be backed by a &lt;tt&gt;DirectByteBuffer&lt;/tt&gt; which is recycled sometime after the memtable containing it is discarded. The reason this causes this particular test to fail is that the min/max &lt;tt&gt;DecoratedKey&lt;/tt&gt; for the index&apos;s sstables are also references (at least, they are immediately after writing and until the table is next opened). The min/max keys are used on the read path to construct the interval tree which determines which sstables are used for a given read query. If one of these direct buffers gets recycled/cleaned/freed, this can corrupt the sstable, causing the interval tree search to fail which results in sstables being skipped incorrectly. &lt;/p&gt;

&lt;p&gt;I added some logging to the test which captures this by reporting some metadata about the index sstable before running each query:&lt;/p&gt;

&lt;p&gt;This log failing test run shows the sstable being corrupted before the 5th query is executed. The token for key 5 changes from &lt;tt&gt;5&lt;/tt&gt; to &lt;tt&gt;0&lt;/tt&gt;, causing the interval tree search to fail &amp;amp; sstable to be skipped.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;INFO  [main] 2016-11-17 09:57:48,577 Index CFS live memtables: [(DataFile: /home/automaton/cassandra/build/test/cassandra/data:0/cql_test_keyspace/table_37-3faeee00acac11e691265959e4dbcb49/.v_idx_1/mc-1-big-Data.db, Min: DecoratedKey(1, 00000001), Max: DecoratedKey(5, 00000005))] 
INFO  [main] 2016-11-17 09:57:48,578 Index CFS live memtables: [(DataFile: /home/automaton/cassandra/build/test/cassandra/data:0/cql_test_keyspace/table_37-3faeee00acac11e691265959e4dbcb49/.v_idx_1/mc-1-big-Data.db, Min: DecoratedKey(1, 00000001), Max: DecoratedKey(5, 00000005))] 
INFO  [main] 2016-11-17 09:57:48,580 Index CFS live memtables: [(DataFile: /home/automaton/cassandra/build/test/cassandra/data:0/cql_test_keyspace/table_37-3faeee00acac11e691265959e4dbcb49/.v_idx_1/mc-1-big-Data.db, Min: DecoratedKey(1, 00000001), Max: DecoratedKey(5, 00000005))] 
INFO  [main] 2016-11-17 09:57:48,581 Index CFS live memtables: [(DataFile: /home/automaton/cassandra/build/test/cassandra/data:0/cql_test_keyspace/table_37-3faeee00acac11e691265959e4dbcb49/.v_idx_1/mc-1-big-Data.db, Min: DecoratedKey(1, 00000001), Max: DecoratedKey(5, 00000005))] 
INFO  [main] 2016-11-17 09:57:48,582 Index CFS live memtables: [(DataFile: /home/automaton/cassandra/build/test/cassandra/data:0/cql_test_keyspace/table_37-3faeee00acac11e691265959e4dbcb49/.v_idx_1/mc-1-big-Data.db, Min: DecoratedKey(1, 00000001), Max: DecoratedKey(0, 00000005))] 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And here the 4th query failed. The sstable was actually corrupted before the 3rd query ran, but that expects to filter all index results which masks the index lookup failure.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;INFO  [main] 2016-11-17 10:06:03,061 Index CFS live memtables: [(DataFile: /home/automaton/cassandra/build/test/cassandra/data:0/cql_test_keyspace/table_37-666d7d30acad11e6bb81b1960637036c/.v_idx_1/mc-1-big-Data.db, Min: DecoratedKey(1, 00000001), Max: DecoratedKey(5, 00000005))] 
INFO  [main] 2016-11-17 10:06:03,062 Index CFS live memtables: [(DataFile: /home/automaton/cassandra/build/test/cassandra/data:0/cql_test_keyspace/table_37-666d7d30acad11e6bb81b1960637036c/.v_idx_1/mc-1-big-Data.db, Min: DecoratedKey(1, 00000001), Max: DecoratedKey(5, 00000005))] 
INFO  [main] 2016-11-17 10:06:03,064 Index CFS live memtables: [(DataFile: /home/automaton/cassandra/build/test/cassandra/data:0/cql_test_keyspace/table_37-666d7d30acad11e6bb81b1960637036c/.v_idx_1/mc-1-big-Data.db, Min: DecoratedKey(1, 00000001), Max: DecoratedKey(0, 00000005))] 
INFO  [main] 2016-11-17 10:06:03,064 Index CFS live memtables: [(DataFile: /home/automaton/cassandra/build/test/cassandra/data:0/cql_test_keyspace/table_37-666d7d30acad11e6bb81b1960637036c/.v_idx_1/mc-1-big-Data.db, Min: DecoratedKey(1, 00000001), Max: DecoratedKey(0, 00000005))] 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12590&quot; title=&quot;Segfault reading secondary index&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12590&quot;&gt;&lt;del&gt;CASSANDRA-12590&lt;/del&gt;&lt;/a&gt;, I suggested that this was probably only a problem for 2i tables, and advocated against having &lt;tt&gt;LocalToken&lt;/tt&gt; make an on-heap copy of the buffer. I still think that the problem only affects indexes, but as the batchlog table is the only other user of &lt;tt&gt;LocalPartitioner&lt;/tt&gt; the cost should be minimal and it&apos;s much cleaner to have the on heap copy made in &lt;tt&gt;LocalToken&lt;/tt&gt;. Testing that locally with extra debug logging shows that the index sstables are no longer holding references to the direct buffers, so I&apos;m pretty sure this will fix the problem. I&apos;ve kicked off a jenkins job to run 200 iterations of the flaky test &amp;amp; if that reports 0 failures, I&apos;ll be pretty confident this is the fix.&lt;/p&gt;

&lt;p&gt;FTR, this isn&apos;t a problem in 2.2 as the insert into the index table is done using the original cell from the write, which is then cloned (potentially moving offheap) before being inserted into the base memtable.  &lt;/p&gt;</comment>
                            <comment id="15686693" author="beobal" created="Tue, 22 Nov 2016 13:05:02 +0000"  >&lt;p&gt;There were no failures on the &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-testall-multiplex/18/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;200x run&lt;/a&gt;, so I&apos;m marking this patch available.&lt;/p&gt;

&lt;p&gt;I&apos;ve pushed branches based on 3.0, 3.X and trunk only as there is really no significant differences between 3.11 &amp;amp; 3.X at this point. &lt;/p&gt;

&lt;p&gt;This issue is one of those preventing us from having a green utest board for the 3.10 release. If vote #3 does fail due to the failing unit tests (as it looks like it might), we can create a 3.10 branch from the 3.10-tentative tag &amp;amp; commit just the fixes for those tests. Again, the delta between 3.10/3.11/3.X right now is negligible so I haven&apos;t done that yet.&lt;/p&gt;


&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;testall&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/12651-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;12651-3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-12651-3.0-testall&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-12651-3.0-dtest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/12651-3.X&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;12651-3.X&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-12651-3.X-testall&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-12651-3.X-dtest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/12651-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;12651-trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-12651-trunk-testall&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/beobal/job/beobal-12651-trunk-dtest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

</comment>
                            <comment id="15695805" author="ifesdjeen" created="Fri, 25 Nov 2016 12:55:28 +0000"  >&lt;p&gt;Brilliant research, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt;! Sorry I couldn&apos;t repro / fix it myself. I guess I just got overly convinced in the fact it was something wrong with tests. The &lt;tt&gt;DecoratedKey&lt;/tt&gt; jump from 5 to 0 certainly proves the point. I&apos;ve also read the &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12590&quot; title=&quot;Segfault reading secondary index&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12590&quot;&gt;&lt;del&gt;CASSANDRA-12590&lt;/del&gt;&lt;/a&gt; discussion, so it does look like these both are consequences of the same problem. As far as I understood, the second (empty) constructor was added in order to avoid assertion failure when &lt;tt&gt;null&lt;/tt&gt; is passed (tried it locally without). &lt;/p&gt;

&lt;p&gt;I have to mention that segfault results are shadowed by cassci, for example &lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-12651-segfault-testall/1/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. We see that the VM exited abnormally, although all the other tests are just skipped, so this is why we may have never seen segfaults mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12590&quot; title=&quot;Segfault reading secondary index&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12590&quot;&gt;&lt;del&gt;CASSANDRA-12590&lt;/del&gt;&lt;/a&gt; (might be for other reasons). I&apos;ll open up the issue.&lt;/p&gt;

&lt;p&gt;+1 from my side.&lt;/p&gt;</comment>
                            <comment id="15695823" author="ifesdjeen" created="Fri, 25 Nov 2016 13:03:03 +0000"  >&lt;p&gt;I&apos;ve created the issue about segfaults &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12957&quot; title=&quot;Segfault &amp;quot;shadows&amp;quot; failures in unit tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12957&quot;&gt;&lt;del&gt;CASSANDRA-12957&lt;/del&gt;&lt;/a&gt; if it&apos;s of any interest for anyone.&lt;/p&gt;</comment>
                            <comment id="15705930" author="beobal" created="Tue, 29 Nov 2016 17:26:53 +0000"  >&lt;p&gt;Thanks, committed to 3.0.x in &lt;tt&gt;820e7a8d810828d29f98a68dc35be33b40a5de62&lt;/tt&gt; and merged up to trunk&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13002130">CASSANDRA-12590</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13116650">CASSANDRA-13999</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33p3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12337348">3.10</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ifesdjeen</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>