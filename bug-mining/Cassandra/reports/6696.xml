<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:32:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-19759] CEP-15 (Accord): When starting a transaction in a table where Accord is not enabled, should fail fast rather than fail with lack of ranges</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-19759</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Reported in Slack: &lt;a href=&quot;https://the-asf.slack.com/archives/C0459N9R5C6/p1712831271287869&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://the-asf.slack.com/archives/C0459N9R5C6/p1712831271287869&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The &#8220;accord_demo.txt&#8221; has the following&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ccm create accord-cql-poc -n 3
ccm start

bin/cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;create keyspace ks with replication={&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;replication_factor&apos;&lt;/span&gt;:3};&quot;&lt;/span&gt;
bin/cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;create table ks.tbl1 (k &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; primary key, v &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;);&quot;&lt;/span&gt;
bin/cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;create table ks.tbl2 (k &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; primary key, v &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;);&quot;&lt;/span&gt;

bin/nodetool -h 0000:0000:0000:0000:0000:ffff:7f00:0001 -p 7100 createepochunsafe
bin/nodetool -h 0000:0000:0000:0000:0000:ffff:7f00:0001 -p 7200 createepochunsafe
bin/nodetool -h 0000:0000:0000:0000:0000:ffff:7f00:0001 -p 7300 createepochunsafe

BEGIN TRANSACTION
  LET row1 = (SELECT * FROM ks.tbl1 WHERE k = 1);
  SELECT row1.v;
  IF row1 IS NULL THEN
    INSERT INTO ks.tbl1 (k, v) VALUES (1, 2);
  END IF
COMMIT TRANSACTION;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you run that it fails in an unclear way&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cqlsh&amp;gt; BEGIN TRANSACTION
   ...   LET row1 = (SELECT * FROM ks.tbl1 WHERE k = 1);
   ...   SELECT row1.v;
   ...   IF row1 IS NULL THEN
   ...     INSERT INTO ks.tbl1 (k, v) VALUES (1, 2);
   ...   END IF
   ... COMMIT TRANSACTION;
NoHostAvailable: (&lt;span class=&quot;code-quote&quot;&gt;&apos;Unable to complete the operation against any hosts&apos;&lt;/span&gt;, {&amp;lt;Host: 127.0.0.1:9042 datacenter1&amp;gt;: &amp;lt;Error from server: code=0000 [Server error] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;java.lang.IllegalStateException: Unable to select a HomeKey as the topology does not have any ranges &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; epoch 17&quot;&lt;/span&gt;&amp;gt;})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The issue is that the table was not marked as an Accord table; aka missing &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
WITH transactional_mode=&lt;span class=&quot;code-quote&quot;&gt;&apos;full&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The demo should be updated to show this, but the error message should also be improved.  We validate that the table exists but now that the metadata is required we should also enforce this in CQL validation&lt;/p&gt;</description>
                <environment></environment>
        <key id="13585050">CASSANDRA-19759</key>
            <summary>CEP-15 (Accord): When starting a transaction in a table where Accord is not enabled, should fail fast rather than fail with lack of ranges</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shiraishi">Youki Shiraishi</assignee>
                                    <reporter username="dcapwell">David Capwell</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Jul 2024 17:23:09 +0000</created>
                <updated>Thu, 25 Jul 2024 05:36:37 +0000</updated>
                            <resolved>Tue, 23 Jul 2024 21:32:11 +0000</resolved>
                                        <fixVersion>NA</fixVersion>
                                    <component>Accord</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="5400">1.5h</timespent>
                                <comments>
                            <comment id="17865240" author="maedhroz" created="Thu, 11 Jul 2024 22:02:59 +0000"  >&lt;p&gt;I&apos;ve had a TODO for a while in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18107&quot; title=&quot;CEP-15: Multi-Partition Transaction CQL Support (Alpha -&amp;gt; v1)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18107&quot;&gt;CASSANDRA-18107&lt;/a&gt; to get rid of or integrate &lt;tt&gt;accord_demo.txt&lt;/tt&gt; into some larger thing like &lt;tt&gt;o.a.c.index.sai.README.md&lt;/tt&gt;. Minor changes to keep it valid for now are fine.&lt;/p&gt;</comment>
                            <comment id="17865241" author="maedhroz" created="Thu, 11 Jul 2024 22:06:39 +0000"  >&lt;p&gt;+1 (left minor nit in PR)&lt;/p&gt;</comment>
                            <comment id="17866828" author="dcapwell" created="Wed, 17 Jul 2024 18:40:34 +0000"  >&lt;p&gt;+1 from both &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt; and I, I will start the merge process and report CI state here&lt;/p&gt;</comment>
                            <comment id="17866841" author="dcapwell" created="Wed, 17 Jul 2024 19:39:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shiraishi&quot; class=&quot;user-hover&quot; rel=&quot;shiraishi&quot;&gt;shiraishi&lt;/a&gt; there are many failing tests caused by this patch, can you take a look?  Think you just have to allow the tables for accord&lt;/p&gt;


&lt;p&gt;org.apache.cassandra.db.compaction.CompactionAccordIteratorsTest&lt;br/&gt;
org.apache.cassandra.service.accord.AccordKeyspaceTest&lt;/p&gt;</comment>
                            <comment id="17868171" author="dcapwell" created="Tue, 23 Jul 2024 19:49:28 +0000"  >&lt;p&gt;just saw the new commits to fix the tests, rerunning CI now&lt;/p&gt;</comment>
                            <comment id="17868192" author="dcapwell" created="Tue, 23 Jul 2024 21:29:03 +0000"  >&lt;p&gt;can not paste results, seems python-dtest is broken after some 5.0 release stuff... since its broken the tool to generate the summary file is failing...&lt;/p&gt;

&lt;p&gt;CI looks mostly fine to me, the failing tests are also failing for the branch, so doesn&apos;t look related to this patch... going to merge now&lt;/p&gt;</comment>
                            <comment id="17868194" author="dcapwell" created="Tue, 23 Jul 2024 21:32:11 +0000"  >&lt;p&gt;Thanks for this patch!&lt;/p&gt;</comment>
                            <comment id="17868548" author="shiraishi" created="Thu, 25 Jul 2024 05:36:37 +0000"  >&lt;p&gt;I appreciate your help!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[shiraishi]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="13562" cascade-level=""><![CDATA[Documentation]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1q7lc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[maedhroz]]></customfieldvalue>
        <customfieldvalue><![CDATA[dcapwell]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348835">NA</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/885f4362afdca43f0a98b03128b2b4993a6701e9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/885f4362afdca43f0a98b03128b2b4993a6701e9&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;new coverage in &lt;a href=&quot;https://github.com/apache/cassandra/pull/3413#diff-0c7a4cee812613339e7ba3d22a20c7c05af4011a1ac6183b11a62758549e6b67&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;TransactionStatementTest&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>