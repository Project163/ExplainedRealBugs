<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:29:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-19197] OA format serialization/deserialization problem</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-19197</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;There is a problem with either serialization or deserialization of the new TTL&lt;/p&gt;</description>
                <environment></environment>
        <key id="13561555">CASSANDRA-19197</key>
            <summary>OA format serialization/deserialization problem</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jlewandowski">Jacek Lewandowski</assignee>
                                    <reporter username="jlewandowski">Jacek Lewandowski</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Dec 2023 14:13:32 +0000</created>
                <updated>Tue, 26 Mar 2024 10:38:28 +0000</updated>
                            <resolved>Fri, 15 Dec 2023 08:46:13 +0000</resolved>
                                        <fixVersion>5.0-rc1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                    <fixVersion>5.1</fixVersion>
                                    <component>Legacy/Local Write-Read Paths</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3000">50m</timespent>
                                <comments>
                            <comment id="17796019" author="bereng" created="Wed, 13 Dec 2023 06:11:26 +0000"  >&lt;p&gt;I was talking to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jlewandowski&quot; class=&quot;user-hover&quot; rel=&quot;jlewandowski&quot;&gt;jlewandowski&lt;/a&gt; about this yesterday and this seems related to the BigFormat.correspondingMessagingVersion being hardcoded which was discovered elsewhere. Still I wanted to make sure this was working correctly on the single node &amp;amp; simple test and coverage. I checked TTLTest and it does indeed test &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-5.0/test/unit/org/apache/cassandra/cql3/validation/operations/TTLTest.java#L245&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;everything&lt;/a&gt; with/without flush. I also created a quick test to triple-check and it seems to work so we&apos;re good on that side of things at least&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    @Test
    public void berengTest() throws Throwable
    {
        ExpirationDateOverflowPolicy origPolicy = ExpirationDateOverflowHandling.policy;
        ExpirationDateOverflowHandling.policy = ExpirationDateOverflowPolicy.CAP_NOWARN;
        createTable(&quot;CREATE TABLE %s (k int PRIMARY KEY, i int)&quot;);
        execute(&quot;INSERT INTO %s (k, i) VALUES (1, 1)  USING TTL &quot; + MAX_TTL);

        UntypedResultSet res = execute(&quot;SELECT TTL(i) FROM %s WHERE k=1&quot;);
        System.out.println(&quot;*****************************************************************************************&quot;);
        System.out.println(&quot;*****************************************************************************************&quot;);
        System.out.println(&quot;*****************************************************************************************&quot;);
        UntypedResultSet.Row row = res.one();
        System.out.println(row.getInt(row.getColumns().get(0).name.toString()));

        Util.flush(Keyspace.open(keyspace()));

        Thread.sleep(5000);
        res = execute(&quot;SELECT TTL(i) FROM %s WHERE k=1&quot;);
        System.out.println(&quot;*****************************************************************************************&quot;);
        System.out.println(&quot;*****************************************************************************************&quot;);
        System.out.println(&quot;*****************************************************************************************&quot;);
        row = res.one();
        System.out.println(row.getInt(row.getColumns().get(0).name.toString()));

        ExpirationDateOverflowHandling.policy = origPolicy;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17796104" author="bereng" created="Wed, 13 Dec 2023 09:40:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jlewandowski&quot; class=&quot;user-hover&quot; rel=&quot;jlewandowski&quot;&gt;jlewandowski&lt;/a&gt; when you do this ticket can you please change &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-5.0/conf/cassandra.yaml#L2119&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this&lt;/a&gt; (oa -&amp;gt; nc). It&apos;s not worth a ticket&lt;/p&gt;

&lt;p&gt;&lt;em&gt;or 4.1, the value of this property should be 4, and that will make us use &apos;oa&apos; sstables. -&amp;gt; or 4.1, the value of this property should be 4, and that will make us use &apos;nb&apos; sstables.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;I checked for other typos and the rest of the docs seem to be correct.&lt;/p&gt;</comment>
                            <comment id="17796107" author="jlewandowski" created="Wed, 13 Dec 2023 09:45:56 +0000"  >&lt;p&gt;For now I have a test update which demonstrates the problem &lt;a href=&quot;https://github.com/apache/cassandra/pull/2990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2990&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I need to dig deeper into that, changing the corresponding messaging version is not enough to fix it&lt;/p&gt;</comment>
                            <comment id="17796630" author="bereng" created="Thu, 14 Dec 2023 09:01:19 +0000"  >&lt;p&gt;I don&apos;t know if this is meant to be ready for review but I checked the PR and so far lgmt besides some doc problems&lt;/p&gt;</comment>
                            <comment id="17796751" author="jlewandowski" created="Thu, 14 Dec 2023 13:53:47 +0000"  >&lt;p&gt;trunk PR&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/cassandra/pull/2994&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2994&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17797044" author="bereng" created="Fri, 15 Dec 2023 06:21:11 +0000"  >&lt;p&gt;Code LGTM. CI is all green with only known flakies and an unrelated new failure imo. Still we changed BTI so: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;5.0 PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2990&lt;/a&gt;. +1 LGTM conditional to running jvm-upgrade-repeats and junit tries which shouldn&apos;t fail.&lt;/li&gt;
	&lt;li&gt;Trunk PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2994&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2994&lt;/a&gt;. +1 LGTM conditional to green tries junit&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17797067" author="jlewandowski" created="Fri, 15 Dec 2023 07:37:38 +0000"  >&lt;p&gt;Upgrade tests and tries tests + repeats are green on both branches, all links in PRs&lt;/p&gt;</comment>
                            <comment id="17797080" author="bereng" created="Fri, 15 Dec 2023 08:16:20 +0000"  >&lt;p&gt;LGTM +1&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jlewandowski]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12986" cascade-level="1"><![CDATA[Recoverable Corruption / Loss]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12975"><![CDATA[Code Inspection]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 47 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1m7oo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bereng]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12353513">5.0-alpha1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/2fc2be54caf4f1861cac8e93146ace03de5e1db6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/2fc2be54caf4f1861cac8e93146ace03de5e1db6&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;run regressions  + new tests&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>