<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:06:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13370] unittest CipherFactoryTest failed on MacOS</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13370</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Seems like MacOS(El Capitan) doesn&apos;t allow writing to &lt;tt&gt;/dev/urandom&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ echo 1 &amp;gt; /dev/urandom
echo: write error: operation not permitted
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Which is causing CipherFactoryTest failed:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ ant test -Dtest.name=CipherFactoryTest
...
    [junit] Testsuite: org.apache.cassandra.security.CipherFactoryTest
    [junit] Testsuite: org.apache.cassandra.security.CipherFactoryTest Tests run: 7, Failures: 0, Errors: 7, Skipped: 0, Time elapsed: 2.184 sec
    [junit]
    [junit] Testcase: buildCipher_SameParams(org.apache.cassandra.security.CipherFactoryTest):  Caused an ERROR
    [junit] setSeed() failed
    [junit] java.security.ProviderException: setSeed() failed
    [junit]     at sun.security.provider.NativePRNG$RandomIO.implSetSeed(NativePRNG.java:472)
    [junit]     at sun.security.provider.NativePRNG$RandomIO.access$300(NativePRNG.java:331)
    [junit]     at sun.security.provider.NativePRNG.engineSetSeed(NativePRNG.java:214)
    [junit]     at java.security.SecureRandom.getDefaultPRNG(SecureRandom.java:209)
    [junit]     at java.security.SecureRandom.&amp;lt;init&amp;gt;(SecureRandom.java:190)
    [junit]     at org.apache.cassandra.security.CipherFactoryTest.setup(CipherFactoryTest.java:50)
    [junit] Caused by: java.io.IOException: Operation not permitted
    [junit]     at java.io.FileOutputStream.writeBytes(Native Method)
    [junit]     at java.io.FileOutputStream.write(FileOutputStream.java:313)
    [junit]     at sun.security.provider.NativePRNG$RandomIO.implSetSeed(NativePRNG.java:470)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m able to reproduce the issue on two Mac machines. But not sure if it&apos;s affecting all other developers.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;-Djava.security.egd=&lt;a href=&quot;file:/dev/urandom&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/dev/urandom&lt;/a&gt;&lt;/tt&gt; was introduced in:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9581&quot; title=&quot;pig-tests spend time waiting on /dev/random for SecureRandom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9581&quot;&gt;&lt;del&gt;CASSANDRA-9581&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I would suggest to revert the &lt;a href=&quot;https://github.com/apache/cassandra/commit/ae179e45327a133248c06019f87615c9cf69f643&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;change&lt;/a&gt; as &lt;tt&gt;pig-test&lt;/tt&gt; is removed (&lt;a href=&quot;https://github.com/apache/cassandra/commit/56cfc6ea35d1410f2f5a8ae711ae33342f286d79&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pig is no longer supported&lt;/a&gt;).&lt;br/&gt;
Or adding a condition for MacOS in build.xml.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aweisberg&quot; class=&quot;user-hover&quot; rel=&quot;aweisberg&quot;&gt;aweisberg&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasobrown&quot; class=&quot;user-hover&quot; rel=&quot;jasobrown&quot;&gt;jasobrown&lt;/a&gt; any thoughts?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13058362">CASSANDRA-13370</key>
            <summary>unittest CipherFactoryTest failed on MacOS</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jay.zhuang">Jay Zhuang</assignee>
                                    <reporter username="jay.zhuang">Jay Zhuang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Mar 2017 18:59:53 +0000</created>
                <updated>Tue, 7 Mar 2023 11:52:25 +0000</updated>
                            <resolved>Fri, 24 Mar 2017 17:28:47 +0000</resolved>
                                        <fixVersion>3.11.0</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Legacy/Testing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15936957" author="aweisberg" created="Wed, 22 Mar 2017 19:18:43 +0000"  >&lt;p&gt;It would be nice to have tests not block on secure random in the environments where that block for an unfortunate amount of time. I looked and I couldn&apos;t find a way to have SHA1PRNG or a fast seed generator be the default. I suspect there is a configuration out there that will initialize quickly, but I couldn&apos;t find it.&lt;/p&gt;

&lt;p&gt;I would +1 switching to something that works on OS X in the interim.&lt;/p&gt;
</comment>
                            <comment id="15937193" author="jay.zhuang" created="Wed, 22 Mar 2017 21:34:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aweisberg&quot; class=&quot;user-hover&quot; rel=&quot;aweisberg&quot;&gt;aweisberg&lt;/a&gt; how about this fix: &lt;a href=&quot;https://github.com/cooldoger/cassandra/commit/718f67d711c15b0d9dbebce3065064c73efd85e5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;718f67d&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="15938026" author="spodxx@gmail.com" created="Thu, 23 Mar 2017 09:54:50 +0000"  >&lt;p&gt;Jay, shouldn&apos;t simply removing the seed be enough? Do you still have to remove the egd path to get rid of the error?&lt;/p&gt;</comment>
                            <comment id="15938462" author="aweisberg" created="Thu, 23 Mar 2017 14:36:59 +0000"  >&lt;p&gt;I think we should remove the seed anyways so that subsequent usage of secure random doesn&apos;t also fail only on OX X. These tests have been failing for a long time without being fixed.&lt;/p&gt;</comment>
                            <comment id="15938698" author="aweisberg" created="Thu, 23 Mar 2017 16:25:05 +0000"  >&lt;p&gt;Oh, I misunderstood. So it&apos;s removing the seed that will stop Java from writing to /dev/random. Yes I think that would be a better approach.&lt;/p&gt;</comment>
                            <comment id="15938724" author="jay.zhuang" created="Thu, 23 Mar 2017 16:37:09 +0000"  >&lt;p&gt;Make sense. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spod&quot; class=&quot;user-hover&quot; rel=&quot;spod&quot;&gt;spod&lt;/a&gt;&lt;br/&gt;
Updated the &lt;a href=&quot;https://github.com/cooldoger/cassandra/commit/e89ac4407f387dc9607b21d3ef9ece6d4bda4bd8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;, passed the test locally on MacOS and Linux.&lt;/p&gt;</comment>
                            <comment id="15938769" author="aweisberg" created="Thu, 23 Mar 2017 17:01:47 +0000"  >&lt;p&gt;Sorry to keep changing my mind. Still digesting the fact that we can fix just this one test and keep using /dev/urandom. I checked and we don&apos;t use seeding of SecureRandom outside of this test. So I propose going with your original solution of using SHA1PRNG, seeding it the way the test does so that the test is deterministic as originally intended, and not changing anything in build.xml.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Code&lt;/th&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;utests&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.11...aweisberg:cassandra-13370-3.11?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Dev/view/aweisberg/job/aweisberg-cassandra-13370-3.11-testall/2/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15938952" author="spodxx@gmail.com" created="Thu, 23 Mar 2017 18:21:21 +0000"  >&lt;p&gt;&lt;del&gt;I don&apos;t think seeding SecureRandom does what you think it does, Ariel. The provided seed will just get &quot;mixed&quot; with the current RNG seed. This is different from e.g. seeding java.util.Random and will not make the test deterministic.&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;(does only seem to apply to the native PRNG, just tested with SHA1PRNG and it worked as described by you, my mistake here)&lt;/p&gt;</comment>
                            <comment id="15939000" author="aweisberg" created="Thu, 23 Mar 2017 18:46:36 +0000"  >&lt;p&gt;Well it&apos;s still news to me that NativePRNG does mixing. Thanks for bringing it up. I guess the test author didn&apos;t rely on it being deterministic.&lt;/p&gt;

&lt;p&gt;The right thing to do anyways is to generate a random seed and log it. So you get fuzzing but you can still reproduce a failure. I amended my original commit.&lt;/p&gt;</comment>
                            <comment id="15939043" author="spodxx@gmail.com" created="Thu, 23 Mar 2017 19:07:04 +0000"  >&lt;p&gt;The initial stacktrace from the description shows that NativePRNG tries do write the seed into /dev/urandom. Any values written there will not reset the seed system wide (which would be funny), but simply provide a bit of additional entropy. SHA1RPNG seems to work differently though, but the &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/security/SecureRandom.html#setSeed-byte:A-&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;javadoc&lt;/a&gt; isn&apos;t very clear either what exactly to expect.&lt;/p&gt;</comment>
                            <comment id="15940724" author="aweisberg" created="Fri, 24 Mar 2017 16:57:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jay.zhuang&quot; class=&quot;user-hover&quot; rel=&quot;jay.zhuang&quot;&gt;jay.zhuang&lt;/a&gt; does this work for you? I don&apos;t want to rewrite your patch without running it by you.&lt;/p&gt;</comment>
                            <comment id="15940739" author="jay.zhuang" created="Fri, 24 Mar 2017 17:03:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aweisberg&quot; class=&quot;user-hover&quot; rel=&quot;aweisberg&quot;&gt;aweisberg&lt;/a&gt; yes, sure. Thanks for improving that.&lt;/p&gt;</comment>
                            <comment id="15940785" author="aweisberg" created="Fri, 24 Mar 2017 17:28:41 +0000"  >&lt;p&gt;Committed as &lt;a href=&quot;https://github.com/apache/cassandra/commit/ee7023e324cdd3b3442b04ad4b0b1f4b33921d35&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ee7023e324cdd3b3442b04ad4b0b1f4b33921d35&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12860183" name="13370-trunk-update.txt" size="1464" author="jay.zhuang" created="Thu, 23 Mar 2017 16:34:07 +0000"/>
                            <attachment id="12860012" name="13370-trunk.txt" size="2974" author="jay.zhuang" created="Wed, 22 Mar 2017 21:31:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jay.zhuang]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3cnqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12351720">5.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aweisberg</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aweisberg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>