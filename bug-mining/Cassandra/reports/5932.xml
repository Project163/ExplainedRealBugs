<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:23:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-15234] Standardise config and JVM parameters</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-15234</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;We have a bunch of inconsistent names and config patterns in the codebase, both from the yams and JVM properties.  It would be nice to standardise the naming (such as otc_ vs internode_) as well as the provision of values with units - while maintaining perpetual backwards compatibility with the old parameter names, of course.&lt;/p&gt;

&lt;p&gt;For temporal units, I would propose parsing strings with suffixes of:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;code&lt;/tt&gt;&lt;br/&gt;
u|micros(econds?)?&lt;br/&gt;
ms|millis(econds?)?&lt;br/&gt;
s(econds?)?&lt;br/&gt;
m(inutes?)?&lt;br/&gt;
h(ours?)?&lt;br/&gt;
d(ays?)?&lt;br/&gt;
mo(nths?)?&lt;br/&gt;
&lt;tt&gt;code&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;For rate units, I would propose parsing any of the standard &lt;tt&gt;B/s, KiB/s, MiB/s, GiB/s, TiB/s&lt;/tt&gt;.&lt;br/&gt;
Perhaps for avoiding ambiguity we could not accept bauds &lt;tt&gt;bs, Mbps&lt;/tt&gt; or powers of 1000 such as &lt;tt&gt;KB/s&lt;/tt&gt;, given these are regularly used for either their old or new definition e.g. &lt;tt&gt;KiB/s&lt;/tt&gt;, or we could support them and simply log the value in bytes/s.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13245388">CASSANDRA-15234</key>
            <summary>Standardise config and JVM parameters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="edimitrova">Ekaterina Dimitrova</assignee>
                                    <reporter username="benedict">Benedict Elliott Smith</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Jul 2019 07:32:34 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:58 +0000</updated>
                            <resolved>Sun, 6 Feb 2022 03:56:39 +0000</resolved>
                                        <fixVersion>4.1-alpha1</fixVersion>
                    <fixVersion>4.1</fixVersion>
                                    <component>Local/Config</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>27</watches>
                                                                                                                <comments>
                            <comment id="16886937" author="iamaleksey" created="Wed, 17 Jul 2019 11:16:00 +0000"  >&lt;p&gt;Would be nice, while at it, to pull all JVM args into one class, a-la &lt;tt&gt;Config&lt;/tt&gt;, with strongly typed accessors and proper documentation for each arg.&lt;/p&gt;

&lt;p&gt;Right now you have to look for usage of &lt;tt&gt;System.getProperty()&lt;/tt&gt;, &lt;tt&gt;Boolean.getBoolean()&lt;/tt&gt;, etc., to enumerate them all, which is a mess.&lt;/p&gt;</comment>
                            <comment id="16886938" author="benedict" created="Wed, 17 Jul 2019 11:16:39 +0000"  >&lt;p&gt;Definitely.&lt;/p&gt;</comment>
                            <comment id="17004567" author="rustyrazorblade" created="Sat, 28 Dec 2019 19:55:21 +0000"  >&lt;p&gt;Probably want ms (milliseconds) in there as well.&lt;/p&gt;</comment>
                            <comment id="17004571" author="benedict" created="Sat, 28 Dec 2019 20:17:12 +0000"  >&lt;p&gt;Yep.  Hopefully I&apos;d have noticed when implementing, but thanks for making sure!&lt;/p&gt;</comment>
                            <comment id="17026288" author="dcapwell" created="Wed, 29 Jan 2020 22:47:05 +0000"  >&lt;p&gt;I see a few things in this JIRA&lt;/p&gt;

&lt;p&gt;1) centralize location of JVM args&lt;br/&gt;
2) backwards compatible way to rename properties (JVM args and yaml)&lt;br/&gt;
3) support common unit conversions (time, space, etc.)&lt;br/&gt;
4) type safe values (Rate, Duration, Space, etc)&lt;br/&gt;
5) backwards compatible value parsing&lt;br/&gt;
6) document all the things&lt;/p&gt;

&lt;p&gt;I should be able to start taking on parts of this in a few weeks, unless anyone else wants to in the mean time.&lt;/p&gt;</comment>
                            <comment id="17050476" author="edimitrova" created="Tue, 3 Mar 2020 18:46:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;. did you start this one?&#160;&lt;/p&gt;</comment>
                            <comment id="17050541" author="dcapwell" created="Tue, 3 Mar 2020 20:47:02 +0000"  >&lt;p&gt;Nope. All yours if you want&lt;/p&gt;</comment>
                            <comment id="17050544" author="michaelsembwever" created="Tue, 3 Mar 2020 20:49:46 +0000"  >&lt;p&gt;And there are a lot of accessing jvm args using the &quot;cassandra.&quot; string literal prefix, instead of &lt;tt&gt;Config.PROPERTY_PREFIX&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;And, this ticket would help simplify &lt;tt&gt;SystemPropertiesTable.CASSANDRA_RELEVANT_PROPERTIES&lt;/tt&gt; in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15616&quot; title=&quot;Expose Cassandra related system properties in a virtual table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15616&quot;&gt;&lt;del&gt;CASSANDRA-15616&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17050573" author="edimitrova" created="Tue, 3 Mar 2020 21:20:23 +0000"  >&lt;p&gt;Great, then I am gonna start working on it tomorrow!&lt;/p&gt;

&lt;p&gt;Probably will ask some questions &#160;at some point.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="17057944" author="rssvihla" created="Thu, 12 Mar 2020 13:57:59 +0000"  >&lt;p&gt;I think this is overall a good idea, but it definitely needs some limits on the number of combinations supported. Let&apos;s just look at a hypothetical new configuration `compaction_throughput` instead of `compaction_throughput_mb_per_sec` (which is a poster child for a difficult to remember name in need of review):&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Any downstream tooling that reads configuration will have to take on everything we add, which is fine, but the more math we require the worse it is on them to get updated. An older tool will read compaction_throughput_mb_per_sec and it was self documenting. A new tool will have to take into account every variant we support for MiB/MB/mb/bytes/etc/etc&lt;/li&gt;
	&lt;li&gt;what about `500mb` vs `500mb/s` vs `500 mbs` (note the space) vs `500MiB/s` vs `500&#160; mb/s` (note the 2 spaces). Which of those is obviously valid or wrong at a glance to a new user? So if we&apos;re going to do it, definitely only accept one valid that&apos;s the same for everything..I still think it&apos;s adding some learning curve for new users.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17057969" author="edimitrova" created="Thu, 12 Mar 2020 14:29:20 +0000"  >&lt;p&gt;Ok, back to this one. Unfortunately, I was parallelizing with some other stuff at the beginning of the week.&#160;&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;&#160;for sharing that ticket, that was helpful.&lt;/p&gt;

&lt;p&gt;I started from looking into standardizing the parameters names and &#160;1) of the plan&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;shared.&lt;/p&gt;

&lt;p&gt;Also, my idea was to reshuffle a bit the order of the parameters in the yaml and try to put them in sections, for example:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Quick start&lt;br/&gt;
The minimal properties needed for configuring a cluster.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Commonly used&lt;br/&gt;
Properties most frequently used when configuring Cassandra.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Performance Tuning&lt;br/&gt;
Tuning performance and system resource utilization, including commit log, compaction, memory, disk I/O, CPU, reads, and writes.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Advanced&lt;br/&gt;
Properties for advanced users or properties that are less commonly used.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;SecurityServer and client security settings.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Yes, this idea came after looking at online documentations and trying to think from user&apos;s perspective.&lt;/p&gt;

&lt;p&gt;On another topic, looking at the plan, I realized that you might want actually a parser and unit converter for the values in order to give freedom to the users to add whatever value they would like in the yaml. Initially, I was thinking that we talk about the suffixes of the parameters names, the way we see them now and some name changes and backward compatibilities.&#160;&lt;/p&gt;

&lt;p&gt;So my question is what is the reason behind doing this and shall we split this Jira then in a couple of smaller ones if we go into that direction?&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17058024" author="benedict" created="Thu, 12 Mar 2020 15:38:41 +0000"  >&lt;p&gt;My personal view is that there&apos;s no need to overcomplicate this ticket, and that perhaps David Capwell anticipates greater complexity in addressing it than I do.&lt;/p&gt;

&lt;p&gt;My goal is to make the config more intuitive, consistent and also to not make any assumptions about reasonable units.  Every property has its own units picked arbitrarily, and this is confusing.  Publishing a simple regex to validate the value types for tools seems sufficient to address &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rssvihla&quot; class=&quot;user-hover&quot; rel=&quot;rssvihla&quot;&gt;rssvihla&lt;/a&gt;&apos;s concerns, I think?  And I don&apos;t think we should make it pluggable, just accept quantities and rates, and we can be quite restrictive, even just accepting GiB/s, MiB/s and KiB/s.&lt;/p&gt;

&lt;p&gt;My personal approach would be to, in separate commits but one ticket&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Move properties to a single file, with strongly typed methods and sensible names for fetching the property.&lt;/li&gt;
	&lt;li&gt;Note property names present in either &lt;tt&gt;Config&lt;/tt&gt; or via system properties, that relate to the same concept but use different terms - not just prefixes like otc_, but also:
	&lt;ul&gt;
		&lt;li&gt;Why do we use &lt;tt&gt;enable&lt;/tt&gt;, &lt;tt&gt;enabled&lt;/tt&gt; and &lt;tt&gt;disable&lt;/tt&gt; in our property names?  Why does it sometimes go at the start or end?&lt;/li&gt;
		&lt;li&gt;Why do we use both &lt;tt&gt;dc&lt;/tt&gt; and &lt;tt&gt;datacenter&lt;/tt&gt;?&lt;/li&gt;
		&lt;li&gt;Who does &lt;tt&gt;max&lt;/tt&gt; sometimes go at the start, sometimes in the middle?&lt;/li&gt;
		&lt;li&gt;...&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Rename things, and make sure &lt;tt&gt;Config&lt;/tt&gt; and system properties look for both old and new forms&lt;/li&gt;
	&lt;li&gt;Support super simple parsing for rate and size&lt;/li&gt;
	&lt;li&gt;Done&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="17058138" author="dcapwell" created="Thu, 12 Mar 2020 17:48:00 +0000"  >&lt;p&gt;Yep, think we are on the same page here; I just prefer smaller patches so rather have ~3-4 (based off your split) patches rather than the same number of commits but one patch.  &lt;/p&gt;</comment>
                            <comment id="17061075" author="edimitrova" created="Tue, 17 Mar 2020 17:33:55 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt;&#160;for the confirmation on what you had in mind here. Makes sense to me.&lt;/p&gt;

&lt;p&gt;So just to confirm I am not doing something stupid.&lt;/p&gt;

&lt;p&gt;For the backward compatibility we are simply using either the old or new parameter from yaml in Config/SysProperties, depending on which one the user used there? In the Database Descriptor I will add a warning which will also warn the developers that they can already use the new one. How about that? Or something else is meant in this case for backward compatibility?&#160;&lt;/p&gt;

&lt;p&gt;I already created a class of accessors for the SystemProperties. Just want to think also maybe about some of the environment variables too.&lt;/p&gt;

&lt;p&gt;The config is reshuffled and many renames are already in place so I guess after this confirmation and a couple of other things to complete, I will submit soon the commits for review. &#160;Thanks&lt;/p&gt;</comment>
                            <comment id="17065133" author="edimitrova" created="Mon, 23 Mar 2020 21:59:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Part1&lt;/a&gt; - dtests are still running and have to clear/correct some comments in config but all in-jvm and unit tests look fine to me.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;New cassandra.yaml ---&amp;gt; currently cassandra-new.yaml in the branch as I wanted to test the backward compatibility on the old version (will have to rename properly also these yaml files with version probably)&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
	&lt;li&gt;reorganization of the file&lt;/li&gt;
	&lt;li&gt;renames to make the names more consistent&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Backward compatibility with the old names - my approach is:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
	&lt;li&gt;Cassandra comes with the new version of the yaml to ensure any new builds will be using it&lt;/li&gt;
	&lt;li&gt;During load of the yaml file I check whether old names are identified(means someone upgraded to 4 and wants to still use the old yaml). If this is the case, we load the values from the old yaml to the new variables (the already renamed parameters). Might need some refactoring here and there but I found this as the easiest and least disruptive approach. Also, there is a warning to the user that there is new yaml version and he/she can consider an update. Also TO DO for later: change cassandra.yaml in conf and test/conf and put cassandra-old.yaml in the test/conf....Should update also CHANGES.txt and NEWS.txt at some point when I am done...&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Still have to complete some parts of the other stuff before sharing. For example, still wondering a bit about the best place to incorporate the parsing(also the unit converts...) to ensure least disruptions in the current code logic. Looks to me that it might be good again to call it during the yaml file load. Should think about it a bit more.   &lt;/p&gt;

&lt;p&gt;Any constructive feedback is always appreciated. &lt;/p&gt;


</comment>
                            <comment id="17065977" author="dcapwell" created="Tue, 24 Mar 2020 17:12:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-b66584c9ce7b64019b5db5a531deeda1R189&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-b66584c9ce7b64019b5db5a531deeda1R189&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I prefer native_transport_max_threads over max_native_transport_threads, the native_transport prefix scopes things better IMO and matches the other configs as well (such as native_transport_flush_in_batches_legacy).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-5749c5e00813f3ae16b68ff8de095cc0R238&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-5749c5e00813f3ae16b68ff8de095cc0R238&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I feel it makes sense to put that in the if block &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-5749c5e00813f3ae16b68ff8de095cc0R227&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-5749c5e00813f3ae16b68ff8de095cc0R227&lt;/a&gt; and remove isOldYAML&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-5749c5e00813f3ae16b68ff8de095cc0R305&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-5749c5e00813f3ae16b68ff8de095cc0R305&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;log isn&apos;t actionable, personally feel logging which properties were used but deprecated is easier to act on (so may be better to log per property?)&lt;/p&gt;

&lt;p&gt;For the parsing remapping logic, I am good with this, it keeps Config.java clean and removes the need for DatabaseDescriptor to do the remapping.  My main question is how this works with a nested property?  Lets say we want to change the yaml to&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
seed_provider:
  # renamed class_name to name
  - name: org.apache.cassandra.locator.SimpleSeedProvider
     parameters:
      - seeds: &lt;span class=&quot;code-quote&quot;&gt;&quot;127.0.0.1:7000&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Not sure if we care about something like that now, but its the main question I have on the remapping (and potential conflict where top level != nested).&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;For example, still wondering a bit about the best place to incorporate the parsing(also the unit converts...) to ensure least disruptions in the current code logic. Looks to me that it might be good again to call it during the yaml file load.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I personally prefer the parsing in the file loading since it can give more meaningful feedback to users than failing somewhere else.  Also would mean that Config.java always has the final results&lt;/p&gt;</comment>
                            <comment id="17066238" author="edimitrova" created="Tue, 24 Mar 2020 22:25:14 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&lt;br/&gt;
Thanks a lot for your feedback!&lt;br/&gt;
           &quot;_&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-b66584c9ce7b64019b5db5a531deeda1R189_&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-b66584c9ce7b64019b5db5a531deeda1R189_&lt;/a&gt;&lt;br/&gt;
           &lt;em&gt;I prefer native_transport_max_threads over max_native_transport_threads, the native_transport prefix scopes things better IMO and matches the other               configs as well (such as native_transport_flush_in_batches_legacy).&lt;/em&gt;&quot;&lt;/p&gt;

&lt;p&gt;I agree with this. On the other hand, we keep all max/min/etc at the end/start of a name, that was the initial plan I think.&lt;/p&gt;

&lt;p&gt;      &quot;&lt;em&gt;log isn&apos;t actionable, personally feel logging which properties were used but deprecated is easier to act on (so may be better to log per property?)&lt;/em&gt;&quot;&lt;/p&gt;

&lt;p&gt;I was thinking about this, too. But in this case we don&apos;t change only one or two parameters but 15 for now. And when I also add the change of those which had a unit at the back... they will be a lot. Also, my point was that we change completely the version of the yaml. Did you check it how it looks like now?&lt;br/&gt;
So from now on any changes/comments/recommendations will go there. We don&apos;t want people to start making changes on the old yaml but potentially to update it with the new one.  &lt;/p&gt;

&lt;p&gt;     &quot;&lt;em&gt;For the parsing remapping logic, I am good with this, it keeps Config.java clean and removes the need for DatabaseDescriptor to do the remapping.&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;Yes, that was exactly my point. Also, we can easily get rid of this backward compatibility one day in the future if we want to.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;   &lt;em&gt;My main question is how this works with a nested property? Lets say we want to change the yaml to&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;seed_provider:&lt;/em&gt;&lt;br/&gt;
  &lt;em&gt;# renamed class_name to name&lt;/em&gt;&lt;br/&gt;
  &lt;em&gt;- name: org.apache.cassandra.locator.SimpleSeedProvider&lt;/em&gt;&lt;br/&gt;
     &lt;em&gt;parameters:&lt;/em&gt;&lt;br/&gt;
     _ - seeds: &quot;127.0.0.1:7000&quot;_&lt;br/&gt;
&lt;em&gt;Not sure if we care about something like that now, but its the main question I have on the remapping (and potential conflict where top level != nested).&lt;/em&gt;&quot;&lt;/p&gt;

&lt;p&gt;We don&apos;t have that issue now but it looks like snakeyaml has everything in place in order to deal with nested parameters, too. Not sure I responded to your question.&lt;/p&gt;

&lt;p&gt;        &quot;&lt;em&gt;I personally prefer the parsing in the file loading since it can give more meaningful feedback to users than failing somewhere else. Also would mean that   Config.java always has the final results&lt;/em&gt;&quot;&lt;/p&gt;

&lt;p&gt;Same here, thanks. &lt;/p&gt;


</comment>
                            <comment id="17066269" author="dcapwell" created="Tue, 24 Mar 2020 23:43:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;I agree with this. On the other hand, we keep all max/min/etc at the end/start of a name, that was the initial plan I think.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;naming is hard, ill defer to others who have stronger opinions&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;they will be a lot. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;yep, which is why it would be good to tell the users which ones are deprecated and replaced with what.  If we just say &quot;there is a problem&quot; they will find out what the problem was in 5.0 (and only then try to figure out how to migrate).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Also, my point was that we change completely the version of the yaml. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I saw you have v2 logic, but don&apos;t understand why given the current patch; is there more pending which change the structure?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Did you check it how it looks like now?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Do you mean the YAML?  the log looks the &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-2#diff-5749c5e00813f3ae16b68ff8de095cc0R305&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;same&lt;/a&gt; to me.  I see you have the two yaml; not sure about others but IMO we should only have 1 file (since users see it), two could be confusing.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;We don&apos;t have that issue now but it looks like snakeyaml has everything in place in order to deal with nested parameters, too. Not sure I responded to your question.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;the current patch doesn&apos;t have the need, was just thinking about if it came up and the impact to the rename logic; the patch currently makes sense for top level names.&lt;/p&gt;</comment>
                            <comment id="17066284" author="edimitrova" created="Wed, 25 Mar 2020 00:31:51 +0000"  >&lt;p&gt;I mentioned in the initial submission... I propose the new version. Cassandra should come only with one version, the new one.  &lt;br/&gt;
But the old one was kept for now for the backward compatibilities CI run and verification. &lt;br/&gt;
The idea is to have the new one v2. &lt;br/&gt;
The old one won&apos;t be there anymore. I can leave it only in test/conf for test purposes.&lt;br/&gt;
So that&apos;s why I didn&apos;t consider just to list all the parameters and say rename so they rename them in the old version.&lt;br/&gt;
v2 logic I mentioned before that I am gonna add it and no one objected. &lt;/p&gt;

&lt;p&gt;This is initial version to get some feedback while  completing the rest of the stuff. Thank you for providing it.&lt;/p&gt;</comment>
                            <comment id="17066285" author="edimitrova" created="Wed, 25 Mar 2020 00:35:27 +0000"  >&lt;p&gt;And I forgot....yes, nested parameter backward compatibility does not exist in the current change as we don&apos;t need it at this point.&lt;br/&gt;
But I think (speculating as I didn&apos;t do it but it looks like that) should be easy to be added in case we need it at some point. Would be added on per case basis.&lt;/p&gt;</comment>
                            <comment id="17066295" author="dcapwell" created="Wed, 25 Mar 2020 00:50:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;The old one won&apos;t be there anymore. I can leave it only in test/conf for test purposes.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;sounds good to me.&lt;/p&gt;</comment>
                            <comment id="17066778" author="edimitrova" created="Wed, 25 Mar 2020 15:55:57 +0000"  >&lt;p&gt;The branch is not compiling after I made some changes by mistake.&lt;br/&gt;
I&apos;ll fix this later &lt;/p&gt;</comment>
                            <comment id="17075947" author="edimitrova" created="Sun, 5 Apr 2020 22:04:06 +0000"  >&lt;p&gt;Part 1 was fixed and CI run showed no issues, forgot to update the ticket. Part II(capability for the users to pickup units) and Part III(the system properties accessors) will have to pass CI run tonight. &lt;br/&gt;
I am currently using the ByteUnit approach (referring to the DatabaseDescriptor) for the part II conversion of space and rate units. Please let me know if I am missing some other utility that could be used better for this goal.&lt;/p&gt;</comment>
                            <comment id="17086118" author="edimitrova" created="Fri, 17 Apr 2020 22:42:48 +0000"  >&lt;p&gt;Done but with one caveat which was caught thankfully with the DTests. Unit tests were even on 100% green at some runs. (And my unit test was not covering the problem conversion explained below, I should add it!)&lt;br/&gt;
 I am new to snakeyaml so I might be wrong, I would appreciate if someone who has the experience proves me wrong.&lt;br/&gt;
 From the DTest failures I realized that turning into Strings the values from the YAML we hit one issue. To me it looks like we already have it actually with Integer and String parameters, just they are not many so it didn&apos;t bite us up to now. Not sure whether this was considered when the Config class was built or not.&lt;/p&gt;

&lt;p&gt;So the issue with int parameters in Config in my solution is:&lt;br/&gt;
 Currently in trunk, when we parse to int variable, If a parameter is commented in the cassandra.yaml, this is observed as null and it will raise an exception in some cases. (i.e. commitlog_sync_period_in_ms) But if it is not commented, just not assigned a value, then this is considered as 0 (as we parse to int). &lt;br/&gt;
 The situation is different with String, Integer. They will be in both cases null. No differentiator. But currently we don&apos;t have many parameters being Integer and String and this wasn&apos;t a problem.&lt;br/&gt;
 Now with the units attached to the parameters&apos; values in the cassandra.yaml file, we need to parse strings with snakeyaml and then convert to the proper int values in Config.&lt;/p&gt;

&lt;p&gt;A way to cope with this issue is to make the users use &quot;&quot;. In this way, if we have a parameter not commented, but not also having an assigned value in cassandra.yaml, we can identify it by checking a string for being empty. If the parameter is commented or not presented, it will be null. But this would be one more new thing for the users to consider. That&apos;s why I came back to snakeyaml again and tried to think of a different way utilizing it. Unfortunately, up to now I didn&apos;t find any different solution. Also, the links to the examples in the official snakeyaml documentation are broken. Not sure whether there they had some interesting stuff. Maybe something with customized constructor but also, I try to make as less as possible disruptive changes in the codebase in order not to mess up something with the Config which might be extremely unpleasant.&lt;/p&gt;

&lt;p&gt;I will be happy to hear an experienced opinion here. Does anyone know a better solution? Or are we ok to introduce &quot;&quot; in the yaml for empty parameters/Strings recognition?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Part1&lt;/a&gt; (This part was already revised by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt; but I paste the explanation again here for completeness).&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;New cassandra.yaml ---&amp;gt; currently cassandra-new.yaml in the branch as I wanted to test the backward compatibility on the old version (will have to rename properly also these yaml files with version probably)&lt;br/&gt;
 reorganization of the file renames to make the names more consistent&lt;/li&gt;
	&lt;li&gt;Backward compatibility with the old names - my approach is:&lt;br/&gt;
 Cassandra comes with the new version of the yaml to ensure any new builds will be using it&lt;br/&gt;
 During load of the yaml file I check whether old names are identified(means someone upgraded to 4 and wants to still use the old yaml). If this is the case, we load the values from the old yaml to the new variables (the already renamed parameters). Also, there is a warning to the user that there is new cassandra.yaml version and he/she can consider an update.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Part2&lt;/a&gt; - units added to the values in the cassandra.yaml file. Parsing and unit conversion in place. One unit test added, should be further developed.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra-dtest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;DTests&lt;/a&gt; updated accordingly for v.4&lt;/p&gt;

&lt;p&gt;&lt;b&gt;EDIT:&lt;/b&gt; Part3 has been moved to a separate ticket -&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15876&quot; title=&quot;Accessors for SystemProperties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15876&quot;&gt;&lt;del&gt;CASSANDRA-15876&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;del&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Part3&lt;/a&gt; - SysProperties class, accessors, hope I didn&apos;t miss anything... most of them are actually just using System.getProperty method.&lt;/del&gt;&lt;br/&gt;
 TO DO: Extract the parser/converter in a separate class from Config&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt;? Anyone else any thoughts here?&lt;/p&gt;

&lt;p&gt;NOTE: The branches are not fully cleaned, this is still work in progress but we need to take a decision on the String issue first, I think.&lt;/p&gt;</comment>
                            <comment id="17089094" author="dcapwell" created="Tue, 21 Apr 2020 21:48:19 +0000"  >&lt;p&gt;Most of my experience with SnakeYaml is as a plugin to Jackson, normally Jackson is better at converting JSON/YAML -&amp;gt; Object and offers more flexibility; I may have misread you but the &quot;int&quot; null case isn&apos;t normally an issue in Jackson (assuming you define defaults).  If this is a real limitation, wonder if it&apos;s better to use Jackson as the interface with SnakeYaml as the parser?&lt;/p&gt;

&lt;p&gt;I skimmed part 2 quickly.  What I see is you offer two fields: string, and parsed value.  If the user provides the string version we attempt to parse it and update the parsed value.  In order to add a new field we would need to define the string and parsed versions, and provide the mapping to the MEM_UNITS_MAP map; my first thought is &quot;why not make this a type?&quot;&lt;/p&gt;

&lt;p&gt;I hope this example is clear to my thinking&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Memory {
  &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; bytes;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Memory(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value) {
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.bytes = parse(value);
  }
  

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; getBytes() { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; bytes};
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; getKillaBytes() { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; bytes * 1024 };
 ...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Memory max_value_size = Memory.ofMb(256);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I quickly prototyped this for the field I showed and it parses just fine, also has the benefit that we drop a lot of unit conversions since config spec != runtime value (config is mb, runtime is bytes).&lt;/p&gt;

&lt;p&gt;My thinking is having types rather than the primitives is easier to read, easier to work with, easier to use with properties, etc; it also means we don&apos;t need to maintain the mapping from string to parsed fields.&lt;/p&gt;

&lt;p&gt;The other benefit is it plays nicely with part 1.  We only have a single field, and if the user defines the new and the old the logic for which is used is centralized in a single place.&lt;/p&gt;

&lt;p&gt;Ill start reading part 3 now.&lt;/p&gt;</comment>
                            <comment id="17089105" author="dcapwell" created="Tue, 21 Apr 2020 22:16:32 +0000"  >&lt;p&gt;Part 3 appears to be a mix of com.google.common.base.StandardSystemProperty, JMX properties, and 3 Cassandra properties (focus on starting up; I know this is showing the idea, so totally fine with this); how I read the class is as the DatabaseDescriptor for system properties/env, is this the thinking?&lt;/p&gt;

&lt;p&gt;I kinda feel that it would be best to split this in 3&lt;/p&gt;

&lt;p&gt;1) guava&apos;s StandardSystemProperty, if there is anything missing, see #2&lt;br/&gt;
2) JavaProperties (not tied to a name, just a placeholder).  This stores the JMX and anything not in StandardSystemProperty&lt;br/&gt;
3) SysProperties.  This manages Cassandra specific configs.&lt;/p&gt;

&lt;p&gt;Im not tied to that so flexible if people only want one class to rule them all...&lt;/p&gt;

&lt;p&gt;For part 3 I am more curious on how this ties into part 1 and 2; prototype or small informal writeup (1-2 sentences, just want to know your thinking) would be good.&lt;/p&gt;</comment>
                            <comment id="17089156" author="edimitrova" created="Wed, 22 Apr 2020 00:03:23 +0000"  >&lt;p&gt;@David, thanks for the review and the clarifications and Slack constructive discussion!&lt;/p&gt;

&lt;p&gt;So looks like we have the same vision and I missed one thing. Let me wrap up here for the record and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt; who is also looking into it.&lt;br/&gt;
 Part2 - null is a legit issue and no one of us likes the idea of adding &quot;&quot; in the yaml file. Still have to spend time to think about a workaround and that we already have it there.&lt;/p&gt;

&lt;p&gt;The Memory class is kind of what I meant when I said I have to pull the current implementation separately.&lt;br/&gt;
 So the suggestion is to pull into three additional classes - Memory, Throughput and TimeDuration (or something similar)&lt;/p&gt;

&lt;p&gt;The confusion was about a thing I saw and forgot to take care. :\&lt;br/&gt;
 There are 11 getters in the DatabaseDescriptor. &lt;br/&gt;
 They need to be changed to only getters without doing one more layer of conversion to bytes. Example:&lt;br/&gt;
 getMaxValueSizeInBytes()&lt;/p&gt;

{ return maxValue.toBytes(); }

&lt;p&gt;-&amp;gt; Memory getMaxValueSize()&lt;/p&gt;

{ return maxValue}

&lt;p&gt;This will clean the code and make it easy for maintenance.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;EDIT:&lt;/b&gt;&#160;Part3 has been moved to a separate ticket -&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15876&quot; title=&quot;Accessors for SystemProperties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15876&quot;&gt;&lt;del&gt;CASSANDRA-15876&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;del&gt;Part 3 - code-wise not related to Part1 and 2, just additional small task which was requested in the previous comments, considering we are trying to do standardization as part of this ticket.&lt;/del&gt; &lt;br/&gt;
 &lt;del&gt;Whether we keep all of them in one class or we split is a matter of agreement I think. As soon as we get it, I will correct it. This is real quick.&lt;/del&gt;&lt;/p&gt;</comment>
                            <comment id="17089439" author="michaelsembwever" created="Wed, 22 Apr 2020 08:22:43 +0000"  >&lt;blockquote&gt;&lt;p&gt;Part2 - null is a legit issue and no one of us likes the idea of adding &quot;&quot; in the yaml file. Still have to spend time to think about a workaround and that we already have it there.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Some properties are nullable numbers, ie null is be a valid value. I would rather not permit/encourage the use of magic numbers (eg -1, or MIN_VALUE or MAX_VALUE) to notate the value as being undefined.&lt;/p&gt;

&lt;p&gt;An example is &lt;tt&gt;allocate_tokens_for_local_replication_factor&lt;/tt&gt;. Its use as a nullable is in &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/dht/BootStrapper.java#L157-L179&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;BootStrapper.getBootstrapTokens(..)&lt;/a&gt;  &lt;/p&gt;

&lt;p&gt;Is this problem restricted to the parsing of deprecated (old yaml) properties? How many of the properties that are getting renamed were nullables?&lt;/p&gt;</comment>
                            <comment id="17089921" author="michaelsembwever" created="Wed, 22 Apr 2020 18:27:30 +0000"  >&lt;p&gt;After a chat with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; I understand the null issue a bit better now.&lt;/p&gt;

&lt;p&gt;In the current codebase the &lt;tt&gt;int&lt;/tt&gt; properties can not be left blank, but it can be commented out. &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A commented value means a default of &lt;tt&gt;0&lt;/tt&gt; (though it will also report an error in system.log).&lt;/li&gt;
	&lt;li&gt;A blank&#160;&lt;tt&gt;int&lt;/tt&gt; property throws an exception.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In this patch some of these &lt;tt&gt;int&lt;/tt&gt; properties will become &lt;tt&gt;String&lt;/tt&gt; properties. For example &lt;tt&gt;commitlog_sync_period_in_ms&lt;/tt&gt; will become &lt;tt&gt;commitlog_sync_period&lt;/tt&gt;, changing its type from &lt;tt&gt;int&lt;/tt&gt; to &lt;tt&gt;String&lt;/tt&gt;. The values will then permit unit suffixes, eg &lt;tt&gt;100ms&lt;/tt&gt; and &lt;tt&gt;3s&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;These values still need to support the existing behaviour: blank throws an exception and commented out means zero. This is not possible with snakeyaml as, for &lt;tt&gt;String&lt;/tt&gt; properties, both commented out and blank get interpreted as &lt;tt&gt;null&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;A suggestion to differentiate between a commented out &lt;tt&gt;String&lt;/tt&gt; yaml property versus a blank &lt;tt&gt;String&lt;/tt&gt; yaml property was to add a simple &lt;tt&gt;isPropertyBlank(name)&lt;/tt&gt; method that performs a regular expression match against the plaintext of the yaml file. It is simple because the parsing of units suffix and &lt;tt&gt;int&lt;/tt&gt; prefix happens in the C* code. The regexp match would then be: &lt;tt&gt;&quot;^&quot; + property + &quot; *: *$&quot;&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17091157" author="edimitrova" created="Fri, 24 Apr 2020 04:13:55 +0000"  >&lt;p&gt;Latest update:&lt;br/&gt;
 Part1&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;format issues fixed&lt;/li&gt;
	&lt;li&gt;The isOldYAML logger info changed to warn, and it lists also the old properties used&lt;/li&gt;
	&lt;li&gt;The format of yaml props is noun_verb. native_transport props adjusted to follow this. Max sent to the back as in native_transport_threads_max.&lt;/li&gt;
	&lt;li&gt;MAP_OLD_TO_NEW_PARAMETERS is not static anymore(so it is freed memory after startup)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Part2 - will be completed in the suggested way probably tomorrow (working asynchronously)&lt;/p&gt;

&lt;p&gt;&lt;b&gt;EDIT:&lt;/b&gt; Part3 has been moved to a separate ticket -&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15876&quot; title=&quot;Accessors for SystemProperties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15876&quot;&gt;&lt;del&gt;CASSANDRA-15876&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;del&gt;Part3 - anyone any thoughts whether it should be 1 class or maybe divided into 3 classes, as suggested by&lt;/del&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&lt;del&gt;?&lt;/del&gt;&lt;/p&gt;</comment>
                            <comment id="17094794" author="michaelsembwever" created="Tue, 28 Apr 2020 18:56:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;Part3 - anyone any thoughts whether it should be 1 class or maybe divided into 3 classes, as suggested by David Capwell?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m ok with one class.&lt;/p&gt;

&lt;p&gt;But it would be nice to list the properties and environments used in enums, so it is quick to list/read what Cassandra accesses. For example &lt;tt&gt;SystemPropertiesTable.java&lt;/tt&gt; should be not be defining its own enums nor the string literals to the properties and environments.&lt;/p&gt;

&lt;p&gt;Otherwise part 3 looks good. What test coverage is there (or will there be) here?&lt;/p&gt;</comment>
                            <comment id="17094815" author="dcapwell" created="Tue, 28 Apr 2020 19:21:03 +0000"  >&lt;p&gt;I am ok with enums&lt;/p&gt;</comment>
                            <comment id="17120295" author="jmckenzie" created="Sat, 30 May 2020 16:17:32 +0000"  >&lt;p&gt;Where do we sit with this? One of our few beta 1 blockers. Thanks!&lt;/p&gt;</comment>
                            <comment id="17120382" author="edimitrova" created="Sun, 31 May 2020 00:22:10 +0000"  >&lt;p&gt;99% done.&lt;/p&gt;

&lt;p&gt;I already took care of all the things requested in the initial review. A couple of things we agreed on offline.&lt;/p&gt;

&lt;p&gt;Spent some time on the testing as all Dtests and CCM required edits because of all the renaming of parameters.&#160;&lt;/p&gt;

&lt;p&gt;Will be done for final review Monday. (running some final tests on my end after edit)&lt;/p&gt;</comment>
                            <comment id="17121528" author="edimitrova" created="Tue, 2 Jun 2020 03:25:13 +0000"  >&lt;p&gt;I think that with my CCM patch all dtests should be fine now but I didn&apos;t manage to run them with my CCM patch in CircleCI. I was advised to change only the repo in requirements.txt but configuration errors appear and I can&apos;t run the tests.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;, is there a way this to be done in Jenkins?&lt;/p&gt;

&lt;p&gt;Otherwise I can try locally but this will take at least half a day to run the dtests...&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;&#160;if you have any ideas how to deal with this task efficiently will be appreciated.&lt;/p&gt;</comment>
                            <comment id="17123580" author="michaelsembwever" created="Tue, 2 Jun 2020 09:59:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;Michael Semb Wever, is there a way this to be done in Jenkins?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Currently the CCM repository is not a parameter to the Cassandra-devbranch pipeline.&lt;/p&gt;

&lt;p&gt;So I can only recommend the same approach, by updating the repo url in the cassandra-dtests/requirements.txt and starting the devbranch pipeline off against your patched dtest repo.&lt;/p&gt;</comment>
                            <comment id="17123750" author="edimitrova" created="Tue, 2 Jun 2020 12:56:26 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;, I will do the testing locally then and attach the logs here.&#160;&lt;/p&gt;</comment>
                            <comment id="17123794" author="michaelsembwever" created="Tue, 2 Jun 2020 13:38:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;, looks like you&apos;ll need the fix &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snazy&quot; class=&quot;user-hover&quot; rel=&quot;snazy&quot;&gt;snazy&lt;/a&gt; added &lt;a href=&quot;https://github.com/apache/cassandra-builds/commit/bf6bc98085330172f323c27b21810ac0eb0cc732&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17124520" author="edimitrova" created="Wed, 3 Jun 2020 02:20:23 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;&#160;and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snazy&quot; class=&quot;user-hover&quot; rel=&quot;snazy&quot;&gt;snazy&lt;/a&gt;, it worked.&lt;/p&gt;

&lt;p&gt;pip3 install was provided with --upgrade option in the &#160;circleci config file.&#160;&lt;/p&gt;

&lt;p&gt;Final clean of the code tomorrow morning.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17125553" author="edimitrova" created="Thu, 4 Jun 2020 05:40:26 +0000"  >&lt;p&gt;[ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Part 2 &lt;/a&gt; ] [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra-dtest/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;DTests &lt;/a&gt; ] [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/ccm/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CCM &lt;/a&gt; ] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/187/workflows/615cdebf-1d49-47ab-93a4-efad25a247b1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI run &lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&#160;- Unit tests updated&lt;/p&gt;

&lt;p&gt;-&#160;Getters and Setters names in the DatabaseDescriptor were updated to follow the new names of the parameters updated&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The conversion of some of the parameters values which is happening in their getters is kept as it is needed in runtime. Some parameters are used with different units in the different areas of the codebase. So I left this part untouched.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;- New class created, ParseAndConvertUnits - it pulls all the functionality needed to cover the addition of units suffixes to the Memory, Duration, and Rate parameters in the cassandra.yaml&lt;/p&gt;

&lt;p&gt;-&#160;the cassandra.yaml file in this branch contains currently the new parameters with new names and unit suffixes but the arrangement of the sections is the old one as this was causing me issues every time I rebase/commit. If we confirm the format, this will be the last step to switch to the new format&lt;/p&gt;

&lt;p&gt;-&#160;Added some additional parsing and supporting conversion functions for the double duration parameters.&lt;/p&gt;

&lt;p&gt;-&#160;The 2 failing cqlsh tests were fixed locally and tested. It was formatting issue.&#160;&lt;/p&gt;

&lt;p&gt;-1 unit test failed - it doesn&apos;t look a related issue but will check the config loaded to ensure that tomorrow&lt;/p&gt;

&lt;p&gt;-&#160;8 failing dtest, it doesn&apos;t look related but I am gonna compare tomorrow morning&lt;/p&gt;

&lt;p&gt;&#160;- Current version of the code needs a final rebase/merge of the last 6 commits on trunk. &#160;Will do tomorrow after I recheck the CI and current version&lt;/p&gt;

&lt;p&gt;-&#160;Have to return the default requirements.txt and config.yml files. The current versions were required only for testing purposes with CircleCI&lt;/p&gt;

&lt;p&gt;&lt;b&gt;WARNING:&lt;/b&gt; we should be careful with the dtests and ccm. One missed check for old/new parameter and default value of the respective parameter from Config will be loaded. This might not lead to failing test and thus silently cover the miss.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;NOTE:&lt;/b&gt; Custom Types, as they were suggested, don&apos;t really work with SnakeYAML, unfortunately. &#160;SnakeYAML supports nothing more than mapping between the yaml and the Config class.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;em&gt;So something like that: Memory max_value = new Memory(&quot;5ms&quot;) wouldn&apos;t work. If there is no value in the yaml, the config default&#160; max_value will be parsed properly but if there is value assigned to max_value at the yaml, it won&apos;t be assigned properly in Config. Classes are used for nested parameters. Also, currently there won&apos;t be a big benefit of the custom types as the different parameters validations in the DatabaseDescriptor are taking different approaches, there is no general framework/approach per group of parameters (Memory, Duration, Rate).&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;em&gt;---------&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;b&gt;EDIT:&lt;/b&gt;&#160;Part3 has been moved to a separate ticket -&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15876&quot; title=&quot;Accessors for SystemProperties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15876&quot;&gt;&lt;del&gt;CASSANDRA-15876&lt;/del&gt;&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;del&gt;The last part was updated as per the recommendations. CI ran successfully. Need to rebase and recheck nothing that might need the attention of this patch has changed in the meanwhile. Three weeks passed since I took care of this one.&lt;/del&gt;&#160;&lt;br/&gt;
 &lt;del&gt;[ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Part3 &lt;/a&gt; ] [ &#160;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/146/workflows/fae5da98-acf5-4824-bf61-3ffab3d86cd6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI JAVA8 &lt;/a&gt; ] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/146/workflows/21b088c4-8984-4b20-8302-2ff8adaf55f7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI Java11 &lt;/a&gt; ]&lt;/del&gt;&lt;/p&gt;</comment>
                            <comment id="17126135" author="edimitrova" created="Thu, 4 Jun 2020 18:36:38 +0000"  >&lt;p&gt;&lt;b&gt;UPDATE:&lt;/b&gt; &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the failing unit test is a flakey test. The configuration is properly loaded so it is not caused by this patch.&lt;/li&gt;
	&lt;li&gt;small issue with Auth_test.py was fixed.&lt;/li&gt;
	&lt;li&gt;the rest of the failing DTests are related to current failures we already see on trunk. Some of them are already fixed in the newer commits. Rebase and run new CI now to confirm the latest status.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17126344" author="edimitrova" created="Fri, 5 Jun 2020 03:35:00 +0000"  >&lt;p&gt;[ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-3-rebase&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk &lt;/a&gt; ] [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra-dtest/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;DTests &lt;/a&gt; ] [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/ccm/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CCM &lt;/a&gt; ] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/193/workflows/718c8a04-385b-4ddc-ac2e-9291c37b1f1e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA8 &lt;/a&gt; ] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/193/workflows/6cd6048d-5daf-4490-a5d3-b5c3178a0757&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA11 &lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Attached to the ticket is the log of the successful runs of the few failing JAVA8 DTests in CircleCI. I ran them locally after fixing lost line of code as it didn&apos;t make sense to me to rerun the whole suite of tests.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Last update:&lt;/b&gt; after rebase and a few nits on my end, we have only 1 DTest and 1 Unit test failing in JAVA11. Unrelated known failures.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;added additional note on the possible units to be used as suffixes in both NEWS.txt and cassandra.yaml&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;CQLSH JAVA11 tests are not currently available in CircleCI.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;b&gt;EDIT:&lt;/b&gt; This work has been moved to a separate ticket -&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15876&quot; title=&quot;Accessors for SystemProperties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15876&quot;&gt;&lt;del&gt;CASSANDRA-15876&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;del&gt;The last part is all green after rebase and CI run.&lt;/del&gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;del&gt;&quot;line.separator&quot; getter added&lt;/del&gt;&lt;br/&gt;
 &lt;del&gt;[ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk &lt;/a&gt; ] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/195/workflows/ebd771ac-d71c-49ea-872b-00b534d9d5c6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA8 CI &lt;/a&gt; ] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/195/workflows/19a3254b-cd7a-4e4f-856f-f314546ff9d7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA11 CI &lt;/a&gt; ]&lt;/del&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;del&gt;There are 1 DTest and 1 Unit unrelated failing tests in JAVA11. Should check for tickets logged.&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;NOTE:&lt;/b&gt; Before commit return to the default config.yml and requirements.txt files&lt;/p&gt;</comment>
                            <comment id="17126815" author="edimitrova" created="Fri, 5 Jun 2020 14:24:52 +0000"  >&lt;p&gt;This one is ready for final review I think.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt; I am not a committer but I think it would be great also to run the tests in Jenkins. Thank you&lt;/p&gt;</comment>
                            <comment id="17126974" author="edimitrova" created="Fri, 5 Jun 2020 17:41:17 +0000"  >&lt;p&gt;&lt;b&gt;Summary:&lt;/b&gt;&lt;br/&gt;
 This branch contains:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/a8a9145a032a9f2d9b74369f2e4474a210aa5b99&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;first commit &lt;/a&gt; which contains parameters name changes as requested; backward compatibility with the old names; Proposed new structure into sections for cassandra.yaml.&lt;/li&gt;
	&lt;li&gt;the &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/032fbd8cca1d7b5b96738bd96d9672864426d718&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;second commit &lt;/a&gt; implements the functionality which gives the end users the opportunity to attach units suffixes to Memory, Duration, Rates parameters.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/68f89503e6e6f30e8f6df1374cb553f243f0068e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;third commit &lt;/a&gt; is a ninja fix of one line which was changed in a wrong way during the latest rebase.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/8389010d704a9524a1c36d96f9e4d8179a8e2044&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;fourth commit &lt;/a&gt; is to return the default config.yml&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This patch requires custom [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra-dtest/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;DTests &lt;/a&gt; ] which run successfully with the following patch of &lt;a href=&quot;https://github.com/ekaterinadimitrova2/ccm/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CCM &lt;/a&gt;&lt;br/&gt;
 DTests - requirements.txt should be updated back to the original one before commit!&lt;/p&gt;

&lt;p&gt;The DTests are not backward compatible with the yaml file without units suffixes.&lt;br/&gt;
 This part is covered by a unit test which tests the successful load of the values of the parameters without units as per the old format.&lt;/p&gt;

&lt;p&gt;[ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-3-rebase&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk &lt;/a&gt; ] [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra-dtest/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;DTests &lt;/a&gt; ] [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/ccm/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CCM &lt;/a&gt; ] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/193/workflows/718c8a04-385b-4ddc-ac2e-9291c37b1f1e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA8 &lt;/a&gt; ] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/193/workflows/6cd6048d-5daf-4490-a5d3-b5c3178a0757&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA11 &lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Attached to the ticket is the log of the successful runs of the few failing JAVA8 DTests in CircleCI. I ran them locally after fixing lost line of code as it didn&apos;t make sense to me to rerun the whole suite of tests.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Last update:&lt;/b&gt; after rebase and a few nits on my end, we have only 1 DTest and 1 Unit test failing in JAVA11. Unrelated known failures.&lt;br/&gt;
 CQLSH JAVA11 tests are not currently available in CircleCI.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;WARNING:&lt;/b&gt; Before commit return to the default requirements.txt file&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Order of commits:&lt;/b&gt; 1) [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-3-rebase&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA branch &lt;/a&gt; ] 2) [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/ccm/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CCM branch &lt;/a&gt; ] 3) [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra-dtest/tree/CASSANDRA-15234-3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;DTests branch &lt;/a&gt; ]&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;b&gt;EDIT:&lt;/b&gt; This work has been moved to a separate ticket -&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15876&quot; title=&quot;Accessors for SystemProperties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15876&quot;&gt;&lt;del&gt;CASSANDRA-15876&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;del&gt;This &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch &lt;/a&gt; is a class of Accessors for System properties. &lt;b&gt;This patch could be considered separate of the previous one, it doesn&apos;t matter&lt;/b&gt; &lt;b&gt;if it is committed&lt;/b&gt;&#160;&lt;b&gt;first or second.&lt;/b&gt; It also doesn&apos;t require custom DTests or custom CCM.&lt;/del&gt;&lt;br/&gt;
 &lt;del&gt;[ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk &lt;/a&gt; ] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/195/workflows/ebd771ac-d71c-49ea-872b-00b534d9d5c6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA8 CI &lt;/a&gt; ] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/195/workflows/19a3254b-cd7a-4e4f-856f-f314546ff9d7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA11 CI &lt;/a&gt; ]&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;&lt;del&gt;There are 1 DTest and 1 Unit unrelated failing tests in JAVA11. Should check for tickets logged.&lt;/del&gt;&lt;/p&gt;</comment>
                            <comment id="17127003" author="michaelsembwever" created="Fri, 5 Jun 2020 18:19:41 +0000"  >&lt;p&gt;Thanks for the summary post &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For the first &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-3-rebase&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;part&lt;/a&gt; (including the dtest and ccm changes), the ASF CI pipeline results are &lt;a href=&quot;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch/144/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. In addition the ASF CI dtest upgrade test results are &lt;a href=&quot;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch-dtest-upgrade/10/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For the second &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;part&lt;/a&gt; the ASF CI results are &lt;a href=&quot;https://ci-cassandra.apache.org/blue/organizations/jenkins/Cassandra-devbranch/detail/Cassandra-devbranch/145/pipeline&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17127857" author="edimitrova" created="Mon, 8 Jun 2020 03:56:57 +0000"  >&lt;p&gt;Thanks to a recent patch I managed to run the upgrade tests in CircleCI.&#160;&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/207/workflows/1d0a0a87-16d9-467b-9299-bb148cb10f68/jobs/1223&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;results &lt;/a&gt;&#160;look good(more than 700 failures but they are those which are currently presented on trunk in CircleCI and mostly related to the environment) when we use the old current DTest suite, CCM and cassandra.yaml. Using the old cassandra.yaml is actually the way a real upgrade will happen.&lt;/p&gt;

&lt;p&gt;In order to run the upgrade tests using the newly proposed version of the DTests suite and CCM, I need to take care about a couple of places where the suite checks for Cassandra version and tries respectively to load some of the parameters with their new names which causes cluster start issues, preventing some of the upgrade tests from run.&#160;&lt;/p&gt;

&lt;p&gt;Currently identified the primary conflict to be in dtest_setup.py. After that scripts is adjusted there are only around 20 tests which fail &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/206/workflows/1f7b0a54-c9e2-4305-8c94-be08d07846dd/jobs/1217/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here &lt;/a&gt;. &#160;One of the other issues is the new name&#160;&lt;em&gt;materialized_views_enabled due&lt;/em&gt; &lt;font color=&quot;#172b4d&quot;&gt;to which some of the&#160;cql tests fail.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;Quick intermediate solution to the mentioned problems would be to add a script which:&lt;/p&gt;

&lt;p&gt;1) runs before the upgrade tests start&lt;/p&gt;

&lt;p&gt;2) replaces the new &#160;cassandra.yaml file with the old one&lt;/p&gt;

&lt;p&gt;3) sets the names of the parameters which would cause issues to their old names which as far as I see are 6-7 compared to almost 70 changed names according to this patch.&lt;/p&gt;

&lt;p&gt;Then I can open a follow-up ticket for fix of the tests so we don&apos;t use this customization in the long term but I find this current issue as not being a blocker for the patch or Beta.&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;TO DO:&lt;/b&gt; Update the Upgrade documentation with the steps of upgrading to version 4 with the old cassandra.yaml and then updating the cassandra.yaml.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17136129" author="michaelsembwever" created="Mon, 15 Jun 2020 19:58:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;, can we pull out the part 3 (Accessors for System properties) patch into a separate ticket.  If it has no dependencies on the other patches in this ticket, then there&apos;s no reason it can&apos;t get reviewed and committed separately.&lt;/p&gt;</comment>
                            <comment id="17136171" author="edimitrova" created="Mon, 15 Jun 2020 21:57:41 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I agree with you,&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15876&quot; title=&quot;Accessors for SystemProperties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15876&quot;&gt;&lt;del&gt;CASSANDRA-15876&lt;/del&gt;&lt;/a&gt;&#160;was created to facilitate this work. It is also not a &#160;4.0 Beta blocker(I set the fix version to beta there) and I think we might be even able to further develop it. Let&apos;s continue the discussion there.&#160;&lt;/p&gt;</comment>
                            <comment id="17138929" author="dcapwell" created="Thu, 18 Jun 2020 00:49:49 +0000"  >&lt;p&gt;This isn&#8217;t a review and I&#8217;m aware I said I didn&#8217;t have time to review it a month ago, but I glanced at the patch and it seems quite different from the approach discussed in &lt;a href=&quot;https://the-asf.slack.com/archives/DSP76MVPC/p1589983705004900&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://the-asf.slack.com/archives/DSP76MVPC/p1589983705004900&lt;/a&gt; and &lt;a href=&quot;https://the-asf.slack.com/archives/DSP76MVPC/p1590006263021200&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://the-asf.slack.com/archives/DSP76MVPC/p1590006263021200&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Can you say a bit about why you changed your approach?&lt;/p&gt;</comment>
                            <comment id="17139545" author="edimitrova" created="Thu, 18 Jun 2020 16:49:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;, I am returning this to &quot;in progress&quot; as things have changed and to prevent people from confusion. Your concerns are valid and addressed. Change has happened because of some misunderstanding on my end but it was corrected already. New submission to follow soon:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;custom types (as per the initial agreement)&lt;/li&gt;
	&lt;li&gt;annotations as suggested by you for easier maintenance&lt;/li&gt;
	&lt;li&gt;backward compatibility will be on property level instead of yaml file level&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;New branch will be shared soon. Thank you!&lt;/p&gt;</comment>
                            <comment id="17144711" author="edimitrova" created="Thu, 25 Jun 2020 07:25:54 +0000"  >&lt;p&gt;This patch implements the functionality which gives the end users the opportunity to attach units suffixes to DataStorage, Duration, BitRates parameters. New custom types for the three group of parameters were added.&lt;/p&gt;

&lt;p&gt;It renames certain parameters with main goal - standardization.&#160;&lt;/p&gt;

&lt;p&gt;Backward compatibility implemented on parameter level utilizing annotations.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-new&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Branch &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This patch requires custom [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra-dtest/tree/CASSANDRA-15234-new&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;DTests &lt;/a&gt;] which run successfully with the following patch of &lt;a href=&quot;https://github.com/ekaterinadimitrova2/ccm/tree/CASSANDRA-15234-new&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CCM &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(The failed test in circle are failing because the CCM patch didn&apos;t apply due to config issue. Also, one exclusion of warning about using the old parameters names should be added. Upgrade tests still running)&lt;/p&gt;

&lt;p&gt;DTests - requirements.txt should be updated back to the original one before commit!&lt;/p&gt;

&lt;p&gt;[ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/257/workflows/98c356fb-b16a-4508-bda8-ff877569b0f5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA8 &lt;/a&gt;] [ &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/257/workflows/d49295a8-d8f5-4836-a18a-df25ff955219&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA11 &lt;/a&gt;]&lt;/p&gt;

&lt;p&gt;&lt;b&gt;TO DO:&lt;/b&gt; IN-JVM tests are not using snakeyaml so I have to update them to use its converter in order for the tests to work with this patch. This is feasible solution aligned with Alex Petrov and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I will provide the additional patch/commit until the end of the week but didn&apos;t want to delay the review of the main patch further.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;WARNING:&lt;/b&gt; Before commit return to the default requirements.txt file&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Order of commits:&lt;/b&gt; 1) [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/CASSANDRA-15234-new&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA branch &lt;/a&gt;] 2) [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/ccm/tree/CASSANDRA-15234-new&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CCM branch &lt;/a&gt;] 3) [ &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra-dtest/tree/CASSANDRA-15234-new&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;DTests branch &lt;/a&gt;]&lt;/p&gt;</comment>
                            <comment id="17145118" author="dcapwell" created="Thu, 25 Jun 2020 17:11:35 +0000"  >&lt;p&gt;This is a large patch, so will take a few attempts to review; below is my first pass (mostly skim).&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Config. otc_coalescing_window_us_default was not renamed but the other otc* configs were.  &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-new#diff-b66584c9ce7b64019b5db5a531deeda1R429&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-new#diff-b66584c9ce7b64019b5db5a531deeda1R429&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;block_for_peers_timeout_in_secs and block_for_peers_in_remote_dcs are exposed in yaml, the comment says &quot;No need of unit conversion as this parameter is not exposed in the yaml file&quot;, can you explain why this comment?&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-new#diff-76c34368f112a0a4e6da5b22c8b50300R353-R376&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-new#diff-76c34368f112a0a4e6da5b22c8b50300R353-R376&lt;/a&gt;. enums can use &quot;abstract&quot; methods, so you can do that rather than use a default which throws&lt;/li&gt;
	&lt;li&gt;in database descriptor I see you use toString to compare, why not convert to the expected unit?  &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-new#diff-a8a9935b164cd23da473fd45784fd1ddR381&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-new#diff-a8a9935b164cd23da473fd45784fd1ddR381&lt;/a&gt;. this could be 
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (conf.commitlog_sync_period.toMillis() != 0)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;.  This is true for all examples I see in this method&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;we should add docs for Replaces and ReplacesList (also calling out that you shouldn&apos;t use ReplacesList directly)&lt;/li&gt;
	&lt;li&gt;for the new types, would be good to have a property test which validates that 
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;type(value, unit).equals(type.parse(type(value, unit).toString()))&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;.&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;LoadOldYAMLBackwardCompatibilityTest and ParseAndConvertUnitsTest look to be copy/paste.  junit supports inheritance so could remove the copy based by having LoadOldYAMLBackwardCompatibilityTest extend ParseAndConvertUnitsTest but use the other config.&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Overall I am good with this patch, need to do a closer review of the details still.&lt;/p&gt;</comment>
                            <comment id="17145765" author="edimitrova" created="Thu, 25 Jun 2020 19:10:25 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;!&lt;br/&gt;
 Please find my comments below in Italic. I will also make a pass later again as I admit I was in a hurry to roll it out last night so it can be visible for people in more time zones before the end of the week to express any bigger concerns that I can address as this is a beta blocker.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Config. otc_coalescing_window_us_default was not renamed but the other otc* configs were. --&amp;gt; &lt;em&gt;will be corrected&lt;/em&gt;&lt;/li&gt;
	&lt;li&gt;block_for_peers_timeout_in_secs and block_for_peers_in_remote_dcs are exposed in yaml, the comment says &quot;No need of unit conversion as this parameter is not exposed in the yaml file&quot;, can you explain why this comment? --&amp;gt; &lt;em&gt;it is not exposed in the yaml for the users so default value and unit is used as per the Config class setup&lt;/em&gt;&lt;/li&gt;
	&lt;li&gt;in database descriptor I see you use toString to compare, why not convert to the expected unit --&amp;gt; &lt;em&gt;I was testing and forgot to correct it, will make a pass to ensure it is corrected everywhere, thanks!&lt;/em&gt;&lt;/li&gt;
	&lt;li&gt;we should add docs for Replaces and ReplacesList (also calling out that you shouldn&apos;t use ReplacesList directly) --&amp;gt; &lt;em&gt;noted&lt;/em&gt;&lt;/li&gt;
	&lt;li&gt;for the new types, would be good to have a property test which validates that
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
type(value, unit).equals(type.parse(type(value, unit).toString()))&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;--&amp;gt; &lt;em&gt;noted&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;LoadOldYAMLBackwardCompatibilityTest and ParseAndConvertUnitsTest look to be copy/paste. junit supports inheritance so could remove the copy based by having LoadOldYAMLBackwardCompatibilityTest extend ParseAndConvertUnitsTest but use the other config --&amp;gt; &lt;em&gt;will definitely take care of that, left over from the&#160;previous version, apologize&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17147386" author="michaelsembwever" created="Sun, 28 Jun 2020 16:35:23 +0000"  >&lt;p&gt;I&apos;ve added some (very minor) comments on the &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/f7ed1e00db5cc5810779a3d71dc065c750ba8e6b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;commit&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Higher level comments (while testing)&#8230;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;during startup warnings about legacy yaml names are logged multiple times&#8230;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;&quot;it is scheduled to be removed by 5.0&quot;&lt;/tt&gt; would be more precise as &lt;tt&gt;&quot;the old name is scheduled to be removed by 5.0&quot;&lt;/tt&gt; (as opposed to the setting+ value being removed),&lt;/li&gt;
	&lt;li&gt;if I define setting  to a blank value, I get a error message like: &lt;tt&gt;&quot;Invalid yaml. Those properties &lt;span class=&quot;error&quot;&gt;&amp;#91;max_hint_window&amp;#93;&lt;/span&gt; are not valid&quot;&lt;/tt&gt;.  This falsely tells me thtat the setting name is wrong, rather than the value. (Invalid non-blank values provide useful error messages.)&lt;/li&gt;
	&lt;li&gt;integer overflow could have a better error message, currently &lt;tt&gt;&quot;NumberFormatException: For input string: &quot;9223372036854775808&quot;&quot;&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;the under/over flow protection between units is nice. &lt;tt&gt;Duration.toMilliseconds()&lt;/tt&gt;  apidoc also describe the overflow to  MAX_VALUE. (same goes for similar default-unit methods in BitsRate and DataStorage)&lt;/li&gt;
	&lt;li&gt;awesome that you can use &lt;tt&gt;&#181;s&lt;/tt&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17147437" author="benedict" created="Sun, 28 Jun 2020 20:41:36 +0000"  >&lt;p&gt;&amp;gt; it is scheduled to be removed by 5.0&lt;/p&gt;

&lt;p&gt;Do we need to remove the legacy parameters if they continue to mean the same thing?  I think we should generally defer breaking deprecated public APIs until it&apos;s useful or necessary.  We&apos;re doing this to cleanup for ourselves and for future users, not to make existing users have a bad time.&lt;/p&gt;</comment>
                            <comment id="17148428" author="blerer" created="Tue, 30 Jun 2020 08:29:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do we need to remove the legacy parameters if they continue to mean the same thing? I think we should generally defer breaking deprecated public APIs until it&apos;s useful or necessary. We&apos;re doing this to cleanup for ourselves and for future users, not to make existing users have a bad time.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; Do you want to keep the backward compatibility forever or do you think that 5.0 is too soon to remove it?&lt;/p&gt;</comment>
                            <comment id="17148441" author="benedict" created="Tue, 30 Jun 2020 08:36:49 +0000"  >&lt;p&gt;My personal view is that for configuration parameters, so long as it is costless to maintain backwards compatibility we should do so.  This includes parameters we remove between versions because we no longer use them (unless there is some semantic implication that the operator needs to consider).  So, yes, indefinitely (but also with continued logging that the parameter is deprecated and might be removed).&lt;/p&gt;

&lt;p&gt;I think the same should be true of all of our public APIs: deprecate immediately, but only remove once the cost to maintain becomes unbearable.&lt;/p&gt;</comment>
                            <comment id="17148460" author="michaelsembwever" created="Tue, 30 Jun 2020 09:04:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think the same should be true of all of our public APIs: deprecate immediately, but only remove once the cost to maintain becomes unbearable.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Is there a problem with advertising that the deprecation only lasts one major version, while we uphold that^ principle internally? &lt;/p&gt;

&lt;p&gt;i.e. we not making any commitment to the &quot;scheduled to be removed by&quot; statement, it&apos;s just a warning. &lt;/p&gt;</comment>
                            <comment id="17148466" author="blerer" created="Tue, 30 Jun 2020 09:15:58 +0000"  >&lt;p&gt;We could change the message to something like &quot;will be removed in a futur major version&quot;. We can then decided later on when we wish to remove it.&lt;/p&gt;

&lt;p&gt;The JDK used some warning like that if I am not mistaken.&lt;/p&gt;</comment>
                            <comment id="17148852" author="dcapwell" created="Tue, 30 Jun 2020 17:33:15 +0000"  >&lt;p&gt;Given the framework provided by this patch, the following wouldn&apos;t be hard to support (all, not just 1 or 2)&lt;/p&gt;

&lt;p&gt;1) no warning or plan to remove&lt;br/&gt;
2) warning that it will be removed some day&lt;br/&gt;
3) warning on specific version which will remove&lt;/p&gt;

&lt;p&gt;So, we could do the following&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// provide a warning that &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; will not longer be supported after 5.0
&lt;/span&gt;@Replaces(oldName = &lt;span class=&quot;code-quote&quot;&gt;&quot;native_transport_idle_timeout_in_ms&quot;&lt;/span&gt;, scheduledRemoveBy = &lt;span class=&quot;code-quote&quot;&gt;&quot;5.0&quot;&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;volatile&lt;/span&gt; Duration native_transport_idle_timeout = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Duration(&lt;span class=&quot;code-quote&quot;&gt;&quot;0ms&quot;&lt;/span&gt;);

&lt;span class=&quot;code-comment&quot;&gt;// provide a warning that the property is deprecated and will be removed one day
&lt;/span&gt;@Replaces(oldName = &lt;span class=&quot;code-quote&quot;&gt;&quot;native_transport_idle_timeout_in_ms&quot;&lt;/span&gt;, deprecated = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;volatile&lt;/span&gt; Duration native_transport_idle_timeout = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Duration(&lt;span class=&quot;code-quote&quot;&gt;&quot;0ms&quot;&lt;/span&gt;);

&lt;span class=&quot;code-comment&quot;&gt;// no warning, both properties are fully supported
&lt;/span&gt;@Replaces(oldName = &lt;span class=&quot;code-quote&quot;&gt;&quot;native_transport_idle_timeout_in_ms&quot;&lt;/span&gt;)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;volatile&lt;/span&gt; Duration native_transport_idle_timeout = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Duration(&lt;span class=&quot;code-quote&quot;&gt;&quot;0ms&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Given the framework makes it trivial to support old names, having no properties marked for removal of 5.0 works for me. If we really want to migrate usage to a new name, then mark it to be removed one day, and stuff which is personal preference (such as enable at the start or end of the name) can have no warning; does this make sense?&lt;/p&gt;</comment>
                            <comment id="17148858" author="benedict" created="Tue, 30 Jun 2020 17:39:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;Given the framework makes it trivial to support old names, having no properties marked for removal of 5.0 works for me&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17150218" author="blerer" created="Thu, 2 Jul 2020 12:01:06 +0000"  >&lt;p&gt;Some comments on the current patch:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;I would prefer to avoid reading twice the configuration file if possible. It should be possible to replace &lt;tt&gt;YamlConfigurationLoader.readStorageConfig&lt;/tt&gt;&#160;and&#160;&lt;tt&gt;isConfigFileValid&lt;/tt&gt; by some checks in &lt;tt&gt;getProperty&lt;/tt&gt; or by using the specific converters. As a side note: &lt;tt&gt;isConfigFileValid&lt;/tt&gt; checks twice for the same condition on each of the &lt;tt&gt;if&lt;/tt&gt; conditions.&lt;/li&gt;
	&lt;li&gt;The patch can be simplified by making &lt;tt&gt;Converter&lt;/tt&gt; an &lt;tt&gt;enum&lt;/tt&gt;. It will allow to use the enum value directly into the &lt;tt&gt;Replaces&lt;/tt&gt; annotation. Doing so will remove the need to use reflection to instantiate the conveters and the use of a cache to avoid multiple instantiation.&lt;/li&gt;
	&lt;li&gt;The change in &lt;tt&gt;ConfigurationException&lt;/tt&gt; are from some experimentations and should be removed.&lt;/li&gt;
	&lt;li&gt;I would as discussed previously defer the date of removal and remove &lt;tt&gt;scheduledRemoveBy&lt;/tt&gt; from the &lt;tt&gt;Replaces&lt;/tt&gt; annotation.&lt;/li&gt;
	&lt;li&gt;It would be nice to have more javadoc on the new code.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17150521" author="benedict" created="Thu, 2 Jul 2020 18:38:15 +0000"  >&lt;p&gt;I haven&apos;t looked closely at this patch, but &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt; pointed out on another ticket that namespaces are a possibility, and this could dramatically simplify understanding the config file, and improve parameter naming as we try to shoe horn fewer things into a crazy long snake case name.  Has this been considered?&lt;/p&gt;

&lt;p&gt;I don&apos;t want to muck things up this late in the game, but if we&apos;re doing this once, we should consider all the options - and I hope this change would be relatively minor compared to all the work &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; has done (if we decide it makes sense, even, of course).&lt;/p&gt;</comment>
                            <comment id="17150579" author="maedhroz" created="Thu, 2 Jul 2020 20:55:02 +0000"  >&lt;blockquote&gt;&lt;p&gt;but if we&apos;re doing this once, we should consider all the options&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We tend to follow the example of what has come before. (I fell into that trap initially trying to name a &lt;em&gt;new&lt;/em&gt; YAML option in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15907&quot; title=&quot;Operational Improvements &amp;amp; Hardening for Replica Filtering Protection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15907&quot;&gt;&lt;del&gt;CASSANDRA-15907&lt;/del&gt;&lt;/a&gt;.) If we can change it now, we can make that basic tendency work &lt;em&gt;for&lt;/em&gt; us. Agreed that it&apos;s a bit late in the process though.&lt;/p&gt;</comment>
                            <comment id="17150619" author="edimitrova" created="Thu, 2 Jul 2020 22:38:38 +0000"  >&lt;p&gt;Thanks everyone for making a review/ providing a valuable input/advice.&lt;br/&gt;
&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Has this been considered?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No, it wasn&apos;t considered. I did the renaming and its backward compatibility as per &#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15234?focusedCommentId=17058024&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17058024&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;the&#160;agreed plan &lt;/a&gt;&#160;.&lt;/p&gt;

&lt;p&gt;For the rest of the audience, I reached out &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt; in Slack&#160;to understand better what is the suggestion.&#160;&lt;/p&gt;

&lt;p&gt;The proposed idea is to group parameters in the yaml the way it already happens with the encryption options.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Example:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Moving in the yaml from:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160; &#160; &#160;cached_rows_warn_threshold: 1000
&#160; &#160; &#160;cached_rows_fail_threshold: 16000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;tt&gt;to:&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
replica_filtering_protection:
&#160; &#160; &#160;- cached_rows_warn_threshold: 1000
&#160; &#160; &#160;- cached_rows_fail_threshold: 16000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;b&gt;My personal opinion:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;if this is really last beta blocker I wouldn&apos;t go for a new round of rework and full validation. This patch touches already more than 50 parameters and requires backward compatibility. Every change of the framework requires full validation and discovers new edge cases as those parameters touch all over the code.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;My suggestion:&lt;/b&gt;&#160;&lt;/p&gt;

&lt;p&gt;Follow the suggestion for new parameters creation. Implement the suggested refactoring in the next major version.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17150641" author="jmckenzie" created="Fri, 3 Jul 2020 00:02:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;Follow the suggestion for new parameters creation. Implement the suggested refactoring in the next major version.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;+1. This is one of 3 tickets left before beta and a new round of rework and validation this late in the alpha is inappropriate IMO.&lt;/p&gt;

&lt;p&gt;I&apos;m sympathetic to the grouping; I find it superior aesthetically and more comprehensible, however balancing that against the need to get beta out and get people actively testing the DB leaves things in favor of the latter for me.&lt;/p&gt;</comment>
                            <comment id="17150909" author="benedict" created="Fri, 3 Jul 2020 10:00:27 +0000"  >&lt;p&gt;If we agree we will be changing the config parameters next version to this alternative approach, then I am fairly opposed to shipping this in its current form and creating more churn for operators when we change it again in the near future.  The point of this exercise is to clean things up, not make them messier, and this includes the perspective of the end user and their ability to keep up with our nomenclature.&lt;/p&gt;

&lt;p&gt;I also think it would be a real shame not to include this work at all, given how awful and confusing our parameter naming situation is today.&lt;/p&gt;

&lt;p&gt;I don&apos;t think this is an absolute necessity for pre-beta, however, given that we have agreed for it to be backwards compatible.  I don&apos;t see any issue with landing this in a later beta.&lt;/p&gt;</comment>
                            <comment id="17151255" author="michaelsembwever" created="Sat, 4 Jul 2020 09:20:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;I don&apos;t think this is an absolute necessity for pre-beta, however, given that we have agreed for it to be backwards compatible. I don&apos;t see any issue with landing this in a later beta.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Move it out to a separate ticket, like was done for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15876&quot; title=&quot;Accessors for SystemProperties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15876&quot;&gt;&lt;del&gt;CASSANDRA-15876&lt;/del&gt;&lt;/a&gt;. To bring additional spec to the table, no matter how good it is, so late in the ticket and so close to the first beta, is particularly painful. As a separate ticket it can be done during the beta phase. &lt;/p&gt;

&lt;p&gt;Otherwise the settings now have a consistent naming pattern &lt;tt&gt;&amp;lt;noun&amp;gt;_&amp;lt;verb&amp;gt;&lt;/tt&gt; which, with no unit suffix noise, and better grouping the settings in the yaml, already brings a huge improvement.&lt;/p&gt;</comment>
                            <comment id="17151336" author="benedict" created="Sat, 4 Jul 2020 13:52:18 +0000"  >&lt;p&gt;&amp;gt; I am fairly opposed to shipping this in its current form and creating more churn for operators when we change it again in the near future&lt;/p&gt;

&lt;p&gt;To be more explicit: I am (binding) -1 knowingly shipping an &lt;em&gt;interim&lt;/em&gt; solution for a public API.  It is user unfriendly.&lt;/p&gt;

&lt;p&gt;I agree it is suboptimal to bring this to the ticket late in the game, but that is how the world sometimes works.  This was not capricious or deliberate; nobody had thought of or suggested this until now, and everyone has since agreed (or implied) this is a superior approach.&lt;/p&gt;

&lt;p&gt;If we change our minds and agree the current approach is the final and superior solution, that is another matter.&lt;/p&gt;

&lt;p&gt;The approaching release of 4.0 should not reduce our attention to detail or quality.  We should merge tickets only when we agree they are ready.  This is particularly important for tickets whose main impact is improving a public API.&lt;/p&gt;

&lt;p&gt;P.S. I would like to take a moment to thank &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; for her work on this (and other tickets).  OSS work can be frustrating sometimes, and I&apos;m sorry if this ticket becomes a source of frustration.  It&apos;s unfortunately not uncommon to have to revisit work, or have work delayed, but please know that it&apos;s valued.  I am excited for the end product; I think it will be a huge improvement when it lands.&lt;/p&gt;</comment>
                            <comment id="17151344" author="jmckenzie" created="Sat, 4 Jul 2020 14:48:13 +0000"  >&lt;blockquote&gt;&lt;blockquote&gt;&lt;p&gt;&#160;To be more explicit: I am (binding) -1 knowingly shipping an &lt;em&gt;interim&lt;/em&gt; solution for a public API. It is user unfriendly.&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;We as a project need to mindfully balance when something is &quot;good enough&quot; and when the trade-off is in favor of getting a release out vs. pursuing another incremental improvement to an API. In my opinion this is classic bike-shedding.&lt;/p&gt;

&lt;p&gt;Given a day focused on nothing but thinking of how to improve our config API I firmly believe we could come up with something that a simple majority considered an improvement over what&apos;s proposed on this ticket + config grouping in a vacuum. &lt;em&gt;I personally prefer the config param grouping&lt;/em&gt;, but not when weighed against delaying the beta when it&apos;s this been long since a prior release.&lt;/p&gt;

&lt;p&gt;I perceive on balance what is in our users&apos; best interests is having a release with all the defect fixes and features available in 4.0. This point of view stems from the empirical evidence of multiple users asking if the project is dead and expressing a strong interest in running 4.0 having heard of the proximity of the beta. I have no evidence of users stating that a lack of configuration grouping in the project causes them equal or greater pain, nor have I seen a cogent argument for that point of view.&lt;/p&gt;

&lt;p&gt;The underlying question we face is how we balance the value to end-users of having as optimal of an API as we can possibly come up in a specific domain vs. the value to end-users of the other things that are delayed due to that effort. Your point of view &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; &lt;em&gt;appears to be&lt;/em&gt; that delaying the beta and the engagement of the user community&apos;s testing of the 4.0 release is justified by the value gained in grouping config params and not having a renamed paradigm for 4.0 and subsequent grouping paradigm in our next major. My apologies if I&apos;m mis-characterizing your point of view here.&lt;/p&gt;

&lt;p&gt;It&apos;s within any committers prerogative to binding -1 things on justified technical grounds. I&apos;d be curious what your perspective is on how we determine what qualifies as justified &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck2&quot; class=&quot;user-hover&quot; rel=&quot;mck2&quot;&gt;mck2&lt;/a&gt; , and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt; in a context such as this, as you all have expressed points of view here.&lt;/p&gt;</comment>
                            <comment id="17151396" author="michaelsembwever" created="Sat, 4 Jul 2020 18:28:02 +0000"  >&lt;p&gt;I&apos;m struggling to see how a request to break work down into separate tickets and steps constitutes a technical reasoning that should block the work. The valid concern around the api churn it introduces is addressed by committing the new ticket to 4.0-beta.&lt;/p&gt;

&lt;p&gt;The more we can do incrementally the better. From reviewing, to testing, to the compartmentalising of jira ticket discussions. (I still miss jira comment threads, even if folk never really used them consistently.)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;&#8230; everyone has since agreed (or implied) this is a superior approach.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Not on my behalf. And I don&apos;t believe all others presumed answers to all questions that need to be asked for it to be a validated proposal. For my part, it is a good suggestion that warrants further investigation. It still needs to be investigated and spec&apos;d out. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If we change our minds and agree the current approach is the final and superior solution, that is another matter.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Not sure I agree with the onus here, based on this being an un-investigated and un-specified suggestion. The onus I think should be the opposite: those wanting this to be a blocker should do the work in determining the value (investigation) and design (specification) to the suggestion. &lt;/p&gt;

&lt;p&gt;The suggestion is not a fault or bug in this ticket, there is nothing in the suggestion that &lt;b&gt;breaks&lt;/b&gt; the patch, it is imho rather a subsequent suggested improvement. Even if it was a suggestion that replaced this patch it should be dealt with in the same way. And of course making such a suggestion first here is natural because the author &lt;em&gt;may&lt;/em&gt; take it on in-stride, but it should be the author&apos;s prerogative to request it be &quot;the next step&quot;.&lt;/p&gt;


&lt;p&gt;In a new ticket: we can better investigate the value that grouping brings and other questions like&#8230;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;how many settings does it apply to?&lt;/li&gt;
	&lt;li&gt;is taxonomy based on a technical or user perspective?&lt;/li&gt;
	&lt;li&gt;if user/operator based, how many people need to be involved to get it right?&lt;/li&gt;
	&lt;li&gt;if user/operator based, what if one property applies to multiple concerns?&lt;/li&gt;
	&lt;li&gt;how does the &lt;tt&gt;@Replace&lt;/tt&gt; annotation work between levels in the grouping?&lt;/li&gt;
	&lt;li&gt;does this introduce more complexity/variations in what has to be tested? (since yaml can consist of old and new setting names)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17151948" author="benedict" created="Mon, 6 Jul 2020 10:38:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;The valid concern around the api churn it introduces is addressed by committing the new ticket to 4.0-beta.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This ticket&#8217;s API replaces the current API, is mutually exclusive with the alternative proposal, and would be deprecated by it.  If we introduce them both in 4.0-beta, we must maintain them both and go through the full deprecation process.  So unfortunately no churn is avoided.&lt;/p&gt;

&lt;p&gt;&amp;gt; I&apos;d be curious what your perspective is on how we determine what qualifies as justified&lt;/p&gt;

&lt;p&gt;It is customary that, before work is committed, alternative proposals are engaged with on their technical merits.  It occurs to me we recently worked to mandate this as part of the process, in fact.  In this case we &lt;em&gt;seem&lt;/em&gt; in danger of subordinating this to beliefs about scheduling.&lt;/p&gt;

&lt;p&gt;If you like, I can formulate a legally airtight veto, but my goal is only for you to engage briefly with the proposal and determine for yourselves which is superior.  If the new proposal is &lt;em&gt;technically&lt;/em&gt;* superior, and of similar complexity, then you are my justification.  If you disagree, however - and importantly we agree that we do not intend to pursue the alternative approach in future - I would consider my veto invalid (and would anyway withdraw it).&lt;/p&gt;

&lt;p&gt;&amp;gt; having heard of the proximity of the beta&lt;/p&gt;

&lt;p&gt;Perhaps we can also directly address people&#8217;s thoughts on deferral to 4.0-beta?  This should surely alleviate concerns around delaying 4.0?  I do understand the imperative to get 4.0 out the door, but I also know we all want to ship the best product we can as well.  If we can achieve both, we should. APIs matter, and avoiding API churn is an important part of our user/operator story.&lt;/p&gt;

&lt;p&gt;&amp;#42; I &lt;em&gt;hope&lt;/em&gt; we can avoid an epistemic battle about the word &quot;technical,&quot; and accept that API design is a technical endeavour to convey meaning.&lt;/p&gt;</comment>
                            <comment id="17152050" author="jmckenzie" created="Mon, 6 Jul 2020 14:16:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;&lt;font color=&quot;#172b4d&quot;&gt;It is customary that, before work is committed, alternative proposals are engaged with on their technical merits. It occurs to me we recently worked to mandate this as part of the process, in fact. In this case we&#160;&lt;/font&gt;&lt;em&gt;seem&lt;/em&gt;&lt;font color=&quot;#172b4d&quot;&gt;&#160;in danger of subordinating this to beliefs about scheduling.&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;font color=&quot;#172b4d&quot;&gt;Unfortunately it&apos;s customary on this project to do that right up until the last moment before something is committed (and even beyond) with no weighting of the value on things actually being in the hands of users vs. in tree and unreleased.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#172b4d&quot;&gt;We have un-tested beliefs about a potentially superior design against un-tested beliefs about the negative impact of the project on further delay. This is not a situation in which we can expect to make progress on a discussion until and unless both sides collect some empirical evidence about their position as well as spend real time investigating and exploring the position of other people engaged.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#172b4d&quot;&gt;Unfortunately I&apos;m well past the time I personally have available to engage on this ticket; I&apos;ll defer to other people to take it from here.&lt;/font&gt;&lt;/p&gt;</comment>
                            <comment id="17152102" author="blerer" created="Mon, 6 Jul 2020 15:39:01 +0000"  >&lt;p&gt;Argeeing on grouping will take a significant amount of time. Specially now where a lot of people are pretty busy with other tasks.&lt;br/&gt;
There are no true urgency to fix that ticket so if we want to go the grouping way within the scope of that ticket we should move it to 4.X.&lt;/p&gt;




</comment>
                            <comment id="17152103" author="benedict" created="Mon, 6 Jul 2020 15:40:14 +0000"  >&lt;p&gt;&amp;gt; We have un-tested beliefs about a potentially superior design&lt;/p&gt;

&lt;p&gt;We don&apos;t ordinarily label our judgements about design &quot;un-tested beliefs&quot; and I think it would help to avoid this kind of rhetoric.  If we all start labelling design decisions in this way the project might grind to a halt.  I have anyway tried specifically to sidestep this kind of accusation, by leaving the ball in your court.  I am simply asking those pushing to move ahead with the current proposal to endorse the view that it is superior.  This is a very weak criteria to meet, and involves no beliefs external to yourselves.&lt;/p&gt;</comment>
                            <comment id="17152110" author="benedict" created="Mon, 6 Jul 2020 15:47:04 +0000"  >&lt;p&gt;&amp;gt; There are no true urgency to fix that ticket so if we want to go the grouping way within the scope of that ticket we should move it to 4.X.&lt;/p&gt;

&lt;p&gt;I think this is indeed preferable to releasing an API we already expect to deprecate, however I think we&apos;re overstating the difficulty here.  We haven&apos;t debated the parameter naming much at all, and we can easily land this in 4.0-beta.  If &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; doesn&apos;t have the time, and 4.0-beta is an acceptable window to land the work, I can take a look in a few weeks.&lt;/p&gt;</comment>
                            <comment id="17152159" author="edimitrova" created="Mon, 6 Jul 2020 16:54:10 +0000"  >&lt;p&gt;Apologize for my late response. I was a bit sick these days and tried to disengage from work and take some rest over the weekend.&lt;/p&gt;

&lt;p&gt;With all my respect to everyone&apos;s opinion and experience on the project, I have two points here:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I truly support &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;&apos;s questions. I believe they should be responded before any decision is taken and someone jumps into actual work.
&lt;blockquote&gt;&lt;p&gt;how many settings does it apply to?&lt;br/&gt;
 is taxonomy based on a technical or user perspective?&lt;br/&gt;
 if user/operator based, how many people need to be involved to get it right?&lt;br/&gt;
 if user/operator based, what if one property applies to multiple concerns?&lt;br/&gt;
 how does the @Replace annotation work between levels in the grouping?&lt;br/&gt;
 does this introduce more complexity/variations in what has to be tested? (since yaml can consist of old and new setting names)&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
	&lt;li&gt;I was also wondering today while I was trying to be open-minded and look from all perspectives at this ticket/patch... Did anyone check the first &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/blob/CASSANDRA-15234-1-outdated/conf/cassandra.yaml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;commit &lt;/a&gt;&#160;where I was suggesting reorganizing of the text into the yaml into sections? I also put it into the ticket thread .&#160;&lt;br/&gt;
 This was a quick draft shared two months ago that could be reworked to sections that satisfy the users&apos; requirements for clarity and consistency.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Do we see any big difference for the users between:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
#*Replica Filtering Protection*

cached_rows_warn_threshold: 1000
cached_rows_fail_threshold: 16000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
replica_filtering_protection:
     - cached_rows_warn_threshold: 1000
     - cached_rows_fail_threshold: 16000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;From that perspective, I think the C* community can accept this patch and then we can raise a new ticket) to improve the internals from our engineering perspective in Beta(refactoring the Config class and the backward compatibility framework), as suggested by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;. I think this work could be really considered incremental work.&lt;/p&gt;

&lt;p&gt;Having that in mind, honestly, I don&apos;t find a justification to spend my time to rework and fully re-test the patch at this point in time.&lt;/p&gt;

&lt;p&gt;I am fine to be proved wrong in a justified way. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;, do you agree with me on my suggestion(reorganizing the yaml file and doing the nested parameters approach later)?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt; I think this is indeed preferable to releasing an API we already expect to deprecate, however I think we&apos;re overstating the difficulty here. We haven&apos;t debated the parameter naming much at all, and we can easily land this in 4.0-beta. If &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; doesn&apos;t have the time, and 4.0-beta is an acceptable window to land the work, I can take a look in a few weeks.  &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I want to be clear - it is not about difficulty, this patch is time consuming. It needs attention to the detail and look at the whole config which touches the code at many places(also ccm, dtests, in-jvm tests, etc)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17152224" author="maedhroz" created="Mon, 6 Jul 2020 17:59:34 +0000"  >&lt;p&gt;My mental model of why grouping &lt;em&gt;might&lt;/em&gt; be valuable:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;It provides a logical place to describe/comment on entire features in the YAML.&lt;/li&gt;
	&lt;li&gt;It avoids duplicate/unwieldy prefixing without sacrificing intelligibility/specificity.&lt;/li&gt;
	&lt;li&gt;It doesn&apos;t rely on the presence of comments.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;My understanding of the changes here is that there are dozens of options that have already been renamed. Assuming we proceed with grouping, supporting three different forms of these options doesn&apos;t seem like the outcome we want. There are really only a handful of groupings that would be interesting and obvious. Essentially, hinted handoff, commitlog, memtable, rpc, compaction, and maybe the caches. (Timeouts seem a bit scattered.)&lt;/p&gt;

&lt;p&gt;What I&apos;m most worried about is the number of versions we have to support at any given time, not whether we change some option grouping early in the beta period. My vote, at this point, would be to just move this issue to beta and hash out a proposal for the (somewhat obvious) option groups I&apos;ve mentioned above.&lt;/p&gt;</comment>
                            <comment id="17152252" author="michaelsembwever" created="Mon, 6 Jul 2020 19:01:17 +0000"  >&lt;blockquote&gt;&lt;p&gt;I am fine to be proved wrong in a justified way. Benedict Elliott Smith, Benjamin Lerer, Michael Semb Wever, do you agree with me on my suggestion(reorganizing the yaml file and doing the nested parameters approach later)?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Let&apos;s keep listening to what everyone has to say. Some of us are better with the written word than others, it is a second language for some, and for me as a native-english-speaker it is still all too easy to miss things the first time they are said. On that, I believe everyone hears and recognises what &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; is saying here regarding frustrations about such a substantial change being suggested so late in the game and the amount of time that&apos;s been asked to re-invest. Especially when an almost identical user experience improvement was presented two months ago. But it should be said again.&lt;/p&gt;

&lt;p&gt;On a side-note, it would have really helped me a lot if the comment &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15234?focusedCommentId=17150521&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-17150521&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;above&lt;/a&gt;&#160;back-referenced &lt;a href=&quot;https://github.com/apache/cassandra/pull/659#discussion_r449201020&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this discussion&lt;/a&gt; where it originated. I know the ticket was referenced, but that discussion thread is the source of the suggestion.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;This ticket&#8217;s API replaces the current API, is mutually exclusive with the alternative proposal, and would be deprecated by it. If we introduce them both in 4.0-beta, we must maintain them both and go through the full deprecation process. So unfortunately no churn is avoided.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;AFAIK this is the only &quot;grounded&quot; justification for the veto. I don&apos;t agree that we are forced into that premise. We can get around those compatibility rules with a minimal amount of effort, by not deprecating the old API and not announcing (in docs or yaml) the new API. (I would expect everyone to intuitively treat private undocumented and un-referenced APIs, only ever available in alpha and beta releases, as unsupported.) &#160;All that &quot;compatibility change&quot; can be left and just done once in the separate ticket. The underlying framework and bulk of this patch can still be merged.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Based on that I see three possible courses of action:&lt;br/&gt;
 1. Accept investigating the alternative proposal, and include it in this ticket, delaying our first 4.0-beta release,&lt;br/&gt;
 2. As (1) but requesting this ticket to be merged during 4.0-beta, so we can release 4.0-beta now,&lt;br/&gt;
 3. Spin out the new suggestion and all public API changes to a separate ticket, slated for 4.0-beta, and merging this ticket.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I suspect, since you have offered to help &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt;, that most are in favour of (2) ?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17152266" author="dcapwell" created="Mon, 6 Jul 2020 19:27:02 +0000"  >&lt;p&gt;Reread the conversations that have been going on over the past 3 days several times, sorry if I missed anything or didn&apos;t grasp all points.&lt;/p&gt;

&lt;p&gt;Most of the thread is about doing an all or nothing approach, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt; for trying to argue for incremental improvement.  Looking at the list of properties impacted (see &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-new#diff-4302f2407249672d7845cd58027ff6e9R257-R339&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-new#diff-4302f2407249672d7845cd58027ff6e9R257-R339&lt;/a&gt;) it looks like a subset would be clearly impacted by the grouping approach, and others not so much or are complementary; given this we could accept a hand full of the properties and move the other properties into the grouping work (stuff such as read_request_timeout_in_ms to read_request_timeout I feel are fine even with the grouping approach, but stuff which renames things maybe leave out for now, such as enable_user_defined_functions to user_defined_functions_enabled).&lt;/p&gt;

&lt;p&gt;I do agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; that it isn&apos;t ok to keep changing our config API since this is user facing, we should be strict about user facing changes and try to help more than harm.  If there is a belief that one structure is better than another then I value this dialog and hope we can get more eyes from the users/operators to see their thoughts; for this work we should really speak about the YAML representation rather than the code so we can agree on the final result.  Also, given the framework that is provided by this patch, I don&apos;t see that work as throwing everything away, instead I see it benefiting from the work which is started.  Given the work involved is to add support for &quot;moving&quot; a field (current &quot;rename&quot; is a special case of move where the move is at the same level) from one location to another (rename and conversion already supported), this adds complexity for the case where the new and the old field are both used and may hit complexity issues with SnakeYaml implementation.  I do believe we should have this discussion and settle on a solution before releasing 4.0.0, but I do not feel that this discussion blocks a beta release. There is a lot of chatting about being a beta blocker but I don&apos;t really follow why this JIRA (or the grouping one) is a blocker.  Reading &lt;a href=&quot;https://cwiki.apache.org/confluence/display/CASSANDRA/Release+Lifecycle&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/CASSANDRA/Release+Lifecycle&lt;/a&gt; I don&apos;t see why this JIRA could not be done during beta, it meets every requirement for this phase.&lt;/p&gt;

&lt;p&gt;Given all the comments above, my TL;DR&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Can we find a subset of properties with the current patch which are not discarded by the grouping work (sample given above)&lt;/li&gt;
	&lt;li&gt;Can we start the conversation and start asking operators of Cassandra clusters on their thoughts on grouping vs not grouping?  Grouping could be nice for humans but could be horrid for some automation (I am neither pro or against grouping, I defer to operators preference here).&lt;/li&gt;
	&lt;li&gt;Can we mark this ticket and the grouping one as non-blocking for beta&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17152590" author="benedict" created="Tue, 7 Jul 2020 09:15:54 +0000"  >&lt;blockquote&gt;&lt;p&gt;We can ... not deprecat&lt;span class=&quot;error&quot;&gt;&amp;#91;e&amp;#93;&lt;/span&gt; the old API and not announc&lt;span class=&quot;error&quot;&gt;&amp;#91;e&amp;#93;&lt;/span&gt; ... the new API&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This would be fine by me.  My -1 as expressed applied only to the public API changes.  All of the other changes in this ticket are absolutely good to go (once review is completed, of course).&lt;/p&gt;

&lt;p&gt;Also to reiterate again (since things easily get lost in such a contentious exchange): &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I think this work is great, and am really glad &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; undertook it.&lt;/li&gt;
	&lt;li&gt;I don&apos;t personally mind too strongly &lt;em&gt;which&lt;/em&gt; API we settle on, just expect that we settle on one upfront before committing the userbase to it.&lt;/li&gt;
	&lt;li&gt;I think it&apos;s a shame that this has seemingly turned into a heightened and acrimonious exchange.&lt;/li&gt;
	&lt;li&gt;It&apos;s worth remembering this situation is not unique; we have all experienced having to revisit work (or abandon it, even - my GitHub is a graveyard of good intentions) to our frustration and disappointment; it&apos;s a part of OSS development.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17152593" author="blerer" created="Tue, 7 Jul 2020 09:23:52 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can we mark this ticket and the grouping one as non-blocking for beta&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I will do that.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can we start the conversation and start asking operators of Cassandra clusters on their thoughts on grouping vs not grouping? Grouping could be nice for humans but could be horrid for some automation (I am neither pro or against grouping, I defer to operators preference here).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt; as you are the ones that suggested the change, would you mind starting the discussion on the dev list?&lt;/p&gt;</comment>
                            <comment id="17152607" author="benedict" created="Tue, 7 Jul 2020 09:49:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;would you mind starting the discussion on the dev list?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Happy to get more directly involved to move this along, if you like.  In this case I will put together a specific proposal to bring to the dev list, to avoid it being an aimless discussion.&lt;/p&gt;</comment>
                            <comment id="17157935" author="edimitrova" created="Wed, 15 Jul 2020 06:41:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt; pointed to me correctly that the new yaml was missing at the last submitted branch as I was testing the backward compatibility with the old cassandra.yaml.&lt;br/&gt;
&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commits/CASSANDRA-15234-new2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;This &lt;/a&gt; is a link to a WIP branch where the new yaml could be found.&lt;br/&gt;
The last two commits are respectively the change to a new structure and the change of parameters names. &lt;/p&gt;</comment>
                            <comment id="17159688" author="maedhroz" created="Fri, 17 Jul 2020 05:30:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; I&apos;ve posted &lt;a href=&quot;https://github.com/maedhroz/cassandra/commit/49e83c70eba3357978d1081ecf500bbbdee960d8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;a rough sketch&lt;/a&gt; of what a fairly aggressive application of option grouping would look like for &lt;tt&gt;cassandra.yaml&lt;/tt&gt;. Hopefully that helps keep the conversation moving forward. The biggest change I made to the existing structure was placing options for the same component in the same group, rather than having &quot;commonly used&quot; and &quot;advanced&quot; options (in some cases) in totally different parts of the file.&lt;/p&gt;</comment>
                            <comment id="17159846" author="benedict" created="Fri, 17 Jul 2020 10:15:28 +0000"  >&lt;p&gt;Thanks Caleb for the reminder.  I&apos;ve &lt;a href=&quot;https://github.com/belliottsmith/cassandra/tree/CASSANDRA-15234-grouping-ideas&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pushed another approach&lt;/a&gt;, that groups options by the reason the operator cares about them, namely: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;cluster&lt;/tt&gt;-wide settings (partitioner, token etc)&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;disk&lt;/tt&gt; options that specify strategy, throttle throughput etc&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;memory&lt;/tt&gt; options that allocate heap or direct memory resources&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;concurrency&lt;/tt&gt; that constrain the number of operations or threads committed to tasks&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;internode&lt;/tt&gt; and &lt;tt&gt;client&lt;/tt&gt; networking options&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;feature&lt;/tt&gt; options; and&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;log&lt;/tt&gt; options for our warning thresholds etc&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;It was taking a while, and it might not be well received, so I only went about 90% of the way so that the approach can receive some feedback.  Obviously, this would necessitate a different approach to the headline comments, wherein we might want to list the parameters users might care about in prose alongside explanations for why they might care.&lt;/p&gt;

&lt;p&gt;I personally would like to propose we also introduce a dual system for updating properties, wherein we can accept the nested namespace versions, as well as e.g. dot-delimited versions.  e.g. &lt;tt&gt;disk.throttle.compaction: 10MiB/s&lt;/tt&gt;. This should mitigate any risk to simplistic tools, as well as maybe providing us a simple route to permitting common options being given at the start of the file, without confusing the overall approach.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;: in going through the yaml, I noticed that you have used mbps in many places, but I thought we had previously agreed that any &lt;tt&gt;bps&lt;/tt&gt; was ambiguous, since it can mean bits or bytes?  I thought we had settled on MiB/s so that there could be no ambiguity?  (Since MB/s is also ambiguous - technically meaning 1000s, but often meaning powers of 2)?&lt;/p&gt;</comment>
                            <comment id="17160264" author="dcapwell" created="Fri, 17 Jul 2020 23:08:50 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; for the YAML examples; it would be great to start this dialog on user@ to get peoples feedback.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I personally would like to propose we also introduce a dual system for updating properties, wherein we can accept the nested namespace versions, as well as e.g. dot-delimited versions. e.g. disk.throttle.compaction: 10MiB/s. This should mitigate any risk to simplistic tools, as well as maybe providing us a simple route to permitting common options being given at the start of the file, without confusing the overall approach.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So the following would be supported?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
compaction_throughput_mb_per_sec: 42
disk:
  throttle:
    compaction: 42MiB/s
disk.throttle.compaction: 42MiB/s
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I assume the semantics would require mixed to work (part of the disk.throttle is nested, other parts are not) and wouldn&apos;t allow duplication definitions with other versions (can only use 1 of the 3 forms, not all), so doesn&apos;t seem that bad as that logic already exists.  We walk the class to discover the previous names, so can do the same or collect the shape while we walk.  &lt;/p&gt;

&lt;p&gt;My main concern is if this makes it more confusing for users; they may find some docs which say the old name, some using the nested name, and others using the flat name.&lt;/p&gt;</comment>
                            <comment id="17162209" author="edimitrova" created="Tue, 21 Jul 2020 17:41:38 +0000"  >&lt;p&gt;Good catch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; . Thank you. My bad, just pushed a fast commit &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/b4eebe080835da79d032f9314262c268b71172a8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&#160;for the three rate parameters we have.&#160;&lt;/p&gt;

&lt;p&gt;For the record, I stopped working on this patch until it is clear whether the code will be used at all. As far as I understand, you took the lead on a POC development for the newly suggested approach. Unfortunately, I don&apos;t have time to support this now but I would be happy to give feedback when it is shaped already.&#160;&lt;/p&gt;

&lt;p&gt;If you decide at some point this work or part of it to be committed, let me know, I will complete whatever is outstanding. The main framework is in place.&lt;/p&gt;

&lt;p&gt;A couple of things to keep in mind:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;As suggested by Benjamin, the patch can be simplified by making &lt;tt&gt;Converter&lt;/tt&gt; an &lt;tt&gt;enum&lt;/tt&gt;. It will allow to use the enum value directly into the &lt;tt&gt;Replaces&lt;/tt&gt; annotation. Doing so will remove the need to use reflection to instantiate the converters and the use of a cache to avoid multiple instantiation.&lt;/li&gt;
	&lt;li&gt;In-jvm tests - loading config parameters should be reworked as currently they don&apos;t work with custom types (like the newly introduced Duration, etc). The suggested approach by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;would work but it requires also api changes. I suggest a separate ticket for this part to be opened. Instead of using reflection, the suggestion is to use SnakeYAML. In order not to slow down the tests, no yaml files will be introduced but there will be a function to build the yaml nodes for us. This was a quick POC by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;but there are parameters which will need additional work and attention:&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MapToConfigTest
 {
&#160; &#160; &#160;@Test
&#160; &#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void test()
&#160; &#160; &#160;{
&#160; &#160; &#160; &#160; &#160; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; map = ImmutableMap.&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt;builder()
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; .put(&lt;span class=&quot;code-quote&quot;&gt;&quot;auto_bootstrap&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; .put(&lt;span class=&quot;code-quote&quot;&gt;&quot;permissions_validity_in_ms&quot;&lt;/span&gt;, 10)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; .put(&lt;span class=&quot;code-quote&quot;&gt;&quot;role_manager&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;some value&quot;&lt;/span&gt;)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; .build(); Constructor constructor = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; YamlConfigurationLoader.CustomConstructor(Config.class);
&#160; &#160; &#160; &#160; &#160;PropertiesChecker propertiesChecker = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PropertiesChecker();
&#160; &#160; &#160; &#160; &#160;constructor.setPropertyUtils(propertiesChecker);
&#160; &#160; &#160; &#160; &#160;constructor.setComposer(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Composer(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
&#160; &#160; &#160; &#160; &#160;{
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Node getSingleNode()
&#160; &#160; &#160; &#160; &#160; &#160; &#160;{
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; toNode(map);
&#160; &#160; &#160; &#160; &#160; &#160; &#160;}
&#160; &#160; &#160; &#160; &#160; });
&#160; &#160; &#160; &#160; &#160; &#160; Config config = (Config) constructor.getSingleData(Config.class);
&#160; &#160; &#160; &#160; &#160; &#160;&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;trap&quot;&lt;/span&gt;);
&#160; &#160; &#160;}

&#160; &#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Node toNode(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; object)
&#160; &#160; &#160;{
&#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (object &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; Map)
&#160; &#160; &#160; &#160; &#160; {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;List&amp;lt;NodeTuple&amp;gt; values = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; e : ((Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt;) object).entrySet())
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;{
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; values.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; NodeTuple(toNode(e.getKey()), toNode(e.getValue())));
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;}
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MappingNode(FAKE_TAG, values, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
&#160; &#160; &#160; &#160; &#160; &#160;}
&#160; &#160; &#160; &#160; &#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (object &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; || object &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; || object &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;)
&#160; &#160; &#160; &#160; &#160; &#160;{
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ScalarNode(FAKE_TAG, object.toString(), FAKE_MARK, FAKE_MARK, &lt;span class=&quot;code-quote&quot;&gt;&apos;\&apos;&lt;/span&gt;&apos;); 
           }
&#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
&#160; &#160; &#160; &#160; &#160; {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnsupportedOperationException(&lt;span class=&quot;code-quote&quot;&gt;&quot;unexpected type found: given &quot;&lt;/span&gt; + object.getClass());
&#160; &#160; &#160; &#160; &#160; }
&#160; &#160; &#160; }
&#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Tag FAKE_TAG = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Tag(&lt;span class=&quot;code-quote&quot;&gt;&quot;ignore&quot;&lt;/span&gt;);
&#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Mark FAKE_MARK = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Mark(&lt;span class=&quot;code-quote&quot;&gt;&quot;ignore&quot;&lt;/span&gt;, 0, 0, 0, &quot;&quot;, 0);
 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The rest are small things which I also partially already handled.&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt;, please,&#160;let me know if you have any other questions around this patch.&lt;/p&gt;</comment>
                            <comment id="17162271" author="benedict" created="Tue, 21 Jul 2020 18:26:24 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If you decide at some point this work or part of it to be committed&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It was a confusing disagreement, certainly.  I understood us to have agreed that - if wanted - we could commit the work that&apos;s been reviewed, excluding only the new config file (and the new config parameter name tests etc).  It&apos;s up to you of course.  I think there could be value in this, since it might make the config file change more manageable, but I&apos;m personally neutral on sequencing.&lt;/p&gt;

&lt;p&gt;I&apos;m fairly certain the main body of this work should be utilised to support whatever our new config file layout is; whether we commit it first or all together is fine by me, and I&apos;m happy to defer to others&apos; preferences (most importantly yours, as the author)&lt;/p&gt;</comment>
                            <comment id="17162342" author="benedict" created="Tue, 21 Jul 2020 21:07:28 +0000"  >&lt;blockquote&gt;&lt;p&gt;it would be great to start this dialog on user@&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;d personally prefer to hash out here for a week or so, to get a good proposal to take to the user list, or a couple of competing proposals.  I find public engagements works best when there&apos;s a good case to challenge/consider.&lt;/p&gt;

&lt;p&gt;It&apos;s a difficult balancing act getting any given approach right, and there are multiple approaches.  I would love to see another approach taken more to its conclusion for comparison.&lt;/p&gt;

&lt;p&gt;I&apos;ve made some further changes, and to make it clearer created a &lt;a href=&quot;https://github.com/belliottsmith/cassandra/blob/5f80d1c0d38873b7a27dc137656d8b81f8e6bbd7/conf/cassandra_nocomment.yaml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;yaml&lt;/a&gt; with comments mostly stripped.&lt;/p&gt;

&lt;p&gt;In this version, there are basic settings for network, disk etc all grouped together, followed by operator tuneables mostly under &lt;tt&gt;limits&lt;/tt&gt; within which we now have &lt;tt&gt;throughput&lt;/tt&gt;, &lt;tt&gt;concurrency&lt;/tt&gt;, &lt;tt&gt;capacity&lt;/tt&gt;.  This leads to settings for some features being kept separate (most notably for caching), but helps the operator understand what they have to play with for controlling resource consumption.&lt;/p&gt;

&lt;p&gt;It&apos;s still incomplete, but 90%+ done, and thoughts would be most welcome.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;My main concern is if this makes it more confusing for users; they may find some docs which say the old name, some using the nested name, and others using the flat name.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is a possibility, and I&apos;m not wed to the idea - but I think the balance of benefit to risk is probably pretty good, particularly since the names are fairly consistent (and we can have a blurb at the start to explain the dual system), so I doubt it should lead to too much confusion if we opt for it.&lt;/p&gt;</comment>
                            <comment id="17162346" author="lorina@datastax.com" created="Tue, 21 Jul 2020 21:12:00 +0000"  >&lt;p&gt;I will be happy to write clear information about this topic in the docs&lt;br/&gt;
after implementation, to explain old/new.&lt;/p&gt;

&lt;p&gt;Lorina&lt;br/&gt;
Lorina Poland&lt;br/&gt;
e. lorina@datastax.com&lt;br/&gt;
w. www.datastax.com&lt;/p&gt;



&lt;p&gt;On Tue, Jul 21, 2020 at 2:09 PM Benedict Elliott Smith (Jira) &amp;lt;&lt;/p&gt;
</comment>
                            <comment id="17163071" author="dcapwell" created="Wed, 22 Jul 2020 21:03:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;d personally prefer to hash out here for a week or so, to get a good proposal to take to the user list, or a couple of competing proposals. I find public engagements works best when there&apos;s a good case to challenge/consider.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I will be happy to write clear information about this topic in the docs after implementation, to explain old/new.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thats great Lorina!&lt;/p&gt;</comment>
                            <comment id="17164627" author="edimitrova" created="Fri, 24 Jul 2020 20:52:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; I am sorry for my delayed responses but I am multi-tasking a lot these days.&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;I&apos;m fairly certain the main body of this work should be utilised to support whatever our new config file layout is; whether we commit it first or all together is fine by me, and I&apos;m happy to defer to others&apos; preferences (most importantly yours, as the author)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think the backward compatibility is the primary part that will be most probably reworked to accommodate the new approach. I think the moment we moved the ticket to beta and the discussion continued here, that was the time we kind of agreed through our actions that this work will be continued/completed/committed later. I might have gotten it wrong. As it looks like this is already happening, I suggest to shape it and then move on with the actual changes. Maybe we can only create now a separate new ticket on the in-jvm api change so a snapshot release could be voted, etc. But also, we need to see what yaml nodes will have to be created according to what we need, so that work could also wait a bit until the api part is agreed, I think.&lt;/p&gt;

&lt;p&gt;About the dual approach, I am not sure I understand you correct what you mean in this citation:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;providing us a simple route to permitting common options being given at the start of the file, without confusing the overall approach.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I understand having third version will help any simplistic tools in case they can&apos;t deal with the nested approach but to me personally it would be confusing. I am pretty sure &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lorina%40datastax.com&quot; class=&quot;user-hover&quot; rel=&quot;lorina@datastax.com&quot;&gt;lorina@datastax.com&lt;/a&gt; will update perfectly the documentation (as usual, thanks a lot &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lorina%40datastax.com&quot; class=&quot;user-hover&quot; rel=&quot;lorina@datastax.com&quot;&gt;lorina@datastax.com&lt;/a&gt;!) but at the same time if someone is in a hurry during a production issue, they will just jump on random link from google probably and maybe be get confused about what/how. Here, for this part, probably the survey will show the best.&lt;br/&gt;
 Otherwise, the grouping sounds reasonable to me.&lt;/p&gt;

&lt;p&gt;The reason why I suggested Quick Start, Advanced options etc is new users. I kind of feel that for someone brand new to C* this might help. But also if we make groups into nested parameters, sure this becomes irrelevant and those sections will not really make sense anymore, not in their current version.&lt;/p&gt;

&lt;p&gt;Excited to see the end result/user reactions.&lt;/p&gt;

&lt;p&gt;Last but not least, I also agree with you on the below:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;I&apos;d personally prefer to hash out here for a week or so, to get a good proposal to take to the user list, or a couple of competing proposals. I find public engagements works best when there&apos;s a good case to challenge/consider.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17171797" author="maedhroz" created="Wed, 5 Aug 2020 22:19:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;Maybe we can only create now a separate new ticket on the in-jvm api change so a snapshot release could be voted, etc.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; I like that idea. I&apos;d volunteer to review a separate Jira...&lt;/p&gt;</comment>
                            <comment id="17203910" author="pauloricardomg" created="Tue, 29 Sep 2020 12:52:12 +0000"  >&lt;p&gt;Despite the awesome work (thanks for leading it &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;) and productive discussion that went into this issue, we didn&apos;t seem to reach a strong agreement here and it seems to me it&apos;s a bit late in the 4.0 release cycle to land this?&lt;/p&gt;

&lt;p&gt;In the spirit of expediting 4.0RC release I propose we postpone this to 4.X, and resume this with high priority earlier in the next release cycle. What do you think?&lt;/p&gt;</comment>
                            <comment id="17204374" author="jmeredithco" created="Wed, 30 Sep 2020 00:02:51 +0000"  >&lt;p&gt;The improvements are definitely very valuable and make configuration much cleaner and more flexible, but I&apos;m also concerned it&apos;s too late in the cycle.&lt;/p&gt;

&lt;p&gt;Although the patch goes to great lengths to be backward compatible, people that have been working towards getting ready for production deployments would need to re-test all the configurations they&apos;ve worked through so far which would certainly cause rework to validate the release.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17209288" author="maedhroz" created="Wed, 7 Oct 2020 04:58:02 +0000"  >&lt;blockquote&gt;&lt;p&gt;In the spirit of expediting 4.0RC release I propose we postpone this to 4.X, and resume this with high priority earlier in the next release cycle.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m more or less in agreement that we push this to the next major along with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16038&quot; title=&quot;Add a getter for InstanceConfig parameters - in-jvm-dtests-api&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16038&quot;&gt;&lt;del&gt;CASSANDRA-16038&lt;/del&gt;&lt;/a&gt;, unless some unrelated need for the latter arises.&lt;/p&gt;</comment>
                            <comment id="17209355" author="blerer" created="Wed, 7 Oct 2020 07:32:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;In the spirit of expediting 4.0RC release I propose we postpone this to 4.X, and resume this with high priority earlier in the next release cycle.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is a major configuration change. As such, it should be part of a &lt;tt&gt;major&lt;/tt&gt; release and not of a &lt;tt&gt;minor&lt;/tt&gt; one. I am fine postponing this ticket but the next target for it should be &lt;tt&gt;5.0&lt;/tt&gt; in my opinion not &lt;tt&gt;4.X.&lt;/tt&gt; &lt;/p&gt;</comment>
                            <comment id="17209519" author="pauloricardomg" created="Wed, 7 Oct 2020 12:51:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;I am fine postponing this ticket but the next target for it should be 5.0 in my opinion not 4.X.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1, I actually meant next major by 4.X&lt;/p&gt;</comment>
                            <comment id="17209532" author="edimitrova" created="Wed, 7 Oct 2020 13:15:03 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Changed the version to 4.x only because there is no 5 yet. If there is other way to mark it that I missed, please, feel free to correct me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17209537" author="benedict" created="Wed, 7 Oct 2020 13:23:30 +0000"  >&lt;p&gt;Not sure if you need special permissions, but you can just create a new version.&lt;/p&gt;

&lt;p&gt;Sorry for my having not had time to finish my proposal - but I agree having a bit more time to decide and consult on the best layout is probably a good thing.&lt;/p&gt;</comment>
                            <comment id="17209560" author="edimitrova" created="Wed, 7 Oct 2020 14:03:22 +0000"  >&lt;p&gt;Thanks&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt;. I think maybe it is a matter of Jira permissions. My only option is to select only from a list of already created versions.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17374817" author="blerer" created="Mon, 5 Jul 2021 13:06:27 +0000"  >&lt;p&gt;Changing the status to &lt;tt&gt;IN PROGRESS&lt;/tt&gt; as the current patch need to update once we agree on the expected outcome.&lt;/p&gt;</comment>
                            <comment id="17376655" author="edimitrova" created="Wed, 7 Jul 2021 15:40:44 +0000"  >&lt;p&gt;Reading back the thread here and reminding myself of what we discussed I guess the next step is to hash out a proposal for the user list and get some feedback?&lt;/p&gt;
&lt;blockquote&gt;&lt;blockquote&gt;&lt;p&gt;&#160;I&apos;d personally prefer to hash out here for a week or so, to get a good proposal to take to the user list, or a couple of competing proposals. I find public engagements works best when there&apos;s a good case to challenge/consider.&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17376671" author="benedict" created="Wed, 7 Jul 2021 16:05:04 +0000"  >&lt;p&gt;So, I produced an initial proposal &lt;a href=&quot;https://github.com/belliottsmith/cassandra/blob/5f80d1c0d38873b7a27dc137656d8b81f8e6bbd7/conf/cassandra_nocomment.yaml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15234?focusedCommentId=17162342&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-17162342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;this comment&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;It is not complete, but the shape of the idea is pretty clear, I think - it would be good to get some initial feedback on this approach to grouping of config options, as optimising the groups is a laborious job that there&apos;s no point pursuing if it&apos;s otherwise unwelcome. We can no doubt bike shed those to death as well, if we so choose.&lt;/p&gt;
</comment>
                            <comment id="17383461" author="edimitrova" created="Mon, 19 Jul 2021 17:07:30 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; and apologize for the late response. There was a lot of multitasking lately.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;it would be good to get some initial feedback on this approach to grouping of config options, as optimising the groups is a laborious job that there&apos;s no point pursuing if it&apos;s otherwise unwelcome.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Absolutely agree with you. I personally have only that question for feedback, whether they would prefer the sections or the nested version you suggested.&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=paulo&quot; class=&quot;user-hover&quot; rel=&quot;paulo&quot;&gt;paulo&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lorina%40datastax.com&quot; class=&quot;user-hover&quot; rel=&quot;lorina@datastax.com&quot;&gt;lorina@datastax.com&lt;/a&gt; &#160;&#160;(maybe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stefan.miklosovic&quot; class=&quot;user-hover&quot; rel=&quot;stefan.miklosovic&quot;&gt;stefan.miklosovic&lt;/a&gt;&#160;as I know he was also interested into this work at some point) - do you have anything to add here as concerns/comment before we bring it to the user list? Any other proposals?&lt;/p&gt;

&lt;p&gt;Also, should it come from a PMC? Survey or just a discussion mail thread? I am not familiar of any similar discussions before so I am not sure what would be the right approach, I am open for suggestions/advice anyone might have. Thank you.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17433798" author="edimitrova" created="Mon, 25 Oct 2021 14:35:51 +0000"  >&lt;p&gt;For the record, this is the discussion thread from the dev mailing list - &lt;a href=&quot;https://lists.apache.org/thread.html/r507be1624a568765f9d5ec5f6b561885129d0aaeb982e9bd9bf5e01b%40%3Cdev.cassandra.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread.html/r507be1624a568765f9d5ec5f6b561885129d0aaeb982e9bd9bf5e01b%40%3Cdev.cassandra.apache.org%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Based on it, I am getting back to this work.&lt;/p&gt;</comment>
                            <comment id="17435713" author="edimitrova" created="Thu, 28 Oct 2021 23:12:16 +0000"  >&lt;p&gt;Rebase and cleaning done successfully.&lt;/p&gt;

&lt;p&gt;I cleaned Unit tests and distributed In-jvm tests, passing up to current trunk state. I should finish updating the Python DTests for the new config parameters&apos; names and check for failures when the java upgrade tests are fixed.&lt;/p&gt;

&lt;p&gt;Topic:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the upgrade tests will be testing with the new names and config parameters provided with the units for trunk. We have unit tests that check the backward compatibility parsing. I guess we don&apos;t plan to run the upgrades also with the old config?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I plan to publish the full patch for new round of review probably early next week.&lt;/p&gt;</comment>
                            <comment id="17447181" author="edimitrova" created="Mon, 22 Nov 2021 03:21:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;,&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;, submitting for new round of review.&#160;&lt;br/&gt;
I have some issue that I can&apos;t always trigger in CI the newest version I push to ccm. Still it seems Jenkins has more success than CircleCI.&lt;/p&gt;

&lt;p&gt;Until I figure it out, these are the patches for initial round of review.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:CASSANDRA-15234-take2?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt; |&#160;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra-dtest/pull/new/CASSANDRA-15234-take2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&#160;| &lt;a href=&quot;https://github.com/ekaterinadimitrova2/ccm/pull/new/CASSANDRA-15234&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ccm&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;I cleaned all tests without full Jenkins confirmation of the Python DTests yet due to the ccm issue mentioned.&lt;/p&gt;

&lt;p&gt;Also, this patch latest rebase was also a week ago and I will rebase again when I have to do next round of review changes and I fix ccm as otherwise on every rebase something new appears as trunk is quite alive and the config is all over the place. Let me first stabilize CI and we can agree on the patch, then I will clean this.&lt;/p&gt;

&lt;p&gt;Now a few important comments:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;ASCII doc migration is still not done but I will open a ticket to add docs for us for adding new config and docs for our users around the new and old types and names.&lt;/li&gt;
	&lt;li&gt;DTests were not updated to the new names and format as this will take forever. Suggestion - leave the old ones and add new tests with new ones. We can also open a follow up ticket but now this exercises the backward compatibility which is good as this is also how I figured out one more change needed for CCM.&lt;/li&gt;
	&lt;li&gt;CCM was updated to be able to handle the backward compatibility and mimic the Cassandra behavior.&#160;&lt;/li&gt;
	&lt;li&gt;I suggest not to overwhelm the patch with the reorganization of cassandra.yaml I suggested earlier on this ticket. I will pull it in a separate one and I can trigger a new discuss thread on the mailing list to confirm that.&#160;&lt;/li&gt;
	&lt;li&gt;Converter was not changed to an enum because we need generics support for that and &#160;&lt;a href=&quot;http://openjdk.java.net/jeps/301&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JEP301&lt;/a&gt; was withdrawn.&#160;&lt;/li&gt;
	&lt;li&gt;Intentionally left the commits after the old patch not squashed to provide some input and hopefully make the review a bit more easy. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;&#160; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;, please, let me know if you want them in a different way for the review.&lt;/li&gt;
	&lt;li&gt;Now when 4.0 was released I had to add also Virtual Table backward compatibility and the easiest way was just to have the old names and types and the new ones both listed in the Settings table, available for our users.&#160;&lt;/li&gt;
	&lt;li&gt;&lt;em&gt;commitlog_sync_batch_in_ms&lt;/em&gt; was left for another ticket as the in-jvm upgrade tests will need work to make it possible to support it due to their nature as it seems we have the lower branch &lt;em&gt;DatabaseDescriptor&lt;/em&gt; class loaded and it makes checks on trunk and complains if we change to the custom type. (&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17161&quot; title=&quot;Remove commitlog_sync_batch_window_in_ms&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17161&quot;&gt;&lt;del&gt;CASSANDRA-17161&lt;/del&gt;&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;Any new parameters added post 4.0 in trunk were/will be directly changed to support the new format as they are still not in any release.&#160;&lt;/li&gt;
	&lt;li&gt;CCM_41_YAML_OPTIONS in ccm should be well documented and people warned that they need to keep it up to date on changes in config. I hope we won&apos;t need this to happen a lot after this update but we need to ensure people are aware of it. It seems a bit clumsy but I didn&apos;t find a better way to handle ccm at this point. I am open for ideas.&#160;&lt;/li&gt;
	&lt;li&gt;I can think of adding some additional test for the virtual table.&#160;&lt;/li&gt;
	&lt;li&gt;I also suggest we add a warning to the users when they start Cassandra that if they add more than once a property (even if it is the old name), the latest occurrence from the yaml file will be the one assigned to the parameter. I would say we add also info to the docs and we don&apos;t complicate to add checks whether we have or not more occurrences during startup and emitting warnings on occurrence as it seems a bit too much overhead on startup. WDYT?&lt;/li&gt;
	&lt;li&gt;There were deprecation warnings emitted more than once. I fixed this. This fix should be also ported to 4.0 where we had to make small port of the name change because of two parameters issues. (FTR - &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17141&quot; title=&quot;internode_send_buff_size_in_bytes and&#160;internode_recv_buff_size_in_bytes from cassandra.yaml &quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17141&quot;&gt;&lt;del&gt;CASSANDRA-17141&lt;/del&gt;&lt;/a&gt;) In 4.0 they are not only two properties with the warnings twice so it was harder to spot it.&#160;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17451443" author="dcapwell" created="Tue, 30 Nov 2021 23:42:55 +0000"  >&lt;p&gt;patch is massive; no way I can finish before I go on break Friday =(&lt;/p&gt;

&lt;p&gt;Can you actually send a PR?  easier to leave comments&lt;/p&gt;</comment>
                            <comment id="17451447" author="edimitrova" created="Tue, 30 Nov 2021 23:49:59 +0000"  >&lt;p&gt;Sure, &lt;a href=&quot;https://github.com/apache/cassandra/pull/1350&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; created&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;patch is massive; no way I can finish before I go on break Friday =(&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This waited whole year, it can wait while you take well deserved break. I will be off on Friday and then in two weeks again. Hopefully the next rebase won&apos;t be too painful &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;Hopefully the community won&apos;t&#160;work too much around the holidays &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&#160;&lt;/p&gt;</comment>
                            <comment id="17451448" author="dcapwell" created="Tue, 30 Nov 2021 23:54:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;DTests were not updated to the new names and format as this will take forever. Suggestion - leave the old ones and add new tests with new ones. We can also open a follow up ticket but now this exercises the backward compatibility which is good as this is also how I figured out one more change needed for CCM.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;works for me; more testing we didn&apos;t break things &lt;sup&gt;_&lt;/sup&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I suggest not to overwhelm the patch with the reorganization of cassandra.yaml I suggested earlier on this ticket. I will pull it in a separate one and I can trigger a new discuss thread on the mailing list to confirm that. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Works for me&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;Converter was not changed to an enum because we need generics support for that and  JEP301 was withdrawn. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Works for me&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Intentionally left the commits after the old patch not squashed to provide some input and hopefully make the review a bit more easy. Benjamin Lerer  and David Capwell , please, let me know if you want them in a different way for the review.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Personally prefer PRs, easier to leave comments than commits&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;Any new parameters added post 4.0 in trunk were/will be directly changed to support the new format as they are still not in any release. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Saw the TrackWarning changes.... &amp;lt;3&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I can think of adding some additional test for the virtual table. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I am 100% cool leaving the vtable problem to another ticket =). Right now it will show the new names, if we want different behavior we can solve it outside of this JIRA.  We are having side conversations on how can we unify (at least I am pushing this) properties access.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I also suggest we add a warning to the users when they start Cassandra that if they add more than once a property (even if it is the old name), the latest occurrence from the yaml file will be the one assigned to the parameter. I would say we add also info to the docs and we don&apos;t complicate to add checks whether we have or not more occurrences during startup and emitting warnings on occurrence as it seems a bit too much overhead on startup. WDYT?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ideally I like this, but also 100% cool not doing in this patch.  &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
a: b
a: c
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;that has worked for years without anyone noticing... if adding a warning is low-hanging-fruit then I am cool, but I wouldn&apos;t hold up this ticket (I like splitting tickets if you have not noticed).&lt;/p&gt;</comment>
                            <comment id="17451939" author="edimitrova" created="Wed, 1 Dec 2021 17:41:20 +0000"  >&lt;p&gt;Moving the ticket to &quot;In Review&quot; as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160; is already looking into it.&lt;/p&gt;

&lt;p&gt;Also, for visibility and context as it seems I missed in my summary - there is a separate ticket linked to this one(&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9691&quot; title=&quot;Liberate cassandra.yaml parameter names from their units&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9691&quot;&gt;&lt;del&gt;CASSANDRA-9691&lt;/del&gt;&lt;/a&gt;) which was mentioning liberating metrics and JMX from units or just moving to lowest unit at least. I left this part to be handled there but I forgot to mention it in my summary. Apologize for that&lt;/p&gt;

&lt;p&gt;My thought was currently to leave the &#160;JMX and metrics for now and assume the old units are in place but &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;is right we need at least to verify (and convert if needed) that in Config the old unit was used with the new custom types and we didn&apos;t use something different as this can be a mess if we leave it to people and reading docs. Something similar will also be needed for VTs where we will have to check the Converter in the new @Replaces annotation. There was idea for getting the VT backward compatibility out until we figure out how we are going to handle the VT as there is ongoing discussion around that, I will leave this now aside for a moment until we clear a bit the discussion. CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;&#160;as I know he is working on a patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15254&quot; title=&quot;Allow UPDATE on settings virtual table to change running configurations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15254&quot;&gt;CASSANDRA-15254&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also, I will be looking again into the ccm issue in the afternoon.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17452143" author="edimitrova" created="Thu, 2 Dec 2021 02:53:17 +0000"  >&lt;p&gt;Quick update - I figured it is purely pip3 issue how we install ccm. The time things worked was when I had a bug in my code, but in general CCM is not changing to my new version when I change it in requirements.txt&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;What I found in CircleCI logs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Collecting ccm
  Cloning https:&lt;span class=&quot;code-comment&quot;&gt;//github.com/ekaterinadimitrova2/ccm.git (to revision CASSANDRA-15234) to /tmp/pip-install-dvfww32x/ccm_727b34808faa4db6904e104a715a22d2
&lt;/span&gt;  Running command git clone -q https:&lt;span class=&quot;code-comment&quot;&gt;//github.com/ekaterinadimitrova2/ccm.git /tmp/pip-install-dvfww32x/ccm_727b34808faa4db6904e104a715a22d2
&lt;/span&gt;  Running command git checkout -b CASSANDRA-15234 --track origin/CASSANDRA-15234
  Switched to a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; branch &lt;span class=&quot;code-quote&quot;&gt;&apos;CASSANDRA-15234&apos;&lt;/span&gt;
  Branch &lt;span class=&quot;code-quote&quot;&gt;&apos;CASSANDRA-15234&apos;&lt;/span&gt; set up to track remote branch &lt;span class=&quot;code-quote&quot;&gt;&apos;CASSANDRA-15234&apos;&lt;/span&gt; from &lt;span class=&quot;code-quote&quot;&gt;&apos;origin&apos;&lt;/span&gt;.
  Resolved https:&lt;span class=&quot;code-comment&quot;&gt;//github.com/ekaterinadimitrova2/ccm.git to commit ee52d120ea34d44500c64bfb3b9d3f517b0865f1&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;But then&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 pip3 freeze
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;output shows:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ccm @ git+https:&lt;span class=&quot;code-comment&quot;&gt;//github.com/riptano/ccm.git@ce612ea71587bf263ed513cb8f8d5dfcf7c8dadb&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I will debug this tomorrow but it is the way we update ccm not CircleCI caching or so&lt;/p&gt;</comment>
                            <comment id="17452661" author="edimitrova" created="Thu, 2 Dec 2021 23:46:03 +0000"  >&lt;p&gt;Short update:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I figured out what needs to be done in order to be able to test with our own CCM branch - ticket to update our docs opened &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17182&quot; title=&quot;Add info how to test with your own CCM branch&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17182&quot;&gt;&lt;del&gt;CASSANDRA-17182&lt;/del&gt;&lt;/a&gt;.&lt;/li&gt;
	&lt;li&gt;I was also thinking of adding a test to the ccm tests but it seems they are not run in CI, not sure what is the story there. (&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;, any ideas?)&lt;/li&gt;
	&lt;li&gt;Almost all tests pass now, it seems I have an issue with the assert warnings only(a few Python DTests failed), I have to correct the string pattern used. I did it &lt;a href=&quot;https://github.com/apache/cassandra-dtest/pull/169/commits/7c417847092524d46de9e03d11d6acc63159e2dd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; but I haven&apos;t run whole CI for this now. &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1239/workflows/345d82ca-1e2a-4db9-b660-a88324793a40&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Java8 CI&lt;/a&gt; | &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1239/workflows/d0f8f584-ede1-42f1-96ad-9fbc2d981a56&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Java11 CI &lt;/a&gt;. This branch was not rebased in the past two weeks so some of the test fixes are not applied.&lt;/li&gt;
	&lt;li&gt;I will do the JMX change next week in a new commit, it also shouldn&apos;t bother any reviews to happen in the meantime if/when people are available. I know &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt; are busy and also holidays are approaching.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17454221" author="maedhroz" created="Mon, 6 Dec 2021 20:07:49 +0000"  >&lt;p&gt;Note: I think the &lt;tt&gt;TestClientRequestMetrics&lt;/tt&gt; &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1239/workflows/d0f8f584-ede1-42f1-96ad-9fbc2d981a56/jobs/7427&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;failure&lt;/a&gt; is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17155&quot; title=&quot;Increase the buckets count for timer histogram&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17155&quot;&gt;&lt;del&gt;CASSANDRA-17155&lt;/del&gt;&lt;/a&gt;. With everything rebased, it should wash out. CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yifanc&quot; class=&quot;user-hover&quot; rel=&quot;yifanc&quot;&gt;yifanc&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17456808" author="maedhroz" created="Thu, 9 Dec 2021 23:09:17 +0000"  >&lt;p&gt;Finished my first pass of review and left comments inline in the PR. (Can take a look at CCM next...)&lt;/p&gt;</comment>
                            <comment id="17457271" author="maedhroz" created="Fri, 10 Dec 2021 17:03:02 +0000"  >&lt;p&gt;CCM changes look reasonable, and I didn&apos;t have trouble running a cluster with it against your branch.&lt;/p&gt;</comment>
                            <comment id="17460231" author="edimitrova" created="Wed, 15 Dec 2021 20:35:08 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;I made all changes as per the review comments and our discussions. I also left responses on the PR. I have three commits on &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/191/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this&lt;/a&gt; new PR, as we talked (The old PR stays there, nothing added, nothing squashed; kept for reference) Next round of review on the &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/191/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;new &lt;/a&gt; PR, the following commits:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/191/commits/c5b19d441949a4bbf0a4395517f8f637b9ee1ddf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the custom types and the related tests&lt;/a&gt;. All tests pass&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/191/commits/4fda1efee2cb9e066661982f79d1aa99ad8fbf8b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;The annotations and converters&lt;/a&gt;&#160; for backward compatibility. I &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1253/workflows/864beb33-9051-4ef7-a96d-4e235fa96e4e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ran &lt;/a&gt; the test suite to ensure any changes in the YAML loader didn&apos;t break anything. From what I see the only failures are known ones which after rebase of the patch should go away, most of them.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/191/commits/6a4cf1d5925da154fd39c35e367fb1aa0f447ca3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;The big change &lt;/a&gt;- all the parameters plus adding backward compatibility for virtual tables. &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1255/workflows/89b0d74c-f745-436a-b2bb-bc7b5ea721e6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI run&lt;/a&gt; Java 8 (I will run again also Java 11 later but there was no reason to waste resources now). The only related to this patch failure is the one of &lt;em&gt;test_sstablelevelreset .&lt;/em&gt;&#160;I have to adjust the warning pattern in the dtest repo.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Side Note: There are two circle ci related commits for testing purposes. Please ignore them. I will remove them at the end.&lt;/p&gt;

&lt;p&gt;I haven&apos;t touched the docs as they will have to be reworked after the migration to adoc.&lt;/p&gt;

&lt;p&gt;JMX methods conversion to the old units is in there but I will add new JMX methods in a separate commit. (There is another ticket linked to this one for that but there was a discussion better to add them here) This doesn&apos;t stop the rest of the work from being revised in the meantime.&lt;/p&gt;

&lt;p&gt;I have to add also that warning we discussed in case some parameters are set more than once in cassandra.yaml. I will do it in a separate commit.&lt;/p&gt;

&lt;p&gt;After we confirm the current work, I will do new rebase and change any new parameters in trunk to the new format (we still don&apos;t have alpha version so it is safe to just change the names and types and no backward compatibility is needed).&lt;/p&gt;

&lt;p&gt;Order of commits for now should be:&lt;/p&gt;

&lt;p&gt;1) Cassandra repo &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/191/commits/c5b19d441949a4bbf0a4395517f8f637b9ee1ddf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;(the custom types and related tests)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2) Cassandra repo (&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/191/commits/4fda1efee2cb9e066661982f79d1aa99ad8fbf8b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;The backward compatibility framework &lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;3) CCM patch&lt;/p&gt;

&lt;p&gt;4) dtest patch&lt;/p&gt;

&lt;p&gt;5) The &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/191/commits/6a4cf1d5925da154fd39c35e367fb1aa0f447ca3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;big change of parameters&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17469738" author="maedhroz" created="Thu, 6 Jan 2022 07:05:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; I&apos;ve made my final pass at review and left one more small set of nits inline in the PR. At a high level, there are only two things that linger a bit in my mind. The first, which I&apos;ve mentioned before, is that we would probably save ourselves some UX trouble later on if we allow a single space between values and units. (ex. Allow both &lt;tt&gt;10 MiB&lt;/tt&gt; and &lt;tt&gt;10 MiB&lt;/tt&gt;.) The second is trying, where possible, to leave the cases where we throw &lt;tt&gt;ConfigurationException&lt;/tt&gt; intact. (This mostly applies to the cases where we might throw it via JMX, i.e. we have something of a contract at the moment.)&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17469740" author="maedhroz" created="Thu, 6 Jan 2022 07:08:20 +0000"  >&lt;p&gt;Ah, and of course, we&apos;ll have to make a decision in terms of whether this hits 4.1 or not. If it doesn&apos;t, it seems like we wouldn&apos;t be able to merge to trunk.&lt;/p&gt;</comment>
                            <comment id="17469818" author="michaelsembwever" created="Thu, 6 Jan 2022 10:16:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;Ah, and of course, we&apos;ll have to make a decision in terms of whether this hits 4.1 or not. If it doesn&apos;t, it seems like we wouldn&apos;t be able to merge to trunk.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s ok that the patch bumps build.xml to 5.0, if warranted (on the presumption we are honouring capability or providing a deprecation cycle where appropriate).&lt;/p&gt;</comment>
                            <comment id="17470013" author="edimitrova" created="Thu, 6 Jan 2022 16:15:37 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;&#160;. I already addressed the first two commits review comments, I will address the third commit comments now. Then I will rebase on the latest changes from December and take care of the newest added config in a new commit. I will ping you when I am done.&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;It&apos;s ok that the patch bumps build.xml to 5.0, if warranted (on the presumption we are honouring capability or providing a deprecation cycle where appropriate).&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;In theory we have backward compatibility with the old yaml&amp;amp;config, no breaking changes which someone might say it qualifies for 4.1. Should I hit the mailing list about that?&lt;/p&gt;

&lt;p&gt;Also, for general visibility - I opted out of adding new JMX methods as there are already tickets for updating config through Virtual tables people work on and also there is no plan to change nodetool.&#160;&lt;/p&gt;</comment>
                            <comment id="17470082" author="edimitrova" created="Thu, 6 Jan 2022 17:42:44 +0000"  >&lt;p&gt;Moved back to 4.x as the patch has backward compatibility, introducing no breaking changes which aligns with our release discussions.&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;we would probably save ourselves some UX trouble later on if we allow a single space between values and units. (ex. Allow both 10MiB and 10 MiB.)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is very easy to introduce but I think it is confusing to have both, similar to what we decided about the letter case. I would prefer to keep the current version only. Let me know what you think.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The second is trying, where possible, to leave the cases where we throw &lt;tt&gt;ConfigurationException&lt;/tt&gt; intact. (This mostly applies to the cases where we might throw it via JMX, i.e. we have something of a contract at the moment.)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Good point, I will handle it, thanks.&#160;&lt;/p&gt;</comment>
                            <comment id="17475083" author="edimitrova" created="Thu, 13 Jan 2022 03:22:54 +0000"  >&lt;p&gt;While rebasing and adding more parameters I hit a corner case, three duration parameters without unit suffixes which I personally don&apos;t think they need name change. That&apos;s fine. A converter was easy to add for them, BUT... what about Virtual tables? In order to support backward compatibility we currently list old parameters, those with new names are available in the old and the new form. For example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
memtable_heap_space &#160; 2018MiB
memtable_heap_space_in_mb &#160; &#160;2018
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The parameters that I personally didn&apos;t find a reason to change names but only the value formatting (adding the units to the value) are:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;key_cache_save_period, row_cache_save_period and counter_cache_save_period.&lt;/em&gt;&#160;I can easily say we introduce a breaking change and leave those alone in the new format but I am open to hear also others&apos; opinion. I feel I am getting too used to this work and I might be missing something. Also, IMHO it&apos;s worth it not to introduce breaking changes when/if possible.&lt;/p&gt;

&lt;p&gt;In other news during the latest rebase and addition of parameters I found we need to improve the precision for the &lt;em&gt;DataRateSpec.&lt;/em&gt;&#160;I will publish this in a separate patch soon, already handled.&lt;/p&gt;

&lt;p&gt;I am doing last cleaning of tests and I will publish the final version with all latest changes from November until now for the reviewers&apos; consideration.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17476514" author="edimitrova" created="Sat, 15 Jan 2022 03:42:21 +0000"  >&lt;p&gt;The &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/pull/191/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; is ready for final round in my opinion. Circle CI run &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1270/workflows/ecf6b25a-8849-4605-af66-9fbd53281629&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. (Only Java 8 until we have +1, then I will have also the Java 11; also I submitted a Jenkins run, see below)&lt;/p&gt;

&lt;p&gt;All three branches - &lt;a href=&quot;https://github.com/ekaterinadimitrova2/ccm/tree/CASSANDRA-15234&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CCM&lt;/a&gt;, &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/tree/15234-take2-review&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Cassandra&lt;/a&gt;&#160;and &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra-dtest/tree/CASSANDRA-15234-take2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;DTest repo&lt;/a&gt;&#160;were rebased and any outstanding issues fixed.&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;&lt;b&gt;Exceptions:&lt;/b&gt;&lt;/ins&gt;&#160;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The VT Settings related tests are failing because of the issue I mentioned in my previous comment around &lt;em&gt;key_cache_save_period, row_cache_save_period and counter_cache_save_period.&lt;/em&gt;&#160;&lt;/li&gt;
	&lt;li&gt;There are a few tests failing with byteman related issues. I suspect CircleCI might be acting weird. The tests complete fine locally. I just pushed a run in Jenkins &lt;a href=&quot;https://jenkins-cm4.apache.org/job/Cassandra-devbranch/1371/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&#160;which I will double check tomorrow.&#160;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17479134" author="maedhroz" created="Thu, 20 Jan 2022 07:22:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; Just reviewed the latest commits and dropped a few comments in the PR. Assuming there isn&apos;t anything controversial among them, my +1 stands. (For the &lt;tt&gt;*_save_period&lt;/tt&gt; items in the virtual table, my guess is just displaying them there in the new format w/ units would be fine.)&lt;/p&gt;</comment>
                            <comment id="17479733" author="edimitrova" created="Thu, 20 Jan 2022 22:48:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;&#160;I just rebased (both Cassandra and Cassandra-dtest) and pushed the updated as per your review patch. Still keeping things in separate commits for historical purposes until I have a go to squash things. Starting CI here - &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1276/workflows/2a49cd4f-d543-4b4c-966b-7cfe0c80f592&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;&#160;and &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1276/workflows/39a8545b-b44d-46e9-a374-acc86dbe5da0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17479794" author="edimitrova" created="Fri, 21 Jan 2022 02:52:32 +0000"  >&lt;p&gt;The CI lgtm, there are all known failures. The byteman issues appear again but they turned to be general problem with CircleCI. There is already a ticket for investigation.&lt;/p&gt;

&lt;p&gt;One thing on my mind is - there was a question whether we should use &quot;fail&quot; or &quot;abort&quot; if I am not mistaken. I noticed that only recently &quot;abort&quot; was introduced, &quot;fail&quot; is widely used in our config. I would suggest to stick to &quot;fail&quot; as it is already common for our users. Of course, I will be happy to hear if someone has a different perspective on this topic.&lt;/p&gt;

&lt;p&gt;Also, my understanding is that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;(from offline discussion)&#160;and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;&#160; are done with their reviews. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;&#160;is swamped at the moment but I want to thank him for all his support and feedback at the early stages. My understanding is &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;&#160;is about to do a final review and then we can commit when he is ready and of course, I address any potential concerns he might have. I will also do another pass tomorrow as the patch is big and widely spread around the codebase. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt;&#160;, please, let me know if you want me to squash already the work; what is easier for you to review.&lt;/p&gt;</comment>
                            <comment id="17480032" author="benedict" created="Fri, 21 Jan 2022 12:02:37 +0000"  >&lt;p&gt;+1 for &lt;tt&gt;fail&lt;/tt&gt;&lt;/p&gt;
</comment>
                            <comment id="17480155" author="maedhroz" created="Fri, 21 Jan 2022 16:06:10 +0000"  >&lt;p&gt;+1 on &quot;fail&quot;...we already use &quot;abort&quot; in many situations that relate to transactions&lt;/p&gt;</comment>
                            <comment id="17487621" author="edimitrova" created="Sun, 6 Feb 2022 03:55:39 +0000"  >&lt;p&gt;Approvals taken on GitHub and confirmed in Slack.&lt;/p&gt;

&lt;p&gt;Many rounds of testing on the different commits were executed, but this is the final CI:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1337/workflows/38632935-e720-4f5a-85d7-570fc52dbbee&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt; &#160;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1337/workflows/16bfc433-02fc-4164-ae3a-9d66c577c708&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;All issues have tickets except the one test that failed on Java 11 but it is some issue with port already occupied which I&apos;ve seen also with other tests and runs and it is infra related.&#160;&lt;/p&gt;

&lt;p&gt;CCM patch committed &lt;a href=&quot;https://github.com/riptano/ccm/commit/6d676896fb2ced4b6ac62fdba4ae2570351b38df&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&#160;and retagged.&lt;/p&gt;

&lt;p&gt;DTest patch committed &lt;a href=&quot;https://github.com/apache/cassandra-dtest/commit/3935906a685640b2f6a2058b38fdf45d917edfc9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Trunk patch split to 13 patches starts from &lt;a href=&quot;https://github.com/apache/cassandra/commit/db9f7a67ec4b03413c10034956e2cf18739ca4b1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this one&lt;/a&gt; on.&lt;/p&gt;

&lt;p&gt;Thank you and please don&apos;t hate me if Jenkins get down after seeing so many commits &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17487627" author="edimitrova" created="Sun, 6 Feb 2022 05:52:42 +0000"  >&lt;p&gt;I received an email that travis has failed for cassandra-dtest. It shows me that it failed with syntax error during execution pytest --metatests. I pulled the latest ccm locally and reran that step. It completed fine, same with my branch.&lt;/p&gt;

&lt;p&gt;In the meantime I saw that I missed to refert to riptano/ccm in requirements.txt. It seems it wasn&apos;t in the separate commit as I thought. I just ninja fixed that and I am going to see whether travis will fail again.&lt;/p&gt;

&lt;p&gt;Jenkins is still running, nothing unusual there for now.&#160;&lt;/p&gt;</comment>
                            <comment id="17487628" author="edimitrova" created="Sun, 6 Feb 2022 05:53:48 +0000"  >&lt;p&gt;Ok, travis just completed successfully after the ninja fix. I have no clue why was that error on a line in a file I haven&apos;t touched.&lt;/p&gt;</comment>
                            <comment id="17487629" author="edimitrova" created="Sun, 6 Feb 2022 06:01:15 +0000"  >&lt;p&gt;Jenkins failed and I found in the logs the same error. I just restarted the build... Considering that in travis things completed fine now, maybe here the same will happen. I am totally not sure where this came from... I will keep an eye on it&lt;/p&gt;</comment>
                            <comment id="17487801" author="edimitrova" created="Sun, 6 Feb 2022 23:52:42 +0000"  >&lt;p&gt;Seems like CCM retagging worked with Jenkins but not with CircleCI anymore. In order CircleCI to pickup the new tag, we need to add -e at the moment.&#160;&lt;/p&gt;

&lt;p&gt;I opened a follow up ticket &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17351&quot; title=&quot;Pip doesn&amp;#39;t install ccm every time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17351&quot;&gt;&lt;del&gt;CASSANDRA-17351&lt;/del&gt;&lt;/a&gt; to fix this. Until then, please, use -e. More details sent to the mailing list &lt;a href=&quot;https://lists.apache.org/thread/x6vojt50z5gcq9n3xfjvgb5cptnh36mz&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&#160;&lt;/p&gt;</comment>
                            <comment id="17509019" author="edimitrova" created="Fri, 18 Mar 2022 18:57:04 +0000"  >&lt;p&gt;CCM issue was fixed last week. No workarounds needed.&lt;/p&gt;

&lt;p&gt;Doc committed here - &lt;a href=&quot;https://github.com/apache/cassandra/commit/d67be0def4085863a039d5d3809a9457e883919b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/d67be0def4085863a039d5d3809a9457e883919b&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17656068" author="ifesdjeen" created="Mon, 9 Jan 2023 12:41:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;&#160;I realise that this was committed a while ago, but I got a question: there is a small change in output of nodetool commands that use `FileUtils#stringifyFileSize` that might break any parser that relies on the format to be in KB not in KiB etc. This constitutes a regression, doesn&apos;t it, as we&apos;ve set a precedent in &lt;del&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17683&quot; title=&quot;Address CASSANDRA-16844 and CASSANDRA-16976 breaking compatibility&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17683&quot;&gt;&lt;del&gt;CASSANDRA-17683&lt;/del&gt;&lt;/a&gt;?&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;, as we&apos;ve briefly talked about this.&#160;&lt;/p&gt;</comment>
                            <comment id="17656154" author="edimitrova" created="Mon, 9 Jan 2023 15:28:31 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt;, &#160;it seems&#160; `FileUtils#stringifyFileSize` is used for nodetool output which I &#160;missed when we were revising to revert changes after the discussions raised around &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17683&quot; title=&quot;Address CASSANDRA-16844 and CASSANDRA-16976 breaking compatibility&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17683&quot;&gt;&lt;del&gt;CASSANDRA-17683&lt;/del&gt;&lt;/a&gt;. So yes, I agree with you. I will open a ticket to revert the change later today. Thank you for raising the issue.&lt;/p&gt;</comment>
                            <comment id="17656157" author="edimitrova" created="Mon, 9 Jan 2023 15:36:06 +0000"  >&lt;p&gt;I just opened &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18139&quot; title=&quot;Revert changes to units output in FileUtils#stringifyFileSize&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18139&quot;&gt;&lt;del&gt;CASSANDRA-18139&lt;/del&gt;&lt;/a&gt;. We can move any discussions there.&lt;/p&gt;</comment>
                            <comment id="17679241" author="edimitrova" created="Fri, 20 Jan 2023 17:36:00 +0000"  >&lt;p&gt;FYI - just for completeness, posting also here. When I started working on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18139&quot; title=&quot;Revert changes to units output in FileUtils#stringifyFileSize&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18139&quot;&gt;&lt;del&gt;CASSANDRA-18139&lt;/del&gt;&lt;/a&gt; I noticed the change is not the output, units are binary since Cassandra 3.6, &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9692&quot; title=&quot;Print sensible units for all log messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9692&quot;&gt;&lt;del&gt;CASSANDRA-9692&lt;/del&gt;&lt;/a&gt;. The change done here was to the constants names. More info - &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18139&quot; title=&quot;Revert changes to units output in FileUtils#stringifyFileSize&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18139&quot;&gt;&lt;del&gt;CASSANDRA-18139&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="13412848">CASSANDRA-17166</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310660">
                    <name>Completes</name>
                                            <outwardlinks description="fixes">
                                        <issuelink>
            <issuekey id="13122731">CASSANDRA-14095</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12841939">CASSANDRA-9691</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13236564">CASSANDRA-15146</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13408862">CASSANDRA-17074</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13411155">CASSANDRA-17135</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13236564">CASSANDRA-15146</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13409945">CASSANDRA-17118</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13410918">CASSANDRA-17131</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13410922">CASSANDRA-17132</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13321544">CASSANDRA-16038</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13441179">CASSANDRA-17574</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13411369">CASSANDRA-17141</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13421374">CASSANDRA-17243</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13411872">CASSANDRA-17148</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13330255">CASSANDRA-16152</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13412351">CASSANDRA-17160</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13428218">CASSANDRA-17379</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13484654">CASSANDRA-17949</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13421506">CASSANDRA-17246</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13433396">CASSANDRA-17431</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13004872" name="CASSANDRA-15234-3-DTests-JAVA8.txt" size="7737" author="e.dimitrova" created="Fri, 5 Jun 2020 03:36:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[edimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z04qy8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
        <customfieldvalue><![CDATA[maedhroz]]></customfieldvalue>
        <customfieldvalue><![CDATA[dcapwell]]></customfieldvalue>
        <customfieldvalue><![CDATA[mck]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/db9f7a67ec4b03413c10034956e2cf18739ca4b1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/db9f7a67ec4b03413c10034956e2cf18739ca4b1&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;CCM patch committed &lt;a href=&quot;https://github.com/riptano/ccm/commit/6d676896fb2ced4b6ac62fdba4ae2570351b38df&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&#160;and retagged.&lt;/p&gt;

&lt;p&gt;DTest patch committed &lt;a href=&quot;https://github.com/apache/cassandra-dtest/commit/3935906a685640b2f6a2058b38fdf45d917edfc9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Trunk patch split to 13 patches starts from &lt;a href=&quot;https://github.com/apache/cassandra/commit/db9f7a67ec4b03413c10034956e2cf18739ca4b1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this one&lt;/a&gt; on.&lt;/p&gt;

&lt;p&gt;The existing tests plus new unit tests added. Also, dtests exercise the backward compatibility and test that way that ccm supports the same behavior as Cassandra as regards to configuration parameters loading.&#160;&lt;/p&gt;

&lt;p&gt;Docs in review -&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17246&quot; title=&quot;DOCS - Update changed config + JVM, guide post CASSANDRA-15234&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17246&quot;&gt;&lt;del&gt;CASSANDRA-17246&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>