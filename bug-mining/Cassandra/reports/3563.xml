<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:53:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-9396] Canonical view of compacting SSTables not working as expected</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-9396</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;ColumnFamilyStore.CANONICAL_VIEW filter does not seem to filter out early opened SSTable as expected.&lt;/p&gt;

&lt;p&gt;Attached test shows that canonical view contains both compacting SSTable and early opened SSTable.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12830048">CASSANDRA-9396</key>
            <summary>Canonical view of compacting SSTables not working as expected</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="benedict">Benedict Elliott Smith</assignee>
                                    <reporter username="yukim">Yuki Morishita</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 May 2015 01:55:47 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:11 +0000</updated>
                            <resolved>Sat, 16 May 2015 09:56:39 +0000</resolved>
                                        <fixVersion>2.1.6</fixVersion>
                    <fixVersion>2.2.0 beta 1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14545108" author="benedict" created="Fri, 15 May 2015 07:50:51 +0000"  >&lt;p&gt;We maintain the early opened files in the compacting set to avoid anyone else marking them compacted, and this was overlooked when CANONICAL_SSTABLES was introduced. &lt;/p&gt;

&lt;p&gt;Thanks for providing a test to catch this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt;. Simple fix attached.&lt;/p&gt;</comment>
                            <comment id="14545587" author="yukim" created="Fri, 15 May 2015 14:43:34 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14545744" author="yukim" created="Fri, 15 May 2015 16:25:15 +0000"  >&lt;p&gt;Committed, thanks!&lt;/p&gt;</comment>
                            <comment id="14546661" author="benedict" created="Sat, 16 May 2015 09:56:39 +0000"  >&lt;p&gt;The new testCanonicalView() test did not clean up its state, so all tests in SSTableRewriter that happened to run after it would fail. I&apos;ve fixed this and committed.&lt;/p&gt;

&lt;p&gt;Obviously, we need to be stringent about going through the new commit process (with cassci vetting) even for relatively innocuous changes.&lt;/p&gt;</comment>
                            <comment id="14548159" author="aweisberg" created="Mon, 18 May 2015 15:30:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; did this meet our definition of done before being merged into trunk? I don&apos;t see a branch for this in cassci and when it was merged it turned SSTableRewriterTest into a hard failure in cassci.&lt;/p&gt;</comment>
                            <comment id="14551978" author="benedict" created="Wed, 20 May 2015 08:14:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;Obviously, we need to be stringent about going through the new commit process (with cassci vetting) even for relatively innocuous changes.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;My view is it did not, although I&apos;m not sure we still have a clearly defined document outlining our definition of done. It would be nice to get that on the Wiki to point people to.&lt;/p&gt;

&lt;p&gt;To dissect what happened here, we did not go through the normal commit process due to timezone issues and it being a pressing issue, so Yuki committed in my stead. Since I had uploaded only a one-line fix and both of us had run the unit test, I assume Yuki considered it safe to commit without running through cassci. In fact, from a product perspective it was; the issue was with the tests. However he should have run it through cassci, and I should perhaps have not submitted a patch for review until it had run in cassci, or at least until it was &lt;em&gt;setup&lt;/em&gt; in cassci. This latter is up for debate, as it may be a bit onerous to always wait for cassci to begin review, and this was a fairly uncommon occurrence with extraordinarily low impact while everyone is still acclimatizing to the new process. &lt;/p&gt;

&lt;p&gt;We could perhaps require that a link to passing cassci results be posted prior to &quot;Patch Available&quot;? Or we could introduce a new workflow step for &quot;Passing CI&quot; which is required before starting review? This is probably not the best place to discuss this, but we should formalize clearly what our process is to be, and try to introduce steps to aid adherence.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12830324">CASSANDRA-9407</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12769341">CASSANDRA-8669</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12830324">CASSANDRA-9407</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12703231">CASSANDRA-6916</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12733033" name="0001-canonical-view-test-while-compacting.patch" size="4518" author="yukim" created="Fri, 15 May 2015 01:55:47 +0000"/>
                            <attachment id="12733075" name="9396.txt" size="1146" author="benedict" created="Fri, 15 May 2015 07:50:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[benedict]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2erhb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yukim</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>