<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:59:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-9179] Unable to &quot;point in time&quot; restore if table/cf has been recreated</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-9179</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;With Cassandra 2.1, and the addition of the CF UUID, the ability to do a &quot;point in time&quot; restore by restoring a snapshot and replaying commitlogs is lost if the table has been dropped and recreated.&lt;/p&gt;

&lt;p&gt;When the table is recreated, the cf_id changes, and the commitlog replay mechanism skips the desired mutations as the cf_id no longer matches what&apos;s present in the schema.&lt;/p&gt;

&lt;p&gt;There should exist a way to inform the replay that you want the mutations replayed even if the cf_id doesn&apos;t match.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12820551">CASSANDRA-9179</key>
            <summary>Unable to &quot;point in time&quot; restore if table/cf has been recreated</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blambov">Branimir Lambov</assignee>
                                    <reporter username="jmoses">Jon Moses</reporter>
                        <labels>
                            <label>doc-impacting</label>
                    </labels>
                <created>Mon, 13 Apr 2015 15:08:27 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:14 +0000</updated>
                            <resolved>Tue, 15 Dec 2015 09:31:04 +0000</resolved>
                                        <fixVersion>2.1.13</fixVersion>
                    <fixVersion>2.2.5</fixVersion>
                    <fixVersion>3.0.3</fixVersion>
                    <fixVersion>3.2</fixVersion>
                                    <component>Legacy/CQL</component>
                    <component>Legacy/Distributed Metadata</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                                                                <comments>
                            <comment id="14494255" author="mbulman" created="Tue, 14 Apr 2015 15:27:58 +0000"  >&lt;p&gt;&lt;del&gt;Two&lt;/del&gt; One thing to add:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;del&gt;This also applies to the case where a schema has been changed but then reverted, leaving you with an identical and compatible schema, but a separate table id and no ability to replay commitlogs&lt;/del&gt;  Update: I&apos;ve been informed changing schema does not impact table ID&lt;/li&gt;
	&lt;li&gt;auto snapshot does not help if you want to restore to a point in time prior to the drop&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14494283" author="mbulman" created="Tue, 14 Apr 2015 15:37:07 +0000"  >&lt;p&gt;Is it possible to manually change the ID of an existing table as a workaround, or will that cause all sorts of Bad Things?&lt;/p&gt;</comment>
                            <comment id="14494319" author="brandon.williams" created="Tue, 14 Apr 2015 16:07:14 +0000"  >&lt;p&gt;I think that would work, but you&apos;d have to know the old table&apos;s ID, and probably somehow modify the schema to know about it again.&lt;/p&gt;</comment>
                            <comment id="14494370" author="jbellis" created="Tue, 14 Apr 2015 16:39:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;This also applies to the case where a schema has been changed but then reverted&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;As soon as you say DROP TABLE you&apos;re telling Cassandra &quot;I don&apos;t want this data anymore.&quot;  Recreating it with the same schema is simply not the same as not having dropped it in the first place.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is it possible to manually change the ID of an existing table as a workaround, or will that cause all sorts of Bad Things?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Maybe.  Restarting C* might be necessary.  It definitely assumes that IDs don&apos;t change right now.&lt;/p&gt;</comment>
                            <comment id="14494380" author="jbellis" created="Tue, 14 Apr 2015 16:45:25 +0000"  >&lt;p&gt;IMO the least hackish solution for you would be to allow &lt;tt&gt;CREATE TABLE ... WITH ID&lt;/tt&gt; for when you want to force a table to be recognized as the same as a previous incarnation.&lt;/p&gt;</comment>
                            <comment id="14494387" author="brandon.williams" created="Tue, 14 Apr 2015 16:52:17 +0000"  >&lt;p&gt;+1, that&apos;s a good idea.&lt;/p&gt;</comment>
                            <comment id="14494442" author="mbulman" created="Tue, 14 Apr 2015 17:27:45 +0000"  >&lt;p&gt;Given this only affects DROP, I&apos;ll concede that &quot;explicit DROP means you don&apos;t need the data anymore&quot; and &quot;if you accidentally DROP a table, auto_snapshot is your friend&quot;.  I do think &lt;tt&gt;CREATE TABLE ... WITH ID&lt;/tt&gt; would be helpful for those edge cases though for both commitlogs and plain old snapshot restores (being able to compare table ID for compatibility validation before hand)&lt;/p&gt;</comment>
                            <comment id="14494445" author="jbellis" created="Tue, 14 Apr 2015 17:30:39 +0000"  >&lt;p&gt;I (modestly) agree that it would be useful, but I&apos;ll set the priority to Minor now. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14494458" author="nickmbailey" created="Tue, 14 Apr 2015 17:40:23 +0000"  >&lt;p&gt;I&apos;m not necessarily advocating for minor vs. major, but I&apos;ll also point out that this issue also affects the &quot;cloning&quot; use case for backup/restore. It will be difficult to do a PIT clone of a table to a different cluster (although it is already fairly difficult since all commitlogs would need to be replayed on all nodes in the case of a different topology).&lt;/p&gt;

&lt;p&gt;And just in general, it&apos;s fine to say that a perfect user will never actually need to this but the reality is that eventually someone will want to. At the time of a restore to fix some issue and get an application running again is not a great place to run into gotchas and complicated workarounds.&lt;/p&gt;</comment>
                            <comment id="15046717" author="blambov" created="Tue, 8 Dec 2015 10:44:52 +0000"  >&lt;p&gt;Uploaded patch:&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;Allows CREATE TABLE WITH ID and adds test for commitlog replay after drop and recreate of a table.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/blambov/cassandra/tree/9179-with-id-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;code 2.2&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blambov/job/blambov-9179-with-id-2.2-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blambov/job/blambov-9179-with-id-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/blambov/cassandra/tree/9179-with-id-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;code 3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blambov/job/blambov-9179-with-id-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blambov/job/blambov-9179-with-id-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15055708" author="krummas" created="Mon, 14 Dec 2015 09:43:04 +0000"  >&lt;p&gt;in general, +1 on the patches&lt;/p&gt;

&lt;p&gt;The 2.2 patch seems to be based on 2.1, should this go into 2.2+?&lt;/p&gt;

&lt;p&gt;nits:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;on the 2.1/2.2 patch, whitespace on line 88 in CFPropDefs&lt;/li&gt;
	&lt;li&gt;in 3.0, should the KW_ID go into TableParams.Option ?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15055844" author="blambov" created="Mon, 14 Dec 2015 11:11:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;in 3.0, should the KW_ID go into TableParams.Option&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Not sure. I did not want to put it in the &lt;tt&gt;TableParams&lt;/tt&gt; as they can be changed using &lt;tt&gt;CFMetaData.params&lt;/tt&gt;. If it&apos;s not a &lt;tt&gt;TableParams&lt;/tt&gt; value I didn&apos;t think it&apos;s a good idea to put the identifier (and validation etc.) there.&lt;/p&gt;

&lt;p&gt;I targeted 2.2, but it looks like the patch is fine on 2.1 as well. Uploaded a 2.1 branch with the whitespace removed:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/blambov/cassandra/tree/9179-with-id-2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.1/2.2 code&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blambov/job/blambov-9179-with-id-2.1-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blambov/job/blambov-9179-with-id-2.1-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15055889" author="krummas" created="Mon, 14 Dec 2015 11:54:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;I did not want to put it in the TableParams as they can be changed using CFMetaData.params. If it&apos;s not a TableParams value I didn&apos;t think it&apos;s a good idea to put the identifier (and validation etc.) there.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ok, +1&lt;/p&gt;

&lt;p&gt;I&apos;ll commit once the 2.1 dtests pass&lt;/p&gt;</comment>
                            <comment id="15057705" author="krummas" created="Tue, 15 Dec 2015 09:31:04 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12629944">CASSANDRA-5202</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blambov]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2d6lz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>marcuse</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>