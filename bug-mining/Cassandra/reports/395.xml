<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:14:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-1348] Failed to delete commitlog when restarting service</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-1348</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;When restarting any Cassandra node we&apos;ve got exception:&lt;/p&gt;

&lt;p&gt;ERROR 09:42:27,869 Exception encountered during startup.&lt;br/&gt;
java.io.IOException: Failed to delete C:\cassandra\data\commitlog\CommitLog-1280817512228.log&lt;br/&gt;
	at org.apache.cassandra.io.util.FileUtils.deleteWithConfirm(FileUtils.java:45)&lt;br/&gt;
	at org.apache.cassandra.db.commitlog.CommitLog.recover(CommitLog.java:177)&lt;br/&gt;
	at org.apache.cassandra.thrift.CassandraDaemon.setup(CassandraDaemon.java:120)&lt;br/&gt;
	at org.apache.cassandra.service.AbstractCassandraDaemon.init(AbstractCassandraDaemon.java:57)&lt;br/&gt;
	at org.apache.cassandra.contrib.windows.service.WindowsService.start(Unknown Source)&lt;br/&gt;
	at org.apache.cassandra.contrib.windows.service.WindowsService.main(Unknown Source)&lt;br/&gt;
 INFO 09:42:27,869 Exception encountered during startup.&lt;br/&gt;
 INFO 09:42:27,869 Cassandra Service Finished: Tue Aug 03 09:42:27 EEST 2010&lt;/p&gt;

&lt;p&gt;Aftrer exception was thrown and Cassandra didn&apos;t started, within commitlog directory there&apos;s only one file: CommitLog-1280817512228.log&lt;br/&gt;
and no CommitLog-1280817512228.log.header. Looks like CommitLog-1280817512228.log was a new file, not the last one after stopping service.&lt;/p&gt;

&lt;p&gt;After few restarts .log file is deleted and Cassandra is working fine until next restart.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows Server 2008 R2 64bit&lt;/p&gt;</environment>
        <key id="12470702">CASSANDRA-1348</key>
            <summary>Failed to delete commitlog when restarting service</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="vjevdokimov">Viktor Jevdokimov</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 Aug 2010 08:42:02 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:19 +0000</updated>
                            <resolved>Tue, 7 Sep 2010 16:25:49 +0000</resolved>
                                        <fixVersion>0.6.6</fixVersion>
                    <fixVersion>0.7 beta 2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12894900" author="jbellis" created="Tue, 3 Aug 2010 15:16:27 +0000"  >&lt;p&gt;windows gets pissy when you try to delete an open file.  this patch closes it before the delete.&lt;/p&gt;</comment>
                            <comment id="12894906" author="gdusbabek" created="Tue, 3 Aug 2010 15:38:16 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12894908" author="jbellis" created="Tue, 3 Aug 2010 15:48:37 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                            <comment id="12895248" author="hudson" created="Wed, 4 Aug 2010 13:25:31 +0000"  >&lt;p&gt;Integrated in Cassandra #509 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/509/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/509/&lt;/a&gt;)&lt;br/&gt;
    close commitlog reader before deleting it&lt;br/&gt;
patch by jbellis; reviewed by gdusbabek for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1348&quot; title=&quot;Failed to delete commitlog when restarting service&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1348&quot;&gt;&lt;del&gt;CASSANDRA-1348&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12905832" author="vjevdokimov" created="Fri, 3 Sep 2010 08:49:49 +0000"  >&lt;p&gt;Still could happen with 0.7 beta 1. Not always, but happens.&lt;/p&gt;</comment>
                            <comment id="12905908" author="jbellis" created="Fri, 3 Sep 2010 14:18:31 +0000"  >&lt;p&gt;new stacktrace?&lt;/p&gt;</comment>
                            <comment id="12906232" author="vjevdokimov" created="Sat, 4 Sep 2010 07:58:12 +0000"  >&lt;p&gt; INFO 13:38:04,311 Received start command&lt;br/&gt;
 INFO 13:38:04,311 Cassandra Service Starting: Fri Sep 03 13:38:04 CEST 2010&lt;br/&gt;
 INFO 13:38:04,467 DiskAccessMode &apos;auto&apos; determined to be mmap, indexAccessMode is mmap&lt;br/&gt;
 INFO 13:38:04,592 Sampling index for D:\cassandra\data\data\system\Statistics-e-501-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,639 Sampling index for D:\cassandra\data\data\system\Statistics-e-502-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,670 Sampling index for D:\cassandra\data\data\system\Schema-e-1-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,670 Sampling index for D:\cassandra\data\data\system\Schema-e-2-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,670 Sampling index for D:\cassandra\data\data\system\Schema-e-3-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,701 Sampling index for D:\cassandra\data\data\system\Migrations-e-1-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,701 Sampling index for D:\cassandra\data\data\system\Migrations-e-2-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,701 Sampling index for D:\cassandra\data\data\system\Migrations-e-3-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,717 Sampling index for D:\cassandra\data\data\system\LocationInfo-e-9-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,717 Sampling index for D:\cassandra\data\data\system\LocationInfo-e-10-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,717 Sampling index for D:\cassandra\data\data\system\LocationInfo-e-11-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,717 Sampling index for D:\cassandra\data\data\system\HintsColumnFamily-e-24-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,732 Sampling index for D:\cassandra\data\data\system\HintsColumnFamily-e-25-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,732 Sampling index for D:\cassandra\data\data\system\HintsColumnFamily-e-26-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,732 Sampling index for D:\cassandra\data\data\system\HintsColumnFamily-e-28-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,732 Sampling index for D:\cassandra\data\data\system\HintsColumnFamily-e-30-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,732 Sampling index for D:\cassandra\data\data\system\HintsColumnFamily-e-33-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:04,763 Loading schema version 6e908998-aa17-11df-bf55-cacedb26d926&lt;br/&gt;
 INFO 13:38:05,013 Sampling index for D:\cassandra\data\data\BehavioralTargeting\CookieTrackingSetupMemberships-e-25-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:07,588 Sampling index for D:\cassandra\data\data\BehavioralTargeting\CookieTrackingSetupMemberships-e-150-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:10,837 Sampling index for D:\cassandra\data\data\BehavioralTargeting\CookieTrackingSetupMemberships-e-279-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:14,550 Sampling index for D:\cassandra\data\data\BehavioralTargeting\CookieTrackingSetupMemberships-e-412-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:17,747 Sampling index for D:\cassandra\data\data\BehavioralTargeting\CookieTrackingSetupMemberships-e-461-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:18,948 Creating new commitlog segment E:/cassandra/data/commitlog\CommitLog-1283513898948.log&lt;br/&gt;
 INFO 13:38:18,964 Deleted D:\cassandra\data\data\BehavioralTargeting\CookieTrackingSetupMemberships-e-470-Data.db&lt;br/&gt;
 INFO 13:38:18,964 Deleted D:\cassandra\data\data\BehavioralTargeting\CookieTrackingSetupMemberships-e-479-Data.db&lt;br/&gt;
 INFO 13:38:18,979 Deleted D:\cassandra\data\data\BehavioralTargeting\CookieTrackingSetupMemberships-e-492-Data.db&lt;br/&gt;
 INFO 13:38:18,979 Deleted D:\cassandra\data\data\BehavioralTargeting\CookieTrackingSetupMemberships-e-497-Data.db&lt;br/&gt;
 INFO 13:38:18,979 Sampling index for D:\cassandra\data\data\BehavioralTargeting\CookieTrackingSetupMemberships-e-498-&amp;lt;&amp;gt;&lt;br/&gt;
 INFO 13:38:20,118 Replaying E:\cassandra\data\commitlog\CommitLog-1283513833929.log, E:\cassandra\data\commitlog\CommitLog-1283513898948.log&lt;br/&gt;
 INFO 13:38:20,134 E:\cassandra\data\commitlog\CommitLog-1283513833929.log.header incomplete, missing or corrupt.  Everything is ok, don&apos;t panic.  CommitLog will be replayed from the beginning&lt;br/&gt;
 INFO 13:38:20,150 Finished reading E:\cassandra\data\commitlog\CommitLog-1283513833929.log&lt;br/&gt;
 INFO 13:38:20,150 Finished reading E:\cassandra\data\commitlog\CommitLog-1283513898948.log&lt;br/&gt;
 INFO 13:38:20,150 switching in a fresh Memtable for Statistics at CommitLogContext(file=&apos;E:/cassandra/data/commitlog\CommitLog-1283513898948.log&apos;, position=592)&lt;br/&gt;
 INFO 13:38:20,165 Enqueuing flush of Memtable-Statistics@1582759704(15004 bytes, 4 operations)&lt;br/&gt;
 INFO 13:38:20,165 Writing Memtable-Statistics@1582759704(15004 bytes, 4 operations)&lt;br/&gt;
 INFO 13:38:20,508 Completed flushing D:\cassandra\data\data\system\Statistics-e-503-Data.db&lt;br/&gt;
 INFO 13:38:20,508 Recovery complete&lt;br/&gt;
ERROR 13:38:20,508 Exception encountered during startup.&lt;br/&gt;
java.io.IOException: Failed to delete E:\cassandra\data\commitlog\CommitLog-1283513898948.log&lt;br/&gt;
	at org.apache.cassandra.io.util.FileUtils.deleteWithConfirm(FileUtils.java:45)&lt;br/&gt;
	at org.apache.cassandra.db.commitlog.CommitLog.recover(CommitLog.java:178)&lt;br/&gt;
	at org.apache.cassandra.thrift.CassandraDaemon.setup(CassandraDaemon.java:120)&lt;br/&gt;
	at org.apache.cassandra.service.AbstractCassandraDaemon.init(AbstractCassandraDaemon.java:57)&lt;br/&gt;
	at org.apache.cassandra.contrib.windows.service.WindowsService.start(Unknown Source)&lt;br/&gt;
	at org.apache.cassandra.contrib.windows.service.WindowsService.main(Unknown Source)&lt;br/&gt;
 INFO 13:38:20,555 Exception encountered during startup.&lt;br/&gt;
 INFO 13:38:20,555 Cassandra Service Finished: Fri Sep 03 13:38:20 CEST 2010&lt;/p&gt;</comment>
                            <comment id="12906833" author="jbellis" created="Tue, 7 Sep 2010 15:24:38 +0000"  >&lt;p&gt;it logs &quot;Finished reading&quot; which means it&apos;s successfully closed the reader, so there&apos;s nothing in Cassandra blocking the delete.  patch -2 makes failure to delete a non-fatal error.&lt;/p&gt;</comment>
                            <comment id="12906835" author="jbellis" created="Tue, 7 Sep 2010 15:27:35 +0000"  >&lt;p&gt;backported try/finally from original patch to 0.6.  (failure to delete is already non-fatal there.)&lt;/p&gt;</comment>
                            <comment id="12906845" author="gdusbabek" created="Tue, 7 Sep 2010 15:49:00 +0000"  >&lt;p&gt;+1 on the new patch.&lt;/p&gt;</comment>
                            <comment id="12906863" author="jbellis" created="Tue, 7 Sep 2010 16:25:49 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12454023" name="1348-2.txt" size="1737" author="jbellis" created="Tue, 7 Sep 2010 15:24:38 +0000"/>
                            <attachment id="12451125" name="1348.txt" size="11939" author="jbellis" created="Tue, 3 Aug 2010 15:15:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20094</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g4i7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>92160</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>gdusbabek</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[gdusbabek]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>