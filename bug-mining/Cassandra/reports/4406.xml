<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:04:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10992] Hanging streaming sessions</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10992</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I&apos;ve started recently running repair using &lt;a href=&quot;https://github.com/spotify/cassandra-reaper&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Cassandra Reaper&lt;/a&gt;  (built-in &lt;tt&gt;nodetool repair&lt;/tt&gt; doesn&apos;t work for me - &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9935&quot; title=&quot;Repair fails with RuntimeException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9935&quot;&gt;&lt;del&gt;CASSANDRA-9935&lt;/del&gt;&lt;/a&gt;). It behaves fine but I&apos;ve noticed hanging streaming sessions:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;root@db1:~# date
Sat Jan  9 16:43:00 UTC 2016
root@db1:~# nt netstats -H | grep total
        Receiving 5 files, 46.59 MB total. Already received 1 files, 11.32 MB total
        Sending 7 files, 46.28 MB total. Already sent 7 files, 46.28 MB total
        Receiving 6 files, 64.15 MB total. Already received 1 files, 12.14 MB total
        Sending 5 files, 61.15 MB total. Already sent 5 files, 61.15 MB total
        Receiving 4 files, 7.75 MB total. Already received 3 files, 7.58 MB total
        Sending 4 files, 4.29 MB total. Already sent 4 files, 4.29 MB total
        Receiving 12 files, 13.79 MB total. Already received 11 files, 7.66 MB total
        Sending 5 files, 15.32 MB total. Already sent 5 files, 15.32 MB total
        Receiving 8 files, 20.35 MB total. Already received 1 files, 13.63 MB total
        Sending 38 files, 125.34 MB total. Already sent 38 files, 125.34 MB total

root@db1:~# date
Sat Jan  9 17:45:42 UTC 2016
root@db1:~# nt netstats -H | grep total
        Receiving 5 files, 46.59 MB total. Already received 1 files, 11.32 MB total
        Sending 7 files, 46.28 MB total. Already sent 7 files, 46.28 MB total
        Receiving 6 files, 64.15 MB total. Already received 1 files, 12.14 MB total
        Sending 5 files, 61.15 MB total. Already sent 5 files, 61.15 MB total
        Receiving 4 files, 7.75 MB total. Already received 3 files, 7.58 MB total
        Sending 4 files, 4.29 MB total. Already sent 4 files, 4.29 MB total
        Receiving 12 files, 13.79 MB total. Already received 11 files, 7.66 MB total
        Sending 5 files, 15.32 MB total. Already sent 5 files, 15.32 MB total
        Receiving 8 files, 20.35 MB total. Already received 1 files, 13.63 MB total
        Sending 38 files, 125.34 MB total. Already sent 38 files, 125.34 MB total
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Such sessions are left even when repair job is long time done (confirmed by checking Reaper&apos;s and Cassandra&apos;s logs). &lt;tt&gt;streaming_socket_timeout_in_ms&lt;/tt&gt; in cassandra.yaml is set to default value (3600000).&lt;/p&gt;</description>
                <environment>&lt;p&gt;C* 2.1.12, Debian Wheezy&lt;/p&gt;</environment>
        <key id="12928883">CASSANDRA-10992</key>
            <summary>Hanging streaming sessions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pauloricardomg">Paulo Motta</assignee>
                                    <reporter username="mlowicki">mlowicki</reporter>
                        <labels>
                    </labels>
                <created>Sat, 9 Jan 2016 17:53:00 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:45 +0000</updated>
                            <resolved>Tue, 9 Aug 2016 22:05:47 +0000</resolved>
                                        <fixVersion>2.2.8</fixVersion>
                    <fixVersion>3.0.9</fixVersion>
                    <fixVersion>3.8</fixVersion>
                                    <component>Legacy/Streaming and Messaging</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15094002" author="pauloricardomg" created="Tue, 12 Jan 2016 14:54:05 +0000"  >&lt;p&gt;Unfortunately hanging stream sessions is a classic problem which can have many possible causes (including network problems), so it&apos;s difficult to troubleshoot without more information or reproduction steps. Some questions:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Do you see any errors or warnings in your system logs?&lt;/li&gt;
	&lt;li&gt;Could you try decreasing your streaming_socket_timeout_in_ms to 10000 ms and see if the problem persists?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If the problem persists and you&apos;re able to reproduce it fairly simply, I recommend you to replace the cassandra jar of all nodes involved in a specific repair with this &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12781836/apache-cassandra-2.1.12-SNAPSHOT.jar&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;jar with more debug logging&lt;/a&gt;, and also set the log level of the &lt;tt&gt;org.apache.cassandra.streaming&lt;/tt&gt; package to &lt;tt&gt;TRACE&lt;/tt&gt; on &lt;tt&gt;conf/logback.xml&lt;/tt&gt;, and post back the logs for better troubleshooting. If you prefer to build your own jar with &lt;tt&gt;ant jar&lt;/tt&gt; you can do it from this &lt;a href=&quot;https://github.com/pauloricardomg/cassandra/tree/2.1-10961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15094919" author="mlowicki" created="Tue, 12 Jan 2016 20:53:50 +0000"  >&lt;p&gt;Some IO errors I&apos;ve found in logs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-518762] 2016-01-12 14:36:11,130 CassandraDaemon.java:227 - Exception in thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-518762,5,main]
java.lang.RuntimeException: java.io.IOException: Connection timed out
        at com.google.common.base.Throwables.propagate(Throwables.java:160) ~[guava-16.0.jar:na]
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:32) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) ~[na:1.8.0_66]
Caused by: java.io.IOException: Connection timed out
        at sun.nio.ch.FileDispatcherImpl.read0(Native Method) ~[na:1.8.0_66]
        at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39) ~[na:1.8.0_66]
        at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) ~[na:1.8.0_66]
        at sun.nio.ch.IOUtil.read(IOUtil.java:197) ~[na:1.8.0_66]
        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380) ~[na:1.8.0_66]
        at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:59) ~[na:1.8.0_66]
        at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:109) ~[na:1.8.0_66]
        at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103) ~[na:1.8.0_66]
        at org.apache.cassandra.streaming.compress.CompressedInputStream$Reader.runMayThrow(CompressedInputStream.java:178) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28) ~[apache-cassandra-2.1.12.jar:2.1.12]
        ... 1 common frames omitted
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [STREAM-IN-/10.210.58.133] 2016-01-12 15:01:39,450 StreamSession.java:505 - [Stream #193dd5c0-b93b-11e5-a713-8fe7d1d062ea] Streaming error occurred
java.io.IOException: Connection timed out
        at sun.nio.ch.FileDispatcherImpl.read0(Native Method) ~[na:1.8.0_66]
        at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39) ~[na:1.8.0_66]
        at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) ~[na:1.8.0_66]
        at sun.nio.ch.IOUtil.read(IOUtil.java:197) ~[na:1.8.0_66]
        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380) ~[na:1.8.0_66]
        at org.apache.cassandra.streaming.messages.StreamMessage.deserialize(StreamMessage.java:51) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.streaming.ConnectionHandler$IncomingMessageHandler.run(ConnectionHandler.java:250) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_66]
INFO  [STREAM-IN-/10.210.58.133] 2016-01-12 15:01:39,451 StreamResultFuture.java:180 - [Stream #193dd5c0-b93b-11e5-a713-8fe7d1d062ea] Session with /10.210.58.133 is complete
WARN  [STREAM-IN-/10.210.58.133] 2016-01-12 15:01:39,451 StreamResultFuture.java:207 - [Stream #193dd5c0-b93b-11e5-a713-8fe7d1d062ea] Stream failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-404196] 2016-01-12 14:44:05,532 CassandraDaemon.java:227 - Exception in thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-404196,5,main]
java.lang.RuntimeException: java.nio.channels.AsynchronousCloseException
        at com.google.common.base.Throwables.propagate(Throwables.java:160) ~[guava-16.0.jar:na]
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:32) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) ~[na:1.8.0_66]
Caused by: java.nio.channels.AsynchronousCloseException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
        at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:205) ~[na:1.8.0_66]
        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:407) ~[na:1.8.0_66]
        at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:59) ~[na:1.8.0_66]
        at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:109) ~[na:1.8.0_66]
        at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103) ~[na:1.8.0_66]
        at org.apache.cassandra.streaming.compress.CompressedInputStream$Reader.runMayThrow(CompressedInputStream.java:178) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28) ~[apache-cassandra-2.1.12.jar:2.1.12]
        ... 1 common frames omitted
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [STREAM-OUT-/10.210.3.224] 2016-01-12 14:44:12,114 StreamSession.java:505 - [Stream #e7af3850-b93a-11e5-bebc-2f019a24a954] Streaming error occurred
java.io.IOException: Broken pipe
        at sun.nio.ch.FileChannelImpl.transferTo0(Native Method) ~[na:1.8.0_66]
        at sun.nio.ch.FileChannelImpl.transferToDirectlyInternal(FileChannelImpl.java:427) ~[na:1.8.0_66]
        at sun.nio.ch.FileChannelImpl.transferToDirectly(FileChannelImpl.java:492) ~[na:1.8.0_66]
        at sun.nio.ch.FileChannelImpl.transferTo(FileChannelImpl.java:607) ~[na:1.8.0_66]
        at org.apache.cassandra.streaming.compress.CompressedStreamWriter.write(CompressedStreamWriter.java:74) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.streaming.messages.OutgoingFileMessage.serialize(OutgoingFileMessage.java:88) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.streaming.messages.OutgoingFileMessage$1.serialize(OutgoingFileMessage.java:49) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.streaming.messages.OutgoingFileMessage$1.serialize(OutgoingFileMessage.java:41) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.streaming.messages.StreamMessage.serialize(StreamMessage.java:45) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.streaming.ConnectionHandler$OutgoingMessageHandler.sendMessage(ConnectionHandler.java:351) [apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.streaming.ConnectionHandler$OutgoingMessageHandler.run(ConnectionHandler.java:323) [apache-cassandra-2.1.12.jar:2.1.12]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_66]
INFO  [STREAM-OUT-/10.210.3.224] 2016-01-12 14:44:12,114 StreamResultFuture.java:180 - [Stream #e7af3850-b93a-11e5-bebc-2f019a24a954] Session with /10.210.3.224 is complete
WARN  [STREAM-OUT-/10.210.3.224] 2016-01-12 14:44:12,114 StreamResultFuture.java:207 - [Stream #e7af3850-b93a-11e5-bebc-2f019a24a954] Stream failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [STREAM-OUT-/10.210.3.224] 2016-01-12 14:44:12,115 StreamSession.java:505 - [Stream #e7af3850-b93a-11e5-bebc-2f019a24a954] Streaming error occurred
java.io.IOException: Broken pipe
        at sun.nio.ch.FileDispatcherImpl.write0(Native Method) ~[na:1.8.0_66]
        at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47) ~[na:1.8.0_66]
        at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93) ~[na:1.8.0_66]
        at sun.nio.ch.IOUtil.write(IOUtil.java:65) ~[na:1.8.0_66]
        at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471) ~[na:1.8.0_66]
        at org.apache.cassandra.io.util.DataOutputStreamAndChannel.write(DataOutputStreamAndChannel.java:48) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.streaming.messages.StreamMessage.serialize(StreamMessage.java:44) ~[apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.streaming.ConnectionHandler$OutgoingMessageHandler.sendMessage(ConnectionHandler.java:351) [apache-cassandra-2.1.12.jar:2.1.12]
        at org.apache.cassandra.streaming.ConnectionHandler$OutgoingMessageHandler.run(ConnectionHandler.java:331) [apache-cassandra-2.1.12.jar:2.1.12]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_66]
ERROR [STREAM-OUT-/10.210.3.224] 2016-01-12 14:44:12,115 StreamSession.java:505 - [Stream #e7af3850-b93a-11e5-bebc-2f019a24a954] Streaming error occurred
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="15094989" author="pauloricardomg" created="Tue, 12 Jan 2016 21:30:01 +0000"  >&lt;p&gt;I don&apos;t know exactly what&apos;s happening, but the &lt;tt&gt;AsynchronousCloseException&lt;/tt&gt; makes it smell like the interrupt workaround for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10012&quot; title=&quot;Deadlock when session streaming is retried after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10012&quot;&gt;&lt;del&gt;CASSANDRA-10012&lt;/del&gt;&lt;/a&gt; is closing the channel after a genuine timeout, preventing a retry. This was fixed on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10961&quot; title=&quot;Not enough bytes error when add nodes to cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10961&quot;&gt;&lt;del&gt;CASSANDRA-10961&lt;/del&gt;&lt;/a&gt;, so to test that hypothesis, could you try replacing the jar I attached (which contains the 2.1 revert for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10012&quot; title=&quot;Deadlock when session streaming is retried after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10012&quot;&gt;&lt;del&gt;CASSANDRA-10012&lt;/del&gt;&lt;/a&gt;) in all nodes involved in a repair of a specific subrange? A rolling restart will be needed.  If this does not solve the issue, please attach corresponding trace logs as instructed before (making sure to enable trace logs in the logback configuration before triggering the faulty repair operation after replacing the jars).&lt;/p&gt;</comment>
                            <comment id="15102147" author="mlowicki" created="Fri, 15 Jan 2016 17:39:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10961&quot; title=&quot;Not enough bytes error when add nodes to cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10961&quot;&gt;&lt;del&gt;CASSANDRA-10961&lt;/del&gt;&lt;/a&gt; has been released for 2.1? We would need to replace our production cluster with attached build which is solid amount of work so if it&apos;ll be fixed in upcoming 2.1.x release then we would test patch after upgrading nodes.&lt;/p&gt;</comment>
                            <comment id="15102496" author="pauloricardomg" created="Fri, 15 Jan 2016 21:35:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mlowicki&quot; class=&quot;user-hover&quot; rel=&quot;mlowicki&quot;&gt;mlowicki&lt;/a&gt; It will be on next release (2.1.13). please report back when you try it. thanks!&lt;/p&gt;</comment>
                            <comment id="15149346" author="pauloricardomg" created="Tue, 16 Feb 2016 21:35:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mlowicki&quot; class=&quot;user-hover&quot; rel=&quot;mlowicki&quot;&gt;mlowicki&lt;/a&gt; were you able to see if the problem still holds on 2.1.13?&lt;/p&gt;</comment>
                            <comment id="15149380" author="mlowicki" created="Tue, 16 Feb 2016 21:50:09 +0000"  >&lt;p&gt;We&apos;ll upgrade our cluster this or next week (have been waiting a bit after release to make sure no critical issues have been introduced). Will let you know here when done.&lt;/p&gt;</comment>
                            <comment id="15149487" author="pauloricardomg" created="Tue, 16 Feb 2016 23:03:50 +0000"  >&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="15171656" author="mlowicki" created="Mon, 29 Feb 2016 09:44:08 +0000"  >&lt;p&gt;We&apos;ve started rolling out upgrade today so within couple of days I should have some feedback.&lt;/p&gt;</comment>
                            <comment id="15179850" author="mlowicki" created="Fri, 4 Mar 2016 12:58:03 +0000"  >&lt;p&gt;The same case after upgrade. Hanging streaming sessions visible in OpsCenter and returned by `nodetool netstats`. I&apos;ve been waiting 2 hours after repair finished.&lt;/p&gt;</comment>
                            <comment id="15179887" author="pauloricardomg" created="Fri, 4 Mar 2016 13:44:43 +0000"  >&lt;p&gt;You&apos;re saying the repair finishes successfully, and streaming sessions are still reported as being active, or do the repairs also hang? If that&apos;s the case I suspect reaper&apos;s might restarting/killing repairs due to timeout, and they&apos;re not cleared properly.&lt;/p&gt;

&lt;p&gt;Can you check if you see any errors/logs in the log again, and also the reaper&apos;s log for any retries? In particular, check for any &quot;Terminate session is called&quot;, to check if &lt;tt&gt;StorageService.forceTerminateAllRepairSessions&lt;/tt&gt; is being called by any chance.&lt;/p&gt;</comment>
                            <comment id="15179905" author="mlowicki" created="Fri, 4 Mar 2016 13:57:10 +0000"  >&lt;p&gt;Repair finished successfully using Cassandra Reaper. It happened during the whole process (took couple of days) that Reaper terminated some sessions due to timeout (saw that in logs which live watching).&lt;/p&gt;</comment>
                            <comment id="15179938" author="pauloricardomg" created="Fri, 4 Mar 2016 14:27:36 +0000"  >&lt;p&gt;What is the reaper timeout? Could you try increasing these significantly and check if the repair/streams will still hang?&lt;/p&gt;

&lt;p&gt;I suspect original repairs are just slow but are being aborted by reaper, and currently streams are not stopped when repair is aborted, so when the new repair is submitted for the same range new stream sessions will make the previous stream sessions hang for some reasons (resource locking or whatever). Proper repair cleanup on abort will be implemented on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11190&quot; title=&quot;Fail fast repairs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11190&quot;&gt;CASSANDRA-11190&lt;/a&gt; and should fix those if that&apos;s the case.&lt;/p&gt;</comment>
                            <comment id="15283451" author="mlowicki" created="Sat, 14 May 2016 06:33:02 +0000"  >&lt;p&gt;Upgrade to 2.1.14 didn&apos;t helped. Still even almost 12h after end of repair run (using Cassandra Reaper) I&apos;ve active streams (all with progress set to 100%). &lt;tt&gt;streaming_socket_timeout_in_ms&lt;/tt&gt; has default value (3600000).&lt;/p&gt;</comment>
                            <comment id="15285488" author="pauloricardomg" created="Mon, 16 May 2016 21:52:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mlowicki&quot; class=&quot;user-hover&quot; rel=&quot;mlowicki&quot;&gt;mlowicki&lt;/a&gt; do they eventually complete or are they still hanging as of now? If so, could you take a thread dump of the process (with &lt;tt&gt;jstack &amp;lt;pid&amp;gt;&lt;/tt&gt;) and attach here?&lt;/p&gt;

&lt;p&gt;Also, can you track the repair session that originated this stream session, and check if it failed or timed out on reaper? I suspect reaper is timing out and retrying the repair while the stream is ongoing, and so the new stream session conflicts with the old stream session and makes it hang. If so this might be fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11190&quot; title=&quot;Fail fast repairs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11190&quot;&gt;CASSANDRA-11190&lt;/a&gt;, so as a workaround you might try increasing the reaper timeout.&lt;/p&gt;</comment>
                            <comment id="15288768" author="mlowicki" created="Wed, 18 May 2016 10:45:07 +0000"  >&lt;p&gt;We&apos;ve 3 datacenter (ams, lati and analytics which is virtual datacenter on OpenStack). I&apos;ve observed that from the list of active streams in OpsCenter in each pair always one node is from OpenStack (analytics cluster) but as I&apos;ve restarted all analytics nodes still there is lots of hanging sessions so it&apos;s not purely related to them.&lt;/p&gt;

&lt;p&gt;Attaching jstack output from two nodes.&lt;/p&gt;

&lt;p&gt;Also I&apos;ve doubled timeout (to 2 hours) and will soon start new repair run.&lt;/p&gt;</comment>
                            <comment id="15302740" author="pauloricardomg" created="Thu, 26 May 2016 19:22:46 +0000"  >&lt;p&gt;From the thread dump it seems the stream session is hanged on &lt;tt&gt;StreamReader.drain&lt;/tt&gt;, more specifically trying to do &lt;tt&gt;CompressedInputStream.read&lt;/tt&gt; which blocks forever on &lt;tt&gt;Queue.take()&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Thread 16969: (state = BLOCKED)
 - sun.misc.Unsafe.park(boolean, long) @bci=0 (Compiled frame; information may be imprecise)
 - java.util.concurrent.locks.LockSupport.park(java.lang.Object) @bci=14, line=175 (Compiled frame)
 - java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await() @bci=42, line=2039 (Compiled frame)
 - java.util.concurrent.ArrayBlockingQueue.take() @bci=20, line=403 (Compiled frame)
 - org.apache.cassandra.streaming.compress.CompressedInputStream.read() @bci=31, line=95 (Compiled frame)
 - java.io.InputStream.read(byte[], int, int) @bci=43, line=170 (Compiled frame)
 - java.io.InputStream.skip(long) @bci=44, line=224 (Interpreted frame)
 - org.apache.cassandra.streaming.StreamReader.drain(java.io.InputStream, long) @bci=11, line=158 (Interpreted frame)
 - org.apache.cassandra.streaming.compress.CompressedStreamReader.read(java.nio.channels.ReadableByteChannel) @bci=577, line=129 (Compiled frame)
 - org.apache.cassandra.streaming.messages.IncomingFileMessage$1.deserialize(java.nio.channels.ReadableByteChannel, int, org.apache.cassandra.streaming.StreamSession) @bci=64, line=48 (Compiled frame)
 - org.apache.cassandra.streaming.messages.IncomingFileMessage$1.deserialize(java.nio.channels.ReadableByteChannel, int, org.apache.cassandra.streaming.StreamSession) @bci=4, line=38 (Compiled frame)
 - org.apache.cassandra.streaming.messages.StreamMessage.deserialize(java.nio.channels.ReadableByteChannel, int, org.apache.cassandra.streaming.StreamSession) @bci=41, line=56 (Compiled frame)
 - org.apache.cassandra.streaming.ConnectionHandler$IncomingMessageHandler.run() @bci=24, line=257 (Compiled frame)
 - java.lang.Thread.run() @bci=11, line=745 (Compiled frame)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Compressed input stream works with an auxiliary thread that reads compressed chunks from the socket stream and adds that to a data buffer queue that is consumed from &lt;tt&gt;CompressedStreamReader&lt;/tt&gt; during reads. If there is an exception reading from the socket, the reader thread adds a poison pill to the data buffer queue that throws an &lt;tt&gt;IOException&lt;/tt&gt; on next read. Upon receiving an exception on read &lt;tt&gt;CompressedStreamReader&lt;/tt&gt; tries to drain the socket, which performs an additional read on the data buffer queue that is empty and blocks forever, causing the stream session to hang.&lt;/p&gt;

&lt;p&gt;From my understanding, we only drain the socket to perform stream session retry later. But since we never retry on &lt;tt&gt;IOException&lt;/tt&gt;, we shouldn&apos;t try to drain the socket when getting an &lt;tt&gt;IOException&lt;/tt&gt; on &lt;tt&gt;CompressedInputStream&lt;/tt&gt;. WDYT &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt;?&lt;/p&gt;

&lt;p&gt;We should perhaps go further in a separate ticket and reconsider the stream retry mechanism, is there any situation where retry is working?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mlowicki&quot; class=&quot;user-hover&quot; rel=&quot;mlowicki&quot;&gt;mlowicki&lt;/a&gt; do you see any &lt;tt&gt;Error while reading compressed input stream&lt;/tt&gt; or &lt;tt&gt;Error while reading partition&lt;/tt&gt; warning in the system.log?&lt;/p&gt;</comment>
                            <comment id="15303849" author="mlowicki" created="Fri, 27 May 2016 09:56:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; yes:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;WARN  [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-154755] 2016-05-26 17:36:20,625 CompressedInputStream.java:190 - Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; reading compressed input stream.
WARN  [STREAM-IN-/10.210.59.151] 2016-05-26 17:36:20,625 CompressedStreamReader.java:115 - [Stream 14d2bb50-2366-11e6-aff3-094ba808857e] Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; reading partition DecoratedKey(-8649238600224809230, 00093330303438393239320000040000934600) from stream on ks=&lt;span class=&quot;code-quote&quot;&gt;&apos;sync&apos;&lt;/span&gt; and table=&lt;span class=&quot;code-quote&quot;&gt;&apos;entity_by_id2&apos;&lt;/span&gt;.
WARN  [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-156292] 2016-05-26 19:52:29,073 CompressedInputStream.java:190 - Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; reading compressed input stream.
WARN  [STREAM-IN-/10.210.59.84] 2016-05-26 19:52:29,073 CompressedStreamReader.java:115 - [Stream 040b4041-2379-11e6-a363-41a0407f7ce6] Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; reading partition DecoratedKey(-3970687134714418221, 0009333035333936313732000004000276d800) from stream on ks=&lt;span class=&quot;code-quote&quot;&gt;&apos;sync&apos;&lt;/span&gt; and table=&lt;span class=&quot;code-quote&quot;&gt;&apos;entity_by_id2&apos;&lt;/span&gt;.
WARN  [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-157643] 2016-05-26 23:17:09,393 CompressedInputStream.java:190 - Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; reading compressed input stream.
WARN  [STREAM-IN-/10.210.59.86] 2016-05-26 23:17:09,393 CompressedStreamReader.java:115 - [Stream 97753900-2395-11e6-b5a2-b9dde4344a60] Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; reading partition DecoratedKey(2694075662350043685, 00093238333331313532320000040000808800) from stream on ks=&lt;span class=&quot;code-quote&quot;&gt;&apos;sync&apos;&lt;/span&gt; and table=&lt;span class=&quot;code-quote&quot;&gt;&apos;entity_by_id2&apos;&lt;/span&gt;.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15347174" author="pauloricardomg" created="Thu, 23 Jun 2016 20:59:06 +0000"  >&lt;p&gt;I created a &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/compare/master...pauloricardomg:10992#diff-0b30b9f097df89d74be1d1af8205ac7eR147&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt; to reproduce this with the following sequence of steps:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;create 2 node cluster with data on compressed table&lt;/li&gt;
	&lt;li&gt;bootstrap new node&lt;/li&gt;
	&lt;li&gt;fail one of the original nodes during bootstrap&lt;/li&gt;
	&lt;li&gt;expect bootstrap to fail&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Currently bootstrap never completes or fails because when &lt;tt&gt;CompressedStreamReader&lt;/tt&gt; gets an &lt;tt&gt;IOException&lt;/tt&gt; due to the node failure it tries to drain the &lt;tt&gt;CompressedInputStream&lt;/tt&gt; for a possible retry, but the data buffer is never filled by the &lt;tt&gt;Reader&lt;/tt&gt; thread because the socket is closed, so the stream session blocks on drain and never completes.&lt;/p&gt;

&lt;p&gt;Since we never retry on &lt;tt&gt;IOException&lt;/tt&gt; the fix is to avoid draining the socket on &lt;tt&gt;IOException&lt;/tt&gt;. Furthermore, I updated &lt;tt&gt;CompressedInputStream&lt;/tt&gt; to cache the exception and re-throw it in case someone tries to read it again from the failed input stream.&lt;/p&gt;

&lt;p&gt;The patch and CI runs are available below:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.1...pauloricardomg:2.1-10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...pauloricardomg:2.2-10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.0...pauloricardomg:3.0-10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...pauloricardomg:trunk-10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/riptano/cassandra-dtest/compare/master...pauloricardomg:10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.1-10992-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.2-10992-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10992-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-10992-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.1-10992-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.2-10992-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10992-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-10992-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;On a related note, it&apos;s not very clear to me from what conditions retry is trying to recover from, and draining based on consumed size is a bit fragile since we may block on the socket/CIS if there is a size mismatch due to a bug (a la &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10005&quot; title=&quot;Streaming not enough bytes error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10005&quot;&gt;&lt;del&gt;CASSANDRA-10005&lt;/del&gt;&lt;/a&gt;). I think it&apos;s safer to drain based on a magic number, so we should probably consider that in the future. With that said, I wonder if we should disable retry altogether because I think that in its current state it brings more pain than benefits.&lt;/p&gt;</comment>
                            <comment id="15347177" author="pauloricardomg" created="Thu, 23 Jun 2016 21:03:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mlowicki&quot; class=&quot;user-hover&quot; rel=&quot;mlowicki&quot;&gt;mlowicki&lt;/a&gt; while the fix above will prevent stream from hanging, it will not address the root cause of the failure, which unfortunately is not shown on the logs of C*2.1.12, but is shown on C*2.1.13 after &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10961&quot; title=&quot;Not enough bytes error when add nodes to cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10961&quot;&gt;&lt;del&gt;CASSANDRA-10961&lt;/del&gt;&lt;/a&gt;. There are a few tuning suggestions on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11845?focusedCommentId=15344344&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15344344&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;CASSANDRA-11845&lt;/a&gt; that may be useful to address those.&lt;/p&gt;</comment>
                            <comment id="15348394" author="mlowicki" created="Fri, 24 Jun 2016 15:00:59 +0000"  >&lt;p&gt;We&apos;re using now C* 2.1.14 (for couple of weeks) and no hanging streaming sessions so far.&lt;/p&gt;</comment>
                            <comment id="15364617" author="yukim" created="Wed, 6 Jul 2016 16:51:02 +0000"  >&lt;blockquote&gt;&lt;p&gt;I wonder if we should disable retry altogether because I think that in its current state it brings more pain than benefits.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree that retry in stream is not considered well enough, so I am ok if we remove it.&lt;/p&gt;</comment>
                            <comment id="15388885" author="pauloricardomg" created="Fri, 22 Jul 2016 04:20:34 +0000"  >&lt;p&gt;While this issue has probably been there for a while, I think we should still add it to 2.1 since it potentially causes compressed stream sessions to hang and accumulate, which is one of the most common complaints for streaming/repair. WDYT?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I agree that retry in stream is not considered well enough, so I am ok if we remove it.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I updated 2.2+ patches to remove retry support, but left only the original patch (without removing retry) for 2.1 to reduce the surface for new bugs at the end of of 2.1 series. &lt;/p&gt;

&lt;p&gt;Updated patch with removed retry and CI results available below:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.9&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.1...pauloricardomg:2.1-10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...pauloricardomg:2.2-10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.0...pauloricardomg:3.0-10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.9...pauloricardomg:3.9-10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...pauloricardomg:trunk-10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/riptano/cassandra-dtest/compare/master...pauloricardomg:10992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.1-10992-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.2-10992-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10992-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.9-10992-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-10992-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.1-10992-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.2-10992-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10992-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.9-10992-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-10992-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15414319" author="yukim" created="Tue, 9 Aug 2016 22:05:47 +0000"  >&lt;p&gt;Thanks, tests look good so +1.&lt;br/&gt;
I committed 2.2+ as &lt;tt&gt;76e3100ffb106cab3cc665404e293c1026e5e65c&lt;/tt&gt; and skipped 2.1 since this is not critical one.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12971189">CASSANDRA-11845</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12781836" name="apache-cassandra-2.1.12-SNAPSHOT.jar" size="4347638" author="pauloricardomg" created="Tue, 12 Jan 2016 14:53:05 +0000"/>
                            <attachment id="12804632" name="db1.ams.jstack" size="486951" author="mlowicki" created="Wed, 18 May 2016 10:45:39 +0000"/>
                            <attachment id="12804633" name="db6.analytics.jstack" size="256849" author="mlowicki" created="Wed, 18 May 2016 10:45:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2r2xb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yukim</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>