<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:18:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-1927] Hadoop Integration doesn&apos;t work when one node is down</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-1927</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;using the same directives in the sample code:&lt;/p&gt;

&lt;p&gt;When I start the CFInputFormat to read a CF in a keyspace of RF=3 on a 4-node cluster:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If all the nodes are all up, everything works fine and I don&apos;t have any problems walking through the all data in the CF, however&lt;/li&gt;
	&lt;li&gt;If there&apos;s a node down, the hadoop job does not even start, just dies without any errors or exceptions.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So I&apos;m really sorry for not being able to post any errors or exceptions, though it&apos;s really easy to reproduce. Just startup a cluster and take one node down and you&apos;re there &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12494462">CASSANDRA-1927</key>
            <summary>Hadoop Integration doesn&apos;t work when one node is down</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mck">Michael Semb Wever</assignee>
                                    <reporter username="uctopcu">Utku Can Topcu</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Jan 2011 01:15:15 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:10 +0000</updated>
                            <resolved>Mon, 3 Jan 2011 19:43:30 +0000</resolved>
                                        <fixVersion>0.7.1</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="12976643" author="michaelsembwever" created="Mon, 3 Jan 2011 08:25:34 +0000"  >&lt;p&gt;Client side (hadoop job):&lt;/p&gt;

&lt;p&gt;java.io.IOException: Could not get input splits&lt;br/&gt;
	at org.apache.cassandra.hadoop.ColumnFamilyInputFormat.getSplits(ColumnFamilyInputFormat.java:127)&lt;br/&gt;
	at org.apache.hadoop.mapred.JobClient.writeNewSplits(JobClient.java:885)&lt;br/&gt;
	at org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:779)&lt;br/&gt;
	at org.apache.hadoop.mapreduce.Job.submit(Job.java:432)&lt;br/&gt;
	at org.apache.hadoop.mapreduce.Job.waitForCompletion(Job.java:447)&lt;br/&gt;
	at no.finntech.countstats.reduce.FakeAdCounterTableReduce.run(FakeAdCounterTableReduce.java:421)&lt;br/&gt;
	at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)&lt;br/&gt;
	at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)&lt;br/&gt;
	at no.finntech.countstats.reduce.FakeAdCounterTableReduce.main(FakeAdCounterTableReduce.java:75)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.apache.hadoop.util.RunJar.main(RunJar.java:156)&lt;br/&gt;
Caused by: java.util.concurrent.ExecutionException: java.io.IOException: unable to connect to server&lt;br/&gt;
	at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)&lt;br/&gt;
	at java.util.concurrent.FutureTask.get(FutureTask.java:83)&lt;br/&gt;
	at org.apache.cassandra.hadoop.ColumnFamilyInputFormat.getSplits(ColumnFamilyInputFormat.java:123)&lt;br/&gt;
	... 13 more&lt;br/&gt;
Caused by: java.io.IOException: unable to connect to server&lt;br/&gt;
	at org.apache.cassandra.hadoop.ColumnFamilyInputFormat.createConnection(ColumnFamilyInputFormat.java:212)&lt;br/&gt;
	at org.apache.cassandra.hadoop.ColumnFamilyInputFormat.getSubSplits(ColumnFamilyInputFormat.java:187)&lt;br/&gt;
	at org.apache.cassandra.hadoop.ColumnFamilyInputFormat.access$200(ColumnFamilyInputFormat.java:74)&lt;br/&gt;
	at org.apache.cassandra.hadoop.ColumnFamilyInputFormat$SplitCallable.call(ColumnFamilyInputFormat.java:160)&lt;br/&gt;
	at org.apache.cassandra.hadoop.ColumnFamilyInputFormat$SplitCallable.call(ColumnFamilyInputFormat.java:145)&lt;br/&gt;
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)&lt;br/&gt;
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;br/&gt;
Caused by: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused&lt;br/&gt;
	at org.apache.thrift.transport.TSocket.open(TSocket.java:185)&lt;br/&gt;
	at org.apache.thrift.transport.TFramedTransport.open(TFramedTransport.java:81)&lt;br/&gt;
	at org.apache.cassandra.hadoop.ColumnFamilyInputFormat.createConnection(ColumnFamilyInputFormat.java:208)&lt;br/&gt;
	... 9 more&lt;br/&gt;
Caused by: java.net.ConnectException: Connection refused&lt;br/&gt;
	at java.net.PlainSocketImpl.socketConnect(Native Method)&lt;br/&gt;
	at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)&lt;br/&gt;
	at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)&lt;br/&gt;
	at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)&lt;br/&gt;
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)&lt;br/&gt;
	at java.net.Socket.connect(Socket.java:525)&lt;br/&gt;
	at org.apache.thrift.transport.TSocket.open(TSocket.java:180)&lt;br/&gt;
	... 11 more&lt;/p&gt;
</comment>
                            <comment id="12976644" author="michaelsembwever" created="Mon, 3 Jan 2011 08:27:16 +0000"  >&lt;p&gt;There&apos;s a todo comment in ColumnFamilyInputFormat&lt;br/&gt;
 // TODO handle failure of range replicas &amp;amp; retry&lt;/p&gt;

&lt;p&gt;line 198 only tries the first endpoint. a loop on the TException trying the next endpoint is needed.&lt;/p&gt;</comment>
                            <comment id="12976683" author="michaelsembwever" created="Mon, 3 Jan 2011 10:45:29 +0000"  >&lt;p&gt;Utku: are you able to test this patch?&lt;/p&gt;

&lt;p&gt;( It didn&apos;t work for me because RF was never really set to 3. using cassandra-cli &quot;describe keyspace xxx&quot; reported &quot;Replication Factor: 1&quot; )  :-$&lt;/p&gt;
</comment>
                            <comment id="12976695" author="uctopcu" created="Mon, 3 Jan 2011 11:00:35 +0000"  >&lt;p&gt;Mck: Right now I can&apos;t access to our compilation server. However I can replace the running binaries and test them if I have the patched rc4. Can you somehow provide me the compiled package?&lt;/p&gt;</comment>
                            <comment id="12976698" author="michaelsembwever" created="Mon, 3 Jan 2011 11:08:00 +0000"  >&lt;p&gt;Sent DM. If it doesn&apos;t work you should at minimum see the job&apos;s IOException stacktrace change from &quot;unable to connect to server&quot; to &quot;failed connecting to all endpoints&quot;.&lt;/p&gt;</comment>
                            <comment id="12976741" author="uctopcu" created="Mon, 3 Jan 2011 13:58:27 +0000"  >&lt;p&gt;I&apos;ll be testing it in a few hours. I&apos;ll write down the results. something urgent came up.&lt;/p&gt;</comment>
                            <comment id="12976787" author="michaelsembwever" created="Mon, 3 Jan 2011 15:53:31 +0000"  >&lt;p&gt;After fixing my local RF problem this patch works for me.&lt;/p&gt;</comment>
                            <comment id="12976832" author="jbellis" created="Mon, 3 Jan 2011 17:25:12 +0000"  >&lt;p&gt;It looks like this patch includes the code from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1921&quot; title=&quot;Add jmx password authentication to nodetool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1921&quot;&gt;&lt;del&gt;CASSANDRA-1921&lt;/del&gt;&lt;/a&gt;, which is causing conflicts b/c it&apos;s already applied on 0.7 and trunk.  Can you create a patch for 1927 only?&lt;/p&gt;</comment>
                            <comment id="12976835" author="michaelsembwever" created="Mon, 3 Jan 2011 17:27:18 +0000"  >&lt;p&gt;Putting Stu as reviewer since he was for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-342&quot; title=&quot;hadoop integration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-342&quot;&gt;&lt;del&gt;CASSANDRA-342&lt;/del&gt;&lt;/a&gt; (which the TODO comment in question was added under).&lt;/p&gt;</comment>
                            <comment id="12976839" author="michaelsembwever" created="Mon, 3 Jan 2011 17:34:21 +0000"  >&lt;p&gt;Yeah, the patch had a lot of crap in it. sorry. will re-apply.&lt;/p&gt;</comment>
                            <comment id="12976841" author="michaelsembwever" created="Mon, 3 Jan 2011 17:38:54 +0000"  >&lt;p&gt;correct patch &amp;amp; license grant&lt;/p&gt;</comment>
                            <comment id="12976843" author="michaelsembwever" created="Mon, 3 Jan 2011 17:41:20 +0000"  >&lt;p&gt;third time lucky. removed unnecessary import.&lt;/p&gt;</comment>
                            <comment id="12976847" author="uctopcu" created="Mon, 3 Jan 2011 17:54:09 +0000"  >&lt;p&gt;I&apos;ve tested against the rc4+patch and it works.&lt;/p&gt;</comment>
                            <comment id="12976908" author="jbellis" created="Mon, 3 Jan 2011 19:43:30 +0000"  >&lt;p&gt;committed, thanks!&lt;/p&gt;</comment>
                            <comment id="12976936" author="hudson" created="Mon, 3 Jan 2011 20:23:29 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #142 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/142/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/142/&lt;/a&gt;)&lt;br/&gt;
    retry hadoop split requests on connection failure&lt;br/&gt;
patch by mck; reviewed by jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1927&quot; title=&quot;Hadoop Integration doesn&amp;#39;t work when one node is down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1927&quot;&gt;&lt;del&gt;CASSANDRA-1927&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12467331" name="CASSANDRA-1927.patch" size="5749" author="mck" created="Mon, 3 Jan 2011 17:41:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[mck]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20373</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 47 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g89j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>92769</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>