<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:52:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-9062] Investigate failing collection indexing dtests</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-9062</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;There are frequent failures with the dtests related to indexing collections (&lt;tt&gt;secondary_indexes_test.py:TestSecondaryIndexesOnCollections&lt;/tt&gt;).&lt;/p&gt;

&lt;p&gt;I tried to look into the reason for failure.  The test does seem to be correct, because it can occasionally pass.  It seems like the failures are due to indexing lagging behind the inserts, resulting in a partial set of results when the index is queried shortly afterwards (getting ~20k matching rows instead of the expected 50k).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12786325">CASSANDRA-9062</key>
            <summary>Investigate failing collection indexing dtests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="samt">Sam Tunnicliffe</assignee>
                                    <reporter username="thobbs">Tom Hobbs</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Mar 2015 20:34:35 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:16 +0000</updated>
                            <resolved>Tue, 14 Apr 2015 21:32:58 +0000</resolved>
                                        <fixVersion>2.2.0 beta 1</fixVersion>
                                    <component>Test/dtest/python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14487678" author="beobal" created="Thu, 9 Apr 2015 17:12:15 +0000"  >&lt;p&gt;This looks to be a regression caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8793&quot; title=&quot;Avoid memory allocation when searching index summary&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8793&quot;&gt;&lt;del&gt;CASSANDRA-8793&lt;/del&gt;&lt;/a&gt; (git bisect agrees). The issue is triggered by the fact that the keys in the 2i table are UUIDs. The RowPosition passed to BigTableReader#getPosition uses a heap buffer, with default byte order. When keys are then read back from the summary in IndexSummary#binarySearch the hollow byte buffer has native ordering so the 2 buffers don&apos;t compare as expected, which ultimately causes the sstable to be skipped. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; I confirmed that forcing the byte order of the hollow buffer to BigEndian in IndexSummary#binarySearch fixes this specific case but I&apos;m sure there must be a better solution, any suggestions?&lt;/p&gt;</comment>
                            <comment id="14489395" author="benedict" created="Fri, 10 Apr 2015 11:21:39 +0000"  >&lt;p&gt;Huh. I didn&apos;t realise that we treated LocalToken like an arbitrary AbstractType (was having a tough time understanding how this was happening, as I thought we always treated the tokens as, effectively plain byte strings - thus avoiding any problems with endianness).&lt;/p&gt;

&lt;p&gt;So, forcing the BB in binarySearch to BigEndian is actually probably the most correct solution to this, since the contents here are always big endian in format. The slightly better, but a little more involved approach, is to make the whole file big endian format, to avoid this confusing distinction of the structure of the file being native, but the contents big endian.&lt;/p&gt;</comment>
                            <comment id="14490021" author="beobal" created="Fri, 10 Apr 2015 18:09:36 +0000"  >&lt;p&gt;Ok, for the purposes of getting the broken tests passing I&apos;ve attached a patch with the simple fix of forcing the buffer in binarySearch to BIG_ENDIAN.&lt;/p&gt;</comment>
                            <comment id="14491055" author="benedict" created="Sat, 11 Apr 2015 14:50:12 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14494107" author="beobal" created="Tue, 14 Apr 2015 13:20:09 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt;, would you mind committing please?&lt;/p&gt;</comment>
                            <comment id="14494932" author="thobbs" created="Tue, 14 Apr 2015 21:32:59 +0000"  >&lt;p&gt;I went ahead and committed this as &lt;tt&gt;d383f5c&lt;/tt&gt; since Benedict is traveling and I&apos;d like to get a run of the dtests without this failure.&lt;/p&gt;</comment>
                            <comment id="14495977" author="benedict" created="Wed, 15 Apr 2015 10:03:50 +0000"  >&lt;p&gt;Yeah, sorry about that. It turns out I have a lossy compression algorithm for storing who can commit themselves, based on length of an individual&apos;s presence on the project. But you mess with that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt;, since you&apos;re a defector.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12783375">CASSANDRA-8996</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12724608" name="9062.txt" size="1205" author="samt" created="Fri, 10 Apr 2015 18:09:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 31 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i27h1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>benedict</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[benedict]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>