<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:01:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11158] AssertionError: null in Slice$Bound.create</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11158</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;We&apos;ve been running Cassandra 3.0.2 for around a week now. Yesterday, we had a network event that briefly isolated one node from others in a 3 node cluster. Since then, we&apos;ve been seeing a constant stream of &quot;Finished hinted handoff&quot; messages, as well as:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;WARN  16:34:39 Uncaught exception on thread Thread[SharedPool-Worker-1,5,main]: {}
java.lang.AssertionError: null
at org.apache.cassandra.db.Slice$Bound.create(Slice.java:365) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.Slice$Bound$Serializer.deserializeValues(Slice.java:553) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.ClusteringPrefix$Serializer.deserialize(ClusteringPrefix.java:274) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.Serializers$2.deserialize(Serializers.java:115) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.Serializers$2.deserialize(Serializers.java:107) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.io.sstable.IndexHelper$IndexInfo$Serializer.deserialize(IndexHelper.java:149) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.RowIndexEntry$Serializer.deserialize(RowIndexEntry.java:218) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.io.sstable.format.big.BigTableReader.getPosition(BigTableReader.java:216) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.io.sstable.format.SSTableReader.getPosition(SSTableReader.java:1568) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.columniterator.SSTableIterator.&amp;lt;init&amp;gt;(SSTableIterator.java:36) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.io.sstable.format.big.BigTableReader.iterator(BigTableReader.java:62) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.SinglePartitionReadCommand.queryMemtableAndSSTablesInTimestampOrder(SinglePartitionReadCommand.java:715) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.SinglePartitionReadCommand.queryMemtableAndDiskInternal(SinglePartitionReadCommand.java:482) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.SinglePartitionReadCommand.queryMemtableAndDisk(SinglePartitionReadCommand.java:459) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.SinglePartitionReadCommand.queryStorage(SinglePartitionReadCommand.java:325) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.ReadCommand.executeLocally(ReadCommand.java:350) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.db.ReadCommandVerbHandler.doVerb(ReadCommandVerbHandler.java:45) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:67) ~[apache-cassandra-3.0.2.jar:3.0.2]
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_72]
at org.apache.cassandra.concurrent.AbstractTracingAwareExecutorService$FutureTask.run(AbstractTracingAwareExecutorService.java:164) ~[apache-cassandra-3.0.2.jar:3.0.2]
at org.apache.cassandra.concurrent.SEPWorker.run(SEPWorker.java:105) [apache-cassandra-3.0.2.jar:3.0.2]
at java.lang.Thread.run(Thread.java:745) [na:1.8.0_72]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and also&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR 06:10:11 Exception in thread Thread[CompactionExecutor:1,1,main]
java.lang.AssertionError: null
at org.apache.cassandra.db.Slice$Bound.create(Slice.java:365) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.Slice$Bound$Serializer.deserializeValues(Slice.java:553) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.ClusteringPrefix$Serializer.deserialize(ClusteringPrefix.java:274) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.Serializers$2.deserialize(Serializers.java:115) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.Serializers$2.deserialize(Serializers.java:107) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.io.sstable.IndexHelper$IndexInfo$Serializer.deserialize(IndexHelper.java:149) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.RowIndexEntry$Serializer.deserialize(RowIndexEntry.java:218) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.io.sstable.format.big.BigTableScanner$KeyScanningIterator.computeNext(BigTableScanner.java:305) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.io.sstable.format.big.BigTableScanner$KeyScanningIterator.computeNext(BigTableScanner.java:260) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.utils.AbstractIterator.hasNext(AbstractIterator.java:47) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.io.sstable.format.big.BigTableScanner.hasNext(BigTableScanner.java:240) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.utils.MergeIterator$Candidate.advance(MergeIterator.java:369) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.utils.MergeIterator$ManyToOne.advance(MergeIterator.java:189) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.utils.MergeIterator$ManyToOne.computeNext(MergeIterator.java:158) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.utils.AbstractIterator.hasNext(AbstractIterator.java:47) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.partitions.UnfilteredPartitionIterators$2.hasNext(UnfilteredPartitionIterators.java:150) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.transform.BasePartitions.hasNext(BasePartitions.java:72) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.compaction.CompactionIterator.hasNext(CompactionIterator.java:226) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.compaction.CompactionTask.runMayThrow(CompactionTask.java:177) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.compaction.CompactionTask.executeInternal(CompactionTask.java:78) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.compaction.AbstractCompactionTask.execute(AbstractCompactionTask.java:60) ~[apache-cassandra-3.0.3.jar:3.0.3]
at org.apache.cassandra.db.compaction.CompactionManager$BackgroundCompactionCandidate.run(CompactionManager.java:263) ~[apache-cassandra-3.0.3.jar:3.0.3]
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_72]
at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_72]
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_72]
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_72]
at java.lang.Thread.run(Thread.java:745) [na:1.8.0_72]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;on all 3 nodes. I&apos;m now upgrading the nodes to 3.0.3, but the issue seems to persist.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12938436">CASSANDRA-11158</key>
            <summary>AssertionError: null in Slice$Bound.create</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blambov">Branimir Lambov</assignee>
                                    <reporter username="samukallio">Samu Kallio</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Feb 2016 06:37:03 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:42 +0000</updated>
                            <resolved>Tue, 23 Feb 2016 10:54:41 +0000</resolved>
                                        <fixVersion>3.0.4</fixVersion>
                    <fixVersion>3.4</fixVersion>
                                    <component>Legacy/Local Write-Read Paths</component>
                    <component>Local/Compaction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15142644" author="samukallio" created="Thu, 11 Feb 2016 12:06:51 +0000"  >&lt;p&gt;Managed to trace this to a single corrupt SSTable file. Checking with sstableverify says the checksum is OK, but at least one row is still corrupted.&lt;/p&gt;</comment>
                            <comment id="15146748" author="samukallio" created="Sun, 14 Feb 2016 22:08:34 +0000"  >&lt;p&gt;I ended up having to delete the corrupted SSTable files on all nodes as nothing could touch them without crashing. Everything seemed OK for a while, then one of the nodes wrote a corrupt SSTable again. Repairing the cluster is not possible right now because the merkle tree calculation crashes.&lt;/p&gt;

&lt;p&gt;Also, 2 of the 3 nodes seem to be running hinted handoff every 10 seconds constantly, even though the whole cluster is up and has seen no network disruptions since the one that triggered this issue:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;INFO  22:05:51 Deleted hint file 97341307-d380-4808-89be-e04393bc0a5c-1455487534177-1.hints
INFO  22:05:51 Finished hinted handoff of file 97341307-d380-4808-89be-e04393bc0a5c-1455487534177-1.hints to endpoint 97341307-d380-4808-89be-e04393bc0a5c
INFO  22:06:01 Deleted hint file 97341307-d380-4808-89be-e04393bc0a5c-1455487544177-1.hints
INFO  22:06:01 Finished hinted handoff of file 97341307-d380-4808-89be-e04393bc0a5c-1455487544177-1.hints to endpoint 97341307-d380-4808-89be-e04393bc0a5c
INFO  22:06:11 Deleted hint file 97341307-d380-4808-89be-e04393bc0a5c-1455487554177-1.hints
INFO  22:06:11 Finished hinted handoff of file 97341307-d380-4808-89be-e04393bc0a5c-1455487554177-1.hints to endpoint 97341307-d380-4808-89be-e04393bc0a5c
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15152189" author="samukallio" created="Thu, 18 Feb 2016 11:39:27 +0000"  >&lt;p&gt;I&apos;m upgrading this ticket to critical as this really is causing us data loss. We&apos;re currently preparing to downgrade to 2.x, but would like to at least know if there is any way to save any of the data in the corrupt SSTables?&lt;/p&gt;</comment>
                            <comment id="15152414" author="iamaleksey" created="Thu, 18 Feb 2016 14:59:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samukallio&quot; class=&quot;user-hover&quot; rel=&quot;samukallio&quot;&gt;samukallio&lt;/a&gt; the hints writing and replaying (and logging) empty files was fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11090&quot; title=&quot;Avoid creating empty hint files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11090&quot;&gt;&lt;del&gt;CASSANDRA-11090&lt;/del&gt;&lt;/a&gt;, FYI, so it will be included in the upcoming 3.4 (and later 3.0.4).&lt;/p&gt;

&lt;p&gt;The corruption part needs more investigation.&lt;/p&gt;</comment>
                            <comment id="15154246" author="blambov" created="Fri, 19 Feb 2016 14:05:13 +0000"  >&lt;p&gt;I saw the same bug locally, it appears &lt;tt&gt;ClusteringPrefix&lt;/tt&gt; cannot deserialize a tombstone range boundary.&lt;/p&gt;</comment>
                            <comment id="15154287" author="samukallio" created="Fri, 19 Feb 2016 14:48:09 +0000"  >&lt;p&gt;Does this mean that the fix is just a matter of checking for kind.isBoundary() == true in ClusteringPrefix.Serializer.deserialize, and handling those using RangeTombstone.Bound.serializer? If so, I can patch our cluster immediately to resolve this issue immediately for us until (perhaps better) upstream fix is available?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="15154325" author="blambov" created="Fri, 19 Feb 2016 15:14:23 +0000"  >&lt;p&gt;&lt;tt&gt;ClusteringPrefix&lt;/tt&gt; was using &lt;tt&gt;Slice.Bound&lt;/tt&gt; to deserialize prefixes, which wasn&apos;t able to deal with boundaries. This only appeared as a problem when a boundary ended up as a name in the column (ie. CQL row) index. Patch adds relevant &lt;tt&gt;RangeTombstone.Bound&lt;/tt&gt; method and changes &lt;tt&gt;ClusteringPrefix&lt;/tt&gt; to use that.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/blambov/cassandra/tree/11158&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;code&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/blambov-11158-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/blambov-11158-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samukallio&quot; class=&quot;user-hover&quot; rel=&quot;samukallio&quot;&gt;samukallio&lt;/a&gt;: Yes, but I would wait until the u/dtests have completed.&lt;/p&gt;</comment>
                            <comment id="15156769" author="slebresne" created="Mon, 22 Feb 2016 10:56:48 +0000"  >&lt;p&gt;+1, though the comment in the test starting with &lt;tt&gt;// Sanity check that we&apos;re testing what we want to test&lt;/tt&gt; is weird since there is nothing following that. I suspect that&apos;s a bad copy-paste that you&apos;ll want to remove.&lt;/p&gt;

&lt;p&gt;Also seems that the first run of tests weren&apos;t too clean and you&apos;ve restarted some so I&apos;ll wait for that to complete before committing (can you just ping me when the test results are in).&lt;/p&gt;
</comment>
                            <comment id="15156773" author="slebresne" created="Mon, 22 Feb 2016 11:00:25 +0000"  >&lt;p&gt;Also, while I&apos;m nitpicking on the test, the &lt;tt&gt;makeRandomTest&lt;/tt&gt; doesn&apos;t use the &lt;tt&gt;Random&lt;/tt&gt; nor it&apos;s &lt;tt&gt;length&lt;/tt&gt; argument. Would also rename it to &lt;tt&gt;makeRandomString&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15156931" author="blambov" created="Mon, 22 Feb 2016 13:41:35 +0000"  >&lt;p&gt;Sorry, I rushed this fix. Fixed the test issues (most of the code was taken from &lt;tt&gt;QueryWithIndexedSSTableTest&lt;/tt&gt;, do you want me to fix the string gen there as well?), changed &lt;tt&gt;ClusteringPrefix.Serializer.serialize&lt;/tt&gt; as well and uploaded again:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/0897d6680da336aaf9a050bf84adfa21a3f2b518&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;code 3.0+&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/blambov-11158-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/blambov-11158-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I think I should go a bit further though, there is a conceptual problem with &lt;tt&gt;Slice.Bound&lt;/tt&gt; and &lt;tt&gt;RangeTombstone.Bound&lt;/tt&gt;: the latter is a subtype of the former, yet the slice bound types are a subset of the tombstone ones. The hierarchy should be the other way around.&lt;/p&gt;</comment>
                            <comment id="15157003" author="samukallio" created="Mon, 22 Feb 2016 13:55:06 +0000"  >&lt;p&gt;We applied this fix into our cluster (the earlier one, after it passed tests, not this latest one), and it fixes the original issue for us. However, we&apos;re now seeing a new AssertionError:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;WARN  13:39:33 Uncaught exception on thread Thread[SharedPool-Worker-6,5,main]: {}
java.lang.AssertionError: null
at org.apache.cassandra.db.RangeTombstoneList.insertFrom(RangeTombstoneList.java:537) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at org.apache.cassandra.db.RangeTombstoneList.add(RangeTombstoneList.java:167) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at org.apache.cassandra.db.RangeTombstoneList.addAll(RangeTombstoneList.java:207) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at org.apache.cassandra.db.MutableDeletionInfo.add(MutableDeletionInfo.java:141) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at org.apache.cassandra.db.partitions.AtomicBTreePartition.addAllWithSizeDelta(AtomicBTreePartition.java:142) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at org.apache.cassandra.db.Memtable.put(Memtable.java:243) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at org.apache.cassandra.db.ColumnFamilyStore.apply(ColumnFamilyStore.java:1145) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at org.apache.cassandra.db.Keyspace.apply(Keyspace.java:502) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at org.apache.cassandra.db.Keyspace.apply(Keyspace.java:389) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at org.apache.cassandra.db.SinglePartitionReadCommand$1.run(SinglePartitionReadCommand.java:750) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_72]
at org.apache.cassandra.concurrent.AbstractLocalAwareExecutorService$FutureTask.run(AbstractLocalAwareExecutorService.java:164) ~[apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at org.apache.cassandra.concurrent.SEPWorker.run(SEPWorker.java:105) [apache-cassandra-3.0.3.jar:3.0.3-SNAPSHOT]
at java.lang.Thread.run(Thread.java:745) [na:1.8.0_72]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This seems to be in the defragmentation code path, so it doesn&apos;t seem to cause any immediate issues, but I wonder if it has any implications about data integrity.&lt;/p&gt;

&lt;p&gt;Should I open a new issue for this?&lt;/p&gt;</comment>
                            <comment id="15158722" author="slebresne" created="Tue, 23 Feb 2016 10:54:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;do you want me to fix the string gen there as well?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;ve fixed it while committing, but thanks.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;there is a conceptual problem with Slice.Bound and RangeTombstone.Bound: the latter is a subtype of the former, yet the slice bound types are a subset of the tombstone ones. The hierarchy should be the other way around.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree there is a conceptual problem, but imo this warrant a little bit more reflection. I&apos;m not sure it makes sense to have one being a subtype of the other in particular since neither is really a special case of the other and we never really should mix both. But I&apos;ve created &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11213&quot; title=&quot;Improve ClusteringPrefix hierarchy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11213&quot;&gt;&lt;del&gt;CASSANDRA-11213&lt;/del&gt;&lt;/a&gt; to decide how best to refactor this as whatever we decide I don&apos;t want to block this pretty critical issue (and besides, such refactor probably belong to trunk while this issue should also go int 3.0).&lt;/p&gt;

&lt;p&gt;So anyway, the test runs were not fully clean but I&apos;m pretty sure the failures are stuff I&apos;ve seen on the 3.0 branch and I&apos;ve checked all the failing tests are passing locally so committed, thanks.&lt;/p&gt;</comment>
                            <comment id="15158728" author="blambov" created="Tue, 23 Feb 2016 11:00:57 +0000"  >&lt;p&gt;It does appear to be a separate problem, so please do open a new one.&lt;/p&gt;</comment>
                            <comment id="15158729" author="slebresne" created="Tue, 23 Feb 2016 11:01:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;Should I open a new issue for this?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, though it would great if now that this issue is actually committed you could first test with the current 3.0 branch.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I wonder if it has any implications about data integrity&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It doesn&apos;t. That defragmentation path is just an optimization (and, I must add, one that we&apos;re not entirely sure actually optimize anything so that we might remove it), having it fail won&apos;t break anything. Still shouldn&apos;t happen and we need to fix it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blambov]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 39 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2spk7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>