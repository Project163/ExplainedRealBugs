<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:01:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11130] [SASI Pre-QA] = semantics not respected when using StandardAnalyzer</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11130</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Tested from build &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11067&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;CASSANDRA-11067&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; KEYSPACE music &lt;span class=&quot;code-keyword&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;replication&lt;/span&gt; = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;replication_factor&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;}  &lt;span class=&quot;code-keyword&quot;&gt;AND&lt;/span&gt; durable_writes = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;

&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; music.albums (
    id &lt;span class=&quot;code-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;KEY&lt;/span&gt;,
    artist &lt;span class=&quot;code-keyword&quot;&gt;text&lt;/span&gt;,
    title1 &lt;span class=&quot;code-keyword&quot;&gt;text&lt;/span&gt;,
    title2 &lt;span class=&quot;code-keyword&quot;&gt;text&lt;/span&gt;
);

&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; CUSTOM &lt;span class=&quot;code-keyword&quot;&gt;INDEX&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;ON&lt;/span&gt; music.albums (title1) &lt;span class=&quot;code-keyword&quot;&gt;USING&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.&lt;span class=&quot;code-keyword&quot;&gt;index&lt;/span&gt;.sasi.SASIIndex&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;OPTIONS&lt;/span&gt; = {&lt;span class=&quot;code-quote&quot;&gt;&apos;tokenization_skip_stop_words&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;analyzer_class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.&lt;span class=&quot;code-keyword&quot;&gt;index&lt;/span&gt;.sasi.analyzer.StandardAnalyzer&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;case_sensitive&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;mode&lt;/span&gt;&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;PREFIX&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;tokenization_enable_stemming&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;};

&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; CUSTOM &lt;span class=&quot;code-keyword&quot;&gt;INDEX&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;ON&lt;/span&gt; music.albums (title2) &lt;span class=&quot;code-keyword&quot;&gt;USING&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.&lt;span class=&quot;code-keyword&quot;&gt;index&lt;/span&gt;.sasi.SASIIndex&apos;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;OPTIONS&lt;/span&gt; = {&lt;span class=&quot;code-quote&quot;&gt;&apos;tokenization_skip_stop_words&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;analyzer_class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.&lt;span class=&quot;code-keyword&quot;&gt;index&lt;/span&gt;.sasi.analyzer.StandardAnalyzer&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;case_sensitive&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;mode&lt;/span&gt;&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;CONTAINS&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;tokenization_enable_stemming&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;};

&lt;span class=&quot;code-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INTO&lt;/span&gt; music.albums(id, artist, title1, title2) 
&lt;span class=&quot;code-keyword&quot;&gt;VALUES&lt;/span&gt;(1, &lt;span class=&quot;code-quote&quot;&gt;&apos;Superpitcher&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;Yesterday&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;Yesterday&apos;&lt;/span&gt;);

&lt;span class=&quot;code-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INTO&lt;/span&gt; music.albums(id, artist, title1, title2) 
&lt;span class=&quot;code-keyword&quot;&gt;VALUES&lt;/span&gt;(2, &lt;span class=&quot;code-quote&quot;&gt;&apos;Hilary Duff&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;So Yesterday&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;So Yesterday&apos;&lt;/span&gt;);

&lt;span class=&quot;code-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INTO&lt;/span&gt; music.albums(id, artist, title1, title2) 
&lt;span class=&quot;code-keyword&quot;&gt;VALUES&lt;/span&gt;(3, &lt;span class=&quot;code-quote&quot;&gt;&apos;The Mr. T Experience&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;Yesterday Rules&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;Yesterday Rules&apos;&lt;/span&gt;);

&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; artist,title1 &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; music.albums &lt;span class=&quot;code-keyword&quot;&gt;WHERE&lt;/span&gt; title1=&lt;span class=&quot;code-quote&quot;&gt;&apos;Yesterday&apos;&lt;/span&gt;;

 artist                 | title1
&lt;span class=&quot;code-comment&quot;&gt;------------------------+----------------
&lt;/span&gt;           Superpitcher |       Yesterday
            Hilary Duff |    So Yesterday
   The Mr. T Experience | Yesterday Rules
 
(3 &lt;span class=&quot;code-keyword&quot;&gt;rows&lt;/span&gt;)

&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; artist,title1 &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; music.albums &lt;span class=&quot;code-keyword&quot;&gt;WHERE&lt;/span&gt; title2=&lt;span class=&quot;code-quote&quot;&gt;&apos;Yesterday&apos;&lt;/span&gt;;

artist                 | title1
&lt;span class=&quot;code-comment&quot;&gt;------------------------+----------------
&lt;/span&gt;           Superpitcher |       Yesterday
            Hilary Duff |    So Yesterday
   The Mr. T Experience | Yesterday Rules
  
(3 &lt;span class=&quot;code-keyword&quot;&gt;rows&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The semantic of &lt;b&gt;=&lt;/b&gt; is not respected. SASI should return only 1 row with exact match. Using &lt;b&gt;LIKE&lt;/b&gt; would return all 3 rows. It does impact both &lt;b&gt;PREFIX&lt;/b&gt; and &lt;b&gt;CONTAINS&lt;/b&gt; mode. Using &lt;b&gt;NonTokenizerAnalyzer&lt;/b&gt; return 1 row with exact match.&lt;/p&gt;

&lt;p&gt; So indeed, the semantics of &lt;b&gt;=&lt;/b&gt; depends on the chosen analyzer, which is inconsistent. We should force &lt;b&gt;=&lt;/b&gt; to be exact match no matter which analyzer is chosen.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Tested from build &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11067&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;CASSANDRA-11067&lt;/a&gt;&lt;/p&gt;</environment>
        <key id="12937347">CASSANDRA-11130</key>
            <summary>[SASI Pre-QA] = semantics not respected when using StandardAnalyzer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xedin">Pavel Yaskevich</assignee>
                                    <reporter username="doanduyhai">DuyHai Doan</reporter>
                        <labels>
                    </labels>
                <created>Sun, 7 Feb 2016 12:41:04 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:43 +0000</updated>
                            <resolved>Thu, 11 Feb 2016 19:26:22 +0000</resolved>
                                        <fixVersion>3.4</fixVersion>
                                    <component>Legacy/CQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15136250" author="doanduyhai" created="Sun, 7 Feb 2016 13:18:32 +0000"  >&lt;p&gt;/cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xedin&quot; class=&quot;user-hover&quot; rel=&quot;xedin&quot;&gt;xedin&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15136422" author="xedin" created="Sun, 7 Feb 2016 20:30:11 +0000"  >&lt;p&gt;This is what &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbellis&quot; class=&quot;user-hover&quot; rel=&quot;jbellis&quot;&gt;jbellis&lt;/a&gt; was talking about, since the index is split into multiple terms from the index perspective &quot;title1&quot; = &quot;Yesterday&quot; is an exact much, but I guess it should just give up trying to explain and make it work, even through it&apos;s going to be inefficient (going to return more matches which will need to be filtered out).&lt;/p&gt;</comment>
                            <comment id="15136448" author="doanduyhai" created="Sun, 7 Feb 2016 21:14:43 +0000"  >&lt;p&gt;I&apos;ve though about one possible way to provide the strict &lt;tt&gt;=&lt;/tt&gt; semantics when using StandardAnalyzer.&lt;/p&gt;

&lt;p&gt; On SASI side, you still hit disk to fetch all matching terms but then you perform a post-processing to return only exact match.&lt;/p&gt;

&lt;p&gt; I don&apos;t know whether you store the source column value in SASI index or not. If yes it should be easy. If no, then it&apos;ll be expensive because we&apos;ll hit Cassandra SSTables before being able to filter out non exact matches&lt;/p&gt;</comment>
                            <comment id="15136503" author="xedin" created="Sun, 7 Feb 2016 22:53:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;I don&apos;t know whether you store the source column value in SASI index or not.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It doesn&apos;t and that&apos;s exactly what I meant when I wrote &quot;inefficient&quot; since, it&apos;s going to mean that index results are going to be inaccurate and require more filtering, but I guess that&apos;s the price to may for exact much queries when tokenization is used... I will look into it ASAP.&lt;/p&gt;</comment>
                            <comment id="15136545" author="xedin" created="Mon, 8 Feb 2016 01:19:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbellis&quot; class=&quot;user-hover&quot; rel=&quot;jbellis&quot;&gt;jbellis&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=doanduyhai&quot; class=&quot;user-hover&quot; rel=&quot;doanduyhai&quot;&gt;doanduyhai&lt;/a&gt; I&apos;ve pushed changes to &lt;a href=&quot;https://github.com/xedin/cassandra/tree/CASSANDRA-11130&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-11130&lt;/a&gt; branch, I made it work so CONTAINS index only supports LIKE operations, PREFIX index supports EQ as long as analyzer set on the column is &lt;b&gt;not&lt;/b&gt; tokenizing, otherwise only LIKE &apos;&amp;lt;term&amp;gt;&apos; and other LIKE operations are supported. I&apos;ve also added couple of tests to make sure that such logic works correctly.&lt;/p&gt;</comment>
                            <comment id="15136570" author="xedin" created="Mon, 8 Feb 2016 03:16:36 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;testall&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11130&quot; title=&quot;[SASI Pre-QA] = semantics not respected when using StandardAnalyzer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11130&quot;&gt;&lt;del&gt;CASSANDRA-11130&lt;/del&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/xedin-CASSANDRA-11130-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/job/xedin-CASSANDRA-11130-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15136677" author="doanduyhai" created="Mon, 8 Feb 2016 07:59:38 +0000"  >&lt;p&gt;Another idea, introduce a new mode &lt;b&gt;CONTAINS_AND_EQUAL&lt;/b&gt;&lt;/p&gt;

&lt;p&gt; In this mode, instead of doing post-processing which is expensive, SASI can create 2 indices files, one for CONTAINS and one for PREFIX which allow strict equality matching with &lt;tt&gt;=&lt;/tt&gt;. It&apos;s a trade-off between disk space vs latency at query time&lt;/p&gt;

&lt;p&gt; WDYT ?&lt;/p&gt;</comment>
                            <comment id="15136687" author="xedin" created="Mon, 8 Feb 2016 08:18:44 +0000"  >&lt;p&gt;Maybe as a long term thing I can work on enabling multiple SASI indexes per column but that would also mean double the overhead and other things like space etc, so probably even better solution to this would be to introduce automaton based indexes e.g. FST which would be able to store both original and tokenized forms without significant original overhead... I think having free text features vs. good old equals + prefix is reasonable compromise for current stage.&lt;/p&gt;</comment>
                            <comment id="15140686" author="beobal" created="Wed, 10 Feb 2016 12:02:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xedin&quot; class=&quot;user-hover&quot; rel=&quot;xedin&quot;&gt;xedin&lt;/a&gt;, mostly lgtm.&lt;/p&gt;

&lt;p&gt;The new tests added at the end of &lt;tt&gt;SASIIndexTest::testPrefixSSTableLookup&lt;/tt&gt; are a bit counter-intuitive to the intent of this ticket. The restriction that PREFIX indexes support EQ iff the analyzer is non-tokenizing is basically enforced at the CQL layer by &lt;tt&gt;(SASI|Column)Index::supports&lt;/tt&gt;, but this is bypassed in the test by constructing the command directly. Which is fine in itself, but we should also have a CQL based test which verifies and illustrates the restriction.  (Also, you duplicated the &quot;key7&quot; -&amp;gt; &quot;Vijay&quot; row, which looks accidental?).&lt;/p&gt;

&lt;p&gt;Regarding the changes to CONTAINS mode, there&apos;s a bug in the filtering when LIKE &apos;&amp;lt;term&amp;gt;&apos; is used. When searching the MemIndex, &lt;tt&gt;getValueForExactKey&lt;/tt&gt; is used and works as expected, but after flushing incorrect results show up:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE KEYSPACE ks WITH replication = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;replication_factor&apos;&lt;/span&gt;: 1};
CREATE TABLE ks.t1(k &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; primary key, v text);
CREATE CUSTOM INDEX ON ks.t1(v) USING &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.index.sasi.SASIIndex&apos;&lt;/span&gt; WITH OPTIONS = { &lt;span class=&quot;code-quote&quot;&gt;&apos;mode&apos;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&apos;CONTAINS&apos;&lt;/span&gt; };
INSERT INTO ks.t1(k, v) VALUES (0, &lt;span class=&quot;code-quote&quot;&gt;&apos;Pavel&apos;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh&amp;gt;SELECT * FROM ks.t1 WHERE v LIKE &lt;span class=&quot;code-quote&quot;&gt;&apos;Pav&apos;&lt;/span&gt;;

 k | v
---+---

(0 rows)
# flush
cqlsh&amp;gt; SELECT * FROM ks.t1 WHERE v LIKE &lt;span class=&quot;code-quote&quot;&gt;&apos;Pav&apos;&lt;/span&gt;;

 k | v
---+-------
 0 | Pavel

(1 rows)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The fix is trivial though: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;diff --git a/src/java/org/apache/cassandra/index/sasi/plan/Expression.java b/src/java/org/apache/cassandra/index/sasi/plan/Expression.java
index d77b505..0ce102d 100644
--- a/src/java/org/apache/cassandra/index/sasi/plan/Expression.java
+++ b/src/java/org/apache/cassandra/index/sasi/plan/Expression.java
@@ -281,6 +281,9 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Expression
                     &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;

                 &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; MATCH:
+                    isMatch = validator.compare(term, requestedValue) == 0;
+                    &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
+
                 &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; CONTAINS:
                     isMatch = ByteBufferUtil.contains(term, requestedValue);
                     &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that this isn&apos;t caught by any current unit test. &lt;/p&gt;</comment>
                            <comment id="15141845" author="xedin" created="Wed, 10 Feb 2016 22:36:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt; I&apos;ve added CQL tests for CONTAINS, PREFIX, PREFIX+analyzer for both memtable and on-disk index and fixed MATCH case you mentioned, everything is rebased and ready in the branch.&lt;/p&gt;</comment>
                            <comment id="15142577" author="beobal" created="Thu, 11 Feb 2016 11:01:47 +0000"  >&lt;p&gt;+1. Just for completeness could you add one more condition to the CONTAINS test, for &lt;tt&gt;LIKE &apos;Pavel&apos;&lt;/tt&gt;  when you commit? &lt;/p&gt;</comment>
                            <comment id="15143317" author="xedin" created="Thu, 11 Feb 2016 19:26:22 +0000"  >&lt;p&gt;Done (LIKE &apos;Pavel&apos; for CONTAINS) and committed. Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[xedin]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 40 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2sj2f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>samt</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>