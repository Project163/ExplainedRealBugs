<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:22:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2869] CassandraStorage does not function properly when used multiple times in a single pig script due to UDFContext sharing issues</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2869</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;CassandraStorage appears to have threading issues along the lines of those described at &lt;a href=&quot;http://pig.markmail.org/message/oz7oz2x2dwp66eoz&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://pig.markmail.org/message/oz7oz2x2dwp66eoz&lt;/a&gt; due to the sharing of the UDFContext.&lt;/p&gt;

&lt;p&gt;I believe the fix lies in implementing&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setStoreFuncUDFContextSignature(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; signature)
    {
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and then using that signature when getting the UDFContext.&lt;/p&gt;

&lt;p&gt;From the Pig manual:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;setStoreFunc!UDFContextSignature(): This method will be called by Pig both in the front end and back end to pass a unique signature to the Storer. The signature can be used to store into the UDFContext any information which the Storer needs to store between various method invocations in the front end and back end. The default implementation in StoreFunc has an empty body. This method will be called before other methods.&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12513172">CASSANDRA-2869</key>
            <summary>CassandraStorage does not function properly when used multiple times in a single pig script due to UDFContext sharing issues</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jeromatron">Jeremy Hanna</assignee>
                                    <reporter username="gsingers">Grant Ingersoll</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Jul 2011 18:26:45 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:56 +0000</updated>
                            <resolved>Thu, 21 Jul 2011 20:11:29 +0000</resolved>
                                        <fixVersion>0.7.9</fixVersion>
                    <fixVersion>0.8.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13063711" author="jeromatron" created="Tue, 12 Jul 2011 04:30:38 +0000"  >&lt;p&gt;Simple patch to use the load and store signatures instead of the udf context property keys we had been using.  We&apos;re running this in our data pipeline and appears to work correctly.  However, I haven&apos;t found evidence that the old way wasn&apos;t working - that seems to be more related to read consistency level we were using.  But, this is probably the way we should be doing it, as it appears to be the Pig approach.  Also there could be some corner cases that might trip up the current approach.&lt;/p&gt;</comment>
                            <comment id="13063993" author="brandon.williams" created="Tue, 12 Jul 2011 16:57:54 +0000"  >&lt;p&gt;Looks like we can remove UDFCONTEXT_SCHEMA_KEY_PREFIX now too, no?&lt;/p&gt;</comment>
                            <comment id="13064149" author="jeromatron" created="Tue, 12 Jul 2011 21:30:36 +0000"  >&lt;p&gt;Yes. I was about to post an updated patch last night but got sidetracked. Do you mind removing that if it&apos;s otherwise good to go? Otherwise I can do that later today.&lt;/p&gt;</comment>
                            <comment id="13064590" author="jeromatron" created="Wed, 13 Jul 2011 14:29:04 +0000"  >&lt;p&gt;Removed that String.  Also removed adding mutation twice and put in the nested exception in putNext into the IOException.  We&apos;ve been meaning to add those last two items to one of these tickets.&lt;/p&gt;</comment>
                            <comment id="13069177" author="brandon.williams" created="Thu, 21 Jul 2011 20:11:29 +0000"  >&lt;p&gt;Committed&lt;/p&gt;</comment>
                            <comment id="13069189" author="hudson" created="Thu, 21 Jul 2011 20:30:48 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #534 (See &lt;a href=&quot;https://builds.apache.org/job/Cassandra-0.7/534/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Cassandra-0.7/534/&lt;/a&gt;)&lt;br/&gt;
    Use a UDF-specific context signature.&lt;br/&gt;
Patch by Jeremy Hanna, reviewed by brandonwilliams for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2869&quot; title=&quot;CassandraStorage does not function properly when used multiple times in a single pig script due to UDFContext sharing issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2869&quot;&gt;&lt;del&gt;CASSANDRA-2869&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;brandonwilliams : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1149341&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1149341&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/cassandra/branches/cassandra-0.7/contrib/pig/src/java/org/apache/cassandra/hadoop/pig/CassandraStorage.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12486314" name="2869-2.txt" size="5441" author="jeromatron" created="Wed, 13 Jul 2011 14:29:04 +0000"/>
                            <attachment id="12486144" name="2869.txt" size="4180" author="jeromatron" created="Tue, 12 Jul 2011 04:31:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jeromatron]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20873</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gdy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>93690</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>brandon.williams</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>