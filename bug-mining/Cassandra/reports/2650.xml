<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:43:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-6778] FBUtilities.singleton() should use the CF comparator</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-6778</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;We sometimes use FBUtilities.singleton() to created a SortedSet for NamesQueryFilter. However, the set created by that method does not use the CF comparator, so that it use ByteBuffer comparison/equality for methods like contains(). And this might not be ok if it turns that the comparator is so that 2 column name can be equal without their binary representation being equal, and as it turns out at least IntegerType, DecimalType (because they let you put arbitrary many zeros in front of the binary encoding) have such property (BooleanType should also have that property though it doesn&apos;t in practice which I think that&apos;s a bug, but that&apos;s for another ticket).&lt;/p&gt;

&lt;p&gt;I&apos;ll note that &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6733&quot; title=&quot;Upgrade of 1.2.11 to 2.0.5 make IllegalArgumentException in Buffer.limit on read of a super column family&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6733&quot;&gt;&lt;del&gt;CASSANDRA-6733&lt;/del&gt;&lt;/a&gt; contains an example where this matter.  However, in practice, only SELECT on compact tables that select just one column can ever ran into that and you&apos;d only run into it if your client insert useless zeros in its IntegerType/DecimalType binary representation, which ought to be not common in the first place. It&apos;s still wrong and should be fixed.&lt;/p&gt;

&lt;p&gt;Patch attached to include the comparator in FBUtilities.singleton. I also found 2 other small places where we were using ByteBuffer.equals() where the comparator should be used instead and attaching a 2nd patch for those.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12697674">CASSANDRA-6778</key>
            <summary>FBUtilities.singleton() should use the CF comparator</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="slebresne">Sylvain Lebresne</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Feb 2014 12:33:48 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:52 +0000</updated>
                            <resolved>Thu, 6 Mar 2014 09:06:10 +0000</resolved>
                                        <fixVersion>2.0.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13914453" author="slebresne" created="Thu, 27 Feb 2014 12:36:16 +0000"  >&lt;p&gt;I&apos;ll note that the patch are against 2.0 because well, I wrote them while working on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6733&quot; title=&quot;Upgrade of 1.2.11 to 2.0.5 make IllegalArgumentException in Buffer.limit on read of a super column family&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6733&quot;&gt;&lt;del&gt;CASSANDRA-6733&lt;/del&gt;&lt;/a&gt;, but we might want to put that in 1.2 too, I just wonder how much more 1.2 release we want to do (and in the end, that&apos;s relatively corner-casy). But I&apos;ll gladly rebase to 1.2 before committing if we want it here and that&apos;s necessary.&lt;/p&gt;</comment>
                            <comment id="13921219" author="thobbs" created="Wed, 5 Mar 2014 18:59:44 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;The attached 6778-text.txt adds a unit test to exercise this patch.&lt;/p&gt;

&lt;p&gt;As for 1.2, I agree that this is a pretty rare corner case, so it&apos;s probably safer to only apply this patch to 2.0.&lt;/p&gt;

&lt;p&gt;By the way, it looks like you already did most of this work on 2.1 as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5417&quot; title=&quot;Push composites support in the storage engine&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5417&quot;&gt;&lt;del&gt;CASSANDRA-5417&lt;/del&gt;&lt;/a&gt;, so make sure the conflicts get resolved properly.&lt;/p&gt;</comment>
                            <comment id="13922182" author="slebresne" created="Thu, 6 Mar 2014 09:06:10 +0000"  >&lt;p&gt;Committed, thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12631516" name="0001-Proper-comparison-for-singleton-sorted-set.txt" size="30440" author="slebresne" created="Thu, 27 Feb 2014 12:36:16 +0000"/>
                            <attachment id="12631517" name="0002-Use-comparator-instead-of-BB.equals.txt" size="2698" author="slebresne" created="Thu, 27 Feb 2014 12:36:16 +0000"/>
                            <attachment id="12632881" name="6778-test.txt" size="3148" author="thobbs" created="Wed, 5 Mar 2014 18:59:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>376148</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1stg7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>376444</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>thobbs</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>