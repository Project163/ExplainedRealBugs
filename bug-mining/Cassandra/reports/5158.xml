<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:12:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-14956] Paged Range Slice queries with DISTINCT can drop rows from results</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-14956</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;If we have a partition where the first CQL row is fully deleted (possibly via TTLs), and that partition happens to fall on the page boundary of a paged range query which is using SELECT DISTINCT, the next live partition &lt;b&gt;after&lt;/b&gt; it is omitted from the result set. This is due to over fetching of the pages and a bug in trimming those pages where overlap occurs.&lt;/p&gt;

&lt;p&gt;This does not affect 3.0+.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13208002">CASSANDRA-14956</key>
            <summary>Paged Range Slice queries with DISTINCT can drop rows from results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="samt">Sam Tunnicliffe</assignee>
                                    <reporter username="samt">Sam Tunnicliffe</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Jan 2019 11:45:56 +0000</created>
                <updated>Tue, 16 Apr 2019 09:29:42 +0000</updated>
                            <resolved>Thu, 17 Jan 2019 13:12:12 +0000</resolved>
                                        <fixVersion>2.1.21</fixVersion>
                    <fixVersion>2.2.14</fixVersion>
                                    <component>CQL/Interpreter</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16735719" author="beobal" created="Mon, 7 Jan 2019 11:59:43 +0000"  >&lt;p&gt;Patch to change the page trimming for DISTINCT range queries to simply remove the first row from the page.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/14956-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;14956-2.2&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/beobal/workflows/cassandra/tree/cci%2F14956-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;circle&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="16736989" author="beobal" created="Tue, 8 Jan 2019 10:39:09 +0000"  >&lt;p&gt;Pushed a 2.1 branch after discussion on dev@ about one last 2.1 release before EOL. Unfortunately, CircleCI no longer supports v1.0 job configuration so a CI run is going to need the v2.0 config backporting (which we may want to do before a release anyway).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/14956-2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;14956-2.1&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16743116" author="krummas" created="Tue, 15 Jan 2019 14:49:21 +0000"  >&lt;p&gt;+1, just change CASSANDRA-XYZ in the unit test comment&lt;/p&gt;</comment>
                            <comment id="16745029" author="beobal" created="Thu, 17 Jan 2019 13:12:12 +0000"  >&lt;p&gt;Thanks, committed to 2.1 in &lt;tt&gt;dd228d4581b020fb2fb788858481c81357d7fa72&lt;/tt&gt; and merged (test only to 3.0+).&lt;/p&gt;</comment>
                            <comment id="16757569" author="jolynch" created="Thu, 31 Jan 2019 18:03:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt; I think that the merge up to trunk broke trunk test runs (e.g. &lt;a href=&quot;https://circleci.com/gh/jolynch/cassandra/415&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;7d138e20&lt;/a&gt;). I think it has to do with re-using the data directory from &lt;tt&gt;cassandra-murmur.yaml&lt;/tt&gt;, debugging it now but do you think we need a separate ticket for fixing that test or I can just submit a fixup patch here?&lt;/p&gt;

&lt;p&gt;Confirmed it&apos;s a pollution issue with the &lt;tt&gt;EmbeddedCassandraService&lt;/tt&gt; by running two tests that both use it:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ cat testlist.txt                                                                                                                                                                                                            
org/apache/cassandra/audit/AuditLoggerTest.java
org/apache/cassandra/cql3/PagingTest.java

$ ant testclasslist -Dtest.classlistfile=$(pwd)/testlist.txt
...
[junit-timeout] Testsuite: org.apache.cassandra.cql3.PagingTest
[junit-timeout] Testsuite: org.apache.cassandra.cql3.PagingTest Tests run: 0, Failures: 0, Errors: 2, Skipped: 0, Time elapsed: 5.241 sec
[junit-timeout] 
[junit-timeout] Testcase: org.apache.cassandra.cql3.PagingTest: Caused an ERROR
[junit-timeout] Unable to gossip with any peers
[junit-timeout] java.lang.RuntimeException: Unable to gossip with any peers
[junit-timeout]         at org.apache.cassandra.gms.Gossiper.doShadowRound(Gossiper.java:1546)
[junit-timeout]         at org.apache.cassandra.service.StorageService.checkForEndpointCollision(StorageService.java:553)
[junit-timeout]         at org.apache.cassandra.service.StorageService.prepareToJoin(StorageService.java:841)
[junit-timeout]         at org.apache.cassandra.service.StorageService.initServer(StorageService.java:699)
[junit-timeout]         at org.apache.cassandra.service.StorageService.initServer(StorageService.java:650)
[junit-timeout]         at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:379)
[junit-timeout]         at org.apache.cassandra.service.CassandraDaemon.init(CassandraDaemon.java:501)
[junit-timeout]         at org.apache.cassandra.service.EmbeddedCassandraService.start(EmbeddedCassandraService.java:50)
[junit-timeout]         at org.apache.cassandra.cql3.PagingTest.setup(PagingTest.java:63)
[junit-timeout] 
[junit-timeout] 
[junit-timeout] Testcase: org.apache.cassandra.cql3.PagingTest: Caused an ERROR
[junit-timeout] null
[junit-timeout] java.lang.NullPointerException
[junit-timeout]         at org.apache.cassandra.cql3.PagingTest.tearDown(PagingTest.java:81)
[junit-timeout] 
[junit-timeout] 
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16757661" author="jolynch" created="Thu, 31 Jan 2019 19:31:12 +0000"  >&lt;p&gt;Turns out it was just that in trunk we don&apos;t include the port in the &lt;a href=&quot;https://github.com/apache/cassandra/blob/7f634feb7cf1fdb135133946ffd75efa681b8cb7/test/conf/cassandra-murmur.yaml#L27&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;cassandra-murmur3.yaml&lt;/a&gt; so the check &lt;a href=&quot;https://github.com/apache/cassandra/blob/7f634feb7cf1fdb135133946ffd75efa681b8cb7/src/java/org/apache/cassandra/service/StorageService.java#L556&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; fails and we actually try to gossip with peers. A quick patch to just include the port appears to fix the issue. Other tests are broken but PagingTest is now fixed:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jolynch/cassandra/commit/bb4b06265cfc7a9cf915e8022feb9ccd83390d5d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;bb4b0626&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/jolynch/cassandra/tree/CASSANDRA-14956-fix-unit&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://circleci.com/gh/jolynch/cassandra/tree/CASSANDRA-14956-fix-unit.png?circle-token= 1102a59698d04899ec971dd36e925928f7b521f5&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Test failures:&lt;br/&gt;
&lt;tt&gt;org.apache.cassandra.distributed.DistributedReadWritePathTest#readRepairTest&lt;/tt&gt;: I believe this is &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-14922&quot; title=&quot;In JVM dtests need to clean up after instance shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-14922&quot;&gt;&lt;del&gt;CASSANDRA-14922&lt;/del&gt;&lt;/a&gt;, debugging that separately&lt;/p&gt;</comment>
                            <comment id="16759793" author="beobal" created="Mon, 4 Feb 2019 11:41:19 +0000"  >&lt;p&gt;Thanks&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jolynch&quot; class=&quot;user-hover&quot; rel=&quot;jolynch&quot;&gt;jolynch&lt;/a&gt;, good catch. I&apos;ve pushed your fix to trunk in &lt;tt&gt;27b35799a46dd5b649c4a172f4f8316b48615304&lt;/tt&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 41 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|u00kow:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>