<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:25:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-17411] Network partition causes write ONE timeouts when using counters in Cassandra 4</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-17411</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;h5&gt;&lt;a name=&quot;Affectedversions%3A&quot;&gt;&lt;/a&gt;Affected versions:&lt;/h5&gt;
&lt;ul&gt;
	&lt;li&gt;4.x&lt;/li&gt;
&lt;/ul&gt;


&lt;h5&gt;&lt;a name=&quot;Observedbehavior%3A&quot;&gt;&lt;/a&gt;Observed behavior:&lt;/h5&gt;

&lt;p&gt;When executing CL=ONE writes on a table with a counter column, if one of the nodes is network partitioned from the others, clients keep sending requests to it.&lt;/p&gt;

&lt;p&gt;Even though this may be a &quot;driver&quot; problem, I&apos;ve been able to reproduce it with both java and python datastax drivers using their latest available versions and given the behavior only changes depending on the Cassandra version, well, here I am.&lt;/p&gt;

&lt;h5&gt;&lt;a name=&quot;Expectedbehavior%3A&quot;&gt;&lt;/a&gt;Expected behavior:&lt;/h5&gt;

&lt;p&gt;In Cassandra 3 after all inflight requests fail (expected), no new requests are sent to the partitioned node. The expectation is that Cassandra 4 behaves the same way.&lt;/p&gt;

&lt;h5&gt;&lt;a name=&quot;Howtoreproduce%3A&quot;&gt;&lt;/a&gt;How to reproduce:&lt;/h5&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;# Create a cluster with the desired version, will go with 4.x for this example
ccm create bug-report -v 4.0.3
ccm populate -n 2:2:2
ccm start

# Create schemas and so on
CQL=$(cat &amp;lt;&amp;lt;END
CONSISTENCY ALL;
DROP KEYSPACE IF EXISTS demo;
CREATE KEYSPACE demo WITH REPLICATION = {&apos;class&apos;: &apos;NetworkTopologyStrategy&apos;, &apos;dc1&apos;: 2, &apos;dc2&apos;: 2, &apos;dc3&apos;: 2};
CREATE TABLE demo.demo (pk uuid PRIMARY KEY, count counter) WITH compaction = {&apos;class&apos;: &apos;LeveledCompactionStrategy&apos;};
END
)
ccm node1 cqlsh --verbose --exec=&quot;${CQL}&quot;

# Launch the attached app.py
# requires cassandra-driver
python3 app.py &quot;127.0.0.1&quot; &quot;9042&quot;

# Wait a bit for the app to settle, proceed to next step once you see 3 messages in stdout like:
# 2022-03-01 15:41:51,557 - target-dc2 - __main__ - INFO - Got 0/572 (0.000000) timeouts/total_rqs in the last 1 minute

# Partition one node with iptables
iptables -A INPUT -p tcp --destination 127.0.0.1 --destination-port 7000 -j DROP; iptables -A INPUT -p tcp --destination 127.0.0.1 --destination-port 9042 -j DROP
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Some time after executing the iptables command in cassandra-3 the output should be similar to:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2022-03-01 15:41:51,557 - target-dc2 - __main__ - INFO - Got 0/572 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:41:51,576 - target-dc3 - __main__ - INFO - Got 0/572 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:41:58,032 - target-dc1 - __main__ - INFO - Got 6/252 (2.380952) timeouts/total_rqs in the last 1 minute
2022-03-01 15:42:51,560 - target-dc2 - __main__ - INFO - Got 0/570 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:42:51,620 - target-dc3 - __main__ - INFO - Got 0/570 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:42:58,101 - target-dc1 - __main__ - INFO - Got 2/354 (0.564972) timeouts/total_rqs in the last 1 minute
2022-03-01 15:43:51,602 - target-dc2 - __main__ - INFO - Got 0/571 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:43:51,672 - target-dc3 - __main__ - INFO - Got 0/571 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:43:58,153 - target-dc1 - __main__ - INFO - Got 0/572 (0.000000) timeouts/total_rqs in the last 1 minute
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;as the timeouts/rqs shows, in about 2 minutes the partitioned node stops receiving traffic&lt;/p&gt;

&lt;p&gt;while as in cassandra-4&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2022-03-01 15:49:39,068 - target-dc3 - __main__ - INFO - Got 0/566 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:49:39,107 - target-dc2 - __main__ - INFO - Got 0/566 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:49:41,206 - target-dc1 - __main__ - INFO - Got 2/444 (0.450450) timeouts/total_rqs in the last 1 minute
2022-03-01 15:50:39,095 - target-dc3 - __main__ - INFO - Got 0/569 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:50:39,148 - target-dc2 - __main__ - INFO - Got 0/569 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:50:42,589 - target-dc1 - __main__ - INFO - Got 7/13 (53.846154) timeouts/total_rqs in the last 1 minute
2022-03-01 15:51:39,125 - target-dc3 - __main__ - INFO - Got 0/567 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:51:39,159 - target-dc2 - __main__ - INFO - Got 0/567 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:51:44,902 - target-dc1 - __main__ - INFO - Got 12/22 (54.545455) timeouts/total_rqs in the last 1 minute
2022-03-01 15:52:39,188 - target-dc2 - __main__ - INFO - Got 0/567 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:52:39,202 - target-dc3 - __main__ - INFO - Got 0/568 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:52:46,994 - target-dc1 - __main__ - INFO - Got 12/20 (60.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:53:39,202 - target-dc2 - __main__ - INFO - Got 0/568 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:53:39,238 - target-dc3 - __main__ - INFO - Got 0/568 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:53:48,765 - target-dc1 - __main__ - INFO - Got 12/17 (70.588235) timeouts/total_rqs in the last 1 minute
2022-03-01 15:54:39,203 - target-dc2 - __main__ - INFO - Got 0/568 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:54:39,291 - target-dc3 - __main__ - INFO - Got 0/568 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:54:51,291 - target-dc1 - __main__ - INFO - Got 12/24 (50.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:55:39,258 - target-dc2 - __main__ - INFO - Got 0/570 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:55:39,327 - target-dc3 - __main__ - INFO - Got 0/570 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-01 15:55:53,365 - target-dc1 - __main__ - INFO - Got 12/20 (60.000000) timeouts/total_rqs in the last 1 minute
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;as the timeouts/rqs shows, the partitioned node keeps receving traffic until the iptables rules are removed&lt;/p&gt;</description>
                <environment></environment>
        <key id="13431300">CASSANDRA-17411</key>
            <summary>Network partition causes write ONE timeouts when using counters in Cassandra 4</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="pbalaguer">Pere Balaguer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Mar 2022 15:33:17 +0000</created>
                <updated>Wed, 5 Oct 2022 22:22:52 +0000</updated>
                            <resolved>Thu, 16 Jun 2022 14:07:32 +0000</resolved>
                                        <fixVersion>4.0.5</fixVersion>
                    <fixVersion>4.1-beta1</fixVersion>
                    <fixVersion>4.1</fixVersion>
                                    <component>Consistency/Coordination</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="17511481" author="brandon.williams" created="Wed, 23 Mar 2022 20:43:14 +0000"  >&lt;p&gt;Following these steps, I received:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2022-03-23 20:36:12,259 - target-dc3 - __main__ - INFO - Got 0/552 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:36:12,265 - target-dc1 - __main__ - INFO - Got 0/553 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:36:12,348 - target-dc2 - __main__ - INFO - Got 0/552 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:37:12,276 - target-dc3 - __main__ - INFO - Got 0/569 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:37:12,337 - target-dc1 - __main__ - INFO - Got 0/569 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:37:12,432 - target-dc2 - __main__ - INFO - Got 0/569 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:38:12,282 - target-dc3 - __main__ - INFO - Got 0/575 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:38:12,415 - target-dc1 - __main__ - INFO - Got 0/575 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:38:12,456 - target-dc2 - __main__ - INFO - Got 0/575 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:39:12,373 - target-dc3 - __main__ - INFO - Got 0/577 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:39:12,556 - target-dc2 - __main__ - INFO - Got 0/578 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:39:16,284 - target-dc1 - __main__ - INFO - Got 1/565 (0.176991) timeouts/total_rqs in the last 1 minute
2022-03-23 20:39:42,083 - target-dc3 - cassandra.connection - WARNING - Heartbeat failed for connection (139909259222464) to 127.0.0.1:9042
2022-03-23 20:39:42,106 - target-dc1 - cassandra.connection - WARNING - Heartbeat failed for connection (139909259218800) to 127.0.0.1:9042
2022-03-23 20:39:42,149 - target-dc2 - cassandra.connection - WARNING - Heartbeat failed for connection (139909259222224) to 127.0.0.1:9042
2022-03-23 20:39:47,113 - target-dc1 - cassandra.cluster - WARNING - [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/cluster.py&quot;, line 3522, in _reconnect_internal
    return self._try_connect(host)
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/cluster.py&quot;, line 3544, in _try_connect
    connection = self._cluster.connection_factory(host.endpoint, is_control_connection=True)
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/cluster.py&quot;, line 1620, in connection_factory
    return self.connection_class.factory(endpoint, self.connect_timeout, *args, **kwargs)
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/connection.py&quot;, line 831, in factory
    conn = cls(endpoint, *args, **kwargs)
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/io/asyncorereactor.py&quot;, line 344, in __init__
    self._connect_socket()
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/connection.py&quot;, line 898, in _connect_socket
    raise socket.error(sockerr.errno, &quot;Tried connecting to %s. Last error: %s&quot; %
OSError: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-23 20:40:12,117 - target-dc1 - cassandra.connection - WARNING - Heartbeat failed for connection (139909241902704) to 127.0.0.1:9042
2022-03-23 20:40:12,117 - target-dc1 - cassandra.cluster - WARNING - Host 127.0.0.1:9042 has been marked down
2022-03-23 20:40:12,381 - target-dc3 - __main__ - INFO - Got 0/574 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:40:12,594 - target-dc2 - __main__ - INFO - Got 0/574 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-23 20:40:17,316 - target-dc1 - __main__ - INFO - Got 7/9 (77.777778) timeouts/total_rqs in the last 1 minute
2022-03-23 20:40:18,326 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.28 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-23 20:40:25,636 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.2 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-23 20:40:34,850 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 8.08 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-23 20:40:47,976 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 16.32 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which seems correct?&lt;/p&gt;</comment>
                            <comment id="17514118" author="JIRAUSER285968" created="Tue, 29 Mar 2022 14:13:19 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;, &lt;/p&gt;

&lt;p&gt;I am going to do a bit of an assumption with my comment, please correct me if I&apos;m wrong.&lt;/p&gt;

&lt;p&gt;If you kept the app running for a few more minutes you should have seen other &quot;got x/y ... timeouts/total_rqs&quot; where (x&amp;gt;0) entries, highlighting the client still sends requests to the DOWN node which didn&apos;t happen in c3. In c3 after in flight requests are concluded, no more traffic is sent to the DOWN node until it goes back UP&lt;/p&gt;

&lt;p&gt;This behavior (sending queries to a DOWN node) is specially bad when counters are involved as those do not seem trigger speculative retries and always result in query timeouts for the client.&lt;/p&gt;</comment>
                            <comment id="17514899" author="brandon.williams" created="Wed, 30 Mar 2022 19:08:34 +0000"  >&lt;p&gt;Here it is with more time:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2022-03-30 18:57:07,763 - target-dc1 - cassandra.connection - WARNING - Heartbeat failed for connection (139719619682112) to 127.0.0.1:9042
2022-03-30 18:57:07,776 - target-dc3 - cassandra.connection - WARNING - Heartbeat failed for connection (139719619681680) to 127.0.0.1:9042
2022-03-30 18:57:07,980 - target-dc2 - __main__ - INFO - Got 0/579 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 18:57:08,094 - target-dc3 - __main__ - INFO - Got 0/579 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 18:57:12,768 - target-dc1 - cassandra.cluster - WARNING - [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/cluster.py&quot;, line 3522, in _reconnect_internal
    return self._try_connect(host)
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/cluster.py&quot;, line 3544, in _try_connect
    connection = self._cluster.connection_factory(host.endpoint, is_control_connection=True)
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/cluster.py&quot;, line 1620, in connection_factory
    return self.connection_class.factory(endpoint, self.connect_timeout, *args, **kwargs)
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/connection.py&quot;, line 831, in factory
    conn = cls(endpoint, *args, **kwargs)
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/io/asyncorereactor.py&quot;, line 344, in __init__
    self._connect_socket()
  File &quot;/home/drift/cassandra-dtest/venv/src/cassandra-driver/cassandra/connection.py&quot;, line 898, in _connect_socket
    raise socket.error(sockerr.errno, &quot;Tried connecting to %s. Last error: %s&quot; %
OSError: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-30 18:57:12,831 - target-dc1 - __main__ - INFO - Got 5/190 (2.631579) timeouts/total_rqs in the last 1 minute
2022-03-30 18:57:37,774 - target-dc1 - cassandra.connection - WARNING - Heartbeat failed for connection (139719602362976) to 127.0.0.1:9042
2022-03-30 18:57:37,775 - target-dc1 - cassandra.cluster - WARNING - Host 127.0.0.1:9042 has been marked down
2022-03-30 18:57:43,983 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.74 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-30 18:57:50,790 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.52 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-30 18:58:00,403 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 7.04 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-30 18:58:08,006 - target-dc2 - __main__ - INFO - Got 0/582 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 18:58:08,144 - target-dc3 - __main__ - INFO - Got 0/582 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 18:58:12,519 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 16.0 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-30 18:58:14,102 - target-dc1 - __main__ - INFO - Got 9/15 (60.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 18:58:33,550 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 33.28 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-30 18:59:08,102 - target-dc2 - __main__ - INFO - Got 0/584 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 18:59:08,221 - target-dc3 - __main__ - INFO - Got 0/584 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 18:59:11,914 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 55.04 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-30 18:59:16,479 - target-dc1 - __main__ - INFO - Got 12/23 (52.173913) timeouts/total_rqs in the last 1 minute
2022-03-30 19:00:08,126 - target-dc2 - __main__ - INFO - Got 0/586 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 19:00:08,246 - target-dc3 - __main__ - INFO - Got 0/586 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 19:00:12,003 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 125.44 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-30 19:00:18,924 - target-dc1 - __main__ - INFO - Got 12/24 (50.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 19:01:08,141 - target-dc2 - __main__ - INFO - Got 0/586 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 19:01:08,302 - target-dc3 - __main__ - INFO - Got 0/586 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 19:01:20,657 - target-dc1 - __main__ - INFO - Got 12/17 (70.588235) timeouts/total_rqs in the last 1 minute
2022-03-30 19:02:08,164 - target-dc2 - __main__ - INFO - Got 0/587 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 19:02:08,374 - target-dc3 - __main__ - INFO - Got 0/587 (0.000000) timeouts/total_rqs in the last 1 minute
2022-03-30 19:02:22,510 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 225.28 seconds: [Errno None] Tried connecting to [(&apos;127.0.0.1&apos;, 9042)]. Last error: timed out
2022-03-30 19:02:23,033 - target-dc1 - __main__ - INFO - Got 12/23 (52.173913) timeouts/total_rqs in the last 1 minute
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;node1 appears down to others:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Datacenter: dc1
===============
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address    Load       Tokens  Owns (effective)  Host ID                               Rack
UN  127.0.0.2  91.08 KiB  1       100.0%            b79a56f9-74bb-488a-ae7a-def71b9d2e32  r1
DN  127.0.0.1  91.15 KiB  1       100.0%            f90307f3-fda3-47c9-9f78-e6f570a67790  r1

Datacenter: dc2
===============
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address    Load       Tokens  Owns (effective)  Host ID                               Rack
UN  127.0.0.4  91.09 KiB  1       100.0%            d0b5d218-544f-4d06-802f-f526c8c7c106  r1
UN  127.0.0.3  91.09 KiB  1       100.0%            d8212283-807c-4ca2-a866-91320faaa9d2  r1

Datacenter: dc3
===============
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address    Load       Tokens  Owns (effective)  Host ID                               Rack
UN  127.0.0.5  91.11 KiB  1       100.0%            82b6222b-79fc-42e6-b1d9-8a3710bb033b  r1
UN  127.0.0.6  91.09 KiB  1       100.0%            ca8c4b9b-d470-43f6-82cc-f6d910f282b3  r1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and everything appears down to node1:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Datacenter: dc1
===============
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address    Load       Tokens  Owns (effective)  Host ID                               Rack
DN  127.0.0.2  91.08 KiB  1       100.0%            b79a56f9-74bb-488a-ae7a-def71b9d2e32  r1  
UN  127.0.0.1  91.15 KiB  1       100.0%            f90307f3-fda3-47c9-9f78-e6f570a67790  r1  

Datacenter: dc2
===============
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address    Load       Tokens  Owns (effective)  Host ID                               Rack
DN  127.0.0.4  91.09 KiB  1       100.0%            d0b5d218-544f-4d06-802f-f526c8c7c106  r1  
DN  127.0.0.3  91.09 KiB  1       100.0%            d8212283-807c-4ca2-a866-91320faaa9d2  r1  

Datacenter: dc3
===============
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address    Load       Tokens  Owns (effective)  Host ID                               Rack
DN  127.0.0.5  91.11 KiB  1       100.0%            82b6222b-79fc-42e6-b1d9-8a3710bb033b  r1  
DN  127.0.0.6  91.09 KiB  1       100.0%            ca8c4b9b-d470-43f6-82cc-f6d910f282b3  r1 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All behavior from the server side looks as expected, so I guess this is indeed a driver problem.&lt;/p&gt;</comment>
                            <comment id="17514902" author="JIRAUSER285968" created="Wed, 30 Mar 2022 19:16:52 +0000"  >&lt;p&gt;Ah now I get where your brain was going towards, I thought you had problems reproducing the issue.&lt;/p&gt;

&lt;p&gt;Fair enough, it is a bit &quot;odd&quot; the exact behavior happens in at least 2 different drivers (java &amp;amp; python) which is why I opened it here but anyway, I&apos;ll open tickets in their queues and reference this one for completeness if that seems ok to you.&lt;/p&gt;</comment>
                            <comment id="17514904" author="brandon.williams" created="Wed, 30 Mar 2022 19:19:26 +0000"  >&lt;p&gt;Sure, I think that makes sense.  What I can confirm here is that the &lt;em&gt;coordinator&lt;/em&gt; isn&apos;t sending requests to the dead node, so there&apos;s nothing we can do on the server side for this behavior.&lt;/p&gt;</comment>
                            <comment id="17543158" author="absurdfarce" created="Fri, 27 May 2022 22:43:22 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; , I had to dig into this a bit for a related issue with the Python driver and I came up with some additional info which might be useful.&#160; After looking into this it sure looks like this might be a server-side issue after all... but obviously I&apos;ll defer to you on that part. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Based on my testing I confirmed the following things about the LBPs in use by app.py when running against Cassandra 4.0.3:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;When iptables is used to shut down access to one of the IP addresses the load balancing policy (LBP) in use by the client is notified that the node has gone down&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;As expected that LBP then removes the down node from it&#8217;s collection of &#8220;live&#8221; nodes for the given DC&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;The LBP no longer returns the down node when make_query_plan() is called&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Great, but by itself that doesn&apos;t prove anything.&#160; So I decided to take a look at the exceptions that were actually getting thrown in this case.&#160; With the following change to app.py:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
55c55,59
&amp;lt; &#160; &#160; &#160; &#160; except (cassandra.OperationTimedOut, cassandra.WriteTimeout):
---
&amp;gt; &#160; &#160; &#160; &#160; except cassandra.OperationTimedOut as exc:
&amp;gt; &#160; &#160; &#160; &#160; &#160; &#160; LOG.info(exc)
&amp;gt; &#160; &#160; &#160; &#160; &#160; &#160; timeout_counter += 1
&amp;gt; &#160; &#160; &#160; &#160; except cassandra.WriteTimeout as exc:
&amp;gt; &#160; &#160; &#160; &#160; &#160; &#160; LOG.info(exc) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I see a sequence of two different error messages when I drop the iptables hammer.&#160; The first is a set of &quot;Client request timeout&quot; messages (which is entirely expected since the LBP doesn&apos;t know about the down node yet) while the second looks to be a server-side issue:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2022-05-27 22:01:38,629 - target-dc1 - __main__ - INFO - errors={&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1:9042&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;Client request timeout. See Session.execute[_async](timeout)&apos;&lt;/span&gt;}, last_host=127.0.0.1:9042
2022-05-27 22:01:48,734 - target-dc1 - __main__ - INFO - errors={&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1:9042&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;Client request timeout. See Session.execute[_async](timeout)&apos;&lt;/span&gt;}, last_host=127.0.0.1:9042
2022-05-27 22:01:58,845 - target-dc1 - __main__ - INFO - errors={&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1:9042&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;Client request timeout. See Session.execute[_async](timeout)&apos;&lt;/span&gt;}, last_host=127.0.0.1:9042
2022-05-27 22:02:03,954 - target-dc1 - __main__ - INFO - Error from server: code=1100 [Coordinator node timed out waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; replica nodes&lt;span class=&quot;code-quote&quot;&gt;&apos; responses] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;Operation timed out - received only 0 responses.&quot;&lt;/span&gt; info={&apos;&lt;/span&gt;consistency&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;ONE&lt;span class=&quot;code-quote&quot;&gt;&apos;, &apos;&lt;/span&gt;required_responses&lt;span class=&quot;code-quote&quot;&gt;&apos;: 1, &apos;&lt;/span&gt;received_responses&lt;span class=&quot;code-quote&quot;&gt;&apos;: 0, &apos;&lt;/span&gt;write_type&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;COUNTER&apos;}
2022-05-27 22:02:14,172 - target-dc1 - __main__ - INFO - errors={&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1:9042&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;Client request timeout. See Session.execute[_async](timeout)&apos;&lt;/span&gt;}, last_host=127.0.0.1:9042
2022-05-27 22:02:22,545 - target-dc3 - __main__ - INFO - Got 0/579 (0.000000) timeouts/total_rqs in the last 1 minute
2022-05-27 22:02:22,548 - target-dc2 - __main__ - INFO - Got 0/579 (0.000000) timeouts/total_rqs in the last 1 minute
2022-05-27 22:02:24,275 - target-dc1 - __main__ - INFO - errors={&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1:9042&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;Client request timeout. See Session.execute[_async](timeout)&apos;&lt;/span&gt;}, last_host=127.0.0.1:9042
2022-05-27 22:02:24,376 - target-dc1 - __main__ - INFO - Got 6/66 (9.090909) timeouts/total_rqs in the last 1 minute
2022-05-27 22:02:34,387 - target-dc1 - __main__ - INFO - errors={&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1:9042&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;Client request timeout. See Session.execute[_async](timeout)&apos;&lt;/span&gt;}, last_host=127.0.0.1:9042
2022-05-27 22:02:44,695 - target-dc1 - __main__ - INFO - errors={&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1:9042&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;Client request timeout. See Session.execute[_async](timeout)&apos;&lt;/span&gt;}, last_host=127.0.0.1:9042 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;When the LBP gets notified of the down node things change; the &quot;Client request timeout&quot; disappears and all I see is the server-side issue:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2022-05-27 22:02:52,482 - target-dc1 - cassandra.cluster - WARNING - Host 127.0.0.1:9042 has been marked down                                                                     
2022-05-27 22:02:52,483 - target-dc1 - cassandra.policies - INFO - on_down &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; host 127.0.0.1:9042                                                                                
2022-05-27 22:02:52,485 - target-dc1 - cassandra.policies - INFO - Setting hosts &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; dc dc1 to (&amp;lt;Host: 127.0.0.2:9042 dc1&amp;gt;,)                                                      
2022-05-27 22:02:52,486 - target-dc1 - cassandra.policies - INFO - on_down &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; host 127.0.0.1:9042                                                                                
2022-05-27 22:02:52,488 - target-dc1 - cassandra.policies - INFO - on_down &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; host 127.0.0.1:9042                                                                                
2022-05-27 22:02:52,488 - target-dc1 - cassandra.policies - INFO - on_down &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; host 127.0.0.1:9042                                                                                
2022-05-27 22:02:57,507 - target-dc1 - cassandra.cluster - WARNING - [control connection] Error connecting to 127.0.0.1:9042:                                                     
Traceback (most recent call last):                                                                                                                                                
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;cassandra/cluster.py&quot;&lt;/span&gt;, line 3522, in cassandra.cluster.ControlConnection._reconnect_internal                                                                              
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;cassandra/cluster.py&quot;&lt;/span&gt;, line 3544, in cassandra.cluster.ControlConnection._try_connect                                                                                     
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;cassandra/cluster.py&quot;&lt;/span&gt;, line 1620, in cassandra.cluster.Cluster.connection_factory                                              
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;cassandra/connection.py&quot;&lt;/span&gt;, line 831, in cassandra.connection.Connection.factory                                                                                            
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/automaton/les23/lib/python3.6/site-packages/cassandra/io/libevreactor.py&quot;&lt;/span&gt;, line 267, in __init__
    self._connect_socket()                                                                                                                                                        
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;cassandra/connection.py&quot;&lt;/span&gt;, line 898, in cassandra.connection.Connection._connect_socket                                         
OSError: [Errno None] Tried connecting to [(&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1&apos;&lt;/span&gt;, 9042)]. Last error: timed out
2022-05-27 22:02:57,609 - target-dc1 - __main__ - INFO - Error from server: code=1100 [Coordinator node timed out waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; replica nodes&lt;span class=&quot;code-quote&quot;&gt;&apos; responses] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;Operation timed out - received only 0 responses.&quot;&lt;/span&gt; info={&apos;&lt;/span&gt;consistency&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;ONE&lt;span class=&quot;code-quote&quot;&gt;&apos;, &apos;&lt;/span&gt;required_responses&lt;span class=&quot;code-quote&quot;&gt;&apos;: 1, &apos;&lt;/span&gt;received_responses&lt;span class=&quot;code-quote&quot;&gt;&apos;: 0, &apos;&lt;/span&gt;write_type&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;COUNTER&apos;}                                           
2022-05-27 22:02:58,615 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.22 seconds: [Errno None] Tried connecting to [(&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1&apos;&lt;/span&gt;, 9042)]. Last error: timed out                                                                                                                                  
2022-05-27 22:03:02,712 - target-dc1 - __main__ - INFO - Error from server: code=1100 [Coordinator node timed out waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; replica nodes&lt;span class=&quot;code-quote&quot;&gt;&apos; responses] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;Operation timed out - received only 0 responses.&quot;&lt;/span&gt; info={&apos;&lt;/span&gt;consistency&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;ONE&lt;span class=&quot;code-quote&quot;&gt;&apos;, &apos;&lt;/span&gt;required_responses&lt;span class=&quot;code-quote&quot;&gt;&apos;: 1, &apos;&lt;/span&gt;received_responses&lt;span class=&quot;code-quote&quot;&gt;&apos;: 0, &apos;&lt;/span&gt;write_type&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;COUNTER&apos;}                                           
2022-05-27 22:03:05,925 - target-dc1 - cassandra.pool - WARNING - Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.24 seconds: [Errno None] Tried connectin$
 to [(&lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1&apos;&lt;/span&gt;, 9042)]. Last error: timed out
2022-05-27 22:03:07,917 - target-dc1 - __main__ - INFO - Error from server: code=1100 [Coordinator node timed out waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; replica nodes&lt;span class=&quot;code-quote&quot;&gt;&apos; responses] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;Operation timed out - received only 0 responses.&quot;&lt;/span&gt; info={&apos;&lt;/span&gt;consistency&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;ONE&lt;span class=&quot;code-quote&quot;&gt;&apos;, &apos;&lt;/span&gt;required_responses&lt;span class=&quot;code-quote&quot;&gt;&apos;: 1, &apos;&lt;/span&gt;received_responses&lt;span class=&quot;code-quote&quot;&gt;&apos;: 0, &apos;&lt;/span&gt;write_type&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;COUNTER&apos;}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It appears that it&apos;s these server-side exceptions which are accounting for the non-zero error counts returned by the app.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If I can do anything to help repro or debug this further please let me know!&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17551102" author="brandon.williams" created="Tue, 7 Jun 2022 13:49:27 +0000"  >&lt;p&gt;I&apos;ve simplified the reproduction in a dtest &lt;a href=&quot;https://github.com/driftx/cassandra-dtest/tree/CASSANDRA-17411&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; and updated the fix versions accordingly while I continue to investigate.&lt;/p&gt;</comment>
                            <comment id="17551287" author="brandon.williams" created="Tue, 7 Jun 2022 21:01:56 +0000"  >&lt;p&gt;I believe transient replication is what broke this &lt;a href=&quot;https://github.com/apache/cassandra/commit/f7431b432875e334170ccdb19934d05545d2cebd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;in this commit&lt;/a&gt; and never filtered out dead replicas when selecting one for counter writes.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-17411-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/516/workflows/c19c3e37-5fd4-4057-8ed1-70a8594fe025&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/516/workflows/421da77e-42d7-4219-9f53-a1fae299a360&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-17411-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/518/workflows/a1fe8fa9-5cdf-41c7-8f86-7088d5261a12&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/518/workflows/8f60ed4f-269d-4c36-9bf6-ec171408420e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-17411-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/517/workflows/51115c65-7f25-49f8-89e2-8fbb9cee5698&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/517/workflows/16011fa8-96e1-481d-9c02-d6c286c39d1f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/519/workflows/b509e5dd-ba9b-4aee-b2fa-74f1a6d4275e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;500 runs&lt;/a&gt; on the new test against 4.1.&lt;/p&gt;</comment>
                            <comment id="17555089" author="adelapena" created="Thu, 16 Jun 2022 13:38:29 +0000"  >&lt;p&gt;Looks good to me, +1. The new dtest reproduces the issue in the most clear way.&lt;/p&gt;

&lt;p&gt;Maybe we can combine the new filter and the one right before into a single one to save us a copy of the collection of replicas:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
replicas = replicas.filter(replica -&amp;gt; FailureDetector.instance.isAlive(replica.endpoint()) &amp;amp;&amp;amp;
                                      StorageService.instance.isRpcReady(replica.endpoint()));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;However I doubt it would be worth the loss of readability.&lt;/p&gt;

&lt;p&gt;The test failure of &lt;tt&gt;HostReplacementTest&lt;/tt&gt; on 4.0 seems to be &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16953&quot; title=&quot;Flaky replaceAliveHost test from hostreplacement.HostReplacementTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16953&quot;&gt;&lt;del&gt;CASSANDRA-16953&lt;/del&gt;&lt;/a&gt;, and the failure of &lt;tt&gt;RepairErrorsTest&lt;/tt&gt; on 4.1 looks like the same timeout on &lt;tt&gt;Cluster#close()&lt;/tt&gt;. Both can be reproduced without the patch, so CI looks clean to me.&lt;/p&gt;</comment>
                            <comment id="17555097" author="brandon.williams" created="Thu, 16 Jun 2022 14:07:32 +0000"  >&lt;p&gt;Committed as is for readability as suggested, thanks for the review!&lt;/p&gt;</comment>
                            <comment id="17559274" author="jmckenzie" created="Mon, 27 Jun 2022 16:44:24 +0000"  >&lt;p&gt;Looks like a bit of infra pressure or flaky CI run; the &quot;1st failure&quot; tests below don&apos;t seem to have any rhyme or reason.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;CI Results&amp;#93;&lt;/span&gt;&lt;br/&gt;
Branch: 4.1, build number: 71&lt;br/&gt;
butler url: &lt;a href=&quot;https://butler.cassandra.apache.org/#/ci/upstream/compare/Cassandra-4.1/Cassandra-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://butler.cassandra.apache.org/#/ci/upstream/compare/Cassandra-4.1/Cassandra-4.1&lt;/a&gt;&lt;br/&gt;
jenkins url: &lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-4.1/71/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/job/Cassandra-4.1/71/&lt;/a&gt;&lt;br/&gt;
JIRA: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17411&quot; title=&quot;Network partition causes write ONE timeouts when using counters in Cassandra 4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17411&quot;&gt;&lt;del&gt;CASSANDRA-17411&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
commit url: &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=cassandra.git;a=commit;h=51ce71881c87df754969809b5f6b2a466abc1e35&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=cassandra.git;a=commit;h=51ce71881c87df754969809b5f6b2a466abc1e35&lt;/a&gt;&lt;br/&gt;
affected paths:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;CHANGES.txt&lt;/li&gt;
	&lt;li&gt;src/java/org/apache/cassandra/service/StorageProxy.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Build Result: UNSTABLE&lt;br/&gt;
Passing Tests: 47328&lt;br/&gt;
Failing Tests: 21&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Test&lt;/th&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Failures&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;JIRA&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest-offheap.repair_tests.repair_test.TestRepair.test_dc_repair&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/issues/?jql=project%20%3D%20CASSANDRA%20and%20resolution%20%3D%20unresolved%20and%20summary%20~%20%22*TestRepair*%22&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Multiple JIRAs found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.distributed.upgrade.CompactStoragePagingTest.testPagingWithCompactStorage&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.cql3.validation.operations.InsertUpdateIfConditionCollectionsTest.testFrozenWithNullValues&lt;span class=&quot;error&quot;&gt;&amp;#91;0: clusterMinVersion=3.0&amp;#93;&lt;/span&gt;-cdc&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.cql3.validation.entities.SecondaryIndexTest.testWriteOnlyIndex&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;5 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest-novnode.bootstrap_test.TestBootstrap.test_simultaneous_bootstrap&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/issues/?jql=project%20%3D%20CASSANDRA%20and%20resolution%20%3D%20unresolved%20and%20summary%20~%20%22*TestBootstrap*%22&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Multiple JIRAs found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.cql3.validation.operations.SelectTest.testRangeQuery&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest-upgrade.upgrade_tests.drop_compact_storage_upgrade_test.TestDropCompactStorage.test_drop_compact_storage_mixed_cluster&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;8 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17674&quot; title=&quot;Test failure: org.apache.cassandra.distributed.upgrade.DropCompactStorageTest.testDropCompactStorage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17674&quot;&gt;CASSANDRA-17674&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.cql3.validation.entities.TupleTypeTest.tuplePartitionReadWrite&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.distributed.upgrade.BatchUpgradeTest.batchTest&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;19 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17651&quot; title=&quot;Fix flaky dtest - org.apache.cassandra.distributed.upgrade.BatchUpgradeTest.batchTest &quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17651&quot;&gt;&lt;del&gt;CASSANDRA-17651&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.cql3.ViewComplexTTLTest.testUpdateColumnInViewPKWithTTLWithFlush&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;11 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest-upgrade.upgrade_tests.upgrade_through_versions_test.TestProtoV3Upgrade_AllVersions_RandomPartitioner_EndsAt_3_11_X_HEAD.test_parallel_upgrade_with_internode_ssl&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;3 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17610&quot; title=&quot;Fix dtest-upgrade.upgrade_tests.upgrade_through_versions_test.TestProtoV3Upgrade_AllVersions_RandomPartitioner_EndsAt_3_11_X_HEAD.test_parallel_upgrade_with_internode_ssl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17610&quot;&gt;CASSANDRA-17610&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.net.ConnectionTest.testMessageDeliveryOnReconnect-compression&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16677&quot; title=&quot;Test Failure: Fix flaky ConnectionTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16677&quot;&gt;CASSANDRA-16677&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest-upgrade.upgrade_tests.upgrade_through_versions_test.TestProtoV4Upgrade_AllVersions_RandomPartitioner_EndsAt_Trunk_HEAD.test_parallel_upgrade_with_internode_ssl&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17296&quot; title=&quot;Test Failure: dtest-upgrade.upgrade_tests.upgrade_through_versions_test.TestProtoV4Upgrade_AllVersions_RandomPartitioner_EndsAt_Trunk_HEAD.test_rolling_upgrade&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17296&quot;&gt;&lt;del&gt;CASSANDRA-17296&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.distributed.test.CASTest.testSuccessfulWriteBeforeRangeMovement&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;6 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17461&quot; title=&quot;Test Failure: org.apache.cassandra.distributed.test.CASTest.testConflictingWritesWithStaleRingInformation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17461&quot;&gt;&lt;del&gt;CASSANDRA-17461&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.cql3.validation.entities.SecondaryIndexTest.testIndexOnPartitionKeyInsertExpiringColumn&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.cql3.validation.entities.SecondaryIndexTest.testIndexesOnNonStaticColumnsWhereSchemaIncludesStaticColumns&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.db.commitlog.GroupCommitLogTest.testOutOfOrderFlushRecoveryWithCompaction&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;-compression&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17232&quot; title=&quot;org.apache.cassandra.db.commitlog.GroupCommitLogTest tests failing on trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17232&quot;&gt;&lt;del&gt;CASSANDRA-17232&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.distributed.test.CASTest.testSucccessfulWriteDuringRangeMovementFollowedByRead&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;10 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17461&quot; title=&quot;Test Failure: org.apache.cassandra.distributed.test.CASTest.testConflictingWritesWithStaleRingInformation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17461&quot;&gt;&lt;del&gt;CASSANDRA-17461&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.distributed.upgrade.MixedModeFrom3UnloggedBatchTest.testSimpleStrategy&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.cql3.validation.entities.TupleTypeTest.testNestedTuple&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;9 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest-upgrade.upgrade_tests.upgrade_through_versions_test.TestUpgrade_indev_4_0_x_To_indev_4_1_x.test_bootstrap_multidc&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;3 of 68&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/issues/?jql=project%20%3D%20CASSANDRA%20and%20resolution%20%3D%20unresolved%20and%20summary%20~%20%22*TestUpgrade*%22&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Multiple JIRAs found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17559684" author="adelapena" created="Tue, 28 Jun 2022 10:33:51 +0000"  >&lt;p&gt;Yep, the failures that are seen for the first time in the run for this patch seem timeouts due to a bad CI run and, if I&apos;m not missing anything, they don&apos;t fail in later runs.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13040598" name="app.py" size="2615" author="pbalaguer" created="Tue, 1 Mar 2022 15:33:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12983" cascade-level=""><![CDATA[Availability]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 20 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10234:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[adelapena]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348281">4.0-alpha1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/51ce71881c87df754969809b5f6b2a466abc1e35&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/51ce71881c87df754969809b5f6b2a466abc1e35&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;add test and run CI&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>