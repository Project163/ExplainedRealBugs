<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:16:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-15665] StreamManager should clearly differentiate between &quot;initiator&quot; and &quot;receiver&quot; sessions</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-15665</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;&lt;tt&gt;StreamManager&lt;/tt&gt; does currently a suboptimal job in differentiating between stream sessions (in form of &lt;tt&gt;StreamResultFuture&lt;/tt&gt;) which have been either initiated or &quot;received&quot;, for the following reasons:&lt;br/&gt;
1) Naming is IMO confusing: a &quot;receiver&quot; session could actually both send and receive files, so technically an initiator is also a receiver.&lt;br/&gt;
2) &lt;tt&gt;StreamManager#findSession()&lt;/tt&gt;  assumes we should first looking into &quot;initiator&quot; sessions, then into &quot;receiver&quot; ones: this is a dangerous assumptions, in particular for test environments where the same process could work as both an initiator and a receiver.&lt;/p&gt;

&lt;p&gt;I would recommend the following changes:&lt;br/&gt;
1) Rename &quot;receiver&quot; with &quot;follower&quot; everywhere the former is used.&lt;br/&gt;
2) Introduce a new flag into &lt;tt&gt;StreamMessageHeader&lt;/tt&gt; to signal if the message comes from an initiator or follower session, in order to correctly differentiate and look for sessions in &lt;tt&gt;StreamManager&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;While my arguments above might seem trivial, I believe they will improve clarity and save from potential bugs/headaches at testing time, and doing such changes now that we&apos;re revamping streaming for 4.0 seems the right time.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13294186">CASSANDRA-15665</key>
            <summary>StreamManager should clearly differentiate between &quot;initiator&quot; and &quot;receiver&quot; sessions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jasonstack">Zhao Yang</assignee>
                                    <reporter username="sbtourist">Sergio Bossa</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Mar 2020 12:22:38 +0000</created>
                <updated>Sun, 3 Jan 2021 17:03:01 +0000</updated>
                            <resolved>Fri, 19 Jun 2020 15:34:34 +0000</resolved>
                                        <fixVersion>4.0-beta1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Legacy/Streaming and Messaging</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17072721" author="jasonstack" created="Wed, 1 Apr 2020 12:33:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/jasonstack/cassandra/pull/10&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Patch&lt;/a&gt; on top of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15666&quot; title=&quot;Race condition when completing stream sessions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15666&quot;&gt;&lt;del&gt;CASSANDRA-15666&lt;/del&gt;&lt;/a&gt;:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Include &lt;tt&gt;isFollower&lt;/tt&gt; flag into &lt;tt&gt;StreamMessageHeader&lt;/tt&gt;. On the receiver side, it will use initiator session if message is sent by a follower or use follower session if message is sent by an initiator.&lt;/li&gt;
	&lt;li&gt;Added a base method &lt;tt&gt;getOrCreateSession&lt;/tt&gt; to &lt;tt&gt;StreamMessage&lt;/tt&gt;:
	&lt;ul&gt;
		&lt;li&gt;it throws unsupported operation by default&lt;/li&gt;
		&lt;li&gt;&lt;tt&gt;StreamInitMessage&lt;/tt&gt; will initialize a follower &lt;tt&gt;StreamResultFuture&lt;/tt&gt;/&lt;tt&gt;StreamSession&lt;/tt&gt;&lt;/li&gt;
		&lt;li&gt;&lt;tt&gt;IncomingStreamMessage&lt;/tt&gt; will just return the stream session taken from &lt;tt&gt;IncomingStreamMessage#serializer#deserialize&lt;/tt&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17092214" author="jasonstack" created="Sat, 25 Apr 2020 12:44:01 +0000"  >&lt;p&gt;CI looks good, dtest failures are not related.&lt;/p&gt;</comment>
                            <comment id="17119016" author="jasonstack" created="Thu, 28 May 2020 19:21:01 +0000"  >&lt;p&gt;Rebased with latest trunk, &lt;a href=&quot;https://circleci.com/workflow-run/947320b4-3c52-4113-91ab-36d622a45e23&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CI&lt;/a&gt; looks good, failed dtests are unrelated and passed locally:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;test_multi_partition_consistent_reads_after_write - materialized_views_test.TestMaterializedViewsConsistency&lt;/li&gt;
	&lt;li&gt;test_13911_partitions_srp - consistency_test.TestConsistency&lt;/li&gt;
	&lt;li&gt;test_13911_rows_srp - consistency_test.TestConsistency&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17130550" author="jasonstack" created="Wed, 10 Jun 2020 11:31:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sbtourist&quot; class=&quot;user-hover&quot; rel=&quot;sbtourist&quot;&gt;sbtourist&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;&#160;do you mind having a look?&#160;&lt;/p&gt;</comment>
                            <comment id="17133127" author="sbtourist" created="Thu, 11 Jun 2020 10:18:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonstack&quot; class=&quot;user-hover&quot; rel=&quot;jasonstack&quot;&gt;jasonstack&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;, apologies for this late reply. I&apos;m afraid I&apos;ll be busy until at least next week. Feel free to go ahead without my review.&lt;/p&gt;</comment>
                            <comment id="17140638" author="blerer" created="Fri, 19 Jun 2020 15:34:34 +0000"  >&lt;p&gt;Committed into trunk at ebba613b0b34ea338eed508a3ba6cbb235986fd9&lt;/p&gt;</comment>
                            <comment id="17163992" author="maedhroz" created="Thu, 23 Jul 2020 21:58:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonstack&quot; class=&quot;user-hover&quot; rel=&quot;jasonstack&quot;&gt;jasonstack&lt;/a&gt; Did we introduce a change &lt;a href=&quot;https://github.com/apache/cassandra/commit/ebba613b0b34ea338eed508a3ba6cbb235986fd9#diff-85ee7eed2fccf1f9220452e69fbf8ca8R131&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; that needs to be guarded by a &lt;tt&gt;VERSION_40&lt;/tt&gt; check? (nit: I&apos;d also call it &lt;tt&gt;sentByFollower&lt;/tt&gt;.)&lt;/p&gt;</comment>
                            <comment id="17164075" author="jasonstack" created="Fri, 24 Jul 2020 01:38:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maedhroz&quot; class=&quot;user-hover&quot; rel=&quot;maedhroz&quot;&gt;maedhroz&lt;/a&gt;&#160;does it fail anything? I think we don&apos;t allow cross-version streaming between 3.x and 4.0..It&apos;s guarded by version when establishing connections.&lt;/p&gt;</comment>
                            <comment id="17164515" author="maedhroz" created="Fri, 24 Jul 2020 16:22:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonstack&quot; class=&quot;user-hover&quot; rel=&quot;jasonstack&quot;&gt;jasonstack&lt;/a&gt; I&apos;m having trouble finding where we prohibit that. Any pointers?&lt;/p&gt;</comment>
                            <comment id="17164532" author="jasonstack" created="Fri, 24 Jul 2020 16:57:48 +0000"  >&lt;p&gt;the version barrier is defined in &lt;tt&gt;MessagingService.accept_streaming&lt;/tt&gt;&lt;br/&gt;
&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jasonstack]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="13163" cascade-level=""><![CDATA[Code]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12975"><![CDATA[Code Inspection]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0cxpk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348281">4.0-alpha1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/ebba613b0b34ea338eed508a3ba6cbb235986fd9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/ebba613b0b34ea338eed508a3ba6cbb235986fd9&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/586&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/586&lt;/a&gt;&lt;br/&gt;
CI: &lt;a href=&quot;https://circleci.com/workflow-run/947320b4-3c52-4113-91ab-36d622a45e23&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/workflow-run/947320b4-3c52-4113-91ab-36d622a45e23&lt;/a&gt;&lt;br/&gt;
&#160;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>