<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:45:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-7353] Java heap being set too large on Windows with 32-bit JVM</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-7353</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;On windows, the JVM settings for max heap size and new gen heap size are set based on the total system memory. When the system has 8G of RAM, the max heap size is set to 2048M. However, according to &lt;a href=&quot;http://goo.gl/1ElbLm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://goo.gl/1ElbLm&lt;/a&gt;, the recommended max heap for a 32 bit JVM on Windows is 1.8G.&lt;/p&gt;

&lt;p&gt;When cassandra is started on Windows under these conditions, the following error is seen:&lt;/p&gt;

&lt;p&gt;Error occurred during initialization of VM&lt;br/&gt;
Could not reserve enough space for object heap&lt;br/&gt;
Error: Could not create the Java Virtual Machine.&lt;br/&gt;
Error: A fatal exception has occurred. Program will exit.&lt;/p&gt;

&lt;p&gt;Switching to a 64-bit JVM on the same machine solves the issue. If a 32-bit JVM is being used, cassandra should be started up with a smaller heap than would be normally used to prevent the error.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows Server 2008, 8G RAM, 32-bit JVM&lt;/p&gt;</environment>
        <key id="12718506">CASSANDRA-7353</key>
            <summary>Java heap being set too large on Windows with 32-bit JVM</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jmckenzie">Josh McKenzie</assignee>
                                    <reporter username="philipthompson">Philip Thompson</reporter>
                        <labels>
                            <label>Windows</label>
                            <label>qa-resolved</label>
                    </labels>
                <created>Wed, 4 Jun 2014 22:56:27 +0000</created>
                <updated>Wed, 15 Oct 2025 09:49:05 +0000</updated>
                            <resolved>Wed, 18 Jun 2014 19:01:32 +0000</resolved>
                                        <fixVersion>2.1 rc2</fixVersion>
                                    <component>Packaging</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14029519" author="jmckenzie" created="Thu, 12 Jun 2014 18:01:09 +0000"  >&lt;p&gt;v1 attached.  Limits heap and youngen ratio on 32-bit Windows JVM to 1.5G.  Tested for this problem on linux but it can support up to 4G heap on 32-bit and I don&apos;t have a testbed with enough memory to push it over the limit and confirm this behavior.  Given the higher threshold 32-bit JVM on linux can tolerate, we may just want to let this one lie as we don&apos;t recommend 32-bit JVM in production anyway.&lt;/p&gt;</comment>
                            <comment id="14032512" author="snazy" created="Mon, 16 Jun 2014 15:03:14 +0000"  >&lt;p&gt;Just a note: as far as I can remember there are differences in multiple installations of 32bit-Win regarding the max possible heap size.&lt;br/&gt;
One machine could work with 1500m - another (same hardware) couldn&apos;t.&lt;br/&gt;
I think the most common max heap setting for 32bit-Win was about 1300m.&lt;/p&gt;</comment>
                            <comment id="14032553" author="jmckenzie" created="Mon, 16 Jun 2014 15:28:16 +0000"  >&lt;p&gt;v2 at 1300 attached.  Thanks for the note Robert.&lt;/p&gt;</comment>
                            <comment id="14033257" author="philipthompson" created="Tue, 17 Jun 2014 00:42:04 +0000"  >&lt;p&gt;I&apos;m starting a 32 bit jvm on a 64 bit version of Windows, and this patch does not fix the error message. It still see this when starting cassandra.bat with -f -v:&lt;br/&gt;
-Xms2048M -Xmx2048M -Xmn400M -XX:+HeapDumpOnOutOfMemoryError -Xss256k&lt;/p&gt;</comment>
                            <comment id="14033271" author="dbrosius" created="Tue, 17 Jun 2014 00:58:50 +0000"  >&lt;p&gt;i suppose for oracle&apos;s jvm you could look at the &quot;sun.arch.data.model&quot; system property to handle this case, but it&apos;s getting kind of ridiculous. why would you run cassandra on a 32 bit jvm on a 64 bit box?&lt;/p&gt;</comment>
                            <comment id="14033802" author="jmckenzie" created="Tue, 17 Jun 2014 13:52:23 +0000"  >&lt;p&gt;Slipped my mind - we have MAX_HEAP_SIZE and HEAP_NEWSIZE available to be tuned in conf/cassandra-env.ps1, so adding more logic on top of that to facilitate an edge-case like this is unnecessary.&lt;/p&gt;

&lt;p&gt;That said, I&apos;ve tidied up a few things, tossed a 100 ms sleep in the launch process to catch JVM init errors (catches it at 10 on my machine but figured a little breathing room wouldn&apos;t hurt), and changed the logic we use to check to see if a process started correctly (v3 patch attached).&lt;/p&gt;

&lt;p&gt;Philip, will this launch delay potentially cause us headaches in ccm or dtests?&lt;/p&gt;</comment>
                            <comment id="14033870" author="philipthompson" created="Tue, 17 Jun 2014 14:48:26 +0000"  >&lt;p&gt;Josh, that increase, even if it took the full 100ms each time is pretty negligible. 30s when a full dtest run takes 2 hours. However, saying that we just don&apos;t support a 32 bit jvm on a 64 bit machine could be an acceptable resolution if Dave&apos;s opinion is the consensus. I&apos;ll get v3 tested and let you know if it works though.&lt;/p&gt;</comment>
                            <comment id="14033876" author="philipthompson" created="Tue, 17 Jun 2014 14:55:32 +0000"  >&lt;p&gt;v3 gives me the same error message with the same Xms, Xmx, and Xmn values.&lt;/p&gt;</comment>
                            <comment id="14033885" author="philipthompson" created="Tue, 17 Jun 2014 15:06:41 +0000"  >&lt;p&gt;If my understanding is correct and the user is now responsible for setting their own MAX_HEAP_SIZE and HEAP_NEWSIZE variables, then this is working correctly. There is a helpful error message when C* does not start correctly, and the environment variables properly coerce the heap. +1.&lt;/p&gt;</comment>
                            <comment id="14033887" author="jmckenzie" created="Tue, 17 Jun 2014 15:07:55 +0000"  >&lt;p&gt;Yep - sorry I wasn&apos;t more clear on v3 totally taking a left-turn when it came to implementation.&lt;/p&gt;</comment>
                            <comment id="14036177" author="jbellis" created="Wed, 18 Jun 2014 19:01:33 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12650093" name="7353_v1.txt" size="2168" author="joshuamckenzie" created="Thu, 12 Jun 2014 18:01:09 +0000"/>
                            <attachment id="12650580" name="7353_v2.txt" size="2168" author="joshuamckenzie" created="Mon, 16 Jun 2014 15:28:16 +0000"/>
                            <attachment id="12650805" name="7353_v3.txt" size="2196" author="joshuamckenzie" created="Tue, 17 Jun 2014 13:52:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jmckenzie]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396705</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 22 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1waqv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396824</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326658">2.1 rc1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>philipthompson</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[philipthompson]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326276">2.1 beta2</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12311124" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Tester</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>philipthompson</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>