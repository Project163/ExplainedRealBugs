<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:54:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-8487] system.schema_columns sometimes missing for &apos;system&apos; keyspace</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-8487</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Occasionally a Cassandra node will have missing schema_columns information where keyspace_name=&apos;system&apos;.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh&amp;gt; select * from system.schema_columns where keyspace_name=&lt;span class=&quot;code-quote&quot;&gt;&apos;system&apos;&lt;/span&gt;;

 keyspace_name | columnfamily_name | column_name
---------------+-------------------+-------------

(0 rows)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All keyspace and column family schema info is present for &apos;system&apos; &amp;#8211; it&apos;s only the column information missing.&lt;/p&gt;

&lt;p&gt;This can occur on an existing cluster following node restart. The data usually appears again after bouncing the node.&lt;/p&gt;

&lt;p&gt;This is impactful to client drivers that expect column meta for configured tables.&lt;/p&gt;

&lt;p&gt;Reproducible in 2.1.2. Have not seen it crop up in 2.0.11.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12761851">CASSANDRA-8487</key>
            <summary>system.schema_columns sometimes missing for &apos;system&apos; keyspace</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aleksey">Aleksey Yeschenko</assignee>
                                    <reporter username="aholmber">Adam Holmberg</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Dec 2014 20:42:11 +0000</created>
                <updated>Fri, 7 May 2021 18:52:01 +0000</updated>
                            <resolved>Thu, 4 Jun 2015 15:34:07 +0000</resolved>
                                        <fixVersion>2.1.6</fixVersion>
                    <fixVersion>2.2.0 rc1</fixVersion>
                                        <due></due>
                            <votes>4</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14349267" author="danderson" created="Thu, 5 Mar 2015 18:55:26 +0000"  >&lt;p&gt;I am seeing the same problem on 2.1.0. The problem is reproducible in my test environment 1 out of 10 times.&lt;/p&gt;

&lt;p&gt;I have not been able to reproduce the problem in 2.1.3.&lt;/p&gt;</comment>
                            <comment id="14349285" author="iamaleksey" created="Thu, 5 Mar 2015 19:03:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=danderson&quot; class=&quot;user-hover&quot; rel=&quot;danderson&quot;&gt;danderson&lt;/a&gt; Thanks. I&apos;m going to close it as Cannot Reproduce (in 2.1.3). Can you please reopen if it happens again?&lt;/p&gt;</comment>
                            <comment id="14349288" author="iamaleksey" created="Thu, 5 Mar 2015 19:04:20 +0000"  >&lt;p&gt;Same goes to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aholmber&quot; class=&quot;user-hover&quot; rel=&quot;aholmber&quot;&gt;aholmber&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14571720" author="kishkaru" created="Wed, 3 Jun 2015 21:59:26 +0000"  >&lt;p&gt;I was able to reproduce this in C* 2.2.0-beta1 on Windows 64-bit. This is on a single-dc, 3 node cluster. In my case, I&apos;m missing both system.schema_columnfamilies and system.schema_columns:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; desc tables;

Keyspace system_auth
--------------------
resource_role_permissons_index  role_permissions  role_members  roles

Keyspace system
---------------
&amp;lt;empty&amp;gt;

Keyspace system_distributed
---------------------------
repair_history  parent_repair_history

Keyspace system_traces
----------------------
events  sessions

cqlsh&amp;gt; select * from system.schema_columnfamilies;
Column family &apos;schema_columnfamilies&apos; not found
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Using python-driver 2.6.0-rc, I was able to do some further investigation:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;gt;&amp;gt;&amp;gt; s.execute(&quot;select distinct keyspace_name from system.schema_columnfamilies&quot;)
[Row(keyspace_name=u&apos;test3rf&apos;), Row(keyspace_name=u&apos;system_auth&apos;), Row(keyspace_name=u&apos;system_distributed&apos;), Row(keyspac
e_name=u&apos;system&apos;), Row(keyspace_name=u&apos;system_traces&apos;)]
&amp;gt;&amp;gt;&amp;gt; s.execute(&quot;select distinct keyspace_name from system.schema_columnfamilies&quot;)
[Row(keyspace_name=u&apos;test3rf&apos;), Row(keyspace_name=u&apos;system_auth&apos;), Row(keyspace_name=u&apos;system_distributed&apos;), Row(keyspac
e_name=u&apos;system&apos;), Row(keyspace_name=u&apos;system_traces&apos;)]
&amp;gt;&amp;gt;&amp;gt; s.execute(&quot;select distinct keyspace_name from system.schema_columnfamilies&quot;)
[Row(keyspace_name=u&apos;test3rf&apos;), Row(keyspace_name=u&apos;system_auth&apos;), Row(keyspace_name=u&apos;system_distributed&apos;), Row(keyspac
e_name=u&apos;system_traces&apos;)]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since the python-driver executes its queries with round-robin, we can see here that each SELECT query was routed to each node, and the 3rd one is missing the metadata about the keyspace &quot;system&quot;. I&apos;m not sure why I&apos;m able to query against a &quot;nonexistent&quot; schema_columnfamilies table in the python-driver, but not in cqlsh. Does cqlsh run at CL.ALL or require metadata for formatting the results?&lt;/p&gt;</comment>
                            <comment id="14571739" author="thobbs" created="Wed, 3 Jun 2015 22:13:53 +0000"  >&lt;blockquote&gt;&lt;p&gt;Does cqlsh run at CL.ALL or require metadata for formatting the results?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;cqlsh queries at ONE (by default), but does require metadata to format the results.&lt;/p&gt;</comment>
                            <comment id="14571751" author="iamaleksey" created="Wed, 3 Jun 2015 22:19:08 +0000"  >&lt;p&gt;The tables will always be there - they are hardcoded. You will always be able to query all system tables.&lt;/p&gt;

&lt;p&gt;Persistence of them into the on-disk data dictionary, though, for some reason seems to not work sometimes.&lt;/p&gt;

&lt;p&gt;Seems like all system.* tables are sometimes missing from columnfamilies/columns, which probably means some timestamp related issue.&lt;/p&gt;</comment>
                            <comment id="14571775" author="kishkaru" created="Wed, 3 Jun 2015 22:45:11 +0000"  >&lt;p&gt;I&apos;m able to repro the issue about 50% of the time on Windows when I start up a CCM cluster. Checking the system tables metadata in the python driver similarly just outputs an empty dict:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;print cluster.metadata.keyspaces[&apos;system&apos;].tables
{}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14571785" author="iamaleksey" created="Wed, 3 Jun 2015 22:52:20 +0000"  >&lt;p&gt;All right. I think I know what the issue is (and it is timestamp related). Let me cook up a patch for you to try.&lt;/p&gt;</comment>
                            <comment id="14571799" author="iamaleksey" created="Wed, 3 Jun 2015 23:02:52 +0000"  >&lt;p&gt;2.1 branch - &lt;a href=&quot;https://github.com/iamaleksey/cassandra/commits/8487-2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/iamaleksey/cassandra/commits/8487-2.1&lt;/a&gt;&lt;br/&gt;
2.2 branch - &lt;a href=&quot;https://github.com/iamaleksey/cassandra/commits/8487-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/iamaleksey/cassandra/commits/8487-2.2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please let me know if you can reproduce there.&lt;/p&gt;</comment>
                            <comment id="14571940" author="kishkaru" created="Thu, 4 Jun 2015 01:11:40 +0000"  >&lt;p&gt;I&apos;m unable to reproduce on Windows against C* 2.1 and 2.2 with the patches above.&lt;/p&gt;</comment>
                            <comment id="14572529" author="iamaleksey" created="Thu, 4 Jun 2015 10:51:45 +0000"  >&lt;p&gt;cassci results will be available at:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/iamaleksey/job/iamaleksey-8487-2.1-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Dev/view/iamaleksey/job/iamaleksey-8487-2.1-dtest/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/iamaleksey/job/iamaleksey-8487-2.1-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Dev/view/iamaleksey/job/iamaleksey-8487-2.1-testall/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/iamaleksey/job/iamaleksey-8487-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Dev/view/iamaleksey/job/iamaleksey-8487-2.2-dtest/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/iamaleksey/job/iamaleksey-8487-2.2-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Dev/view/iamaleksey/job/iamaleksey-8487-2.2-testall/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14572967" author="beobal" created="Thu, 4 Jun 2015 15:18:32 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14572980" author="iamaleksey" created="Thu, 4 Jun 2015 15:33:35 +0000"  >&lt;p&gt;Committed to 2.1 as &lt;tt&gt;f1b22dfc4042cebb2de0e17d296ac4d7bc7d53df&lt;/tt&gt; and merged into 2.2 and trunk. Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 24 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i23gb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12328841">2.1.2</customfieldvalue>
    <customfieldvalue id="12324945">2.2.0 beta 1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>samt</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>