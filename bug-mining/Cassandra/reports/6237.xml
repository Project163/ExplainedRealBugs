<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:27:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-18025] cassandra-stress: not all contact point are passed down to driver</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-18025</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Seem like c-s is randomly selecting a node from the nodes passed down to it in the command line, and use that node as contact point to the driver.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;When using c-s together with other management operations (for example expending/shrinking the cluster), we can get into situation some of the nodes mentioned in the command line aren&apos;t reachable/available, and c-s instead of applying the best practice of having multiple contact points, pass down only one that can be unavailable and fail completely without trying any of the other nodes mentioned in the command line&lt;/p&gt;

&lt;p&gt;we just fixed that in our fork of cassandra-stress:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/scylladb/scylla-tools-java/pull/314&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/scylladb/scylla-tools-java/pull/314&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13499746">CASSANDRA-18025</key>
            <summary>cassandra-stress: not all contact point are passed down to driver</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="smiklosovic">Stefan Miklosovic</assignee>
                                    <reporter username="fruch">Israel Fruchter</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Nov 2022 15:23:04 +0000</created>
                <updated>Tue, 12 Sep 2023 13:03:01 +0000</updated>
                            <resolved>Fri, 19 May 2023 18:22:25 +0000</resolved>
                                        <fixVersion>3.0.30</fixVersion>
                    <fixVersion>3.11.16</fixVersion>
                    <fixVersion>4.0.10</fixVersion>
                    <fixVersion>4.1.2</fixVersion>
                    <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Tool/stress</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4200">1h 10m</timespent>
                                <comments>
                            <comment id="17636513" author="smiklosovic" created="Mon, 21 Nov 2022 08:02:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; what do you think about this? It is ok that it fixes the connection when one node is down, on the other hand, should not be a user notified about that node being down before a stress test starts? In that sense, it is good that it fails. I would not want to start my stress test on a three node cluster when one of the nodes is down and I do not know it.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fruch&quot; class=&quot;user-hover&quot; rel=&quot;fruch&quot;&gt;fruch&lt;/a&gt; could you please expand your thinking around &quot;management operation / expanding / shrinking&quot;? Is it common for you to perform a stress test on a cluster which changes its topology? Why would expanding of a cluster make the driver not being able to connect to a node which was there already?&lt;/p&gt;</comment>
                            <comment id="17640135" author="brandon.williams" created="Mon, 28 Nov 2022 16:51:35 +0000"  >&lt;p&gt;I think the driver probably does notify that the node it tried was down?  &lt;/p&gt;</comment>
                            <comment id="17640146" author="fruch" created="Mon, 28 Nov 2022 17:13:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; the idea is that we are using cassandra-stress during complex test cases, in which at any given time one of the nodes might be affect by a ChaosMonkey style experiment/fault. in those situation we might start cassandra-stress with a list of nodes, which one of them is down. and it&apos;s part of what we are testing.&lt;/p&gt;

&lt;p&gt;other stress tools we are using, doesn&apos;t suffer from this issue, since they are passing all contact points down to their driver code.&lt;/p&gt;

&lt;p&gt;The whole idea is to let user run the stress tool also on cluster which are not fully functioning, as long as you doing CQL command in QUORUM for example, you have guarantee it should work, isn&apos;t that what Cassandra advertise ? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Anyhow randomly picking one of the nodes doesn&apos;t &#160;guarantees&#160; that all of them are working, just that this one that was selected is up.&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; the driver is aware that nodes goes down, but I don&apos;t think cassandra-stress is listen to those. (but it&apos;s visible you turn on some of the driver debug levels)&lt;/p&gt;

&lt;p&gt;And again, all production code will be using multiple contact points (for exactly the reason I&apos;ve described), I think tooling and tests should act as close to production behavior as possible.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17723911" author="smiklosovic" created="Thu, 18 May 2023 12:53:05 +0000"  >&lt;p&gt;trunk &lt;a href=&quot;https://github.com/apache/cassandra/pull/2343&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2343&lt;/a&gt;&lt;br/&gt;
4.1 &lt;a href=&quot;https://github.com/apache/cassandra/pull/2344&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2344&lt;/a&gt;&lt;br/&gt;
4.0 &lt;a href=&quot;https://github.com/apache/cassandra/pull/2345&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2345&lt;/a&gt;&lt;br/&gt;
3.11 &lt;a href=&quot;https://github.com/apache/cassandra/pull/2346&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2346&lt;/a&gt;&lt;br/&gt;
3.0 &lt;a href=&quot;https://github.com/apache/cassandra/pull/2347&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2347&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I ll add builds soon.&lt;/p&gt;</comment>
                            <comment id="17724165" author="smiklosovic" created="Fri, 19 May 2023 07:26:41 +0000"  >&lt;p&gt;3.0 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2239/workflows/2358d608-7756-4b94-ba84-bd3eb5104e57&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2239/workflows/2358d608-7756-4b94-ba84-bd3eb5104e57&lt;/a&gt;&lt;br/&gt;
3.11 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2238/workflows/8ab419e4-96e0-42a8-8be3-cbba634a2d48&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2238/workflows/8ab419e4-96e0-42a8-8be3-cbba634a2d48&lt;/a&gt;&lt;br/&gt;
4.0 j8 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2237/workflows/b22a3b8c-4de3-4d48-a3f0-9d44a7dd316d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2237/workflows/b22a3b8c-4de3-4d48-a3f0-9d44a7dd316d&lt;/a&gt;&lt;br/&gt;
4.0 j11 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2237/workflows/9c090b86-9493-4536-8e4b-a3a58dca716a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2237/workflows/9c090b86-9493-4536-8e4b-a3a58dca716a&lt;/a&gt;&lt;br/&gt;
4.1 j11 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2236/workflows/9f17a644-d5f6-4018-b169-e1e99b363d47&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2236/workflows/9f17a644-d5f6-4018-b169-e1e99b363d47&lt;/a&gt;&lt;br/&gt;
4.1 j8 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2236/workflows/431febd5-d0f4-42e7-b694-49245f53ce04&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2236/workflows/431febd5-d0f4-42e7-b694-49245f53ce04&lt;/a&gt;&lt;br/&gt;
trunk TBD&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; I would appreciated if you run trunk for me - this branch &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra?branch=CASSANDRA-18025&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra?branch=CASSANDRA-18025&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4.1 is still running as I write this. I believe that if all is nice I would be able to merge this today evening UTC if you help with trunk. Thanks.&lt;/p&gt;

&lt;p&gt;I also manually tested this on trunk and it behaves nicely. If I run a stress against 3 nodes and turn off one of them, it just continues fine which can not be told about the current solution. &lt;/p&gt;

&lt;p&gt;There is also -nodes file=path flag to specify nodes in a file, one per line. A user would expect that all three nodes are used but that is not true, just random one, which is misleading (without this patch merged).&lt;/p&gt;</comment>
                            <comment id="17724177" author="fruch" created="Fri, 19 May 2023 08:04:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; I can add we are using this in scylla for testing for the last 6 months, with no issues.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The thing you want to be testing is that c-s is &lt;b&gt;starting&lt;/b&gt; even if some nodes are down.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Anyhow thanks for moving this forward.&lt;/p&gt;</comment>
                            <comment id="17724194" author="smiklosovic" created="Fri, 19 May 2023 08:41:27 +0000"  >&lt;p&gt;Sure, that indeed works as well.&lt;/p&gt;</comment>
                            <comment id="17724215" author="brandon.williams" created="Fri, 19 May 2023 10:07:26 +0000"  >&lt;p&gt;I started trunk: &lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-18025-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1007/workflows/9928cc55-44c8-4901-9af4-4b71422fc058&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1007/workflows/c3ce5a76-162b-4f92-9887-56a6af01efe0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17724266" author="smiklosovic" created="Fri, 19 May 2023 13:01:09 +0000"  >&lt;p&gt;All is finished. I think we are good!&lt;/p&gt;</comment>
                            <comment id="17724282" author="brandon.williams" created="Fri, 19 May 2023 13:36:59 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[smiklosovic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12987" cascade-level="1"><![CDATA[Transient Incorrect Response]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1bo3s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333891">3.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/b828f7ea1b735586da388ddfee17f26685e20cef&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/b828f7ea1b735586da388ddfee17f26685e20cef&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;CI&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>