<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:01:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11169] add SASI validation for partitioner and complex columns</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11169</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I have a brand new cluster, built off 1944bf507d66b5c103c136319caeb4a9e3767a69&lt;/p&gt;

&lt;p&gt;I created a new table with a set&amp;lt;text&amp;gt;, then a SASI index on the set.  I tried to insert a row with a set, Cassandra throws an exception and becomes unavailable.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh&amp;gt; create KEYSPACE test WITH replication = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;replication_factor&apos;&lt;/span&gt;: 1};
cqlsh&amp;gt; use test;
cqlsh:test&amp;gt; create table a (id &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; PRIMARY KEY , s set&amp;lt;text&amp;gt; );
cqlsh:test&amp;gt; create CUSTOM INDEX on a(s) USING &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.index.sasi.SASIIndex&apos;&lt;/span&gt;;

cqlsh:test&amp;gt; insert into a (id, s) values (1, {&lt;span class=&quot;code-quote&quot;&gt;&apos;jon&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;haddad&apos;&lt;/span&gt;});
WriteTimeout: code=1100 [Coordinator node timed out waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; replica nodes&lt;span class=&quot;code-quote&quot;&gt;&apos; responses] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;Operation timed out - received only 0 responses.&quot;&lt;/span&gt; info={&apos;&lt;/span&gt;received_responses&lt;span class=&quot;code-quote&quot;&gt;&apos;: 0, &apos;&lt;/span&gt;required_responses&lt;span class=&quot;code-quote&quot;&gt;&apos;: 1, &apos;&lt;/span&gt;consistency&lt;span class=&quot;code-quote&quot;&gt;&apos;: &apos;&lt;/span&gt;ONE&apos;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cassandra stacktrace:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.AssertionError: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	at org.apache.cassandra.db.rows.BTreeRow.getCell(BTreeRow.java:212) ~[main/:na]
	at org.apache.cassandra.index.sasi.conf.ColumnIndex.getValueOf(ColumnIndex.java:194) ~[main/:na]
	at org.apache.cassandra.index.sasi.conf.ColumnIndex.index(ColumnIndex.java:95) ~[main/:na]
	at org.apache.cassandra.index.sasi.SASIIndex$1.insertRow(SASIIndex.java:247) ~[main/:na]
	at org.apache.cassandra.index.SecondaryIndexManager$WriteTimeTransaction.onInserted(SecondaryIndexManager.java:808) ~[main/:na]
	at org.apache.cassandra.db.partitions.AtomicBTreePartition$RowUpdater.apply(AtomicBTreePartition.java:335) ~[main/:na]
	at org.apache.cassandra.db.partitions.AtomicBTreePartition$RowUpdater.apply(AtomicBTreePartition.java:295) ~[main/:na]
	at org.apache.cassandra.utils.btree.BTree.buildInternal(BTree.java:136) ~[main/:na]
	at org.apache.cassandra.utils.btree.BTree.build(BTree.java:118) ~[main/:na]
	at org.apache.cassandra.utils.btree.BTree.update(BTree.java:177) ~[main/:na]
	at org.apache.cassandra.db.partitions.AtomicBTreePartition.addAllWithSizeDelta(AtomicBTreePartition.java:156) ~[main/:na]
	at org.apache.cassandra.db.Memtable.put(Memtable.java:244) ~[main/:na]
	at org.apache.cassandra.db.ColumnFamilyStore.apply(ColumnFamilyStore.java:1216) ~[main/:na]
	at org.apache.cassandra.db.Keyspace.apply(Keyspace.java:531) ~[main/:na]
	at org.apache.cassandra.db.Keyspace.apply(Keyspace.java:399) ~[main/:na]
	at org.apache.cassandra.db.Mutation.applyFuture(Mutation.java:202) ~[main/:na]
	at org.apache.cassandra.db.Mutation.apply(Mutation.java:214) ~[main/:na]
	at org.apache.cassandra.db.Mutation.apply(Mutation.java:228) ~[main/:na]
	at org.apache.cassandra.service.StorageProxy$$Lambda$201/413275033.run(Unknown Source) ~[na:na]
	at org.apache.cassandra.service.StorageProxy$8.runMayThrow(StorageProxy.java:1343) ~[main/:na]
	at org.apache.cassandra.service.StorageProxy$LocalMutationRunnable.run(StorageProxy.java:2520) ~[main/:na]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_45]
	at org.apache.cassandra.concurrent.AbstractLocalAwareExecutorService$FutureTask.run(AbstractLocalAwareExecutorService.java:164) ~[main/:na]
	at org.apache.cassandra.concurrent.AbstractLocalAwareExecutorService$LocalSessionFutureTask.run(AbstractLocalAwareExecutorService.java:136) [main/:na]
	at org.apache.cassandra.concurrent.SEPWorker.run(SEPWorker.java:105) [main/:na]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_45]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12938997">CASSANDRA-11169</key>
            <summary>add SASI validation for partitioner and complex columns</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xedin">Pavel Yaskevich</assignee>
                                    <reporter username="rustyrazorblade">Jon Haddad</reporter>
                        <labels>
                    </labels>
                <created>Sat, 13 Feb 2016 03:14:16 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:42 +0000</updated>
                            <resolved>Wed, 17 Feb 2016 21:57:44 +0000</resolved>
                                        <fixVersion>3.4</fixVersion>
                                    <component>Feature/SASI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15145748" author="rustyrazorblade" created="Sat, 13 Feb 2016 03:15:07 +0000"  >&lt;p&gt;/cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xedin&quot; class=&quot;user-hover&quot; rel=&quot;xedin&quot;&gt;xedin&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15145751" author="rustyrazorblade" created="Sat, 13 Feb 2016 03:21:45 +0000"  >&lt;p&gt;FWIW, the behavior I was expecting is to have a prefix index on each of the elements in the set.&lt;/p&gt;</comment>
                            <comment id="15145784" author="xedin" created="Sat, 13 Feb 2016 04:22:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rustyrazorblade&quot; class=&quot;user-hover&quot; rel=&quot;rustyrazorblade&quot;&gt;rustyrazorblade&lt;/a&gt; collections are not yet supported properly by SASI since one couldn&apos;t even create index on collections before (2.0 where we ported SASI from), I will add a validation option to verify that &quot;create index&quot; fails on such columns meanwhile and will later check what if required to make it happen. &lt;/p&gt;</comment>
                            <comment id="15149775" author="xedin" created="Wed, 17 Feb 2016 03:20:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt; I&apos;ve pushed index validation changes to &lt;a href=&quot;https://github.com/xedin/cassandra/tree/CASSANDRA-11169&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-11169&lt;/a&gt; it validates/rejects the case when column in question is complex and/or partitioner is not Murmur3Partitioner.&lt;/p&gt;</comment>
                            <comment id="15149912" author="jasobrown" created="Wed, 17 Feb 2016 05:32:33 +0000"  >&lt;p&gt;+1, lgtm&lt;/p&gt;</comment>
                            <comment id="15151271" author="xedin" created="Wed, 17 Feb 2016 21:57:44 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="15151289" author="jkrupan" created="Wed, 17 Feb 2016 22:12:54 +0000"  >&lt;p&gt;To be clear, &quot;Fixed&quot; means that a plain English error is given for the CQL statement rather than a nasty-looking exception.&lt;/p&gt;

&lt;p&gt;Is it still the intent to eventually/soon implement indexing of the column values of collection columns? Is there a Jira for that? Is it like a 3.x improvement or more like 4.x?&lt;/p&gt;</comment>
                            <comment id="15151313" author="xedin" created="Wed, 17 Feb 2016 22:29:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jkrupan&quot; class=&quot;user-hover&quot; rel=&quot;jkrupan&quot;&gt;jkrupan&lt;/a&gt; It&apos;s in the TODO list for me, feel free to create a ticket for it if you want, it&apos;s just a matter of integration really, since index format is not going to change.&lt;/p&gt;</comment>
                            <comment id="15152019" author="doanduyhai" created="Thu, 18 Feb 2016 09:40:59 +0000"  >&lt;p&gt;I just created JIRA for follow up:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;collections support: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11182&quot; title=&quot;Enable SASI index for collections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11182&quot;&gt;CASSANDRA-11182&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;static columns support: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11183&quot; title=&quot;Enable SASI index for static columns&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11183&quot;&gt;&lt;del&gt;CASSANDRA-11183&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[xedin]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 39 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2st0n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jasobrown</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jasobrown]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>