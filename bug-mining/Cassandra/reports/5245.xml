<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:14:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-15075] SELECT JSON generates invalid JSON for the duration type</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-15075</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Currently,&#160;Apache Cassandra generates invalid JSON for the &quot;duration&quot; type.&lt;/p&gt;

&lt;p&gt;cqlsh&amp;gt; CREATE KEYSPACE ks1 WITH REPLICATION = { &apos;class&apos; : &apos;SimpleStrategy&apos;, &apos;replication_factor&apos; : 1 };&lt;br/&gt;
 cqlsh&amp;gt; CREATE TABLE ks1.data (id int, d duration, PRIMARY KEY (id));&lt;/p&gt;

&lt;p&gt;cqlsh&amp;gt; INSERT INTO ks1.data (id, d) VALUES (1, 6h40m);&lt;br/&gt;
 cqlsh&amp;gt; SELECT JSON d FROM ks1.data WHERE id = 1;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;json&amp;#93;&lt;/span&gt;&lt;br/&gt;
 --------------&lt;br/&gt;
 {&quot;d&quot;: 6h40m}&lt;/p&gt;

&lt;p&gt;That is, the duration is not quoted and is therefore invalid&#160;according to &lt;a href=&quot;https://jsonlint.com/,&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://jsonlint.com/,&lt;/a&gt;&#160;for example.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Fix the problem by quoting the formatted duration type properly:&lt;/p&gt;

&lt;p&gt;cqlsh&amp;gt; INSERT INTO ks1.data (id, d) VALUES (1, 6h40m);&lt;br/&gt;
 cqlsh&amp;gt; SELECT JSON d FROM ks1.data WHERE id = 1;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;json&amp;#93;&lt;/span&gt;&lt;br/&gt;
 ----------------&lt;br/&gt;
 {&quot;d&quot;: &quot;6h40m&quot;}&lt;/p&gt;

&lt;p&gt;(1 rows)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The problem is fixed by the following patch:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12964696/12964696_0001-Fix-SELECT-JSON-formatting-for-the-duration-type.patch&quot; title=&quot;0001-Fix-SELECT-JSON-formatting-for-the-duration-type.patch attached to CASSANDRA-15075&quot;&gt;0001-Fix-SELECT-JSON-formatting-for-the-duration-type.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13225798">CASSANDRA-15075</key>
            <summary>SELECT JSON generates invalid JSON for the duration type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="penberg">Pekka Enberg</assignee>
                                    <reporter username="penberg">Pekka Enberg</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Apr 2019 12:38:03 +0000</created>
                <updated>Fri, 15 May 2020 08:38:36 +0000</updated>
                            <resolved>Thu, 28 Nov 2019 07:59:34 +0000</resolved>
                                        <fixVersion>3.11.6</fixVersion>
                    <fixVersion>4.0-alpha3</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>CQL/Syntax</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16971562" author="krummas" created="Mon, 11 Nov 2019 14:03:25 +0000"  >&lt;p&gt;Thanks for the patch and sorry for the delay&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;We could probably just remove the &lt;tt&gt;toJSONString&lt;/tt&gt; override from &lt;tt&gt;DurationType&lt;/tt&gt; so that the AbstractType method is used?&lt;/li&gt;
	&lt;li&gt;The &lt;tt&gt;json_test.py&lt;/tt&gt; dtest should test &lt;tt&gt;DurationType&lt;/tt&gt; as well&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I totally understand if you have moved on from this - if that is the case I&apos;ll make the changes&lt;/p&gt;</comment>
                            <comment id="16971572" author="penberg" created="Mon, 11 Nov 2019 14:12:47 +0000"  >&lt;p&gt;Hi Marcus,&lt;/p&gt;

&lt;p&gt;I no longer have the development environment, so if you can do the adjustments to the fix yourself, that would be much appreciated!&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Pekka&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16983589" author="krummas" created="Wed, 27 Nov 2019 14:45:03 +0000"  >&lt;p&gt;pushed a &lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/15075&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;small update and a test&lt;/a&gt; with tests running &lt;a href=&quot;https://circleci.com/workflow-run/242ed896-419d-4f61-9585-2c674168422c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;does it look good to you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=penberg&quot; class=&quot;user-hover&quot; rel=&quot;penberg&quot;&gt;penberg&lt;/a&gt;?&lt;/p&gt;

&lt;p&gt;It was way too painful to update json_test.py, so I just added a small roundtrip unit test&lt;/p&gt;</comment>
                            <comment id="16983679" author="penberg" created="Wed, 27 Nov 2019 16:16:10 +0000"  >&lt;p&gt;Looks good to me!&lt;/p&gt;</comment>
                            <comment id="16984212" author="krummas" created="Thu, 28 Nov 2019 07:59:34 +0000"  >&lt;p&gt;And committed, thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12964696" name="0001-Fix-SELECT-JSON-formatting-for-the-duration-type.patch" size="1615" author="penberg" created="Wed, 3 Apr 2019 12:36:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[penberg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z01esw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12339157">3.11.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/5d930cc9db6cdb29c2f7f1dec5a03c5b30ab66a7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/5d930cc9db6cdb29c2f7f1dec5a03c5b30ab66a7&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;add new test&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>