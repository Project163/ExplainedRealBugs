<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:56:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10132] sstablerepairedset throws exception while loading metadata</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10132</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;&lt;tt&gt;sstablerepairedset&lt;/tt&gt; displays exception trying to load schema through DatabaseDescriptor.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ ./tools/bin/sstablerepairedset --really-set --is-repaired ~/.ccm/3.0/node1/data/keyspace1/standard1-2c0b226046aa11e596f58106a0d438e8/ma-1-big-Data.db
14:42:36.714 [main] DEBUG o.a.c.i.s.m.MetadataSerializer - Mutating /home/yuki/.ccm/3.0/node1/data/keyspace1/standard1-2c0b226046aa11e596f58106a0d438e8/ma-1-big-Statistics.db to repairedAt time 1440013248000
14:42:36.721 [main] DEBUG o.a.c.i.s.m.MetadataSerializer - Load metadata &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /home/yuki/.ccm/3.0/node1/data/keyspace1/standard1-2c0b226046aa11e596f58106a0d438e8/ma-1-big
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.ExceptionInInitializerError
        at org.apache.cassandra.config.DatabaseDescriptor.loadConfig(DatabaseDescriptor.java:123)
        at org.apache.cassandra.config.DatabaseDescriptor.&amp;lt;clinit&amp;gt;(DatabaseDescriptor.java:110)
        at org.apache.cassandra.utils.memory.BufferPool.&amp;lt;clinit&amp;gt;(BufferPool.java:51)
        at org.apache.cassandra.io.util.RandomAccessReader.allocateBuffer(RandomAccessReader.java:76)
        at org.apache.cassandra.io.util.RandomAccessReader.&amp;lt;init&amp;gt;(RandomAccessReader.java:58)
        at org.apache.cassandra.io.util.RandomAccessReader$RandomAccessReaderWithChannel.&amp;lt;init&amp;gt;(RandomAccessReader.java:89)
        at org.apache.cassandra.io.util.RandomAccessReader.open(RandomAccessReader.java:108)
        at org.apache.cassandra.io.sstable.metadata.MetadataSerializer.deserialize(MetadataSerializer.java:91)
        at org.apache.cassandra.io.sstable.metadata.MetadataSerializer.mutateRepairedAt(MetadataSerializer.java:143)
        at org.apache.cassandra.tools.SSTableRepairedAtSetter.main(SSTableRepairedAtSetter.java:86)
Caused by: org.apache.cassandra.exceptions.ConfigurationException: Expecting URI in variable: [cassandra.config]. Found[cassandra.yaml]. Please prefix the file with [file:&lt;span class=&quot;code-comment&quot;&gt;///] &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; local files and [file://&amp;lt;server&amp;gt;/] &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; remote files. If you are executing &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; from an external tool, it needs to set Config.setClientMode(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) to avoid loading configuration.
&lt;/span&gt;        at org.apache.cassandra.config.YamlConfigurationLoader.getStorageConfigURL(YamlConfigurationLoader.java:78)
        at org.apache.cassandra.config.YamlConfigurationLoader.&amp;lt;clinit&amp;gt;(YamlConfigurationLoader.java:92)
        ... 10 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;MetadataSerializer uses RandomAccessReader which allocates buffer through BufferPool. BufferPool gets its settings from DatabaseDescriptor and it won&apos;t work in offline tool.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12857309">CASSANDRA-10132</key>
            <summary>sstablerepairedset throws exception while loading metadata</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yukim">Yuki Morishita</assignee>
                                    <reporter username="yukim">Yuki Morishita</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Aug 2015 19:46:08 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:59 +0000</updated>
                            <resolved>Mon, 24 Aug 2015 14:49:17 +0000</resolved>
                                        <fixVersion>3.0 beta 2</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14703915" author="yukim" created="Wed, 19 Aug 2015 23:10:19 +0000"  >&lt;p&gt;Since BufferPool access DatabaseDescriptor, we need to set &lt;tt&gt;Config.setClientMode(true)&lt;/tt&gt; in offline tool.&lt;br/&gt;
patch here: &lt;a href=&quot;https://github.com/yukim/cassandra/tree/10132&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/yukim/cassandra/tree/10132&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;incremental_repair_test.sstable_repairedset_test still can fail from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6230&quot; title=&quot;Write hints to flat files instead of the system.hints&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6230&quot;&gt;&lt;del&gt;CASSANDRA-6230&lt;/del&gt;&lt;/a&gt; though.&lt;/p&gt;</comment>
                            <comment id="14709227" author="krummas" created="Mon, 24 Aug 2015 13:01:52 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14709235" author="slebresne" created="Mon, 24 Aug 2015 13:05:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;incremental_repair_test.sstable_repairedset_test still can fail from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6230&quot; title=&quot;Write hints to flat files instead of the system.hints&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6230&quot;&gt;&lt;del&gt;CASSANDRA-6230&lt;/del&gt;&lt;/a&gt; though.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m confused. In &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9111?focusedCommentId=14709224&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14709224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;your comment&lt;/a&gt; on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9111&quot; title=&quot;SSTables originated from the same incremental repair session have different repairedAt timestamps&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9111&quot;&gt;&lt;del&gt;CASSANDRA-9111&lt;/del&gt;&lt;/a&gt; you suggest the patch is supposed to fix that test. Which is it? And if you think the failure is due to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6230&quot; title=&quot;Write hints to flat files instead of the system.hints&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6230&quot;&gt;&lt;del&gt;CASSANDRA-6230&lt;/del&gt;&lt;/a&gt; then can you elaborate on why you think that&apos;s the case.&lt;/p&gt;</comment>
                            <comment id="14709262" author="yukim" created="Mon, 24 Aug 2015 13:19:17 +0000"  >&lt;p&gt;On my machine, I&apos;m still getting&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;AssertionError: Unexpected error in node2 node log: [&apos;ERROR [HintsDispatcher:1] 2015-08-24 08:16:45,858 CassandraDaemon.java:192 - Exception in thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[HintsDispatcher:1,1,main] java.lang.RuntimeException: java.nio.file.NoSuchFileException: /home/yuki/Developments/workspace/cassandra/data/hints/d2b92799-086b-4daa-8e9d-13fbcfb31868-1440422185762-1.hints
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;so, I thought it is something new hint file related.&lt;/p&gt;</comment>
                            <comment id="14709295" author="slebresne" created="Mon, 24 Aug 2015 13:37:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=iamaleksey&quot; class=&quot;user-hover&quot; rel=&quot;iamaleksey&quot;&gt;iamaleksey&lt;/a&gt; Can you comment on Yuki&apos;s error above?&lt;/p&gt;</comment>
                            <comment id="14709314" author="iamaleksey" created="Mon, 24 Aug 2015 13:50:12 +0000"  >&lt;p&gt;Sure, I will. Is there more stack trace where it&apos;s coming from? What line in &lt;tt&gt;HintsDispatcher&lt;/tt&gt;?&lt;/p&gt;</comment>
                            <comment id="14709334" author="yukim" created="Mon, 24 Aug 2015 14:01:05 +0000"  >&lt;p&gt;Here&apos;s full stack trace:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [HintsDispatcher:1] 2015-08-24 08:16:45,858 CassandraDaemon.java:192 - Exception in thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[HintsDispatcher:1,1,main]
java.lang.RuntimeException: java.nio.file.NoSuchFileException: /home/yuki/Developments/workspace/cassandra/data/hints/d2b92799-086b-4daa-8e9d-13fbcfb31868-1440422185762-1.hints
	at org.apache.cassandra.io.util.ChannelProxy.openChannel(ChannelProxy.java:55) ~[main/:na]
	at org.apache.cassandra.io.util.ChannelProxy.&amp;lt;init&amp;gt;(ChannelProxy.java:66) ~[main/:na]
	at org.apache.cassandra.io.util.RandomAccessReader$RandomAccessReaderWithChannel.&amp;lt;init&amp;gt;(RandomAccessReader.java:89) ~[main/:na]
	at org.apache.cassandra.io.util.RandomAccessReader.open(RandomAccessReader.java:108) ~[main/:na]
	at org.apache.cassandra.hints.HintsReader.open(HintsReader.java:78) ~[main/:na]
	at org.apache.cassandra.hints.HintsDispatcher.create(HintsDispatcher.java:71) ~[main/:na]
	at org.apache.cassandra.hints.HintsDispatchExecutor$DispatchHintsTask.dispatch(HintsDispatchExecutor.java:178) ~[main/:na]
	at org.apache.cassandra.hints.HintsDispatchExecutor$DispatchHintsTask.dispatch(HintsDispatchExecutor.java:159) ~[main/:na]
	at org.apache.cassandra.hints.HintsDispatchExecutor$DispatchHintsTask.run(HintsDispatchExecutor.java:138) ~[main/:na]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[na:1.8.0_51]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_51]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_51]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_51]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_51]
Caused by: java.nio.file.NoSuchFileException: /home/yuki/Developments/workspace/cassandra/data/hints/d2b92799-086b-4daa-8e9d-13fbcfb31868-1440422185762-1.hints
	at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86) ~[na:1.8.0_51]
	at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102) ~[na:1.8.0_51]
	at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107) ~[na:1.8.0_51]
	at sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:177) ~[na:1.8.0_51]
	at java.nio.channels.FileChannel.open(FileChannel.java:287) ~[na:1.8.0_51]
	at java.nio.channels.FileChannel.open(FileChannel.java:335) ~[na:1.8.0_51]
	at org.apache.cassandra.io.util.ChannelProxy.openChannel(ChannelProxy.java:51) ~[main/:na]
	... 13 common frames omitted
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Using my branch (&lt;a href=&quot;https://github.com/yukim/cassandra/tree/10132&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/yukim/cassandra/tree/10132&lt;/a&gt;) and the following dtest run will throw error.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;nosetests-2.7 incremental_repair_test.py:TestIncRepair.sstable_repairedset_test
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14709339" author="iamaleksey" created="Mon, 24 Aug 2015 14:05:47 +0000"  >&lt;p&gt;Thanks. If your patch fixes the original issue, then I suggested you commit and resolve this one - and open a new one, assigned to me, to deal with the dtests failure - if you&apos;ve got a few minutes. Thanks.&lt;/p&gt;</comment>
                            <comment id="14709354" author="yukim" created="Mon, 24 Aug 2015 14:17:41 +0000"  >&lt;p&gt;Sorry for the alarm, it was my ccm just not up to date.&lt;br/&gt;
It runs fine now.&lt;/p&gt;</comment>
                            <comment id="14709400" author="yukim" created="Mon, 24 Aug 2015 14:49:18 +0000"  >&lt;p&gt;Committed patch. Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 13 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2j4br:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>marcuse</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>