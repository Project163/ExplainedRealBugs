<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:07:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13302] last row of previous page == first row of next page while querying data using SASI index</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13302</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Apologies if this is a duplicate (couldn&apos;t track down an existing bug).&lt;/p&gt;

&lt;p&gt;Similarly to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11208&quot; title=&quot;Paging is broken for IN queries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11208&quot;&gt;&lt;del&gt;CASSANDRA-11208&lt;/del&gt;&lt;/a&gt;, it appears it is possible to retrieve duplicate rows when paging using a SASI index as documented in &lt;a href=&quot;https://datastax-oss.atlassian.net/browse/JAVA-1413&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA-1413&lt;/a&gt;, the following test demonstrates that data is repeated while querying using a SASI index:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestPagingBug
{
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args)
	{
		Cluster.Builder builder = Cluster.builder();
		Cluster c = builder.addContactPoints(&lt;span class=&quot;code-quote&quot;&gt;&quot;192.168.98.190&quot;&lt;/span&gt;).build();		
		Session s = c.connect();
		
		s.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE KEYSPACE IF NOT EXISTS test WITH replication = { &lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;replication_factor&apos;&lt;/span&gt; : 3 }&quot;&lt;/span&gt;);
		s.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE IF NOT EXISTS test.test_table_sec(sec BIGINT PRIMARY KEY, id INT)&quot;&lt;/span&gt;);
                &lt;span class=&quot;code-comment&quot;&gt;//create secondary index on ID column, used &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; select statement
&lt;/span&gt;                &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; index = &lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE CUSTOM INDEX test_table_sec_idx ON test.test_table_sec (id) USING &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.index.sasi.SASIIndex&apos;&lt;/span&gt; &quot;&lt;/span&gt;
                + &lt;span class=&quot;code-quote&quot;&gt;&quot;WITH OPTIONS = { &lt;span class=&quot;code-quote&quot;&gt;&apos;mode&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;PREFIX&apos;&lt;/span&gt; }&quot;&lt;/span&gt;;
                s.execute(index);
		
		PreparedStatement insert = s.prepare(&lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT INTO test.test_table_sec (id, sec) VALUES (1, ?)&quot;&lt;/span&gt;);		
		&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; 1000; i++)
			s.execute(insert.bind((&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;) i));
		
		PreparedStatement select = s.prepare(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT sec FROM test.test_table_sec WHERE id = 1&quot;&lt;/span&gt;);
		
		&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; lastSec = -1;		
		&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Row row : s.execute(select.bind().setFetchSize(300)))
		{
			&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; sec = row.getLong(&lt;span class=&quot;code-quote&quot;&gt;&quot;sec&quot;&lt;/span&gt;);
			&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (sec == lastSec)
				&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;Duplicated id %d&quot;&lt;/span&gt;, sec));
			
			lastSec = sec;
		}
		&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.exit(0);
	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The program outputs the following:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Duplicated id 23
Duplicated id 192
Duplicated id 684
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that the simple primary key is required to reproduce this.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Tested with C* 3.9 and 3.10.&lt;/p&gt;</environment>
        <key id="13048565">CASSANDRA-13302</key>
            <summary>last row of previous page == first row of next page while querying data using SASI index</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ifesdjeen">Alex Petrov</assignee>
                                    <reporter username="andrew.tolbert">Andy Tolbert</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Mar 2017 16:03:41 +0000</created>
                <updated>Sun, 1 Aug 2021 11:18:02 +0000</updated>
                            <resolved>Fri, 12 May 2017 07:53:50 +0000</resolved>
                                        <fixVersion>3.11.7</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15959059" author="ifesdjeen" created="Thu, 6 Apr 2017 15:06:51 +0000"  >&lt;p&gt;Attaching a simple patch and test reproducing the problem with paging. It is happening only in tables without clustering, because of the left bound inclusion on subsequent pages.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ifesdjeen:13379-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-13379-trunk-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/ifesdjeen/job/ifesdjeen-13379-trunk-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15962882" author="adelapena" created="Mon, 10 Apr 2017 13:47:36 +0000"  >&lt;p&gt;The patch looks good to me, +1. There are some unused imports in &lt;tt&gt;SASICQLTest&lt;/tt&gt; that can be removed while committing the patch.&lt;/p&gt;</comment>
                            <comment id="16007764" author="ifesdjeen" created="Fri, 12 May 2017 07:53:35 +0000"  >&lt;p&gt;Thank you for the review! I&apos;ve fixed the imports on commit as you have suggested. &lt;/p&gt;

&lt;p&gt;Committed to 3.11 with &lt;a href=&quot;https://github.com/apache/cassandra/commit/9723db27171c014911a8a3f2b0db9454a91dd936&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;9723db27171c014911a8a3f2b0db9454a91dd936&lt;/a&gt; and merged up to &lt;a href=&quot;https://github.com/apache/cassandra/commit/c7b77eb60b56ec612622809fa871919cacd91a43&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13059244">CASSANDRA-13379</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12941173">CASSANDRA-11208</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="13056295">CASSANDRA-13332</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 27 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3b053:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>adelapena</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[adelapena]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>