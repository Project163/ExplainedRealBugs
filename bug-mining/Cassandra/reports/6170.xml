<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:26:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-12525] When adding new nodes to a cluster which has authentication enabled, we end up losing cassandra user&apos;s current crendentials and they get reverted back to default cassandra/cassandra credentials</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-12525</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Made the following observation:&lt;/p&gt;

&lt;p&gt;When adding new nodes to an existing C* cluster with authentication enabled we end up loosing password information about `cassandra` user. &lt;/p&gt;

&lt;p&gt;Initial Setup&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Create a 5 node cluster with system_auth having RF=5 and NetworkTopologyStrategy&lt;/li&gt;
	&lt;li&gt;Enable PasswordAuthenticator on this cluster and update the password for &apos;cassandra&apos; user to say &apos;password&apos; via the alter query&lt;/li&gt;
	&lt;li&gt;Make sure you run nodetool repair on all the nodes&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Test case&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Now go ahead and add 5 more nodes to this cluster.&lt;/li&gt;
	&lt;li&gt;Run nodetool repair on all the 10 nodes now&lt;/li&gt;
	&lt;li&gt;Decommission the original 5 nodes such that only the new 5 nodes are in the cluster now&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Run cqlsh and try to connect to this cluster using old user name and password, cassandra/password&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I was unable to connect to the nodes with the original credentials and was only able to connect using the default cassandra/cassandra credentials&lt;/p&gt;

&lt;p&gt;From the conversation over IIRC&lt;/p&gt;

&lt;p&gt;`beobal: sood: that definitely shouldn&apos;t happen. The new nodes should only create the default superuser role if there are 0 roles currently defined (including that default one)`&lt;/p&gt;</description>
                <environment></environment>
        <key id="12999303">CASSANDRA-12525</key>
            <summary>When adding new nodes to a cluster which has authentication enabled, we end up losing cassandra user&apos;s current crendentials and they get reverted back to default cassandra/cassandra credentials</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xgerman42">German Eichberger</assignee>
                                    <reporter username="asood">Atin Sood</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Aug 2016 17:32:10 +0000</created>
                <updated>Tue, 12 Sep 2023 13:02:48 +0000</updated>
                            <resolved>Wed, 18 Jan 2023 14:29:53 +0000</resolved>
                                        <fixVersion>3.0.29</fixVersion>
                    <fixVersion>3.11.15</fixVersion>
                    <fixVersion>4.0.8</fixVersion>
                    <fixVersion>4.1.1</fixVersion>
                    <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Cluster/Schema</component>
                    <component>Local/Config</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>11</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="11400">3h 10m</timespent>
                                <comments>
                            <comment id="15451550" author="beobal" created="Wed, 31 Aug 2016 08:17:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=asood&quot; class=&quot;user-hover&quot; rel=&quot;asood&quot;&gt;asood&lt;/a&gt;: sorry I&apos;m a bit late asking this, but do you have the logs collected during this period (in particular, the logs from the 5 new nodes would be useful here).&lt;/p&gt;</comment>
                            <comment id="15454064" author="asood" created="Thu, 1 Sep 2016 02:22:30 +0000"  >&lt;p&gt;Sam, unfortunately don&apos;t have these handy ATM, but let me try to get these by next week. We were able to consistently replicate this and have the cluster handy in dev, so let me get you the logs as soon as I free up from my day to day work.&lt;/p&gt;

&lt;p&gt;Appreciate you looking into this.&lt;/p&gt;</comment>
                            <comment id="17634535" author="JIRAUSER298386" created="Tue, 15 Nov 2022 21:30:31 +0000"  >&lt;p&gt;We were able to reliably reproduce this issue on C* 4.0.5&lt;/p&gt;

&lt;p&gt;Our steps:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Create DC 1 with say 3 nodes&lt;/li&gt;
	&lt;li&gt;Set a password for the cassandra user&lt;/li&gt;
	&lt;li&gt;Create other users, etc.&lt;/li&gt;
	&lt;li&gt;Add another DC DC2
	&lt;ol&gt;
		&lt;li&gt;We observe in I think 3.11 cassandra logs (4.0 is similar)&#160; for the first node brought up on the new DC:&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;source_file &#160; &#160;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&#160;source_line&#160;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;message&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;CassandraRoleManager.java&#160;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;374 &#160;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&#160;Created default superuser role &apos;cassandra&apos;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;ol&gt;
	&lt;li&gt;Then we run a full repair on system_auth so other users propagate from DC1 to DC2&lt;/li&gt;
	&lt;li&gt;Result: cassandra user has original casssandra password&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;We also have seen this sporadically in C* 3.11.13&lt;/p&gt;

&lt;p&gt;I believe there is some race conditions where that first node believes it&apos;s the only node in the cluster and ignores the other DC Our expectation is that this code does not run for the second data center and if it needs to run, a simple fix might be to set the write_time to epoch 0 or something so a subsequent repair overwrites it.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;A workaround is deleting the system_auth on the node in question but this still exposes the node to being accessed with the default password for a short period of time&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17640951" author="brandon.williams" created="Tue, 29 Nov 2022 21:39:59 +0000"  >&lt;p&gt;Linking German&apos;s PR that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mck&quot; class=&quot;user-hover&quot; rel=&quot;mck&quot;&gt;mck&lt;/a&gt; pointed me to, thanks!&lt;/p&gt;

&lt;p&gt;I think this approach makes sense, effectively making the automatic creation idempotent. WDYT, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt;? (I think we should still check the 4.0.5 bug described though.)&lt;/p&gt;</comment>
                            <comment id="17641811" author="beobal" created="Thu, 1 Dec 2022 10:24:31 +0000"  >&lt;p&gt;Seems like a sensible solution to me.&lt;/p&gt;</comment>
                            <comment id="17643180" author="smiklosovic" created="Mon, 5 Dec 2022 09:24:30 +0000"  >&lt;p&gt; I put some comments in PR.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xgerman42&quot; class=&quot;user-hover&quot; rel=&quot;xgerman42&quot;&gt;xgerman42&lt;/a&gt; could you please move this to &quot;patch available&quot; so I can review it formally etc? We should follow Jira workflow here.&lt;/p&gt;</comment>
                            <comment id="17643549" author="JIRAUSER298386" created="Mon, 5 Dec 2022 20:42:42 +0000"  >&lt;p&gt;I am sorry for all the mistakes. This is my first patch so still learning the process...&lt;/p&gt;</comment>
                            <comment id="17643920" author="smiklosovic" created="Tue, 6 Dec 2022 15:18:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xgerman42&quot; class=&quot;user-hover&quot; rel=&quot;xgerman42&quot;&gt;xgerman42&lt;/a&gt; I think we should do a test you described in the description of this ticket to be sure that it works. The test currently in place just checks if these timestamps are 0 / are same. It would be nice to have more &quot;real world&quot; test here if you do not mind. The test you did consists of 10 nodes together. I do not think that is necessary. What is the minimal amount of nodes you are able to reproduce this problem on? Do 2 nodes  work as well?&lt;/p&gt;</comment>
                            <comment id="17644897" author="smiklosovic" created="Thu, 8 Dec 2022 17:03:28 +0000"  >&lt;p&gt;Hi again &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xgerman42&quot; class=&quot;user-hover&quot; rel=&quot;xgerman42&quot;&gt;xgerman42&lt;/a&gt; ,&lt;/p&gt;

&lt;p&gt;I wanted to replicate your issue locally but I was not able to do that. I used 3 nodes per dc in two dc&apos;s (6 nodes in total).&lt;/p&gt;

&lt;p&gt;I was also checking the logic when it comes to role creation (1) and (2). What it does is that it will create local cassandra role only in case it is nowhere to be found. First it checks with consistency level ONE, if it is not there, it will check with QUORUM CL. I put more debugging to that and every time it executed only query with ONE and it saw that cassandra role is there and it just moved on.&lt;/p&gt;

&lt;p&gt;The only ever case when cassandra role was created was when I started the very first node in dc1. The fact that you see cassandra role creation in other node in the second dc is very interesting. I am not completely sure how you got that behavior.&lt;/p&gt;

&lt;p&gt;There is also this (3), it will postpone the check of (1) for 10 seconds. So what could in theory happen is that the node did not see any peers in this window of 10 seconds which means that it evaluated that it is alone in the cluster (all conditions in (1) were evaluated as true (and false as they were negated)). This is the most reasonable explanation why you see this from time to time.&lt;/p&gt;

&lt;p&gt;The interesting consequence of that logic in (3) is that it can not be blocking because that node about to start does not know in advance if it is going to be the only one in the cluster or not. The delay is controlled by system property (4)  so you could pro-actively increase this to some higher value, like 30 seconds to minimize the chance that this might happen.&lt;/p&gt;

&lt;p&gt;To improve this, we might make the default waiting time bigger but that is not solving it entirely, we are just kicking the can down the road here.&lt;/p&gt;

&lt;p&gt;So if we can not completely prevent this, the next best option is to do what you suggested.&lt;/p&gt;

&lt;p&gt;Is not there any third, better way? What about waiting on &lt;em&gt;something&lt;/em&gt; in that scheduled tasked, postponed to 10s by default, to wait for something which is not initialized fully yet? The fact that these peers are not there yet seems like Gossip did not have a chance to see the topology fully yet? &lt;/p&gt;

&lt;p&gt;(1) &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/auth/CassandraRoleManager.java#L351-L356&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/auth/CassandraRoleManager.java#L351-L356&lt;/a&gt;&lt;br/&gt;
(2) &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/auth/CassandraRoleManager.java#L376-L384&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/auth/CassandraRoleManager.java#L376-L384&lt;/a&gt;&lt;br/&gt;
(3) &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/auth/CassandraRoleManager.java#L386-L405&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/auth/CassandraRoleManager.java#L386-L405&lt;/a&gt;&lt;br/&gt;
(4) &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/auth/AuthKeyspace.java#L58&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/auth/AuthKeyspace.java#L58&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17644898" author="brandon.williams" created="Thu, 8 Dec 2022 17:06:38 +0000"  >&lt;p&gt;I don&apos;t think a third way precludes also adding the protection that creating the user in an idempotent manner grants.  We can do both.  &lt;/p&gt;</comment>
                            <comment id="17644920" author="JIRAUSER298386" created="Thu, 8 Dec 2022 17:42:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt;&#160; it&apos;s best practice after adding a second DC to run a (full) repair of the system_auth keyspace so with my patch this will effectively mitigate the issue for most people.&lt;/p&gt;

&lt;p&gt;Also consider this scenario:&lt;br/&gt;
1. We bring up DC 1 in network A and change the cassandra user&apos;s password&lt;/p&gt;

&lt;p&gt;2. We bring up DC 2 on network B - but due to some error the networks are not connected&lt;/p&gt;

&lt;p&gt;3. We discover our error and connect network A and B so the DCs can see each other&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In this case DC2 would not know that there is another DC (someone might just have misconfigured seed nodes) until the connection is established.To help with this scenario (other than my patch and repair) we would need some command line parameter so an operator can skip the initial role generation...&lt;/p&gt;</comment>
                            <comment id="17644958" author="smiklosovic" created="Thu, 8 Dec 2022 19:50:03 +0000"  >&lt;p&gt;Ok lets to this then. I would not increase default delay for that system property. If we kept increasing this and other time that property, after a while all the &quot;waitings&quot; together would slow-downed the overall startup unbearably.&lt;/p&gt;

&lt;p&gt;For your scenario, maybe I am completely wrong here, but I would expect that nodes in dc2 would have as a seed a node from dc1. So the startup should not even propagate that far to create the default role. It should not even start if it can not see any seeds.&lt;/p&gt;

&lt;p&gt;To test this, we could do this then with 2 nodes only. Start the first, change the password, partition the network, start the second and it should create the default role and then start the first node and repair the second. You should be able to connect to the second node with the changed password.&lt;/p&gt;

&lt;p&gt;To partition the network, there are already some examples how to drop the communication, start to take a look at this (1) and you eventually figure it out.&lt;/p&gt;

&lt;p&gt;Please, tell me if it is too much for you to do this. We would be glad if you figured it out, if you dont we are here to help to guide you. We are trying to guide new contributors so they will be more comfortable here.&lt;/p&gt;

&lt;p&gt;(1) &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/test/distributed/org/apache/cassandra/distributed/shared/ClusterUtils.java#L124&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/trunk/test/distributed/org/apache/cassandra/distributed/shared/ClusterUtils.java#L124&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="17652972" author="JIRAUSER298386" created="Thu, 29 Dec 2022 23:31:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt;&#160; Sorry for the delayed response. I added the test with the two data centers.&lt;/p&gt;

&lt;p&gt;The error condition is only hit when the new node is in the seed node list which changes the behavior of the shadow round - otherwise startup will fail there and not get to messing up the system_auth keyspace.&lt;/p&gt;

&lt;p&gt;Adding all potential seed nodes to casandra.yaml is common practice to avoid carefully managing the list for each node...&lt;/p&gt;</comment>
                            <comment id="17656032" author="smiklosovic" created="Mon, 9 Jan 2023 11:00:07 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xgerman42&quot; class=&quot;user-hover&quot; rel=&quot;xgerman42&quot;&gt;xgerman42&lt;/a&gt; ,&lt;/p&gt;

&lt;p&gt;thanks for being so persistent!&lt;/p&gt;

&lt;p&gt;I have checked your latest changes and the test is not doing what I was mentioning in my last comment. My suggestion was:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;start the first node (done)&lt;/li&gt;
	&lt;li&gt;change the password (not done)&lt;/li&gt;
	&lt;li&gt;partition the network (done)&lt;/li&gt;
	&lt;li&gt;start the second node (done)&lt;/li&gt;
	&lt;li&gt;check that it created the default role (not done)&lt;/li&gt;
	&lt;li&gt;&quot;unpartition&quot; the network (not done)&lt;/li&gt;
	&lt;li&gt;repair the second node (not done)&lt;/li&gt;
	&lt;li&gt;you should be able to connect to the second node with the changed password (not done)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Doing CQL against a node can be done through Cassandra Java driver (logging in, changing password ...). Repairing of the node can be done via nodetool. There is &quot;nodetool&quot; method on IInstance you get from calling cluster.get like &quot;cluster.get(2).nodetool(&quot;repair&quot;)&quot;. You got the idea.&lt;/p&gt;

&lt;p&gt;Do you plan to finish this or do you have any other idea how how to test this differently? I humbly think the approach I outlined is the most comprehensive in order to mimic the real-world usage here.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="17656461" author="smiklosovic" created="Tue, 10 Jan 2023 07:05:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xgerman42&quot; class=&quot;user-hover&quot; rel=&quot;xgerman42&quot;&gt;xgerman42&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I was thinking about this a little bit more lately and I will try to jump in to fill the gaps, if you do not mind. I have to admit that it might be little bit off-putting to jump through all these hurdles suddenly at once. Also, maybe we realize that, for some reason, the steps I suggested are not entirely correct (might happen, right!?) and we would just kill more time on this than necessary.&lt;/p&gt;</comment>
                            <comment id="17656730" author="JIRAUSER298386" created="Tue, 10 Jan 2023 17:58:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt;&#160; I really learned a lot writing those tests (would have never imagined that by adding the node&apos;s ip to the seed node list the behavior of bootstrap would change) - so super helpful. Though eventually I like to do more substantial work currently I just don&apos;t have the time.&#160; Especially, I feel for implementing the changes you suggest I would need to change the way the tests work - for instance `cluster.coordinator(1).execute` doesn&apos;t use an admin context so there is some refactoring required to make it roles aware and in my opinion this is the right way forward. But that likely requires refactoring and design work and is a bigger conversation than CAAS-12525.&lt;/p&gt;

&lt;p&gt;In any case curious how you implement the changes and I am sure I can learn a lot by looking over your shoulder/studying the PR.&lt;/p&gt;</comment>
                            <comment id="17675633" author="smiklosovic" created="Wed, 11 Jan 2023 16:05:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xgerman42&quot; class=&quot;user-hover&quot; rel=&quot;xgerman42&quot;&gt;xgerman42&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;please find the patch here: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2085/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2085/files&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I took what you did and finished the test, also all changes are squashed into one commit. Please go through it and verify my logic is correct. We might then ask for the second review.&lt;/p&gt;</comment>
                            <comment id="17675678" author="JIRAUSER298386" created="Wed, 11 Jan 2023 18:53:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; this looks great - especially the use of the cql client.&lt;/p&gt;</comment>
                            <comment id="17675681" author="brandon.williams" created="Wed, 11 Jan 2023 19:09:28 +0000"  >&lt;p&gt;LGTM, I think we just need to run CI.&lt;/p&gt;</comment>
                            <comment id="17675939" author="smiklosovic" created="Thu, 12 Jan 2023 10:43:24 +0000"  >&lt;p&gt;PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/2085/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2085/files&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;j8 pre-commit &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1701/workflows/6adcd572-b3dd-4f9f-af86-4f20f78d36d8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1701/workflows/6adcd572-b3dd-4f9f-af86-4f20f78d36d8&lt;/a&gt;&lt;br/&gt;
j11 pre-commit &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1701/workflows/314b5982-03a2-464a-ad07-d697261847cd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1701/workflows/314b5982-03a2-464a-ad07-d697261847cd&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;failing tests in j8 are &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17708&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-17708&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17819&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-17819&lt;/a&gt; (there is ongoing discussion about possible re-opening of this ticket as it started to fail for more people lately)&lt;br/&gt;
failing testForcedNormalRepairWithOneNodeDown is mentioned here &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-14752&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-14752&lt;/a&gt; but it was evaluated as not-related which is probably the same here, it seems it does not have dedicated ticket yet, I may create it.&lt;/p&gt;

&lt;p&gt;test was run repeatedly too&lt;/p&gt;</comment>
                            <comment id="17675940" author="smiklosovic" created="Thu, 12 Jan 2023 10:50:59 +0000"  >&lt;p&gt;ah wait a minute, we need to fix this from 3.0 up, right? &lt;/p&gt;</comment>
                            <comment id="17675968" author="brandon.williams" created="Thu, 12 Jan 2023 11:58:02 +0000"  >&lt;p&gt;Sorry, I meant &apos;branch and run CI&apos;, if you are keen to fix it in all the branches.&lt;/p&gt;</comment>
                            <comment id="17675969" author="smiklosovic" created="Thu, 12 Jan 2023 11:59:09 +0000"  >&lt;p&gt;Yeah I&apos;ll backport that. It seems to be very easy patch.&lt;/p&gt;</comment>
                            <comment id="17676932" author="smiklosovic" created="Sat, 14 Jan 2023 16:43:16 +0000"  >&lt;p&gt;3.0 &lt;a href=&quot;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch/2185/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch/2185/&lt;/a&gt;&lt;br/&gt;
3.11 &lt;a href=&quot;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch/2186/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch/2186/&lt;/a&gt;&lt;br/&gt;
4.0 &lt;a href=&quot;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch/2190/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch/2190/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4.1&lt;br/&gt;
j8 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1714/workflows/aa3cd518-a827-43b4-b378-2b5ba31759c0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1714/workflows/aa3cd518-a827-43b4-b378-2b5ba31759c0&lt;/a&gt;&lt;br/&gt;
j11 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1714/workflows/bbb07956-0556-4154-bf7d-cde850bd2a1f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1714/workflows/bbb07956-0556-4154-bf7d-cde850bd2a1f&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;trunk&lt;br/&gt;
j8 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1701/workflows/6adcd572-b3dd-4f9f-af86-4f20f78d36d8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1701/workflows/6adcd572-b3dd-4f9f-af86-4f20f78d36d8&lt;/a&gt;&lt;br/&gt;
j11 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1701/workflows/314b5982-03a2-464a-ad07-d697261847cd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/1701/workflows/314b5982-03a2-464a-ad07-d697261847cd&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-12525-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/instaclustr/cassandra/tree/CASSANDRA-12525-3.0&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-12525-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/instaclustr/cassandra/tree/CASSANDRA-12525-3.11&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-12525-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/instaclustr/cassandra/tree/CASSANDRA-12525-4.0&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-12525-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/instaclustr/cassandra/tree/CASSANDRA-12525-4.1&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-12525&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/instaclustr/cassandra/tree/CASSANDRA-12525&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17677666" author="smiklosovic" created="Tue, 17 Jan 2023 08:34:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; I am waiting patiently for your explicit +1. I think I run multiplexer only for trunk but I consider that to be enough as it is exactly same test.&lt;/p&gt;</comment>
                            <comment id="17677766" author="brandon.williams" created="Tue, 17 Jan 2023 13:36:09 +0000"  >&lt;p&gt;Thanks for your patience, yesterday was a holiday in the US.  +1, I too am fine with a multiplexer run on a single branch.&lt;/p&gt;</comment>
                            <comment id="17678264" author="smiklosovic" created="Wed, 18 Jan 2023 14:30:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xgerman42&quot; class=&quot;user-hover&quot; rel=&quot;xgerman42&quot;&gt;xgerman42&lt;/a&gt; thanks for your contribution. Keep them coming!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[xgerman42]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 42 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32nwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12334609">3.3</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
        <customfieldvalue><![CDATA[smiklosovic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333891">3.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/8ecd7616fe5d3ce0cfe8f4621eda1905a9110db1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/8ecd7616fe5d3ce0cfe8f4621eda1905a9110db1&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;clean CI and passed added test + manual test&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>