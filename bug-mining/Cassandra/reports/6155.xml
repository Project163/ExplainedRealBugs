<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:26:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-18055] Nodetool Compact set the compaction type incorrectly</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-18055</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;When using nodetool compactionstats to see what does the c*&apos;s compactions are doing ,the output has got a column named &quot;compaction type&quot;, but It seem that major compaction and minor compaction &apos;s type are all name Compaction, after read the code I found that may be the the MAJOR_COMPACTION OperationType is not setted into AbstractCompactionTask  &lt;br/&gt;
at this method : CompactionStrategyManager -&amp;gt; getMaximalTasks .When we peform a major compact without any arguments we will got this execute path : &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// Some comments here
&lt;/span&gt;Compact.java : probe.forceKeyspaceCompaction(splitOutput, keyspace, tableNames);
---&amp;gt;
 ColumnFamilyStore.java :  cfStore.forceMajorCompaction(splitOutput);
---&amp;gt; 
CompactionManager.java : submitMaximal(cfStore, gcBefore, splitOutput, OperationType.MAJOR_COMPACTION); 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 
&lt;p&gt;Unfortunately OperationType.MAJOR_COMPACTION is not rightly setted.&lt;/p&gt;


&lt;p&gt;see the picture on the right I perform a major compact , and on the left the compactionstats show the type is only Compaction ;&lt;br/&gt;
I think it is import for us to know wether the task is a major or a minor .&lt;/p&gt;


</description>
                <environment></environment>
        <key id="13502920">CASSANDRA-18055</key>
            <summary>Nodetool Compact set the compaction type incorrectly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="maxwellguo">guo Maxwell</assignee>
                                    <reporter username="maxwellguo">guo Maxwell</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Nov 2022 16:01:36 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:53 +0000</updated>
                            <resolved>Wed, 7 Dec 2022 11:27:32 +0000</resolved>
                                        <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Local/Compaction</component>
                    <component>Tool/nodetool</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4200">1h 10m</timespent>
                                <comments>
                            <comment id="17635348" author="maxwellguo" created="Thu, 17 Nov 2022 13:11:52 +0000"  >&lt;p&gt;I just add one ut for this patch , the ut just perform a major without range /dk specified. and I found it not easy to add test for this because when perform a major at one time and the compactionstast at another time ,the compaction task may just finished before the compactionstast command finished its&apos;s execution. &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stefan.miklosovic&quot; class=&quot;user-hover&quot; rel=&quot;stefan.miklosovic&quot;&gt;stefan.miklosovic&lt;/a&gt; can you give some advice on this patch ? or just help to have a look on this&lt;/p&gt;</comment>
                            <comment id="17635384" author="brandon.williams" created="Thu, 17 Nov 2022 14:41:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maxwellguo&quot; class=&quot;user-hover&quot; rel=&quot;maxwellguo&quot;&gt;maxwellguo&lt;/a&gt; can you link the patch to this ticket?&lt;/p&gt;</comment>
                            <comment id="17635594" author="maxwellguo" created="Fri, 18 Nov 2022 02:02:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; wait ,just one failed test case.&lt;/p&gt;
</comment>
                            <comment id="17635702" author="maxwellguo" created="Fri, 18 Nov 2022 07:16:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;PR : &lt;a href=&quot;https://github.com/apache/cassandra/pull/2022&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2022&lt;/a&gt;&lt;br/&gt;
CI : Java-8 precommit : &lt;a href=&quot;https://app.circleci.com/pipelines/github/Maxwell-Guo/cassandra/337/workflows/9a8d11af-25cc-4ecf-aaed-b957f6653696&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/Maxwell-Guo/cassandra/337/workflows/9a8d11af-25cc-4ecf-aaed-b957f6653696&lt;/a&gt;&lt;br/&gt;
       Java-11 precommit : &lt;a href=&quot;https://app.circleci.com/pipelines/github/Maxwell-Guo/cassandra/337/workflows/3b713125-569c-4d05-969c-dedb0aa34f47&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/Maxwell-Guo/cassandra/337/workflows/3b713125-569c-4d05-969c-dedb0aa34f47&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17642048" author="brandon.williams" created="Thu, 1 Dec 2022 16:50:38 +0000"  >&lt;p&gt;I reran your PR through CI, including a repeated test for CompactionTaskTest: &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/710/workflows/7a9c4adb-aa8d-4c48-8f32-6f878e1c63fc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/710/workflows/ab31cc66-501a-4998-95fe-79a2da11166f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;. Everything passed and looks good to me.&lt;/p&gt;</comment>
                            <comment id="17642241" author="maxwellguo" created="Fri, 2 Dec 2022 02:40:51 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;.&lt;br/&gt;
Is there something we should do before this patch can be checkin ? Need another one to review and +1 ?  &lt;/p&gt;</comment>
                            <comment id="17642243" author="brandon.williams" created="Fri, 2 Dec 2022 02:46:32 +0000"  >&lt;p&gt;Correct.&lt;/p&gt;</comment>
                            <comment id="17642249" author="edimitrova" created="Fri, 2 Dec 2022 03:16:56 +0000"  >&lt;p&gt;Ok, so do we consider this trunk improvement or a bug we plan to fix also in other branches?&lt;br/&gt;
I can probably take a look tomorrow if no one gets to it before me. &lt;/p&gt;</comment>
                            <comment id="17642279" author="maxwellguo" created="Fri, 2 Dec 2022 04:49:49 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;, I think trunk improvement is ok ? what is your opinion&#65311; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17642466" author="brandon.williams" created="Fri, 2 Dec 2022 12:04:30 +0000"  >&lt;p&gt;Since this isn&apos;t strictly a cosmetic fix, I was thinking going to trunk only would be fine since nobody was pushing for other branches.  If someone ever does want a backport later, they&apos;ll have the benefit of additional testing from being in trunk first.&lt;/p&gt;</comment>
                            <comment id="17643579" author="edimitrova" created="Mon, 5 Dec 2022 22:14:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=barnie&quot; class=&quot;user-hover&quot; rel=&quot;barnie&quot;&gt;barnie&lt;/a&gt;, do you mind to take a look into this small patch, please? &lt;/p&gt;</comment>
                            <comment id="17643910" author="maxwellguo" created="Tue, 6 Dec 2022 15:08:06 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=barnie&quot; class=&quot;user-hover&quot; rel=&quot;barnie&quot;&gt;barnie&lt;/a&gt;  I have update the patch again after your comment.&lt;/p&gt;</comment>
                            <comment id="17643944" author="blambov" created="Tue, 6 Dec 2022 16:23:40 +0000"  >&lt;p&gt;The patch looks good to me.&lt;/p&gt;</comment>
                            <comment id="17644090" author="maxwellguo" created="Wed, 7 Dec 2022 02:23:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blambov&quot; class=&quot;user-hover&quot; rel=&quot;blambov&quot;&gt;blambov&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt;Thanks ~~~&lt;/p&gt;</comment>
                            <comment id="17644159" author="maxwellguo" created="Wed, 7 Dec 2022 06:38:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blambov&quot; class=&quot;user-hover&quot; rel=&quot;blambov&quot;&gt;blambov&lt;/a&gt; all + 1 on this patch . So I think it is ready to commit &lt;/p&gt;</comment>
                            <comment id="17644285" author="brandon.williams" created="Wed, 7 Dec 2022 11:27:32 +0000"  >&lt;p&gt;Committed, thanks everyone!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13052284" name="20221116235846.jpg" size="200674" author="maxwellguo" created="Wed, 16 Nov 2022 15:59:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[maxwellguo]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 48 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1c7o8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
        <customfieldvalue><![CDATA[blambov]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348835">NA</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/3f83396b76115a25b8189410c68775f87f31f8ac&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/3f83396b76115a25b8189410c68775f87f31f8ac&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;ut and dt&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>