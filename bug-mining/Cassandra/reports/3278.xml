<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:49:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-8452] Add missing systems to FBUtilities.isUnix, add FBUtilities.isWindows</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-8452</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;The isUnix method leaves out a few unix systems, which, after the changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8136&quot; title=&quot;Windows Service never finishes shutting down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8136&quot;&gt;&lt;del&gt;CASSANDRA-8136&lt;/del&gt;&lt;/a&gt;, causes some unexpected behavior during shutdown. It would also be clearer if FBUtilities had an isWindows method for branching into Windows specific logic.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12760614">CASSANDRA-8452</key>
            <summary>Add missing systems to FBUtilities.isUnix, add FBUtilities.isWindows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bdeggleston">Blake Eggleston</assignee>
                                    <reporter username="bdeggleston">Blake Eggleston</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Dec 2014 00:58:32 +0000</created>
                <updated>Wed, 15 Oct 2025 09:49:04 +0000</updated>
                            <resolved>Mon, 15 Dec 2014 17:37:32 +0000</resolved>
                                        <fixVersion>2.1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14241078" author="jmckenzie" created="Wed, 10 Dec 2014 13:25:46 +0000"  >&lt;p&gt;Check out v2 on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6993&quot; title=&quot;Windows: remove mmap&amp;#39;ed I/O for index files and force standard file access&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6993&quot;&gt;&lt;del&gt;CASSANDRA-6993&lt;/del&gt;&lt;/a&gt; as well as Benedict&apos;s comment about it.  We should probably change the call to &quot;isPosixCompliant&quot; and compute and store the boolean at static init time and just reference that rather than strcmp every time we want to check it.&lt;/p&gt;</comment>
                            <comment id="14242720" author="bdeggleston" created="Thu, 11 Dec 2014 15:55:08 +0000"  >&lt;p&gt;It looks like there&apos;s already a patch in the works for 2.1 in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6993&quot; title=&quot;Windows: remove mmap&amp;#39;ed I/O for index files and force standard file access&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6993&quot;&gt;&lt;del&gt;CASSANDRA-6993&lt;/del&gt;&lt;/a&gt;, &lt;br/&gt;
should I close this as a duplicate?&lt;/p&gt;

&lt;p&gt;If not, +1 on calculating at startup and calling it posix. The v2 patch attached determines OS on class initialization, and renames &lt;tt&gt;isUnix&lt;/tt&gt; to &lt;tt&gt;isPosix&lt;/tt&gt;. It also replaces a few &lt;tt&gt;!FBUtilities.isUnix()&lt;/tt&gt; with &lt;tt&gt;FBUtilities.isWindows()&lt;/tt&gt; where the comments indicate that the check is being done to support windows. Also, imo isPosix implies that the system is posix compliant, so I just changed it to isPosix, but lemme know if isPosixCompliant is strongly preferred, and I&apos;ll rename it.&lt;/p&gt;</comment>
                            <comment id="14242969" author="jmckenzie" created="Thu, 11 Dec 2014 19:09:19 +0000"  >&lt;p&gt;I&apos;m not sure if &quot;isPosix&quot; is correct in retrospect (&lt;a href=&quot;http://en.wikipedia.org/wiki/POSIX#POSIX-oriented_operating_systems&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;reference&lt;/a&gt;).  Not only are we not actually checking if something&apos;s truly posix compliant (though being mostly compliant serves our needs for now...), but our checks are more oriented around granular platform-specific differences, i.e. whether or not the underlying filesystem is an ext/hfs vs. ntfs, or whether or not the platform has a /proc filesystem  (Note: I don&apos;t think the /proc filesystem is actually defined in the posix standard (&lt;a href=&quot;http://pubs.opengroup.org/onlinepubs/9699919799/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;reference 2&lt;/a&gt;)).&lt;/p&gt;

&lt;p&gt;While having methods like &apos;isNTFS&apos; or &apos;hasProcFilesystem&apos; would be arguably more correct, at this point if we slice the eco-sytem into &quot;Windows&quot; vs. &quot;non-Windows&quot; it seems like it would satisfy our requirements.  I could be off on that though - do we have areas in the code-base where we support specific sub-types of the *nix world w/different checks?  i.e. is cassandra run on any systems that are currently missing a /proc filesystem, or have wacky hard-link behavior so early re-open is a problem, etc?&lt;/p&gt;</comment>
                            <comment id="14243498" author="bdeggleston" created="Fri, 12 Dec 2014 00:46:37 +0000"  >&lt;p&gt;Well I&apos;m glad you brought up procfs, since it turns out osx doesn&apos;t have one. The rest of the posix systems we&apos;re checking for do &lt;a href=&quot;http://en.wikipedia.org/wiki/Procfs&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;according to wikipedia &lt;/a&gt;. I guess adding hasProcFS would make some sense, just for the sake of being correct. At the moment, it only affects whether some warnings are logged. Basically we eagerly try to open a proc file, and use isPosix to see if we should log anything if that fails. Relying on isPosix alone causes erroneous startup warnings in mac dev environments. &lt;/p&gt;

&lt;p&gt;I would think isWindows is enough for ntfs specific logic. Linux &lt;em&gt;can&lt;/em&gt; mount and write to ntfs disks, but I&apos;m don&apos;t know how common it is for C* to be using it, outside of maybe some dual boot dev environments. I also not as clear if it would have the same behaviors we&apos;re coding around with isWindows. It&apos;s written against a spec that was reverse engineered from the Windows implementation.&lt;/p&gt;</comment>
                            <comment id="14244539" author="jmckenzie" created="Fri, 12 Dec 2014 18:09:26 +0000"  >&lt;p&gt;I&apos;m comfortable with the position that if you run cassandra on linux w/ntfs you&apos;re in uncharted territory and we make no promises.  Naming the checks &apos;isWindows&apos; and &apos;hasProcFS&apos; seems like the most granular / correct combination of things for our current needs and we could expand from there later as needs dictate.&lt;/p&gt;</comment>
                            <comment id="14244543" author="bdeggleston" created="Fri, 12 Dec 2014 18:12:04 +0000"  >&lt;p&gt;+1, sounds good to me. The v3 patch should cover all the bases then.&lt;/p&gt;</comment>
                            <comment id="14244552" author="jmckenzie" created="Fri, 12 Dec 2014 18:22:29 +0000"  >&lt;p&gt;The failure / check on maybeReopenEarly isn&apos;t about whether it&apos;s posix or not but about whether it&apos;s ntfs (and pre-nio technically, though we&apos;re all-or-nothing windows on 2.1).  Is there a reason we shouldn&apos;t reduce this to isWindows and hasProcFS checks and move forward with the assumption of posix-compliance if not Windows, given the platforms we run on?&lt;/p&gt;

&lt;p&gt;Seems unnecessary to have the isPosix structure simply to add that to the check on the fs for proc.&lt;/p&gt;</comment>
                            <comment id="14244862" author="bdeggleston" created="Fri, 12 Dec 2014 22:02:46 +0000"  >&lt;p&gt;Ah, I didn&apos;t realize that about maybeReopenEarly. In that case, no reason to keep isPosix around. Anyway, I think it&apos;s a reasonable convention to assume we&apos;re on linux, and check for specific deviations where appropriate, since that&apos;s the primary environment we target.&lt;/p&gt;

&lt;p&gt;Attached v4&lt;/p&gt;</comment>
                            <comment id="14246878" author="jmckenzie" created="Mon, 15 Dec 2014 17:37:32 +0000"  >&lt;p&gt;committed - thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12707042">CASSANDRA-6993</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12686609" name="CASSANDRA-8452-v2.patch" size="6634" author="bdeggleston" created="Thu, 11 Dec 2014 15:55:08 +0000"/>
                            <attachment id="12686733" name="CASSANDRA-8452-v3.patch" size="6844" author="bdeggleston" created="Fri, 12 Dec 2014 00:46:37 +0000"/>
                            <attachment id="12686958" name="CASSANDRA-8452-v4.patch" size="6450" author="bdeggleston" created="Fri, 12 Dec 2014 22:02:46 +0000"/>
                            <attachment id="12686167" name="CASSANDRA-8452.patch" size="2072" author="bdeggleston" created="Wed, 10 Dec 2014 01:01:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bdeggleston]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 49 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2397z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>joshuamckenzie</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[joshuamckenzie]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12328841">2.1.2</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>