<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:07:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-12929] Fix version check to enable streaming keep-alive</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-12929</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;example failure:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/job/trunk_novnode_dtest/494/testReport/bootstrap_test/TestBootstrap/simple_bootstrap_test_small_keepalive_period&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_novnode_dtest/494/testReport/bootstrap_test/TestBootstrap/simple_bootstrap_test_small_keepalive_period&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Error Message

Expected [[&apos;COMPLETED&apos;]] from SELECT bootstrapped FROM system.local WHERE key=&apos;local&apos;, but got [[u&apos;IN_PROGRESS&apos;]]
-------------------- &amp;gt;&amp;gt; begin captured logging &amp;lt;&amp;lt; --------------------
dtest: DEBUG: cluster ccm directory: /tmp/dtest-YmnyEI
dtest: DEBUG: Done setting configuration options:
{   &apos;num_tokens&apos;: None, &apos;phi_convict_threshold&apos;: 5, &apos;start_rpc&apos;: &apos;true&apos;}
cassandra.cluster: INFO: New Cassandra host &amp;lt;Host: 127.0.0.1 datacenter1&amp;gt; discovered
--------------------- &amp;gt;&amp;gt; end captured logging &amp;lt;&amp;lt; ---------------------
Stacktrace

  File &quot;/usr/lib/python2.7/unittest/case.py&quot;, line 329, in run
    testMethod()
  File &quot;/home/automaton/cassandra-dtest/tools/decorators.py&quot;, line 46, in wrapped
    f(obj)
  File &quot;/home/automaton/cassandra-dtest/bootstrap_test.py&quot;, line 163, in simple_bootstrap_test_small_keepalive_period
    assert_bootstrap_state(self, node2, &apos;COMPLETED&apos;)
  File &quot;/home/automaton/cassandra-dtest/tools/assertions.py&quot;, line 297, in assert_bootstrap_state
    assert_one(session, &quot;SELECT bootstrapped FROM system.local WHERE key=&apos;local&apos;&quot;, [expected_bootstrap_state])
  File &quot;/home/automaton/cassandra-dtest/tools/assertions.py&quot;, line 130, in assert_one
    assert list_res == [expected], &quot;Expected {} from {}, but got {}&quot;.format([expected], query, list_res)
&quot;Expected [[&apos;COMPLETED&apos;]] from SELECT bootstrapped FROM system.local WHERE key=&apos;local&apos;, but got [[u&apos;IN_PROGRESS&apos;]]\n-------------------- &amp;gt;&amp;gt; begin captured logging &amp;lt;&amp;lt; --------------------\ndtest: DEBUG: cluster ccm directory: /tmp/dtest-YmnyEI\ndtest: DEBUG: Done setting configuration options:\n{   &apos;num_tokens&apos;: None, &apos;phi_convict_threshold&apos;: 5, &apos;start_rpc&apos;: &apos;true&apos;}\ncassandra.cluster: INFO: New Cassandra host &amp;lt;Host: 127.0.0.1 datacenter1&amp;gt; discovered\n--------------------- &amp;gt;&amp;gt; end captured logging &amp;lt;&amp;lt; ---------------------&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13021559">CASSANDRA-12929</key>
            <summary>Fix version check to enable streaming keep-alive</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pauloricardomg">Paulo Motta</assignee>
                                    <reporter username="mshuler">Michael Shuler</reporter>
                        <labels>
                            <label>dtest</label>
                            <label>test-failure</label>
                    </labels>
                <created>Thu, 17 Nov 2016 19:06:08 +0000</created>
                <updated>Fri, 15 May 2020 08:05:13 +0000</updated>
                            <resolved>Tue, 4 Apr 2017 14:10:01 +0000</resolved>
                                        <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15683404" author="pauloricardomg" created="Mon, 21 Nov 2016 11:59:06 +0000"  >&lt;p&gt;I think the max keep-alive period of 2s is to small and may cause flakiness on unstable test clusters. We should probably increase this to 10s or 30s. &lt;/p&gt;</comment>
                            <comment id="15683418" author="pauloricardomg" created="Mon, 21 Nov 2016 12:07:44 +0000"  >&lt;p&gt;This is probably a good chance to modify this test to use byteman, so it will be faster since we will not need to load 50k rows.&lt;/p&gt;</comment>
                            <comment id="15950013" author="pauloricardomg" created="Thu, 30 Mar 2017 22:49:54 +0000"  >&lt;p&gt;Hmm, the version check &lt;tt&gt;CassandraVersion.isSupportedBy&lt;/tt&gt; only consider versions in the same major compatible, so keep-alive was never being enabled. I updated the keep-alive version check to use &lt;tt&gt;compareTo&lt;/tt&gt; which compares both majors and minors instead, which makes 4.0 compatible with 3.10.&lt;/p&gt;

&lt;p&gt;Also updated dtest to use byteman so it will be faster &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/1458&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Trivial patch attached:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...pauloricardomg:trunk-12929&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/riptano/cassandra-dtest/compare/master...pauloricardomg:12929&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-12929-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt;Mind having a quick look &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt;? Thanks!&lt;/p&gt;</comment>
                            <comment id="15950206" author="yukim" created="Fri, 31 Mar 2017 02:21:13 +0000"  >&lt;p&gt;Nice catch. +1.&lt;/p&gt;</comment>
                            <comment id="15951523" author="pauloricardomg" created="Fri, 31 Mar 2017 19:18:43 +0000"  >&lt;p&gt;Submitted &lt;a href=&quot;https://cassci.datastax.com/view/Parameterized/job/parameterized_dtest_multiplexer/391/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;multiplexer run&lt;/a&gt; since this is a novnode test which did not get triggered in the previous run.&lt;/p&gt;</comment>
                            <comment id="15951796" author="pauloricardomg" created="Fri, 31 Mar 2017 23:19:41 +0000"  >&lt;p&gt;Committed to trunk as &lt;tt&gt;add855ae177d28d02f1172fb0070ef487237ead5&lt;/tt&gt;. Thanks!&lt;/p&gt;</comment>
                            <comment id="15954569" author="jkni" created="Tue, 4 Apr 2017 05:25:36 +0000"  >&lt;p&gt;It looks like this is causing quite a few test failures on commit.&lt;/p&gt;

&lt;p&gt;In dtests, this includes many tests in sstable_generation_loading_test and snapshot_test.TestSnapshot.test_basic_snapshot_and_restore.&lt;/p&gt;

&lt;p&gt;in testall, this includes StreamStateStoreTest.testUpdateAndQueryAvailableRanges, LocalSyncTaskTest.testDifference, StreamingRepairTaskTest.incrementalStreamPlan, StreamingRepairTaskTest.fullStreamPlan, StreamTransferTaskTest.testScheduleTimeout, and StreamTransferTaskTest.testFailSessionDuringTransferShouldNotReleaseReferences.&lt;/p&gt;

&lt;p&gt;There may be others that I missed, but that list should get things pointed in the right direction.&lt;/p&gt;</comment>
                            <comment id="15954750" author="yukim" created="Tue, 4 Apr 2017 07:58:43 +0000"  >&lt;p&gt;My bad, I should have checked more closely.&lt;br/&gt;
I pushed fix and submitted test build.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;testall&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/yukim/cassandra/tree/12929-fix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;12929-fix&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/yukim/job/yukim-12929-fix-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/yukim/job/yukim-12929-fix-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15955174" author="pauloricardomg" created="Tue, 4 Apr 2017 14:09:56 +0000"  >&lt;p&gt;doh, my bad too for not double checking test results and submitting testall (since it was so trivial). I remember we had the exact same problem back in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11841&quot; title=&quot;Add keep-alive to stream protocol&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11841&quot;&gt;&lt;del&gt;CASSANDRA-11841&lt;/del&gt;&lt;/a&gt;. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Fix and tests look good (triple checked). Committed fix as to trunk as &lt;tt&gt;633babf0f02fac56cad7bff03a4ff415feb38f39&lt;/tt&gt;. Thanks!&lt;/p&gt;</comment>
                            <comment id="15955195" author="jkni" created="Tue, 4 Apr 2017 14:28:32 +0000"  >&lt;p&gt;Thanks! It happens.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="13061142">CASSANDRA-13402</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 33 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36gzb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yukim</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>