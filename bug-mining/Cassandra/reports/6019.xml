<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:24:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-17416] Test Failure: org.apache.cassandra.db.commitlog.CommitLogSegmentManagerCDCTest.testCDCIndexFileWriteOnSync</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-17416</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-trunk/985/testReport/org.apache.cassandra.db.commitlog/CommitLogSegmentManagerCDCTest/testCDCIndexFileWriteOnSync_cdc_3/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/job/Cassandra-trunk/985/testReport/org.apache.cassandra.db.commitlog/CommitLogSegmentManagerCDCTest/testCDCIndexFileWriteOnSync_cdc_3/&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;ErrorMessage&quot;&gt;&lt;/a&gt;Error Message&lt;/h3&gt;

&lt;p&gt;expected:&amp;lt;1748956&amp;gt; but was:&amp;lt;1749196&amp;gt;&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;Stacktrace&quot;&gt;&lt;/a&gt;Stacktrace&lt;/h3&gt;

&lt;p&gt;junit.framework.AssertionFailedError: expected:&amp;lt;1748956&amp;gt; but was:&amp;lt;1749196&amp;gt; at org.apache.cassandra.db.commitlog.CommitLogSegmentManagerCDCTest.testCDCIndexFileWriteOnSync(CommitLogSegmentManagerCDCTest.java:160) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;StandardOutput&quot;&gt;&lt;/a&gt;Standard Output&lt;/h3&gt;

&lt;p&gt;INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; 2022-03-02 15:04:59,516 YamlConfigurationLoader.java:103 - Configuration location: &lt;a href=&quot;file:////home/cassandra/cassandra/build/test/cassandra.cdc.yaml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:////home/cassandra/cassandra/build/test/cassandra.cdc.yaml&lt;/a&gt; DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; 2022-03-02 15:04:59,520 YamlConfigurationLoader.java:124 - Loading settings from &lt;a href=&quot;file:////home/cassandra/cassandra/build/test/cassandra.cdc.yaml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:////home/cassandra/cassandra/build/test/cassandra.cdc.yaml&lt;/a&gt; INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; 2022-03-02 15:04:59,674 Config.java:907 - Node configuration:[allocate_tokens_for_keyspace=null; allocate_tokens_for_local_replication_factor=null; allow_extra_insecure_ ...&lt;span class=&quot;error&quot;&gt;&amp;#91;truncated 4125855 chars&amp;#93;&lt;/span&gt;... -02 15:06:57,491 PathUtils.java:73 - Deleting file during startup: /home/cassandra/cassandra/build/test/cassandra/data/system_schema/views-9786ac1cdd583201a7cdad556410c985/nb-11-big-Summary.db DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;MemtableFlushWriter:2&amp;#93;&lt;/span&gt; 2022-03-02 15:06:57,496 ColumnFamilyStore.java:1207 - Flushed to &lt;span class=&quot;error&quot;&gt;&amp;#91;BigTableReader(path=&amp;#39;/home/cassandra/cassandra/build/test/cassandra/data/system_schema/keyspaces-abac5682dea631c5b535b3d6cffd0fb6/nb-55-big-Data.db&amp;#39;)&amp;#93;&lt;/span&gt; (1 sstables, 4.895KiB), biggest 4.895KiB, smallest 4.895KiB&lt;/p&gt;</description>
                <environment></environment>
        <key id="13431877">CASSANDRA-17416</key>
            <summary>Test Failure: org.apache.cassandra.db.commitlog.CommitLogSegmentManagerCDCTest.testCDCIndexFileWriteOnSync</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yifanc">Yifan Cai</assignee>
                                    <reporter username="marcuse">Marcus Eriksson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Mar 2022 07:13:10 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:58 +0000</updated>
                            <resolved>Fri, 6 May 2022 18:37:05 +0000</resolved>
                                        <fixVersion>4.1-alpha1</fixVersion>
                    <fixVersion>4.1</fixVersion>
                                    <component>Test/unit</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17514407" author="edimitrova" created="Wed, 30 Mar 2022 02:47:12 +0000"  >&lt;p&gt;I don&apos;t see a reason for this one to stay in triage, I keep on seeing it on trunk&lt;/p&gt;</comment>
                            <comment id="17516031" author="edimitrova" created="Fri, 1 Apr 2022 17:19:06 +0000"  >&lt;p&gt;I just saw this stacktrace in &lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-trunk/1044/testReport/org.apache.cassandra.db.commitlog/CommitLogSegmentManagerCDCTest/testCDCIndexFileWriteOnSync_cdc_2/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Regression
org.apache.cassandra.db.commitlog.CommitLogSegmentManagerCDCTest.testCDCIndexFileWriteOnSync-cdc (from org.apache.cassandra.db.commitlog.CommitLogSegmentManagerCDCTest-cdc)

Failing &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the past 1 build (Since #1044 )
Took 2.1 sec.
 Failed 2 times in the last 30 runs. Flakiness: 10%, Stability: 93%
Error Message
&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
Stacktrace
java.lang.NumberFormatException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.parseInt(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.java:542)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.parseInt(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.java:615)
	at org.apache.cassandra.db.commitlog.CommitLogSegmentManagerCDCTest.testCDCIndexFileWriteOnSync(CommitLogSegmentManagerCDCTest.java:159)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17530906" author="jmckenzie" created="Mon, 2 May 2022 19:12:54 +0000"  >&lt;p&gt;Can&apos;t reproduce this one locally but noodling on it for a bit, here&apos;s a hypothesis:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        CommitLog.instance.sync(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        CommitLogSegment currentSegment = CommitLog.instance.segmentManager.allocatingFrom();
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; syncOffset = currentSegment.lastSyncedOffset;

        &lt;span class=&quot;code-comment&quot;&gt;// Confirm index file is written
&lt;/span&gt;        File cdcIndexFile = currentSegment.getCDCIndexFile();
        Assert.assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Index file not written: &quot;&lt;/span&gt; + cdcIndexFile, cdcIndexFile.exists());

        &lt;span class=&quot;code-comment&quot;&gt;// Read index value and confirm it&apos;s == end from last sync
&lt;/span&gt;        BufferedReader in = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileReader(cdcIndexFile));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In general, to my eye the above code is going to be prone to races. The syncOffset we take immediately after sync + getting ref may or may not point to whatever is in the cdcIndexFile as another flush / sync may go on between that first lastSyncedOffset check and creation of the FileReader.&lt;/p&gt;

&lt;p&gt;So I&apos;m thinking we check that the value we parse from cdcIndexFile is &amp;gt;= lastSyncedOffset to account for that.&lt;/p&gt;

&lt;p&gt;As for the null you saw Ekaterina, no clue. That null indicates it failed to read anything from the cdcIndexFile and it really shouldn&apos;t have done that; can&apos;t think of a scenario where it&apos;d succeed in writing the index file but have it be completely empty. I can harden that test a bit and have it dump out the entire contents of the index file if it has an integer parse error.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yifanc&quot; class=&quot;user-hover&quot; rel=&quot;yifanc&quot;&gt;yifanc&lt;/a&gt; - since you&apos;ve dug around a bit in the CDC space, WDYT about the &amp;gt;= comparison instead of equality here? Sound reasonable?&lt;br/&gt;
&#160;&lt;/p&gt;</comment>
                            <comment id="17530908" author="edimitrova" created="Mon, 2 May 2022 19:22:03 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmckenzie&quot; class=&quot;user-hover&quot; rel=&quot;jmckenzie&quot;&gt;jmckenzie&lt;/a&gt; Note on the reproducibility. I see these failures all the time with midres in CircleCI. You can use the jobs to loop it there and you will have the logs under artifacts. It is super convenient. Hope that helps &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17530936" author="edimitrova" created="Mon, 2 May 2022 20:35:51 +0000"  >&lt;p&gt;For the record, this is a loop on recent trunk where we can see both failures and respective logs from CircleCI:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1557/workflows/a1508c6d-7d81-4f05-b6bf-e763ca73d4d0/jobs/10300&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1557/workflows/a1508c6d-7d81-4f05-b6bf-e763ca73d4d0/jobs/10300&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17531049" author="yifanc" created="Tue, 3 May 2022 05:38:24 +0000"  >&lt;p&gt;I was able to reproduce the both failures. Some logging changes was made to the test and it helped to indicate the cause. Please see the test failures in &lt;a href=&quot;https://app.circleci.com/pipelines/github/yifan-c/cassandra/337/workflows/5a42b3bc-c540-4c36-aac4-7a22709cf75b/jobs/2808&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this repeated run&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For the unequal expected and actual offset values, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmckenzie&quot; class=&quot;user-hover&quot; rel=&quot;jmckenzie&quot;&gt;jmckenzie&lt;/a&gt;&apos;s analysis is correct. The completed tasks from the commit log metrics between the explicit commit log sync call and reading the index file are different for the failed tests. It means there is another mutation added to the commit log. &lt;/p&gt;

&lt;p&gt;For reading the null value, I believe the cause is the race between overwriting and reading the CDC index file. Overwriting a file (as for the one opened with PathUtils#newWriteOverwriteChannel) has 2 steps:&lt;br/&gt;
1. Truncate the file to size of 0.&lt;br/&gt;
2. Write the offset (long). &lt;br/&gt;
It is possible that the test reads the file when the file is just truncated, hence getting the null value. I also have an independent unit test to reproduce the behavior. It inserts a pause between creating the file writer (which truncates) and writing content. The other thread that reads the file throws NPE. &lt;br/&gt;
Since the overwrite operation is non-atomic, NPE is possible to happen when CDC consumers read the index file. I think we should either document the behavior or make the update atomic. I would lean to the former for simplicity and re-reading the file is going to give the correct content. WDYT?&lt;/p&gt;</comment>
                            <comment id="17531264" author="jmckenzie" created="Tue, 3 May 2022 15:53:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think we should either document the behavior or make the update atomic. I would lean to the former for simplicity and re-reading the file is going to give the correct content. WDYT?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;+1 to documenting the nuance of the API and we can also have the unit test pause a bit and retry N times, throwing a specific exception about the expectation (we expected race w/new file write to lead to us being able to read a new file after retry but got null N times) in there.&lt;/p&gt;

&lt;p&gt;While still &lt;b&gt;technically&lt;/b&gt; there&apos;s surface area to flake w/that, it should be a vanishingly small pct chance if we retry 100 times with 20ms sleeps and we can give a very direct guide as to why it failed.&lt;/p&gt;

&lt;p&gt;I&apos;m happy to make both these changes and push up a PR. Thanks for checking and confirming &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yifanc&quot; class=&quot;user-hover&quot; rel=&quot;yifanc&quot;&gt;yifanc&lt;/a&gt; (as well as checking into Ekaterina&apos;s other observed failure pattern)&lt;/p&gt;</comment>
                            <comment id="17532533" author="yifanc" created="Thu, 5 May 2022 21:30:25 +0000"  >&lt;p&gt;Talked with Josh offline and I am posting the patch. It makes changes to the test and documents the edge case when reading from the CDC index file.&lt;/p&gt;

&lt;p&gt;PR: &lt;a href=&quot;https://github.com/apache/cassandra/pull/1605&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1605&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/yifan-c/cassandra/339/workflows/4798541d-1cdc-4ac3-bd18-81ea18b6874b/jobs/2813&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;J8 (repeated)&lt;/a&gt;: Green&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/yifan-c/cassandra/339/workflows/157cac9e-58b5-4414-a9d0-ca289efb7c3d/jobs/2814&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;J11 (repeated)&lt;/a&gt;: Green&lt;/p&gt;</comment>
                            <comment id="17532929" author="jmckenzie" created="Fri, 6 May 2022 15:32:16 +0000"  >&lt;p&gt;One question but I&apos;m a +1 pending that: currently the test just spins 5 times to try and read the index file. I think adding a very small sleep (20ms for example) between each attempt to read would make this a bit more robust as that&apos;d give the kernel scheduler more chances to put the CDC index file writer to the front of the queue to execute for our next read.&lt;/p&gt;

&lt;p&gt;Based on your opinion of the above, CI looks good and the patch looks good. So take it or leave it on commit.&lt;/p&gt;

&lt;p&gt;Thanks for grabbing this Yifan!&lt;/p&gt;</comment>
                            <comment id="17532973" author="yifanc" created="Fri, 6 May 2022 16:38:18 +0000"  >&lt;p&gt;Addressed the feedback (add pause between each read attempt) and started a new &lt;a href=&quot;https://app.circleci.com/pipelines/github/yifan-c/cassandra/340/workflows/06684382-3087-4c54-9e33-8089b73150b1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;repeated run&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17533029" author="yifanc" created="Fri, 6 May 2022 18:37:05 +0000"  >&lt;p&gt;Committed into trunk as &lt;a href=&quot;https://github.com/apache/cassandra/commit/c48906394e01460382f4070ecc34f6f9754fc567&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;c48906&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17533163" author="edimitrova" created="Sat, 7 May 2022 00:29:01 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yifanc&quot; class=&quot;user-hover&quot; rel=&quot;yifanc&quot;&gt;yifanc&lt;/a&gt;&#160;, I think you forgot to commit the fix to our brand new cassandra-4.1 branch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17534044" author="yifanc" created="Mon, 9 May 2022 22:30:07 +0000"  >&lt;p&gt;Thank you, Ekaterina! &lt;br/&gt;
Just cherrypicked the commit to 4.1 and started the repeated run: &lt;a href=&quot;https://app.circleci.com/pipelines/github/yifan-c/cassandra/342/workflows/9d751a4e-52bd-45f4-8b12-13b451b12080&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/yifan-c/cassandra/342/workflows/9d751a4e-52bd-45f4-8b12-13b451b12080&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17534064" author="yifanc" created="Tue, 10 May 2022 01:01:04 +0000"  >&lt;p&gt;The repeated run is green. &lt;br/&gt;
Pushed the &lt;a href=&quot;https://github.com/apache/cassandra/commit/8fc39685fbb6c963cf0d86fd458069ab80bbcece&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;commit to 4.1&lt;/a&gt; and merged up to trunk. &lt;/p&gt;</comment>
                            <comment id="17534065" author="edimitrova" created="Tue, 10 May 2022 01:12:56 +0000"  >&lt;p&gt;Great! Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yifanc&quot; class=&quot;user-hover&quot; rel=&quot;yifanc&quot;&gt;yifanc&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="17534473" author="jmckenzie" created="Tue, 10 May 2022 16:54:30 +0000"  >&lt;p&gt;ASF CI run seems like a bit of an unrelated mess. Probably need to see how build 11 w/a subsequent commit runs, as a lot of unrelated failures popped up for seemingly first time in the 4.1 history on this patch.&lt;/p&gt;

&lt;p&gt;A limitation of the logic used to determine historical test failure here is that we&apos;re comparing the 10 builds of the cassandra-4.1 branch and missing out on trunk so it&apos;s quite possible there&apos;s failures of these tests on those branches as well not being correlated here.&lt;/p&gt;

&lt;p&gt;I don&apos;t think there&apos;s anything for us to do re: CI and this patch though.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;CI Results&amp;#93;&lt;/span&gt;&lt;br/&gt;
Branch: 4.1, build number: 10&lt;br/&gt;
butler url: &lt;a href=&quot;https://butler.cassandra.apache.org/#/ci/upstream/compare/Cassandra-4.1/Cassandra-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://butler.cassandra.apache.org/#/ci/upstream/compare/Cassandra-4.1/Cassandra-4.1&lt;/a&gt;&lt;br/&gt;
jenkins url: &lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-4.1/10/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/job/Cassandra-4.1/10/&lt;/a&gt;&lt;br/&gt;
JIRA: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17416&quot; title=&quot;Test Failure: org.apache.cassandra.db.commitlog.CommitLogSegmentManagerCDCTest.testCDCIndexFileWriteOnSync&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17416&quot;&gt;&lt;del&gt;CASSANDRA-17416&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
commit url: &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=cassandra.git;a=commit;h=8fc39685fbb6c963cf0d86fd458069ab80bbcece&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=cassandra.git;a=commit;h=8fc39685fbb6c963cf0d86fd458069ab80bbcece&lt;/a&gt;&lt;br/&gt;
affected paths:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;doc/modules/cassandra/pages/operating/cdc.adoc&lt;/li&gt;
	&lt;li&gt;test/unit/org/apache/cassandra/db/commitlog/CommitLogSegmentManagerCDCTest.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Build Result: UNSTABLE&lt;br/&gt;
Passing Tests: 49062&lt;br/&gt;
Failing Tests: 16&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Test&lt;/th&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Failures&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;JIRA&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest-upgrade.upgrade_tests.upgrade_through_versions_test.TestProtoV3Upgrade_AllVersions_RandomPartitioner_EndsAt_3_11_X_HEAD.test_rolling_upgrade_with_internode_ssl&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/issues/?jql=project%20%3D%20CASSANDRA%20and%20resolution%20%3D%20unresolved%20and%20summary%20~%20%22*TestProtoV3Upgrade*%22&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Multiple JIRAs found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.net.ProxyHandlerConnectionsTest.testExpireSome&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17301&quot; title=&quot;Test Failure: org.apache.cassandra.net.ProxyHandlerConnectionsTest.suddenDisconnect-cdc&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17301&quot;&gt;&lt;del&gt;CASSANDRA-17301&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.distributed.upgrade.MixedModeAvailabilityV30Test.testAvailability&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17307&quot; title=&quot;Test Failure: org.apache.cassandra.distributed.upgrade.MixedModeAvailabilityV30Test.testAvailability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17307&quot;&gt;&lt;del&gt;CASSANDRA-17307&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.tools.TopPartitionsTest.testServiceTopPartitionsSingleTable-compression&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17455&quot; title=&quot;Flaky org.apache.cassandra.tools TopPartitionsTest testServiceTopPartitionsSingleTable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17455&quot;&gt;&lt;del&gt;CASSANDRA-17455&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.distributed.test.thresholds.TombstoneCountWarningTest.noWarningsScan&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17244&quot; title=&quot;Fix org.apache.cassandra.distributed.test.trackwarnings.TombstoneCountWarningTest.failThresholdSinglePartition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17244&quot;&gt;&lt;del&gt;CASSANDRA-17244&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest-upgrade.upgrade_tests.cql_tests.TestCQLNodes3RF3_Upgrade_current_3_0_x_To_indev_4_1_x.test_multi_in_compact&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest-offheap.auth_test.TestAuth.test_system_auth_ks_is_alterable&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/issues/?jql=project%20%3D%20CASSANDRA%20and%20resolution%20%3D%20unresolved%20and%20summary%20~%20%22*TestAuth*%22&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Multiple JIRAs found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.distributed.test.thresholds.TombstoneCountWarningTest.failThresholdSinglePartition&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17244&quot; title=&quot;Fix org.apache.cassandra.distributed.test.trackwarnings.TombstoneCountWarningTest.failThresholdSinglePartition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17244&quot;&gt;&lt;del&gt;CASSANDRA-17244&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.tools.TopPartitionsTest.testServiceTopPartitionsSingleTable-cdc&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17455&quot; title=&quot;Flaky org.apache.cassandra.tools TopPartitionsTest testServiceTopPartitionsSingleTable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17455&quot;&gt;&lt;del&gt;CASSANDRA-17455&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.cql3.validation.operations.InsertUpdateIfConditionCollectionsTest.testNonFrozenEmptyCollection&lt;span class=&quot;error&quot;&gt;&amp;#91;1: clusterMinVersion=3.11&amp;#93;&lt;/span&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest.materialized_views_test.TestMaterializedViews.test_mv_with_default_ttl_with_flush&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11612&quot; title=&quot;dtest failure in materialized_views_test.TestMaterializedViews.interrupt_build_process_test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11612&quot;&gt;CASSANDRA-11612&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.distributed.test.thresholds.TombstoneCountWarningTest.noWarningsSinglePartition&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17244&quot; title=&quot;Fix org.apache.cassandra.distributed.test.trackwarnings.TombstoneCountWarningTest.failThresholdSinglePartition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17244&quot;&gt;&lt;del&gt;CASSANDRA-17244&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.db.commitlog.CommitLogSegmentManagerCDCTest.testSwitchingCDCWriteModes&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17542&quot; title=&quot;Test failure: CommitLogSegmentManagerCDCTest.testSwitchingCDCWriteModes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17542&quot;&gt;CASSANDRA-17542&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.db.SinglePartitionSliceCommandTest.testPartitionDeletionRowDeletionTie-compression&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17463&quot; title=&quot;Test Failure: org.apache.cassandra.db.SinglePartitionSliceCommandTest.testPartitionDeletionRowDeletionTie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17463&quot;&gt;&lt;del&gt;CASSANDRA-17463&lt;/del&gt;&lt;/a&gt;?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;org.apache.cassandra.cql3.validation.operations.InsertUpdateIfConditionCollectionsTest.testListItem&lt;span class=&quot;error&quot;&gt;&amp;#91;1: clusterMinVersion=3.11&amp;#93;&lt;/span&gt;-cdc&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;dtest-upgrade.upgrade_tests.cql_tests.TestCQLNodes3RF3_Upgrade_indev_3_0_x_To_indev_4_1_x.test_no_range_ghost&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1 of 8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/RapidBoard.jspa?rapidView=496&amp;amp;quickFilter=2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;No JIRA found&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yifanc]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12990" cascade-level="1"><![CDATA[Test Failure]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z105mo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jmckenzie]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12336842">4.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/c48906394e01460382f4070ecc34f6f9754fc567&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/c48906394e01460382f4070ecc34f6f9754fc567&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;unit test; CI&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>