<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:29:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-19255] StorageService.getRangeToEndpointMap() MBean operation is running into NPE for LocalStrategy keysapces</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-19255</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;When the StorageService&apos;s MBean operation getRangeToEndpointMap is called for LocalStrategy keyspaces, then it is running into NPE. It is working in earlier major version, but failing in trunk. It can be reproduced in local using JConsole or using a tool like `jmxterm` (unfortunately these tools are not giving full stacktrace). Observed the same behavior with getRangeToEndpointWithPortMap operation too.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13564087">CASSANDRA-19255</key>
            <summary>StorageService.getRangeToEndpointMap() MBean operation is running into NPE for LocalStrategy keysapces</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="n.v.harikrishna">n.v.harikrishna</assignee>
                                    <reporter username="n.v.harikrishna">n.v.harikrishna</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Jan 2024 17:21:36 +0000</created>
                <updated>Mon, 25 Mar 2024 06:33:07 +0000</updated>
                            <resolved>Fri, 22 Mar 2024 10:49:53 +0000</resolved>
                                        <fixVersion>5.x</fixVersion>
                                    <component>Cluster/Membership</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="17804818" author="n.v.harikrishna" created="Tue, 9 Jan 2024 17:27:30 +0000"  >&lt;p&gt;Sample output using jmxterm&lt;/p&gt;

&lt;p&gt;For trunk:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;$&amp;gt;bean org.apache.cassandra.db:type=StorageService&lt;br/&gt;
#bean is set to org.apache.cassandra.db:type=StorageService&lt;/p&gt;

&lt;p&gt;$&amp;gt;run getRangeToEndpointMap system&lt;br/&gt;
#calling operation getRangeToEndpointMap of mbean org.apache.cassandra.db:type=StorageService with params &lt;span class=&quot;error&quot;&gt;&amp;#91;system&amp;#93;&lt;/span&gt;&lt;br/&gt;
#RuntimeMBeanException: java.lang.NullPointerException&lt;/p&gt;

&lt;p&gt;$&amp;gt;run getRangeToEndpointWithPortMap system&lt;br/&gt;
#calling operation getRangeToEndpointWithPortMap of mbean org.apache.cassandra.db:type=StorageService with params &lt;span class=&quot;error&quot;&gt;&amp;#91;system&amp;#93;&lt;/span&gt;&lt;br/&gt;
#RuntimeMBeanException: java.lang.NullPointerException&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;For 4.1 (using ccm):&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;$&amp;gt;run getRangeToEndpointMap system&lt;br/&gt;
#calling operation getRangeToEndpointMap of mbean org.apache.cassandra.db:type=StorageService with params &lt;span class=&quot;error&quot;&gt;&amp;#91;system&amp;#93;&lt;/span&gt;&lt;br/&gt;
#operation returns:&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
  ( 3074457345618258602, -9223372036854775808 ) = ( 127.0.0.1 );
  ( -3074457345618258603, 3074457345618258602 ) = ( 127.0.0.1 );
  ( -9223372036854775808, -3074457345618258603 ) = ( 127.0.0.1 );
}&lt;/span&gt; &lt;/div&gt;

&lt;p&gt;$&amp;gt;run getRangeToEndpointWithPortMap system&lt;br/&gt;
#calling operation getRangeToEndpointWithPortMap of mbean org.apache.cassandra.db:type=StorageService with params &lt;span class=&quot;error&quot;&gt;&amp;#91;system&amp;#93;&lt;/span&gt;&lt;br/&gt;
#operation returns:&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
  ( 3074457345618258602, -9223372036854775808 ) = ( 127.0.0.1}&lt;/span&gt; &lt;/div&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17804820" author="n.v.harikrishna" created="Tue, 9 Jan 2024 17:31:05 +0000"  >&lt;p&gt;Suspecting that similar issue exists for other getRangeTo* operations of StorageService. Will cross check them too.&#160;&lt;/p&gt;</comment>
                            <comment id="17806431" author="n.v.harikrishna" created="Sun, 14 Jan 2024 05:56:25 +0000"  >&lt;p&gt;Observed NPE for &lt;tt&gt;getRangeToRpcaddressMap&lt;/tt&gt; and &lt;tt&gt;getRangeToNativeaddressWithPortMap&lt;/tt&gt; methods too (these are working in 4.1). Preparing a patch.&lt;/p&gt;</comment>
                            <comment id="17821217" author="n.v.harikrishna" created="Tue, 27 Feb 2024 12:56:09 +0000"  >&lt;p&gt;Prepared a patch. Here is the &lt;a href=&quot;https://github.com/apache/cassandra/pull/3141&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17821219" author="n.v.harikrishna" created="Tue, 27 Feb 2024 12:58:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcuse&quot; class=&quot;user-hover&quot; rel=&quot;marcuse&quot;&gt;marcuse&lt;/a&gt; would you mind taking a look?&lt;/p&gt;</comment>
                            <comment id="17829806" author="n.v.harikrishna" created="Fri, 22 Mar 2024 09:23:14 +0000"  >&lt;p&gt;Uploaded the test results.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://example.com&quot; title=&quot;https://github.com/apache/cassandra/pull/3141&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17829814" author="krummas" created="Fri, 22 Mar 2024 09:53:40 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17829823" author="beobal" created="Fri, 22 Mar 2024 10:49:53 +0000"  >&lt;p&gt;LGTM too, committed as &lt;tt&gt;a69c8657d75de627fb1fe518bfe1d657add11740&lt;/tt&gt; (with a couple of extremely minor changes).&lt;br/&gt;
One thing to note is that this will need slight readjustment if &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-19482&quot; title=&quot;Simplify metadata log implementation using custom partitioner&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-19482&quot;&gt;&lt;del&gt;CASSANDRA-19482&lt;/del&gt;&lt;/a&gt; is committed as the way we handle the &lt;tt&gt;MetaStrategy&lt;/tt&gt; keyspace is changed. &lt;br/&gt;
The attached diff will fix that if/when necessary.&lt;/p&gt;</comment>
                            <comment id="17829829" author="n.v.harikrishna" created="Fri, 22 Mar 2024 11:11:24 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcuse&quot; class=&quot;user-hover&quot; rel=&quot;marcuse&quot;&gt;marcuse&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt; !&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13067609" name="19482_patch_for_19255.diff" size="2798" author="samt" created="Fri, 22 Mar 2024 10:50:58 +0000"/>
                            <attachment id="13067603" name="ci_summary.html" size="7082" author="n.v.harikrishna" created="Fri, 22 Mar 2024 09:20:12 +0000"/>
                            <attachment id="13067604" name="result_details.tar.gz" size="42390513" author="n.v.harikrishna" created="Fri, 22 Mar 2024 09:20:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[n.v.harikrishna]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12988" cascade-level="1"><![CDATA[API / Semantic Implementation]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12977"><![CDATA[Adhoc Test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 33 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1mnao:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12349241">5.x</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/a69c8657d75de627fb1fe518bfe1d657add11740&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/a69c8657d75de627fb1fe518bfe1d657add11740&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Verified in local and ran tests.&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>