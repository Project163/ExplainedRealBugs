<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:19:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2206] Startup fails due to cassandra trying to delete nonexisting file</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2206</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;On one of our nodes, startup fails due to cassandra trying to delete a nonexistant &quot;Data&quot; file (see below).&lt;/p&gt;

&lt;p&gt;Why that file is missing is another mistery... The log file entries don&apos;t show any ERROR messages before cassandra restarted (for reasons I don&apos;t know) and this error occured.&lt;/p&gt;

&lt;p&gt;Directory listing:&lt;/p&gt;

&lt;p&gt;total 109M&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root  51M 2011-02-21 05:25 table_task-f-1666-Data.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 243K 2011-02-21 05:25 table_task-f-1666-Filter.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 6.1M 2011-02-21 05:25 table_task-f-1666-Index.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 4.2K 2011-02-21 05:25 table_task-f-1666-Statistics.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 9.8M 2011-02-21 11:36 table_task-f-1703-Data.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root  57K 2011-02-21 11:36 table_task-f-1703-Filter.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 1.3M 2011-02-21 11:36 table_task-f-1703-Index.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 4.2K 2011-02-21 11:36 table_task-f-1703-Statistics.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 292K 2011-02-21 11:42 table_task-f-1704-Data.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 1.7K 2011-02-21 11:42 table_task-f-1704-Filter.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root  42K 2011-02-21 11:42 table_task-f-1704-Index.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 4.2K 2011-02-21 11:42 table_task-f-1704-Statistics.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 364K 2011-02-21 11:52 table_task-f-1705-Data.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 2.0K 2011-02-21 11:52 table_task-f-1705-Filter.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root  50K 2011-02-21 11:52 table_task-f-1705-Index.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 4.2K 2011-02-21 11:52 table_task-f-1705-Statistics.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 535K 2011-02-21 12:10 table_task-f-1706-Data.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 2.8K 2011-02-21 12:10 table_task-f-1706-Filter.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root  70K 2011-02-21 12:10 table_task-f-1706-Index.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 4.2K 2011-02-21 12:10 table_task-f-1706-Statistics.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root  11M 2011-02-21 12:11 table_task-f-1707-Data.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root  18M 2011-02-21 09:47 table_task_meta-f-417-Data.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 271K 2011-02-21 09:47 table_task_meta-f-417-Filter.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 6.7M 2011-02-21 09:47 table_task_meta-f-417-Index.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 4.2K 2011-02-21 09:47 table_task_meta-f-417-Statistics.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 1.2M 2011-02-21 10:47 table_task_meta-f-418-Data.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root  18K 2011-02-21 10:47 table_task_meta-f-418-Filter.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 460K 2011-02-21 10:47 table_task_meta-f-418-Index.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 4.2K 2011-02-21 10:47 table_task_meta-f-418-Statistics.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 791K 2011-02-21 11:47 table_task_meta-f-419-Data.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root  13K 2011-02-21 11:47 table_task_meta-f-419-Filter.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 311K 2011-02-21 11:47 table_task_meta-f-419-Index.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 4.2K 2011-02-21 11:47 table_task_meta-f-419-Statistics.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root  57K 2011-02-21 12:11 table_task-tmp-f-1707-Filter.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 1.4M 2011-02-21 12:11 table_task-tmp-f-1707-Index.db&lt;br/&gt;
&lt;del&gt;rw-r&lt;/del&gt;&lt;del&gt;r&lt;/del&gt;- 1 root root 4.2K 2011-02-21 12:11 table_task-tmp-f-1707-Statistics.db&lt;/p&gt;


&lt;p&gt;Cassandra log:&lt;/p&gt;

&lt;p&gt;/software/cassandra/bin/cassandra&lt;br/&gt;
rm: cannot remove `/software/cassandra/lib/jna.jar&apos;: No such file or directory&lt;br/&gt;
root@intr1n3:/cassandra/data/table_task#  INFO 12:47:29,020 Logging initialized&lt;br/&gt;
 INFO 12:47:29,030 Heap size: 2614493184/2614493184&lt;br/&gt;
 INFO 12:47:29,031 JNA not found. Native methods will be disabled.&lt;br/&gt;
 INFO 12:47:29,038 Loading settings from &lt;a href=&quot;file:/software/cassandra/conf/cassandra.yaml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/software/cassandra/conf/cassandra.yaml&lt;/a&gt;&lt;br/&gt;
 INFO 12:47:29,320 DiskAccessMode is standard, indexAccessMode is mmap&lt;br/&gt;
 INFO 12:47:29,332 Creating new commitlog segment /hd1/cassandra_md5/commitlog/CommitLog-1298288849332.log&lt;br/&gt;
 INFO 12:47:29,422 Opening /cassandra/data/system/Schema-f-244&lt;br/&gt;
 INFO 12:47:29,434 Opening /cassandra/data/system/Migrations-f-244&lt;br/&gt;
 INFO 12:47:29,437 Opening /cassandra/data/system/LocationInfo-f-137&lt;br/&gt;
 INFO 12:47:29,440 Opening /cassandra/data/system/HintsColumnFamily-f-352&lt;br/&gt;
 INFO 12:47:29,441 Opening /cassandra/data/system/HintsColumnFamily-f-353&lt;br/&gt;
 INFO 12:47:29,465 Loading schema version 54bc134e-2229-11e0-9159-fdf0b6b4b562&lt;br/&gt;
 WARN 12:47:29,623 Schema definitions were defined both locally and in cassandra.yaml. Definitions in cassandra.yaml were ignored.&lt;br/&gt;
ERROR 12:47:29,638 Exception encountered during startup.&lt;br/&gt;
java.io.IOError: java.io.IOException: Failed to delete /cassandra/data/table_task/table_task-tmp-f-1707-Data.db&lt;br/&gt;
        at org.apache.cassandra.io.sstable.SSTable.delete(SSTable.java:145)&lt;br/&gt;
        at org.apache.cassandra.db.ColumnFamilyStore.scrubDataDirectories(ColumnFamilyStore.java:468)&lt;br/&gt;
        at org.apache.cassandra.service.AbstractCassandraDaemon.setup(AbstractCassandraDaemon.java:153)&lt;br/&gt;
        at org.apache.cassandra.service.AbstractCassandraDaemon.activate(AbstractCassandraDaemon.java:316)&lt;br/&gt;
        at org.apache.cassandra.thrift.CassandraDaemon.main(CassandraDaemon.java:79)&lt;br/&gt;
Caused by: java.io.IOException: Failed to delete /cassandra/data/table_task/table_task-tmp-f-1707-Data.db&lt;br/&gt;
        at org.apache.cassandra.io.util.FileUtils.deleteWithConfirm(FileUtils.java:51)&lt;br/&gt;
        at org.apache.cassandra.io.util.FileUtils.deleteWithConfirm(FileUtils.java:41)&lt;br/&gt;
        at org.apache.cassandra.io.sstable.SSTable.delete(SSTable.java:133)&lt;br/&gt;
        ... 4 more&lt;br/&gt;
Exception encountered during startup.&lt;br/&gt;
java.io.IOError: java.io.IOException: Failed to delete /cassandra/data/table_task/table_task-tmp-f-1707-Data.db&lt;br/&gt;
        at org.apache.cassandra.io.sstable.SSTable.delete(SSTable.java:145)&lt;br/&gt;
        at org.apache.cassandra.db.ColumnFamilyStore.scrubDataDirectories(ColumnFamilyStore.java:468)&lt;br/&gt;
        at org.apache.cassandra.service.AbstractCassandraDaemon.setup(AbstractCassandraDaemon.java:153)&lt;br/&gt;
        at org.apache.cassandra.service.AbstractCassandraDaemon.activate(AbstractCassandraDaemon.java:316)&lt;br/&gt;
        at org.apache.cassandra.thrift.CassandraDaemon.main(CassandraDaemon.java:79)&lt;br/&gt;
Caused by: java.io.IOException: Failed to delete /cassandra/data/table_task/table_task-tmp-f-1707-Data.db&lt;br/&gt;
        at org.apache.cassandra.io.util.FileUtils.deleteWithConfirm(FileUtils.java:51)&lt;br/&gt;
        at org.apache.cassandra.io.util.FileUtils.deleteWithConfirm(FileUtils.java:41)&lt;br/&gt;
        at org.apache.cassandra.io.sstable.SSTable.delete(SSTable.java:133)&lt;br/&gt;
        ... 4 more&lt;/p&gt;</description>
                <environment>&lt;p&gt;linux&lt;/p&gt;</environment>
        <key id="12499221">CASSANDRA-2206</key>
            <summary>Startup fails due to cassandra trying to delete nonexisting file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="tbritz">Thibaut</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Feb 2011 11:57:16 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:06 +0000</updated>
                            <resolved>Thu, 24 Feb 2011 15:14:43 +0000</resolved>
                                        <fixVersion>0.7.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="12997424" author="jbellis" created="Mon, 21 Feb 2011 14:37:08 +0000"  >&lt;p&gt;You can manually fix this by removing the &quot;tmp&quot; from all the tmp-f-1707 files.&lt;/p&gt;</comment>
                            <comment id="12997429" author="jbellis" created="Mon, 21 Feb 2011 14:51:17 +0000"  >&lt;p&gt;Patch to fix this for new files by making sure we rename -Data last.&lt;/p&gt;</comment>
                            <comment id="12998218" author="mdennis" created="Wed, 23 Feb 2011 07:57:38 +0000"  >&lt;p&gt;renaming -data files last doesn&apos;t actually fix the problem.&lt;/p&gt;

&lt;p&gt;You can test this by running&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cd /var/lib/cassandra/data/system
touch Schema-tmp-f-763-Data.db  Schema-f-763-Filter.db
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;before starting cassandra.&lt;/p&gt;

&lt;p&gt;This would simulate a crash between renaming all the the components besides -data and renaming -data (though really a crash any time between when the first component is renamed and before -data is renamed will exhibit the issue).&lt;/p&gt;</comment>
                            <comment id="12998613" author="jbellis" created="Wed, 23 Feb 2011 23:44:15 +0000"  >&lt;p&gt;v2 also fixes a bug where tmp and non-tmp Descriptors were considered equal, which is what confused the file scanning for scrub in your example&lt;/p&gt;</comment>
                            <comment id="12998885" author="gdusbabek" created="Thu, 24 Feb 2011 15:12:17 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12998887" author="jbellis" created="Thu, 24 Feb 2011 15:14:43 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                            <comment id="12998901" author="hudson" created="Thu, 24 Feb 2011 15:39:39 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #316 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/316/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/316/&lt;/a&gt;)&lt;br/&gt;
    improve detection and cleanup ofpartially-written sstables&lt;br/&gt;
patch by jbellis; reviewed by gdusbabek for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2206&quot; title=&quot;Startup fails due to cassandra trying to delete nonexisting file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2206&quot;&gt;&lt;del&gt;CASSANDRA-2206&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12471786" name="2206-v2.txt" size="2152" author="jbellis" created="Wed, 23 Feb 2011 23:44:15 +0000"/>
                            <attachment id="12471565" name="2206.txt" size="1283" author="jbellis" created="Mon, 21 Feb 2011 14:52:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20503</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 39 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g9yv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>93045</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>gdusbabek</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[gdusbabek]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>