<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:22:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3039] AssertionError on nodetool cleanup</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3039</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;While doing a cleanup I got the following AssertionError, I have tried a scrub and a major compaction before the cleanup which has not helped.&lt;/p&gt;

&lt;p&gt;ST:&lt;/p&gt;

&lt;p&gt; INFO 18:49:58,540 Scrubbing SSTableReader(path=&apos;/vol/cassandra/data/system/LocationInfo-g-93-Data.db&apos;)&lt;br/&gt;
 INFO 18:49:58,834 Scrub of SSTableReader(path=&apos;/vol/cassandra/data/system/LocationInfo-g-93-Data.db&apos;) complete: 4 rows in new sstable and 0 empty (tombstoned) rows dropped&lt;br/&gt;
 INFO 18:49:58,913 Scrubbing SSTableReader(path=&apos;/vol/cassandra/data/system/Migrations-g-56-Data.db&apos;)&lt;br/&gt;
 INFO 18:49:59,218 Scrub of SSTableReader(path=&apos;/vol/cassandra/data/system/Migrations-g-56-Data.db&apos;) complete: 1 rows in new sstable and 0 empty (tombstoned) rows dropped&lt;br/&gt;
 INFO 18:49:59,256 Scrubbing SSTableReader(path=&apos;/vol/cassandra/data/system/Schema-g-58-Data.db&apos;)&lt;br/&gt;
 INFO 18:49:59,323 Scrub of SSTableReader(path=&apos;/vol/cassandra/data/system/Schema-g-58-Data.db&apos;) complete: 34 rows in new sstable and 0 empty (tombstoned) rows dropped&lt;br/&gt;
 INFO 18:49:59,416 Scrubbing SSTableReader(path=&apos;/vol/cassandra/data/SpiderServices/Content2-g-5074-Data.db&apos;)&lt;br/&gt;
 INFO 18:50:50,137 Scrub of SSTableReader(path=&apos;/vol/cassandra/data/SpiderServices/Content2-g-5074-Data.db&apos;) complete: 91735 rows in new sstable and 32 empty (tombstoned) rows dropped&lt;br/&gt;
 INFO 18:50:50,137 Scrubbing SSTableReader(path=&apos;/vol/cassandra/data/SpiderServices/Content2-g-5075-Data.db&apos;)&lt;br/&gt;
 INFO 18:50:53,075 Scrub of SSTableReader(path=&apos;/vol/cassandra/data/SpiderServices/Content2-g-5075-Data.db&apos;) complete: 27940 rows in new sstable and 0 empty (tombstoned) rows dropped&lt;br/&gt;
 INFO 18:50:53,089 Scrubbing SSTableReader(path=&apos;/vol/cassandra/data/SpiderServices/Content-g-238-Data.db&apos;)&lt;/p&gt;

&lt;p&gt; INFO 18:51:10,302 Scrub of SSTableReader(path=&apos;/vol/cassandra/data/SpiderServices/Content-g-238-Data.db&apos;) complete: 70815 rows in new sstable and 0 empty (tombstoned) rows dropped&lt;br/&gt;
 INFO 18:53:05,420 Cleaning up SSTableReader(path=&apos;/vol/cassandra/data/SpiderServices/Content2-g-5078-Data.db&apos;)&lt;br/&gt;
 INFO 18:53:13,266 Cleaned up to /vol/cassandra/data/SpiderServices/Content2-tmp-g-5079-Data.db.  198,705,176 to 198,705,176 (~100% of original) bytes for 27,940 keys.  Time: 7,846ms.&lt;br/&gt;
 INFO 18:53:13,267 Cleaning up SSTableReader(path=&apos;/vol/cassandra/data/SpiderServices/Content2-g-5077-Data.db&apos;)&lt;br/&gt;
ERROR 18:53:33,913 Fatal exception in thread Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;CompactionExecutor:21,1,RMI Runtime&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.AssertionError&lt;br/&gt;
	at org.apache.cassandra.db.compaction.PrecompactedRow.write(PrecompactedRow.java:107)&lt;br/&gt;
	at org.apache.cassandra.io.sstable.SSTableWriter.append(SSTableWriter.java:132)&lt;br/&gt;
	at org.apache.cassandra.db.compaction.CompactionManager.doCleanupCompaction(CompactionManager.java:866)&lt;br/&gt;
	at org.apache.cassandra.db.compaction.CompactionManager.access$500(CompactionManager.java:65)&lt;br/&gt;
	at org.apache.cassandra.db.compaction.CompactionManager$2.call(CompactionManager.java:204)&lt;br/&gt;
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)&lt;br/&gt;
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:662)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Distributor ID:	Ubuntu&lt;br/&gt;
Description:	Ubuntu 10.10&lt;br/&gt;
Release:	10.10&lt;br/&gt;
Codename:	maverick&lt;/p&gt;

&lt;p&gt;AWS: m2.xlarge instance&lt;/p&gt;

&lt;p&gt;6 Node Cluster&lt;/p&gt;</environment>
        <key id="12518911">CASSANDRA-3039</key>
            <summary>AssertionError on nodetool cleanup</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="rays">Ray Slakinski</reporter>
                        <labels>
                            <label>exception</label>
                            <label>nodetool</label>
                    </labels>
                <created>Mon, 15 Aug 2011 19:18:47 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:53 +0000</updated>
                            <resolved>Tue, 16 Aug 2011 19:23:22 +0000</resolved>
                                        <fixVersion>0.8.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13085285" author="jbellis" created="Mon, 15 Aug 2011 19:42:28 +0000"  >&lt;p&gt;Patch to make cleanup and normal compaction able to skip empty rows (rows containing nothing but expired tombstones).&lt;/p&gt;

&lt;p&gt;Scrub can already handle these, so you can workaround by scrubbing frequently, but if your workload results in a lot of these rows you probably want to apply this patch sooner than later.&lt;/p&gt;</comment>
                            <comment id="13085911" author="xedin" created="Tue, 16 Aug 2011 19:23:22 +0000"  >&lt;p&gt;committed.&lt;/p&gt;</comment>
                            <comment id="13085984" author="hudson" created="Tue, 16 Aug 2011 21:22:28 +0000"  >&lt;p&gt;Integrated in Cassandra-0.8 #281 (See &lt;a href=&quot;https://builds.apache.org/job/Cassandra-0.8/281/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Cassandra-0.8/281/&lt;/a&gt;)&lt;br/&gt;
    Make cleanup and normal compaction able to skip empty rows (rows containing nothing but expired tombstones).&lt;br/&gt;
patch by Jonathan Ellis; reviewed by Pavel Yaskevich for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3039&quot; title=&quot;AssertionError on nodetool cleanup&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3039&quot;&gt;&lt;del&gt;CASSANDRA-3039&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;xedin : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1158425&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1158425&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/cassandra/branches/cassandra-0.8/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/db/compaction/CompactionManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12490464" name="3039.txt" size="1376" author="jbellis" created="Mon, 15 Aug 2011 19:42:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20946</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gezz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>93860</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>xedin</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[xedin]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>