<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:07:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13329] max_hints_delivery_threads does not work</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13329</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;HintsDispatchExecutor creates JMXEnabledThreadPoolExecutor with corePoolSize  == 1 and maxPoolSize==max_hints_delivery_threads and unbounded LinkedBlockingQueue.&lt;/p&gt;

&lt;p&gt;In this configuration additional threads will not be created.&lt;/p&gt;

&lt;p&gt;Same problem with PerSSTableIndexWriter.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13056184">CASSANDRA-13329</key>
            <summary>max_hints_delivery_threads does not work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Gerrrr">Alex Sorokoumov</assignee>
                                    <reporter username="Fuud">Fuud</reporter>
                        <labels>
                            <label>lhf</label>
                    </labels>
                <created>Wed, 15 Mar 2017 06:25:26 +0000</created>
                <updated>Fri, 15 May 2020 08:01:20 +0000</updated>
                            <resolved>Fri, 7 Apr 2017 10:34:58 +0000</resolved>
                                        <fixVersion>3.11.0</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15940242" author="gerrrr" created="Fri, 24 Mar 2017 12:36:03 +0000"  >&lt;p&gt;&lt;tt&gt;JMXEnabledThreadPoolExecutor&lt;/tt&gt; (used by &lt;tt&gt;HintsDispatchExecutor&lt;/tt&gt; and &lt;tt&gt;PerSSTableIndexWriter&lt;/tt&gt;) extends &lt;tt&gt;DebuggableThreadPoolExecutor&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;According to the docs on &lt;tt&gt;DebuggableThreadPoolExecutor&lt;/tt&gt; it works in the following way:&lt;br/&gt;
1. If fewer than corePoolSize threads are running, the Executor always prefers adding a new thread rather than queuing.&lt;br/&gt;
2. If corePoolSize or more threads are running, the Executor always prefers queuing a request rather than adding a new thread.&lt;br/&gt;
3. If a request cannot be queued, a new thread is created unless this would exceed maximumPoolSize, in which case, the task will be rejected.&lt;/p&gt;

&lt;p&gt;In both &lt;tt&gt;HintsDispatchExecutor&lt;/tt&gt; and &lt;tt&gt;PerSSTableIndexWriter&lt;/tt&gt;, &lt;tt&gt;JMXEnabledThreadPoolExecutor&lt;/tt&gt; is constructed with corePoolSize equal to 1, maximumPoolSize equal to some constant and a work queue being unbounded &lt;tt&gt;LinkedBlockingQueue&lt;/tt&gt;. In that setup when there are no tasks running, the new incoming task will add a thread to the pool (according to #1). However, because the queue is unbounded, according to #2 all the consequent tasks will be added to the queue instead of adding threads to the pool. Having corePoolSize equal to maximumPoolSize solves the problem because then the pool will maintain maximumPoolSize threads and submit tasks to them before queueing.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Link to the branch&lt;/b&gt;: &lt;a href=&quot;https://github.com/Gerrrr/cassandra/tree/13329-3.10&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Gerrrr/cassandra/tree/13329-3.10&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15945324" author="ifesdjeen" created="Tue, 28 Mar 2017 14:58:25 +0000"  >&lt;p&gt;+1, LGTM&lt;/p&gt;

&lt;p&gt;I&apos;ve written a small test to verify the behaviour &lt;a href=&quot;https://github.com/ifesdjeen/cassandra/commit/8c2a322bf0bdaf0d198384992caa793f8289b533&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; although I do not think we should include it into the final patch, since it&apos;s rather a configuration/initialisation problem.&lt;/p&gt;

&lt;p&gt;And triggered CI for 3.11 and trunk: &lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ifesdjeen:13329-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/job/ifesdjeen-13329-trunk-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/job/ifesdjeen-13329-trunk-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ifesdjeen:13329-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/job/ifesdjeen-13329-trunk-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://cassci.datastax.com/job/ifesdjeen-13329-3.11-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15960587" author="ifesdjeen" created="Fri, 7 Apr 2017 10:34:52 +0000"  >&lt;p&gt;Committed to 3.11 as &lt;a href=&quot;https://github.com/apache/cassandra/commit/8eeea07f5f74eb86403e84464107b75c5063cf6b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;8eeea07f5f74eb86403e84464107b75c5063cf6b&lt;/a&gt; and merged to &lt;a href=&quot;https://github.com/apache/cassandra/commit/a0a0e823e3095b9a47a3d11b3d58b14c039e1ced&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15963396" author="alekiv" created="Mon, 10 Apr 2017 19:33:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gerrrr&quot; class=&quot;user-hover&quot; rel=&quot;Gerrrr&quot;&gt;Gerrrr&lt;/a&gt;: do you have plans to fix this problem(max_hints_delivery_threads part) in 3.0.x version?&lt;/p&gt;</comment>
                            <comment id="15963421" author="gerrrr" created="Mon, 10 Apr 2017 19:56:35 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alekiv&quot; class=&quot;user-hover&quot; rel=&quot;alekiv&quot;&gt;alekiv&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thank you for the suggestion! I have created a branch for 3.0 - &lt;a href=&quot;https://github.com/Gerrrr/cassandra/tree/13329-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Gerrrr/cassandra/tree/13329-3.0&lt;/a&gt;&lt;br/&gt;
The fix there is only for HintsDispatchExecutor since there was no PerSSTableIndexWriter.&lt;/p&gt;</comment>
                            <comment id="16073367" author="alekiv" created="Tue, 4 Jul 2017 09:11:56 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gerrrr&quot; class=&quot;user-hover&quot; rel=&quot;Gerrrr&quot;&gt;Gerrrr&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;do you have plans to create pull request for 3.0.x version?&lt;/p&gt;</comment>
                            <comment id="16088914" author="gerrrr" created="Sun, 16 Jul 2017 12:38:25 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt;,&lt;br/&gt;
Can you please check the patch for 3.0 &lt;a href=&quot;https://github.com/Gerrrr/cassandra/tree/13329-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Gerrrr/cassandra/tree/13329-3.0&lt;/a&gt; ?&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="16096063" author="ifesdjeen" created="Fri, 21 Jul 2017 09:40:21 +0000"  >&lt;p&gt;Committed the backport to 3.0 with &lt;a href=&quot;https://github.com/apache/cassandra/commit/b337c690d321f2e4d7ebbbb0a1b8a90f986d21e9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;b337c690d321f2e4d7ebbbb0a1b8a90f986d21e9&lt;/a&gt;, merged up to &lt;a href=&quot;https://github.com/apache/cassandra/commit/bf0a4b9cd6324e9c5adfe8cdd72ecb1c3a70568a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt; and &lt;a href=&quot;https://github.com/apache/cassandra/commit/8d2fa65f8a7abbc27b0c3ff0820af2945fcf7496&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;. I&apos;ve also taken a chance to make call syntax consistent across the branches (1-arg call instead of passing same var twice).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[Gerrrr]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3caaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ifesdjeen</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>