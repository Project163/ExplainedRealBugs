<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:21:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-16835] Scrub still uses &quot;row&quot; to mean &quot;partitions&quot;, and has broken code</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-16835</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;2 issues in the scrub code:&lt;br/&gt;
 1) It still uses &quot;row&quot; to mean &quot;partition&quot;. And not only in the code, but also in user messages. As we&apos;ve fairly systematically remove such instances elsewhere in 3.0+, having it in scrub is going to confuse users which will almost surely misinterpret the results. If scrub says that it dropped 2 unreadable &quot;rows&quot; from your sstable, you might be ok with that when we&apos;re actually talking about CQL rows, but not if we talk of 2 full partitions.&lt;br/&gt;
 2) There is a branch at the end of scrub that is supposed to handle the case where scrubbing a sstable generates no output at all (the sstable is completely hosed usually), mostly providing a more user friendly message. The code is broken (and has been for a long time, since &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7066&quot; title=&quot;Simplify (and unify) cleanup of compaction leftovers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7066&quot;&gt;&lt;del&gt;CASSANDRA-7066&lt;/del&gt;&lt;/a&gt; I believe) however such that this branch can simply never be taken (even when it should). While admittedly pretty minor, no reason to leave it that way.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13394279">CASSANDRA-16835</key>
            <summary>Scrub still uses &quot;row&quot; to mean &quot;partitions&quot;, and has broken code</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="edimitrova">Ekaterina Dimitrova</assignee>
                                    <reporter username="edimitrova">Ekaterina Dimitrova</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Aug 2021 20:45:41 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:55 +0000</updated>
                            <resolved>Tue, 17 Aug 2021 19:23:11 +0000</resolved>
                                        <fixVersion>3.11.12</fixVersion>
                    <fixVersion>4.0.1</fixVersion>
                    <fixVersion>4.1-alpha1</fixVersion>
                    <fixVersion>4.1</fixVersion>
                                    <component>Tool/nodetool</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17396932" author="edimitrova" created="Tue, 10 Aug 2021 23:04:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:16835-3.11?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;, &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:16835-4.0?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&#160;patches.&lt;br/&gt;
 The trunk patch will be identical with 4.0.&lt;br/&gt;
 I ran the respective tests locally for now. I didn&apos;t clean unrelated warnings as I didn&apos;t want to overwhelm the patch at this point with unrelated changes but if a reviewer insists, I can add that later too. &lt;br/&gt;
 I will also run full CI pre-commit.&lt;/p&gt;</comment>
                            <comment id="17397455" author="brandon.williams" created="Wed, 11 Aug 2021 16:20:35 +0000"  >&lt;p&gt;Looks good to me, +1.  The bug fixed was around completed/finished.isEmpty()?&lt;/p&gt;</comment>
                            <comment id="17397463" author="edimitrova" created="Wed, 11 Aug 2021 16:27:20 +0000"  >&lt;p&gt;Thank you for the review.&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The bug fixed was around completed/finished.isEmpty()?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, that is the one, I guess I had to put it in a separate commit for clarity. Sorry.&lt;/p&gt;

&lt;p&gt;I will propagate also to trunk and run full CI on all three branches for sanity check.&lt;/p&gt;</comment>
                            <comment id="17397479" author="edimitrova" created="Wed, 11 Aug 2021 16:52:02 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Patch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:16835-3.11?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://jenkins-cm4.apache.org/job/Cassandra-devbranch/1006/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Jenkins&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:16835-4.0?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://jenkins-cm4.apache.org/job/Cassandra-devbranch/1007/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Jenkins&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...ekaterinadimitrova2:16835-trunk?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://jenkins-cm4.apache.org/job/Cassandra-devbranch/1008/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Jenkins&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17397480" author="edimitrova" created="Wed, 11 Aug 2021 16:53:10 +0000"  >&lt;p&gt;I will commit on green CI&#160;&lt;/p&gt;</comment>
                            <comment id="17398380" author="edimitrova" created="Fri, 13 Aug 2021 01:52:13 +0000"  >&lt;p&gt;Unfortunately, &lt;em&gt;testRecoverOverflowedExpirationWithSSTableScrub&lt;/em&gt; is failing on 4.0. I will check it tomorrow, hopefully it is only test issue. &lt;/p&gt;</comment>
                            <comment id="17399923" author="edimitrova" created="Mon, 16 Aug 2021 18:28:10 +0000"  >&lt;p&gt;I think it is a test issue. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;,&#160;as you were also involved In&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16013&quot; title=&quot;sstablescrub unit test hardening and docs improvements&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16013&quot;&gt;&lt;del&gt;CASSANDRA-16013&lt;/del&gt;&lt;/a&gt; where &lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/06aca0e4a995f0fff4e4eac76d1d81d27d181239#diff-702da23770e443ad8b0ac0a4b94c6b9fbf1c3727fcab13b734389e49878ff175L430&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this assertion&lt;/a&gt;&#160;(the fix will apply to 4.0 and trunk) was added, can you confirm It, please, that I am not missing anything?&#160;&lt;/p&gt;</comment>
                            <comment id="17399948" author="brandon.williams" created="Mon, 16 Aug 2021 18:58:38 +0000"  >&lt;p&gt;That looks like what we need, +1.&lt;/p&gt;</comment>
                            <comment id="17400015" author="edimitrova" created="Mon, 16 Aug 2021 21:21:58 +0000"  >&lt;p&gt;Great, thanks. Then squash, rebase and then these are last(hopefully) CI runs:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Patch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/ed49d3edad9b9e86952808e7585f6dce69785e2b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1073/workflows/5fb0b764-bfc0-4409-9d3b-b65fe07f13e0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CircleCI&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/af10a0c1f6f9824b4933fb65d42c860c0fc4766a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1074/workflows/40500114-c53e-42b3-bee1-d48b0c1e3e20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CircleCI j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1074/workflows/5e0527f6-a1d1-4be6-af1d-dc120395bdf7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/ekaterinadimitrova2/cassandra/commit/6af63779aa6f4dab4b184a0e4ff612ec3c6c3536&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1075/workflows/8d4f1f0f-1e46-4e52-8064-ceaa02735a05&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CircleCI j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1075/workflows/a326d796-3350-4655-a2c9-80175f46a776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17400407" author="edimitrova" created="Tue, 17 Aug 2021 13:52:34 +0000"  >&lt;p&gt;All known errors.&lt;/p&gt;

&lt;p&gt;Except &lt;a href=&quot;https://app.circleci.com/pipelines/github/ekaterinadimitrova2/cassandra/1082/workflows/8dacef5d-46f4-4b59-a8f7-08824bf1180f/jobs/6407/tests#failed-test-0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this one&lt;/a&gt;&#160;which is stable in Jenkins but shows as flaky in the multiplexer so I am going to open a separate ticket for it.&#160;&lt;/p&gt;

&lt;p&gt;Preparing to commit&lt;/p&gt;</comment>
                            <comment id="17400576" author="edimitrova" created="Tue, 17 Aug 2021 19:22:17 +0000"  >&lt;p&gt;Committed, thanks.&lt;/p&gt;

&lt;p&gt;To &lt;a href=&quot;https://github.com/apache/cassandra.git&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra.git&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&#160; 770dee5a57..e581a85b93&#160; cassandra-3.11 -&amp;gt; cassandra-3.11&lt;/p&gt;

&lt;p&gt;&#160;&#160; af6654cb06..cb19b39827&#160; cassandra-4.0 -&amp;gt; cassandra-4.0&lt;/p&gt;

&lt;p&gt;&#160;&#160; dc77cb8729..5b325b8c51&#160; trunk -&amp;gt; trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[edimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 13 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0tqp4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/e581a85b93acff0fecef7d41d9a94a2f89f810ba&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/e581a85b93acff0fecef7d41d9a94a2f89f810ba&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16835?focusedCommentId=17396932&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17396932&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-16835?focusedCommentId=17396932&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-17396932&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>