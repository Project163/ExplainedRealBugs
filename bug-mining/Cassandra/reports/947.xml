<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:21:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2644] Make bootstrap retry</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2644</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;We ran into a situation where we had rpc_timeout set to 1 second, and the node needing to compute the token took over a second (1.6 seconds). The bootstrapping node hangs forever without getting a token because the expiring map removes it before the reply comes back.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12507049">CASSANDRA-2644</key>
            <summary>Make bootstrap retry</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lenn0x">Chris Goffinet</assignee>
                                    <reporter username="lenn0x">Chris Goffinet</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 May 2011 22:22:05 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:59 +0000</updated>
                            <resolved>Mon, 30 May 2011 08:52:14 +0000</resolved>
                                        <fixVersion>0.8.1</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13032715" author="lenn0x" created="Thu, 12 May 2011 22:23:09 +0000"  >&lt;p&gt;I have a patch for this I&apos;ll be adding within the next day. I make ExpiringMap support custom timeouts per object, and make bootstrap getToken retry, while exponentially increasing the timeout until retries is met.&lt;/p&gt;</comment>
                            <comment id="13032734" author="stuhood" created="Thu, 12 May 2011 22:52:49 +0000"  >&lt;p&gt;+1&lt;br/&gt;
Thanks Chris!&lt;/p&gt;</comment>
                            <comment id="13032741" author="jbellis" created="Thu, 12 May 2011 23:09:42 +0000"  >&lt;p&gt;I think the retry logic is a distraction here. If it doesn&apos;t work the first time because of anything other than &quot;we didn&apos;t wait long enough&quot; (i.e. it errored out) it&apos;s not likely to magically unbreak for the second.&lt;/p&gt;

&lt;p&gt;Suggest just giving it a long retry to begin with.&lt;/p&gt;</comment>
                            <comment id="13032823" author="stuhood" created="Fri, 13 May 2011 04:37:18 +0000"  >&lt;p&gt;Good point. But there are still cases that retries will recover from... flapping/down nodes, etc.&lt;/p&gt;

&lt;p&gt;IMO, we should fix the performance issue independently (opened &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2645&quot; title=&quot;Improve getBootstrapToken efficiency&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2645&quot;&gt;&lt;del&gt;CASSANDRA-2645&lt;/del&gt;&lt;/a&gt;), and consider retrying to be a best practice that should spread to more places in the codebase.&lt;/p&gt;</comment>
                            <comment id="13032871" author="slebresne" created="Fri, 13 May 2011 07:35:37 +0000"  >&lt;p&gt;Not fully related to the discussion here but streaming is another part of bootstrap so I&apos;ll mention that &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2433&quot; title=&quot;Failed Streams Break Repair&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2433&quot;&gt;&lt;del&gt;CASSANDRA-2433&lt;/del&gt;&lt;/a&gt; introduces some mechanism to handle unrecoverable failures during streaming (that is, streaming already retry on errors but 1) it retries indefinitely while the &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2433&quot; title=&quot;Failed Streams Break Repair&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2433&quot;&gt;&lt;del&gt;CASSANDRA-2433&lt;/del&gt;&lt;/a&gt; introduce a max retry and 2) it doesn&apos;t detect the other end being dead). Anyway, just referencing the ticket so that if this ticket becomes &quot;make bootstrap handle failures better&quot;, we don&apos;t duplicate efforts.   &lt;/p&gt;</comment>
                            <comment id="13035098" author="jbellis" created="Tue, 17 May 2011 22:17:44 +0000"  >&lt;blockquote&gt;&lt;p&gt;But there are still cases that retries will recover from... flapping/down nodes&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Fair enough, but increasing the timeout is still unwarranted.  Let&apos;s just make it wait for max(DEFAULT_TIMEOUT, BOOTSTRAP_TIMEOUT) with B_T equal to, say, 30s.&lt;/p&gt;

&lt;p&gt;Committed patch 01 to 0.8.1 branch, btw.&lt;/p&gt;</comment>
                            <comment id="13041045" author="lenn0x" created="Mon, 30 May 2011 08:48:50 +0000"  >&lt;p&gt;Made changes to 02 patch, and commited to 0.8.1. Thanks!&lt;/p&gt;</comment>
                            <comment id="13041150" author="hudson" created="Mon, 30 May 2011 14:44:42 +0000"  >&lt;p&gt;Integrated in Cassandra #912 (See &lt;a href=&quot;https://builds.apache.org/hudson/job/Cassandra/912/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/hudson/job/Cassandra/912/&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="13041155" author="hudson" created="Mon, 30 May 2011 14:55:47 +0000"  >&lt;p&gt;Integrated in Cassandra-0.8 #146 (See &lt;a href=&quot;https://builds.apache.org/hudson/job/Cassandra-0.8/146/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/hudson/job/Cassandra-0.8/146/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12479021" name="0001-Make-ExpiringMap-have-objects-with-specific-timeouts.patch" size="7340" author="lenn0x" created="Thu, 12 May 2011 22:41:26 +0000"/>
                            <attachment id="12479022" name="0002-Make-bootstrap-retry-and-increment-timeout-for-every.patch" size="2765" author="lenn0x" created="Thu, 12 May 2011 22:41:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[lenn0x]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20749</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 26 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gclj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>93471</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>stuhood</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stuhood]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>