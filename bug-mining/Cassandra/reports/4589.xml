<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:05:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-12959] copy from csv import wrong values with udt having set when fields are not specified in correct order in csv</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-12959</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description> &lt;blockquote&gt;
&lt;p&gt;create KEYSPACE test WITH replication = { &apos;class&apos;: &apos;SimpleStrategy&apos;, &apos;replication_factor&apos;: 1};&lt;/p&gt;

&lt;p&gt;CREATE TYPE test.my_udt (&lt;br/&gt;
    first_field text,&lt;br/&gt;
    second_field frozen&amp;lt;set&amp;lt;text&amp;gt;&amp;gt;&lt;br/&gt;
);&lt;/p&gt;

&lt;p&gt;CREATE TABLE test.test ( key text, value my_udt, PRIMARY KEY (key));&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The following works as expected : &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;INSERT INTO test.test (key , value ) VALUES ( &apos;key1&apos;, {second_field: {&apos;test1&apos;, &apos;test2&apos;}, first_field: &apos;first_field&apos;});&lt;/p&gt;

&lt;p&gt; key  | value&lt;br/&gt;
-----&lt;del&gt;+&lt;/del&gt;---------------------------------------------------------------&lt;br/&gt;
 key1 | {first_field: &apos;first_field&apos;, second_field: {&apos;test1&apos;, &apos;test2&apos;}}&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;but when inserted using a .csv the result is wrong:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;&quot;key1&quot;,&quot;{second_field: {&apos;test1&apos;, &apos;test2&apos;}, first_field: &apos;first_field&apos;}&quot;&lt;/p&gt;

&lt;p&gt;COPY test.test FROM &apos;~/test.csv&apos;;&lt;/p&gt;

&lt;p&gt; key  | value&lt;br/&gt;
-----&lt;del&gt;+&lt;/del&gt;---------------------------------------------------------------------&lt;br/&gt;
 key1 | {first_field: &apos;{&apos;&apos;test1&apos;&apos;, &apos;&apos;test2&apos;&apos;}&apos;, second_field: {&apos;irst_fiel&apos;}}&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;it works as expected if the keys are in order: &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&quot;key1&quot;,&quot;{first_field: &apos;first_field&apos;, second_field: {&apos;test1&apos;, &apos;test2&apos;}}&quot;)&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="13023588">CASSANDRA-12959</key>
            <summary>copy from csv import wrong values with udt having set when fields are not specified in correct order in csv</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="qambard">Quentin Ambard</reporter>
                        <labels>
                    </labels>
                <created>Sun, 27 Nov 2016 17:04:20 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:14 +0000</updated>
                            <resolved>Thu, 22 Dec 2016 02:32:16 +0000</resolved>
                                        <fixVersion>2.1.17</fixVersion>
                    <fixVersion>2.2.9</fixVersion>
                    <fixVersion>3.0.11</fixVersion>
                    <fixVersion>3.10</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15744340" author="stefania" created="Tue, 13 Dec 2016 06:34:47 +0000"  >&lt;p&gt;This is a regression of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9302&quot; title=&quot;Optimize cqlsh COPY FROM, part 3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9302&quot;&gt;&lt;del&gt;CASSANDRA-9302&lt;/del&gt;&lt;/a&gt;: if the udt fields are not in the correct order, it imports values incorrectly or it fails with a conversion error if the types are incompatible.&lt;/p&gt;

&lt;p&gt;This is the patch for all branches starting with 2.1. Although this is not a critical bug, I argue that it should be in 2.1 because it is a regression and it is safe to fix. Since the patch applies cleanly to all branches, I have launched CI only on 4 of the 6 eligible branches (I skipped 3.11 and 3.x):&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/tree/12959-cqlsh-2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/tree/12959-cqlsh-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/tree/12959-cqlsh-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/tree/12959-cqlsh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12959-cqlsh-2.1-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12959-cqlsh-2.2-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12959-cqlsh-3.0-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12959-cqlsh-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;The test to reproduce this problem is &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/1406&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thobbs&quot; class=&quot;user-hover&quot; rel=&quot;thobbs&quot;&gt;thobbs&lt;/a&gt;, would you be able to review?&lt;/p&gt;</comment>
                            <comment id="15744488" author="stefania" created="Tue, 13 Dec 2016 07:52:50 +0000"  >&lt;p&gt;For 2.1 the cqlsh tests do not run, so I&apos;ve launched the dtests &lt;a href=&quot;http://cassci.datastax.com/job/stef1927-12959-cqlsh-2.1-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15747194" author="stefania" created="Wed, 14 Dec 2016 04:14:31 +0000"  >&lt;p&gt;Thanks for taking the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt;! Hopefully you haven&apos;t looked at the patch yet, and so it makes no difference, but I just modified it slightly so that we can handle missing UDT fields as well. The patch is still quite small and it applies without conflicts to all branches. CI is pending.&lt;/p&gt;</comment>
                            <comment id="15767946" author="pauloricardomg" created="Wed, 21 Dec 2016 19:36:37 +0000"  >&lt;p&gt;Patch and tests look good! I&apos;m a bit impressed parsing &lt;tt&gt;&apos;first_field&apos;&lt;/tt&gt; to &lt;tt&gt;frozen&amp;lt;set&amp;lt;text&amp;gt;&amp;gt;&lt;/tt&gt; did not error out, but was actually parsed as {&lt;tt&gt;&apos;irst_fiel&apos;&lt;/tt&gt;}, is this something we should look into (maybe in a separate ticket)?&lt;/p&gt;

&lt;p&gt;Agreed this should go in 2.1 since it&apos;s a very simple fix and also bit critical since it can cause silent corruption if the import results are not verified.&lt;/p&gt;

&lt;p&gt;2.1 tests did not run, I resubmitted and will mark as ready to commit if it looks good.&lt;/p&gt;</comment>
                            <comment id="15768570" author="pauloricardomg" created="Thu, 22 Dec 2016 00:21:30 +0000"  >&lt;p&gt;oops, I missed your earlied comment about 2.1 dtests not running. marking as ready to commit! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Thanks!&lt;/p&gt;</comment>
                            <comment id="15768782" author="stefania" created="Thu, 22 Dec 2016 02:18:37 +0000"  >&lt;p&gt;Thank you for the review! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I&apos;m a bit impressed parsing &apos;first_field&apos; to frozen&amp;lt;set&amp;lt;text&amp;gt;&amp;gt; did not error out, but was actually parsed as {&apos;irst_fiel&apos;}, is this something we should look into (maybe in a separate ticket)?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;ve created &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13071&quot; title=&quot;cqlsh copy-from should error out when csv contains invalid data for collections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13071&quot;&gt;&lt;del&gt;CASSANDRA-13071&lt;/del&gt;&lt;/a&gt; for this.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;oops, I missed your earlier comment about 2.1 dtests not running. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The cqlsh tests do not run, but I did run the full dtests, which include cqlsh dtests but not cqlshlib tests and do not test cython. I think this is safe enough for this patch: we never run cqlshlib tests for 2.1, not even on the main branches, whilst cython is not the default and was tested on the other branches.&lt;/p&gt;

&lt;p&gt;I will commit shortly.&lt;/p&gt;</comment>
                            <comment id="15768805" author="stefania" created="Thu, 22 Dec 2016 02:32:16 +0000"  >&lt;p&gt;Committed to 2.1 as bdca25e96e8fc9b6379c599ef001a256e474688e and merged upwards.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 47 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i36ti7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12335695">3.8</customfieldvalue>
    <customfieldvalue id="12337344">3.9</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>pauloricardomg</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>