<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:03:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11465] dtest failure in cql_tracing_test.TestCqlTracing.tracing_unknown_impl_test</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11465</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Failing on the following assert, on trunk only: &lt;tt&gt;self.assertEqual(len(errs&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;), 1)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Is not failing consistently.&lt;/p&gt;

&lt;p&gt;example failure:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/job/trunk_dtest/1087/testReport/cql_tracing_test/TestCqlTracing/tracing_unknown_impl_test&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_dtest/1087/testReport/cql_tracing_test/TestCqlTracing/tracing_unknown_impl_test&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Failed on CassCI build trunk_dtest #1087&lt;/p&gt;</description>
                <environment></environment>
        <key id="12954731">CASSANDRA-11465</key>
            <summary>dtest failure in cql_tracing_test.TestCqlTracing.tracing_unknown_impl_test</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="philipthompson">Philip Thompson</reporter>
                        <labels>
                            <label>dtest</label>
                    </labels>
                <created>Wed, 30 Mar 2016 19:46:38 +0000</created>
                <updated>Wed, 15 Oct 2025 09:49:06 +0000</updated>
                            <resolved>Fri, 29 Jul 2016 07:35:41 +0000</resolved>
                                        <fixVersion>2.2.8</fixVersion>
                    <fixVersion>3.0.9</fixVersion>
                    <fixVersion>3.8</fixVersion>
                                    <component>Legacy/Observability</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="15220227" author="philipthompson" created="Thu, 31 Mar 2016 17:05:14 +0000"  >&lt;p&gt;Also seeing the failure in tracing_default_impl_test&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/job/trunk_novnode_dtest/337/testReport/cql_tracing_test/TestCqlTracing/tracing_default_impl_test/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_novnode_dtest/337/testReport/cql_tracing_test/TestCqlTracing/tracing_default_impl_test/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15226528" author="mambocab" created="Tue, 5 Apr 2016 16:01:43 +0000"  >&lt;p&gt;Merged &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/905&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/riptano/cassandra-dtest/pull/905&lt;/a&gt; for debugging help.&lt;/p&gt;</comment>
                            <comment id="15346620" author="philipthompson" created="Thu, 23 Jun 2016 15:38:33 +0000"  >&lt;p&gt;Here&apos;s the problem:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;dtest: DEBUG: Errors after attempted trace with unknown tracing class: [[&lt;span class=&quot;code-quote&quot;&gt;&quot;ERROR [ScheduledTasks:1] 2016-06-15 03:06:41,111 Tracing.java:106 - Cannot use &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;junk &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; tracing (Unable to find Tracing class &lt;span class=&quot;code-quote&quot;&gt;&apos;junk&apos;&lt;/span&gt;), ignoring by defaulting on normal tracing&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;WARN  [main] 2016-06-15 03:06:41,119 StartupChecks.java:123 - jemalloc shared library could not be preloaded to speed up memory allocations&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;WARN  [main] 2016-06-15 03:06:41,119 StartupChecks.java:156 - JMX is not enabled to receive remote connections. Please see cassandra-env.sh &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more info.&apos;&lt;/span&gt;]]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should be getting those WARNs&lt;/p&gt;</comment>
                            <comment id="15375145" author="mambocab" created="Wed, 13 Jul 2016 14:49:42 +0000"  >&lt;p&gt;Another failure we&apos;re seeing:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/job/trunk_dtest/1288/testReport/junit/cql_tracing_test/TestCqlTracing/tracing_unknown_impl_test/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/trunk_dtest/1288/testReport/junit/cql_tracing_test/TestCqlTracing/tracing_unknown_impl_test/&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos;/127.0.0.1&apos;&lt;/span&gt; not found in &lt;span class=&quot;code-quote&quot;&gt;&quot;Consistency level set to ALL.\nNow Tracing is enabled\n\nTracing session: 54778be0-3c80-11e6-a333-ef4c703100c3\n\n activity                                                                                                                                                             | timestamp                  | source    | source_elapsed | client\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------+-----------+----------------+-----------\n                                                                                                                                                   Execute CQL3 query | 2016-06-27 16:00:55.198000 | 127.0.0.1 |              0 | 127.0.0.1\n Parsing INSERT INTO ks.users (userid, firstname, lastname, age) VALUES (550e8400-e29b-41d4-a716-446655440000, &lt;span class=&quot;code-quote&quot;&gt;&apos;Frodo&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;Baggins&apos;&lt;/span&gt;, 32); [Native-Transport-Requests-2] | 2016-06-27 16:00:55.198000 | 127.0.0.1 |            462 | 127.0.0.1\n                                                                                                                    Preparing statement [Native-Transport-Requests-2] | 2016-06-27 16:00:55.199000 | 127.0.0.1 |            953 | 127.0.0.1\n                                                                                                      Determining replicas &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mutation [Native-Transport-Requests-2] | 2016-06-27 16:00:55.200000 | 127.0.0.1 |           1773 | 127.0.0.1\n                                                                                        Sending MUTATION message to /127.0.0.3 [MessagingService-Outgoing-/127.0.0.3] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4094 | 127.0.0.1\n                                                                                        Sending MUTATION message to /127.0.0.2 [MessagingService-Outgoing-/127.0.0.2] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4117 | 127.0.0.1\n                                                                                                                 Appending to commitlog [Native-Transport-Requests-2] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4270 | 127.0.0.1\n                                                                                                               Adding to users memtable [Native-Transport-Requests-2] | 2016-06-27 16:00:55.203000 | 127.0.0.1 |           4758 | 127.0.0.1\n                                                                             REQUEST_RESPONSE message received from /127.0.0.3 [MessagingService-Incoming-/127.0.0.3] | 2016-06-27 16:00:55.213000 | 127.0.0.1 |          14833 | 127.0.0.1\n                                                                                                         Processing response from /127.0.0.3 [RequestResponseStage-4] | 2016-06-27 16:00:55.213000 | 127.0.0.1 |          15059 | 127.0.0.1\n                                                                             REQUEST_RESPONSE message received from /127.0.0.2 [MessagingService-Incoming-/127.0.0.2] | 2016-06-27 16:00:55.217000 | 127.0.0.1 |          19203 | 127.0.0.1\n                                                                                                         Processing response from /127.0.0.2 [RequestResponseStage-1] | 2016-06-27 16:00:55.217000 | 127.0.0.1 |          19379 | 127.0.0.1\n                                                                                                                                                     Request complete | 2016-06-27 16:00:55.217557 | 127.0.0.1 |          19557 | 127.0.0.1\n\n\n&quot;&lt;/span&gt;
-------------------- &amp;gt;&amp;gt; begin captured logging &amp;lt;&amp;lt; --------------------
dtest: DEBUG: cluster ccm directory: /tmp/dtest-RJbUwP
dtest: DEBUG: Custom init_config not found. Setting defaults.
dtest: DEBUG: Done setting configuration options:
{   &lt;span class=&quot;code-quote&quot;&gt;&apos;initial_token&apos;&lt;/span&gt;: None,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;num_tokens&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;32&apos;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;phi_convict_threshold&apos;&lt;/span&gt;: 5,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;range_request_timeout_in_ms&apos;&lt;/span&gt;: 10000,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;read_request_timeout_in_ms&apos;&lt;/span&gt;: 10000,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;request_timeout_in_ms&apos;&lt;/span&gt;: 10000,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;truncate_request_timeout_in_ms&apos;&lt;/span&gt;: 10000,
    &lt;span class=&quot;code-quote&quot;&gt;&apos;write_request_timeout_in_ms&apos;&lt;/span&gt;: 10000}
dtest: DEBUG: Consistency level set to ALL.
Now Tracing is enabled

Tracing session: 54778be0-3c80-11e6-a333-ef4c703100c3

 activity                                                                                                                                                             | timestamp                  | source    | source_elapsed | client
----------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------+-----------+----------------+-----------
                                                                                                                                                   Execute CQL3 query | 2016-06-27 16:00:55.198000 | 127.0.0.1 |              0 | 127.0.0.1
 Parsing INSERT INTO ks.users (userid, firstname, lastname, age) VALUES (550e8400-e29b-41d4-a716-446655440000, &lt;span class=&quot;code-quote&quot;&gt;&apos;Frodo&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;Baggins&apos;&lt;/span&gt;, 32); [Native-Transport-Requests-2] | 2016-06-27 16:00:55.198000 | 127.0.0.1 |            462 | 127.0.0.1
                                                                                                                    Preparing statement [Native-Transport-Requests-2] | 2016-06-27 16:00:55.199000 | 127.0.0.1 |            953 | 127.0.0.1
                                                                                                      Determining replicas &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mutation [Native-Transport-Requests-2] | 2016-06-27 16:00:55.200000 | 127.0.0.1 |           1773 | 127.0.0.1
                                                                                        Sending MUTATION message to /127.0.0.3 [MessagingService-Outgoing-/127.0.0.3] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4094 | 127.0.0.1
                                                                                        Sending MUTATION message to /127.0.0.2 [MessagingService-Outgoing-/127.0.0.2] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4117 | 127.0.0.1
                                                                                                                 Appending to commitlog [Native-Transport-Requests-2] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4270 | 127.0.0.1
                                                                                                               Adding to users memtable [Native-Transport-Requests-2] | 2016-06-27 16:00:55.203000 | 127.0.0.1 |           4758 | 127.0.0.1
                                                                             REQUEST_RESPONSE message received from /127.0.0.3 [MessagingService-Incoming-/127.0.0.3] | 2016-06-27 16:00:55.213000 | 127.0.0.1 |          14833 | 127.0.0.1
                                                                                                         Processing response from /127.0.0.3 [RequestResponseStage-4] | 2016-06-27 16:00:55.213000 | 127.0.0.1 |          15059 | 127.0.0.1
                                                                             REQUEST_RESPONSE message received from /127.0.0.2 [MessagingService-Incoming-/127.0.0.2] | 2016-06-27 16:00:55.217000 | 127.0.0.1 |          19203 | 127.0.0.1
                                                                                                         Processing response from /127.0.0.2 [RequestResponseStage-1] | 2016-06-27 16:00:55.217000 | 127.0.0.1 |          19379 | 127.0.0.1
                                                                                                                                                     Request complete | 2016-06-27 16:00:55.217557 | 127.0.0.1 |          19557 | 127.0.0.1



--------------------- &amp;gt;&amp;gt; end captured logging &amp;lt;&amp;lt; ---------------------
Stacktrace

  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python2.7/unittest/&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;.py&quot;&lt;/span&gt;, line 329, in run
    testMethod()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/automaton/cassandra-dtest/tools.py&quot;&lt;/span&gt;, line 288, in wrapped
    f(obj)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/automaton/cassandra-dtest/cql_tracing_test.py&quot;&lt;/span&gt;, line 126, in tracing_unknown_impl_test
    self.trace(session)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/automaton/cassandra-dtest/cql_tracing_test.py&quot;&lt;/span&gt;, line 75, in trace
    self.assertIn(&lt;span class=&quot;code-quote&quot;&gt;&apos;/127.0.0.1&apos;&lt;/span&gt;, out)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python2.7/unittest/&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;.py&quot;&lt;/span&gt;, line 803, in assertIn
    self.fail(self._formatMessage(msg, standardMsg))
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/python2.7/unittest/&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;.py&quot;&lt;/span&gt;, line 410, in fail
    raise self.failureException(msg)
&lt;span class=&quot;code-quote&quot;&gt;&apos;\&apos;&lt;/span&gt;/127.0.0.1\&lt;span class=&quot;code-quote&quot;&gt;&apos; not found in &lt;span class=&quot;code-quote&quot;&gt;&quot;Consistency level set to ALL.\\nNow Tracing is enabled\\n\\nTracing session: 54778be0-3c80-11e6-a333-ef4c703100c3\\n\\n activity                                                                                                                                                             | timestamp                  | source    | source_elapsed | client\\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------+-----------+----------------+-----------\\n                                                                                                                                                   Execute CQL3 query | 2016-06-27 16:00:55.198000 | 127.0.0.1 |              0 | 127.0.0.1\\n Parsing INSERT INTO ks.users (userid, firstname, lastname, age) VALUES (550e8400-e29b-41d4-a716-446655440000, \&apos;&lt;/span&gt;Frodo\&lt;span class=&quot;code-quote&quot;&gt;&apos;, \&apos;&lt;/span&gt;Baggins\&lt;span class=&quot;code-quote&quot;&gt;&apos;, 32); [Native-Transport-Requests-2] | 2016-06-27 16:00:55.198000 | 127.0.0.1 |            462 | 127.0.0.1\\n                                                                                                                    Preparing statement [Native-Transport-Requests-2] | 2016-06-27 16:00:55.199000 | 127.0.0.1 |            953 | 127.0.0.1\\n                                                                                                      Determining replicas &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mutation [Native-Transport-Requests-2] | 2016-06-27 16:00:55.200000 | 127.0.0.1 |           1773 | 127.0.0.1\\n                                                                                        Sending MUTATION message to /127.0.0.3 [MessagingService-Outgoing-/127.0.0.3] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4094 | 127.0.0.1\\n                                                                                        Sending MUTATION message to /127.0.0.2 [MessagingService-Outgoing-/127.0.0.2] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4117 | 127.0.0.1\\n                                                                                                                 Appending to commitlog [Native-Transport-Requests-2] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4270 | 127.0.0.1\\n                                                                                                               Adding to users memtable [Native-Transport-Requests-2] | 2016-06-27 16:00:55.203000 | 127.0.0.1 |           4758 | 127.0.0.1\\n                                                                             REQUEST_RESPONSE message received from /127.0.0.3 [MessagingService-Incoming-/127.0.0.3] | 2016-06-27 16:00:55.213000 | 127.0.0.1 |          14833 | 127.0.0.1\\n                                                                                                         Processing response from /127.0.0.3 [RequestResponseStage-4] | 2016-06-27 16:00:55.213000 | 127.0.0.1 |          15059 | 127.0.0.1\\n                                                                             REQUEST_RESPONSE message received from /127.0.0.2 [MessagingService-Incoming-/127.0.0.2] | 2016-06-27 16:00:55.217000 | 127.0.0.1 |          19203 | 127.0.0.1\\n                                                                                                         Processing response from /127.0.0.2 [RequestResponseStage-1] | 2016-06-27 16:00:55.217000 | 127.0.0.1 |          19379 | 127.0.0.1\\n                                                                                                                                                     Request complete | 2016-06-27 16:00:55.217557 | 127.0.0.1 |          19557 | 127.0.0.1\\n\\n\\n&quot;&lt;/span&gt;\n-------------------- &amp;gt;&amp;gt; begin captured logging &amp;lt;&amp;lt; --------------------\ndtest: DEBUG: cluster ccm directory: /tmp/dtest-RJbUwP\ndtest: DEBUG: Custom init_config not found. Setting defaults.\ndtest: DEBUG: Done setting configuration options:\n{   \&apos;&lt;/span&gt;initial_token\&lt;span class=&quot;code-quote&quot;&gt;&apos;: None,\n    \&apos;&lt;/span&gt;num_tokens\&lt;span class=&quot;code-quote&quot;&gt;&apos;: \&apos;&lt;/span&gt;32\&lt;span class=&quot;code-quote&quot;&gt;&apos;,\n    \&apos;&lt;/span&gt;phi_convict_threshold\&lt;span class=&quot;code-quote&quot;&gt;&apos;: 5,\n    \&apos;&lt;/span&gt;range_request_timeout_in_ms\&lt;span class=&quot;code-quote&quot;&gt;&apos;: 10000,\n    \&apos;&lt;/span&gt;read_request_timeout_in_ms\&lt;span class=&quot;code-quote&quot;&gt;&apos;: 10000,\n    \&apos;&lt;/span&gt;request_timeout_in_ms\&lt;span class=&quot;code-quote&quot;&gt;&apos;: 10000,\n    \&apos;&lt;/span&gt;truncate_request_timeout_in_ms\&lt;span class=&quot;code-quote&quot;&gt;&apos;: 10000,\n    \&apos;&lt;/span&gt;write_request_timeout_in_ms\&lt;span class=&quot;code-quote&quot;&gt;&apos;: 10000}\ndtest: DEBUG: Consistency level set to ALL.\nNow Tracing is enabled\n\nTracing session: 54778be0-3c80-11e6-a333-ef4c703100c3\n\n activity                                                                                                                                                             | timestamp                  | source    | source_elapsed | client\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------+-----------+----------------+-----------\n                                                                                                                                                   Execute CQL3 query | 2016-06-27 16:00:55.198000 | 127.0.0.1 |              0 | 127.0.0.1\n Parsing INSERT INTO ks.users (userid, firstname, lastname, age) VALUES (550e8400-e29b-41d4-a716-446655440000, \&apos;&lt;/span&gt;Frodo\&lt;span class=&quot;code-quote&quot;&gt;&apos;, \&apos;&lt;/span&gt;Baggins\&lt;span class=&quot;code-quote&quot;&gt;&apos;, 32); [Native-Transport-Requests-2] | 2016-06-27 16:00:55.198000 | 127.0.0.1 |            462 | 127.0.0.1\n                                                                                                                    Preparing statement [Native-Transport-Requests-2] | 2016-06-27 16:00:55.199000 | 127.0.0.1 |            953 | 127.0.0.1\n                                                                                                      Determining replicas &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mutation [Native-Transport-Requests-2] | 2016-06-27 16:00:55.200000 | 127.0.0.1 |           1773 | 127.0.0.1\n                                                                                        Sending MUTATION message to /127.0.0.3 [MessagingService-Outgoing-/127.0.0.3] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4094 | 127.0.0.1\n                                                                                        Sending MUTATION message to /127.0.0.2 [MessagingService-Outgoing-/127.0.0.2] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4117 | 127.0.0.1\n                                                                                                                 Appending to commitlog [Native-Transport-Requests-2] | 2016-06-27 16:00:55.202000 | 127.0.0.1 |           4270 | 127.0.0.1\n                                                                                                               Adding to users memtable [Native-Transport-Requests-2] | 2016-06-27 16:00:55.203000 | 127.0.0.1 |           4758 | 127.0.0.1\n                                                                             REQUEST_RESPONSE message received from /127.0.0.3 [MessagingService-Incoming-/127.0.0.3] | 2016-06-27 16:00:55.213000 | 127.0.0.1 |          14833 | 127.0.0.1\n                                                                                                         Processing response from /127.0.0.3 [RequestResponseStage-4] | 2016-06-27 16:00:55.213000 | 127.0.0.1 |          15059 | 127.0.0.1\n                                                                             REQUEST_RESPONSE message received from /127.0.0.2 [MessagingService-Incoming-/127.0.0.2] | 2016-06-27 16:00:55.217000 | 127.0.0.1 |          19203 | 127.0.0.1\n                                                                                                         Processing response from /127.0.0.2 [RequestResponseStage-1] | 2016-06-27 16:00:55.217000 | 127.0.0.1 |          19379 | 127.0.0.1\n                                                                                                                                                     Request complete | 2016-06-27 16:00:55.217557 | 127.0.0.1 |          19557 | 127.0.0.1\n\n\n\n--------------------- &amp;gt;&amp;gt; end captured logging &amp;lt;&amp;lt; ---------------------&apos;&lt;/span&gt;
Standard Output

(EE)  (EE)  (EE)  
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should be seeing all those trace entries. Here&apos;s an example of the output from a successful trace in a successful local run:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; activity                                                                                                                                                             | timestamp                  | source    | source_elapsed | client
----------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------+-----------+----------------+-----------
                                                                                                                                                   Execute CQL3 query | 2016-07-13 10:47:36.596000 | 127.0.0.1 |              0 | 127.0.0.1
 Parsing INSERT INTO ks.users (userid, firstname, lastname, age) VALUES (550e8400-e29b-41d4-a716-446655440000, &lt;span class=&quot;code-quote&quot;&gt;&apos;Frodo&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;Baggins&apos;&lt;/span&gt;, 32); [Native-Transport-Requests-2] | 2016-07-13 10:47:36.596000 | 127.0.0.1 |            240 | 127.0.0.1
                                                                                                                    Preparing statement [Native-Transport-Requests-2] | 2016-07-13 10:47:36.596000 | 127.0.0.1 |            502 | 127.0.0.1
                                                                                                      Determining replicas &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mutation [Native-Transport-Requests-2] | 2016-07-13 10:47:36.597000 | 127.0.0.1 |            997 | 127.0.0.1
                                                                                        Sending MUTATION message to /127.0.0.2 [MessagingService-Outgoing-/127.0.0.2] | 2016-07-13 10:47:36.597000 | 127.0.0.1 |           1557 | 127.0.0.1
                                                                                        Sending MUTATION message to /127.0.0.3 [MessagingService-Outgoing-/127.0.0.3] | 2016-07-13 10:47:36.598000 | 127.0.0.1 |           2138 | 127.0.0.1
                                                                                     MUTATION message received from /127.0.0.1 [MessagingService-Incoming-/127.0.0.1] | 2016-07-13 10:47:36.599000 | 127.0.0.2 |            457 | 127.0.0.1
                                                                                     MUTATION message received from /127.0.0.1 [MessagingService-Incoming-/127.0.0.1] | 2016-07-13 10:47:36.600000 | 127.0.0.3 |            347 | 127.0.0.1
                                                                                                                             Appending to commitlog [MutationStage-1] | 2016-07-13 10:47:36.600000 | 127.0.0.1 |           3996 | 127.0.0.1
                                                                                                                           Adding to users memtable [MutationStage-1] | 2016-07-13 10:47:36.600000 | 127.0.0.1 |           4332 | 127.0.0.1
                                                                                                                             Appending to commitlog [MutationStage-2] | 2016-07-13 10:47:36.601000 | 127.0.0.2 |           1966 | 127.0.0.1
                                                                                                                           Adding to users memtable [MutationStage-2] | 2016-07-13 10:47:36.601000 | 127.0.0.2 |           2308 | 127.0.0.1
                                                                                                                             Appending to commitlog [MutationStage-2] | 2016-07-13 10:47:36.602000 | 127.0.0.3 |           2581 | 127.0.0.1
                                                                             REQUEST_RESPONSE message received from /127.0.0.2 [MessagingService-Incoming-/127.0.0.2] | 2016-07-13 10:47:36.602000 | 127.0.0.1 |           6584 | 127.0.0.1
                                                                                                                   Enqueuing response to /127.0.0.1 [MutationStage-2] | 2016-07-13 10:47:36.602000 | 127.0.0.2 |           2693 | 127.0.0.1
                                                                                                                           Adding to users memtable [MutationStage-2] | 2016-07-13 10:47:36.602000 | 127.0.0.3 |           2938 | 127.0.0.1
                                                                                Sending REQUEST_RESPONSE message to /127.0.0.1 [MessagingService-Outgoing-/127.0.0.1] | 2016-07-13 10:47:36.602000 | 127.0.0.2 |           3008 | 127.0.0.1
                                                                                                                   Enqueuing response to /127.0.0.1 [MutationStage-2] | 2016-07-13 10:47:36.603000 | 127.0.0.3 |           3278 | 127.0.0.1
                                                                                                         Processing response from /127.0.0.2 [RequestResponseStage-1] | 2016-07-13 10:47:36.603000 | 127.0.0.1 |           7515 | 127.0.0.1
                                                                                Sending REQUEST_RESPONSE message to /127.0.0.1 [MessagingService-Outgoing-/127.0.0.1] | 2016-07-13 10:47:36.605000 | 127.0.0.3 |           5241 | 127.0.0.1
                                                                             REQUEST_RESPONSE message received from /127.0.0.3 [MessagingService-Incoming-/127.0.0.3] | 2016-07-13 10:47:36.605000 | 127.0.0.1 |           9261 | 127.0.0.1
                                                                                                         Processing response from /127.0.0.3 [RequestResponseStage-4] | 2016-07-13 10:47:36.605000 | 127.0.0.1 |           9484 | 127.0.0.1
                                                                                                                                                     Request complete | 2016-07-13 10:47:36.605643 | 127.0.0.1 |           9643 | 127.0.0.1

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15375148" author="mambocab" created="Wed, 13 Jul 2016 14:50:26 +0000"  >&lt;p&gt;I believe this is a bug. Marking as such and unassigning to add it to the dev queue.&lt;/p&gt;</comment>
                            <comment id="15376518" author="stefania" created="Thu, 14 Jul 2016 07:49:01 +0000"  >&lt;p&gt;The additional warnings are a problem with ccm code, here is an extract of the log file taken from the last seen &lt;a href=&quot;http://cassci.datastax.com/job/trunk_dtest/1276/testReport/junit/cql_tracing_test/TestCqlTracing/tracing_unknown_impl_test/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;failing test&lt;/a&gt; on June 15:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [ScheduledTasks:1] 2016-06-15 03:06:41,111 Tracing.java:106 - Cannot use &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;junk &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; tracing (Unable to find Tracing class &lt;span class=&quot;code-quote&quot;&gt;&apos;junk&apos;&lt;/span&gt;), ignoring by defaulting on normal tracing
WARN  [main] 2016-06-15 03:06:41,119 StartupChecks.java:123 - jemalloc shared library could not be preloaded to speed up memory allocations
WARN  [main] 2016-06-15 03:06:41,119 StartupChecks.java:156 - JMX is not enabled to receive remote connections. Please see cassandra-env.sh &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more info.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;PR &lt;a href=&quot;https://github.com/pcmanus/ccm/pull/518&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#518&lt;/a&gt; should have fixed this problem; it was merged on June 24.&lt;/p&gt;

&lt;p&gt;&amp;#8211;&lt;/p&gt;

&lt;p&gt;The missing &lt;tt&gt;&apos;/127.0.0.1&apos;&lt;/tt&gt; happens at least on 3.8, 3.9 and trunk, I couldn&apos;t see any similar failures on 3.0 or 3.7. It seems the &lt;a href=&quot;http://cassci.datastax.com/view/trunk/job/trunk_novnode_dtest/409/testReport/junit/cql_tracing_test/TestCqlTracing/tracing_default_impl_test/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;oldest test&lt;/a&gt; that failed is on Jun 27. Locally, I can reproduce it about once every 10 times, so I am currently trying to bisect between cassandra-3.7 and cassandra-3.8.&lt;/p&gt;

&lt;p&gt;What&apos;s happening is that we are missing the tracing events of nodes 2 and 3, we only have the coordinator events. Looking at how tracing works, technically this can happen if the coordinator is very slow and pre-empted, because &lt;tt&gt;TraceStateImpl&lt;/tt&gt; mutates at CL.ANY and the driver queries &lt;tt&gt;system_traces.events&lt;/tt&gt; at CL.LOCAL_ONE. The coordinator writes a session-end entry in &lt;tt&gt;system_traces.sessions&lt;/tt&gt; just before the response is sent to the client; the driver waits for this entry before querying &lt;tt&gt;system_tracing.events&lt;/tt&gt;. Although the replicas send a tracing mutation request before sending the response to the actual request with tracing enabled, which in this case is at CL.ALL, since the coordinator is operating in a multi-threaded environment, there is no guarantee that the mutations of the tracing events will be inserted before inserting the session-end mutation. This is a race but I cannot find anything in the code that suggests that this was changed recently. It should only be a problem with a very slow C* coordinator, or if the tracing mutations were dropped due to overload, which clearly isn&apos;t the case. Therefore I am hoping the bisect may shed some light.&lt;/p&gt;</comment>
                            <comment id="15376683" author="stefania" created="Thu, 14 Jul 2016 09:46:54 +0000"  >&lt;p&gt;I found the reason of the sudden failures, it&apos;s &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/1052&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR #1052&lt;/a&gt;, specifically &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/1052/files#diff-b866cba7cf982d53e6406cca014e659eR75&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;, merged on June 23. Previously we were just checking if &quot;127.0.0.1&quot;, etc were present, now we check if &quot;/127.0.0.1&quot;, etc are present. Note the forward slash. So my analysis above is correct, the only reason it did not fail before is because we were not testing it. &lt;/p&gt;

&lt;p&gt;I don&apos;t think we can easily fix the race in tracing, it&apos;s probably a known limitation, what we can do is query with a higher consistency level in cqlsh. Since &lt;a href=&quot;https://datastax-oss.atlassian.net/browse/PYTHON-435&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PYTHON-435&lt;/a&gt;, released as part of driver version 3.3.0, the consistency level for trace queries can be set by the caller. I propose to use the same consistency level that is used for executing the statement in cqlsh, in this case it would be CL.ALL. However, we need to wait for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11850&quot; title=&quot;cannot use cql since upgrading python to 2.7.11+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11850&quot;&gt;&lt;del&gt;CASSANDRA-11850&lt;/del&gt;&lt;/a&gt; to upgrade the driver first.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=JoshuaMcKenzie&quot; class=&quot;user-hover&quot; rel=&quot;JoshuaMcKenzie&quot;&gt;JoshuaMcKenzie&lt;/a&gt;: I don&apos;t think this is a show stopper for the release, we can either change the test back or leave the known failure, and once 11850 is available test this cqlsh patch &lt;a href=&quot;https://github.com/stef1927/cassandra/commit/8118c3dca34120b78f29a66c073208ee0de91063&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15376814" author="jmckenzie" created="Thu, 14 Jul 2016 12:22:32 +0000"  >&lt;p&gt;I&apos;d say revert and then re-commit w/11850. That way we can continue forward with just &quot;working | flaky&quot; as our two test states rather than potentially introducing &quot;known pending another change&quot;.&lt;/p&gt;

&lt;p&gt;Seem reasonable/&lt;/p&gt;</comment>
                            <comment id="15377102" author="philipthompson" created="Thu, 14 Jul 2016 15:16:20 +0000"  >&lt;p&gt;So, I would argue we aren&apos;t actually introducing &quot;known pending another change&quot;, right? That seems to be the state that every failing test is in, where the cause of the failure is a C* limitation? As long as we do this in a way that doesn&apos;t accidentally lead to reverting the new coverage and forgetting to restore it, I don&apos;t feel too strongly.&lt;/p&gt;</comment>
                            <comment id="15377622" author="thobbs" created="Thu, 14 Jul 2016 17:53:20 +0000"  >&lt;p&gt;FWIW, I spent a little time trying to make tracing more reliable for tests in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11928&quot; title=&quot;dtest failure in cql_tracing_test.TestCqlTracing.tracing_simple_test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11928&quot;&gt;&lt;del&gt;CASSANDRA-11928&lt;/del&gt;&lt;/a&gt; by doing synchronous CL.ALL writes when a system flag was present.  Unfortunately, this appeared to cause some kind of deadlock, and it didn&apos;t seem worth it to investigate further.  However, if this is a problem across many tests, we may want to spend more time looking into that.&lt;/p&gt;</comment>
                            <comment id="15378125" author="mambocab" created="Thu, 14 Jul 2016 18:52:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;we may want to spend more time looking into &lt;span class=&quot;error&quot;&gt;&amp;#91;doing synchronous CL.ALL writes&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is worth looking into, but with this caveat: in the dtest environment, timeouts can make &lt;tt&gt;CL.ALL&lt;/tt&gt; calls can actually make tests flakier. I don&apos;t have a concrete example of this, but that&apos;s my memory.&lt;/p&gt;</comment>
                            <comment id="15378426" author="jmckenzie" created="Thu, 14 Jul 2016 21:32:06 +0000"  >&lt;p&gt;I&apos;m also fine w/us leaving it failing until Paulo gets back and reviews &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11850&quot; title=&quot;cannot use cql since upgrading python to 2.7.11+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11850&quot;&gt;&lt;del&gt;CASSANDRA-11850&lt;/del&gt;&lt;/a&gt;. This should be done well in time for 3.9 so shouldn&apos;t block release.&lt;/p&gt;</comment>
                            <comment id="15378760" author="stefania" created="Fri, 15 Jul 2016 02:19:59 +0000"  >&lt;p&gt;Since Paulo is back on Monday and it is already Friday, I prefer to leave the test code as it is. &lt;/p&gt;

&lt;p&gt;I&apos;ve prepared a patch based on 11850, and launched the tests:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.9&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-cqlsh-3.9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-cqlsh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.9-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.9-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;cqlsh dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;cqlsh dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;If the tests are OK, could we arrange a multiplexed job? I think 20x of &lt;tt&gt;cql_tracing_test.py:TestCqlTracing&lt;/tt&gt; should be sufficient.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;FWIW, I spent a little time trying to make tracing more reliable for tests in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11928&quot; title=&quot;dtest failure in cql_tracing_test.TestCqlTracing.tracing_simple_test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11928&quot;&gt;&lt;del&gt;CASSANDRA-11928&lt;/del&gt;&lt;/a&gt; by doing synchronous CL.ALL writes when a system flag was present. Unfortunately, this appeared to cause some kind of deadlock, and it didn&apos;t seem worth it to investigate further. However, if this is a problem across many tests, we may want to spend more time looking into that.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Let&apos;s see if we have more luck with the driver reading at CL.ALL.&lt;/p&gt;</comment>
                            <comment id="15378857" author="stefania" created="Fri, 15 Jul 2016 04:57:21 +0000"  >&lt;p&gt;Test results are very disappointing, I reproduced &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-dtest/lastCompletedBuild/testReport/cql_tracing_test/TestCqlTracing/tracing_simple_test/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the issue&lt;/a&gt; despite of the patch. Looking into it.&lt;/p&gt;

&lt;p&gt;BTW, the other 3 failing cqlsh tests are expected, there is a companion dtest PR that will be committed with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11850&quot; title=&quot;cannot use cql since upgrading python to 2.7.11+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11850&quot;&gt;&lt;del&gt;CASSANDRA-11850&lt;/del&gt;&lt;/a&gt; and will fix those failures.&lt;/p&gt;</comment>
                            <comment id="15378934" author="stefania" created="Fri, 15 Jul 2016 07:07:25 +0000"  >&lt;p&gt;So, the problem is not just the consistency level but also the fact that &lt;tt&gt;TraceStateImpl.executeMutation()&lt;/tt&gt; is completely asynchronous; I should have read more carefully what &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thobbs&quot; class=&quot;user-hover&quot; rel=&quot;thobbs&quot;&gt;thobbs&lt;/a&gt; wrote above.&lt;/p&gt;

&lt;p&gt;I have another version of the patch, in addition to reading at CL.ALL, we post a no-op event to the TRACING stage before closing the tracing state. Because the tracing executor only has one thread in its pool, this should guarantee that the tracing mutations for this query have been applied to at least one replica. I&apos;m not sure if this is going to introduce slowness or deadlocks, and we may have to put it behind a system flag to play it safe. Let&apos;s see what the dtest results are first.&lt;/p&gt;</comment>
                            <comment id="15378937" author="stefania" created="Fri, 15 Jul 2016 07:10:20 +0000"  >&lt;p&gt;I&apos;ve also launched testall since we&apos;ve modified java code:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.9&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.9-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15379017" author="stefania" created="Fri, 15 Jul 2016 08:30:55 +0000"  >&lt;p&gt;Many dtests failed, I will check on Monday what is going on. However &lt;tt&gt;cqlsh_tracing_test.TestCqlTracing&lt;/tt&gt; passed in both runs, so you could multiplex it maybe 20x to see if at least we are on the right track.&lt;/p&gt;</comment>
                            <comment id="15379194" author="stefania" created="Fri, 15 Jul 2016 10:25:16 +0000"  >&lt;p&gt;The failures were caused by a compilation error in &lt;tt&gt;build-test&lt;/tt&gt;, relaunched.&lt;/p&gt;</comment>
                            <comment id="15381669" author="stefania" created="Mon, 18 Jul 2016 03:34:53 +0000"  >&lt;p&gt;The last 2 runs of dtests were successful. I&apos;ve rebased and launched both dtests and utests one more time. If the results are again successful, we can move on to repeating a few runs of only &lt;tt&gt;cqlsh_tracing_test.TestCqlTracing&lt;/tt&gt; on Jenkins (i.e. 20x) and reviewing the patch.&lt;/p&gt;</comment>
                            <comment id="15383505" author="stefania" created="Tue, 19 Jul 2016 02:59:12 +0000"  >&lt;p&gt;Yesterday&apos;s run reproduced the &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.9-dtest/lastCompletedBuild/testReport/cql_tracing_test/TestCqlTracing/tracing_default_impl_test/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;same failure&lt;/a&gt; unfortunately. After investigating, I discovered that the tracing executor was rejecting calls to submit with UnsupportedOperation exceptions. I&apos;ve fixed this and I&apos;ve also increased the maximum time we wait for a queued event to execute on the tracing executor when releasing the tracing state. By default it is still 1 second, and could be zero if required, but the tests can override it via a system property and are currently using up to 15 seconds. I&apos;ve also added some trace messages to debug further if the problem persists, and relaunched the tests.&lt;/p&gt;</comment>
                            <comment id="15383715" author="stefania" created="Tue, 19 Jul 2016 07:28:48 +0000"  >&lt;p&gt;Latest test round looks good, can we run a batch of &lt;tt&gt;TRACE=org.apache.cassandra.tracing.TraceStateImpl nosetests cql_tracing_test.py&lt;/tt&gt;, e.g. 20x, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mambocab&quot; class=&quot;user-hover&quot; rel=&quot;mambocab&quot;&gt;mambocab&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=philipthompson&quot; class=&quot;user-hover&quot; rel=&quot;philipthompson&quot;&gt;philipthompson&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="15384761" author="mambocab" created="Tue, 19 Jul 2016 20:01:31 +0000"  >&lt;p&gt;I ran the following script:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; i in `seq 30` ; &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
        echo iteration $i
        PRINT_DEBUG=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; DEBUG=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; CASSANDRA_VERSION=github:stef1927/11465-cqlsh-3.9 TRACE=org.apache.cassandra.tracing.TraceStateImpl nosetests cql_tracing_test.py
        killall -9 java
done

&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; i in `seq 30` ; &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
        echo iteration $i
        PRINT_DEBUG=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; DEBUG=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; CASSANDRA_VERSION=github:stef1927/11465-cqlsh TRACE=org.apache.cassandra.tracing.TraceStateImpl nosetests cql_tracing_test.py
        killall -9 java
done
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and saw no failures:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://gist.github.com/072692334800285afc8d362165cb37a6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/072692334800285afc8d362165cb37a6&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;EDIT: I did so on an &lt;tt&gt;m3.xlarge&lt;/tt&gt; instance on openstack.&lt;/p&gt;</comment>
                            <comment id="15385171" author="stefania" created="Wed, 20 Jul 2016 01:42:26 +0000"  >&lt;p&gt;Thanks for running the tests.&lt;/p&gt;

&lt;p&gt;I&apos;ve backported the patch to 2.2 and 3.0 as well, since &lt;tt&gt;tracing_simple_test&lt;/tt&gt; may fail there too. Here is a recap:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.9&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-cqlsh-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-cqlsh-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-cqlsh-3.9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-cqlsh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-2.2-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.9-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.9-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Here are the &lt;a href=&quot;https://github.com/stef1927/cassandra-dtest/commits/11465&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest changes&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Both dtest and c* patches are based on the &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11850&quot; title=&quot;cannot use cql since upgrading python to 2.7.11+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11850&quot;&gt;&lt;del&gt;CASSANDRA-11850&lt;/del&gt;&lt;/a&gt; patch.&lt;/p&gt;</comment>
                            <comment id="15390264" author="pauloricardomg" created="Fri, 22 Jul 2016 22:00:50 +0000"  >&lt;p&gt;While this looks good and seems to solve the problem, it may introduce timing dependencies between concurrent tracing sessions and the timeout would still not guarantee all messages are persisted before the tracing session completes. While this is probably not a big deal and much better than what we currently have, I think a more robust and deterministic approach would be to keep tracing futures for each &lt;tt&gt;TraceStateImpl&lt;/tt&gt; and wait for them to complete before stopping the session. WDYT of this alternative approach? &lt;/p&gt;

&lt;p&gt;If the alternative is not feasible for some reason I&apos;m not aware of, adds too much complexity, or requires a change of interfaces, I&apos;m also fine with keeping the current approach and perhaps opening another ticket for improvement later if feasible.&lt;/p&gt;</comment>
                            <comment id="15391376" author="stefania" created="Mon, 25 Jul 2016 05:38:47 +0000"  >&lt;p&gt;There&apos;s a static method that we won&apos;t be able to capture with futures but even the approach based on adding a no op event could have the same race, see &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5668&quot; title=&quot;NPE in net.OutputTcpConnection when tracing is enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5668&quot;&gt;&lt;del&gt;CASSANDRA-5668&lt;/del&gt;&lt;/a&gt;. Basically the state may be deleted before the coordinator receives all responses or even sends all requests but this is not applicable to CL.ALL. Also, the 3.9 patch becomes a little bit more involved due to the abstractions introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10392&quot; title=&quot;Allow Cassandra to trace to custom tracing implementations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10392&quot;&gt;&lt;del&gt;CASSANDRA-10392&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Launched the tests again, the latest changes are in a separate commit so we can choose which approach to use. I would prefer to use futures since it is more accurate.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.9&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-cqlsh-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-cqlsh-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-cqlsh-3.9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-cqlsh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-2.2-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.9-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-3.9-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-cqlsh-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Only the 2.2 and 3.9 commits need reviewing, the 3.0 and trunk commits are identical to the 2.2. and 3.9 commits respectively.&lt;/p&gt;

&lt;p&gt;I&apos;ve also created the pull request for dtests &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/1125&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15392611" author="pauloricardomg" created="Mon, 25 Jul 2016 20:35:55 +0000"  >&lt;p&gt;New future-based approach LGTM. I added a &lt;a href=&quot;https://github.com/pauloricardomg/cassandra/commit/7246dfbffcb99a6a3f54fef9f84e84072fa90e3c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;new commit&lt;/a&gt; to the trunk version simplifying waitForPendingEvents to wait on a list of &lt;tt&gt;CompletableFuture&lt;/tt&gt; instead.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Launched the tests again, the latest changes are in a separate commit so we can choose which approach to use. I would prefer to use futures since it is more accurate.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Since the no-op event solution is a bit simpler and less risky, I propose we commit that for 2.2+ and commit the future-based version only to trunk as an improvement. WDYT ?&lt;/p&gt;

&lt;p&gt;Submitted 20x multiplexer run of &lt;tt&gt;cql_tracing_test.py:TestCqlTracing&lt;/tt&gt; for 2.2 (no-op version) and trunk (future version):&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Parameterized/job/parameterized_dtest_multiplexer/186/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Parameterized/job/parameterized_dtest_multiplexer/185/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15393116" author="stefania" created="Tue, 26 Jul 2016 03:05:00 +0000"  >&lt;p&gt;Thanks for the additional commit. I&apos;ve incorporated it into the trunk patch and discarded the futures commits on all branches except for trunk. I&apos;ve also rebased, squashed, prepared the patches for commit and relaunched the tests. The multiplexer runs were aborted unfortunately, and I am not able to restart them with the up-to-date commits, so would you mind doing that as well as taking a another quick look at the final patches? &lt;/p&gt;</comment>
                            <comment id="15394014" author="pauloricardomg" created="Tue, 26 Jul 2016 16:08:40 +0000"  >&lt;p&gt;Submitted new multiplexer runs:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Parameterized/job/parameterized_dtest_multiplexer/188/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://cassci.datastax.com/view/Parameterized/job/parameterized_dtest_multiplexer/187/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15394971" author="pauloricardomg" created="Wed, 27 Jul 2016 02:43:13 +0000"  >&lt;p&gt;patch and multiplexer results look good, but for some reason dtest doesn&apos;t seem to be running, tried resubmitting a few times without success. wasn&apos;t able to find out the root cause from a quick glance at the logs. could you maybe trying rebase the dtest repo?&lt;/p&gt;</comment>
                            <comment id="15395031" author="stefania" created="Wed, 27 Jul 2016 04:44:35 +0000"  >&lt;p&gt;I&apos;ve tried following &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mshuler&quot; class=&quot;user-hover&quot; rel=&quot;mshuler&quot;&gt;mshuler&lt;/a&gt; advice on IRC and renamed the branches. They should be running on Openstack now.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.9&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465-3.9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11465&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-2.2-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-3.9-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-3.9-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15395328" author="stefania" created="Wed, 27 Jul 2016 09:47:22 +0000"  >&lt;p&gt;I managed to get the 2.2 dtests to run but the other dtests are still failing, see an example &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-dtest/2/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. I think the problem is that the build is timing out:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;Build timed out (after 20 minutes). Marking the build as aborted.&lt;/tt&gt; &lt;/p&gt;

&lt;p&gt;Locally I can build these branches without problems however. They were all rebased this morning BTW. I&apos;ve relaunched the aborted dtests one more time.&lt;/p&gt;

&lt;p&gt;There were also many timeouts for the trunk utests, but the same problem happened in 3.9 &lt;a href=&quot;http://cassci.datastax.com/view/cassandra-3.9/job/cassandra-3.9_testall/41/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;yesterday&lt;/a&gt;. I&apos;ve rebased and relaunched the trunk utests as well.&lt;/p&gt;</comment>
                            <comment id="15395781" author="jkni" created="Wed, 27 Jul 2016 14:39:07 +0000"  >&lt;p&gt;I think you&apos;re right regarding the build time out - this has surfaced a few times in the last few days. On the Apache infra page, you can see that &lt;a href=&quot;https://status.apache.org/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;repository.apache.org&lt;/a&gt; (under the Nexus section) has been down several times in the last few days.&lt;/p&gt;

&lt;p&gt;Local builds probably work because of your cached m2.&lt;/p&gt;</comment>
                            <comment id="15396736" author="pauloricardomg" created="Thu, 28 Jul 2016 00:47:56 +0000"  >&lt;p&gt;The previous runs failed with the same reason. I resubmitted them separately (with a delay between them as to not overload the apache repos), and they seem to be running. Please mark as ready to commit if CI executes successfully this time.&lt;/p&gt;</comment>
                            <comment id="15397244" author="stefania" created="Thu, 28 Jul 2016 08:26:14 +0000"  >&lt;p&gt;Thanks for restarting the tests. &lt;/p&gt;

&lt;p&gt;There are a number of failures, all accounted for except for &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-3.0-dtest/lastCompletedBuild/testReport/snapshot_test/TestArchiveCommitlog/test_archive_commitlog&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this&lt;/a&gt; in 3.0 and &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-3.9-dtest/lastCompletedBuild/testReport/delete_insert_test/DeleteInsertTest/delete_insert_search_test/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this&lt;/a&gt; in 3.9. &lt;/p&gt;

&lt;p&gt;I&apos;m not sure they are related given that both commitlog and secondary indexes are local, but perhaps to be on the safe side we should set the default value of &lt;tt&gt;WAIT_FOR_PENDING_EVENTS_TIMEOUT_SECS&lt;/tt&gt; to zero rather than 1 second so that this patch only affects the tests that set &lt;tt&gt;-Dcassandra.wait_for_tracing_events_timeout_secs&lt;/tt&gt;? &lt;/p&gt;</comment>
                            <comment id="15397245" author="stefania" created="Thu, 28 Jul 2016 08:26:56 +0000"  >&lt;p&gt;This makes sense, thanks for the explanation!&lt;/p&gt;</comment>
                            <comment id="15398441" author="pauloricardomg" created="Thu, 28 Jul 2016 23:43:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;There are a number of failures, all accounted for except for this in 3.0 and this in 3.9. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;tt&gt;snapshot_test.TestArchiveCommitlog.test_archive_commitlog&lt;/tt&gt; is being addressed on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11811&quot; title=&quot;dtest failure in snapshot_test.TestArchiveCommitlog.test_archive_commitlog&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11811&quot;&gt;&lt;del&gt;CASSANDRA-11811&lt;/del&gt;&lt;/a&gt; but &lt;tt&gt;delete_insert_search_test&lt;/tt&gt; in fact looks like a new failure, but it seems unrelated.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;perhaps to be on the safe side we should set the default value of WAIT_FOR_PENDING_EVENTS_TIMEOUT_SECS to zero rather than 1 second so that this patch only affects the tests that set -Dcassandra.wait_for_tracing_events_timeout_secs?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think we can keep it, since this issue may also happen in ordinary tracing sessions so it may help to make this a bit more robust and AFAIK tracing is only used for debugging/troubleshooting so it&apos;s not particularly critical. In any case, I submitted an additional &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-3.9-dtest/4/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.9 dtest run&lt;/a&gt; to verify the previous failures were indeed unrelated.&lt;/p&gt;

&lt;p&gt;I will mark as ready to commit if this last test run looks good. Thanks!&lt;/p&gt;</comment>
                            <comment id="15398511" author="stefania" created="Fri, 29 Jul 2016 00:48:27 +0000"  >&lt;p&gt;I&apos;ve restarted the 3.0 dtests as well, the failure addressed by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11811&quot; title=&quot;dtest failure in snapshot_test.TestArchiveCommitlog.test_archive_commitlog&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11811&quot;&gt;&lt;del&gt;CASSANDRA-11811&lt;/del&gt;&lt;/a&gt; is quite different than ours. Also, I forgot to mention yesterday that the tests do pass locally.&lt;/p&gt;</comment>
                            <comment id="15398607" author="pauloricardomg" created="Fri, 29 Jul 2016 02:24:45 +0000"  >&lt;p&gt;The latest 3.9 run finished, but there are couple of additional &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-3.9-dtest/4/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;failures&lt;/a&gt; on &lt;tt&gt;materialized_views_test&lt;/tt&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, but they were already present in a previous &lt;a href=&quot;http://cassci.datastax.com/view/cassandra-3.9/job/cassandra-3.9_dtest/17/testReport/junit/materialized_views_test/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.9 branch run&lt;/a&gt; so I&apos;m quite confident they&apos;re unrelated to this ticket. I submitted a &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11465-3.9-dtest/5/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;new run&lt;/a&gt; just in case.&lt;/p&gt;

&lt;p&gt;Feel free to mark as ready to commit if remaining 3.0/3.9 CI results look good.&lt;/p&gt;</comment>
                            <comment id="15398808" author="stefania" created="Fri, 29 Jul 2016 06:34:25 +0000"  >&lt;p&gt;3.0 and 3.9 dtest runs just completed and they are both good. I will commit this soon.&lt;/p&gt;</comment>
                            <comment id="15398888" author="stefania" created="Fri, 29 Jul 2016 07:35:17 +0000"  >&lt;p&gt;Committed to 2.2 as 7bd65a129c63091d6885f92afe77a41c4fc46a6f and merged upwards. Thank you for the review and running the tests Paulo!&lt;/p&gt;</comment>
                            <comment id="15479205" author="michaelsembwever" created="Sat, 10 Sep 2016 05:29:21 +0000"  >&lt;p&gt;Only just found and read this today! Feel free to shout out for tracing related stuff &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15481241" author="stefania" created="Sun, 11 Sep 2016 07:08:22 +0000"  >&lt;p&gt;Will do, thanks! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12971376">CASSANDRA-11850</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12988243">CASSANDRA-12159</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12974251">CASSANDRA-11928</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13010251">CASSANDRA-12754</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13010253">CASSANDRA-12755</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 10 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2vf3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>pauloricardomg</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>