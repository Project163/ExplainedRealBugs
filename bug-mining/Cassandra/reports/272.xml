<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:12:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-644] Provide way to remove nodes from gossip entirely</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-644</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;As reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-634&quot; title=&quot;Hinted Handoff Exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-634&quot;&gt;&lt;del&gt;CASSANDRA-634&lt;/del&gt;&lt;/a&gt;, &quot;Now that we&apos;re gossiping about dead nodes as well, gossip digest continues to grow without boundary when nodes come and go. This information will never disappear as it will be propagated to new nodes no matter how old and obsolete it is. To counter this, we need some mechanism to (1) either remove dead node from endpointstateinfo or (2) at some point stop to gossip about it, or both.&quot;&lt;/p&gt;

&lt;p&gt;This is also seen when using &quot;fat clients&quot; that participate in the gossip ring; if a client leaves and does not come back it stays in the gossip forever.  (This can be confusing if the client does start up again, connecting to a &lt;em&gt;different&lt;/em&gt; cluster, but the old one notices it is back and starts gossiping to it again!)&lt;/p&gt;

&lt;p&gt;I would prefer to leave management of these things explicit; 3 days is long enough that the fat client problem in particular needs another solution, and if it needs another solution then that can become the only solution. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;So I would be in favor of removeToken clearing out gossip entries, and also adding a command to remove an endpoint from the gossip ring that does not have a token associated with it (like fat clients).  A command to ask &quot;what are all the known gossip hosts&quot; would also be useful, since nodeprobe ring only includes nodes w/ tokens.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12443778">CASSANDRA-644</key>
            <summary>Provide way to remove nodes from gossip entirely</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jaakko">Jaakko Laine</assignee>
                                    <reporter username="jbellis">Jonathan Ellis</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Dec 2009 16:18:55 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:30 +0000</updated>
                            <resolved>Wed, 27 Jan 2010 21:19:14 +0000</resolved>
                                        <fixVersion>0.6</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12793178" author="jaakko" created="Mon, 21 Dec 2009 12:35:20 +0000"  >&lt;p&gt;&amp;gt; connecting to a &lt;em&gt;different&lt;/em&gt; cluster, but the old one notices it is back and starts gossiping to it again!&lt;/p&gt;

&lt;p&gt;Actually this cannot happen since gossip SYN carries cluster ID and only messages from the same cluster are handled.&lt;/p&gt;

&lt;p&gt;I think removing fat clients automatically is OK. We could run a check periodically and remove all nodes from gossiper that have been silent for certain period of time, and do not have token associated with it. I&apos;m not sure in what kind of situations this kind of clients are used, but if a node does not participate in storage and has been dead for an hour, there should be no harm in removing it. It will be back in gossip anyway immediately if it reappears. Cleaning up fat clients automatically would prevent gossip data from growing &quot;rapidly&quot; if there are many clients coming and going from different IP addresses.&lt;/p&gt;

&lt;p&gt;As for &quot;proper&quot; storage nodes: These are likely to be more stable than clients, so probably it is best to have removetoken and/or other manual commands to take care of this.&lt;/p&gt;</comment>
                            <comment id="12793240" author="jbellis" created="Mon, 21 Dec 2009 15:59:06 +0000"  >&lt;p&gt;&amp;gt; We could run a check periodically and remove all nodes from gossiper that have been silent for certain period of time, and do not have token associated with it.&lt;/p&gt;

&lt;p&gt;that sounds fine.&lt;/p&gt;</comment>
                            <comment id="12799984" author="jbellis" created="Wed, 13 Jan 2010 22:47:56 +0000"  >&lt;p&gt;(I originally marked this as Improvement, but isn&apos;t decommission/removeToken not cleaning out from gossip a Bug?)&lt;/p&gt;</comment>
                            <comment id="12800232" author="jaakko" created="Thu, 14 Jan 2010 15:27:38 +0000"  >&lt;p&gt;yeah, that should probably be fixed. Attached patch should do the trick. I&apos;ll fix the other part tomorrow.&lt;/p&gt;</comment>
                            <comment id="12801117" author="jaakko" created="Sat, 16 Jan 2010 07:22:49 +0000"  >&lt;p&gt;patch attached:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;removeToken now removes node from gossip&lt;/li&gt;
	&lt;li&gt;fat clients (nodes without token) are removed from gossip after 1 hour of inactivity&lt;/li&gt;
	&lt;li&gt;added justRemovedEndPoints to gossip to prevent removed nodes from reappearing immediately. Removed nodes are kept here for RING_DELAY period, during which time new joins from them are ignored. It takes a while for remove token gossip to propagate to all nodes. During this time some nodes will continue to gossip about the just-now-being-removed-node, while others have already removed it.&lt;/li&gt;
	&lt;li&gt;fixed a bug related to removeToken command which allowed node&apos;s own token being removed.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12801844" author="jbellis" created="Mon, 18 Jan 2010 16:22:57 +0000"  >&lt;p&gt;shouldn&apos;t this also r/m from FD.arrivalSamples?&lt;/p&gt;</comment>
                            <comment id="12803174" author="jaakko" created="Thu, 21 Jan 2010 05:01:53 +0000"  >&lt;p&gt;yeah, I decided it is not worth the trouble, but you&apos;re right, it is better to remove from FD too. attached new version.&lt;/p&gt;</comment>
                            <comment id="12803729" author="jbellis" created="Fri, 22 Jan 2010 15:37:28 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;are you comfortable committing this to 0.5 branch? &lt;/p&gt;</comment>
                            <comment id="12803954" author="jaakko" created="Sat, 23 Jan 2010 00:01:36 +0000"  >&lt;p&gt;Before committing to 0.5, it would be good if other people tested this as well.&lt;/p&gt;</comment>
                            <comment id="12804461" author="jaakko" created="Mon, 25 Jan 2010 09:27:36 +0000"  >&lt;p&gt;Committed to trunk. Let&apos;s wait a while and commit to 0.5 if nothing breaks.&lt;/p&gt;</comment>
                            <comment id="12804522" author="hudson" created="Mon, 25 Jan 2010 12:43:12 +0000"  >&lt;p&gt;Integrated in Cassandra #334 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/334/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/334/&lt;/a&gt;)&lt;br/&gt;
    fixed broken test. &lt;br/&gt;
modify removetoken to remove node from gossip. remove fat clients automatically after 1h of inactivity. patch by jaakko, reviewed by jbellis. &lt;/p&gt;</comment>
                            <comment id="12804540" author="jbellis" created="Mon, 25 Jan 2010 14:06:41 +0000"  >&lt;p&gt;could you also update CHANGES?&lt;/p&gt;</comment>
                            <comment id="12805656" author="jbellis" created="Wed, 27 Jan 2010 21:19:14 +0000"  >&lt;p&gt;updated CHANGES and closed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12430987" name="644.patch" size="11566" author="jaakko" created="Thu, 21 Jan 2010 05:01:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jaakko]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19797</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 43 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g07b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>91463</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>