<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:20:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2435] auto bootstrap happened on already bootstrapped nodes</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2435</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I believe the following was observed on 0.7.2. I meant to dig deeper, but never had the time, and now I want to at least file this even if I don&apos;t have extremely helpful information.&lt;/p&gt;

&lt;p&gt;A piece of background is that we consciously made the decision to have the default configuration on nodes have auto_bootstrap set to true. The logic was that if one accidentally were to start a new node, we&apos;d rather have it join with data than join &lt;b&gt;without&lt;/b&gt; data and cause bogus read results in the cluster.&lt;/p&gt;

&lt;p&gt;We executed this policy (by way of having the puppet managed config have auto_bootstrap set to true).&lt;/p&gt;

&lt;p&gt;On one of our clusters with 5 nodes, we did some moves. All looked well; the moves completed. For unrelated reasons, we wanted to restart nodes after they had been moved. When we did, three of the 5, specifically those 3 that were &lt;b&gt;NOT&lt;/b&gt; seed nodes, initiated a bootstrap procedure! Before the moves the cluster had been running for several days at least.&lt;/p&gt;

&lt;p&gt;The logs indicated the automatic token selection, and they joined the ring under a new automatically selected token.&lt;/p&gt;

&lt;p&gt;Presumably, this violated consistency but at the time there was no live traffic to the cluster and we didn&apos;t confirm (put traffic on it after repair+cleanup).&lt;/p&gt;

&lt;p&gt;I did look a little bit at the code in light of this but didn&apos;t see anything obvious, so I don&apos;t really know what the likely culprit is.&lt;/p&gt;

&lt;p&gt;A potential complication was that seed nodes were moved without using the correct procedure of de-seeding them first. This was clearly wrong, but it is not obvious to me that it would cause other nodes to incorrectly bootstrap since a node should &lt;b&gt;never&lt;/b&gt; bootstrap more than once if the local system tables say it&apos;s been bootstrapped.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12503656">CASSANDRA-2435</key>
            <summary>auto bootstrap happened on already bootstrapped nodes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="scode">Peter Schuller</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Apr 2011 17:29:40 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:02 +0000</updated>
                            <resolved>Mon, 11 Apr 2011 03:10:06 +0000</resolved>
                                        <fixVersion>0.7.5</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13017648" author="jbellis" created="Fri, 8 Apr 2011 21:14:38 +0000"  >&lt;p&gt;recall that move (until 0.8) consists of&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;unbootstrap&lt;/li&gt;
	&lt;li&gt;bootstrap to new location&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;unbootstrap calls storageservice.leavering (same as decommission), which marks the node as not-bootstrapped with setBootstrapped(false).  &lt;/p&gt;

&lt;p&gt;in one of the refactorings during 0.7 development we removed the call to setBootstrapped(true) from finishBootstrapping.  So next restart it will indeed autobootstrap if that is enabled in the config file.&lt;/p&gt;</comment>
                            <comment id="13017649" author="jbellis" created="Fri, 8 Apr 2011 21:15:30 +0000"  >&lt;p&gt;patch to fix.&lt;/p&gt;</comment>
                            <comment id="13018072" author="scode" created="Sun, 10 Apr 2011 12:13:04 +0000"  >&lt;p&gt;FWIW, looks good to me (but I only did visual inspection and some code jumping in the 0.7 branch; haven&apos;t tested it).&lt;/p&gt;</comment>
                            <comment id="13018135" author="nickmbailey" created="Sun, 10 Apr 2011 19:04:06 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13018182" author="jbellis" created="Mon, 11 Apr 2011 03:10:06 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                            <comment id="13018184" author="hudson" created="Mon, 11 Apr 2011 03:26:05 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #430 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/430/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/430/&lt;/a&gt;)&lt;br/&gt;
    re-set bootstrapped flag after move finishes&lt;br/&gt;
patch by jbellis; reviewed by Peter Schuller and Nick Bailey for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2435&quot; title=&quot;auto bootstrap happened on already bootstrapped nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2435&quot;&gt;&lt;del&gt;CASSANDRA-2435&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12475840" name="2435.txt" size="994" author="jbellis" created="Fri, 8 Apr 2011 21:15:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20624</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 33 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gbcv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>93270</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>nickmbailey</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[nickmbailey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>