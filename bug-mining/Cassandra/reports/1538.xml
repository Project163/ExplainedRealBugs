<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:30:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3612] CQL inserting blank key.</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3612</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;One of our application bug inserted blank key into cluster causing assertion error on key. After checking the root cause, I found it is the bug with CQL and reproducible. Client cassandra-node and cqlsh-1.0.6.&lt;br/&gt;
Blank key only work when one column provided.&lt;/p&gt;

&lt;p&gt;{}&lt;br/&gt;
cqlsh&amp;gt; insert into login (KEY,email)values(&apos;&apos;,&apos;&apos;);&lt;br/&gt;
cqlsh&amp;gt; select * from login;&lt;br/&gt;
u&apos;&apos; | u&apos;email&apos;,u&apos;&apos; &lt;br/&gt;
cqlsh&amp;gt; insert into login (KEY,email,verified)values(&apos;&apos;,&apos;&apos;,&apos;&apos;);&lt;br/&gt;
Request did not complete within rpc_timeout.&lt;br/&gt;
cqlsh&amp;gt; insert into login (KEY,verified)values(&apos;&apos;,&apos;&apos;);&lt;br/&gt;
Request did not complete within rpc_timeout.&lt;br/&gt;
cqlsh&amp;gt; insert into login (KEY,email)values(&apos;&apos;,&apos;&apos;);&lt;br/&gt;
cqlsh&amp;gt; &lt;br/&gt;
cqlsh&amp;gt; select * from login;&lt;br/&gt;
u&apos;&apos; | u&apos;email&apos;,u&apos;&apos; | u&apos;uid&apos;,None&lt;br/&gt;
cqlsh&amp;gt; select * from login;&lt;br/&gt;
u&apos;&apos; | u&apos;email&apos;,u&apos;&apos; | u&apos;uid&apos;,None&lt;br/&gt;
cqlsh&amp;gt; select * from login;&lt;br/&gt;
u&apos;&apos; | u&apos;email&apos;,u&apos;&apos; | u&apos;uid&apos;,None&lt;br/&gt;
cqlsh&amp;gt; &lt;br/&gt;
cqlsh&amp;gt; select * from login;&lt;br/&gt;
u&apos;&apos; | u&apos;email&apos;,u&apos;&apos; | u&apos;uid&apos;,None&lt;br/&gt;
u&apos;samalgorai@gmail.com&apos; | u&apos;email&apos;,u&apos;samalgorai@gmail.com&apos; | u&apos;password&apos;,u&apos;388ad1c312a488ee9e12998fe097f2258fa8d5ee&apos; | u&apos;uid&apos;,UUID(&apos;05ea41dc-241f-11e1-8521-3da59237b189&apos;) | u&apos;verified&apos;,u&apos;0&apos;&lt;br/&gt;
cqlsh&amp;gt; quit;&lt;/p&gt;
{/}

&lt;p&gt;&lt;a href=&quot;http://pastebin.com/HJn5fHhH&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://pastebin.com/HJn5fHhH&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux ubuntu 3.0.0-12-generic #20-Ubuntu SMP Fri Oct 7 14:56:25 UTC 2011 x86_64 x86_64 x86_64 GNU/Linux&lt;/p&gt;</environment>
        <key id="12534669">CASSANDRA-3612</key>
            <summary>CQL inserting blank key.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thepaul">paul cannon</assignee>
                                    <reporter username="samal_">samal</reporter>
                        <labels>
                            <label>cql</label>
                    </labels>
                <created>Sun, 11 Dec 2011 18:01:29 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:44 +0000</updated>
                            <resolved>Wed, 28 Mar 2012 17:06:08 +0000</resolved>
                                        <fixVersion>1.0.9</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                    <component>Legacy/CQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13167173" author="brandon.williams" created="Sun, 11 Dec 2011 19:01:38 +0000"  >&lt;p&gt;Adding the exception from pastebin for posterity.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
s.  Time: 292ms.
ERROR 22:39:02,137 Fatal exception in thread Thread[MutationStage:1,5,main]
java.lang.AssertionError
	at org.apache.cassandra.db.ColumnFamilyStore.markReferenced(ColumnFamilyStore.java:1236)
	at org.apache.cassandra.db.CollationController.collectTimeOrderedData(CollationController.java:83)
	at org.apache.cassandra.db.CollationController.getTopLevelColumns(CollationController.java:62)
	at org.apache.cassandra.db.ColumnFamilyStore.getTopLevelColumns(ColumnFamilyStore.java:1275)
	at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1161)
	at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1123)
	at org.apache.cassandra.db.Table.readCurrentIndexedColumns(Table.java:504)
	at org.apache.cassandra.db.Table.apply(Table.java:441)
	at org.apache.cassandra.db.RowMutation.apply(RowMutation.java:256)
	at org.apache.cassandra.service.StorageProxy$6.runMayThrow(StorageProxy.java:440)
	at org.apache.cassandra.service.StorageProxy$DroppableRunnable.run(StorageProxy.java:1258)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)
ERROR 22:42:02,786 Fatal exception in thread Thread[MutationStage:34,5,main]
java.lang.AssertionError
	at org.apache.cassandra.db.ColumnFamilyStore.markReferenced(ColumnFamilyStore.java:1236)
	at org.apache.cassandra.db.CollationController.collectTimeOrderedData(CollationController.java:83)
	at org.apache.cassandra.db.CollationController.getTopLevelColumns(CollationController.java:62)
	at org.apache.cassandra.db.ColumnFamilyStore.getTopLevelColumns(ColumnFamilyStore.java:1275)
	at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1161)
	at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1123)
	at org.apache.cassandra.db.Table.readCurrentIndexedColumns(Table.java:504)
	at org.apache.cassandra.db.Table.apply(Table.java:441)
	at org.apache.cassandra.db.RowMutation.apply(RowMutation.java:256)
	at org.apache.cassandra.service.StorageProxy$6.runMayThrow(StorageProxy.java:440)
	at org.apache.cassandra.service.StorageProxy$DroppableRunnable.run(StorageProxy.java:1258)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)
ERROR 22:45:40,752 Fatal exception in thread Thread[MutationStage:36,5,main]
java.lang.AssertionError
	at org.apache.cassandra.db.ColumnFamilyStore.markReferenced(ColumnFamilyStore.java:1236)
	at org.apache.cassandra.db.CollationController.collectTimeOrderedData(CollationController.java:83)
	at org.apache.cassandra.db.CollationController.getTopLevelColumns(CollationController.java:62)
	at org.apache.cassandra.db.ColumnFamilyStore.getTopLevelColumns(ColumnFamilyStore.java:1275)
	at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1161)
	at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1123)
	at org.apache.cassandra.db.Table.readCurrentIndexedColumns(Table.java:504)
	at org.apache.cassandra.db.Table.apply(Table.java:441)
	at org.apache.cassandra.db.RowMutation.apply(RowMutation.java:256)
	at org.apache.cassandra.service.StorageProxy$6.runMayThrow(StorageProxy.java:440)
	at org.apache.cassandra.service.StorageProxy$DroppableRunnable.run(StorageProxy.java:1258)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)
ERROR 22:46:02,674 Fatal exception in thread Thread[MutationStage:37,5,main]
java.lang.AssertionError
	at org.apache.cassandra.db.ColumnFamilyStore.markReferenced(ColumnFamilyStore.java:1236)
	at org.apache.cassandra.db.CollationController.collectTimeOrderedData(CollationController.java:83)
	at org.apache.cassandra.db.CollationController.getTopLevelColumns(CollationController.java:62)
	at org.apache.cassandra.db.ColumnFamilyStore.getTopLevelColumns(ColumnFamilyStore.java:1275)
	at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1161)
	at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1123)
	at org.apache.cassandra.db.Table.readCurrentIndexedColumns(Table.java:504)
	at org.apache.cassandra.db.Table.apply(Table.java:441)
	at org.apache.cassandra.db.RowMutation.apply(RowMutation.java:256)
	at org.apache.cassandra.service.StorageProxy$6.runMayThrow(StorageProxy.java:440)
	at org.apache.cassandra.service.StorageProxy$DroppableRunnable.run(StorageProxy.java:1258)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13215163" author="jbellis" created="Thu, 23 Feb 2012 23:01:25 +0000"  >&lt;p&gt;We shouldn&apos;t allow blank keys at all, so there&apos;s a validation failure in QueryProcessor here.  Unsure why markReferenced doesn&apos;t fail the assert for the first insert though.&lt;/p&gt;

&lt;p&gt;(If the fix is involved let&apos;s push to 1.1.)&lt;/p&gt;</comment>
                            <comment id="13215894" author="thepaul" created="Fri, 24 Feb 2012 20:48:02 +0000"  >&lt;p&gt;Ok, finally reproduced.  This isn&apos;t because there is more than one column with the blank key, it&apos;s because your second column (&quot;verified&quot;) must have an index on it. It&apos;s the &quot;read mutated indexes&quot; code path here that invokes the assertion for non-empty keys. You&apos;ll also see a similar traceback when trying to DELETE the row with the empty key.&lt;/p&gt;

&lt;p&gt;And yes, QueryProcessor is missing validation for these write operations here (INSERT, UPDATE, DELETE, and each of those inside BATCH statements (would take a different validation path). QueryProcessor does have validation for most everything else, though.&lt;/p&gt;</comment>
                            <comment id="13216027" author="thepaul" created="Fri, 24 Feb 2012 22:43:18 +0000"  >&lt;p&gt;This particular problem is fixed in my github fork, in the 3612-1.0 and 3612-1.1 branches.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/thepaul/cassandra/commit/5dc73e765f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/thepaul/cassandra/commit/5dc73e765f&lt;/a&gt; - 3612-1.0&lt;br/&gt;
&lt;a href=&quot;https://github.com/thepaul/cassandra/commit/eab19b0979&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/thepaul/cassandra/commit/eab19b0979&lt;/a&gt; - 3612-1.1&lt;/p&gt;

&lt;p&gt;However, it looks like problems of a similar nature still exist in cql3, in the 1.1 series. I&apos;ll fix that and include those changes along with this ticket.&lt;/p&gt;</comment>
                            <comment id="13217323" author="thepaul" created="Mon, 27 Feb 2012 17:43:40 +0000"  >&lt;p&gt;ok, 3612-1.1 branch updated (now at &lt;a href=&quot;https://github.com/thepaul/cassandra/commit/d921a395ae&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/thepaul/cassandra/commit/d921a395ae&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="13240531" author="xedin" created="Wed, 28 Mar 2012 16:49:30 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13240545" author="brandon.williams" created="Wed, 28 Mar 2012 17:06:08 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thepaul]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>220390</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 34 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gm1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95002</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>xedin</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[xedin]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>