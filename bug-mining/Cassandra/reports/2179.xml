<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:38:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5273] Hanging system after OutOfMemory. Server cannot die due to uncaughtException handling</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5273</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;On out of memory exception, there is an uncaughtexception handler that is calling System.exit(). However, multiple threads are calling this handler causing a deadlock and the server cannot stop working. See &lt;a href=&quot;http://www.mail-archive.com/user@cassandra.apache.org/msg27898.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/user@cassandra.apache.org/msg27898.html&lt;/a&gt;. And see stack trace in attachement.&lt;/p&gt;</description>
                <environment>&lt;p&gt;linux, 64 bit&lt;/p&gt;</environment>
        <key id="12633165">CASSANDRA-5273</key>
            <summary>Hanging system after OutOfMemory. Server cannot die due to uncaughtException handling</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="ignaced">Ignace Desimpel</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Feb 2013 10:32:09 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:17 +0000</updated>
                            <resolved>Wed, 22 May 2013 15:33:04 +0000</resolved>
                                        <fixVersion>1.2.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13582086" author="ignaced" created="Wed, 20 Feb 2013 10:46:23 +0000"  >&lt;p&gt;Stack trace hanging system&lt;/p&gt;</comment>
                            <comment id="13611873" author="jbellis" created="Sat, 23 Mar 2013 21:58:16 +0000"  >&lt;p&gt;Do we have any better options than just adding a timeout to the appendingThread.join call?&lt;/p&gt;</comment>
                            <comment id="13640200" author="krummas" created="Wed, 24 Apr 2013 07:44:56 +0000"  >&lt;p&gt;this is very hard to reproduce (and i have never seen it happen in any of our clusters) so i simply added timeouts to the Thread#join methods in CommitLog#shutdownBlocking&lt;/p&gt;</comment>
                            <comment id="13640207" author="ignaced" created="Wed, 24 Apr 2013 07:56:14 +0000"  >&lt;p&gt;Just an idea : one could say that the problem is caused by the java runtime that is holding a lock during System.exit(). At the same time, the cassandra code (the uncaught exception handler) is potentially calling System.exit() many times. Would it not be more safe and clean for the code in the handler to call at most once System.exit(), avoiding the jre lock and letting everything die in a &apos;normal&apos; way?&lt;/p&gt;</comment>
                            <comment id="13640306" author="krummas" created="Wed, 24 Apr 2013 10:00:45 +0000"  >&lt;p&gt;adds a lock to make sure only one thread calls System.exit&lt;/p&gt;

&lt;p&gt;the threads that would have called System.exit will block (unclear (to me) what would happen if they would be allowed to continue to run where they should have exited)&lt;/p&gt;</comment>
                            <comment id="13644517" author="jbellis" created="Mon, 29 Apr 2013 14:29:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;the threads that would have called System.exit&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t think we&apos;re very rigorous about calling Thread.setDaemon, so I think this will actually deadlock it &amp;#8211; System.exit will wait for daemon threads to die, and the daemon threads will park at the lock acquisition.&lt;/p&gt;</comment>
                            <comment id="13663065" author="krummas" created="Tue, 21 May 2013 15:48:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbellis&quot; class=&quot;user-hover&quot; rel=&quot;jbellis&quot;&gt;jbellis&lt;/a&gt; you think the timeouts would be enough?&lt;/p&gt;</comment>
                            <comment id="13664116" author="jbellis" created="Wed, 22 May 2013 13:59:18 +0000"  >&lt;p&gt;Thinking about it more, I think adding a lock doesn&apos;t change anything.  System.exit already locks/synchronizes the important parts.  So we still have the deadlock problem, which we can hack around with timeouts but I&apos;d rather not.&lt;/p&gt;

&lt;p&gt;Patch attached against 1.2 to call System.exit from a new thread instead.&lt;/p&gt;</comment>
                            <comment id="13664184" author="jbellis" created="Wed, 22 May 2013 15:27:15 +0000"  >&lt;p&gt;v3 preallocates the Thread.&lt;/p&gt;</comment>
                            <comment id="13664186" author="krummas" created="Wed, 22 May 2013 15:29:29 +0000"  >&lt;p&gt;lgtm&lt;/p&gt;</comment>
                            <comment id="13664189" author="jbellis" created="Wed, 22 May 2013 15:33:04 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12580265" name="0001-CASSANDRA-5273-add-timeouts-to-the-blocking-commitlo.patch" size="4916" author="marcuse" created="Wed, 24 Apr 2013 10:00:45 +0000"/>
                            <attachment id="12580250" name="0001-CASSANDRA-5273-add-timeouts-to-the-blocking-commitlo.patch" size="3080" author="marcuse" created="Wed, 24 Apr 2013 07:44:56 +0000"/>
                            <attachment id="12584307" name="5273-v2.txt" size="1246" author="jbellis" created="Wed, 22 May 2013 13:59:18 +0000"/>
                            <attachment id="12584316" name="5273-v3.txt" size="1289" author="jbellis" created="Wed, 22 May 2013 15:27:15 +0000"/>
                            <attachment id="12570109" name="CassHangs.txt" size="88399" author="ignaced" created="Wed, 20 Feb 2013 10:46:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>313661</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1i4lz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>314006</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>marcuse</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>