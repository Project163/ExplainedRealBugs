<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:01:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-7281] SELECT on tuple relations are broken for mixed ASC/DESC clustering order</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-7281</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;As noted on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6875?focusedCommentId=13992153&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13992153&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;CASSANDRA-6875&lt;/a&gt;, the tuple notation is broken when the clustering order mixes ASC and DESC directives because the range of data they describe don&apos;t correspond to a single continuous slice internally. To copy the example from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6875&quot; title=&quot;CQL3: select multiple CQL rows in a single partition using IN&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6875&quot;&gt;&lt;del&gt;CASSANDRA-6875&lt;/del&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh:ks&amp;gt; create table foo (a int, b int, c int, PRIMARY KEY (a, b, c)) WITH CLUSTERING ORDER BY (b DESC, c ASC);
cqlsh:ks&amp;gt; INSERT INTO foo (a, b, c) VALUES (0, 2, 0);
cqlsh:ks&amp;gt; INSERT INTO foo (a, b, c) VALUES (0, 1, 0);
cqlsh:ks&amp;gt; INSERT INTO foo (a, b, c) VALUES (0, 1, 1);
cqlsh:ks&amp;gt; INSERT INTO foo (a, b, c) VALUES (0, 0, 0);
cqlsh:ks&amp;gt; SELECT * FROM foo WHERE a=0;

 a | b | c
---+---+---
 0 | 2 | 0
 0 | 1 | 0
 0 | 1 | 1
 0 | 0 | 0

(4 rows)

cqlsh:ks&amp;gt; SELECT * FROM foo WHERE a=0 AND (b, c) &amp;gt; (1, 0);

 a | b | c
---+---+---
 0 | 2 | 0

(1 rows)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The last query should really return &lt;tt&gt;(0, 2, 0)&lt;/tt&gt; and &lt;tt&gt;(0, 1, 1)&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;For that specific example we should generate 2 internal slices, but I believe that with more clustering columns we may have more slices.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12715801">CASSANDRA-7281</key>
            <summary>SELECT on tuple relations are broken for mixed ASC/DESC clustering order</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marcinszymaniuk">Marcin Szymaniuk</assignee>
                                    <reporter username="slebresne">Sylvain Lebresne</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 May 2014 17:22:26 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:44 +0000</updated>
                            <resolved>Thu, 11 Feb 2016 09:52:40 +0000</resolved>
                                        <fixVersion>2.2.6</fixVersion>
                    <fixVersion>3.0.4</fixVersion>
                    <fixVersion>3.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14215483" author="marcinszymaniuk" created="Tue, 18 Nov 2014 00:29:23 +0000"  >&lt;p&gt;This patch makes the tuple query working&lt;/p&gt;

&lt;p&gt;There are two concerns though:&lt;br/&gt;
1.  I don&apos;t get why we have the last line assert in testMultipleClusteringReversedComponents. The fact result set is not empty  now seem to be correct to me.&lt;/p&gt;

&lt;p&gt;2. Not sure about validateSlices. The way slices are represented makes it fail sometimes. Not sure if it&apos;s a bug in my code or I the validation is not correct anymore. Here is example of validate failing:&lt;/p&gt;

&lt;p&gt;create table foo (a int, b int, c int, d int , e int, PRIMARY KEY (a, b, c, d, e) )&lt;br/&gt;
            WITH CLUSTERING ORDER BY (b DESC, c ASC, d ASC, e DESC);&lt;/p&gt;

&lt;p&gt;SELECT * FROM foo WHERE a=0 AND (b, c, d, e) &amp;gt; (0, 1, 1, 0);&lt;/p&gt;

&lt;p&gt;I transform this restriction to 4 independent restrictions:&lt;br/&gt;
b&amp;gt;0&lt;br/&gt;
b=0 c=1 d=1 e&amp;gt;0&lt;br/&gt;
b=0 c=1 c&amp;gt;1&lt;br/&gt;
b=0 c&amp;gt;1&lt;br/&gt;
when we create slices out of it it ends up as:&lt;br/&gt;
slices = [&lt;span class=&quot;error&quot;&gt;&amp;#91;, 000400000000ff&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;000400000000000004000000010000040000000100, 000400000000000004000000010000040000000100000400000000ff&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;000400000000000004000000010000040000000101, 0004000000000000040000000101&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;0004000000000000040000000101, 00040000000001&amp;#93;&lt;/span&gt;]&lt;/p&gt;

&lt;p&gt;so slices&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;==slices&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; which seems fine to me (maybe not optimal?)&lt;/p&gt;

&lt;p&gt;then this condition in validateSlices make it fail:&lt;br/&gt;
if (i &amp;gt; 0 &amp;amp;&amp;amp; comparator.compare(slices&lt;span class=&quot;error&quot;&gt;&amp;#91;i - 1&amp;#93;&lt;/span&gt;.finish, start) &amp;gt;= 0)&lt;/p&gt;

&lt;p&gt;In the patch I commented out the problematic condition in validation and the query works. If the validation is still valid I will have to fix the code but I need some sugestions. &lt;br/&gt;
Also I have bunch of dtests. Do I submit them independently?&lt;/p&gt;



</comment>
                            <comment id="14215488" author="mshuler" created="Tue, 18 Nov 2014 00:33:12 +0000"  >&lt;p&gt;Nit:  if you&apos;re going to remove lines in &lt;tt&gt;src/java/org/apache/cassandra/db/filter/ColumnSlice.java&lt;/tt&gt;, remove them, please, don&apos;t comment them out.&lt;/p&gt;</comment>
                            <comment id="14215496" author="mshuler" created="Tue, 18 Nov 2014 00:36:54 +0000"  >&lt;p&gt;Missed the dtest comment - send those as a pull request on &lt;a href=&quot;https://github.com/riptano/cassandra-dtest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/riptano/cassandra-dtest&lt;/a&gt; - thanks!&lt;/p&gt;</comment>
                            <comment id="14219694" author="marcinszymaniuk" created="Thu, 20 Nov 2014 18:13:38 +0000"  >&lt;p&gt;New patch uploaded.&lt;br/&gt;
I decided to just change &amp;lt;= to &amp;lt;. So far I create as many restrictions (slices) as the number of clustering columns in tuple. The fact we query  two slices next to each other instead of one is ok in terms of the final effect. I don&apos;t think it harms performance. We might want to change it to be more consistent from conceptual point of view. I will wait for your thoughts before doing anything more.&lt;br/&gt;
Also I did dtests pull-request related to that change: &lt;br/&gt;
&lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/riptano/cassandra-dtest/pull/118&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14224632" author="blerer" created="Tue, 25 Nov 2014 14:52:32 +0000"  >&lt;p&gt;The ticket is open for the version 2.0 but it seems that the patch has been built for an other version. Marcin, could you backport your fix for version 2.0.&lt;/p&gt;</comment>
                            <comment id="14227974" author="marcinszymaniuk" created="Thu, 27 Nov 2014 21:37:44 +0000"  >&lt;p&gt;Ah sorry. Just attached patch for 2.0.&lt;/p&gt;</comment>
                            <comment id="14250021" author="philipthompson" created="Wed, 17 Dec 2014 15:48:55 +0000"  >&lt;p&gt;Any chance this could get reviewed before the holidays?&lt;/p&gt;</comment>
                            <comment id="14250245" author="blerer" created="Wed, 17 Dec 2014 18:17:18 +0000"  >&lt;p&gt;I will try but the chances are low.&lt;/p&gt;</comment>
                            <comment id="14250263" author="philipthompson" created="Wed, 17 Dec 2014 18:25:54 +0000"  >&lt;p&gt;Okay, that is fine. Sylvain mentioned a possible 2.1.3 release by the end of the calendar year. If this patch makes it into that release, that is soon enough.&lt;/p&gt;</comment>
                            <comment id="14276925" author="blerer" created="Wed, 14 Jan 2015 14:10:54 +0000"  >&lt;ul&gt;
	&lt;li&gt;It seems that the patch does not work when the two sides of the slice are specified. Queries like:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SELECT * FROM foo WHERE a=0 AND (b) &amp;gt; (0) AND (b) &amp;lt;= (1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SELECT * FROM %s WHERE a=0 AND (b, c) &amp;gt; (1, 0) AND (b, c) &amp;lt; (2, 0);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;do not returns the good rows.&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;It would be good to also add some unit tests to &lt;tt&gt;MultiColumnRelationTest&lt;/tt&gt; to cover all of the possible cases&lt;/li&gt;
	&lt;li&gt;The  code is quite heavy and will not merge in 3.0 due to the &lt;tt&gt;SelectStatement&lt;/tt&gt; refactoring.You should be able to fix this ticket by changing only the &lt;tt&gt;SelectStatement.buildMultiColumnSliceBound&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14294121" author="blerer" created="Tue, 27 Jan 2015 20:20:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcinszymaniuk&quot; class=&quot;user-hover&quot; rel=&quot;marcinszymaniuk&quot;&gt;marcinszymaniuk&lt;/a&gt; do you want to provide another patch or should I reassign the ticket?&lt;/p&gt;</comment>
                            <comment id="14294313" author="marcinszymaniuk" created="Tue, 27 Jan 2015 22:27:15 +0000"  >&lt;p&gt;Ah yes I will provide another one. I missed your message.&lt;/p&gt;</comment>
                            <comment id="14298609" author="blerer" created="Fri, 30 Jan 2015 13:19:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcinszymaniuk&quot; class=&quot;user-hover&quot; rel=&quot;marcinszymaniuk&quot;&gt;marcinszymaniuk&lt;/a&gt; I am currently working on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8613&quot; title=&quot;Regression in mixed single and multi-column relation support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8613&quot;&gt;&lt;del&gt;CASSANDRA-8613&lt;/del&gt;&lt;/a&gt; and the changes requireded for it will impact a lot the code of &lt;tt&gt;SelectStatement&lt;/tt&gt; used to build the requestedBounds. &lt;br/&gt;
If you can, it might be better to wait a bit before writing your patch. &lt;/p&gt;</comment>
                            <comment id="14300027" author="marcinszymaniuk" created="Sat, 31 Jan 2015 23:10:45 +0000"  >&lt;p&gt;Sure, I started watching your ticket.&lt;/p&gt;</comment>
                            <comment id="14350102" author="blerer" created="Fri, 6 Mar 2015 08:28:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcinszymaniuk&quot; class=&quot;user-hover&quot; rel=&quot;marcinszymaniuk&quot;&gt;marcinszymaniuk&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8613&quot; title=&quot;Regression in mixed single and multi-column relation support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8613&quot;&gt;&lt;del&gt;CASSANDRA-8613&lt;/del&gt;&lt;/a&gt; as been committed. &lt;br/&gt;
You are good to go &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14352704" author="marcinszymaniuk" created="Mon, 9 Mar 2015 09:09:57 +0000"  >&lt;p&gt;Ok, cool&lt;/p&gt;</comment>
                            <comment id="14496311" author="jbellis" created="Wed, 15 Apr 2015 15:09:20 +0000"  >&lt;p&gt;So the patches from Nov need to be redone on top of 8613, right?&lt;/p&gt;

&lt;p&gt;Marking as Open for now.&lt;/p&gt;</comment>
                            <comment id="14539576" author="blerer" created="Tue, 12 May 2015 09:27:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcinszymaniuk&quot; class=&quot;user-hover&quot; rel=&quot;marcinszymaniuk&quot;&gt;marcinszymaniuk&lt;/a&gt; Do you still want to provide a patch or should I reasign the issue? The issue has been open for nearly a year and I would like to get rid of it as it is one of the last issues that we have on tuple relations.&lt;/p&gt;</comment>
                            <comment id="14550010" author="marcinszymaniuk" created="Tue, 19 May 2015 08:09:59 +0000"  >&lt;p&gt;I will provide another patch by the end of this week&lt;/p&gt;</comment>
                            <comment id="14550027" author="blerer" created="Tue, 19 May 2015 08:25:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcinszymaniuk&quot; class=&quot;user-hover&quot; rel=&quot;marcinszymaniuk&quot;&gt;marcinszymaniuk&lt;/a&gt; Great! Thanks&lt;/p&gt;</comment>
                            <comment id="14558124" author="marcinszymaniuk" created="Mon, 25 May 2015 11:20:14 +0000"  >&lt;p&gt;I Uploaded a patch yesterday in case you don&apos;t get notifications for that.&lt;/p&gt;</comment>
                            <comment id="14558870" author="blerer" created="Tue, 26 May 2015 08:46:09 +0000"  >&lt;p&gt;Thanks for the patch. It is nice that you added all those unit tests.&lt;/p&gt;

&lt;p&gt;I had a quick look at the patch and I have the following comments:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8613&quot; title=&quot;Regression in mixed single and multi-column relation support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8613&quot;&gt;&lt;del&gt;CASSANDRA-8613&lt;/del&gt;&lt;/a&gt; has changed the way things are working. You can now have a mix tulpe relations and non tulpe relations. This means that you first relation might not be a tulpe relation or a slice tulpe relation.&lt;/li&gt;
	&lt;li&gt;In 2.2 &lt;tt&gt;SelectStatement&lt;/tt&gt; has been refactored to simplify the code and allow us to implements more complex features. Your approach of creating new restrictions will not fit properly there.&lt;br/&gt;
I believe that you should be able to skip this restrictions creation step and implements the logic into &lt;tt&gt;buildBound&lt;/tt&gt; by going directly from the original restriction to the composites.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;FYI: The &lt;tt&gt;buildBond&lt;/tt&gt; unit tests are located in &lt;tt&gt;SelectStatementTest&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14561778" author="marcinszymaniuk" created="Wed, 27 May 2015 21:33:36 +0000"  >&lt;p&gt;Ok I will have a look. I guess we should change Fix Version/s then?&lt;/p&gt;</comment>
                            <comment id="14561779" author="marcinszymaniuk" created="Wed, 27 May 2015 21:33:44 +0000"  >&lt;p&gt;Ok I will have a look. I guess we should change Fix Version/s then?&lt;/p&gt;</comment>
                            <comment id="14568757" author="marcinszymaniuk" created="Tue, 2 Jun 2015 08:18:03 +0000"  >&lt;p&gt;In 2.2 I cannot see classes/methods mentioned in your comment. &lt;br/&gt;
From quick look it seems to me that:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MultiColumnRestriction.Slice#appendBoundTo is the place to implement the logic&lt;/li&gt;
	&lt;li&gt;PrimaryKeyRestrictionSetTest is good place to create more of unit-style tests.&lt;br/&gt;
Can you please have a look and confirm? &lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14568783" author="blerer" created="Tue, 2 Jun 2015 08:38:26 +0000"  >&lt;p&gt;Sorry, my comment was really not that clear.&lt;br/&gt;
In 2.1: I think that your code should tackle the problem within the &lt;tt&gt;SelectStatement.buildBound&lt;/tt&gt; method. The tests for that method are within &lt;tt&gt;SelectStatementTest&lt;/tt&gt;.&lt;br/&gt;
In 2.2 you are right the code should be within &lt;tt&gt;MultiColumnRestriction.Slice.appendBoundTo&lt;/tt&gt; method and the tests are within {{PrimaryKeyRestrictionSetTest }}.&lt;/p&gt;

&lt;p&gt;I expect that if you manage to fix the problem in 2.1 as part of the &lt;tt&gt;SelectStatement.buildBound&lt;/tt&gt; method you should be able to make it work within 2.2 without too much difficulties by extracting your fix and putting it within &lt;tt&gt;MultiColumnRestriction.Slice.appendBoundTo&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Hope it helps.&lt;br/&gt;
Do not hesitate to contact me on IRC or by email if you have more questions&lt;/p&gt;</comment>
                            <comment id="14578472" author="stefania" created="Tue, 9 Jun 2015 07:21:38 +0000"  >&lt;p&gt;The dtests that were written for this ticket are being migrated to java unit tests, see &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9160&quot; title=&quot;Migrate CQL dtests to unit tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9160&quot;&gt;&lt;del&gt;CASSANDRA-9160&lt;/del&gt;&lt;/a&gt;. I am attaching the java equivalent of the dtests, &lt;em&gt;7281_unit_tests.txt&lt;/em&gt;. You need to add it to your patch, picking the cql3 unit test file that is more appropriate. I was not able to test them so there could be conversion typos or mistakes.&lt;/p&gt;</comment>
                            <comment id="14586621" author="marcinszymaniuk" created="Mon, 15 Jun 2015 20:21:16 +0000"  >&lt;p&gt;All right. I will merge it with unit tests I already have (It might be that those from dtest are not necessary anymore).&lt;/p&gt;</comment>
                            <comment id="14587132" author="stefania" created="Mon, 15 Jun 2015 23:22:35 +0000"  >&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="14632885" author="marcinszymaniuk" created="Sun, 19 Jul 2015 17:42:08 +0000"  >&lt;p&gt;Attaching a patch for 2.2.  I will have a look at 2.1 after this gets reviewed.&lt;/p&gt;</comment>
                            <comment id="14966879" author="blerer" created="Wed, 21 Oct 2015 14:21:39 +0000"  >&lt;p&gt;Sorry for not reviewing the patch sooner.&lt;/p&gt;

&lt;p&gt;Your patch suffer from the same problem as I mentionned earlier. It will not work with a mix of single and multi column restrictions like:&lt;br/&gt;
&lt;tt&gt;SELECT * FROM myTable WHERE partitionKey = 1 AND clustering_1 IN (1, 2) AND clustering_2 = 0 AND (clustering_3, clustering_4) &amp;gt; (2, 3);&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Another problem is that a big part of the code in &lt;tt&gt;PrimaryKeyRestrictionSet&lt;/tt&gt; is relative to &lt;tt&gt;MultiColumnRestrictions&lt;/tt&gt; and should be in my opinion encapsulate within it. Having this code within &lt;tt&gt;PrimaryKeyRestrictionSet&lt;/tt&gt; will make the implementation of an issue like &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8855&quot; title=&quot; Batching SELECTs for multiple column ranges for the same partition key&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8855&quot;&gt;CASSANDRA-8855&lt;/a&gt; much more complicated.&lt;/p&gt;

&lt;p&gt;I have pushed modified version of the patch for 2.2 &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...blerer:7281-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; (it runs fine on CI).&lt;/p&gt;

&lt;p&gt;Feel free to provide some feedbacks on it. &lt;/p&gt;



</comment>
                            <comment id="15027102" author="blerer" created="Wed, 25 Nov 2015 16:50:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcinszymaniuk&quot; class=&quot;user-hover&quot; rel=&quot;marcinszymaniuk&quot;&gt;marcinszymaniuk&lt;/a&gt; do you have any comments on my modified version?&lt;/p&gt;

&lt;p&gt;Are you still interested in providing a patch for 2.1 and 3.0?&lt;/p&gt;</comment>
                            <comment id="15034102" author="marcinszymaniuk" created="Tue, 1 Dec 2015 17:18:21 +0000"  >&lt;p&gt;I&apos;m still interested. I will have a look at your patch.&lt;/p&gt;</comment>
                            <comment id="15094027" author="slebresne" created="Tue, 12 Jan 2016 15:10:44 +0000"  >&lt;p&gt;Had a look at &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;&apos;s modified version and it looks good, but we obviously need patches for 3.0 and upwards (as well as links to the CI results). I don&apos;t think we&apos;ll want to commit this to 2.1 at this point however, so I suggest not wasting time on that.&lt;/p&gt;</comment>
                            <comment id="15095858" author="blerer" created="Wed, 13 Jan 2016 09:13:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcinszymaniuk&quot; class=&quot;user-hover&quot; rel=&quot;marcinszymaniuk&quot;&gt;marcinszymaniuk&lt;/a&gt; do you have time to make the patches for 3.0 and 3.3 in the coming days? We would like to have this ticket fixed for the 3.3 release.&lt;/p&gt;</comment>
                            <comment id="15108230" author="marcinszymaniuk" created="Wed, 20 Jan 2016 08:52:23 +0000"  >&lt;p&gt;I will do it over the weekend if it&apos;s not too late for you.&lt;/p&gt;</comment>
                            <comment id="15108830" author="blerer" created="Wed, 20 Jan 2016 16:25:22 +0000"  >&lt;p&gt;It would be perfect. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15114522" author="marcinszymaniuk" created="Sun, 24 Jan 2016 20:29:37 +0000"  >&lt;p&gt;To be honest I underestimated time I need to get familiar with 3.x. There are some significant changes around bounds. So far I just rewritten some test Benjamin added. Depends on your schedule, I will have a look at it later this week/weekend but I understand it might be too late for your release. Please let me know if you decide you start working on this on your own so I don&apos;t do it in parallel. I&apos;m attaching two tests I rewritten - It can save you some typing.&lt;/p&gt;</comment>
                            <comment id="15115316" author="blerer" created="Mon, 25 Jan 2016 14:52:22 +0000"  >&lt;p&gt;Thanks for the work.&lt;/p&gt;

&lt;p&gt;The code freeze for 3.3 will be next monday. By consequence, end of week will probably be too late for the review process.&lt;br/&gt;
I will take it over. &lt;/p&gt;</comment>
                            <comment id="15118917" author="blerer" created="Wed, 27 Jan 2016 09:21:31 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;patch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;utests&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtests&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...blerer:7281-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-7281-2.2-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-7281-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...blerer:7281-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-7281-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-7281-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...blerer:7281-3.3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.3&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-7281-3.3-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.3&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-7281-3.3-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.3&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...blerer:7281-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-7281-trunk-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-7281-trunk-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt; could you review?&lt;/p&gt;

&lt;p&gt;The patch for 2.2 is the same as before. It has just been rebased.&lt;br/&gt;
The patch for 3.0 is different for &lt;tt&gt;MultiCBuilder&lt;/tt&gt;, &lt;tt&gt;PrimaryKeyRestrictionSet&lt;/tt&gt; and &lt;tt&gt;PrimaryKeyRestrictionSetTest&lt;/tt&gt; due to the changes of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8099&quot; title=&quot;Refactor and modernize the storage engine&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8099&quot;&gt;&lt;del&gt;CASSANDRA-8099&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
The patch for 3.3 differs from the one of 3.0 for &lt;tt&gt;MultiCBuilder&lt;/tt&gt; and &lt;tt&gt;PrimaryKeyRestrictionSet&lt;/tt&gt; due to the changes of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10409&quot; title=&quot;Specialize MultiCBuilder when building a single clustering&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10409&quot;&gt;&lt;del&gt;CASSANDRA-10409&lt;/del&gt;&lt;/a&gt; which modified &lt;tt&gt;MultiCBuilder&lt;/tt&gt;.&lt;br/&gt;
The patch for trunk is the same as the one of 3.3.&lt;/p&gt;</comment>
                            <comment id="15141014" author="slebresne" created="Wed, 10 Feb 2016 15:36:09 +0000"  >&lt;p&gt;lgtm, +1 (probably needs a minor rebasing though before committing).&lt;/p&gt;</comment>
                            <comment id="15142482" author="blerer" created="Thu, 11 Feb 2016 09:52:40 +0000"  >&lt;p&gt;Committed into 2.2 at 90fc8969a656b183e81496e479db35f321c8a3aa and merged into 3.0 and trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12682036" name="0001-CASSANDRA-7281-SELECT-on-tuple-relations-are-broken-.patch" size="8001" author="marcinszymaniuk" created="Tue, 18 Nov 2014 00:29:23 +0000"/>
                            <attachment id="12682700" name="0001-CASSANDRA-7281-SELECT-on-tuple-relations-are-broken-v2.patch" size="7929" author="marcinszymaniuk" created="Thu, 20 Nov 2014 18:13:38 +0000"/>
                            <attachment id="12684118" name="0001-CASSANDRA-7281-SELECT-on-tuple-relations-are-broken-v3.patch" size="8399" author="marcinszymaniuk" created="Thu, 27 Nov 2014 21:36:57 +0000"/>
                            <attachment id="12735079" name="0001-CASSANDRA-7281-SELECT-on-tuple-relations-are-broken-v4.patch" size="49539" author="marcinszymaniuk" created="Sun, 24 May 2015 18:02:16 +0000"/>
                            <attachment id="12746014" name="0001-CASSANDRA-7281-SELECT-on-tuple-relations-are-broken-v5.patch" size="52611" author="marcinszymaniuk" created="Sun, 19 Jul 2015 17:42:08 +0000"/>
                            <attachment id="12784071" name="0001-Some-tests-for-CASSANDRA-7281.patch" size="24142" author="marcinszymaniuk" created="Sun, 24 Jan 2016 20:30:14 +0000"/>
                            <attachment id="12738532" name="7281_unit_tests.txt" size="5726" author="stefania" created="Tue, 9 Jun 2015 07:21:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcinszymaniuk]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>394086</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 40 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1vurz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>394224</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>blerer</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>