<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:06:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13125] Duplicate rows after upgrading from 2.1.16 to 3.0.10/3.9</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13125</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I found that rows are splitting and duplicated after upgrading the cluster from 2.1.x to 3.0.x.&lt;/p&gt;

&lt;p&gt;I found the way to reproduce the problem as below.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ ccm create test -v 2.1.16 -n 3 -s                                                                               
Current cluster is now: test
$ ccm node1 cqlsh  -e &lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE KEYSPACE test WITH replication = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;replication_factor&apos;&lt;/span&gt;:3}&quot;&lt;/span&gt;
$ ccm node1 cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE test.test (id text PRIMARY KEY, value1 set&amp;lt;text&amp;gt;, value2 set&amp;lt;text&amp;gt;);&quot;&lt;/span&gt;

# Upgrade node1
$ &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; i in 1; &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; ccm node${i} stop; ccm node${i} setdir -v3.0.10; ccm node${i} start;ccm node${i} nodetool upgradesstables; done

# Insert a row through node1(3.0.10)
$ ccm node1 cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT INTO test.test (id, value1, value2) values (&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, {&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bbb&apos;&lt;/span&gt;}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;ccc&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ddd&apos;&lt;/span&gt;});&quot;&lt;/span&gt;                       

# Insert a row through node2(2.1.16)
$ ccm node2 cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT INTO test.test (id, value1, value2) values (&lt;span class=&quot;code-quote&quot;&gt;&apos;bbb&apos;&lt;/span&gt;, {&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bbb&apos;&lt;/span&gt;}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;ccc&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ddd&apos;&lt;/span&gt;});&quot;&lt;/span&gt; 

# The row inserted from node1 is splitting
$ ccm node1 cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM test.test ;&quot;&lt;/span&gt;

 id  | value1         | value2
-----+----------------+----------------
 aaa |           &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; |           &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
 aaa | {&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bbb&apos;&lt;/span&gt;} | {&lt;span class=&quot;code-quote&quot;&gt;&apos;ccc&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ddd&apos;&lt;/span&gt;}
 bbb | {&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bbb&apos;&lt;/span&gt;} | {&lt;span class=&quot;code-quote&quot;&gt;&apos;ccc&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ddd&apos;&lt;/span&gt;}

$ &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; i in 1 2; &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; ccm node${i} nodetool flush; done

# Results of sstable2json of node2. The row inserted from node1(3.0.10) is different from the row inserted from node2(2.1.16).
$ ccm node2 json -k test -c test
running
[&lt;span class=&quot;code-quote&quot;&gt;&apos;/home/zzheng/.ccm/test/node2/data0/test/test-5406ee80dbdb11e6a175f57c4c7c85f3/test-test-ka-1-Data.db&apos;&lt;/span&gt;]
-- test-test-ka-1-Data.db -----
[
{&lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;aaa&quot;&lt;/span&gt;,
 &lt;span class=&quot;code-quote&quot;&gt;&quot;cells&quot;&lt;/span&gt;: [[&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;,&quot;&lt;/span&gt;&quot;,1484564624769577],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;value2:!&quot;&lt;/span&gt;,1484564624769576,&lt;span class=&quot;code-quote&quot;&gt;&quot;t&quot;&lt;/span&gt;,1484564624],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value1:616161&quot;&lt;/span&gt;,&quot;&quot;,1484564624769577],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value1:626262&quot;&lt;/span&gt;,&quot;&quot;,1484564624769577],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value2:636363&quot;&lt;/span&gt;,&quot;&quot;,1484564624769577],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value2:646464&quot;&lt;/span&gt;,&quot;&quot;,1484564624769577]]},
{&lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;bbb&quot;&lt;/span&gt;,
 &lt;span class=&quot;code-quote&quot;&gt;&quot;cells&quot;&lt;/span&gt;: [[&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;,&quot;&lt;/span&gt;&quot;,1484564634508029],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value1:_&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;value1:!&quot;&lt;/span&gt;,1484564634508028,&lt;span class=&quot;code-quote&quot;&gt;&quot;t&quot;&lt;/span&gt;,1484564634],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value1:616161&quot;&lt;/span&gt;,&quot;&quot;,1484564634508029],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value1:626262&quot;&lt;/span&gt;,&quot;&quot;,1484564634508029],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value2:_&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;value2:!&quot;&lt;/span&gt;,1484564634508028,&lt;span class=&quot;code-quote&quot;&gt;&quot;t&quot;&lt;/span&gt;,1484564634],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value2:636363&quot;&lt;/span&gt;,&quot;&quot;,1484564634508029],
           [&lt;span class=&quot;code-quote&quot;&gt;&quot;value2:646464&quot;&lt;/span&gt;,&quot;&quot;,1484564634508029]]}
]

# Upgrade node2,3
$ &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; i in `seq 2 3`; &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; ccm node${i} stop; ccm node${i} setdir -v3.0.10; ccm node${i} start;ccm node${i} nodetool upgradesstables; done

# After upgrade node2,3, the row inserted from node1 is splitting in node2,3
$ ccm node2 cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM test.test ;&quot;&lt;/span&gt;                                                                                        

 id  | value1         | value2
-----+----------------+----------------
 aaa |           &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; |           &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
 aaa | {&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bbb&apos;&lt;/span&gt;} | {&lt;span class=&quot;code-quote&quot;&gt;&apos;ccc&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ddd&apos;&lt;/span&gt;}
 bbb | {&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bbb&apos;&lt;/span&gt;} | {&lt;span class=&quot;code-quote&quot;&gt;&apos;ccc&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ddd&apos;&lt;/span&gt;}

(3 rows)

# Results of sstabledump
# node1
[
  {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;partition&quot;&lt;/span&gt; : {
      &lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;aaa&quot;&lt;/span&gt; ],
      &lt;span class=&quot;code-quote&quot;&gt;&quot;position&quot;&lt;/span&gt; : 0
    },
    &lt;span class=&quot;code-quote&quot;&gt;&quot;rows&quot;&lt;/span&gt; : [
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;row&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;position&quot;&lt;/span&gt; : 17,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;liveness_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;tstamp&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:44.769577Z&quot;&lt;/span&gt; },
        &lt;span class=&quot;code-quote&quot;&gt;&quot;cells&quot;&lt;/span&gt; : [
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;deletion_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;marked_deleted&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:44.769576Z&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;local_delete_time&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:44Z&quot;&lt;/span&gt; } },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;aaa&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;bbb&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;deletion_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;marked_deleted&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:44.769576Z&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;local_delete_time&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:44Z&quot;&lt;/span&gt; } },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;ccc&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;ddd&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; }
        ]
      }
    ]
  },
  {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;partition&quot;&lt;/span&gt; : {
      &lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;bbb&quot;&lt;/span&gt; ],
      &lt;span class=&quot;code-quote&quot;&gt;&quot;position&quot;&lt;/span&gt; : 48
    },
    &lt;span class=&quot;code-quote&quot;&gt;&quot;rows&quot;&lt;/span&gt; : [
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;row&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;position&quot;&lt;/span&gt; : 65,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;liveness_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;tstamp&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:54.508029Z&quot;&lt;/span&gt; },
        &lt;span class=&quot;code-quote&quot;&gt;&quot;cells&quot;&lt;/span&gt; : [
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;deletion_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;marked_deleted&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:54.508028Z&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;local_delete_time&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:54Z&quot;&lt;/span&gt; } },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;aaa&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;bbb&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;deletion_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;marked_deleted&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:54.508028Z&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;local_delete_time&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:54Z&quot;&lt;/span&gt; } },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;ccc&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;ddd&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; }
        ]
      }
    ]
  }
]                                                                                                                                                    

# node2
[
  {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;partition&quot;&lt;/span&gt; : {
      &lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;aaa&quot;&lt;/span&gt; ],
      &lt;span class=&quot;code-quote&quot;&gt;&quot;position&quot;&lt;/span&gt; : 0
    },
    &lt;span class=&quot;code-quote&quot;&gt;&quot;rows&quot;&lt;/span&gt; : [
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;row&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;position&quot;&lt;/span&gt; : 17,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;liveness_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;tstamp&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:44.769577Z&quot;&lt;/span&gt; },
        &lt;span class=&quot;code-quote&quot;&gt;&quot;cells&quot;&lt;/span&gt; : [ ]
      },
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;row&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;position&quot;&lt;/span&gt; : 22,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;deletion_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;marked_deleted&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:44.769576Z&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;local_delete_time&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:44Z&quot;&lt;/span&gt; },
        &lt;span class=&quot;code-quote&quot;&gt;&quot;cells&quot;&lt;/span&gt; : [
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;aaa&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;tstamp&lt;span class=&quot;code-quote&quot;&gt;&quot; : &quot;&lt;/span&gt;2017-01-16T11:03:44.769577Z&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;bbb&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;tstamp&lt;span class=&quot;code-quote&quot;&gt;&quot; : &quot;&lt;/span&gt;2017-01-16T11:03:44.769577Z&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;ccc&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;tstamp&lt;span class=&quot;code-quote&quot;&gt;&quot; : &quot;&lt;/span&gt;2017-01-16T11:03:44.769577Z&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;ddd&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;tstamp&lt;span class=&quot;code-quote&quot;&gt;&quot; : &quot;&lt;/span&gt;2017-01-16T11:03:44.769577Z&quot; }
        ]
      }
    ]
  },
  {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;partition&quot;&lt;/span&gt; : {
      &lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;bbb&quot;&lt;/span&gt; ],
      &lt;span class=&quot;code-quote&quot;&gt;&quot;position&quot;&lt;/span&gt; : 57
    },
    &lt;span class=&quot;code-quote&quot;&gt;&quot;rows&quot;&lt;/span&gt; : [
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;row&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;position&quot;&lt;/span&gt; : 74,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;liveness_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;tstamp&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:54.508029Z&quot;&lt;/span&gt; },
        &lt;span class=&quot;code-quote&quot;&gt;&quot;cells&quot;&lt;/span&gt; : [
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;deletion_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;marked_deleted&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:54.508028Z&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;local_delete_time&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:54Z&quot;&lt;/span&gt; } },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;aaa&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;bbb&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;deletion_info&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;marked_deleted&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:54.508028Z&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;local_delete_time&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;2017-01-16T11:03:54Z&quot;&lt;/span&gt; } },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;ccc&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; },
          { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;value2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;ddd&quot;&lt;/span&gt; ], &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt; : &quot;&quot; }
        ]
      }
    ]
  }
]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Another example of row splitting is as follows.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ ccm create test2 -v 2.1.16 -n 3 -s                                                                                                    
Current cluster is now: test2
$ ccm node1 cqlsh  -e &lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE KEYSPACE test WITH replication = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;replication_factor&apos;&lt;/span&gt;:3}&quot;&lt;/span&gt;                      
$ ccm node1 cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE test.text_set_set (id text PRIMARY KEY, value1 text, value2 set&amp;lt;text&amp;gt;, value3 set&amp;lt;text&amp;gt;);&quot;&lt;/span&gt;           
$ &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; i in `seq 1`; &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; ccm node${i} stop; ccm node${i} setdir -v3.0.10; ccm node${i} start;ccm node${i} nodetool upgradesstables; done  
$ ccm node1 cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT INTO test.text_set_set (id, value1, value2, value3) values (&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, {&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bbb&apos;&lt;/span&gt;}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;ccc&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ddd&apos;&lt;/span&gt;});&quot;&lt;/span&gt;
$ ccm node1 cqlsh -e &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM test.text_set_set;&quot;&lt;/span&gt;                                                                                 

 id  | value1 | value2         | value3
-----+--------+----------------+----------------
 aaa |    aaa |           &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; |           &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
 aaa |   &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; | {&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bbb&apos;&lt;/span&gt;} | {&lt;span class=&quot;code-quote&quot;&gt;&apos;ccc&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;ddd&apos;&lt;/span&gt;}

(2 rows)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As far as I investigated, the occurrence conditions are as follows.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Table schema contains multiple collections.&lt;/li&gt;
	&lt;li&gt;Insert a row, which values of the collection column are not null through 3.x node while both 2.1 and 3.x nodes exist in a cluster.&lt;/li&gt;
	&lt;li&gt;Rows in sstables of node which version was 2.1 at the time the row was inserted is splitting after upgrading to 3.x.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13035206">CASSANDRA-13125</key>
            <summary>Duplicate rows after upgrading from 2.1.16 to 3.0.10/3.9</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="zzheng">Zhongxiang Zheng</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Jan 2017 12:29:01 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:11 +0000</updated>
                            <resolved>Wed, 8 Feb 2017 10:43:19 +0000</resolved>
                                        <fixVersion>3.0.11</fixVersion>
                    <fixVersion>3.11.0</fixVersion>
                                        <due></due>
                            <votes>2</votes>
                                    <watches>14</watches>
                                                                                                                <comments>
                            <comment id="15829145" author="yasuharu" created="Thu, 19 Jan 2017 01:55:09 +0000"  >&lt;h2&gt;&lt;a name=&quot;Investigations...&quot;&gt;&lt;/a&gt;Investigations...&lt;/h2&gt;

&lt;p&gt;After some debugging, I found interesting difference in serialized RangeTombstoneLists between 2.1.16 and 3.0.10.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I ran 3 Cassandra nodes with some debug prints.
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;127.0.0.1 (C* 3.0.10)&lt;/li&gt;
		&lt;li&gt;127.0.0.2 (C* 2.1.16)&lt;/li&gt;
		&lt;li&gt;127.0.0.3 (C* 2.1.16)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;They have a keyspace and a table already created.
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;CREATE KEYSPACE test WITH replication = 
{&apos;class&apos;: &apos;SimpleStrategy&apos;, &apos;replication_factor&apos;: &apos;1&apos;}&lt;/li&gt;
		&lt;li&gt;CREATE TABLE test.test ( a int PRIMARY KEY, b int, c set&amp;lt;int&amp;gt;, d set&amp;lt;int&amp;gt;, e int )&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;And I query a same INSERT (which mutation is sent to 127.0.0.2) query from 127.0.0.1(C*3.0) and 127.0.0.3(C*2.1) and see the difference.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Insert a row from 127.0.0.1 and scan. ( inserted (a=14) row is broken)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;cqlsh&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;into&lt;/span&gt; test.test(&lt;span class=&quot;code-keyword&quot;&gt;a&lt;/span&gt;,b,&lt;span class=&quot;code-keyword&quot;&gt;c&lt;/span&gt;,d,e) &lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt;(14,1,{2,3},{4,5},6);
cqlsh&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;from&lt;/span&gt; test.test;

 &lt;span class=&quot;code-keyword&quot;&gt;a&lt;/span&gt;  | b    | &lt;span class=&quot;code-keyword&quot;&gt;c&lt;/span&gt;      | d      | e
&lt;span class=&quot;code-comment&quot;&gt;----+------+--------+--------+------
&lt;/span&gt; 14 |    1 |   &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; |   &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; | &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
 14 | &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; | {2, 3} | {4, 5} |    6

(2 &lt;span class=&quot;code-keyword&quot;&gt;rows&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And then, I insert from 127.0.0.3 and scan.  (neither a=5 nor a=14 are broken)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;cqlsh&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;into&lt;/span&gt; test.test(&lt;span class=&quot;code-keyword&quot;&gt;a&lt;/span&gt;,b,&lt;span class=&quot;code-keyword&quot;&gt;c&lt;/span&gt;,d,e)&lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt;(5,1,{2,3},{4,5},6);
cqlsh&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;from&lt;/span&gt; test.test;

 &lt;span class=&quot;code-keyword&quot;&gt;a&lt;/span&gt;  | b | &lt;span class=&quot;code-keyword&quot;&gt;c&lt;/span&gt;      | d      | e
&lt;span class=&quot;code-comment&quot;&gt;----+---+--------+--------+---
&lt;/span&gt;  5 | 1 | {2, 3} | {4, 5} | 6
 14 | 1 | {2, 3} | {4, 5} | 6
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And back to 127.0.0.1 and scan the table. a=14 is broken but a=5 is not.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;cqlsh&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;from&lt;/span&gt; test.test;

 &lt;span class=&quot;code-keyword&quot;&gt;a&lt;/span&gt;  | b    | &lt;span class=&quot;code-keyword&quot;&gt;c&lt;/span&gt;      | d      | e
&lt;span class=&quot;code-comment&quot;&gt;----+------+--------+--------+------
&lt;/span&gt;  5 |    1 | {2, 3} | {4, 5} |    6
 14 |    1 |   &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; |   &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; | &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
 14 | &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; | {2, 3} | {4, 5} |    6
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Therefore,It looks like that &quot;C*3 can&apos;t scan properly rows that is stored in C*2 but inserted from C*3.&quot;;&lt;/p&gt;

&lt;p&gt;Next, I observed some incoming MUTATIONs in 127.0.0.2 like below. I saw that C*3.0 sent RangeTombstones like &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;c-c&amp;#93;&lt;/span&gt;,&lt;span class=&quot;error&quot;&gt;&amp;#91;c-d&amp;#93;&lt;/span&gt;&lt;/tt&gt;, but C*2.1 sent &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;c:_-c&amp;#93;&lt;/span&gt;,&lt;span class=&quot;error&quot;&gt;&amp;#91;d:_-d&amp;#93;&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;gt; insert into test.test(a,b,c,d,e) values(14,1,{2,3},{4,5},6); from 127.0.0.1

DeletionInfo:{deletedAt=-9223372036854775808, localDeletion=2147483647, ranges=[c-c:!, deletedAt=1484710273390930, localDeletion=1484710273][c-d:!, deletedAt=1484710273390930, localDeletion=1484710273]}
from:/127.0.0.1, payload:Mutation(keyspace=&apos;test&apos;, key=&apos;0000000e&apos;, modifications=[ColumnFamily(test -{deletedAt=-9223372036854775808, localDeletion=2147483647, ranges=[c-c:!, deletedAt=1484710273390930, localDeletion=1484710273][c-d:!, deletedAt=1484710273390930, localDeletion=1484710273]}- [:false:0@1484710273390931,b:false:4@1484710273390931,c:00000002:false:0@1484710273390931,c:00000003:false:0@1484710273390931,d:00000004:false:0@1484710273390931,d:00000005:false:0@1484710273390931,e:false:4@1484710273390931,])]), verb:MUTATION, version:8

&amp;gt; insert into test.test(a,b,c,d,e) values(14,1,{2,3},{4,5},6); from 127.0.0.3
DeletionInfo:{deletedAt=-9223372036854775808, localDeletion=2147483647, ranges=[c:_-c:!, deletedAt=1484710277987556, localDeletion=1484710277][d:_-d:!, deletedAt=1484710277987556, localDeletion=1484710277]}
from:/127.0.0.3, payload:Mutation(keyspace=&apos;test&apos;, key=&apos;0000000e&apos;, modifications=[ColumnFamily(test -{deletedAt=-9223372036854775808, localDeletion=2147483647, ranges=[c:_-c:!, deletedAt=1484710277987556, localDeletion=1484710277][d:_-d:!, deletedAt=1484710277987556, localDeletion=1484710277]}- [:false:0@1484710277987557,b:false:4@1484710277987557,c:00000002:false:0@1484710277987557,c:00000003:false:0@1484710277987557,d:00000004:false:0@1484710277987557,d:00000005:false:0@1484710277987557,e:false:4@1484710277987557,])]), verb:MUTATION, version:8
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;h2&gt;&lt;a name=&quot;WorkaroundPlanA&quot;&gt;&lt;/a&gt;Workaround Plan-A&lt;/h2&gt;

&lt;p&gt;But, LegacyRangeTombstone remove &lt;tt&gt;collectionName&lt;/tt&gt; from RangeTombStone which start.bound != end.bound like &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;c-d&amp;#93;&lt;/span&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-3.0.10/src/java/org/apache/cassandra/db/LegacyLayout.java#L1592-L1599&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-3.0.10/src/java/org/apache/cassandra/db/LegacyLayout.java#L1592-L1599&lt;/a&gt;&lt;br/&gt;
It seems like that this deletions of collectionName corrupt the unmarshal of legacy tombstone. After I commentized these else-if block, I could scan the table correctly.&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((start.collectionName == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) != (stop.collectionName == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;))
            {
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (start.collectionName == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
                    stop = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LegacyBound(stop.bound, stop.isStatic, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
                &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
                    start = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LegacyBound(start.bound, start.isStatic, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
            }
            /*&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!Objects.equals(start.collectionName, stop.collectionName))
            {
                &lt;span class=&quot;code-comment&quot;&gt;// We&apos;re in the similar but slightly more complex &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; where on top of the big tombstone
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// A, we have 2 (or more) collection tombstones B and C within A. So we also end up with
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// a tombstone that goes between the end of B and the start of C.
&lt;/span&gt;                start = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LegacyBound(start.bound, start.isStatic, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
                stop = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LegacyBound(stop.bound, stop.isStatic, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
            }
            */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; select * from test.test;

 a  | b | c      | d      | e
----+---+--------+--------+---
  5 | 1 | {2, 3} | {4, 5} | 6
 14 | 1 | {2, 3} | {4, 5} | 6
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;see patch diff-a.patch.&lt;/p&gt;

&lt;h2&gt;&lt;a name=&quot;WorkaroundPlanB&quot;&gt;&lt;/a&gt;Workaround Plan-B&lt;/h2&gt;
&lt;p&gt;Instead of modify the LegacyLayout unmarshal code, commentizing the following line fixed the problem too. It changes the TombStoneRange which is serialized  by LegacyLayout from &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;c-c&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;c-d&amp;#93;&lt;/span&gt;&lt;/tt&gt; to &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;c-c&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;d-d&amp;#93;&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-3.0.10/src/java/org/apache/cassandra/db/LegacyLayout.java#L2099&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-3.0.10/src/java/org/apache/cassandra/db/LegacyLayout.java#L2099&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;//                     start = ends[i];&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
DeletionInfo:{deletedAt=-9223372036854775808, localDeletion=2147483647, ranges=[c-c:!, deletedAt=1484715120458008, localDeletion=1484715120][d-d:!, deletedAt=1484715120458008, localDeletion=1484715120]}
from:/127.0.0.1, payload:Mutation(keyspace=&apos;test&apos;, key=&apos;0000000e&apos;, modifications=[ColumnFamily(test -{deletedAt=-9223372036854775808, localDeletion=2147483647, ranges=[c-c:!, deletedAt=1484715120458008, localDeletion=1484715120][d-d:!, deletedAt=1484715120458008, localDeletion=1484715120]}- [:false:0@1484715120458009,b:false:4@1484715120458009,c:00000002:false:0@1484715120458009,c:00000003:false:0@1484715120458009,d:00000004:false:0@1484715120458009,d:00000005:false:0@1484715120458009,e:false:4@1484715120458009,])]), verb:MUTATION, version:8
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;see patch diff-b.patch.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure if my solution cause any unexpected effects. But I attach my patches for reference.&lt;br/&gt;
Could anyboody please review my patch?&lt;/p&gt;</comment>
                            <comment id="15829147" author="yasuharu" created="Thu, 19 Jan 2017 01:55:59 +0000"  >&lt;p&gt;A patch for Plan-A on Cassandra 3.0.10&lt;/p&gt;</comment>
                            <comment id="15829148" author="yasuharu" created="Thu, 19 Jan 2017 01:56:26 +0000"  >&lt;p&gt;A patch for Plan-B on Cassandra-3.0.10.&lt;/p&gt;</comment>
                            <comment id="15829150" author="yasuharu" created="Thu, 19 Jan 2017 01:57:08 +0000"  >&lt;p&gt;I&apos;ve submitted a brief patch for reference.&lt;/p&gt;</comment>
                            <comment id="15831816" author="slebresne" created="Fri, 20 Jan 2017 14:31:13 +0000"  >&lt;p&gt;Thanks a lot for the very detailed reproduction case and analysis. You are absolutely right that it&apos;s abnormal for 3.0 to transform a range like &lt;tt&gt;[c-c!][d-d!]&lt;/tt&gt; into &lt;tt&gt;[c-c!][c-d!]&lt;/tt&gt;. And having duplicate row entries is only one of the problem this triggers, as with more collections you could this ending up to delete data that it shouldn&apos;t. In any case, the problem is definitively in 3.0 generating this in the first place, so that&apos;s what we should fix, so fixing this in LegacyRangeTombstone constructor (Plan-A above) is too late.&lt;/p&gt;

&lt;p&gt;So the problem is when building the &lt;tt&gt;LegacyRangeTombstonList&lt;/tt&gt; on 3.0, though it&apos;s not in the &lt;tt&gt;insertFrom&lt;/tt&gt; method and the Plan-B patch would likely create other problems. The problem is in the &lt;tt&gt;LegacyBoundComparator&lt;/tt&gt;: it delegates to &lt;tt&gt;clusteringComparator.compare()&lt;/tt&gt; before it even checks if the bounds it compares have a &lt;tt&gt;collectionName&lt;/tt&gt;, but that&apos;s incorrect.&lt;/p&gt;

&lt;p&gt;Anyway, attaching below a fix for this as well as a simple unit test showing&lt;br/&gt;
where the problem lies:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/pcmanus/cassandra/commits/13125-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;13125-3.0&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;http://cassci.datastax.com/job/pcmanus-13125-3.0-testall&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;http://cassci.datastax.com/job/pcmanus-13125-3.0-dtest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/pcmanus/cassandra/commits/13125-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;13125-3.11&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;http://cassci.datastax.com/job/pcmanus-13125-3.11-testall&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;http://cassci.datastax.com/job/pcmanus-13125-3.11-dtest&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Yasuharu&quot; class=&quot;user-hover&quot; rel=&quot;Yasuharu&quot;&gt;Yasuharu&lt;/a&gt;, if you could check if this patch does properly work in your case, that would be much appreciated. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thobbs&quot; class=&quot;user-hover&quot; rel=&quot;thobbs&quot;&gt;thobbs&lt;/a&gt;, since you&apos;re familiar with 3.0 compatibility code, would you also mind having a quick look at the patch?&lt;/p&gt;</comment>
                            <comment id="15832169" author="yasuharu" created="Fri, 20 Jan 2017 17:48:18 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt;! I checked that your patches worked properly in my reproduce procedure. The result is below. Now I could see that C*3.0 generated &lt;tt&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;c-c!&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;d-d!&amp;#93;&lt;/span&gt;&lt;/tt&gt; style range tombstones and the rows are not broken!&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;On131253.0&quot;&gt;&lt;/a&gt;On 13125-3.0&lt;/h4&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; insert into test.test(a,b,c,d,e) values(14,1,{2,3},{4,5},6);
cqlsh&amp;gt; select * from test.test;

 a  | b | c      | d      | e
----+---+--------+--------+---
 14 | 1 | {2, 3} | {4, 5} | 6

RangeTombstone(0), start:org.apache.cassandra.db.composites.CompoundSparseCellName@78e3b54a, end:org.apache.cassandra.db.composites.BoundedComposite@6b517b57, markedAt:1484931972134334, delTime:1484931972
RangeTombstone(1), start:org.apache.cassandra.db.composites.CompoundSparseCellName@78e3b54b, end:org.apache.cassandra.db.composites.BoundedComposite@6b517b58, markedAt:1484931972134334, delTime:1484931972
DeletionInfo:{deletedAt=-9223372036854775808, localDeletion=2147483647, ranges=[c-c:!, deletedAt=1484931972134334, localDeletion=1484931972][d-d:!, deletedAt=1484931972134334, localDeletion=1484931972]}
from:/127.0.0.1, payload:Mutation(keyspace=&apos;test&apos;, key=&apos;0000000e&apos;, modifications=[ColumnFamily(test -{deletedAt=-9223372036854775808, localDeletion=2147483647, ranges=[c-c:!, deletedAt=1484931972134334, localDeletion=1484931972][d-d:!, deletedAt=1484931972134334, localDeletion=1484931972]}- [:false:0@1484931972134335,b:false:4@1484931972134335,c:00000002:false:0@1484931972134335,c:00000003:false:0@1484931972134335,d:00000004:false:0@1484931972134335,d:00000005:false:0@1484931972134335,e:false:4@1484931972134335,])]), verb:MUTATION, version:8
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;h4&gt;&lt;a name=&quot;On131253.11&quot;&gt;&lt;/a&gt;On 13125-3.11&lt;/h4&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; insert into test.test(a,b,c,d,e) values(14,1,{2,3},{4,5},6);
cqlsh&amp;gt; select * from test.test;                               
 a  | b | c      | d      | e
----+---+--------+--------+---
 14 | 1 | {2, 3} | {4, 5} | 6

Mutation.deserialize() size==1
RangeTombstone(0), start:org.apache.cassandra.db.composites.CompoundSparseCellName@4316af5d, end:org.apache.cassandra.db.composites.BoundedComposite@256e93b0, markedAt:1484933162431359, delTime:1484933162
RangeTombstone(1), start:org.apache.cassandra.db.composites.CompoundSparseCellName@4316af5e, end:org.apache.cassandra.db.composites.BoundedComposite@256e93b1, markedAt:1484933162431359, delTime:1484933162
DeletionInfo:{deletedAt=-9223372036854775808, localDeletion=2147483647, ranges=[c-c:!, deletedAt=1484933162431359, localDeletion=1484933162][d-d:!, deletedAt=1484933162431359, localDeletion=1484933162]}
from:/127.0.0.1, payload:Mutation(keyspace=&apos;test&apos;, key=&apos;0000000e&apos;, modifications=[ColumnFamily(test -{deletedAt=-9223372036854775808, localDeletion=2147483647, ranges=[c-c:!, deletedAt=1484933162431359, localDeletion=1484933162][d-d:!, deletedAt=1484933162431359, localDeletion=1484933162]}- [:false:0@1484933162431360,b:false:4@1484933162431360,c:00000002:false:0@1484933162431360,c:00000003:false:0@1484933162431360,d:00000004:false:0@1484933162431360,d:00000005:false:0@1484933162431360,e:false:4@1484933162431360,])]), verb:MUTATION, version:8
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="15832384" author="thobbs" created="Fri, 20 Jan 2017 20:51:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt; the patch and new test look good to me.  For some reason related to sigar your new unit test is erroring on Jenkins in the 3.11 version &amp;#8211; maybe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mshuler&quot; class=&quot;user-hover&quot; rel=&quot;mshuler&quot;&gt;mshuler&lt;/a&gt; knows what&apos;s up with that?&lt;/p&gt;</comment>
                            <comment id="15832400" author="mshuler" created="Fri, 20 Jan 2017 21:12:17 +0000"  >&lt;p&gt;Would this have something to do with it?&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;(cassandra-3.11)mshuler@hana:~/git/cassandra$ grep -r sigar-bin conf/
conf/cassandra-env.ps1:    $env:JVM_OPTS = &quot;$env:JVM_OPTS -Djava.library.path=&quot;&quot;$env:CASSANDRA_HOME\lib\sigar-bin&quot;&quot;&quot;
conf/cassandra-env.sh:JVM_OPTS=&quot;$JVM_OPTS -Djava.library.path=$CASSANDRA_HOME/lib/sigar-bin&quot;

(cassandra-3.11)mshuler@hana:~/git/cassandra$ grep -r sigar-bin test/conf/
(cassandra-3.11)mshuler@hana:~/git/cassandra$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15834197" author="slebresne" created="Mon, 23 Jan 2017 10:06:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;For some reason related to sigar your new unit test is erroring on Jenkins in the 3.11 version&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The sigar stack is unrelated noise: it&apos;s not being properly set by Jenkins, but that shouldn&apos;t impact any test, and while it could be nice to fix it, let&apos;s please leave that to some other venue.&lt;/p&gt;

&lt;p&gt;The failure seems to be due to the fact that the test don&apos;t initialize &lt;tt&gt;DatabaseDescriptor&lt;/tt&gt; and so &lt;tt&gt;CFMetaData.Builder.build()&lt;/tt&gt; complains about not knowing the partitioner. Pushed a trivial fix that forces a partitioner (we could also force daemon initialization I suppose but no point is making the test more heavy than it has to be). Restarted the unit test on 3.11 to check it fixes it.&lt;/p&gt;</comment>
                            <comment id="15836334" author="thobbs" created="Tue, 24 Jan 2017 17:22:57 +0000"  >&lt;p&gt;The test fix and latest test run look good, so +1 on committing.&lt;/p&gt;</comment>
                            <comment id="15857820" author="slebresne" created="Wed, 8 Feb 2017 10:43:19 +0000"  >&lt;p&gt;Committed, thanks.&lt;/p&gt;</comment>
                            <comment id="15857829" author="yasuharu" created="Wed, 8 Feb 2017 10:53:15 +0000"  >&lt;p&gt;Thank you guys! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15858807" author="zzheng" created="Thu, 9 Feb 2017 01:03:51 +0000"  >&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="15876247" author="mnantern" created="Tue, 21 Feb 2017 16:28:26 +0000"  >&lt;p&gt;Thank you for the fix !&lt;/p&gt;

&lt;p&gt;Just a small question, how can I repair my table now ? I have rows with null because of that issue and I cannot delete them:&lt;/p&gt;

&lt;p&gt;(primary_id and secondary_id are my primary key)&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;select primary_id,secondary_id, access_rights, date_modification from access WHERE primary_id = 92a9a568-e585-45cd-a1f6-96376809098c;

 primary_id                           | secondary_id                         | access_rights   | date_modification
--------------------------------------+--------------------------------------+-----------------+--------------------------
 92a9a568-e585-45cd-a3f6-96376819098c | 078ae733-5be5-402e-b9b2-5f989550787e | [&apos;b&apos;, &apos;u&apos;, &apos;r&apos;] | 2017-02-20 12:35:02+0000
 92a9a568-e585-45cd-a3f6-96376819098c | 078ae733-5be5-402e-b9b2-5f989550787e |            null | 2017-02-20 12:35:02+0000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15877379" author="yasuharu" created="Wed, 22 Feb 2017 03:16:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mnantern&quot; class=&quot;user-hover&quot; rel=&quot;mnantern&quot;&gt;mnantern&lt;/a&gt; In our case, &lt;tt&gt;nodetool scrub&lt;/tt&gt; (C* 3.0.9 or later) fixed our broken sstables.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12972450">CASSANDRA-11887</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12987121">CASSANDRA-12144</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12848197" name="diff-a.patch" size="507" author="Yasuharu" created="Thu, 19 Jan 2017 01:55:59 +0000"/>
                            <attachment id="12848198" name="diff-b.patch" size="1053" author="Yasuharu" created="Thu, 19 Jan 2017 01:56:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 38 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38rdz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12338291">3.0.10</customfieldvalue>
    <customfieldvalue id="12337344">3.9</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>thobbs</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>