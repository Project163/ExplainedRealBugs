<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:41:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-6289] Murmur3Partitioner doesn&apos;t yield proper ownership calculation</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-6289</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In a new 1.2 install with Murmur3 as default, I setup a test cluster with N=RF=3 for the cluster size and RF for a keyspace&lt;/p&gt;

&lt;p&gt;but when I look at the ring output (with the keyspace name), to my surprise it shows RF=2.&lt;/p&gt;

&lt;p&gt;Further investigate shows the &quot;total replica&quot; is an addition of the float value from the effectiveOwnership. But that results in &amp;lt; 1 for the setup:&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;#bean is set to org.apache.cassandra.db:type=StorageService&lt;br/&gt;
$&amp;gt;run effectiveOwnership Keyspace1&lt;br/&gt;
#calling operation effectiveOwnership of mbean org.apache.cassandra.db:type=StorageService&lt;br/&gt;
#operation returns: &lt;br/&gt;
{ &lt;br/&gt;
  /127.0.0.1 = 0.9999989;&lt;br/&gt;
  /127.0.0.2 = 0.9999989;&lt;br/&gt;
  /127.0.0.3 = 0.9999989;&lt;br/&gt;
 }&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;$ ./bin/nodetool -h 0 -p 7100 ring Keyspace1&lt;/p&gt;

&lt;p&gt;Datacenter: datacenter1&lt;br/&gt;
==========&lt;br/&gt;
Replicas: 2&lt;/p&gt;

&lt;p&gt;Address    Rack        Status State   Load            Owns                Token                                       &lt;br/&gt;
                                                                          3074457345618258602                         &lt;br/&gt;
127.0.0.1  rack1       Up     Normal  1.02 GB         100.00%             -9223372036854775808                        &lt;br/&gt;
127.0.0.2  rack1       Up     Normal  996.38 MB       100.00%             -3074457345618258603                        &lt;br/&gt;
127.0.0.3  rack1       Up     Normal  980.55 MB       100.00%             3074457345618258602 &lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;Keyspace: Keyspace1:&lt;br/&gt;
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy&lt;br/&gt;
  Durable Writes: true&lt;br/&gt;
    Options: &lt;span class=&quot;error&quot;&gt;&amp;#91;replication_factor:3&amp;#93;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The println would simply class the float value to int, so i guess that&apos;s round down.&lt;/p&gt;

&lt;p&gt;When using RandomPartitioner, the effectiveOwnership will return 1.0 &lt;/p&gt;

&lt;p&gt;So I guess the real question is, is the Murmur3 calculation correct? Or is it losing precision? If it is correct, then I guess we need to force the float -&amp;gt; int to round up? (is that even the right thing to do?)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12677192">CASSANDRA-6289</key>
            <summary>Murmur3Partitioner doesn&apos;t yield proper ownership calculation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="cywjackson">Jackson Chung</reporter>
                        <labels>
                    </labels>
                <created>Sat, 2 Nov 2013 01:47:52 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:01 +0000</updated>
                            <resolved>Thu, 21 Nov 2013 20:19:03 +0000</resolved>
                                        <fixVersion>2.0.4</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13819852" author="mishail" created="Tue, 12 Nov 2013 05:46:58 +0000"  >&lt;p&gt;Use &lt;tt&gt;Math.round&lt;/tt&gt; instead of truncating&lt;/p&gt;</comment>
                            <comment id="13820084" author="jeromatron" created="Tue, 12 Nov 2013 13:31:23 +0000"  >&lt;p&gt;Might this be a similar problem in RandomPartitioner?  Just wondering if &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6320&quot; title=&quot;During range movements, nodetool ring reports incorrect replicas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6320&quot;&gt;&lt;del&gt;CASSANDRA-6320&lt;/del&gt;&lt;/a&gt; might have a similar fix.&lt;/p&gt;</comment>
                            <comment id="13820126" author="jbellis" created="Tue, 12 Nov 2013 14:26:53 +0000"  >&lt;p&gt;6320 is about ownership changes which is not the case here.&lt;/p&gt;</comment>
                            <comment id="13820136" author="jbellis" created="Tue, 12 Nov 2013 14:45:32 +0000"  >&lt;p&gt;I think the real problem is that displaying replica count derived from sum(ownership) is fundamentally broken.  Consider using SimpleStrategy instead of NTS &amp;#8211; you&apos;ll just get nonsense.&lt;/p&gt;

&lt;p&gt;I think the right solution is to rip this out instead of trying to compensate for one inaccuracy by applying more on an ad hoc basis until it looks right in some cases.  But, I don&apos;t want to break anyone parsing nodetool output in 1.2.x.  Patch attached for 2.0.&lt;/p&gt;</comment>
                            <comment id="13829297" author="brandon.williams" created="Thu, 21 Nov 2013 20:15:01 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13829299" author="jbellis" created="Thu, 21 Nov 2013 20:19:03 +0000"  >&lt;p&gt;committed after IRC +1&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12613374" name="6289-v2.txt" size="1056" author="jbellis" created="Tue, 12 Nov 2013 14:45:32 +0000"/>
                            <attachment id="12613324" name="cassandra-1.2-6289.patch" size="886" author="mishail" created="Tue, 12 Nov 2013 05:46:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>356567</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1pgx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>356855</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>brandon.williams</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>