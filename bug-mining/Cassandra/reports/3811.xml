<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:57:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10237] CFS.loadNewSSTables() broken for pre-3.0 sstables</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10237</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;While working on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10236&quot; title=&quot;Generate legacy sstables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10236&quot;&gt;&lt;del&gt;CASSANDRA-10236&lt;/del&gt;&lt;/a&gt; I discovered that &lt;tt&gt;CFS.loadNewSSTables()&lt;/tt&gt; doesn&apos;t work for pre-3.0 sstables - just for version &lt;tt&gt;ma&lt;/tt&gt; sstables.&lt;/p&gt;

&lt;p&gt;TBC: Starting C* with 2.0, 2.1 or 2.2 sstables works - but loading new sstables during runtime doesn&apos;t.&lt;/p&gt;

&lt;p&gt;Issues with &lt;tt&gt;CFS.loadNewSSTables()&lt;/tt&gt; discovered so far:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;&lt;tt&gt;MetadataSerializer.deserialize(Descriptor,FileDataInput,EnumSet)&lt;/tt&gt; returns &lt;tt&gt;null&lt;/tt&gt; for &lt;tt&gt;MetadataType.HEADER&lt;/tt&gt; which results in a NPE later in &lt;tt&gt;MetadataSerializer.serialize&lt;/tt&gt; executing &lt;tt&gt;Collections.sort&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;After working around the previous issue, it turns out that it couldn&apos;t load the digest file, since &lt;tt&gt;Component.DIGEST&lt;/tt&gt; is a singleton which refers to CRC32, but pre-3.0 sstables use Adler32.&lt;/li&gt;
	&lt;li&gt;After working around that one, it fails in &lt;tt&gt;StreamingHistogram$StreamingHistogramSerializer.deserialize&lt;/tt&gt; as &lt;tt&gt;maxBinSize==Integer.MAX_VALUE&lt;/tt&gt;.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;As loading legacy sstables works fine during startup, I assume my workarounds are not correct.&lt;/p&gt;

&lt;p&gt;For reference, &lt;a href=&quot;https://github.com/snazy/cassandra/commit/2f0668a1e1d8a101e8301b9c4211b164c113afaa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this commit&lt;/a&gt; contains a ton of legacy sstables (simple, counter, clustered and clustered+counter) for 2.0, 2.1 and 2.2. I&apos;ve extended LegacySSTablesTest to read these tables using &lt;tt&gt;CFS.loadNewSSTables()&lt;/tt&gt;.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;LegacySSTablesTest.txt&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;diff --git a/test/unit/org/apache/cassandra/io/sstable/LegacySSTableTest.java b/test/unit/org/apache/cassandra/io/sstable/LegacySSTableTest.java
index d2922cc..1be6450 100644
--- a/test/unit/org/apache/cassandra/io/sstable/LegacySSTableTest.java
+++ b/test/unit/org/apache/cassandra/io/sstable/LegacySSTableTest.java
@@ -18,6 +18,9 @@
 package org.apache.cassandra.io.sstable;
 
 import java.io.File;
+import java.io.FileInputStream;
+import java.io.FileOutputStream;
+import java.io.IOException;
 import java.nio.ByteBuffer;
 import java.util.ArrayList;
 import java.util.HashSet;
@@ -27,10 +30,15 @@ import java.util.Set;
 import org.junit.BeforeClass;
 import org.junit.Test;
 
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+
 import org.apache.cassandra.SchemaLoader;
 import org.apache.cassandra.Util;
 import org.apache.cassandra.config.CFMetaData;
+import org.apache.cassandra.cql3.QueryProcessor;
 import org.apache.cassandra.db.ColumnFamilyStore;
+import org.apache.cassandra.db.ConsistencyLevel;
 import org.apache.cassandra.db.DeletionTime;
 import org.apache.cassandra.db.Keyspace;
 import org.apache.cassandra.db.rows.SliceableUnfilteredRowIterator;
@@ -43,6 +51,7 @@ import org.apache.cassandra.exceptions.ConfigurationException;
 import org.apache.cassandra.io.sstable.format.SSTableFormat;
 import org.apache.cassandra.io.sstable.format.SSTableReader;
 import org.apache.cassandra.io.sstable.format.Version;
+import org.apache.cassandra.io.sstable.format.big.BigFormat;
 import org.apache.cassandra.schema.KeyspaceParams;
 import org.apache.cassandra.service.StorageService;
 import org.apache.cassandra.streaming.StreamPlan;
@@ -57,6 +66,8 @@ import static org.apache.cassandra.utils.ByteBufferUtil.bytes;
  */
 public class LegacySSTableTest
 {
+    private static final Logger logger = LoggerFactory.getLogger(LegacySSTableTest.class);
+
     public static final String LEGACY_SSTABLE_PROP = &quot;legacy-sstable-root&quot;;
     public static final String KSNAME = &quot;Keyspace1&quot;;
     public static final String CFNAME = &quot;Standard1&quot;;
@@ -64,6 +75,8 @@ public class LegacySSTableTest
     public static Set&amp;lt;String&amp;gt; TEST_DATA;
     public static File LEGACY_SSTABLE_ROOT;
 
+    public static final String[] legacyVersions = {&quot;jb&quot;, &quot;ka&quot;, &quot;la&quot;};
+
     @BeforeClass
     public static void defineSchema() throws ConfigurationException
     {
@@ -208,4 +221,65 @@ public class LegacySSTableTest
             throw e;
         }
     }
+
+    @Test
+    public void testLegacyCqlTables() throws Exception
+    {
+        QueryProcessor.executeInternal(&quot;CREATE KEYSPACE legacy_tables WITH replication = {&apos;class&apos;: &apos;SimpleStrategy&apos;, &apos;replication_factor&apos;: &apos;1&apos;}&quot;);
+
+        loadLegacyTables();
+    }
+
+    private void loadLegacyTables() throws IOException
+    {
+        for (String legacyVersion : legacyVersions)
+        {
+            logger.info(&quot;Preparing legacy version {}&quot;, legacyVersion);
+
+            QueryProcessor.executeInternal(String.format(&quot;CREATE TABLE legacy_tables.legacy_%s_simple (pk text PRIMARY KEY, val text)&quot;, legacyVersion));
+            QueryProcessor.executeInternal(String.format(&quot;CREATE TABLE legacy_tables.legacy_%s_simple_counter (pk text PRIMARY KEY, val counter)&quot;, legacyVersion));
+            QueryProcessor.executeInternal(String.format(&quot;CREATE TABLE legacy_tables.legacy_%s_clust (pk text, ck text, val text, PRIMARY KEY (pk, ck))&quot;, legacyVersion));
+            QueryProcessor.executeInternal(String.format(&quot;CREATE TABLE legacy_tables.legacy_%s_clust_counter (pk text, ck text, val counter, PRIMARY KEY (pk, ck))&quot;, legacyVersion));
+
+            loadLegacyTable(&quot;legacy_%s_simple&quot;, legacyVersion);
+            loadLegacyTable(&quot;legacy_%s_simple_counter&quot;, legacyVersion);
+            loadLegacyTable(&quot;legacy_%s_clust&quot;, legacyVersion);
+            loadLegacyTable(&quot;legacy_%s_clust_counter&quot;, legacyVersion);
+
+        }
+    }
+
+    private void loadLegacyTable(String tablePattern, String legacyVersion) throws IOException
+    {
+        String table = String.format(tablePattern, legacyVersion);
+
+        logger.info(&quot;Loading legacy table {}&quot;, table);
+
+        ColumnFamilyStore cfs = Keyspace.open(&quot;legacy_tables&quot;).getColumnFamilyStore(table);
+
+        for (File cfDir : cfs.getDirectories().getCFDirectories())
+        {
+            copySstables(legacyVersion, table, cfDir);
+        }
+
+        cfs.loadNewSSTables();
+    }
+
+    private static void copySstables(String legacyVersion, String table, File cfDir) throws IOException
+    {
+        byte[] buf = new byte[65536];
+
+        for (File file : new File(LEGACY_SSTABLE_ROOT, String.format(&quot;%s/legacy_tables/%s&quot;, legacyVersion, table)).listFiles())
+        {
+            if (file.isFile())
+            {
+                File target = new File(cfDir, file.getName());
+                int rd;
+                FileInputStream is = new FileInputStream(file);
+                FileOutputStream os = new FileOutputStream(target);
+                while ((rd = is.read(buf)) &amp;gt;= 0)
+                    os.write(buf, 0, rd);
+            }
+        }
+    }
 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;broken-workaround&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;diff --git a/src/java/org/apache/cassandra/db/compaction/Verifier.java b/src/java/org/apache/cassandra/db/compaction/Verifier.java
index 554c782..e953b1d 100644
--- a/src/java/org/apache/cassandra/db/compaction/Verifier.java
+++ b/src/java/org/apache/cassandra/db/compaction/Verifier.java
@@ -96,7 +96,7 @@ public class Verifier implements Closeable
         {
             validator = null;
 
-            if (new File(sstable.descriptor.filenameFor(Component.DIGEST)).exists())
+            if (new File(sstable.descriptor.filenameFor(sstable.descriptor.digestComponent())).exists())
             {
                 validator = DataIntegrityMetadata.fileDigestValidator(sstable.descriptor);
                 validator.validate();
diff --git a/src/java/org/apache/cassandra/io/sstable/Component.java b/src/java/org/apache/cassandra/io/sstable/Component.java
index 54dd35b..d0405e4 100644
--- a/src/java/org/apache/cassandra/io/sstable/Component.java
+++ b/src/java/org/apache/cassandra/io/sstable/Component.java
@@ -34,6 +34,7 @@ public class Component
     public static final char separator = &apos;-&apos;;
 
     final static EnumSet&amp;lt;Type&amp;gt; TYPES = EnumSet.allOf(Type.class);
+
     public enum Type
     {
         // the base data for an sstable: the remaining components can be regenerated
@@ -79,13 +80,17 @@ public class Component
         }
     }
 
+    private static final String DIGEST_CRC32_NAME = &quot;Digest.crc32&quot;;
+    private static final String DIGEST_ADLER32_NAME = &quot;Digest.adler32&quot;;
+
     // singleton components for types that don&apos;t need ids
     public final static Component DATA = new Component(Type.DATA);
     public final static Component PRIMARY_INDEX = new Component(Type.PRIMARY_INDEX);
     public final static Component FILTER = new Component(Type.FILTER);
     public final static Component COMPRESSION_INFO = new Component(Type.COMPRESSION_INFO);
     public final static Component STATS = new Component(Type.STATS);
-    public final static Component DIGEST = new Component(Type.DIGEST);
+    public final static Component DIGEST_CRC32 = new Component(Type.DIGEST, DIGEST_CRC32_NAME);
+    public final static Component DIGEST_ADLER32 = new Component(Type.DIGEST, DIGEST_ADLER32_NAME);
     public final static Component CRC = new Component(Type.CRC);
     public final static Component SUMMARY = new Component(Type.SUMMARY);
     public final static Component TOC = new Component(Type.TOC);
@@ -138,11 +143,23 @@ public class Component
             case FILTER:            component = Component.FILTER;                       break;
             case COMPRESSION_INFO:  component = Component.COMPRESSION_INFO;             break;
             case STATS:             component = Component.STATS;                        break;
-            case DIGEST:            component = Component.DIGEST;                       break;
             case CRC:               component = Component.CRC;                          break;
             case SUMMARY:           component = Component.SUMMARY;                      break;
             case TOC:               component = Component.TOC;                          break;
             case CUSTOM:            component = new Component(Type.CUSTOM, path.right); break;
+            case DIGEST:
+                switch (path.right)
+                {
+                    case DIGEST_CRC32_NAME:
+                        component = Component.DIGEST_CRC32;
+                        break;
+                    case DIGEST_ADLER32_NAME:
+                        component = Component.DIGEST_ADLER32;
+                        break;
+                    default:
+                        throw new IllegalStateException();
+                }
+                break;
             default:
                  throw new IllegalStateException();
         }
diff --git a/src/java/org/apache/cassandra/io/sstable/Descriptor.java b/src/java/org/apache/cassandra/io/sstable/Descriptor.java
index 38829df..0db6f00 100644
--- a/src/java/org/apache/cassandra/io/sstable/Descriptor.java
+++ b/src/java/org/apache/cassandra/io/sstable/Descriptor.java
@@ -32,6 +32,7 @@ import org.apache.cassandra.io.sstable.metadata.IMetadataSerializer;
 import org.apache.cassandra.io.sstable.metadata.LegacyMetadataSerializer;
 import org.apache.cassandra.io.sstable.metadata.MetadataSerializer;
 import org.apache.cassandra.utils.Pair;
+import org.apache.hadoop.mapred.JobTracker;
 
 import static org.apache.cassandra.io.sstable.Component.separator;
 
@@ -344,4 +345,16 @@ public class Descriptor
     {
         return hashCode;
     }
+
+    public Component digestComponent()
+    {
+        switch (version.compressedChecksumType())
+        {
+            case Adler32:
+                return Component.DIGEST_ADLER32;
+            case CRC32:
+                return Component.DIGEST_CRC32;
+        }
+        throw new IllegalStateException();
+    }
 }
diff --git a/src/java/org/apache/cassandra/io/sstable/format/SSTableWriter.java b/src/java/org/apache/cassandra/io/sstable/format/SSTableWriter.java
index bd21536..74e4b56 100644
--- a/src/java/org/apache/cassandra/io/sstable/format/SSTableWriter.java
+++ b/src/java/org/apache/cassandra/io/sstable/format/SSTableWriter.java
@@ -131,7 +131,7 @@ public abstract class SSTableWriter extends SSTable implements Transactional
                 Component.STATS,
                 Component.SUMMARY,
                 Component.TOC,
-                Component.DIGEST));
+                Component.DIGEST_CRC32));
 
         if (metadata.params.bloomFilterFpChance &amp;lt; 1.0)
             components.add(Component.FILTER);
diff --git a/src/java/org/apache/cassandra/io/sstable/metadata/MetadataSerializer.java b/src/java/org/apache/cassandra/io/sstable/metadata/MetadataSerializer.java
index 9a5eae8..a40c37a 100644
--- a/src/java/org/apache/cassandra/io/sstable/metadata/MetadataSerializer.java
+++ b/src/java/org/apache/cassandra/io/sstable/metadata/MetadataSerializer.java
@@ -122,7 +122,12 @@ public class MetadataSerializer implements IMetadataSerializer
                 in.seek(offset);
                 component = type.serializer.deserialize(descriptor.version, in);
             }
-            components.put(type, component);
+            if (component == null)
+            {
+                assert type != MetadataType.HEADER || !descriptor.version.storeRows();
+            }
+            else
+                components.put(type, component);
         }
         return components;
     }
diff --git a/src/java/org/apache/cassandra/io/util/DataIntegrityMetadata.java b/src/java/org/apache/cassandra/io/util/DataIntegrityMetadata.java
index 70cd860..b88f4f2 100644
--- a/src/java/org/apache/cassandra/io/util/DataIntegrityMetadata.java
+++ b/src/java/org/apache/cassandra/io/util/DataIntegrityMetadata.java
@@ -109,7 +109,7 @@ public class DataIntegrityMetadata
         {
             this.descriptor = descriptor;
             checksum = descriptor.version.uncompressedChecksumType().newInstance();
-            digestReader = RandomAccessReader.open(new File(descriptor.filenameFor(Component.DIGEST)));
+            digestReader = RandomAccessReader.open(new File(descriptor.filenameFor(descriptor.digestComponent())));
             dataReader = RandomAccessReader.open(new File(descriptor.filenameFor(Component.DATA)));
             try
             {
@@ -211,7 +211,7 @@ public class DataIntegrityMetadata
 
         public void writeFullChecksum(Descriptor descriptor)
         {
-            File outFile = new File(descriptor.filenameFor(Component.DIGEST));
+            File outFile = new File(descriptor.filenameFor(descriptor.digestComponent()));
             try (BufferedWriter out =Files.newBufferedWriter(outFile.toPath(), Charsets.UTF_8))
             {
                 out.write(String.valueOf(fullChecksum.getValue()));
diff --git a/src/java/org/apache/cassandra/io/util/FileUtils.java b/src/java/org/apache/cassandra/io/util/FileUtils.java
index 920eee0..1420cae 100644
--- a/src/java/org/apache/cassandra/io/util/FileUtils.java
+++ b/src/java/org/apache/cassandra/io/util/FileUtils.java
@@ -173,7 +173,7 @@ public class FileUtils
 
     public static void renameWithConfirm(File from, File to)
     {
-        assert from.exists();
+        assert from.exists() : String.format(&quot;File to rename does not exist: %s&quot;, from.getPath());
         if (logger.isDebugEnabled())
             logger.debug((String.format(&quot;Renaming %s to %s&quot;, from.getPath(), to.getPath())));
         // this is not FSWE because usually when we see it it&apos;s because we didn&apos;t close the file before renaming it,
diff --git a/test/unit/org/apache/cassandra/db/VerifyTest.java b/test/unit/org/apache/cassandra/db/VerifyTest.java
index 13ce0c1..0233169 100644
--- a/test/unit/org/apache/cassandra/db/VerifyTest.java
+++ b/test/unit/org/apache/cassandra/db/VerifyTest.java
@@ -275,11 +275,11 @@ public class VerifyTest
         SSTableReader sstable = cfs.getLiveSSTables().iterator().next();
 
 
-        RandomAccessFile file = new RandomAccessFile(sstable.descriptor.filenameFor(Component.DIGEST), &quot;rw&quot;);
+        RandomAccessFile file = new RandomAccessFile(sstable.descriptor.filenameFor(sstable.descriptor.digestComponent()), &quot;rw&quot;);
         Long correctChecksum = Long.parseLong(file.readLine());
         file.close();
 
-        writeChecksum(++correctChecksum, sstable.descriptor.filenameFor(Component.DIGEST));
+        writeChecksum(++correctChecksum, sstable.descriptor.filenameFor(sstable.descriptor.digestComponent()));
 
         try (Verifier verifier = new Verifier(cfs, sstable, false))
         {
@@ -315,7 +315,7 @@ public class VerifyTest
         file.close();
 
         // Update the Digest to have the right Checksum
-        writeChecksum(simpleFullChecksum(sstable.getFilename()), sstable.descriptor.filenameFor(Component.DIGEST));
+        writeChecksum(simpleFullChecksum(sstable.getFilename()), sstable.descriptor.filenameFor(sstable.descriptor.digestComponent()));
 
         try (Verifier verifier = new Verifier(cfs, sstable, false))
         {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12861040">CASSANDRA-10237</key>
            <summary>CFS.loadNewSSTables() broken for pre-3.0 sstables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="snazy">Robert Stupp</assignee>
                                    <reporter username="snazy">Robert Stupp</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Sep 2015 15:15:53 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:57 +0000</updated>
                            <resolved>Fri, 11 Sep 2015 08:51:58 +0000</resolved>
                                        <fixVersion>3.0.0 rc1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14732071" author="snazy" created="Sat, 5 Sep 2015 18:56:57 +0000"  >&lt;p&gt;This also breaks sstable verify (both standalone and via JMX/nodetool) by that the digest file isn&apos;t verified since the file existence check in &lt;tt&gt;org.apache.cassandra.db.compaction.Verifier#verify&lt;/tt&gt; doesn&apos;t succeed. I.e. this results in no error, but the functionality is lost.&lt;/p&gt;</comment>
                            <comment id="14732106" author="snazy" created="Sat, 5 Sep 2015 21:37:20 +0000"  >&lt;p&gt;Proposed change includes a bunch of fixes:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;extends &lt;tt&gt;Component&lt;/tt&gt; class to support &lt;tt&gt;Digest.cc32&lt;/tt&gt;, &lt;tt&gt;Digest.adler32&lt;/tt&gt; and &lt;tt&gt;Digest.sha1&lt;/tt&gt; (got that extension by running included code to generate sstables in 2.0 as a unit test) - by that sstable verification is also fixed&lt;/li&gt;
	&lt;li&gt;fix re-write of stats metadata (as that&apos;s being done using the probably legacy version of the sstable)&lt;/li&gt;
	&lt;li&gt;unit test to verify loading of legacy (jb, ka, la, ma) sstables using &lt;tt&gt;CFS.loadNewSSTables()&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14737467" author="bdeggleston" created="Wed, 9 Sep 2015 19:47:57 +0000"  >&lt;p&gt;This seem like the best approach for supporting the additional requirements loadNewSSTables has. The only thing I&apos;m not sure about is in &lt;tt&gt;o.a.c.io.sstable.SSTable#discoverComponentsFor&lt;/tt&gt;, shouldn&apos;t we still check that the digest file exists there as well?&lt;/p&gt;

&lt;p&gt;I also have a few nits:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;could you add a comment to the new &lt;tt&gt;else if (pair.right.type == Component.Type.DIGEST)&lt;/tt&gt; block in &lt;tt&gt;o.a.c.db.Directories.SSTableLister#getFilter&lt;/tt&gt;? Exactly what is happening and why is not obvious without digging around.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;o.a.c.io.sstable.LegacySSTableTest#testGenerateSstables&lt;/tt&gt; looks like it supersedes the &lt;tt&gt;buildTestSSTable&lt;/tt&gt; method above. Can you add a comment explaining the purpose and usage of the new method, and remove the old one if it&apos;s obsolete?&lt;/li&gt;
	&lt;li&gt;remove &apos;adler32&apos; from the comment before the try block in &lt;tt&gt;o.a.c.db.compaction.Verifier#verify&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;also, while you&apos;re modifying &lt;tt&gt;o.a.c.db.Component.Type&lt;/tt&gt;, it would be a good opportunity to refactor the constructor to take variadic arguments, instead of explicitly passing in arrays&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="14738333" author="snazy" created="Thu, 10 Sep 2015 07:32:59 +0000"  >&lt;p&gt;You&apos;re right, &lt;tt&gt;o.a.c.io.sstable.SSTable#discoverComponentsFor&lt;/tt&gt; should only return existing components (so existing files). Changed that, too.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;buildTestSSTable&lt;/tt&gt; - huh - didn&apos;t notice that at all (as it is commented out). Removed it as it doesn&apos;t compile anymore.&lt;/p&gt;

&lt;p&gt;Also addressed the other comments and updated the 3.0 and trunk branches.&lt;/p&gt;</comment>
                            <comment id="14739928" author="bdeggleston" created="Fri, 11 Sep 2015 00:42:38 +0000"  >&lt;p&gt;Great, +1. Could you just add the comment to &lt;tt&gt;o.a.c.io.sstable.LegacySSTableTest#testGenerateSstables&lt;/tt&gt; before committing?&lt;/p&gt;</comment>
                            <comment id="14740425" author="snazy" created="Fri, 11 Sep 2015 08:51:58 +0000"  >&lt;p&gt;Thanks! Committed as 0600d7dc03bcf3ce1d881d608afeaa29066fd052 to 3.0.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[snazy]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 10 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jnnj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333095">3.0 beta 1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>bdeggleston</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bdeggleston]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>