<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:54:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-9400] smallint, tinyint, date + time types in UDFs</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-9400</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Cassandra 2.2 adds new types &lt;tt&gt;smallint&lt;/tt&gt;, &lt;tt&gt;tinyint, {{date&lt;/tt&gt; + &lt;tt&gt;time&lt;/tt&gt;.&lt;br/&gt;
However the bundled Java driver does not support them.&lt;/p&gt;

&lt;p&gt;There are two options:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Do not allow the new types &lt;tt&gt;smallint&lt;/tt&gt;, &lt;tt&gt;tinyint&lt;/tt&gt;, &lt;tt&gt;date&lt;/tt&gt; + &lt;tt&gt;time&lt;/tt&gt; for UDFs&lt;/li&gt;
	&lt;li&gt;Use a new Java Driver version that can handle these types.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Probably we should go with option 1 and update the driver in a 2.2.x release?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12830212">CASSANDRA-9400</key>
            <summary>smallint, tinyint, date + time types in UDFs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="snazy">Robert Stupp</assignee>
                                    <reporter username="snazy">Robert Stupp</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 May 2015 16:15:06 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:10 +0000</updated>
                            <resolved>Thu, 4 Jun 2015 15:09:53 +0000</resolved>
                                        <fixVersion>2.2.0 rc1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14545745" author="iamaleksey" created="Fri, 15 May 2015 16:25:33 +0000"  >&lt;p&gt;Also &lt;tt&gt;smallint&lt;/tt&gt; and &lt;tt&gt;tinyint&lt;/tt&gt;. Not crucial for 2.2beta1, but better be there in 2.2rc1.&lt;/p&gt;</comment>
                            <comment id="14547727" author="slebresne" created="Mon, 18 May 2015 08:39:53 +0000"  >&lt;p&gt;Given that it&apos;s probably simple enough to add in the java driver, I think we can try to get a version ready for the RC (even if that&apos;s not an officially released version, what we use for UDFs is pretty limited). We can always get back to disallowing those types before the RC otherwise, but I&apos;d like to try supporting them if we can.&lt;/p&gt;</comment>
                            <comment id="14558057" author="snazy" created="Mon, 25 May 2015 09:09:44 +0000"  >&lt;p&gt;Branch contains support for smallint + tinyint.&lt;/p&gt;</comment>
                            <comment id="14565310" author="snazy" created="Fri, 29 May 2015 20:01:23 +0000"  >&lt;p&gt;Updated the branch with a custom version of the java-driver that has support for smallint, tinying, date, time.&lt;/p&gt;</comment>
                            <comment id="14565318" author="snazy" created="Fri, 29 May 2015 20:08:22 +0000"  >&lt;p&gt;Patch contains Java code changes (pls use the branch, which contains the driver binary).&lt;/p&gt;

&lt;p&gt;Notes to cleanup later (in a separate ticket):&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;build.xml&lt;/tt&gt; has old java driver commented out for the mvn deps&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;maxProtocolVersion&lt;/tt&gt; is limited to &lt;tt&gt;3&lt;/tt&gt; because the driver&apos;s support for V4 is not yet finished&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14567513" author="beobal" created="Mon, 1 Jun 2015 16:24:46 +0000"  >&lt;p&gt;We should wait for &lt;a href=&quot;https://datastax-oss.atlassian.net/browse/JAVA-404&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JAVA-404&lt;/a&gt; to be committed before incorporating the custom jar, just in case of further changes on the driver side. In the meantime, I&apos;ve a few remarks on the patch:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;adding support for the new types in &lt;tt&gt;CqlRecordReader&lt;/tt&gt; should probably be broken out into a separate ticket. But if we&apos;re going to shoehorn it in here, can we look at improving the coverage of &lt;tt&gt;CqlRecordReaderTest&lt;/tt&gt; to check all the supported datatypes.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;can we now enable &lt;tt&gt;UFTest#testFunctionExecutionExceptionNet&lt;/tt&gt;? As with the previous comment, maybe we ought to make that a separate ticket but I&apos;d be ok with doing it here.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;the new &lt;tt&gt;UFTest#testTypesWithAndWithoutNulls&lt;/tt&gt; is pretty hard to follow. It would add a bit of boilerplate, but perhaps adding a simple struct and making &lt;tt&gt;typeDefs&lt;/tt&gt; an array of those would make the test more readable.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;the &lt;tt&gt;maxProtocolVersion&lt;/tt&gt; logic in CQLTester is already incorrect and this (temporary) hack to skip v4 while driver support is incomplete doesn&apos;t help much.&lt;br/&gt;
It&apos;s incorrect in 2.2/trunk because if &lt;tt&gt;Server.CURRENT_VERSION&lt;/tt&gt; &lt;b&gt;is&lt;/b&gt; supported by the driver, then the &lt;tt&gt;IllegalArgumentException&lt;/tt&gt; is never thrown, so we don&apos;t break out of the loop and &lt;tt&gt;version&lt;/tt&gt; will end up being incremented once too many times. How about this alternative:&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt;
    {
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; version = Server.CURRENT_VERSION;
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;(version &amp;gt;= Server.VERSION_1)
        {
            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
            {
                ProtocolVersion.fromInt(version);
                &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
            }
            &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IllegalArgumentException e)
            {
                version--;
            }
        }
        maxProtocolVersion = version;
        &lt;span class=&quot;code-comment&quot;&gt;//TODO java-driver as of C* 2.2rc1 has incomplete V4 implementation - so skip V4 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; now
&lt;/span&gt;        maxProtocolVersion = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.min(Server.VERSION_3, version);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We could either remove the last assignment when driver v4 support is complete, or just initialise &lt;tt&gt;version&lt;/tt&gt; to &lt;tt&gt;VERSION_3&lt;/tt&gt;. I slightly favour the way it&apos;s done above as it&apos;s more explicit.&lt;/p&gt;</comment>
                            <comment id="14571790" author="snazy" created="Wed, 3 Jun 2015 22:55:54 +0000"  >&lt;p&gt;All of the comments have been factored out to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9493&quot; title=&quot;Integrate snapshot 2.2rc Java Driver&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9493&quot;&gt;&lt;del&gt;CASSANDRA-9493&lt;/del&gt;&lt;/a&gt; as these are all specific to the driver itself.&lt;/p&gt;

&lt;p&gt;The current branch contains two commits: one with the changes from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9493&quot; title=&quot;Integrate snapshot 2.2rc Java Driver&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9493&quot;&gt;&lt;del&gt;CASSANDRA-9493&lt;/del&gt;&lt;/a&gt; and the changes for this ticket on-top.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/snazy/job/snazy-9400-udf-small-tiny-dtest/5/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/snazy/job/snazy-9400-udf-small-tiny-testall/5/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14572385" author="beobal" created="Thu, 4 Jun 2015 08:46:43 +0000"  >&lt;p&gt;Looks like there&apos;s a regression in &lt;tt&gt;UFTest#testScriptParamReturnTypes&lt;/tt&gt; due to the new &lt;tt&gt;DateWithoutTime&lt;/tt&gt; not supporting arithmetic operations .&lt;/p&gt;</comment>
                            <comment id="14572389" author="snazy" created="Thu, 4 Jun 2015 08:49:16 +0000"  >&lt;p&gt;Yes - just realized exactly that. Have the general fix - but now I&apos;m fighting against the differences in Nashorn and Rhino.&lt;/p&gt;

&lt;p&gt;EDIT: fixed&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/snazy/job/snazy-9400-udf-small-tiny-dtest/6/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/snazy/job/snazy-9400-udf-small-tiny-testall/6/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14572924" author="beobal" created="Thu, 4 Jun 2015 14:56:14 +0000"  >&lt;p&gt;ok, LGTM +1 (is there likely to be issues with the merge to 3.0, due to the Nashorn vs Rhino thing?)&lt;/p&gt;</comment>
                            <comment id="14572933" author="snazy" created="Thu, 4 Jun 2015 15:02:56 +0000"  >&lt;p&gt;Thanks.&lt;/p&gt;

&lt;p&gt;Don&apos;t think that there will be significant issues regarding our unit tests. But Nashorn and Rhino behave a bit differently - we had some trouble with unit tests passing on the one and failing on the other - things that happen with untyped languages. AFAIR it was related to what one engine interprets as an integer an the other as a float.&lt;/p&gt;</comment>
                            <comment id="14572938" author="beobal" created="Thu, 4 Jun 2015 15:04:54 +0000"  >&lt;p&gt;Is it worth pushing a trunk-based branch to your repo before merging then, so cassci can check it out?&lt;/p&gt;</comment>
                            <comment id="14572943" author="snazy" created="Thu, 4 Jun 2015 15:09:31 +0000"  >&lt;p&gt;No - it works. It may affect users switching from Java7 to Java8.&lt;/p&gt;</comment>
                            <comment id="14572944" author="snazy" created="Thu, 4 Jun 2015 15:09:53 +0000"  >&lt;p&gt;Committed as 30be921d44ed62f0c29a40dc841190519f84cffc&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12736236" name="9400.txt" size="28484" author="snazy" created="Fri, 29 May 2015 20:08:22 +0000"/>
                            <attachment id="12737393" name="9400v2.txt" size="24867" author="snazy" created="Wed, 3 Jun 2015 22:55:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[snazy]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 24 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2eshr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324945">2.2.0 beta 1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>samt</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311124" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Tester</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>philipthompson</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>