<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:39:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5769] Not all STATUS_CHANGE UP events reported via the native protocol</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5769</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Not all gossip UP events are pushed to native protocol users who have registered for them.  This seems to be a native protocol issue because nodes themselves get the UP event (as seen in their logs).  I can consistently reproduce this issue as follows:&lt;/p&gt;

&lt;p&gt;1) connect a client to a cluster node (&quot;node1&quot;) using the native protocol, register for TOPOLOGY_CHANGE and STATUS_CHANGE events.  (Probably you only need to register for STATUS_CHANGE to see this, however my client registers for both).&lt;br/&gt;
2) on another node (&quot;node2&quot;), send SIGSTOP to the Cassandra process.&lt;br/&gt;
3) after about 30 seconds the client gets pushed a STATUS_CHANGE DOWN event for the stopped node.&lt;br/&gt;
4) on node2, send SIGCONT to the the Cassandra process.&lt;br/&gt;
5) wait forever to get a STATUS_CHANGE UP event.  This is failure: no event is ever received.&lt;/p&gt;

&lt;p&gt;Observe that node1 does know that node2 is back up: in its system log I see for example&lt;br/&gt;
  INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;GossipStage:1&amp;#93;&lt;/span&gt; 2013-07-17 14:27:41,238 Gossiper.java (line 771) InetAddress /172.18.34.169 is now UP&lt;br/&gt;
shortly after sending SIGCONT to the stopped process.&lt;/p&gt;

&lt;p&gt;To eliminate the possibility that my client is at fault, I performed the following sanity check:&lt;/p&gt;

&lt;p&gt;2&apos;) on node2, stopped Cassandra nicely using: sudo service cassandra stop&lt;br/&gt;
4&apos;) on node2, restarted Cassandra using: sudo service cassandra start&lt;/p&gt;

&lt;p&gt;In this case the client soon after gets a STATUS_CHANGE DOWN event followed by a STATUS_CHANGE UP event for node2.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Uubuntu 12.04, x86, 64 bit&lt;/p&gt;</environment>
        <key id="12658251">CASSANDRA-5769</key>
            <summary>Not all STATUS_CHANGE UP events reported via the native protocol</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="baldrick">Duncan Sands</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Jul 2013 13:06:52 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:09 +0000</updated>
                            <resolved>Fri, 19 Jul 2013 06:54:08 +0000</resolved>
                                        <fixVersion>1.2.7</fixVersion>
                                    <component>Legacy/CQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13711377" author="jbellis" created="Wed, 17 Jul 2013 18:06:04 +0000"  >&lt;p&gt;Tyler, can you reproduce?&lt;/p&gt;</comment>
                            <comment id="13711439" author="thobbs" created="Wed, 17 Jul 2013 18:40:29 +0000"  >&lt;p&gt;Yes, I can reliably reproduce the issue (through the python driver) with those steps using ccm.&lt;/p&gt;</comment>
                            <comment id="13712270" author="slebresne" created="Thu, 18 Jul 2013 12:27:33 +0000"  >&lt;p&gt;We are currently calling the native protocol notification in SS.handleStateNormal(), but that&apos;s only called on major state changes, while in the this case there is no generation change.&lt;/p&gt;

&lt;p&gt;I wouldn&apos;t claim the gossiper code is always easy to follow but it seems that moving the notification code from SS.handleStateNormal() to SS.onAlive() ensures we&apos;ll always notify (without over-notifying) so attaching a patch to do that. I&apos;ve checked it does fix the notification in the case above.&lt;/p&gt;</comment>
                            <comment id="13712948" author="jasobrown" created="Thu, 18 Jul 2013 22:06:01 +0000"  >&lt;p&gt;patch lgtm, although I might debate your claim about the gossiper code - it&apos;s not that bad &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13713387" author="slebresne" created="Fri, 19 Jul 2013 06:54:08 +0000"  >&lt;p&gt;Committed, thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12592963" name="5769.txt" size="2391" author="slebresne" created="Thu, 18 Jul 2013 12:27:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>338445</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1mdiv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>338765</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jasobrown</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jasobrown]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>