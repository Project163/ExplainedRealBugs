<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:27:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-17919] Capital P gets confused in the parser for a Duration in places where IDENT are needed</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-17919</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;This was found while adding Accord Transaction syntax into CQL and fuzz testing to validate all possible cases&#8230; in doing this the following was found&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; query = &lt;span class=&quot;code-quote&quot;&gt;&quot;BEGIN TRANSACTION\n&quot;&lt;/span&gt; +
                           &lt;span class=&quot;code-quote&quot;&gt;&quot;  LET P = (SELECT v FROM &quot;&lt;/span&gt; + keyspace + &lt;span class=&quot;code-quote&quot;&gt;&quot;.tbl WHERE k=? AND c=?);\n&quot;&lt;/span&gt; +
                           &lt;span class=&quot;code-quote&quot;&gt;&quot;  LET row2 = (SELECT v FROM &quot;&lt;/span&gt; + keyspace + &lt;span class=&quot;code-quote&quot;&gt;&quot;.tbl WHERE k=? AND c=?);\n&quot;&lt;/span&gt; +
                           &lt;span class=&quot;code-quote&quot;&gt;&quot;  SELECT v FROM &quot;&lt;/span&gt; + keyspace + &lt;span class=&quot;code-quote&quot;&gt;&quot;.tbl WHERE k=? AND c=?;\n&quot;&lt;/span&gt; +
                           &lt;span class=&quot;code-quote&quot;&gt;&quot;  IF P IS NULL AND row2.v = ? THEN\n&quot;&lt;/span&gt; +
                           &lt;span class=&quot;code-quote&quot;&gt;&quot;    INSERT INTO &quot;&lt;/span&gt; + keyspace + &lt;span class=&quot;code-quote&quot;&gt;&quot;.tbl (k, c, v) VALUES (?, ?, ?);\n&quot;&lt;/span&gt; +
                           &lt;span class=&quot;code-quote&quot;&gt;&quot;  END IF\n&quot;&lt;/span&gt; +
                           &lt;span class=&quot;code-quote&quot;&gt;&quot;COMMIT TRANSACTION&quot;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fails with&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SyntaxException: line 2:6 mismatched input &lt;span class=&quot;code-quote&quot;&gt;&apos;P&apos;&lt;/span&gt; expecting IDENT (BEGIN TRANSACTION  LET [P]...)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The new LET syntax found this, but was able to reproduce in other cases&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cqlsh:ks&amp;gt; CREATE TABLE P (k INT PRIMARY KEY);
SyntaxException: line 1:13 no viable alternative at input &lt;span class=&quot;code-quote&quot;&gt;&apos;P&apos;&lt;/span&gt; (CREATE TABLE [P]...)
cqlsh:ks&amp;gt;
cqlsh:ks&amp;gt; CREATE TABLE p (k INT PRIMARY KEY);
cqlsh:ks&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13482979">CASSANDRA-17919</key>
            <summary>Capital P gets confused in the parser for a Duration in places where IDENT are needed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="maximc">Maxim Chanturiay</assignee>
                                    <reporter username="dcapwell">David Capwell</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Sep 2022 18:05:11 +0000</created>
                <updated>Tue, 12 Sep 2023 13:02:33 +0000</updated>
                            <resolved>Thu, 27 Apr 2023 08:17:39 +0000</resolved>
                                        <fixVersion>3.11.15</fixVersion>
                    <fixVersion>4.0.10</fixVersion>
                    <fixVersion>4.1.2</fixVersion>
                    <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>CQL/Syntax</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="6000">1h 40m</timespent>
                                <comments>
                            <comment id="17608869" author="dcapwell" created="Fri, 23 Sep 2022 18:06:53 +0000"  >&lt;p&gt;In further inspection &quot;PT&quot; is also unsafe as it hits the same bug.&lt;/p&gt;

&lt;p&gt;Caleb also tested the following and we found that &quot;P&quot; is a valid duration&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
assertEquals(Duration.newInstance(0, 0, 0), Duration.from(&lt;span class=&quot;code-quote&quot;&gt;&quot;P&quot;&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17609477" author="blerer" created="Mon, 26 Sep 2022 12:38:26 +0000"  >&lt;p&gt;According to &lt;a href=&quot;https://en.wikipedia.org/wiki/ISO_8601#Durations&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Wikipedia&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Date and time elements including their designator may be omitted if their value is zero, and lower-order elements may also be omitted for reduced precision. For example, &quot;P23DT23H&quot; and &quot;P4Y&quot; are both acceptable duration representations. However, at least one element must be present, thus &quot;P&quot; is not a valid representation for a duration of 0 seconds. &quot;PT0S&quot; or &quot;P0D&quot;, however, are both valid and represent the same duration.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Effectively the lexer rule and the parsing logic from &lt;tt&gt;Duration.from&lt;/tt&gt; should be rewritten.&lt;/p&gt;</comment>
                            <comment id="17624988" author="JIRAUSER296801" created="Thu, 27 Oct 2022 09:40:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;&#160;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt; Hello! I&apos;d like to work on the issue.&lt;br/&gt;
I will assign myself - so please remove me if it is already taken. I&apos;ll watch the ticket updates&apos; mail.&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;What has been done so far?&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve checked out a branch from Cassandra 4.1, created a couple of unit tests that fail because of &quot;DROP TABLE P&quot; and &quot;CREATE TABLE P&quot; with the same error as in the bug report.&#160;In short - there is a functioning local dev environment to test out code changes.&lt;/p&gt;

&lt;p&gt;I&apos;d like to go with&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;&apos;s solution.&lt;/p&gt;

&lt;p&gt;I&apos;ve tried other options, like placing token IDENT above DURATION or trying to identify P as duration only when it&apos;s enclosed by parentheses ().&lt;br/&gt;
None of them worked either because of the ambiguity where both IDENT and DURATION contain a letter and optional digit or too complicated code wise.&lt;br/&gt;
And given the thousands of code lines in parser logic - more complication is the last thing that is needed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17625101" author="blerer" created="Thu, 27 Oct 2022 13:03:21 +0000"  >&lt;p&gt;@&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maximc&quot; class=&quot;user-hover&quot; rel=&quot;maximc&quot;&gt;maximc&lt;/a&gt;  Thanks for working on this problem. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;br/&gt;
The Duration type was introduced in 3.10 and the bug was there from the start. You should probably start with the 3.11 branch. The merge should be relatively simple. &lt;/p&gt;</comment>
                            <comment id="17629500" author="JIRAUSER296801" created="Sun, 6 Nov 2022 15:52:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;&#160;hello!&lt;/p&gt;

&lt;p&gt;I&apos;ve submitted the patch with the pull requests for the relevant versions.&lt;/p&gt;</comment>
                            <comment id="17711452" author="smiklosovic" created="Wed, 12 Apr 2023 15:38:25 +0000"  >&lt;p&gt;Any progress here? I think I will do a review if nothing has changed since then.&lt;/p&gt;</comment>
                            <comment id="17711885" author="JIRAUSER296801" created="Thu, 13 Apr 2023 13:32:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; , it would be great if you can do a review! There was no change since patches submission.&lt;/p&gt;</comment>
                            <comment id="17713062" author="smiklosovic" created="Mon, 17 Apr 2023 12:25:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maximc&quot; class=&quot;user-hover&quot; rel=&quot;maximc&quot;&gt;maximc&lt;/a&gt; could you please prepare patch for trunk as well? &lt;/p&gt;

&lt;p&gt;It would be great if all of them are rebased on top of the current branches as it was quite a while this was implemented. &lt;/p&gt;

&lt;p&gt;Could  you also please put a comment for these tests that it is testing &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17919&quot; title=&quot;Capital P gets confused in the parser for a Duration in places where IDENT are needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17919&quot;&gt;&lt;del&gt;CASSANDRA-17919&lt;/del&gt;&lt;/a&gt;? People might be quite confused while looking on test which tests the creation of a table called &quot;P&quot;.&lt;/p&gt;</comment>
                            <comment id="17713400" author="JIRAUSER296801" created="Tue, 18 Apr 2023 05:59:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt;, sure. I&apos;ll update once done.&lt;/p&gt;</comment>
                            <comment id="17713926" author="JIRAUSER296801" created="Wed, 19 Apr 2023 06:44:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt;,&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I&apos;ve added the comment to hint the test cases&apos; purpose.&lt;/li&gt;
	&lt;li&gt;Pull request to trunk was created. I&apos;ve attached link to it under &quot;Pull requests&quot; under the section &quot;Test and Documentation Plan&quot; (along with the existing pull requests).&lt;/li&gt;
	&lt;li&gt;All the branches have been rebased to contain the latest commits of the target branches.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17714119" author="smiklosovic" created="Wed, 19 Apr 2023 14:10:36 +0000"  >&lt;p&gt;Thanks.&lt;/p&gt;

&lt;p&gt;It looks just fine. I noticed there there is also this in the wiki&lt;/p&gt;

&lt;p&gt;&lt;em&gt;The smallest value used may also have a decimal fraction,&lt;span class=&quot;error&quot;&gt;&amp;#91;38&amp;#93;&lt;/span&gt; as in &quot;P0.5Y&quot; to indicate half a year. This decimal fraction may be specified with either a comma or a full stop, as in &quot;P0,5Y&quot; or &quot;P0.5Y&quot;.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;We do not implement this. This ticket is not to blame, I am just writing what I see. I looked into the code and it would be quite challenging to support this format. The values are based on an integer only. &lt;/p&gt;

&lt;p&gt;I am +1, I need to find another committer and we may build it all afterwards as it spans 4 branches.&lt;/p&gt;

&lt;p&gt;The sneak peek of the builds is here, for trunk j8 pre-commit, I will build the rest afterwards to save the resources and time: &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2105/workflows/c50c15aa-8e27-4fd6-b4cc-5a216ed115d6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2105/workflows/c50c15aa-8e27-4fd6-b4cc-5a216ed115d6&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=e.dimitrova&quot; class=&quot;user-hover&quot; rel=&quot;e.dimitrova&quot;&gt;e.dimitrova&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="17716607" author="blerer" created="Wed, 26 Apr 2023 08:51:14 +0000"  >&lt;p&gt;The patches look good to me. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=maximc&quot; class=&quot;user-hover&quot; rel=&quot;maximc&quot;&gt;maximc&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17716923" author="smiklosovic" created="Wed, 26 Apr 2023 21:23:13 +0000"  >&lt;p&gt;3.11 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2144/workflows/c55dd33e-341b-4cfc-b1c1-1348de9da4cf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2144/workflows/c55dd33e-341b-4cfc-b1c1-1348de9da4cf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;all failed tests in Butler:&lt;/p&gt;

&lt;p&gt;test_dead_sync_initiator&lt;br/&gt;
testReprepareMixedVersionWithoutReset&lt;/p&gt;

&lt;p&gt;4.0 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2143/workflows/edd00ec9-2230-4faf-ac40-b10ef360b596&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2143/workflows/edd00ec9-2230-4faf-ac40-b10ef360b596&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;all failed tests in Butler:&lt;/p&gt;

&lt;p&gt;testExpireSome&lt;br/&gt;
testFailingMessage&lt;/p&gt;

&lt;p&gt;4.1 &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2142/workflows/96a0e62d-64a6-49e2-ae4e-1d3da38be742&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2142/workflows/96a0e62d-64a6-49e2-ae4e-1d3da38be742&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;tests in Butler:&lt;/p&gt;

&lt;p&gt;paxosRepairHistoryIsntUpdatedInForcedRepair&lt;br/&gt;
testServiceTopPartitionsSingleTable&lt;/p&gt;

&lt;p&gt;ShortPaxosSimulationTest - this is not in Butler but it does not seem to be related at all&lt;/p&gt;

&lt;p&gt;trunk &lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2105/workflows/c50c15aa-8e27-4fd6-b4cc-5a216ed115d6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/instaclustr/cassandra/2105/workflows/c50c15aa-8e27-4fd6-b4cc-5a216ed115d6&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;in Butler:&lt;/p&gt;

&lt;p&gt;testMessageDeliveryOnReconnect&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt; do you want to take additional look and +1 that? I see just usual flakes. I am +1 myself.&lt;/p&gt;</comment>
                            <comment id="17717043" author="blerer" created="Thu, 27 Apr 2023 07:53:36 +0000"  >&lt;p&gt;+1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[maximc]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="13162" cascade-level="1"><![CDATA[API / Semantic Definition]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12972"><![CDATA[Fuzz Test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 28 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z18sy8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
        <customfieldvalue><![CDATA[smiklosovic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12337348">3.10</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/0f3a990dd2bc9532752a711a49a131c63d52e3c7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/0f3a990dd2bc9532752a711a49a131c63d52e3c7&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;b&gt;Pull requests&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;cassandra-3.11 - &lt;a href=&quot;https://github.com/apache/cassandra/pull/1977&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1977&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;cassandra-4.0 - &lt;a href=&quot;https://github.com/apache/cassandra/pull/1975&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1975&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;cassandra-4.1 - &lt;a href=&quot;https://github.com/apache/cassandra/pull/1976&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1976&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;trunk - &lt;a href=&quot;https://github.com/apache/cassandra/pull/2283&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2283&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;Source code changes&lt;/b&gt;&lt;br/&gt;
There was a change in the Lexer.g.&lt;br/&gt;
Capital letter &quot;P&quot; is no longer a valid representation for 0 duration. It has to comply with &lt;a href=&quot;https://en.wikipedia.org/wiki/ISO_8601#Durations&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://en.wikipedia.org/wiki/ISO_8601#Durations&lt;/a&gt; (see Benjamin Lerer&apos;s comment).&lt;br/&gt;
A couple of examples for valid 0 duration representation are:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PT0S
P0D
PT0H
P0W
P0Y0M0DT0H0M0S
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;b&gt;Unit tests changes&lt;/b&gt;&lt;br/&gt;
The following tests have been expanded with new logic to cover the ticket&apos;s changes:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;org.apache.cassandra.cql3.validation.operations.CreateTest&lt;/li&gt;
	&lt;li&gt;org.apache.cassandra.cql3.validation.operations.DropTest&lt;/li&gt;
	&lt;li&gt;org.apache.cassandra.cql3.validation.operations.InsertTest&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;Manual test case flow&lt;/b&gt;&lt;br/&gt;
Let&apos;s go through the case where we create a &quot;P&quot; keyspace, use it, create a &quot;P&quot; table and insert 0 duration twice with the correct format (the updated), select all rows, try to insert 0 duration with incorrect format, get the error and lastly drop the &quot;P&quot; keyspace.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cqlsh&amp;gt; CREATE KEYSPACE IF NOT EXISTS P WITH replication = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;replication_factor&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt;};

cqlsh&amp;gt; USE P;

cqlsh:p&amp;gt; CREATE TABLE P (a INT PRIMARY KEY, b DURATION);

cqlsh:p&amp;gt; INSERT INTO P (a, b) VALUES (1, PT0S);
cqlsh:p&amp;gt; INSERT INTO P (a, b) VALUES (2, P0D);

cqlsh:p&amp;gt; SELECT * FROM P;

 a | b
---+---
 1 |  
 2 |  

(2 rows)

cqlsh:p&amp;gt; INSERT INTO P (a, b) VALUES (3, P);
SyntaxException: line 1:33 no viable alternative at input &lt;span class=&quot;code-quote&quot;&gt;&apos;)&apos;&lt;/span&gt; (... b) VALUES (3, [P])...)

cqlsh:p&amp;gt; DROP KEYSPACE P;

cqlsh:p&amp;gt; describe keyspaces;

system &#160; &#160; &#160; system_distributed&#160; system_traces&#160; system_virtual_schema
system_auth&#160; system_schema &#160; &#160; &#160; system_views &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311124" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Tester</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>smiklosovic</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>