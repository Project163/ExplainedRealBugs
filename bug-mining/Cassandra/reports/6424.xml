<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:29:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-19126] Streaming appears to be incompatible with different storage_compatibility_mode settings</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-19126</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In particular, SSTableLoader appears to be incompatible with storage_compatibility_mode: NONE, which manifests as a failure of &lt;tt&gt;org.apache.cassandra.distributed.test.SSTableLoaderEncryptionOptionsTest&lt;/tt&gt; when the flag is turned on (found during &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18753&quot; title=&quot;Add an optimized default configuration to tests and make it available for new users&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18753&quot;&gt;&lt;del&gt;CASSANDRA-18753&lt;/del&gt;&lt;/a&gt; testing). Setting &lt;tt&gt;storage_compatibility_mode: NONE&lt;/tt&gt; in the tool configuration yaml does not help (according to the docs, this setting is not picked up).&lt;/p&gt;

&lt;p&gt;This is likely a bigger problem as the acceptable streaming version for C* 5 is 12 only in legacy mode and 13 only in none, i.e. two C* 5 nodes do not appear to be able to stream with each other if their setting for the compatibility mode is different.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13560082">CASSANDRA-19126</key>
            <summary>Streaming appears to be incompatible with different storage_compatibility_mode settings</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jlewandowski">Jacek Lewandowski</assignee>
                                    <reporter username="blambov">Branimir Lambov</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Nov 2023 14:25:50 +0000</created>
                <updated>Thu, 18 Jul 2024 21:11:53 +0000</updated>
                            <resolved>Tue, 23 Jan 2024 15:49:21 +0000</resolved>
                                        <fixVersion>5.0-rc1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                    <fixVersion>5.1</fixVersion>
                                    <component>Consistency/Streaming</component>
                    <component>Legacy/Streaming and Messaging</component>
                    <component>Messaging/Internode</component>
                    <component>Tool/bulk load</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17791665" author="brandon.williams" created="Thu, 30 Nov 2023 14:52:05 +0000"  >&lt;p&gt;We probably also need storage_compatibility_mode testing somewhere in our testing matrix.&lt;/p&gt;</comment>
                            <comment id="17791914" author="bereng" created="Fri, 1 Dec 2023 06:21:13 +0000"  >&lt;p&gt;Wouldn&apos;t nodes in v5.0 stream correctly as they would communicate with the correct maximum supported messaging version between the 2? Like in any other mixed versions upgrade scenario...&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;We probably also need storage_compatibility_mode testing somewhere in our testing matrix&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Branimir is already going to be enabling that setting in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18753&quot; title=&quot;Add an optimized default configuration to tests and make it available for new users&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18753&quot;&gt;&lt;del&gt;CASSANDRA-18753&lt;/del&gt;&lt;/a&gt; in CI if that is what you&apos;re referring to?&lt;/p&gt;</comment>
                            <comment id="17791958" author="blambov" created="Fri, 1 Dec 2023 08:57:13 +0000"  >&lt;p&gt;I believe what Brandon means is that we also need upgrade tests where only some nodes have changed &lt;tt&gt;storage_compatibility_mode&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/net/MessagingService.java#L259&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;This line&lt;/a&gt; is what appears to be preventing &lt;tt&gt;BulkLoader&lt;/tt&gt; from working. I don&apos;t have enough knowledge in the area and have not dug deep enough to understand all implications.&lt;/p&gt;</comment>
                            <comment id="17791964" author="bereng" created="Fri, 1 Dec 2023 09:19:17 +0000"  >&lt;p&gt;We have at least &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-5.0/test/distributed/org/apache/cassandra/distributed/upgrade/MixedModeTTLOverflowUpgradeTest.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;one&lt;/a&gt; of those upgrade tests we can use as a starting point.&lt;/p&gt;</comment>
                            <comment id="17792095" author="blambov" created="Fri, 1 Dec 2023 15:05:35 +0000"  >&lt;p&gt;Python dtest &lt;tt&gt;snaphost_test&lt;/tt&gt; is also failing because of this sstableloader problem:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception: sstableloader command &lt;span class=&quot;code-quote&quot;&gt;&apos;/home/cassandra/cassandra/bin/sstableloader -d 127.0.0.1 /tmp/tmpidg_8u3c/0/ks/cf&apos;&lt;/span&gt; failed; exit status: 1&apos;; stdout: Established connection to initial hosts
Opening sstables and calculating sections to stream
Streaming relevant part of /tmp/tmpidg_8u3c/0/ks/cf/da-1-bti-Data.db to [/127.0.0.1:7000]

progress: total: 100% 0.000B/s (avg: 0.000B/s)
; stderr: ERROR 10:16:01,391 [Stream #4bb85ff0-8ea0-11ee-94d3-3de6344de31d] Streaming error occurred on session with peer 127.0.0.1:7000
java.lang.ClassCastException: &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.cassandra.net.OutboundConnectionInitiator$Result$Incompatible cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.cassandra.net.OutboundConnectionInitiator$Result$Success (org.apache.cassandra.net.OutboundConnectionInitiator$Result$Incompatible and org.apache.cassandra.net.OutboundConnectionInitiator$Result$Success are in unnamed module of loader &lt;span class=&quot;code-quote&quot;&gt;&apos;app&apos;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17792833" author="jlewandowski" created="Mon, 4 Dec 2023 13:05:46 +0000"  >&lt;p&gt;isn&apos;t this related?: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-19012&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-19012&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17794298" author="jlewandowski" created="Thu, 7 Dec 2023 15:27:13 +0000"  >&lt;p&gt;Reading the exception, it looks like there is also a minor problem of incorrectly handling (actually lack of handling) non-success result in &lt;tt&gt;NettyStreamingConnectionFactory&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17794551" author="jlewandowski" created="Fri, 8 Dec 2023 07:10:21 +0000"  >&lt;p&gt;I doubt this is the best time to investigate that but I&apos;m wondering why acquiring a connection for messaging and for streaming is implemented differently? What I&apos;ve commented above is just a single manifestation of this problem&lt;/p&gt;</comment>
                            <comment id="17794578" author="jlewandowski" created="Fri, 8 Dec 2023 08:12:11 +0000"  >&lt;p&gt;Ok, I think I know what is going on. There is a mix of configurations - &lt;tt&gt;SSTableLoaderEncryptionOptionsTest&lt;/tt&gt; is a JVM dtest. Those tests do not load &lt;tt&gt;cassandra.yaml&lt;/tt&gt; - you pass all the configuration options explicitly. If you run it with &lt;tt&gt;storage_compatiblity_mode: NONE&lt;/tt&gt; in &lt;tt&gt;cassandra.yaml&lt;/tt&gt; but not in the cluster configuration, the cluster will use the default compatibility mode &quot;4&quot;, while the bulk loader loads the yaml configuration and use the compatibility mode: none.&lt;/p&gt;

&lt;p&gt;Precise fix for this would be to use the same compatibility mode for bulk loader and the node. To make sure the tool uses the same configuration as the node, we should probably output that config into a yaml which can be then loaded by the tool.&lt;/p&gt;</comment>
                            <comment id="17794614" author="jlewandowski" created="Fri, 8 Dec 2023 09:43:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/2975&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/2975&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;Now I&apos;m going to look into the dtest&lt;/p&gt;</comment>
                            <comment id="17794683" author="jlewandowski" created="Fri, 8 Dec 2023 12:46:36 +0000"  >&lt;p&gt;I cannot reproduce the python dtest failure by setting storage_compativility_mode to NONE in the main cassandra.yaml&lt;/p&gt;</comment>
                            <comment id="17795089" author="blambov" created="Sun, 10 Dec 2023 16:57:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;Precise fix for this would be to use the same compatibility mode for bulk loader and the node.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;While this would fix the test, it would not do anything about the underlying problem. C* 5 nodes in different compatibility mode should be able to stream with each other. One should at least be able to stream whole sstables from legacy mode to current.&lt;/p&gt;

&lt;p&gt;Current to legacy mode when &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-19012&quot; title=&quot;It should be possible to read all supported versions of sstables regardless of the compatibility mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-19012&quot;&gt;CASSANDRA-19012&lt;/a&gt; is done also makes sense, but it might violate the downgradability promise while such data is not compacted. We probably need a warning if current-format data is streamed to a node in legacy mode (e.g. suggesting one does upgradesstables before downgrading below 5.0).&lt;/p&gt;</comment>
                            <comment id="17795225" author="jlewandowski" created="Mon, 11 Dec 2023 08:02:14 +0000"  >&lt;p&gt;My understanding of the upgrade process is as follows:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Start the cluster with the SCM = 4, all the nodes produce and accept only 4.0 sstable&lt;/li&gt;
	&lt;li&gt;When the user decides to upgrade, do the rolling restart of the nodes with SCM = UPGRADE, from this moment, all the nodes should still produce old sstables, but they should start accepting new sstables for streaming&lt;/li&gt;
	&lt;li&gt;Start the rolling restart with SCM = NONE, from this moment, some nodes starts to produce new sstables and try to stream them to other nodes, those other nodes should accept them.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;TBH, I don&apos;t understand the need to have two modes: 4 and UPGRADE. If both produce only old sstables, none of the node would produce a new sstable which will retain the ability to downgrade. &lt;/p&gt;

&lt;p&gt;Though, this should be addressed in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-19012&quot; title=&quot;It should be possible to read all supported versions of sstables regardless of the compatibility mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-19012&quot;&gt;CASSANDRA-19012&lt;/a&gt;. In this ticket the issue was the fact that the tool used wrong configuration.&lt;/p&gt;</comment>
                            <comment id="17795254" author="bereng" created="Mon, 11 Dec 2023 09:11:39 +0000"  >&lt;p&gt;I am a bit lost here. Let&apos;s go bit by bit:&lt;/p&gt;

&lt;p&gt;I agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jlewandowski&quot; class=&quot;user-hover&quot; rel=&quot;jlewandowski&quot;&gt;jlewandowski&lt;/a&gt; that we have a mess of CI yamls flying around and mismatched configs produce errors. This seems to be the case for &lt;tt&gt;SSTableLoaderEncryptionOptionsTest&lt;/tt&gt; iiuc.&lt;/p&gt;

&lt;p&gt;The upgrade process for SCM is described &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/conf/cassandra.yaml#L2129&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&lt;br/&gt;
1. You start with SCM=4. No new features or formats enabled. If you&apos;re happy with the binaries continue, else rollback.&lt;br/&gt;
2. Rolling upgrade to SCM= UPGRADING. While the cluster is in &lt;em&gt;mixed&lt;/em&gt; SCM new features or formats should be enabled in a &lt;em&gt;safe &amp;amp; compatible&lt;/em&gt; way. Once the &lt;em&gt;last&lt;/em&gt; node switches to UPGRADING do new features and formats fully kick in.&lt;br/&gt;
3. Rolling upgrade to NONE.&lt;/p&gt;

&lt;p&gt;While nodes are in UPGRADING there is the extra cost of checking the SCM of the other nodes so we know if can start using the new features/formats or not, i.e &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-5.0/src/java/org/apache/cassandra/db/rows/Cell.java#L91&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; for TTL. We switch to NONE to shed that cost and to protect from SCM flapping if a node goes down and comes up again days later with the wrong config, somebody copies an old yaml with the wrong SCM, some unintended node join, etc. This makes the behavior of the cluster deterministic by config and protects against accidents, doesn&apos;t rely on node topology which would be very dangerous and fragile, etc.&lt;/p&gt;

&lt;p&gt;So if streaming is indeed broken a test would be great to see how the code plays out as my naive expectation is that this would all work like any other std upgrade scenario. If it wasn&apos;t the case we&apos;d need to hold off until all nodes have been moved to UPGRADING.&lt;/p&gt;</comment>
                            <comment id="17795406" author="blambov" created="Mon, 11 Dec 2023 14:56:13 +0000"  >&lt;p&gt;In other words, you both feel that it is okay for &lt;tt&gt;BulkLoader&lt;/tt&gt; to not work if it is not the corresponding version or is not configured exactly like the database is?&lt;/p&gt;

&lt;p&gt;Separately, that a node in e.g. &lt;tt&gt;UPGRADING&lt;/tt&gt; mode should not be able to stream sstables to one in &lt;tt&gt;NONE&lt;/tt&gt;?&lt;/p&gt;</comment>
                            <comment id="17795418" author="jlewandowski" created="Mon, 11 Dec 2023 15:50:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blambov&quot; class=&quot;user-hover&quot; rel=&quot;blambov&quot;&gt;blambov&lt;/a&gt; I don&apos;t know to be honest - if we let bulkloader upload a new sstable to the node which is still in 4.0 mode, that node will lost the ability to downgrade. So I think it should work more or less like: if the node supports messaging version 4.0 and 5.0, then we can stream whatever, if the node supports messaging version 5.0, we can stream whatever, if the node supports messaging version 4.0 we can stream only what is compatible with 4.0. &lt;/p&gt;

&lt;p&gt;I&apos;ve noticed that there is a &lt;tt&gt;correspondingMessagingVersion&lt;/tt&gt; field in &lt;tt&gt;Version&lt;/tt&gt;, which is set to 4.0 for BTI (I think we should change that to 5.0) and 3.0 for all BIG versions, which I think should be 3.0 for M, 4.0 for N and 5.0 for O. Then, the bulk loader could translate the sstable version to the required minimum protocol version and figure out whether it can be streamed or not.&lt;/p&gt;</comment>
                            <comment id="17795603" author="bereng" created="Tue, 12 Dec 2023 06:15:52 +0000"  >&lt;p&gt;I am also having trouble getting my head around this, apologies for being thick.&lt;/p&gt;

&lt;p&gt;So while SCM is being changed you&apos;re still in the &apos;upgrade&apos; process. Afaik during upgrade no maintenance operations should be carried out. Is BulkLoader allowed during an upgrade? Are streaming operations allowed during an upgrade?&lt;/p&gt;</comment>
                            <comment id="17795728" author="jlewandowski" created="Tue, 12 Dec 2023 12:50:49 +0000"  >&lt;p&gt;Perhaps the problem is that whether the bulk loader works or not depends on the server configuration. Command line bulk loader is expected to get configuration parameters from the command line so the fact that it uses some config options from yaml is unexpected. I think, it should work in UPGRADING mode all the time&lt;/p&gt;</comment>
                            <comment id="17795753" author="jlewandowski" created="Tue, 12 Dec 2023 13:43:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blambov&quot; class=&quot;user-hover&quot; rel=&quot;blambov&quot;&gt;blambov&lt;/a&gt; Repair (or more general, streaming) is not expected to work during major version upgrades. There is a test which asserts that it fails with informative message.&lt;/p&gt;</comment>
                            <comment id="17795787" author="bereng" created="Tue, 12 Dec 2023 14:39:32 +0000"  >&lt;p&gt;^that is what we spoke yesterday and would help connect the dots for me&lt;/p&gt;</comment>
                            <comment id="17797047" author="bereng" created="Fri, 15 Dec 2023 06:24:30 +0000"  >&lt;p&gt;Just my 2cts here is the message: &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-5.0/src/java/org/apache/cassandra/repair/messages/PrepareMessage.java#L91&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-5.0/src/java/org/apache/cassandra/repair/messages/PrepareMessage.java#L91&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17797142" author="jlewandowski" created="Fri, 15 Dec 2023 11:11:54 +0000"  >&lt;p&gt;I&apos;ve accidentally discovered that sstable loader is broken for byte ordered partitioner&lt;/p&gt;</comment>
                            <comment id="17797168" author="jlewandowski" created="Fri, 15 Dec 2023 12:52:15 +0000"  >&lt;p&gt;Ok, so I&apos;ve pushed a fix for the problem with bulk loader. It is not a test-fix. Instead of fixing the test, I&apos;ve applied some semantics to:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;current messaging version - for tools and clients it will be always 50&lt;/li&gt;
	&lt;li&gt;accepted streaming version - for tools and clients it will be always the range 40 - 50, so the tool will be able to connect to a node running in any compatibility mode&lt;/li&gt;
	&lt;li&gt;compatibility mode - for tools and clients it will be always none so that they can read sstables in any format&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;alternatively to the conditions, we can implement another option for the storage compatibility mode; also storage compatibility mode may hold supported sstable versions and accepted protocol versions instead of implementing that as conditions in few places in the code&lt;/p&gt;</comment>
                            <comment id="17797365" author="jlewandowski" created="Sat, 16 Dec 2023 07:18:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blambov&quot; class=&quot;user-hover&quot; rel=&quot;blambov&quot;&gt;blambov&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;bereng&lt;/a&gt; ^ ?&lt;/p&gt;</comment>
                            <comment id="17798565" author="blambov" created="Tue, 19 Dec 2023 12:35:53 +0000"  >&lt;blockquote&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; MIXED_MODE_ERROR = &lt;span class=&quot;code-quote&quot;&gt;&quot;Some nodes involved in repair are on an incompatible major version. &quot;&lt;/span&gt; +
                                                   &lt;span class=&quot;code-quote&quot;&gt;&quot;Repair is not supported in mixed major version clusters.&quot;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;em&gt;To me&lt;/em&gt; this message in the context of a 5.0 cluster where something is in the wrong compatibility mode would be quite confusing. At the very least we need to state very clearly that a 5.x node in compatibility mode is considered a 4.x node for all intents and purposes, including being a &quot;same major version&quot; for the message above. Also, does this not mean we can&apos;t ever drop 4.0 support because e.g. 6.0 must be compatible with 5.0, including in its compatibility mode?&lt;/p&gt;</comment>
                            <comment id="17798647" author="jlewandowski" created="Tue, 19 Dec 2023 16:07:40 +0000"  >&lt;p&gt;That&apos;s a good question &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blambov&quot; class=&quot;user-hover&quot; rel=&quot;blambov&quot;&gt;blambov&lt;/a&gt;...&lt;/p&gt;</comment>
                            <comment id="17799122" author="jlewandowski" created="Wed, 20 Dec 2023 18:05:06 +0000"  >&lt;p&gt;Perhaps, value of &quot;4&quot; should be immediately deprecated? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="17799836" author="jlewandowski" created="Fri, 22 Dec 2023 13:26:17 +0000"  >&lt;p&gt;By running tests, I realized I don&apos;t know what the Scrubber should do, which resulting format should it choose? Maybe we need to provide that explicitly? what do you think?&lt;/p&gt;

&lt;p&gt;EDIT: After thinking about it a bit, Scrubber is not actually something to be run outside of the server, or at least, it would be pretty rare. Therefore, it should take the server configuration. I&apos;ll also consider letting the user provide the target format/version through the command line. &lt;/p&gt;</comment>
                            <comment id="17802208" author="jlewandowski" created="Wed, 3 Jan 2024 14:54:30 +0000"  >&lt;p&gt;So the rule will be like - if it is a client, it is assumed it runs outside the server and should accept all protocol versions. If it is a tool, it will just use the server configuration. As I looked at what we consider tools and clients, it seems tools operate on existing sstable files in data directories. BulkLoader was also considered a tool, but I think it is more appropriate to consider it a client. Changed that and made it work with client initialization. &lt;/p&gt;</comment>
                            <comment id="17804175" author="bereng" created="Mon, 8 Jan 2024 08:52:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;Perhaps, value of &quot;4&quot; should be immediately deprecated?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m in support of that or just clarifying it in the docs . Otherwise your cornering yourself to effectively supporting a chained N-1 on all versions going forward&lt;/p&gt;</comment>
                            <comment id="17804419" author="jlewandowski" created="Mon, 8 Jan 2024 18:36:26 +0000"  >&lt;p&gt;What is the conclusion here - is the PR acceptable as an immediate solution? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blambov&quot; class=&quot;user-hover&quot; rel=&quot;blambov&quot;&gt;blambov&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;Bereng&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="17804661" author="blambov" created="Tue, 9 Jan 2024 09:51:25 +0000"  >&lt;p&gt;It is to me.&lt;/p&gt;</comment>
                            <comment id="17805387" author="bereng" created="Thu, 11 Jan 2024 06:26:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jlewandowski&quot; class=&quot;user-hover&quot; rel=&quot;jlewandowski&quot;&gt;jlewandowski&lt;/a&gt; I&apos;m out sick. I started reviewing and will drop just a couple minor comments.&lt;/p&gt;</comment>
                            <comment id="17809798" author="bereng" created="Tue, 23 Jan 2024 08:18:59 +0000"  >&lt;p&gt;+1 with the latest changes&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13557291">CASSANDRA-19012</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                                                <inwardlinks description="Discovered while testing">
                                        <issuelink>
            <issuekey id="13547359">CASSANDRA-18753</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jlewandowski]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12986" cascade-level="1"><![CDATA[Recoverable Corruption / Loss]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1lylc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bereng]]></customfieldvalue>
        <customfieldvalue><![CDATA[blambov]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12353816">5.0-beta1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/d422eb1f353d27264665bfe3357dac1160814ea1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/d422eb1f353d27264665bfe3357dac1160814ea1&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;run regression tests, run manual tests for affected configuration&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>