<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:19:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2083] Hinted Handoff and schema race</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2083</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;If a node is down while a keyspace/cf is created and then data is inserted into the CF causing other nodes to hint, when the down node recovers it will lose some hints until the schema propagates:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR 19:59:28,264 Error in row mutation
org.apache.cassandra.db.UnserializableColumnFamilyException: Couldn&apos;t find cfId=1000
        at org.apache.cassandra.db.ColumnFamilySerializer.deserialize(ColumnFamilySerializer.java:117)
        at org.apache.cassandra.db.RowMutation$RowMutationSerializer.deserialize(RowMutation.java:377)
        at org.apache.cassandra.db.RowMutationVerbHandler.doVerb(RowMutationVerbHandler.java:50)
        at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:70)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662)
 INFO 19:59:28,356 Applying migration 28e2e7a4-2d74-11e0-9b6b-cdc89135952c
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12497250">CASSANDRA-2083</key>
            <summary>Hinted Handoff and schema race</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="brandon.williams">Brandon Williams</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Jan 2011 19:57:50 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:07 +0000</updated>
                            <resolved>Thu, 3 Feb 2011 23:34:05 +0000</resolved>
                                        <fixVersion>0.7.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="28800">8h</timeoriginalestimate>
                            <timeestimate seconds="28800">8h</timeestimate>
                                        <comments>
                            <comment id="12989432" author="brandon.williams" created="Tue, 1 Feb 2011 22:46:25 +0000"  >&lt;p&gt;Patch to wait up to RING_DELAY for schema alignment before delivering hints.  Also ensures that we keep schema up to date in gossip.&lt;/p&gt;</comment>
                            <comment id="12989646" author="jbellis" created="Wed, 2 Feb 2011 14:25:28 +0000"  >&lt;p&gt;gossip propagation is laggy enough that we&apos;ve traditionally used the special version rpc call for schema version checks instead.  we should probably keep doing that here.&lt;/p&gt;</comment>
                            <comment id="12989796" author="brandon.williams" created="Wed, 2 Feb 2011 21:10:17 +0000"  >&lt;p&gt;v2 builds on v1, in that it keeps schema up to date in gossip.  In HHOM we first check if the schema matches in gossip so we can avoid the rpc in the common case of no schema change, then fall back to waiting up to RING_DELAY for agreement via rpc before delivering hints.&lt;/p&gt;</comment>
                            <comment id="12989801" author="jbellis" created="Wed, 2 Feb 2011 21:18:32 +0000"  >&lt;p&gt;So...  now that I think about it more, maybe gossip lag is a GOOD thing here: w/ the RPC, everyone will start hammering the recovered nodes w/ replay at the same time.  W/ gossip it will likely be staggered.&lt;/p&gt;</comment>
                            <comment id="12989803" author="brandon.williams" created="Wed, 2 Feb 2011 21:22:05 +0000"  >&lt;p&gt;Interesting point, although schema will probably match 99% of the time and they&apos;ll replay at the same time anyway.&lt;/p&gt;</comment>
                            <comment id="12990192" author="jbellis" created="Thu, 3 Feb 2011 17:34:15 +0000"  >&lt;p&gt;v3 only uses gossip to check for agreement, and adds a random sleep from 0 to 60 seconds if schemas agree to stagger delivery a little.&lt;/p&gt;</comment>
                            <comment id="12990203" author="brandon.williams" created="Thu, 3 Feb 2011 17:59:51 +0000"  >&lt;p&gt;Committed with the debug line indicating the check is in progress bumped to info.&lt;/p&gt;</comment>
                            <comment id="12990222" author="brandon.williams" created="Thu, 3 Feb 2011 18:31:49 +0000"  >&lt;p&gt;Reverted.  This has problems, the least of which is passing tests.&lt;/p&gt;</comment>
                            <comment id="12990272" author="brandon.williams" created="Thu, 3 Feb 2011 20:07:22 +0000"  >&lt;p&gt;v4 is similar to v3, but fixes migration announcement in gossip correctly by splitting the active announcement (via rpc) from the passive announcement (via gossip), increases logging to indicate it is sleeping to stagger the hints, and makes sure the host is still alive after the sleep before beginning delivery.&lt;/p&gt;</comment>
                            <comment id="12990277" author="hudson" created="Thu, 3 Feb 2011 20:16:19 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #243 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/243/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/243/&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="12990373" author="gdusbabek" created="Thu, 3 Feb 2011 23:28:51 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12990375" author="brandon.williams" created="Thu, 3 Feb 2011 23:34:05 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="12990391" author="hudson" created="Fri, 4 Feb 2011 00:04:40 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #245 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/245/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/245/&lt;/a&gt;)&lt;br/&gt;
    Fix race between HH and schema changes.&lt;br/&gt;
Patch by brandonwilliams, reviewed by gdusbabek for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2083&quot; title=&quot;Hinted Handoff and schema race&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2083&quot;&gt;&lt;del&gt;CASSANDRA-2083&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12470163" name="2083-v3.txt" size="4834" author="jbellis" created="Thu, 3 Feb 2011 17:36:44 +0000"/>
                            <attachment id="12470180" name="2083-v4.txt" size="6743" author="brandon.williams" created="Thu, 3 Feb 2011 20:07:22 +0000"/>
                            <attachment id="12469992" name="2083.txt" size="5889" author="brandon.williams" created="Tue, 1 Feb 2011 22:46:25 +0000"/>
                            <attachment id="12470070" name="2083v2.txt" size="7694" author="brandon.williams" created="Wed, 2 Feb 2011 21:10:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20433</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g97j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>92922</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>gdusbabek</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[gdusbabek]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>