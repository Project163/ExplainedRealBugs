<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:28:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-18707] Test failure: junit.framework.TestSuite.org.apache.cassandra.distributed.test.CASMultiDCTest-.jdk11 </title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-18707</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Seen here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-trunk/1650/testReport/junit.framework/TestSuite/org_apache_cassandra_distributed_test_CASMultiDCTest__jdk11/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/job/Cassandra-trunk/1650/testReport/junit.framework/TestSuite/org_apache_cassandra_distributed_test_CASMultiDCTest__jdk11/&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;&lt;a name=&quot;%C2%A0&quot;&gt;&lt;/a&gt;&#160;&lt;/h3&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Error Message
Schema agreement not reached. Schema versions of the instances: [ef1c8e05-a06d-388d-a46d-53cc22a94762, 6c386108-1805-3985-b48e-8016012a0207, 6c386108-1805-3985-b48e-8016012a0207, ef1c8e05-a06d-388d-a46d-53cc22a94762]

Stacktrace
java.lang.IllegalStateException: Schema agreement not reached. Schema versions of the instances: [ef1c8e05-a06d-388d-a46d-53cc22a94762, 6c386108-1805-3985-b48e-8016012a0207, 6c386108-1805-3985-b48e-8016012a0207, ef1c8e05-a06d-388d-a46d-53cc22a94762] at org.apache.cassandra.distributed.impl.AbstractCluster$ChangeMonitor.waitForCompletion(AbstractCluster.java:907) at org.apache.cassandra.distributed.impl.AbstractCluster.lambda$schemaChange$8(AbstractCluster.java:836) at org.apache.cassandra.concurrent.FutureTask$1.call(FutureTask.java:96) at org.apache.cassandra.concurrent.FutureTask.call(FutureTask.java:61) at org.apache.cassandra.concurrent.FutureTask.run(FutureTask.java:71) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:829)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13545352">CASSANDRA-18707</key>
            <summary>Test failure: junit.framework.TestSuite.org.apache.cassandra.distributed.test.CASMultiDCTest-.jdk11 </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bereng">Berenguer Blasi</assignee>
                                    <reporter username="edimitrova">Ekaterina Dimitrova</reporter>
                        <labels>
                    </labels>
                <created>Fri, 28 Jul 2023 21:53:53 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:56 +0000</updated>
                            <resolved>Thu, 5 Oct 2023 07:30:48 +0000</resolved>
                                        <fixVersion>4.0.12</fixVersion>
                    <fixVersion>4.1.4</fixVersion>
                    <fixVersion>5.0-alpha1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                                    <component>Test/dtest/java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17749937" author="brandon.williams" created="Tue, 1 Aug 2023 16:36:55 +0000"  >&lt;p&gt;I&apos;m not sure what else we can really do here. It&apos;s a timeout that didn&apos;t reach schema agreement, it knows it didn&apos;t, and reported it.&lt;/p&gt;</comment>
                            <comment id="17750463" author="edimitrova" created="Wed, 2 Aug 2023 19:49:02 +0000"  >&lt;p&gt;Well, I guess we need to improve the test. Didn&apos;t we have similar issue with the Python DTests?&lt;/p&gt;

&lt;p&gt;What is weird about this test is that it shows me it was run only twice in Butler (when it failed) and it wasn&apos;t run otherwise?&lt;/p&gt;</comment>
                            <comment id="17750878" author="brandon.williams" created="Thu, 3 Aug 2023 19:53:54 +0000"  >&lt;blockquote&gt;&lt;p&gt;Didn&apos;t we have similar issue with the Python DTests?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think in those the issue was not waiting for agreement, where here it has, and failed after waiting 70s.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;What is weird about this test is that it shows me it was run only twice in Butler (when it failed) and it wasn&apos;t run otherwise?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That is odd, I don&apos;t know what&apos;s going on there.&lt;/p&gt;</comment>
                            <comment id="17761803" author="adelapena" created="Mon, 4 Sep 2023 11:57:31 +0000"  >&lt;p&gt;I&apos;ve tried to reproduce it on the multiplexer:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.circleci/generate.sh -p \
  -e REPEATED_JVM_DTESTS=org.apache.cassandra.distributed.test.CASMultiDCTest \
  -e REPEATED_JVM_DTESTS_COUNT=100
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/3198/workflows/0ee48e01-1c84-44cd-a783-6ec6b487b029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/adelapena/cassandra/3198/workflows/0ee48e01-1c84-44cd-a783-6ec6b487b029&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It doesn&apos;t hit that failure with 100 runs, but it finds a different failure in &lt;tt&gt;testLocalSerialLocalCommit&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
junit.framework.AssertionFailedError: numWritten: 2 &amp;lt; 3
	at org.apache.cassandra.distributed.test.CASMultiDCTest.testLocalSerialCommit(CASMultiDCTest.java:111)
	at org.apache.cassandra.distributed.test.CASMultiDCTest.testLocalSerialLocalCommit(CASMultiDCTest.java:121)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17764993" author="bereng" created="Thu, 14 Sep 2023 05:57:28 +0000"  >&lt;p&gt;I haven&apos;t been able to repro. &lt;tt&gt;testLocalSerialLocalCommit&lt;/tt&gt; seems to be flaky &lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-4.1/417/testReport/org.apache.cassandra.distributed.test/CASMultiDCTest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;in 4.1 as well&lt;/a&gt; according to jenkins despite logs being lost by now already. #justfyi&lt;/p&gt;</comment>
                            <comment id="17765001" author="bereng" created="Thu, 14 Sep 2023 06:05:46 +0000"  >&lt;p&gt;Oh wait the schema disagreement seems to be 5.0 only &lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-5.0/33/testReport/junit.framework/TestSuite/org_apache_cassandra_distributed_test_CASMultiDCTest__jdk11/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this&lt;/a&gt; is a recent failure&lt;/p&gt;</comment>
                            <comment id="17765063" author="bereng" created="Thu, 14 Sep 2023 08:40:38 +0000"  >&lt;p&gt;The problem is that on a slow env the node does indeed take more than 70s to start so schema change agreement can&apos;t be reached. In the attached log  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13062899/13062899_TESTS-TestSuites.xml.xz&quot; title=&quot;TESTS-TestSuites.xml.xz attached to CASSANDRA-18707&quot;&gt;TESTS-TestSuites.xml.xz&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; we can see the test starts and 70s later it fails which matches the &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-5.0/test/distributed/org/apache/cassandra/distributed/impl/AbstractCluster.java#L968&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;70s timeout&lt;/a&gt; of the change monitor.&lt;/p&gt;

&lt;p&gt;If you grep the log for &apos;Schema updated&apos; or &apos;d03783d7&apos;  you can see the propagation of schemas being correct but not being complete. Also the test goes silent for 47s which is probably the root cause blowing the timeouts: &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;INFO  [node4_ScheduledTasks:1] node4 2023-09-13 02:08:29,935 StatusLogger.java:121 - system_auth.role_permissions                 0,0
DEBUG [node1_ScheduledTasks:1] node1 2023-09-13 02:09:16,769 MigrationCoordinator.java:267 - Pulling unreceived schema versions...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;We can only raise the timeout to 140s, see PR, if we agree the diagnostic is correct. Wdyt?&lt;/p&gt;</comment>
                            <comment id="17766743" author="edimitrova" created="Tue, 19 Sep 2023 10:44:58 +0000"  >&lt;p&gt;Do we keep on seeing these failures? Is it every time the same reason?&#160;&lt;br/&gt;
What is the timeout we agreed on in the Python DTests?&#160;&lt;/p&gt;</comment>
                            <comment id="17766770" author="bereng" created="Tue, 19 Sep 2023 11:48:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do we keep on seeing these failures?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In the comment &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18707?focusedCommentId=17765001&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-17765001&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;above&lt;/a&gt; you can see that yes, we keep seeing them&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is it every time the same reason? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The ones I&apos;ve seen yes.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;What is the timeout we agreed on in the Python DTests? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In dtests you can pass in a timeout. But some tests like &lt;a href=&quot;https://github.com/apache/cassandra-dtest/blob/trunk/secondary_indexes_test.py#L294&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this one&lt;/a&gt; do already have 120s.&lt;/p&gt;
</comment>
                            <comment id="17766883" author="edimitrova" created="Tue, 19 Sep 2023 17:03:02 +0000"  >&lt;blockquote&gt;&lt;p&gt;In the comment&#160;above&#160;you can see that yes, we keep seeing them&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Well, I meant more than 1 random failure. Anyway &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160; I don&apos;t see it in Butler on any branch and it seems no one reproduced it so far.&lt;/p&gt;

&lt;p&gt;So your idea is actually to make it double the wait time for all tests on 4.0? I see comments about 5.0 and 4.1, too. I guess you waited for feedback before propagating to all other branches, and this should be 4.0+ change. (covering all branches)&lt;/p&gt;

&lt;p&gt;Also, what do we do with the other failure &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt; mentioned?&#160;&lt;/p&gt;

&lt;p&gt;Considering this silence of 47s happens rarely and randomly only in Jenkins, I suspect it is just the environment, and raising it to 140 should be okay.&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=drohrer&quot; class=&quot;user-hover&quot; rel=&quot;drohrer&quot;&gt;drohrer&lt;/a&gt; , I noticed you were the one who tested and extended the wait time from 60 to 70 due to a race with a hard-coded 60-second timeout in MigrationManager &lt;tt&gt;MIGRATION_DELAY_IN_MS. Any reason why 140 wouldn&apos;t be a good idea here?&#160;&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17766905" author="drohrer" created="Tue, 19 Sep 2023 18:37:28 +0000"  >&lt;blockquote&gt;&lt;p&gt;Doug Rohrer , I noticed you were the one who tested and extended the wait time from 60 to 70 due to a race with a hard-coded 60-second timeout in MigrationManager MIGRATION_DELAY_IN_MS. Any reason why 140 wouldn&apos;t be a good idea here? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;d suggest that I should have made it a configurable value back then, and we should probably make it configurable now. Bumping the default to 140 seems reasonable, but I think we should make it easier for folks with their own CI environment to potentially bump it if they need to without having to change the code again? Thoughts on adding a new property and defaulting &lt;em&gt;that&lt;/em&gt; to 140?&lt;/p&gt;

&lt;p&gt;I do hate to just bump the timeout without understanding why the cluster just hung for 47 seconds, but if we&apos;ve tried to reproduce it a bunch of times and it&apos;s just not happening it seems like the only reasonable option for now. By making it configurable, we can try locally to reproduce and diagnose the root cause (if there is one)&lt;/p&gt;</comment>
                            <comment id="17766910" author="edimitrova" created="Tue, 19 Sep 2023 19:16:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;d suggest that I should have made it a configurable value back then, and we should probably make it configurable now. Bumping the default to 140 seems reasonable, but I think we should make it easier for folks with their own CI environment to potentially bump it if they need to without having to change the code again? Thoughts on adding a new property and defaulting&#160;&lt;em&gt;that&lt;/em&gt;&#160;to 140?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;+1 on making it configurable and further experimenting.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;I do hate to just bump the timeout without understanding why the cluster just hung for 47 seconds, but if we&apos;ve tried to reproduce it a bunch of times and it&apos;s just not happening it seems like the only reasonable option for now. By making it configurable, we can try locally to reproduce and diagnose the root cause (if there is one)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=drohrer&quot; class=&quot;user-hover&quot; rel=&quot;drohrer&quot;&gt;drohrer&lt;/a&gt;, I should admit that you have a point. I was against raising it for the Python tests a while ago, but the community decided the opposite, considering our unstable and slow environment. However, making one more attempt to reproduce the problem by lowering the timeouts sounds reasonable. Especially when there is a concern the cluster hung for 47 seconds... Technically, we do such experiments sometimes, even without having an explicit config parameter. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;Bereng&lt;/a&gt;, did you happen to try that already?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17767010" author="bereng" created="Wed, 20 Sep 2023 06:26:25 +0000"  >&lt;blockquote&gt;&lt;p&gt;I guess you waited for feedback before propagating to all other branches&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yep let&apos;s agree first and then it goes into all 4.0+ branches.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Also, what do we do with the other failure Andres de la Pe&#241;a mentioned? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18851&quot; title=&quot;Test failure: junit.framework.TestSuite.org.apache.cassandra.distributed.test.CASMultiDCTest.testLocalSerialLocalCommit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18851&quot;&gt;CASSANDRA-18851&lt;/a&gt; to handle that one&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I&apos;d suggest that I should have made it a configurable value back then&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Seems like an easy change to fold into this ticket. Added to the PR.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Berenguer Blasi, did you happen to try that already?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Nope. And I am not following I am afraid. 60s pauses on jenkins are common going from my experience fixing previous flakies. I have seen it before. The logs are just empty for that period, there&apos;s absolutely nothing to go about. So as Brandon said it is just a timeout and I agree it&apos;s bc of the env imo. If we reduce the timeout we&apos;ll just make it fail more times, stare at an empty log for that timeout period and then there&apos;s nothing we can do about it right? I&apos;m probably missing sthg but if it failed again what do you do without logs?&lt;/p&gt;</comment>
                            <comment id="17767135" author="edimitrova" created="Wed, 20 Sep 2023 14:23:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;If we reduce the timeout we&apos;ll just make it fail more times, stare at an empty log for that timeout period and then there&apos;s nothing we can do about it right? I&apos;m probably missing sthg but if it failed again what do you do without logs?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I haven&apos;t played with this particular test, but usually, we add additional logging and/or enable tracing during debugging Python DTests. Staring at an empty log is not the way, I agree.&lt;/p&gt;</comment>
                            <comment id="17767386" author="bereng" created="Thu, 21 Sep 2023 05:38:09 +0000"  >&lt;p&gt;That is clear. But it doesn&apos;t repro bc imo you&apos;re trying to repro a jenkins env freeze just during schema agreement. No amount of added logging will make a difference bc we have no insight into that. So I am with Brandon I don&apos;t know what else to do here. I&apos;d merge and if it happens again maybe sbdy else sees sthg... :shrug:&lt;/p&gt;</comment>
                            <comment id="17768895" author="edimitrova" created="Mon, 25 Sep 2023 20:10:27 +0000"  >&lt;p&gt;Sorry, got pulled into something else. I will be looking into this soon&lt;/p&gt;</comment>
                            <comment id="17769003" author="bereng" created="Tue, 26 Sep 2023 04:56:17 +0000"  >&lt;p&gt;No hurries and thanks for your time&lt;/p&gt;</comment>
                            <comment id="17769333" author="edimitrova" created="Tue, 26 Sep 2023 20:10:33 +0000"  >&lt;p&gt;A few observations on my end:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The test exists only 4.1+. Thus, even if we decide to raise the timeout to deal with the flaky test, I don&apos;t see a reason to do it on 4.0.&lt;/li&gt;
	&lt;li&gt;I can fail the test locally only with timeout 0s, not even with 1ms... I have no clue what Jenkins is doing...&lt;/li&gt;
	&lt;li&gt;As the test was looped only 100 times as per previous comment, I tried 500 in Circle CI in both 4.1 and 5.0 branches, and I can reproduce only the other failure from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18851&quot; title=&quot;Test failure: junit.framework.TestSuite.org.apache.cassandra.distributed.test.CASMultiDCTest.testLocalSerialLocalCommit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18851&quot;&gt;CASSANDRA-18851&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;I don&apos;t see any new failures in Butler. I am tempted to use this ticket to make configurable the timeout as suggested but not raise it until we see the failure again. WDYT?&#160;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17769423" author="bereng" created="Wed, 27 Sep 2023 05:23:46 +0000"  >&lt;p&gt;So iiuc we&apos;re basically saying the same:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I don&apos;t see a reason to do it on 4.0.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Let&apos;s do it in 4.0 +1000 imo. We don&apos;t want to be repeating this analysis in the future. As the failure is related to jenkins it may affect any branch and test anytime.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I have no clue what Jenkins is doing&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agreed&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I can reproduce only the other failure from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18851&quot; title=&quot;Test failure: junit.framework.TestSuite.org.apache.cassandra.distributed.test.CASMultiDCTest.testLocalSerialLocalCommit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18851&quot;&gt;CASSANDRA-18851&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agreed&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;make configurable the timeout as suggested&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agreed and was pushed to the PR&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;but not raise it until we see the failure again. WDYT? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I strongly disagree here. We don&apos;t want to do this analysis again or worse, have sbdy else do it again from scratch, specially when it can hit any random test. It would be wasting the effort put here imo.&lt;/p&gt;</comment>
                            <comment id="17769660" author="edimitrova" created="Wed, 27 Sep 2023 14:58:59 +0000"  >&lt;p&gt;Reasons why I am not convinced we should raise it everywhere:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;4.0 is a stable branch where we do not see many changes or this type of failures (so let&apos;s say it would be probably just with/without - it is ok)&lt;/li&gt;
	&lt;li&gt;we see this timeout with a specific test, and not with many, which makes it suspicious.&lt;/li&gt;
	&lt;li&gt;if anyone gets back to the issue, they will find the previous conversation on this ticket and not waste time from scratch.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In Python DTests we opted to raise the timeout per tests or in create_cf.  However it seems the majority opted in for 120, so let&apos;s just accept your suggestion here and move on. I guess that the suspicious test will pop in again if there is something bigger. &lt;br/&gt;
+1, assuming the patch is the same on all branches and there is green CI run per branch&lt;/p&gt;
</comment>
                            <comment id="17769894" author="bereng" created="Thu, 28 Sep 2023 04:13:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;4.0 is a stable branch where we do not see many changes&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Correct. The problem is that we have no insight as to what is happening in jenkins at the time. It might hit it as well&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;we see this timeout with a specific test, and not with many, which makes it suspicious.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I disagree here. I have seen schema changes many times go over 60s in jenkins. That was a common scenario when we were on the 4.0 flaky fixing frenzy and that&apos;s why at the time I did already propose to raise timeouts already. That was declined and I found myself debugging through logs the same problem 2 or 3 extra times. This is just another one.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;not waste time from scratch&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Correct. But you you just have an indication of what have happened. You still have to wade through logs to confirm it is indeed the same scenario.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;In Python DTests we opted to raise the timeout&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Correct and I think it was a good move. I will change the 140s to 120s for consistency and OCD lol&lt;/p&gt;

&lt;p&gt;Thanks I&apos;ll put PRs up&lt;/p&gt;</comment>
                            <comment id="17771027" author="bereng" created="Mon, 2 Oct 2023 09:49:14 +0000"  >&lt;p&gt;Pushed all PRs + CI links. LGTM if I am not missing anything.&lt;/p&gt;</comment>
                            <comment id="17771177" author="edimitrova" created="Mon, 2 Oct 2023 16:09:20 +0000"  >&lt;p&gt;Thanks. The posted runs LGTM. (I didn&apos;t check the patch as I relied it was the same one everywhere?) I also suggest running the Java upgrade tests as they exercise those paths too.&#160;&lt;/p&gt;

&lt;p&gt;Also, we need runs with both JDK versions, as usual.&#160;&lt;/p&gt;

&lt;p&gt;I couldn&apos;t find but maybe I just missed it - is there a repeated run with this patch for the test we were looking at? To verify if something has changed.&lt;/p&gt;</comment>
                            <comment id="17771357" author="bereng" created="Tue, 3 Oct 2023 07:19:30 +0000"  >&lt;p&gt;Yes the patch it&apos;s the same on all branches and yes I should have ran upgrade tests I missed than one! I was trying to spare CI cycles  so I didn&apos;t run all jdks but I added them now for completion. It&apos;s all done now, same links.&lt;/p&gt;

&lt;p&gt;The repeated runs I did didn&apos;t repro the issue. So repeating with a higher timeout will only waste CI imo? wdyt?&lt;/p&gt;</comment>
                            <comment id="17771532" author="edimitrova" created="Tue, 3 Oct 2023 15:48:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;I was trying to spare CI cycles so I didn&apos;t run all jdks, but I added them now for completion.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think I may be looking in the wrong place, so I am posting the links I used to verify CI here: &lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/bereng/cassandra?branch=CASSANDRA-18707-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0 &lt;/a&gt; hit &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18158&quot; title=&quot;Test Failure: org.apache.cassandra.distributed.upgrade.MixedModeReadTest.mixedModeReadColumnSubsetDigestCheck&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18158&quot;&gt;CASSANDRA-18158&lt;/a&gt;, but I do not see J11 run. &lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/bereng/cassandra/1089/workflows/6cbb8ed4-221a-4ae4-88b6-bd08579c144f/jobs/31124&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1 &lt;/a&gt; - I do not see J11 runs&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/bereng/cassandra/1090/workflows/8bcb9c45-7a72-4ae2-a62b-970e9f66a1d3/jobs/31125&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;5.0 &lt;/a&gt; - I do not see J17 runs&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/bereng/cassandra?branch=CASSANDRA-18707-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk &lt;/a&gt; - I do not see J17 runs&lt;/p&gt;

&lt;p&gt;I also just realized (absolutely my fault, so leave it for a follow-up ticket, please, apologize) that the timeout is not configurable with -D or so - being in CASSANDRA_RELEVANT_PROPERTIES, for example, as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=drohrer&quot; class=&quot;user-hover&quot; rel=&quot;drohrer&quot;&gt;drohrer&lt;/a&gt; suggested. Though it can be changed per test in the codebase, you can still not change it per the CI system as a configuration parameter.&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The repeated runs I did didn&apos;t repro the issue.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, but the raised timeout can have a side effect. I spun the test locally on 5.0 100 times with your patch applied, and there were no issues, so I suggest we skip that in CI.&lt;/p&gt;

&lt;p&gt;+1 on green CI (the missing JDK runs)&lt;/p&gt;</comment>
                            <comment id="17771703" author="bereng" created="Wed, 4 Oct 2023 05:21:22 +0000"  >&lt;p&gt;You&apos;re looking in the right places. The links are on the PRs. What I did yesterday is add runs for the mixed jdks case only, again to prevent extra CI which is expensive. I added what you requested now and all is green. I don&apos;t see what side effects a timeout increase can have, in this case, in regards to the underlying jdk version but there it goes for completion.&lt;/p&gt;

&lt;p&gt;Ah yes we spoke on Slack about that. I did make it configurable per test but not as a global property...&lt;/p&gt;

&lt;p&gt;Everything seems green. I&apos;ll merge tomorrow to give some time.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                            <outwardlinks description="Testing discovered">
                                        <issuelink>
            <issuekey id="13550623">CASSANDRA-18851</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13062899" name="TESTS-TestSuites.xml.xz" size="987932" author="bereng" created="Thu, 14 Sep 2023 08:35:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bereng]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12990" cascade-level="1"><![CDATA[Test Failure]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1jgfs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[e.dimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12353292">4.0.11</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/9ccec3dc8c94fe9797c2855ccfb43b47532843fd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/9ccec3dc8c94fe9797c2855ccfb43b47532843fd&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Pending proposed solution approval&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>