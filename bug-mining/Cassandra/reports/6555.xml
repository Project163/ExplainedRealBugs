<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:30:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-19890] type system contains check for duration does not work for hidden types</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-19890</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;The function &quot;org.apache.cassandra.db.marshal.AbstractType#referencesDuration&#8221; relies on type overriding for detecting if the type contains a duration, but the hidden types like Composite or DynamicComposite don&#8217;t override this&#8230; this means that we will be able to create a 2i index for these columns (unless we use SAI as it properly detects this)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
CREATE TABLE &lt;span class=&quot;code-quote&quot;&gt;&quot;tbl&quot;&lt;/span&gt; (
    &lt;span class=&quot;code-quote&quot;&gt;&quot;pk1&quot;&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;with_duration&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;CompositeType(ListType(DurationType))&apos;&lt;/span&gt;,
    PRIMARY KEY (&lt;span class=&quot;code-quote&quot;&gt;&quot;pk1&quot;&lt;/span&gt;)
);
CREATE INDEX ON &lt;span class=&quot;code-quote&quot;&gt;&quot;tbl&quot;&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;with_duration&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is able to create the 2i index even though we shouldn&#8217;t be able to due to duration not being allowed in indexes.&lt;/p&gt;

&lt;p&gt;We have a test method that is able to detect if a type exists in complex types:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
AbstractTypeGenerators.contains(type, DurationType.instance);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Could leverage the same logic to avoid maintenance burden with inheritance &lt;/p&gt;</description>
                <environment></environment>
        <key id="13590911">CASSANDRA-19890</key>
            <summary>type system contains check for duration does not work for hidden types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rwelgosh">Raymond Welgosh</assignee>
                                    <reporter username="dcapwell">David Capwell</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 Sep 2024 19:28:22 +0000</created>
                <updated>Tue, 29 Oct 2024 16:42:36 +0000</updated>
                            <resolved>Wed, 23 Oct 2024 17:56:29 +0000</resolved>
                                        <fixVersion>5.1</fixVersion>
                                    <component>CQL/Interpreter</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="6600">1h 50m</timespent>
                                <comments>
                            <comment id="17880059" author="JIRAUSER306929" created="Sat, 7 Sep 2024 16:55:26 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dcapwell&quot; class=&quot;user-hover&quot; rel=&quot;dcapwell&quot;&gt;dcapwell&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Firstly, this is my first time in trying to make contribution in the opensource project.&lt;/p&gt;

&lt;p&gt;I tried to look at the code and the issue you have mentioned and tried to run it.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;I am able to insert the data in case of DurationType and ListType(DurationType) and as per the functionality not able to create the index on &quot;with_duration&quot;.&lt;/li&gt;
	&lt;li&gt;but I am not able to insert the data in case of &apos;CompositeType(ListType(DurationType))&apos;, can you please help me in this how can I insert the data in this case?&lt;/li&gt;
	&lt;li&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13071433/13071433_image-2024-09-07-22-22-00-382.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13071432/13071432_image-2024-09-07-22-20-38-433.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13071431/13071431_image-2024-09-07-22-18-35-109.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Is it like you want that when we create the DurationType inside the CompositeType then at time of Defining the INDEX using &quot;CREATE INDEX&quot; it should throw the error?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17882124" author="dcapwell" created="Mon, 16 Sep 2024 17:10:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;can you please help me in this how can I insert the data in this case?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The CQL Literal format isn&apos;t user friendly as these are &quot;hidden&quot; types, below are random examples I generated&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
0x00320000000200000013f02b775640f02bb15f3eff7eacf193d293246c00000013f0dda233ddf07660e909ff7f43397051e176af00
0x00470000000300000012e936ac84f0ed53c606ffc7a8794a8e2f0e1400000013f05b380fb3f07c03df73ff45e8fb55aeb8cc1700000012f01ff6bc02e127fbf6ff6cbda80f91c27a5400
0x001b0000000100000013f04b90a085f01d086375ffcca86423b84a07b100
0x00480000000300000013f08ae8726cf0a3f78f48ff46e0079823b3690600000013f02db6a044f07c344c4eff8c51b2957f0daa2000000012f0956f919fe3d0191fff3c422d5ea849786700
0x00320000000200000013f08a36c186f05d322e9aff12bceeba1dd36eee00000013f0f1010774f0676c1adeff7b92eeed80d80ae200
0x00490000000300000013f08415ae4df081c246dbffa19c8cc1aaeb0ebd00000013f034e0d1fdf039e8df5bff706013f13de3f94700000013f09453046af0c1cda522ff34d08aa28bfd6d7c00
0x001b0000000100000013f05a3d02b5f0c627d0adff160dfa8661781ca300
0x00490000000300000013f06c2f1b90f0909bf81cff990843249aa0d78c00000013f042ed2668f0f065d27effc8f59a66b931243e00000013f0f2f4f3e6f0682ccfa4ff69996cde1c04bc9400
0x00320000000200000013f09e51f1e6f09950c908ff210f78d0cdf6bc0a00000013f049bd73c7f0e7f95871ff9888ad323d34462900
0x00300000000200000013f0400f8524f0a163a874fffa5f118347b56b8000000011e47e2f40eeee303cff4087d01ece700e6e00
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17882125" author="dcapwell" created="Mon, 16 Sep 2024 17:12:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;Defining the INDEX using &quot;CREATE INDEX&quot; it should through the error?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It should fail, it doesn&apos;t fail right now because a method was added using inheritance but didn&apos;t update everything... a simpler solution is to leverage the test methods as they handle this far better and have better coverage&lt;/p&gt;</comment>
                            <comment id="17882457" author="dcapwell" created="Tue, 17 Sep 2024 16:47:58 +0000"  >&lt;p&gt;I went to use &quot;contain&quot; in another patch and found out its in &lt;a href=&quot;https://github.com/apache/cassandra/pull/3416&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/3416&lt;/a&gt;... I have too many patches inflight &lt;del&gt;_&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;That method just makes a slight refactor to the existing UDT methods, making it reusable in other contexts...&lt;/p&gt;</comment>
                            <comment id="17890991" author="JIRAUSER305752" created="Fri, 18 Oct 2024 15:23:59 +0000"  >&lt;p&gt;Pull Request: &lt;a href=&quot;https://github.com/apache/cassandra/pull/3621&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/3621&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17891031" author="dcapwell" created="Fri, 18 Oct 2024 17:11:22 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rwelgosh&quot; class=&quot;user-hover&quot; rel=&quot;rwelgosh&quot;&gt;rwelgosh&lt;/a&gt; for the patch, did review and posted feedback in GitHub&lt;/p&gt;</comment>
                            <comment id="17891961" author="yifanc" created="Tue, 22 Oct 2024 18:20:49 +0000"  >&lt;p&gt;Pasting the &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13072368/ci_summary.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;CI result&lt;/a&gt;. It looks green. &lt;/p&gt;
</comment>
                            <comment id="17892228" author="dcapwell" created="Wed, 23 Oct 2024 16:45:59 +0000"  >&lt;p&gt;+1 from me&lt;/p&gt;</comment>
                            <comment id="17892230" author="yifanc" created="Wed, 23 Oct 2024 16:51:27 +0000"  >&lt;p&gt;+1 on the patch. Thanks for the fix!&lt;/p&gt;</comment>
                            <comment id="17892246" author="yifanc" created="Wed, 23 Oct 2024 17:56:29 +0000"  >&lt;p&gt;Committed into trunk as &lt;a href=&quot;https://github.com/apache/cassandra/commit/e8891be04a681fbd87e2bec2c07ed22e55725a04&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;e8891be&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13597110">CASSANDRA-20036</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13072368" name="ci_summary.html" size="86348" author="yifanc" created="Tue, 22 Oct 2024 18:20:11 +0000"/>
                            <attachment id="13071431" name="image-2024-09-07-22-18-35-109.png" size="25412" author="nikhilkumawat03" created="Sat, 7 Sep 2024 16:48:35 +0000"/>
                            <attachment id="13071432" name="image-2024-09-07-22-20-38-433.png" size="21789" author="nikhilkumawat03" created="Sat, 7 Sep 2024 16:50:39 +0000"/>
                            <attachment id="13071433" name="image-2024-09-07-22-22-00-382.png" size="35560" author="nikhilkumawat03" created="Sat, 7 Sep 2024 16:52:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[rwelgosh]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="13161" cascade-level="1"><![CDATA[Unrecoverable Corruption / Loss]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12972"><![CDATA[Fuzz Test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1r7qg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[dcapwell]]></customfieldvalue>
        <customfieldvalue><![CDATA[ycai]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12337348">3.10</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/e8891be04a681fbd87e2bec2c07ed22e55725a04&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/e8891be04a681fbd87e2bec2c07ed22e55725a04&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Added tests in AbstractTypeTest.java to check nested types with durations in them.&#160;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>