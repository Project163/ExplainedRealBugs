<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:14:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-1279] heisenbug in RoundRobinSchedulerTest</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-1279</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Occasionally I see this error in the test suite:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Testcase: testScheduling(org.apache.cassandra.scheduler.RoundRobinSchedulerTest):	FAILED&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; junit.framework.AssertionFailedError: &lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.cassandra.scheduler.RoundRobinSchedulerTest.testScheduling(RoundRobinSchedulerTest.java:90)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &lt;/p&gt;</description>
                <environment></environment>
        <key id="12469264">CASSANDRA-1279</key>
            <summary>heisenbug in RoundRobinSchedulerTest</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rnirmal">Nirmal Ranganathan</assignee>
                                    <reporter username="jbellis">Jonathan Ellis</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Jul 2010 15:58:35 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:20 +0000</updated>
                            <resolved>Tue, 3 Aug 2010 17:27:05 +0000</resolved>
                                        <fixVersion>0.7 beta 1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12890324" author="rnirmal" created="Tue, 20 Jul 2010 17:02:27 +0000"  >&lt;p&gt;Fixed the problem, it&apos;s due to the unpredictable thread scheduling. The fixe loads the requests and then lets the scheduler proceed, that way the tests could be somewhat predictable and realize the expected behavior.&lt;/p&gt;</comment>
                            <comment id="12890432" author="jbellis" created="Tue, 20 Jul 2010 20:36:39 +0000"  >&lt;p&gt;can you add a comment as to what is going on?&lt;/p&gt;

&lt;p&gt;also, adding a package-private method for the test to use would be cleaner than poking through reflection&lt;/p&gt;</comment>
                            <comment id="12890473" author="rnirmal" created="Tue, 20 Jul 2010 21:51:19 +0000"  >&lt;p&gt;The test is done with 15 simulated connections, 10 for K1(keyspace), 2 for K2 and 3 for k3. Requests came in the order of K1(1 thru 10), K2(11 thru 12), K3(13 thru15) and the test checked if K2 and K3 requests ran earlier then their request order. With the scheduler starting simultaneously, the requests were pretty much routed in order +/- the jvm thread scheduling order, hence the cause for the bug. &lt;/p&gt;

&lt;p&gt;Now the scheduler is paused still all the requests arrive and placed in their respective queues. When the scheduler is resumed, each pass retrieves one request from each keyspace queue, hence since K2 &amp;amp; K3 have only 2 and 3 requests, they get serviced faster than the order in which they arrived. This test just validates that the requests are RoundRobin and that&apos;s what we want to unit test.&lt;/p&gt;</comment>
                            <comment id="12890481" author="jbellis" created="Tue, 20 Jul 2010 22:03:44 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                            <comment id="12890711" author="hudson" created="Wed, 21 Jul 2010 12:50:24 +0000"  >&lt;p&gt;Integrated in Cassandra #496 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/496/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/496/&lt;/a&gt;)&lt;br/&gt;
    fix RoundRobinSchedulerTest heisenbug.  patch by Nirmal Ranganathan; reviewed by jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1279&quot; title=&quot;heisenbug in RoundRobinSchedulerTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1279&quot;&gt;&lt;del&gt;CASSANDRA-1279&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12894898" author="jbellis" created="Tue, 3 Aug 2010 15:14:45 +0000"  >&lt;p&gt;looks like this is only mostly fixed.  still getting&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; junit.framework.AssertionFailedError: &lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.cassandra.scheduler.RoundRobinSchedulerTest.testScheduling(RoundRobinSchedulerTest.java:93)&lt;/p&gt;
</comment>
                            <comment id="12894902" author="rnirmal" created="Tue, 3 Aug 2010 15:24:30 +0000"  >&lt;p&gt;Hmm.... looks like I&apos;ll have to change the way we test it. &lt;/p&gt;</comment>
                            <comment id="12894940" author="rnirmal" created="Tue, 3 Aug 2010 17:08:15 +0000"  >&lt;p&gt;The scheduler will only have 1 token at anytime and the run/release of each thread is synchronized, effectively running only one thread at a time. So hopefully no threading inconsistencies occur.&lt;/p&gt;</comment>
                            <comment id="12894943" author="jbellis" created="Tue, 3 Aug 2010 17:10:23 +0000"  >&lt;p&gt;Is this the point at which we say that &quot;this is different enough from &apos;live&apos; code that it&apos;s not really a useful test anymore?&quot;  Because I&apos;m okay with that.&lt;/p&gt;</comment>
                            <comment id="12894948" author="rnirmal" created="Tue, 3 Aug 2010 17:23:27 +0000"  >&lt;p&gt;Yes I&apos;d say that, because it doesn&apos;t reflect the actual concurrency that will take place. So if it&apos;s ok we could remove it.&lt;/p&gt;</comment>
                            <comment id="12894949" author="jbellis" created="Tue, 3 Aug 2010 17:27:05 +0000"  >&lt;p&gt;removed&lt;/p&gt;</comment>
                            <comment id="12895245" author="hudson" created="Wed, 4 Aug 2010 13:25:29 +0000"  >&lt;p&gt;Integrated in Cassandra #509 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/509/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/509/&lt;/a&gt;)&lt;br/&gt;
    r/m RoundRobinSchedulerTest for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1279&quot; title=&quot;heisenbug in RoundRobinSchedulerTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1279&quot;&gt;&lt;del&gt;CASSANDRA-1279&lt;/del&gt;&lt;/a&gt;; it doesn&apos;t appear possible to test concurrency usefully&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12451135" name="1279-v3.patch" size="1990" author="rnirmal" created="Tue, 3 Aug 2010 17:08:15 +0000"/>
                            <attachment id="12449982" name="Cassandra-1279-v2.patch" size="2477" author="rnirmal" created="Tue, 20 Jul 2010 21:51:19 +0000"/>
                            <attachment id="12449945" name="Cassandra-1279.patch" size="2206" author="rnirmal" created="Tue, 20 Jul 2010 17:02:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[rnirmal]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20056</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g43b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>92093</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>