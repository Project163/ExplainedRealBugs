<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:27:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3551] Timeout exception for quorum reads after upgrade from 1.0.2 to 1.0.5</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3551</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I upgraded from 1.0.2 to 1.0.5. For some column families always got TimeoutException. I turned on debug and increase rpc_timeout to 1 minute, but still got timeout. I believe it is bug on 1.0.5.&lt;/p&gt;

&lt;p&gt;ConsistencyLevel is QUORUM, replicate factor is 3. &lt;/p&gt;

&lt;p&gt;Here are partial logs. &lt;/p&gt;


&lt;p&gt;DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,717 StorageProxy.java (line 813) RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;keyspaceLBSDATAPRODUS&apos;, column_family=&apos;dataProvider&apos;, super_column=null, predicate=SlicePre
dicate(slice_range:SliceRange(start:80 01 00 01 00 00 00 10 67 65 74 5F 72 61 6E 67 65 5F 73 6C 69 63 65 73 00 00 00 03 0C 00 01 0B 00 03 00 00 00 0C 64 61 74 61 50 72 6F 76 69 64 65 72 00 0C 00 0
2 0C 00 02 0B 00 01 00 00 00 00, finish:80 01 00 01 00 00 00 10 67 65 74 5F 72 61 6E 67 65 5F 73 6C 69 63 65 73 00 00 00 03 0C 00 01 0B 00 03 00 00 00 0C 64 61 74 61 50 72 6F 76 69 64 65 72 00 0C 
00 02 0C 00 02 0B 00 01 00 00 00 00 0B 00 02 00 00 00 00, reversed:false, count:1024)), range=[PROD/US/000/0,PROD/US/999/99999], max_keys=1024}
&lt;p&gt;DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,718 StorageProxy.java (line 1012) restricted ranges for query &lt;span class=&quot;error&quot;&gt;&amp;#91;PROD/US/000/0,PROD/US/999/99999&amp;#93;&lt;/span&gt; are [&lt;span class=&quot;error&quot;&gt;&amp;#91;PROD/US/000/0,PROD/US/300/~&amp;#93;&lt;/span&gt;, (PROD/US/300/~,PROD/&lt;br/&gt;
US/600/&lt;sub&gt;], (PROD/US/600/&lt;/sub&gt;,PROD/US/999/99999]]&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,720 VoxeoStrategy.java (line 157) ReplicationFactor 3&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,720 VoxeoStrategy.java (line 33) PROD/US/300/~&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,721 VoxeoStrategy.java (line 96) End region for token PROD/US/300/~ PROD/US/300/~ 10.92.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,721 VoxeoStrategy.java (line 96) End region for token PROD/US/300/~ PROD/US/600/~ 10.72.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,721 VoxeoStrategy.java (line 96) End region for token PROD/US/300/~ PROD/US/999/~ 10.8.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,723 VoxeoStrategy.java (line 157) ReplicationFactor 3&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,724 ReadCallback.java (line 77) Blockfor/repair is 2/false; setting up requests to /10.92.208.103,/10.72.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/10.92.208.103&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,725 OutboundTcpConnection.java (line 206) attempting to connect to /10.92.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,726 StorageProxy.java (line 859) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;keyspaceLBSDATAPRODUS&apos;, column_family=&apos;dataProvider&apos;, super_column=null, predicate=
SlicePredicate(slice_range:SliceRange(start:80 01 00 01 00 00 00 10 67 65 74 5F 72 61 6E 67 65 5F 73 6C 69 63 65 73 00 00 00 03 0C 00 01 0B 00 03 00 00 00 0C 64 61 74 61 50 72 6F 76 69 64 65 72 00
 0C 00 02 0C 00 02 0B 00 01 00 00 00 00, finish:80 01 00 01 00 00 00 10 67 65 74 5F 72 61 6E 67 65 5F 73 6C 69 63 65 73 00 00 00 03 0C 00 01 0B 00 03 00 00 00 0C 64 61 74 61 50 72 6F 76 69 64 65 7
2 00 0C 00 02 0C 00 02 0B 00 01 00 00 00 00 0B 00 02 00 00 00 00, reversed:false, count:1024)), range=[PROD/US/000/0,PROD/US/300/~], max_keys=1024}
&lt;p&gt; from /10.92.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,726 StorageProxy.java (line 859) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;keyspaceLBSDATAPRODUS&apos;, column_family=&apos;dataProvider&apos;, super_column=null, predicate=
SlicePredicate(slice_range:SliceRange(start:80 01 00 01 00 00 00 10 67 65 74 5F 72 61 6E 67 65 5F 73 6C 69 63 65 73 00 00 00 03 0C 00 01 0B 00 03 00 00 00 0C 64 61 74 61 50 72 6F 76 69 64 65 72 00
 0C 00 02 0C 00 02 0B 00 01 00 00 00 00, finish:80 01 00 01 00 00 00 10 67 65 74 5F 72 61 6E 67 65 5F 73 6C 69 63 65 73 00 00 00 03 0C 00 01 0B 00 03 00 00 00 0C 64 61 74 61 50 72 6F 76 69 64 65 7
2 00 0C 00 02 0C 00 02 0B 00 01 00 00 00 00 0B 00 02 00 00 00 00, reversed:false, count:1024)), range=[PROD/US/000/0,PROD/US/300/~], max_keys=1024}
&lt;p&gt; from /10.72.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;WRITE-/10.8.208.103&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,727 OutboundTcpConnection.java (line 206) attempting to connect to /10.8.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,727 StorageProxy.java (line 859) reading RangeSliceCommand&lt;/p&gt;
{keyspace=&apos;keyspaceLBSDATAPRODUS&apos;, column_family=&apos;dataProvider&apos;, super_column=null, predicate=
SlicePredicate(slice_range:SliceRange(start:80 01 00 01 00 00 00 10 67 65 74 5F 72 61 6E 67 65 5F 73 6C 69 63 65 73 00 00 00 03 0C 00 01 0B 00 03 00 00 00 0C 64 61 74 61 50 72 6F 76 69 64 65 72 00
 0C 00 02 0C 00 02 0B 00 01 00 00 00 00, finish:80 01 00 01 00 00 00 10 67 65 74 5F 72 61 6E 67 65 5F 73 6C 69 63 65 73 00 00 00 03 0C 00 01 0B 00 03 00 00 00 0C 64 61 74 61 50 72 6F 76 69 64 65 7
2 00 0C 00 02 0C 00 02 0B 00 01 00 00 00 00 0B 00 02 00 00 00 00, reversed:false, count:1024)), range=[PROD/US/000/0,PROD/US/300/~], max_keys=1024}
&lt;p&gt; from /10.8.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,731 SliceQueryFilter.java (line 123) collecting 0 of 1024: active:false:1@1322777621601000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,731 SliceQueryFilter.java (line 123) collecting 1 of 1024: name:false:4@1322777621601000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,731 SliceQueryFilter.java (line 123) collecting 2 of 1024: providerData:false:2283@1321549067179000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,731 SliceQueryFilter.java (line 123) collecting 3 of 1024: providerID:false:1@1322777621601000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,732 SliceQueryFilter.java (line 123) collecting 4 of 1024: timestamp:false:13@1322777621601000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,732 SliceQueryFilter.java (line 123) collecting 5 of 1024: vendorData:false:2364@1322777621601000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,733 ColumnFamilyStore.java (line 1331) scanned DecoratedKey(PROD/US/001/1, 50524f442f55532f3030312f31)&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ReadStage:1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,733 RangeSliceVerbHandler.java (line 55) Sending RangeSliceReply&lt;/p&gt;
{rows=Row(key=DecoratedKey(PROD/US/001/1, 50524f442f55532f3030312f31), cf=ColumnFamily(dataP
rovider [active:false:1@1322777621601000,name:false:4@1322777621601000,providerData:false:2283@1321549067179000,providerID:false:1@1322777621601000,timestamp:false:13@1322777621601000,vendorData:f
alse:2364@1322777621601000,]))}
&lt;p&gt; to 72@/10.72.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,734 ResponseVerbHandler.java (line 44) Processing response on a callback from 72@/10.72.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:2&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,887 ResponseVerbHandler.java (line 44) Processing response on a callback from 71@/10.92.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,889 SliceQueryFilter.java (line 123) collecting 0 of 2147483647: active:false:1@1322777621601000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,890 SliceQueryFilter.java (line 123) collecting 1 of 2147483647: name:false:4@1322777621601000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,890 SliceQueryFilter.java (line 123) collecting 2 of 2147483647: providerData:false:2283@1321549067179000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,890 SliceQueryFilter.java (line 123) collecting 3 of 2147483647: providerID:false:1@1322777621601000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,890 SliceQueryFilter.java (line 123) collecting 4 of 2147483647: timestamp:false:13@1322777621601000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,891 SliceQueryFilter.java (line 123) collecting 5 of 2147483647: vendorData:false:2364@1322777621601000&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,892 StorageProxy.java (line 867) range slices read DecoratedKey(PROD/US/001/1, 50524f442f55532f3030312f31)&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RequestResponseStage:3&amp;#93;&lt;/span&gt; 2011-12-01 22:25:39,936 ResponseVerbHandler.java (line 44) Processing response on a callback from 73@/10.8.208.103&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-12-01 22:26:19,788 LoadBroadcaster.java (line 86) Disseminating load info ...&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-2-thread-1&amp;#93;&lt;/span&gt; 2011-12-01 22:26:39,904 StorageProxy.java (line 874) Range slice timeout: java.util.concurrent.TimeoutException: Operation timed out.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux, Cassandra 1.0.5&lt;/p&gt;</environment>
        <key id="12533530">CASSANDRA-3551</key>
            <summary>Timeout exception for quorum reads after upgrade from 1.0.2 to 1.0.5</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="apache.zli">Zhong Li</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Dec 2011 22:58:16 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:45 +0000</updated>
                            <resolved>Wed, 7 Dec 2011 17:35:33 +0000</resolved>
                                        <fixVersion>1.0.6</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13161279" author="jbellis" created="Thu, 1 Dec 2011 23:08:51 +0000"  >&lt;p&gt;any exceptions on the other nodes?&lt;/p&gt;</comment>
                            <comment id="13161517" author="jalkanen" created="Fri, 2 Dec 2011 09:57:37 +0000"  >&lt;p&gt;I am seeing this too; switching to ConsistencyLevel.ONE helps, but does not solve the problem completely, i.e. queries fail less often.&lt;/p&gt;</comment>
                            <comment id="13161532" author="slebresne" created="Fri, 2 Dec 2011 10:23:39 +0000"  >&lt;p&gt;More infos on you respective setups could help. For instance:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;you said, &apos;For some column families&apos;. Is there something specific to those column families ? Are they using compression? leveled compaction?&lt;/li&gt;
	&lt;li&gt;Janne: you&apos;re seeing it too, but on which version exactly did you definitively not see this problem and on which are you definitively seeing it? Is it 1.0.2 and 1.0.5 respectively as for Zhong?&lt;/li&gt;
	&lt;li&gt;As Jonathan said, are you seeing any error in any node logs?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13161553" author="jalkanen" created="Fri, 2 Dec 2011 11:28:37 +0000"  >&lt;p&gt;1.0.5, RF 3, 3 node cluster on EC2.  I upgraded just recently directly from 0.6.13, so I have not been on any earlier 1.0.x version.  No compression, just a straightforward upgrade with minimal tuning to the cassandra.yaml file.  2GB heap, maybe ~1GB in use.  Happens with column families which have 20 rows, CFs which have 10000 rows and more.  Happens when trying to read 100 rows at a time, happens when trying to read 10k rows at a time.  The only factor that I&apos;ve noticed while trying to tune that has any effect is changing the CL.&lt;/p&gt;

&lt;p&gt;No errors in node logs, no anomalies in system monitoring (like suddenly increased disk latency).  Only cassandra&apos;s storageproxy latency goes way up (hundreds of milliseconds), before failure.&lt;/p&gt;

&lt;p&gt;Here is the exception from hector:&lt;/p&gt;

&lt;p&gt;Caused by: me.prettyprint.hector.api.exceptions.HTimedOutException: TimedOutException()&lt;br/&gt;
	at me.prettyprint.cassandra.service.ExceptionsTranslatorImpl.translate(ExceptionsTranslatorImpl.java:42)&lt;br/&gt;
	at me.prettyprint.cassandra.service.KeyspaceServiceImpl$3.execute(KeyspaceServiceImpl.java:163)&lt;br/&gt;
	at me.prettyprint.cassandra.service.KeyspaceServiceImpl$3.execute(KeyspaceServiceImpl.java:145)&lt;br/&gt;
	at me.prettyprint.cassandra.service.Operation.executeAndSetResult(Operation.java:101)&lt;br/&gt;
	at me.prettyprint.cassandra.connection.HConnectionManager.operateWithFailover(HConnectionManager.java:233)&lt;br/&gt;
	at me.prettyprint.cassandra.service.KeyspaceServiceImpl.operateWithFailover(KeyspaceServiceImpl.java:131)&lt;br/&gt;
	at me.prettyprint.cassandra.service.KeyspaceServiceImpl.getRangeSlices(KeyspaceServiceImpl.java:167)&lt;br/&gt;
	at me.prettyprint.cassandra.model.thrift.ThriftRangeSlicesQuery$1.doInKeyspace(ThriftRangeSlicesQuery.java:67)&lt;br/&gt;
	at me.prettyprint.cassandra.model.thrift.ThriftRangeSlicesQuery$1.doInKeyspace(ThriftRangeSlicesQuery.java:63)&lt;br/&gt;
	at me.prettyprint.cassandra.model.KeyspaceOperationCallback.doInKeyspaceAndMeasure(KeyspaceOperationCallback.java:20)&lt;br/&gt;
	at me.prettyprint.cassandra.model.ExecutingKeyspace.doExecute(ExecutingKeyspace.java:85)&lt;br/&gt;
	at me.prettyprint.cassandra.model.thrift.ThriftRangeSlicesQuery.execute(ThriftRangeSlicesQuery.java:62)&lt;/p&gt;

&lt;p&gt;Here&apos;s the CF definition:&lt;/p&gt;

&lt;p&gt;    ColumnFamily: XXXX&lt;br/&gt;
      Key Validation Class: org.apache.cassandra.db.marshal.BytesType&lt;br/&gt;
      Default column value validator: org.apache.cassandra.db.marshal.BytesType&lt;br/&gt;
      Columns sorted by: org.apache.cassandra.db.marshal.UTF8Type&lt;br/&gt;
      Row cache size / save period in seconds / keys to save : 0.0/0/all&lt;br/&gt;
      Row Cache Provider: org.apache.cassandra.cache.ConcurrentLinkedHashCacheProvider&lt;br/&gt;
      Key cache size / save period in seconds: 200000.0/14400&lt;br/&gt;
      GC grace seconds: 864000&lt;br/&gt;
      Compaction min/max thresholds: 4/32&lt;br/&gt;
      Read repair chance: 1.0&lt;br/&gt;
      Replicate on write: true&lt;br/&gt;
      Built indexes: []&lt;br/&gt;
      Compaction Strategy: org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy&lt;/p&gt;</comment>
                            <comment id="13161778" author="apache.zli" created="Fri, 2 Dec 2011 18:31:10 +0000"  >&lt;p&gt;There is no exceptions on other nodes. &lt;/p&gt;

&lt;p&gt;I might be wrong about &apos;For some column families&apos;. I saw another column family failed with Range Slice too. It works for insert. It might work for others retrieve command. I need test more when I have time. There is no compression, one row data only.&lt;/p&gt;



&lt;p&gt; ColumnFamily: dataProvider&lt;br/&gt;
      Key Validation Class: org.apache.cassandra.db.marshal.UTF8Type&lt;br/&gt;
      Default column value validator: org.apache.cassandra.db.marshal.UTF8Type&lt;br/&gt;
      Columns sorted by: org.apache.cassandra.db.marshal.UTF8Type&lt;br/&gt;
      Row cache size / save period in seconds / keys to save : 1024.0/0/all&lt;br/&gt;
      Row Cache Provider: org.apache.cassandra.cache.SerializingCacheProvider&lt;br/&gt;
      Key cache size / save period in seconds: 1024.0/14400&lt;br/&gt;
      GC grace seconds: 432000&lt;br/&gt;
      Compaction min/max thresholds: 4/32&lt;br/&gt;
      Read repair chance: 1.0&lt;br/&gt;
      Replicate on write: true&lt;br/&gt;
      Column Metadata:&lt;br/&gt;
        Column Name: active&lt;br/&gt;
          Validation Class: org.apache.cassandra.db.marshal.UTF8Type&lt;br/&gt;
          Index Name: dataProvider_active_idx&lt;br/&gt;
          Index Type: KEYS&lt;br/&gt;
        Column Name: object&lt;br/&gt;
          Validation Class: org.apache.cassandra.db.marshal.BytesType&lt;br/&gt;
        Column Name: providerData&lt;br/&gt;
          Validation Class: org.apache.cassandra.db.marshal.UTF8Type&lt;br/&gt;
          Index Name: dataProvider_providerData_idx&lt;br/&gt;
          Index Type: KEYS&lt;br/&gt;
        Column Name: providerID&lt;br/&gt;
          Validation Class: org.apache.cassandra.db.marshal.UTF8Type&lt;br/&gt;
          Index Name: dataProvider_providerID_idx&lt;br/&gt;
          Index Type: KEYS&lt;br/&gt;
      Compaction Strategy: org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy&lt;/p&gt;
</comment>
                            <comment id="13163721" author="dccwilliams" created="Tue, 6 Dec 2011 18:06:04 +0000"  >&lt;p&gt;I hit a version of this problem...&lt;/p&gt;

&lt;p&gt;I upgraded a production cluster from 1.0.3 (from a non-official version patched for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3510&quot; title=&quot;Incorrect query results due to invalid SSTable.maxTimestamp&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3510&quot;&gt;&lt;del&gt;CASSANDRA-3510&lt;/del&gt;&lt;/a&gt;) to 1.0.5. The aim was to pass &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3440&quot; title=&quot;local writes timing out cause attempt to hint to self&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3440&quot;&gt;&lt;del&gt;CASSANDRA-3440&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This generated a timeout storm on range slices and I have reverted. &lt;/p&gt;

&lt;p&gt;Notes:&lt;/p&gt;

&lt;p&gt;1/ The 1.0.5 node CPUs all showed tiny load - in fact, they seemed to be substantially less loaded than the 1.0.3 nodes were/are again&lt;/p&gt;

&lt;p&gt;2/ The system.log files on the 1.0.5 nodes didn&apos;t record any errors&lt;/p&gt;

&lt;p&gt;3/ range_slice timeout storm experienced in application layer. Example log trace below&lt;/p&gt;

&lt;p&gt;org.apache.thrift.transport.TTransportException: java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
        at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:129) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;libthrift-0.6.1.jar:0.6.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.thrift.transport.TTransport.readAll(TTransport.java:84) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;libthrift-0.6.1.jar:0.6.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.thrift.transport.TFramedTransport.readFrame(TFramedTransport.java:129) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;libthrift-0.6.1.jar:0.6.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.thrift.transport.TFramedTransport.read(TFramedTransport.java:101) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;libthrift-0.6.1.jar:0.6.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.thrift.transport.TTransport.readAll(TTransport.java:84) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;libthrift-0.6.1.jar:0.6.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:378) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;libthrift-0.6.1.jar:0.6.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:297) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;libthrift-0.6.1.jar:0.6.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:204) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;libthrift-0.6.1.jar:0.6.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.thrift.Cassandra$Client.recv_get_slice(Cassandra.java:560) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cassandra-thrift-1.0.1.jar:1.0.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.cassandra.thrift.Cassandra$Client.get_slice(Cassandra.java:542) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;cassandra-thrift-1.0.1.jar:1.0.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.scale7.cassandra.pelops.Selector$3.execute(Selector.java:683) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;scale7-pelops-1.3-1.0.x-SNAPSHOT.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.scale7.cassandra.pelops.Selector$3.execute(Selector.java:680) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;scale7-pelops-1.3-1.0.x-SNAPSHOT.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.scale7.cassandra.pelops.Operand.tryOperation(Operand.java:86) &lt;span class=&quot;error&quot;&gt;&amp;#91;scale7-pelops-1.3-1.0.x-SNAPSHOT.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.scale7.cassandra.pelops.Operand.tryOperation(Operand.java:66) &lt;span class=&quot;error&quot;&gt;&amp;#91;scale7-pelops-1.3-1.0.x-SNAPSHOT.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.scale7.cassandra.pelops.Selector.getColumnOrSuperColumnsFromRow(Selector.java:680) &lt;span class=&quot;error&quot;&gt;&amp;#91;scale7-pelops-1.3-1.0.x-SNAPSHOT.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.scale7.cassandra.pelops.Selector.getColumnsFromRow(Selector.java:689) &lt;span class=&quot;error&quot;&gt;&amp;#91;scale7-pelops-1.3-1.0.x-SNAPSHOT.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.scale7.cassandra.pelops.Selector.getColumnsFromRow(Selector.java:676) &lt;span class=&quot;error&quot;&gt;&amp;#91;scale7-pelops-1.3-1.0.x-SNAPSHOT.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.scale7.cassandra.pelops.Selector.getColumnsFromRow(Selector.java:562) &lt;span class=&quot;error&quot;&gt;&amp;#91;scale7-pelops-1.3-1.0.x-SNAPSHOT.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at com.fightmymonster.game.Monsters.getMonster(Monsters.java:92) &lt;span class=&quot;error&quot;&gt;&amp;#91;fmmServer.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at com.fightmymonster.rmi.monsters.GetMonster.doWork(GetMonster.java:25) &lt;span class=&quot;error&quot;&gt;&amp;#91;fmmServer.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.wyki.networking.starburst.SyncRmiOperation.run(SyncRmiOperation.java:50) &lt;span class=&quot;error&quot;&gt;&amp;#91;fmmServer.jar:na&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) &lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.6.0_22&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) &lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.6.0_22&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662) &lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.6.0_22&amp;#93;&lt;/span&gt;&lt;br/&gt;
Caused by: java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
        at java.net.SocketInputStream.socketRead0(Native Method) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.6.0_22&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.net.SocketInputStream.read(SocketInputStream.java:129) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.6.0_22&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:127) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;libthrift-0.6.1.jar:0.6.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        ... 23 common frames omitted&lt;/p&gt;</comment>
                            <comment id="13164524" author="slebresne" created="Wed, 7 Dec 2011 17:07:14 +0000"  >&lt;p&gt;This is due to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3440&quot; title=&quot;local writes timing out cause attempt to hint to self&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3440&quot;&gt;&lt;del&gt;CASSANDRA-3440&lt;/del&gt;&lt;/a&gt;. More precisely, the fact that in RowRepairResolver it has changed the message from the mutation verb to the read_repair one. The problem is that ReadRepairVerbHandler does not respond anything, but the RowRepairResolver is waiting for a response.&lt;/p&gt;

&lt;p&gt;After looking, I haven&apos;t found any part of the code using the read_repair verb handler except for the RowRepairResolver (which would mean that before &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3440&quot; title=&quot;local writes timing out cause attempt to hint to self&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3440&quot;&gt;&lt;del&gt;CASSANDRA-3440&lt;/del&gt;&lt;/a&gt; it wasn&apos;t used at all, so it&apos;s worth having someone else double checking I didn&apos;t missed anything), so a simple fix is to make the ReadRepairVerbHandler return an acknowledgment. Attaching a patch for that.&lt;/p&gt;</comment>
                            <comment id="13164545" author="jbellis" created="Wed, 7 Dec 2011 17:29:41 +0000"  >&lt;p&gt;To be explicit: this only affects queries at CL &amp;gt; ONE.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I haven&apos;t found any part of the code using the read_repair verb handler except for the RowRepairResolver, which would mean that before &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3440&quot; title=&quot;local writes timing out cause attempt to hint to self&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3440&quot;&gt;&lt;del&gt;CASSANDRA-3440&lt;/del&gt;&lt;/a&gt; it wasn&apos;t used at all&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right, it was used for a while, then we switched to MUTATION Verb to get the reply for &quot;free&quot; when we changed StorageProxy to wait for repair acks, but we never cleared out the Verb or RRVH.&lt;/p&gt;

&lt;p&gt;+1 on the fix.&lt;/p&gt;</comment>
                            <comment id="13164551" author="slebresne" created="Wed, 7 Dec 2011 17:35:34 +0000"  >&lt;p&gt;Committed, thanks&lt;/p&gt;</comment>
                            <comment id="13169634" author="jalkanen" created="Wed, 14 Dec 2011 19:54:21 +0000"  >&lt;p&gt;Confirmed fixed in 1.0.6. Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12506485" name="3551.patch" size="1491" author="slebresne" created="Wed, 7 Dec 2011 17:07:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>219258</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0glav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94881</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>