<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:38:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5484] Support custom secondary indexes in CQL</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5484</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Through thrift users can add custom secondary indexes to the column metadata.&lt;/p&gt;

&lt;p&gt;The following syntax is used in PLSQL, and I think we could use something similar.&lt;/p&gt;

&lt;p&gt;CREATE INDEX &amp;lt;NAME&amp;gt; ON &amp;lt;TABLE&amp;gt; (&amp;lt;COLUMN&amp;gt;) [INDEXTYPE IS (&amp;lt;TYPENAME&amp;gt;) [PARAMETERS (&amp;lt;PARAM&amp;gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;, &amp;lt;PARAM&amp;gt;&amp;#93;&lt;/span&gt;)]&lt;/p&gt;</description>
                <environment></environment>
        <key id="12642817">CASSANDRA-5484</key>
            <summary>Support custom secondary indexes in CQL</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aleksey">Aleksey Yeschenko</assignee>
                                    <reporter username="bcoverston">Benjamin Coverston</reporter>
                        <labels>
                            <label>cql3</label>
                            <label>index</label>
                    </labels>
                <created>Tue, 16 Apr 2013 21:31:15 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:14 +0000</updated>
                            <resolved>Fri, 3 May 2013 16:41:45 +0000</resolved>
                                        <fixVersion>1.2.5</fixVersion>
                                    <component>Feature/2i Index</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="13633405" author="jbellis" created="Tue, 16 Apr 2013 21:39:59 +0000"  >&lt;p&gt;I have a mild preference for PostgreSQL syntax, which adds no additional keywords (we already have USING and WITH): &lt;/p&gt;

&lt;p&gt;&lt;tt&gt;CREATE INDEX &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;lt;name&amp;gt;&amp;#93;&lt;/span&gt; ON &amp;lt;table&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;USING &amp;lt;method&amp;gt;&amp;#93;&lt;/span&gt; (&amp;lt;columns&amp;gt;) &lt;span class=&quot;error&quot;&gt;&amp;#91;WITH &amp;lt;parameters&amp;gt;&amp;#93;&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="13633416" author="jbellis" created="Tue, 16 Apr 2013 21:45:34 +0000"  >&lt;p&gt;Actually if it wouldn&apos;t confuse the parser too much I&apos;d prefer no keyword at all for the index implementation: &lt;/p&gt;

&lt;p&gt;&lt;tt&gt;CREATE &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;lt;method&amp;gt;&amp;#93;&lt;/span&gt; INDEX &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;lt;name&amp;gt;&amp;#93;&lt;/span&gt; ON &amp;lt;table&amp;gt; (&amp;lt;columns&amp;gt;) &lt;span class=&quot;error&quot;&gt;&amp;#91;WITH &amp;lt;parameters&amp;gt;&amp;#93;&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="13633436" author="jbellis" created="Tue, 16 Apr 2013 21:53:48 +0000"  >&lt;p&gt;Let&apos;s also split out parameterization to another ticket &amp;#8211; I don&apos;t think we support that yet for any index type.&lt;/p&gt;</comment>
                            <comment id="13633442" author="bcoverston" created="Tue, 16 Apr 2013 21:57:21 +0000"  >&lt;p&gt;wfm&lt;/p&gt;</comment>
                            <comment id="13637918" author="slebresne" created="Mon, 22 Apr 2013 10:55:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;Let&apos;s also split out parameterization to another ticket &#8211; I don&apos;t think we support that yet for any index type.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Actually, I think we do need it here because that&apos;s the way we pass the class name for CUSTOM indexes. So I think this could look like:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;CREATE CUSTOM INDEX ON &amp;lt;table&amp;gt;(&amp;lt;column&amp;gt;) WITH class=&apos;MyCustomIndex&apos;; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;(I do note that thrift uses &apos;class_name&apos; in the index options, but for CQL3, using just &apos;class&apos; would be somewhat more coherent with the compaction strategy.&lt;/p&gt;

&lt;p&gt;I will also note that on the thrift side, we have 3 different IndexType: Keys, Composites and Custom. But for CQL3, I am not convinced that making the different between Keys and Composites is a good idea: CQL3 knows enough about the tables to know with one to use. In other words, I think the only &amp;lt;method&amp;gt; we should support here is &apos;CUSTOM&apos; (or nothing).&lt;/p&gt;

&lt;p&gt;And while in theory it is possible to create a KEYS index on a composite table on the thrift side, it&apos;s unclear whether it is useful or not for CQL3 and should be supported. So even if we do want to consider it, then I think that this part should be split to a separate ticket.&lt;/p&gt;</comment>
                            <comment id="13646244" author="iamaleksey" created="Wed, 1 May 2013 00:52:42 +0000"  >&lt;p&gt;I was going for&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;CREATE INDEX ON &amp;lt;table&amp;gt;(&amp;lt;column) WITH type = CUSTOM AND options = {&apos;class_name&apos;: &apos;MyCostomIndex&apos;, ...};
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to allow parametrization for KEYS/COMPOSITES index in the future, but I can&apos;t think of what we could actually want to parametrize with them, so scratch that. Let&apos;s only leave parametrization for CUSTOM.&lt;br/&gt;
But for the sake of consistency with CREATE KEYSPACE and compaction,compression,etc. options for CREATE TABLE, I&apos;d like options to be a map (and replace &apos;class_name&apos; key with &apos;class&apos; internally, also for consistency), e.g.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;CREATE INDEX ON &amp;lt;table&amp;gt;(&amp;lt;column&amp;gt;) WITH options = {&apos;class&apos;: &apos;MyCustomIndex&apos;,...}; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Not sure about CREATE CUSTOM INDEX vs. just treating CREATE INDEX with non-null options as custom, implicitly. I believe that every time we add a keyword to CQL, even an unreserved one, a kitten dies somewhere, so I&apos;d like to avoid doing that.&lt;/p&gt;</comment>
                            <comment id="13646445" author="slebresne" created="Wed, 1 May 2013 07:48:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;d like options to be a map (and replace &apos;class_name&apos; key with &apos;class&apos; internally, also for consistency)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Make sense to me.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;just treating CREATE INDEX with non-null options as custom, implicitly&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That would work now, but that slightly frighten me for the future because:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;what if we add some other type of non custom indexes, like say bitmap indexes.&lt;/li&gt;
	&lt;li&gt;what if we want to add options for non custom indexes (while this is nice to avoid option when we can, it&apos;s not hard to imagine that future improvements to the 2ndary index code might require tweaking knobs for instance).&lt;/li&gt;
&lt;/ul&gt;


&lt;blockquote&gt;&lt;p&gt;every time we add a keyword to CQL, even an unreserved one, a kitten dies somewhere&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree we should avoid new keyword when possible. But that being said, when we add unreserved ones I think there is no real downside for clients. Yes it add some marginal delta to the parser and it&apos;s definitively sad for the kitten, but typically I&apos;m not sold that it&apos;s worth taking the risk of being blocked if we want to add options to non-custom index later just to avoid adding an unreserved keyword now.&lt;/p&gt;
</comment>
                            <comment id="13646535" author="iamaleksey" created="Wed, 1 May 2013 12:40:32 +0000"  >&lt;p&gt;Makes sense.&lt;/p&gt;</comment>
                            <comment id="13648070" author="iamaleksey" created="Fri, 3 May 2013 00:52:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/iamaleksey/cassandra/compare/5484&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/iamaleksey/cassandra/compare/5484&lt;/a&gt; (&lt;a href=&quot;https://github.com/iamaleksey/cassandra/compare/5484.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/iamaleksey/cassandra/compare/5484.patch&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Also refactored CreateIndexStatement to split validation into validate() instead of the mess in announceMigration().&lt;/p&gt;

&lt;p&gt;Once this has been reviewed, but before resolving the issue, will need to:&lt;br/&gt;
1. Write a dtest&lt;br/&gt;
2. Update cqlsh completion&lt;br/&gt;
3. Update NEWS + cql docs&lt;/p&gt;</comment>
                            <comment id="13648424" author="slebresne" created="Fri, 3 May 2013 14:02:43 +0000"  >&lt;p&gt;lgtm, +1&lt;/p&gt;</comment>
                            <comment id="13648550" author="iamaleksey" created="Fri, 3 May 2013 16:41:46 +0000"  >&lt;p&gt;Committed, thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12545732">CASSANDRA-4027</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323231</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 29 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jrnj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323576</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>