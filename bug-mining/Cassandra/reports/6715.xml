<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:33:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-20054] Get Harry working on top of Accord and fix various issues found by TopologyMixupTestBase</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-20054</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;TopologyMixupTestBase has been useful at finding a lot of unexpected issues, and adding Harry on top of Accord at this layer should help validate Accord correctness while also testing stability.&lt;/p&gt;

&lt;p&gt;In running these tests several bugs were found&lt;/p&gt;

&lt;p&gt;1) vtable showing what txn are blocking the queried table would throw error when txn isn&#8217;t known, which is valid (report historic transaction&#8230;)&lt;br/&gt;
2) AccordCommandStore submitted sync requests in a blocking manner, but did this on a CommandStore&#8230; this lead to a 5 minute deadlock&lt;br/&gt;
3) MajorityDepsFetcher would have a deadlock as it triggers waiting notifications while holding the lock, and the waiting callers then access more locks, such as the config service lock&lt;br/&gt;
4) when restarting and learning about removed nodes, AccordService is not setup yet, so need to pass this through to avoid startup issues&lt;br/&gt;
5) When accord asks TCM for the epoch history, there were no retries which would cause stability issues during startup&lt;br/&gt;
6) when learning about min epochs needed for startup, purge all starting epochs that are empty as it isn&#8217;t needed and only adds costs for startup&lt;br/&gt;
7) when nodes leave the cluster we did not start durability sync (this isn&#8217;t working, but thats a different issue&#8230; durability sync requires ALL which isn&#8217;t possible)&lt;br/&gt;
8) TCM&#8217;s getLogEntries method hit an edge case with snapshots where it assumed the API was inclusive, but its exclusive; this caused a gap in epochs&lt;br/&gt;
9) JVM Dtest now supports startup timeouts, this is to avoid issues where startup will take infinity (due to bugs) causing CI to throw away the logs.&lt;br/&gt;
10) fixed a race condition bug in Harry where the TokenPlacementModel could see a partial row causing NPEs down the line&lt;br/&gt;
11) Fixed a bug in Harry where Accord timeouts would not retry as they don&#8217;t have the expected message&lt;/p&gt;</description>
                <environment></environment>
        <key id="13597675">CASSANDRA-20054</key>
            <summary>Get Harry working on top of Accord and fix various issues found by TopologyMixupTestBase</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dcapwell">David Capwell</assignee>
                                    <reporter username="dcapwell">David Capwell</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Nov 2024 21:20:58 +0000</created>
                <updated>Wed, 6 Nov 2024 19:17:44 +0000</updated>
                            <resolved>Wed, 6 Nov 2024 19:01:35 +0000</resolved>
                                        <fixVersion>NA</fixVersion>
                                    <component>Accord</component>
                    <component>Test/fuzz</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17896064" author="dcapwell" created="Wed, 6 Nov 2024 18:54:14 +0000"  >&lt;p&gt;+1 from Alex in GH and Slack&lt;/p&gt;</comment>
                            <comment id="17896071" author="dcapwell" created="Wed, 6 Nov 2024 19:17:44 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Repo&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Parent Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;SHA&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Status&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;https://github.com/dcapwell/cassandra.git&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-20054&quot; title=&quot;Get Harry working on top of Accord and fix various issues found by TopologyMixupTestBase&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-20054&quot;&gt;&lt;del&gt;CASSANDRA-20054&lt;/del&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;trunk&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;ce7c64ccd6083c2f01d8bc0fead10846444be943&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Unstable&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Failed Builds:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Build&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Result&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Reason&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; dependency_check    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Found 1 vulnerable dependencies                                                                      &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; jvm-dtest-simulator &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Test org.apache.cassandra.simulator.test.HarrySimulatorTest::test-_jdk11 had an error,Test org.apach &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; jvm-upgrade-dtests  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Test org.apache.cassandra.distributed.upgrade.MixedModeFrom3ReplicationTest::testSimpleStrategy-_jdk &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; jvm11-dtests        &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Test org.apache.cassandra.distributed.test.accord.AccordBootstrapTest::bootstrapTest-_jdk11 failed,T &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; jvm11-dtests-fuzz   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Test org.apache.cassandra.fuzz.topology.AccordTopologyMixupTest::test-_jdk11 failed                  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; jvm11-utests        &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Test org.apache.cassandra.cql3.RandomSchemaV2Test::test-_jdk11 failed,Test org.apache.cassandra.db.c &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; jvm17-dtests        &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Test org.apache.cassandra.distributed.test.accord.AccordBootstrapTest::bootstrapTest-_jdk17 failed,T &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; jvm17-dtests-fuzz   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Test org.apache.cassandra.fuzz.topology.AccordTopologyMixupTest::test-_jdk17 failed,Test org.apache. &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; jvm17-utests        &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Test org.apache.cassandra.cql3.RandomSchemaV2Test::test-_jdk17 failed,Test org.apache.cassandra.db.c &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; python-dtests       &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Test cqlsh_tests.test_cqlsh.TestCqlsh::cqlsh_tests.py::test_cqlsh::test_describe failed,Test cqlsh_t &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; python-dtests-large &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; fail &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Test materialized_views_test.TestMaterializedViews::materialized_views_test.py::TestMaterializedView &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;




&lt;p&gt;These are failing on cep-15-accord before the merge, so ignoring for now... will try to get tests closer to 0 in follow up work&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13072667" name="ci_summary-trunk-ce7c64ccd6083c2f01d8bc0fead10846444be943.html" size="1505329" author="dcapwell" created="Wed, 6 Nov 2024 19:16:38 +0000"/>
                            <attachment id="13072668" name="result_details-trunk-ce7c64ccd6083c2f01d8bc0fead10846444be943.tar.gz" size="11227156" author="dcapwell" created="Wed, 6 Nov 2024 19:16:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[dcapwell]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="13161" cascade-level="1"><![CDATA[Unrecoverable Corruption / Loss]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12972"><![CDATA[Fuzz Test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1sdcw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348835">NA</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/9b8c57db468481060caa68a8299f5e8cc6048b31&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/9b8c57db468481060caa68a8299f5e8cc6048b31&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;new tests&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>