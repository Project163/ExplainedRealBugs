<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:00:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10961] Not enough bytes error when add nodes to cluster</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10961</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;we got the same problem all the time when we add nodes to cluster.&lt;/p&gt;

&lt;p&gt;netstats:&lt;br/&gt;
on HostA&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;/la-38395-big-Data.db 14792091851/14792091851 bytes(100%) sent to idx:0/HostB
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;on HostB&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;tmp-la-4-big-Data.db 2667087450/14792091851 bytes(18%) received from idx:0/HostA
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After a while, Error on HostB&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;WARN  [STREAM-IN-/HostA] 2016-01-02 12:08:14,737 StreamSession.java:644 - [Stream #b91a4e90-b105-11e5-bd57-dd0cc3b4634c] Retrying for following error
java.lang.IllegalArgumentException: Not enough bytes
        at org.apache.cassandra.db.composites.AbstractCType.checkRemaining(AbstractCType.java:362) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.db.composites.AbstractCompoundCellNameType.fromByteBuffer(AbstractCompoundCellNameType.java:98) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.db.composites.AbstractCType$Serializer.deserialize(AbstractCType.java:381) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.db.composites.AbstractCType$Serializer.deserialize(AbstractCType.java:365) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.db.OnDiskAtom$Serializer.deserializeFromSSTable(OnDiskAtom.java:75) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.db.AbstractCell$1.computeNext(AbstractCell.java:52) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.db.AbstractCell$1.computeNext(AbstractCell.java:46) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:143) ~[guava-16.0.jar:na]
        at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:138) ~[guava-16.0.jar:na]
        at org.apache.cassandra.io.sstable.format.big.BigTableWriter.appendFromStream(BigTableWriter.java:243) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.StreamReader.writeRow(StreamReader.java:173) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.compress.CompressedStreamReader.read(CompressedStreamReader.java:95) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.IncomingFileMessage$1.deserialize(IncomingFileMessage.java:49) [apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.IncomingFileMessage$1.deserialize(IncomingFileMessage.java:38) [apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.StreamMessage.deserialize(StreamMessage.java:58) [apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.ConnectionHandler$IncomingMessageHandler.run(ConnectionHandler.java:261) [apache-cassandra-2.2.4.jar:2.2.4]
        at java.lang.Thread.run(Thread.java:745) [na:1.8.0_66-internal]
ERROR [Thread-28] 2016-01-02 12:08:14,737 CassandraDaemon.java:185 - Exception in thread Thread[Thread-28,5,main]
java.lang.RuntimeException: java.lang.InterruptedException
        at com.google.common.base.Throwables.propagate(Throwables.java:160) ~[guava-16.0.jar:na]
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:32) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at java.lang.Thread.run(Thread.java:745) ~[na:1.8.0_66-internal]
Caused by: java.lang.InterruptedException: null
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireInterruptibly(AbstractQueuedSynchronizer.java:1220) ~[na:1.8.0_66-internal]
        at java.util.concurrent.locks.ReentrantLock.lockInterruptibly(ReentrantLock.java:335) ~[na:1.8.0_66-internal]
        at java.util.concurrent.ArrayBlockingQueue.put(ArrayBlockingQueue.java:350) ~[na:1.8.0_66-internal]
        at org.apache.cassandra.streaming.compress.CompressedInputStream$Reader.runMayThrow(CompressedInputStream.java:176) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28) ~[apache-cassandra-2.2.4.jar:2.2.4]
        ... 1 common frames omitted
ERROR [STREAM-IN-/HostA] 2016-01-02 12:08:14,737 StreamSession.java:524 - [Stream #b91a4e90-b105-11e5-bd57-dd0cc3b4634c] Streaming error occurred
java.nio.channels.ClosedChannelException: null
        at sun.nio.ch.SocketChannelImpl.ensureReadOpen(SocketChannelImpl.java:257) ~[na:1.8.0_66-internal]
        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:300) ~[na:1.8.0_66-internal]
        at org.apache.cassandra.streaming.messages.StreamMessage.deserialize(StreamMessage.java:53) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.ConnectionHandler$IncomingMessageHandler.run(ConnectionHandler.java:261) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at java.lang.Thread.run(Thread.java:745) [na:1.8.0_66-internal]
INFO  [STREAM-IN-/HostA] 2016-01-02 12:08:15,875 StreamResultFuture.java:182 - [Stream #b91a4e90-b105-11e5-bd57-dd0cc3b4634c] Session with /HostA is complete
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Errors on HostA&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;WARN  [STREAM-IN-/HostB] 2016-01-02 12:08:14,763 StreamResultFuture.java:209 - [Stream #b91a4e90-b105-11e5-bd57-dd0cc3b4634c] Stream failed
ERROR [STREAM-OUT-/HostB] 2016-01-02 12:08:14,777 StreamSession.java:524 - [Stream #b91a4e90-b105-11e5-bd57-dd0cc3b4634c] Streaming error occurred
org.apache.cassandra.io.FSReadError: java.io.IOException: Broken pipe
        at org.apache.cassandra.io.util.ChannelProxy.transferTo(ChannelProxy.java:144) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.compress.CompressedStreamWriter$1.apply(CompressedStreamWriter.java:79) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.compress.CompressedStreamWriter$1.apply(CompressedStreamWriter.java:76) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.io.util.BufferedDataOutputStreamPlus.applyToChannel(BufferedDataOutputStreamPlus.java:297) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.compress.CompressedStreamWriter.write(CompressedStreamWriter.java:75) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.OutgoingFileMessage.serialize(OutgoingFileMessage.java:90) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.OutgoingFileMessage$1.serialize(OutgoingFileMessage.java:48) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.OutgoingFileMessage$1.serialize(OutgoingFileMessage.java:40) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.StreamMessage.serialize(StreamMessage.java:47) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.ConnectionHandler$OutgoingMessageHandler.sendMessage(ConnectionHandler.java:363) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.ConnectionHandler$OutgoingMessageHandler.run(ConnectionHandler.java:335) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at java.lang.Thread.run(Thread.java:745) [na:1.8.0_66-internal]
Caused by: java.io.IOException: Broken pipe
        at sun.nio.ch.FileChannelImpl.transferTo0(Native Method) ~[na:1.8.0_66-internal]
        at sun.nio.ch.FileChannelImpl.transferToDirectlyInternal(FileChannelImpl.java:427) ~[na:1.8.0_66-internal]
        at sun.nio.ch.FileChannelImpl.transferToDirectly(FileChannelImpl.java:492) ~[na:1.8.0_66-internal]
        at sun.nio.ch.FileChannelImpl.transferTo(FileChannelImpl.java:607) ~[na:1.8.0_66-internal]
        at org.apache.cassandra.io.util.ChannelProxy.transferTo(ChannelProxy.java:140) ~[apache-cassandra-2.2.4.jar:2.2.4]
        ... 11 common frames omitted
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12925222">CASSANDRA-10961</key>
            <summary>Not enough bytes error when add nodes to cluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pauloricardomg">Paulo Motta</assignee>
                                    <reporter username="xiaost">xiaost</reporter>
                        <labels>
                    </labels>
                <created>Sat, 2 Jan 2016 12:25:31 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:46 +0000</updated>
                            <resolved>Wed, 13 Jan 2016 19:18:15 +0000</resolved>
                                        <fixVersion>2.1.13</fixVersion>
                    <fixVersion>2.2.5</fixVersion>
                    <fixVersion>3.0.3</fixVersion>
                    <fixVersion>3.3</fixVersion>
                                    <component>Legacy/Streaming and Messaging</component>
                        <due></due>
                            <votes>5</votes>
                                    <watches>21</watches>
                                                                                                                <comments>
                            <comment id="15076732" author="jack doo" created="Sun, 3 Jan 2016 00:42:30 +0000"  >&lt;p&gt;I also have problem with add node to cluster in 2.2.4&lt;/p&gt;

&lt;p&gt;HostB joining cluster and immediate get error&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ERROR [STREAM-IN-/HostA] 2016-01-03 00:21:04,741 StreamSession.java:524 - [Stream #d5c419e0-b1af-11e5-9c1e-b5506ad414a4] Streaming error occurred
java.nio.channels.ClosedChannelException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
        at sun.nio.ch.SocketChannelImpl.ensureReadOpen(SocketChannelImpl.java:257) ~[na:1.8.0_65]
        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:300) ~[na:1.8.0_65]
        at org.apache.cassandra.streaming.messages.StreamMessage.deserialize(StreamMessage.java:53) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.ConnectionHandler$IncomingMessageHandler.run(ConnectionHandler.java:261) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_65]
DEBUG [STREAM-OUT-/HostA] 2016-01-03 00:21:04,741 ConnectionHandler.java:334 - [Stream #d5c419e0-b1af-11e5-9c1e-b5506ad414a4] Sending Session Failed
ERROR [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-5] 2016-01-03 00:21:04,741 CassandraDaemon.java:185 - Exception in thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-5,5,main]
java.lang.RuntimeException: java.lang.InterruptedException
        at com.google.common.base.Throwables.propagate(Throwables.java:160) ~[guava-16.0.jar:na]
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:32) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) ~[na:1.8.0_65]
Caused by: java.lang.InterruptedException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireInterruptibly(AbstractQueuedSynchronizer.java:1220) ~[na:1.8.0_65]
        at java.util.concurrent.locks.ReentrantLock.lockInterruptibly(ReentrantLock.java:335) ~[na:1.8.0_65]
        at java.util.concurrent.ArrayBlockingQueue.put(ArrayBlockingQueue.java:350) ~[na:1.8.0_65]
        at org.apache.cassandra.streaming.compress.CompressedInputStream$Reader.runMayThrow(CompressedInputStream.java:176) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28) ~[apache-cassandra-2.2.4.jar:2.2.4]
        ... 1 common frames omitted
DEBUG [STREAM-IN-/HostA] 2016-01-03 00:21:04,777 ConnectionHandler.java:110 - [Stream #d5c419e0-b1af-11e5-9c1e-b5506ad414a4] Closing stream connection handler on /HostA
INFO  [STREAM-IN-/HostA] 2016-01-03 00:21:04,777 StreamResultFuture.java:182 - [Stream #d5c419e0-b1af-11e5-9c1e-b5506ad414a4] Session with /HostA is complete
WARN  [STREAM-IN-/HostA] 2016-01-03 00:21:04,778 StreamResultFuture.java:209 - [Stream #d5c419e0-b1af-11e5-9c1e-b5506ad414a4] Stream failed
ERROR [main] 2016-01-03 00:21:04,780 StorageService.java:1245 - Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; waiting on bootstrap to complete. Bootstrap will have to be restarted.
java.util.concurrent.ExecutionException: org.apache.cassandra.streaming.StreamException: Stream failed
        at com.google.common.util.concurrent.AbstractFuture$Sync.getValue(AbstractFuture.java:299) ~[guava-16.0.jar:na]
        at com.google.common.util.concurrent.AbstractFuture$Sync.get(AbstractFuture.java:286) ~[guava-16.0.jar:na]
        at com.google.common.util.concurrent.AbstractFuture.get(AbstractFuture.java:116) ~[guava-16.0.jar:na]
        at org.apache.cassandra.service.StorageService.bootstrap(StorageService.java:1240) [apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.service.StorageService.joinTokenRing(StorageService.java:920) [apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.service.StorageService.initServer(StorageService.java:705) [apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.service.StorageService.initServer(StorageService.java:581) [apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:315) [apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:529) [apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:638) [apache-cassandra-2.2.4.jar:2.2.4]
Caused by: org.apache.cassandra.streaming.StreamException: Stream failed
        at org.apache.cassandra.streaming.management.StreamEventJMXNotifier.onFailure(StreamEventJMXNotifier.java:85) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at com.google.common.util.concurrent.Futures$4.run(Futures.java:1172) ~[guava-16.0.jar:na]
        at com.google.common.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:297) ~[guava-16.0.jar:na]
        at com.google.common.util.concurrent.ExecutionList.executeListener(ExecutionList.java:156) ~[guava-16.0.jar:na]
        at com.google.common.util.concurrent.ExecutionList.execute(ExecutionList.java:145) ~[guava-16.0.jar:na]
        at com.google.common.util.concurrent.AbstractFuture.setException(AbstractFuture.java:202) ~[guava-16.0.jar:na]
        at org.apache.cassandra.streaming.StreamResultFuture.maybeComplete(StreamResultFuture.java:210) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.StreamResultFuture.handleSessionComplete(StreamResultFuture.java:186) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.StreamSession.closeSession(StreamSession.java:434) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.StreamSession.onError(StreamSession.java:529) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.ConnectionHandler$IncomingMessageHandler.run(ConnectionHandler.java:279) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) ~[na:1.8.0_65]
WARN  [main] 2016-01-03 00:21:04,785 StorageService.java:975 - Some data streaming failed. Use nodetool to check bootstrap state and resume. For more, see `nodetool help bootstrap`. IN_PROGRESS
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Error on hostA&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [STREAM-OUT-/HostB] 2016-01-03 00:21:05,085 StreamSession.java:524 - [Stream #d5c419e0-b1af-11e5-9c1e-b5506ad414a4] Streaming error occurred
org.apache.cassandra.io.FSReadError: java.io.IOException: Broken pipe
        at org.apache.cassandra.io.util.ChannelProxy.transferTo(ChannelProxy.java:144) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.compress.CompressedStreamWriter$1.apply(CompressedStreamWriter.java:79) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.compress.CompressedStreamWriter$1.apply(CompressedStreamWriter.java:76) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.io.util.BufferedDataOutputStreamPlus.applyToChannel(BufferedDataOutputStreamPlus.java:297) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.compress.CompressedStreamWriter.write(CompressedStreamWriter.java:75) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.OutgoingFileMessage.serialize(OutgoingFileMessage.java:90) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.OutgoingFileMessage$1.serialize(OutgoingFileMessage.java:48) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.OutgoingFileMessage$1.serialize(OutgoingFileMessage.java:40) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.messages.StreamMessage.serialize(StreamMessage.java:47) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.ConnectionHandler$OutgoingMessageHandler.sendMessage(ConnectionHandler.java:363) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at org.apache.cassandra.streaming.ConnectionHandler$OutgoingMessageHandler.run(ConnectionHandler.java:335) ~[apache-cassandra-2.2.4.jar:2.2.4]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_65]
Caused by: java.io.IOException: Broken pipe
        at sun.nio.ch.FileChannelImpl.transferTo0(Native Method) ~[na:1.8.0_65]
        at sun.nio.ch.FileChannelImpl.transferToDirectlyInternal(FileChannelImpl.java:427) ~[na:1.8.0_65]
        at sun.nio.ch.FileChannelImpl.transferToDirectly(FileChannelImpl.java:492) ~[na:1.8.0_65]
        at sun.nio.ch.FileChannelImpl.transferTo(FileChannelImpl.java:607) ~[na:1.8.0_65]
        at org.apache.cassandra.io.util.ChannelProxy.transferTo(ChannelProxy.java:140) ~[apache-cassandra-2.2.4.jar:2.2.4]
        ... 11 common frames omitted
INFO  [STREAM-IN-/HostB] 2016-01-03 00:21:05,085 StreamResultFuture.java:182 - [Stream #d5c419e0-b1af-11e5-9c1e-b5506ad414a4] Session with /HostB is complete
WARN  [STREAM-IN-/HostB] 2016-01-03 00:21:05,086 StreamResultFuture.java:209 - [Stream #d5c419e0-b1af-11e5-9c1e-b5506ad414a4] Stream failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On stackoverflow other people also report problems&lt;br/&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/34551975/broken-pipe-when-bootstrapping-or-repair-node&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/34551975/broken-pipe-when-bootstrapping-or-repair-node&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/34555653/cassandra-bootstrap-fail-with-streaming-error-occurred&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/34555653/cassandra-bootstrap-fail-with-streaming-error-occurred&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15080970" author="slebresne" created="Mon, 4 Jan 2016 10:39:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xiaost&quot; class=&quot;user-hover&quot; rel=&quot;xiaost&quot;&gt;xiaost&lt;/a&gt; I suspect we&apos;ll need more info to track the underlying problem. &lt;/p&gt;

&lt;p&gt;At least a confirmation of which node is the added one (I strongly suspect HostB but can&apos;t hurt to be sure) and the schema of the table for which this happen might give some clue. And when you say &quot;all the time&quot;, could you elaborate on how many time we&apos;re talking here, as well as whether the error always happen for the same table?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Jack+Doo&quot; class=&quot;user-hover&quot; rel=&quot;Jack Doo&quot;&gt;Jack Doo&lt;/a&gt; as far as I can tell from your trace, this is not the same error (you don&apos;t have the &lt;tt&gt;IllegalArgumentException: Not enough bytes&lt;/tt&gt; which is indicative of a server side bug) and from what you posted, this might be a network problem. In any case, tracking 2 different problems on the same ticket will be confusing so if you can reproduce your own problem, please open a separate ticket.&lt;/p&gt;</comment>
                            <comment id="15080995" author="xiaost" created="Mon, 4 Jan 2016 11:04:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;the node receiving data is the added one. &lt;br/&gt;
we only have one table in the cluster &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
I tried to add node to the cluster  but failed with the errors above and I kill the process.  &lt;br/&gt;
the progress seems always sucks in streaming file which larger than 10GB &lt;br/&gt;
(after abort 4~5 times?) &lt;br/&gt;
I use&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;nodetool bootstrap resume&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to resume the bootstrap, but it failed and logs like the other issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10448&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-10448&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;the cluster now have 3 nodes(UN status) with abort 600GB*3 data on HDD*3, and one node(UJ status) with ~1GB load&lt;/p&gt;</comment>
                            <comment id="15081042" author="slebresne" created="Mon, 4 Jan 2016 11:41:02 +0000"  >&lt;p&gt;Thanks for the info. The &lt;tt&gt;IllegalArgumentException&lt;/tt&gt; means that either the comparator on the new node is wrong, or the data streamed has a problem. Given that you don&apos;t get errors while reading data on the nodes, it&apos;s unlikely the original sstable that is corrupted so it might be something streaming specific. Especially since &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10448&quot; title=&quot;&amp;quot;Unknown type 0&amp;quot; Stream failure on Repair&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10448&quot;&gt;&lt;del&gt;CASSANDRA-10448&lt;/del&gt;&lt;/a&gt; suggests there is something wrong with streaming in 2.2. In fact, if streaming was somewhat corrupting data while streaming, that would explain both this and the different stacks found on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10448&quot; title=&quot;&amp;quot;Unknown type 0&amp;quot; Stream failure on Repair&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10448&quot;&gt;&lt;del&gt;CASSANDRA-10448&lt;/del&gt;&lt;/a&gt; so this might all be the same problem. We&apos;ll have someone investigate, but any info that could help reproducing would be really helpful.&lt;/p&gt;</comment>
                            <comment id="15081060" author="pauloricardomg" created="Mon, 4 Jan 2016 12:00:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xiaost&quot; class=&quot;user-hover&quot; rel=&quot;xiaost&quot;&gt;xiaost&lt;/a&gt; can you please try reproducing the issue replacing your cassandra 2.2.4 jar with this  &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12776132/apache-cassandra-2.2.4-SNAPSHOT.jar&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;modified jar&lt;/a&gt;, that contains more detailed debug logging? If you prefer to build your own jar, you can clone &lt;a href=&quot;https://github.com/pauloricardomg/cassandra/tree/2.2-10488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this branch&lt;/a&gt; and run &lt;tt&gt;ant jar&lt;/tt&gt; to generate the jar.&lt;/p&gt;

&lt;p&gt;Please attach the debug.log of source and destination nodes after replacing the jar and reproducing the issue so we can investigate it. Thanks!&lt;/p&gt;</comment>
                            <comment id="15081206" author="xiaost" created="Mon, 4 Jan 2016 14:28:11 +0000"  >&lt;p&gt;progress is stuck now &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I will give more informations later&lt;/p&gt;</comment>
                            <comment id="15081243" author="xiaost" created="Mon, 4 Jan 2016 15:03:13 +0000"  >&lt;p&gt;reproduced. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12780321/12780321_debug.1.log&quot; title=&quot;debug.1.log attached to CASSANDRA-10961&quot;&gt;debug.1.log&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12780322/12780322_netstats.1.log&quot; title=&quot;netstats.1.log attached to CASSANDRA-10961&quot;&gt;netstats.1.log&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="15082649" author="pauloricardomg" created="Tue, 5 Jan 2016 08:41:15 +0000"  >&lt;p&gt;Please also attach debug.log of nodes .12, .13 and .14.&lt;/p&gt;</comment>
                            <comment id="15083423" author="xiaost" created="Tue, 5 Jan 2016 17:33:43 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12780582/12780582_debug.logs.zip&quot; title=&quot;debug.logs.zip attached to CASSANDRA-10961&quot;&gt;debug.logs.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; all in one &lt;/p&gt;</comment>
                            <comment id="15083459" author="xiaost" created="Tue, 5 Jan 2016 17:54:24 +0000"  >&lt;p&gt;BTW, I had ran &lt;tt&gt;nodetool scrub&lt;/tt&gt; on every nodes before debugging.&lt;/p&gt;</comment>
                            <comment id="15086533" author="pauloricardomg" created="Wed, 6 Jan 2016 23:57:34 +0000"  >&lt;p&gt;There seems to be more than one problem here. This might be a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10005&quot; title=&quot;Streaming not enough bytes error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10005&quot;&gt;&lt;del&gt;CASSANDRA-10005&lt;/del&gt;&lt;/a&gt;, some problem in the ser/des of AbstractCompoundCellNameType on 2.2. Furthermore, the proposed workaround on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10012&quot; title=&quot;Deadlock when session streaming is retried after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10012&quot;&gt;&lt;del&gt;CASSANDRA-10012&lt;/del&gt;&lt;/a&gt; might be closing the socket channel when interrupting the compressed input reader thread, what is also making retry fail + throwing uncatched InterruptedException. I&apos;m still investigating the issue and will propose a solution as soon as I have a better understanding.&lt;/p&gt;</comment>
                            <comment id="15088039" author="pauloricardomg" created="Thu, 7 Jan 2016 20:19:16 +0000"  >&lt;p&gt;I might have found the culprit on &lt;tt&gt;CompressedStreamReader&lt;/tt&gt;, in this snippet:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;int sectionLength = (int) (section.right - section.left);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This might cause sections larger than 2.14GB to have negative length due to &lt;tt&gt;int&lt;/tt&gt; overflow and be skipped, what may break deserealization of next sections. I changed to use &lt;tt&gt;long&lt;/tt&gt; type instead.&lt;/p&gt;

&lt;p&gt;I also reverted &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10005&quot; title=&quot;Streaming not enough bytes error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10005&quot;&gt;&lt;del&gt;CASSANDRA-10005&lt;/del&gt;&lt;/a&gt;, since interrupting a thread waiting on a &lt;tt&gt;SocketChannel&lt;/tt&gt; will cause the channel to be closed what will make retry fail.&lt;/p&gt;

&lt;p&gt;Furthermore I added more debugging statements, so in case this is not the problem we will have more elements to investigate further. If that&apos;s the case, please attach new debug logs in the next run.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xiaost&quot; class=&quot;user-hover&quot; rel=&quot;xiaost&quot;&gt;xiaost&lt;/a&gt; I attached a new &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12781053/apache-cassandra-2.2.4-SNAPSHOT.jar&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;jar&lt;/a&gt; that you can test, and in case you want to build your own you can do it from this &lt;a href=&quot;https://github.com/pauloricardomg/cassandra/tree/2.2-10961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15088654" author="xiaost" created="Fri, 8 Jan 2016 03:49:39 +0000"  >&lt;p&gt;wonderful! I will test it ASAP. &lt;/p&gt;</comment>
                            <comment id="15088801" author="xiaost" created="Fri, 8 Jan 2016 07:00:07 +0000"  >&lt;p&gt;It works!  &lt;/p&gt;

&lt;p&gt;over 500GB streaming data is received without any error.&lt;/p&gt;

&lt;p&gt;hope release in 2.2.5 soon&lt;/p&gt;

&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="15088843" author="juliano.vidal" created="Fri, 8 Jan 2016 07:42:34 +0000"  >&lt;p&gt;Shall we use this snapshot jar while waiting.for 2.2.5?&lt;br/&gt;
When is it going to be released?&lt;/p&gt;</comment>
                            <comment id="15088931" author="zjumty" created="Fri, 8 Jan 2016 09:07:20 +0000"  >&lt;p&gt;hi xiaost&lt;br/&gt;
I replace the patched jar on new bootstrap node, but got the same error. &lt;br/&gt;
do I need to replace jar on all nodes?&lt;/p&gt;</comment>
                            <comment id="15089157" author="pauloricardomg" created="Fri, 8 Jan 2016 12:41:47 +0000"  >&lt;p&gt;Replacing the patched jar on the new node should suffice. Are you still getting the same &lt;tt&gt;java.lang.IllegalArgumentException: Not enough bytes&lt;/tt&gt; error?&lt;/p&gt;

&lt;p&gt;Please try scrubbing your data before as it may genuinely be some corrupted data. If it still doesn&apos;t work please attach debug.log of source and destination nodes.&lt;/p&gt;</comment>
                            <comment id="15089161" author="pauloricardomg" created="Fri, 8 Jan 2016 12:44:10 +0000"  >&lt;p&gt;There is no official forecast yet but I think it should be released in the next month or so. Use the patched jar in new nodes until then.&lt;/p&gt;</comment>
                            <comment id="15089573" author="pauloricardomg" created="Fri, 8 Jan 2016 17:35:41 +0000"  >&lt;p&gt;Created 2.2 patch with following changes:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Fix bug by changing &lt;tt&gt;sectionLength&lt;/tt&gt; variable type from &lt;tt&gt;int&lt;/tt&gt; to &lt;tt&gt;long&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Revert &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10012&quot; title=&quot;Deadlock when session streaming is retried after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10012&quot;&gt;&lt;del&gt;CASSANDRA-10012&lt;/del&gt;&lt;/a&gt; (&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10005&quot; title=&quot;Streaming not enough bytes error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10005&quot;&gt;&lt;del&gt;CASSANDRA-10005&lt;/del&gt;&lt;/a&gt;), since the deadlock was more a consequence rather than cause of this. The &lt;tt&gt;CompressedInputStream&lt;/tt&gt; &lt;tt&gt;Reader&lt;/tt&gt; thread does not need to be closed/stopped because it needs to be active in order to skip bytes on &lt;tt&gt;drain&lt;/tt&gt;. Furthermore, interrupting a thread waiting on a &lt;tt&gt;SocketChannel&lt;/tt&gt; will cause it to be closed, what will break the next retry attempt.&lt;/li&gt;
	&lt;li&gt;Add more debug log messages to help troubleshoot similar issues&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...pauloricardomg:2.2-10961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.2-10961-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.2-10961-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Will provide patches for other versions after first review. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt; mind reviewing? Thanks!&lt;/p&gt;
</comment>
                            <comment id="15090044" author="juliano.vidal" created="Fri, 8 Jan 2016 22:18:02 +0000"  >&lt;p&gt;It works!!!!&lt;br/&gt;
Just finished to join the 7th node on my existing cluster.&lt;/p&gt;

&lt;p&gt;Thanks all!!&lt;/p&gt;</comment>
                            <comment id="15090422" author="zjumty" created="Sat, 9 Jan 2016 05:05:53 +0000"  >&lt;p&gt;Yes, it works. my new node bootstraped well.  I got same error because of my mistake when replacing jar.&lt;br/&gt;
thank you.&lt;/p&gt;</comment>
                            <comment id="15092292" author="yukim" created="Mon, 11 Jan 2016 17:09:48 +0000"  >&lt;p&gt;Thanks Paulo.&lt;br/&gt;
Patch and tests look good. Can you go ahead and create branches for 3.0+?&lt;/p&gt;</comment>
                            <comment id="15092935" author="pauloricardomg" created="Mon, 11 Jan 2016 23:27:01 +0000"  >&lt;p&gt;Attached patches for 2.1, 2.2, 3.0, 3.3 and trunk.  There were merge conflicts on 3.0 and 3.3 (trunk merges fine from 3.3). I didn&apos;t squash commits to simplify potential conflict resolutions. Although the problem does not happen in 2.1, I added a 2.1 branch to revert &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10012&quot; title=&quot;Deadlock when session streaming is retried after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10012&quot;&gt;&lt;del&gt;CASSANDRA-10012&lt;/del&gt;&lt;/a&gt; and improve debug messages (commit at your own will).&lt;/p&gt;

&lt;p&gt;Test results will appear shortly below:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.3&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.1...pauloricardomg:2.1-10961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...pauloricardomg:2.2-10961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.0...pauloricardomg:3.0-10961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.3...pauloricardomg:3.3-10961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...pauloricardomg:trunk-10961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.1-10961-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.2-10961-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10961-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.3-10961-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-10961-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.1-10961-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-2.2-10961-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10961-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.3-10961-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-10961-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15096833" author="yukim" created="Wed, 13 Jan 2016 19:18:15 +0000"  >&lt;p&gt;Thanks, tests are all looks good to me.&lt;br/&gt;
Committed to 2.2+.&lt;/p&gt;</comment>
                            <comment id="15102176" author="pauloricardomg" created="Fri, 15 Jan 2016 17:48:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt; what do you think about committing this to 2.1 as well? I&apos;m afraid the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10012&quot; title=&quot;Deadlock when session streaming is retried after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10012&quot;&gt;&lt;del&gt;CASSANDRA-10012&lt;/del&gt;&lt;/a&gt; might be causing &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10992&quot; title=&quot;Hanging streaming sessions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10992&quot;&gt;&lt;del&gt;CASSANDRA-10992&lt;/del&gt;&lt;/a&gt; on 2.1, and if not, it may cause other issues due to early channel closing when closing the &lt;tt&gt;CompressedInputStream&lt;/tt&gt;, so I think it&apos;s important to revert that on 2.1 as well.&lt;/p&gt;</comment>
                            <comment id="15102241" author="yukim" created="Fri, 15 Jan 2016 18:23:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; Done committing your 2.1 patch to cassandra-2.1.&lt;/p&gt;</comment>
                            <comment id="15102480" author="pauloricardomg" created="Fri, 15 Jan 2016 21:23:12 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="15120088" author="zchen" created="Wed, 27 Jan 2016 20:08:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; &lt;br/&gt;
Is there patched jar for 2.2.3&lt;br/&gt;
I met the same issue in our cluster 2.2.3.&lt;br/&gt;
Thank you. &lt;/p&gt;</comment>
                            <comment id="15120090" author="pauloricardomg" created="Wed, 27 Jan 2016 20:11:06 +0000"  >&lt;p&gt;No, but you can cherry-pick the 2.2.5 commit on the 2.2.3 tag and build your own jar.&lt;/p&gt;

&lt;p&gt;If you don&apos;t want to do this you can wait for the 2.2.5 release which should be out soon.&lt;/p&gt;</comment>
                            <comment id="15133307" author="chernals" created="Thu, 4 Feb 2016 23:22:18 +0000"  >&lt;p&gt;I think I&apos;m facing the exact same problem with 3.2. I commissioned the new node with the 3.4-SNAPSHOT. Does it make sense to go back to 3.2 (installed with .rpm which my sysadmin prefers) and wait for 3.3 ? Or should I stick with the version that initially got the data from the other nodes?&lt;/p&gt;</comment>
                            <comment id="15133330" author="pauloricardomg" created="Thu, 4 Feb 2016 23:42:06 +0000"  >&lt;p&gt;officially downgrading is not supported, but afaik there aren&apos;t any major sstable/messaging changes between 3.2 and 3.4 so you might try downgrading to 3.2 in the bootstrapped node at your own risk (make sure to snapshot sstables/backup files before). otherwise your best bet is to remain with a mixed version cluster until 3.3 is out or replace the patched jar in the remaining nodes. You may review &lt;tt&gt;NEWS.txt&lt;/tt&gt; and &lt;tt&gt;CHANGES.txt&lt;/tt&gt; to see if there is any change between 3.2 and 3.4 that may cause problems with mixed versions/downgrading, otherwise you should be fine.&lt;/p&gt;</comment>
                            <comment id="15133404" author="chernals" created="Fri, 5 Feb 2016 00:26:48 +0000"  >&lt;p&gt;Ok, thanks for the input!&lt;/p&gt;</comment>
                            <comment id="15255604" author="wavelet" created="Sun, 24 Apr 2016 14:42:49 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
We are using Cassandra 2.1.9,and We are experiencing the same issue when adding a new node.Could you please advise where can I download the patch and how to apply the patch?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Peng Xiao&lt;/p&gt;</comment>
                            <comment id="15256494" author="pauloricardomg" created="Mon, 25 Apr 2016 15:43:12 +0000"  >&lt;p&gt;your easiest option is probably to upgrade to version &amp;gt;= 2.1.13 (version 2.1.14 should be out this week if you can wait a bit), since if you patch 2.1.9 manually you&apos;ll probably need to do a rolling restart anyway.&lt;/p&gt;

&lt;p&gt;if for some reason you can&apos;t upgrade, you&apos;ll need to cherry-pick &lt;a href=&quot;https://github.com/pauloricardomg/cassandra/commits/2.1-10961&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;these latest commits&lt;/a&gt; in your cassandra-2.1.9 branch and create a custom jar to replace on your nodes before doing a rolling restart.&lt;/p&gt;</comment>
                            <comment id="15317529" author="kulkarni.akshay" created="Tue, 7 Jun 2016 00:06:34 +0000"  >&lt;p&gt;Our cluster also had a similar issue and we are on Cassandra 2.1.12 version. However, we were not adding any new nodes to our cluster but we faced this issue when suddenly our node went down and we when try to restart them again they are not coming up. Does this bug come during bootstrapping as well? &lt;/p&gt;</comment>
                            <comment id="15318700" author="slebresne" created="Tue, 7 Jun 2016 15:38:31 +0000"  >&lt;p&gt;What do you mean by &quot;similar&quot; exactly? Did you have a stack trace server side? In which case, can you paste it here so we can decide if we want to open a follow-up (as I suspect it might not be streaming related)?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310060">
                    <name>Container</name>
                                            <outwardlinks description="contains">
                                        <issuelink>
            <issuekey id="12932191">CASSANDRA-11028</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12902560">CASSANDRA-10448</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12926985">CASSANDRA-10963</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12930134">CASSANDRA-11014</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12852713">CASSANDRA-10012</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12781053" name="apache-cassandra-2.2.4-SNAPSHOT.jar" size="4593268" author="pauloricardomg" created="Thu, 7 Jan 2016 20:08:53 +0000"/>
                            <attachment id="12780321" name="debug.1.log" size="1301514" author="xiaost" created="Mon, 4 Jan 2016 15:03:13 +0000"/>
                            <attachment id="12780582" name="debug.logs.zip" size="1239487" author="xiaost" created="Tue, 5 Jan 2016 17:32:56 +0000"/>
                            <attachment id="12780322" name="netstats.1.log" size="3111" author="xiaost" created="Mon, 4 Jan 2016 15:03:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 24 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2qgcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333871">2.2.4</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yukim</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333871">2.2.4</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>