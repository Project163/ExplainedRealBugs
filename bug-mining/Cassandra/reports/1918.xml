<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:36:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-4980] StorageServiceClientTest/RecoveryManager2Test fail on 1.2.0 and above branch</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-4980</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Looks like change in c4cca2d8bba20a7651b956e1893727391bf5f10a (store schema_version to system.local) broke both StorageServiceClientTest and RecoveryManager2Test.&lt;br/&gt;
StorageServiceClientTest assert data directories are not created in client mode but this change actually creates data directories. RecoveryManager2Test fails with &quot;junit.framework.AssertionFailedError: Expecting only 1 replayed mutation, got 10&quot; error and I think extra commit log also comes from this insert to system.local.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12617135">CASSANDRA-4980</key>
            <summary>StorageServiceClientTest/RecoveryManager2Test fail on 1.2.0 and above branch</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="yukim">Yuki Morishita</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Nov 2012 16:50:10 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:22 +0000</updated>
                            <resolved>Wed, 21 Nov 2012 19:18:31 +0000</resolved>
                                                            <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13502121" author="jbellis" created="Wed, 21 Nov 2012 16:54:30 +0000"  >&lt;p&gt;My vote would be to revert c4cca2 for 1.2.0 and try again for 1.2.1.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13502145" author="slebresne" created="Wed, 21 Nov 2012 17:26:51 +0000"  >&lt;p&gt;I&apos;d rather avoid that if possible.&lt;/p&gt;

&lt;p&gt;The problem in StorageServiceClientTest is imo a bug that this commit just happens to reveal. Namely, that for some reason &lt;tt&gt;SS.initClient()&lt;/tt&gt; calls updateVersionAndAnnounce. But since fat clients are supposed to not have local tables, they will in particular have no schema and this is useless. If for some weird reason we really need fat client to send a &apos;I have no schema&apos; on gossip, let&apos;s call &lt;tt&gt;MigrationManager.passiveAnnounce(Schema.emptyVersion)&lt;/tt&gt; directly (but I don&apos;t see why we would need that).&lt;/p&gt;

&lt;p&gt;As for RecoveryManager2Test, it&apos;s just that this test was somehow assuming the commit log was empty when the test started. Which was the case because we almost always flush when we write the system table, but it happens that for writing the schemaVersion in the local table I figured flushing was overkill (since it&apos;s only for client sake and we don&apos;t need to flush to have it visible).&lt;/p&gt;

&lt;p&gt;Attaching simple fixes for both problems.&lt;/p&gt;</comment>
                            <comment id="13502193" author="yukim" created="Wed, 21 Nov 2012 18:45:48 +0000"  >&lt;p&gt;patch lgtm. +1&lt;/p&gt;</comment>
                            <comment id="13502212" author="slebresne" created="Wed, 21 Nov 2012 19:18:31 +0000"  >&lt;p&gt;Committed, thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12554535" name="0001-fix-StorageServiceClientTest.txt" size="909" author="slebresne" created="Wed, 21 Nov 2012 17:26:51 +0000"/>
                            <attachment id="12554536" name="0002-Clean-up-the-commit-log-before-RecoveryManager2Test.txt" size="1481" author="slebresne" created="Wed, 21 Nov 2012 17:26:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>259336</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lofr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>124609</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yukim</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>