<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:46:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-7502] NoHostAvailableException when preparing a statement with &apos;CONTAINS&apos;</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-7502</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;With C* 2.1-rc2 and the 2.1.0-SNAPSHOT Java Driver, I am not able to prepare a statement that contains the keyword &apos;CONTAINS&apos;. The C* node responds well and I am able to prepare others statements but I get a &apos;NoHostAvailableException&apos; as soon as I prepare a statement with &apos;CONTAINS&apos;. (Could it be related to some kind of &apos;timeout&apos; because it takes some time before the exception is thrown ?)&lt;/p&gt;

&lt;p&gt;A code sample that makes the problem happen ;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        Session session = cluster.connect(); &lt;span class=&quot;code-comment&quot;&gt;// Your session
&lt;/span&gt;        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; KS = &lt;span class=&quot;code-quote&quot;&gt;&quot;myTestKeyspace&quot;&lt;/span&gt;;
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; CF = KS + &lt;span class=&quot;code-quote&quot;&gt;&quot;.myTestTable&quot;&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            &lt;span class=&quot;code-comment&quot;&gt;// Create schema and insert data
&lt;/span&gt;            session.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE KEYSPACE IF NOT EXISTS &quot;&lt;/span&gt; + KS + &lt;span class=&quot;code-quote&quot;&gt;&quot; WITH replication = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;SimpleStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;replication_factor&apos;&lt;/span&gt;: 1 }&quot;&lt;/span&gt;);
            session.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE IF NOT EXISTS &quot;&lt;/span&gt; + CF + &lt;span class=&quot;code-quote&quot;&gt;&quot; ( k &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; PRIMARY KEY , s set&amp;lt;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&amp;gt; )&quot;&lt;/span&gt;);
            session.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE INDEX IF NOT EXISTS ks_table_set_index ON &quot;&lt;/span&gt; + CF + &lt;span class=&quot;code-quote&quot;&gt;&quot;(s)&quot;&lt;/span&gt;);
            session.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;UPDATE &quot;&lt;/span&gt; + CF + &lt;span class=&quot;code-quote&quot;&gt;&quot; SET s = s + {1} WHERE k = 1&quot;&lt;/span&gt;);
           
            &lt;span class=&quot;code-comment&quot;&gt;// Simple execution =&amp;gt; OK
&lt;/span&gt;            ResultSet result = session.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM &quot;&lt;/span&gt; + CF + &lt;span class=&quot;code-quote&quot;&gt;&quot; WHERE s CONTAINS 1&quot;&lt;/span&gt;);
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Row row : result.all()) {
                &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;\tKey where s contains 1 : &quot;&lt;/span&gt; + row.getInt(&lt;span class=&quot;code-quote&quot;&gt;&quot;k&quot;&lt;/span&gt;));
            }
           
            &lt;span class=&quot;code-comment&quot;&gt;// Prepare another statement =&amp;gt; OK
&lt;/span&gt;            PreparedStatement results = session.prepare(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM &quot;&lt;/span&gt; + CF + &lt;span class=&quot;code-quote&quot;&gt;&quot; WHERE k = ?&quot;&lt;/span&gt;);
            ResultSetFuture &lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt; = session.executeAsync(results.bind(1));
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Row row : &lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt;.get().all()) {
                &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;\ts where k is 1 :&quot;&lt;/span&gt; + row.getSet(&lt;span class=&quot;code-quote&quot;&gt;&quot;s&quot;&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.class));
            }
           
            &lt;span class=&quot;code-comment&quot;&gt;// Prepare the &lt;span class=&quot;code-quote&quot;&gt;&apos;CONTAINS&apos;&lt;/span&gt; statement
&lt;/span&gt;            results = session.prepare(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM &quot;&lt;/span&gt; + CF + &lt;span class=&quot;code-quote&quot;&gt;&quot; WHERE s CONTAINS ?&quot;&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// =&amp;gt; Boum !
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt; = session.executeAsync(results.bind(1));
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Row row : &lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt;.get().all()) {
                &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;\tKey where s contains 1 :&quot;&lt;/span&gt; + row.getInt(&lt;span class=&quot;code-quote&quot;&gt;&quot;k&quot;&lt;/span&gt;));
            }
           
            session.execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;DROP KEYSPACE &quot;&lt;/span&gt; + KS);
           
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
            e.printStackTrace();
        } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
            session.close();
            cluster.close();
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The output from the Java Driver ;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; query failed (tried: localhost/127.0.0.1:9042 (com.datastax.driver.core.exceptions.DriverException: Timeout during read))
    at com.datastax.driver.core.exceptions.NoHostAvailableException.copy(NoHostAvailableException.java:65)
    at com.datastax.driver.core.DefaultResultSetFuture.extractCauseFromExecutionException(DefaultResultSetFuture.java:258)
    at com.datastax.driver.core.AbstractSession.prepare(AbstractSession.java:79)
    at  (...)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; query failed (tried: localhost/127.0.0.1:9042 (com.datastax.driver.core.exceptions.DriverException: Timeout during read))
    at com.datastax.driver.core.RequestHandler.sendRequest(RequestHandler.java:103)
    at com.datastax.driver.core.RequestHandler$1.run(RequestHandler.java:175)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:744)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I did not see anything in the &lt;tt&gt;system.log&lt;/tt&gt; file about that.&lt;/p&gt;

&lt;p&gt;Discussed here :&lt;br/&gt;
&lt;a href=&quot;https://groups.google.com/a/lists.datastax.com/forum/#!topic/java-driver-user/zNme-LOf62A&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://groups.google.com/a/lists.datastax.com/forum/#!topic/java-driver-user/zNme-LOf62A&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;C* 2.1-rc2 ; seen using Java Driver 2.1-SNAPSHOT.&lt;/p&gt;</environment>
        <key id="12725685">CASSANDRA-7502</key>
            <summary>NoHostAvailableException when preparing a statement with &apos;CONTAINS&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="flarcher">Fabrice Larcher</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Jul 2014 07:36:08 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:41 +0000</updated>
                            <resolved>Mon, 7 Jul 2014 16:09:00 +0000</resolved>
                                        <fixVersion>2.1 rc3</fixVersion>
                                    <component>Legacy/CQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14053502" author="slebresne" created="Mon, 7 Jul 2014 09:43:54 +0000"  >&lt;p&gt;We simply add forgotten to call &quot;collectMarkerSpecification&quot; for &lt;tt&gt;CONTAINS&lt;/tt&gt; in SelectStatement. Attaching trivial patch that adds the missing line.&lt;/p&gt;

&lt;p&gt;We had tests for &lt;tt&gt;CONTAINS&lt;/tt&gt; for somehow they weren&apos;t written to exercises the &quot;prepared&quot; path and so this wasn&apos;t caught. The attached patch modify those tests (so they can exercise both the prepared and non prepared paths).&lt;/p&gt;</comment>
                            <comment id="14053691" author="tjake" created="Mon, 7 Jul 2014 14:21:29 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14053797" author="slebresne" created="Mon, 7 Jul 2014 16:09:00 +0000"  >&lt;p&gt;Committed, thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12654299" name="7502.txt" size="10971" author="slebresne" created="Mon, 7 Jul 2014 09:43:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403843</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 20 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xi6f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>403886</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327111">2.1 rc2</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tjake</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[tjake]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>