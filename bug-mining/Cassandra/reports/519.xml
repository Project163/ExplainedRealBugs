<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:17:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-1635] cli not picking up type annotation on set</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-1635</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Keyspace1] create column family Users
create column family Users
737c7a71-dc56-11df-8240-e700f669bcfc
[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Keyspace1] set Users[jsmith][first] = &lt;span class=&quot;code-quote&quot;&gt;&apos;John&apos;&lt;/span&gt;
set Users[jsmith][first] = &lt;span class=&quot;code-quote&quot;&gt;&apos;John&apos;&lt;/span&gt;
Value inserted.
[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Keyspace1] set Users[jsmith][last] = &lt;span class=&quot;code-quote&quot;&gt;&apos;Smith&apos;&lt;/span&gt;
set Users[jsmith][last] = &lt;span class=&quot;code-quote&quot;&gt;&apos;Smith&apos;&lt;/span&gt;
Value inserted.
[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Keyspace1] set Users[jsmith][age] = &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(42)
set Users[jsmith][age] = &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(42)
Value inserted.
[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Keyspace1] get Users[jsmith]
get Users[jsmith]
=&amp;gt; (column=6c617374, value=Smith, timestamp=1287584999695000)
=&amp;gt; (column=6669727374, value=John, timestamp=1287584990126000)
=&amp;gt; (column=616765, value=^@^@^@^@^@^@^@*, timestamp=1287585014593000)
Returned 3 results.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12477874">CASSANDRA-1635</key>
            <summary>cli not picking up type annotation on set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xedin">Pavel Yaskevich</assignee>
                                    <reporter username="jbellis">Jonathan Ellis</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Oct 2010 14:40:11 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:15 +0000</updated>
                            <resolved>Wed, 20 Oct 2010 21:11:21 +0000</resolved>
                                        <fixVersion>0.7 beta 3</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12923053" author="xedin" created="Wed, 20 Oct 2010 17:14:12 +0000"  >&lt;p&gt;Please check after 1615 committed.&lt;/p&gt;</comment>
                            <comment id="12923111" author="jbellis" created="Wed, 20 Oct 2010 19:24:25 +0000"  >&lt;p&gt;post-1615 I get&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;=&amp;gt; (column=626972746864617465, value=?, timestamp=1287602501548000)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also, I noticed that it&apos;s actually sending&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        thriftClient_.system_update_column_family(columnFamily);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;when I use a conversion function.  this is not right, we should only issue system_update_column_family for &quot;update column family&quot; statements, anything else we infer should stay local.&lt;/p&gt;</comment>
                            <comment id="12923135" author="xedin" created="Wed, 20 Oct 2010 20:00:36 +0000"  >&lt;p&gt;my test (after applied &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1635&quot; title=&quot;cli not picking up type annotation on set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1635&quot;&gt;&lt;del&gt;CASSANDRA-1635&lt;/del&gt;&lt;/a&gt;.patch to the latest trunk):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@KS1] create column family Users with comparator=UTF8Type and column_metadata=[{column_name:first, validation_class:UTF8Type}, {column_name:last, validation_class:UTF8Type}]
412367d6-dc83-11df-bf47-e700f669bcfc
[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@KS1] set Users[jsmith][first] = &lt;span class=&quot;code-quote&quot;&gt;&apos;John&apos;&lt;/span&gt;
Value inserted.
[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@KS1] set Users[jsmith][last] = &lt;span class=&quot;code-quote&quot;&gt;&apos;Smith&apos;&lt;/span&gt;
Value inserted.
[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@KS1] set Users[jsmith][age] = &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;(42)
Value inserted.
[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@KS1] get Users[jsmith]
=&amp;gt; (column=last, value=Smith, timestamp=1287604215498000)
=&amp;gt; (column=first, value=John, timestamp=1287604214111000)
=&amp;gt; (column=age, value=42, timestamp=1287604216661000)
Returned 3 results.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I use UTF8Type here manually because default comparator for column names is BytesType. Results you get are very weird... &lt;/p&gt;

&lt;p&gt;if you mean convertValueByFunction method then it has boolean withUpdate argument which used to determine if system update is need, I have also added polymorphic convertValueByFunction 3 arguments: columnFamily, columnName and tree argument, which calls convertValueByFunction with withUpdate set to false.&lt;/p&gt;</comment>
                            <comment id="12923149" author="jbellis" created="Wed, 20 Oct 2010 20:16:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;my test (after applied &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1635&quot; title=&quot;cli not picking up type annotation on set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1635&quot;&gt;&lt;del&gt;CASSANDRA-1635&lt;/del&gt;&lt;/a&gt;.patch to the latest trunk): &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ah, I thought when you said &quot;Please check after 1615 committed&quot; that 1615 was supposed to fix it.  I do see value working correctly after 1635 patch.  committed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;convertValueByFunction method then it has boolean withUpdate argument which used to determine if system update is need, I have also added polymorphic convertValueByFunction 3 arguments: columnFamily, columnName and tree argument, which calls convertValueByFunction with withUpdate set to false.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;something is definitely buggy, when I watch the server log I can see it applying the schema migration after the long() set.&lt;/p&gt;

&lt;p&gt;fundamentally side effects to thriftclient have no business in the convertValue method.  update local schema? yes. update server schema? no.&lt;/p&gt;</comment>
                            <comment id="12923163" author="xedin" created="Wed, 20 Oct 2010 20:44:28 +0000"  >&lt;p&gt;Sorry for my misleading comment :/ now updates for column defs are performed only locally except &quot;update column family&quot; statement.&lt;/p&gt;</comment>
                            <comment id="12923173" author="jbellis" created="Wed, 20 Oct 2010 21:11:21 +0000"  >&lt;p&gt;perfect, committed.&lt;/p&gt;</comment>
                            <comment id="12923473" author="hudson" created="Thu, 21 Oct 2010 14:55:52 +0000"  >&lt;p&gt;Integrated in Cassandra #572 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra/572/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra/572/&lt;/a&gt;)&lt;br/&gt;
    avoid updating server schema except for explicit &apos;update column family&apos;.  patch by Pavel Yaskevich; reviewed by jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1635&quot; title=&quot;cli not picking up type annotation on set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1635&quot;&gt;&lt;del&gt;CASSANDRA-1635&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
fix cli value conversion, update readme&lt;br/&gt;
patch by Pavel Yaskevich and jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1635&quot; title=&quot;cli not picking up type annotation on set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1635&quot;&gt;&lt;del&gt;CASSANDRA-1635&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
cli support for index queries&lt;br/&gt;
patch by Pavel Yaskevich; reviewed by jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1635&quot; title=&quot;cli not picking up type annotation on set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1635&quot;&gt;&lt;del&gt;CASSANDRA-1635&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12457707" name="CASSANDRA-1635-v2.patch" size="4119" author="xedin" created="Wed, 20 Oct 2010 20:44:28 +0000"/>
                            <attachment id="12457681" name="CASSANDRA-1635.patch" size="2183" author="xedin" created="Wed, 20 Oct 2010 17:14:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[xedin]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20228</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 5 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g6fz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>92474</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>