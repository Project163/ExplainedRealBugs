<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:23:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3259] Replace token leaves the old node state in tact causing problems in cli</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3259</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;in the replace token patch we dont evict the node from the Gossip which will leave the node lingering around and causes issues in cli (UNReachable nodes)&lt;/p&gt;

&lt;p&gt;As a part of the replace token if the token is replaced with another token we should remove the old nodes Gossip states.&lt;/p&gt;</description>
                <environment>&lt;p&gt;JVM on CentOS&lt;/p&gt;</environment>
        <key id="12524654">CASSANDRA-3259</key>
            <summary>Replace token leaves the old node state in tact causing problems in cli</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vijay2win@yahoo.com">Vijay</assignee>
                                    <reporter username="vijay2win@yahoo.com">Vijay</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Sep 2011 15:51:09 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:50 +0000</updated>
                            <resolved>Fri, 30 Sep 2011 21:48:09 +0000</resolved>
                                        <fixVersion>0.8.7</fixVersion>
                    <fixVersion>1.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13117894" author="vijay2win@yahoo.com" created="Fri, 30 Sep 2011 05:39:54 +0000"  >&lt;p&gt;This patch fixes this issue. We can immediately delete the Application states of the token which we just replaced so that we dont gossip about it.&lt;/p&gt;</comment>
                            <comment id="13118316" author="brandon.williams" created="Fri, 30 Sep 2011 19:35:01 +0000"  >&lt;p&gt;If this is causing problems in the cli, the cli is doing something wrong, because removeEndpoint already takes it out of the Gossiper&apos;s unreachable nodes.  What problem is this solving?&lt;/p&gt;

&lt;p&gt;We do need to expire remove this endpoint but I don&apos;t think exposing evictFromMembership is the best way.&lt;/p&gt;</comment>
                            <comment id="13118327" author="vijay2win@yahoo.com" created="Fri, 30 Sep 2011 19:40:39 +0000"  >&lt;p&gt;The problem is that, when we do the replace token we dont change the status of the old node (to removed ip or something)... hence the Node will get the State back as it is still gossiping about the replaced node. Even if removeToken() the states are not removed and hence if someone is talking about this node after (Async evict by doStatus()) this node will be added back.... hence the node will never go out of the Application State. This patch will instead will evict immediately when it sees a irrelevant host. This is simpler solution than adding another status like &quot;remove ip&quot;. This works as expected in my tests.&lt;/p&gt;</comment>
                            <comment id="13118464" author="vijay2win@yahoo.com" created="Fri, 30 Sep 2011 21:23:53 +0000"  >&lt;p&gt;v2 adds abstraction to evict based on brandon&apos;s comments in IRC.&lt;/p&gt;</comment>
                            <comment id="13118489" author="brandon.williams" created="Fri, 30 Sep 2011 21:48:09 +0000"  >&lt;p&gt;Committed, thanks&lt;/p&gt;</comment>
                            <comment id="13118504" author="hudson" created="Fri, 30 Sep 2011 22:14:03 +0000"  >&lt;p&gt;Integrated in Cassandra-0.8 #352 (See &lt;a href=&quot;https://builds.apache.org/job/Cassandra-0.8/352/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Cassandra-0.8/352/&lt;/a&gt;)&lt;br/&gt;
    Evict gossip state immediately when a token is taken over.&lt;br/&gt;
Patch by vijay, reviewed by brandonwilliams for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3259&quot; title=&quot;Replace token leaves the old node state in tact causing problems in cli&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3259&quot;&gt;&lt;del&gt;CASSANDRA-3259&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;brandonwilliams : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1177847&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1177847&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/gms/Gossiper.java&lt;/li&gt;
	&lt;li&gt;/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/service/StorageService.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13118607" author="vijay2win@yahoo.com" created="Sat, 1 Oct 2011 00:52:00 +0000"  >&lt;p&gt;Hi Brandon, Really sorry about extra work... i missed one change for 1.0 i was separating these 2 patches and some how i missed it.... &lt;/p&gt;</comment>
                            <comment id="13119211" author="slebresne" created="Mon, 3 Oct 2011 08:59:37 +0000"  >&lt;p&gt;This hasn&apos;t been merged up to 1.0 yet so it should probably be (with the last changes from Vijay?), and it could probably use an entry in the changelog when doing so.&lt;/p&gt;</comment>
                            <comment id="13120470" author="brandon.williams" created="Tue, 4 Oct 2011 21:02:35 +0000"  >&lt;p&gt;Done and done.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12497221" name="0001-evict-replaced-node-immediately-v2.patch" size="2490" author="vijay2win@yahoo.com" created="Fri, 30 Sep 2011 21:23:53 +0000"/>
                            <attachment id="12497115" name="0001-evict-replaced-node-immediately.patch" size="2407" author="vijay2win@yahoo.com" created="Fri, 30 Sep 2011 05:39:54 +0000"/>
                            <attachment id="12497254" name="0002-evict-during-replace-token-for-1.0.patch" size="2352" author="vijay2win@yahoo.com" created="Sat, 1 Oct 2011 00:54:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[vijay2win@yahoo.com]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1832</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 8 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ghqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94304</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>brandon.williams</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>