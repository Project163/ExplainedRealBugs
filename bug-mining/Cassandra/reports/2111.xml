<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:37:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5385] IndexHelper.skipBloomFilters won&apos;t skip non-SHA filters</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5385</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Currently, if the bloom filter is not of SHA type, we do not properly skip the bytes. We need to read out the number of bytes, as happens in the Murmur deserializer, then skip that many bytes instead of just skipping the hash size. The version needs to be passed into the method as well, so that it knows what type of index it is, and does the appropriate skipping.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12639161">CASSANDRA-5385</key>
            <summary>IndexHelper.skipBloomFilters won&apos;t skip non-SHA filters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="carlyeks">Carl Yeksigian</assignee>
                                    <reporter username="carlyeks">Carl Yeksigian</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Mar 2013 19:03:40 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:15 +0000</updated>
                            <resolved>Wed, 3 Apr 2013 23:17:06 +0000</resolved>
                                        <fixVersion>1.2.4</fixVersion>
                    <fixVersion>2.0 beta 1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13614449" author="jasobrown" created="Tue, 26 Mar 2013 19:16:46 +0000"  >&lt;p&gt;LGTM. Nice catch, will commit in a few minutes. Thanks!&lt;/p&gt;

&lt;p&gt;EDIT: actually, looking into a side question that carl raised about OOM problem.&lt;/p&gt;</comment>
                            <comment id="13614788" author="jasobrown" created="Wed, 27 Mar 2013 01:40:05 +0000"  >&lt;p&gt;After talking on the IRC with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=carlyeks&quot; class=&quot;user-hover&quot; rel=&quot;carlyeks&quot;&gt;carlyeks&lt;/a&gt;, this does affect 1.2 (and starts there) so resetting the affects/fix versions&lt;/p&gt;</comment>
                            <comment id="13620128" author="jasobrown" created="Tue, 2 Apr 2013 18:51:59 +0000"  >&lt;p&gt;There is a problem with ScrubTest, and we decided, on the IRC, to can it for now. It will be rewritten as part of #4180.&lt;/p&gt;

&lt;p&gt;Committed to cassandra-1.2 and trunk. Thanks, Carl!&lt;/p&gt;</comment>
                            <comment id="13620590" author="carlyeks" created="Wed, 3 Apr 2013 04:19:30 +0000"  >&lt;p&gt;The problem with the OOM is actually something that shows what is wrong (it&apos;s not a symptom). We can add back the scrub test, as it should pass now.&lt;/p&gt;

&lt;p&gt;Before sstable version ia, the size of the bloom filter was written in the column header, along with the bloom filter. In 1.2, the Murmur3 partitioner was added, which dropped the size of the bloom filter as the first parameter. If we tried to read a bloom filter that was encoded in a pre-ia table, we would fail, skip it (using index helper), and it would skip the correct number of bytes. Now, we need to distinguish between the bloom filter stored in the sstable and the one stored in the filter component.&lt;/p&gt;

&lt;p&gt;This patch fixes the LegacySSTableTest by distinguishing between the sstables written in the ia format (which didn&apos;t write the size of the bloom filter up front) and the pre-ia format.&lt;/p&gt;</comment>
                            <comment id="13620916" author="jasobrown" created="Wed, 3 Apr 2013 13:39:55 +0000"  >&lt;p&gt;Committed to trunk, and ScrubTest and LegacySSTableTest now pass. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=carlyeks&quot; class=&quot;user-hover&quot; rel=&quot;carlyeks&quot;&gt;carlyeks&lt;/a&gt;, does this need to be applied to 1.2, as well? Seems like it should, but the ScrubTest and LegacySSTableTest pass on 1.2 without this.&lt;/p&gt;</comment>
                            <comment id="13621486" author="jasobrown" created="Wed, 3 Apr 2013 23:16:59 +0000"  >&lt;p&gt;Backported and committed to cassandra-1.2. Thanks for the effort, Carl!&lt;/p&gt;</comment>
                            <comment id="13636489" author="jbellis" created="Fri, 19 Apr 2013 15:34:09 +0000"  >&lt;p&gt;Hmm, looks like the backport blew away scrubtest on 1.2 as well.  Oversight?&lt;/p&gt;</comment>
                            <comment id="13636656" author="jbellis" created="Fri, 19 Apr 2013 17:41:08 +0000"  >&lt;p&gt;I&apos;m confused by this whole ticket.  Which of these is incorrect?&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;skipBloomFilters is only called on data in the Data componenet&lt;/li&gt;
	&lt;li&gt;skipBloomFilters is only called against a 1.1 sstable&lt;/li&gt;
	&lt;li&gt;1.1 sstables only use Murmur2 Bloom filters&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;(Because if all of these are correct, then we shouldn&apos;t need the changes to IndexHelper introduced here.)&lt;/p&gt;</comment>
                            <comment id="13637617" author="carlyeks" created="Sun, 21 Apr 2013 18:48:26 +0000"  >&lt;blockquote&gt;

&lt;p&gt;Hmm, looks like the backport blew away scrubtest on 1.2 as well. Oversight?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Yes, was an oversight.&lt;/p&gt;

&lt;p&gt;Just for clarification, skipBloomFilters is old.&lt;/p&gt;

&lt;p&gt;#1 and #2 are incorrect.&lt;/p&gt;

&lt;p&gt;1: The skipBloomFilters gets called on the index file in RowIndexEntry line 104.&lt;br/&gt;
2: In 2.0, the skipBloomFilters will be called on a 1.2 sstable; also, the skipBloomFilters currently is called against any sstable when scrubbing.&lt;/p&gt;</comment>
                            <comment id="13637673" author="jbellis" created="Sun, 21 Apr 2013 22:50:06 +0000"  >&lt;p&gt;Ah, I see.  So, my assertions are correct for 1.2, which is what I&apos;ve been working in lately.  I&apos;ll make sure it stays that way as I merge &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5497&quot; title=&quot;Use allocator information to improve memtable memory usage estimate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5497&quot;&gt;&lt;del&gt;CASSANDRA-5497&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5492&quot; title=&quot;Backport row-level bloom filter removal to 1.2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5492&quot;&gt;&lt;del&gt;CASSANDRA-5492&lt;/del&gt;&lt;/a&gt; forward.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12614202">CASSANDRA-4885</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12576713" name="5385-v2.patch" size="15825" author="carlyeks" created="Wed, 3 Apr 2013 04:19:30 +0000"/>
                            <attachment id="12575563" name="5385.patch" size="8197" author="carlyeks" created="Tue, 26 Mar 2013 19:04:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[carlyeks]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319631</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 31 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1j5fb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319972</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jasobrown</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jasobrown]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>