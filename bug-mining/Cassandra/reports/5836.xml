<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:21:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-16888] SSTableReaderTest#testGetPositionsKeyCacheStats failing sporadically on unexpected key cache hit for non-cached key</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-16888</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;This has started to pop up on 4.0.x and trunk builds in both CircleCI and Apache CI:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/josh-mckenzie/cassandra/60/workflows/15e09ea4-4d35-4035-9afc-ff0d1089041e/jobs/382&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/josh-mckenzie/cassandra/60/workflows/15e09ea4-4d35-4035-9afc-ff0d1089041e/jobs/382&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/maedhroz/cassandra/332/workflows/3bd588d9-717f-4877-8e78-7a127180dfee/jobs/2093/tests#failed-test-0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/maedhroz/cassandra/332/workflows/3bd588d9-717f-4877-8e78-7a127180dfee/jobs/2093/tests#failed-test-0&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;&lt;a href=&quot;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch/1067/testReport/junit/org.apache.cassandra.io.sstable/SSTableReaderTest/testGetPositionsKeyCacheStats_cdc/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch/1067/testReport/junit/org.apache.cassandra.io.sstable/SSTableReaderTest/testGetPositionsKeyCacheStats_cdc/&lt;/a&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
It passes consistently in local runs, although I have seen one failure in about 10 runs.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13397652">CASSANDRA-16888</key>
            <summary>SSTableReaderTest#testGetPositionsKeyCacheStats failing sporadically on unexpected key cache hit for non-cached key</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="maedhroz">Caleb Rackliffe</assignee>
                                    <reporter username="maedhroz">Caleb Rackliffe</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Aug 2021 21:08:16 +0000</created>
                <updated>Fri, 27 May 2022 19:25:24 +0000</updated>
                            <resolved>Thu, 9 Sep 2021 19:14:03 +0000</resolved>
                                        <fixVersion>4.0.2</fixVersion>
                    <fixVersion>4.1-alpha1</fixVersion>
                    <fixVersion>4.1</fixVersion>
                                    <component>Local/Caching</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17405475" author="maedhroz" created="Thu, 26 Aug 2021 21:15:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; No idea if it&apos;s related yet, but I think the most recent changes around this were for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12922&quot; title=&quot;Bloom filter miss counts are not measured correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12922&quot;&gt;&lt;del&gt;CASSANDRA-12922&lt;/del&gt;&lt;/a&gt;. I&apos;ll try to track this down in the next few days...&lt;/p&gt;</comment>
                            <comment id="17405477" author="brandon.williams" created="Thu, 26 Aug 2021 21:19:46 +0000"  >&lt;p&gt;Hmm, I was mostly facilitating the commit there, ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17405512" author="adelapena" created="Thu, 26 Aug 2021 23:36:07 +0000"  >&lt;p&gt;25 hits in 200 runs of the full test class with j8: &lt;a href=&quot;https://app.circleci.com/pipelines/github/adelapena/cassandra/807/workflows/67d4e4bf-a599-4fbb-a445-d600e10b10f5/jobs/7830&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/adelapena/cassandra/807/workflows/67d4e4bf-a599-4fbb-a445-d600e10b10f5/jobs/7830&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17412662" author="maedhroz" created="Thu, 9 Sep 2021 16:07:39 +0000"  >&lt;p&gt;What&apos;s interesting is that this test only seems to have been running since &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-12922&quot; title=&quot;Bloom filter miss counts are not measured correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-12922&quot;&gt;&lt;del&gt;CASSANDRA-12922&lt;/del&gt;&lt;/a&gt;. There&apos;s also &lt;tt&gt;OrderedJUnit4ClassRunner&lt;/tt&gt; in play here, so there might be some test state leakage that was papering over that&apos;s now a problem...&lt;/p&gt;</comment>
                            <comment id="17412717" author="maedhroz" created="Thu, 9 Sep 2021 17:16:51 +0000"  >&lt;p&gt;patch (4.0): &lt;a href=&quot;https://github.com/apache/cassandra/pull/1192&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/pull/1192&lt;/a&gt;&lt;br/&gt;
CircleCI: &lt;a href=&quot;https://app.circleci.com/pipelines/github/maedhroz/cassandra?branch=CASSANDRA-16888-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/maedhroz/cassandra?branch=CASSANDRA-16888-4.0&lt;/a&gt;&lt;br/&gt;
trunk multiplexer run: &lt;a href=&quot;https://app.circleci.com/pipelines/github/maedhroz/cassandra?branch=16888-trunk-with-fix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/maedhroz/cassandra?branch=16888-trunk-with-fix&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17412720" author="maedhroz" created="Thu, 9 Sep 2021 17:21:00 +0000"  >&lt;p&gt;The long story short here is that many of the tests in &lt;tt&gt;SSTableReaderTest&lt;/tt&gt; share the same table(s), but there was not consistent removal of the SSTables from previous tests. That combined with partition key reuse, doomed the test in question here, since it could view an SSTable from &lt;tt&gt;testGetPositionsForRangesWithKeyCache()&lt;/tt&gt;. Doing this also happens to remove the need to use &lt;tt&gt;OrderedJUnit4ClassRunner&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17412725" author="krummas" created="Thu, 9 Sep 2021 17:24:18 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17412759" author="maedhroz" created="Thu, 9 Sep 2021 18:19:55 +0000"  >&lt;p&gt;The multiplexer &lt;a href=&quot;https://app.circleci.com/pipelines/github/maedhroz/cassandra?branch=16888-trunk-with-fix&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;likes is&lt;/a&gt;, so I think we&apos;re all set. Starting commit...&lt;/p&gt;</comment>
                            <comment id="17412787" author="maedhroz" created="Thu, 9 Sep 2021 19:14:03 +0000"  >&lt;p&gt;4.0: &lt;a href=&quot;https://github.com/apache/cassandra/commit/bc052fa68f525155246de498cc86bb192f2d479a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/bc052fa68f525155246de498cc86bb192f2d479a&lt;/a&gt;&lt;br/&gt;
trunk: &lt;a href=&quot;https://github.com/apache/cassandra/commit/b6b3be6d8aa79c5e74b0c0f197075fdc48e38287&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/b6b3be6d8aa79c5e74b0c0f197075fdc48e38287&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[maedhroz]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12990" cascade-level="1"><![CDATA[Test Failure]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12970"><![CDATA[Unit Test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 9 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ubig:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12350307">4.0.1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/bc052fa68f525155246de498cc86bb192f2d479a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/bc052fa68f525155246de498cc86bb192f2d479a&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;This patch fixes an existing test class.&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>