<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:39:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5856] AE in ArrayBackedSortedColumns</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5856</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR [ReadStage:3] 2013-08-07 06:58:21,485 CassandraDaemon.java (line 192) Exception in thread Thread[ReadStage:3,5,main]
java.lang.AssertionError: Added column does not sort as the last column
    at org.apache.cassandra.db.ArrayBackedSortedColumns.addColumn(ArrayBackedSortedColumns.java:131)
    at org.apache.cassandra.db.AbstractColumnContainer.addColumn(AbstractColumnContainer.java:119)
    at org.apache.cassandra.db.AbstractColumnContainer.addColumn(AbstractColumnContainer.java:114)
    at org.apache.cassandra.db.filter.SliceQueryFilter.collectReducedColumns(SliceQueryFilter.java:171)
    at org.apache.cassandra.db.filter.QueryFilter.collateColumns(QueryFilter.java:136)
    at org.apache.cassandra.db.filter.QueryFilter.collateOnDiskAtom(QueryFilter.java:84)
    at org.apache.cassandra.db.CollationController.collectAllData(CollationController.java:291)
    at org.apache.cassandra.db.CollationController.getTopLevelColumns(CollationController.java:65)
    at org.apache.cassandra.db.ColumnFamilyStore.getTopLevelColumns(ColumnFamilyStore.java:1390)
    at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1213)
    at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1125)
    at org.apache.cassandra.db.Table.getRow(Table.java:347)
    at org.apache.cassandra.db.SliceFromReadCommand.getRow(SliceFromReadCommand.java:70)
    at org.apache.cassandra.service.StorageProxy$LocalReadRunnable.runMayThrow(StorageProxy.java:1047)
    at org.apache.cassandra.service.StorageProxy$DroppableRunnable.run(StorageProxy.java:1593)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.Thread.run(Thread.java:722)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;test_column_index_stress in wide_rows_test will reproduce this within ~20 runs and bisect strongly points to a regression in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5762&quot; title=&quot;Lost row marker after TTL expires&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5762&quot;&gt;&lt;del&gt;CASSANDRA-5762&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12662410">CASSANDRA-5856</key>
            <summary>AE in ArrayBackedSortedColumns</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aleksey">Aleksey Yeschenko</assignee>
                                    <reporter username="brandon.williams">Brandon Williams</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Aug 2013 15:47:18 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:08 +0000</updated>
                            <resolved>Sat, 17 Aug 2013 15:53:35 +0000</resolved>
                                        <fixVersion>1.2.9</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13736577" author="jbellis" created="Mon, 12 Aug 2013 04:46:47 +0000"  >&lt;p&gt;First guess: something&apos;s getting confused about reversed-ness.  Is that part of the test in question?&lt;/p&gt;</comment>
                            <comment id="13736588" author="jbellis" created="Mon, 12 Aug 2013 05:07:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5762&quot; title=&quot;Lost row marker after TTL expires&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5762&quot;&gt;&lt;del&gt;CASSANDRA-5762&lt;/del&gt;&lt;/a&gt; is probably causing this indirectly by forcing more code to go through the slice path, rather than introducing a bug in collation directly.&lt;/p&gt;</comment>
                            <comment id="13736598" author="jbellis" created="Mon, 12 Aug 2013 05:34:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;First guess: something&apos;s getting confused about reversed-ness&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Second guess: there&apos;s a bug in ISR&apos;s code for reversed fetches (&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5712&quot; title=&quot;Reverse slice queries can skip range tombstones&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5712&quot;&gt;&lt;del&gt;CASSANDRA-5712&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Might need to make it print out the cells in collectReducedColumns to see...&lt;/p&gt;</comment>
                            <comment id="13736608" author="jbellis" created="Mon, 12 Aug 2013 05:49:56 +0000"  >&lt;p&gt;If there&apos;s a bug in ISR it&apos;s probably older than 5712.  &lt;tt&gt;prefetched&lt;/tt&gt; makes my head hurt.&lt;/p&gt;</comment>
                            <comment id="13736613" author="jbellis" created="Mon, 12 Aug 2013 05:55:53 +0000"  >&lt;p&gt;Patch to get more information from the assert.&lt;/p&gt;

&lt;p&gt;(NB: the existing error message indicates that this is NOT a reversed slice.  So, beats the hell out of me how this could be erroring out.  Hence, the need for more information.)&lt;/p&gt;</comment>
                            <comment id="13736735" author="iamaleksey" created="Mon, 12 Aug 2013 10:32:27 +0000"  >&lt;p&gt;I&apos;ll get to it today/tomorrow. Yeah. 5762 is very unlikely to be the cause of it.&lt;/p&gt;</comment>
                            <comment id="13738404" author="jbellis" created="Tue, 13 Aug 2013 16:00:01 +0000"  >&lt;p&gt;Two of the patched assertion failures:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.AssertionError: Added cell val31254: does not sort as the last; contents are val2960::false:0@1376407099059000,val2960:value:false:4@1376407099059000,val31254::false:0@1376407110826001,val31254:value:false:4@1376407110826001, with comparator org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.AssertionError: Added cell val54806: does not sort as the last; contents are val22917::false:0@1376408295872003,val22917:value:false:4@1376408295872003,val54806::false:0@1376408305568001,val54806:value:false:4@1376408305568001, with comparator org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13738408" author="brandon.williams" created="Tue, 13 Aug 2013 16:05:03 +0000"  >&lt;p&gt;Here&apos;s the most concise one I&apos;ve seen:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.AssertionError: Added cell val11599: does not sort as the last; contents are val11599::false:0@1376409359730001,val11599:value:false:4@1376409359730001, with comparator org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13741288" author="brandon.williams" created="Thu, 15 Aug 2013 18:10:12 +0000"  >&lt;p&gt;So, this is a lot simpler than the test makes it look.  It&apos;s caused simple by asking for the same column by name twice:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; create keyspace foo WITH replication = {&apos;class&apos;: &apos;SimpleStrategy&apos;, &apos;replication_factor&apos;: 1};
cqlsh&amp;gt; use foo;
cqlsh:foo&amp;gt; create table bar (row varchar, name varchar, value int, PRIMARY KEY (row, name));
cqlsh:foo&amp;gt; update bar set value = 1 WHERE row = &apos;baz&apos; AND name = &apos;qux&apos;;
cqlsh:foo&amp;gt; select value from bar where row=&apos;baz&apos; AND name in (&apos;qux&apos;, &apos;qux&apos;);
Request did not complete within rpc_timeout.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Results in:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.AssertionError: Added cell qux: does not sort as the last; contents are qux::false:0@1376590034567000,qux:value:false:4@1376590034567000, with comparator org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13742954" author="jbellis" created="Sat, 17 Aug 2013 15:23:41 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Nit: can we make buildBound return Collection to avoid the extra copy?&lt;/p&gt;</comment>
                            <comment id="13742960" author="iamaleksey" created="Sat, 17 Aug 2013 15:53:35 +0000"  >&lt;p&gt;Committed, thanks.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Nit: can we make buildBound return Collection to avoid the extra copy?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No, unfortunately we can&apos;t. Well, we kinda can, but we&apos;d then have to create an extra iterator for getKeyBound (won&apos;t be able to just .get(0)) and two extra iterators in makeFilter (again, won&apos;t be able to just .get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; - and we need to iterate over startBounds and endBounds simultaneously to build the ColumnSlices).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12597413" name="5856-assert.txt" size="1213" author="jbellis" created="Mon, 12 Aug 2013 05:55:53 +0000"/>
                            <attachment id="12598335" name="5856.txt" size="4477" author="aleksey" created="Fri, 16 Aug 2013 00:47:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>342414</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 14 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n1wf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>342719</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324628">1.2.7</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>