<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:37:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5287] Composite comparators for super CFs broken in 1.2</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5287</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In Cassandra 1.2.0 through 1.2.2, attempting to insert data into a super column family with a CompositeType comparator results in the following stacktrace:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR 14:56:49,920 Error occurred during processing of message.
java.lang.IllegalArgumentException
	at java.nio.Buffer.limit(Buffer.java:249)
	at org.apache.cassandra.db.marshal.AbstractCompositeType.getBytes(AbstractCompositeType.java:51)
	at org.apache.cassandra.db.marshal.AbstractCompositeType.getWithShortLength(AbstractCompositeType.java:60)
	at org.apache.cassandra.db.marshal.AbstractCompositeType.split(AbstractCompositeType.java:126)
	at org.apache.cassandra.config.CFMetaData.getColumnDefinitionFromColumnName(CFMetaData.java:920)
	at org.apache.cassandra.thrift.ThriftValidation.validateColumnData(ThriftValidation.java:404)
	at org.apache.cassandra.thrift.ThriftValidation.validateColumnOrSuperColumn(ThriftValidation.java:287)
	at org.apache.cassandra.thrift.ThriftValidation.validateMutation(ThriftValidation.java:343)
	at org.apache.cassandra.thrift.CassandraServer.createMutationList(CassandraServer.java:704)
	at org.apache.cassandra.thrift.CassandraServer.batch_mutate(CassandraServer.java:752)
	at org.apache.cassandra.thrift.Cassandra$Processor$batch_mutate.getResult(Cassandra.java:3622)
	at org.apache.cassandra.thrift.Cassandra$Processor$batch_mutate.getResult(Cassandra.java:3610)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:32)
	at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:34)
	at org.apache.cassandra.thrift.CustomTThreadPoolServer$WorkerProcess.run(CustomTThreadPoolServer.java:199)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Client-side, you&apos;ll just see &quot;&lt;tt&gt;TTransportException: TSocket read 0 bytes&lt;/tt&gt;&quot;.&lt;/p&gt;

&lt;p&gt;Cassandra 1.1 doesn&apos;t have the same problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12633993">CASSANDRA-5287</key>
            <summary>Composite comparators for super CFs broken in 1.2</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="thobbs">Tom Hobbs</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Feb 2013 21:03:19 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:17 +0000</updated>
                            <resolved>Thu, 28 Feb 2013 13:11:41 +0000</resolved>
                                        <fixVersion>1.2.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13586281" author="thobbs" created="Mon, 25 Feb 2013 21:04:17 +0000"  >&lt;p&gt;Attached script reproduces the issue with pycassa.&lt;/p&gt;</comment>
                            <comment id="13587344" author="slebresne" created="Tue, 26 Feb 2013 18:20:22 +0000"  >&lt;p&gt;Patch attached (I haven&apos;t tested it yet tbh but pretty sure that&apos;s &lt;b&gt;a&lt;/b&gt; problem if not &lt;b&gt;the&lt;/b&gt; problem).&lt;/p&gt;</comment>
                            <comment id="13588608" author="thobbs" created="Wed, 27 Feb 2013 18:40:11 +0000"  >&lt;p&gt;Is the patch supposed to be against the 1.2 branch? It doesn&apos;t compile there.&lt;/p&gt;</comment>
                            <comment id="13588619" author="slebresne" created="Wed, 27 Feb 2013 18:46:11 +0000"  >&lt;p&gt;Hum, that&apos;s what you get for not even compiling before attaching a patch I suppose. The newly attached version should work better. &lt;/p&gt;</comment>
                            <comment id="13588665" author="thobbs" created="Wed, 27 Feb 2013 19:29:34 +0000"  >&lt;p&gt;The patch seems fine to me, but I&apos;m not terribly familiar with this area of the code.  With it applied, all of the pycassa and phpcassa tests pass, and they cover this pretty well.&lt;/p&gt;</comment>
                            <comment id="13589518" author="slebresne" created="Thu, 28 Feb 2013 13:11:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;The patch seems fine to me, but I&apos;m not terribly familiar with this area of the code.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;For the record, what happens is that in CQL3 you can have a ColumnDefinition that applies to only a component of the column name, hence the special code for composite in CFMetadata.getColumnDefinitionFromColumnName. However, for super columns we pass to this method the subcolumn name, so using the comparator is bogus. But since super columns don&apos;t exist in CQL3, and since thrift don&apos;t allow to define ColumnDefinition that applies to only sub-component of composites, the patch just always use the &apos;else&apos; branch that does the right thing.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;all of the pycassa and phpcassa tests pass, and they cover this pretty well&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Alright, I&apos;ll consider that +1 enough &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. So committed, thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12570859" name="5287-pycassa-repro.py" size="601" author="thobbs" created="Mon, 25 Feb 2013 21:04:17 +0000"/>
                            <attachment id="12571242" name="5287.txt" size="1010" author="slebresne" created="Wed, 27 Feb 2013 18:45:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>314487</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 38 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1i9pb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>314831</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>thobbs</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>