<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:07:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13441] Schema version changes for each upgraded node in a rolling upgrade, causing migration storms</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13441</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In versions &amp;lt; 3.0, during a rolling upgrade (say 2.0 -&amp;gt; 2.1), the first node to upgrade to 2.1 would add the new tables, setting the new 2.1 version ID, and subsequently upgraded hosts would settle on that version.&lt;/p&gt;

&lt;p&gt;When a 3.0 node upgrades and writes its own new-in-3.0 system tables, it&apos;ll write the same tables that exist in the schema with brand new timestamps. As written, this will cause all nodes in the cluster to change schema (to the version with the newest timestamp). On a sufficiently large cluster with a non-trivial schema, this could cause (literally) millions of migration tasks to needlessly bounce across the cluster.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="13063579">CASSANDRA-13441</key>
            <summary>Schema version changes for each upgraded node in a rolling upgrade, causing migration storms</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jjirsa">Jeff Jirsa</assignee>
                                    <reporter username="jjirsa">Jeff Jirsa</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Apr 2017 18:23:34 +0000</created>
                <updated>Fri, 15 May 2020 08:02:22 +0000</updated>
                            <resolved>Mon, 24 Apr 2017 16:13:45 +0000</resolved>
                                        <fixVersion>3.0.14</fixVersion>
                    <fixVersion>3.11.0</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Legacy/Distributed Metadata</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>13</watches>
                                                                                                                <comments>
                            <comment id="15966726" author="michaelsembwever" created="Wed, 12 Apr 2017 22:09:08 +0000"  >&lt;p&gt;I suspect we&apos;ll see a number of people doing 2.1.x and 2.2.x upgrades to 3.11.x (especially the bigger clusters after a few patch releases on 3.11), long before we see many upgrading to 4.0.x.&lt;/p&gt;

&lt;p&gt;Why not slate this for 3.11.x ?&lt;/p&gt;</comment>
                            <comment id="15966773" author="jjirsa" created="Wed, 12 Apr 2017 22:55:35 +0000"  >&lt;p&gt;The risk is that 3.11 is wire-compatible with 3.0, which means a 3.0 -&amp;gt; 3.11 upgrade would be ugly with this patch (constantly bouncing schemas back and forth between the 3.0 and 3.11 versions).&lt;/p&gt;</comment>
                            <comment id="15969282" author="jjirsa" created="Fri, 14 Apr 2017 17:22:36 +0000"  >&lt;p&gt;Patch for trunk at: &lt;a href=&quot;https://github.com/jeffjirsa/cassandra/tree/cassandra-13441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeffjirsa/cassandra/tree/cassandra-13441&lt;/a&gt;&lt;br/&gt;
CircleCI running unit tests: &lt;a href=&quot;https://circleci.com/gh/jeffjirsa/cassandra/tree/cassandra-13441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/gh/jeffjirsa/cassandra/tree/cassandra-13441&lt;/a&gt;&lt;br/&gt;
Dtest will run from here: &lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/13/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/13/&lt;/a&gt; (may be quite some time until dtests run, maybe available by Monday)&lt;/p&gt;
</comment>
                            <comment id="15972009" author="michaelsembwever" created="Tue, 18 Apr 2017 02:19:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;Patch for trunk at: &lt;a href=&quot;https://github.com/jeffjirsa/cassandra/tree/cassandra-13441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeffjirsa/cassandra/tree/cassandra-13441&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Did you push the branch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jjirsa&quot; class=&quot;user-hover&quot; rel=&quot;jjirsa&quot;&gt;jjirsa&lt;/a&gt; ? (i can&apos;t see any such branch in your fork)&lt;/p&gt;</comment>
                            <comment id="15972044" author="jjirsa" created="Tue, 18 Apr 2017 02:59:26 +0000"  >&lt;p&gt;Aleksey mentioned he had some concerns with the approach in IRC and, more importantly, suggested a cleaner way to do it (rather than change the hashing, write new system tables with fixed time stamps). &lt;/p&gt;

&lt;p&gt;Using this method, we&apos;re able to actually push this to 3.0, 3.11, and trunk without causing the ping-pong effect the original patch caused, and it&apos;s much cleaner (doesn&apos;t go all the way down into the storage engine). &lt;/p&gt;

&lt;p&gt;New patches here:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Branch &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Testall &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Dtest &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/jeffjirsa/cassandra/commits/cassandra-3.0-13441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://circleci.com/gh/jeffjirsa/cassandra/tree/cassandra-3.0-13441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/16/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/jeffjirsa/cassandra/commits/cassandra-3.11-13441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://circleci.com/gh/jeffjirsa/cassandra/tree/cassandra-3.11-13441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/17/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/jeffjirsa/cassandra/commits/cassandra-13441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://circleci.com/gh/jeffjirsa/cassandra/tree/cassandra-13441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/18/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt;(Unit and dtests are queued now but will likely take some time to complete)&lt;/p&gt;</comment>
                            <comment id="15972792" author="iamaleksey" created="Tue, 18 Apr 2017 14:30:29 +0000"  >&lt;p&gt;The patches look good to me. +1&lt;/p&gt;

&lt;p&gt;P.S. Thought initially that you overlooked specifying a 0 timestamp for keyspace metadata itself (replication params and durable_writes), but apparently there, in &lt;tt&gt;MigrationManager.maybeAddKeyspace()&lt;/tt&gt; we already do correctly set 0 timestamp. Makes me wonder how we forgot to do the same for tables back then.&lt;/p&gt;</comment>
                            <comment id="15981431" author="jjirsa" created="Mon, 24 Apr 2017 16:13:45 +0000"  >&lt;p&gt;Thanks for the review Aleksey.&lt;/p&gt;

&lt;p&gt;Committed as &lt;tt&gt;032a8cc1e9424c718a78e1463530d62e2e310d4a&lt;/tt&gt; &lt;/p&gt;</comment>
                            <comment id="16006613" author="juliuszaromskis" created="Thu, 11 May 2017 15:12:27 +0000"  >&lt;p&gt;Hi, any workaround for this issue? I&apos;ve hit this after upgrading from 3.0.9 to 3.0.13 and doing sstableupgrade. Noticed weird disk write patterns and started seeing migration tasks bouncing around. I&apos;ve only managed to update first of the 3 nodes. Migration tasks have stopped after I&apos;ve rebooted first node.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Cluster Information:
        Name: cloud.zaromskis.lt cluster
        Snitch: org.apache.cassandra.locator.DynamicEndpointSnitch
        Partitioner: org.apache.cassandra.dht.Murmur3Partitioner
        Schema versions:
                600b7268-d42a-3b72-8706-093b6c8cfaff: [10.240.0.6]
                77a40699-8e9e-35aa-834e-68c32e40a45a: [10.240.0.7, 10.240.0.8]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Datacenter: dc1
===============
Status=Up/Down
|/ State=Normal/Leaving/Joining/Moving
--  Address     Load       Tokens       Owns (effective)  Host ID                               Rack
UN  10.240.0.6  284.95 GB  256          63.4%             d0d83d9d-0dec-45cd-9ca9-93515fa131f3  rack1
UN  10.240.0.7  288.53 GB  256          64.1%             6d9709a0-0e10-46a1-9afa-d106b74ca9e0  rack1
UN  10.240.0.8  326.31 GB  256          72.5%             5c969700-8bd9-49a4-9772-1284439f8364  rack1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The migrations are in fact executed, as I can see that on the disk, new files are created every second in system keyspace. Why doesn&apos;t cluster settle on the same schema version then?&lt;/p&gt;

&lt;p&gt;The schema version of first node would not propagate to other nodes. I&apos;m afraid further upgrades might create new schema versions? I can&apos;t afford to lose any data. Any advise?&lt;/p&gt;
</comment>
                            <comment id="16006683" author="jjirsa" created="Thu, 11 May 2017 16:02:23 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=juliuszaromskis&quot; class=&quot;user-hover&quot; rel=&quot;juliuszaromskis&quot;&gt;juliuszaromskis&lt;/a&gt; - if you&apos;re upgrading from 3.0.9 to 3.0.13, it&apos;s unlikely that this is your issue (this would mostly impact people going from 2.1 -&amp;gt; 3.0, or 2.2 -&amp;gt; 3.0. Unless you&apos;re very confident that the schema version on &lt;tt&gt;10.240.0.6&lt;/tt&gt; is different and more desirable than that on the other two nodes, the most likely solution is to issue a &lt;tt&gt;nodetool resetlocalschema&lt;/tt&gt; on 10.240.0.6, allowing it to re-pull its schema from .7 and .8.&lt;/p&gt;
</comment>
                            <comment id="16006733" author="juliuszaromskis" created="Thu, 11 May 2017 16:35:17 +0000"  >&lt;p&gt;Here&apos;s a apiece of debug log, maybe this will help to identify if it&apos;s the same issue or not. &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;DEBUG [MemtableFlushWriter:107525] 2017-05-11 16:04:05,896 Memtable.java:401 - Completed flushing /mnt/storage/cassandra/data/system_schema/indexes-0feb57ac311f382fba6d9024d305702f/mc-22120-big-Data.db (0.098KiB) for commitlog position ReplayPosition(segmentId=1483955071260, position=8644066)
DEBUG [InternalResponseStage:589] 2017-05-11 16:04:05,941 MigrationManager.java:556 - Gossiping my schema version 77a40699-8e9e-35aa-834e-68c32e40a45a
DEBUG [InternalResponseStage:588] 2017-05-11 16:04:05,944 ColumnFamilyStore.java:850 - Enqueuing flush of keyspaces: 2079 (0%) on-heap, 0 (0%) off-heap
DEBUG [MemtableFlushWriter:107524] 2017-05-11 16:04:05,944 Memtable.java:368 - Writing Memtable-keyspaces@1326973542(0.582KiB serialized bytes, 4 ops, 0%/0% of on/off-heap limit)
DEBUG [MemtableFlushWriter:107524] 2017-05-11 16:04:05,951 Memtable.java:401 - Completed flushing /mnt/storage/cassandra/data/system_schema/keyspaces-abac5682dea631c5b535b3d6cffd0fb6/mc-22200-big-Data.db (0.489KiB) for commitlog position ReplayPosition(segmentId=1483955071260, position=8685297)
DEBUG [InternalResponseStage:588] 2017-05-11 16:04:05,971 ColumnFamilyStore.java:850 - Enqueuing flush of tables: 65895 (0%) on-heap, 0 (0%) off-heap
DEBUG [MemtableFlushWriter:107525] 2017-05-11 16:04:05,972 Memtable.java:368 - Writing Memtable-tables@512792876(20.714KiB serialized bytes, 31 ops, 0%/0% of on/off-heap limit)
DEBUG [MemtableFlushWriter:107525] 2017-05-11 16:04:05,980 Memtable.java:401 - Completed flushing /mnt/storage/cassandra/data/system_schema/tables-afddfb9dbc1e30688056eed6c302ba09/mc-22197-big-Data.db (13.019KiB) for commitlog position ReplayPosition(segmentId=1483955071260, position=8700606)
DEBUG [InternalResponseStage:588] 2017-05-11 16:04:06,005 ColumnFamilyStore.java:850 - Enqueuing flush of columns: 204664 (0%) on-heap, 0 (0%) off-heap
DEBUG [MemtableFlushWriter:107524] 2017-05-11 16:04:06,006 Memtable.java:368 - Writing Memtable-columns@643217662(43.015KiB serialized bytes, 286 ops, 0%/0% of on/off-heap limit)
DEBUG [MemtableFlushWriter:107524] 2017-05-11 16:04:06,018 Memtable.java:401 - Completed flushing /mnt/storage/cassandra/data/system_schema/columns-24101c25a2ae3af787c1b40ee1aca33f/mc-22195-big-Data.db (20.975KiB) for commitlog position ReplayPosition(segmentId=1483955071260, position=8707212)
DEBUG [CompactionExecutor:47263] 2017-05-11 16:04:06,055 CompactionTask.java:146 - Compacting (75968370-3663-11e7-ab7b-d7e32ecfc62d) [/mnt/storage/cassandra/data/system_schema/columns-24101c25a2ae3af787c1b40ee1aca33f/mc-22193-big-Data.db:level=0, /mnt/storage/cassandra/data/system_schema/columns-24101c25a2ae3af787c1b40ee1aca33f/mc-22194-big-Data.db:level=0, /mnt/storage/cassandra/data/system_schema/columns-24101c25a2ae3af787c1b40ee1aca33f/mc-22192-big-Data.db:level=0, /mnt/storage/cassandra/data/system_schema/columns-24101c25a2ae3af787c1b40ee1aca33f/mc-22195-big-Data.db:level=0, ]
DEBUG [MemtablePostFlush:95264] 2017-05-11 16:04:06,057 ColumnFamilyStore.java:903 - forceFlush requested but everything is clean in dropped_columns
DEBUG [MemtablePostFlush:95264] 2017-05-11 16:04:06,057 ColumnFamilyStore.java:903 - forceFlush requested but everything is clean in triggers
DEBUG [MemtablePostFlush:95264] 2017-05-11 16:04:06,057 ColumnFamilyStore.java:903 - forceFlush requested but everything is clean in views
DEBUG [MemtablePostFlush:95264] 2017-05-11 16:04:06,057 ColumnFamilyStore.java:903 - forceFlush requested but everything is clean in types
DEBUG [MemtablePostFlush:95264] 2017-05-11 16:04:06,057 ColumnFamilyStore.java:903 - forceFlush requested but everything is clean in functions
DEBUG [MemtablePostFlush:95264] 2017-05-11 16:04:06,057 ColumnFamilyStore.java:903 - forceFlush requested but everything is clean in aggregates
DEBUG [InternalResponseStage:588] 2017-05-11 16:04:06,057 ColumnFamilyStore.java:850 - Enqueuing flush of indexes: 598 (0%) on-heap, 0 (0%) off-heap
DEBUG [MemtableFlushWriter:107525] 2017-05-11 16:04:06,057 Memtable.java:368 - Writing Memtable-indexes@1653592334(0.127KiB serialized bytes, 1 ops, 0%/0% of on/off-heap limit)
DEBUG [MemtableFlushWriter:107525] 2017-05-11 16:04:06,068 Memtable.java:401 - Completed flushing /mnt/storage/cassandra/data/system_schema/indexes-0feb57ac311f382fba6d9024d305702f/mc-22121-big-Data.db (0.098KiB) for commitlog position ReplayPosition(segmentId=1483955071260, position=8742156)
DEBUG [CompactionExecutor:47266] 2017-05-11 16:04:06,090 CompactionTask.java:146 - Compacting (759bdaa0-3663-11e7-ab7b-d7e32ecfc62d) [/mnt/storage/cassandra/data/system_schema/indexes-0feb57ac311f382fba6d9024d305702f/mc-22120-big-Data.db:level=0, /mnt/storage/cassandra/data/system_schema/indexes-0feb57ac311f382fba6d9024d305702f/mc-22121-big-Data.db:level=0, /mnt/storage/cassandra/data/system_schema/indexes-0feb57ac311f382fba6d9024d305702f/mc-22119-big-Data.db:level=0, /mnt/storage/cassandra/data/system_schema/indexes-0feb57ac311f382fba6d9024d305702f/mc-22118-big-Data.db:level=0, ]
DEBUG [InternalResponseStage:588] 2017-05-11 16:04:06,112 MigrationManager.java:556 - Gossiping my schema version 77a40699-8e9e-35aa-834e-68c32e40a45a
DEBUG [CompactionExecutor:47263] 2017-05-11 16:04:06,120 CompactionTask.java:218 - Compacted (75968370-3663-11e7-ab7b-d7e32ecfc62d) 4 sstables to [/mnt/storage/cassandra/data/system_schema/columns-24101c25a2ae3af787c1b40ee1aca33f/mc-22196-big,] to level=0.  29,348 bytes to 10,277 (~35% of original) in 64ms = 0.153139MB/s.  0 total partitions merged to 6.  Partition merge counts were {1:2, 4:4, }
DEBUG [CompactionExecutor:47266] 2017-05-11 16:04:06,136 CompactionTask.java:218 - Compacted (759bdaa0-3663-11e7-ab7b-d7e32ecfc62d) 4 sstables to [/mnt/storage/cassandra/data/system_schema/indexes-0feb57ac311f382fba6d9024d305702f/mc-22122-big,] to level=0.  392 bytes to 98 (~25% of original) in 45ms = 0.002077MB/s.  0 total partitions merged to 1.  Partition merge counts were {4:1, }
DEBUG [NonPeriodicTasks:1] 2017-05-11 16:04:06,782 MigrationManager.java:124 - submitting migration task for /10.240.0.6
DEBUG [NonPeriodicTasks:1] 2017-05-11 16:04:06,782 MigrationManager.java:124 - submitting migration task for /10.240.0.7
DEBUG [InternalResponseStage:586] 2017-05-11 16:04:06,792 ColumnFamilyStore.java:850 - Enqueuing flush of keyspaces: 2079 (0%) on-heap, 0 (0%) off-heap
DEBUG [MemtableFlushWriter:107524] 2017-05-11 16:04:06,793 Memtable.java:368 - Writing Memtable-keyspaces@847538504(0.582KiB serialized bytes, 4 ops, 0%/0% of on/off-heap limit)
DEBUG [MemtableFlushWriter:107524] 2017-05-11 16:04:06,799 Memtable.java:401 - Completed flushing /mnt/storage/cassandra/data/system_schema/keyspaces-abac5682dea631c5b535b3d6cffd0fb6/mc-22201-big-Data.db (0.489KiB) for commitlog position ReplayPosition(segmentId=1483955071260, position=8939092)
DEBUG [CompactionExecutor:47266] 2017-05-11 16:04:06,816 CompactionTask.java:146 - Compacting (760aa200-3663-11e7-ab7b-d7e32ecfc62d) [/mnt/storage/cassandra/data/system_schema/keyspaces-abac5682dea631c5b535b3d6cffd0fb6/mc-22201-big-Data.db:level=0, /mnt/storage/cassandra/data/system_schema/keyspaces-abac5682dea631c5b535b3d6cffd0fb6/mc-22198-big-Data.db:level=0, /mnt/storage/cassandra/data/system_schema/keyspaces-abac5682dea631c5b535b3d6cffd0fb6/mc-22199-big-Data.db:level=0, /mnt/storage/cassandra/data/system_schema/keyspaces-abac5682dea631c5b535b3d6cffd0fb6/mc-22200-big-Data.db:level=0, ]
DEBUG [InternalResponseStage:586] 2017-05-11 16:04:06,816 ColumnFamilyStore.java:850 - Enqueuing flush of tables: 65895 (0%) on-heap, 0 (0%) off-heap
DEBUG [MemtableFlushWriter:107525] 2017-05-11 16:04:06,817 Memtable.java:368 - Writing Memtable-tables@1477384931(20.714KiB serialized bytes, 31 ops, 0%/0% of on/off-heap limit)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This has continued for several hours until &apos;ve decided to continue with the migration to 3.0.13, here&apos;s the result:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Cluster Information:
        Name: cloud.zaromskis.lt cluster
        Snitch: org.apache.cassandra.locator.DynamicEndpointSnitch
        Partitioner: org.apache.cassandra.dht.Murmur3Partitioner
        Schema versions:
                600b7268-d42a-3b72-8706-093b6c8cfaff: [10.240.0.6, 10.240.0.7, 10.240.0.8]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looks like cluster is consistent now&lt;/p&gt;</comment>
                            <comment id="16077657" author="xuzhongxing" created="Fri, 7 Jul 2017 06:07:53 +0000"  >&lt;p&gt;I still see this when a new node is joining the cluster. The cassandra version are all 3.11.0&lt;/p&gt;

&lt;p&gt;ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; 2017-07-07 13:56:29,873 MigrationManager.java:172 - Migration task failed to complete&lt;/p&gt;</comment>
                            <comment id="16170066" author="juliuszaromskis" created="Mon, 18 Sep 2017 14:11:54 +0000"  >&lt;p&gt;This has indeed resolved an issue I was having. Using 3.0.14 now.&lt;/p&gt;

&lt;p&gt;Note: if anyone else has problems adding new nodes or datacenter to the cluster, this resolves an issue with schema version mismatch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12977044">CASSANDRA-11983</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13097875">CASSANDRA-13812</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jjirsa]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12984" cascade-level=""><![CDATA[Degradation]]></customfieldvalue>
                                <customfieldvalue key="12997" cascade-level="1"><![CDATA[Performance Bug/Regression]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 9 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3djwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aleksey</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>