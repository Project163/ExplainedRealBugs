<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:09:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13883] StrictLiveness for view row is not handled in AbstractRow</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13883</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In &lt;tt&gt;AbstractRow.hasLiveData(nowInSecond)&lt;/tt&gt;, it doesn&apos;t handle &lt;tt&gt;strictLiveness&lt;/tt&gt; introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11500&quot; title=&quot;Obsolete MV entry may not be properly deleted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11500&quot;&gt;&lt;del&gt;CASSANDRA-11500&lt;/del&gt;&lt;/a&gt;. The &lt;tt&gt;DataLimits&lt;/tt&gt; counts the expired view row as live data and then the expired view row is purged in &lt;tt&gt;Row.purge()&lt;/tt&gt;. When query with limit, we will get less data.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;test to reproduce&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testRegularColumnTimestampUpdates() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Throwable
    {
        createTable(&lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE TABLE %s (&quot;&lt;/span&gt; +
                    &lt;span class=&quot;code-quote&quot;&gt;&quot;k &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; PRIMARY KEY, &quot;&lt;/span&gt; +
                    &lt;span class=&quot;code-quote&quot;&gt;&quot;c &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, &quot;&lt;/span&gt; +
                    &lt;span class=&quot;code-quote&quot;&gt;&quot;val &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)&quot;&lt;/span&gt;);

        execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;USE &quot;&lt;/span&gt; + keyspace());
        executeNet(protocolVersion, &lt;span class=&quot;code-quote&quot;&gt;&quot;USE &quot;&lt;/span&gt; + keyspace());

        createView(&lt;span class=&quot;code-quote&quot;&gt;&quot;mv_rctstest&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND c IS NOT NULL PRIMARY KEY (k,c)&quot;&lt;/span&gt;);

        updateView(&lt;span class=&quot;code-quote&quot;&gt;&quot;UPDATE %s SET c = ?, val = ? WHERE k = ?&quot;&lt;/span&gt;, 0, 0, 0);
        updateView(&lt;span class=&quot;code-quote&quot;&gt;&quot;UPDATE %s SET val = ? WHERE k = ?&quot;&lt;/span&gt;, 1, 0);
        updateView(&lt;span class=&quot;code-quote&quot;&gt;&quot;UPDATE %s SET c = ? WHERE k = ?&quot;&lt;/span&gt;, 1, 0);
        assertRows(execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT c, k, val FROM mv_rctstest&quot;&lt;/span&gt;), row(1, 0, 1));

        updateView(&lt;span class=&quot;code-quote&quot;&gt;&quot;TRUNCATE %s&quot;&lt;/span&gt;);

        updateView(&lt;span class=&quot;code-quote&quot;&gt;&quot;UPDATE %s USING TIMESTAMP 1 SET c = ?, val = ? WHERE k = ?&quot;&lt;/span&gt;, 0, 0, 0);
        updateView(&lt;span class=&quot;code-quote&quot;&gt;&quot;UPDATE %s USING TIMESTAMP 3 SET c = ? WHERE k = ?&quot;&lt;/span&gt;, 1, 0);
        updateView(&lt;span class=&quot;code-quote&quot;&gt;&quot;UPDATE %s USING TIMESTAMP 2 SET val = ? WHERE k = ?&quot;&lt;/span&gt;, 1, 0);
        updateView(&lt;span class=&quot;code-quote&quot;&gt;&quot;UPDATE %s USING TIMESTAMP 4 SET c = ? WHERE k = ?&quot;&lt;/span&gt;, 2, 0);
        updateView(&lt;span class=&quot;code-quote&quot;&gt;&quot;UPDATE %s USING TIMESTAMP 3 SET val = ? WHERE k = ?&quot;&lt;/span&gt;, 2, 0);

        &lt;span class=&quot;code-comment&quot;&gt;// FIXME no rows &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;
&lt;/span&gt;        assertRows(execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT c, k, val FROM mv_rctstest limit 1&quot;&lt;/span&gt;), row(2, 0, 2));
        assertRows(execute(&lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT c, k, val FROM mv_rctstest&quot;&lt;/span&gt;), row(2, 0, 2));
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13102947">CASSANDRA-13883</key>
            <summary>StrictLiveness for view row is not handled in AbstractRow</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jasonstack">Zhao Yang</assignee>
                                    <reporter username="jasonstack">Zhao Yang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Sep 2017 12:41:27 +0000</created>
                <updated>Fri, 15 May 2020 08:02:18 +0000</updated>
                            <resolved>Mon, 25 Sep 2017 06:44:30 +0000</resolved>
                                        <fixVersion>3.0.15</fixVersion>
                    <fixVersion>3.11.1</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Feature/Materialized Views</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16172606" author="jasonstack" created="Wed, 20 Sep 2017 01:52:50 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; source &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; unit &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; dtest &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...jasonstack:CASSANDRA-13883-trunk?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://circleci.com/gh/jasonstack/cassandra/627&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;passed&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   repair_tests.repair_test.TestRepair.dc_parallel_repair_test&lt;br/&gt;
repair_tests.repair_test.TestRepair.dc_repair_test&lt;br/&gt;
repair_tests.repair_test.TestRepair.local_dc_repair_test&lt;br/&gt;
repair_tests.repair_test.TestRepair.simple_parallel_repair_test&lt;br/&gt;
repair_tests.repair_test.TestRepair.thread_count_repair_test&lt;br/&gt;
upgrade_internal_auth_test.TestAuthUpgrade.upgrade_to_22_test&lt;br/&gt;
upgrade_internal_auth_test.TestAuthUpgrade.upgrade_to_30_test&lt;br/&gt;
auth_test.TestAuth.system_auth_ks_is_alterable_test&lt;br/&gt;
disk_balance_test.TestDiskBalance.disk_balance_decommission_test&lt;br/&gt;
cdc_test.TestCDC.test_insertion_and_commitlog_behavior_after_reaching_cdc_total_space&lt;br/&gt;
cdc_test.TestCDC.test_insertion_and_commitlog_behavior_after_reaching_cdc_total_space&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.11...jasonstack:CASSANDRA-13883-3.11?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://circleci.com/gh/jasonstack/cassandra/625&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;passed&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; upgrade_internal_auth_test.TestAuthUpgrade.upgrade_to_22_test&lt;br/&gt;
upgrade_internal_auth_test.TestAuthUpgrade.upgrade_to_30_test&lt;br/&gt;
auth_test.TestAuth.system_auth_ks_is_alterable_test &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.0...jasonstack:CASSANDRA-13883-3.0?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://circleci.com/gh/jasonstack/cassandra/628&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;passed&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; global_row_key_cache_test.TestGlobalRowKeyCache.functional_test&lt;br/&gt;
repair_tests.incremental_repair_test.TestIncRepair.multiple_repair_test&lt;br/&gt;
upgrade_internal_auth_test.TestAuthUpgrade.upgrade_to_22_test&lt;br/&gt;
upgrade_internal_auth_test.TestAuthUpgrade.upgrade_to_30_test &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/apache/cassandra-dtest/compare/master...jasonstack:CASSANDRA-13883?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;CI looks good, failure seems unrelated.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Changes:
    1. Change {{AbstractRow.hasLiveData}} to check {{enforceStrictLiveness}}:  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; livenessInfo is not live and enforceStrictLiveness, then there is not live data.
    2. For SPRC.group, use the first command to get {{enforceStrictLiveness}} since each command should be the same except &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; key.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16178602" author="pauloricardomg" created="Mon, 25 Sep 2017 06:44:30 +0000"  >&lt;p&gt;Oh, it seems like this was in the original version of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11500&quot; title=&quot;Obsolete MV entry may not be properly deleted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11500&quot;&gt;&lt;del&gt;CASSANDRA-11500&lt;/del&gt;&lt;/a&gt;, and missed during the final refactor. Good catch!&lt;/p&gt;

&lt;p&gt;Patch LGTM, committed as &lt;tt&gt;68bdf45477417c97fa6ed3840eee39b8390fd678&lt;/tt&gt; on cassandra-3.0 and merged up to trunk, and cassandra-dtest commit as &lt;tt&gt;2a1ce8450d1876c3df58ea7e85d352c428de2ca2&lt;/tt&gt;. Thanks!&lt;/p&gt;</comment>
                            <comment id="16178755" author="jasonstack" created="Mon, 25 Sep 2017 09:08:19 +0000"  >&lt;p&gt;Thanks for reviewing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jasonstack]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 8 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3k6pj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>pauloricardomg</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>