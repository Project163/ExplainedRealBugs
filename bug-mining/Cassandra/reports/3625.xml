<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:54:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-9559] IndexOutOfBoundsException inserting into TupleType</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-9559</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Trying to run this query on the 2.2 branch resulted in IndexOutOfBoundsException:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;INSERT INTO datatypes.alltypes (pk,c_tuple) VALUES (1,&apos;01:02:03.456789012&apos;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The column &lt;tt&gt;c_tuple&lt;/tt&gt; is of type &lt;tt&gt;tuple&amp;lt;int&amp;gt;&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;The cause seems to be that &lt;tt&gt;TupleType.fromString&lt;/tt&gt; is splitting the source string on &lt;tt&gt;:&lt;/tt&gt; (meant for UDT only?) but does not consider that the number of those fields may exceed the number of types defined in the Tuple. &lt;/p&gt;

&lt;p&gt;A simple fix would be to bound the for loop with &lt;tt&gt;types.size()&lt;/tt&gt; instead of &lt;tt&gt;fieldStrings.size()&lt;/tt&gt; but still some error should be raised if &lt;tt&gt;fieldStrings.size() &amp;gt; types.size()&lt;/tt&gt;.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.IndexOutOfBoundsException: Index: 1, Size: 1
        at java.util.ArrayList.rangeCheck(ArrayList.java:635) ~[na:1.7.0_51]
        at java.util.ArrayList.get(ArrayList.java:411) ~[na:1.7.0_51]
        at org.apache.cassandra.db.marshal.TupleType.type(TupleType.java:60) ~[main/:na]
        at org.apache.cassandra.db.marshal.TupleType.fromString(TupleType.java:224) ~[main/:na]
        at org.apache.cassandra.cql3.Constants$Literal.parsedValue(Constants.java:152) ~[main/:na]
        at org.apache.cassandra.cql3.Constants$Literal.prepare(Constants.java:138) ~[main/:na]
        at org.apache.cassandra.cql3.Constants$Literal.prepare(Constants.java:91) ~[main/:na]
        at org.apache.cassandra.cql3.Operation$SetValue.prepare(Operation.java:167) ~[main/:na]
        at org.apache.cassandra.cql3.statements.UpdateStatement$ParsedInsert.prepareInternal(UpdateStatement.java:213) ~[main/:na]
        at org.apache.cassandra.cql3.statements.ModificationStatement$Parsed.prepare(ModificationStatement.java:710) ~[main/:na]
        at org.apache.cassandra.cql3.statements.ModificationStatement$Parsed.prepare(ModificationStatement.java:698) ~[main/:na]
        at org.apache.cassandra.cql3.QueryProcessor.getStatement(QueryProcessor.java:493) ~[main/:na]
        at org.apache.cassandra.cql3.QueryProcessor.process(QueryProcessor.java:247) ~[main/:na]
        at org.apache.cassandra.cql3.QueryProcessor.process(QueryProcessor.java:241) ~[main/:na]
        at org.apache.cassandra.transport.messages.QueryMessage.execute(QueryMessage.java:119) ~[main/:na]
        at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:507) [main/:na]
        at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:401) [main/:na]
        at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105) [netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:333) [netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.channel.AbstractChannelHandlerContext.access$700(AbstractChannelHandlerContext.java:32) [netty-all-4.0.23.Final.jar:4.0.23.Final]
        at io.netty.channel.AbstractChannelHandlerContext$8.run(AbstractChannelHandlerContext.java:324) [netty-all-4.0.23.Final.jar:4.0.23.Final]
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471) [na:1.7.0_51]
        at org.apache.cassandra.concurrent.AbstractTracingAwareExecutorService$FutureTask.run(AbstractTracingAwareExecutorService.java:164) [main/:na]
        at org.apache.cassandra.concurrent.SEPWorker.run(SEPWorker.java:105) [main/:na]
        at java.lang.Thread.run(Thread.java:744) [na:1.7.0_51]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12835842">CASSANDRA-9559</key>
            <summary>IndexOutOfBoundsException inserting into TupleType</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blerer">Benjamin Lerer</assignee>
                                    <reporter username="djatnieks">dan jatnieks</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Jun 2015 22:07:21 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:08 +0000</updated>
                            <resolved>Fri, 26 Jun 2015 17:34:38 +0000</resolved>
                                        <fixVersion>2.1.8</fixVersion>
                    <fixVersion>2.2.0 rc2</fixVersion>
                                    <component>Legacy/CQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14575361" author="jbellis" created="Fri, 5 Jun 2015 22:38:50 +0000"  >&lt;p&gt;This works correctly in 2.1?&lt;/p&gt;</comment>
                            <comment id="14575409" author="djatnieks" created="Fri, 5 Jun 2015 23:38:36 +0000"  >&lt;p&gt;Just checked 2.1.3 and got the same exception.&lt;/p&gt;</comment>
                            <comment id="14580432" author="blerer" created="Wed, 10 Jun 2015 12:03:34 +0000"  >&lt;p&gt;The patch checks that the number of elements match the expected one and throw an Exception if it is not the case. It also add a test to check the behavior.&lt;/p&gt;
</comment>
                            <comment id="14598173" author="thobbs" created="Tue, 23 Jun 2015 18:57:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blerer&quot; class=&quot;user-hover&quot; rel=&quot;blerer&quot;&gt;blerer&lt;/a&gt; it looks like the size check is incorrect.  It should be checking if &lt;tt&gt;fieldStrings.size() &amp;gt; size()&lt;/tt&gt;.  Also, can you make the error message match the non-string message?  And can you add test cases for successful string decoding?&lt;/p&gt;</comment>
                            <comment id="14601746" author="blerer" created="Thu, 25 Jun 2015 19:02:56 +0000"  >&lt;p&gt;The patch fixes the issues found.&lt;/p&gt;

&lt;p&gt;The unit tests results are &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-9559-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; and the DTests results are &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-9559-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14603267" author="thobbs" created="Fri, 26 Jun 2015 17:34:38 +0000"  >&lt;p&gt;+1, committed to 2.1 as &lt;tt&gt;c233270643d0a887dc84ae90573176eb52f8ca93&lt;/tt&gt; and merged to 2.2 and trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12741923" name="9559-2.txt" size="3941" author="blerer" created="Thu, 25 Jun 2015 19:02:56 +0000"/>
                            <attachment id="12738807" name="9559.txt" size="2813" author="blerer" created="Wed, 10 Jun 2015 12:03:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 21 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fpdj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324945">2.2.0 beta 1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>thobbs</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12328951">2.1.3</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>