<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:12:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-15002] Avoid leaking threads when anticompaction fails</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-15002</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;If anticompaction fails on a node, a message is sent to all repair participants that this session is failed. If the other participants successfully finish their anticompactions we will not shut down the executor in `LocalSessions` since we can&apos;t change the state from &quot;FAILED&quot; to &quot;PREPARED&quot; and throw exception before calling shutdown.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13212868">CASSANDRA-15002</key>
            <summary>Avoid leaking threads when anticompaction fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marcuse">Marcus Eriksson</assignee>
                                    <reporter username="marcuse">Marcus Eriksson</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Jan 2019 17:49:25 +0000</created>
                <updated>Fri, 15 May 2020 08:04:35 +0000</updated>
                            <resolved>Thu, 31 Jan 2019 08:16:18 +0000</resolved>
                                        <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Consistency/Repair</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16756367" author="krummas" created="Wed, 30 Jan 2019 18:02:54 +0000"  >&lt;p&gt;Patch: &lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/15002&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/15002&lt;/a&gt;&lt;br/&gt;
Tests: &lt;a href=&quot;https://circleci.com/gh/krummas/workflows/cassandra/tree/marcuse%2F15002&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/gh/krummas/workflows/cassandra/tree/marcuse%2F15002&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The branch contains 2 commits, first one fixes the thread leak and retries acquiring sstables for 1 minute, the second commit adds rate limiting to anticompaction and makes anticompactions stoppable again (should have been done in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-14935&quot; title=&quot;PendingAntiCompaction should be more judicious in the compactions it cancels&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-14935&quot;&gt;&lt;del&gt;CASSANDRA-14935&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;The reasoning behind adding retries when trying to acquire sstables is that if there is an sstable &lt;span class=&quot;error&quot;&gt;&amp;#91;0, 100&amp;#93;&lt;/span&gt; and the user submits a repair on &lt;span class=&quot;error&quot;&gt;&amp;#91;0, 50&amp;#93;&lt;/span&gt;, we will anticompact the sstable in to two new sstables &lt;span class=&quot;error&quot;&gt;&amp;#91;0, 50&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;51, 100&amp;#93;&lt;/span&gt; - if a user submits a repair on &lt;span class=&quot;error&quot;&gt;&amp;#91;51, 100&amp;#93;&lt;/span&gt; while the first anticompaction is executing, we would fail immediately, since the sstable the new repair requires is busy anticompacting. By retrying to acquire sstables we give the first anticompaction a chance to finish and the new repair would be able to grab the new &lt;span class=&quot;error&quot;&gt;&amp;#91;51, 100&amp;#93;&lt;/span&gt; sstable - it does not need to wait for the whole first repair to finish.&lt;/p&gt;</comment>
                            <comment id="16756718" author="bdeggleston" created="Thu, 31 Jan 2019 00:12:56 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16756995" author="krummas" created="Thu, 31 Jan 2019 08:16:18 +0000"  >&lt;p&gt;And committed as &lt;tt&gt;7f634feb7cf1fdb135133946ffd75efa681b8cb7&lt;/tt&gt;, thanks&lt;/p&gt;

&lt;p&gt;Ran the failing test in a loop locally successfully, don&apos;t think this patch caused the test failure&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi0hps:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>bdeggleston</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bdeggleston]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>