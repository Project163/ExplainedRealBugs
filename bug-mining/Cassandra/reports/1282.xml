<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:27:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3484] Bizarre Compaction Manager Behaviour</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3484</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;It seems the CompactionManager has gotten itself into a bad state. My 1.0.2 node has been up for 20 hours now - checking via JMX, the compaction manager is reporting that it has completed 14,797,412,000 tasks. Yep, thats right 14 billion tasks and increasing at a rate of roughly 208,400/second. &lt;/p&gt;

&lt;p&gt;I should point out that I am currently running a major compaction on the node. My theory is that this problem was introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3363&quot; title=&quot;Allow one leveled compaction task to kick off another&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3363&quot;&gt;&lt;del&gt;CASSANDRA-3363&lt;/del&gt;&lt;/a&gt;. It looks like SizeTieredCompactionStrategy.getBackgroundTasks() returns a set of task without consideration for any in-progress compactions. Compactions are only kicked off if task.markSSTablesForCompaction() returns true (CompactionManager line 127) but the task resubmission is based only on the task list not being empty (CompactionManager line 141). Should the logic not be to only reschedule if a task has actually been executed?&lt;/p&gt;

&lt;p&gt;I am just waiting now for the major compaction to finish to see if the problem goes away as would be suggested by my theory.&lt;/p&gt;</description>
                <environment>&lt;p&gt;RHEL 6&lt;br/&gt;
java version &quot;1.6.0_26&quot;&lt;br/&gt;
6 node cluster (5 nodes 0.8.6, 1 node 1.0.2 minus &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2503&quot; title=&quot;Eagerly re-write data at read time (&amp;quot;superseding / defragmenting&amp;quot;)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2503&quot;&gt;&lt;del&gt;CASSANDRA-2503&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</environment>
        <key id="12531167">CASSANDRA-3484</key>
            <summary>Bizarre Compaction Manager Behaviour</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dhendry">Dan Hendry</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Nov 2011 19:04:32 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:46 +0000</updated>
                            <resolved>Fri, 11 Nov 2011 20:01:39 +0000</resolved>
                                        <fixVersion>1.0.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13148662" author="dhendry" created="Fri, 11 Nov 2011 19:07:21 +0000"  >&lt;p&gt;JMX evidence&lt;/p&gt;</comment>
                            <comment id="13148672" author="dhendry" created="Fri, 11 Nov 2011 19:19:13 +0000"  >&lt;p&gt;Patch to only reschedule another compaction check when the active check resulted in a task being executed&lt;/p&gt;</comment>
                            <comment id="13148675" author="jbellis" created="Fri, 11 Nov 2011 19:24:20 +0000"  >&lt;p&gt;I think the patch on #2407 would also fix this.&lt;/p&gt;</comment>
                            <comment id="13148681" author="dhendry" created="Fri, 11 Nov 2011 19:33:15 +0000"  >&lt;p&gt;Yes it would. The issue seemed to result in some pretty significant temporary performance degradation. Any chance of getting 2407 into 1.0.3 instead of 1.1?&lt;/p&gt;</comment>
                            <comment id="13148697" author="slebresne" created="Fri, 11 Nov 2011 19:47:35 +0000"  >&lt;p&gt;We can commit either this patch or the one on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2407&quot; title=&quot;Compaction thread should try to empty a bucket before moving on&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2407&quot;&gt;&lt;del&gt;CASSANDRA-2407&lt;/del&gt;&lt;/a&gt; for this issue (since they both fix the issue here). But the goal of #2407 is a bit different so we just should leave that issue solve the problem it want to solve.&lt;/p&gt;</comment>
                            <comment id="13148708" author="slebresne" created="Fri, 11 Nov 2011 20:01:39 +0000"  >&lt;p&gt;Alright, +1 on the patch here, committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12503407" name="3484.txt" size="1321" author="dhendry" created="Fri, 11 Nov 2011 19:19:12 +0000"/>
                            <attachment id="12503403" name="compaction.png" size="31273" author="dhendry" created="Fri, 11 Nov 2011 19:07:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>216905</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gkh3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94747</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>