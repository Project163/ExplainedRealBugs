<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:01:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11123] cqlsh pg-style-strings broken if line ends with &apos;;&apos;</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11123</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;If one separate line in a multi-line pg-style-string ends with a semicolon in cqlsh, cqlsh incorrectly assumes that that is the end of the statement.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh:foo&amp;gt; insert into tab (pk, val) values (2, $$
       ... wepofjef
       ... wefoijew
       ... ;
SyntaxException: &amp;lt;ErrorMessage code=2000 [Syntax error in CQL query] message=&lt;span class=&quot;code-quote&quot;&gt;&quot;line 4:0 mismatched character &lt;span class=&quot;code-quote&quot;&gt;&apos;;&apos;&lt;/span&gt; expecting &lt;span class=&quot;code-quote&quot;&gt;&apos;$&apos;&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12937017">CASSANDRA-11123</key>
            <summary>cqlsh pg-style-strings broken if line ends with &apos;;&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="snazy">Robert Stupp</assignee>
                                    <reporter username="snazy">Robert Stupp</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Feb 2016 11:51:06 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:43 +0000</updated>
                            <resolved>Wed, 17 Feb 2016 12:45:28 +0000</resolved>
                                        <fixVersion>2.2.6</fixVersion>
                    <fixVersion>3.0.4</fixVersion>
                    <fixVersion>3.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15134120" author="snazy" created="Fri, 5 Feb 2016 12:54:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...snazy:11123-pg-semicolon-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;commit&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/job/snazy-11123-pg-semicolon-2.2-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Stefania&quot; class=&quot;user-hover&quot; rel=&quot;stefania&quot;&gt;Stefania&lt;/a&gt;, do you have some time to review?&lt;/p&gt;</comment>
                            <comment id="15134144" author="snazy" created="Fri, 5 Feb 2016 13:09:10 +0000"  >&lt;p&gt;Note: manually tested with &lt;tt&gt;SOURCE&lt;/tt&gt; command and &lt;tt&gt;-f&lt;/tt&gt; command line switch&lt;/p&gt;</comment>
                            <comment id="15136549" author="stefania" created="Mon, 8 Feb 2016 01:25:45 +0000"  >&lt;p&gt;The functionality seems correct, I tested it manually on Linux and it works as expected. As far as I understood from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7769&quot; title=&quot;Implement pg-style dollar syntax for string constants&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7769&quot;&gt;&lt;del&gt;CASSANDRA-7769&lt;/del&gt;&lt;/a&gt;, we only support &lt;tt&gt;$$&lt;/tt&gt; and we don&apos;t therefore support embedded pg-style-strings.&lt;/p&gt;

&lt;p&gt;Two things:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;cql_split_statements&lt;/tt&gt; is called by the cqlshlib tests as well, see &lt;tt&gt;test_cqlsh_parsing.py&lt;/tt&gt; and &lt;tt&gt;casconnect.py&lt;/tt&gt;. As a result, a number of cqlshlib tests are broken. To run these tests start up a cassandra node with a clean data folder, go into &lt;tt&gt;pylib/cqlshlib/test&lt;/tt&gt; and type &lt;tt&gt;nosetests&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;IMO we don&apos;t need to return two different boolean values from &lt;tt&gt;cql_split_statements&lt;/tt&gt; as they convey the same information as far as the callers are concerned, that is to continue parsing, so maybe only use one boolean with an appropriate name?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15142464" author="snazy" created="Thu, 11 Feb 2016 09:32:36 +0000"  >&lt;p&gt;Right, we do not support nested pg-style-strings.&lt;/p&gt;

&lt;p&gt;Updated the change of &lt;tt&gt;cql_split_statements&lt;/tt&gt; to just return a single boolean (as before) and pushed to my branch. That should fix both issues you raised in your comment.&lt;/p&gt;</comment>
                            <comment id="15143883" author="stefania" created="Fri, 12 Feb 2016 02:00:22 +0000"  >&lt;p&gt;The patch is fine but how about using &lt;tt&gt;in_multiline_statement&lt;/tt&gt; as in &lt;a href=&quot;https://github.com/stef1927/cassandra/commit/ed770d966a5a05dace0a3a9d25b125580098b8af&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this suggestion&lt;/a&gt;? At the minimum &lt;tt&gt;in_batch&lt;/tt&gt; in &lt;em&gt;cassconnect.py&lt;/em&gt; should be changed.&lt;/p&gt;

&lt;p&gt;Otherwise +1.&lt;/p&gt;</comment>
                            <comment id="15144094" author="stefania" created="Fri, 12 Feb 2016 05:47:03 +0000"  >&lt;p&gt;Actually &lt;tt&gt;in_multiline_statement&lt;/tt&gt; is not correct, perhaps something like &lt;tt&gt;endtoken_escaped&lt;/tt&gt; or &lt;tt&gt;endtoken_allowed&lt;/tt&gt; or similar. It&apos;s up to you, you can keep &lt;tt&gt;in_batch_or_pg_string&lt;/tt&gt; but do change &lt;tt&gt;in_batch&lt;/tt&gt; in &lt;em&gt;casconnect.py&lt;/em&gt;.&lt;/p&gt;</comment>
                            <comment id="15148967" author="snazy" created="Tue, 16 Feb 2016 17:39:07 +0000"  >&lt;p&gt;OK, renamed the variable in both places to &lt;tt&gt;end token_escaped&lt;/tt&gt; and pushed the branches. GTG?&lt;/p&gt;</comment>
                            <comment id="15149534" author="stefania" created="Tue, 16 Feb 2016 23:59:45 +0000"  >&lt;p&gt;Yes GTG, +1.&lt;/p&gt;</comment>
                            <comment id="15150444" author="snazy" created="Wed, 17 Feb 2016 12:45:28 +0000"  >&lt;p&gt;Thanks!&lt;br/&gt;
Committed as 97f3aa681d83a46b83593f79a7c2d15fb89be3c2 to cassandra-2.2 and merged to 3.0 and trunk.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12734245">CASSANDRA-7769</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[snazy]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 39 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2sh1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>stefania</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>