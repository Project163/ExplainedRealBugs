<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:13:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-15041] UncheckedExecutionException if authentication/authorization query fails</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-15041</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;If cache update for permissions/credentials/roles fails with UnavailableException this comes back to client as&#160;UncheckedExecutionException.&lt;/p&gt;

&lt;p&gt;Stack trace on server side:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR [Native-Transport-Requests-1] 2019-03-04 16:30:51,537 ErrorMessage.java:384 - Unexpected exception during request
com.google.common.util.concurrent.UncheckedExecutionException: com.google.common.util.concurrent.UncheckedExecutionException: java.lang.RuntimeException: org.apache.cassandra.exceptions.UnavailableException: Cannot achieve consistency level QUORUM
        at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2203) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache.get(LocalCache.java:3937) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) ~[guava-18.0.jar:na]
        at org.apache.cassandra.auth.AuthCache.get(AuthCache.java:97) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.PermissionsCache.getPermissions(PermissionsCache.java:45) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.AuthenticatedUser.getPermissions(AuthenticatedUser.java:104) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.ClientState.authorize(ClientState.java:439) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.ClientState.checkPermissionOnResourceChain(ClientState.java:368) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.ClientState.ensureHasPermission(ClientState.java:345) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.ClientState.hasAccess(ClientState.java:332) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.ClientState.hasColumnFamilyAccess(ClientState.java:310) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.cql3.statements.ModificationStatement.checkAccess(ModificationStatement.java:211) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.cql3.QueryProcessor.processStatement(QueryProcessor.java:222) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.cql3.QueryProcessor.processPrepared(QueryProcessor.java:532) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.cql3.QueryProcessor.processPrepared(QueryProcessor.java:509) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.transport.messages.ExecuteMessage.execute(ExecuteMessage.java:146) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:566) [apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.transport.Message$Dispatcher.channelRead0(Message.java:410) [apache-cassandra-3.11.4.jar:3.11.4]
        at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105) [netty-all-4.0.44.Final.jar:4.0.44.Final]
        at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:357) [netty-all-4.0.44.Final.jar:4.0.44.Final]
        at io.netty.channel.AbstractChannelHandlerContext.access$600(AbstractChannelHandlerContext.java:35) [netty-all-4.0.44.Final.jar:4.0.44.Final]
        at io.netty.channel.AbstractChannelHandlerContext$7.run(AbstractChannelHandlerContext.java:348) [netty-all-4.0.44.Final.jar:4.0.44.Final]
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_181]
        at org.apache.cassandra.concurrent.AbstractLocalAwareExecutorService$FutureTask.run(AbstractLocalAwareExecutorService.java:162) [apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.concurrent.SEPWorker.run(SEPWorker.java:114) [apache-cassandra-3.11.4.jar:3.11.4]
        at java.lang.Thread.run(Thread.java:748) [na:1.8.0_181]
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: java.lang.RuntimeException: org.apache.cassandra.exceptions.UnavailableException: Cannot achieve consistency level QUORUM
        at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2203) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache.get(LocalCache.java:3937) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3941) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4824) ~[guava-18.0.jar:na]
        at org.apache.cassandra.auth.AuthCache.get(AuthCache.java:97) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.RolesCache.getRoles(RolesCache.java:44) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.Roles.hasSuperuserStatus(Roles.java:51) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.AuthenticatedUser.isSuper(AuthenticatedUser.java:71) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.CassandraAuthorizer.authorize(CassandraAuthorizer.java:81) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.PermissionsCache.lambda$new$0(PermissionsCache.java:37) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.AuthCache$1.load(AuthCache.java:172) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) ~[guava-18.0.jar:na]
        ... 26 common frames omitted
Caused by: java.lang.RuntimeException: org.apache.cassandra.exceptions.UnavailableException: Cannot achieve consistency level QUORUM
        at org.apache.cassandra.auth.CassandraRoleManager.getRole(CassandraRoleManager.java:518) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.CassandraRoleManager.getRoles(CassandraRoleManager.java:283) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.RolesCache.lambda$new$0(RolesCache.java:36) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.AuthCache$1.load(AuthCache.java:172) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282) ~[guava-18.0.jar:na]
        at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197) ~[guava-18.0.jar:na]
        ... 40 common frames omitted
Caused by: org.apache.cassandra.exceptions.UnavailableException: Cannot achieve consistency level QUORUM
        at org.apache.cassandra.db.ConsistencyLevel.assureSufficientLiveNodes(ConsistencyLevel.java:334) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.AbstractReadExecutor.getReadExecutor(AbstractReadExecutor.java:162) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.StorageProxy$SinglePartitionReadLifecycle.&amp;lt;init&amp;gt;(StorageProxy.java:1766) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.StorageProxy.fetchRows(StorageProxy.java:1728) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.StorageProxy.readRegular(StorageProxy.java:1671) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.StorageProxy.read(StorageProxy.java:1586) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.db.SinglePartitionReadCommand$Group.execute(SinglePartitionReadCommand.java:1209) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.cql3.statements.SelectStatement.execute(SelectStatement.java:315) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.cql3.statements.SelectStatement.execute(SelectStatement.java:285) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.CassandraRoleManager.getRoleFromTable(CassandraRoleManager.java:526) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.CassandraRoleManager.getRole(CassandraRoleManager.java:508) ~[apache-cassandra-3.11.4.jar:3.11.4]
        ... 47 common frames omitted
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Also, if &lt;tt&gt;x_validity_in_ms&lt;/tt&gt; &amp;gt; &lt;tt&gt;x_update_interval_in_ms&lt;/tt&gt;, then the background update thread will fail in a similar way:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR [PermissionsCacheRefresh:1] 2019-03-04 16:30:43,541 CassandraDaemon.java:228 - Exception in thread Thread[PermissionsCacheRefresh:1,5,main]
java.lang.RuntimeException: org.apache.cassandra.exceptions.UnavailableException: Cannot achieve consistency level QUORUM
        at org.apache.cassandra.auth.CassandraRoleManager.getRole(CassandraRoleManager.java:518) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.CassandraRoleManager.isSuper(CassandraRoleManager.java:307) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.Roles.hasSuperuserStatus(Roles.java:52) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.AuthenticatedUser.isSuper(AuthenticatedUser.java:71) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.CassandraAuthorizer.authorize(CassandraAuthorizer.java:81) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.PermissionsCache.lambda$new$0(PermissionsCache.java:37) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.AuthCache$1.lambda$reload$0(AuthCache.java:180) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_181]
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[na:1.8.0_181]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_181]
        at org.apache.cassandra.concurrent.NamedThreadFactory.lambda$threadLocalDeallocator$0(NamedThreadFactory.java:81) [apache-cassandra-3.11.4.jar:3.11.4]
        at java.lang.Thread.run(Thread.java:748) ~[na:1.8.0_181]
Caused by: org.apache.cassandra.exceptions.UnavailableException: Cannot achieve consistency level QUORUM
        at org.apache.cassandra.db.ConsistencyLevel.assureSufficientLiveNodes(ConsistencyLevel.java:334) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.AbstractReadExecutor.getReadExecutor(AbstractReadExecutor.java:162) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.StorageProxy$SinglePartitionReadLifecycle.&amp;lt;init&amp;gt;(StorageProxy.java:1766) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.StorageProxy.fetchRows(StorageProxy.java:1728) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.StorageProxy.readRegular(StorageProxy.java:1671) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.service.StorageProxy.read(StorageProxy.java:1586) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.db.SinglePartitionReadCommand$Group.execute(SinglePartitionReadCommand.java:1209) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.cql3.statements.SelectStatement.execute(SelectStatement.java:315) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.cql3.statements.SelectStatement.execute(SelectStatement.java:285) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.CassandraRoleManager.getRoleFromTable(CassandraRoleManager.java:526) ~[apache-cassandra-3.11.4.jar:3.11.4]
        at org.apache.cassandra.auth.CassandraRoleManager.getRole(CassandraRoleManager.java:508) ~[apache-cassandra-3.11.4.jar:3.11.4]
        ... 11 common frames omitted
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13219327">CASSANDRA-15041</key>
            <summary>UncheckedExecutionException if authentication/authorization query fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eperott">Per Otterstr&#246;m</assignee>
                                    <reporter username="eperott">Per Otterstr&#246;m</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Mar 2019 16:32:03 +0000</created>
                <updated>Fri, 15 May 2020 08:06:06 +0000</updated>
                            <resolved>Fri, 5 Jul 2019 18:14:35 +0000</resolved>
                                        <fixVersion>2.2.15</fixVersion>
                    <fixVersion>3.0.19</fixVersion>
                    <fixVersion>3.11.5</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Feature/Authorization</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16841705" author="eperott" created="Thu, 16 May 2019 20:40:06 +0000"  >&lt;p&gt;So, this is mostly a cosmetic issue in the sense that there is no way to resolve the underlying problem - that not enough replicas are available to read from the system_auth tables. Still, this generates error messages that cause operators to jump, and Cassandra isn&apos;t behaving well towards clients when this happens.&lt;/p&gt;

&lt;p&gt;I&apos;ve updated the auth_test.py to use consistent cache settings and created a few new test cases to reproduce this issue in the scenario where not enough replicas are available. They revile unwanted behavior with small variation on different releases. In short:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;TC1 will trigger Cassandra to perform a background update of a cached credentials/roles/permissions entries.&lt;/li&gt;
	&lt;li&gt;TC2 will trigger authorization when cached entries have passed both update-interval and validity (blocking update)&lt;/li&gt;
	&lt;li&gt;TC3 will trigger authorization when cache is disabled.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Link to dtest&#160;&lt;a href=&quot;https://github.com/apache/cassandra-dtest/compare/master...eperott:cassandra-15041&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;m expecting Cassandra to fail gracefully on TC1, possibly with a warning, but no stack trace.&lt;/p&gt;

&lt;p&gt;I&apos;m expecting TC2 and TC3 to reject the request with exception to indicate not-authorized|unavailable|timeout, not sure which makes most sense. In any case, TC2 and TC3 should fail the same way and there should be no errors or stack traces in the log.&lt;/p&gt;

&lt;p&gt;Results on different releases:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;4.0: TC2 fail&lt;/li&gt;
	&lt;li&gt;3.11: TC1, TC2, TC3 and existing test_login fail&lt;/li&gt;
	&lt;li&gt;3.0: TC1, TC2 and TC3 fail&lt;/li&gt;
	&lt;li&gt;2.2: TC1, TC2 and TC3 fail&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;4.0 behaves generally better since a similar ticket as this one was fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13113&quot; title=&quot;test failure in auth_test.TestAuth.system_auth_ks_is_alterable_test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13113&quot;&gt;&lt;del&gt;CASSANDRA-13113&lt;/del&gt;&lt;/a&gt;. The reason TC2 fails is that the request actually will be authorized, even though the cached entries should have timed out. From what I can tell the cache is handing out stale entries.&lt;/p&gt;

&lt;p&gt;The reason test_login fail on 3.11 branch is that we&apos;re caching credentials since 3.4.&lt;/p&gt;

&lt;p&gt;All new test cases fail on 3.11, 3.0 and 2.2 as reported in this ticket.&lt;/p&gt;

&lt;p&gt;So far I&apos;ve made no attempt to work on a fix for this. Before we dive into that, I&apos;d like to get some feedback on the dtests and my findings above.&lt;/p&gt;

&lt;p&gt;TC2 and TC3 currently expect an UnavailableException and a message similar to &quot;Cannot achieve consistency level QUORUM&quot; at the client side, simply because this is the behavior in 4.0 branch. I feel this might confuse users a bit as the exception and message is related to the internal lookup on the system_auth.* table, rather than the actual query sent to the cluster. Would it make more sense to throw back an UnauthorizedException?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=beobal&quot; class=&quot;user-hover&quot; rel=&quot;beobal&quot;&gt;beobal&lt;/a&gt;&#160;and&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt;, you were both much involved in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13113&quot; title=&quot;test failure in auth_test.TestAuth.system_auth_ks_is_alterable_test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13113&quot;&gt;&lt;del&gt;CASSANDRA-13113&lt;/del&gt;&lt;/a&gt;. What are your thoughts on this?&lt;/p&gt;</comment>
                            <comment id="16842130" author="beobal" created="Fri, 17 May 2019 12:13:47 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eperott&quot; class=&quot;user-hover&quot; rel=&quot;eperott&quot;&gt;eperott&lt;/a&gt;.&#160;&lt;/p&gt;

&lt;p&gt;I agree that leaking the details about the failure back to the user and spamming the logs are not really desirable and probably quite confusing, so it would be great to fix them both. I&apos;m not totally convinced about changing the response type as an auth failure signifies incorrect credentials or insufficient privileges and so a client should not assume that retrying the request is a valid strategy. On the other hand, a server error indicates an issue outside the client&apos;s control and suggests that if the same request is sent again, it may be successful. We could definitely improve the text of the error response though to give a nicer message when this does occur.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;4.0: TC2 fail&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This appears to be due to a conflict in the Caffeine cache (earlier branches use Guava) between &lt;tt&gt;refreshAfterWrite&lt;/tt&gt; and &lt;tt&gt;expireAfterWrite&lt;/tt&gt;. Basically. the refresh keeps trying and failing, which prevents the expiration happening. I haven&apos;t been through the changelog to see exactly what the issue was, but upgrading to Caffeine 2.7.0 seems to fix this.&lt;/p&gt;</comment>
                            <comment id="16843347" author="eperott" created="Sun, 19 May 2019 08:21:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m not totally convinced about changing the response type as an auth failure signifies incorrect credentials or insufficient privileges and so a client should not assume that retrying the request is a valid strategy. On the other hand, a server error indicates an issue outside the client&apos;s control and suggests that if the same request is sent again, it may be successful.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;True. If we were to expose the internal RequestExecutionException, then clients might retry and succeed. Less headache for operators.&lt;/p&gt;

&lt;p&gt;But this all depends on the retry strategy of the client/driver and whether the actual client request is idempotent. This could also result in a ReadTimeoutException when the client actually is doing an INSERT, which might add to the confusion.&lt;/p&gt;

&lt;p&gt;About authentication, both 2.2 and 3.0 convert the internal RequestExecutionException to an AuthenticationException. 3.11 will do the same when the credentials cache is enabled, but otherwise it will not. 4.0 will never convert to AuthenticationException. The behavior in 2.2/3.0 seem quite deliberate.&lt;/p&gt;

&lt;p&gt;IMO we should stick with the legacy behavior during authentication and update 3.11/4.0 accordingly. I&apos;m not sure about authorization behavior - RequestExecutionException seem more practical, while an UnauthorizedException seem more correct.&lt;/p&gt;

&lt;p&gt;I&apos;ve added a few more &lt;a href=&quot;https://github.com/apache/cassandra-dtest/compare/master...eperott:cassandra-15041&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt; to cover for&#160;authentication as well as valid cases for responding from cached entries. (ATM tests expect AuthenticationException during authentication, and UnavailableException during authorization.)&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;We could definitely improve the text of the error response though to give a nicer message when this does occur.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Right, so I&apos;ve incorporated my suggestions in the dtests. The idea is to give an indication of why the request was rejected, and give a hint of the cause for this.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;but upgrading to Caffeine 2.7.0 seems to fix this&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Indeed it does! For better traceability, and considering that the caffeine library is used on many places in the code base, I suggest to follow up on this issue in a separate ticket.&lt;/p&gt;</comment>
                            <comment id="16849436" author="eperott" created="Tue, 28 May 2019 07:44:39 +0000"  >&lt;p&gt;I&apos;ve been giving this some more thought. My proposal is:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Indicate &lt;tt&gt;AuthenticationException&lt;/tt&gt; to client if system_auth is inaccessible during authentication&lt;br/&gt;
 This is in line with existing behavior in 2.2, 3.0 and partially 3.11.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Indicate &lt;tt&gt;UnavailableException&lt;/tt&gt; to client if system_auth is inaccessible during authorization&lt;br/&gt;
 This should wrap whatever &lt;tt&gt;RequestExecutionException&lt;/tt&gt; that was thrown by the authorization backend (perhaps this is what you meant to say from the beginning).&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;In both cases above should the error message clearly state that issue is related to Authenticatoin/Authorization&lt;br/&gt;
 The underlying cause should also be included in the message as a hint for troubleshooting.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Create a separate ticket for upgrading the Caffein dependency.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt;, would be great to get your thoughts on this. Also, would you be able to review this if I work on a patch?&lt;/p&gt;</comment>
                            <comment id="16850725" author="beobal" created="Wed, 29 May 2019 10:17:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eperott&quot; class=&quot;user-hover&quot; rel=&quot;eperott&quot;&gt;eperott&lt;/a&gt;&#160;sure, your proposal does sound entirely reasonable and consistent so let&apos;s got for that. I can definitely review when you&apos;re ready with a patch.&lt;/p&gt;</comment>
                            <comment id="16860306" author="eperott" created="Mon, 10 Jun 2019 20:24:52 +0000"  >&lt;p&gt;Had to make some adjustments while implementing this.&lt;/p&gt;

&lt;p&gt;When we fail to perform authorization it is not always possible to convert whatever-exception-we-get into an &lt;tt&gt;UnavailableException&lt;/tt&gt; since the &lt;tt&gt;UnavailableException&lt;/tt&gt; constructor requires a bunch of parameters (CL plus required and live nodes). I didn&apos;t feel comfortable to change this to achieve our goals here, so I went with the other proposal to convert this into an &lt;tt&gt;UnauthorizedException&lt;/tt&gt; instead. But I&apos;m happy to discuss options. Worth considering, since IAuthorizer is a public plug-in interface it should define a generic behavior. And, for example, it would be somewhat awkward for an &lt;tt&gt;LDAPAuthorizer&lt;/tt&gt; to throw an &lt;tt&gt;UnavailableException&lt;/tt&gt; if it fails to contact the LDAP server, so the &lt;tt&gt;UnauthorizedException&lt;/tt&gt; may be a better fit anyway.&lt;/p&gt;

&lt;p&gt;A side effect of signaling &lt;tt&gt;UnauthorizedException&lt;/tt&gt; instead of &lt;tt&gt;UnavailableException&lt;/tt&gt; is that the issue with the stale entries from the Caffeine cache don&apos;&#7831; show any more. This is because the driver will not retry on &lt;tt&gt;UnauthrizedException&lt;/tt&gt;, and the Caffeine issue only shows if it get repeated queries on failing keys. But IMO we should still see to this. I created &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15153&quot; title=&quot;Ensure Caffeine cache does not return stale entries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15153&quot;&gt;&lt;del&gt;CASSANDRA-15153&lt;/del&gt;&lt;/a&gt; for this.&lt;/p&gt;

&lt;p&gt;Also, had a setback with one of the goals of this ticket - to make the background cache reload thread mute if it fails. Turns out the error message is buried deep down in the Guava &lt;tt&gt;LoadingCache&lt;/tt&gt;. Only option I see for pre-4.0 is to mute this in the logback config.&lt;/p&gt;

&lt;p&gt;PR for &lt;a href=&quot;https://github.com/apache/cassandra-dtest/pull/52&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The patches for Cassandra differs a bit on 2.2/3.0 vs. 3.11 vs. trunk. Not sure what&apos;s the best way to provide these patches to simplify review and merge into upstream repo. Below are links to the individual branches on my github clone without merge commits, is that OK? Lots if dtests are timing out since I only have the free service, but will try to run failing tests locally&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Patch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/eperott/cassandra/tree/15041-cassandra-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;15041-cassandra-2.2&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/eperott/workflows/cassandra/tree/cci%2F15041-cassandra-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CircleCI&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/eperott/cassandra/tree/15041-cassandra-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;15041-cassandra-3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/eperott/workflows/cassandra/tree/cci%2F15041-cassandra-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CircleCI&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/eperott/cassandra/tree/15041-cassandra-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;15041-cassandra-3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/eperott/workflows/cassandra/tree/cci%2F15041-cassandra-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CircleCI&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/eperott/cassandra/tree/15041-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;15041-trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/eperott/workflows/cassandra/tree/cci%2F15041-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CircleCI&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="16864627" author="eperott" created="Sat, 15 Jun 2019 07:09:11 +0000"  >&lt;p&gt;Since dtests on CircleCI are unreliable on the free service, I&apos;ve run failing j8_dtests-no-vnodes locally and compared with each base branch. There is no regression.&lt;/p&gt;</comment>
                            <comment id="16866829" author="eperott" created="Tue, 18 Jun 2019 16:46:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;Also, had a setback with one of the goals of this ticket - to make the background cache reload thread mute if it fails. Turns out the error message is buried deep down in the Guava LoadingCache. Only option I see for pre-4.0 is to mute this in the logback config.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Discovered that this was a false assumption based on comments in the Guava Cache API. The log message is actually coming from the &lt;tt&gt;DebuggableThreadPoolExecutor&lt;/tt&gt; which is invoking the &lt;tt&gt;DefaultUncaughtExceptionHandler&lt;/tt&gt; which in turn is installed by &lt;tt&gt;CassandraDaemon&lt;/tt&gt;. Added a small patch on top of 2.2, 3.0, and 3.11 branches to override this behavior. Also update dtest branch to verify that a failing background update will actually be silent.&lt;/p&gt;</comment>
                            <comment id="16866919" author="beobal" created="Tue, 18 Jun 2019 18:36:27 +0000"  >&lt;p&gt;Thanks, I should get finished with this soon. I&apos;ve been running the branches through CircleCI with the HIRES settings and the only failures are for unrelated things (one which has already been fixed in the dtests &amp;amp; one known issue with Thrift tests on 3.11 and lower).&lt;/p&gt;</comment>
                            <comment id="16868818" author="beobal" created="Thu, 20 Jun 2019 18:12:46 +0000"  >&lt;p&gt;Thanks for this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eperott&quot; class=&quot;user-hover&quot; rel=&quot;eperott&quot;&gt;eperott&lt;/a&gt;, there are definitely valuable improvements here.&lt;/p&gt;

&lt;p&gt;Whilst the new dtests for handling unavailability do what they claim, they&#8217;re not doing so in the way one &lt;b&gt;might&lt;/b&gt; expect. First of all, because they use a superuser, table/keyspace level permissions will never be read from system tables and so won&#8217;t be vulnerable to unavailablity. The reason the tests are currently passing is that the check that the user has access to the local DC is resulting in a failed read by &lt;tt&gt;CassandraNetworkAuthorizer&lt;/tt&gt;. So the tests are definitely still valid as they are, but it might be worth adding some commentary just to highlight this and maybe use a non-superuser role that &lt;b&gt;could&lt;/b&gt; exercise the permissions cache too (even though it won&apos;t with the way the current test are organised). Potentially, adding some logging to the new catch blocks in &lt;tt&gt;CassandraRoleManager&lt;/tt&gt; might be useful, similar to that in &lt;tt&gt;CassandraAuthorizer::authorize&lt;/tt&gt;. &lt;tt&gt;CassandraNetworkAuthorizer&lt;/tt&gt; is especially vulnerable here, due to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15089&quot; title=&quot;CassandraNetworkAuthorizer::authorize should get role details from Roles, not directly from IRoleManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15089&quot;&gt;&lt;del&gt;CASSANDRA-15089&lt;/del&gt;&lt;/a&gt;, which I will commit as soon as I get chance.&lt;/p&gt;

&lt;p&gt;Otherwise, this all looks pretty good to me, modulo a typo in &lt;tt&gt;ClientState::canLogin&lt;/tt&gt; (only in 2.2/3.0/3.11).&lt;/p&gt;

&lt;p&gt;I&#8217;ve been running the tests with the HIRES circle configuration and everything looks good - all failures are unrelated and/or fixed already by other tickets.&lt;/p&gt;

&lt;p&gt;So I just have these nits:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;typo in &lt;tt&gt;ClientState::canLogin&lt;/tt&gt; (2.2/3.0/3.11)&lt;/li&gt;
	&lt;li&gt;maybe add some minimal logging in &lt;tt&gt;CassandraRoleManager::isSuper/canLogin&lt;/tt&gt; or make the exception messages distinguishable&lt;/li&gt;
	&lt;li&gt;document the potential sources of the availability failures that the dtests are checking and/or use a non-superuser in tests&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;One thing that I had missed up to now was that when Guava was replaced with Caffeine in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10855&quot; title=&quot;Use Caffeine (W-TinyLFU) for on-heap caches&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10855&quot;&gt;&lt;del&gt;CASSANDRA-10855&lt;/del&gt;&lt;/a&gt;, the ability to do async reloading in &lt;tt&gt;AuthCache&lt;/tt&gt; was lost. We should definitely fix that, as having those reads done in a thread servicing client reads is not a good idea. I&#8217;ve opened &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15177&quot; title=&quot;Reloading of auth caches happens on the calling thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15177&quot;&gt;&lt;del&gt;CASSANDRA-15177&lt;/del&gt;&lt;/a&gt; for that. &lt;/p&gt;</comment>
                            <comment id="16873909" author="eperott" created="Thu, 27 Jun 2019 08:25:07 +0000"  >&lt;p&gt;Thanks for taking the time to review.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Whilst the new dtests for handling unavailability do what they claim, they&#8217;re not doing so in the way one might expect.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, had to spend some time to get this sorted in my head. There are certainly a few surprises in how the caches affect the result, and one another. What&apos;s more, behavior is a bit different between versions since we&apos;re caching the super-user flag in 4.0, while in pre-4.0 we&apos;re not. For this reason, a stale entry in the permissions cache on pre-4.0 will result in a query to pull up the role&apos;s super-user flag even if the role cache is still up to date. The resulting error message is a bit confusing, but this is more intuitive in 4.0 I think. Also, I believe this makes it hard to use a non-super-user role in the tests and still get clean code and consistent results across versions, so didn&apos;t change that. Open to suggestions if you have some ideas...&lt;/p&gt;

&lt;p&gt;I&apos;ve added some comments around assumptions and test strategy in the dtests.&lt;/p&gt;

&lt;p&gt;One thing I discovered while working on this is that the assert_exception helper (and friends) don&apos;t verify error message properly. I fixed this locally while verifying, but will create a separate ticket for this since it will affect a few places where the helpers are used.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;So I just have these nits&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Fixed those. Also, since I removed the stack trace dump on error level when background updates fail (pre-4.0), I&apos;ve re-added the trace log we used to have in the AuthCache.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I&#8217;ve been running the tests with the HIRES circle configuration&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks. Tried to make it work on free service, but I give up...&lt;/p&gt;</comment>
                            <comment id="16879462" author="beobal" created="Fri, 5 Jul 2019 18:14:35 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eperott&quot; class=&quot;user-hover&quot; rel=&quot;eperott&quot;&gt;eperott&lt;/a&gt; committed to 2.2 in &lt;tt&gt;b2f6953addfb1fce111d1b49627285d1a57a7f40&lt;/tt&gt; and merged to 3.0, 3.11 &amp;amp; trunk. Committed the dtest patch in &lt;a href=&quot;https://github.com/apache/cassandra-dtest/commit/ef5f2f52f83ae2592555a627ce3534daa8a0a3a5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ef5f2f52f83ae2592555a627ce3534daa8a0a3a5&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13238523">CASSANDRA-15153</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[eperott]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12988" cascade-level="1"><![CDATA[API / Semantic Implementation]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 19 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z00b1s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12343576">3.0.18</customfieldvalue>
    <customfieldvalue id="12343577">3.11.4</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12332983">2.2.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/b2f6953addfb1fce111d1b49627285d1a57a7f40&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/b2f6953addfb1fce111d1b49627285d1a57a7f40&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;New unit and dtests included&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>