<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:41:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-6206] Thrift socket listen backlog</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-6206</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Although Thrift is a depreciated method of accessing Cassandra, default backlog is way too low on that socket. It shouldn&apos;t be a problem to implement it and I am including a POC patch for this (sorry, really low on time with limited Java knowledge so just to give an idea).&lt;/p&gt;

&lt;p&gt;This is an old report which was never addressed and the bug remains till this day, except in my case I have a much larger scale application with 3rd party software which I cannot modify to include connection pooling:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1663&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-1663&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There is also a pending change in the Thrift itself which Cassandra should be able to use for parts using TServerSocket (SSL):&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1868&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/THRIFT-1868&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Debian Linux, Java 7&lt;/p&gt;</environment>
        <key id="12674032">CASSANDRA-6206</key>
            <summary>Thrift socket listen backlog</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nmerdan">Nenad Merdanovic</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Oct 2013 00:46:51 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:02 +0000</updated>
                            <resolved>Fri, 14 Mar 2014 01:19:37 +0000</resolved>
                                                            <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13796790" author="brandon.williams" created="Wed, 16 Oct 2013 13:39:44 +0000"  >&lt;p&gt;Use the HSHA server if you have this problem.&lt;/p&gt;</comment>
                            <comment id="13800746" author="nmerdan" created="Mon, 21 Oct 2013 15:42:46 +0000"  >&lt;p&gt;Although I saw no benefit of doing this, as it doesn&apos;t relate to the application&apos;s way of handling connections, but to the socket limits that are handled in-kernel, I have tried to change the RPC server type to &apos;hsha&apos;. It didn&apos;t help.&lt;/p&gt;

&lt;p&gt;Socket limits are set with the listen(2) system call and Java&apos;s implementation sets it to &apos;50&apos; if not specified. This is way too low on any production traffic that is not using connection pooling (for example PDO-Cassandra doesn&apos;t support it at all). To patch this should be extremely simple and I kindly ask you to reconsider about fixing this.&lt;/p&gt;</comment>
                            <comment id="13800956" author="vijay2win@yahoo.com" created="Mon, 21 Oct 2013 18:57:54 +0000"  >&lt;p&gt;Nenad, Can you change have the default backlog config to be java default?&lt;/p&gt;</comment>
                            <comment id="13800968" author="nmerdan" created="Mon, 21 Oct 2013 19:11:37 +0000"  >&lt;p&gt;Hello Vijay,&lt;/p&gt;

&lt;p&gt;Not sure I understand, you want me to have a default value in code just the same as Java default? So basically, in the patch I should change:&lt;br/&gt;
+   public Integer rpc_listen_backlog = 1024;&lt;br/&gt;
to&lt;br/&gt;
+   public Integer rpc_listen_backlog = 50;&lt;/p&gt;

&lt;p&gt;If that is it, no problem, I&apos;ll attach another patch.&lt;/p&gt;</comment>
                            <comment id="13800991" author="vijay2win@yahoo.com" created="Mon, 21 Oct 2013 19:34:18 +0000"  >&lt;p&gt;Hi Nenad, Yep, thanks!&lt;/p&gt;</comment>
                            <comment id="13800997" author="nmerdan" created="Mon, 21 Oct 2013 19:39:20 +0000"  >&lt;p&gt;Hello Vijay, attached the cassandra-v2.patch file as requested.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Nenad&lt;/p&gt;</comment>
                            <comment id="13801518" author="vijay2win@yahoo.com" created="Tue, 22 Oct 2013 05:53:25 +0000"  >&lt;p&gt;v2 doesn&apos;t apply clean (in future may be use git patch). I will also change SSLFactory.getServerSocket to use this configuration.&lt;/p&gt;

&lt;p&gt;ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xedin&quot; class=&quot;user-hover&quot; rel=&quot;xedin&quot;&gt;xedin&lt;/a&gt; for HSHA change after &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1868&quot; title=&quot;Make the TPC backlog configurable in the Java servers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1868&quot;&gt;&lt;del&gt;THRIFT-1868&lt;/del&gt;&lt;/a&gt;, &lt;br/&gt;
Should we leave this ticket open till &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1868&quot; title=&quot;Make the TPC backlog configurable in the Java servers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1868&quot;&gt;&lt;del&gt;THRIFT-1868&lt;/del&gt;&lt;/a&gt; gets resolved and/or also till 2.1 (changes the yaml configuration)?&lt;/p&gt;</comment>
                            <comment id="13801802" author="nmerdan" created="Tue, 22 Oct 2013 13:26:23 +0000"  >&lt;p&gt;It appears I mangled the patch file while making a simple change, sorry. I have uploaded the one that is good.&lt;/p&gt;
</comment>
                            <comment id="13818558" author="vijay2win@yahoo.com" created="Sun, 10 Nov 2013 21:47:17 +0000"  >&lt;p&gt;Committed to trunk,&lt;/p&gt;

&lt;p&gt;But a partially. Talked to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xedin&quot; class=&quot;user-hover&quot; rel=&quot;xedin&quot;&gt;xedin&lt;/a&gt;, once we have the setting in HSHA we can resolve this ticket.&lt;/p&gt;</comment>
                            <comment id="13853441" author="jbellis" created="Thu, 19 Dec 2013 23:16:09 +0000"  >&lt;p&gt;Any progress on the hsha part?&lt;/p&gt;</comment>
                            <comment id="13853457" author="xedin" created="Thu, 19 Dec 2013 23:29:30 +0000"  >&lt;p&gt;We are waiting for Thrift guys to resolve on their side first.&lt;/p&gt;</comment>
                            <comment id="13917924" author="slebresne" created="Mon, 3 Mar 2014 10:40:43 +0000"  >&lt;p&gt;What part of this exactly requires &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1868&quot; title=&quot;Make the TPC backlog configurable in the Java servers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1868&quot;&gt;&lt;del&gt;THRIFT-1868&lt;/del&gt;&lt;/a&gt;? Is the &quot;Committed to trunk&quot; means that this is fixed in 2.1 but cannot be fixed in 2.0 without &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-1868&quot; title=&quot;Make the TPC backlog configurable in the Java servers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-1868&quot;&gt;&lt;del&gt;THRIFT-1868&lt;/del&gt;&lt;/a&gt;? Cause that thrift ticket has had a patch waiting for review since last September. I&apos;ve pinged them on the issue, but if there is no movement soon and that we&apos;re good in 2.1, maybe we should just say that it&apos;s &apos;fix for&apos; 2.1 and move on.&lt;/p&gt;</comment>
                            <comment id="13933811" author="jbellis" created="Thu, 13 Mar 2014 18:25:17 +0000"  >&lt;p&gt;Ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xedin&quot; class=&quot;user-hover&quot; rel=&quot;xedin&quot;&gt;xedin&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13934251" author="xedin" created="Thu, 13 Mar 2014 22:48:31 +0000"  >&lt;p&gt;The problem is that we have no control over socket.bind(...) call in depths of TNonblockingServerSocket, we need Thrift guys to give us the way to set backlog the same way as for blocking ones, so I don&apos;t think that&apos;s going in any time soon. On the othre hand, we can easily cherry-pick blacklog to 2.0 but it would only work with TThreadPoolServer so I&apos;m not sure if it&apos;s that useful...&lt;/p&gt;</comment>
                            <comment id="13934410" author="jbellis" created="Fri, 14 Mar 2014 01:19:37 +0000"  >&lt;p&gt;Let&apos;s wontfix, then.  As Nenad notes, the native protocol is more important anyway.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12609651" name="cassandra-v2.patch" size="6648" author="nmerdan" created="Tue, 22 Oct 2013 13:26:23 +0000"/>
                            <attachment id="12608619" name="cassandra.patch" size="6671" author="nmerdan" created="Wed, 16 Oct 2013 00:49:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353655</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 36 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1oz1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353947</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>