<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:29:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3838] Repair Streaming hangs between multiple regions</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3838</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Streaming hangs between datacenters, though there might be multiple reasons for this, a simple fix will be to add the Socket timeout so the session can retry.&lt;/p&gt;

&lt;p&gt;The following is the netstat of the affected node (the below output remains this way for a very long period).&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;test_abrepairtest@test_abrepair--euwest1c-i-1adfb753 ~&amp;#93;&lt;/span&gt;$ nt netstats&lt;br/&gt;
Mode: NORMAL&lt;br/&gt;
Streaming to: /50.17.92.159&lt;br/&gt;
   /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2221-Data.db sections=7002 progress=1523325354/2475291786 - 61%&lt;br/&gt;
   /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2233-Data.db sections=4581 progress=0/595026085 - 0%&lt;br/&gt;
   /mnt/data/cassandra070/data/abtests/cust_allocs-g-2235-Data.db sections=6631 progress=0/2270344837 - 0%&lt;br/&gt;
   /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2239-Data.db sections=6266 progress=0/2190197091 - 0%&lt;br/&gt;
   /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2230-Data.db sections=7662 progress=0/3082087770 - 0%&lt;br/&gt;
   /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2240-Data.db sections=7874 progress=0/587439833 - 0%&lt;br/&gt;
   /mnt/data/cassandra070/data/abtests/cust_allocs-g-2226-Data.db sections=7682 progress=0/2933920085 - 0%&lt;/p&gt;



&lt;p&gt;&quot;Streaming:1&quot; daemon prio=10 tid=0x00002aaac2060800 nid=0x1676 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x000000006be85000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
        at java.net.SocketOutputStream.socketWrite0(Native Method)&lt;br/&gt;
        at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)&lt;br/&gt;
        at java.net.SocketOutputStream.write(SocketOutputStream.java:136)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.OutputRecord.writeBuffer(OutputRecord.java:297)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.OutputRecord.write(OutputRecord.java:286)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.writeRecordInternal(SSLSocketImpl.java:743)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.writeRecord(SSLSocketImpl.java:731)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.AppOutputStream.write(AppOutputStream.java:59)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0x00000006afea1bd8&amp;gt; (a com.sun.net.ssl.internal.ssl.AppOutputStream)&lt;br/&gt;
        at com.ning.compress.lzf.ChunkEncoder.encodeAndWriteChunk(ChunkEncoder.java:133)&lt;br/&gt;
        at com.ning.compress.lzf.LZFOutputStream.writeCompressedBlock(LZFOutputStream.java:203)&lt;br/&gt;
        at com.ning.compress.lzf.LZFOutputStream.flush(LZFOutputStream.java:117)&lt;br/&gt;
        at org.apache.cassandra.streaming.FileStreamTask.stream(FileStreamTask.java:152)&lt;br/&gt;
        at org.apache.cassandra.streaming.FileStreamTask.runMayThrow(FileStreamTask.java:91)&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:30)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Streaming from: /46.51.141.51&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2241-Data.db sections=7231 progress=0/1548922508 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2231-Data.db sections=4730 progress=0/296474156 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2244-Data.db sections=7650 progress=0/1580417610 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2217-Data.db sections=7682 progress=0/196689250 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2220-Data.db sections=7149 progress=0/478695185 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2171-Data.db sections=443 progress=0/78417320 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-g-2235-Data.db sections=6631 progress=0/2270344837 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2222-Data.db sections=4590 progress=0/1310718798 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2233-Data.db sections=4581 progress=0/595026085 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-g-2226-Data.db sections=7682 progress=0/2933920085 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2213-Data.db sections=7876 progress=0/3308781588 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2216-Data.db sections=7386 progress=0/2868167170 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2240-Data.db sections=7874 progress=0/587439833 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2254-Data.db sections=4618 progress=0/215989758 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2221-Data.db sections=7002 progress=1542191546/2475291786 - 62%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2239-Data.db sections=6266 progress=0/2190197091 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2210-Data.db sections=6698 progress=0/2304563183 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2230-Data.db sections=7662 progress=0/3082087770 - 0%&lt;br/&gt;
   abtests: /mnt/data/cassandra070/data/abtests/cust_allocs-hc-2229-Data.db sections=7386 progress=0/1324787539 - 0%&lt;/p&gt;


&lt;p&gt;&quot;Thread-198896&quot; prio=10 tid=0x00002aaac0e00800 nid=0x4710 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x000000004251b000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
        at java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
        at java.net.SocketInputStream.read(SocketInputStream.java:129)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.InputRecord.readFully(InputRecord.java:293)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.InputRecord.readV3Record(InputRecord.java:405)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.InputRecord.read(InputRecord.java:360)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:798)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0x00000005e220a170&amp;gt; (a java.lang.Object)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readDataRecord(SSLSocketImpl.java:755)&lt;br/&gt;
        at com.sun.net.ssl.internal.ssl.AppInputStream.read(AppInputStream.java:75)&lt;/li&gt;
	&lt;li&gt;locked &amp;lt;0x00000005e220a1b8&amp;gt; (a com.sun.net.ssl.internal.ssl.AppInputStream)&lt;br/&gt;
        at com.ning.compress.lzf.LZFDecoder.readFully(LZFDecoder.java:392)&lt;br/&gt;
        at com.ning.compress.lzf.LZFDecoder.decompressChunk(LZFDecoder.java:190)&lt;br/&gt;
        at com.ning.compress.lzf.LZFInputStream.readyBuffer(LZFInputStream.java:254)&lt;br/&gt;
        at com.ning.compress.lzf.LZFInputStream.read(LZFInputStream.java:129)&lt;br/&gt;
        at java.io.DataInputStream.readFully(DataInputStream.java:178)&lt;br/&gt;
        at java.io.DataInputStream.readLong(DataInputStream.java:399)&lt;br/&gt;
        at org.apache.cassandra.utils.BytesReadTracker.readLong(BytesReadTracker.java:115)&lt;br/&gt;
        at org.apache.cassandra.db.ColumnSerializer.deserialize(ColumnSerializer.java:119)&lt;br/&gt;
        at org.apache.cassandra.db.ColumnSerializer.deserialize(ColumnSerializer.java:37)&lt;br/&gt;
        at org.apache.cassandra.io.sstable.SSTableWriter.appendFromStream(SSTableWriter.java:244)&lt;br/&gt;
        at org.apache.cassandra.streaming.IncomingStreamReader.streamIn(IncomingStreamReader.java:148)&lt;br/&gt;
        at org.apache.cassandra.streaming.IncomingStreamReader.read(IncomingStreamReader.java:90)&lt;br/&gt;
        at org.apache.cassandra.net.IncomingTcpConnection.stream(IncomingTcpConnection.java:185)&lt;br/&gt;
        at org.apache.cassandra.net.IncomingTcpConnection.run(IncomingTcpConnection.java:81)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12540877">CASSANDRA-3838</key>
            <summary>Repair Streaming hangs between multiple regions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jasobrown">Jason Brown</assignee>
                                    <reporter username="vijay2win@yahoo.com">Vijay</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Feb 2012 06:10:29 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:41 +0000</updated>
                            <resolved>Sun, 5 Feb 2012 21:40:51 +0000</resolved>
                                        <fixVersion>1.0.8</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13200477" author="slebresne" created="Sat, 4 Feb 2012 17:23:14 +0000"  >&lt;p&gt;Is there any usefulness to set the SO_TIMEOUT on the socket that is writing?&lt;/p&gt;

&lt;p&gt;I also wonder if we really should reuse the rpc timeout for this (and my initial intuition is that we probably shouldn&apos;t). As far as I&apos;m concerned, I&apos;m fine adding a new streaming_socket_timeout option for this (we don&apos;t even have to document it in the yaml if we consider it&apos;s an advanced thing).&lt;/p&gt;</comment>
                            <comment id="13200566" author="vijay2win@yahoo.com" created="Sat, 4 Feb 2012 21:51:08 +0000"  >&lt;p&gt;Hi Sylvain,&lt;br/&gt;
My observation on this is that... when there is network congestion the Routers will start to drop the packets and which will cause the write on the socket to hang.... Until we write again to the socket we will not know if the socket is closed or not... hence it will be better to have it in both the sides... &lt;/p&gt;

&lt;p&gt;I will add streaming_socket_timeout and add documentation in the next patch... if you are ok with the above Thanks!&lt;/p&gt;</comment>
                            <comment id="13200610" author="scode" created="Sun, 5 Feb 2012 00:57:09 +0000"  >&lt;p&gt;Note that simply adding a socket timeout is not a good idea unless both sides are truly expected to never starve (this is why I didn&apos;t suggest it for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3569&quot; title=&quot;Failure detector downs should not break streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3569&quot;&gt;&lt;del&gt;CASSANDRA-3569&lt;/del&gt;&lt;/a&gt;, and why TCP keep-alive is the &quot;correct&quot; solution because it does not generate spurious timeouts by lack of in-band data on the channel - but as noted in that ticket, the practical reality is that we don&apos;t control keep alive parameters on a per-socket basis).&lt;/p&gt;

&lt;p&gt;For example if one of the ends is waiting for a few seconds for a particularly expensive fsync(), or waiting for some kind of lock, you&apos;d have spurious failures (whereas this is not the case for keep-alive, because the transport is alive and kicking at the kernel level). Depending on surrounding logic, it could be dangerous if it causes the receiver to believe it received the file while the sender believes it doesn&apos;t (e.g. multiple streaming -&amp;gt; disk space explosion).&lt;/p&gt;

&lt;p&gt;I would suggest TCP keep-alive for the reasons mentioned here and discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3569&quot; title=&quot;Failure detector downs should not break streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3569&quot;&gt;&lt;del&gt;CASSANDRA-3569&lt;/del&gt;&lt;/a&gt;, and suggest that the TCP keep-alive settings be tweaked to fail quicker if that is desired.&lt;/p&gt;

&lt;p&gt;If adding a socket timeout, thought needs to go into what kind of false failure cases will be created. If both ends are truly expected not to block on anything like compaction locks or whatever else there might be, it might be okay.&lt;/p&gt;

&lt;p&gt;In either case, definitely &lt;b&gt;don&apos;t&lt;/b&gt; use rpc timeout IMO; the concerns are completely different. A low-timeout cluster with an rpc timeout of 0.5 seconds for example would be extremely sensitive to even the slightest hiccup (such as waitnig 1 second for an fsync(), or a GC pause, etc) and it would truly be useless and extremely damaging to kill streams for that.&lt;/p&gt;

&lt;p&gt;In general, as with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3569&quot; title=&quot;Failure detector downs should not break streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3569&quot;&gt;&lt;del&gt;CASSANDRA-3569&lt;/del&gt;&lt;/a&gt;, I strongly argue that streaming should not be caused to spuriously fail because the impact of that can be huge, particularly on clusters with large nodes.&lt;/p&gt;

&lt;p&gt;As for reads vs. writes: You definitely want timeouts on both sides in order to guarantee that you never hang under any circumstance regardless of the nature of the TCP connection loss, unless you have some other method to accomplish the same thing.&lt;/p&gt;

&lt;p&gt;If this (socket timeouts) does go in, I argue even more strongly than before that the tear-down of streams due to failure detector as in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3569&quot; title=&quot;Failure detector downs should not break streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3569&quot;&gt;&lt;del&gt;CASSANDRA-3569&lt;/del&gt;&lt;/a&gt; is truly just negative rather than positive (but as noted in that ticket, not hanging forever on repairs and such remains a concern).&lt;/p&gt;</comment>
                            <comment id="13200612" author="scode" created="Sun, 5 Feb 2012 00:58:17 +0000"  >&lt;p&gt;Vijay, I do believe though that if you don&apos;t care about having to wait for a few hours for streams to abort, simply setting keep alive is the easiest and least-likely-to-have-negative-side-effects fix to your problem of inter-dc streams.&lt;/p&gt;</comment>
                            <comment id="13200614" author="scode" created="Sun, 5 Feb 2012 01:02:21 +0000"  >&lt;p&gt;Turns out we can do per-socket keep-alive on Linux if we&apos;re willing to be platform specific, see &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3569?focusedCommentId=13200613&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13200613&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-3569?focusedCommentId=13200613&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13200613&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13200617" author="scode" created="Sun, 5 Feb 2012 01:24:05 +0000"  >&lt;p&gt;Let me be more clear about why keep-alive is better.&lt;/p&gt;

&lt;p&gt;TCP keep-alive is at the transport level, and thus independent of in-band data (or lack thereof). Imagine that you&apos;re implementing a remote procedure call protocol where the client sends:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;INVOKE name-of-process arg1 arg2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The server invokes the method, and responds:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;RET success|failure exit-value|exception
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The first thing you need if you are using this in some kind of production scenario, is to ensure that requests can time out. But there is a problem. Suppose you&apos;re making the assumption that this software is running on well-connected networks and a high number of requests per second; there is no reason to not quickly time out requests if the remote host is unreachable. So you set a socket timeout to 1 second. The only problem is that it will also time out on all requests that take longer than 1 second because the method call legitimately took longer.&lt;/p&gt;

&lt;p&gt;The conflict happens because the selection of timeout was made based on the transport level circumstances (fast local network, high throughput, no need to wait if a host is down) while the effect of the timeout is at the in-band data level and is thus triggered by a slow request.&lt;/p&gt;

&lt;p&gt;One way to fix this is to extend the protocol between client and server such that they can constantly be exchanging PING/PONG type messages (witness IRC for an example of this). This allows you to utilize socket (or read/write op) timeouts to detect a broken transport, under the assumption/premise that both sides have dedicated code for the ping/pong stuff which is independent of any delay in processing the otherwise in-band data.&lt;/p&gt;

&lt;p&gt;Disadvantages of this approach can include the need to actually change the protocol, and (depending on implementation) additional implementation complexity as you suddenly need to actively model the transport as such.&lt;/p&gt;

&lt;p&gt;TCP keep-alive is a way to let the kernel/tcp, which is already supposed to support this, deal with this without adding complexity to the application. It allows what effectively boils down to a &quot;timeout&quot; at the transport level which can be selected based on use-case and expected networking characteristics, and is independent of the nature of the in-band data sent over that transport.&lt;/p&gt;

&lt;p&gt;In the Cassandra case, the equivalent of the slow RPC call might be that a write() during streaming blocks for 5 seconds because socket buffers on both ends are full, and the other end is going a GC or waiting on an fsync().&lt;/p&gt;

&lt;p&gt;By using keep-alives we get more &quot;correct&quot; behavior in that such blocks won&apos;t cause connection tear-downs, while at the same time not having to change the protocol and/or add complexity to the code base to implement a protocol-within-tcp in which to mux the actual payload for streaming.&lt;/p&gt;</comment>
                            <comment id="13200619" author="vijay2win@yahoo.com" created="Sun, 5 Feb 2012 01:27:07 +0000"  >&lt;p&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt; In either case, definitely don&apos;t use rpc timeout IMO; the concerns are completely different. A low-timeout cluster with an rpc timeout of 0.5 seconds &lt;br/&gt;
We will add a configuration  streaming_socket_timeout  which will be different than rpc_timeout...  &lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt;&amp;gt; If this (socket timeouts) does go in, I argue even more strongly than before that the tear-down of streams due to failure detector as in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3569&quot; title=&quot;Failure detector downs should not break streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3569&quot;&gt;&lt;del&gt;CASSANDRA-3569&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
I dont have any option on that ticket, but it looks reasonable. I would say so_timeout will be a better solution for streaming as it is not a long lived connections... but i also think Keep alive should be set for the Messaging connection as you mentioned in the other ticket.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt;&amp;gt; I do believe though that if you don&apos;t care about having to wait for a few hours for streams to abort&lt;br/&gt;
We definitely dont want to wait for hours.... And i dont think we have to wait for hours when we have a better option, even if we set streaming_socket_timeout to 30 Seconds or even a minute.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt;&amp;gt; As for reads vs. writes: You definitely want timeouts on both sides in order to guarantee that you never hang under any circumstance &lt;br/&gt;
Agree, i will get the patch done in few min.&lt;/p&gt;</comment>
                            <comment id="13200801" author="slebresne" created="Sun, 5 Feb 2012 16:32:28 +0000"  >&lt;p&gt;The default for this should be to not timeout at all, we should be conservative.&lt;/p&gt;

&lt;p&gt;I&apos;m good with keep alive on principle, but I think the actual hitch Vijay is trying to hitch is to not wait hours to retry the repair. So given that for keep alive that would involve potential non-portable code and such, let&apos;s keep that for later unless someone is willing to actually write that keep-alive patch in a timely fashion. &lt;/p&gt;</comment>
                            <comment id="13200819" author="vijay2win@yahoo.com" created="Sun, 5 Feb 2012 18:30:58 +0000"  >&lt;p&gt;Hi Sylvain the default is set to no timeout in the new patch. Thanks!&lt;/p&gt;</comment>
                            <comment id="13200841" author="scode" created="Sun, 5 Feb 2012 20:03:56 +0000"  >&lt;blockquote&gt;
&lt;p&gt;So given that for keep alive that would involve potential non-portable code and such, let&apos;s keep that for later unless someone is willing to actually write that keep-alive patch in a timely fashion.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I have nothing against that at all, to be clear. I didn&apos;t mean to sound like I was arguing against this going in. I am very much for it, +1. In fact I&apos;d rather have this just be turned on by default (with a reasonably high default timeout) than having FD convictions kill streams. So no argument here.&lt;/p&gt;

&lt;p&gt;Timeouts like these can be exchanged for keep-alive:s in the future without really affecting the surrounding logic, if that feature becomes available.&lt;/p&gt;</comment>
                            <comment id="13200916" author="slebresne" created="Sun, 5 Feb 2012 21:40:51 +0000"  >&lt;p&gt;Commmitted, thanks.&lt;/p&gt;

&lt;p&gt;I&apos;ve slightly updated the option name to streaming_socket_timeout_in_ms (I added the _in_ms) to mirror the rpc_timeout_in_ms option and to avoid having people wonder which unit that was.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12533758">CASSANDRA-3569</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12512915" name="0001-Add-streaming-socket-timeouts.patch" size="1639" author="vijay2win@yahoo.com" created="Thu, 2 Feb 2012 06:13:13 +0000"/>
                            <attachment id="12513313" name="0001-CASSANDRA-3838-v2.patch" size="3811" author="vijay2win@yahoo.com" created="Sun, 5 Feb 2012 18:30:58 +0000"/>
                            <attachment id="12513289" name="0001-CASSANDRA-3838.patch" size="3786" author="vijay2win@yahoo.com" created="Sun, 5 Feb 2012 06:52:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jasobrown]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>226231</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 42 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gotr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95452</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>