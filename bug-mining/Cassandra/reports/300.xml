<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:12:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-944] system.test_thrift_server.TestMutations.test_batch_mutate_standard_columns appears to be non deterministic</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-944</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;system.test_thrift_server.TestMutations.test_batch_mutate_standard_columns appears to be non deterministic.  The first time I ran the thrift tests after a clean checkout it failed.  However, it did not fail the ~10 times after that.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mdennis@mdennis:~/c/cassandra$ nosetests test/system/test_thrift_server.py 
...........E....................................
======================================================================
ERROR: system.test_thrift_server.TestMutations.test_batch_mutate_standard_columns
----------------------------------------------------------------------
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/lib/pymodules/python2.6/nose/&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;.py&quot;&lt;/span&gt;, line 183, in runTest
    self.test(*self.arg)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/mdennis/c/cassandra/test/system/test_thrift_server.py&quot;&lt;/span&gt;, line 318, in test_batch_mutate_standard_columns
    _assert_column(&lt;span class=&quot;code-quote&quot;&gt;&apos;Keyspace1&apos;&lt;/span&gt;, column_family, key, &lt;span class=&quot;code-quote&quot;&gt;&apos;c1&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;value1&apos;&lt;/span&gt;)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/mdennis/c/cassandra/test/system/test_thrift_server.py&quot;&lt;/span&gt;, line 43, in _assert_column
    raise Exception(&lt;span class=&quot;code-quote&quot;&gt;&apos;expected %s:%s:%s:%s:%s, but was not present&apos;&lt;/span&gt; % (keyspace, column_family, key, column, value) )
Exception: expected Keyspace1:Standard1:key_27:c1:value1, but was not present

----------------------------------------------------------------------
Ran 48 tests in 184.700s

FAILED (errors=1)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;xubuntu 9.10&lt;br/&gt;
Linux mdennis 2.6.31-20-generic #58-Ubuntu SMP Fri Mar 12 05:23:09 UTC 2010 i686 GNU/Linux&lt;/p&gt;</environment>
        <key id="12460991">CASSANDRA-944</key>
            <summary>system.test_thrift_server.TestMutations.test_batch_mutate_standard_columns appears to be non deterministic</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="mdennis">Matthew F. Dennis</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Apr 2010 03:02:03 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:25 +0000</updated>
                            <resolved>Tue, 6 Apr 2010 21:33:49 +0000</resolved>
                                        <fixVersion>0.7 beta 1</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12852791" author="gdusbabek" created="Fri, 2 Apr 2010 11:22:02 +0000"  >&lt;p&gt;I bet you&apos;re running a mac.&lt;/p&gt;

&lt;p&gt;If you increase the time.sleep(0.1) to a larger value, the problem will go away.  The problem is that the operation being tested is happening at ConsistencyLevel.ZERO and you are feeling the &apos;eventual&apos; part of &apos;eventual consistency.&apos;&lt;/p&gt;

&lt;p&gt;I wonder if it would be a good idea to make the sleep value a constant and have it set to 0.15 if MacOS is detected.&lt;/p&gt;</comment>
                            <comment id="12852873" author="mdennis" created="Fri, 2 Apr 2010 17:24:24 +0000"  >&lt;p&gt;Sorry, not on a mac, on Linux (see environment field for details )&lt;/p&gt;

&lt;p&gt;I was thinking more like lowering the sleep, but putting it in a loop with a much higher max wait time (like an entire second).&lt;/p&gt;

&lt;p&gt;Assuming the test is trying to verify that eventually the correct data shows up (and is not trying to verify the data shows up in under 0.1 seconds), then I believe something similar to the following would address the issue.&lt;/p&gt;

&lt;p&gt;wait = 1s&lt;br/&gt;
start = now&lt;br/&gt;
verified = false&lt;br/&gt;
while not (verified = try_to_verify) and now &amp;lt; start+wait:&lt;br/&gt;
  sleep(0.05)&lt;/p&gt;

&lt;p&gt;if not verified:&lt;br/&gt;
  fail_test&lt;/p&gt;


&lt;p&gt;thoughts?&lt;/p&gt;</comment>
                            <comment id="12852904" author="gdusbabek" created="Fri, 2 Apr 2010 18:39:34 +0000"  >&lt;p&gt;That would work.  Maybe something like a assert_within(func, wait) function.  If func doesn&apos;t return true within wait, then the test fails.&lt;/p&gt;</comment>
                            <comment id="12854041" author="brandon.williams" created="Tue, 6 Apr 2010 16:19:26 +0000"  >&lt;p&gt;Patch to add a loop as described and use it in conjunction with CL.ZERO&lt;/p&gt;</comment>
                            <comment id="12854195" author="jbellis" created="Tue, 6 Apr 2010 21:33:49 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                            <comment id="12854461" author="hudson" created="Wed, 7 Apr 2010 12:41:54 +0000"  >&lt;p&gt;Integrated in Cassandra #400 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/400/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/400/&lt;/a&gt;)&lt;br/&gt;
    fix heisenbug in system tests, especially common on OS X.  patch by Brandon Williams; reviewed by jbellis for &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12440920" name="944.patch" size="3651" author="brandon.williams" created="Tue, 6 Apr 2010 16:19:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19932</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 33 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g21j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>91761</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>