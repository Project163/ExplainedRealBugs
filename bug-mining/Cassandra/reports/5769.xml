<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:21:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-16735] Adding columns via ALTER TABLE can generate corrupt sstables</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-16735</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;This is similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13004&quot; title=&quot;Corruption while adding/removing a column to/from the table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13004&quot;&gt;&lt;del&gt;CASSANDRA-13004&lt;/del&gt;&lt;/a&gt; and was caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15899&quot; title=&quot;Dropping a column can break queries until the schema is fully propagated&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-15899&quot;&gt;&lt;del&gt;CASSANDRA-15899&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Basically the column placeholders introduced in 15899 can get read-repaired in to the memtable and later flushed to disk and in some cases this can conflict with the actual column (if the actual column is a collection for example) and cause CorruptSSTableExceptions.&lt;/p&gt;

&lt;p&gt;Fix is probably to just revert 15899, at least until if and when we find a solution that we can rely on. Will post that + test next week.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13383482">CASSANDRA-16735</key>
            <summary>Adding columns via ALTER TABLE can generate corrupt sstables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marcuse">Marcus Eriksson</assignee>
                                    <reporter username="marcuse">Marcus Eriksson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Jun 2021 17:51:39 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:55 +0000</updated>
                            <resolved>Mon, 21 Jun 2021 14:00:30 +0000</resolved>
                                        <fixVersion>3.0.25</fixVersion>
                    <fixVersion>3.11.11</fixVersion>
                    <fixVersion>4.0-rc2</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Consistency/Repair</component>
                    <component>Local/SSTable</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17361993" author="edimitrova" created="Fri, 11 Jun 2021 19:13:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcuse&quot; class=&quot;user-hover&quot; rel=&quot;marcuse&quot;&gt;marcuse&lt;/a&gt;, I am not familiar with these works but I am trying to filter the blockers for 4.0.0 Jira board&#160;and I saw this ticket. Reading your thoughts in the description, do you think we can revert 15899 to unblock 4.0.0?&#160;&lt;/p&gt;</comment>
                            <comment id="17361994" author="brandon.williams" created="Fri, 11 Jun 2021 19:15:27 +0000"  >&lt;p&gt;+1 to revert for 4.0.0&lt;/p&gt;</comment>
                            <comment id="17363116" author="krummas" created="Mon, 14 Jun 2021 17:58:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/16735-4.0.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/16735-4.0.0&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/16735-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/16735-3.11&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/16735&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/16735&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/krummas/cassandra?branch=marcuse%2F16735-4.0.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/krummas/cassandra?branch=marcuse%2F16735-4.0.0&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/krummas/cassandra?branch=marcuse%2F16735-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/krummas/cassandra?branch=marcuse%2F16735-3.11&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://app.circleci.com/pipelines/github/krummas/cassandra?branch=marcuse%2F16735&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://app.circleci.com/pipelines/github/krummas/cassandra?branch=marcuse%2F16735&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17363162" author="brandon.williams" created="Mon, 14 Jun 2021 19:18:26 +0000"  >&lt;p&gt;Looks like this broke the in-jvm schema disagreement tests, and the 3.11 run didn&apos;t get the last commit to fix its build before it ran.&lt;/p&gt;</comment>
                            <comment id="17365393" author="krummas" created="Fri, 18 Jun 2021 09:21:19 +0000"  >&lt;p&gt;removed the failing 15899 tests, now the cci runs look good (the sstableverify test fails locally without this patch as well)&lt;/p&gt;</comment>
                            <comment id="17365536" author="edimitrova" created="Fri, 18 Jun 2021 14:44:41 +0000"  >&lt;p&gt;Thank you for all your work &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=marcuse&quot; class=&quot;user-hover&quot; rel=&quot;marcuse&quot;&gt;marcuse&lt;/a&gt;! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;I was wondering, should we really remove the&#160;&lt;em&gt;readWithSchemaDisagreement&lt;/em&gt; test?&lt;/p&gt;

&lt;p&gt;PS Indeed, sstableverify test is a known issue, not related to this patch&lt;/p&gt;</comment>
                            <comment id="17365600" author="beobal" created="Fri, 18 Jun 2021 16:40:10 +0000"  >&lt;p&gt;LGTM +1&lt;/p&gt;</comment>
                            <comment id="17366506" author="ifesdjeen" created="Mon, 21 Jun 2021 10:19:34 +0000"  >&lt;p&gt;LGTM +1 &lt;/p&gt;</comment>
                            <comment id="17366614" author="krummas" created="Mon, 21 Jun 2021 14:00:30 +0000"  >&lt;p&gt;committed to 3.0 and merged all the way up to trunk, thanks!&lt;/p&gt;</comment>
                            <comment id="17369580" author="brandon.williams" created="Fri, 25 Jun 2021 16:30:02 +0000"  >&lt;p&gt;Note that this broke ~370 tests in the 3.0 to 3.11 upgrade: &lt;a href=&quot;https://ci-cassandra.apache.org/job/Cassandra-3.11/186/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/job/Cassandra-3.11/186/&lt;/a&gt; caused by our old friend &quot;Unknown column cdc during deserialization&quot;&lt;/p&gt;</comment>
                            <comment id="17370711" author="krummas" created="Mon, 28 Jun 2021 16:29:50 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16770&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-16770&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17428774" author="jlewandowski" created="Thu, 14 Oct 2021 12:03:53 +0000"  >&lt;p&gt;Hi, I&apos;m looking at `SchemaTest` modified in this ticket - what is that test doing? I mean - is the only way to reproduce that issue executing internal statements?&lt;/p&gt;</comment>
                            <comment id="17428776" author="krummas" created="Thu, 14 Oct 2021 12:11:30 +0000"  >&lt;p&gt;we use &lt;tt&gt;schemaChangeInternal&lt;/tt&gt; to introduce a schema mismatch between nodes, and &lt;tt&gt;executeInternal&lt;/tt&gt; to make sure we read repair later when doing a read&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13386302">CASSANDRA-16770</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="13161" cascade-level="1"><![CDATA[Unrecoverable Corruption / Loss]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12972"><![CDATA[Fuzz Test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 4 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0rw60:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
        <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348743">3.0.23</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/1d87da3f6fc0eca4e805238c19db16e6607b44a7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/1d87da3f6fc0eca4e805238c19db16e6607b44a7&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;new test, cci run&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>