<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:34:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-4459] pig driver casts ints as bytearray</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-4459</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;we seem to be auto-mapping C* int columns to bytearray in Pig, and farther down I can&apos;t seem to find a way to cast that to int and do an average.  &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
grunt&amp;gt; cassandra_users = LOAD &lt;span class=&quot;code-quote&quot;&gt;&apos;cassandra:&lt;span class=&quot;code-comment&quot;&gt;//cqldb/users&apos;&lt;/span&gt; USING CassandraStorage();
&lt;/span&gt;grunt&amp;gt; dump cassandra_users;
(bobhatter,(act,22),(fname,bob),(gender,m),(highSchool,Cal High),(lname,hatter),(sat,500),(state,CA),{})
(alicesmith,(act,27),(fname,alice),(gender,f),(highSchool,Tuscon High),(lname,smith),(sat,650),(state,AZ),{})
 
&lt;span class=&quot;code-comment&quot;&gt;// notice sat and act columns are bytearray values 
&lt;/span&gt;grunt&amp;gt; describe cassandra_users;
cassandra_users: {key: chararray,act: (name: chararray,value: bytearray),fname: (name: chararray,value: chararray),
gender: (name: chararray,value: chararray),highSchool: (name: chararray,value: chararray),lname: (name: chararray,value: chararray),
sat: (name: chararray,value: bytearray),state: (name: chararray,value: chararray),columns: {(name: chararray,value: chararray)}}

grunt&amp;gt; users_by_state = GROUP cassandra_users BY state;
grunt&amp;gt; dump users_by_state;
((state,AX),{(aoakley,(highSchool,Phoenix High),(lname,Oakley),state,(act,22),(sat,500),(gender,m),(fname,Anne),{})})
((state,AZ),{(gjames,(highSchool,Tuscon High),(lname,James),state,(act,24),(sat,650),(gender,f),(fname,Geronomo),{})})
((state,CA),{(philton,(highSchool,Beverly High),(lname,Hilton),state,(act,37),(sat,220),(gender,m),(fname,Paris),{}),(jbrown,(highSchool,Cal High),(lname,Brown),state,(act,20),(sat,700),(gender,m),(fname,Jerry),{})})

&lt;span class=&quot;code-comment&quot;&gt;// Error - use explicit &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;
&lt;/span&gt;grunt&amp;gt; user_avg = FOREACH users_by_state GENERATE cassandra_users.state, AVG(cassandra_users.sat);
grunt&amp;gt; dump user_avg;
2012-07-22 17:15:04,361 [main] ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1045: Could not infer the matching function &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; org.apache.pig.builtin.AVG as multiple or none of them fit. Please use an explicit &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;.

&lt;span class=&quot;code-comment&quot;&gt;// Unable to &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; as &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;
&lt;/span&gt;grunt&amp;gt; user_avg = FOREACH users_by_state GENERATE cassandra_users.state, AVG((&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)cassandra_users.sat);
grunt&amp;gt; dump user_avg;
2012-07-22 17:07:39,217 [main] ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1052: Cannot &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; bag with schema sat: bag({name: chararray,value: bytearray}) to &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;b&gt;Seed data in CQL&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE KEYSPACE cqldb with 
  strategy_class = &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.locator.SimpleStrategy&apos;&lt;/span&gt; 
  and strategy_options:replication_factor=3;	


use cqldb;

CREATE COLUMNFAMILY users (
  KEY text PRIMARY KEY, 
  fname text, lname text, gender varchar, 
  act &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, sat &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, highSchool text, state varchar);

insert into users (KEY, fname, lname, gender, act, sat, highSchool, state)
values (gjames, Geronomo, James, f, 24, 650, &lt;span class=&quot;code-quote&quot;&gt;&apos;Tuscon High&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;AZ&apos;&lt;/span&gt;);

insert into users (KEY, fname, lname, gender, act, sat, highSchool, state)
values (aoakley, Anne, Oakley, m , 22, 500, &lt;span class=&quot;code-quote&quot;&gt;&apos;Phoenix High&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;AX&apos;&lt;/span&gt;);

insert into users (KEY, fname, lname, gender, act, sat, highSchool, state)
values (jbrown, Jerry, Brown, m , 20, 700, &lt;span class=&quot;code-quote&quot;&gt;&apos;Cal High&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;CA&apos;&lt;/span&gt;);

insert into users (KEY, fname, lname, gender, act, sat, highSchool, state)
values (philton, Paris, Hilton, m , 37, 220, &lt;span class=&quot;code-quote&quot;&gt;&apos;Beverly High&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;CA&apos;&lt;/span&gt;);

select * from users;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;C* 1.1.2 embedded in DSE&lt;/p&gt;</environment>
        <key id="12599883">CASSANDRA-4459</key>
            <summary>pig driver casts ints as bytearray</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="cdaw">Cathy Daw</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Jul 2012 18:51:51 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:30 +0000</updated>
                            <resolved>Wed, 25 Jul 2012 17:09:56 +0000</resolved>
                                        <fixVersion>1.1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13420891" author="brandon.williams" created="Mon, 23 Jul 2012 19:19:29 +0000"  >&lt;p&gt;We actually have tests in examples/pig/test that explicitly cover this, but we populate that data with the cli which uses IntegerType, but cql uses Int32Type.  Trivial patch to cast both to pig&apos;s integer type.&lt;/p&gt;</comment>
                            <comment id="13420909" author="jbellis" created="Mon, 23 Jul 2012 19:40:42 +0000"  >&lt;p&gt;casting IntegerType to pig&apos;s &lt;span class=&quot;error&quot;&gt;&amp;#91;32bit&amp;#93;&lt;/span&gt; int sounds broken to me.  shouldn&apos;t we fix the population script to use int32 as well?&lt;/p&gt;</comment>
                            <comment id="13421338" author="xedin" created="Tue, 24 Jul 2012 11:41:34 +0000"  >&lt;p&gt;I agree with Jonathan on this, IntegerType could be larger than int32.&lt;/p&gt;</comment>
                            <comment id="13421502" author="jeromatron" created="Tue, 24 Jul 2012 16:04:52 +0000"  >&lt;p&gt;fwiw - see &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2764&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PIG-2764&lt;/a&gt; for the addition of BigInteger and BigDecimal as built-in pig data types.  Also, I&apos;m not sure how much of an issue it is for users to use pig ints for now because I don&apos;t know how many users know that the cassandra IntegerType is actually a BigInteger and not just a regular Integer.  That&apos;s not to say that it&apos;s not dangerous to try to put a BigInteger value into an Integer type.  It&apos;s just that I don&apos;t know if it&apos;s common knowledge that Cassandra uses a BigInteger underneath.&lt;/p&gt;</comment>
                            <comment id="13421508" author="brandon.williams" created="Tue, 24 Jul 2012 16:10:10 +0000"  >&lt;blockquote&gt;&lt;p&gt;casting IntegerType to pig&apos;s &lt;span class=&quot;error&quot;&gt;&amp;#91;32bit&amp;#93;&lt;/span&gt; int sounds broken to me.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree, but the conundrum we&apos;re in now is, I&apos;m almost certain someone is relying on the current behavior to work and always using ints under 2**31, so changing it now would break things for them, and really the only danger is exceeding that limit, which I suspect people who create int columns never intend to do (or they&apos;d make them longs.)&lt;/p&gt;

&lt;p&gt;So, I propose that when pig has a BigInteger, we switch to that, allowing a smooth transition (unless you&apos;re exceeding 2**31 already, which to my knowledge no one is.)&lt;/p&gt;</comment>
                            <comment id="13421510" author="jbellis" created="Tue, 24 Jul 2012 16:12:36 +0000"  >&lt;p&gt;That&apos;s reasonable, but we should still use int32type for cli population &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13422375" author="brandon.williams" created="Wed, 25 Jul 2012 16:16:50 +0000"  >&lt;p&gt;Update with a comment explaining that IntegerType is wrong, but we&apos;re doing it anyway.  Also switched all the IntegerTypes to Int32Types in the tests, which pass.  I don&apos;t see any point in explicitly testing IntegerType as well until pig has a BigInteger.&lt;/p&gt;</comment>
                            <comment id="13422395" author="jbellis" created="Wed, 25 Jul 2012 16:40:33 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13422400" author="xedin" created="Wed, 25 Jul 2012 16:43:01 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13422419" author="brandon.williams" created="Wed, 25 Jul 2012 17:09:56 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12537848" name="4459-v2.txt" size="2026" author="brandon.williams" created="Wed, 25 Jul 2012 16:16:50 +0000"/>
                            <attachment id="12537596" name="4459.txt" size="807" author="brandon.williams" created="Mon, 23 Jul 2012 19:19:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>256175</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 17 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gw3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96632</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>xedin</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[xedin]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>