<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:12:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-14735] LOCAL_QUORUM may speculate to non-local nodes, resulting in Timeout instead of Unavailable</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-14735</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;This issue applies to all of: rapid read protection, read repair&apos;s rapid read protection and read repair&apos;s&#160;rapid write protection.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13184626">CASSANDRA-14735</key>
            <summary>LOCAL_QUORUM may speculate to non-local nodes, resulting in Timeout instead of Unavailable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="benedict">Benedict Elliott Smith</assignee>
                                    <reporter username="benedict">Benedict Elliott Smith</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Sep 2018 14:32:06 +0000</created>
                <updated>Fri, 15 May 2020 07:59:59 +0000</updated>
                            <resolved>Wed, 26 Sep 2018 09:57:08 +0000</resolved>
                                        <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16621758" author="benedict" created="Thu, 20 Sep 2018 09:49:47 +0000"  >&lt;p&gt;Patch available &lt;a href=&quot;https://github.com/belliottsmith/cassandra/tree/14735&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This patch begins by cleaning up &lt;tt&gt;ConsistencyLevel&lt;/tt&gt; to remove (most of) the functionality that doesn&apos;t logically belong there:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;DC locality testing (to &lt;tt&gt;InOurDcTester&lt;/tt&gt;)&lt;/li&gt;
	&lt;li&gt;Replica counting per DC and replication type (to &lt;tt&gt;Replicas&lt;/tt&gt;)&lt;/li&gt;
	&lt;li&gt;Endpoint sufficiency testing / filtering to &lt;tt&gt;ReplicaPlans&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The last commit makes the only functional changes, reworking the filtering code into separate &lt;tt&gt;candidatesForRead&lt;/tt&gt; and &lt;tt&gt;contactForRead&lt;/tt&gt; methods, as well as moving from &lt;tt&gt;HashMap&amp;lt;String, Integer&amp;gt;&lt;/tt&gt; to &lt;tt&gt;ObjectIntOpenHashMap&lt;/tt&gt; in the replica counting methods.&lt;/p&gt;</comment>
                            <comment id="16621760" author="benedict" created="Thu, 20 Sep 2018 09:50:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ifesdjeen&quot; class=&quot;user-hover&quot; rel=&quot;ifesdjeen&quot;&gt;ifesdjeen&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aweisberg&quot; class=&quot;user-hover&quot; rel=&quot;aweisberg&quot;&gt;aweisberg&lt;/a&gt;, would either (or both) of you mind reviewing?&lt;/p&gt;</comment>
                            <comment id="16622844" author="aweisberg" created="Thu, 20 Sep 2018 23:03:42 +0000"  >&lt;p&gt;I ran out of time today. The thing I couldn&apos;t convince myself of was how this fixes rapid read protection and read repair. I need to look up how they assemble their reads.&lt;/p&gt;

&lt;p&gt;I guess I&apos;m confused how it was broken before because we filter based on DC locality even without this change?&lt;/p&gt;</comment>
                            <comment id="16622857" author="benedict" created="Thu, 20 Sep 2018 23:18:11 +0000"  >&lt;p&gt;It&#8217;s possible there were too many extraneous cleanup changes; the fix, fundamentally, is splitting filterForQuery into candidatesForRead and contactsForRead; the former now also filters to DC local, whereas previously candidates were not DC-local.&lt;/p&gt;</comment>
                            <comment id="16622913" author="aweisberg" created="Fri, 21 Sep 2018 00:33:54 +0000"  >&lt;p&gt;Oh I get it now. It previously selected the candidates and then filtered after resulting in a candidates collection with too many incorrect options. Other DCs are not candidates for LOCAL_*.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16628496" author="benedict" created="Wed, 26 Sep 2018 09:57:08 +0000"  >&lt;p&gt;Thanks, committed as &lt;a href=&quot;https://github.com/apache/cassandra/commit/8554d6b35dcc5eec46ed7edc809a36c1f7fa588f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;8554d6b35dcc5eec46ed7edc809a36c1f7fa588f&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="13183397">CASSANDRA-14697</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[benedict]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 7 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3y0ev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
        <customfieldvalue><![CDATA[aweisberg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>