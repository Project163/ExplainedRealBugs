<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 01:36:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92">
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-4054] SStableImport and SStableExport does not serialize row level deletion</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-4054</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;SSTableImport and SSTableExport does not serialize/de-serialize the row-level deletion info to/from the json file. This brings back the deleted data after restore from the json file.&lt;/p&gt;</description>
                <environment/>
        <key id="12546566">CASSANDRA-4054</key>
            <summary>SStableImport and SStableExport does not serialize row level deletion</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dr-alves">David Alves</assignee>
                                    <reporter username="hanzhu">Zhu Han</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 Mar 2012 10:47:01 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:37 +0000</updated>
                            <resolved>Thu, 12 Jul 2012 15:41:14 +0000</resolved>
                                        <fixVersion>1.2.0 beta 1</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due/>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13230563" author="jbellis" created="Thu, 15 Mar 2012 21:17:58 +0000">&lt;p&gt;I think we could fix that by splitting the row into {'key': key, 'metadata': &lt;/p&gt;
{...}
&lt;p&gt;, 'columns': &lt;span class="error"&gt;&amp;#91;...&amp;#93;&lt;/span&gt;} instead of the current &lt;/p&gt;
{key: [...]}
&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;Do you want to take a stab at that, Zhu?&lt;/p&gt;</comment>
                            <comment id="13230564" author="jbellis" created="Thu, 15 Mar 2012 21:19:03 +0000">&lt;p&gt;Changing fix version to 1.1.0 since this would be backwards-incompatible.  If we miss 1.1.0 we can push to 1.2.&lt;/p&gt;</comment>
                            <comment id="13398184" author="dr-alves" created="Thu, 21 Jun 2012 04:36:35 +0000">&lt;p&gt;Patch implements jbellis suggestion.&lt;br/&gt;
also:&lt;/p&gt;
&lt;ul class="alternate" type="square"&gt;
	&lt;li&gt;refactored SSTableImport's methods away from static (class had static internal state that was breaking tests in some configurations)&lt;/li&gt;
	&lt;li&gt;added several tests to import that were missing (import sorted was only tested in the case we indicated we wanted to import sorted but there were unsorted keys).&lt;/li&gt;
	&lt;li&gt;deletion info is serialized/deserialized with the same data as in DeletionInfo.Serializer.serializeToSSTable&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13398548" author="yukim" created="Thu, 21 Jun 2012 16:31:22 +0000">&lt;p&gt;SSTableImport seems it does not handle SuperColumn deletion as well. (It has been commented out for long time.)&lt;br/&gt;
How about extending writeMeta/parseCFMetadata to accept SuperColumn (or more precisely, AbstractColumnContainer) and use them when handling both row and SuperColumn?&lt;br/&gt;
Also, it would be great if you remove whitespaces on empty line and always put braces on new line.&lt;/p&gt;</comment>
                            <comment id="13404303" author="dr-alves" created="Fri, 29 Jun 2012 23:13:42 +0000">&lt;p&gt;additionally implements Yuki's suggestion. also deals with formatting and whitespace issues.&lt;/p&gt;</comment>
                            <comment id="13404308" author="jbellis" created="Fri, 29 Jun 2012 23:20:10 +0000">&lt;blockquote&gt;&lt;p&gt;I think we could fix that by splitting the row into {'key': key, 'metadata': {...}, 'columns': &lt;span class="error"&gt;&amp;#91;...&amp;#93;&lt;/span&gt;} &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thinking about it more ... do we really want a meta&lt;span class="error"&gt;&amp;#91;data&amp;#93;&lt;/span&gt; object with just a single sub-object?  should we just pull deletion_info out and make it a top-level field and dispense with the meta container?&lt;/p&gt;

&lt;p&gt;Nit: would prefer to spell out "columns" vs "cols"&lt;/p&gt;</comment>
                            <comment id="13404319" author="dr-alves" created="Fri, 29 Jun 2012 23:33:39 +0000">&lt;p&gt;the only point I can think of for the metadata container is to ease maintenance/compatibility down the line (i.e. writing/parsing metadata can change without having impact on the overall format), then again the less verbose the output the better (previous format had that in mind and that's why I used "meta" and "cols" instead of "metadata" and "columns"). I'm happy either way. wdyt?&lt;/p&gt;</comment>
                            <comment id="13410387" author="dr-alves" created="Tue, 10 Jul 2012 14:43:05 +0000">&lt;p&gt;Yuki is the implementation on the latest patch what you had in mind?&lt;br/&gt;
wrt to pulling deletionInfo up and abandoning metadata +0, I'm happy either way.&lt;/p&gt;</comment>
                            <comment id="13411600" author="yukim" created="Wed, 11 Jul 2012 14:58:25 +0000">&lt;p&gt;David, &lt;br/&gt;
As you stated above, I think it is ok to leave metadata container.&lt;br/&gt;
So, I'm +1 here, only if it were "metadata" and "columns".&lt;br/&gt;
Could you make those changes and repost the patch?&lt;/p&gt;</comment>
                            <comment id="13411719" author="dr-alves" created="Wed, 11 Jul 2012 16:59:45 +0000">&lt;p&gt;patch without abbreviated names&lt;/p&gt;</comment>
                            <comment id="13412884" author="yukim" created="Thu, 12 Jul 2012 15:40:58 +0000">&lt;p&gt;+1 and committed. Thanks, David!&lt;/p&gt;</comment>
                            <comment id="13412899" author="hudson" created="Thu, 12 Jul 2012 16:09:47 +0000">&lt;p&gt;Integrated in Cassandra #1691 (See &lt;a href="https://builds.apache.org/job/Cassandra/1691/" class="external-link" target="_blank" rel="nofollow noopener"&gt;https://builds.apache.org/job/Cassandra/1691/&lt;/a&gt;)&lt;br/&gt;
    new json format with row level deletion; patch by David Alves, reviewed by yukim for &lt;a href="https://issues.apache.org/jira/browse/CASSANDRA-4054" title="SStableImport and SStableExport does not serialize row level deletion" class="issue-link" data-issue-key="CASSANDRA-4054"&gt;&lt;del&gt;CASSANDRA-4054&lt;/del&gt;&lt;/a&gt; (Revision d569f873de40f0336a9a34e260c1942866e48950)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
yukim : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;test/resources/SuperCF.json&lt;/li&gt;
	&lt;li&gt;test/resources/UnsortedCF.json&lt;/li&gt;
	&lt;li&gt;test/resources/SimpleCF.oldformat.json&lt;/li&gt;
	&lt;li&gt;test/resources/CounterCF.json&lt;/li&gt;
	&lt;li&gt;src/java/org/apache/cassandra/tools/SSTableExport.java&lt;/li&gt;
	&lt;li&gt;CHANGES.txt&lt;/li&gt;
	&lt;li&gt;test/unit/org/apache/cassandra/tools/SSTableImportTest.java&lt;/li&gt;
	&lt;li&gt;test/resources/SimpleCFWithDeletionInfo.json&lt;/li&gt;
	&lt;li&gt;test/resources/SimpleCF.json&lt;/li&gt;
	&lt;li&gt;test/unit/org/apache/cassandra/tools/SSTableExportTest.java&lt;/li&gt;
	&lt;li&gt;src/java/org/apache/cassandra/tools/SSTableImport.java&lt;/li&gt;
	&lt;li&gt;test/resources/UnsortedSuperCF.json&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12536064" name="4054.patch" size="53498" author="dr-alves" created="Wed, 11 Jul 2012 16:59:45 +0000"/>
                            <attachment id="12534069" name="4054.patch" size="53410" author="dr-alves" created="Fri, 29 Jun 2012 23:13:42 +0000"/>
                            <attachment id="12532821" name="4054.patch" size="47500" author="dr-alves" created="Thu, 21 Jun 2012 04:31:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[dr-alves]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>231724</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 19 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0grf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95872</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yukim</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>