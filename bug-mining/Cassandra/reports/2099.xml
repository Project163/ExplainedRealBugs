<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:37:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5378] Fat Client: No longer works in 1.2</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5378</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;The current client only example doesn&apos;t compile. After doing some updates, the fat client still won&apos;t work, mainly because the schema is not being pushed to the fat client.&lt;/p&gt;

&lt;p&gt;I&apos;ve made changes to the client to support CQL3 commands, to the ServiceManager to wait until a migration has completed before starting the client, and to the MigrationManager to not try to pull schemas from a fat client.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12638545">CASSANDRA-5378</key>
            <summary>Fat Client: No longer works in 1.2</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="carlyeks">Carl Yeksigian</assignee>
                                    <reporter username="carlyeks">Carl Yeksigian</reporter>
                        <labels>
                            <label>client</label>
                    </labels>
                <created>Fri, 22 Mar 2013 17:28:41 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:16 +0000</updated>
                            <resolved>Wed, 7 Aug 2013 17:31:18 +0000</resolved>
                                        <fixVersion>1.2.9</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13611066" author="carlyeks" created="Fri, 22 Mar 2013 18:46:51 +0000"  >&lt;p&gt;Was actually developing against trunk for this patch, so the fix version should be 2.0.&lt;/p&gt;

&lt;p&gt;I&apos;m fixing it for 1.2.4 as well, but this patch doesn&apos;t apply cleanly.&lt;/p&gt;</comment>
                            <comment id="13611068" author="carlyeks" created="Fri, 22 Mar 2013 18:50:25 +0000"  >&lt;p&gt;This patch is applied against the 1.2 branch - the unclean file wasn&apos;t needed.&lt;/p&gt;</comment>
                            <comment id="13617343" author="brandon.williams" created="Fri, 29 Mar 2013 13:54:33 +0000"  >&lt;p&gt;Committed, thanks!&lt;/p&gt;</comment>
                            <comment id="13617365" author="brandon.williams" created="Fri, 29 Mar 2013 14:15:18 +0000"  >&lt;p&gt;&lt;a href=&quot;http://buildbot.datastax.com:8020/builders/cassandra-1.2/builds/179/steps/shell/logs/stdio&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://buildbot.datastax.com:8020/builders/cassandra-1.2/builds/179/steps/shell/logs/stdio&lt;/a&gt; StorageServiceClientTest is failing, can you take a look?&lt;/p&gt;</comment>
                            <comment id="13617447" author="carlyeks" created="Fri, 29 Mar 2013 15:50:25 +0000"  >&lt;p&gt;This fixes the test.&lt;/p&gt;</comment>
                            <comment id="13617518" author="brandon.williams" created="Fri, 29 Mar 2013 17:04:54 +0000"  >&lt;p&gt;Committed as well, thanks.&lt;/p&gt;</comment>
                            <comment id="13623599" author="slebresne" created="Fri, 5 Apr 2013 13:04:34 +0000"  >&lt;p&gt;This broke a dtests, namely cql_tests.py:TestCQL.bug_5240_test.&lt;/p&gt;

&lt;p&gt;The reason is that the patch modifies SelectStatement.java and call CFMetadata.getKeyName(), but that method should not be called from CQL3 ever. I&apos;m not sure I understand why fixing the fat client would involve making any kind of change in SelectStatement tbh.&lt;/p&gt;</comment>
                            <comment id="13623861" author="carlyeks" created="Fri, 5 Apr 2013 17:57:14 +0000"  >&lt;p&gt;The change to select statement is because the fat client can&apos;t use the CFS as it doesn&apos;t have the data. So, the only things that we have instead is the metadata. Since CQL3 is the way that most clients will want to interact with the service, I thought it made sense to try to update those statements to not use the CFS; any direction on how to fix this?&lt;/p&gt;</comment>
                            <comment id="13623915" author="slebresne" created="Fri, 5 Apr 2013 18:36:37 +0000"  >&lt;p&gt;Well looking at that code, what was the rational of adding the offending line was added in the first place:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+                indexedNames.add(cfm.getKeyName());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Seems to me it could just be removed.&lt;/p&gt;</comment>
                            <comment id="13623941" author="carlyeks" created="Fri, 5 Apr 2013 18:51:01 +0000"  >&lt;p&gt;If we don&apos;t have that, we won&apos;t be able to validate a query against the row key.&lt;/p&gt;

&lt;p&gt;That is, if the schema is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE COLUMNFAMILY standard1 ( id ascii PRIMARY KEY , name ascii , value blob ) ;
SELECT * FROM standard1 WHERE id=&lt;span class=&quot;code-quote&quot;&gt;&apos;abc&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That select statement will not be validated, as no column is indexed, but the row key is. It&apos;ll throw the &quot;No indexed columns present in by-columns clause with Equal operator&quot; exception.&lt;/p&gt;</comment>
                            <comment id="13625254" author="slebresne" created="Mon, 8 Apr 2013 09:40:25 +0000"  >&lt;p&gt;I&apos;m not sure what you are talking about. The example above have always worked and does not require the row key to be added to the indexedNames (which is an addition of this patch). The row key is &quot;primarily&quot; indexed but it&apos;s not indexed by a secondary index. And adding a secondary index on the row key is not something supported (largely because it would be useless).&lt;/p&gt;

&lt;p&gt;So anyway, I have removed that line in commit 69f05a704aafa90f2151db721312f3c5907abb2f if only because that restore the behavior of before that patch and let all cql dtests pass. If you still think there is a problem, please open a separate issue with a test case showing the problem you are talking about. &lt;/p&gt;</comment>
                            <comment id="13646895" author="tjake" created="Wed, 1 May 2013 20:34:11 +0000"  >&lt;p&gt;The fix for the test breaks the fat client 5378-v2.txt&lt;/p&gt;

&lt;p&gt;It can no longer get the schema from the non-fat clients and instead throws:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.NullPointerException
	at org.apache.cassandra.service.MigrationManager.maybeScheduleSchemaPull(MigrationManager.java:123)
	at org.apache.cassandra.service.MigrationManager.onAlive(MigrationManager.java:98)
	at org.apache.cassandra.gms.Gossiper.markAlive(Gossiper.java:773)
	at org.apache.cassandra.gms.Gossiper.handleMajorStateChange(Gossiper.java:816)
	at org.apache.cassandra.gms.Gossiper.applyStateLocally(Gossiper.java:901)
	at org.apache.cassandra.gms.GossipDigestAck2VerbHandler.doVerb(GossipDigestAck2VerbHandler.java:50)
	at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:56)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:662)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can we put the change back in or somehow fix this NPE?&lt;/p&gt;</comment>
                            <comment id="13655895" author="carlyeks" created="Mon, 13 May 2013 10:40:34 +0000"  >&lt;p&gt;The point of the second patch was to prevent us from using the file system. This means that the migration manager probably needs to be able to operate exclusively in memory.&lt;/p&gt;

&lt;p&gt;I&apos;ll take a look at this issue later today.&lt;/p&gt;</comment>
                            <comment id="13684024" author="carlyeks" created="Sat, 15 Jun 2013 01:52:33 +0000"  >&lt;p&gt;I&apos;m attaching a fix that adds back the Schema.instance.updateVersion(), but prevents writing out to disk by that call.&lt;/p&gt;

&lt;p&gt;This fixes the test, and the startup of the fat client.&lt;/p&gt;</comment>
                            <comment id="13727268" author="jbellis" created="Fri, 2 Aug 2013 03:25:17 +0000"  >&lt;p&gt;Marking Patch Available.&lt;/p&gt;</comment>
                            <comment id="13732191" author="brandon.williams" created="Wed, 7 Aug 2013 17:31:18 +0000"  >&lt;p&gt;Looks like I ninja&apos;d this exact patch in right after committing the original, to fix the test.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12575068" name="5378-1.2.txt" size="58959" author="carlyeks" created="Fri, 22 Mar 2013 18:50:25 +0000"/>
                            <attachment id="12587943" name="5378-schema-writing.patch" size="1647" author="carlyeks" created="Sat, 15 Jun 2013 01:52:36 +0000"/>
                            <attachment id="12576086" name="5378-v2.txt" size="804" author="carlyeks" created="Fri, 29 Mar 2013 15:50:25 +0000"/>
                            <attachment id="12575045" name="5378.txt" size="60513" author="carlyeks" created="Fri, 22 Mar 2013 17:29:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[carlyeks]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319021</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 15 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1j1nr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319362</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>brandon.williams</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>