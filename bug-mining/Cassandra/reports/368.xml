<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:13:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-1011] Exception auto-bootstrapping two nodes nodes at the same time</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-1011</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I&apos;ve got a small cluster of 3 machines, and after starting the first node (which is the seed), I brought up the other two nodes at the same time. This exception then gets raised on the seed node. Looks like the seed node is assigning the same token to the subnodes at the same time:&lt;/p&gt;

&lt;p&gt;ERROR 21:46:49,417 Error in ThreadPoolExecutor&lt;br/&gt;
java.lang.RuntimeException: Bootstrap Token collision between /10.0.0.2 and /10.0.0.3 (token Token(bytes&lt;span class=&quot;error&quot;&gt;&amp;#91;4c617374204d6967726174696f6e&amp;#93;&lt;/span&gt;)&lt;br/&gt;
	at org.apache.cassandra.locator.TokenMetadata.addBootstrapToken(TokenMetadata.java:130)&lt;br/&gt;
	at org.apache.cassandra.service.StorageService.handleStateBootstrap(StorageService.java:548)&lt;br/&gt;
	at org.apache.cassandra.service.StorageService.onChange(StorageService.java:511)&lt;br/&gt;
	at org.apache.cassandra.gms.Gossiper.doNotifications(Gossiper.java:705)&lt;br/&gt;
	at org.apache.cassandra.gms.Gossiper.applyApplicationStateLocally(Gossiper.java:670)&lt;br/&gt;
	at org.apache.cassandra.gms.Gossiper.applyStateLocally(Gossiper.java:624)&lt;br/&gt;
	at org.apache.cassandra.gms.Gossiper$GossipDigestAck2VerbHandler.doVerb(Gossiper.java:1016)&lt;br/&gt;
	at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:41)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:636)&lt;br/&gt;
ERROR 21:46:49,418 Fatal exception in thread Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;GMFD:1,5,main&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.RuntimeException: Bootstrap Token collision between /10.0.0.2 and /10.0.0.3 (token Token(bytes&lt;span class=&quot;error&quot;&gt;&amp;#91;4c617374204d6967726174696f6e&amp;#93;&lt;/span&gt;)&lt;br/&gt;
	at org.apache.cassandra.locator.TokenMetadata.addBootstrapToken(TokenMetadata.java:130)&lt;br/&gt;
	at org.apache.cassandra.service.StorageService.handleStateBootstrap(StorageService.java:548)&lt;br/&gt;
	at org.apache.cassandra.service.StorageService.onChange(StorageService.java:511)&lt;br/&gt;
	at org.apache.cassandra.gms.Gossiper.doNotifications(Gossiper.java:705)&lt;br/&gt;
	at org.apache.cassandra.gms.Gossiper.applyApplicationStateLocally(Gossiper.java:670)&lt;br/&gt;
	at org.apache.cassandra.gms.Gossiper.applyStateLocally(Gossiper.java:624)&lt;br/&gt;
	at org.apache.cassandra.gms.Gossiper$GossipDigestAck2VerbHandler.doVerb(Gossiper.java:1016)&lt;br/&gt;
	at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:41)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:636)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12462730">CASSANDRA-1011</key>
            <summary>Exception auto-bootstrapping two nodes nodes at the same time</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gdusbabek">Gary Dusbabek</assignee>
                                    <reporter username="erickt">Erick Tryzelaar</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Apr 2010 05:09:43 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:24 +0000</updated>
                            <resolved>Wed, 14 Jul 2010 12:11:35 +0000</resolved>
                                        <fixVersion>0.7 beta 1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12882270" author="gdusbabek" created="Thu, 24 Jun 2010 18:31:08 +0000"  >&lt;p&gt;There is still plenty of window for this to happen, but this should narrow it down some.&lt;/p&gt;</comment>
                            <comment id="12882278" author="jbellis" created="Thu, 24 Jun 2010 18:44:50 +0000"  >&lt;p&gt;i don&apos;t think the window between when the bootstrapping machine chooses a machine to ask for a token, and when it actually does so (sub ms under any scenario i can think of) is large enough to add the extra check in getBalancedToken.  either way the main danger is that some node has already chosen the same token but we haven&apos;t heard about it yet over gossip.&lt;/p&gt;

&lt;p&gt;it would be worth checking though in getBootstrapSource that if sorted node zero has a bootstrap target already (i.e., &lt;em&gt;every&lt;/em&gt; node already has one), then we should fail the bootstrap (and tell the user to specify an initialtoken manually, or wait for one of the current bootstraps to finish).&lt;/p&gt;</comment>
                            <comment id="12887535" author="gdusbabek" created="Mon, 12 Jul 2010 21:12:30 +0000"  >&lt;p&gt;&amp;gt; it would be worth checking though in getBootstrapSource that if sorted node zero has a bootstrap target already (i.e., every node already has one), then we should fail the bootstrap (and tell the user to specify an initialtoken manually, or wait for one of the current bootstraps to finish).&lt;/p&gt;

&lt;p&gt;I think I&apos;m missing something.  We don&apos;t keep track of whether or not node zero has a bootstrap target, do we?  Nothing I can see in TMD indicates this.&lt;/p&gt;</comment>
                            <comment id="12887568" author="jbellis" created="Mon, 12 Jul 2010 22:25:51 +0000"  >&lt;p&gt;metadata.pendingRangeChanges = bootstrap targets, more or less&lt;/p&gt;</comment>
                            <comment id="12888175" author="jbellis" created="Wed, 14 Jul 2010 03:45:04 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12888345" author="hudson" created="Wed, 14 Jul 2010 13:56:22 +0000"  >&lt;p&gt;Integrated in Cassandra #491 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Cassandra/491/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Cassandra/491/&lt;/a&gt;)&lt;br/&gt;
    fail bootstrap if all nodes are bootstrapping. patch by gdusbabek, reviewed by jbellis. &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1011&quot; title=&quot;Exception auto-bootstrapping two nodes nodes at the same time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1011&quot;&gt;&lt;del&gt;CASSANDRA-1011&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12449372" name="0001-fail-bootstrap-if-all-nodes-are-bootstrapping.patch" size="4669" author="gdusbabek" created="Tue, 13 Jul 2010 18:10:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[gdusbabek]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19955</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 19 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g2gf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>91828</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>