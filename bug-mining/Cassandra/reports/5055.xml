<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:11:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-14423] SSTables stop being compacted</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-14423</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;So seeing a problem in 3.11.0 where SSTables are being lost from the view and not being included in compactions/as candidates for compaction. It seems to get progressively worse until there&apos;s only 1-2 SSTables in the view which happen to be the most recent SSTables and thus compactions completely stop for that table.&lt;/p&gt;

&lt;p&gt;The SSTables seem to still be included in reads, just not compactions.&lt;/p&gt;

&lt;p&gt;The issue can be fixed by restarting C*, as it will reload all SSTables into the view, but this is only a temporary fix. User defined/major compactions still work - not clear if they include the result back in the view but is not a good work around.&lt;/p&gt;

&lt;p&gt;This also results in a discrepancy between SSTable count and SSTables in levels for any table using LCS.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Keyspace : xxx
Read Count: 57761088
Read Latency: 0.10527088681224288 ms.
Write Count: 2513164
Write Latency: 0.018211106398149903 ms.
Pending Flushes: 0
Table: xxx
SSTable count: 10
SSTables in each level: [2, 0, 0, 0, 0, 0, 0, 0, 0]
Space used (live): 894498746
Space used (total): 894498746
Space used by snapshots (total): 0
Off heap memory used (total): 11576197
SSTable Compression Ratio: 0.6956629530569777
&lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of keys (estimate): 3562207
Memtable cell count: 0
Memtable data size: 0
Memtable off heap memory used: 0
Memtable &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; count: 87
Local read count: 57761088
Local read latency: 0.108 ms
Local write count: 2513164
Local write latency: NaN ms
Pending flushes: 0
Percent repaired: 86.33
Bloom filter &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; positives: 43
Bloom filter &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; ratio: 0.00000
Bloom filter space used: 8046104
Bloom filter off heap memory used: 8046024
Index summary off heap memory used: 3449005
Compression metadata off heap memory used: 81168
Compacted partition minimum bytes: 104
Compacted partition maximum bytes: 5722
Compacted partition mean bytes: 175
Average live cells per slice (last five minutes): 1.0
Maximum live cells per slice (last five minutes): 1
Average tombstones per slice (last five minutes): 1.0
Maximum tombstones per slice (last five minutes): 1
Dropped Mutations: 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Also for STCS we&apos;ve confirmed that SSTable count will be different to the number of SSTables reported in the Compaction Bucket&apos;s. In the below example there&apos;s only 3 SSTables in a single bucket - no more are listed for this table. Compaction thresholds haven&apos;t been modified for this table and it&apos;s a very basic KV schema.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Keyspace : yyy
    Read Count: 30485
    Read Latency: 0.06708991307200263 ms.
    Write Count: 57044
    Write Latency: 0.02204061776873992 ms.
    Pending Flushes: 0
        Table: yyy
        SSTable count: 19
        Space used (live): 18195482
        Space used (total): 18195482
        Space used by snapshots (total): 0
        Off heap memory used (total): 747376
        SSTable Compression Ratio: 0.7607394576769735
        &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of keys (estimate): 116074
        Memtable cell count: 0
        Memtable data size: 0
        Memtable off heap memory used: 0
        Memtable &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; count: 39
        Local read count: 30485
        Local read latency: NaN ms
        Local write count: 57044
        Local write latency: NaN ms
        Pending flushes: 0
        Percent repaired: 79.76
        Bloom filter &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; positives: 0
        Bloom filter &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; ratio: 0.00000
        Bloom filter space used: 690912
        Bloom filter off heap memory used: 690760
        Index summary off heap memory used: 54736
        Compression metadata off heap memory used: 1880
        Compacted partition minimum bytes: 73
        Compacted partition maximum bytes: 124
        Compacted partition mean bytes: 96
        Average live cells per slice (last five minutes): NaN
        Maximum live cells per slice (last five minutes): 0
        Average tombstones per slice (last five minutes): NaN
        Maximum tombstones per slice (last five minutes): 0
        Dropped Mutations: 0 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Apr 27 03:10:39 cassandra[9263]: TRACE o.a.c.d.c.SizeTieredCompactionStrategy Compaction buckets are [[BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/lib/cassandra/data/yyy/yyy-5f7a2d60e4a811e6868a8fd39a64fd59/mc-67168-big-Data.db&apos;&lt;/span&gt;), BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/lib/cassandra/data/yyy/yyy-5f7a2d60e4a811e6868a8fd39a64fd59/mc-67167-big-Data.db&apos;&lt;/span&gt;), BigTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/lib/cassandra/data/yyy/yyy-5f7a2d60e4a811e6868a8fd39a64fd59/mc-67166-big-Data.db&apos;&lt;/span&gt;)]]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Also for every LCS table we&apos;re seeing the following warning being spammed (seems to be in line with anticompaction spam):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Apr 26 21:30:09 cassandra[9263]: WARN&#160; o.a.c.d.c.LeveledCompactionStrategy Live sstable /&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/lib/cassandra/data/xxx/xxx-8c3ef9e0e3fc11e6868a8fd39a64fd59/mc-79024-big-Data.db from level 0 is not on corresponding level in the leveled manifest. This is not a problem per se, but may indicate an orphaned sstable due to a failed compaction not cleaned up properly.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is a vnodes cluster with 256 tokens per node, and the only thing that seems like it could be causing issues is anticompactions.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-14079&quot; title=&quot;Prevent compaction strategies from looping indefinitely&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-14079&quot;&gt;&lt;del&gt;CASSANDRA-14079&lt;/del&gt;&lt;/a&gt; might be related but doesn&apos;t quite describe the same issue, and in this case we&apos;re using only a single disk for data. Have yet to reproduce but figured worth reporting here first.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13155605">CASSANDRA-14423</key>
            <summary>SSTables stop being compacted</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="KurtG">Kurt Greaves</assignee>
                                    <reporter username="KurtG">Kurt Greaves</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Apr 2018 04:05:22 +0000</created>
                <updated>Tue, 16 Apr 2019 09:29:51 +0000</updated>
                            <resolved>Fri, 29 Jun 2018 08:16:48 +0000</resolved>
                                        <fixVersion>2.2.13</fixVersion>
                    <fixVersion>3.0.17</fixVersion>
                    <fixVersion>3.11.3</fixVersion>
                                    <component>Local/Compaction</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>13</watches>
                                                                                                                <comments>
                            <comment id="16511927" author="kurtg" created="Thu, 14 Jun 2018 03:03:37 +0000"  >&lt;p&gt;Figured this out. tl;dr is that full repairs are completely broken. We add the repaired sstables to the transaction for anti-compaction but we never do anything with them or re-write them (because they are already repaired), and thus they get &quot;removed&quot; from the compaction strategies SSTables along with the unrepaired SSTables that got anti-compacted.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This essentially means that full repairs has been terribly broken for a long time, haven&apos;t checked how far back yet but it seems reasonable to say 2.1. Going to mark this as a blocker for 3.11.3 only while doing more research.&lt;/p&gt;</comment>
                            <comment id="16511934" author="kurtg" created="Thu, 14 Jun 2018 03:12:30 +0000"  >&lt;p&gt;Looks like we only&#160;&lt;em&gt;stopped&lt;/em&gt; anti-compacting repaired SSTables in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13153&quot; title=&quot;Reappeared Data when Mixing Incremental and Full Repairs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13153&quot;&gt;&lt;del&gt;CASSANDRA-13153&lt;/del&gt;&lt;/a&gt;, so this bug only occurs since 2.2.10, 3.0.13, and 3.11.0.&lt;/p&gt;</comment>
                            <comment id="16512316" author="kurtg" created="Thu, 14 Jun 2018 11:02:21 +0000"  >&lt;p&gt;got a patch &amp;amp; test for 3.11 &lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.11...kgreav:14423-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. Started on the wrong branch so will backport to 2.2 and 3.0 tomorrow...&lt;/p&gt;</comment>
                            <comment id="16512497" author="spodxx@gmail.com" created="Thu, 14 Jun 2018 13:59:13 +0000"  >&lt;blockquote&gt;&lt;p&gt; and thus they get &quot;removed&quot; from the compaction strategies SSTables along with the unrepaired SSTables that got anti-compacted.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Where exactly does this happen?&lt;/p&gt;</comment>
                            <comment id="16513294" author="kurtg" created="Fri, 15 Jun 2018 03:46:22 +0000"  >&lt;p&gt;In &lt;tt&gt;org.apache.cassandra.db.compaction.CompactionManager#submitAntiCompaction&lt;/tt&gt; we create a transaction over all SSTables included in the repair (including repaired SSTables when doing full repair) and pass that through to &lt;tt&gt;performAntiCompaction&lt;/tt&gt; in which two things can happen:&lt;/p&gt;

&lt;p&gt;1. The SSTable is fully contained within the repairing ranges, and in that case we mutate repairedAt to the current time of repair and add it to &lt;tt&gt;mutatedRepairStatuses&lt;/tt&gt;&lt;br/&gt;
2. The SSTable isn&apos;t fully contained within the repairing ranges (highly likely if vnodes or single tokens with &amp;gt;RF nodes). In this case we don&apos;t add the &lt;em&gt;already repaired&lt;/em&gt; SSTable to &lt;tt&gt;mutatedRepairStatuses&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;We then remove all SSTables from the transaction in &lt;tt&gt;mutatedRepairStatuses&lt;/tt&gt; &lt;a href=&quot;https://github.com/apache/cassandra/blob/191ad7b87a4ded26be4ab0bd192ef676f059276c/src/java/org/apache/cassandra/db/compaction/CompactionManager.java#L704&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If &lt;b&gt;2&lt;/b&gt; occured, the already repaired SSTables were not in &lt;tt&gt;mutatedRepairStatuses&lt;/tt&gt; and thus didn&apos;t get removed from the transaction and when &lt;tt&gt;txn.finish()&lt;/tt&gt; is called they get removed from the CompactionStrategy&apos;s view of sstables via &lt;tt&gt;org.apache.cassandra.db.lifecycle.LifecycleTransaction#doCommit&lt;/tt&gt; calling &lt;tt&gt;Tracker#notifySSTablesChanged&lt;/tt&gt; which will not include the already repaired SSTables.&lt;/p&gt;

&lt;p&gt;The reason &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13153&quot; title=&quot;Reappeared Data when Mixing Incremental and Full Repairs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13153&quot;&gt;&lt;del&gt;CASSANDRA-13153&lt;/del&gt;&lt;/a&gt; brought this bug to light was because up until that point we &lt;em&gt;were&lt;/em&gt; anti-compacting already repaired SSTables, and thus upon anti-compaction (rewrite) they would be added back into the transaction and the old SSTable would be removed as usual and the new SSTable would take its place.&lt;/p&gt;

&lt;p&gt;Seeing as the existing consensus seems to be that there&apos;s no real value at the moment in mutating repaired times on already repaired SSTables I think the best solution is to not include the repaired SSTables in the transaction in the first place. This corresponds with how trunk currently works and also is a lot cleaner, which is how it works in my patch mentioned above. The alternative would be to remove them from the transaction regardless of if they were mutated, but this seems pointless considering we don&apos;t do anything with it. If we ever decide there is value in updating repairedAt on already repaired SSTables, we can add it back and handle it then. &lt;/p&gt;</comment>
                            <comment id="16513345" author="kurtg" created="Fri, 15 Jun 2018 05:05:56 +0000"  >&lt;p&gt;Patches for all branches:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...kgreav:14423-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.0...kgreav:14423-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.11...kgreav:14423-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="16513693" author="spodxx@gmail.com" created="Fri, 15 Jun 2018 11:46:07 +0000"  >&lt;p&gt;Thanks for the detailed description. Finishing a LifecycleTransaction does indeed seem to remove the sstables the transactions has been created for from the compaction strategy. Simply ignoring repaired sstables, by filtering them as currently implemented, should be changed in that case. &lt;/p&gt;

&lt;p&gt;But it looks like your patch effectively reverts &lt;a href=&quot;https://github.com/apache/cassandra/commit/67637d1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;67637d1&lt;/a&gt; (&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11172&quot; title=&quot;Infinite loop bug adding high-level SSTableReader in compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11172&quot;&gt;&lt;del&gt;CASSANDRA-11172&lt;/del&gt;&lt;/a&gt;) which needs some more careful consideration.&lt;/p&gt;

&lt;p&gt;/cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krummas&quot; class=&quot;user-hover&quot; rel=&quot;krummas&quot;&gt;krummas&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="16515286" author="kurtg" created="Mon, 18 Jun 2018 01:59:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spodxx%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;spodxx@gmail.com&quot;&gt;spodxx@gmail.com&lt;/a&gt; That change was to ensure that we didn&apos;t send repair status change notifications where the SSTable was already marked as repaired. My change doesn&apos;t revert that,  as we no longer pass through the repaired SSTables to &lt;tt&gt;performAntiCompaction&lt;/tt&gt; so there is no need to filter them out. Granted it does change the behaviour of &lt;tt&gt;performAntiCompaction&lt;/tt&gt; and if someone were to call it and pass in repaired SSTables, it would produce the old behaviour. But arguably you should never be passing already repaired SSTables to &lt;tt&gt;performAntiCompaction&lt;/tt&gt;. At the moment &lt;tt&gt;performAntiCompaction&lt;/tt&gt; is only ever used by submitAntiCompaction in the codebase, so it&apos;s only a problem if 3rd party tools are using it. If we&apos;re worried maybe adding a test to the start of &lt;tt&gt;performAntiCompaction&lt;/tt&gt; to check the SSTables aren&apos;t already repaired would be the way to go?&lt;/p&gt;

&lt;p&gt;utests:&lt;br/&gt;
&lt;a href=&quot;https://circleci.com/gh/kgreav/cassandra/163&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://circleci.com/gh/kgreav/cassandra/167&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://circleci.com/gh/kgreav/cassandra/165&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16515628" author="spodxx@gmail.com" created="Mon, 18 Jun 2018 11:58:22 +0000"  >&lt;p&gt;Can we move the status check into &lt;tt&gt;performAnticompaction&lt;/tt&gt; by adding already repaired sstables to &lt;tt&gt;nonAnticompacting&lt;/tt&gt;? I think filtering there would be more coherent, given we also create a corresponding log message and use the same code path for canceling/releasing such sstables. We also keep updating repairedAt this way, in case of fully contained sstables (and the triggered event notification related to that).&lt;/p&gt;</comment>
                            <comment id="16515644" author="spodxx@gmail.com" created="Mon, 18 Jun 2018 12:30:08 +0000"  >&lt;p&gt;I&apos;d like to add for interested readers that full repairs on subranges (e.g. using reaper) will not be affected by this issue. In this case, &quot;Not a global repair, will not do anticompaction&quot; will occur in your logs.&lt;/p&gt;</comment>
                            <comment id="16517011" author="kurtg" created="Tue, 19 Jun 2018 12:27:02 +0000"  >&lt;p&gt;OK. I&apos;ve updated all 3 branches to use &lt;tt&gt;nonAnticompacting&lt;/tt&gt; for filtering. Personally, I&apos;m not a huge fan of this but it avoids the behaviour change issues previously mentioned and still fixes the problem. Also as I see it, a cleaner fix would require some refactoring of &lt;tt&gt;submitAntiCompaction&lt;/tt&gt; and &lt;tt&gt;performAntiCompaction&lt;/tt&gt; to decouple anti-compaction from repair, which is not possible in current releases anyway (to clarify, I don&apos;t think &lt;tt&gt;performAntiCompaction&lt;/tt&gt; should care about whether SSTables are repaired or not). I can see a future though where it&apos;s possible to anti-compact SSTables separate to a repair, but I&apos;ll think about that for a separate ticket for trunk.&lt;/p&gt;

&lt;p&gt;Side-notes related to patches: I took the liberty of making one log message less spammy &quot;SSTable x will be anticompacted on range...&quot; - with many vnodes this becomes ridiculously spammy. It&apos;s not a lot better in the patched version, but at least it&apos;s a one line log message with no repeated information.&lt;/p&gt;

&lt;p&gt;And I took the liberty of fixing the &quot;anti-compacted from x to y SSTables&quot; log message in &lt;tt&gt;doAntiCompaction&lt;/tt&gt;. This was broken as &lt;tt&gt;repaired.originals.size&lt;/tt&gt; could/would return a wrong size after &lt;tt&gt;repaired.split(sstableGroup)&lt;/tt&gt; was called.&lt;/p&gt;

&lt;p&gt;Also, the assert at the end of &lt;tt&gt;performAntiCompaction&lt;/tt&gt; had to be removed as we&apos;re removing &lt;tt&gt;nonAnticompacting&lt;/tt&gt; from the transaction which violates the assert, this is fine however as the assert was effectively incorrect in the first place, and only valid due to the bug.&lt;/p&gt;

&lt;p&gt;Finally, I split the tests out into a separate method (&lt;tt&gt;shouldAntiCompact&lt;/tt&gt;), and added more test cases&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-2.2...kgreav:14423-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/kgreav/cassandra/169&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.0...kgreav:14423-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/kgreav/cassandra/171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.11...kgreav:14423-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/kgreav/cassandra/173&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I&apos;m working on a unit test for trunk, but it&apos;s going to have to be a fair bit different, as the repaired SSTables are filtered out prior to creation of the transaction. I don&apos;t think it needs to block review of the other branches however.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16519010" author="spodxx@gmail.com" created="Thu, 21 Jun 2018 07:14:02 +0000"  >&lt;p&gt;I think this is going in the right direction.&lt;/p&gt;

&lt;p&gt;As for log messages, the &quot;does not intersect repaired ranges&quot; message seems to be now incorrectly shown for already repaired sstables.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Also, the assert at the end of performAntiCompaction had to be removed as we&apos;re removing nonAnticompacting from the transaction which violates the assert, this is fine however as the assert was effectively incorrect in the first place, and only valid due to the bug.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Help me out, in which case do we end up removing an sstable in nonAnticompacting from txn.originals that would not also be removed from sstableIterator?&lt;/p&gt;</comment>
                            <comment id="16523635" author="spodxx@gmail.com" created="Tue, 26 Jun 2018 12:08:32 +0000"  >&lt;p&gt;Took another closer look at the patch today and I think that this should work. I put the assert back in, as I still can&apos;t see why it should not hold anymore. Also did some minor wording changes to a log message, changelog and git log, if that&apos;s ok for you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=KurtG&quot; class=&quot;user-hover&quot; rel=&quot;KurtG&quot;&gt;KurtG&lt;/a&gt;.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/spodkowinski/cassandra/tree/CASSANDRA-14423-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;br/&gt;
 &lt;a href=&quot;https://circleci.com/gh/spodkowinski/cassandra/tree/CASSANDRA-14423-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;circleci&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/578/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/spodkowinski/cassandra/tree/CASSANDRA-14423-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://circleci.com/gh/spodkowinski/cassandra/tree/CASSANDRA-14423-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;circleci&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/579/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/spodkowinski/cassandra/tree/CASSANDRA-14423-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://circleci.com/gh/spodkowinski/cassandra/tree/CASSANDRA-14423-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;circleci&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/580/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The 2.2 circleci test failures seem to be flaky. Dtests still running.&lt;/p&gt;</comment>
                            <comment id="16524292" author="kurtg" created="Tue, 26 Jun 2018 22:43:22 +0000"  >&lt;p&gt;Sorry for the delay, was looking at this yesterday but yeah, it turned out the assert failing was just me imagining things. That all seems good to me &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spodxx%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;spodxx@gmail.com&quot;&gt;spodxx@gmail.com&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16524758" author="krummas" created="Wed, 27 Jun 2018 08:18:56 +0000"  >&lt;p&gt;Should we stop doing anticompaction at all after full repairs instead? Clearly no one does &lt;tt&gt;--full&lt;/tt&gt; repairs right now and letting users do non-incremental full repairs might be good until 4.0 (&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9143&quot; title=&quot;Fix consistency of incrementally repaired data across replicas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9143&quot;&gt;&lt;del&gt;CASSANDRA-9143&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="16524885" author="kurtg" created="Wed, 27 Jun 2018 10:34:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krummas&quot; class=&quot;user-hover&quot; rel=&quot;krummas&quot;&gt;krummas&lt;/a&gt; I&apos;ve suggested that we at the very least provide a flag to skip anti-compaction from full repairs before, but it was all deemed too &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13885?focusedCommentId=16206922&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16206922&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;complicated&lt;/a&gt;. Regardless, I think a flag would be perfectly fine and it&apos;s still desirable so at least people can go back to at the very least running full repairs successfully without having to worry about SSTables being marked repaired. However, I don&apos;t think we can go and change the default behaviour, purely because people&#160;&lt;em&gt;could&lt;/em&gt; still be running full repairs on earlier versions of 3.x/3.0 before this bug came along.&lt;/p&gt;</comment>
                            <comment id="16524923" author="krummas" created="Wed, 27 Jun 2018 11:13:37 +0000"  >&lt;p&gt;the patches lgtm&lt;/p&gt;</comment>
                            <comment id="16526070" author="spodxx@gmail.com" created="Thu, 28 Jun 2018 08:02:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=KurtG&quot; class=&quot;user-hover&quot; rel=&quot;KurtG&quot;&gt;KurtG&lt;/a&gt;, do you mind to go on by committing 2.2/3.0/3.11 patches now and address trunk in a separate ticket?&lt;/p&gt;</comment>
                            <comment id="16526981" author="kurtg" created="Fri, 29 Jun 2018 00:45:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=spodxx%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;spodxx@gmail.com&quot;&gt;spodxx@gmail.com&lt;/a&gt;, not at all. Probably won&apos;t have time to look at trunk until next week, and I&apos;m fairly sure it&apos;ll just be a case of making the test work so I&apos;ll create another ticket for trunk.&lt;/p&gt;</comment>
                            <comment id="16526987" author="kurtg" created="Fri, 29 Jun 2018 00:51:44 +0000"  >&lt;p&gt;Created &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-14550&quot; title=&quot;Port changes for CASSANDRA-14423 to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-14550&quot;&gt;CASSANDRA-14550&lt;/a&gt; for the trunk port.&lt;/p&gt;</comment>
                            <comment id="16527284" author="michaelsembwever" created="Fri, 29 Jun 2018 07:20:24 +0000"  >&lt;p&gt;Jumping on this to commit. Two (other) reviewers have +1 this now, and tests have passed.&lt;/p&gt;

&lt;p&gt;Repeating for clarity, the patches and their tests were&#8230;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;uTest&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dTest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/spodkowinski/cassandra/tree/CASSANDRA-14423-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;cassandra-2.2_14423&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/spodkowinski/cassandra/tree/CASSANDRA-14423-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://circleci.com/gh/spodkowinski/cassandra/tree/CASSANDRA-14423-2.2.svg?style=svg&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/583&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/583/badge/icon&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/spodkowinski/cassandra/tree/CASSANDRA-14423-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;cassandra-3.0_14423&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/spodkowinski/cassandra/tree/CASSANDRA-14423-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://circleci.com/gh/spodkowinski/cassandra/tree/CASSANDRA-14423-3.0.svg?style=svg&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/581&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/581/badge/icon&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/spodkowinski/cassandra/tree/CASSANDRA-14423-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;cassandra-3.11_14423&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/spodkowinski/cassandra/tree/CASSANDRA-14423-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://circleci.com/gh/spodkowinski/cassandra/tree/CASSANDRA-14423-3.11.svg?style=svg&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/580&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/580/badge/icon&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="16527308" author="michaelsembwever" created="Fri, 29 Jun 2018 08:16:48 +0000"  >&lt;p&gt;committed as&#160; f8912ce9329a8bc360e93cf61e56814135fbab39&lt;/p&gt;</comment>
                            <comment id="16536936" author="mshuler" created="Mon, 9 Jul 2018 13:49:22 +0000"  >&lt;p&gt;Build fails on JDK7.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;((2.2.13-tentative))mshuler@hana:~/git/cassandra$ java -version
java version &quot;1.7.0_80&quot;
Java(TM) SE Runtime Environment (build 1.7.0_80-b15)
Java HotSpot(TM) 64-Bit Server VM (build 24.80-b11, mixed mode)
((2.2.13-tentative))mshuler@hana:~/git/cassandra$ ant
Buildfile: /home/mshuler/git/cassandra/build.xml

init:
    [mkdir] Created dir: /home/mshuler/git/cassandra/build/classes/main
    [mkdir] Created dir: /home/mshuler/git/cassandra/build/classes/thrift
    [mkdir] Created dir: /home/mshuler/git/cassandra/build/test/lib
    [mkdir] Created dir: /home/mshuler/git/cassandra/build/test/classes
    [mkdir] Created dir: /home/mshuler/git/cassandra/src/gen-java
    [mkdir] Created dir: /home/mshuler/git/cassandra/build/lib
    [mkdir] Created dir: /home/mshuler/git/cassandra/build/jacoco
    [mkdir] Created dir: /home/mshuler/git/cassandra/build/jacoco/partials

maven-ant-tasks-localrepo:
     [copy] Copying 1 file to /home/mshuler/git/cassandra/build

maven-ant-tasks-download:

maven-ant-tasks-init:

maven-declare-dependencies:

maven-ant-tasks-retrieve-build:
[artifact:dependencies] Building ant file: /home/mshuler/git/cassandra/build/build-dependencies.xml
[artifact:dependencies] Building ant file: /home/mshuler/git/cassandra/build/build-dependencies-sources.xml
     [copy] Copying 65 files to /home/mshuler/git/cassandra/build/lib/jars
     [copy] Copying 41 files to /home/mshuler/git/cassandra/build/lib/sources
     [copy] Copying 25 files to /home/mshuler/git/cassandra/build/lib/jars
    [unzip] Expanding: /home/mshuler/git/cassandra/build/lib/jars/org.jacoco.agent-0.7.5.201505241946.jar into /home/mshuler/git/cassandra/build/lib/jars

check-gen-cql3-grammar:

gen-cql3-grammar:
     [echo] Building Grammar /home/mshuler/git/cassandra/src/java/org/apache/cassandra/cql3/Cql.g  ...

generate-cql-html:

build-project:
     [echo] apache-cassandra: /home/mshuler/git/cassandra/build.xml
    [javac] Compiling 45 source files to /home/mshuler/git/cassandra/build/classes/thrift
    [javac] warning: Supported source version &apos;RELEASE_6&apos; from annotation processor &apos;org.openjdk.jmh.generators.BenchmarkProcessor&apos; less than -source &apos;1.7&apos;
    [javac] Note: /home/mshuler/git/cassandra/interface/thrift/gen-java/org/apache/cassandra/thrift/Cassandra.java uses or overrides a deprecated API.
    [javac] Note: Recompile with -Xlint:deprecation for details.
    [javac] Note: Some input files use unchecked or unsafe operations.
    [javac] Note: Recompile with -Xlint:unchecked for details.
    [javac] 1 warning
    [javac] Compiling 1168 source files to /home/mshuler/git/cassandra/build/classes/main
    [javac] Note: Processing compiler hints annotations
    [javac] warning: Supported source version &apos;RELEASE_6&apos; from annotation processor &apos;org.openjdk.jmh.generators.BenchmarkProcessor&apos; less than -source &apos;1.7&apos;
    [javac] Note: Processing compiler hints annotations
    [javac] Note: Writing compiler command file at META-INF/hotspot_compiler
    [javac] Note: Done processing compiler hints annotations
    [javac] /home/mshuler/git/cassandra/src/java/org/apache/cassandra/db/compaction/CompactionManager.java:584: error: cannot find symbol
    [javac]                     logger.info(&quot;SSTable {} ({}) will be anticompacted on ranges: {}&quot;, sstable, sstableBounds, String.join(&quot;, &quot;, anticompactRanges));
    [javac]                                                                                                                      ^
    [javac]   symbol:   method join(String,List&amp;lt;String&amp;gt;)
    [javac]   location: class String
    [javac] Note: Some input files use or override a deprecated API.
    [javac] Note: Recompile with -Xlint:deprecation for details.
    [javac] Note: Some input files use unchecked or unsafe operations.
    [javac] Note: Recompile with -Xlint:unchecked for details.
    [javac] 1 error
    [javac] 1 warning

BUILD FAILED
/home/mshuler/git/cassandra/build.xml:827: Compile failed; see the compiler error output for details.

Total time: 32 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16537820" author="michaelsembwever" created="Tue, 10 Jul 2018 00:13:50 +0000"  >&lt;p&gt;This will break running Cassandra-2.2 on jdk1.7&lt;/p&gt;</comment>
                            <comment id="16537833" author="michaelsembwever" created="Tue, 10 Jul 2018 00:31:12 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;uTest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/thelastpickle/cassandra/tree/mck/cassandra-2.2_14423.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;cassandra-2.2_14423.1&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/thelastpickle/cassandra/tree/mck%2Fcassandra-2.2_14423.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://circleci.com/gh/thelastpickle/cassandra/tree/mck%2Fcassandra-2.2_14423.1.svg?style=svg&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mshuler&quot; class=&quot;user-hover&quot; rel=&quot;mshuler&quot;&gt;mshuler&lt;/a&gt;, can you quick review this?&lt;/p&gt;

&lt;p&gt;(also created &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-14563&quot; title=&quot;Add animalsniffer to build to ensure runtime jdk compatbility&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-14563&quot;&gt;&lt;del&gt;CASSANDRA-14563&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="16538761" author="mshuler" created="Tue, 10 Jul 2018 15:17:12 +0000"  >&lt;p&gt;Thanks! That commit looks good to me.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;tt&gt;ant artifacts&lt;/tt&gt; builds again successfully on JDK7&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;ant test -Dtest.name=AntiCompactionTest&lt;/tt&gt; passes successfully on JDK7&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16539403" author="michaelsembwever" created="Wed, 11 Jul 2018 00:26:11 +0000"  >&lt;p&gt;Committed as 3482370df5672c9337a16a8a52baba53b70a4fe8&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13169026">CASSANDRA-14550</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[KurtG]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 18 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3t3a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12339157">3.11.0</customfieldvalue>
    <customfieldvalue id="12341709">3.11.2</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>spod</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>