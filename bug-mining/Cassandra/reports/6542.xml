<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:30:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-17667] Text value containing &quot;/*&quot; interpreted as multiline comment in cqlsh</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-17667</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I use CQLSH command line utility to load some DDLs. The version of utility I use is this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[cqlsh 6.0.0 | Cassandra 4.0.0.47 | CQL spec 3.4.5 | Native protocol v5]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Command that loads DDL.cql:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh -u username -p password cassandra.example.com 65503 --ssl -f DDL.cql
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I have a line in CQL script that breaks the syntax.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;INSERT into tablename (key,columnname1,columnname2) VALUES (&apos;keyName&apos;,&apos;value1&apos;,&apos;/value2/*/value3&apos;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;tt&gt;/*&lt;/tt&gt; here is interpreted as start of multi-line comment. It used to work on older versions of cqlsh. The error I see looks like this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SyntaxException: line 4:2 mismatched input &apos;Update&apos; expecting &apos;)&apos; (...,&apos;value1&apos;,&apos;/value2INSERT into tablename(INSERT into tablename (key,columnname1,columnname2)) VALUES (&apos;[Update]-...) SyntaxException: line 1:0 no viable alternative at input &apos;(&apos; ([(]...)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Same behavior while running in interactive mode too. &lt;tt&gt;/*&lt;/tt&gt; inside a CQL statement should not be interpreted as start of multi-line comment.&lt;/p&gt;

&lt;p&gt;With schema:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
CREATE TABLE tablename ( key text primary key, columnname1 text, columnname2 text);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13447158">CASSANDRA-17667</key>
            <summary>Text value containing &quot;/*&quot; interpreted as multiline comment in cqlsh</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bschoeni">Brad Schoening</assignee>
                                    <reporter username="nixtalker">ANOOP THOMAS</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 May 2022 07:22:57 +0000</created>
                <updated>Mon, 30 Sep 2024 12:24:28 +0000</updated>
                            <resolved>Tue, 24 Sep 2024 13:17:17 +0000</resolved>
                                        <fixVersion>4.0.15</fixVersion>
                    <fixVersion>4.1.8</fixVersion>
                    <fixVersion>5.0.2</fixVersion>
                    <fixVersion>5.1</fixVersion>
                                    <component>CQL/Interpreter</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="17542824" author="JIRAUSER285101" created="Fri, 27 May 2022 08:08:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nixtalker&quot; class=&quot;user-hover&quot; rel=&quot;nixtalker&quot;&gt;nixtalker&lt;/a&gt; thanks for logging the ticket. I did see &#160;&lt;a href=&quot;https://stackoverflow.com/questions/72391377/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;your question on Stack Overflow&lt;/a&gt; but I just haven&apos;t gotten around to testing it for myself yet.&lt;/p&gt;

&lt;p&gt;Can you please confirm your Cassandra version? The reason I&apos;m asking is&#160;I&apos;m not familiar with version &lt;tt&gt;4.0.0.47&lt;/tt&gt; &amp;#8211; note the &lt;b&gt;&lt;font color=&quot;#DE350B&quot;&gt;.47&lt;/font&gt;&lt;/b&gt; at the end. Is it a fork?&lt;/p&gt;</comment>
                            <comment id="17542862" author="JIRAUSER285101" created="Fri, 27 May 2022 10:05:27 +0000"  >&lt;p&gt;This looks like a regression. I can confirm that it works in C* 3.11.13 but not any version of C* 4.0.&lt;/p&gt;</comment>
                            <comment id="17542875" author="brandon.williams" created="Fri, 27 May 2022 10:45:12 +0000"  >&lt;p&gt;There&apos;s a lot of difference between 3.x and 4.x since we switched to python3, among other things.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bschoeni&quot; class=&quot;user-hover&quot; rel=&quot;bschoeni&quot;&gt;bschoeni&lt;/a&gt; any interest in this one?&lt;/p&gt;</comment>
                            <comment id="17542960" author="bschoeni" created="Fri, 27 May 2022 15:05:12 +0000"  >&lt;p&gt;I can take a look.&#160; I seem to recall something in the parser (maybe a test case) for this issue.&lt;/p&gt;</comment>
                            <comment id="17542968" author="bschoeni" created="Fri, 27 May 2022 15:15:22 +0000"  >&lt;p&gt;There is a unit test for this in test_cql_parsing.py.&#160;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&#160; def test_comments_in_string_literals(self):
&#160; &#160; &#160; &#160; comment_strings = [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;sausage -- comment&apos;&lt;/span&gt;&quot;&lt;/span&gt;,
&#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;eggs and spam &lt;span class=&quot;code-comment&quot;&gt;// comment string&apos;&lt;/span&gt;&quot;&lt;/span&gt;,
&lt;/span&gt;&#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;spam eggs sausage and spam /* still in string&apos;&lt;/span&gt;&quot;&lt;/span&gt;]
&#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; s in comment_strings:
&#160; &#160; &#160; &#160; &#160; &#160; self.assertSequenceEqual(tokens_with_types(CqlRuleSet.lex(s)),
&#160;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [(s, &lt;span class=&quot;code-quote&quot;&gt;&apos;quotedStringLiteral&apos;&lt;/span&gt;)])
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17543085" author="brandon.williams" created="Fri, 27 May 2022 19:07:09 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cqlsh:test&amp;gt; insert into foo (key, value) VALUES ( &lt;span class=&quot;code-quote&quot;&gt;&apos;test&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;foo -- bar&apos;&lt;/span&gt;);
cqlsh:test&amp;gt; insert into foo (key, value) VALUES ( &lt;span class=&quot;code-quote&quot;&gt;&apos;test&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;foo &lt;span class=&quot;code-comment&quot;&gt;// bar&apos;&lt;/span&gt;);
&lt;/span&gt;cqlsh:test&amp;gt; insert into foo (key, value) VALUES ( &lt;span class=&quot;code-quote&quot;&gt;&apos;test&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;foo /* bar&apos;&lt;/span&gt;);
        ... 
        ... 
        ... 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The last format is never accepted, as if there is no semicolon;&lt;/p&gt;</comment>
                            <comment id="17544787" author="bereng" created="Wed, 1 Jun 2022 09:46:56 +0000"  >&lt;p&gt;Apologies &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ahomoki&quot; class=&quot;user-hover&quot; rel=&quot;ahomoki&quot;&gt;ahomoki&lt;/a&gt; I hadn&apos;t noticed you had picked up this one as I hadn&apos;t refreshed the page. I started looking and the problem is in &lt;tt&gt;cqlsh.py#strip_comment_blocks&lt;/tt&gt;. I haven&apos;t traced the diffs across versions to see what changed though. Let me know if you don&apos;t have the time and I&apos;ll take over. I just wanted to spare some duplicate work by sharing my findings &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17544812" author="JIRAUSER289805" created="Wed, 1 Jun 2022 11:03:17 +0000"  >&lt;p&gt;No worries &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;bereng&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Yes, the culprit is the &lt;tt&gt;strip_comment_blocks&lt;/tt&gt; function which been committed to &lt;tt&gt;cqlsh.py&lt;/tt&gt; in 2020 : &lt;a href=&quot;https://github.com/apache/cassandra/commit/1b1b87cfe3a9a93c393d1f3c1e003394260edeb5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/1b1b87cfe3a9a93c393d1f3c1e003394260edeb5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and the function hasn&apos;t been changed since it was introduced.&lt;/p&gt;

&lt;p&gt;This is the original JIRA: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-15802&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CASSANDRA-15802&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is the code part which causing the problem:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;/*&apos;&lt;/span&gt; in result:
    result = re.sub(&lt;span class=&quot;code-quote&quot;&gt;&apos;[/][*].*&apos;&lt;/span&gt;, &quot;&quot;, result)
    in_comment = True
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;*/&apos;&lt;/span&gt; in result:
    result = re.sub(&lt;span class=&quot;code-quote&quot;&gt;&apos;.*[*][/]&apos;&lt;/span&gt;, &quot;&quot;, result)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As a fix, I&apos;m thinking about modifying the above part to prevent the replacements of the &quot;/&lt;b&gt;&quot; or &quot;&lt;/b&gt;/&quot; if these are found in single quote enclosed string literals.&lt;/p&gt;

&lt;p&gt;Any thoughts?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17544851" author="bereng" created="Wed, 1 Jun 2022 11:49:18 +0000"  >&lt;p&gt;I would first try to see why it doesn&apos;t fail on pre 4.0. As relying on regexp to detect comments on non-parsed CQL sounds like trouble. I don&apos;t understand why it worked pre 4.0 tbh.&lt;/p&gt;</comment>
                            <comment id="17545278" author="bereng" created="Thu, 2 Jun 2022 05:35:52 +0000"  >&lt;p&gt;Just moved to in progress to reflect you&apos;re working on it #collaborating&lt;/p&gt;</comment>
                            <comment id="17547104" author="bschoeni" created="Fri, 3 Jun 2022 21:12:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ahomoki&quot; class=&quot;user-hover&quot; rel=&quot;ahomoki&quot;&gt;ahomoki&lt;/a&gt; the function strip_comment_blocks seems a bolt on in cqlsh.py.&#160; Would this behavior be better implemented in the lexer in pylexotron.py?&lt;/p&gt;</comment>
                            <comment id="17555053" author="JIRAUSER289805" created="Thu, 16 Jun 2022 12:19:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bschoeni&quot; class=&quot;user-hover&quot; rel=&quot;bschoeni&quot;&gt;bschoeni&lt;/a&gt; Yes, it makes sense to move this functionality into pylexotron.py.&lt;/p&gt;

&lt;p&gt;I&apos;m away for 2 weeks and will work on this when I back&lt;/p&gt;</comment>
                            <comment id="17571175" author="bschoeni" created="Tue, 26 Jul 2022 02:38:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ahomoki&quot; class=&quot;user-hover&quot; rel=&quot;ahomoki&quot;&gt;ahomoki&lt;/a&gt;,&#160; looking at this a little further, safescanner.py, which inherits from the python re.Scanner, is tokenizing the input.&#160; &#160;An example from &lt;a href=&quot;https://mail.python.org/pipermail/python-dev/2003-April/035075.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://mail.python.org/pipermail/python-dev/2003-April/035075.html&lt;/a&gt; shows how input is parsed:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; re

def s_ident(scanner, token): &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; token
def s_operator(scanner, token): &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;op%s&quot;&lt;/span&gt; % token
def s_float(scanner, token): &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;(token)
def s_int(scanner, token): &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;(token)

scanner = re.Scanner([
    (r&lt;span class=&quot;code-quote&quot;&gt;&quot;[a-zA-Z_]\w*&quot;&lt;/span&gt;, s_ident),
    (r&lt;span class=&quot;code-quote&quot;&gt;&quot;\d+\.\d*&quot;&lt;/span&gt;, s_float),
    (r&lt;span class=&quot;code-quote&quot;&gt;&quot;\d+&quot;&lt;/span&gt;, s_int),
    (r&lt;span class=&quot;code-quote&quot;&gt;&quot;=|\+|-|\*|/&quot;&lt;/span&gt;, s_operator),
    (r&lt;span class=&quot;code-quote&quot;&gt;&quot;\s+&quot;&lt;/span&gt;, None),
    ])

# sanity check
test(&lt;span class=&quot;code-quote&quot;&gt;&apos;scanner.scan(&lt;span class=&quot;code-quote&quot;&gt;&quot;sum = 3*foo + 312.50 + bar&quot;&lt;/span&gt;)&apos;&lt;/span&gt;,
     ([&lt;span class=&quot;code-quote&quot;&gt;&apos;sum&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;op=&apos;&lt;/span&gt;, 3, &lt;span class=&quot;code-quote&quot;&gt;&apos;op*&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;op+&apos;&lt;/span&gt;, 312.5, &lt;span class=&quot;code-quote&quot;&gt;&apos;op+&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bar&apos;&lt;/span&gt;], &apos;&apos;))
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In&#160; pylexotron this is implemented as:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
RuleSpecScanner = SaferScanner([
        (r&lt;span class=&quot;code-quote&quot;&gt;&apos;::=&apos;&lt;/span&gt;, lambda s, t: t),
        (r&lt;span class=&quot;code-quote&quot;&gt;&apos;\[[a-z0-9_]+\]=&apos;&lt;/span&gt;, lambda s, t: (&lt;span class=&quot;code-quote&quot;&gt;&apos;named_collector&apos;&lt;/span&gt;, t[1:-2])),
        (r&lt;span class=&quot;code-quote&quot;&gt;&apos;[a-z0-9_]+=&apos;&lt;/span&gt;, lambda s, t: (&lt;span class=&quot;code-quote&quot;&gt;&apos;named_symbol&apos;&lt;/span&gt;, t[:-1])),
        (r&lt;span class=&quot;code-quote&quot;&gt;&apos;/(\[\^?.[^]]*\]|[^/]|\\.)*/&apos;&lt;/span&gt;, lambda s, t: (&lt;span class=&quot;code-quote&quot;&gt;&apos;regex&apos;&lt;/span&gt;, t[1:-1].replace(r&lt;span class=&quot;code-quote&quot;&gt;&apos;\/&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;/&apos;&lt;/span&gt;))),
        (r&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-quote&quot;&gt;&quot;([^&quot;&lt;/span&gt;]|\\.)*&quot;&apos;&lt;/span&gt;, lambda s, t: (&lt;span class=&quot;code-quote&quot;&gt;&apos;litstring&apos;&lt;/span&gt;, t)),
        (r&lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;lt;[^&amp;gt;]*&amp;gt;&apos;&lt;/span&gt;, lambda s, t: (&lt;span class=&quot;code-quote&quot;&gt;&apos;reference&apos;&lt;/span&gt;, t[1:-1])),
        (r&lt;span class=&quot;code-quote&quot;&gt;&apos;\bJUNK\b&apos;&lt;/span&gt;, lambda s, t: (&lt;span class=&quot;code-quote&quot;&gt;&apos;junk&apos;&lt;/span&gt;, t)),
        (r&lt;span class=&quot;code-quote&quot;&gt;&apos;[@()|?*;]&apos;&lt;/span&gt;, lambda s, t: t),
        (r&lt;span class=&quot;code-quote&quot;&gt;&apos;\s+&apos;&lt;/span&gt;, None),
        (r&lt;span class=&quot;code-quote&quot;&gt;&apos;#[^\n]*&apos;&lt;/span&gt;, None),
    ], re.I | re.S | re.U) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;r&apos;\s+&apos; is skipping whitespace&lt;/p&gt;

&lt;p&gt;I&apos;m uncertain what r&apos;#&lt;span class=&quot;error&quot;&gt;&amp;#91;^\n&amp;#93;&lt;/span&gt;*&apos; and r&apos;\bJUNK\b&apos; are doing. Adding comments could be helpful.&#160;&lt;/p&gt;

&lt;p&gt;The Scanner flags used are re.I | re.S | re.U for IgnoreCase, DotAll and Unicode, but it doesn&apos;t use re.M for Multiline.&#160; So, either that could be added if it doesn&apos;t break anything, or the tokenizer would have to tokenize a start comment and end comment token.&lt;/p&gt;

&lt;p&gt;There doesn&apos;t seem to be unit tests for pylexotron or SafeScanner, however.&#160; That might be a good thing to add.&#160; There could be tests for each type of token, named_collector, named_symbol, regex, litstring, reference and junk.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://www.programcreek.com/python/example/53972/re.Scanner&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.programcreek.com/python/example/53972/re.Scanner&lt;/a&gt; for an example of skipping multi-line comments using re.MULTILINE.&lt;/p&gt;

&lt;p&gt;The BNF for Java here &lt;span class=&quot;error&quot;&gt;&amp;#91;JavaCC | The most popular parser generator for use with Java applications.|https://javacc.github.io/javacc/documentation/bnf.html#comments&amp;#93;&lt;/span&gt; show how it skips multi-line comments.&lt;/p&gt;</comment>
                            <comment id="17574277" author="JIRAUSER289805" created="Tue, 2 Aug 2022 15:16:44 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bschoeni&quot; class=&quot;user-hover&quot; rel=&quot;bschoeni&quot;&gt;bschoeni&lt;/a&gt; , thanks for the examples, they are really good help. I&apos;m still familiarizing myself with the functions in cqlsh and its libraries to understand when they get called.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17711451" author="smiklosovic" created="Wed, 12 Apr 2023 15:37:22 +0000"  >&lt;p&gt;Kindly pinging to ask if there is some progress.&lt;/p&gt;</comment>
                            <comment id="17712480" author="JIRAUSER289805" created="Fri, 14 Apr 2023 17:38:28 +0000"  >&lt;p&gt;Hey Stefan,&lt;/p&gt;

&lt;p&gt;Currently I&apos;m not able to work on this project.&lt;/p&gt;

&lt;p&gt;I have some progress on this issue and updated &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bschoeni&quot; class=&quot;user-hover&quot; rel=&quot;bschoeni&quot;&gt;bschoeni&lt;/a&gt; with the details today.&lt;/p&gt;</comment>
                            <comment id="17716381" author="bschoeni" created="Tue, 25 Apr 2023 18:14:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; I can&apos;t figure out why the unit test test_comments_in_string_literals with &apos;spam /* still&apos; passes, but your example with CQLSH with &apos;foo /* bar&apos; fails.&#160; Any thoughts on how to craft a failing unit test?&lt;/p&gt;</comment>
                            <comment id="17716401" author="brandon.williams" created="Tue, 25 Apr 2023 19:13:23 +0000"  >&lt;p&gt;I think test_comments_in_string_literals is passing because the strings are in single quotes.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;gt;&amp;gt;&amp;gt; &quot;&apos;spam eggs sausage and spam /* still in string&apos;&quot; != &apos;spam eggs sausage and spam /* still in string&apos;
True
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17717869" author="bschoeni" created="Sat, 29 Apr 2023 03:16:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; Maybe the test itself is wrong, but its looking for a quotedStringLiteral as the result&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
self.assertSequenceEqual(tokens_with_types(CqlRuleSet.lex(s)), [(s, &lt;span class=&quot;code-quote&quot;&gt;&apos;quotedStringLiteral&apos;&lt;/span&gt;)])&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which works with nested quotes:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;gt;&amp;gt;&amp;gt; CqlRuleSet.lex(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;foo /* bar&apos;&lt;/span&gt;&quot;&lt;/span&gt;)
[(&lt;span class=&quot;code-quote&quot;&gt;&apos;quotedStringLiteral&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;foo /* bar&apos;&lt;/span&gt;&quot;&lt;/span&gt;, (0, 12))]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but fails without them:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;gt;&amp;gt;&amp;gt; CqlRuleSet.lex(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo /* bar&quot;&lt;/span&gt;)
[(&lt;span class=&quot;code-quote&quot;&gt;&apos;identifier&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;foo&apos;&lt;/span&gt;, (0, 3)), (&lt;span class=&quot;code-quote&quot;&gt;&apos;op&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;/&apos;&lt;/span&gt;, (4, 5)), (&lt;span class=&quot;code-quote&quot;&gt;&apos;star&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;*&apos;&lt;/span&gt;, (5, 6)), (&lt;span class=&quot;code-quote&quot;&gt;&apos;identifier&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;bar&apos;&lt;/span&gt;, (7, 10))]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17752645" author="smiklosovic" created="Thu, 10 Aug 2023 06:56:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vgali7&quot; class=&quot;user-hover&quot; rel=&quot;vgali7&quot;&gt;vgali7&lt;/a&gt; I see you added a PR. Is this ready for a review?&lt;/p&gt;

&lt;p&gt;Could you please prepare patches for all branches? (4.0, 4.1, 5.0 and trunk).&lt;/p&gt;</comment>
                            <comment id="17796793" author="brandon.williams" created="Thu, 14 Dec 2023 15:10:43 +0000"  >&lt;p&gt;I took a look and that PR is not a solution.&lt;/p&gt;</comment>
                            <comment id="17798656" author="JIRAUSER289805" created="Tue, 19 Dec 2023 16:44:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks for taking a look. Mind sharing what aspect didn&apos;t work for you ?&lt;/p&gt;

&lt;p&gt;I tested that PR and it works for me, as I can execute something like this without any issue:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 insert into cycling.cyclist_name (id, firstname, lastname) VALUES (uuid(), &lt;span class=&quot;code-quote&quot;&gt;&apos;myfirstname&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;foo /* an unclosed comment&apos;&lt;/span&gt; ); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the above gets inserted :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cqlsh&amp;gt; select * from cycling.cyclist_name;

id &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;    &#160; | firstname &#160; &#160; &#160; &#160; &#160; &#160; &#160; | lastname
--------------------------------------+-------------------------+----------------------------------------------
cc983531-84a8-4f95-9462-a9cd5e440bc2  | &#160; &#160; &#160; &#160; &#160; &#160; myfirstname | &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; foo /* an unclosed comment &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it works with closed comments and with linebreaks as well.&lt;/p&gt;

&lt;p&gt;it also works when I feed the file to cqlsh like this:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cqlsh -f updates_w_comments.cql &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;thanks&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17801847" author="brandon.williams" created="Tue, 2 Jan 2024 16:32:39 +0000"  >&lt;p&gt;Hmm, I read the comment that said it removed the ability to have comments inside statements and it seemed true, but I see now that it is not.  I started a CI run against trunk &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1423/workflows/b4e8d8e8-bb09-4475-be60-dd649761444c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;, if that checks out then we can prepare the other branches.&lt;/p&gt;</comment>
                            <comment id="17801862" author="brandon.williams" created="Tue, 2 Jan 2024 17:01:11 +0000"  >&lt;p&gt;This patch also fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-19202&quot; title=&quot;A multi-line comment containing semi colon as the end of line throws error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-19202&quot;&gt;&lt;del&gt;CASSANDRA-19202&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17801865" author="brandon.williams" created="Tue, 2 Jan 2024 17:10:04 +0000"  >&lt;p&gt;This passed all the cqlsh tests.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ahomoki&quot; class=&quot;user-hover&quot; rel=&quot;ahomoki&quot;&gt;ahomoki&lt;/a&gt; would you like to prepare the other branches?  I think this one will cover 5.0 and trunk, and another will cover 4.0 and 4.1.&lt;/p&gt;</comment>
                            <comment id="17804194" author="bereng" created="Mon, 8 Jan 2024 09:18:05 +0000"  >&lt;p&gt;If tests pass then that settles it. I am still uneasy as to why the removal of that code has no effect on comments. I noticed a new test with &apos;/&amp;#42;&apos; was added for a &lt;em&gt;field value&lt;/em&gt;. Should we add one with &apos;&amp;#42;/&apos;, one with &apos;/&amp;#42;blabla&amp;#42;/&apos;, pg-style quoted equivalents and a multiline for &lt;em&gt;field values&lt;/em&gt;?&lt;/p&gt;</comment>
                            <comment id="17804261" author="JIRAUSER289805" created="Mon, 8 Jan 2024 12:54:51 +0000"  >&lt;p&gt;&lt;em&gt;&quot; why the removal of that code has no effect on comments :&lt;/em&gt;&#160; the code was just a workaround to fix the original issue which was thet the order of the terminal productions (aka field values) was incorrect.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&quot;Should we add ...&quot; :&lt;/em&gt; &#160;also tested (manually) with the following field values and these will work multiline comments.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;closedComment&amp;gt; ::= /&lt;span class=&quot;error&quot;&gt;&amp;#91;/&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;*&amp;#93;&lt;/span&gt;.*&lt;span class=&quot;error&quot;&gt;&amp;#91;*&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;/&amp;#93;&lt;/span&gt;/ ;&lt;br/&gt;
&amp;lt;unclosedComment&amp;gt; ::= /&lt;span class=&quot;error&quot;&gt;&amp;#91;/&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;*&amp;#93;&lt;/span&gt;.*$/ ;&lt;br/&gt;
&amp;lt;closedTComment&amp;gt; ::= /&lt;span class=&quot;error&quot;&gt;&amp;#91;/&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;.*&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;/&amp;#93;&lt;/span&gt;/ ;&lt;br/&gt;
&amp;lt;unclosedTComment&amp;gt; ::= /&lt;span class=&quot;error&quot;&gt;&amp;#91;/&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;.*$/ ;&lt;br/&gt;
&amp;lt;unclosedPgString&amp;gt;::= /\$\$(?&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;?!\$\$).)*/ ;&lt;br/&gt;
&amp;lt;unclosedString&amp;gt; &#160;::= /&apos;(&lt;span class=&quot;error&quot;&gt;&amp;#91;^&amp;#39;&amp;#93;&lt;/span&gt;|&apos;&apos;)*/ ;&lt;br/&gt;
&amp;lt;unclosedName&amp;gt; &#160; &#160;::= /&quot;(&lt;span class=&quot;error&quot;&gt;&amp;#91;^&amp;quot;&amp;#93;&lt;/span&gt;|&quot;&quot;)*/ ;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;my commit: &lt;a href=&quot;https://github.com/apache/cassandra/commit/84a7fc2629062412303243b09004d03e2a2ade90&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/84a7fc2629062412303243b09004d03e2a2ade90&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17804266" author="bereng" created="Mon, 8 Jan 2024 13:09:15 +0000"  >&lt;p&gt;That commit 84a7fc2629062412303243b09004d03e2a2ade90 is not in the &lt;a href=&quot;https://github.com/apache/cassandra/pull/2561&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR linked in this ticket&lt;/a&gt;. So can you please confirm which is the code I should be reviewing?&lt;/p&gt;

&lt;p&gt;Also even if you tested manually why not add those cases to the test? Am I missing shtg?&lt;/p&gt;</comment>
                            <comment id="17804333" author="JIRAUSER289805" created="Mon, 8 Jan 2024 14:46:19 +0000"  >&lt;p&gt;Please ignore my last commit (84a7fc2629062412303243b09004d03e2a2ade90), the &lt;a href=&quot;https://github.com/apache/cassandra/pull/2561&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR linked in this ticket&lt;/a&gt; is good to go.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17804457" author="brandon.williams" created="Mon, 8 Jan 2024 20:35:34 +0000"  >&lt;p&gt;Reminder that we are going to need PRs for all the branches where we intend to fix this.&lt;/p&gt;</comment>
                            <comment id="17804539" author="bschoeni" created="Tue, 9 Jan 2024 01:14:15 +0000"  >&lt;p&gt;I spoke with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ahomoki&quot; class=&quot;user-hover&quot; rel=&quot;ahomoki&quot;&gt;ahomoki&lt;/a&gt; and he isn&apos;t able to work on this anymore, and Vineet who had picked it up in August was an intern who has since moved on.&#160; I&apos;ll pick this up to update the branch PRs and see if adding new unit tests is straightforward.&lt;/p&gt;</comment>
                            <comment id="17804540" author="brandon.williams" created="Tue, 9 Jan 2024 01:16:19 +0000"  >&lt;p&gt;Thanks Brad!&lt;/p&gt;</comment>
                            <comment id="17804982" author="bereng" created="Wed, 10 Jan 2024 06:43:20 +0000"  >&lt;p&gt;Thanks Brad, I haven&apos;t tried directly but adding the junits should be almost copy-paste iiuc&lt;/p&gt;</comment>
                            <comment id="17839796" author="brandon.williams" created="Mon, 22 Apr 2024 17:21:08 +0000"  >&lt;p&gt;Kind ping in case this has been forgotten.&lt;/p&gt;</comment>
                            <comment id="17840085" author="bschoeni" created="Tue, 23 Apr 2024 12:15:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&#160; thanks, it&apos;s not forgotten about it, it&apos;s next up after I close out &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-19450&quot; title=&quot;Hygiene updates for warnings and pytests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-19450&quot;&gt;&lt;del&gt;CASSANDRA-19450&lt;/del&gt;&lt;/a&gt; and 19498.&lt;/p&gt;</comment>
                            <comment id="17846493" author="bschoeni" created="Wed, 15 May 2024 04:48:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;bereng&lt;/a&gt; I have updated the PR with a test string for */. There already exists&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&apos;SELECT FROM &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-comment&quot;&gt;/*MyTable*/&lt;/span&gt;&quot;&lt;/span&gt;;&apos;&lt;/span&gt;

&apos;SELECT FROM /*
comment block starts here;
and continues here
*/ &quot;MyTable&apos;;

&apos; &lt;span class=&quot;code-comment&quot;&gt;/* comment block */&lt;/span&gt;
&lt;span class=&quot;code-comment&quot;&gt;/* another comment */&lt;/span&gt; SELECT FROM /*
 comment block starts here;
and continues here
*/ &quot;MyTable&apos;;
                                        &lt;span class=&quot;code-quote&quot;&gt;&apos;                             &apos;&lt;/span&gt;
&lt;span class=&quot;code-quote&quot;&gt;&apos;SELECT FROM &lt;span class=&quot;code-comment&quot;&gt;/* \n comment block starts here; \n and continues here \n */&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;MyTable&quot;&lt;/span&gt;;&apos;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I looked up pg-style quoted equivalents means, and see that was added in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7769&quot; title=&quot;Implement pg-style dollar syntax for string constants&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7769&quot;&gt;&lt;del&gt;CASSANDRA-7769&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17849360" author="bschoeni" created="Fri, 24 May 2024 18:18:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;bereng&lt;/a&gt; let me know if the tests as updated look good.&lt;/p&gt;</comment>
                            <comment id="17849368" author="brandon.williams" created="Fri, 24 May 2024 18:40:09 +0000"  >&lt;p&gt;That looks good to me &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bschoeni&quot; class=&quot;user-hover&quot; rel=&quot;bschoeni&quot;&gt;bschoeni&lt;/a&gt; if you want to prepare the branches.&lt;/p&gt;</comment>
                            <comment id="17849620" author="bereng" created="Mon, 27 May 2024 05:26:00 +0000"  >&lt;p&gt;sgtm&lt;/p&gt;</comment>
                            <comment id="17850127" author="bschoeni" created="Tue, 28 May 2024 18:07:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bereng&quot; class=&quot;user-hover&quot; rel=&quot;bereng&quot;&gt;bereng&lt;/a&gt; CQLSH 4.1.x and 5.x all use the pytest framework and test_cql_parsing.py runs successfully. But 4.0.x uses nosetests which I was never able to run.&lt;/p&gt;

&lt;p&gt;IDK if 4.0.x is worth the effort, but the 4.1 PR should cherry-pick easily if someone can run the nose tests including the updated unit tests added here for unclosed productions.&#160; Or consider it safest to just fix it where pytest is running.&lt;/p&gt;

&lt;p&gt;PR&apos;s for 4.1.x, 5.0.x, 5.1.x are linked here.&lt;/p&gt;</comment>
                            <comment id="17850139" author="brandon.williams" created="Tue, 28 May 2024 18:46:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;4.0.x uses nosetests&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Can you show me where?&lt;/p&gt;</comment>
                            <comment id="17850140" author="bschoeni" created="Tue, 28 May 2024 18:49:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-4.0/pylib/cassandra-cqlsh-tests.sh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-4.0/pylib/cassandra-cqlsh-tests.sh&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;which was changed with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17293&quot; title=&quot;Update python test framework from nose to pytest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17293&quot;&gt;&lt;del&gt;CASSANDRA-17293&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17850143" author="brandon.williams" created="Tue, 28 May 2024 18:54:12 +0000"  >&lt;p&gt;I converted it to pytest in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-18088&quot; title=&quot;cqlsh - module &amp;#39;re&amp;#39; has no attribute &amp;#39;sre_parse&amp;#39; - with Python 3.11&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-18088&quot;&gt;&lt;del&gt;CASSANDRA-18088&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://github.com/driftx/cassandra/commit/62c94ccf4cb2432fde954bf4c12db1325b3a62a1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="17850181" author="bschoeni" created="Tue, 28 May 2024 21:22:49 +0000"  >&lt;p&gt;I&apos;d assume it was running nosetest because it generates the nosetest.xml artifact.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
------------------------------------------------- generated xml file: /&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;/&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt;/tmp/cassandra/pylib/cqlshlib/nosetests.xml -------------------------------------------------
======================================================================== 23 passed, 1 warning in 0.80s ========================================================================
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The tests ran, so I&apos;ve added the 4.0 PR as well.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17882428" author="bschoeni" created="Tue, 17 Sep 2024 14:33:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;&#160; would you be able to review the PRs.&lt;/p&gt;</comment>
                            <comment id="17883377" author="brandon.williams" created="Fri, 20 Sep 2024 18:56:24 +0000"  >&lt;p&gt;Sure!  Looks good to me, let&apos;s see what CI thinks:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-17667-4.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1734/workflows/3ea7cbe9-0617-490f-96c2-9042022b6f87&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1734/workflows/115e1c83-701a-4f76-a85a-bd3c3fcc2399&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-17667-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1731/workflows/d3dee232-159c-405c-8529-fb071e4a5a5a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1731/workflows/321c36ae-0a3e-4e45-ab76-e6c80a20c958&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-17667-5.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;5.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1732/workflows/148c1c87-1b12-49c8-ba49-3392b854b552&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1732/workflows/690a9f08-f122-4dd8-af78-599e292d0547&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j17&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-17667-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1733/workflows/7a5e482c-f541-4ec4-86e7-3f15ee60f1b0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1733/workflows/f5dc5f33-d0fa-4a37-b5ed-64c30bb76093&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j17&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17883391" author="brandon.williams" created="Fri, 20 Sep 2024 19:28:40 +0000"  >&lt;p&gt;4.0 looks like it has codestyle problems.&lt;/p&gt;</comment>
                            <comment id="17883409" author="bschoeni" created="Fri, 20 Sep 2024 20:42:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; yikes, fixed&lt;/p&gt;</comment>
                            <comment id="17883411" author="brandon.williams" created="Fri, 20 Sep 2024 21:21:43 +0000"  >&lt;p&gt;That looks better, thanks.  +1&lt;/p&gt;</comment>
                            <comment id="17884161" author="smiklosovic" created="Tue, 24 Sep 2024 07:55:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; I will merge that.&lt;/p&gt;</comment>
                            <comment id="17884228" author="smiklosovic" created="Tue, 24 Sep 2024 11:04:16 +0000"  >&lt;p&gt;Who is the &quot;author&quot; of this work? It is pretty confusing to me to figure it out. I need to craft the commit message and with what was going on, ticket changing hands etc, I have hard time to realize who did what.&lt;/p&gt;</comment>
                            <comment id="17884236" author="smiklosovic" created="Tue, 24 Sep 2024 11:20:36 +0000"  >&lt;p&gt;I think it is fair to say that the author is &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vgali7&quot; class=&quot;user-hover&quot; rel=&quot;vgali7&quot;&gt;vgali7&lt;/a&gt; and it was co-authored by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bschoeni&quot; class=&quot;user-hover&quot; rel=&quot;bschoeni&quot;&gt;bschoeni&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ahomoki&quot; class=&quot;user-hover&quot; rel=&quot;ahomoki&quot;&gt;ahomoki&lt;/a&gt;. Reviewed by Brandon and Brad.&lt;/p&gt;</comment>
                            <comment id="17884238" author="bschoeni" created="Tue, 24 Sep 2024 11:24:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; yes, that&apos;s fine.&lt;/p&gt;</comment>
                            <comment id="17884275" author="smiklosovic" created="Tue, 24 Sep 2024 13:17:17 +0000"  >&lt;p&gt;note to myself: change the fix versions once the current release train finishes&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13561923">CASSANDRA-19202</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13304018">CASSANDRA-15802</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[bschoeni]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="13163" cascade-level=""><![CDATA[Code]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13101"><![CDATA[Clients]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12314420" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Mentor</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ahomoki</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z12qmw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12350367">4.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/a79f7f4b00b861d5d4b9caa3d4257b8c7e4c75c7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/a79f7f4b00b861d5d4b9caa3d4257b8c7e4c75c7&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;New unit test&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>