<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:07:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13413] Run more test targets on CircleCI</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13413</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Currently we only run &lt;tt&gt;ant test&lt;/tt&gt; on circleci, we should use all the (free) containers we have and run more targets in parallel.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13061719">CASSANDRA-13413</key>
            <summary>Run more test targets on CircleCI</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marcuse">Marcus Eriksson</assignee>
                                    <reporter username="marcuse">Marcus Eriksson</reporter>
                        <labels>
                            <label>CI</label>
                    </labels>
                <created>Wed, 5 Apr 2017 12:33:18 +0000</created>
                <updated>Fri, 15 May 2020 08:03:47 +0000</updated>
                            <resolved>Fri, 7 Apr 2017 06:15:02 +0000</resolved>
                                        <fixVersion>2.1.18</fixVersion>
                    <fixVersion>2.2.10</fixVersion>
                    <fixVersion>3.0.13</fixVersion>
                    <fixVersion>3.11.0</fixVersion>
                    <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>CI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="15956774" author="krummas" created="Wed, 5 Apr 2017 12:36:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/testcircle&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/testcircle&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It runs &lt;tt&gt;ant eclipse-warnings; ant test&lt;/tt&gt; if we only have one container configured, if we have 4 it also runs &lt;tt&gt;ant long-test&lt;/tt&gt;, &lt;tt&gt;ant test-compression&lt;/tt&gt; and &lt;tt&gt;ant stress-test&lt;/tt&gt; on the different containers&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://circleci.com/gh/krummas/cassandra/5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/gh/krummas/cassandra/5&lt;/a&gt; (not finished when posting this, so might be broken)&lt;/p&gt;</comment>
                            <comment id="15956786" author="jasobrown" created="Wed, 5 Apr 2017 12:47:37 +0000"  >&lt;p&gt;this is awesome! +1.&lt;/p&gt;

&lt;p&gt;Maybe add &apos;microbench&apos; target somewhere? Not sure how long it takes to execute, though...&lt;/p&gt;</comment>
                            <comment id="15956813" author="krummas" created="Wed, 5 Apr 2017 13:03:15 +0000"  >&lt;blockquote&gt;&lt;p&gt;Maybe add &apos;microbench&apos; target somewhere?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;would be nice, but not sure the place is in CI - we would need jmh to output some sort of junit xml test report, and fail builds based on the benchmark times I guess? And not sure how predictable the performance is in CircleCI if it actually gives us something (other than we make sure that the benchmarks can actually build/execute)&lt;/p&gt;</comment>
                            <comment id="15956829" author="jasobrown" created="Wed, 5 Apr 2017 13:13:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;not sure how predictable the performance is&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, you are correct about that, and that&apos;s the best reason for not including it. I&apos;m still +1 on the current patch on your branch&lt;/p&gt;</comment>
                            <comment id="15956832" author="krummas" created="Wed, 5 Apr 2017 13:16:19 +0000"  >&lt;p&gt;my test failed quite badly: &lt;a href=&quot;https://circleci.com/gh/krummas/cassandra/5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/gh/krummas/cassandra/5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;rerunning&lt;/p&gt;</comment>
                            <comment id="15957103" author="jjirsa" created="Wed, 5 Apr 2017 15:59:22 +0000"  >&lt;p&gt;Build #6 looks better, but it&apos;s somehow not gathering the junit result properly &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Your build ran 2980 tests in junit with 0 failures&lt;br/&gt;
Slowest test: org.apache.cassandra.cql3.PagingQueryTest pagingOnRegularColumn (took 105.24 seconds).&lt;/p&gt;&lt;/blockquote&gt;

&lt;blockquote&gt;
&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Testsuite: org.apache.cassandra.net.MessagingServiceTest-compression&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Testsuite: org.apache.cassandra.net.MessagingServiceTest-compression Tests run: 12, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 3.835 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Testcase: testDroppedMessages(org.apache.cassandra.net.MessagingServiceTest)-compression:	FAILED&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; expected:&amp;lt;...dropped latency: 227&lt;span class=&quot;error&quot;&gt;&amp;#91;8&amp;#93;&lt;/span&gt; ms&amp;gt; but was:&amp;lt;...dropped latency: 227&lt;span class=&quot;error&quot;&gt;&amp;#91;7&amp;#93;&lt;/span&gt; ms&amp;gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; junit.framework.AssertionFailedError: expected:&amp;lt;...dropped latency: 227&lt;span class=&quot;error&quot;&gt;&amp;#91;8&amp;#93;&lt;/span&gt; ms&amp;gt; but was:&amp;lt;...dropped latency: 227&lt;span class=&quot;error&quot;&gt;&amp;#91;7&amp;#93;&lt;/span&gt; ms&amp;gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.cassandra.net.MessagingServiceTest.testDroppedMessages(MessagingServiceTest.java:114)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; &lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Test org.apache.cassandra.net.MessagingServiceTest FAILED&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Passed on 3 of the 4 containers/suites, though, so it&apos;s pretty close. &lt;tt&gt;test-compression&lt;/tt&gt; puts results into &lt;tt&gt;build/test/output/compression/&lt;/tt&gt; so you&apos;ll need to copy those into the results directory in the post step.&lt;/p&gt;</comment>
                            <comment id="15957245" author="mshuler" created="Wed, 5 Apr 2017 17:06:07 +0000"  >&lt;p&gt;I was working on multiple runners and fixing a broken test in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13414&quot; title=&quot;circle.yml: parallelize tests and install word list&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13414&quot;&gt;&lt;del&gt;CASSANDRA-13414&lt;/del&gt;&lt;/a&gt;. It looks like we OOM the container with more than one runner, so since y&apos;all are here, can you include this one-liner to fix o.a.c.utils.BitSetTest.compareBitSets?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;diff --git a/circle.yml b/circle.yml
index f0df31265a..66e752f367 100644
--- a/circle.yml
+++ b/circle.yml
@@ -8,6 +8,7 @@ test:
     - sudo ifconfig lo:2 127.0.0.3 up
     - sudo ifconfig lo:3 127.0.0.4 up
     - sudo ifconfig lo:4 127.0.0.5 up
+    - sudo apt-get update; sudo apt-get install wamerican
     - ant build
 
   override:
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since you&apos;re removing the pre: section, I&apos;m not sure how to include that in the parallel bits, yet. Thanks!&lt;/p&gt;</comment>
                            <comment id="15957246" author="krummas" created="Wed, 5 Apr 2017 17:08:41 +0000"  >&lt;p&gt;sure, will include!&lt;/p&gt;</comment>
                            <comment id="15957251" author="krummas" created="Wed, 5 Apr 2017 17:12:23 +0000"  >&lt;p&gt;running a new test with wamerican installed and it also collects the compression xmls, thanks guys: &lt;a href=&quot;https://circleci.com/gh/krummas/cassandra/8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/gh/krummas/cassandra/8&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15959332" author="krummas" created="Thu, 6 Apr 2017 17:14:12 +0000"  >&lt;p&gt;ok, finally got it working: &lt;a href=&quot;https://circleci.com/gh/krummas/cassandra/16&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/gh/krummas/cassandra/16&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15959387" author="mshuler" created="Thu, 6 Apr 2017 17:35:31 +0000"  >&lt;p&gt;&lt;tt&gt;ant test-cdc&lt;/tt&gt; writes its result xml files to &lt;tt&gt;build/test/output/cdc&lt;/tt&gt; and `ant test-all` writes to multiple for each dep target. Jenkins allows ant-style globbing, so we use &lt;tt&gt;*&lt;b&gt;/TEST-&lt;/b&gt;.xml&lt;/tt&gt; everywhere to just grab everything. I&apos;d bet something like a blanket &lt;tt&gt;find ./build/test/output -type f -name *.xml&lt;/tt&gt; and cp to $CIRCLE_TEST_REPORTS/junit/ - sorry, I think that will overwrite same-named files, so maybe &lt;tt&gt;find ./build/test/output -type d&lt;/tt&gt; for finding all the directories under there and then doing the recursive copy of each?&lt;/p&gt;

&lt;p&gt;Sorry I don&apos;t have the bandwidth to test all the possibles, but just spitballing something to cover all the possible targets a little better than a single conditional.&lt;/p&gt;</comment>
                            <comment id="15959400" author="krummas" created="Thu, 6 Apr 2017 17:38:33 +0000"  >&lt;p&gt;My patch essentially runs test-all:&lt;br/&gt;
&lt;tt&gt;&amp;lt;target name=&quot;test-all&quot; depends=&quot;eclipse-warnings,test,long-test,test-compression,stress-test&quot; ...&lt;/tt&gt;&lt;br/&gt;
and this patch runs those different targets in the 4 different containers.&lt;/p&gt;

&lt;p&gt;Had no idea test-cdc existed, is that being run on cassci?&lt;/p&gt;</comment>
                            <comment id="15959407" author="mshuler" created="Thu, 6 Apr 2017 17:42:13 +0000"  >&lt;p&gt;test-cdc is running on the ASF Jenkins branches that contain it, so cassandra-3.11 and trunk - &lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/view/A-D/view/Cassandra/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15959425" author="krummas" created="Thu, 6 Apr 2017 17:48:19 +0000"  >&lt;p&gt;updated patch to copy all xml files in output directory, running now&lt;/p&gt;</comment>
                            <comment id="15959428" author="krummas" created="Thu, 6 Apr 2017 17:49:25 +0000"  >&lt;p&gt;and it wont overwrite the files, the commands are being run on each of the containers&lt;/p&gt;</comment>
                            <comment id="15959561" author="jjirsa" created="Thu, 6 Apr 2017 19:15:54 +0000"  >&lt;p&gt;lgtm&lt;/p&gt;
</comment>
                            <comment id="15959585" author="mshuler" created="Thu, 6 Apr 2017 19:29:39 +0000"  >&lt;p&gt;ship it! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15959840" author="aweisberg" created="Thu, 6 Apr 2017 21:55:54 +0000"  >&lt;p&gt;These seems less useful for me in day to day testing where I would rather optimize for response time vs. daily test runs that are more thorough.&lt;/p&gt;

&lt;p&gt;If I need to build several branches at once I would rather use my containers for that or better yet for running the same branch faster.&lt;/p&gt;

&lt;p&gt;For me this would be a step backwards.&lt;/p&gt;</comment>
                            <comment id="15960270" author="krummas" created="Fri, 7 Apr 2017 04:47:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aweisberg&quot; class=&quot;user-hover&quot; rel=&quot;aweisberg&quot;&gt;aweisberg&lt;/a&gt; just leave the parallelism at 1 and it should works just like before&lt;/p&gt;</comment>
                            <comment id="15960345" author="krummas" created="Fri, 7 Apr 2017 06:15:02 +0000"  >&lt;p&gt;committed, thanks&lt;/p&gt;</comment>
                            <comment id="15961030" author="aweisberg" created="Fri, 7 Apr 2017 16:10:38 +0000"  >&lt;p&gt;Where do I set the parallelism to 1? This is still going to take a 1.5 hour test run and turn it into 4 hours of testing that needs to run through my pool of 4 containers.&lt;/p&gt;</comment>
                            <comment id="15961034" author="aweisberg" created="Fri, 7 Apr 2017 16:11:25 +0000"  >&lt;p&gt;Found out where you adjust parallelism &lt;a href=&quot;https://circleci.com/gh/[username]/cassandra/edit#parallel-builds&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/gh/[username]/cassandra/edit#parallel-builds&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15961051" author="krummas" created="Fri, 7 Apr 2017 16:20:44 +0000"  >&lt;blockquote&gt;&lt;p&gt;This is still going to take a 1.5 hour test run and turn it into 4 hours of testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;what do you mean?&lt;/p&gt;

&lt;p&gt;with parallelism=1 circleci will only run &apos;case 0&apos; here: &lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/circle.yml#L10&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/trunk/circle.yml#L10&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15961060" author="aweisberg" created="Fri, 7 Apr 2017 16:24:35 +0000"  >&lt;p&gt;Ah great. I thought it was going to run them serially.&lt;/p&gt;</comment>
                            <comment id="16131006" author="eduard.tudenhoefner" created="Thu, 17 Aug 2017 18:54:50 +0000"  >&lt;p&gt;It looks like the &lt;b&gt;stress-test&lt;/b&gt; target only got introduced with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11638&quot; title=&quot;Add cassandra-stress test source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11638&quot;&gt;&lt;del&gt;CASSANDRA-11638&lt;/del&gt;&lt;/a&gt; (3.10) and so &lt;b&gt;stress-test&lt;/b&gt; isn&apos;t valid in all previous versions. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krummas&quot; class=&quot;user-hover&quot; rel=&quot;krummas&quot;&gt;krummas&lt;/a&gt; I created &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13775&quot; title=&quot;CircleCI tests fail because *stress-test* isn&amp;#39;t a valid target&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13775&quot;&gt;&lt;del&gt;CASSANDRA-13775&lt;/del&gt;&lt;/a&gt;, could you review it please?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310060">
                    <name>Container</name>
                                            <outwardlinks description="contains">
                                        <issuelink>
            <issuekey id="13061768">CASSANDRA-13414</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 13 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3d8fz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jjirsa</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jjirsa]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>