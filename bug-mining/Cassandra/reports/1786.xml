<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:35:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-4537] We should emit number of sstables in each level from JMX</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-4537</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;We should add methods to this Mbean org.apache.cassandra.db.ColumnFamilyStoreMBean&lt;/p&gt;

&lt;p&gt;These metrics will be helpful to see how sstables are distributed in different levels and how they move to higher level with time. &lt;br/&gt;
Currently we can see this by looking at the json file but with JMX, we can monitor the historic values over time using any monitoring tool.  &lt;/p&gt;</description>
                <environment></environment>
        <key id="12603335">CASSANDRA-4537</key>
            <summary>We should emit number of sstables in each level from JMX</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yukim">Yuki Morishita</assignee>
                                    <reporter username="kohlisankalp">Sankalp Kohli</reporter>
                        <labels>
                            <label>compaction</label>
                            <label>leveled</label>
                    </labels>
                <created>Mon, 13 Aug 2012 21:32:54 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:29 +0000</updated>
                            <resolved>Tue, 11 Sep 2012 22:24:10 +0000</resolved>
                                        <fixVersion>1.2.0 beta 1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="43200">12h</timeoriginalestimate>
                            <timeestimate seconds="43200">12h</timeestimate>
                                        <comments>
                            <comment id="13433833" author="brandon.williams" created="Tue, 14 Aug 2012 02:08:07 +0000"  >&lt;p&gt;I would go one further and say it should be available via nodetool compactionstats.  I can&apos;t count the number of times I&apos;ve had to paste a python script that prints level counts.&lt;/p&gt;</comment>
                            <comment id="13450973" author="yukim" created="Fri, 7 Sep 2012 20:57:21 +0000"  >&lt;p&gt;Attaching patch that adds SSTableCountPerLevel to ColulmnFamilyStoreMBean, which returns number of SSTable for each level in &lt;em&gt;int[]&lt;/em&gt; and prints it with nodetool cfstats.&lt;/p&gt;

&lt;p&gt;Output looks like below:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
    Column Family: Standard1
    SSTable count: 19
    SSTables in each level: [0, 8, 11, 0, 0, 0, 0, 0]
    Space used (live): 100923462
    Space used (total): 101012612
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;compactionstats displays info only when compaction is happening, so I chose cfstats to show info.&lt;/p&gt;

&lt;p&gt;cfstats output is long, but let &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4191&quot; title=&quot;Add `nodetool cfstats &amp;lt;ks&amp;gt; &amp;lt;cf&amp;gt;` abilities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4191&quot;&gt;&lt;del&gt;CASSANDRA-4191&lt;/del&gt;&lt;/a&gt; handle it.&lt;/p&gt;</comment>
                            <comment id="13450985" author="jbellis" created="Fri, 7 Sep 2012 21:11:40 +0000"  >&lt;p&gt;Idea: show number of sstables / desired max, when we exceed the desired threshold?  This would give you a quick eyeball of &quot;here&apos;s where compaction is behind.&quot;&lt;/p&gt;

&lt;p&gt;SSTables in each level: &lt;span class=&quot;error&quot;&gt;&amp;#91;43/0, 8, 102/100, 123, 0, 0, 0, 0&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="13452396" author="yukim" created="Mon, 10 Sep 2012 20:09:51 +0000"  >&lt;p&gt;v2 attached. It displays max threshold of level when exceeded.&lt;/p&gt;</comment>
                            <comment id="13453326" author="jbellis" created="Tue, 11 Sep 2012 19:31:04 +0000"  >&lt;p&gt;+1, lgtm&lt;/p&gt;

&lt;p&gt;nit: getLevelSize call is a little confusing since it handles i &amp;gt; generations.length, inlining to generations&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;.size might be more clear&lt;/p&gt;</comment>
                            <comment id="13453487" author="yukim" created="Tue, 11 Sep 2012 22:24:10 +0000"  >&lt;p&gt;Committed with above nit fixed.&lt;/p&gt;</comment>
                            <comment id="13453539" author="hudson" created="Tue, 11 Sep 2012 23:18:08 +0000"  >&lt;p&gt;Integrated in Cassandra #2090 (See &lt;a href=&quot;https://builds.apache.org/job/Cassandra/2090/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Cassandra/2090/&lt;/a&gt;)&lt;br/&gt;
    Add SSTable count per level to cfstats patch by yukim; reviewed by jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4537&quot; title=&quot;We should emit number of sstables in each level from JMX&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4537&quot;&gt;&lt;del&gt;CASSANDRA-4537&lt;/del&gt;&lt;/a&gt; (Revision c64d975cdf9eebddb04801573035a7272f779fed)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
yukim : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;src/java/org/apache/cassandra/db/compaction/LeveledManifest.java&lt;/li&gt;
	&lt;li&gt;src/java/org/apache/cassandra/tools/NodeCmd.java&lt;/li&gt;
	&lt;li&gt;src/java/org/apache/cassandra/db/ColumnFamilyStoreMBean.java&lt;/li&gt;
	&lt;li&gt;CHANGES.txt&lt;/li&gt;
	&lt;li&gt;src/java/org/apache/cassandra/db/ColumnFamilyStore.java&lt;/li&gt;
	&lt;li&gt;src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13595994" author="cscetbon" created="Thu, 7 Mar 2013 15:57:43 +0000"  >&lt;p&gt;Whenever I try to access this attribute I get an empty string in version 1.2.2 I was expecting that even if I have only stables in level 0 I would get an array like &lt;span class=&quot;error&quot;&gt;&amp;#91;x,0,0,0,..&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="13596007" author="yukim" created="Thu, 7 Mar 2013 16:09:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cscetbon&quot; class=&quot;user-hover&quot; rel=&quot;cscetbon&quot;&gt;cscetbon&lt;/a&gt; Do you mean SSTableCountPerLevel attribute in ColumnFamilyStoreMBean? It should return int[] even if there are only level 0s or no sstables at all when ColumnFamily is configured to use leveled compaction. When you use size tiered compaction, then it returns null.&lt;/p&gt;</comment>
                            <comment id="13600132" author="cscetbon" created="Tue, 12 Mar 2013 16:11:11 +0000"  >&lt;p&gt;why is this information not available when we are using size tiered compaction ? It would be interesting to know how much different similar-sized stables exist.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12544519" name="4537-v2.txt" size="4767" author="yukim" created="Mon, 10 Sep 2012 20:09:51 +0000"/>
                            <attachment id="12544289" name="4537.txt" size="4000" author="yukim" created="Fri, 7 Sep 2012 20:57:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>256226</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 37 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gwv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96754</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>