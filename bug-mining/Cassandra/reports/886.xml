<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:20:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2563] Error starting up a cassandra cluster after creating a table in the system keyspace: Attempt to assign id to existing column family.</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2563</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;&lt;b&gt;Repro Steps&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;rm -rf /var/lib/cassandra/*&lt;/li&gt;
	&lt;li&gt;rm -rf /var/log/cassandra/*&lt;/li&gt;
	&lt;li&gt;Start Cassandra&lt;/li&gt;
	&lt;li&gt;In cqlsh, create a column family and insert data
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; CREATE COLUMNFAMILY users (
   ...   KEY varchar PRIMARY KEY,
   ...   password varchar,
   ...   gender varchar,
   ...   session_token varchar,
   ...   state varchar,
   ...   birth_year bigint);

cqlsh&amp;gt; INSERT INTO users (KEY, password, gender, state, birth_year) VALUES (&apos;user1&apos;, &apos;ch@ngem3&apos;, &apos;f&apos;, &apos;CA&apos;, &apos;1971&apos;);
cqlsh&amp;gt; INSERT INTO users (KEY, password, gender, state, birth_year) VALUES (&apos;user2&apos;, &apos;ch@ngem3&apos;, &apos;f&apos;, &apos;CA&apos;, &apos;1972&apos;);
cqlsh&amp;gt; INSERT INTO users (KEY, password, gender, state, birth_year) VALUES (&apos;user3&apos;, &apos;ch@ngem3&apos;, &apos;f&apos;, &apos;CA&apos;, &apos;1973&apos;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Quit cqlsh&lt;/li&gt;
	&lt;li&gt;Kill Cassandra&lt;/li&gt;
	&lt;li&gt;Startup Cassandra and get error&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; INFO 18:38:24,509 Loading schema version 087af100-7034-11e0-0000-242d50cf1fde
ERROR 18:38:24,774 Exception encountered during startup.
java.io.IOError: org.apache.cassandra.config.ConfigurationException: Attempt to assign id to existing column family.
	at org.apache.cassandra.config.DatabaseDescriptor.loadSchemas(DatabaseDescriptor.java:489)
	at org.apache.cassandra.service.AbstractCassandraDaemon.setup(AbstractCassandraDaemon.java:138)
	at org.apache.cassandra.service.AbstractCassandraDaemon.activate(AbstractCassandraDaemon.java:313)
	at org.apache.cassandra.thrift.CassandraDaemon.main(CassandraDaemon.java:80)
Caused by: org.apache.cassandra.config.ConfigurationException: Attempt to assign id to existing column family.
	at org.apache.cassandra.config.CFMetaData.map(CFMetaData.java:126)
	at org.apache.cassandra.config.DatabaseDescriptor.loadSchemas(DatabaseDescriptor.java:485)
	... 3 more
Exception encountered during startup.
java.io.IOError: org.apache.cassandra.config.ConfigurationException: Attempt to assign id to existing column family.
	at org.apache.cassandra.config.DatabaseDescriptor.loadSchemas(DatabaseDescriptor.java:489)
	at org.apache.cassandra.service.AbstractCassandraDaemon.setup(AbstractCassandraDaemon.java:138)
	at org.apache.cassandra.service.AbstractCassandraDaemon.activate(AbstractCassandraDaemon.java:313)
	at org.apache.cassandra.thrift.CassandraDaemon.main(CassandraDaemon.java:80)
Caused by: org.apache.cassandra.config.ConfigurationException: Attempt to assign id to existing column family.
	at org.apache.cassandra.config.CFMetaData.map(CFMetaData.java:126)
	at org.apache.cassandra.config.DatabaseDescriptor.loadSchemas(DatabaseDescriptor.java:485)
	... 3 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



&lt;p&gt;&lt;b&gt;UPDATE:  This issue happens if I create the CF in the default keyspace.&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Workaround&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; CREATE KEYSPACE cqldb with 
   ...   strategy_class =  
   ...     &apos;org.apache.cassandra.locator.SimpleStrategy&apos; 
   ...   and strategy_options:replication_factor=1;
cqlsh&amp;gt; use cqldb;

The create the table and insert data.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Branch: cassandra-0.8; git pull @ 11:30amPST on 4/26&lt;br/&gt;
Server: RHEL5.5 single node&lt;/p&gt;</environment>
        <key id="12505230">CASSANDRA-2563</key>
            <summary>Error starting up a cassandra cluster after creating a table in the system keyspace: Attempt to assign id to existing column family.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="cdaw">Cathy Daw</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Apr 2011 18:50:50 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:00 +0000</updated>
                            <resolved>Wed, 27 Apr 2011 15:55:28 +0000</resolved>
                                        <fixVersion>0.8.0 beta 2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13025382" author="cdaw" created="Tue, 26 Apr 2011 19:01:40 +0000"  >&lt;p&gt;The /var/lib/cassandra directory tarball.&lt;/p&gt;</comment>
                            <comment id="13025385" author="cdaw" created="Tue, 26 Apr 2011 19:06:21 +0000"  >&lt;p&gt;I was able to reproduce this again ...  cleared out /var/lib/cassandra/* and then started up server and repeated steps.&lt;/p&gt;</comment>
                            <comment id="13025396" author="jbellis" created="Tue, 26 Apr 2011 19:49:56 +0000"  >&lt;p&gt;is default keyspace = system?&lt;/p&gt;</comment>
                            <comment id="13025400" author="cdaw" created="Tue, 26 Apr 2011 19:56:17 +0000"  >&lt;p&gt;The CF was created in the system keyspace:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Keyspace: system:
  Replication Strategy: org.apache.cassandra.locator.LocalStrategy
    Options: [replication_factor:1]
  Column Families:
    ColumnFamily: users
      Key Validation Class: org.apache.cassandra.db.marshal.UTF8Type
      Default column value validator: org.apache.cassandra.db.marshal.UTF8Type
      Columns sorted by: org.apache.cassandra.db.marshal.UTF8Type
      Row cache size / save period in seconds: 0.0/0
      Key cache size / save period in seconds: 200000.0/14400
      Memtable thresholds: 0.140625/30/1440 (millions of ops/MB/minutes)
      GC grace seconds: 864000
      Compaction min/max thresholds: 4/32
      Read repair chance: 1.0
      Replicate on write: true
      Built indexes: []
      Column Metadata:
        Column Name: session_token
          Validation Class: org.apache.cassandra.db.marshal.UTF8Type
        Column Name: state
          Validation Class: org.apache.cassandra.db.marshal.UTF8Type
        Column Name: birth_year
          Validation Class: org.apache.cassandra.db.marshal.LongType
        Column Name: password
          Validation Class: org.apache.cassandra.db.marshal.UTF8Type
        Column Name: gender
          Validation Class: org.apache.cassandra.db.marshal.UTF8Type
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13025449" author="jbellis" created="Tue, 26 Apr 2011 21:31:15 +0000"  >&lt;p&gt;patch to disallow screwing w/ system keyspace&lt;/p&gt;</comment>
                            <comment id="13025464" author="cdaw" created="Tue, 26 Apr 2011 21:59:43 +0000"  >&lt;p&gt;The patch works good and gives this error when creating a new column family:&lt;br/&gt;
Bad Request: system keyspace is not user-modifiable&lt;/p&gt;

&lt;p&gt;The only thing to think about is whether or not this fix limits the ability of support to fix corruption issues.&lt;/p&gt;</comment>
                            <comment id="13025859" author="jbellis" created="Wed, 27 Apr 2011 15:55:28 +0000"  >&lt;p&gt;committed.&lt;/p&gt;

&lt;p&gt;note that this only disallows schema changes; modifying system &lt;b&gt;data&lt;/b&gt; is still allowed (and still dangerous &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13025902" author="hudson" created="Wed, 27 Apr 2011 17:18:12 +0000"  >&lt;p&gt;Integrated in Cassandra-0.8 #46 (See &lt;a href=&quot;https://builds.apache.org/hudson/job/Cassandra-0.8/46/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/hudson/job/Cassandra-0.8/46/&lt;/a&gt;)&lt;br/&gt;
    disallow making schema changes to system keyspace&lt;br/&gt;
patch by jbellis; tested by cdaw for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2563&quot; title=&quot;Error starting up a cassandra cluster after creating a table in the system keyspace: Attempt to assign id to existing column family.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2563&quot;&gt;&lt;del&gt;CASSANDRA-2563&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12477442" name="2563.txt" size="734" author="jbellis" created="Tue, 26 Apr 2011 21:31:15 +0000"/>
                            <attachment id="12477431" name="cassandra.2563.tar" size="71680" author="cdaw" created="Tue, 26 Apr 2011 19:01:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20698</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gc3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>93392</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>cdaw</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[cdaw]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>