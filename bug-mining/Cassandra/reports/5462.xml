<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:16:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-16053] cqlsh COPY functions broken in Python 3.8 on Mac</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-16053</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;aholmberg-rmbp16:cassandra adamholmberg$ pyenv shell
3.8.2
aholmberg-rmbp16:cassandra adamholmberg$ bin/cqlsh --debug
Using CQL driver: &amp;lt;module &apos;cassandra&apos; from &apos;/Users/adamholmberg/code/cassandra/bin/../lib/cassandra-driver-internal-only-3.23.0.post0-1a184b99.zip/cassandra-driver-3.23.0.post0-1a184b99/cassandra/__init__.py&apos;&amp;gt;
Using connect timeout: 5 seconds
Using &apos;utf-8&apos; encoding
Using ssl: False
Connected to Test Cluster at 127.0.0.1:9042.
[cqlsh 5.0.1 | Cassandra 4.0-beta2-SNAPSHOT | CQL spec 3.4.5 | Native protocol v4]
Use HELP for help.
cqlsh&amp;gt; copy test.testcopyto to &apos;asdf&apos;;
Detected 12 core(s)
Using 11 child processes

Starting copy of test.testcopyto with columns [a, b, c, d].
Traceback (most recent call last):
  File &quot;/Users/adamholmberg/code/cassandra/bin/cqlsh.py&quot;, line 937, in onecmd
    self.handle_statement(st, statementtext)
  File &quot;/Users/adamholmberg/code/cassandra/bin/cqlsh.py&quot;, line 974, in handle_statement
    return custom_handler(parsed)
  File &quot;/Users/adamholmberg/code/cassandra/bin/cqlsh.py&quot;, line 1563, in do_copy
    task.run()
  File &quot;/Users/adamholmberg/code/cassandra/bin/../pylib/cqlshlib/copyutil.py&quot;, line 669, in run
    self.start_processes()
  File &quot;/Users/adamholmberg/code/cassandra/bin/../pylib/cqlshlib/copyutil.py&quot;, line 471, in start_processes
    process.start()
  File &quot;/Users/adamholmberg/.pyenv/versions/3.8.2/lib/python3.8/multiprocessing/process.py&quot;, line 121, in start
    self._popen = self._Popen(self)
  File &quot;/Users/adamholmberg/.pyenv/versions/3.8.2/lib/python3.8/multiprocessing/context.py&quot;, line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File &quot;/Users/adamholmberg/.pyenv/versions/3.8.2/lib/python3.8/multiprocessing/context.py&quot;, line 283, in _Popen
    return Popen(process_obj)
  File &quot;/Users/adamholmberg/.pyenv/versions/3.8.2/lib/python3.8/multiprocessing/popen_spawn_posix.py&quot;, line 32, in __init__
    super().__init__(process_obj)
  File &quot;/Users/adamholmberg/.pyenv/versions/3.8.2/lib/python3.8/multiprocessing/popen_fork.py&quot;, line 19, in __init__
    self._launch(process_obj)
  File &quot;/Users/adamholmberg/.pyenv/versions/3.8.2/lib/python3.8/multiprocessing/popen_spawn_posix.py&quot;, line 47, in _launch
    reduction.dump(process_obj, fp)
  File &quot;/Users/adamholmberg/.pyenv/versions/3.8.2/lib/python3.8/multiprocessing/reduction.py&quot;, line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
TypeError: cannot pickle &apos;_thread.lock&apos; object
cqlsh&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;multiprocessing uses a different default start method on Mac, and pickling fails trying to serialize the Cluster object.&lt;br/&gt;
&lt;a href=&quot;https://github.com/python/cpython/blob/db098bc1f05bd0773943e59f83489f05f28dedf8/Lib/multiprocessing/context.py#L313-L318&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/python/cpython/blob/db098bc1f05bd0773943e59f83489f05f28dedf8/Lib/multiprocessing/context.py#L313-L318&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://bugs.python.org/issue33725&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.python.org/issue33725&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13323097">CASSANDRA-16053</key>
            <summary>cqlsh COPY functions broken in Python 3.8 on Mac</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aholmber">Adam Holmberg</assignee>
                                    <reporter username="aholmber">Adam Holmberg</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Aug 2020 19:09:27 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:43 +0000</updated>
                            <resolved>Thu, 20 Aug 2020 20:05:33 +0000</resolved>
                                        <fixVersion>4.0-beta2</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Tool/cqlsh</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17179209" author="aholmber" created="Mon, 17 Aug 2020 20:25:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11749&quot; title=&quot;CQLSH gets SSL exception following a COPY FROM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11749&quot;&gt;&lt;del&gt;CASSANDRA-11749&lt;/del&gt;&lt;/a&gt; introduced passing the cluster to clean up sockets in forked child processes. That patch assumed that forking would be used everywhere but Windows.&lt;/p&gt;

&lt;p&gt;Instead of making the parameter passing logic more complex to account for platform and runtime variations, I suggest we rely on the underlying driver fix which was later introduced, and stop trying to pass the Cluster.&lt;br/&gt;
&lt;a href=&quot;https://datastax-oss.atlassian.net/browse/PYTHON-577&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PYTHON-577&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...aholmberg:CASSANDRA-16053?expand=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve run the repro script from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-11749&quot; title=&quot;CQLSH gets SSL exception following a COPY FROM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-11749&quot;&gt;&lt;del&gt;CASSANDRA-11749&lt;/del&gt;&lt;/a&gt; several hundred times. Stefania indicated that it would previously reproduce within around a half dozen iterations.&lt;/p&gt;</comment>
                            <comment id="17179246" author="aholmber" created="Mon, 17 Aug 2020 21:53:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/aholmberg/cassandra?branch=CASSANDRA-16053&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ci&lt;/a&gt;&lt;br/&gt;
Everything failed so far is known to be flaky.&lt;/p&gt;</comment>
                            <comment id="17181388" author="edimitrova" created="Thu, 20 Aug 2020 19:24:58 +0000"  >&lt;p&gt;I am not a driver person but from everything I read in the referenced links around python and drivers, the patch looks good to me. &lt;br/&gt;
No new CI failures, I read you iterated the reproduction test quite some time and it doesn&apos;t fail anymore.&lt;br/&gt;
+1 from me, you need a committer to check it too and possibly commit.&lt;/p&gt;</comment>
                            <comment id="17181416" author="brandon.williams" created="Thu, 20 Aug 2020 20:05:33 +0000"  >&lt;p&gt;Committed, thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12967293">CASSANDRA-11749</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aholmber]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="13163" cascade-level=""><![CDATA[Code]]></customfieldvalue>
                                <customfieldvalue key="13164" cascade-level="1"><![CDATA[Bug - Unclear Impact]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12970"><![CDATA[Unit Test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 12 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0hu68:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
        <customfieldvalue><![CDATA[e.dimitrova]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348281">4.0-alpha1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/0e53379ec945e07c38aed03048ba8f76d42bdd42&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/0e53379ec945e07c38aed03048ba8f76d42bdd42&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;I ran the repro script from the previous ticket 500+ times, restarting C* (which was said to make it happen more) each time.&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>