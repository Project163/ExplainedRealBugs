<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:51:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-8778] Adler32 Digests for Compressed SSTables are Incorrect</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-8778</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;ChecksumWriter append() calculates the checksum of a buffer, then also writes that checksum as an int into the provided DataOutput. The final call to writeFullChecksum will have the checksum of all of the buffers, but none of the intermediate int checksums.&lt;/p&gt;

&lt;p&gt;This issue was discovered (and a fix proposed) in #5791 - if the patch for #5791 is not accepted, some fix for src/java/org/apache/cassandra/io/util/DataIntegrityMetadata.java should be applied. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12773996">CASSANDRA-8778</key>
            <summary>Adler32 Digests for Compressed SSTables are Incorrect</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jjirsa">Jeff Jirsa</assignee>
                                    <reporter username="jjirsa">Jeff Jirsa</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Feb 2015 22:22:46 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:21 +0000</updated>
                            <resolved>Thu, 5 Mar 2015 20:08:47 +0000</resolved>
                                                            <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14315523" author="jbellis" created="Wed, 11 Feb 2015 03:36:41 +0000"  >&lt;p&gt;IMO we should do this separately anyway since #5791 is 2.1+ but this should be fixed in 2.0 as well.&lt;/p&gt;</comment>
                            <comment id="14326852" author="jjirsa" created="Thu, 19 Feb 2015 01:18:48 +0000"  >&lt;p&gt;Proposed patch against trunk&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;for i in ~/.ccm/snapshot/node1/data/test2/*/*Data*; do echo $i &amp;amp;&amp;amp; java AdlerCheckSum $i ; j=`echo $i | sed -e &apos;s/Data.db/Digest.sha1/g&apos; ` &amp;amp;&amp;amp; echo &apos;value from digest&apos; &amp;amp;&amp;amp; cat $j &amp;amp;&amp;amp; echo &apos;&apos; ; done
/Users/jeff/.ccm/snapshot/node1/data/test2/compressed_counters-c2caca90b7d311e4a8fa85b755fc16c4/la-3-big-Data.db
2241194834
value from digest
2241194834
/Users/jeff/.ccm/snapshot/node1/data/test2/compressed_counters-c2caca90b7d311e4a8fa85b755fc16c4/la-4-big-Data.db
3042888126
value from digest
3042888126
/Users/jeff/.ccm/snapshot/node1/data/test2/uncompressed_table-c37ed850b7d311e4a8fa85b755fc16c4/la-3-big-Data.db
2620019278
value from digest
2620019278
/Users/jeff/.ccm/snapshot/node1/data/test2/uncompressed_table-c37ed850b7d311e4a8fa85b755fc16c4/la-4-big-Data.db
2131686065
value from digest
2131686065
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14326923" author="jbellis" created="Thu, 19 Feb 2015 02:38:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=benedict&quot; class=&quot;user-hover&quot; rel=&quot;benedict&quot;&gt;benedict&lt;/a&gt; to review&lt;/p&gt;</comment>
                            <comment id="14327181" author="benedict" created="Thu, 19 Feb 2015 09:56:24 +0000"  >&lt;p&gt;Please remember to mark patch available, else it doesn&apos;t appear in my workflow &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14327345" author="benedict" created="Thu, 19 Feb 2015 12:31:54 +0000"  >&lt;p&gt;This patch doesn&apos;t apply cleanly to 2.0 - looks like there&apos;s some associated renaming missing from the diff. Could you also ensure you&apos;re producing the patch by a simple &quot;git diff&quot;? There&apos;s some extraneous noise in the file as well.&lt;/p&gt;</comment>
                            <comment id="14328242" author="jjirsa" created="Thu, 19 Feb 2015 22:42:41 +0000"  >&lt;p&gt;I know that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbellis&quot; class=&quot;user-hover&quot; rel=&quot;jbellis&quot;&gt;jbellis&lt;/a&gt;] suggested pushing this to 2.0, but 2.0 calculates sha1 digests (when needed), and does so correctly. The real issue I intended to report in #8778 is that &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4165&quot; title=&quot;Generate Digest file for compressed SSTables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4165&quot;&gt;&lt;del&gt;CASSANDRA-4165&lt;/del&gt;&lt;/a&gt; incorrectly calculated adler32 digests in 2.1 and 3.0/trunk&lt;/p&gt;

&lt;p&gt;If someone wants to port #4165 to 2.0, I won&apos;t really object, but the digests calculated by 2.0 are technically correct when present. In 2.1+, they were incorrect.&lt;/p&gt;

&lt;p&gt;I have, however, uploaded a new .diff (rather than .patch) if you prefer that format. I&apos;ve confirmed this applies cleanly to both 2.1 and trunk. &lt;/p&gt;

&lt;p&gt;The one thing I did neglect is that the digest is still named .sha1 rather than .adler32. That change remains in my patch for #5791, and probably belongs here. Trivial change, though, I can add it or you can.&lt;/p&gt;
</comment>
                            <comment id="14328258" author="benedict" created="Thu, 19 Feb 2015 22:53:43 +0000"  >&lt;p&gt;OK, I&apos;m confused. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbellis&quot; class=&quot;user-hover&quot; rel=&quot;jbellis&quot;&gt;jbellis&lt;/a&gt; could you confirm what the aim is for this wrt 2.0? Sounds like this really is 2.1+ (though no major harm having it split out as a ticket)&lt;/p&gt;</comment>
                            <comment id="14328374" author="jbellis" created="Fri, 20 Feb 2015 00:34:11 +0000"  >&lt;p&gt;I misunderstood and thought we&apos;re computing digests incorrectly in 2.0 as well.  Sorry for the confusion!&lt;/p&gt;</comment>
                            <comment id="14349406" author="benedict" created="Thu, 5 Mar 2015 20:08:47 +0000"  >&lt;p&gt;LGTM, commited. Thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12659199">CASSANDRA-5791</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12699756" name="cassandra-8778.diff" size="3133" author="jjirsa" created="Thu, 19 Feb 2015 22:40:47 +0000"/>
                            <attachment id="12699589" name="cassandra-8778.patch" size="3741" author="jjirsa" created="Thu, 19 Feb 2015 01:18:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jjirsa]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i25g3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>benedict</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[benedict]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>