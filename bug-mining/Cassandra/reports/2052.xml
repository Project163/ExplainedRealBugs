<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:37:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5300] Insufficient validation of UPDATE queries against counter cfs</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5300</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;CREATE TABLE demo (
  id int PRIMARY KEY,
  c counter
)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is expected:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;insert into demo (id, c) VALUES ( 0, 20);
Bad Request: INSERT statement are not allowed on counter tables, use UPDATE instead
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This should also be forbidden, but it is not:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;update demo set c = 20 where id = 0;
select * from demo;

 id | c
----+----
  0 | 20
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12634654">CASSANDRA-5300</key>
            <summary>Insufficient validation of UPDATE queries against counter cfs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="aleksey">Aleksey Yeschenko</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Feb 2013 18:19:02 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:17 +0000</updated>
                            <resolved>Fri, 1 Mar 2013 13:30:26 +0000</resolved>
                                        <fixVersion>1.2.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13589750" author="iamaleksey" created="Thu, 28 Feb 2013 18:24:00 +0000"  >&lt;p&gt;1.1 is not affected - this is a 1.2 regression.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;update demo set c = 20 where id = 0;
Bad Request: invalid operation for commutative columnfamily demo
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13590389" author="marco.matarazzo" created="Fri, 1 Mar 2013 10:00:53 +0000"  >&lt;p&gt;I was hoping this was a feature, and was about to be extended to INSERT too, it can be very useful during table initialization/import using COPY FROM on cqlsh or just a bunch of saved CQL.&lt;/p&gt;</comment>
                            <comment id="13590392" author="ggargani" created="Fri, 1 Mar 2013 10:04:35 +0000"  >&lt;p&gt;I welcomed it as nice feature, too. Forcing a defined value in a counter does have uses (i.e., when you have a cap to the value a counter can reach)&lt;/p&gt;</comment>
                            <comment id="13590401" author="slebresne" created="Fri, 1 Mar 2013 10:28:39 +0000"  >&lt;p&gt;I&apos;d prefer doing the validation in Operation.SetValue directly because that where we have all the other type validation now (and it&apos;s cleaner that way imo), as done in the attached v2.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;it can be very useful during table initialization/import&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;For the record, nobody contesting being able to set a counter would be useful.  But it doesn&apos;t work and I&apos;m pretty sure it cannot work with the current implementation of counters. Don&apos;t be fooled by the example above, it&apos;s not complete. If you try an increment after the last update, you will end up with a server side exception because you&apos;ve basically corrupted your data.&lt;/p&gt;</comment>
                            <comment id="13590467" author="iamaleksey" created="Fri, 1 Mar 2013 12:39:50 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;d prefer doing the validation in Operation.SetValue directly because that where we have all the other type validation now (and it&apos;s cleaner that way imo), as done in the attached v2.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;wfm, +1&lt;/p&gt;</comment>
                            <comment id="13590516" author="slebresne" created="Fri, 1 Mar 2013 13:30:26 +0000"  >&lt;p&gt;v2 commmitted, thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12571561" name="5300-v2.txt" size="1091" author="slebresne" created="Fri, 1 Mar 2013 10:28:39 +0000"/>
                            <attachment id="12571453" name="5300.txt" size="962" author="aleksey" created="Thu, 28 Feb 2013 19:41:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315147</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 38 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1idrz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315491</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aleksey</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>