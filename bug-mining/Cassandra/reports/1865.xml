<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:35:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-4816] Broken get_paged_slice</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-4816</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;get_paged_slice doesn&apos;t reset the start column filter for the second returned row sometimes. So instead of getting a slice:&lt;/p&gt;

&lt;p&gt;row 0: &amp;lt;start_column&amp;gt;...&amp;lt;last_column_in_row&amp;gt;&lt;br/&gt;
row 1: &amp;lt;first column in a row&amp;gt;...&amp;lt;last_column_in_row&amp;gt;&lt;br/&gt;
row 2: &amp;lt;first column in a row&amp;gt;...&lt;/p&gt;

&lt;p&gt;you sometimes get:&lt;/p&gt;

&lt;p&gt;row 0: &amp;lt;start_column&amp;gt;...&amp;lt;last_column_in_row&amp;gt;&lt;br/&gt;
row 1: &amp;lt;start_column&amp;gt;...&amp;lt;last_column_in_row&amp;gt;&lt;br/&gt;
row 2: &amp;lt;first column in a row&amp;gt;...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12612041">CASSANDRA-4816</key>
            <summary>Broken get_paged_slice</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pkolaczk">Piotr Kolaczkowski</assignee>
                                    <reporter username="pkolaczk">Piotr Kolaczkowski</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Oct 2012 14:21:27 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:25 +0000</updated>
                            <resolved>Wed, 24 Oct 2012 19:48:43 +0000</resolved>
                                        <fixVersion>1.1.7</fixVersion>
                    <fixVersion>1.2.0 beta 2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13477083" author="slebresne" created="Tue, 16 Oct 2012 15:33:18 +0000"  >&lt;p&gt;My bet would be that this is due to the memtable iterator. The way we implement get_paged_slice, we reset the start of the QueryFilter used after the first row have been read. Which means that for each row, we need to make sure the filter is not used until we&apos;ve processed the preceding row. This is the case for the sstable iterator, but not for the memtable one. Attaching patch to change that (I haven&apos;t tested the patch though).&lt;/p&gt;</comment>
                            <comment id="13477120" author="slebresne" created="Tue, 16 Oct 2012 16:14:36 +0000"  >&lt;p&gt;Scratch that patch, brain fart. The AbstractIterator.computeNext() is called no sooner than on hasNext() so we should be good on that front. Still don&apos;t know what is the problem here.&lt;/p&gt;</comment>
                            <comment id="13477180" author="slebresne" created="Tue, 16 Oct 2012 17:23:12 +0000"  >&lt;p&gt;Ok, second attempt. Looking more closing it does seem that this is a problem with the interaction of the mergeIterator and the SSTableScanner. Basically the mergeIterator always needs to know what his &quot;the next row&quot; (during the reducing phase). If that next row was the one that the reducer ended up returning, we were fine (so with 1 sstable or if all sstables had the same rows, it was ok), but otherwise it might end up using the QueryFilter before it should for our get_paged_slice &quot;hack&quot;.&lt;/p&gt;

&lt;p&gt;Anyway, all that the mergeIterator needs during its reduction phase is to know the next key. So attaching a patch that delay the use of the filter until the row data is actually queried.&lt;/p&gt;</comment>
                            <comment id="13477704" author="pkolaczk" created="Wed, 17 Oct 2012 07:52:21 +0000"  >&lt;p&gt;Attaching 3rd version of the patch. LazyColumnIterator is used both for SSTableScanners and Memtable.&lt;br/&gt;
This version works for me.&lt;/p&gt;</comment>
                            <comment id="13483024" author="cdaw" created="Wed, 24 Oct 2012 06:36:12 +0000"  >&lt;p&gt;+1 this version fixes my tests as well.&lt;/p&gt;</comment>
                            <comment id="13483031" author="slebresne" created="Wed, 24 Oct 2012 06:57:01 +0000"  >&lt;p&gt;To be clear, I&apos;m also good on version 3 but I&apos;ll let Jonathan review since I&apos;ve wrote version 2 on which version 3 is based.&lt;/p&gt;</comment>
                            <comment id="13483515" author="jbellis" created="Wed, 24 Oct 2012 19:48:43 +0000"  >&lt;p&gt;LGTM, committed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12549345" name="4816-2.txt" size="3856" author="slebresne" created="Tue, 16 Oct 2012 17:23:12 +0000"/>
                            <attachment id="12549461" name="4816-3.txt" size="7732" author="pkolaczk" created="Wed, 17 Oct 2012 07:52:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pkolaczk]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249001</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 4 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a3ev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56826</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>