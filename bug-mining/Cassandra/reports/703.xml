<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:19:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2076] Not restarting due to Invalid saved cache</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2076</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;This occured on two nodes on me (running 0.7.1 from svn)&lt;/p&gt;

&lt;p&gt;One node was killed by the kernel due to a OOM and the other node was haning and I had to kill it manually with kill -9 (kill didn&apos;t work). (maybe these were faulty hardware nodes, I don&apos;t know)&lt;/p&gt;

&lt;p&gt;The saved_cache was corrupt afterwards and I couldn&apos;t start the nodes. &lt;/p&gt;

&lt;p&gt;After deleting the saved_caches directory I could start the nodes again. &lt;/p&gt;

&lt;p&gt;Instead of not starting when an error occurs, cassandra could simply delete the errornous file and continue to start?&lt;/p&gt;




&lt;p&gt; INFO 22:31:11,570 reading saved cache&lt;br/&gt;
/hd1/cassandra_md5/saved_caches/table_attributes-table_attributes-KeyCache&lt;br/&gt;
ERROR 22:31:11,595 Exception encountered during startup.&lt;br/&gt;
java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
       at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:159)&lt;br/&gt;
       at org.apache.cassandra.dht.OrderPreservingPartitioner.decorateKey(OrderPreservingPartitioner.java:44)&lt;br/&gt;
       at org.apache.cassandra.db.ColumnFamilyStore.readSavedCache(ColumnFamilyStore.java:281)&lt;br/&gt;
       at org.apache.cassandra.db.ColumnFamilyStore.&amp;lt;init&amp;gt;(ColumnFamilyStore.java:218)&lt;br/&gt;
       at org.apache.cassandra.db.ColumnFamilyStore.createColumnFamilyStore(ColumnFamilyStore.java:458)&lt;br/&gt;
       at org.apache.cassandra.db.ColumnFamilyStore.createColumnFamilyStore(ColumnFamilyStore.java:440)&lt;br/&gt;
       at org.apache.cassandra.db.Table.initCf(Table.java:360)&lt;br/&gt;
       at org.apache.cassandra.db.Table.&amp;lt;init&amp;gt;(Table.java:290)&lt;br/&gt;
       at org.apache.cassandra.db.Table.open(Table.java:107)&lt;br/&gt;
       at org.apache.cassandra.service.AbstractCassandraDaemon.setup(AbstractCassandraDaemon.java:167)&lt;br/&gt;
       at org.apache.cassandra.service.AbstractCassandraDaemon.activate(AbstractCassandraDaemon.java:312)&lt;br/&gt;
       at org.apache.cassandra.thrift.CassandraDaemon.main(CassandraDaemon.java:81)&lt;br/&gt;
Caused by: java.nio.charset.MalformedInputException: Input length = 1&lt;br/&gt;
       at java.nio.charset.CoderResult.throwException(CoderResult.java:260)&lt;br/&gt;
       at java.nio.charset.CharsetDecoder.decode(CharsetDecoder.java:781)&lt;br/&gt;
       at org.apache.cassandra.utils.FBUtilities.decodeToUTF8(FBUtilities.java:403)&lt;br/&gt;
       at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:155)&lt;br/&gt;
       ... 11 more&lt;br/&gt;
Exception encountered during startup.&lt;br/&gt;
java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
       at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:159)&lt;br/&gt;
       at org.apache.cassandra.dht.OrderPreservingPartitioner.decorateKey(OrderPreservingPartitioner.java:44)&lt;br/&gt;
       at org.apache.cassandra.db.ColumnFamilyStore.readSavedCache(ColumnFamilyStore.java:281)&lt;br/&gt;
       at org.apache.cassandra.db.ColumnFamilyStore.&amp;lt;init&amp;gt;(ColumnFamilyStore.java:218)&lt;br/&gt;
       at org.apache.cassandra.db.ColumnFamilyStore.createColumnFamilyStore(ColumnFamilyStore.java:458)&lt;br/&gt;
       at org.apache.cassandra.db.ColumnFamilyStore.createColumnFamilyStore(ColumnFamilyStore.java:440)&lt;br/&gt;
       at org.apache.cassandra.db.Table.initCf(Table.java:360)&lt;br/&gt;
       at org.apache.cassandra.db.Table.&amp;lt;init&amp;gt;(Table.java:290)&lt;br/&gt;
       at org.apache.cassandra.db.Table.open(Table.java:107)&lt;br/&gt;
       at org.apache.cassandra.service.AbstractCassandraDaemon.setup(AbstractCassandraDaemon.java:167)&lt;br/&gt;
       at org.apache.cassandra.service.AbstractCassandraDaemon.activate(AbstractCassandraDaemon.java:312)&lt;br/&gt;
       at org.apache.cassandra.thrift.CassandraDaemon.main(CassandraDaemon.java:81)&lt;br/&gt;
Caused by: java.nio.charset.MalformedInputException: Input length = 1&lt;br/&gt;
       at java.nio.charset.CoderResult.throwException(CoderResult.java:260)&lt;br/&gt;
       at java.nio.charset.CharsetDecoder.decode(CharsetDecoder.java:781)&lt;br/&gt;
       at org.apache.cassandra.utils.FBUtilities.decodeToUTF8(FBUtilities.java:403)&lt;br/&gt;
       at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:155)&lt;br/&gt;
       ... 11 more&lt;/p&gt;</description>
                <environment>&lt;p&gt;linux&lt;/p&gt;</environment>
        <key id="12497183">CASSANDRA-2076</key>
            <summary>Not restarting due to Invalid saved cache</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mdennis">Matthew F. Dennis</assignee>
                                    <reporter username="tbritz">Thibaut</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Jan 2011 09:15:17 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:08 +0000</updated>
                            <resolved>Thu, 10 Feb 2011 03:29:26 +0000</resolved>
                                        <fixVersion>0.7.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                            <timeestimate seconds="7200">2h</timeestimate>
                                        <comments>
                            <comment id="12988780" author="tbritz" created="Mon, 31 Jan 2011 15:01:51 +0000"  >&lt;p&gt;This might be related:&lt;/p&gt;

&lt;p&gt;Two other nodes (still running) also show up the &quot;The provided key was not UTF8 encoded.&quot; error in the log.&lt;/p&gt;

&lt;p&gt;I have never seen this error in 0.7.0&lt;/p&gt;


&lt;p&gt;ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:19&amp;#93;&lt;/span&gt; 2011-01-30 21:36:16,951 DebuggableThreadPoolExecutor.java (line 103) Error in ThreadPoolExecutor&lt;br/&gt;
java.lang.RuntimeException: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:34)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;br/&gt;
Caused by: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:159)&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.decorateKey(OrderPreservingPartitioner.java:44)&lt;br/&gt;
        at org.apache.cassandra.db.Table.apply(Table.java:406)&lt;br/&gt;
        at org.apache.cassandra.db.RowMutation.apply(RowMutation.java:190)&lt;br/&gt;
        at org.apache.cassandra.service.StorageProxy$2.runMayThrow(StorageProxy.java:288)&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:30)&lt;br/&gt;
        ... 3 more&lt;br/&gt;
Caused by: java.nio.charset.MalformedInputException: Input length = 1&lt;br/&gt;
        at java.nio.charset.CoderResult.throwException(CoderResult.java:260)&lt;br/&gt;
        at java.nio.charset.CharsetDecoder.decode(CharsetDecoder.java:781)&lt;br/&gt;
        at org.apache.cassandra.utils.FBUtilities.decodeToUTF8(FBUtilities.java:403)&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:155)&lt;br/&gt;
        ... 8 more&lt;br/&gt;
ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:19&amp;#93;&lt;/span&gt; 2011-01-30 21:36:16,991 AbstractCassandraDaemon.java (line 119) Fatal exception in thread Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:19,5,main&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.RuntimeException: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:34)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;br/&gt;
Caused by: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:159)&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.decorateKey(OrderPreservingPartitioner.java:44)&lt;br/&gt;
        at org.apache.cassandra.db.Table.apply(Table.java:406)&lt;br/&gt;
        at org.apache.cassandra.db.RowMutation.apply(RowMutation.java:190)&lt;br/&gt;
        at org.apache.cassandra.service.StorageProxy$2.runMayThrow(StorageProxy.java:288)&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:30)&lt;br/&gt;
        ... 3 more&lt;br/&gt;
Caused by: java.nio.charset.MalformedInputException: Input length = 1&lt;br/&gt;
        at java.nio.charset.CoderResult.throwException(CoderResult.java:260)&lt;br/&gt;
        at java.nio.charset.CharsetDecoder.decode(CharsetDecoder.java:781)&lt;br/&gt;
        at org.apache.cassandra.utils.FBUtilities.decodeToUTF8(FBUtilities.java:403)&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:155)&lt;br/&gt;
        ... 8 more&lt;br/&gt;
 WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;ScheduledTasks:1&amp;#93;&lt;/span&gt; 2011-01-30 21:36:21,450 MessagingService.java (line 506) Dropped 8 MUTATION messages in the last 5000ms&lt;/p&gt;


</comment>
                            <comment id="12988781" author="tbritz" created="Mon, 31 Jan 2011 15:22:19 +0000"  >&lt;p&gt;I brought down and restarted the entire cluster. (100 nodes, 5x20 nodes)&lt;/p&gt;

&lt;p&gt;Every single node complains of an invalid file in the saved_cache directory.&lt;/p&gt;</comment>
                            <comment id="12989160" author="tbritz" created="Tue, 1 Feb 2011 11:20:46 +0000"  >&lt;p&gt;This just happens if you kill the node with -9&lt;/p&gt;</comment>
                            <comment id="12990171" author="jbellis" created="Thu, 3 Feb 2011 16:46:19 +0000"  >&lt;p&gt;The problem is that we&apos;re not cloning the buffer backing the key read from thrift, so we are hitting a problem similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1743&quot; title=&quot;Switch to TFastFramedTransport&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1743&quot;&gt;&lt;del&gt;CASSANDRA-1743&lt;/del&gt;&lt;/a&gt;.  Matt is working on a fix.&lt;/p&gt;</comment>
                            <comment id="12990377" author="mdennis" created="Thu, 3 Feb 2011 23:35:38 +0000"  >&lt;p&gt;attached patch (depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2102&quot; title=&quot;saved row cache doesn&amp;#39;t save the cache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2102&quot;&gt;&lt;del&gt;CASSANDRA-2102&lt;/del&gt;&lt;/a&gt;) allows C* to start when the saved caches are invalid/corrupt.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2102&quot; title=&quot;saved row cache doesn&amp;#39;t save the cache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2102&quot;&gt;&lt;del&gt;CASSANDRA-2102&lt;/del&gt;&lt;/a&gt; prevents the saved caches from becoming corrupt in the first place.&lt;/p&gt;
</comment>
                            <comment id="12990491" author="tbritz" created="Fri, 4 Feb 2011 09:22:27 +0000"  >&lt;p&gt;I was running yesterday&apos;s version with the Consitency fix and getting a similar error messages while reading the commitlog at start. I had to delete the commitlog (data loss) to restart cassandra.&lt;/p&gt;

&lt;p&gt;Is this also related to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2102&quot; title=&quot;saved row cache doesn&amp;#39;t save the cache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2102&quot;&gt;&lt;del&gt;CASSANDRA-2102&lt;/del&gt;&lt;/a&gt; or shall I open a new bug report?&lt;/p&gt;


&lt;p&gt; INFO 23:50:00,922 Replaying /hd1/cassandra_md5/commitlog/CommitLog-1296731219671.log, /hd1/cassandra_md5/commitlog/CommitLog-1296759540149.log, /hd1/cassandra_md5/commitlog/CommitLog-1296760444366.log, /hd1/cassandra_md5/commitlog/CommitLog-1296761120546.log, /hd1/cassandra_md5/commitlog/CommitLog-1296762054192.log, /hd1/cassandra_md5/commitlog/CommitLog-1296773137101.log, /hd1/cassandra_md5/commitlog/CommitLog-1296773242671.log&lt;br/&gt;
 INFO 23:50:02,192 Finished reading /hd1/cassandra_md5/commitlog/CommitLog-1296731219671.log&lt;br/&gt;
ERROR 23:50:02,235 Fatal exception in thread Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;MutationStage:7,5,main&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.RuntimeException: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:34)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)&lt;br/&gt;
        at java.util.concurrent.FutureTask.run(FutureTask.java:138)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;br/&gt;
Caused by: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:159)&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.decorateKey(OrderPreservingPartitioner.java:44)&lt;br/&gt;
        at org.apache.cassandra.db.Table.apply(Table.java:406)&lt;br/&gt;
        at org.apache.cassandra.db.commitlog.CommitLog$2.runMayThrow(CommitLog.java:294)&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:30)&lt;br/&gt;
        ... 6 more&lt;br/&gt;
Caused by: java.nio.charset.MalformedInputException: Input length = 1&lt;br/&gt;
        at java.nio.charset.CoderResult.throwException(CoderResult.java:260)&lt;br/&gt;
        at java.nio.charset.CharsetDecoder.decode(CharsetDecoder.java:781)&lt;br/&gt;
        at org.apache.cassandra.utils.FBUtilities.decodeToUTF8(FBUtilities.java:403)&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:155)&lt;br/&gt;
        ... 10 more&lt;br/&gt;
 INFO 23:50:02,245 Finished reading /hd1/cassandra_md5/commitlog/CommitLog-1296759540149.log&lt;br/&gt;
ERROR 23:50:02,245 Exception encountered during startup.&lt;br/&gt;
java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.lang.RuntimeException: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.utils.FBUtilities.waitOnFutures(FBUtilities.java:455)&lt;br/&gt;
        at org.apache.cassandra.db.commitlog.CommitLog.recover(CommitLog.java:301)&lt;br/&gt;
        at org.apache.cassandra.db.commitlog.CommitLog.recover(CommitLog.java:159)&lt;br/&gt;
        at org.apache.cassandra.service.AbstractCassandraDaemon.setup(AbstractCassandraDaemon.java:166)&lt;br/&gt;
        at org.apache.cassandra.service.AbstractCassandraDaemon.activate(AbstractCassandraDaemon.java:307)&lt;br/&gt;
        at org.apache.cassandra.thrift.CassandraDaemon.main(CassandraDaemon.java:81)&lt;br/&gt;
Caused by: java.util.concurrent.ExecutionException: java.lang.RuntimeException: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)&lt;br/&gt;
        at java.util.concurrent.FutureTask.get(FutureTask.java:83)&lt;br/&gt;
        at org.apache.cassandra.utils.FBUtilities.waitOnFutures(FBUtilities.java:451)&lt;br/&gt;
        ... 5 more&lt;br/&gt;
Caused by: java.lang.RuntimeException: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:34)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)&lt;br/&gt;
        at java.util.concurrent.FutureTask.run(FutureTask.java:138)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;br/&gt;
Caused by: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:159)&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.decorateKey(OrderPreservingPartitioner.java:44)&lt;br/&gt;
        at org.apache.cassandra.db.Table.apply(Table.java:406)&lt;br/&gt;
        at org.apache.cassandra.db.commitlog.CommitLog$2.runMayThrow(CommitLog.java:294)&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:30)&lt;br/&gt;
        ... 6 more&lt;br/&gt;
Caused by: java.nio.charset.MalformedInputException: Input length = 1&lt;br/&gt;
        at java.nio.charset.CoderResult.throwException(CoderResult.java:260)&lt;br/&gt;
        at java.nio.charset.CharsetDecoder.decode(CharsetDecoder.java:781)&lt;br/&gt;
        at org.apache.cassandra.utils.FBUtilities.decodeToUTF8(FBUtilities.java:403)&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:155)&lt;br/&gt;
        ... 10 more&lt;br/&gt;
Exception encountered during startup.&lt;br/&gt;
java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.lang.RuntimeException: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.utils.FBUtilities.waitOnFutures(FBUtilities.java:455)&lt;br/&gt;
        at org.apache.cassandra.db.commitlog.CommitLog.recover(CommitLog.java:301)&lt;br/&gt;
        at org.apache.cassandra.db.commitlog.CommitLog.recover(CommitLog.java:159)&lt;br/&gt;
        at org.apache.cassandra.service.AbstractCassandraDaemon.setup(AbstractCassandraDaemon.java:166)&lt;br/&gt;
        at org.apache.cassandra.service.AbstractCassandraDaemon.activate(AbstractCassandraDaemon.java:307)&lt;br/&gt;
        at org.apache.cassandra.thrift.CassandraDaemon.main(CassandraDaemon.java:81)&lt;br/&gt;
Caused by: java.util.concurrent.ExecutionException: java.lang.RuntimeException: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)&lt;br/&gt;
        at java.util.concurrent.FutureTask.get(FutureTask.java:83)&lt;br/&gt;
        at org.apache.cassandra.utils.FBUtilities.waitOnFutures(FBUtilities.java:451)&lt;br/&gt;
        ... 5 more&lt;br/&gt;
Caused by: java.lang.RuntimeException: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:34)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)&lt;br/&gt;
        at java.util.concurrent.FutureTask.run(FutureTask.java:138)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;br/&gt;
Caused by: java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:159)&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.decorateKey(OrderPreservingPartitioner.java:44)&lt;br/&gt;
        at org.apache.cassandra.db.Table.apply(Table.java:406)&lt;br/&gt;
        at org.apache.cassandra.db.commitlog.CommitLog$2.runMayThrow(CommitLog.java:294)&lt;br/&gt;
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:30)&lt;br/&gt;
        ... 6 more&lt;br/&gt;
Caused by: java.nio.charset.MalformedInputException: Input length = 1&lt;br/&gt;
        at java.nio.charset.CoderResult.throwException(CoderResult.java:260)&lt;br/&gt;
        at java.nio.charset.CharsetDecoder.decode(CharsetDecoder.java:781)&lt;br/&gt;
        at org.apache.cassandra.utils.FBUtilities.decodeToUTF8(FBUtilities.java:403)&lt;br/&gt;
        at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:155)&lt;br/&gt;
        ... 10 more&lt;/p&gt;

</comment>
                            <comment id="12990580" author="jbellis" created="Fri, 4 Feb 2011 15:23:28 +0000"  >&lt;p&gt;It&apos;s a different bug.&lt;/p&gt;

&lt;p&gt;Did you have any nodes down for part of the time (any hinted handoff going on?)&lt;/p&gt;</comment>
                            <comment id="12990583" author="jbellis" created="Fri, 4 Feb 2011 15:32:53 +0000"  >&lt;p&gt;I reverted &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-1743&quot; title=&quot;Switch to TFastFramedTransport&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-1743&quot;&gt;&lt;del&gt;CASSANDRA-1743&lt;/del&gt;&lt;/a&gt; which is what caused &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2102&quot; title=&quot;saved row cache doesn&amp;#39;t save the cache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2102&quot;&gt;&lt;del&gt;CASSANDRA-2102&lt;/del&gt;&lt;/a&gt;.  I suspect it&apos;s causing this other problem too for reasons not yet understood.&lt;/p&gt;</comment>
                            <comment id="12990643" author="tbritz" created="Fri, 4 Feb 2011 17:41:04 +0000"  >&lt;p&gt;I can&apos;t say for sure. I guess so.&lt;/p&gt;

&lt;p&gt;Can you trigger a hudson build with the most recent fixes as well. (Don&apos;t know for sure which revision to take) So I can let it run over the weekend and check if any of the exceptions and bugs (these ones, cpu spike, consistency...) occurs again or not.&lt;/p&gt;

</comment>
                            <comment id="12990695" author="jbellis" created="Fri, 4 Feb 2011 19:41:10 +0000"  >&lt;p&gt;build scheduled&lt;/p&gt;</comment>
                            <comment id="12990895" author="mdennis" created="Sat, 5 Feb 2011 03:03:09 +0000"  >&lt;p&gt;the commit logs have checksums in them to attempt to catch corrupted files.  C* is supposed to log that it is corrupted, skip over it and then continue.  The fact that &lt;b&gt;any&lt;/b&gt; value inside a commit log can cause C* not to start is a bug of it&apos;s own.  I&apos;ve opened &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2113&quot; title=&quot;corrupt commitlogs can prevent C* from starting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2113&quot;&gt;&lt;del&gt;CASSANDRA-2113&lt;/del&gt;&lt;/a&gt; to track this.&lt;/p&gt;</comment>
                            <comment id="12990984" author="jbellis" created="Sat, 5 Feb 2011 13:56:54 +0000"  >&lt;p&gt;v2 is a less-invasive fix to the original problem.&lt;/p&gt;</comment>
                            <comment id="12992230" author="mdennis" created="Tue, 8 Feb 2011 23:19:42 +0000"  >&lt;p&gt;I like the first patch better (recently rebased) as it adds a version field at the top and operates on an actual count instead of using in.available() which is not actually reliable in all cases.&lt;/p&gt;

&lt;p&gt;In addition the rebase fixes a recently introduced bug that prevented the caches from getting saved where BufferedRandomAccessFile doesn&apos;t accept &quot;w&quot; as a mode and adds some comments in CacheWriter about how the totalBytes reported via ICompactionInfo is just an approximation.&lt;/p&gt;

&lt;p&gt;If we don&apos;t want these other changes, +1 on the v2 patch.&lt;/p&gt;</comment>
                            <comment id="12992847" author="jbellis" created="Thu, 10 Feb 2011 03:29:26 +0000"  >&lt;p&gt;I&apos;m not excited about the enumerated cache format change, because the benefit is nominal (if available() is wrong, then the cache is corrupt and we&apos;ll find out soon enough; knowing how many their SHOULD have been is of purely theoretical interest at that point) while the cost is making the cache useless for upgrades, which is the reason it was added in the first place.&lt;/p&gt;

&lt;p&gt;Committed w/o the format change, but with the change to getTotalBytes to take the max of estimated/written.&lt;/p&gt;</comment>
                            <comment id="12992861" author="hudson" created="Thu, 10 Feb 2011 04:34:54 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #273 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Cassandra-0.7/273/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://hudson.apache.org/hudson/job/Cassandra-0.7/273/&lt;/a&gt;)&lt;br/&gt;
    continue starting when invalid savedcache entries are encountered&lt;br/&gt;
patch by mdennis and jbellis for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2076&quot; title=&quot;Not restarting due to Invalid saved cache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2076&quot;&gt;&lt;del&gt;CASSANDRA-2076&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12470637" name="2076-cassandra-0.7.txt" size="6702" author="mdennis" created="Tue, 8 Feb 2011 23:19:42 +0000"/>
                            <attachment id="12470361" name="2076-v2.txt" size="1238" author="jbellis" created="Sat, 5 Feb 2011 13:56:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[mdennis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20430</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0g96f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>92917</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>