<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:38:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5587] BulkLoader fails with NoSuchElementException</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5587</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;When using BulkLoader tool (sstableloader command) to transfer data from a cluster to another, &lt;br/&gt;
a java.util.NoSuchElementException is thrown whenever the directory contains a &quot;snapshot&quot; sub directory,&lt;br/&gt;
and the bulk load fails.&lt;/p&gt;

&lt;p&gt;The fix should be quite simple:&lt;br/&gt;
Catch any NoSuchElementException thrown in &lt;tt&gt;SSTableLoader#openSSTables()&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;The directory structure:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;user@cassandrasrv01:~$ ls /var/lib/cassandra/data/Keyspace1/CF1/
Keyspace1-CF1-ib-1872-CompressionInfo.db
Keyspace1-CF1-ib-1872-Data.db
Keyspace1-CF1-ib-1872-Filter.db
Keyspace1-CF1-ib-1872-Index.db
Keyspace1-CF1-ib-1872-Statistics.db
Keyspace1-CF1-ib-1872-Summary.db
Keyspace1-CF1-ib-1872-TOC.txt
Keyspace1-CF1-ib-2166-CompressionInfo.db
Keyspace1-CF1-ib-2166-Data.db
Keyspace1-CF1-ib-2166-Filter.db
Keyspace1-CF1-ib-2166-Index.db
Keyspace1-CF1-ib-2166-Statistics.db
Keyspace1-CF1-ib-2166-Summary.db
Keyspace1-CF1-ib-2166-TOC.txt
Keyspace1-CF1-ib-5-CompressionInfo.db
Keyspace1-CF1-ib-5-Data.db
Keyspace1-CF1-ib-5-Filter.db
Keyspace1-CF1-ib-5-Index.db
Keyspace1-CF1-ib-5-Statistics.db
Keyspace1-CF1-ib-5-Summary.db
Keyspace1-CF1-ib-5-TOC.txt
...
snapshots
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;The stacktrace: &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;user@cassandrasrv01:~$ ./cassandra/bin/sstableloader -v --debug -d cassandrabck01 /var/lib/cassandra/data/Keyspace1/CF1/
null
java.util.NoSuchElementException
        at java.util.StringTokenizer.nextToken(StringTokenizer.java:349)
        at org.apache.cassandra.io.sstable.Descriptor.fromFilename(Descriptor.java:265)
        at org.apache.cassandra.io.sstable.Component.fromFilename(Component.java:122)
        at org.apache.cassandra.io.sstable.SSTable.tryComponentFromFilename(SSTable.java:194)
        at org.apache.cassandra.io.sstable.SSTableLoader$1.accept(SSTableLoader.java:71)
        at java.io.File.list(File.java:1087)
        at org.apache.cassandra.io.sstable.SSTableLoader.openSSTables(SSTableLoader.java:67)
        at org.apache.cassandra.io.sstable.SSTableLoader.stream(SSTableLoader.java:119)
        at org.apache.cassandra.tools.BulkLoader.main(BulkLoader.java:67)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12648818">CASSANDRA-5587</key>
            <summary>BulkLoader fails with NoSuchElementException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="julien.ayme@gmail.com">Julien Aym&#233;</assignee>
                                    <reporter username="julien.ayme@gmail.com">Julien Aym&#233;</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 May 2013 05:49:24 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:12 +0000</updated>
                            <resolved>Sun, 2 Jun 2013 03:46:11 +0000</resolved>
                                        <fixVersion>1.2.6</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="14400">4h</timeoriginalestimate>
                            <timeestimate seconds="14400">4h</timeestimate>
                                        <comments>
                            <comment id="13663831" author="julien.ayme@gmail.com" created="Wed, 22 May 2013 06:16:08 +0000"  >&lt;p&gt;The proposed patch, made against branch cassandra-1.2&lt;/p&gt;</comment>
                            <comment id="13663866" author="dbrosius" created="Wed, 22 May 2013 06:53:45 +0000"  >&lt;p&gt;the SSTableLoader.openSSTables filenameFilter could immediately ignore directories before even trying SSTable.tryComponentFromFilename. as well.&lt;/p&gt;

&lt;p&gt;ie&lt;/p&gt;

&lt;p&gt;if (new File(dir, name).isDirectory()) return false;&lt;/p&gt;</comment>
                            <comment id="13663870" author="julien.ayme@gmail.com" created="Wed, 22 May 2013 06:59:16 +0000"  >&lt;p&gt;Yes, this is also a valid solution, but there is one use case I could think of which would fail with the same symptom: if a user deliberatly adds other files (like metainfo, ...) in the directory (yes, this is a bad thing to do).&lt;/p&gt;

&lt;p&gt;And nothing prevents us from doing both: immediatly ignore directories, and keep the second safe guard catch NSEE.&lt;/p&gt;</comment>
                            <comment id="13663875" author="julien.ayme@gmail.com" created="Wed, 22 May 2013 07:02:32 +0000"  >&lt;p&gt;Updated patch: both checks are done&lt;/p&gt;</comment>
                            <comment id="13671125" author="dbrosius" created="Fri, 31 May 2013 04:04:47 +0000"  >&lt;p&gt;works as advertised, altho just my nitpick perhaps but not a big fan of catching RuntimeExceptions, i&apos;d rather just prevent them, perhaps Descriptor.fromFilename could just use String.split and early exit if the number of components wasn&apos;t found rather than going thru the morass of using an old school StringTokenizer.&lt;/p&gt;</comment>
                            <comment id="13672314" author="dbrosius" created="Sun, 2 Jun 2013 03:46:11 +0000"  >&lt;p&gt;Committed as c0c1492666e44612ec4f3ca5b47ffcd68e85e210 to cassandra-1.2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12584257" name="cassandra-1.2-5587.txt" size="2534" author="julien.ayme@gmail.com" created="Wed, 22 May 2013 07:02:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[julien.ayme@gmail.com]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>329148</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 25 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ksdz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>329488</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>dbrosius</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[dbrosius]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>