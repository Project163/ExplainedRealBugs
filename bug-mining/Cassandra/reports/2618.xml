<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:42:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-6732] Cross DC writes not compatible 1.2-&gt;1.1 during rolling upgrade</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-6732</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;During a rolling upgrade from 1.1.12 to 1.2.15 one DC at a time only 1/3 of the writes to the first DC to be upgraded actually make it to the other DC, and LOTS of hints attempt to get made.&lt;/p&gt;

&lt;p&gt;Looks like the header for forwarded writes changed from 1.1-&amp;gt;1.2 so the 1.1 nodes can&apos;t read it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12695949">CASSANDRA-6732</key>
            <summary>Cross DC writes not compatible 1.2-&gt;1.1 during rolling upgrade</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jeremiah">Jeremiah Jordan</assignee>
                                    <reporter username="jeremiah">Jeremiah Jordan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Feb 2014 13:17:02 +0000</created>
                <updated>Tue, 14 Oct 2025 12:15:35 +0000</updated>
                            <resolved>Wed, 19 Feb 2014 14:34:53 +0000</resolved>
                                        <fixVersion>1.2.16</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13905405" author="JIRAUSER308715" created="Wed, 19 Feb 2014 13:21:28 +0000"  >&lt;p&gt;Simple fix of not trying to Cross DC forwarding to old nodes attached.  If someone wants they can do a more complicated fix that uses the old 1.1 headers for 1.1 nodes.&lt;/p&gt;</comment>
                            <comment id="13905489" author="jbellis" created="Wed, 19 Feb 2014 14:34:53 +0000"  >&lt;p&gt;Committed.  (The regression was caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3617&quot; title=&quot;Clean up and optimize Message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3617&quot;&gt;&lt;del&gt;CASSANDRA-3617&lt;/del&gt;&lt;/a&gt; splitting FORWARD_HEADER into FORWARD_TO and FORWARD_FROM.)&lt;/p&gt;</comment>
                            <comment id="14103203" author="ssmith" created="Wed, 20 Aug 2014 01:29:19 +0000"  >&lt;p&gt;This week I ran into this problem testing upgrade from 1.1.12 to 1.2.18.  I want to document for others that, as far as I can tell, the attached patch fixes one case but not all.  When the local coordinator wants to relay cross-DC writes through a remote relay, there are 4 cases to consider (based on my tests and reading the code):&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Local coordinator is Cassandra 1.1, remote relay is Cassandra 1.1: &lt;br class=&quot;atl-forced-newline&quot; /&gt; Everything works. The old &quot;FORWARD&quot; header is used as expected.&lt;/li&gt;
	&lt;li&gt;Local coordinator is Cassandra 1.2, remote relay is Cassandra 1.1: &lt;br class=&quot;atl-forced-newline&quot; /&gt; Everything works due to this patch.  The Cassandra 1.2 coordinator will send individual messages to all the remote DC servers.&lt;/li&gt;
	&lt;li&gt;Local coordinator is Cassandra 1.2, remote relay is Cassandra 1.2: &lt;br class=&quot;atl-forced-newline&quot; /&gt; All Cassandra 1.1 servers in the remote DC receive the write but ack to the remote relay instead of the coordinator.  This is because the Cassandra 1.1 servers ignore the new &quot;FWD_FRM&quot; header and, starting with Cassandra 1.2, the relay sets &quot;message.from&quot; to itself on the forwarded messages.  The net effect: writes get applied, but EACH_QUORUM, ALL writes fail due to lost acks.&lt;/li&gt;
	&lt;li&gt;Local coordinator is Cassandra 1.1, remote relay is Cassandra 1.2: &lt;br class=&quot;atl-forced-newline&quot; /&gt; The remote relay ignores the &quot;FORWARD&quot; header and does not forward messages.  The net effect: only the remote relay applies the write, other servers in the remote DC drop the write.  EACH_QUORUM, ALL writes fail and data is left inconsistent, repair is required if hints are lost.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Apologies if I have any mistakes here.  It&apos;s hard to test each combination independently.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12629762" name="0001-Don-t-try-to-do-Cross-DC-forwarding-to-old-nodes.patch" size="1221" author="jjordan" created="Wed, 19 Feb 2014 13:20:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jeremiah]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>374427</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 13 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1sivb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>374727</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326169">1.2.15</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>