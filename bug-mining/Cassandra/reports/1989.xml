<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:36:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5141] Can not insert an empty map.</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5141</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;It is not possible to insert an empty map. It looks like the &quot;{}&quot; is reserved only for Set.&lt;/p&gt;

&lt;p&gt;So when for table:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE TABLE users (
    id text PRIMARY KEY,
    surname text,
    favs map&amp;lt;text, text&amp;gt;
)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I try to insert map without any elements:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh:test&amp;gt; insert into users(id,surname,favs) values(&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;aaa&apos;&lt;/span&gt;,{});
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I get:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; Bad Request: Set operations are only supported on Set typed columns, but org.apache.cassandra.db.marshal.MapType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type) given.
text could not be lexed at line 1, &lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt; 63
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12626959">CASSANDRA-5141</key>
            <summary>Can not insert an empty map.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="krzysztof cieslinski">Krzysztof Cieslinski Cognitum</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Jan 2013 15:29:23 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:19 +0000</updated>
                            <resolved>Fri, 11 Jan 2013 17:01:59 +0000</resolved>
                                        <fixVersion>1.2.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13550936" author="dbrosius" created="Fri, 11 Jan 2013 07:40:07 +0000"  >&lt;p&gt;cql.g&apos;s &lt;/p&gt;

&lt;p&gt;set_literal and map_literal can&apos;t differentiate {} without outside knowledge, and so just choose set.&lt;/p&gt;</comment>
                            <comment id="13551141" author="slebresne" created="Fri, 11 Jan 2013 14:46:02 +0000"  >&lt;p&gt;Yes, the parser can&apos;t distinguish between empty set and empty map, so it always pick empty set and delegate the real choice to when we have type information. Now there used to be code that was handling that in UpdateStatement but it seems to have gone away (haven&apos;t found when but haven&apos;t look very hard).&lt;/p&gt;

&lt;p&gt;Anyway, attaching code that adds back the code to handle that.&lt;/p&gt;</comment>
                            <comment id="13551234" author="jbellis" created="Fri, 11 Jan 2013 16:35:28 +0000"  >&lt;p&gt;s/differenciate/differentiate/&lt;/p&gt;

&lt;p&gt;otherwise +1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13551264" author="slebresne" created="Fri, 11 Jan 2013 17:01:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;s/differenciate/differentiate/&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Damn, my cover is blown. Committed with that fixed, thanks&lt;/p&gt;</comment>
                            <comment id="13573335" author="marcinszymaniuk" created="Thu, 7 Feb 2013 09:23:23 +0000"  >&lt;p&gt;Its letting me to execute the insert with an empty mup but that doesnt really inserting the map. Example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;into&lt;/span&gt; users(id,surname,favs) &lt;span class=&quot;code-keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&apos;key123&apos;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&apos;justAString&apos;&lt;/span&gt;,{});
&lt;span class=&quot;code-keyword&quot;&gt;select&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;from&lt;/span&gt; users &lt;span class=&quot;code-keyword&quot;&gt;where&lt;/span&gt; id=&lt;span class=&quot;code-quote&quot;&gt;&apos;key123&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;id     | favs | surname
--------+------+-------------
key123 | &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; | justAString
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The question is- is this what you aggreed for? Its a bit misleading for me - inserting an empty map means that it has some semantic but I loose it. &lt;/p&gt;

&lt;p&gt;The MapOperation.doPut method doesnt seem to care about empty map at all - its just iterating through a map. If its empty it does nothing.&lt;/p&gt;</comment>
                            <comment id="13573352" author="slebresne" created="Thu, 7 Feb 2013 09:45:33 +0000"  >&lt;p&gt;In Cassandra, an empty map/set/list is equivalent to the column being null. In other words a collection only exists if it has elements. The reason for that semantic (versus having null being different from empty) is honestly mainly dictated by implementation concerns (internally a collection &lt;b&gt;does not&lt;/b&gt; indeed exist unless it has elements). I.e. it&apos;s not because we think it is intrinsically better that way, but it is also true that, at least as far as I&apos;m concern, I don&apos;t think it is intrinsically worst that way either.&lt;/p&gt;</comment>
                            <comment id="13573577" author="marcinszymaniuk" created="Thu, 7 Feb 2013 15:22:10 +0000"  >&lt;p&gt;gotcha, thanks Sylvain&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12564410" name="5141.txt" size="4486" author="slebresne" created="Fri, 11 Jan 2013 14:46:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>303651</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17dhb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>251153</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>