<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:50:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-8245] Cassandra nodes periodically die in 2-DC configuration</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-8245</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;We have 2 DCs with 3 nodes in each.&lt;br/&gt;
Second DC periodically has 1-2 nodes down.&lt;/p&gt;

&lt;p&gt;Looks like it looses connectivity with another nodes and then Gossiper starts to accumulate tasks until Cassandra dies with OOM.&lt;/p&gt;

&lt;p&gt;WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;MemoryMeter:1&amp;#93;&lt;/span&gt; 2014-08-12 14:34:59,803 Memtable.java (line 470) setting live ratio to maximum of 64.0 instead of Infinity&lt;br/&gt;
 WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;GossipTasks:1&amp;#93;&lt;/span&gt; 2014-08-12 14:44:34,866 Gossiper.java (line 637) Gossip stage has 1 pending tasks; skipping status check (no nodes will be marked down)&lt;br/&gt;
 WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;GossipTasks:1&amp;#93;&lt;/span&gt; 2014-08-12 14:44:35,968 Gossiper.java (line 637) Gossip stage has 4 pending tasks; skipping status check (no nodes will be marked down)&lt;br/&gt;
 WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;GossipTasks:1&amp;#93;&lt;/span&gt; 2014-08-12 14:44:37,070 Gossiper.java (line 637) Gossip stage has 8 pending tasks; skipping status check (no nodes will be marked down)&lt;br/&gt;
 WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;GossipTasks:1&amp;#93;&lt;/span&gt; 2014-08-12 14:44:38,171 Gossiper.java (line 637) Gossip stage has 11 pending tasks; skipping status check (no nodes will be marked down)&lt;br/&gt;
...&lt;br/&gt;
WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;GossipTasks:1&amp;#93;&lt;/span&gt; 2014-10-06 21:42:51,575 Gossiper.java (line 637) Gossip stage has 1014764 pending tasks; skipping status check (no nodes will be marked down)&lt;br/&gt;
 WARN &lt;a href=&quot;#13&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;New I/O worker #13&lt;/a&gt; 2014-10-06 21:54:27,010 Slf4JLogger.java (line 76) Unexpected exception in the selector loop.&lt;br/&gt;
java.lang.OutOfMemoryError: Java heap space&lt;/p&gt;

&lt;p&gt;Also those lines but not sure it is relevant:&lt;br/&gt;
DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;GossipStage:1&amp;#93;&lt;/span&gt; 2014-08-12 11:33:18,801 FailureDetector.java (line 338) Ignoring interval time of 2085963047&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Scientific Linux release 6.5&lt;br/&gt;
java version &quot;1.7.0_51&quot;&lt;br/&gt;
Cassandra 2.0.9&lt;/p&gt;</environment>
        <key id="12752436">CASSANDRA-8245</key>
            <summary>Cassandra nodes periodically die in 2-DC configuration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="brandon.williams">Brandon Williams</assignee>
                                    <reporter username="relgames">Oleg Poleshuk</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Nov 2014 14:41:53 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:29 +0000</updated>
                            <resolved>Tue, 6 Jan 2015 15:32:19 +0000</resolved>
                                        <fixVersion>2.0.12</fixVersion>
                    <fixVersion>2.1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14194704" author="mshuler" created="Mon, 3 Nov 2014 16:36:51 +0000"  >&lt;p&gt;What are the hardware specs of your nodes and the memory-related configurations? Nodes that die due to heap exhaustion aren&apos;t really a datacenter issue, but a more basic node-level setup problem that should be addressed with larger machines and configuration tuning, typically.&lt;/p&gt;</comment>
                            <comment id="14194711" author="mshuler" created="Mon, 3 Nov 2014 16:42:55 +0000"  >&lt;p&gt;I asked the devs about this ticket, and a thread dump to see what&apos;s blocking gossip would be very helpful with troubleshooting this.&lt;/p&gt;</comment>
                            <comment id="14194715" author="mshuler" created="Mon, 3 Nov 2014 16:46:55 +0000"  >&lt;p&gt;Additionally, those dates go from 2014-08-12 to 2014-10-06 - are the datacenters communicating properly at all?&lt;/p&gt;</comment>
                            <comment id="14194724" author="relgames" created="Mon, 3 Nov 2014 16:54:51 +0000"  >&lt;p&gt;Processors       =&amp;gt; 8&lt;br/&gt;
Memory           =&amp;gt; 15.58 GB&lt;/p&gt;

&lt;p&gt;processor	: 7&lt;br/&gt;
vendor_id	: GenuineIntel&lt;br/&gt;
cpu family	: 6&lt;br/&gt;
model		: 15&lt;br/&gt;
model name	: Intel(R) Xeon(R) CPU E5-2665 0 @ 2.40GHz&lt;br/&gt;
stepping	: 1&lt;br/&gt;
cpu MHz		: 2400.000&lt;br/&gt;
cache size	: 20480 KB&lt;/p&gt;</comment>
                            <comment id="14194725" author="relgames" created="Mon, 3 Nov 2014 16:55:43 +0000"  >&lt;p&gt;I will provide a thread dump when it dies next time.&lt;/p&gt;</comment>
                            <comment id="14194726" author="relgames" created="Mon, 3 Nov 2014 16:56:59 +0000"  >&lt;p&gt;Why did it go to Minor? Datacenter dies periodically because of Gossiper memory leaks, this is not Minor as to me...&lt;/p&gt;</comment>
                            <comment id="14194729" author="relgames" created="Mon, 3 Nov 2014 16:59:06 +0000"  >&lt;p&gt;Dates go from August because it went down several times. Probably, I grepped previous event.&lt;br/&gt;
Datacenters communicate properly. In any case, isn&apos;t it supposed to survive DC link failure?..&lt;/p&gt;</comment>
                            <comment id="14194735" author="mshuler" created="Mon, 3 Nov 2014 17:03:21 +0000"  >&lt;p&gt;To me, this appears to be symptomatic of something more basic to cluster/node configuration, thus minor. Critical would indicate a reproducible bug causing something like data loss. Provide the steps to reproduce, along with verifiable data loss, and we can talk about the severity  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  It&apos;s just a setting that can be changed to prioritize bugs for developer eyes.&lt;/p&gt;</comment>
                            <comment id="14196143" author="relgames" created="Tue, 4 Nov 2014 14:25:53 +0000"  >&lt;p&gt;So it happened again (not OOM but Gossip pending tasks).&lt;br/&gt;
I ran jstack several times. Not sure if that contains a stacktrace devs need.&lt;br/&gt;
If that is not enough just let me know how I can make a proper dump.&lt;/p&gt;

&lt;p&gt;Stacktraces are attached.&lt;/p&gt;</comment>
                            <comment id="14196227" author="mshuler" created="Tue, 4 Nov 2014 15:32:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; could you take a look at these thread dumps and see if you can find anything interesting?  Thanks!&lt;/p&gt;</comment>
                            <comment id="14212700" author="brandon.williams" created="Fri, 14 Nov 2014 19:33:46 +0000"  >&lt;p&gt;All of these dumps show the nodes blocked on flushing the system table as a result of processing a new node joining, which means that a lot of nodes must be joining.  The interesting message here is:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;DEBUG [GossipStage:1] 2014-08-12 11:33:18,801 FailureDetector.java (line 338) Ignoring interval time of 2085963047
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which means it didn&apos;t see a heartbeat from that node for &lt;b&gt;241 days&lt;/b&gt;, which almost certainly points to a system clock problem of some sort.  I strongly suspect this is environmental, not a bug in Cassandra.&lt;/p&gt;</comment>
                            <comment id="14214638" author="relgames" created="Mon, 17 Nov 2014 13:16:19 +0000"  >&lt;p&gt;There are 6 nodes total: 3 per DC. &lt;br/&gt;
Time difference is 2 seconds between 2 DCs. Within one DC it&apos;s &amp;lt;1 second.&lt;br/&gt;
Anyway, upgraded to 2.1 and the error is gone.&lt;/p&gt;

&lt;p&gt;I would recommend to add an additional debug info to FailureDetector, hostname should be very useful that just &quot;Ignoring interval time &quot;&lt;/p&gt;</comment>
                            <comment id="14261238" author="thinkerfeeler" created="Tue, 30 Dec 2014 16:49:29 +0000"  >&lt;p&gt;We&apos;re getting a similar increase in the number of pending Gossip stage tasks, followed by OutOfMemory.  This happens once a day or so on some node of our 38 node DC.   Other nodes have increases in pending Gossip stage tasks but they recover.   This is with C* 2.0.11.    We have two other DCs. ntpd is running on all nodes. But all nodes on one DC are down now.&lt;/p&gt;

&lt;p&gt;What&apos;s odd is that the cassandra process continues running despite the OutOfMemory exception.  You&apos;d expect it to exit.&lt;/p&gt;

&lt;p&gt;Prior to getting OutOfMemory, I notice that such nodes are slow in responding to commands and queries (e.g., jmx).&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;WARN [GossipTasks:1] 2014-12-26 02:45:06,204 Gossiper.java (line 648) Gossip stage has 2695 pending tasks; skipping status check (no nodes will be marked down)
ERROR [Thread-49234] 2014-12-26 07:18:42,281 CassandraDaemon.java (line 199) Exception in thread Thread[Thread-49234,5,main]
java.lang.OutOfMemoryError: Java heap space
....
ERROR [Thread-49235] 2014-12-26 07:18:42,291 CassandraDaemon.java (line 199) Exception in thread Thread[Thread-49235,5,main]
java.lang.OutOfMemoryError: Java heap space
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14261468" author="thobbs" created="Tue, 30 Dec 2014 20:37:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;What&apos;s odd is that the cassandra process continues running despite the OutOfMemory exception. You&apos;d expect it to exit.&lt;/p&gt;&lt;/blockquote&gt;

&lt;blockquote&gt;&lt;p&gt;Prior to getting OutOfMemory, I notice that such nodes are slow in responding to commands and queries (e.g., jmx).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;OOMs are handled in a better (more consistent) way with &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7507&quot; title=&quot;OOM creates unreliable state - die instantly better&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7507&quot;&gt;&lt;del&gt;CASSANDRA-7507&lt;/del&gt;&lt;/a&gt;.  That ticket may answer a few questions for you.&lt;/p&gt;</comment>
                            <comment id="14266269" author="brandon.williams" created="Tue, 6 Jan 2015 15:32:19 +0000"  >&lt;p&gt;I added the host to the logging.  Since there&apos;s nothing else actionable here, I&apos;m resolving this ticket.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12679218" name="stack1.txt" size="193012" author="relgames" created="Tue, 4 Nov 2014 14:25:53 +0000"/>
                            <attachment id="12679221" name="stack2.txt" size="191210" author="relgames" created="Tue, 4 Nov 2014 14:25:53 +0000"/>
                            <attachment id="12679222" name="stack3.txt" size="199194" author="relgames" created="Tue, 4 Nov 2014 14:25:53 +0000"/>
                            <attachment id="12679219" name="stack4.txt" size="193138" author="relgames" created="Tue, 4 Nov 2014 14:25:53 +0000"/>
                            <attachment id="12679220" name="stack5.txt" size="189510" author="relgames" created="Tue, 4 Nov 2014 14:25:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 46 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21w9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326830">2.0.9</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>