<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:35:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-4648] Unable to start Cassandra with simple authentication enabled</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-4648</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I followed the steps for enabling simple authentication as described here, &lt;a href=&quot;http://www.datastax.com/docs/1.1/configuration/authentication&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.datastax.com/docs/1.1/configuration/authentication&lt;/a&gt;. I tried starting Cassandra with, &lt;/p&gt;

&lt;p&gt;cassandra -f -Dpasswd.properties=conf/passwd.properties -Daccess.properties=conf/access.properties&lt;/p&gt;

&lt;p&gt;Start up failed with this exception in my log:&lt;/p&gt;

&lt;p&gt;ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; 2012-09-11 15:03:04,642 CassandraDaemon.java (line 403) Exception encountered during startup&lt;br/&gt;
java.lang.AssertionError: org.apache.cassandra.exceptions.InvalidRequestException: You have not logged in&lt;br/&gt;
        at org.apache.cassandra.cql3.QueryProcessor.processInternal(QueryProcessor.java:136)&lt;br/&gt;
        at org.apache.cassandra.db.SystemTable.checkHealth(SystemTable.java:298)&lt;br/&gt;
        at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:203)&lt;br/&gt;
        at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:386)&lt;br/&gt;
        at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:429)&lt;br/&gt;
Caused by: org.apache.cassandra.exceptions.InvalidRequestException: You have not logged in&lt;br/&gt;
        at org.apache.cassandra.service.ClientState.validateLogin(ClientState.java:254)&lt;br/&gt;
        at org.apache.cassandra.service.ClientState.hasColumnFamilyAccess(ClientState.java:235)&lt;br/&gt;
        at org.apache.cassandra.cql3.statements.SelectStatement.checkAccess(SelectStatement.java:105)&lt;br/&gt;
        at org.apache.cassandra.cql3.QueryProcessor.processStatement(QueryProcessor.java:106)&lt;br/&gt;
        at org.apache.cassandra.cql3.QueryProcessor.processInternal(QueryProcessor.java:124)&lt;br/&gt;
        ... 4 more&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mac OS X&lt;/p&gt;</environment>
        <key id="12607116">CASSANDRA-4648</key>
            <summary>Unable to start Cassandra with simple authentication enabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="jsanda">John Sanda</reporter>
                        <labels>
                            <label>security</label>
                    </labels>
                <created>Tue, 11 Sep 2012 19:39:37 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:27 +0000</updated>
                            <resolved>Thu, 27 Sep 2012 09:03:34 +0000</resolved>
                                        <fixVersion>1.2.0 beta 2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13453346" author="jbellis" created="Tue, 11 Sep 2012 20:02:34 +0000"  >&lt;p&gt;Related: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4617&quot; title=&quot;OPTIMIZE_LOCAL_REQUESTS=false no longer works&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4617&quot;&gt;&lt;del&gt;CASSANDRA-4617&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think we need to either not use QP internally, or add a compile-and-local-query only mode that skips StorageProxy and auth.&lt;/p&gt;</comment>
                            <comment id="13453947" author="slebresne" created="Wed, 12 Sep 2012 12:32:12 +0000"  >&lt;p&gt;Attaching patch that is so that processInternal skips StorageProxy and authorization (so it also solve &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4617&quot; title=&quot;OPTIMIZE_LOCAL_REQUESTS=false no longer works&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4617&quot;&gt;&lt;del&gt;CASSANDRA-4617&lt;/del&gt;&lt;/a&gt; in particular).&lt;/p&gt;

&lt;p&gt;I&apos;m keen on keeping QP here because we use a mix of cf with and without compact storage internally, and not using QP would get annoying and error prone, while QP already deal with that. Also, collections are another thing that might be painful without QP (I don&apos;t think we have any in the system tables yet but I&apos;m betting we&apos;ll have some soon enough). &lt;/p&gt;</comment>
                            <comment id="13463994" author="jbellis" created="Wed, 26 Sep 2012 17:56:57 +0000"  >&lt;p&gt;Is permissionalteringstatement related or just a refactor that happened to be included in this patch?&lt;/p&gt;

&lt;p&gt;Rest LGTM.&lt;/p&gt;

&lt;p&gt;NB I removed IOException from IM.apply in b781ee7d52c9f30136ae2ce851c4af6def8df38e so you can drop that catch block.&lt;/p&gt;</comment>
                            <comment id="13464525" author="slebresne" created="Thu, 27 Sep 2012 07:32:47 +0000"  >&lt;blockquote&gt;&lt;p&gt;Is permissionalteringstatement related or just a refactor that happened to be included in this patch?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It was meant to make it easier to add executeInternal, i.e. adding it to PermissionAlteringStatement only instead of all its subclasses. And since it factor a few other methods too ...&lt;/p&gt;</comment>
                            <comment id="13464560" author="slebresne" created="Thu, 27 Sep 2012 09:03:34 +0000"  >&lt;p&gt;Alright, committed after rebase (and removal of IOException catch). Thanks&lt;/p&gt;</comment>
                            <comment id="13499526" author="iamaleksey" created="Sat, 17 Nov 2012 21:37:25 +0000"  >&lt;p&gt;We still need something like old processInternal (not restricting queries to the local node). Had to reimplement pre-change processInternal in NativeAuthority (#4874), will have to do the same in NativeAuthenticator unless processInternal gets changed (or another method like it is added).&lt;/p&gt;

&lt;p&gt;It is my understanding that this patch does more than just skipping authorization (which is achieved easier by simply moving isInternall check in has*Access higher, before validateLogin happens).&lt;/p&gt;</comment>
                            <comment id="13499786" author="slebresne" created="Sun, 18 Nov 2012 12:39:17 +0000"  >&lt;p&gt;Yes, authentication was only one small problem, the big one this ticket solvers is that it&apos;s not a good idea to use the normal path (basically everythign related to replication) to write to the System tables (that are not replicated anyway).&lt;/p&gt;

&lt;p&gt;If there is a need to do normal queries but without authentication checks, I would look into subclassing ClientState with no-op authentication methods.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12544811" name="4648.txt" size="28493" author="slebresne" created="Wed, 12 Sep 2012 12:32:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>256315</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 1 week, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gy2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96951</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>