<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:08:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13664] RangeFetchMapCalculator should not try to optimise &apos;trivial&apos; ranges</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13664</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;RangeFetchMapCalculator (&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-4650&quot; title=&quot;RangeStreamer should be smarter when picking endpoints for streaming in case of N &amp;gt;=3 in each DC.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-4650&quot;&gt;&lt;del&gt;CASSANDRA-4650&lt;/del&gt;&lt;/a&gt;) tries to make the number of streams out of each node as even as possible.&lt;/p&gt;

&lt;p&gt;In a typical multi-dc ring the nodes in the dcs are setup using token + 1, creating many tiny ranges. If we only try to optimise over the number of streams, it is likely that the amount of data streamed out of each node is unbalanced.&lt;/p&gt;

&lt;p&gt;We should ignore those trivial ranges and only optimise the big ones, then share the tiny ones over the nodes.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13084534">CASSANDRA-13664</key>
            <summary>RangeFetchMapCalculator should not try to optimise &apos;trivial&apos; ranges</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marcuse">Marcus Eriksson</assignee>
                                    <reporter username="marcuse">Marcus Eriksson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Jul 2017 12:28:26 +0000</created>
                <updated>Fri, 15 May 2020 08:00:47 +0000</updated>
                            <resolved>Mon, 14 Aug 2017 12:35:34 +0000</resolved>
                                        <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16073582" author="krummas" created="Tue, 4 Jul 2017 12:30:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/krummas/cassandra/commits/marcuse/opt_large&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krummas/cassandra/commits/marcuse/opt_large&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;simply filters out ranges considered trivial (less than 1000 tokens for RP and M3P, no trivial ranges for BOP etc), then re-adds them once the optimisation is done.&lt;/p&gt;</comment>
                            <comment id="16075518" author="aweisberg" created="Wed, 5 Jul 2017 22:13:25 +0000"  >&lt;p&gt;I still need to look at this in more detail but isn&apos;t the issue here that the streams aren&apos;t weighted and the decision made by total weight? RFMC is still pretty new to me so I need to look at exactly what is being done there.&lt;/p&gt;</comment>
                            <comment id="16076030" author="krummas" created="Thu, 6 Jul 2017 06:47:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;isn&apos;t the issue here that the streams aren&apos;t weighted&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, that would be a nicer solution. It wasn&apos;t obvious to me how to do maximum bipartite matching with weighted edges though so I went with the easy solution (I guess having an edge for each token would be a way, but that would be quite silly). Also have to say I didn&apos;t spend very much time trying to figure it out, so if you have an idea, please let me know.&lt;/p&gt;</comment>
                            <comment id="16076867" author="aweisberg" created="Thu, 6 Jul 2017 16:43:11 +0000"  >&lt;p&gt;Changes makes sense to me. Can you run the dtests just to sanity check?&lt;/p&gt;</comment>
                            <comment id="16092496" author="krummas" created="Wed, 19 Jul 2017 02:50:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/139/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/139/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16122640" author="jjirsa" created="Fri, 11 Aug 2017 01:09:52 +0000"  >&lt;p&gt;This is marked ready to commit - is it good to go? That dtest run has already expired.&lt;/p&gt;</comment>
                            <comment id="16123270" author="krummas" created="Fri, 11 Aug 2017 12:26:02 +0000"  >&lt;p&gt;rerunning tests&lt;br/&gt;
&lt;a href=&quot;https://circleci.com/gh/krummas/cassandra/68&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://circleci.com/gh/krummas/cassandra/68&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/176&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/view/A-D/view/Cassandra/job/Cassandra-devbranch-dtest/176&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ll try to grab screen shots once they are finished&lt;/p&gt;</comment>
                            <comment id="16125602" author="krummas" created="Mon, 14 Aug 2017 12:24:55 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12881726/12881726_Screen+Shot+2017-08-14+at+14.22.23.png&quot; title=&quot;Screen Shot 2017-08-14 at 14.22.23.png attached to CASSANDRA-13664&quot;&gt;Screen Shot 2017-08-14 at 14.22.23.png&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; - looks like only flaky failures&lt;/p&gt;</comment>
                            <comment id="16125611" author="krummas" created="Mon, 14 Aug 2017 12:35:34 +0000"  >&lt;p&gt;Committed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12881726" name="Screen Shot 2017-08-14 at 14.22.23.png" size="152337" author="marcuse" created="Mon, 14 Aug 2017 12:23:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 14 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h2u7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aweisberg</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aweisberg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>