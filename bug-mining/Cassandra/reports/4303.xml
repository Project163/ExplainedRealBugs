<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:03:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-11152] SOURCE command in CQLSH 3.2 requires that &quot;use keyspace&quot; is in the cql file that you are sourcing</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-11152</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;a difference in behaviour between SOURCE command in CQLSH 3.1 and 3.2. &lt;br/&gt;
In CQLSH 3.1 SOURCE will NOT require &quot;use keyspace&quot; in the cql file that you execute: the &quot;keyspace&quot; directive in the qlshrc file will work and the cql file will be executed.&lt;/p&gt;

&lt;p&gt;In CQLSH 3.2.1, SOURCE command requires that &quot;use keyspace&quot; is in the cql file that you are sourcing, otherwise it throws this error:&lt;br/&gt;
&quot;No keyspace has been specified. USE a keyspace, or explicitly specify keyspace.tablename&quot;. &lt;br/&gt;
The &quot;keyspace&quot; directive in cqlshrc is overridden by source command.&lt;/p&gt;

&lt;p&gt;steps to reproduce:&lt;br/&gt;
create a file called select.cql in your home directory:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;echo &quot;CONSISTENCY ONE;&quot; &amp;gt; select.cql
echo &quot;select * from tab;&quot; &amp;gt;&amp;gt; select.cql
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;in cqlsh:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;create KEYSPACE kspace WITH replication = {&apos;class&apos;: &apos;SimpleStrategy&apos;, &apos;replication_factor&apos;: 1};
create TABLE tab ( id int primary key);
insert into tab (id) VALUES ( 1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add this to cqlsgrc:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[authentication]
keyspace = kspace
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then exit cqlsh and rerun cqlsh using the cqlshrc just modified.&lt;br/&gt;
Note that you are in keyspace &quot;kspace&quot;.&lt;br/&gt;
execute:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;source &apos;select.cql&apos; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;this will have different behaviour in CQLSH 3.2 and 3.1&lt;/p&gt;</description>
                <environment>&lt;p&gt;CQLSH 3.2.1&lt;/p&gt;</environment>
        <key id="12938255">CASSANDRA-11152</key>
            <summary>SOURCE command in CQLSH 3.2 requires that &quot;use keyspace&quot; is in the cql file that you are sourcing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="fanimali">Francesco Animali</reporter>
                        <labels>
                            <label>lhf</label>
                    </labels>
                <created>Wed, 10 Feb 2016 17:44:33 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:42 +0000</updated>
                            <resolved>Wed, 1 Jun 2016 13:38:48 +0000</resolved>
                                        <fixVersion>2.1.15</fixVersion>
                    <fixVersion>2.2.7</fixVersion>
                    <fixVersion>3.0.7</fixVersion>
                    <fixVersion>3.7</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15272091" author="ahattrell" created="Thu, 5 May 2016 08:56:02 +0000"  >&lt;p&gt;The pain point here is that users have maintenance scripts that can be run against multiple keyspaces.  &lt;/p&gt;

&lt;p&gt;Historically they&apos;ve just done the maintenance in sequence:&lt;/p&gt;

&lt;p&gt;use keyspace1 ;&lt;br/&gt;
source &apos;my-script.cql&apos; ;&lt;br/&gt;
use keyspace2 ;&lt;br/&gt;
source &apos;my-script.cql&apos;;&lt;/p&gt;

&lt;p&gt;etc.&lt;/p&gt;

&lt;p&gt;Whilst this seems like a minor issue - it&apos;s actually quite annoying in practise.&lt;/p&gt;</comment>
                            <comment id="15272452" author="snazy" created="Thu, 5 May 2016 14:36:42 +0000"  >&lt;p&gt;I&apos;m not sure, whether it&apos;s an oversight, that the keyspace is not passed to the subshell used for &lt;tt&gt;source&lt;/tt&gt; command.&lt;br/&gt;
If it is an oversight in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6307&quot; title=&quot;Switch cqlsh from cassandra-dbapi2 to python-driver&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6307&quot;&gt;&lt;del&gt;CASSANDRA-6307&lt;/del&gt;&lt;/a&gt;, adding &lt;tt&gt;keyspace = self.keyspace&lt;/tt&gt; to the subshell&apos;s Shell constructor in &lt;tt&gt;Shell#do_source&lt;/tt&gt; should fix it.&lt;br/&gt;
Thoughts?&lt;/p&gt;</comment>
                            <comment id="15307873" author="stefania" created="Tue, 31 May 2016 15:07:06 +0000"  >&lt;p&gt;You&apos;re correct &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snazy&quot; class=&quot;user-hover&quot; rel=&quot;snazy&quot;&gt;snazy&lt;/a&gt;, adding the keyspace parameter to the Shell constructor invocation in &lt;tt&gt;do_source&lt;/tt&gt; fixes it. In fact, I don&apos;t see why we shouldn&apos;t pass &lt;tt&gt;self.current_keyspace&lt;/tt&gt; so that we pick up the current keyspace that has been set by a USE directive, not just the one specified in cqlshrc. Are you happy to review or shall I ask someone else for confirmation of this behavior?&lt;/p&gt;

&lt;p&gt;Patch and cqlsh dtests (still running):&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2.2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.7&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11152-cqlsh-2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11152-cqlsh-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11152-cqlsh-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11152-cqlsh-3.7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/11152-cqlsh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11152-cqlsh-2.1-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11152-cqlsh-2.2-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11152-cqlsh-3.0-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11152-cqlsh-3.7-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-11152-cqlsh-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15307902" author="snazy" created="Tue, 31 May 2016 15:20:45 +0000"  >&lt;p&gt;I&apos;m happy to review. &lt;br/&gt;
Passing the current keyspace to &lt;tt&gt;do_source&lt;/tt&gt; is the correct way IMO as doing something like the following and the script is executed without a current-keyspace is strange.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;USE foo_bar;
SOURCE &lt;span class=&quot;code-quote&quot;&gt;&apos;super_script.cql&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15309340" author="stefania" created="Wed, 1 Jun 2016 05:59:28 +0000"  >&lt;p&gt;Thanks for offering to review and for confirming the approach. CI results are OK: the 2.1 failures also happen on the unpatched branch. The 3.0 cython configuration tests were aborted but the non-cython tests were all successful and it looks like a test environment problem interrupted the cython tests, I&apos;ve restarted them. &lt;/p&gt;

&lt;p&gt;Assuming the 3.0 tests complete successfully, are you OK if I commit this?&lt;/p&gt;</comment>
                            <comment id="15309925" author="snazy" created="Wed, 1 Jun 2016 08:30:25 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15310314" author="stefania" created="Wed, 1 Jun 2016 13:38:04 +0000"  >&lt;p&gt;Thanks, committed to 2.1 as 4008e9bd3fd8b6fca2f3c9f935b9f5dfa97116ad and merged upwards.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2sofz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333872">2.1.12</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>snazy</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[snazy]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>