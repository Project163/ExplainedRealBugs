<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:10:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-14008] RTs at index boundaries in 2.x sstables can create unexpected CQL row in 3.x</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-14008</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In 2.1/2.2, it is possible for a range tombstone that isn&apos;t a row deletion and isn&apos;t a complex deletion to appear between two cells with the same clustering. The 8099 legacy code incorrectly treats the two (non-RT) cells as two distinct CQL rows, despite having the same clustering prefix.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13117589">CASSANDRA-14008</key>
            <summary>RTs at index boundaries in 2.x sstables can create unexpected CQL row in 3.x</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jjirsa">Jeff Jirsa</assignee>
                                    <reporter username="jjirsa">Jeff Jirsa</reporter>
                        <labels>
                            <label>correctness</label>
                    </labels>
                <created>Fri, 10 Nov 2017 14:57:03 +0000</created>
                <updated>Tue, 18 Jun 2019 16:24:59 +0000</updated>
                            <resolved>Tue, 12 Dec 2017 18:00:17 +0000</resolved>
                                        <fixVersion>3.0.16</fixVersion>
                    <fixVersion>3.11.2</fixVersion>
                                    <component>Legacy/Local Write-Read Paths</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="16248976" author="kurtg" created="Sun, 12 Nov 2017 20:09:34 +0000"  >&lt;p&gt;So this kind of sounds like an issue we&apos;ve been investigating, but we&apos;ve had trouble finding the clustering that&apos;s actually causing the problem. Do you have an example to reproduce, or even just an example row to compare with?&lt;/p&gt;

&lt;p&gt;If it&apos;s the same problem we&apos;ve found that in some cases after upgrade to 3.11 the SSTable containing the data will also be corrupt.&lt;/p&gt;</comment>
                            <comment id="16248993" author="jjirsa" created="Sun, 12 Nov 2017 21:26:54 +0000"  >&lt;p&gt;It does create an invalid (or similarly broken)  sstable on compaction/upgradesstables, and while I&apos;ve got a fix for the original problem done, I need to think about the right way to un-break the resulting 3.0 sstable (which should be do-able, based on what I&apos;ve seen so far).&lt;/p&gt;



</comment>
                            <comment id="16249432" author="iamaleksey" created="Mon, 13 Nov 2017 11:41:07 +0000"  >&lt;p&gt;We can probably generate an sstable that triggers this bug relatively easily for a regression test (nice to have, but won&apos;t block the patch on lack of it).&lt;/p&gt;

&lt;p&gt;And, as Jeff mentions, it would be nice to find a way to un-break 3.0 sstables where the damage&apos;s been done already, in a follow-up JIRA.&lt;/p&gt;</comment>
                            <comment id="16273735" author="jjirsa" created="Fri, 1 Dec 2017 00:39:34 +0000"  >&lt;p&gt;The raw patches that fix the bug in LegacyLayout are at &lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Branch &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; CI &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/jeffjirsa/cassandra/tree/cassandra-3.0-14008&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://circleci.com/gh/jeffjirsa/cassandra/tree/cassandra-3.0-14008/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://circleci.com/gh/jeffjirsa/cassandra/tree/cassandra-3.0-14008.svg?style=svg&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://github.com/jeffjirsa/cassandra/tree/cassandra-3.11-14008&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://circleci.com/gh/jeffjirsa/cassandra/tree/cassandra-3.11-14008/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://circleci.com/gh/jeffjirsa/cassandra/tree/cassandra-3.11-14008.svg?style=svg&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I was hoping to actually have a solution to un-breaking the broken 3.0 sstables in the same patch, but it&apos;s proving to be more difficult than I anticipated. I haven&apos;t yet tried to make some sample sstables for regression tests, I agree it&apos;d be nice to have those. &lt;/p&gt;

&lt;p&gt;Please glance at the code, and I&apos;ll work on the regression sstables before committing.&lt;/p&gt;</comment>
                            <comment id="16274298" author="iamaleksey" created="Fri, 1 Dec 2017 11:56:11 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16286449" author="jjirsa" created="Mon, 11 Dec 2017 19:40:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=iamaleksey&quot; class=&quot;user-hover&quot; rel=&quot;iamaleksey&quot;&gt;iamaleksey&lt;/a&gt; can you check both branches for a new regression test please?&lt;/p&gt;

&lt;p&gt;Exact commits are &lt;a href=&quot;https://github.com/jeffjirsa/cassandra/commit/eff1f18fcd80b4860bb5812142d196e94b6ae2a1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeffjirsa/cassandra/commit/eff1f18fcd80b4860bb5812142d196e94b6ae2a1&lt;/a&gt; and &lt;br/&gt;
&lt;a href=&quot;https://github.com/jeffjirsa/cassandra/commit/a85befc4fc3c0e44f6751a3e6472afecaefc4b77&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeffjirsa/cassandra/commit/a85befc4fc3c0e44f6751a3e6472afecaefc4b77&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="16287517" author="iamaleksey" created="Tue, 12 Dec 2017 12:09:39 +0000"  >&lt;p&gt;Validated the test, both logically, and by running &lt;tt&gt;LegacyLayoutTest&lt;/tt&gt; in both branches, with and without the fix reverted, ensuring that it doesn&apos;t fail, then fails, respectively.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16287981" author="jjirsa" created="Tue, 12 Dec 2017 18:00:17 +0000"  >&lt;p&gt;Thanks Aleksey. Committed as &lt;tt&gt;4a2b516a3488ab04ee3338e74397b8c6d69e6d43&lt;/tt&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12987121">CASSANDRA-12144</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jjirsa]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3mnbb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>aleksey</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>