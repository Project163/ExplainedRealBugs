<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:19:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-16479] Materialized Views: incorrect where clause reported for quoted identifiers</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-16479</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;I believe this is a regression from 3.11.&lt;/p&gt;

&lt;p&gt;Given the following schema:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;CREATE TABLE t1 (&quot;theKey&quot; int, &quot;theClustering&quot; int, &quot;theValue&quot; int, PRIMARY KEY (&quot;theKey&quot;, &quot;theClustering&quot;));

CREATE MATERIALIZED VIEW mv1 AS SELECT * FROM t1 WHERE &quot;theKey&quot; IS NOT NULL AND &quot;theClustering&quot; IS NOT NULL AND &quot;theValue&quot; IS NOT NULL  PRIMARY KEY (&quot;theKey&quot;, &quot;theClustering&quot;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And given the following query:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SELECT where_clause FROM system_schema.views ;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With 3.11, I get:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&quot;theKey&quot; IS NOT NULL AND &quot;theClustering&quot; IS NOT NULL AND &quot;theValue&quot; IS NOT NULL
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But with current trunk, I get:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;theKey IS NOT NULL AND theClustering IS NOT NULL AND theValue IS NOT NULL
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note how column names appear in their internal format, not in quoted form.&lt;/p&gt;

&lt;p&gt;Note: the DataStax drivers rely on this info to rebuild the view&apos;s DDL query client-side; generated CQL is currently broken with Cassandra 4.0-trunk.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13362104">CASSANDRA-16479</key>
            <summary>Materialized Views: incorrect where clause reported for quoted identifiers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blerer">Benjamin Lerer</assignee>
                                    <reporter username="adutra">Alexandre Dutra</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Mar 2021 13:45:05 +0000</created>
                <updated>Thu, 11 Mar 2021 17:21:17 +0000</updated>
                            <resolved>Thu, 11 Mar 2021 16:54:44 +0000</resolved>
                                        <fixVersion>4.0-rc1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>CQL/Syntax</component>
                    <component>Feature/Materialized Views</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="17296221" author="blerer" created="Fri, 5 Mar 2021 17:25:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-13426&quot; title=&quot;Make all DDL statements idempotent and not dependent on global state&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-13426&quot;&gt;&lt;del&gt;CASSANDRA-13426&lt;/del&gt;&lt;/a&gt; changed the way the Materialized Views WHERE clause stored in &lt;tt&gt;system_schema.views&lt;/tt&gt; was generated. The code used to generate the WHERE clause text was not relying on method quoting identifiers when needed.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/pull/916&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; CI: &lt;a href=&quot;https://app.circleci.com/pipelines/github/blerer/cassandra/110/workflows/3fa3e242-3164-4757-b18f-14e4682f383f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/blerer/cassandra/110/workflows/9cd65e6d-24f5-455a-9431-815c37c4fab5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="17298079" author="adelapena" created="Tue, 9 Mar 2021 13:53:40 +0000"  >&lt;p&gt;Overall the patch looks good to me, with a few comments:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Perhaps we could add a &lt;tt&gt;toCQLString&lt;/tt&gt; method to both &lt;tt&gt;Relation&lt;/tt&gt; and &lt;tt&gt;CustomIndexExpression&lt;/tt&gt;. These &lt;tt&gt;toCQLString&lt;/tt&gt; methods can be called by &lt;tt&gt;toString&lt;/tt&gt;. Otherwise future changes can miss that the &lt;tt&gt;toString&lt;/tt&gt; implementation is intended to return valid CQL, as it recently happened in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16415&quot; title=&quot;Digest mismatches during upgrade&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16415&quot;&gt;&lt;del&gt;CASSANDRA-16415&lt;/del&gt;&lt;/a&gt;. Also, calls to &lt;tt&gt;toCQLString&lt;/tt&gt; should be explicit, whereas implicit calls to &lt;tt&gt;toString&lt;/tt&gt; from other &lt;tt&gt;toCQLString&lt;/tt&gt; methods are a bit easier to miss.&lt;/li&gt;
	&lt;li&gt;I think there are no tests for the changes in &lt;tt&gt;CustomIndexExpression&lt;/tt&gt;/&lt;tt&gt;QualifiedName&lt;/tt&gt;. Creating tests for custom indexes is tricky, so perhaps that&apos;s something we could do in the followup ticket for &lt;tt&gt;toCQLString&lt;/tt&gt; methods mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16483&quot; title=&quot;ColumnFilter::toString doesn&amp;#39;t return a valid CQL fragment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16483&quot;&gt;&lt;del&gt;CASSANDRA-16483&lt;/del&gt;&lt;/a&gt;.&lt;/li&gt;
	&lt;li&gt;I&apos;d say the CI results look good. I think &lt;a href=&quot;https://app.circleci.com/pipelines/github/blerer/cassandra/110/workflows/9cd65e6d-24f5-455a-9431-815c37c4fab5/jobs/967&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the failure in &lt;tt&gt;ViewTest&lt;/tt&gt;&lt;/a&gt; is not related to the changes, and the upgrade tests have failed because the PR misses the last changes in CircleCI config. We could give it another run after rebasing.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17299609" author="blerer" created="Thu, 11 Mar 2021 14:55:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt; I pushed the changes that you suggested &lt;a href=&quot;https://app.circleci.com/pipelines/github/blerer/cassandra/111/workflows/ccd213e5-d841-4318-a453-3103ed1827f6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/blerer/cassandra/111/workflows/3194f093-399a-4276-a443-25263316fcd9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Regarding the &lt;tt&gt;CustomIndexExpression/QualifiedName&lt;/tt&gt; I think it makes sense to test them in a followup ticket.&lt;/p&gt;</comment>
                            <comment id="17299645" author="adelapena" created="Thu, 11 Mar 2021 15:34:00 +0000"  >&lt;p&gt;Changes look good to me, +1&lt;/p&gt;</comment>
                            <comment id="17299713" author="blerer" created="Thu, 11 Mar 2021 16:54:44 +0000"  >&lt;p&gt;Committed into trunk at 92fe6a37fc79b9c545bccd75b93e5126fd1678e9&lt;/p&gt;</comment>
                            <comment id="17299714" author="blerer" created="Thu, 11 Mar 2021 16:55:01 +0000"  >&lt;p&gt;Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adelapena&quot; class=&quot;user-hover&quot; rel=&quot;adelapena&quot;&gt;adelapena&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13363556">CASSANDRA-16510</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 35 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0o98g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[adelapena]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12348281">4.0-alpha1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/92fe6a37fc79b9c545bccd75b93e5126fd1678e9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/92fe6a37fc79b9c545bccd75b93e5126fd1678e9&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Add a new unit test to check that the problem is fixed for the different supported scenarios&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>