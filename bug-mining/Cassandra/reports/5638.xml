<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:19:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-16474] Multiple python dtest failures after promoting protocol v5 from beta</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-16474</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;After making v5 the default for connections where a preferred protocol version is not specified, a number of python dtests are failing in CI environments.&lt;/p&gt;

&lt;p&gt;The issue appears to be with how the driver handles cases where the bytes read from the client socket doesn&apos;t constitute a complete frame (or to be more specific, the read buffer is exhausted whilst in the middle of reading a frame).&lt;/p&gt;</description>
                <environment></environment>
        <key id="13361910">CASSANDRA-16474</key>
            <summary>Multiple python dtest failures after promoting protocol v5 from beta</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="samt">Sam Tunnicliffe</assignee>
                                    <reporter username="samt">Sam Tunnicliffe</reporter>
                        <labels>
                            <label>protocolv5</label>
                    </labels>
                <created>Tue, 2 Mar 2021 16:34:58 +0000</created>
                <updated>Fri, 10 Oct 2025 08:47:43 +0000</updated>
                            <resolved>Thu, 4 Mar 2021 14:53:58 +0000</resolved>
                                        <fixVersion>4.0-rc1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Messaging/Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17293826" author="beobal" created="Tue, 2 Mar 2021 16:43:26 +0000"  >&lt;p&gt;Candidate driver patch has been produced, running CI now.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/beobal/cassandra/238/workflows/1e121554-3514-4840-a919-d785ee0484f5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Circle JDK8&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/beobal/cassandra/238/workflows/cfc78f97-0700-4e77-853c-411d90dbb11d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Circle JDK11&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch/445/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ci-c.apache.org&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17294499" author="beobal" created="Wed, 3 Mar 2021 12:20:29 +0000"  >&lt;p&gt;Both Circle and Apache CI look much better:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;On the JDK 8 pipeline, all python tests are now green with the exception of one &lt;tt&gt;indev_3.x_to_indev_trunk&lt;/tt&gt; upgrade test. Will check on this after merging and open a new JIRA if necessary.&lt;/li&gt;
	&lt;li&gt;On the JDK 8 pipeline, one in-jvm upgrade failure. Should be fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16415&quot; title=&quot;Digest mismatches during upgrade&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16415&quot;&gt;&lt;del&gt;CASSANDRA-16415&lt;/del&gt;&lt;/a&gt;, which landed in the meantime.&lt;/li&gt;
	&lt;li&gt;On the JDK11 pipeline, one failing python dtest. Looks unrelated, I&apos;ll follow up with a new JIRA.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The &lt;a href=&quot;https://github.com/datastax/python-driver/pull/1100&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;python driver PR&lt;/a&gt; has been merged and the &lt;tt&gt;cassandra-test&lt;/tt&gt; branch updated, so python dtests in CI should start to pass again now. &lt;br/&gt;
 However, we also need to rebuild the &lt;tt&gt;cassandra-testing&lt;/tt&gt; docker images as the previously installed driver includes cython extension modules which don&apos;t get rebuilt when tests are run. These&lt;br/&gt;
 are causing some test failures as they don&apos;t include the latest driver fixes. I&apos;ve opened a PR to exclude the cython extensions from the base image &lt;br/&gt;
 I&apos;ve rebundled the &lt;tt&gt;cassandra-driver-internal-only&lt;/tt&gt; lib in C* and once the images are rebuilt &amp;amp; published, the last thing to do is to run a minimal set of python dtest/cqlsh tests.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Patches&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/cassandra-builds/pull/37/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Cassandra Builds&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/commit/4977bc44639dd8d3d7c1fc4b80b095076f2c5dbc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Cassandra&lt;/a&gt; (trivial)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17294675" author="aholmber" created="Wed, 3 Mar 2021 17:23:19 +0000"  >&lt;p&gt;Tiny take-it-or-leave-it comment on the docker file change.&lt;br/&gt;
+1 overall&lt;/p&gt;</comment>
                            <comment id="17295265" author="beobal" created="Thu, 4 Mar 2021 13:02:10 +0000"  >&lt;p&gt;New docker images have been published, so I&apos;ve updated the circle config files.&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Patches&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/16474-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;2.2&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/16474-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/16474-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/beobal/cassandra/tree/16474-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt; (also includes driver update)&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;I&apos;ve also opened &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-16483&quot; title=&quot;ColumnFilter::toString doesn&amp;#39;t return a valid CQL fragment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-16483&quot;&gt;&lt;del&gt;CASSANDRA-16483&lt;/del&gt;&lt;/a&gt; for the python upgrade test failure, along with a couple of python cql tests with the same proximate cause.&lt;/p&gt;</comment>
                            <comment id="17295319" author="beobal" created="Thu, 4 Mar 2021 14:53:58 +0000"  >&lt;p&gt;Thanks all, committed (the docker change only) to 2.2 in &lt;tt&gt;bad17a891a6df23f1e7698dc1285d031d0900118&lt;/tt&gt; and merged upwards, adding the bundled driver update in trunk.&lt;/p&gt;</comment>
                            <comment id="17296102" author="edimitrova" created="Fri, 5 Mar 2021 15:35:11 +0000"  >&lt;p&gt;Hey Sam,&#160;&lt;/p&gt;

&lt;p&gt;Thank you for taking care of CircleCI config, I was wondering whether this removal was intentional or broken merge:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/2bcba44533ae1b9a67f1fda882c53e8a887656c5#diff-7f0a716b02445f43e77444f81a3a87f7101eda3668a0dd82f61822141d20e2bfL2186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/2bcba44533ae1b9a67f1fda882c53e8a887656c5#diff-7f0a716b02445f43e77444f81a3a87f7101eda3668a0dd82f61822141d20e2bfL2186&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Also, FYI I will open a ticket to update also the midres in trunk. If you want me also to return those stuff, let me know and I can do everything at once later today &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17296139" author="beobal" created="Fri, 5 Mar 2021 16:13:08 +0000"  >&lt;p&gt;Hey Ekaterina, sorry about that.&lt;/p&gt;

&lt;p&gt;I updated the template and regenerated the specific yaml files as per the readme (I&apos;m not sure if that&apos;s outdated now though). I looks like the &lt;tt&gt;utests_system_keyspace_directory&lt;/tt&gt; job was added directly to the &lt;tt&gt;config.yml.XYZ&lt;/tt&gt; files, so it got lost by my doing that. I completely overlooked the &lt;tt&gt;MIDRES&lt;/tt&gt; file sorry. I&apos;ll take care of filing a jira and restoring things to how they were previously.&lt;/p&gt;</comment>
                            <comment id="17296155" author="edimitrova" created="Fri, 5 Mar 2021 16:25:47 +0000"  >&lt;p&gt;No worries, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=samt&quot; class=&quot;user-hover&quot; rel=&quot;samt&quot;&gt;samt&lt;/a&gt;&#160;for looking into it. Let me know if you want me to take care, I will be happy to help &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;

&lt;p&gt;Yes, I think one issue is MIDRES is only on trunk and on the other hand people sometimes update directly the yaml because they miss the readme. It&apos;s a bit confusing&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12983" cascade-level=""><![CDATA[Availability]]></customfieldvalue>
                                <customfieldvalue key="12991" cascade-level="1"><![CDATA[Response Crash]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12970"><![CDATA[Unit Test]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 36 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0o81c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aholmber]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12349335">4.0-beta4</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/bad17a891a6df23f1e7698dc1285d031d0900118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/bad17a891a6df23f1e7698dc1285d031d0900118&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Full CI runs completed, follow up with smaller test runs targetting cql/cqlsh.&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>