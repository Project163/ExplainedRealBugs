<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:04:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-12261] dtest failure in write_failures_test.TestWriteFailures.test_thrift</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-12261</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;example failure:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/job/cassandra-3.9_novnode_dtest/14/testReport/write_failures_test/TestWriteFailures/test_thrift&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/cassandra-3.9_novnode_dtest/14/testReport/write_failures_test/TestWriteFailures/test_thrift&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Failure is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Unexpected error in node3 log, error: 
ERROR [NonPeriodicTasks:1] 2016-07-20 07:09:52,127 LogTransaction.java:205 - Unable to delete /tmp/dtest-CSPEFG/test/node3/data2/system_schema/tables-afddfb9dbc1e30688056eed6c302ba09/mb-2-big-Data.db as it does not exist
Unexpected error in node3 log, error: 
ERROR [NonPeriodicTasks:1] 2016-07-20 07:09:52,334 LogTransaction.java:205 - Unable to delete /tmp/dtest-CSPEFG/test/node3/data2/system_schema/tables-afddfb9dbc1e30688056eed6c302ba09/mb-15-big-Data.db as it does not exist
Unexpected error in node3 log, error: 
ERROR [NonPeriodicTasks:1] 2016-07-20 07:09:52,337 LogTransaction.java:205 - Unable to delete /tmp/dtest-CSPEFG/test/node3/data2/system_schema/tables-afddfb9dbc1e30688056eed6c302ba09/mb-31-big-Data.db as it does not exist
Unexpected error in node3 log, error: 
ERROR [NonPeriodicTasks:1] 2016-07-20 07:09:52,339 LogTransaction.java:205 - Unable to delete /tmp/dtest-CSPEFG/test/node3/data2/system_schema/tables-afddfb9dbc1e30688056eed6c302ba09/mb-18-big-Data.db as it does not exist
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12991488">CASSANDRA-12261</key>
            <summary>dtest failure in write_failures_test.TestWriteFailures.test_thrift</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="philipthompson">Philip Thompson</reporter>
                        <labels>
                            <label>dtest</label>
                    </labels>
                <created>Thu, 21 Jul 2016 14:31:19 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:25 +0000</updated>
                            <resolved>Tue, 30 Aug 2016 01:04:36 +0000</resolved>
                                        <fixVersion>3.10</fixVersion>
                                    <component>Legacy/Local Write-Read Paths</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15387778" author="philipthompson" created="Thu, 21 Jul 2016 14:31:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mambocab&quot; class=&quot;user-hover&quot; rel=&quot;mambocab&quot;&gt;mambocab&lt;/a&gt;, can you take a look? This might just need moved to the bug queue&lt;/p&gt;

&lt;p&gt;EDIT: This test does nothing weird, so I&apos;d like to just have a dev take a look&lt;/p&gt;</comment>
                            <comment id="15396899" author="stefania" created="Thu, 28 Jul 2016 04:35:53 +0000"  >&lt;p&gt;This test seems to have failed only once with this specific failure and it cannot be reproduced locally. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mambocab&quot; class=&quot;user-hover&quot; rel=&quot;mambocab&quot;&gt;mambocab&lt;/a&gt;, are you aware of any other tests with the same problem or a reasonably reliable way to reproduce this?&lt;/p&gt;

&lt;p&gt;The sstable transaction tidier deletes the sstable data file but at present it does not check if the data file exists. I&apos;ve added this check and, if the sstable was not new, a new error message that should tell us if the sstable tidier ran without data file. After all sstable tidiers have run, the transaction tidier does another pass to ensure no content files are left before deleting the actual transaction log file. Here we were missing a folder sync, so I think it&apos;s not 100% impossible that &lt;tt&gt;record.getExistingFiles()&lt;/tt&gt; returned a wrong result including files that were deleted just before by the sstable tidiers, although this wouldn&apos;t explain why only data files were reported as non existing. I&apos;ve added the folder sync call. Unless the same file is involved in two different transactions, which shouldn&apos;t happen, there shouldn&apos;t be any race between the call to record.getExistingFiles() and LogTransaction::delete in LogFile.deleteRecordFiles().&lt;/p&gt;

&lt;p&gt;I&apos;ve also added the exception call stack in LogTransaction.delete(), but only to the debug log file.&lt;/p&gt;

&lt;p&gt;I&apos;ve prepared the patches fro 3.9 and trunk:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.9&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/12261-3.9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/commits/12261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12261-3.9-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12261-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12261-3.9-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-12261-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;This problem could technically happen in 3.0 as well, but I would rather not disrupt 3.0 unless we are sure there is an issue in the first place.&lt;/p&gt;</comment>
                            <comment id="15397687" author="mambocab" created="Thu, 28 Jul 2016 15:30:06 +0000"  >&lt;blockquote&gt;&lt;p&gt;are you aware of any other tests with the same problem or a reasonably reliable way to reproduce this?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No and no, unfortunately.&lt;/p&gt;</comment>
                            <comment id="15398519" author="stefania" created="Fri, 29 Jul 2016 00:55:55 +0000"  >&lt;p&gt;Thanks anyway. Should it happen again, the exception stack trace added by this patch should give us more details.&lt;/p&gt;</comment>
                            <comment id="15445799" author="blerer" created="Mon, 29 Aug 2016 12:58:27 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15447614" author="stefania" created="Tue, 30 Aug 2016 01:04:36 +0000"  >&lt;p&gt;Thank you for the review, committed to trunk as 9ccccf28dc38ec932f9debcecbcb46f41a7f1ffe.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13002174">CASSANDRA-12593</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12819348" name="node1.log" size="39858" author="philipthompson" created="Thu, 21 Jul 2016 14:31:19 +0000"/>
                            <attachment id="12819346" name="node1_debug.log" size="195323" author="philipthompson" created="Thu, 21 Jul 2016 14:31:19 +0000"/>
                            <attachment id="12819347" name="node1_gc.log" size="23464" author="philipthompson" created="Thu, 21 Jul 2016 14:31:19 +0000"/>
                            <attachment id="12819351" name="node2.log" size="63685" author="philipthompson" created="Thu, 21 Jul 2016 14:31:19 +0000"/>
                            <attachment id="12819349" name="node2_debug.log" size="350989" author="philipthompson" created="Thu, 21 Jul 2016 14:31:19 +0000"/>
                            <attachment id="12819350" name="node2_gc.log" size="16380" author="philipthompson" created="Thu, 21 Jul 2016 14:31:19 +0000"/>
                            <attachment id="12819354" name="node3.log" size="64904" author="philipthompson" created="Thu, 21 Jul 2016 14:31:19 +0000"/>
                            <attachment id="12819352" name="node3_debug.log" size="338800" author="philipthompson" created="Thu, 21 Jul 2016 14:31:19 +0000"/>
                            <attachment id="12819353" name="node3_gc.log" size="20321" author="philipthompson" created="Thu, 21 Jul 2016 14:31:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31bof:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>blerer</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>