<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:56:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10006] 2.1 format sstable filenames with &quot;tmp&quot; are not handled by 3.0</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10006</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In 3.0, &lt;tt&gt;Descriptor.fromFilename()&lt;/tt&gt; doesn&apos;t handle &quot;tmp&quot; in sstable filenames in the 2.1 (ka) format.  If you start 3.0 with one of these filenames, you&apos;ll see an exception like the following:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR [main] 2015-08-05 10:15:57,872 CassandraDaemon.java:623 - Exception encountered during startup
java.lang.AssertionError: Invalid file name system-schema_columns-tmp-ka-5-Filter.db in /tmp/dtest-Jstsy2/test/node1/data/system/schema_columns-296e9c049bec3085827dc17d3df2122a
    at org.apache.cassandra.io.sstable.Descriptor.fromFilename(Descriptor.java:291) ~[main/:na]
    at org.apache.cassandra.io.sstable.Descriptor.fromFilename(Descriptor.java:190) ~[main/:na]
    at org.apache.cassandra.service.StartupChecks$7$1.visitFile(StartupChecks.java:226) ~[main/:na]
    at org.apache.cassandra.service.StartupChecks$7$1.visitFile(StartupChecks.java:218) ~[main/:na]
    at java.nio.file.Files.walkFileTree(Files.java:2670) ~[na:1.8.0_45]
    at java.nio.file.Files.walkFileTree(Files.java:2742) ~[na:1.8.0_45]
    at org.apache.cassandra.service.StartupChecks$7.execute(StartupChecks.java:251) ~[main/:na]
    at org.apache.cassandra.service.StartupChecks.verify(StartupChecks.java:103) ~[main/:na]
    at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:163) [main/:na]
    at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:504) [main/:na]
    at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:610) [main/:na]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I can reliably reproduce this with an &lt;a href=&quot;https://github.com/thobbs/cassandra-dtest/blob/8099-backwards-compat/upgrade_tests/cql_tests.py#L5126-L5162&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;upgrade dtest&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-9704&quot; title=&quot;On-wire backward compatibility for 8099&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-9704&quot;&gt;&lt;del&gt;CASSANDRA-9704&lt;/del&gt;&lt;/a&gt;, but it should also be reproducible by simply starting 3.0 with a filename like the one from the error message.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12852628">CASSANDRA-10006</key>
            <summary>2.1 format sstable filenames with &quot;tmp&quot; are not handled by 3.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="thobbs">Tom Hobbs</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Aug 2015 17:10:54 +0000</created>
                <updated>Tue, 14 Oct 2025 12:13:57 +0000</updated>
                            <resolved>Tue, 11 Aug 2015 01:50:19 +0000</resolved>
                                        <fixVersion>3.0 beta 1</fixVersion>
                                    <component>Legacy/Local Write-Read Paths</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14660574" author="yukim" created="Thu, 6 Aug 2015 18:31:13 +0000"  >&lt;p&gt;This is from the change in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7066&quot; title=&quot;Simplify (and unify) cleanup of compaction leftovers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7066&quot;&gt;&lt;del&gt;CASSANDRA-7066&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I think we can just clean up tmps and tmplinks at the start up.&lt;/p&gt;</comment>
                            <comment id="14663283" author="stefania" created="Sun, 9 Aug 2015 06:49:56 +0000"  >&lt;p&gt;What are the valid upgrade paths to 3.0? Can we do 2.1 -&amp;gt; 3.0 and 2.0 -&amp;gt; 3.0 as well? In &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7066&quot; title=&quot;Simplify (and unify) cleanup of compaction leftovers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7066&quot;&gt;&lt;del&gt;CASSANDRA-7066&lt;/del&gt;&lt;/a&gt; I only assumed 2.2 -&amp;gt; 3.0, hence the problem. I do agree there is an issue on folder names though, see &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7066?focusedCommentId=14661942&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14661942&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;this comment&lt;/a&gt;, I&apos;ll fix this. &lt;/p&gt;</comment>
                            <comment id="14679141" author="JIRAUSER308715" created="Sun, 9 Aug 2015 13:25:44 +0000"  >&lt;p&gt;2.1 or 2.2 -&amp;gt; 3.0&lt;/p&gt;</comment>
                            <comment id="14679420" author="stefania" created="Mon, 10 Aug 2015 00:17:04 +0000"  >&lt;p&gt;Thanks Jeremiah.&lt;/p&gt;

&lt;p&gt;I&apos;ve attached a patch that supports 2.1 files as well. The temporary files are deleted at startup when we detect a version upgrade; this was already in place but for 2.2 files only. I&apos;ve also used regular expressions to make the match as accurate as possible.&lt;/p&gt;

&lt;p&gt;CI still pending:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10006-3.0-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10006-3.0-testall/&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10006-3.0-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-10006-3.0-dtest/&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="14679550" author="jbellis" created="Mon, 10 Aug 2015 04:39:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt; to review&lt;/p&gt;</comment>
                            <comment id="14681061" author="yukim" created="Tue, 11 Aug 2015 01:17:49 +0000"  >&lt;p&gt;Patch looks good to me. +1.&lt;/p&gt;

&lt;p&gt;testall/dtest seem not broken by the patch.&lt;br/&gt;
I also ran upgrade dtest Tyler mentioned couple of times with patched version without problem.&lt;/p&gt;</comment>
                            <comment id="14681094" author="yukim" created="Tue, 11 Aug 2015 01:50:19 +0000"  >&lt;p&gt;Committed, thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12709760">CASSANDRA-7066</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ifg7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yukim</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12332361">3.0 alpha 1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>