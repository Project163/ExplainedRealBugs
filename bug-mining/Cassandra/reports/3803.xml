<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:57:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10274] Assertion Errors when interrupting Cleanup</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10274</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Exceptions encountered after Interrupting cleanup on 2.1.7 - logging due to nature. Seen on 2 different nodes. May be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10260&quot; title=&quot;NPE in SSTableReader.invalidateCacheKey&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10260&quot;&gt;&lt;del&gt;CASSANDRA-10260&lt;/del&gt;&lt;/a&gt; . &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;INFO  [CompactionExecutor:5836] 2015-09-06 11:33:39,630 CompactionManager.java:1286 - Compaction interrupted: Cleanup@74bffc10-0fbe-11e5-a5ce-37a8b36fe285(keyspace, table, 44698243387/139158
624314)bytes
INFO  [CompactionExecutor:5838] 2015-09-06 11:33:39,638 CompactionManager.java:1286 - Compaction interrupted: Cleanup@74bffc10-0fbe-11e5-a5ce-37a8b36fe285(keyspace, table, 37886026781/133123
638379)bytes
INFO  [CompactionExecutor:5836] 2015-09-06 11:33:39,639 CompactionManager.java:749 - Cleaning up SSTableReader(path=&lt;span class=&quot;code-quote&quot;&gt;&apos;/mnt/cassandra/data/keyspace/table-74bffc100fbe11e5a5ce37a8b36fe285/keyspace-table-26598-Data.db&apos;&lt;/span&gt;)
ERROR [CompactionExecutor:5838] 2015-09-06 11:33:39,639 CassandraDaemon.java:223 - Exception in thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[CompactionExecutor:5838,1,main]
java.lang.AssertionError: Memory was freed
        at org.apache.cassandra.io.util.SafeMemory.checkBounds(SafeMemory.java:97) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.util.Memory.getInt(Memory.java:281) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.IndexSummary.getPositionInSummary(IndexSummary.java:139) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.IndexSummary.getKey(IndexSummary.java:144) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.IndexSummary.binarySearch(IndexSummary.java:113) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.SSTableReader.getIndexScanPosition(SSTableReader.java:1183) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.SSTableReader.firstKeyBeyond(SSTableReader.java:1667) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.db.compaction.CompactionManager.needsCleanup(CompactionManager.java:693) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.db.compaction.CompactionManager.doCleanupOne(CompactionManager.java:734) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.db.compaction.CompactionManager.access$400(CompactionManager.java:94) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.db.compaction.CompactionManager$5.execute(CompactionManager.java:389) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.db.compaction.CompactionManager$2.call(CompactionManager.java:285) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[na:1.8.0_51]
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[na:1.8.0_51]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_51]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_51]

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [IndexSummaryManager:1] 2015-09-06 09:32:23,346 CassandraDaemon.java:223 - Exception in thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[IndexSummaryManager:1,1,main]
java.lang.AssertionError: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
        at org.apache.cassandra.io.sstable.SSTableReader.setReplacedBy(SSTableReader.java:955) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.SSTableReader.cloneAndReplace(SSTableReader.java:1002) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.SSTableReader.cloneWithNewSummarySamplingLevel(SSTableReader.java:1105) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.IndexSummaryManager.adjustSamplingLevels(IndexSummaryManager.java:421) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.IndexSummaryManager.redistributeSummaries(IndexSummaryManager.java:299) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.IndexSummaryManager.redistributeSummaries(IndexSummaryManager.java:238) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.io.sstable.IndexSummaryManager$1.runMayThrow(IndexSummaryManager.java:139) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at org.apache.cassandra.concurrent.DebuggableScheduledThreadPoolExecutor$UncomplainingRunnable.run(DebuggableScheduledThreadPoolExecutor.java:118) ~[apache-cassandra-2.1.7.jar:2.1.7]
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [na:1.8.0_51]
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) [na:1.8.0_51]
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) [na:1.8.0_51]
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) [na:1.8.0_51]
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [na:1.8.0_51]
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [na:1.8.0_51]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745) [na:1.8.0_51]
ERROR [Reference-Reaper:1] 2015-09-06 09:32:24,891 Ref.java:179 - LEAK DETECTED: a reference (org.apache.cassandra.utils.concurrent.Ref$State@56b339db) to &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.cassandra.io.sstable.SSTableReader$InstanceTidier@1484053885:/mnt/cassandra/data/keyspace/table-74bffc100fbe11e5a5ce37a8b36fe285/keyspace-table-ka-6021 was not released before the reference was garbage collected
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12862093">CASSANDRA-10274</key>
            <summary>Assertion Errors when interrupting Cleanup</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="benedict">Benedict Elliott Smith</assignee>
                                    <reporter username="jjirsa">Jeff Jirsa</reporter>
                        <labels>
                    </labels>
                <created>Sun, 6 Sep 2015 11:51:10 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:57 +0000</updated>
                            <resolved>Tue, 8 Sep 2015 12:48:46 +0000</resolved>
                                        <fixVersion>2.1.10</fixVersion>
                    <fixVersion>2.2.2</fixVersion>
                    <fixVersion>3.0.0 rc1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14732485" author="benedict" created="Sun, 6 Sep 2015 18:08:55 +0000"  >&lt;p&gt;&lt;tt&gt;CompactionManager:291&lt;/tt&gt; is not safe. We must wait for all operations to complete whether or not there are any exceptions, as we must ensure that an sstable remains marked compacting while any operations are running against it.&lt;/p&gt;

&lt;p&gt;It looks to me like both of these exceptions could be explained by this bug. Was there some other exception earlier on in the log?&lt;/p&gt;</comment>
                            <comment id="14733566" author="benedict" created="Mon, 7 Sep 2015 11:31:40 +0000"  >&lt;p&gt;Patch available &lt;a href=&quot;https://github.com/belliottsmith/cassandra/tree/10274-2.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;I&apos;ve also pushed a merge for 2.2 &lt;a href=&quot;https://github.com/belliottsmith/cassandra/tree/10274-2.2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. 2.2 isn&apos;t actually affected by this bug, but it conflicts with changes that fixed it, and in merging I used our newish &lt;tt&gt;Throwables&lt;/tt&gt; static utilities.&lt;/p&gt;</comment>
                            <comment id="14733924" author="krummas" created="Mon, 7 Sep 2015 17:07:18 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14734760" author="benedict" created="Tue, 8 Sep 2015 12:48:46 +0000"  >&lt;p&gt;Thanks. Committed as d769fcb397b6c5937561194b9e8f9dd596ffcd18&lt;/p&gt;

&lt;p&gt;I was a little misbehaved, and snuck in a slightly better cleanup of 2.2+, that is also more robust to unexpected exceptions in &lt;tt&gt;LifecycleTransaction.close&lt;/tt&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[benedict]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 11 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ju1z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12332753">2.1.7</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>marcuse</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[marcuse]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>