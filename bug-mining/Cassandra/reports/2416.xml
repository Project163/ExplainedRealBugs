<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:40:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5957] Cannot drop keyspace Keyspace1 after running cassandra-stress</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5957</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Steps to reproduce:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Set MAX_HEAP=&quot;2G&quot;, HEAP_NEWSIZE=&quot;400M&quot;&lt;/li&gt;
	&lt;li&gt;Run ./cassandra-stress -n 50000 -c 400 -S 256&lt;/li&gt;
	&lt;li&gt;The test should complete despite several warnings about low heap memory.&lt;/li&gt;
	&lt;li&gt;Try to drop keyspace:
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh&amp;gt; drop keyspace Keyspace1;
TSocket read 0 bytes
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;system.log:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; INFO 15:10:46,516 Enqueuing flush of Memtable-schema_columnfamilies@2127258371(0/0 serialized/live bytes, 1 ops)
 INFO 15:10:46,516 Writing Memtable-schema_columnfamilies@2127258371(0/0 serialized/live bytes, 1 ops)
 INFO 15:10:46,690 Completed flushing /var/lib/cassandra/data/system/schema_columnfamilies/system-schema_columnfamilies-ic-6-Data.db (38 bytes) for commitlog position ReplayPosition(segmentId=1377867520699, position=19794574)
 INFO 15:10:46,692 Enqueuing flush of Memtable-schema_columns@1997964959(0/0 serialized/live bytes, 1 ops)
 INFO 15:10:46,693 Writing Memtable-schema_columns@1997964959(0/0 serialized/live bytes, 1 ops)
 INFO 15:10:46,857 Completed flushing /var/lib/cassandra/data/system/schema_columns/system-schema_columns-ic-6-Data.db (38 bytes) for commitlog position ReplayPosition(segmentId=1377867520699, position=19794574)
 INFO 15:10:46,897 Enqueuing flush of Memtable-local@1366216652(98/98 serialized/live bytes, 3 ops)
 INFO 15:10:46,898 Writing Memtable-local@1366216652(98/98 serialized/live bytes, 3 ops)
 INFO 15:10:47,064 Completed flushing /var/lib/cassandra/data/system/local/system-local-ic-12-Data.db (139 bytes) for commitlog position ReplayPosition(segmentId=1377867520699, position=19794845)
 INFO 15:10:48,956 Enqueuing flush of Memtable-local@432522279(46/46 serialized/live bytes, 1 ops)
 INFO 15:10:48,957 Writing Memtable-local@432522279(46/46 serialized/live bytes, 1 ops)
 INFO 15:10:49,132 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 400882073/1094043713)bytes
 INFO 15:10:49,175 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 147514075/645675954)bytes
 INFO 15:10:49,185 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 223249644/609072261)bytes
 INFO 15:10:49,202 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 346471085/990388210)bytes
 INFO 15:10:49,215 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 294748503/2092376617)bytes
 INFO 15:10:49,257 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 692722235/739328646)bytes
 INFO 15:10:49,285 Completed flushing /var/lib/cassandra/data/system/local/system-local-ic-13-Data.db (82 bytes) for commitlog position ReplayPosition(segmentId=1377867520699, position=19794974)
 INFO 15:10:49,286 Compacting [SSTableReader(path=&apos;/var/lib/cassandra/data/system/local/system-local-ic-10-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/system/local/system-local-ic-13-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/system/local/system-local-ic-12-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/system/local/system-local-ic-11-Data.db&apos;)]
ERROR 15:10:49,287 Error occurred during processing of message.
java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.lang.AssertionError: SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-78-Data.db&apos;) was already marked compacted
	at org.apache.cassandra.utils.FBUtilities.waitOnFuture(FBUtilities.java:378)
	at org.apache.cassandra.service.MigrationManager.announce(MigrationManager.java:281)
	at org.apache.cassandra.service.MigrationManager.announceKeyspaceDrop(MigrationManager.java:262)
	at org.apache.cassandra.cql.QueryProcessor.processStatement(QueryProcessor.java:718)
	at org.apache.cassandra.cql.QueryProcessor.process(QueryProcessor.java:775)
	at org.apache.cassandra.thrift.CassandraServer.execute_cql_query(CassandraServer.java:1668)
	at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql_query.getResult(Cassandra.java:4048)
	at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql_query.getResult(Cassandra.java:4036)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:32)
	at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:34)
	at org.apache.cassandra.thrift.CustomTThreadPoolServer$WorkerProcess.run(CustomTThreadPoolServer.java:199)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.util.concurrent.ExecutionException: java.lang.AssertionError: SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-78-Data.db&apos;) was already marked compacted
	at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)
	at java.util.concurrent.FutureTask.get(FutureTask.java:83)
	at org.apache.cassandra.utils.FBUtilities.waitOnFuture(FBUtilities.java:374)
	... 13 more
Caused by: java.lang.AssertionError: SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-78-Data.db&apos;) was already marked compacted
	at org.apache.cassandra.db.DataTracker.removeOldSSTablesSize(DataTracker.java:354)
	at org.apache.cassandra.db.DataTracker.postReplace(DataTracker.java:325)
	at org.apache.cassandra.db.DataTracker.unreferenceSSTables(DataTracker.java:264)
	at org.apache.cassandra.db.ColumnFamilyStore.invalidate(ColumnFamilyStore.java:302)
	at org.apache.cassandra.db.Table.unloadCf(Table.java:314)
	at org.apache.cassandra.db.Table.dropCf(Table.java:296)
	at org.apache.cassandra.db.DefsTable.dropColumnFamily(DefsTable.java:607)
	at org.apache.cassandra.db.DefsTable.mergeColumnFamilies(DefsTable.java:469)
	at org.apache.cassandra.db.DefsTable.mergeSchema(DefsTable.java:355)
	at org.apache.cassandra.service.MigrationManager$2.runMayThrow(MigrationManager.java:299)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	... 3 more
ERROR 15:10:49,287 Exception in thread Thread[MigrationStage:1,5,main]
java.lang.AssertionError: SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-78-Data.db&apos;) was already marked compacted
	at org.apache.cassandra.db.DataTracker.removeOldSSTablesSize(DataTracker.java:354)
	at org.apache.cassandra.db.DataTracker.postReplace(DataTracker.java:325)
	at org.apache.cassandra.db.DataTracker.unreferenceSSTables(DataTracker.java:264)
	at org.apache.cassandra.db.ColumnFamilyStore.invalidate(ColumnFamilyStore.java:302)
	at org.apache.cassandra.db.Table.unloadCf(Table.java:314)
	at org.apache.cassandra.db.Table.dropCf(Table.java:296)
	at org.apache.cassandra.db.DefsTable.dropColumnFamily(DefsTable.java:607)
	at org.apache.cassandra.db.DefsTable.mergeColumnFamilies(DefsTable.java:469)
	at org.apache.cassandra.db.DefsTable.mergeSchema(DefsTable.java:355)
	at org.apache.cassandra.service.MigrationManager$2.runMayThrow(MigrationManager.java:299)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
 INFO 15:10:49,471 Compacted 4 sstables to [/var/lib/cassandra/data/system/local/system-local-ic-14,].  829 bytes to 501 (~60% of original) in 184ms = 0,002597MB/s.  4 total rows, 1 unique.  Row merge counts were {1:0, 2:0, 3:0, 4:1, }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment>&lt;p&gt;Cassandra 1.2.9 freshly built from cassandra-1.2 branch (f5b224cf9aa0f319d51078ef4b78d55e36613963)&lt;/p&gt;</environment>
        <key id="12666319">CASSANDRA-5957</key>
            <summary>Cannot drop keyspace Keyspace1 after running cassandra-stress</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thobbs">Tom Hobbs</assignee>
                                    <reporter username="pkolaczk">Piotr Kolaczkowski</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Aug 2013 13:26:49 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:06 +0000</updated>
                            <resolved>Mon, 14 Oct 2013 09:38:59 +0000</resolved>
                                        <fixVersion>1.2.11</fixVersion>
                    <fixVersion>2.0.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13754703" author="aecobley" created="Fri, 30 Aug 2013 13:51:22 +0000"  >&lt;p&gt;IS this because stress test is creating the keyspace via thrift rather than CQL ?  try running the test with the --enable-cql option and then droping the keyspace ?&lt;/p&gt;</comment>
                            <comment id="13754798" author="pkolaczk" created="Fri, 30 Aug 2013 15:32:44 +0000"  >&lt;p&gt;No. I checked with --enable-cql (after starting from fresh empty /var/lib/cassandra) and the problem still persists.&lt;/p&gt;</comment>
                            <comment id="13754897" author="aecobley" created="Fri, 30 Aug 2013 17:00:12 +0000"  >&lt;p&gt;Did you try deleting the keyspace with cassandra-cli  before running the test with --enable-cql ?&lt;/p&gt;</comment>
                            <comment id="13755434" author="pkolaczk" created="Sat, 31 Aug 2013 05:58:31 +0000"  >&lt;p&gt;Nope. But I can try it for you. However, my intuition tells me it is unrelated &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;So far I tried:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;running cassandra-stress without cql and then dropping from cqlsh / cqlsh -3&lt;/li&gt;
	&lt;li&gt;running cassandra-stress with --enable-cql and then dropping from cqlsh / cqlsh -3&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="13755436" author="pkolaczk" created="Sat, 31 Aug 2013 06:02:15 +0000"  >&lt;p&gt;If I let cassandra-stress write only &lt;b&gt;one&lt;/b&gt; row, deleting keyspace from cqlsh works fine.&lt;br/&gt;
I guess the problem might be compaction that is running long after cassandra-stress finished its work. And dropping keyspace during compaction breaks it. &lt;/p&gt;</comment>
                            <comment id="13755439" author="pkolaczk" created="Sat, 31 Aug 2013 06:29:05 +0000"  >&lt;p&gt;Ok, I tried from cassandra-cli and it worked fine. Not sure if it was a one-time luck so I&apos;ll try once again.&lt;br/&gt;
I tried once again with cqlsh and this time I got a different error:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;INFO 08:26:10,314 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 107063147/625780253)bytes
 INFO 08:26:10,326 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 256225944/1056670573)bytes
 INFO 08:26:10,340 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 256445786/533336692)bytes
 INFO 08:26:10,350 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 369114811/593903163)bytes
ERROR 08:26:10,415 Unable to delete /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-34-Data.db (it will be removed on server restart; we&apos;ll also retry after GC)
ERROR 08:26:10,415 Unable to delete /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-13-Data.db (it will be removed on server restart; we&apos;ll also retry after GC)
ERROR 08:26:10,415 Unable to delete /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-36-Data.db (it will be removed on server restart; we&apos;ll also retry after GC)
ERROR 08:26:10,416 Unable to delete /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-23-Data.db (it will be removed on server restart; we&apos;ll also retry after GC)
ERROR 08:26:10,416 Unable to delete /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-22-Data.db (it will be removed on server restart; we&apos;ll also retry after GC)
 INFO 08:26:10,416 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 794619126/1234742593)bytes
 INFO 08:26:10,548 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 186316188/523663644)bytes
 INFO 08:26:10,604 Compaction interrupted: Compaction@4d331c44-f018-302b-91c2-2dcf94c4bfad(Keyspace1, Standard1, 495853724/605444868)bytes
ERROR 08:26:10,618 Unable to delete /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-30-Data.db (it will be removed on server restart; we&apos;ll also retry after GC)
ERROR 08:26:10,627 Unable to delete /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-15-Data.db (it will be removed on server restart; we&apos;ll also retry after GC)
ERROR 08:26:10,627 Unable to delete /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-14-Data.db (it will be removed on server restart; we&apos;ll also retry after GC)
ERROR 08:26:10,639 Unable to delete /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-29-Data.db (it will be removed on server restart; we&apos;ll also retry after GC)
 INFO 08:26:10,793 Completed flushing /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-92-Data.db (24952067 bytes) for commitlog position ReplayPosition(segmentId=1377929629788, position=10887214)
 INFO 08:26:10,802 Compacting [SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-57-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-83-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-92-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-55-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-91-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-74-Data.db&apos;)]
 INFO 08:26:10,805 Compacted 4 sstables to [/var/lib/cassandra/data/system/schema_keyspaces/system-schema_keyspaces-ic-5,].  529 bytes to 249 (~47% of original) in 872ms = 0,000272MB/s.  6 total rows, 3 unique.  Row merge counts were {1:2, 2:0, 3:0, 4:1, }
 INFO 08:26:10,810 Compacting [SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-48-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-52-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-62-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-68-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-87-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-65-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-31-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-33-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-81-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-45-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-28-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-66-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-69-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-25-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-19-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-21-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-88-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-58-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-84-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-61-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-78-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-72-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-73-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-75-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-64-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-59-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-24-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-46-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-76-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-60-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-80-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-79-Data.db&apos;)]
 INFO 08:26:10,813 Compacting [SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-40-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-56-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-10-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-8-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-50-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-86-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-67-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-49-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-44-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-85-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-26-Data.db&apos;)]
ERROR 08:26:10,815 Exception in thread Thread[CompactionExecutor:4,1,main]
java.lang.RuntimeException: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-31-Data.db (No such file or directory)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:53)
	at org.apache.cassandra.io.sstable.SSTableReader.openDataReader(SSTableReader.java:1212)
	at org.apache.cassandra.io.sstable.SSTableScanner.&amp;lt;init&amp;gt;(SSTableScanner.java:54)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1032)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1044)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:157)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:163)
	at org.apache.cassandra.db.compaction.CompactionTask.runWith(CompactionTask.java:117)
	at org.apache.cassandra.io.util.DiskAwareRunnable.runMayThrow(DiskAwareRunnable.java:48)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	at org.apache.cassandra.db.compaction.CompactionTask.executeInternal(CompactionTask.java:58)
	at org.apache.cassandra.db.compaction.AbstractCompactionTask.execute(AbstractCompactionTask.java:60)
	at org.apache.cassandra.db.compaction.CompactionManager$BackgroundCompactionTask.run(CompactionManager.java:208)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-31-Data.db (No such file or directory)
	at java.io.RandomAccessFile.open(Native Method)
	at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(RandomAccessFile.java:216)
	at org.apache.cassandra.io.util.RandomAccessReader.&amp;lt;init&amp;gt;(RandomAccessReader.java:67)
	at org.apache.cassandra.io.util.ThrottledReader.&amp;lt;init&amp;gt;(ThrottledReader.java:35)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:49)
	... 18 more
ERROR 08:26:10,815 Exception in thread Thread[CompactionExecutor:5,1,main]
java.lang.RuntimeException: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-10-Data.db (No such file or directory)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:53)
	at org.apache.cassandra.io.sstable.SSTableReader.openDataReader(SSTableReader.java:1212)
	at org.apache.cassandra.io.sstable.SSTableScanner.&amp;lt;init&amp;gt;(SSTableScanner.java:54)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1032)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1044)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:157)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:163)
	at org.apache.cassandra.db.compaction.CompactionTask.runWith(CompactionTask.java:117)
	at org.apache.cassandra.io.util.DiskAwareRunnable.runMayThrow(DiskAwareRunnable.java:48)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	at org.apache.cassandra.db.compaction.CompactionTask.executeInternal(CompactionTask.java:58)
	at org.apache.cassandra.db.compaction.AbstractCompactionTask.execute(AbstractCompactionTask.java:60)
	at org.apache.cassandra.db.compaction.CompactionManager$BackgroundCompactionTask.run(CompactionManager.java:208)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-10-Data.db (No such file or directory)
	at java.io.RandomAccessFile.open(Native Method)
	at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(RandomAccessFile.java:216)
	at org.apache.cassandra.io.util.RandomAccessReader.&amp;lt;init&amp;gt;(RandomAccessReader.java:67)
	at org.apache.cassandra.io.util.ThrottledReader.&amp;lt;init&amp;gt;(ThrottledReader.java:35)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:49)
	... 18 more
 INFO 08:26:10,821 Compacting [SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-48-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-52-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-62-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-68-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-87-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-65-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-31-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-33-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-81-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-45-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-28-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-66-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-69-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-25-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-19-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-21-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-88-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-58-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-84-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-61-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-78-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-72-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-73-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-75-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-64-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-59-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-24-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-46-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-76-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-60-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-80-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-79-Data.db&apos;)]
ERROR 08:26:10,822 Exception in thread Thread[CompactionExecutor:8,1,main]
java.lang.RuntimeException: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-31-Data.db (No such file or directory)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:53)
	at org.apache.cassandra.io.sstable.SSTableReader.openDataReader(SSTableReader.java:1212)
	at org.apache.cassandra.io.sstable.SSTableScanner.&amp;lt;init&amp;gt;(SSTableScanner.java:54)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1032)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1044)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:157)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:163)
	at org.apache.cassandra.db.compaction.CompactionTask.runWith(CompactionTask.java:117)
	at org.apache.cassandra.io.util.DiskAwareRunnable.runMayThrow(DiskAwareRunnable.java:48)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	at org.apache.cassandra.db.compaction.CompactionTask.executeInternal(CompactionTask.java:58)
	at org.apache.cassandra.db.compaction.AbstractCompactionTask.execute(AbstractCompactionTask.java:60)
	at org.apache.cassandra.db.compaction.CompactionManager$BackgroundCompactionTask.run(CompactionManager.java:208)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-31-Data.db (No such file or directory)
	at java.io.RandomAccessFile.open(Native Method)
	at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(RandomAccessFile.java:216)
	at org.apache.cassandra.io.util.RandomAccessReader.&amp;lt;init&amp;gt;(RandomAccessReader.java:67)
	at org.apache.cassandra.io.util.ThrottledReader.&amp;lt;init&amp;gt;(ThrottledReader.java:35)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:49)
	... 18 more
ERROR 08:26:10,862 Exception in thread Thread[MigrationStage:1,5,main]
java.lang.RuntimeException: Tried to hard link to file that does not exist /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-28-Index.db
	at org.apache.cassandra.io.util.FileUtils.createHardLink(FileUtils.java:72)
	at org.apache.cassandra.io.sstable.SSTableReader.createLinks(SSTableReader.java:1081)
	at org.apache.cassandra.db.ColumnFamilyStore.snapshotWithoutFlush(ColumnFamilyStore.java:1567)
	at org.apache.cassandra.db.ColumnFamilyStore.snapshot(ColumnFamilyStore.java:1612)
	at org.apache.cassandra.db.DefsTable.dropColumnFamily(DefsTable.java:608)
	at org.apache.cassandra.db.DefsTable.mergeColumnFamilies(DefsTable.java:471)
	at org.apache.cassandra.db.DefsTable.mergeSchema(DefsTable.java:356)
	at org.apache.cassandra.service.MigrationManager$2.runMayThrow(MigrationManager.java:304)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
ERROR 08:26:10,863 Error occurred during processing of message.
java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.lang.RuntimeException: Tried to hard link to file that does not exist /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-28-Index.db
	at org.apache.cassandra.utils.FBUtilities.waitOnFuture(FBUtilities.java:379)
	at org.apache.cassandra.service.MigrationManager.announce(MigrationManager.java:286)
	at org.apache.cassandra.service.MigrationManager.announceKeyspaceDrop(MigrationManager.java:267)
	at org.apache.cassandra.cql.QueryProcessor.processStatement(QueryProcessor.java:718)
	at org.apache.cassandra.cql.QueryProcessor.process(QueryProcessor.java:775)
	at org.apache.cassandra.thrift.CassandraServer.execute_cql_query(CassandraServer.java:1668)
	at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql_query.getResult(Cassandra.java:4048)
	at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql_query.getResult(Cassandra.java:4036)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:32)
	at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:34)
	at org.apache.cassandra.thrift.CustomTThreadPoolServer$WorkerProcess.run(CustomTThreadPoolServer.java:199)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.util.concurrent.ExecutionException: java.lang.RuntimeException: Tried to hard link to file that does not exist /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-28-Index.db
	at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)
	at java.util.concurrent.FutureTask.get(FutureTask.java:83)
	at org.apache.cassandra.utils.FBUtilities.waitOnFuture(FBUtilities.java:375)
	... 13 more
Caused by: java.lang.RuntimeException: Tried to hard link to file that does not exist /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-28-Index.db
	at org.apache.cassandra.io.util.FileUtils.createHardLink(FileUtils.java:72)
	at org.apache.cassandra.io.sstable.SSTableReader.createLinks(SSTableReader.java:1081)
	at org.apache.cassandra.db.ColumnFamilyStore.snapshotWithoutFlush(ColumnFamilyStore.java:1567)
	at org.apache.cassandra.db.ColumnFamilyStore.snapshot(ColumnFamilyStore.java:1612)
	at org.apache.cassandra.db.DefsTable.dropColumnFamily(DefsTable.java:608)
	at org.apache.cassandra.db.DefsTable.mergeColumnFamilies(DefsTable.java:471)
	at org.apache.cassandra.db.DefsTable.mergeSchema(DefsTable.java:356)
	at org.apache.cassandra.service.MigrationManager$2.runMayThrow(MigrationManager.java:304)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	... 3 more
 INFO 08:26:19,760 Compacted 6 sstables to [/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-93,].  137&#160;181&#160;408 bytes to 137&#160;181&#160;408 (~100% of original) in 8&#160;958ms = 14,604419MB/s.  1&#160;248 total rows, 1&#160;248 unique.  Row merge counts were {1:1248, 2:0, 3:0, 4:0, 5:0, 6:0, }
 INFO 08:26:19,765 Compacting [SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-40-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-56-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-10-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-8-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-50-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-86-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-67-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-49-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-44-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-85-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-26-Data.db&apos;)]
ERROR 08:26:19,765 Exception in thread Thread[CompactionExecutor:2,1,main]
java.lang.RuntimeException: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-10-Data.db (No such file or directory)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:53)
	at org.apache.cassandra.io.sstable.SSTableReader.openDataReader(SSTableReader.java:1212)
	at org.apache.cassandra.io.sstable.SSTableScanner.&amp;lt;init&amp;gt;(SSTableScanner.java:54)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1032)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1044)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:157)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:163)
	at org.apache.cassandra.db.compaction.CompactionTask.runWith(CompactionTask.java:117)
	at org.apache.cassandra.io.util.DiskAwareRunnable.runMayThrow(DiskAwareRunnable.java:48)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	at org.apache.cassandra.db.compaction.CompactionTask.executeInternal(CompactionTask.java:58)
	at org.apache.cassandra.db.compaction.AbstractCompactionTask.execute(AbstractCompactionTask.java:60)
	at org.apache.cassandra.db.compaction.CompactionManager$BackgroundCompactionTask.run(CompactionManager.java:208)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-10-Data.db (No such file or directory)
	at java.io.RandomAccessFile.open(Native Method)
	at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(RandomAccessFile.java:216)
	at org.apache.cassandra.io.util.RandomAccessReader.&amp;lt;init&amp;gt;(RandomAccessReader.java:67)
	at org.apache.cassandra.io.util.ThrottledReader.&amp;lt;init&amp;gt;(ThrottledReader.java:35)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:49)
	... 18 more
 INFO 08:26:19,766 Compacting [SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-48-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-52-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-62-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-68-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-87-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-65-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-31-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-33-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-81-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-45-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-28-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-66-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-69-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-25-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-19-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-21-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-88-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-58-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-84-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-61-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-78-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-72-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-73-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-75-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-64-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-59-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-24-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-46-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-76-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-60-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-80-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-79-Data.db&apos;)]
 INFO 08:26:19,769 Compacting [SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-40-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-56-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-10-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-8-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-50-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-86-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-67-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-49-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-44-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-85-Data.db&apos;), SSTableReader(path=&apos;/var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-26-Data.db&apos;)]
ERROR 08:26:19,769 Exception in thread Thread[CompactionExecutor:3,1,main]
java.lang.RuntimeException: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-31-Data.db (No such file or directory)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:53)
	at org.apache.cassandra.io.sstable.SSTableReader.openDataReader(SSTableReader.java:1212)
	at org.apache.cassandra.io.sstable.SSTableScanner.&amp;lt;init&amp;gt;(SSTableScanner.java:54)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1032)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1044)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:157)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:163)
	at org.apache.cassandra.db.compaction.CompactionTask.runWith(CompactionTask.java:117)
	at org.apache.cassandra.io.util.DiskAwareRunnable.runMayThrow(DiskAwareRunnable.java:48)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	at org.apache.cassandra.db.compaction.CompactionTask.executeInternal(CompactionTask.java:58)
	at org.apache.cassandra.db.compaction.AbstractCompactionTask.execute(AbstractCompactionTask.java:60)
	at org.apache.cassandra.db.compaction.CompactionManager$BackgroundCompactionTask.run(CompactionManager.java:208)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-31-Data.db (No such file or directory)
	at java.io.RandomAccessFile.open(Native Method)
	at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(RandomAccessFile.java:216)
	at org.apache.cassandra.io.util.RandomAccessReader.&amp;lt;init&amp;gt;(RandomAccessReader.java:67)
	at org.apache.cassandra.io.util.ThrottledReader.&amp;lt;init&amp;gt;(ThrottledReader.java:35)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:49)
	... 18 more
ERROR 08:26:19,771 Exception in thread Thread[CompactionExecutor:1,1,main]
java.lang.RuntimeException: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-10-Data.db (No such file or directory)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:53)
	at org.apache.cassandra.io.sstable.SSTableReader.openDataReader(SSTableReader.java:1212)
	at org.apache.cassandra.io.sstable.SSTableScanner.&amp;lt;init&amp;gt;(SSTableScanner.java:54)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1032)
	at org.apache.cassandra.io.sstable.SSTableReader.getDirectScanner(SSTableReader.java:1044)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:157)
	at org.apache.cassandra.db.compaction.AbstractCompactionStrategy.getScanners(AbstractCompactionStrategy.java:163)
	at org.apache.cassandra.db.compaction.CompactionTask.runWith(CompactionTask.java:117)
	at org.apache.cassandra.io.util.DiskAwareRunnable.runMayThrow(DiskAwareRunnable.java:48)
	at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
	at org.apache.cassandra.db.compaction.CompactionTask.executeInternal(CompactionTask.java:58)
	at org.apache.cassandra.db.compaction.AbstractCompactionTask.execute(AbstractCompactionTask.java:60)
	at org.apache.cassandra.db.compaction.CompactionManager$BackgroundCompactionTask.run(CompactionManager.java:208)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.io.FileNotFoundException: /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-10-Data.db (No such file or directory)
	at java.io.RandomAccessFile.open(Native Method)
	at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(RandomAccessFile.java:216)
	at org.apache.cassandra.io.util.RandomAccessReader.&amp;lt;init&amp;gt;(RandomAccessReader.java:67)
	at org.apache.cassandra.io.util.ThrottledReader.&amp;lt;init&amp;gt;(ThrottledReader.java:35)
	at org.apache.cassandra.io.util.ThrottledReader.open(ThrottledReader.java:49)
	... 18 more

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13755440" author="pkolaczk" created="Sat, 31 Aug 2013 06:30:23 +0000"  >&lt;p&gt;And on the cqlsh side:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;pkolaczk@m4600:~/Projekty/datastax/cassandra$ bin/cqlsh 
Connected to Test Cluster at 127.0.0.1:9160.
[cqlsh 3.1.7 | Cassandra 0.0.0 | CQL spec 2.0.0 | Thrift protocol 19.36.0]
Use HELP for help.
cqlsh&amp;gt; drop keyspace Keyspace1;
TSocket read 0 bytes
cqlsh&amp;gt; drop keyspace Keyspace1;
TSocket read 0 bytes
cqlsh&amp;gt; drop keyspace Keyspace1;
Traceback (most recent call last):
  File &quot;bin/cqlsh&quot;, line 1038, in perform_statement_untraced
    self.cursor.execute(statement, decoder=decoder)
  File &quot;bin/../lib/cql-internal-only-1.4.0.zip/cql-1.4.0/cql/cursor.py&quot;, line 80, in execute
    response = self.get_response(prepared_q, cl)
  File &quot;bin/../lib/cql-internal-only-1.4.0.zip/cql-1.4.0/cql/thrifteries.py&quot;, line 80, in get_response
    return self.handle_cql_execution_errors(doquery, compressed_q, compress)
  File &quot;bin/../lib/cql-internal-only-1.4.0.zip/cql-1.4.0/cql/thrifteries.py&quot;, line 96, in handle_cql_execution_errors
    return executor(*args, **kwargs)
  File &quot;bin/../lib/cql-internal-only-1.4.0.zip/cql-1.4.0/cql/cassandra/Cassandra.py&quot;, line 1741, in execute_cql_query
    self.send_execute_cql_query(query, compression)
  File &quot;bin/../lib/cql-internal-only-1.4.0.zip/cql-1.4.0/cql/cassandra/Cassandra.py&quot;, line 1751, in send_execute_cql_query
    self._oprot.trans.flush()
  File &quot;bin/../lib/thrift-python-internal-only-0.7.0.zip/thrift/transport/TTransport.py&quot;, line 293, in flush
    self.__trans.write(buf)
  File &quot;bin/../lib/thrift-python-internal-only-0.7.0.zip/thrift/transport/TSocket.py&quot;, line 117, in write
    plus = self.handle.send(buff)
error: [Errno 32] Broken pipe


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13755442" author="pkolaczk" created="Sat, 31 Aug 2013 06:32:04 +0000"  >&lt;p&gt;After this I cannot also drop it from cassandra-cli:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
pkolaczk@m4600:~/Projekty/datastax/cassandra$ bin/cassandra-cli
Column Family assumptions read from /home/pkolaczk/.cassandra/assumptions.json
Connected to: &quot;Test Cluster&quot; on 127.0.0.1/9160
Welcome to Cassandra CLI version 1.2.9-SNAPSHOT

Type &apos;help;&apos; or &apos;?&apos; for help.
Type &apos;quit;&apos; or &apos;exit;&apos; to quit.

[default@unknown] drop keyspace Keyspace1;
null
org.apache.thrift.transport.TTransportException
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:84)
	at org.apache.thrift.transport.TFramedTransport.readFrame(TFramedTransport.java:129)
	at org.apache.thrift.transport.TFramedTransport.read(TFramedTransport.java:101)
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:84)
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:378)
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:297)
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:204)
	at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:69)
	at org.apache.cassandra.thrift.Cassandra$Client.recv_system_drop_keyspace(Cassandra.java:1437)
	at org.apache.cassandra.thrift.Cassandra$Client.system_drop_keyspace(Cassandra.java:1424)
	at org.apache.cassandra.cli.CliClient.executeDelKeySpace(CliClient.java:1364)
	at org.apache.cassandra.cli.CliClient.executeCLIStatement(CliClient.java:249)
	at org.apache.cassandra.cli.CliMain.processStatementInteractive(CliMain.java:213)
	at org.apache.cassandra.cli.CliMain.main(CliMain.java:339)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13755555" author="aecobley" created="Sat, 31 Aug 2013 17:01:52 +0000"  >&lt;p&gt;I&apos;m having trouble reproducing this myself.  Can you post your cluster size, OS and java version ?&lt;/p&gt;</comment>
                            <comment id="13755581" author="pkolaczk" created="Sat, 31 Aug 2013 19:17:00 +0000"  >&lt;p&gt;Ubuntu Linux 13.04, single node&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java version &quot;1.6.0_45&quot;
Java(TM) SE Runtime Environment (build 1.6.0_45-b06)
Java HotSpot(TM) 64-Bit Server VM (build 20.45-b01, mixed mode)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13755582" author="pkolaczk" created="Sat, 31 Aug 2013 19:23:09 +0000"  >&lt;p&gt;Attaching system.log from the whole last run.&lt;/p&gt;</comment>
                            <comment id="13756097" author="pkolaczk" created="Mon, 2 Sep 2013 14:20:13 +0000"  >&lt;p&gt;Today I got this on C* 1.2.6 dse 3.1.2. Slightly different exception, but maybe will be helpful:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR 16:16:37,702 Error occurred during processing of message.
java.lang.RuntimeException: java.util.concurrent.ExecutionException: java.lang.RuntimeException: Tried to hard link to file that does not exist /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-64-Statistics.db
	at org.apache.cassandra.utils.FBUtilities.waitOnFuture(FBUtilities.java:378)
	at org.apache.cassandra.service.MigrationManager.announce(MigrationManager.java:281)
	at org.apache.cassandra.service.MigrationManager.announceKeyspaceDrop(MigrationManager.java:262)
	at org.apache.cassandra.cql3.statements.DropKeyspaceStatement.announceMigration(DropKeyspaceStatement.java:60)
	at org.apache.cassandra.cql3.statements.SchemaAlteringStatement.execute(SchemaAlteringStatement.java:73)
	at org.apache.cassandra.cql3.QueryProcessor.processStatement(QueryProcessor.java:145)
	at org.apache.cassandra.cql3.QueryProcessor.process(QueryProcessor.java:162)
	at org.apache.cassandra.thrift.CassandraServer.execute_cql3_query(CassandraServer.java:1714)
	at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql3_query.getResult(Cassandra.java:4074)
	at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql3_query.getResult(Cassandra.java:4062)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:32)
	at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:34)
	at org.apache.cassandra.thrift.CustomTThreadPoolServer$WorkerProcess.run(CustomTThreadPoolServer.java:201)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.util.concurrent.ExecutionException: java.lang.RuntimeException: Tried to hard link to file that does not exist /var/lib/cassandra/data/Keyspace1/Standard1/Keyspace1-Standard1-ic-64-Statistics.db
	at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)
	at java.util.concurrent.FutureTask.get(FutureTask.java:83)
	at org.apache.cassandra.utils.FBUtilities.waitOnFuture(FBUtilities.java:374)
	... 15 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13790914" author="thobbs" created="Wed, 9 Oct 2013 22:10:15 +0000"  >&lt;p&gt;Quick summary of the problem: when the table is dropped, there are multiple ongoing compactions.  When handling the table drop, DataTracker first builds a view of non-compacting sstables.  Meanwhile, the compaction tasks get cancelled, and as part of the cleanup, it marks the sstables as compacted (because the column family is no longer valid).  Then the DataTracker finally tries to mark the sstables in its view as compacted, hitting the failing assertion.  Additionally, when a compaction task is cancelled, it doesn&apos;t unreference the sstables involved, and since the DataTracker ignored compacting sstables, they never get unreferenced (even if the failing assertion is disabled).&lt;/p&gt;

&lt;p&gt;5957-1.2-v1.patch (and &lt;a href=&quot;https://github.com/thobbs/cassandra/tree/CASSANDRA-5957&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;) uses the simplest fix I could think of, which is to block the table drop operation until all compactions on that table have stopped (either normally, because of an error, or because they saw the stop signal).  This way, when the DataTracker cleans up sstables as part of the drop operation, there are no compacting sstables.&lt;/p&gt;</comment>
                            <comment id="13791122" author="jbellis" created="Thu, 10 Oct 2013 02:45:02 +0000"  >&lt;p&gt;I think we have a problem still.  We could have a compaction started by another thread after we stop the existing ones.  This requires the schema to be fetched before the purge, then the thread to be suspended until after we purge and stop compactions.  Rare, but possible.&lt;/p&gt;

&lt;p&gt;Turns out it was truncate I was thinking of that changed in 2.0.  What we did there was introduce CFS.runWithCompactionsDisabled to avoid this race.&lt;/p&gt;

&lt;p&gt;So you might want to backport that (d72e9381 for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3430&quot; title=&quot;Break Big Compaction Lock apart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3430&quot;&gt;&lt;del&gt;CASSANDRA-3430&lt;/del&gt;&lt;/a&gt; &amp;#8211; I don&apos;t remember if this introduced bugs that we fixed in later commits.  Quite possible) but it&apos;s a bit involved.&lt;/p&gt;

&lt;p&gt;I think there&apos;s a similar problem with flushing.  With truncate we don&apos;t care (if new writes arrive after the truncate starts, we&apos;re totally fine with having them survive; in fact, that&apos;s desirable) but we might care here.&lt;/p&gt;

&lt;p&gt;All things considered I suspect it will be simpler to fix the cleanup race rather than try to lock down everything for the drop.&lt;/p&gt;</comment>
                            <comment id="13793021" author="thobbs" created="Fri, 11 Oct 2013 20:33:39 +0000"  >&lt;p&gt;5957-1.2-v2.patch (and &lt;a href=&quot;https://github.com/thobbs/cassandra/tree/CASSANDRA-5957-v2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;) disables the &quot;was not marked compacted&quot; assertion when cleaning up sstables for a dropped table and unreferences sstables when compaction tasks finish (or are interrupted) if the table has been dropped.&lt;/p&gt;

&lt;p&gt;Regarding flushing, a blocking flush is forced after unregistering the CF but prior to the CFS being invalidated (which is when sstables get unreferenced), so we shouldn&apos;t see a similar problem there (and I haven&apos;t seen one while testing this).&lt;/p&gt;</comment>
                            <comment id="13794013" author="jbellis" created="Mon, 14 Oct 2013 09:39:05 +0000"  >&lt;p&gt;LGTM; committed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12607668" name="5957-1.2-v1.patch" size="7103" author="thobbs" created="Wed, 9 Oct 2013 22:10:15 +0000"/>
                            <attachment id="12608067" name="5957-1.2-v2.patch" size="4211" author="thobbs" created="Fri, 11 Oct 2013 20:33:39 +0000"/>
                            <attachment id="12600956" name="system.log" size="706506" author="pkolaczk" created="Sat, 31 Aug 2013 19:23:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>346258</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 6 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1npjr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>346559</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>