<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:02:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10990] Support streaming of older version sstables in 3.0</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10990</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;In 2.0 we introduced support for streaming older versioned sstables (&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5772&quot; title=&quot;Support streaming of SSTables created in older version&amp;#39;s format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5772&quot;&gt;&lt;del&gt;CASSANDRA-5772&lt;/del&gt;&lt;/a&gt;).  In 3.0, because of the rewrite of the storage layer, this became no longer supported.  So currently, while 3.0 can read sstables in the 2.1/2.2 format, it cannot stream the older versioned sstables.  We should do some work to make this still possible to be consistent with what &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5772&quot; title=&quot;Support streaming of SSTables created in older version&amp;#39;s format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5772&quot;&gt;&lt;del&gt;CASSANDRA-5772&lt;/del&gt;&lt;/a&gt; provided.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12928704">CASSANDRA-10990</key>
            <summary>Support streaming of older version sstables in 3.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pauloricardomg">Paulo Motta</assignee>
                                    <reporter username="jeromatron">Jeremy Hanna</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Jan 2016 18:42:41 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:45 +0000</updated>
                            <resolved>Thu, 17 Mar 2016 16:07:34 +0000</resolved>
                                        <fixVersion>3.0.5</fixVersion>
                    <fixVersion>3.5</fixVersion>
                                    <component>Legacy/Streaming and Messaging</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="15101817" author="pauloricardomg" created="Fri, 15 Jan 2016 14:18:30 +0000"  >&lt;p&gt;Attaching 3.0 patch for initial feedback. Main changes were:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Deserialize from old format and serialize in new format on legacy &lt;tt&gt;ClusteringPrefix&lt;/tt&gt; serializer&lt;/li&gt;
	&lt;li&gt;Skip deserialization of &lt;tt&gt;SerializationHeader&lt;/tt&gt; for pre-3.0 streamed sstables&lt;/li&gt;
	&lt;li&gt;Create stats-less &lt;tt&gt;SerializationHeader&lt;/tt&gt; on &lt;tt&gt;SSTableWriter&lt;/tt&gt; if 3.0 serialization header is not present.
	&lt;ul&gt;
		&lt;li&gt;What&apos;s the practical consequence of this? Does it make any difference to collect stats while appending rows to the writer or is this already done somewhere internally?&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Extended &lt;tt&gt;LegacySSTableTest&lt;/tt&gt; to test streaming of older version sstables. However, I think this test suite is not comprehensive enough, testing only some basic scenarios. I plan to extend this suite with a combination of the following features:
	&lt;ul&gt;
		&lt;li&gt;Compact Storage&lt;/li&gt;
		&lt;li&gt;Static columns&lt;/li&gt;
		&lt;li&gt;Tombstones&lt;/li&gt;
		&lt;li&gt;Complex types&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Patch and tests below:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.0...pauloricardomg:3.0-10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10990-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10990-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt; could you have a look? I&apos;m not completely familiarized with new sstable format, so please let me know of any unaddressed detail I might have missed and other edge cases that would be interesting to test/address. Thanks!&lt;/p&gt;</comment>
                            <comment id="15110707" author="slebresne" created="Thu, 21 Jan 2016 14:55:08 +0000"  >&lt;p&gt;The problem will be compact tables. With them, old nodes have their cells for declared columns intermingled with other cells and we need to get all the former ones first for the new format (as they become static columns). When reading old sstables, we end up having to sometimes double read partitions during compaction (thankfully it&apos;s only for some tables and it&apos;s a one time thing) and do some tricks for reads (which are too long to explain here but one can look at &lt;tt&gt;ThriftResultsMerger&lt;/tt&gt; if interested).&lt;/p&gt;

&lt;p&gt;Anyway, we can&apos;t easily do this for streaming. The only viable solution I can see would be to first write all the &quot;dynamic&quot; cells to some temporary location collecting the &quot;static&quot; ones while doing it, then writing the static ones and then copying back the dynamic ones. Doable, though it&apos;s getting complicated.&lt;/p&gt;

&lt;p&gt;I also want to note that streaming sstables is in itself useless. What we care is the features that use streaming, i.e. bootstrap, moving and repair. And at least for repair, this won&apos;t work out of the box because 3.0 don&apos;t compute the same digest than 2.X nodes. Now, 3.0 nodes are actually able to compute the 2.X ones (which we use for digest queries), but we need to add the code so they pick the right version to compute. As for bootstrap/moving, they &quot;should&quot; work out of the box in mixed cluster (providing streaming works) but we&apos;ve changed enough in 3.0, including with schemas, that we need a good battery of tests before claiming it does.&lt;/p&gt;

&lt;p&gt;So anyway, we can likely solve all those problems, but it&apos;s worth noting that this ticket is probably a rather big one if you include the testing necessary (and I think it&apos;s better to say &quot;sorry but you can&apos;t do streaming based operations during upgrade&quot; than pretending it works but having it break easily in practice).&lt;/p&gt;</comment>
                            <comment id="15112830" author="pauloricardomg" created="Fri, 22 Jan 2016 18:33:42 +0000"  >&lt;p&gt;Many thanks for the detailed explanation and clarification &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;I believe the purpose of this ticket is more to allow streaming of old sstables to 3.0 vnodes via &lt;tt&gt;sstableloader&lt;/tt&gt; as well as support bootstrap and move on 3.0 nodes that did not complete &lt;tt&gt;upgradesstables&lt;/tt&gt; (dense nodes) than to actually provide full 2.x-3.0 streaming compatibility (we can leave this to &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8110&quot; title=&quot;Make streaming forward &amp;amp; backwards compatible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8110&quot;&gt;CASSANDRA-8110&lt;/a&gt;). There seems to be additional complications with repair due to different digest formats, so we can address that in a separate ticket if necessary.&lt;/p&gt;

&lt;p&gt;I was able to achieve streaming of pre-3.0 sstables fairly transparently with the addition of a &lt;tt&gt;RewindableDataInputStreamPlus&lt;/tt&gt; wrapper input stream that allows rewinding a source stream, so we can leverage the exactly same code path of reading pre-3.0 sstables (&lt;tt&gt;OldFormatIterator&lt;/tt&gt;) to do the static compact table handling. Currently, the &lt;tt&gt;RewindableDataInputStreamPlus&lt;/tt&gt; works in memory, so next step is to spill the buffer to disk if its sizes goes above a certain treshold.&lt;/p&gt;

&lt;p&gt;I agree we need to do extensive testing before calling this supported. I propose to extend &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10563&quot; title=&quot;Integrate new upgrade test into dtest upgrade suite&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10563&quot;&gt;&lt;del&gt;CASSANDRA-10563&lt;/del&gt;&lt;/a&gt; upgrade dtests to perform a bootstrap of a new node, without performing &lt;tt&gt;upgradesstables&lt;/tt&gt; on upgraded nodes (so they will contain only old sstables), and check that all streamed data will be readable via thrift and/or cql.&lt;/p&gt;

&lt;p&gt;I updated the previous branch with the latest changes.&lt;/p&gt;</comment>
                            <comment id="15134391" author="pauloricardomg" created="Fri, 5 Feb 2016 16:18:44 +0000"  >&lt;p&gt;Initial version is ready for review. Feedback on approach and correctness will be greatly appreciated.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Patch Overview&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;The patch adds support for streaming pre-3.0 sstables and a comprehensive test suite around it. Adding support to non-static-compact tables was simple, basically wokaround the lack of serialization header by using a header with no stats and deserialize clustering prefix with old format deserializer while serializing in new format.&lt;/p&gt;

&lt;p&gt;The main challenge was to provide support to streaming compact static tables, because in the new format the static columns must be the first columns in a partition while in the previous format they can be in any position of the partition. This means that each partition must be traversed to search for static columns and then rewinded to search for remaining non-static columns.&lt;/p&gt;

&lt;p&gt;In order to solve this I added a new &lt;tt&gt;CachedInputStream&lt;/tt&gt; that adds mark/reset functionality to a source stream and allows to cooperatively cascade multiple &lt;tt&gt;CachedInputStream&lt;/tt&gt; with different capacities to create an input stream cache hierarchy. For instance, I used this feature on &lt;tt&gt;StreamDeserializer&lt;/tt&gt; for pre-3.0 sstables that uses a &lt;tt&gt;MemoryCachedInputStream&lt;/tt&gt; that falls back to a &lt;tt&gt;FileCachedInputStream&lt;/tt&gt; when it runs out of capacity in memory. The &lt;tt&gt;FileCachedInputStream&lt;/tt&gt; may write a temporary buffer file to a data directory and remove it once the file is successfully streamed or if it fails.&lt;/p&gt;

&lt;p&gt;This approach allow us to use the &lt;tt&gt;OldFormatDeserializer&lt;/tt&gt; transparently, and the same code path for reading pre-3.0 sstables is used to stream pre-3.0 sstables. Note that the &lt;tt&gt;CachedInputStream&lt;/tt&gt; is only used to stream pre-3.0 sstables in order to provide rewind functionality and will not affect existing behavior.&lt;/p&gt;

&lt;p&gt;Please note that performance was not the objective here, but mostly support streaming functionality of pre-3.0 sstables. Compact static tables may suffer a slight performance hit due to buffer copying and rewinding, but non-compact static tables will not have performance affected since the stream cache will not be used.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Tests&lt;/b&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;b&gt;Unit tests&lt;/b&gt;: Extended &lt;tt&gt;LegacySStableTest&lt;/tt&gt; to test streaming of legacy compact sstables since jb version.
	&lt;ul&gt;
		&lt;li&gt;Add comprehensive test suite for different &lt;tt&gt;CachedInputStream&lt;/tt&gt; variants on &lt;tt&gt;RewindableDataInputStreamPlusTest&lt;/tt&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;SStable loader dtests&lt;/b&gt;: Extended &lt;tt&gt;sstable_generation_loading_test&lt;/tt&gt; to sstableload 2.1 (ka) sstables with different compression settings.&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;Upgrade dtests&lt;/b&gt;: Extended &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10563&quot; title=&quot;Integrate new upgrade test into dtest upgrade suite&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10563&quot;&gt;&lt;del&gt;CASSANDRA-10563&lt;/del&gt;&lt;/a&gt; upgrade dtests to bootstrap soon after upgrading, to test bootstrap streaming of legacy sstables.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;TODO&lt;/b&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Cleanup of leftover buffer files on startup.&lt;/li&gt;
	&lt;li&gt;Improve documentation of &lt;tt&gt;CachedInputStream&lt;/tt&gt;, &lt;tt&gt;MemoryCachedInputStream&lt;/tt&gt; and &lt;tt&gt;FileCachedInputStream&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Make max memory buffer size a system property and change it on dtests&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;LegacySSTableTest&lt;/tt&gt; passes when executed individually but fails when executed on a suite, probably some leftovers from previous test that need to be cleaned up.&lt;/li&gt;
	&lt;li&gt;Add la sstables to &lt;tt&gt;sstable_generation_loading_test&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Fix &lt;tt&gt;upgrade_8099_test.py:TestBootstrapAfterUpgrade.upgrade_with_wide_partition_test&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.0...pauloricardomg:10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/riptano/cassandra-dtest/compare/master...pauloricardomg:10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-10990-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-10990-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=philipthompson&quot; class=&quot;user-hover&quot; rel=&quot;philipthompson&quot;&gt;philipthompson&lt;/a&gt; when you have time, could you please setup a custom dtest run with the dtest branch above? Thanks!&lt;/p&gt;</comment>
                            <comment id="15134400" author="philipthompson" created="Fri, 5 Feb 2016 16:21:59 +0000"  >&lt;p&gt;Running at &lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10990-dtest/3/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10990-dtest/3/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15135308" author="yukim" created="Sat, 6 Feb 2016 00:06:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt; Over all, I like your approach.&lt;/p&gt;

&lt;p&gt;I&apos;m still looking through your code, and commented some on github, I have one quesitons for now.&lt;/p&gt;

&lt;p&gt;What&apos;s the difference between &lt;tt&gt;MemoryCachedInputStream&lt;/tt&gt; and &lt;tt&gt;BufferedInputStream&lt;/tt&gt;? Why can&apos;t we use the latter? &lt;tt&gt;MemoryCachedInputStream&lt;/tt&gt; uses default &lt;tt&gt;ByteArrayOutputStream&lt;/tt&gt; constructor which has only size of 32 bytes. Isn&apos;t this too small to use for cache?&lt;/p&gt;</comment>
                            <comment id="15141660" author="pauloricardomg" created="Wed, 10 Feb 2016 21:02:47 +0000"  >&lt;p&gt;Thanks for the comments &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;What&apos;s the difference between MemoryCachedInputStream and BufferedInputStream? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The main difference between &lt;tt&gt;MemoryCachedInputStream&lt;/tt&gt; and &lt;tt&gt;BufferedInputStream&lt;/tt&gt; is that the former has the ability to mark/reset a parent/source stream when it runs out of capacity without losing its mark state, allowing us to cascade a &lt;tt&gt;FileCachedInputStream&lt;/tt&gt; with a &lt;tt&gt;MemoryCachedInputStream&lt;/tt&gt; to provide a multi-tiered cached input stream.&lt;/p&gt;

&lt;p&gt;Another less relevant difference is that &lt;tt&gt;BufferedInputStream&lt;/tt&gt; always does buffered reads of up to the capacity of its buffer, while &lt;tt&gt;MemoryCachedInputStream&lt;/tt&gt; only buffer reads when it&apos;s marked and only the amount that was consumed via its &lt;tt&gt;read&lt;/tt&gt;/&lt;tt&gt;skip&lt;/tt&gt; methods.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Why can&apos;t we use the latter? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I tried extending &lt;tt&gt;BufferedInputStream&lt;/tt&gt; to add the ability to mark a parent stream when it runs out of capacity, but that involved reimplementing and/or changing most of its methods since &lt;tt&gt;BufferedInputStream&lt;/tt&gt; always reads from its internal buffer and re-fills it when necessary and most of its methods rely on that logic. Reading from a parent stream when the buffer is full would change this assumption what would require a significant refactor in most of its methods. I&apos;m open to suggestions if you see a way of easily adapting &lt;tt&gt;BufferedInputStream&lt;/tt&gt; to fulfil that requirement.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;&lt;tt&gt;MemoryCachedInputStream&lt;/tt&gt; uses default &lt;tt&gt;ByteArrayOutputStream&lt;/tt&gt; constructor which has only size of 32 bytes. Isn&apos;t this too small to use for cache?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Probably, I will try to find a better value for this. Do you easily remember if there is a way to retrieve the average partition size for a given table? I remember seeing something along those lines but I&apos;m not sure where it is..&lt;/p&gt;

&lt;p&gt;I will start work on the remaining TODO points and review comments. Please let me know if you have something to add.&lt;/p&gt;</comment>
                            <comment id="15154677" author="yukim" created="Fri, 19 Feb 2016 19:04:55 +0000"  >&lt;p&gt;One more suggestion.&lt;br/&gt;
Isn&apos;t it simpler to just have CachedInputStream that first fills on heap buffer and writes out to file as buffer gets full?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Do you easily remember if there is a way to retrieve the average partition size for a given table? I remember seeing something along those lines but I&apos;m not sure where it is.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think we can just set to be more sane value (few hundreds kilobytes?), the use case here is for static columns only.&lt;/p&gt;</comment>
                            <comment id="15159412" author="xiaodong" created="Tue, 23 Feb 2016 18:53:12 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
   I learnt that this issue has been worked on actively. Could you please share the updates/ETA of the fix release? &lt;/p&gt;

&lt;p&gt;   I am currently running into the same issue and get blocked when trying to migrating the data from C* 2.1.x to C* 3.3 &lt;/p&gt;

&lt;p&gt;Did a few approaches:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Running the &quot;sstableupgrade&quot; &amp;amp; &quot;sstableloader&quot; on the 2.1.x&apos;s snapshots won&apos;t work because of this issue;&lt;/li&gt;
	&lt;li&gt;Due to the &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-8110&quot; title=&quot;Make streaming forward &amp;amp; backwards compatible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-8110&quot;&gt;CASSANDRA-8110&lt;/a&gt;:  within the same 2.1.x cluster running &quot;rebuild&quot; on 3.3 DC won&apos;t work;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15159424" author="yukim" created="Tue, 23 Feb 2016 18:59:17 +0000"  >&lt;p&gt;Did you try running sstableupgrade from 3.3 against 2.1 SSTables?&lt;/p&gt;</comment>
                            <comment id="15165679" author="pauloricardomg" created="Wed, 24 Feb 2016 22:57:32 +0000"  >&lt;p&gt;Thanks for the review and comments &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt;! Follow-up below.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Isn&apos;t it simpler to just have CachedInputStream that first fills on heap buffer and writes out to file as buffer gets full?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1, merged &lt;tt&gt;MemoryCachedInputStream&lt;/tt&gt; and &lt;tt&gt;FileCachedInputStream&lt;/tt&gt; into a single class &lt;tt&gt;RewindableInputStream&lt;/tt&gt;, and also made some simplifications to cover only our needed use case. Before I was trying to make it too general that&apos;s why it became unnecessarily complex. Also updated tests to reflect changes.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think we can just set to be more sane value (few hundreds kilobytes?), the use case here is for static columns only.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Made 128KB initial capacity and 1MB max memory capacity to store read partitions. After that, read bytes are spilled to disk. Also removed &lt;tt&gt;ByteArrayOutputStream&lt;/tt&gt; and &lt;tt&gt;ByteArrayInputStream&lt;/tt&gt;, now working with a  growing &lt;tt&gt;byte[]&lt;/tt&gt; buffer.&lt;/p&gt;

&lt;p&gt;Besides that, addressed github comments, finished previous TODO list and fixed all tests. Patch and tests available below.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...pauloricardomg:10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/riptano/cassandra-dtest/compare/master...pauloricardomg:10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-10990-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-10990-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;I will provide 3.0 patch after review, as well as update CHANGEs, etc. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=philipthompson&quot; class=&quot;user-hover&quot; rel=&quot;philipthompson&quot;&gt;philipthompson&lt;/a&gt; if I used the same C* and dtests branches as before, do you need to update the cassci job or can I just resubmit?&lt;/p&gt;</comment>
                            <comment id="15167951" author="yukim" created="Thu, 25 Feb 2016 21:58:24 +0000"  >&lt;p&gt;Thanks for the update. Here are my review comments.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;StreamDeserializer determines tmp directory to where disk can be hold 2 * the size of streaming SSTable, but isn&apos;t it too much? SSTable can be few hundred GB. You need to cap that.&lt;/li&gt;
	&lt;li&gt;Speaking of capping the size of tmp buffer file, we may want to respect the parameter of &lt;tt&gt;InputStream#mark(int readLimit)&lt;/tt&gt;. We just set read limit to&lt;br/&gt;
2.147GB and make it the limitation of this functionality. Users can always upgradesstable if needed.&lt;/li&gt;
	&lt;li&gt;RewindableInputStream - I don&apos;t think we need &lt;tt&gt;SyncUtil.sync&lt;/tt&gt; on buffer file.&lt;/li&gt;
	&lt;li&gt;RewindableInputStream only deletes buffer file at close, but it is not closed when stream finishes. You cannot close with &lt;tt&gt;RewindableInputStream#close&lt;/tt&gt; because that will cause underlying socket to be closed.&lt;/li&gt;
	&lt;li&gt;RewindableDataInputStreamPlus - &lt;tt&gt;bytesPastMark&lt;/tt&gt; returns underlying stream&apos;s &lt;tt&gt;available()&lt;/tt&gt;, but I don&apos;t think that is suitable there. &lt;tt&gt;available&lt;/tt&gt; (by contract) just returns estimated bytes to be read without blocking. You should return &lt;tt&gt;pos&lt;/tt&gt; from &lt;tt&gt;RewindableInputStream&lt;/tt&gt;. That said, I think it is better to integrate &lt;tt&gt;RewindableDataInputStreamPlus&lt;/tt&gt; and &lt;tt&gt;RewindableInputStream&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;Initial capacity seems to be set as 128 bytes, not 128 Kbytes. Also I prefer passing this value to constructor as well so you don&apos;t have to deal with &lt;tt&gt;System.setProperty&lt;/tt&gt; in unit test.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15170295" author="pauloricardomg" created="Sat, 27 Feb 2016 02:31:22 +0000"  >&lt;p&gt;Thanks for the review, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt;! Follow-up below:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;StreamDeserializer determines tmp directory to where disk can be hold 2 * the size of streaming SSTable, but isn&apos;t it too much? SSTable can be few hundred GB. You need to cap that.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;With the current implementation, each partition larger than 1MB is spilled to disk for rewind later. In the worst case, if all partitions are &amp;gt;&amp;gt; 1MB, the spill file will be proportional to the sstable size. This is mostly a safety measure to check that currently the disk has space to hold the actual sstable, and all partitions spilled to disk in the worst case. Of course that even with this, and other compactions/streaming in place you cannot guarantee anything, and the disk can occasionaly get full and chaos will happen. An alternative approach is to overwrite the spill file for each partition, so we need disk space proportional to the max partition size, but this will probably cause write amplification. In any case, before I was not checking in case the returned spill file from &lt;tt&gt;cfs.getDirectories().getTemporaryWriteableDirectoryAsFile&lt;/tt&gt; was null (meaning there is no space) so I added that check and threw an exception.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Speaking of capping the size of tmp buffer file, we may want to respect the parameter of InputStream#mark(int readLimit). We just set read limit to 2.147GB and make it the limitation of this functionality. Users can always upgradesstable if needed.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t see why we should cap this if there is enough disk space, which is usually the case when bootstrapping/sstableloading. While I&apos;m happy to add the cap if you feel strong about it, I think this will render the functionality useless to dense nodes with &lt;tt&gt;STCS&lt;/tt&gt;, while they could still be served as long as there is sufficient disk space. Furthermore, I think for most cases partitions will be &amp;lt;= 1MB, so we will only spill to disk very rarely (and the disk space check protection should be sufficient for other cases).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;RewindableInputStream only deletes buffer file at close, but it is not closed when stream finishes. You cannot close with RewindableInputStream#close because that will cause underlying socket to be closed.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Nice catch, thanks! I added a &lt;tt&gt;cleanup&lt;/tt&gt; method to &lt;tt&gt;StreamDeserializer&lt;/tt&gt; that performs the cleanup in the &lt;tt&gt;finally&lt;/tt&gt; clause of &lt;tt&gt;StreamReader.read&lt;/tt&gt; and &lt;tt&gt;CompressedStreamReader.read&lt;/tt&gt; (unfortunately I couldn&apos;t reuse the &lt;tt&gt;close&lt;/tt&gt; method of &lt;tt&gt;StreamDeserializer&lt;/tt&gt; because it&apos;s called in-between-partitions by the try-with-resources clause of &lt;tt&gt;BigTableWriter.append&lt;/tt&gt;). I also updated &lt;a href=&quot;https://github.com/pauloricardomg/cassandra-dtest/tree/10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt; to check that temp spill files are cleaned up correctly.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;RewindableInputStream - I don&apos;t think we need SyncUtil.sync on buffer file.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Removed, thanks!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;RewindableDataInputStreamPlus - bytesPastMark returns underlying stream&apos;s available(), but I don&apos;t think that is suitable there. available (by contract) just returns estimated bytes to be read without blocking. You should return pos from RewindableInputStream. That said, I think it is better to integrate RewindableDataInputStreamPlus and RewindableInputStream.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Fixed &lt;tt&gt;bytesPastMark&lt;/tt&gt; and integrated &lt;tt&gt;RewindableInputStream&lt;/tt&gt; into &lt;tt&gt;RewindableDataInputStreamPlus&lt;/tt&gt;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Initial capacity seems to be set as 128 bytes, not 128 Kbytes. Also I prefer passing this value to constructor as well so you don&apos;t have to deal with System.setProperty in unit test.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I set the initial capacity to 32KB, do you think this is sufficient or do you prefer 128KB ?&lt;/p&gt;

&lt;p&gt;I added the initial capacity to constructor so we can use it on unit tests, but left the system properties so we can set them to a lower value on &lt;a href=&quot;https://github.com/pauloricardomg/cassandra-dtest/tree/10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Updated above branch with review followup and resubmitted tests.&lt;/p&gt;</comment>
                            <comment id="15171565" author="xiaodong" created="Mon, 29 Feb 2016 08:13:51 +0000"  >&lt;p&gt;Thanks for the prompt response, Yuki.&lt;/p&gt;

&lt;p&gt;I did try the upgrade the SSTable and failed. And figured out that the SSTable has to be under &amp;lt;data_directory&amp;gt;/&amp;lt;keyspace&amp;gt;/&amp;lt;table&amp;gt;/.&lt;/p&gt;

&lt;p&gt;After the upgrade,  a few table could be loaded.&lt;/p&gt;

&lt;p&gt;I will keep updated if further issues.&lt;/p&gt;</comment>
                            <comment id="15172237" author="yukim" created="Mon, 29 Feb 2016 17:56:16 +0000"  >&lt;p&gt;Current check requires to have disk space of 2 * transferring SSTable, so for example we need to receive a SSTable file of 100GB at bootstrap then we need 200GB of free space beforehand on bootstrapping node, even we may write 2 MB of buffer file. I think &lt;tt&gt;totalSize + Integer.MAX_VALUE&lt;/tt&gt; can do the job here.&lt;br/&gt;
We want to do&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;An alternative approach is to overwrite the spill file for each partition, so we need disk space proportional to the max partition size&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;with the cap.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;but this will probably cause write amplification.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We don&apos;t need to overwrite for every partition, we can apply cap here too.&lt;br/&gt;
Implementation may become a bit complicated though. WDYT?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I set the initial capacity to 32KB, do you think this is sufficient or do you prefer 128KB ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;32 is fine, users can change through system prop if they really need to.&lt;/p&gt;

&lt;p&gt;BTW, you can use &lt;tt&gt;Integer.getInteger&lt;/tt&gt; instead of &lt;tt&gt;Integer.parseInt(System.getProperty)&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15181464" author="pauloricardomg" created="Sat, 5 Mar 2016 02:50:43 +0000"  >&lt;p&gt;Updated branch with reworked &lt;tt&gt;RewindableDataInputStreamPlus&lt;/tt&gt;, now treating the spill file as circular buffer with max size. Now required space for spill buffer file of legacy &lt;tt&gt;StreamDeserializer&lt;/tt&gt; is &lt;tt&gt;max(sstableSize, MAX_INT)&lt;/tt&gt;, capping the max required space (and max partition size) for streaming legacy/compact sstables on ~2GB. I also updated documentation and tests. WDYT &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yukim&quot; class=&quot;user-hover&quot; rel=&quot;yukim&quot;&gt;yukim&lt;/a&gt;?&lt;/p&gt;

&lt;p&gt;Besides that, I added a new &lt;a href=&quot;https://github.com/pauloricardomg/cassandra-dtest/commit/b59ea329a5b9302372c57956f7015111fd47a4ae&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt; for testing repair of older version sstables on 3.0+, and it seems to work. Now we have the following dtests:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/pauloricardomg/cassandra-dtest/blob/10990/upgrade_8099_test.py#L340&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;bootstrap dtests&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/pauloricardomg/cassandra-dtest/blob/10990/sstable_generation_loading_test.py#L181&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;sstable loader dtests&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/pauloricardomg/cassandra-dtest/commit/b59ea329a5b9302372c57956f7015111fd47a4ae&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;repair dtests&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;For simplicity, I opted for writing the old streamed sstables in the new format without &lt;tt&gt;EncodingStats&lt;/tt&gt; (since there is no &lt;tt&gt;SerializationHeader&lt;/tt&gt; available), what may make these sstables less optimized in terms of storage space from what I understood. Do you think we should construct these stats when receiving the sstable or not bother &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt; ? Also, do you recall of any other edge case we should watch here?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="15187223" author="yukim" created="Wed, 9 Mar 2016 15:14:10 +0000"  >&lt;p&gt;I think patch looks good for me with the following little change:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;getTempBufferFile should throw IOException instead of RuntimeException when buffer file cannot be created, so stream won&apos;t be retried.&lt;/li&gt;
	&lt;li&gt;RewindableDISP.reset should throw IOException instead of IllegalStateException so that it fits the InputStream&apos;s interface.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Can you create patch for 3.0 branch also, and run dtests?&lt;/p&gt;</comment>
                            <comment id="15188030" author="pauloricardomg" created="Wed, 9 Mar 2016 21:06:48 +0000"  >&lt;p&gt;Updated patch and submitted tests.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.5&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;dtest&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.0...pauloricardomg:3.0-10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/cassandra-3.5...pauloricardomg:3.5-10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...pauloricardomg:trunk-10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/riptano/cassandra-dtest/compare/master...pauloricardomg:10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10990-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.5-10990-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-10990-testall/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.0-10990-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-3.5-10990-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/paulomotta/job/pauloricardomg-trunk-10990-dtest/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;note: the dtests are configured to use the &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/compare/master...pauloricardomg:10990&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;updated dtest branch&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;commit info: conflict on 3.5, merges cleanly to trunk.&lt;/p&gt;</comment>
                            <comment id="15195544" author="yukim" created="Tue, 15 Mar 2016 16:01:56 +0000"  >&lt;p&gt;+1. Thanks for your work.&lt;br/&gt;
I will commit soon.&lt;br/&gt;
(Can you change status to Patch Available so that the status can change to Ready to commit?)&lt;/p&gt;</comment>
                            <comment id="15196238" author="pauloricardomg" created="Tue, 15 Mar 2016 20:55:40 +0000"  >&lt;p&gt;I rebased branches and dtests and will resubmit tests. Will mark as ready to commit when new tests look good.&lt;/p&gt;</comment>
                            <comment id="15196492" author="pauloricardomg" created="Tue, 15 Mar 2016 23:44:02 +0000"  >&lt;p&gt;dtests look good. &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/858&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest PR&lt;/a&gt; submitted. marking as ready to commit.&lt;/p&gt;</comment>
                            <comment id="15199796" author="yukim" created="Thu, 17 Mar 2016 16:07:34 +0000"  >&lt;p&gt;Committed as e8651b6625c7f6260852f2a9c45fb189c63ab528. Thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12945751">CASSANDRA-11287</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12924232">CASSANDRA-10940</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 35 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2r1tr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>yukim</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>