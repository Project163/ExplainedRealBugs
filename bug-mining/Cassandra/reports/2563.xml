<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:42:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-6210] Repair hangs when a new datacenter is added to a cluster</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-6210</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Attempting to add a new datacenter to a cluster seems to cause repair operations to break. I&apos;ve been reproducing this with 20~ node clusters but can get it to reliably occur on 2 node setups.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;##Basic Steps to reproduce
#Node 1 is started using GossipingPropertyFileSnitch as dc1
#Cassandra-stress is used to insert a minimal amount of data
$CASSANDRA_STRESS -t 100 -R org.apache.cassandra.locator.NetworkTopologyStrategy  --num-keys=1000 --columns=10 --consistency-level=LOCAL_QUORUM --average-size-values -
-compaction-strategy=&lt;span class=&quot;code-quote&quot;&gt;&apos;LeveledCompactionStrategy&apos;&lt;/span&gt; -O dc1:1 --operation=COUNTER_ADD
#Alter &lt;span class=&quot;code-quote&quot;&gt;&quot;Keyspace1&quot;&lt;/span&gt;
ALTER KEYSPACE &lt;span class=&quot;code-quote&quot;&gt;&quot;Keyspace1&quot;&lt;/span&gt; WITH replication = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;NetworkTopologyStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;dc1&apos;&lt;/span&gt;: 1 , &lt;span class=&quot;code-quote&quot;&gt;&apos;dc2&apos;&lt;/span&gt;: 1 };
#Add node 2 using GossipingPropertyFileSnitch as dc2
run repair on node 1
run repair on node 2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The repair task on node 1 never completes and while there are no exceptions in the logs of node1, netstat reports the following repair tasks&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Mode: NORMAL
Repair 4e71a250-36b4-11e3-bedc-1d1bb5c9abab
Repair 6c64ded0-36b4-11e3-bedc-1d1bb5c9abab
Read Repair Statistics:
Attempted: 0
Mismatch (Blocking): 0
Mismatch (Background): 0
Pool Name                    Active   Pending      Completed
Commands                        n/a         0          10239
Responses                       n/a         0           3839
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Checking on node 2 we see the following exceptions&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [STREAM-IN-/10.171.122.130] 2013-10-16 22:42:58,961 StreamSession.java (line 410) [Stream #4e71a250-36b4-11e3-bedc-1d1bb5c9abab] Streaming error occurred
java.lang.NullPointerException
        at org.apache.cassandra.streaming.ConnectionHandler.sendMessage(ConnectionHandler.java:174)
        at org.apache.cassandra.streaming.StreamSession.prepare(StreamSession.java:436)
        at org.apache.cassandra.streaming.StreamSession.messageReceived(StreamSession.java:358)
        at org.apache.cassandra.streaming.ConnectionHandler$IncomingMessageHandler.run(ConnectionHandler.java:293)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:724)
...
ERROR [STREAM-IN-/10.171.122.130] 2013-10-16 22:43:49,214 StreamSession.java (line 410) [Stream #6c64ded0-36b4-11e3-bedc-1d1bb5c9abab] Streaming error occurred
java.lang.NullPointerException
        at org.apache.cassandra.streaming.ConnectionHandler.sendMessage(ConnectionHandler.java:174)
        at org.apache.cassandra.streaming.StreamSession.prepare(StreamSession.java:436)
        at org.apache.cassandra.streaming.StreamSession.messageReceived(StreamSession.java:358)
        at org.apache.cassandra.streaming.ConnectionHandler$IncomingMessageHandler.run(ConnectionHandler.java:293)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:724)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Netstats on node 2 reports&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;automaton@ip-10-171-15-234:~$ nodetool netstats
Mode: NORMAL
Repair 4e71a250-36b4-11e3-bedc-1d1bb5c9abab
Read Repair Statistics:
Attempted: 0
Mismatch (Blocking): 0
Mismatch (Background): 0
Pool Name                    Active   Pending      Completed
Commands                        n/a         0           2562
Responses                       n/a         0           4284

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Amazon Ec2&lt;br/&gt;
2 M1.large nodes&lt;/p&gt;</environment>
        <key id="12674215">CASSANDRA-6210</key>
            <summary>Repair hangs when a new datacenter is added to a cluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yukim">Yuki Morishita</assignee>
                                    <reporter username="rspitzer">Russell Spitzer</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Oct 2013 23:01:09 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:02 +0000</updated>
                            <resolved>Tue, 28 Jan 2014 15:21:29 +0000</resolved>
                                        <fixVersion>2.0.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13797720" author="jbellis" created="Thu, 17 Oct 2013 08:53:53 +0000"  >&lt;p&gt;Is this just &quot;I can&apos;t repair until bootstrapping is finished?&quot;&lt;/p&gt;</comment>
                            <comment id="13798109" author="rspitzer" created="Thu, 17 Oct 2013 17:13:10 +0000"  >&lt;p&gt;I see this effect with both auto_bootstrap: false (in cassandra.yaml). Although if it is just a bootstrapping issue, I think we should have a better failure mode.  I&apos;ll try doing the keyspace alteration after adding the new node and see if that fixes things.&lt;/p&gt;</comment>
                            <comment id="13798113" author="rspitzer" created="Thu, 17 Oct 2013 17:16:18 +0000"  >&lt;p&gt;Double checked that auto_bootstrap was false on both nodes. Re ran test&lt;/p&gt;

&lt;p&gt;On node 1 (netstats)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Mode: NORMAL
Repair e50825a0-374e-11e3-854d-f97c22942f02
Read Repair Statistics:
Attempted: 0
Mismatch (Blocking): 0
Mismatch (Background): 0
Pool Name                    Active   Pending      Completed
Commands                        n/a         0           2562
Responses                       n/a         0           1284
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On node 2 (System.log)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [STREAM-IN-/10.171.10.24] 2013-10-17 17:09:34,102 StreamSession.java (line 410) [Stream #e50825a0-374e-11e3-854d-f97c22942f02] Streaming error occurred
java.lang.NullPointerException
        at org.apache.cassandra.streaming.ConnectionHandler.sendMessage(ConnectionHandler.java:174)
        at org.apache.cassandra.streaming.StreamSession.prepare(StreamSession.java:436)
        at org.apache.cassandra.streaming.StreamSession.messageReceived(StreamSession.java:358)
        at org.apache.cassandra.streaming.ConnectionHandler$IncomingMessageHandler.run(ConnectionHandler.java:293)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:724)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13798132" author="rspitzer" created="Thu, 17 Oct 2013 17:28:35 +0000"  >&lt;p&gt;&lt;del&gt;Moving the alter of the keyspace to after bringing up the second Node fixes this.&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;I spoke to soon it failed on the second trial.&lt;/p&gt;</comment>
                            <comment id="13798282" author="brandon.williams" created="Thu, 17 Oct 2013 19:03:53 +0000"  >&lt;p&gt;Can&apos;t repro on the 2.0 branch with these steps.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Moving the alter of the keyspace to after bringing up the second Node fixes this.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s because there&apos;s nothing to repair without the second replica defined.&lt;/p&gt;</comment>
                            <comment id="13798318" author="rspitzer" created="Thu, 17 Oct 2013 19:39:36 +0000"  >&lt;p&gt;If I execute nodetool rebuild before doing the repair then repair completes successfully (because it doesn&apos;t have to stream anything?) &lt;/p&gt;</comment>
                            <comment id="13798336" author="rspitzer" created="Thu, 17 Oct 2013 19:54:18 +0000"  >&lt;p&gt;The same test works on 1.2.10 (DSE w/o vnodes)&lt;/p&gt;</comment>
                            <comment id="13798356" author="rspitzer" created="Thu, 17 Oct 2013 20:17:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt;, I moved the alter statement too after bringing up the second node, but not after running repair. So it still has data to repair.&lt;/p&gt;

&lt;p&gt;So this sequence still has a bug&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Node 1 up dc1
Stress
Node 2 up dc2
Alter keyspace
repair on node1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But this sequence seems to work fine&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;node 1 up
stress
node 2 up
Alter Keyspace
Nodetool rebuild on node 2
Repair
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13798379" author="brandon.williams" created="Thu, 17 Oct 2013 20:36:15 +0000"  >&lt;p&gt;Can you try 2.0 HEAD?&lt;/p&gt;</comment>
                            <comment id="13798427" author="rspitzer" created="Thu, 17 Oct 2013 21:12:16 +0000"  >&lt;p&gt;Same error on 2.0 Head, when I try to repair without issuing the rebuild.&lt;/p&gt;

&lt;p&gt;Last commit&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;commit 886f16ca1c14f1209151579408b59cd699832cbf
Author: Brandon Williams &amp;lt;brandonwilliams@apache.org&amp;gt;
Date:   Thu Oct 17 13:37:04 2013 -0500
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



</comment>
                            <comment id="13798524" author="rspitzer" created="Thu, 17 Oct 2013 22:16:27 +0000"  >&lt;p&gt;The problem doesn&apos;t manifest when i&apos;m not using vnodes on 2.0-HEAD&lt;/p&gt;</comment>
                            <comment id="13850912" author="yukim" created="Tue, 17 Dec 2013 21:10:28 +0000"  >&lt;p&gt;I followed the steps bellow:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Node 1 up dc1
Stress
Node 2 up dc2
Alter keyspace
repair on node1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And with auto_bootstrap: false, I got the following and repair hung:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [AntiEntropyStage:1] 2013-12-17 15:03:08,945 CassandraDaemon.java (line 187) Exception in thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[AntiEntropyStage:1,5,main]
java.lang.AssertionError: Unknown keyspace Keyspace1
        at org.apache.cassandra.db.Keyspace.&amp;lt;init&amp;gt;(Keyspace.java:262)
        at org.apache.cassandra.db.Keyspace.open(Keyspace.java:110)
        at org.apache.cassandra.db.Keyspace.open(Keyspace.java:88)
        at org.apache.cassandra.repair.RepairMessageVerbHandler.doVerb(RepairMessageVerbHandler.java:46)
        at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:60)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:744)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should &apos;catch-all&apos; in RepairVerbHandler to prevent hang at least.&lt;br/&gt;
It was not the same exception.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rspitzer&quot; class=&quot;user-hover&quot; rel=&quot;rspitzer&quot;&gt;rspitzer&lt;/a&gt;, can you reproduce with &apos;log4j.logger.org.apache.cassandra.streaming=DEBUG&apos; in your log4j-server.properties and attach the log here?&lt;/p&gt;</comment>
                            <comment id="13851378" author="rspitzer" created="Wed, 18 Dec 2013 05:26:23 +0000"  >&lt;p&gt;Sure, It was a while back so things have most likely changed in the interim. I&apos;ll get the test running tomorrow with the DEBUG statements turned on. &lt;/p&gt;</comment>
                            <comment id="13852313" author="rspitzer" created="Wed, 18 Dec 2013 23:36:31 +0000"  >&lt;p&gt;Repair running on this node&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; INFO [AntiEntropyStage:1] 2013-12-18 22:39:28,209 StreamResultFuture.java (line 82) [Stream #40d875d0-6835-11e3-a172-3729e500a0e7] Executing streaming plan &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Repair
 INFO [AntiEntropyStage:1] 2013-12-18 22:39:28,209 StreamResultFuture.java (line 86) [Stream #40d875d0-6835-11e3-a172-3729e500a0e7] Beginning stream session with /10.171.81.22
DEBUG [StreamConnectionEstablisher:2] 2013-12-18 22:39:28,210 ConnectionHandler.java (line 78) [Stream #40d875d0-6835-11e3-a172-3729e500a0e7] Sending stream init &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; incoming stream
DEBUG [StreamConnectionEstablisher:2] 2013-12-18 22:39:28,211 ConnectionHandler.java (line 84) [Stream #40d875d0-6835-11e3-a172-3729e500a0e7] Sending stream init &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; outgoing stream
DEBUG [STREAM-OUT-/10.171.81.22] 2013-12-18 22:39:28,212 ConnectionHandler.java (line 356) [Stream #40d875d0-6835-11e3-a172-3729e500a0e7] Sending Prepare (1 requests,  2 files}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On requested node&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;DEBUG [STREAM-IN-/10.172.27.174] 2013-12-18 22:39:28,296 ConnectionHandler.java (line 292) [Stream #40d875d0-6835-11e3-a172-3729e500a0e7] Received Prepare (1 requests,  2 files}
ERROR [STREAM-IN-/10.172.27.174] 2013-12-18 22:39:28,314 StreamSession.java (line 410) [Stream #40d875d0-6835-11e3-a172-3729e500a0e7] Streaming error occurred
java.lang.NullPointerException
        at org.apache.cassandra.streaming.ConnectionHandler.sendMessage(ConnectionHandler.java:174)
        at org.apache.cassandra.streaming.StreamSession.prepare(StreamSession.java:436)
        at org.apache.cassandra.streaming.StreamSession.messageReceived(StreamSession.java:358)
        at org.apache.cassandra.streaming.ConnectionHandler$IncomingMessageHandler.run(ConnectionHandler.java:293)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:724)
DEBUG [STREAM-IN-/10.172.27.174] 2013-12-18 22:39:28,316 ConnectionHandler.java (line 153) [Stream #40d875d0-6835-11e3-a172-3729e500a0e7] Closing stream connection handler on /10.172.27.174
 INFO [STREAM-IN-/10.172.27.174] 2013-12-18 22:39:28,317 StreamResultFuture.java (line 181) [Stream #40d875d0-6835-11e3-a172-3729e500a0e7] Session with /10.172.27.174 is complete
 WARN [STREAM-IN-/10.172.27.174] 2013-12-18 22:39:28,317 StreamResultFuture.java (line 210) [Stream #40d875d0-6835-11e3-a172-3729e500a0e7] Stream failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13853030" author="rspitzer" created="Thu, 19 Dec 2013 16:58:30 +0000"  >&lt;p&gt;Attached RepairLogs.tar.gz Which has logs from all the nodes involved&lt;/p&gt;

&lt;p&gt;They contain data from two trial runs, one where counter data is attempted to be repaired, and one where standard inserts are repaired. The Shutdown indicates the separation between these tests. &lt;/p&gt;

&lt;p&gt;Null pointers are seen on 10.171.49.137 and 10.171.81.22&lt;/p&gt;</comment>
                            <comment id="13855702" author="yukim" created="Mon, 23 Dec 2013 15:56:16 +0000"  >&lt;p&gt;Thanks Russell.&lt;/p&gt;

&lt;p&gt;From the log, I can see streaming session on receiver side did not set up correctly, though sender thought we were ready. Sender wrote stream init message through SocketChannel API but the message was not sent/received.&lt;br/&gt;
I think there are two ways to fix this. 1) Sender waits for ACK from receiver or 2) Receiver holds response to sender until ready.&lt;br/&gt;
I&apos;m tend to fix this using 2) rather than add another message for ACK, since the next message sender would send is only one stream PREPARE message.&lt;/p&gt;

&lt;p&gt;Let me work on that patch as well as to fix AE I encountered above.&lt;/p&gt;</comment>
                            <comment id="13874147" author="yukim" created="Thu, 16 Jan 2014 23:32:08 +0000"  >&lt;p&gt;I think the actual cause of this is StreamInitMessage is not completely written. We should have checked if SocketChannel#write does write out content of message buffer. Patch attached to fix this.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rspitzer&quot; class=&quot;user-hover&quot; rel=&quot;rspitzer&quot;&gt;rspitzer&lt;/a&gt; Can you test with the patch applied to 2.0 branch?&lt;/p&gt;</comment>
                            <comment id="13875006" author="rspitzer" created="Fri, 17 Jan 2014 17:51:15 +0000"  >&lt;p&gt;Ran the test again last night and repair reported the following exceptions, I&apos;ll have the logs up in a moment.&lt;/p&gt;

&lt;p&gt;Setup:&lt;br/&gt;
4 Nodes, 2 per DC&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR [AntiEntropySessions:2] 2014-01-17 06:59:13,320 RepairSession.java (line 278) [repair #def293b0-7f44-11e3-b180-d1c68624042f] session completed with the following error
org.apache.cassandra.exceptions.RepairException: [repair #def293b0-7f44-11e3-b180-d1c68624042f on Keyspace1/Standard1, (-4559856749309798061,-4559456353371206248]] Sync failed between /10.171.121.18 and /10.196.16.123
        at org.apache.cassandra.repair.RepairSession.syncComplete(RepairSession.java:200)
        at org.apache.cassandra.service.ActiveRepairService.handleMessage(ActiveRepairService.java:204)
        at org.apache.cassandra.repair.RepairMessageVerbHandler.doVerb(RepairMessageVerbHandler.java:59)
        at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:60)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:724)
ERROR [AntiEntropySessions:2] 2014-01-17 06:59:13,325 CassandraDaemon.java (line 192) Exception in thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[AntiEntropySessions:2,5,RMI &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt;]
java.lang.RuntimeException: org.apache.cassandra.exceptions.RepairException: [repair #def293b0-7f44-11e3-b180-d1c68624042f on Keyspace1/Standard1, (-4559856749309798061,-4559456353371206248]] Sync failed between /10.171.121.18 and /10.196.16.123
        at com.google.common.base.Throwables.propagate(Throwables.java:160)
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:32)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:724)
Caused by: org.apache.cassandra.exceptions.RepairException: [repair #def293b0-7f44-11e3-b180-d1c68624042f on Keyspace1/Standard1, (-4559856749309798061,-4559456353371206248]] Sync failed between /10.171.121.18 and /10.196.16.123
        at org.apache.cassandra.repair.RepairSession.syncComplete(RepairSession.java:200)
        at org.apache.cassandra.service.ActiveRepairService.handleMessage(ActiveRepairService.java:204)
        at org.apache.cassandra.repair.RepairMessageVerbHandler.doVerb(RepairMessageVerbHandler.java:59)
        at org.apache.cassandra.net.MessageDeliveryTask.run(MessageDeliveryTask.java:60)
        ... 3 more
 INFO [AntiEntropySessions:4] 2014-01-17 06:59:13,328 RepairSession.java (line 236) [repair #df5d6370-7f44-11e3-b180-d1c68624042f] &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; session: will sync /10.171.121.18, /10.198.2.16 on range (-5516517151222322415,-5504449186624942606] &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Keyspace1.[SuperCounter1, Super1, Counter3, Standard1, Counter1]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13875019" author="rspitzer" created="Fri, 17 Jan 2014 18:00:13 +0000"  >&lt;p&gt;Logs from patched cluster running repair test&lt;/p&gt;</comment>
                            <comment id="13875328" author="yukim" created="Fri, 17 Jan 2014 22:28:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rspitzer&quot; class=&quot;user-hover&quot; rel=&quot;rspitzer&quot;&gt;rspitzer&lt;/a&gt; thanks for the log, I&apos;m still seeing the same NPE.&lt;/p&gt;

&lt;p&gt;Updated patch attached. This version also enqueues message until connection for output is established. Can you test with it?&lt;/p&gt;</comment>
                            <comment id="13875340" author="rspitzer" created="Fri, 17 Jan 2014 22:36:25 +0000"  >&lt;p&gt;Of course, Setting up now.&lt;/p&gt;</comment>
                            <comment id="13883665" author="rspitzer" created="Tue, 28 Jan 2014 02:21:02 +0000"  >&lt;p&gt;Newest patch looks good to me. Passes extended repair tests.&lt;/p&gt;</comment>
                            <comment id="13884241" author="yukim" created="Tue, 28 Jan 2014 15:21:29 +0000"  >&lt;p&gt;Thanks for testing.&lt;br/&gt;
Committed to 2.0 and trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12623737" name="6210-2.0.txt" size="9493" author="yukim" created="Fri, 17 Jan 2014 22:28:43 +0000"/>
                            <attachment id="12619601" name="RepairLogs.tar.gz" size="2690373" author="rspitzer" created="Thu, 19 Dec 2013 16:58:30 +0000"/>
                            <attachment id="12623694" name="patch_1_logs.tar.gz" size="422397" author="rspitzer" created="Fri, 17 Jan 2014 18:00:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[yukim]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353837</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 43 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1p053:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>354129</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324542">2.0.1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>rspitzer</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[rspitzer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12324629">2.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>