<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:18:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-14925] DecimalSerializer.toString() can be used as OOM attack </title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-14925</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Currently, in &lt;tt&gt;DecimalSerializer.toString(value)&lt;/tt&gt;, it&#160;uses &lt;tt&gt;BigDecimal.toPlainString()&lt;/tt&gt; which generates huge string for large scale values.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
BigDecimal&#160;d&#160;=&#160;&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;&#160;BigDecimal(&lt;span class=&quot;code-quote&quot;&gt;&quot;1e-&quot;&lt;/span&gt;&#160;+ (&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.MAX_VALUE&#160;- 6));
d.toPlainString(); &lt;span class=&quot;code-comment&quot;&gt;// oom&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Propose to use &lt;tt&gt;BigDecimal.toString()&lt;/tt&gt; when scale is larger than 100 which is configurable via&#160;&lt;tt&gt;-Dcassandra.decimal.maxscaleforstring&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; patch &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; circle-ci &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasonstack/cassandra/commits/decimal-tostring-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/jasonstack/cassandra/751?utm_campaign=vcs-integration-link&amp;amp;utm_medium=referral&amp;amp;utm_source=github-build-link&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;unit&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;The code should apply cleanly to 3.0+.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13203364">CASSANDRA-14925</key>
            <summary>DecimalSerializer.toString() can be used as OOM attack </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10000" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Urgent</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jasonstack">Zhao Yang</assignee>
                                    <reporter username="jasonstack">Zhao Yang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 10 Dec 2018 07:05:01 +0000</created>
                <updated>Wed, 30 Dec 2020 11:31:52 +0000</updated>
                            <resolved>Sat, 19 Dec 2020 18:41:53 +0000</resolved>
                                        <fixVersion>3.0.24</fixVersion>
                    <fixVersion>3.11.10</fixVersion>
                    <fixVersion>4.0-rc1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                    <component>Legacy/Core</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16714525" author="slebresne" created="Mon, 10 Dec 2018 10:12:34 +0000"  >&lt;p&gt;Can&apos;t we just use &lt;tt&gt;BigDecimal.toString()&lt;/tt&gt; all the time as save ourselves the trouble of adding yet one more runtime parameter that no user will probably ever modify?&lt;/p&gt;</comment>
                            <comment id="16714659" author="jasonstack" created="Mon, 10 Dec 2018 12:32:36 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can&apos;t we just use BigDecimal.toString() all the time as save ourselves the trouble of adding yet one more runtime parameter that no user will probably ever modify?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Make sense.. updated the patch to use `toString()` only.&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;patch&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;circle-ci&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasonstack/cassandra/commits/decimal-tostring-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/jasonstack/cassandra/747?utm_campaign=vcs-integration-link&amp;amp;utm_medium=referral&amp;amp;utm_source=github-build-link&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;unit&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasonstack/cassandra/commits/decimal-tostring-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/jasonstack/cassandra/752?utm_campaign=vcs-integration-link&amp;amp;utm_medium=referral&amp;amp;utm_source=github-build-link&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;unit&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasonstack/cassandra/commits/decimal-tostring-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/jasonstack/cassandra/751?utm_campaign=vcs-integration-link&amp;amp;utm_medium=referral&amp;amp;utm_source=github-build-link&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;unit&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16716681" author="slebresne" created="Tue, 11 Dec 2018 09:41:27 +0000"  >&lt;p&gt;The patch looks obviously technically ok, but there is of course the question of backward compatibility. I believe the most of usage of &lt;tt&gt;AbstractType#getString&lt;/tt&gt; is&#160;for log messages, but there is a few other usages. &lt;tt&gt;sstabledump&lt;/tt&gt; is one, though I&apos;m not too worried about this here. There is a also a bunch of case where it&apos;s used for internal stuffs but &quot;I think&quot; this should be case where &lt;tt&gt;decimal&lt;/tt&gt; is not used. But I have far from make a careful analysis of all the places where it is used, so I think we&apos;re fine but I&apos;m not 100% sure.&lt;/p&gt;

&lt;p&gt;Overall, not sure what to do about that previous comment. I do think we should fix this and I don&apos;t think the risk of someone running into backward compatibility troubles is very high here, but I wonder if we shouldn&apos;t stick to trunk as a compromise. Would welcome other opinions here for sure. Maybe worth a quick email on the mailing list to gather opinions? &lt;/p&gt;
</comment>
                            <comment id="16722682" author="jasonstack" created="Mon, 17 Dec 2018 04:53:35 +0000"  >&lt;p&gt;Updated the patch to Trunk only.&lt;/p&gt;</comment>
                            <comment id="17227257" author="jlewandowski" created="Fri, 6 Nov 2020 09:12:36 +0000"  >&lt;p&gt;When is it going to be merged?&lt;/p&gt;</comment>
                            <comment id="17250232" author="blambov" created="Wed, 16 Dec 2020 10:33:09 +0000"  >&lt;p&gt;To me this is a serious bug for any version of Cassandra, and should be applied to all supported versions ASAP. This is a real security risk for users and can be very easily exploited as a denial of service attack. I am raising the severity accordingly &#8211; this has been ignored too long already.&lt;/p&gt;

&lt;p&gt;The risk of problems after the patch is not real: any of the considered formats is a valid full precision representation of the number and will be accepted correctly by transformations back to &lt;tt&gt;BigDecimal&lt;/tt&gt; from &lt;tt&gt;String&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17250365" author="jasonstack" created="Wed, 16 Dec 2020 14:51:17 +0000"  >&lt;p&gt;I have rebased..&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;patch&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;circle-ci&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasonstack/cassandra/commits/decimal-tostring-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/jasonstack/cassandra/333/workflows/b3d324ef-d356-4831-a8fb-d80c5eb4a49d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;unit&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasonstack/cassandra/commits/decimal-tostring-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;3.11&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/jasonstack/cassandra/332/workflows/74399094-9b27-44d7-b5bd-d34cd46fa944&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;unit&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasonstack/cassandra/commits/decimal-tostring-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;trunk&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/jasonstack/cassandra/331/workflows/ffa08b52-3716-4fce-9603-4be9ad0563e8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;unit&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17250501" author="blerer" created="Wed, 16 Dec 2020 17:53:37 +0000"  >&lt;p&gt;The patches looks good to me. Feel free to commit if the tests are green. &lt;/p&gt;</comment>
                            <comment id="17252252" author="jasonstack" created="Sat, 19 Dec 2020 18:42:21 +0000"  >&lt;p&gt;committed, thanks for the review&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jasonstack]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 47 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s01c60:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333891">3.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/ea52f1d2fa032dd28bbe69a1914497e48a6eb99a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/ea52f1d2fa032dd28bbe69a1914497e48a6eb99a&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>