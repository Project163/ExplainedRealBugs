<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:37:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5395] Compaction doesn&apos;t remove index entries as designed</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5395</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;PerColumnIndexUpdater ignores updates where the new value is a tombstone.  It should still remove the index entry on oldColumn.&lt;/p&gt;

&lt;p&gt;(Note that this will not affect user-visible correctness, since KeysSearcher/CompositeSearcher will issue deletes against stale index entries, but having more stale entries than we &quot;should&quot; could affect performance.)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12639433">CASSANDRA-5395</key>
            <summary>Compaction doesn&apos;t remove index entries as designed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="jbellis">Jonathan Ellis</reporter>
                        <labels>
                            <label>qa-resolved</label>
                    </labels>
                <created>Wed, 27 Mar 2013 19:32:57 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:15 +0000</updated>
                            <resolved>Thu, 4 Apr 2013 15:48:29 +0000</resolved>
                                        <fixVersion>1.2.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13615679" author="jbellis" created="Wed, 27 Mar 2013 20:02:32 +0000"  >&lt;p&gt;second patch attached (on top of the first) that also avoids creating duplicate index entries during PrecompactedRow.merge.  (Calling indexer.update(A, B) would remove the entry for A and add one for B, but since we&apos;re compacting we know that an entry for B already exists.)&lt;/p&gt;

&lt;p&gt;switched to a merge-column-at-a-time approach similar to what LCR uses.&lt;/p&gt;

&lt;p&gt;also tweaked LCR&apos;s reducer to short-circuit the column lookup if there is no index involved.&lt;/p&gt;</comment>
                            <comment id="13615816" author="jbellis" created="Wed, 27 Mar 2013 22:06:14 +0000"  >&lt;p&gt;Fixed a test failure and pushed to &lt;a href=&quot;http://github.com/jbellis/cassandra/tree/5395&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://github.com/jbellis/cassandra/tree/5395&lt;/a&gt;.  (Original patches were also half 1.2, half trunk.  Now both against 1.2.)&lt;/p&gt;</comment>
                            <comment id="13615972" author="jbellis" created="Thu, 28 Mar 2013 01:58:11 +0000"  >&lt;p&gt;... And pushed a 3rd commit applying the fix in patch to to ParallelCompactionIterable.&lt;/p&gt;

&lt;p&gt;This also has the side effect of switching from TSM to ABSM for PrecompactedRow and ParallelCompactionIterable, so there may be a performance improvement.&lt;/p&gt;</comment>
                            <comment id="13616605" author="beobal" created="Thu, 28 Mar 2013 20:04:55 +0000"  >&lt;p&gt;lgtm, just have 2 trivial queries:&lt;/p&gt;

&lt;p&gt;In LCR &amp;amp; PCR, if the purpose of the additional clauses is to omit unnecessary column lookups, should the column lookup be the last of the &amp;amp;&amp;amp;&apos;d  conditions?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (indexer != SecondaryIndexManager.nullUpdater
                    &amp;amp;&amp;amp; !column.isMarkedForDelete()
                    &amp;amp;&amp;amp; container.getColumn(column.name()) != column)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Class documentation in IdentityQueryFilter states &quot;Only for use in testing; will read entire CF into memory.&quot; Seeing as its being used in non-test code we should probably amend the docstring&lt;/p&gt;</comment>
                            <comment id="13617522" author="jbellis" created="Fri, 29 Mar 2013 17:08:24 +0000"  >&lt;p&gt;Committed with suggested improvements.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12575756" name="5395-2.txt" size="5505" author="jbellis" created="Wed, 27 Mar 2013 20:02:32 +0000"/>
                            <attachment id="12575751" name="5395.txt" size="1960" author="jbellis" created="Wed, 27 Mar 2013 19:34:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319903</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 34 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1j73r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320244</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>samt</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[samt]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311124" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Tester</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>enigmacurry</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>