<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:21:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-2581] Rebuffer called excessively during seeks</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-2581</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;When doing an strace tonight, I noticed during memtable flushes that we were only writing 1KB per every write() system call...After diving more into it, it&apos;s because of a bug in the seek() code. &lt;/p&gt;

&lt;p&gt;if (newPosition &amp;gt;= bufferOffset + validBufferBytes || newPosition &amp;lt; bufferOffset)&lt;/p&gt;

&lt;p&gt;vs.&lt;/p&gt;

&lt;p&gt;if (newPosition &amp;gt; (bufferOffset + validBufferBytes) || newPosition &amp;lt; bufferOffset)&lt;/p&gt;

&lt;p&gt;Two things I noticed, we shouldn&apos;t need to rebuffer if newPosition is equal to bufferOffset + validBufferBytes, second the evaluation was doing (newPosition &amp;gt;= bufferOffset) + validBufferBytes which always seemed to be true.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12505751">CASSANDRA-2581</key>
            <summary>Rebuffer called excessively during seeks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lenn0x">Chris Goffinet</assignee>
                                    <reporter username="lenn0x">Chris Goffinet</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Apr 2011 04:34:04 +0000</created>
                <updated>Tue, 16 Apr 2019 09:33:00 +0000</updated>
                            <resolved>Tue, 3 May 2011 15:50:48 +0000</resolved>
                                        <fixVersion>0.7.6</fixVersion>
                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13027043" author="jbellis" created="Fri, 29 Apr 2011 15:53:17 +0000"  >&lt;blockquote&gt;&lt;p&gt;we shouldn&apos;t need to rebuffer if newPosition is equal to bufferOffset + validBufferBytes&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think that is correct, patch attached. I will ask Pavel to also review since this is extremely important not to break.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;second the evaluation was doing (newPosition &amp;gt;= bufferOffset) + validBufferBytes&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No, addition is higher precedence than comparison (or the logical operations). In fact if you force the grouping you suggest, javac will reject it since you cannot add a boolean and an int.&lt;/p&gt;</comment>
                            <comment id="13028151" author="xedin" created="Tue, 3 May 2011 10:49:08 +0000"  >&lt;p&gt;+1, we can just change &quot;current&quot; if we point on the last byte of the the buffer.&lt;/p&gt;</comment>
                            <comment id="13028234" author="jbellis" created="Tue, 3 May 2011 13:57:36 +0000"  >&lt;blockquote&gt;&lt;p&gt;we can just change &quot;current&quot; if we point on the last byte of the the buffer&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Meaning you suggest an additional code change?&lt;/p&gt;</comment>
                            <comment id="13028236" author="xedin" created="Tue, 3 May 2011 14:01:32 +0000"  >&lt;p&gt;No, I mean that the patch is correct, sorry &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13028272" author="jbellis" created="Tue, 3 May 2011 15:50:48 +0000"  >&lt;p&gt;committed goffinet&apos;s patch with the additional parentheses for clarity&lt;/p&gt;</comment>
                            <comment id="13028280" author="hudson" created="Tue, 3 May 2011 16:04:04 +0000"  >&lt;p&gt;Integrated in Cassandra-0.7 #466 (See &lt;a href=&quot;https://builds.apache.org/hudson/job/Cassandra-0.7/466/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/hudson/job/Cassandra-0.7/466/&lt;/a&gt;)&lt;br/&gt;
    fix excessively pessimistic rebuffering in BRAF writes&lt;br/&gt;
patch by goffinet; reviewed by jbellis and Pavel Yaskevich for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-2581&quot; title=&quot;Rebuffer called excessively during seeks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-2581&quot;&gt;&lt;del&gt;CASSANDRA-2581&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12477725" name="0001-Rebuffer-called-excessively-during-seeks.patch" size="1056" author="lenn0x" created="Fri, 29 Apr 2011 04:37:07 +0000"/>
                            <attachment id="12477807" name="2581.txt" size="626" author="jbellis" created="Fri, 29 Apr 2011 15:53:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[lenn0x]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20711</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 30 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gc7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>93410</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>xedin</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[xedin]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>