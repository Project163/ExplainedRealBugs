<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:04:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-12499] Row cache does not cache partitions on tables without clustering keys</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-12499</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;MLSEA-JJIRSA01:~ jjirsa$ ccm start
MLSEA-JJIRSA01:~ jjirsa$ echo &lt;span class=&quot;code-quote&quot;&gt;&quot;DESCRIBE TABLE test.test; &quot;&lt;/span&gt; | ccm node1 cqlsh

CREATE TABLE test.test (
    id &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; PRIMARY KEY,
    v text
) WITH bloom_filter_fp_chance = 0.01
    AND caching = {&lt;span class=&quot;code-quote&quot;&gt;&apos;keys&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;ALL&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;rows_per_partition&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;100&apos;&lt;/span&gt;}
    AND comment = &apos;&apos;
    AND compaction = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;max_threshold&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;32&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;min_threshold&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;4&apos;&lt;/span&gt;}
    AND compression = {&lt;span class=&quot;code-quote&quot;&gt;&apos;chunk_length_in_kb&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;64&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.io.compress.LZ4Compressor&apos;&lt;/span&gt;}
    AND crc_check_chance = 1.0
    AND dclocal_read_repair_chance = 0.1
    AND default_time_to_live = 0
    AND gc_grace_seconds = 864000
    AND max_index_interval = 2048
    AND memtable_flush_period_in_ms = 0
    AND min_index_interval = 128
    AND read_repair_chance = 0.0
    AND speculative_retry = &lt;span class=&quot;code-quote&quot;&gt;&apos;99PERCENTILE&apos;&lt;/span&gt;;

MLSEA-JJIRSA01:~ jjirsa$ ccm node1 nodetool info | grep Row
Row Cache              : entries 0, size 0 bytes, capacity 100 MiB, 0 hits, 0 requests, NaN recent hit rate, 0 save period in seconds
MLSEA-JJIRSA01:~ jjirsa$ echo &lt;span class=&quot;code-quote&quot;&gt;&quot;INSERT INTO test.test(id,v) VALUES(1, &lt;span class=&quot;code-quote&quot;&gt;&apos;a&apos;&lt;/span&gt;); &quot;&lt;/span&gt; | ccm node1 cqlsh
MLSEA-JJIRSA01:~ jjirsa$ echo &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM test.test WHERE id=1; &quot;&lt;/span&gt; | ccm node1 cqlsh

 id | v
----+---
  1 | a

(1 rows)
MLSEA-JJIRSA01:~ jjirsa$ ccm node1 nodetool info | grep Row
Row Cache              : entries 0, size 0 bytes, capacity 100 MiB, 0 hits, 0 requests, NaN recent hit rate, 0 save period in seconds
MLSEA-JJIRSA01:~ jjirsa$ echo &lt;span class=&quot;code-quote&quot;&gt;&quot;SELECT * FROM test.test WHERE id=1; &quot;&lt;/span&gt; | ccm node1 cqlsh

 id | v
----+---
  1 | a

(1 rows)
MLSEA-JJIRSA01:~ jjirsa$ ccm node1 nodetool info | grep Row
Row Cache              : entries 0, size 0 bytes, capacity 100 MiB, 0 hits, 0 requests, NaN recent hit rate, 0 save period in seconds
MLSEA-JJIRSA01:~ jjirsa$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12998399">CASSANDRA-12499</key>
            <summary>Row cache does not cache partitions on tables without clustering keys</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jjirsa">Jeff Jirsa</assignee>
                                    <reporter username="jjirsa">Jeff Jirsa</reporter>
                        <labels>
                            <label>Performance</label>
                    </labels>
                <created>Fri, 19 Aug 2016 05:49:49 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:21 +0000</updated>
                            <resolved>Wed, 21 Sep 2016 00:37:43 +0000</resolved>
                                        <fixVersion>3.0.10</fixVersion>
                    <fixVersion>3.10</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15427673" author="jjirsa" created="Fri, 19 Aug 2016 06:07:56 +0000"  >&lt;p&gt;Working as intended in:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;2.1.12&lt;/li&gt;
	&lt;li&gt;2.2.7&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Broken in:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;3.0.8&lt;/li&gt;
	&lt;li&gt;3.7&lt;/li&gt;
	&lt;li&gt;Trunk&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="15441819" author="jjirsa" created="Sat, 27 Aug 2016 15:59:04 +0000"  >&lt;p&gt;Branch here: &lt;a href=&quot;https://github.com/jeffjirsa/cassandra/commit/e7cb6c3409b889174d32c4eec9f60da380f39d3d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jeffjirsa/cassandra/commit/e7cb6c3409b889174d32c4eec9f60da380f39d3d&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Believe patch applies cleanly to 3.0 -&amp;gt; trunk (or it did a few days ago when written)&lt;/p&gt;

&lt;p&gt;testall shows no failures: &lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12499-testall/lastBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/jeffjirsa-cassandra-12499-testall/lastBuild/testReport/&lt;/a&gt;&lt;br/&gt;
dtest shows one failure that appears unrelated: &lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12499-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/jeffjirsa-cassandra-12499-dtest/&lt;/a&gt;&lt;/p&gt;


</comment>
                            <comment id="15483581" author="slebresne" created="Mon, 12 Sep 2016 09:09:20 +0000"  >&lt;p&gt;The change lgtm but a few small remarks:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;It&apos;s probably worth a comment as to why we have to special case tables without clustering columns.&lt;/li&gt;
	&lt;li&gt;For the test, instead of adding a new &lt;tt&gt;standardCFMD()&lt;/tt&gt; method with a new parameter, I&apos;d just make &lt;tt&gt;clusteringType == null&lt;/tt&gt; mean no clustering. You can also pull the &lt;tt&gt;.addClusteringColumn()&lt;/tt&gt; call on its own and call just that conditionally rather than duplicate 3 lines. Lastly, &lt;tt&gt;insertData&lt;/tt&gt; don&apos;t really need a new parameter, it can decide if it needs a clustering based on the &lt;tt&gt;CFMetaData&lt;/tt&gt;, which would be less error prone.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15499130" author="jjirsa" created="Sat, 17 Sep 2016 14:33:08 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt;. Implemented your changes, force pushed.&lt;/p&gt;

&lt;p&gt;Patch here: &lt;a href=&quot;https://github.com/apache/cassandra/compare/trunk...jeffjirsa:cassandra-12499.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/compare/trunk...jeffjirsa:cassandra-12499.patch&lt;/a&gt;&lt;br/&gt;
Cassci running, test reports should be here: &lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12499-testall/lastBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/jeffjirsa-cassandra-12499-testall/lastBuild/testReport/&lt;/a&gt; and &lt;a href=&quot;http://cassci.datastax.com/job/jeffjirsa-cassandra-12499-dtest/lastBuild/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cassci.datastax.com/job/jeffjirsa-cassandra-12499-dtest/lastBuild/testReport/&lt;/a&gt; in a few hours. &lt;/p&gt;
</comment>
                            <comment id="15502665" author="slebresne" created="Mon, 19 Sep 2016 08:11:39 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15508263" author="jjirsa" created="Wed, 21 Sep 2016 00:37:44 +0000"  >&lt;p&gt;Committed in &lt;tt&gt;eace9aaddfdd0059f52b1eb9b6902f999f04a447&lt;/tt&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jjirsa]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 8 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32ibj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>