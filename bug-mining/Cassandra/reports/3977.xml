<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:59:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-10739] Timeout for CQL Deletes on an Entire Partition Against Specified Columns</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-10739</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cqlsh:graphs&amp;gt; delete color from composite_pk where k1 = &apos;1&apos; and k2 = &apos;1&apos;;
cqlsh:graphs&amp;gt; create table composite_with_clustering(k1 text, k2 text, c1 text, color text, value float, primary key ((k1, k2), c1));
cqlsh:graphs&amp;gt; insert into composite_with_clustering(k1, k2, c1, value) values (&apos;1&apos;,&apos;1&apos;, &apos;1&apos;, 6);
cqlsh:graphs&amp;gt; insert into composite_with_clustering(k1, k2, c1, color) values (&apos;1&apos;,&apos;1&apos;, &apos;2&apos;, &apos;green&apos;);
cqlsh:graphs&amp;gt; delete color from composite_with_clustering where k1 = &apos;1&apos; and k2 = &apos;1&apos;;
WriteTimeout: code=1100 [Coordinator node timed out waiting for replica nodes&apos; responses] message=&quot;Operation timed out - received only 0 responses.&quot; info={&apos;received_responses&apos;: 0, &apos;required_responses&apos;: 1, &apos;consistency&apos;: &apos;ONE&apos;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;tt&gt;Clustering$Serializer&lt;/tt&gt; clearly doesn&apos;t like this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;WARN  [SharedPool-Worker-2] 2015-11-19 20:55:15,935  AbstractTracingAwareExecutorService.java:169 - Uncaught exception on thread Thread[SharedPool-Worker-2,5,main]: {}
java.lang.AssertionError: Invalid clustering for the table: org.apache.cassandra.db.Clustering$2@3157dded
	at org.apache.cassandra.db.Clustering$Serializer.serialize(Clustering.java:136) ~[cassandra-all-3.0.0.710.jar:3.0.0.710]
	at org.apache.cassandra.db.rows.UnfilteredSerializer.serialize(UnfilteredSerializer.java:159) ~[cassandra-all-3.0.0.710.jar:3.0.0.710]
	at org.apache.cassandra.db.rows.UnfilteredSerializer.serialize(UnfilteredSerializer.java:108) ~[cassandra-all-3.0.0.710.jar:3.0.0.710]
	at org.apache.cassandra.db.rows.UnfilteredSerializer.serialize(UnfilteredSerializer.java:96) ~[cassandra-all-3.0.0.710.jar:3.0.0.710]
	at org.apache.cassandra.db.rows.UnfilteredRowIteratorSerializer.serialize(UnfilteredRowIteratorSerializer.java:132) ~[cassandra-all-3.0.0.710.jar:3.0.0.710]
	at org.apache.cassandra.db.rows.UnfilteredRowIteratorSerializer.serialize(UnfilteredRowIteratorSerializer.java:87) ~[cassandra-all-3.0.0.710.jar:3.0.0.710]
	at org.apache.cassandra.db.partitions.PartitionUpdate$PartitionUpdateSerializer.serialize(PartitionUpdate.java:599) ~[cassandra-all-3.0.0.710.jar:3.0.0.710]
	at org.apache.cassandra.db.Mutation$MutationSerializer.serialize(Mutation.java:291) ~[cassandra-all-3.0.0.710.jar:3.0.0.710]
	at org.apache.cassandra.db.commitlog.CommitLog.add(CommitLog.java:279) ~[cassandra-all-3.0.0.710.jar:3.0.0.710]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If this isn&apos;t supported, there should probably be a more obvious error message.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12914616">CASSANDRA-10739</key>
            <summary>Timeout for CQL Deletes on an Entire Partition Against Specified Columns</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="blerer">Benjamin Lerer</assignee>
                                    <reporter username="maedhroz">Caleb Rackliffe</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 Nov 2015 21:07:07 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:49 +0000</updated>
                            <resolved>Tue, 1 Dec 2015 17:17:57 +0000</resolved>
                                        <fixVersion>3.0.1</fixVersion>
                    <fixVersion>3.1</fixVersion>
                                    <component>Legacy/CQL</component>
                    <component>Legacy/Local Write-Read Paths</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15015581" author="slebresne" created="Fri, 20 Nov 2015 10:46:05 +0000"  >&lt;p&gt;This is theoretically meant to work following &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6237&quot; title=&quot;Allow range deletions in CQL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-6237&quot;&gt;&lt;del&gt;CASSANDRA-6237&lt;/del&gt;&lt;/a&gt; so we should investigate why it doesn&apos;t. But of course, if we can&apos;t make it work easily for some reason, we should throw a meaningful exception.&lt;/p&gt;</comment>
                            <comment id="15024600" author="blerer" created="Tue, 24 Nov 2015 14:31:31 +0000"  >&lt;p&gt;The request &lt;tt&gt;delete color from composite_with_clustering where k1 = &apos;1&apos; and k2 = &apos;1&apos;;&lt;/tt&gt;  is invalid as range deletions are not supported for specific columns.&lt;br/&gt;
The request would be valid if &lt;tt&gt;color&lt;/tt&gt; was a static column or if the table had no clustering keys.&lt;br/&gt;
The problem comes from the fact that I forgot to check in &lt;tt&gt;DeleteStatement&lt;/tt&gt; if the table was having none of its clustering keys specified. &lt;/p&gt;

&lt;p&gt;The patch adds this extra check and a unit tests to verify that the proper error is being thrown.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-10739-3.0-testall/1/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-10739-trunk-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-10739-3.0-dtest/2/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/blerer/job/blerer-10739-trunk-dtest/1/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15024601" author="blerer" created="Tue, 24 Nov 2015 14:32:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=carlyeks&quot; class=&quot;user-hover&quot; rel=&quot;carlyeks&quot;&gt;carlyeks&lt;/a&gt; could you review?&lt;/p&gt;</comment>
                            <comment id="15032279" author="carlyeks" created="Mon, 30 Nov 2015 19:12:35 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15034100" author="blerer" created="Tue, 1 Dec 2015 17:17:07 +0000"  >&lt;p&gt;Thanks for the review.&lt;/p&gt;</comment>
                            <comment id="15034101" author="blerer" created="Tue, 1 Dec 2015 17:17:57 +0000"  >&lt;p&gt;committed in 3.0 at 3864b2114ab11a02cf55e91c1e5553c9c4f854bc and merged into 3.1 and trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12774068" name="10739-3.0.txt" size="3205" author="blerer" created="Tue, 24 Nov 2015 14:31:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[blerer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 51 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ony7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333634">3.0.0 rc2</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>carlyeks</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[carlyeks]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>