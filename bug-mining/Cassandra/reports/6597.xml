<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:31:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-20208] audit_logging_options parameters are not sanitized when loaded from a configuration file on startup</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-20208</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;based on the discussion in &lt;a href=&quot;https://lists.apache.org/thread/3whc30bqfcr1vgwv73zwlv74l2v3c0gt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread/3whc30bqfcr1vgwv73zwlv74l2v3c0gt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;a configuration like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
audit_logging_options:
&#160; enabled: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&#160; logger:
&#160; &#160; - class_name: FileAuditLogger
&#160; included_categories: DCL, ERROR, AUTH &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;is not sanitized when it is loaded on startup from cassandra.yaml file - spaces here are remaining: &quot; ERROR&quot;, &quot; AUTH&quot; after parsing. As a result the audit logs filtering works not in a way as a user may expect and it is hard to troubleshoot:&lt;br/&gt;
&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13074015/13074015_audit_filtering_state.png&quot; width=&quot;400&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;When we run nodetool enableauditlog&#160;the following logic is invoked:&#160;&lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-4.1.7/src/java/org/apache/cassandra/service/StorageService.java#L6459&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-4.1.7/src/java/org/apache/cassandra/service/StorageService.java#L6459&lt;/a&gt; which rebuild&#160;AuditLogOptions using builder API.AuditLogOption.build() has sanitisation logic which does the trimming:&#160;&lt;a href=&quot;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/audit/AuditLogOptions.java#L235&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/trunk/src/java/org/apache/cassandra/audit/AuditLogOptions.java#L235&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;org.apache.cassandra.config.Config#audit_logging_options is created a generic reflective code which does not use the builder, so there is no trimming during a startup.&lt;/p&gt;

&lt;p&gt;It can be fixed by adding sanitisation during the startup parsing too to make the behaviour more consistent and less error prone.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13605056">CASSANDRA-20208</key>
            <summary>audit_logging_options parameters are not sanitized when loaded from a configuration file on startup</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="smiklosovic">Stefan Miklosovic</assignee>
                                    <reporter username="dnk">Dmitry Konstantinov</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Jan 2025 11:15:39 +0000</created>
                <updated>Sat, 18 Jan 2025 17:09:31 +0000</updated>
                            <resolved>Sat, 18 Jan 2025 17:09:31 +0000</resolved>
                                        <fixVersion>4.1.8</fixVersion>
                    <fixVersion>5.0.3</fixVersion>
                    <fixVersion>5.1</fixVersion>
                                    <component>Observability/Logging</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="600">10m</timespent>
                                <comments>
                            <comment id="17914082" author="smiklosovic" created="Fri, 17 Jan 2025 12:44:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dnk&quot; class=&quot;user-hover&quot; rel=&quot;dnk&quot;&gt;dnk&lt;/a&gt; the PR is up. Test is not necessary because it is tested already in org.apache.cassandra.audit.AuditLogOptionsTest&lt;/p&gt;</comment>
                            <comment id="17914100" author="dnk" created="Fri, 17 Jan 2025 13:23:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smiklosovic&quot; class=&quot;user-hover&quot; rel=&quot;smiklosovic&quot;&gt;smiklosovic&lt;/a&gt; thank you for fixing it.&lt;br/&gt;
LGTM. I have also tested the change manually - it works. Sorry, I cannot give you a hand with committing as a non-committer &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Should we apply it not only to trunk but at least to 5.0.x  and, potentially, to 4.x too?&lt;/p&gt;</comment>
                            <comment id="17914102" author="brandon.williams" created="Fri, 17 Jan 2025 13:28:18 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17914111" author="smiklosovic" created="Fri, 17 Jan 2025 13:51:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dnk&quot; class=&quot;user-hover&quot; rel=&quot;dnk&quot;&gt;dnk&lt;/a&gt; I am willing to fix that from 4.1 up. In 4.0 there is no sanitation at all and a lot of code around is not there and I am not going to mess with that.&lt;/p&gt;</comment>
                            <comment id="17914112" author="dnk" created="Fri, 17 Jan 2025 13:54:10 +0000"  >&lt;p&gt;Sounds good&lt;/p&gt;</comment>
                            <comment id="17914316" author="smiklosovic" created="Sat, 18 Jan 2025 10:23:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-20208&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-20208&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java17_pre-commit_tests                         
  &#10003; j17_build                                        4m 50s
  &#10003; j17_cqlsh_dtests_py311                           6m 57s
  &#10003; j17_cqlsh_dtests_py311_vnode                     7m 22s
  &#10003; j17_cqlsh_dtests_py38                            6m 59s
  &#10003; j17_cqlsh_dtests_py38_vnode                      9m 32s
  &#10003; j17_cqlshlib_cython_tests                        11m 9s
  &#10003; j17_cqlshlib_tests                               6m 40s
  &#10003; j17_jvm_dtests_latest_vnode                      16m 6s
  &#10003; j17_unit_tests                                  14m 42s
  &#10003; j17_utests_latest                               14m 54s
  &#10003; j17_utests_oa                                   15m 14s
  &#10005; j17_dtests                                      33m 52s
      compaction_test.TestCompaction test_compaction_throughput
      refresh_test.TestRefresh test_refresh_deadlock_startup
  &#10005; j17_dtests_latest                                39m 1s
      read_repair_test.TestSpeculativeReadRepair test_failed_read_repair
      read_repair_test.TestSpeculativeReadRepair test_quorum_requirement
      read_repair_test.TestSpeculativeReadRepair test_quorum_requirement_on_speculated_read
      read_repair_test.TestSpeculativeReadRepair test_speculative_data_request
  &#10005; j17_dtests_vnode                                41m 45s
      compaction_test.TestCompaction test_compaction_throughput
  &#10005; j17_jvm_dtests                                  20m 48s
      org.apache.cassandra.fuzz.ring.ConsistentBootstrapTest coordinatorIsBehindTest                            
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5220/workflows/4be5451c-b3ff-4403-9454-44062c85dfff&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java17_pre-commit_tests&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17914347" author="smiklosovic" created="Sat, 18 Jan 2025 17:02:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-20208-5.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-20208-5.0&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java17_pre-commit_tests                         
  &#10003; j17_build                                        3m 57s
  &#10003; j17_cqlsh_dtests_py311                           6m 43s
  &#10003; j17_cqlsh_dtests_py38                            6m 42s
  &#10003; j17_cqlshlib_cython_tests                        7m 38s
  &#10003; j17_cqlshlib_tests                                7m 2s
  &#10003; j17_dtests_latest                                43m 3s
  &#10003; j17_jvm_dtests                                  21m 50s
  &#10003; j17_unit_tests                                  16m 34s
  &#10003; j17_utests_latest                                17m 9s
  &#10003; j17_utests_oa                                   16m 45s
  &#10005; j17_cqlsh_dtests_py311_vnode                     7m 48s
      cqlsh_tests.test_cqlsh_copy.TestCqlshCopy test_bulk_round_trip_with_timeouts
  &#10005; j17_cqlsh_dtests_py38_vnode                      7m 46s
      cqlsh_tests.test_cqlsh_copy.TestCqlshCopy test_bulk_round_trip_with_timeouts
  &#10005; j17_dtests                                      32m 51s
      refresh_test.TestRefresh test_refresh_deadlock_startup
  &#10005; j17_dtests_vnode                                40m 43s
      bootstrap_test.TestBootstrap test_decommissioned_wiped_node_can_join
  &#10005; j17_jvm_dtests_latest_vnode                     15m 50s
      org.apache.cassandra.distributed.test.ReadSpeculationTest speculateTest
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5226/workflows/2d38246a-c4a5-4c31-8347-0c1907a8cb1b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java17_pre-commit_tests&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17914348" author="smiklosovic" created="Sat, 18 Jan 2025 17:03:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/instaclustr/cassandra/tree/CASSANDRA-20208-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CASSANDRA-20208-4.1&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java11_pre-commit_tests                         
  &#10003; j11_build                                        1m 52s
  &#10003; j11_cqlsh_dtests_py311                           5m 51s
  &#10003; j11_cqlsh_dtests_py311_vnode                     5m 52s
  &#10003; j11_cqlsh_dtests_py38                            5m 37s
  &#10003; j11_cqlsh_dtests_py38_vnode                      8m 53s
  &#10003; j11_cqlsh_dtests_py3_vnode                       5m 32s
  &#10003; j11_cqlshlib_cython_tests                        7m 23s
  &#10003; j11_cqlshlib_tests                                6m 9s
  &#10003; j11_dtests_vnode                                40m 43s
  &#10003; j11_jvm_dtests                                  14m 59s
  &#10003; j11_jvm_dtests_vnode                            13m 55s
  &#10003; j11_unit_tests                                  10m 18s
  &#10005; j11_cqlsh_dtests_py3                             7m 25s
      cqlsh_tests.test_cqlsh_copy.TestCqlshCopy test_bulk_round_trip_with_timeouts
  &#10005; j11_dtests                                      53m 14s
      refresh_test.TestRefresh test_refresh_deadlock_startup&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/instaclustr/cassandra/5227/workflows/8310709e-ef75-4fd2-bcc3-1de5f8a6e863&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java11_pre-commit_tests&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13074015" name="audit_filtering_state.png" size="595122" author="dnk" created="Wed, 15 Jan 2025 11:16:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[smiklosovic]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="13163" cascade-level=""><![CDATA[Code]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12964"><![CDATA[Low Hanging Fruit]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12313922" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Impacts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13100"><![CDATA[None]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            42 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1tmls:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12350367">4.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/f66183a711dd440b3619a960ba4e5444c1c900ff&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/f66183a711dd440b3619a960ba4e5444c1c900ff&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;ci and manual&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>