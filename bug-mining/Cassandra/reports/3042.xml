<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:47:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-7599] Dtest on low cardinality secondary indexes failing in 2.1</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-7599</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;test_low_cardinality_indexes in secondary_indexes_test.py is failing when tested on the cassandra-2.1 branch. This test has been failing on cassci for a while (at least the last 10 builds) and can easily be reproduced locally as well. It appears to still work on 2.0.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;======================================================================
FAIL: test_low_cardinality_indexes (secondary_indexes_test.TestSecondaryIndexes)
----------------------------------------------------------------------
Traceback (most recent call last):
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/shawn/git/cstar5/cassandra-dtest/tools.py&quot;&lt;/span&gt;, line 213, in wrapped
    f(obj)
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/shawn/git/cstar5/cassandra-dtest/secondary_indexes_test.py&quot;&lt;/span&gt;, line 89, in test_low_cardinality_indexes
    check_request_order()
  File &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/shawn/git/cstar5/cassandra-dtest/secondary_indexes_test.py&quot;&lt;/span&gt;, line 84, in check_request_order
    self.assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&apos;Executing indexed scan&apos;&lt;/span&gt; in relevant_events[-1][0], str(relevant_events[-1]))
AssertionError: (u&lt;span class=&quot;code-quote&quot;&gt;&apos;Enqueuing request to /127.0.0.2&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;127.0.0.1&apos;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The test checks that a series of messages are found in the trace after a select query against an index is carried out. It fails to find an &apos;Executing indexed scan&apos; from node 1 (which takes the query, note both node2 and node3 produced this message). Brief investigation seemed to show that whichever node you create the patient_cql_connection on will not produce this message, indicating perhaps it does not carry out the scan.  Should also note that changing &apos;numrows&apos; (rows initially added) or &apos;b&apos; (value on index column we query for) does not appear to make a difference.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12729214">CASSANDRA-7599</key>
            <summary>Dtest on low cardinality secondary indexes failing in 2.1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thobbs">Tom Hobbs</assignee>
                                    <reporter username="shawn.kumar">Shawn Kumar</reporter>
                        <labels>
                            <label>qa-resolved</label>
                    </labels>
                <created>Wed, 23 Jul 2014 17:27:01 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:39 +0000</updated>
                            <resolved>Tue, 12 Aug 2014 18:34:22 +0000</resolved>
                                        <fixVersion>2.1.0</fixVersion>
                                    <component>Feature/2i Index</component>
                    <component>Test/dtest/python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14072401" author="thobbs" created="Wed, 23 Jul 2014 21:44:53 +0000"  >&lt;p&gt;The problem is that tracing isn&apos;t working locally after the LocalRangeSliceRunnable is submitted to the READ stage.&lt;/p&gt;</comment>
                            <comment id="14072450" author="thobbs" created="Wed, 23 Jul 2014 22:09:32 +0000"  >&lt;p&gt;The solution was to pass the TracingState to the thread pool executor for local range slices.  I also noticed that the READ verb was being used for local range slices instead of RANGE_SLICE, so the timeout and dropped message counts were incorrect.&lt;/p&gt;

&lt;p&gt;7599.txt (and &lt;a href=&quot;https://github.com/thobbs/cassandra/tree/CASSANDRA-7599&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;) fixes both of those issues.&lt;/p&gt;</comment>
                            <comment id="14074702" author="brandon.williams" created="Fri, 25 Jul 2014 18:07:13 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14074736" author="thobbs" created="Fri, 25 Jul 2014 18:27:37 +0000"  >&lt;p&gt;Thanks, committed.&lt;/p&gt;</comment>
                            <comment id="14088020" author="philipthompson" created="Wed, 6 Aug 2014 18:45:41 +0000"  >&lt;p&gt;The test has begun failing on 2.1.0 again for the same reason. The end of the trace looks like: &lt;a href=&quot;http://aep.appspot.com/display/FS1tjJE8gpgYR5Zo6XjVXjgoxmU/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://aep.appspot.com/display/FS1tjJE8gpgYR5Zo6XjVXjgoxmU/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14090712" author="slebresne" created="Fri, 8 Aug 2014 12:35:11 +0000"  >&lt;p&gt;The error that I get (sometimes, not every run) with this test on current 2.1.0 is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;======================================================================
FAIL: test_low_cardinality_indexes (secondary_indexes_test.TestSecondaryIndexes)
----------------------------------------------------------------------
Traceback (most recent call last):
  File &quot;/home/mcmanus/Git/dtest-cassandra/tools.py&quot;, line 213, in wrapped
    f(obj)
  File &quot;/home/mcmanus/Git/dtest-cassandra/secondary_indexes_test.py&quot;, line 94, in test_low_cardinality_indexes
    check_request_order()
  File &quot;/home/mcmanus/Git/dtest-cassandra/secondary_indexes_test.py&quot;, line 83, in check_request_order
    self.assertTrue(&apos;Enqueuing&apos; in relevant_events[1][0], str(relevant_events[1]))
AssertionError: (u&apos;Executing indexed scan for [min(-9223372036854775808), max(-9192447039475188032)]&apos;, &apos;127.0.0.1&apos;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is different from the initial error of this ticket, it complains because it expect the 2 first lines of the trace to be &apos;Enqueuing ....&apos; while it gets a &apos;Executing indexed scan&apos; for localhost first. But as far as I can tell, it&apos;s the test that gets it wrong: scan for localhost are optimized and pushed on a stage concurrently from the loop that adds the &apos;Enqueuing&apos; message so there is nothing unexpected in the order the message appear.&lt;/p&gt;</comment>
                            <comment id="14090762" author="philipthompson" created="Fri, 8 Aug 2014 13:43:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thobbs&quot; class=&quot;user-hover&quot; rel=&quot;thobbs&quot;&gt;thobbs&lt;/a&gt; recently made changes to the test that may have resolved this.&lt;/p&gt;</comment>
                            <comment id="14090917" author="thobbs" created="Fri, 8 Aug 2014 16:11:05 +0000"  >&lt;p&gt;Specifically, this was the dtest fix: &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/commit/2f2b4b67cf875f3b0502284326b15ab880b980d4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/riptano/cassandra-dtest/commit/2f2b4b67cf875f3b0502284326b15ab880b980d4&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14090924" author="slebresne" created="Fri, 8 Aug 2014 16:19:10 +0000"  >&lt;p&gt;I believe the error I posted just above is after this &quot;fix&quot;. I still think the test is wrong in its assumptions.&lt;/p&gt;</comment>
                            <comment id="14090963" author="thobbs" created="Fri, 8 Aug 2014 16:57:40 +0000"  >&lt;p&gt;You&apos;re correct.  As is, it&apos;s hard to make that test not race-prone, so 7599-follow-up.txt adds extra trace information (which should be useful in any case).  I have a new &lt;a href=&quot;https://github.com/thobbs/cassandra-dtest/tree/CASSANDRA-7599-fix-2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest branch&lt;/a&gt; to utilize the new trace info.&lt;/p&gt;</comment>
                            <comment id="14092799" author="slebresne" created="Mon, 11 Aug 2014 14:12:30 +0000"  >&lt;p&gt;&amp;lt;bikeshedding&amp;gt;Feels slightly weird that we might have multiple &lt;tt&gt;&quot;Finished submitting {} concurrent range requests&quot;&lt;/tt&gt; logs for only one &lt;tt&gt;&quot;Submitting {} concurrent range requests&quot;&lt;/tt&gt;. It&apos;s a detail, just the symmetry of the messages looks weird. Also, it&apos;s a minor detail but the finished message use &lt;tt&gt;concurrencyFactor&lt;/tt&gt; while less than that can have been sent. Anyway, attaching a slightly different alternative.&amp;lt;/bikeshedding&amp;gt;&lt;/p&gt;</comment>
                            <comment id="14094465" author="thobbs" created="Tue, 12 Aug 2014 18:34:23 +0000"  >&lt;p&gt;+1 on the bikeshed changes.&lt;/p&gt;

&lt;p&gt;Committed to 2.1.0 and committed the (updated) dtest here: &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/commit/0de37a40de4e5a818e1107cf2b88605aa4ba9fb2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/riptano/cassandra-dtest/commit/0de37a40de4e5a818e1107cf2b88605aa4ba9fb2&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12660661" name="7599-follow-up.txt" size="1431" author="thobbs" created="Fri, 8 Aug 2014 16:57:40 +0000"/>
                            <attachment id="12660991" name="7599-followup-bikeshed.txt" size="3106" author="slebresne" created="Mon, 11 Aug 2014 14:12:30 +0000"/>
                            <attachment id="12657463" name="7599.txt" size="1250" author="thobbs" created="Wed, 23 Jul 2014 22:09:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407288</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1y33r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407304</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327541">2.1 rc5</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311124" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Tester</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>shawn.kumar</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>