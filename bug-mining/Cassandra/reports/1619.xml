<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:32:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-4255] concurrent modif ex when repair is run on LCS</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-4255</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;came across this, will try to figure a way to systematically reprod this. But the problem is the sstable list in the manifest is changing as the repair is triggered:&lt;/p&gt;

&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;Exception in thread &quot;main&quot; java.util.ConcurrentModificationException &lt;br/&gt;
 at java.util.AbstractList$Itr.checkForComodification(Unknown Source)&lt;br/&gt;
 at java.util.AbstractList$Itr.next(Unknown Source)&lt;br/&gt;
 at org.apache.cassandra.io.sstable.SSTable.getTotalBytes(SSTable.java:250)&lt;br/&gt;
 at org.apache.cassandra.db.compaction.LeveledManifest.getEstimatedTasks(LeveledManifest.java:435)&lt;br/&gt;
 at org.apache.cassandra.db.compaction.LeveledCompactionStrategy.getEstimatedRemainingTasks(LeveledCompactionStrategy.java:128)&lt;br/&gt;
 at org.apache.cassandra.db.compaction.CompactionManager.getPendingTasks(CompactionManager.java:1063)&lt;br/&gt;
 at sun.reflect.GeneratedMethodAccessor73.invoke(Unknown Source)&lt;br/&gt;
 at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
 at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
 at com.sun.jmx.mbeanserver.StandardMBeanIntrospector.invokeM2(Unknown Source)&lt;br/&gt;
 at com.sun.jmx.mbeanserver.StandardMBeanIntrospector.invokeM2(Unknown Source)&lt;br/&gt;
 at com.sun.jmx.mbeanserver.MBeanIntrospector.invokeM(Unknown Source)&lt;br/&gt;
 at com.sun.jmx.mbeanserver.PerInterface.getAttribute(Unknown Source)&lt;br/&gt;
 at com.sun.jmx.mbeanserver.MBeanSupport.getAttribute(Unknown Source)&lt;br/&gt;
 at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(Unknown Source)&lt;br/&gt;
 at com.sun.jmx.mbeanserver.JmxMBeanServer.getAttribute(Unknown Source)&lt;br/&gt;
 at javax.management.remote.rmi.RMIConnectionImpl.doOperation(Unknown Source)&lt;br/&gt;
 at javax.management.remote.rmi.RMIConnectionImpl.access$200(Unknown Source)&lt;br/&gt;
 at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(Unknown Source)&lt;br/&gt;
 at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(Unknown Source)&lt;br/&gt;
 at javax.management.remote.rmi.RMIConnectionImpl.getAttribute(Unknown Source)&lt;br/&gt;
 at sun.reflect.GeneratedMethodAccessor7.invoke(Unknown Source)&lt;br/&gt;
 at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
 at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
 at sun.rmi.server.UnicastServerRef.dispatch(Unknown Source)&lt;br/&gt;
 at sun.rmi.transport.Transport$1.run(Unknown Source)&lt;br/&gt;
 at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
 at sun.rmi.transport.Transport.serviceCall(Unknown Source)&lt;br/&gt;
 at sun.rmi.transport.tcp.TCPTransport.handleMessages(Unknown Source)&lt;br/&gt;
 at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(Unknown Source)&lt;br/&gt;
 at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(Unknown Source)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)&lt;br/&gt;
 at java.lang.Thread.run(Unknown Source)&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;maybe we could change the list to a copyOnArrayList? just a suggestion, haven&apos;t investigated much yet:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;LeveledManifest.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;generations[i] = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;SSTableReader&amp;gt;();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12556268">CASSANDRA-4255</key>
            <summary>concurrent modif ex when repair is run on LCS</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="cywjackson">Jackson Chung</reporter>
                        <labels>
                            <label>compaction</label>
                            <label>lcs</label>
                    </labels>
                <created>Thu, 17 May 2012 18:29:34 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:34 +0000</updated>
                            <resolved>Mon, 21 May 2012 16:52:46 +0000</resolved>
                                        <fixVersion>1.0.11</fixVersion>
                    <fixVersion>1.1.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13278113" author="jbellis" created="Thu, 17 May 2012 19:13:54 +0000"  >&lt;p&gt;patch attached to synchronize getEstimatedTasks.  copyOnWriteArrayList would probably work too, but we already synchronize other accesses (to prevent cross-level races) so that&apos;s simplest here.&lt;/p&gt;</comment>
                            <comment id="13278220" author="jbellis" created="Thu, 17 May 2012 20:23:49 +0000"  >&lt;p&gt;Looks like this only affects getEstimatedTasks, not actually repair.&lt;/p&gt;</comment>
                            <comment id="13280066" author="slebresne" created="Mon, 21 May 2012 10:21:08 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13280274" author="jbellis" created="Mon, 21 May 2012 16:52:46 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12527888" name="4255.txt" size="583" author="jbellis" created="Thu, 17 May 2012 19:13:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>255997</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gtsn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96257</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>