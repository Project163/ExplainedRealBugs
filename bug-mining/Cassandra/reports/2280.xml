<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:39:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-5793] OPP seems completely unsupported</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-5793</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;We were using 0.7.6 version. And upgraded to 1.2.5 today. We were using OPP (OrderPreservingPartitioner).&lt;/p&gt;

&lt;p&gt;OPP throws error when any node join the cluster. Cluster can not be brought up due to this error. After digging little deep, We realized that &quot;peers&quot; column family is defined with key as type &quot;inet&quot;. Looks like many other column families in system keyspace has same issue.&lt;/p&gt;

&lt;p&gt;Exception trace:&lt;br/&gt;
java.lang.RuntimeException: The provided key was not UTF8 encoded.&lt;br/&gt;
	at org.apache.cassandra.dht.OrderPreservingPartitioner.getToken(OrderPreservingPartitioner.java:172)&lt;br/&gt;
	at org.apache.cassandra.dht.OrderPreservingPartitioner.decorateKey(OrderPreservingPartitioner.java:44)&lt;br/&gt;
	at org.apache.cassandra.db.Table.apply(Table.java:379)&lt;br/&gt;
	at org.apache.cassandra.db.Table.apply(Table.java:353)&lt;br/&gt;
	at org.apache.cassandra.db.RowMutation.apply(RowMutation.java:258)&lt;br/&gt;
	at org.apache.cassandra.cql3.statements.ModificationStatement.executeInternal(ModificationStatement.java:117)&lt;br/&gt;
	at org.apache.cassandra.cql3.QueryProcessor.processInternal(QueryProcessor.java:172)&lt;br/&gt;
	at org.apache.cassandra.db.SystemTable.updatePeerInfo(SystemTable.java:258)&lt;br/&gt;
	at org.apache.cassandra.service.StorageService.onChange(StorageService.java:1231)&lt;br/&gt;
	at org.apache.cassandra.service.StorageService.onJoin(StorageService.java:1948)&lt;br/&gt;
	at org.apache.cassandra.gms.Gossiper.handleMajorStateChange(Gossiper.java:823)&lt;br/&gt;
	at org.apache.cassandra.gms.Gossiper.applyStateLocally(Gossiper.java:901)&lt;br/&gt;
	at org.apache.cassandra.gms.GossipDigestAck2VerbHandler.doVerb(GossipDigestAck2VerbHandler.java:50)&lt;/p&gt;


&lt;p&gt;Possibilities:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Changing partitioner to BOP (or something else) fails while loading schema_keyspaces. So, it does not look like an option.&lt;/li&gt;
	&lt;li&gt;One possibility is that getToken of OPP can return hex value if it fails to encode bytes to UTF-8 instead of throwing error. By this system tables seem to be working fine with OPP.&lt;/li&gt;
	&lt;li&gt;Or Completely remove OPP from code base &amp;amp; configuration files. Mark clearly that OPP is no longer supported in upgrade instructions.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;Cassandra on Ubuntu&lt;/p&gt;</environment>
        <key id="12659295">CASSANDRA-5793</key>
            <summary>OPP seems completely unsupported</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="varakumar">Vara Kumar</assignee>
                                    <reporter username="varakumar">Vara Kumar</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Jul 2013 09:42:44 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:09 +0000</updated>
                            <resolved>Tue, 30 Jul 2013 20:40:14 +0000</resolved>
                                        <fixVersion>1.2.9</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13716289" author="jeromatron" created="Tue, 23 Jul 2013 10:32:48 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://github.com/apache/cassandra/blob/cassandra-1.2.6/NEWS.txt#L184-L186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/blob/cassandra-1.2.6/NEWS.txt#L184-L186&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can&apos;t change partitioner once the data has been written.  Rows of data are ordered in sstables according to the partitioner.  You can upgrade to 1.1.x or stay at 0.7, then using Hadoop or a batch job, you can read from your existing cluster and write to a different cluster running 1.2.6 with your new partitioner.&lt;/p&gt;</comment>
                            <comment id="13716366" author="jeromatron" created="Tue, 23 Jul 2013 12:59:15 +0000"  >&lt;p&gt;I suppose I was assuming that you were using the now removed COPP, but since you&apos;re using just the OPP, that &lt;b&gt;should&lt;/b&gt; work.  Sorry for the confusion.&lt;/p&gt;</comment>
                            <comment id="13716384" author="jbellis" created="Tue, 23 Jul 2013 13:31:15 +0000"  >&lt;blockquote&gt;&lt;p&gt;One possibility is that getToken of OPP can return hex value if it fails to encode bytes to UTF-8 instead of throwing error.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I can&apos;t think of how it would break anything to accept keys we previously rejected.&lt;/p&gt;</comment>
                            <comment id="13723553" author="varakumar" created="Tue, 30 Jul 2013 08:21:13 +0000"  >&lt;p&gt;Should we handle in this way (return hex value if OPP fails to encode bytes to UTF-8 instead of throwing error) &amp;amp; mark OPP as unsupported in relevant documentation?&lt;/p&gt;</comment>
                            <comment id="13724378" author="jbellis" created="Tue, 30 Jul 2013 20:40:14 +0000"  >&lt;p&gt;Made the change to OPP in 2ccbe3c6f547511e79454b79cbef682ef8a6973a.&lt;/p&gt;

&lt;p&gt;cassandra.yaml has noted that OPP is deprecated in favor of BOP for... years.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[varakumar]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>339488</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1mjyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>339808</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jbellis</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>