<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:46:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-7200] word count broken</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-7200</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;word_count_setup hangs forever, and word_count loops forever with this exception:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;DEBUG 17:52:42,875 java.io.IOException: config(config)
        at org.apache.hadoop.conf.Configuration.&amp;lt;init&amp;gt;(Configuration.java:260)
        at org.apache.hadoop.mapred.JobConf.&amp;lt;init&amp;gt;(JobConf.java:341)
        at org.apache.hadoop.mapreduce.JobContext.&amp;lt;init&amp;gt;(JobContext.java:76)
        at org.apache.hadoop.mapreduce.TaskAttemptContext.&amp;lt;init&amp;gt;(TaskAttemptContext.java:35)
        at org.apache.hadoop.mapreduce.TaskInputOutputContext.&amp;lt;init&amp;gt;(TaskInputOutputContext.java:44)
        at org.apache.hadoop.mapreduce.MapContext.&amp;lt;init&amp;gt;(MapContext.java:43)
        at org.apache.hadoop.mapreduce.Mapper$Context.&amp;lt;init&amp;gt;(Mapper.java:105)
        at sun.reflect.GeneratedConstructorAccessor14.newInstance(Unknown Source)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:526)
        at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:759)
        at org.apache.hadoop.mapred.MapTask.run(MapTask.java:370)
        at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:212)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12713358">CASSANDRA-7200</key>
            <summary>word count broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ala.alkhaldi">Ala&apos; Alkhaldi</assignee>
                                    <reporter username="brandon.williams">Brandon Williams</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 May 2014 17:56:13 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:46 +0000</updated>
                            <resolved>Fri, 18 Jul 2014 17:37:08 +0000</resolved>
                                        <fixVersion>2.0.10</fixVersion>
                    <fixVersion>2.1 rc4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14044072" author="ala.alkhaldi" created="Wed, 25 Jun 2014 21:31:53 +0000"  >&lt;p&gt;For the hadoop_cql3_word_count example:&lt;br/&gt;
word_count_setup is verified to work against the trunk . I could not reproduce the problem.&lt;br/&gt;
The world_count also works correctly and produce the expected results. Running word_count_counters after it generates the expected counts cql3_worldcount.output_words.&lt;/p&gt;

&lt;p&gt;The IOException above is a &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-2851&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;known Hadoop issue&lt;/a&gt; that&apos;s marked as won&apos;t fix, and it can be safely ignored. it just logs an exception to the debug log, despite no exception actually being thrown. When the log level is set to any value other that DEBUG, the exception disappears. &lt;/p&gt;

&lt;p&gt;the hadoop_word_count fails to build. Are we still interested in shipping it with Cassandra?&lt;br/&gt;
Also, all of the examples shipped with Cassandra do not work on Windows. Are we interested in supporting Windows examples?&lt;/p&gt;
</comment>
                            <comment id="14044082" author="brandon.williams" created="Wed, 25 Jun 2014 21:36:38 +0000"  >&lt;p&gt;I think I discovered this against 2.0, not sure what the status is there now.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The IOException above is a known Hadoop issue that&apos;s marked as won&apos;t fix, and it can be safely ignored. it just logs an exception to the debug log, despite no exception actually being thrown. When the log level is set to any value other that DEBUG, the exception disappears.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We could silence it with log4j/logback configuration.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;the hadoop_word_count fails to build. Are we still interested in shipping it with Cassandra?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Also, all of the examples shipped with Cassandra do not work on Windows. Are we interested in supporting Windows examples?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s probably a good idea, but not critical.  What breaks on windows?&lt;/p&gt;</comment>
                            <comment id="14044085" author="ala.alkhaldi" created="Wed, 25 Jun 2014 21:39:00 +0000"  >&lt;blockquote&gt;
&lt;p&gt;It&apos;s probably a good idea, but not critical. What breaks on windows?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;These examples run by the shell scripts under bin directory. We need to provide equivalent .bat files for Windows &lt;/p&gt;</comment>
                            <comment id="14044198" author="ala.alkhaldi" created="Wed, 25 Jun 2014 23:59:21 +0000"  >&lt;blockquote&gt;
&lt;p&gt;These examples run by the shell scripts under bin directory. We need to provide equivalent .bat files for Windows&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Apparently, I was not accurate. Hadoop-core 1.0.3 does not support Windows platform. The first release to support it is 2.1.0-beta (&lt;a href=&quot;http://hadoop.apache.org/releases.html#25+August%2C+2013%3A+Release+2.1.0-beta+available&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;see Hadoop release notes&lt;/a&gt;). &lt;/p&gt;</comment>
                            <comment id="14046292" author="ala.alkhaldi" created="Fri, 27 Jun 2014 19:06:30 +0000"  >&lt;p&gt;The attached patch (7200_v1.txt) update the config to silence the IO exception mentioned in the bug. In addition, it solve all the compilation issues of the hadoop_world_count examples.  &lt;/p&gt;</comment>
                            <comment id="14046432" author="jbellis" created="Fri, 27 Jun 2014 21:45:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; to review&lt;/p&gt;</comment>
                            <comment id="14055101" author="brandon.williams" created="Tue, 8 Jul 2014 16:34:34 +0000"  >&lt;p&gt;A couple of things: word count is broken in 2.0 too, (quite likely for different reasons though) so we need a version for that.  Also, word_count_setup never seems to exit, even though it is done and the box is completely idle.&lt;/p&gt;</comment>
                            <comment id="14055108" author="brandon.williams" created="Tue, 8 Jul 2014 16:39:51 +0000"  >&lt;p&gt;I take that last point back, it finally exited but seemed to spend a ridiculous amount of time doing nothing.&lt;/p&gt;</comment>
                            <comment id="14055113" author="brandon.williams" created="Tue, 8 Jul 2014 16:42:26 +0000"  >&lt;p&gt;looks like the cql3 word count has problems as well.  Maybe for 2.1 we should just simplify our lives and get rid of the old count and stick to cql3.&lt;/p&gt;</comment>
                            <comment id="14055159" author="ala.alkhaldi" created="Tue, 8 Jul 2014 17:20:55 +0000"  >&lt;p&gt;I checked the 2.0 version of cql3 word count. it builds successfully and it takes so long time to finish. is that what you mean by broken?&lt;/p&gt;</comment>
                            <comment id="14055188" author="brandon.williams" created="Tue, 8 Jul 2014 17:45:02 +0000"  >&lt;p&gt;The slow idle period is a problem, but I think I only tested cql3 on 2.1&lt;/p&gt;</comment>
                            <comment id="14055194" author="ala.alkhaldi" created="Tue, 8 Jul 2014 17:49:30 +0000"  >&lt;p&gt;word count of cql3 on 2.0 also fails with this exception when writing back to cassandra in the reducer:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.NullPointerException
    at org.apache.cassandra.dht.Murmur3Partitioner.getToken(Murmur3Partitioner.java:89)
    at org.apache.cassandra.dht.Murmur3Partitioner.getToken(Murmur3Partitioner.java:39)
    at org.apache.cassandra.client.RingCache.getRange(RingCache.java:117)
    at org.apache.cassandra.hadoop.cql3.CqlRecordWriter.write(CqlRecordWriter.java:162)
    at org.apache.cassandra.hadoop.cql3.CqlRecordWriter.write(CqlRecordWriter.java:62)
    at org.apache.hadoop.mapred.ReduceTask$NewTrackingRecordWriter.write(ReduceTask.java:587)
    at org.apache.hadoop.mapreduce.TaskInputOutputContext.write(TaskInputOutputContext.java:80)
    at WordCount$ReducerToCassandra.reduce(Unknown Source)
    at WordCount$ReducerToCassandra.reduce(Unknown Source)
    at org.apache.hadoop.mapreduce.Reducer.run(Reducer.java:176)
    at org.apache.hadoop.mapred.ReduceTask.runNewReducer(ReduceTask.java:649)
    at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:417)
    at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:260)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="14057868" author="ala.alkhaldi" created="Thu, 10 Jul 2014 20:03:10 +0000"  >&lt;p&gt;The latest NPE is already solved in &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-6793&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;CASSANDRA-6793&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14057879" author="ala.alkhaldi" created="Thu, 10 Jul 2014 20:09:43 +0000"  >&lt;p&gt;The slowness is caused by using vnodes at the cassandra server which is not recommended for the hadoop case. For instance, WordCountSetup relies on the number of returned vnodes to determine the sleep time after creating the keyspace which turned to be 256 seconds in current default installation of Cassandra. I updated the README file to mention that disabaling vnodes  is recommended. &lt;br/&gt;
The Attached 7200_v2.txt includes the README update as well as the changes in 7200_v1.txt changes.&lt;/p&gt;

&lt;p&gt;I also checked Cassandra 2.0. The hadoop_word_count example works fine, but the cql3 word count has a bug that is already solved as I mentioned in the above comment. &lt;/p&gt;</comment>
                            <comment id="14057904" author="brandon.williams" created="Thu, 10 Jul 2014 20:21:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;I also checked Cassandra 2.0. The hadoop_word_count example works fine, but the cql3 word count has a bug that is already solved as I mentioned in the above comment. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That says it was fixed in 2.0.7, so I&apos;m confused why we&apos;re encountering it.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The slowness is caused by using vnodes at the cassandra server which is not recommended for the hadoop case. For instance, WordCountSetup relies on the number of returned vnodes to determine the sleep time after creating the keyspace which turned to be 256 seconds in current default installation of Cassandra.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Well, that&apos;s silly then, since it can both a) count actual nodes or b) poll for actual schema agreement.&lt;/p&gt;</comment>
                            <comment id="14058038" author="ala.alkhaldi" created="Thu, 10 Jul 2014 22:07:15 +0000"  >&lt;blockquote&gt;
&lt;p&gt;That says it was fixed in 2.0.7, so I&apos;m confused why we&apos;re encountering it.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I used 2.0 for my test. 2.0.7 does not have the issue&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Well, that&apos;s silly then, since it can both a) count actual nodes or b) poll for actual schema agreement.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I used number of peers to get the actual nodes count. check 7200_v3.txt&lt;/p&gt;</comment>
                            <comment id="14058041" author="brandon.williams" created="Thu, 10 Jul 2014 22:11:02 +0000"  >&lt;blockquote&gt;&lt;p&gt;I used 2.0 for my test. 2.0.7 does not have the issue&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;2.0-HEAD?  That&apos;s the source of my confusion, we&apos;re on 2.0.9 now so we shouldn&apos;t be seeing this, unless you mean 2.0.0.&lt;/p&gt;</comment>
                            <comment id="14058045" author="ala.alkhaldi" created="Thu, 10 Jul 2014 22:13:49 +0000"  >&lt;blockquote&gt;
&lt;p&gt;2.0-HEAD? That&apos;s the source of my confusion, we&apos;re on 2.0.9 now so we shouldn&apos;t be seeing this, unless you mean 2.0.0.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;yes, I used 2.0.0. Sorry for not being clear.&lt;/p&gt;</comment>
                            <comment id="14059064" author="brandon.williams" created="Fri, 11 Jul 2014 17:37:46 +0000"  >&lt;p&gt;It looks like your IDE did some strange things with the imports, and I&apos;m not sure why the toByteBuffer() line was added to WordCount since it won&apos;t compile with it, but maybe that&apos;s just artifacts from patch against 2.0.0 and a rebase will solve it.&lt;/p&gt;

&lt;p&gt;cql3 word count looks good, can we add similar logic about the sleep to word count (and rebase aganst 2.0 head)?&lt;/p&gt;</comment>
                            <comment id="14061138" author="ala.alkhaldi" created="Mon, 14 Jul 2014 20:03:01 +0000"  >&lt;blockquote&gt;
&lt;p&gt;It looks like your IDE did some strange things with the imports, and I&apos;m not sure why the toByteBuffer() line was added to WordCount since it won&apos;t compile with it, but maybe that&apos;s just artifacts from patch against 2.0.0 and a rebase will solve it.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The import changes applies only to the trunk version not the 2.0-HEAD&lt;/p&gt;

&lt;p&gt;As peer our discussion. I attached two files; 7200_v4_trunk has the trunk changes that include: solution to the compilation problem in cql3 word count, sleep fixes, log fix, and README addition.&lt;br/&gt;
7200_v4_2.0-HEAD has the 2.0-HEAD changes that include: sleep fixes, log fix, and README addition.&lt;/p&gt;</comment>
                            <comment id="14066584" author="brandon.williams" created="Fri, 18 Jul 2014 17:37:08 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12652875" name="7200_v1.txt" size="1999" author="ala.alkhaldi" created="Fri, 27 Jun 2014 19:06:30 +0000"/>
                            <attachment id="12655065" name="7200_v2.txt" size="4538" author="ala.alkhaldi" created="Thu, 10 Jul 2014 20:03:24 +0000"/>
                            <attachment id="12655097" name="7200_v3.txt" size="5439" author="ala.alkhaldi" created="Thu, 10 Jul 2014 22:07:47 +0000"/>
                            <attachment id="12655604" name="7200_v4_2.0-HEAD.txt" size="5232" author="ala.alkhaldi" created="Mon, 14 Jul 2014 20:02:35 +0000"/>
                            <attachment id="12655605" name="7200_v4_trunk.txt" size="6759" author="ala.alkhaldi" created="Mon, 14 Jul 2014 20:02:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ala.alkhaldi]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391674</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1vggf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391886</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>brandon.williams</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>