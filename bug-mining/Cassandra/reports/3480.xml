<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:52:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-8102] cassandra-cli and cqlsh report two different values for a setting, partially update it and partially report it</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-8102</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;cassandra-cli updates and prints out a min_compaction_threshold that is not shown by cqlsh (it shows a different min_threshold attribute)&lt;/p&gt;

&lt;p&gt;cqlsh updates &quot;both&quot; values but only shows one of them&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cassandra-cli:
UPDATE COLUMN FAMILY foo WITH min_compaction_threshold = 8;

$ echo &lt;span class=&quot;code-quote&quot;&gt;&quot;describe foo;&quot;&lt;/span&gt; | cassandra-cli -h `hostname` -k bar
      Compaction min/max thresholds: 8/32

$ echo &lt;span class=&quot;code-quote&quot;&gt;&quot;describe table foo;&quot;&lt;/span&gt; | cqlsh -k bar `hostname`
  compaction={&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;SizeTieredCompactionStrategy&apos;&lt;/span&gt;} AND
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh:
ALTER TABLE foo WITH compaction = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&apos;SizeTieredCompactionStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;min_threshold&apos;&lt;/span&gt; : 16};

cassandra-cli:
      Compaction min/max thresholds: 16/32
      Compaction Strategy Options:
        min_threshold: 16
cqlsh:
  compaction={&lt;span class=&quot;code-quote&quot;&gt;&apos;min_threshold&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;16&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;SizeTieredCompactionStrategy&apos;&lt;/span&gt;} AND
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cassandra-cli:
UPDATE COLUMN FAMILY foo WITH min_compaction_threshold = 8;

cassandra-cli:
      Compaction min/max thresholds: 8/32
      Compaction Strategy Options:
        min_threshold: 16

cqlsh:
  compaction={&lt;span class=&quot;code-quote&quot;&gt;&apos;min_threshold&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;16&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;SizeTieredCompactionStrategy&apos;&lt;/span&gt;} AND
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;2.0.9&lt;/p&gt;</environment>
        <key id="12747344">CASSANDRA-8102</key>
            <summary>cassandra-cli and cqlsh report two different values for a setting, partially update it and partially report it</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="peter-librato">Peter Haggerty</reporter>
                        <labels>
                            <label>cli</label>
                            <label>cqlsh</label>
                    </labels>
                <created>Fri, 10 Oct 2014 17:11:19 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:31 +0000</updated>
                            <resolved>Wed, 8 Apr 2015 18:14:56 +0000</resolved>
                                        <fixVersion>2.0.15</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14328542" author="pbhosale" created="Fri, 20 Feb 2015 04:22:43 +0000"  >&lt;p&gt;I am looking into this bug &amp;amp; below are my observations : &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;While looking into the cassandra-cli code found below comments in executeUpdateColumnFamily():&lt;br/&gt;
// request correct cfDef from the server (we let that call include CQL3 cf even though&lt;br/&gt;
// they can&apos;t be modified by thrift because the error message that will be thrown by&lt;br/&gt;
// system_update_column_family will be more useful)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I tried to update the gc_grace_seconds and index&#8221; attributes of columnfamily through cli &amp;amp; they are updated properly. They were also reflected through cqlsh.&lt;br/&gt;
We are getting an issue for &#8220;min_compaction_threshold&#8221;.&lt;/p&gt;

&lt;p&gt;So are the above comment applicable only for some of the attributes of columnfamily ?&lt;/p&gt;</comment>
                            <comment id="14388587" author="philipthompson" created="Tue, 31 Mar 2015 14:28:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krummas&quot; class=&quot;user-hover&quot; rel=&quot;krummas&quot;&gt;krummas&lt;/a&gt;, is the cqlsh behavior here is correct?&lt;/p&gt;</comment>
                            <comment id="14392430" author="krummas" created="Thu, 2 Apr 2015 09:25:50 +0000"  >&lt;p&gt;looks like a bug to me&lt;/p&gt;</comment>
                            <comment id="14480863" author="stefania" created="Mon, 6 Apr 2015 03:02:38 +0000"  >&lt;p&gt;In CQL3 the compaction thresholds come from the compaction options (&lt;b&gt;cql3.statements.CFPropDefs.applyToCFMetadata()&lt;/b&gt;) and cqlsh only shows the values from the options.&lt;/p&gt;

&lt;p&gt;I modified cassandra-cli to also set the options, so that they are reflected in cqlsh: &lt;a href=&quot;https://github.com/stef1927/cassandra/commits/8102&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/stef1927/cassandra/commits/8102&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14480864" author="stefania" created="Mon, 6 Apr 2015 03:05:09 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thobbs&quot; class=&quot;user-hover&quot; rel=&quot;thobbs&quot;&gt;thobbs&lt;/a&gt; are you happy to review this one?&lt;/p&gt;</comment>
                            <comment id="14483484" author="thobbs" created="Tue, 7 Apr 2015 16:49:17 +0000"  >&lt;p&gt;Sure, I can review.&lt;/p&gt;

&lt;p&gt;When creating a new column family with a min/max_compaction_threshold through cassandra-cli, you&apos;ll get a NullPointerException with the following stacktrace (when &lt;tt&gt;--debug&lt;/tt&gt; is used):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[default@ks1] create column family bar WITH min_compaction_threshold = 8;
java.lang.NullPointerException
java.lang.RuntimeException: java.lang.NullPointerException
	at org.apache.cassandra.cli.CliClient.executeAddColumnFamily(CliClient.java:1124)
	at org.apache.cassandra.cli.CliClient.executeCLIStatement(CliClient.java:244)
	at org.apache.cassandra.cli.CliMain.processStatementInteractive(CliMain.java:201)
	at org.apache.cassandra.cli.CliMain.main(CliMain.java:331)
Caused by: java.lang.NullPointerException
	at org.apache.cassandra.cli.CliClient.updateCfDefAttributes(CliClient.java:1322)
	at org.apache.cassandra.cli.CliClient.executeAddColumnFamily(CliClient.java:1114)
	... 3 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It looks like the compaction strategy options need to be initialized before we try to put an option in them.&lt;/p&gt;</comment>
                            <comment id="14484655" author="stefania" created="Wed, 8 Apr 2015 03:28:57 +0000"  >&lt;p&gt;Thanks for spotting this, I should have used &lt;tt&gt;putToCompaction_strategy_options()&lt;/tt&gt;, which also takes care of creating the options if they don&apos;t exist yet.&lt;/p&gt;

&lt;p&gt;Fixed and rebased.&lt;/p&gt;</comment>
                            <comment id="14485702" author="thobbs" created="Wed, 8 Apr 2015 18:14:56 +0000"  >&lt;p&gt;+1, committed as &lt;tt&gt;4b43684&lt;/tt&gt;.  Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12723976" name="8102-2.0.txt" size="2484" author="thobbs" created="Wed, 8 Apr 2015 18:14:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i211hj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12326830">2.0.9</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>thobbs</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>