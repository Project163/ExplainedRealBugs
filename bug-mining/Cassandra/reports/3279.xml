<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:49:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-8156] Fix validation of indexes on composite column components of COMPACT tables</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-8156</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5125&quot; title=&quot;Support indexes on composite column components (clustered columns)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5125&quot;&gt;&lt;del&gt;CASSANDRA-5125&lt;/del&gt;&lt;/a&gt; added support of indexes on composite column components for &lt;b&gt;non-compact&lt;/b&gt; tables (see &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-5125&quot; title=&quot;Support indexes on composite column components (clustered columns)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-5125&quot;&gt;&lt;del&gt;CASSANDRA-5125&lt;/del&gt;&lt;/a&gt; comments for additional information).&lt;br/&gt;
This is a follow up for &lt;b&gt;compact&lt;/b&gt; tables.&lt;/p&gt;

&lt;p&gt;Using compact tables it is possible to CREATE INDEX on composite primary key columns, but queries returns no results for the tests below.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; users2 (
   userID uuid,
   fname &lt;span class=&quot;code-keyword&quot;&gt;text&lt;/span&gt;,
   zip &lt;span class=&quot;code-keyword&quot;&gt;int&lt;/span&gt;,
   &lt;span class=&quot;code-keyword&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;text&lt;/span&gt;,
  &lt;span class=&quot;code-keyword&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;KEY&lt;/span&gt; ((userID, fname))
) &lt;span class=&quot;code-keyword&quot;&gt;WITH&lt;/span&gt; COMPACT &lt;span class=&quot;code-keyword&quot;&gt;STORAGE&lt;/span&gt;;

&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INDEX&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;ON&lt;/span&gt; users2 (userID);
&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INDEX&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;ON&lt;/span&gt; users2 (fname);

&lt;span class=&quot;code-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;INTO&lt;/span&gt; users2 (userID, fname, zip, &lt;span class=&quot;code-keyword&quot;&gt;state&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;VALUES&lt;/span&gt; (b3e3bc33-b237-4b55-9337-3d41de9a5649, &lt;span class=&quot;code-quote&quot;&gt;&apos;John&apos;&lt;/span&gt;, 10007, &lt;span class=&quot;code-quote&quot;&gt;&apos;NY&apos;&lt;/span&gt;);

&lt;span class=&quot;code-comment&quot;&gt;-- the &lt;span class=&quot;code-keyword&quot;&gt;following&lt;/span&gt; queries &lt;span class=&quot;code-keyword&quot;&gt;returns&lt;/span&gt; 0 &lt;span class=&quot;code-keyword&quot;&gt;rows&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;instead&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;of&lt;/span&gt; 1 expected
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; users2 &lt;span class=&quot;code-keyword&quot;&gt;WHERE&lt;/span&gt; fname=&lt;span class=&quot;code-quote&quot;&gt;&apos;John&apos;&lt;/span&gt;; 
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; users2 &lt;span class=&quot;code-keyword&quot;&gt;WHERE&lt;/span&gt; userid=b3e3bc33-b237-4b55-9337-3d41de9a5649;
&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; * &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; users2 &lt;span class=&quot;code-keyword&quot;&gt;WHERE&lt;/span&gt; userid=b3e3bc33-b237-4b55-9337-3d41de9a5649 &lt;span class=&quot;code-keyword&quot;&gt;AND&lt;/span&gt; fname=&lt;span class=&quot;code-quote&quot;&gt;&apos;John&apos;&lt;/span&gt;;

&lt;span class=&quot;code-comment&quot;&gt;-- dropping 2ndary indexes &lt;span class=&quot;code-keyword&quot;&gt;restore&lt;/span&gt; normal behavior&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12749489">CASSANDRA-8156</key>
            <summary>Fix validation of indexes on composite column components of COMPACT tables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="slebresne">Sylvain Lebresne</assignee>
                                    <reporter username="denis.angilella">Denis Angilella</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Oct 2014 11:02:36 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:30 +0000</updated>
                            <resolved>Tue, 16 Dec 2014 19:38:10 +0000</resolved>
                                        <fixVersion>2.0.12</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14201873" author="slebresne" created="Fri, 7 Nov 2014 10:10:03 +0000"  >&lt;p&gt;There is a bug here and it&apos;s that the index creation above is at all allowed since we don&apos;t currently support indexes on primary key columns for compact tables. This is a validation bug and I we should fix that asap, so attaching a patch for that.&lt;/p&gt;

&lt;p&gt;Now, I know the initial intent of this ticket was to extend primary key column index support for compact tables but to be honest, compact tables are mainly for legacy compatibility with thrift tables, so I&apos;m not convinced it&apos;s worth spending efforts and adding complexity for it.&lt;/p&gt;</comment>
                            <comment id="14201896" author="denis.angilella" created="Fri, 7 Nov 2014 10:26:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt;: My intention when creating this ticket was not necessarily to support indexes on primary key columns for compact tables, but to have a not misleading behavior. So I agree that validation should be fixed instead.&lt;/p&gt;

&lt;p&gt;+1 for not adding this feature to legacy tables.&lt;/p&gt;</comment>
                            <comment id="14233475" author="thobbs" created="Wed, 3 Dec 2014 20:19:23 +0000"  >&lt;p&gt;One nitpick: we should improve the error message for this.  My suggestion: &quot;Secondary indexes are not supported on PRIMARY KEY columns in COMPACT STORAGE tables&quot;&lt;/p&gt;

&lt;p&gt;Other than that, +1&lt;/p&gt;</comment>
                            <comment id="14248654" author="thobbs" created="Tue, 16 Dec 2014 18:44:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=slebresne&quot; class=&quot;user-hover&quot; rel=&quot;slebresne&quot;&gt;slebresne&lt;/a&gt; don&apos;t forget to commit this at some point.&lt;/p&gt;</comment>
                            <comment id="14248769" author="slebresne" created="Tue, 16 Dec 2014 19:38:10 +0000"  >&lt;p&gt;Thanks for the reminder, committed with the message tweak, thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12626383">CASSANDRA-5125</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12680127" name="8156.txt" size="1327" author="slebresne" created="Fri, 7 Nov 2014 10:10:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21edj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311421" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Reproduced In</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12327942">2.0.11</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>thobbs</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[thobbs]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>