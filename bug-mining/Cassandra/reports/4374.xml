<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:03:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-12189] $$ escaped string literals are not handled correctly in cqlsh</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-12189</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;The syntax rules for pg ($$) escaped string literals in cqlsh do not match the lexer rule for this type in Lexer.g. &lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;unclosedPgString&lt;/tt&gt; rule is not correctly matching pg string literals in multi-line statements so:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;INSERT INTO test.test (id) values (
...$$&amp;lt;xml/&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;fails with a syntax error at the forward slash.&lt;/p&gt;

&lt;p&gt;Both &lt;tt&gt;pgStringLiteral&lt;/tt&gt; and &lt;tt&gt;unclosedPgString&lt;/tt&gt; fail with the following string&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$$a$b$$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;where this is allowed by the CQL lexer rule.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12989064">CASSANDRA-12189</key>
            <summary>$$ escaped string literals are not handled correctly in cqlsh</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mike_tr_adamson">Mike Adamson</assignee>
                                    <reporter username="mike_tr_adamson">Mike Adamson</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Jul 2016 09:33:59 +0000</created>
                <updated>Wed, 15 Jul 2020 18:07:47 +0000</updated>
                            <resolved>Wed, 20 Jul 2016 14:05:00 +0000</resolved>
                                        <fixVersion>3.8</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15374740" author="mike_tr_adamson" created="Wed, 13 Jul 2016 09:46:33 +0000"  >&lt;p&gt;I have pushed a branch that fixes this to trunk but this is easily portable to previous versions if needed.&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/mike-tr-adamson/cassandra/tree/12189-trunk&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/madamson/job/mike-tr-adamson-12189-trunk-testall/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;testall&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/madamson/job/mike-tr-adamson-12189-trunk-dtest/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="15382250" author="ifesdjeen" created="Mon, 18 Jul 2016 13:08:35 +0000"  >&lt;p&gt;Some inputs that were previously invalid, are now not closing:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE KEYSPACE cql_test_keyspace WITH replication = {&lt;span class=&quot;code-quote&quot;&gt;&apos;class&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;NetworkTopologyStrategy&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;datacenter1&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;1&apos;&lt;/span&gt; };
use cql_test_keyspace;
CREATE TABLE testtable (key ascii primary key, val text);

&lt;span class=&quot;code-comment&quot;&gt;// following inputs are not closing:
&lt;/span&gt;INSERT INTO testtable (key, val) VALUES ($$key_empty$$, $$&apos;&apos; value &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; empty$ $);
INSERT INTO testtable (key, val) VALUES ($$key_empty$ $, $$&apos;&apos; value &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; empty$$);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In both cases it waits for more possible input, which might be indistinguishable from end of input. &lt;/p&gt;

&lt;p&gt;What started working after the patch:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;INSERT INTO testtable (key, val) VALUES ($$$foo$_$foo$$, $$$&apos;&apos; value &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; empty$$); 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;User-defined functions and other inputs are working fine however:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;INSERT INTO testtable (key, val) VALUES ($$prim$ $ $key$$, $$some &apos;&apos; arbitrary value$$);
INSERT INTO testtable (key, val) VALUES (&lt;span class=&quot;code-quote&quot;&gt;&apos;$txt$key$$$$txt$&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;$txt$&apos;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&apos; other value$txt$&apos;&lt;/span&gt;);
INSERT INTO testtable (key, val) VALUES ($$key_empty$$, $$&apos;&apos; value &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; empty$$);

SELECT key, val FROM testtable WHERE key=&lt;span class=&quot;code-quote&quot;&gt;&apos;prim$ $ $key&apos;&lt;/span&gt;;
SELECT key, val FROM testtable WHERE key=&lt;span class=&quot;code-quote&quot;&gt;&apos;key_empty&apos;&lt;/span&gt;;
SELECT key, val FROM testtable WHERE key=&lt;span class=&quot;code-quote&quot;&gt;&apos;$foo$_$foo&apos;&lt;/span&gt;;
SELECT key, val FROM testtable WHERE key=&lt;span class=&quot;code-quote&quot;&gt;&apos;$txt$key$$$$txt$&apos;&lt;/span&gt;;

INSERT INTO testtable (key, val) VALUES ($$prim$ $ $key$$, $$some &apos;&apos; arbitrary value$$);
INSERT INTO testtable (key, val) VALUES ($$$foo$_$foo$$, $$$&apos;&apos; value &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; empty$$);

CREATE FUNCTION cql_test_keyspace::pgsin ( input &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; ) RETURNS &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; USING $$org.apache.cassandra.cql3.UFTest#sin$$ ;

CREATE FUNCTION testfn( lst list&amp;lt;&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;&amp;gt; )
RETURNS NULL ON NULL INPUT
RETURNS list&amp;lt;&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;&amp;gt;
LANGUAGE java
AS $$&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; lst;$$;

CREATE FUNCTION testfn2( input &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; )
CALLED ON NULL INPUT
RETURNS text
LANGUAGE java
AS $$
&lt;span class=&quot;code-comment&quot;&gt;// parameter val is of type java.lang.&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;/* &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; type is of type java.lang.&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt; */&lt;/span&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (input == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
}
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;.toString(&lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.sin(input));
$$;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;In context of CQLsh I don&apos;t see a way to distinguish between the end of input and incorrectly closed &lt;tt&gt;$$&lt;/tt&gt;. Do you think it&apos;s possible?&lt;/p&gt;</comment>
                            <comment id="15382318" author="mike_tr_adamson" created="Mon, 18 Jul 2016 14:08:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;In context of CQLsh I don&apos;t see a way to distinguish between the end of input and incorrectly closed $$. Do you think it&apos;s possible?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No, I don&apos;t. I couldn&apos;t find a way of covering all these cases so I opted for letting it work correctly for valid input. &lt;/p&gt;</comment>
                            <comment id="15384129" author="ifesdjeen" created="Tue, 19 Jul 2016 13:16:31 +0000"  >&lt;p&gt;True. As it&apos;s always ambiguous: one can always supply the correct end delimiter on the next line, therefore it&apos;s indistiguishable, and limiting it to the single line would not be a good behaviour.&lt;/p&gt;

&lt;p&gt;I&apos;m +1 on this. &lt;/p&gt;

&lt;p&gt;I&apos;ve tried to rebase it on top of trunk and it merges clearly. &lt;/p&gt;</comment>
                            <comment id="15385894" author="iamaleksey" created="Wed, 20 Jul 2016 13:59:54 +0000"  >&lt;p&gt;Committing now, but can you please include CHANGES.txt entry, and the proper commit message in the patch? See &lt;a href=&quot;https://docs.google.com/document/d/1d_AzYQo74de9utbbpyXxW2w-b0__sFhC7b24ibiJqjw/view&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.google.com/document/d/1d_AzYQo74de9utbbpyXxW2w-b0__sFhC7b24ibiJqjw/view&lt;/a&gt; for details.&lt;/p&gt;</comment>
                            <comment id="15385901" author="iamaleksey" created="Wed, 20 Jul 2016 14:04:45 +0000"  >&lt;p&gt;Committed as &lt;a href=&quot;https://github.com/apache/cassandra/commit/0b49b1776e5c6aa20bc2845e5b48dafe84169d46&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;0b49b1776e5c6aa20bc2845e5b48dafe84169d46&lt;/a&gt; to 3.9 and merged into trunk, thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12989062">CASSANDRA-12187</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13316973">CASSANDRA-15948</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[mike_tr_adamson]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 17 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30wq7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ifesdjeen</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[ifesdjeen]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12333891">3.0.0</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>