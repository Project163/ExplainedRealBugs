<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:25:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3391] CFM.toAvro() incorrectly serialises key_validation_class defn</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3391</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;see &lt;a href=&quot;http://www.mail-archive.com/user@cassandra.apache.org/msg18132.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.mail-archive.com/user@cassandra.apache.org/msg18132.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Repo with &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;create keyspace Stats with placement_strategy = &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.cassandra.locator.SimpleStrategy&apos;&lt;/span&gt; and strategy_options={replication_factor:1};

use Stats;

create column family Sample_Stats with default_validation_class=CounterColumnType
    and key_validation_class=&lt;span class=&quot;code-quote&quot;&gt;&apos;CompositeType(UTF8Type,UTF8Type)&apos;&lt;/span&gt;
    and comparator=&lt;span class=&quot;code-quote&quot;&gt;&apos;CompositeType(UTF8Type, UTF8Type)&apos;&lt;/span&gt;
    and replicate_on_write=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;

[&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;@Stats] describe cluster;
Cluster Information:
   Snitch: org.apache.cassandra.locator.SimpleSnitch
   Partitioner: org.apache.cassandra.dht.RandomPartitioner
   Schema versions: 
	1d39bbf0-fb60-11e0-0000-242d50cf1ffd: [127.0.0.1]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Stop and restart the node&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR 10:12:22,729 Exception encountered during startup
java.lang.RuntimeException: Could not inflate CFMetaData &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; {&lt;span class=&quot;code-quote&quot;&gt;&quot;keyspace&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;Stats&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;Sample_Stats&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;column_type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;Standard&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;comparator_type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type)&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;subcomparator_type&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;comment&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;row_cache_size&lt;span class=&quot;code-quote&quot;&gt;&quot;: 0.0, &quot;&lt;/span&gt;key_cache_size&lt;span class=&quot;code-quote&quot;&gt;&quot;: 200000.0, &quot;&lt;/span&gt;read_repair_chance&lt;span class=&quot;code-quote&quot;&gt;&quot;: 1.0, &quot;&lt;/span&gt;replicate_on_write&lt;span class=&quot;code-quote&quot;&gt;&quot;: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &quot;&lt;/span&gt;gc_grace_seconds&lt;span class=&quot;code-quote&quot;&gt;&quot;: 864000, &quot;&lt;/span&gt;default_validation_class&lt;span class=&quot;code-quote&quot;&gt;&quot;: &quot;&lt;/span&gt;org.apache.cassandra.db.marshal.CounterColumnType&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;key_validation_class&lt;span class=&quot;code-quote&quot;&gt;&quot;: &quot;&lt;/span&gt;org.apache.cassandra.db.marshal.CompositeType&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;min_compaction_threshold&lt;span class=&quot;code-quote&quot;&gt;&quot;: 4, &quot;&lt;/span&gt;max_compaction_threshold&lt;span class=&quot;code-quote&quot;&gt;&quot;: 32, &quot;&lt;/span&gt;row_cache_save_period_in_seconds&lt;span class=&quot;code-quote&quot;&gt;&quot;: 0, &quot;&lt;/span&gt;key_cache_save_period_in_seconds&lt;span class=&quot;code-quote&quot;&gt;&quot;: 14400, &quot;&lt;/span&gt;row_cache_keys_to_save&lt;span class=&quot;code-quote&quot;&gt;&quot;: 2147483647, &quot;&lt;/span&gt;merge_shards_chance&lt;span class=&quot;code-quote&quot;&gt;&quot;: 0.1, &quot;&lt;/span&gt;id&lt;span class=&quot;code-quote&quot;&gt;&quot;: 1000, &quot;&lt;/span&gt;column_metadata&lt;span class=&quot;code-quote&quot;&gt;&quot;: [], &quot;&lt;/span&gt;row_cache_provider&lt;span class=&quot;code-quote&quot;&gt;&quot;: &quot;&lt;/span&gt;org.apache.cassandra.cache.ConcurrentLinkedHashCacheProvider&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;key_alias&lt;span class=&quot;code-quote&quot;&gt;&quot;: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &quot;&lt;/span&gt;compaction_strategy&lt;span class=&quot;code-quote&quot;&gt;&quot;: &quot;&lt;/span&gt;org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;compaction_strategy_options&lt;span class=&quot;code-quote&quot;&gt;&quot;: {}, &quot;&lt;/span&gt;compression_options&quot;: {}}
	at org.apache.cassandra.config.CFMetaData.fromAvro(CFMetaData.java:362)
	at org.apache.cassandra.config.KSMetaData.fromAvro(KSMetaData.java:193)
	at org.apache.cassandra.db.DefsTable.loadFromStorage(DefsTable.java:99)
	at org.apache.cassandra.config.DatabaseDescriptor.loadSchemas(DatabaseDescriptor.java:502)
	at org.apache.cassandra.service.AbstractCassandraDaemon.setup(AbstractCassandraDaemon.java:161)
	at org.apache.cassandra.service.AbstractCassandraDaemon.activate(AbstractCassandraDaemon.java:337)
	at org.apache.cassandra.thrift.CassandraDaemon.main(CassandraDaemon.java:106)
Caused by: org.apache.cassandra.config.ConfigurationException: Invalid definition &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; comparator org.apache.cassandra.db.marshal.CompositeType.
	at org.apache.cassandra.db.marshal.TypeParser.getRawAbstractType(TypeParser.java:319)
	at org.apache.cassandra.db.marshal.TypeParser.getAbstractType(TypeParser.java:247)
	at org.apache.cassandra.db.marshal.TypeParser.parse(TypeParser.java:83)
	at org.apache.cassandra.db.marshal.TypeParser.parse(TypeParser.java:92)
	at org.apache.cassandra.config.CFMetaData.fromAvro(CFMetaData.java:358)
	... 6 more
Caused by: org.apache.cassandra.config.ConfigurationException: Nonsensical empty parameter list &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; CompositeType
	at org.apache.cassandra.db.marshal.CompositeType.getInstance(CompositeType.java:67)
	at org.apache.cassandra.db.marshal.CompositeType.getInstance(CompositeType.java:61)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.cassandra.db.marshal.TypeParser.getRawAbstractType(TypeParser.java:307)
	... 10 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Will post the patch in a minute. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12528043">CASSANDRA-3391</key>
            <summary>CFM.toAvro() incorrectly serialises key_validation_class defn</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="amorton">Aaron Morton</assignee>
                                    <reporter username="amorton">Aaron Morton</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Oct 2011 22:26:32 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:48 +0000</updated>
                            <resolved>Fri, 21 Oct 2011 13:43:00 +0000</resolved>
                                        <fixVersion>0.8.8</fixVersion>
                    <fixVersion>1.0.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13132132" author="amorton" created="Thu, 20 Oct 2011 22:34:53 +0000"  >&lt;p&gt;Use AbstractType.toString() when serialising key_validator_class to Avro.&lt;/p&gt;

&lt;p&gt;Checked other places to CFMD.toAvro() and CFMD.fromAvro() they seemed ok. &lt;/p&gt;</comment>
                            <comment id="13132669" author="slebresne" created="Fri, 21 Oct 2011 13:34:34 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13132672" author="slebresne" created="Fri, 21 Oct 2011 13:43:00 +0000"  >&lt;p&gt;Committed, thanks&lt;/p&gt;</comment>
                            <comment id="13132770" author="hudson" created="Fri, 21 Oct 2011 16:00:27 +0000"  >&lt;p&gt;Integrated in Cassandra-0.8 #384 (See &lt;a href=&quot;https://builds.apache.org/job/Cassandra-0.8/384/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Cassandra-0.8/384/&lt;/a&gt;)&lt;br/&gt;
    Correctly serialize key_validation_class for avro&lt;br/&gt;
patch by amorton; reviewed by slebresne for &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-3391&quot; title=&quot;CFM.toAvro() incorrectly serialises key_validation_class defn&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-3391&quot;&gt;&lt;del&gt;CASSANDRA-3391&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;slebresne : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1187339&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1187339&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/cassandra/branches/cassandra-0.8/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/config/CFMetaData.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12499967" name="0001-3391-fix.patch" size="1190" author="amorton" created="Thu, 20 Oct 2011 22:34:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[amorton]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96256</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 5 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gjbr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94561</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>