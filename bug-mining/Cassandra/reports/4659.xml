<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:06:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-13071] cqlsh copy-from should error out when csv contains invalid data for collections</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-13071</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;If the csv file contains invalid data for collection types, at the moment the data is imported incorrectly, an error would be a better behavior.&lt;/p&gt;

&lt;p&gt;For example this table:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE TABLE test.test (key text, value frozen&amp;lt;set&amp;lt;text&amp;gt;&amp;gt;, PRIMARY KEY (key)); 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;with this data:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;key1&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;{&lt;span class=&quot;code-quote&quot;&gt;&apos;test1&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;test2&apos;&lt;/span&gt;}&quot;&lt;/span&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;Key2&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;not_a_set&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;will be imported by &lt;tt&gt;COPY test.test FROM &apos;test.csv&apos;;&lt;/tt&gt; without errors but will result in the following data:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;cqlsh&amp;gt; select * from test.test;

 key  | value
------+--------------------
 key1 | {&lt;span class=&quot;code-quote&quot;&gt;&apos;test1&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;test2&apos;&lt;/span&gt;}
 Key2 |        {&lt;span class=&quot;code-quote&quot;&gt;&apos;ot_a_se&apos;&lt;/span&gt;}

(2 rows)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The second row should have been rejected. The reason is that the &lt;a href=&quot;https://github.com/stef1927/cassandra/blob/trunk/pylib/cqlshlib/copyutil.py#L1898&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;split&lt;/tt&gt; function&lt;/a&gt; assumes that the first and last characters of the string passed in are parentheses, without actually checking it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13029975">CASSANDRA-13071</key>
            <summary>cqlsh copy-from should error out when csv contains invalid data for collections</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stefania">Stefania Alborghetti</assignee>
                                    <reporter username="stefania">Stefania Alborghetti</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Dec 2016 02:15:18 +0000</created>
                <updated>Tue, 16 Apr 2019 09:30:12 +0000</updated>
                            <resolved>Thu, 2 Mar 2017 02:03:16 +0000</resolved>
                                        <fixVersion>3.0.12</fixVersion>
                    <fixVersion>3.11.0</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15880271" author="stefania" created="Thu, 23 Feb 2017 11:14:08 +0000"  >&lt;p&gt;Patch is ready &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pauloricardomg&quot; class=&quot;user-hover&quot; rel=&quot;pauloricardomg&quot;&gt;pauloricardomg&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.0&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3.11&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;trunk&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/tree/13071-cqlsh-3.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/tree/13071-cqlsh-3.11&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/stef1927/cassandra/tree/13071-cqlsh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;patch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-13071-cqlsh-3.0-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-13071-cqlsh-3.11-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;http://cassci.datastax.com/view/Dev/view/stef1927/job/stef1927-13071-cqlsh-cqlsh-tests/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;dtest&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Tests are &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/1448&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15883648" author="pauloricardomg" created="Fri, 24 Feb 2017 22:35:06 +0000"  >&lt;p&gt;The fix looks good, but while testing I noticed that the following is still a valid CSV for the example above:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&quot;key1&quot;,&quot;{&apos;test1&apos;, &apos;test2&apos;}&quot;
&quot;Key2&quot;,&quot;(this_is_a_set, hoho, blueh)&quot;
&quot;Key3&quot;,&quot;[this_as_well]&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is this supposed to be working or are we supposed to use type-based delimiters (&lt;tt&gt;[]&lt;/tt&gt; for lists, ({&lt;tt&gt;}&lt;/tt&gt;) for maps/tuples, etc). If you agree this is a (minor) consistency issue, I&apos;m fine with either fixing this here or opening another ticket for it.&lt;/p&gt;

&lt;p&gt;The dtests results look good, but it seems they were not triggered using the new dtest branch you created so I re-triggered them using your branch. I will mark as ready to commit but please check them again before committing. Thanks!&lt;/p&gt;</comment>
                            <comment id="15885069" author="stefania" created="Mon, 27 Feb 2017 03:18:06 +0000"  >&lt;p&gt;Thanks for the review!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is this supposed to be working or are we supposed to use type-based delimiters&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s actually supposed to be working, but I&apos;m not entirely sure about it. I&apos;ve left a comment &lt;a href=&quot;https://github.com/stef1927/cassandra/commit/170e21fa3d8da8661a4cd500c3507d3919717eff#diff-27e394435c04a60c58ec9d5c34397341R1889&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;. Basically, I wasn&apos;t sure about enforcing the correct type parenthesis in order to avoid breaking data that so far could be imported, albeit data that is incorrect CQL. On the flip side, we could, for example, incorrectly convert a list to a set and vice-versa, if two columns are swapped by mistake. Missing columns should be detected by the check on the total number of columns, so I am not too worried about collections being converted to another collection type due to missing columns. Perhaps we should just enforce type parenthesis in 4.0?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The dtests results look good, but it seems they were not triggered using the new dtest branch you created so I re-triggered them using your branch.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I didn&apos;t realize we could specify a dtest branch for the cqlsh tests, thanks for relaunching them. The results are clean for 3.0 and 3.11, but there was a problem for trunk: &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-10520&quot; title=&quot;Compressed writer and reader should support non-compressed data.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-10520&quot;&gt;&lt;del&gt;CASSANDRA-10520&lt;/del&gt;&lt;/a&gt; broke the clqshlib tests, and this caused the entire job to fail. I&apos;ve ninja fixed this, rebased and relaunched.&lt;/p&gt;</comment>
                            <comment id="15890123" author="pauloricardomg" created="Wed, 1 Mar 2017 13:08:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;It&apos;s actually supposed to be working, but I&apos;m not entirely sure about it. I&apos;ve left a comment here.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;sorry, I missed the comment. I guess we can leave it like this then and maybe address it on 4.0, since it&apos;s restricted to COPY FROM and not very critical.&lt;/p&gt;

&lt;p&gt;+1 then! Thanks!&lt;/p&gt;</comment>
                            <comment id="15891475" author="stefania" created="Thu, 2 Mar 2017 02:03:16 +0000"  >&lt;p&gt;Thanks! Committed to 3.0 as 496cfa8f5b160d26794b346ce360b513069aa300 and merged upwards.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37wx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>pauloricardomg</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[pauloricardomg]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>