<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:47:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-7561] On DROP we should invalidate CounterKeyCache as well as Key/Row cache</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-7561</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;We should also probably ensure we don&apos;t attempt to auto save &lt;em&gt;any&lt;/em&gt; of the caches while they are in an inconsistent state (i.e. there are keys present to be saved that should not be restored, or that would throw exceptions when we save (e.g. CounterCacheKey))&lt;/p&gt;</description>
                <environment></environment>
        <key id="12727871">CASSANDRA-7561</key>
            <summary>On DROP we should invalidate CounterKeyCache as well as Key/Row cache</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aleksey">Aleksey Yeschenko</assignee>
                                    <reporter username="benedict">Benedict Elliott Smith</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jul 2014 08:03:03 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:40 +0000</updated>
                            <resolved>Fri, 15 Aug 2014 19:22:29 +0000</resolved>
                                        <fixVersion>2.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14097557" author="iamaleksey" created="Thu, 14 Aug 2014 20:14:43 +0000"  >&lt;p&gt;Well. It shouldn&apos;t be throwing any exceptions, AFAIK, but we should still invalidate the counter cache, for consistency w/ row/key caches, if for nothing else.&lt;/p&gt;

&lt;p&gt;The patch also refactors CFS#invalidate()/CFS#invalidateCaches() to get rid of some duplication.&lt;/p&gt;

&lt;p&gt;+ adds missing invalidateKeyCacheForCf() call to invalidateCaches()&lt;/p&gt;</comment>
                            <comment id="14098811" author="benedict" created="Fri, 15 Aug 2014 17:44:47 +0000"  >&lt;blockquote&gt;&lt;p&gt;Well. It shouldn&apos;t be throwing any exceptions, AFAIK&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;CounterCacheKey.getPathInfo() is called during serialization, which is not safe if the CF has been dropped (since it will get a null cf back). So we still need to address preventing an autosave happening whilst the map contains keys that are in a dropped CF, or we need getPathInfo() at least to be safe during this (and return a result that is valid for all use cases), whichever is easiest.&lt;/p&gt;

&lt;p&gt;It looks like this bug may affect the row cache as well, except that we&apos;ve simply never noticed it since the window is too small. I filed this ticket a long time ago so cannot remember where/why I saw this happen. Mea culpa for not filling it into the ticket in the first place.&lt;/p&gt;</comment>
                            <comment id="14098858" author="benedict" created="Fri, 15 Aug 2014 18:10:02 +0000"  >&lt;p&gt;Since this is holding up 2.1-rc6, I&apos;m comfortable splitting the remainder of the fix out into a separate ticket. The code as it stands at least reduces the bug to a window of risk after DROP rather than a guaranteed failure.&lt;/p&gt;</comment>
                            <comment id="14098968" author="iamaleksey" created="Fri, 15 Aug 2014 19:22:29 +0000"  >&lt;p&gt;Committed. Feel free to open the follow-up 2.1.1 ticket and assign it to me.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12734507">CASSANDRA-7782</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12661870" name="7561.txt" size="2192" author="aleksey" created="Thu, 14 Aug 2014 20:11:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[aleksey]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>405976</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xv2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>405996</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>benedict</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[benedict]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>