<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:53:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-9300] token-generator - generated tokens too long</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-9300</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;&lt;tt&gt;token-generator&lt;/tt&gt; tool does not generate valid long values (2.0, 2.1, trunk).&lt;/p&gt;

&lt;p&gt;E.g. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;tools/bin/token-generator 4
DC #1:
  Node #1:                                        0
  Node #2:   42535295865117307932921825928971026432
  Node #3:   85070591730234615865843651857942052864
  Node #4:  127605887595351923798765477786913079296
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But should generate tokens like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-9223372036854775808
-4611686018427387904
0
4611686018427387904
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12827288">CASSANDRA-9300</key>
            <summary>token-generator - generated tokens too long</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="snazy">Robert Stupp</assignee>
                                    <reporter username="snazy">Robert Stupp</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 May 2015 13:53:38 +0000</created>
                <updated>Tue, 16 Apr 2019 09:31:12 +0000</updated>
                            <resolved>Thu, 14 May 2015 08:46:46 +0000</resolved>
                                        <fixVersion>2.0.16</fixVersion>
                    <fixVersion>2.1.6</fixVersion>
                    <fixVersion>2.2.0 beta 1</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14528631" author="jbellis" created="Tue, 5 May 2015 15:19:36 +0000"  >&lt;p&gt;It&apos;s generating tokens for the old RandomPartitioner, right?  I suppose we could add a -murmur3 option.&lt;/p&gt;

&lt;p&gt;In 3.x maybe we should just remove it, since &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-7032&quot; title=&quot;Improve vnode allocation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-7032&quot;&gt;&lt;del&gt;CASSANDRA-7032&lt;/del&gt;&lt;/a&gt; is coming along nicely (maybe even for 3.0).&lt;/p&gt;</comment>
                            <comment id="14529406" author="snazy" created="Tue, 5 May 2015 22:19:07 +0000"  >&lt;p&gt;Yes, Murmur3 is missing.&lt;/p&gt;

&lt;p&gt;Patch contains:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;support for Murmur3 (now default)&lt;/li&gt;
	&lt;li&gt;command line options for murmur3 + random partitioners&lt;/li&gt;
	&lt;li&gt;add new option &lt;tt&gt;--ringoffset&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;add new option &lt;tt&gt;--random&lt;/tt&gt; for random partitioner&lt;/li&gt;
	&lt;li&gt;suppress help output for options &lt;tt&gt;-&lt;del&gt;nts&lt;/tt&gt;, &lt;tt&gt;&lt;/del&gt;&lt;del&gt;onts&lt;/tt&gt;, &lt;tt&gt;&lt;/del&gt;&lt;del&gt;ringrange&lt;/tt&gt;, &lt;tt&gt;&lt;/del&gt;-ringoffset&lt;/tt&gt;. Suppressed them since these seem to be very old options - but not sure whether it&apos;s ok to suppress them.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14529433" author="jbellis" created="Tue, 5 May 2015 22:33:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thobbs&quot; class=&quot;user-hover&quot; rel=&quot;thobbs&quot;&gt;thobbs&lt;/a&gt; to review&lt;/p&gt;</comment>
                            <comment id="14535275" author="thobbs" created="Fri, 8 May 2015 19:03:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snazy&quot; class=&quot;user-hover&quot; rel=&quot;snazy&quot;&gt;snazy&lt;/a&gt; thanks for the patch, this tool doesn&apos;t get much love &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Would you mind writing some very basic dtests?  They don&apos;t have to be comprehensive, but it would be good to catch at least obvious failures like this one.&lt;/p&gt;</comment>
                            <comment id="14535320" author="snazy" created="Fri, 8 May 2015 19:18:56 +0000"  >&lt;p&gt;yup - will add some dtest for it&lt;/p&gt;</comment>
                            <comment id="14537175" author="snazy" created="Sun, 10 May 2015 13:39:05 +0000"  >&lt;p&gt;dtest available via &lt;a href=&quot;https://github.com/riptano/cassandra-dtest/pull/261&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/riptano/cassandra-dtest/pull/261&lt;/a&gt; (Is it correct to use a PR?)&lt;/p&gt;

&lt;p&gt;Had to update the original patch (had a bug when creating tokens for multiple DCs) - attached v2 of the patch&lt;/p&gt;

&lt;p&gt;The dtest has two &#8221;components&#8221;:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Create a 3 node cluster with tokens generated from token-generator&lt;/li&gt;
	&lt;li&gt;Check multiple DC/nodes combinations and verifies that there are no duplicate tokens and the amount of tokens matches the given arguments&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14540104" author="thobbs" created="Tue, 12 May 2015 16:00:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Stefania&quot; class=&quot;user-hover&quot; rel=&quot;stefania&quot;&gt;Stefania&lt;/a&gt; can you review?&lt;/p&gt;</comment>
                            <comment id="14541546" author="stefania" created="Wed, 13 May 2015 07:47:58 +0000"  >&lt;p&gt;Hi Robert, some issues with the murmur ranges which did not match, i.e. the defaults and the option callback values where different. I believe the correct range is -2^63 to 2^63-1 or at least these are the MIN and MAX of murmur partitioner in java. Please confirm. I also updated the description. All changes here: &lt;a href=&quot;https://github.com/stef1927/cassandra/commits/9300-token-gen&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/stef1927/cassandra/commits/9300-token-gen&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For the dtests, there was a tiny bug, please see here: &lt;a href=&quot;https://github.com/stef1927/cassandra-dtest/commits/9300-token-gen&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/stef1927/cassandra-dtest/commits/9300-token-gen&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For convenience I created a pull request to you (&lt;a href=&quot;https://github.com/snazy/cassandra-dtest/pull/1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/snazy/cassandra-dtest/pull/1&lt;/a&gt;) but for some reason I could not do the same for the cassandra branch.&lt;/p&gt;

&lt;p&gt;I believe you can create a pull request of your dtests to the riptano branch as soon as you like, provided you use the &apos;require&apos; tag that you see in my PR. Then when the JIRA is committed you ask them to remove the require tag, else just wait till the JIRA is committed and create the PR afterwards, without the require tag.&lt;/p&gt;</comment>
                            <comment id="14541665" author="snazy" created="Wed, 13 May 2015 09:45:22 +0000"  >&lt;p&gt;Well, you&apos;re right. The option values (not the defaults) are indeed wrong. &lt;tt&gt;ringoffset&lt;/tt&gt; is the lowest possible value but &lt;tt&gt;ringrange&lt;/tt&gt;&#160;covers the whole range (not the max value). So &lt;tt&gt;1^64&lt;/tt&gt; is correct here.&lt;/p&gt;

&lt;p&gt;I&apos;ve pushed the changes to my branches and opened a new PR against riptano/cassandra-dtest&lt;/p&gt;</comment>
                            <comment id="14541683" author="stefania" created="Wed, 13 May 2015 10:15:43 +0000"  >&lt;blockquote&gt;&lt;p&gt;but ringrange covers the whole range (not the max value). So 1^64 is correct here.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;OK, so we need max + 1. Max in murmur is Long.MAX_VALUE (2^63 -1), so plus one it becomes 2^63 and therefore 1&amp;lt;&amp;lt;63 and not 1&amp;lt;&amp;lt;64?&lt;/p&gt;

&lt;p&gt;Also, ringrange for the random partitioner is currently set to 1&amp;lt;&amp;lt;127, which is 2^127, the max in the random partitioner, should this be changed to max +1, 2^127 + 1 then?&lt;/p&gt;</comment>
                            <comment id="14542043" author="snazy" created="Wed, 13 May 2015 14:56:13 +0000"  >&lt;p&gt;No - the range is excluding.&lt;br/&gt;
&lt;tt&gt;ringoffset + ringrange == {{-(1&amp;lt;&amp;lt;63) + (1&amp;lt;&amp;lt;64) == (1&amp;lt;&amp;lt;63)-1&lt;/tt&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;RP&apos;s valid range is &lt;tt&gt;0..1&amp;lt;&amp;lt;127&lt;/tt&gt; (&lt;tt&gt;Token.TokenFactory#validate&lt;/tt&gt; in &lt;tt&gt;RandomPartitioner&lt;/tt&gt;)&lt;/p&gt;</comment>
                            <comment id="14542917" author="stefania" created="Wed, 13 May 2015 23:38:22 +0000"  >&lt;p&gt;Oh, now I get it thanks.&lt;/p&gt;

&lt;p&gt;However:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;python
Python 2.7.6 (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;, Mar 22 2014, 22:59:56) 
[GCC 4.8.2] on linux2
Type &lt;span class=&quot;code-quote&quot;&gt;&quot;help&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;copyright&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;credits&quot;&lt;/span&gt; or &lt;span class=&quot;code-quote&quot;&gt;&quot;license&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more information.
&amp;gt;&amp;gt;&amp;gt; -(1&amp;lt;&amp;lt;63) + (1&amp;lt;&amp;lt;64) == (1&amp;lt;&amp;lt;63)-1
False
&amp;gt;&amp;gt;&amp;gt; -(1&amp;lt;&amp;lt;63) + (1&amp;lt;&amp;lt;64) -1 == (1&amp;lt;&amp;lt;63) -1
True
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So (1 &amp;lt;&amp;lt;64) -1 then?&lt;/p&gt;</comment>
                            <comment id="14542926" author="snazy" created="Wed, 13 May 2015 23:45:38 +0000"  >&lt;p&gt;Nope. The range is excluding. (Yes, my equation was wrong - should have been &lt;tt&gt;-(1&amp;lt;&amp;lt;63) + (1&amp;lt;&amp;lt;64) == (1&amp;lt;&amp;lt;63)&lt;/tt&gt;).&lt;br/&gt;
It can only generate numbers in the range &lt;tt&gt;ringoffset &amp;lt;= X &amp;lt; ringoffset + ringrange&lt;/tt&gt; ; &lt;tt&gt;-(1&amp;lt;&amp;lt;63) &amp;lt; X &amp;lt; -(1&amp;lt;&amp;lt;63) + (1&amp;lt;&amp;lt;64)&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="14543044" author="stefania" created="Thu, 14 May 2015 01:23:26 +0000"  >&lt;p&gt;Sorry I focused on the equation and not so much the exclusive part. Then yes 1 &amp;lt;&amp;lt; 64 is correct.&lt;/p&gt;

&lt;p&gt;So difference between MURMUR and RP is that for MURMUR the minimum value, -2^63, is a valid value whilst for RP the minimum, -1, is not valid.&lt;/p&gt;

&lt;p&gt;+1 to commit.&lt;/p&gt;</comment>
                            <comment id="14543393" author="snazy" created="Thu, 14 May 2015 08:46:46 +0000"  >&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;Committed as 1611ef3d1995337998b9d7514c7ea5c35fa59895 to 2.0 branch for fix-version 2.0.16 (not yet available in JIRA)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12731794" name="9300-v2.txt" size="6896" author="snazy" created="Sun, 10 May 2015 13:39:05 +0000"/>
                            <attachment id="12730629" name="9300.txt" size="5244" author="snazy" created="Tue, 5 May 2015 22:19:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[snazy]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 27 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2eawn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>stefania</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[stefania]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>