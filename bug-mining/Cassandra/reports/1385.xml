<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 22:28:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-3693] strange values of pending tasks with compactionstats (below 0)</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-3693</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;during scrub:&lt;/p&gt;

&lt;p&gt;Every 2.0s: for i in 1 2 3; do nodetool -h 192.168.2.$i compactionstats; done                                                                                                                                     Wed Jan  4 13:48:13 2012&lt;/p&gt;

&lt;p&gt;pending tasks: 2147483646&lt;br/&gt;
          compaction type        keyspace   column family bytes compacted     bytes total  progress&lt;br/&gt;
               Compaction         Archive        Messages     28034971475     72393139120    38.73%&lt;br/&gt;
pending tasks: -2147483647&lt;br/&gt;
          compaction type        keyspace   column family bytes compacted     bytes total  progress&lt;br/&gt;
               Compaction         Archive        Messages     24575687282     72385305067    33.95%&lt;br/&gt;
pending tasks: 0&lt;/p&gt;
</description>
                <environment>&lt;p&gt;linux, oracle java 1.6.26&lt;/p&gt;</environment>
        <key id="12537183">CASSANDRA-3693</key>
            <summary>strange values of pending tasks with compactionstats (below 0)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10003" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Low</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbellis">Jonathan Ellis</assignee>
                                    <reporter username="zenek_kraweznik0">Zenek Kraweznik</reporter>
                        <labels>
                            <label>compaction</label>
                    </labels>
                <created>Wed, 4 Jan 2012 12:53:28 +0000</created>
                <updated>Tue, 16 Apr 2019 09:32:43 +0000</updated>
                            <resolved>Wed, 11 Jan 2012 07:56:58 +0000</resolved>
                                        <fixVersion>1.0.7</fixVersion>
                                    <component>Legacy/Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13180255" author="zenek_kraweznik0" created="Thu, 5 Jan 2012 09:10:52 +0000"  >&lt;p&gt;Also my cassandra is doing compactions on two nodes in loop. restart of cassandra service doesn&apos;t fix this. After restart compaction is also started.&lt;/p&gt;</comment>
                            <comment id="13180930" author="jbellis" created="Thu, 5 Jan 2012 23:12:49 +0000"  >&lt;p&gt;Are you using LeveledCompaction?&lt;/p&gt;

&lt;p&gt;How much data do you have on disk?  How many sstables?&lt;/p&gt;</comment>
                            <comment id="13182293" author="zenek_kraweznik0" created="Sun, 8 Jan 2012 21:13:02 +0000"  >&lt;p&gt;I&apos;m using leveled compaction (with 4096mb limit, but with compression sstables are smaller).&lt;/p&gt;

&lt;p&gt;There&apos;s a 80GB per node (3 nodes, replication factor=3).&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;find /var/lib/cassandra/data -type f | wc -l&lt;br/&gt;
273&lt;br/&gt;
#&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;=&amp;gt; 273 sstables&lt;/p&gt;

&lt;p&gt;compactionstats looks now like this:&lt;/p&gt;

&lt;p&gt;pending tasks: -2147483648&lt;br/&gt;
          compaction type        keyspace   column family bytes compacted     bytes total  progress&lt;br/&gt;
               Compaction         Archive        Messages     35050352366               0       n/a&lt;/p&gt;

&lt;p&gt;I wonder why 0 bytes total is visible on this node (nodetool ring is reporting 37.18GB).&lt;/p&gt;

&lt;p&gt;After every compactions bytes total is about 73xxxxxxxxx (i guess it is not compress data size), but this value isn&apos;t saved anywhere.&lt;/p&gt;</comment>
                            <comment id="13183724" author="jbellis" created="Tue, 10 Jan 2012 23:58:03 +0000"  >&lt;p&gt;Patch to keep compaction task count arithmetic as a long until after the division by sstable size has been done.&lt;/p&gt;</comment>
                            <comment id="13183937" author="slebresne" created="Wed, 11 Jan 2012 07:56:58 +0000"  >&lt;p&gt;+1, committed&lt;/p&gt;</comment>
                            <comment id="13183983" author="zenek_kraweznik0" created="Wed, 11 Jan 2012 10:34:01 +0000"  >&lt;p&gt;ok, thanks. I&apos;ll chech it after ugprade to 1.0.7&lt;/p&gt;

&lt;p&gt;And second question from my last comment: &quot;I wonder why 0 bytes total is visible on this node during compaction (nodetool ring is reporting 37.18GB).&quot;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12510128" name="3693.txt" size="2242" author="jbellis" created="Tue, 10 Jan 2012 23:58:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jbellis]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>222692</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 45 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0gn33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95170</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>slebresne</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[slebresne]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12961"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>