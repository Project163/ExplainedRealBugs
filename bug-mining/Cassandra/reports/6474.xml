<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:30:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-19578] Concurrent equivalent schema updates lead to unresolved disagreement</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-19578</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;As part of &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17819&quot; title=&quot;Test failure: org.apache.cassandra.distributed.test.SchemaTest.schemaReset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17819&quot;&gt;&lt;del&gt;CASSANDRA-17819&lt;/del&gt;&lt;/a&gt; a check for empty schema changes was added to the updateSchema. This only looks at the &lt;em&gt;logical&lt;/em&gt; schema difference of the schemas, but the changes made to the system_schema keyspace are the ones that actually are involved in the digest.&lt;/p&gt;

&lt;p&gt;If two nodes issue the same CREATE statement the difference from the keyspace.diff would be empty but the timestamps on the mutations would be different, leading to a pseudo schema disagreement which will never resolve until resetlocalschema or nodes being bounced.&lt;/p&gt;

&lt;p&gt;Only impacts 4.1&lt;/p&gt;

&lt;p&gt;test and fix : &lt;a href=&quot;https://github.com/clohfink/cassandra/commit/ba915f839089006ac6d08494ef19dc010bcd6411&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/clohfink/cassandra/commit/ba915f839089006ac6d08494ef19dc010bcd6411&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13576592">CASSANDRA-19578</key>
            <summary>Concurrent equivalent schema updates lead to unresolved disagreement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="clohfink">Chris Lohfink</assignee>
                                    <reporter username="clohfink">Chris Lohfink</reporter>
                        <labels>
                    </labels>
                <created>Sat, 20 Apr 2024 01:11:50 +0000</created>
                <updated>Thu, 2 May 2024 02:17:10 +0000</updated>
                            <resolved>Tue, 30 Apr 2024 22:04:12 +0000</resolved>
                                        <fixVersion>4.1.5</fixVersion>
                    <fixVersion>5.0-rc1</fixVersion>
                                    <component>Cluster/Schema</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17839276" author="jrwest" created="Sat, 20 Apr 2024 19:34:11 +0000"  >&lt;p&gt;+1. We should definitely get this into a 4.1.5 quickly as its a pretty significant operational bug. We should get a full test run on this branch going so we can merge. &lt;/p&gt;</comment>
                            <comment id="17839278" author="brandon.williams" created="Sat, 20 Apr 2024 19:41:17 +0000"  >&lt;p&gt;I&apos;ve started a run: &lt;a href=&quot;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch-before-5/2678/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ci-cassandra.apache.org/view/patches/job/Cassandra-devbranch-before-5/2678/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17839280" author="brandon.williams" created="Sat, 20 Apr 2024 20:00:33 +0000"  >&lt;p&gt;We&apos;ll also need to multiplex SchemaTest for flakiness, which I ran &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1592/workflows/a84707b9-9ff8-4d49-af26-015a5e99d2b4/jobs/85318/tests&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; and is failing, which I verified, and learned that it is only failing when the suite is run, but testTransKsMigration passes in isolation.&lt;/p&gt;</comment>
                            <comment id="17839767" author="brandon.williams" created="Mon, 22 Apr 2024 16:06:48 +0000"  >&lt;p&gt;Unsurprisingly testTransKsMigration also failed in the CI run, but that is the only one that needs to be addressed there.&lt;/p&gt;</comment>
                            <comment id="17842111" author="brandon.williams" created="Mon, 29 Apr 2024 17:24:29 +0000"  >&lt;p&gt;Hmm, I see in the description this says &quot;Only impacts 4.1&quot; but then &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jwest&quot; class=&quot;user-hover&quot; rel=&quot;jwest&quot;&gt;jwest&lt;/a&gt; added 5.0.  If I apply the added test to 5.0 (and make DefaultSchemaUpdateHandler.applyMutations public so it can run) then it fails there also.  Does this affect 5.0?&lt;/p&gt;</comment>
                            <comment id="17842181" author="jrwest" created="Mon, 29 Apr 2024 22:47:44 +0000"  >&lt;p&gt;4.1 is when it was introduced but afaik the issue wasn&apos;t fixed so its likely broken in 5.0.x as well &amp;#8211; or any code where TCM isn&apos;t merged post 4.1&lt;/p&gt;</comment>
                            <comment id="17842420" author="brandon.williams" created="Tue, 30 Apr 2024 15:09:51 +0000"  >&lt;p&gt;I see, thanks.  In that case, even though this is in 4.1 I don&apos;t think we should release 5.0 with it present.  To that end, I added a small fix for the test &lt;a href=&quot;https://github.com/driftx/cassandra/commit/6ec147868d92c57e27959c513f70a5e597ef1192&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; which hopefully results in clean CI:&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Branch&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;CI&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-19578-4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;4.1&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1614/workflows/ac2b40a8-7275-464f-9a1b-96f08d9c703d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j8&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1614/workflows/d6f7fd59-bcd1-41b6-96a2-b4ca5b7ee1ad&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/driftx/cassandra/tree/CASSANDRA-19578-5.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;5.0&lt;/a&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1615/workflows/b03ed4d4-ed4c-4dcb-b3eb-f29436a35067&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j11&lt;/a&gt;, &lt;a href=&quot;https://app.circleci.com/pipelines/github/driftx/cassandra/1615/workflows/ddba8908-224a-4b89-9071-e9fc4813b7d3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;j17&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="17842448" author="brandon.williams" created="Tue, 30 Apr 2024 16:53:38 +0000"  >&lt;p&gt;4.1 ran into &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17298&quot; title=&quot;Improve accuracy of memtable heap usage tracking&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17298&quot;&gt;&lt;del&gt;CASSANDRA-17298&lt;/del&gt;&lt;/a&gt; and 5.0 hit &lt;a href=&quot;https://issues.apache.org/jira/browse/CASSANDRA-17798&quot; title=&quot;Flaky org.apache.cassandra.tools TopPartitionsTest testServiceTopPartitionsSingleTable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CASSANDRA-17798&quot;&gt;CASSANDRA-17798&lt;/a&gt; and encountered a timeout on IntersectFilteringQueryTest which passes locally, otherwise this is clean.  I am +1 here; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jwest&quot; class=&quot;user-hover&quot; rel=&quot;jwest&quot;&gt;jwest&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=clohfink&quot; class=&quot;user-hover&quot; rel=&quot;clohfink&quot;&gt;clohfink&lt;/a&gt; if one or both of you are good with the fix and 5.0, we can commit.&lt;/p&gt;</comment>
                            <comment id="17842491" author="clohfink" created="Tue, 30 Apr 2024 19:35:19 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="17842510" author="brandon.williams" created="Tue, 30 Apr 2024 22:04:12 +0000"  >&lt;p&gt;Committed, thanks!&lt;/p&gt;</comment>
                            <comment id="17842822" author="jrwest" created="Thu, 2 May 2024 02:08:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=brandon.williams&quot; class=&quot;user-hover&quot; rel=&quot;brandon.williams&quot;&gt;brandon.williams&lt;/a&gt; following up on your comment re: holding up 5.0 release until it was merged, I wonder if we want to consider a 4.1.5 release as well. Thoughts? &lt;/p&gt;</comment>
                            <comment id="17842825" author="brandon.williams" created="Thu, 2 May 2024 02:17:10 +0000"  >&lt;p&gt;4.x releases have been on my radar for weeks, and now the various pieces (this being one) have nearly come together.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[clohfink]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12313825" key="com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect">
                        <customfieldname>Bug Category</customfieldname>
                        <customfieldvalues>
                                                    <customfieldvalue key="12982" cascade-level=""><![CDATA[Correctness]]></customfieldvalue>
                                <customfieldvalue key="12986" cascade-level="1"><![CDATA[Recoverable Corruption / Loss]]></customfieldvalue>
            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313821" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12965"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313822" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Discovered By</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12969"><![CDATA[User Report]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 27 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12313921" key="jira.plugin.projectspecificselectfield.jpssf:multicftype">
                        <customfieldname>Platform</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="13076"><![CDATA[All]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1orjs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[brandon.williams]]></customfieldvalue>
        <customfieldvalue><![CDATA[jwest]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12963"><![CDATA[Critical]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311420" key="com.atlassian.jira.plugin.system.customfieldtypes:version">
                        <customfieldname>Since Version</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue id="12352367">4.1-beta1</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313924" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Source Control Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;&lt;a href=&quot;https://github.com/apache/cassandra/commit/a6e80317ded9cbb500ce68e7d3fb91b5fbcb5e48&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/cassandra/commit/a6e80317ded9cbb500ce68e7d3fb91b5fbcb5e48&lt;/a&gt;&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313823" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Test and Documentation Plan</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;run CI&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>