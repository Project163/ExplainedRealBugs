<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Tue Nov 11 23:11:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CASSANDRA-14314] Fix argument passing for SSLContext in trunk</title>
                <link>https://issues.apache.org/jira/browse/CASSANDRA-14314</link>
                <project id="12310865" key="CASSANDRA">Apache Cassandra</project>
                    <description>&lt;p&gt;Argument passing has a minor bug while creating the SSLContext. Audit and make sure that the client &amp;amp; server SSL contexts are created at appropriate locations.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13145277">CASSANDRA-14314</key>
            <summary>Fix argument passing for SSLContext in trunk</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="10002" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Normal</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="djoshi">Dinesh Joshi</assignee>
                                    <reporter username="djoshi">Dinesh Joshi</reporter>
                        <labels>
                            <label>security</label>
                    </labels>
                <created>Thu, 15 Mar 2018 05:09:12 +0000</created>
                <updated>Fri, 15 May 2020 07:59:49 +0000</updated>
                            <resolved>Thu, 22 Mar 2018 13:42:11 +0000</resolved>
                                        <fixVersion>4.0-alpha1</fixVersion>
                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16399929" author="djoshi3" created="Thu, 15 Mar 2018 05:18:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasobrown&quot; class=&quot;user-hover&quot; rel=&quot;jasobrown&quot;&gt;jasobrown&lt;/a&gt; - please review.&lt;/p&gt;

&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;sslfactory&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/dineshjoshi/cassandra/tree/fix-args-to-sslfactory&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/dineshjoshi/workflows/cassandra/tree/fix-args-to-sslfactory&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests &amp;amp; dtests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="16400953" author="jasobrown" created="Thu, 15 Mar 2018 18:49:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=djoshi3&quot; class=&quot;user-hover&quot; rel=&quot;djoshi3&quot;&gt;djoshi3&lt;/a&gt; and I spoke offline about this, and we uncovered some futher incorrectness with &lt;tt&gt;SSLFactory.getSslContext()&lt;/tt&gt;. We&apos;ll have an updated patch soon.&lt;/p&gt;</comment>
                            <comment id="16403296" author="djoshi3" created="Sat, 17 Mar 2018 07:14:35 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasobrown&quot; class=&quot;user-hover&quot; rel=&quot;jasobrown&quot;&gt;jasobrown&lt;/a&gt;, I have updated the branch with a bunch of changes. Here&apos;s a short rundown of the changes -&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Removed the &lt;tt&gt;serverSslContext&lt;/tt&gt; and &lt;tt&gt;clientSslContext&lt;/tt&gt; &lt;tt&gt;AtomicReference&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Introduced a new field &lt;tt&gt;SocketType&lt;/tt&gt; - so now you can create a combination of (PEER, CLIENT) &lt;tt&gt;ConnectionType&lt;/tt&gt; and (SERVER, CLIENT) &lt;tt&gt;SocketType&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Netty SSL contexts are cached in a &lt;tt&gt;ConcurrentHashMap&lt;/tt&gt;. I haven&apos;t currently implemented any strategy to prune or reset this map. My expectation is in the steady state this map should not grow.&lt;/li&gt;
	&lt;li&gt;Hot reloading is updated to use this map.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="16403793" author="djoshi3" created="Sat, 17 Mar 2018 23:38:38 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;sslfactory&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/dineshjoshi/cassandra/tree/fix-args-to-sslfactory&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/dineshjoshi/workflows/cassandra/tree/fix-args-to-sslfactory&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests &amp;amp; dtests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;
</comment>
                            <comment id="16403810" author="djoshi3" created="Sun, 18 Mar 2018 00:22:10 +0000"  >&lt;p&gt;Squashed the commit - b9836dc07560ffa03eb6fb3902a2d96c3ff5715e&lt;/p&gt;</comment>
                            <comment id="16408405" author="jasobrown" created="Wed, 21 Mar 2018 18:43:35 +0000"  >&lt;p&gt;I&apos;ve made a few changes to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=djoshi3&quot; class=&quot;user-hover&quot; rel=&quot;djoshi3&quot;&gt;djoshi3&lt;/a&gt;&apos;s branch, which was a great step in the right direction, and pushed up to my repo:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;sslfactory&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://github.com/jasobrown/cassandra/tree/fix-args-to-sslfactory&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;branch&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;a href=&quot;https://circleci.com/gh/jasobrown/workflows/cassandra/tree/fix-args-to-sslfactory&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;utests &amp;amp; dtests&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I renamed &lt;tt&gt;ConnectionType.CLIENT&lt;/tt&gt; to &lt;tt&gt;ConnectionType.NATIVE_PROTOCOL&lt;/tt&gt; (and &lt;tt&gt;ConnectionType.PEER&lt;/tt&gt; to &lt;tt&gt;ConnectionType.INTERNODE_MESSAGING&lt;/tt&gt;) as it was just confusing to me what &apos;client&apos; vs &apos;server&apos; really meant. The change ends up reading very well, especially at call sites.&lt;/li&gt;
	&lt;li&gt;as a petty readability change, I replaced &lt;tt&gt;SSLFactory.HotReloadableFile.Type&lt;/tt&gt; with &lt;tt&gt;ConnectionType&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;SSLFactory.CacheKey&lt;/tt&gt; - I moved the &lt;tt&gt;equals&lt;/tt&gt;/&lt;tt&gt;hashCode&lt;/tt&gt; logic for &lt;tt&gt;EncryptionOptions&lt;/tt&gt; fields into &lt;tt&gt;equals&lt;/tt&gt;/&lt;tt&gt;hashCode&lt;/tt&gt; functions on &lt;tt&gt;EncryptionOptions&lt;/tt&gt; itself.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;Server&lt;/tt&gt; - &lt;tt&gt;ConnectionType&lt;/tt&gt; should be &lt;tt&gt;CLIENT&lt;/tt&gt; (now &lt;tt&gt;NATIVE_PROTOCOL&lt;/tt&gt;) as this is where we start the server-side of the client-facing native protocol.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;NettyFactory.OutboundInitializer.initChannel&lt;/tt&gt; - &lt;tt&gt;ConnectionType&lt;/tt&gt; should be &lt;tt&gt;PEER&lt;/tt&gt; (now &lt;tt&gt;INTERNODE_MESSAGING&lt;/tt&gt;) as this is where we start the client-side of a internode messaging connection.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;SSLFactory.getSslContext&lt;/tt&gt; - when &lt;tt&gt;cachedSslContexts.putIfAbsent&lt;/tt&gt; is called, if the value is not null, we should return that value rather than using the instance we just created. That way we reuse the &apos;winning&apos; context.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;SSLFactory.createNettySslContext&lt;/tt&gt; - I&apos;m not sure we need to check if &lt;tt&gt;options.enabled&lt;/tt&gt;. Actually, I&apos;m not sure if there&apos;s a strong argument for why we should ever not load the keystore. In 3.0, we always loaded the keystore. wdyt?&lt;/li&gt;
	&lt;li&gt;Last, while I can&apos;t (or don&apos;t want to) rename the yaml properties (&lt;tt&gt;client_encryption_options&lt;/tt&gt;/&lt;tt&gt;server_encryption_options&lt;/tt&gt;), I can clean up the code that refers to them. Hence, in DD I&apos;ve changed &lt;tt&gt;getServerEncryptionOptions&lt;/tt&gt; to &lt;tt&gt;getInternodeMessagingEncryptonOptions&lt;/tt&gt; and so on. This make the call sites to get that data more obvious, as well. This change is not a requirement for this patch, but helps clarify the code.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16408499" author="djoshi3" created="Wed, 21 Mar 2018 20:07:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasobrown&quot; class=&quot;user-hover&quot; rel=&quot;jasobrown&quot;&gt;jasobrown&lt;/a&gt; a few comments -&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;SSLFactory&lt;/tt&gt; line 327 info message should read - &quot;SSL certificates have been updated. Reseting the ssl contexts for new connections.&quot;. Please drop the word &quot;peer&quot;.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;HotReloadableFile&lt;/tt&gt; we can get rid of &lt;tt&gt;isServer&lt;/tt&gt; and &lt;tt&gt;isClient&lt;/tt&gt; methods and associated code as we&apos;re not making any distinctions any more.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Rest looks good.&lt;/p&gt;</comment>
                            <comment id="16409527" author="jasobrown" created="Thu, 22 Mar 2018 13:42:11 +0000"  >&lt;p&gt;committed, with minor nits addressed, as sha &lt;tt&gt;11496039fb18bb45407246602e31740c56d28157&lt;/tt&gt;. Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12313920" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Authors</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[djoshi]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 34 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3rbtr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_10022" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Reviewer</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>jasobrown</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313420" key="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker">
                        <customfieldname>Reviewers</customfieldname>
                        <customfieldvalues>
                                    <customfieldvalue><![CDATA[jasobrown]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313820" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="12962"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>