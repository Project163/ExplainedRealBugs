diff --git a/CHANGES.txt b/CHANGES.txt
index 641326e447..180b044575 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,3 +1,7 @@
+2.1.0-final
+ * (Windows) fix startup when WMI memory query fails (CASSANDRA-7505)
+
+
 2.1.0-rc3
  * Consider expiry when reconciling otherwise equal cells (CASSANDRA-7403)
  * Introduce CQL support for stress tool (CASSANDRA-6146)
diff --git a/conf/cassandra-env.ps1 b/conf/cassandra-env.ps1
index 87a5cfecf9..b8a806fc5d 100644
--- a/conf/cassandra-env.ps1
+++ b/conf/cassandra-env.ps1
@@ -66,6 +66,14 @@ Function CalculateHeapSizes
     }
 
     $memObject = Get-WMIObject -class win32_physicalmemory
+    if ($memObject -eq $null)
+    {
+        echo "WARNING!  Could not determine system memory.  Defaulting to 2G heap, 512M newgen.  Manually override in conf/cassandra-env.ps1 for different heap values."
+        $env:MAX_HEAP_SIZE = "2048M"
+        $env:HEAP_NEWSIZE = "512M"
+        return
+    }
+
     $memory = ($memObject | Measure-Object Capacity -Sum).sum
     $memoryMB = [Math]::Truncate($memory / (1024*1024))
 
