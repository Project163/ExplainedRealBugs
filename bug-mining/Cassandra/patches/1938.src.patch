diff --git a/CHANGES.txt b/CHANGES.txt
index d3e04a7c5b..9a41c87ed1 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -8,7 +8,7 @@
  * Fix message when trying to alter a clustering key type (CASSANDRA-5012)
 Merged from 1.1
  * Improve schema propagation performance (CASSANDRA-5025)
-
+ * Fix for IndexHelper.IndexFor throws OOB Exception (CASSANDRA-5030)
 
 1.2-beta3
  * make consistency level configurable in cqlsh (CASSANDRA-4829)
diff --git a/src/java/org/apache/cassandra/db/columniterator/SSTableNamesIterator.java b/src/java/org/apache/cassandra/db/columniterator/SSTableNamesIterator.java
index 766c282d48..da4631df53 100644
--- a/src/java/org/apache/cassandra/db/columniterator/SSTableNamesIterator.java
+++ b/src/java/org/apache/cassandra/db/columniterator/SSTableNamesIterator.java
@@ -234,7 +234,7 @@ public class SSTableNamesIterator extends SimpleAbstractColumnIterator implement
         for (ByteBuffer name : filteredColumnNames)
         {
             int index = IndexHelper.indexFor(name, indexList, comparator, false, lastIndexIdx);
-            if (index == indexList.size())
+            if (index < 0 || index == indexList.size())
                 continue;
             IndexHelper.IndexInfo indexInfo = indexList.get(index);
             // Check the index block does contain the column names and that we haven't inserted this block yet.
diff --git a/src/java/org/apache/cassandra/io/sstable/IndexHelper.java b/src/java/org/apache/cassandra/io/sstable/IndexHelper.java
index d01c45d499..6a2e101d8c 100644
--- a/src/java/org/apache/cassandra/io/sstable/IndexHelper.java
+++ b/src/java/org/apache/cassandra/io/sstable/IndexHelper.java
@@ -154,6 +154,10 @@ public class IndexHelper
     {
         if (name.remaining() == 0 && reversed)
             return indexList.size() - 1;
+
+        if (lastIndex >= indexList.size())
+            return -1;
+
         IndexInfo target = new IndexInfo(name, name, 0, 0);
         /*
         Take the example from the unit test, and say your index looks like this:
diff --git a/test/unit/org/apache/cassandra/io/sstable/IndexHelperTest.java b/test/unit/org/apache/cassandra/io/sstable/IndexHelperTest.java
index d5370d6208..d96cab1348 100644
--- a/test/unit/org/apache/cassandra/io/sstable/IndexHelperTest.java
+++ b/test/unit/org/apache/cassandra/io/sstable/IndexHelperTest.java
@@ -20,6 +20,9 @@ package org.apache.cassandra.io.sstable;
 
 import java.util.ArrayList;
 import java.util.List;
+
+import static junit.framework.Assert.*;
+
 import org.junit.Test;
 
 import org.apache.cassandra.db.marshal.AbstractType;
@@ -39,16 +42,24 @@ public class IndexHelperTest
 
         AbstractType comp = IntegerType.instance;
 
-        assert 0 == IndexHelper.indexFor(bytes(-1L), indexes, comp, false, -1);
-        assert 0 == IndexHelper.indexFor(bytes(5L), indexes, comp, false, -1);
-        assert 1 == IndexHelper.indexFor(bytes(12L), indexes, comp, false, -1);
-        assert 2 == IndexHelper.indexFor(bytes(17L), indexes, comp, false, -1);
-        assert 3 == IndexHelper.indexFor(bytes(100L), indexes, comp, false, -1);
-
-        assert -1 == IndexHelper.indexFor(bytes(-1L), indexes, comp, true, -1);
-        assert 0 == IndexHelper.indexFor(bytes(5L), indexes, comp, true, -1);
-        assert 1 == IndexHelper.indexFor(bytes(12L), indexes, comp, true, -1);
-        assert 1 == IndexHelper.indexFor(bytes(17L), indexes, comp, true, -1);
-        assert 2 == IndexHelper.indexFor(bytes(100L), indexes, comp, true, -1);
+        assertEquals(0, IndexHelper.indexFor(bytes(-1L), indexes, comp, false, -1));
+        assertEquals(0, IndexHelper.indexFor(bytes(5L), indexes, comp, false, -1));
+        assertEquals(1, IndexHelper.indexFor(bytes(12L), indexes, comp, false, -1));
+        assertEquals(2, IndexHelper.indexFor(bytes(17L), indexes, comp, false, -1));
+        assertEquals(3, IndexHelper.indexFor(bytes(100L), indexes, comp, false, -1));
+        assertEquals(1, IndexHelper.indexFor(bytes(100L), indexes, comp, false, 0));
+        assertEquals(2, IndexHelper.indexFor(bytes(100L), indexes, comp, false, 1));
+        assertEquals(3, IndexHelper.indexFor(bytes(100L), indexes, comp, false, 2));
+        assertEquals(-1, IndexHelper.indexFor(bytes(100L), indexes, comp, false, 3));
+
+        assertEquals(-1, IndexHelper.indexFor(bytes(-1L), indexes, comp, true, -1));
+        assertEquals(0, IndexHelper.indexFor(bytes(5L), indexes, comp, true, -1));
+        assertEquals(1, IndexHelper.indexFor(bytes(17L), indexes, comp, true, -1));
+        assertEquals(2, IndexHelper.indexFor(bytes(100L), indexes, comp, true, -1));
+        assertEquals(2, IndexHelper.indexFor(bytes(100L), indexes, comp, true, 0));
+        assertEquals(1, IndexHelper.indexFor(bytes(12L), indexes, comp, true, -1));
+        assertEquals(2, IndexHelper.indexFor(bytes(100L), indexes, comp, true, 1));
+        assertEquals(2, IndexHelper.indexFor(bytes(100L), indexes, comp, true, 2));
+        assertEquals(-1, IndexHelper.indexFor(bytes(100L), indexes, comp, true, 4));
     }
 }
