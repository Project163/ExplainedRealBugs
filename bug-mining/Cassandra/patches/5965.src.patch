diff --git a/CHANGES.txt b/CHANGES.txt
index b055b12e66..00d4352bb7 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 3.11.13
+ * dropping of a materialized view creates a snapshot with dropped- prefix (CASSANDRA-17415)
 Merged from 3.0:
  * Suppress inapplicable CVEs (CASSANDRA-17368)
  * Fix flaky test - test_cqlsh_completion.TestCqlshCompletion (CASSANDRA-17338)
diff --git a/src/java/org/apache/cassandra/config/Schema.java b/src/java/org/apache/cassandra/config/Schema.java
index 3ba8673b7c..04c70e617f 100644
--- a/src/java/org/apache/cassandra/config/Schema.java
+++ b/src/java/org/apache/cassandra/config/Schema.java
@@ -759,7 +759,7 @@ public class Schema
         CompactionManager.instance.interruptCompactionFor(Collections.singleton(cfs.metadata), true);
 
         if (DatabaseDescriptor.isAutoSnapshot())
-            cfs.snapshot(Keyspace.getTimestampedSnapshotName(cfs.name));
+            cfs.snapshot(Keyspace.getTimestampedSnapshotNameWithPrefix(cfs.name, ColumnFamilyStore.SNAPSHOT_DROP_PREFIX));
 
         // reinitialize the keyspace.
         ViewDefinition view = oldKsm.views.get(viewName).get();
diff --git a/test/unit/org/apache/cassandra/cql3/ViewTest.java b/test/unit/org/apache/cassandra/cql3/ViewTest.java
index ba7eb2b459..2894e7b2a3 100644
--- a/test/unit/org/apache/cassandra/cql3/ViewTest.java
+++ b/test/unit/org/apache/cassandra/cql3/ViewTest.java
@@ -18,6 +18,9 @@
 
 package org.apache.cassandra.cql3;
 
+import java.io.File;
+import java.nio.file.Path;
+import java.nio.file.Paths;
 import java.util.ArrayList;
 import java.util.HashSet;
 import java.util.List;
@@ -25,9 +28,14 @@ import java.util.concurrent.CountDownLatch;
 import java.util.concurrent.Future;
 import java.util.concurrent.TimeUnit;
 import java.util.concurrent.atomic.AtomicInteger;
+import java.util.regex.Matcher;
+import java.util.regex.Pattern;
+import java.util.stream.Collectors;
 
 import com.google.common.util.concurrent.Uninterruptibles;
 
+import org.apache.commons.io.FileUtils;
+
 import junit.framework.Assert;
 import org.junit.After;
 import org.junit.Before;
@@ -55,7 +63,6 @@ import org.apache.cassandra.db.marshal.AsciiType;
 import org.apache.cassandra.db.view.View;
 import org.apache.cassandra.exceptions.SyntaxException;
 import org.apache.cassandra.schema.KeyspaceParams;
-import org.apache.cassandra.schema.SchemaKeyspace;
 import org.apache.cassandra.schema.SchemaKeyspaceTables;
 import org.apache.cassandra.service.ClientWarn;
 import org.apache.cassandra.transport.ProtocolVersion;
@@ -64,11 +71,11 @@ import org.jboss.byteman.contrib.bmunit.BMRule;
 import org.jboss.byteman.contrib.bmunit.BMRules;
 import org.jboss.byteman.contrib.bmunit.BMUnitRunner;
 
-import static junit.framework.Assert.fail;
 import static org.assertj.core.api.Assertions.assertThat;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.fail;
 
 @RunWith(BMUnitRunner.class)
 public class ViewTest extends CQLTester
@@ -96,7 +103,7 @@ public class ViewTest extends CQLTester
     public void end() throws Throwable
     {
         for (String viewName : views)
-            executeNet(protocolVersion, "DROP MATERIALIZED VIEW " + viewName);
+            executeNet(protocolVersion, "DROP MATERIALIZED VIEW IF EXISTS " + viewName);
     }
 
     private void createView(String name, String query) throws Throwable
@@ -1617,6 +1624,42 @@ public class ViewTest extends CQLTester
                                              "INSERT INTO %s(k, v) VALUES (2, 3)"), row(3, 2));
     }
 
+    @Test
+    public void testSnapshotNameOfDroppedViewHasDroppedPrefix() throws Throwable
+    {
+        createTable("CREATE TABLE %s (k int PRIMARY KEY, v int)");
+
+        executeNet(protocolVersion, "USE " + keyspace());
+
+        boolean enableMaterializedViews = DatabaseDescriptor.getEnableMaterializedViews();
+        try
+        {
+            // create it
+            DatabaseDescriptor.setEnableMaterializedViews(true);
+            createView("viewtobedropped", "CREATE MATERIALIZED VIEW %s AS SELECT v FROM %%s WHERE k IS NOT NULL AND v IS NOT NULL PRIMARY KEY (v, k)");
+
+            // drop it
+            executeNet(protocolVersion, "DROP MATERIALIZED VIEW " + keyspace() + ".viewtobedropped");
+
+            String dataDir = DatabaseDescriptor.getAllDataFileLocations()[0];
+            // look for snapshots which have "dropped-" prefix, there has to be such
+            Pattern compile = Pattern.compile(String.format("%s/viewtobedropped-.*/snapshots/dropped-.*-viewtobedropped/.*", keyspace()));
+
+            List<File> collect = FileUtils.listFiles(new File(dataDir), null, true)
+                                          .stream()
+                                          .filter(file -> {
+                                              Path relativize = Paths.get(dataDir).relativize(file.toPath());
+                                              Matcher matcher = compile.matcher(relativize.toString());
+                                              return matcher.matches();
+                                          }).collect(Collectors.toList());
+            assertFalse(collect.isEmpty());
+        }
+        finally
+        {
+            DatabaseDescriptor.setEnableMaterializedViews(enableMaterializedViews);
+        }
+    }
+
     /**
      * Tests that truncating a table stops the ongoing builds of its materialized views,
      * so they don't write into the MV data that has been truncated in the base table.
