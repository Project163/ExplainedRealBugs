diff --git a/CHANGES.txt b/CHANGES.txt
index ecef4fc88a..a9623ab152 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,6 @@
 4.1
+ * Fix leak of non-standard Java types in our Exceptions as clients using JMX are unable to handle them.
+   Remove useless validation that leads to unnecessary additional read of cassandra.yaml on startup (CASSANDRA-17638)
  * Fix repair_request_timeout_in_ms and remove paxos_auto_repair_threshold_mb (CASSANDRA-17557)
  * Incremental repair leaks SomeRepairFailedException after switch away from flatMap (CASSANDRA-17620)
  * StorageService read threshold get methods throw NullPointerException due to not handling null configs (CASSANDRA-17593)
diff --git a/src/java/org/apache/cassandra/config/DataRateSpec.java b/src/java/org/apache/cassandra/config/DataRateSpec.java
index dd45c25d8d..22b138fe03 100644
--- a/src/java/org/apache/cassandra/config/DataRateSpec.java
+++ b/src/java/org/apache/cassandra/config/DataRateSpec.java
@@ -25,8 +25,6 @@ import java.util.stream.Collectors;
 
 import com.google.common.primitives.Ints;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
-
 /**
  * Represents a data rate type used for cassandra configuration. It supports the opportunity for the users to be able to
  * add units to the confiuration parameter value. (CASSANDRA-15234)
@@ -48,7 +46,7 @@ public final class DataRateSpec
         Matcher matcher = BIT_RATE_UNITS_PATTERN.matcher(value);
 
         if (!matcher.find())
-            throw new ConfigurationException("Invalid bit rate: " + value + " Accepted units: MiB/s, KiB/s, B/s where " +
+            throw new IllegalArgumentException("Invalid bit rate: " + value + " Accepted units: MiB/s, KiB/s, B/s where " +
                                              "case matters and " + "only non-negative values are valid");
 
         quantity = Long.parseLong(matcher.group(1));
@@ -58,7 +56,7 @@ public final class DataRateSpec
     DataRateSpec(double quantity, DataRateUnit unit)
     {
         if (quantity < 0)
-            throw new ConfigurationException("Invalid bit rate: value must be non-negative");
+            throw new IllegalArgumentException("Invalid bit rate: value must be non-negative");
 
         if (quantity > Long.MAX_VALUE)
             throw new NumberFormatException("Invalid bit rate: value must be between 0 and Long.MAX_VALUE = 9223372036854775807");
@@ -337,7 +335,7 @@ public final class DataRateSpec
                 if (value.symbol.equalsIgnoreCase(symbol))
                     return value;
             }
-            throw new ConfigurationException(String.format("Unsupported data rate unit: %s. Supported units are: %s",
+            throw new IllegalArgumentException(String.format("Unsupported data rate unit: %s. Supported units are: %s",
                                                              symbol, Arrays.stream(values())
                                                                            .map(u -> u.symbol)
                                                                            .collect(Collectors.joining(", "))));
diff --git a/src/java/org/apache/cassandra/config/DataStorageSpec.java b/src/java/org/apache/cassandra/config/DataStorageSpec.java
index 93224b3245..22e21f23a4 100644
--- a/src/java/org/apache/cassandra/config/DataStorageSpec.java
+++ b/src/java/org/apache/cassandra/config/DataStorageSpec.java
@@ -27,8 +27,6 @@ import com.google.common.collect.ImmutableMap;
 import com.google.common.collect.ImmutableSet;
 import com.google.common.primitives.Ints;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
-
 import static org.apache.cassandra.config.DataStorageSpec.DataStorageUnit.GIBIBYTES;
 import static org.apache.cassandra.config.DataStorageSpec.DataStorageUnit.KIBIBYTES;
 import static org.apache.cassandra.config.DataStorageSpec.DataStorageUnit.MEBIBYTES;
@@ -62,7 +60,7 @@ public class DataStorageSpec
 
         if (!matcher.find())
         {
-            throw new ConfigurationException("Invalid data storage: " + value + " Accepted units: B, KiB, MiB, GiB" +
+            throw new IllegalArgumentException("Invalid data storage: " + value + " Accepted units: B, KiB, MiB, GiB" +
                                              " where case matters and only non-negative values are accepted");
         }
 
@@ -73,7 +71,7 @@ public class DataStorageSpec
     DataStorageSpec(long quantity, DataStorageUnit unit)
     {
         if (quantity < 0)
-            throw new ConfigurationException("Invalid data storage: value must be positive, but was " + quantity);
+            throw new IllegalArgumentException("Invalid data storage: value must be positive, but was " + quantity);
 
         this.quantity = quantity;
         this.unit = unit;
@@ -82,7 +80,7 @@ public class DataStorageSpec
     public DataStorageSpec (String value, DataStorageUnit minUnit)
     {
         if (!MAP_UNITS_PER_MIN_UNIT.containsKey(minUnit))
-            throw new ConfigurationException("Invalid smallest unit set for " + value);
+            throw new IllegalArgumentException("Invalid smallest unit set for " + value);
 
         //parse the string field value
         Matcher matcher = STORAGE_UNITS_PATTERN.matcher(value);
@@ -93,11 +91,11 @@ public class DataStorageSpec
             unit = DataStorageUnit.fromSymbol(matcher.group(2));
 
             if (!MAP_UNITS_PER_MIN_UNIT.get(minUnit).contains(unit))
-                throw new ConfigurationException("Invalid data storage: " + value + " Accepted units:" + MAP_UNITS_PER_MIN_UNIT);
+                throw new IllegalArgumentException("Invalid data storage: " + value + " Accepted units:" + MAP_UNITS_PER_MIN_UNIT);
         }
         else
         {
-            throw new ConfigurationException("Invalid data storage: " + value + " Accepted units:" + MAP_UNITS_PER_MIN_UNIT.get(minUnit) +
+            throw new IllegalArgumentException("Invalid data storage: " + value + " Accepted units:" + MAP_UNITS_PER_MIN_UNIT.get(minUnit) +
                                              " where case matters and only non-negative values are accepted");
         }
     }
@@ -389,7 +387,7 @@ public class DataStorageSpec
                 if (value.symbol.equalsIgnoreCase(symbol))
                     return value;
             }
-            throw new ConfigurationException(String.format("Unsupported data storage unit: %s. Supported units are: %s",
+            throw new IllegalArgumentException(String.format("Unsupported data storage unit: %s. Supported units are: %s",
                                                            symbol, Arrays.stream(values())
                                                                          .map(u -> u.symbol)
                                                                          .collect(Collectors.joining(", "))));
diff --git a/src/java/org/apache/cassandra/config/DatabaseDescriptor.java b/src/java/org/apache/cassandra/config/DatabaseDescriptor.java
index a381b31367..a636850534 100644
--- a/src/java/org/apache/cassandra/config/DatabaseDescriptor.java
+++ b/src/java/org/apache/cassandra/config/DatabaseDescriptor.java
@@ -1379,16 +1379,7 @@ public class DatabaseDescriptor
         if (updateInterval == -1)
             conf.permissions_update_interval = null;
         else
-        {
-            try
-            {
-                conf.permissions_update_interval = SmallestDurationMilliseconds.inMilliseconds(updateInterval);
-            }
-            catch (ConfigurationException e)
-            {
-                throw new IllegalArgumentException("permissions_update_interval should be >= -1");
-            }
-        }
+            conf.permissions_update_interval = SmallestDurationMilliseconds.inMilliseconds(updateInterval);
     }
 
     public static int getPermissionsCacheMaxEntries()
@@ -1443,16 +1434,7 @@ public class DatabaseDescriptor
         if (interval == -1)
             conf.roles_update_interval = null;
         else
-        {
-            try
-            {
-                conf.roles_update_interval = SmallestDurationMilliseconds.inMilliseconds(interval);
-            }
-            catch(ConfigurationException e)
-            {
-                throw new IllegalArgumentException("roles_update_interval should be >= -1");
-            }
-        }
+            conf.roles_update_interval = SmallestDurationMilliseconds.inMilliseconds(interval);
     }
 
     public static int getRolesCacheMaxEntries()
@@ -1487,16 +1469,7 @@ public class DatabaseDescriptor
         if (updateInterval == -1)
             conf.credentials_update_interval = null;
         else
-        {
-            try
-            {
-                conf.credentials_update_interval = SmallestDurationMilliseconds.inMilliseconds(updateInterval);
-            }
-            catch (ConfigurationException e)
-            {
-                throw new IllegalArgumentException("credentials_update_interval should be >= -1.");
-            }
-        }
+            conf.credentials_update_interval = SmallestDurationMilliseconds.inMilliseconds(updateInterval);
     }
 
     public static int getCredentialsCacheMaxEntries()
@@ -2669,14 +2642,7 @@ public class DatabaseDescriptor
         if (maxRequestDataInFlightInBytes == -1)
             maxRequestDataInFlightInBytes = Runtime.getRuntime().maxMemory() / 40;
 
-        try
-        {
-            conf.native_transport_max_request_data_in_flight_per_ip = DataStorageSpec.inBytes(maxRequestDataInFlightInBytes);
-        }
-        catch (ConfigurationException e)
-        {
-            throw new IllegalArgumentException("native_transport_max_request_data_in_flight_per_ip can be only -1 which gets default value or >= 0");
-        }
+        conf.native_transport_max_request_data_in_flight_per_ip = DataStorageSpec.inBytes(maxRequestDataInFlightInBytes);
 
     }
 
@@ -2690,14 +2656,7 @@ public class DatabaseDescriptor
         if (maxRequestDataInFlightInBytes == -1)
             maxRequestDataInFlightInBytes = Runtime.getRuntime().maxMemory() / 10;
 
-        try
-        {
-            conf.native_transport_max_request_data_in_flight = DataStorageSpec.inBytes(maxRequestDataInFlightInBytes);
-        }
-        catch (ConfigurationException e)
-        {
-            throw new IllegalArgumentException("native_transport_max_request_data_in_flight can be only -1 which gets default value or >= 0");
-        }
+        conf.native_transport_max_request_data_in_flight = DataStorageSpec.inBytes(maxRequestDataInFlightInBytes);
     }
 
     public static int getNativeTransportMaxRequestsPerSecond()
@@ -4097,16 +4056,16 @@ public class DatabaseDescriptor
 
     public static int getDefaultKeyspaceRF() { return conf.default_keyspace_rf; }
 
-    public static void setDefaultKeyspaceRF(int value) throws ConfigurationException
+    public static void setDefaultKeyspaceRF(int value) throws IllegalArgumentException
     {
         if (value < 1)
         {
-            throw new ConfigurationException("default_keyspace_rf cannot be less than 1");
+            throw new IllegalArgumentException("default_keyspace_rf cannot be less than 1");
         }
 
         if (value < guardrails.getMinimumReplicationFactorFailThreshold())
         {
-            throw new ConfigurationException(String.format("default_keyspace_rf to be set (%d) cannot be less than minimum_replication_factor_fail_threshold (%d)", value, guardrails.getMinimumReplicationFactorFailThreshold()));
+            throw new IllegalArgumentException(String.format("default_keyspace_rf to be set (%d) cannot be less than minimum_replication_factor_fail_threshold (%d)", value, guardrails.getMinimumReplicationFactorFailThreshold()));
         }
 
         conf.default_keyspace_rf = value;
diff --git a/src/java/org/apache/cassandra/config/DurationSpec.java b/src/java/org/apache/cassandra/config/DurationSpec.java
index 4b407b27a5..f675110721 100644
--- a/src/java/org/apache/cassandra/config/DurationSpec.java
+++ b/src/java/org/apache/cassandra/config/DurationSpec.java
@@ -28,8 +28,6 @@ import com.google.common.collect.ImmutableMap;
 import com.google.common.collect.ImmutableSet;
 import com.google.common.primitives.Ints;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
-
 import static java.util.concurrent.TimeUnit.DAYS;
 import static java.util.concurrent.TimeUnit.HOURS;
 import static java.util.concurrent.TimeUnit.MILLISECONDS;
@@ -73,7 +71,7 @@ public class DurationSpec
         }
         else
         {
-            throw new ConfigurationException("Invalid duration: " + value + " Accepted units: d, h, m, s, ms, us, µs," +
+            throw new IllegalArgumentException("Invalid duration: " + value + " Accepted units: d, h, m, s, ms, us, µs," +
                                              " ns where case matters and " + "only non-negative values");
         }
     }
@@ -81,7 +79,7 @@ public class DurationSpec
     DurationSpec(long quantity, TimeUnit unit)
     {
         if (quantity < 0)
-            throw new ConfigurationException("Invalid duration " + quantity + ": value must be positive");
+            throw new IllegalArgumentException("Invalid duration " + quantity + ": value must be positive");
 
         this.quantity = quantity;
         this.unit = unit;
@@ -95,7 +93,7 @@ public class DurationSpec
     public DurationSpec(String value, TimeUnit minUnit)
     {
         if (!MAP_UNITS_PER_MIN_UNIT.containsKey(minUnit))
-            throw new ConfigurationException("Invalid smallest unit set for " + value);
+            throw new IllegalArgumentException("Invalid smallest unit set for " + value);
 
         Matcher matcher = TIME_UNITS_PATTERN.matcher(value);
 
@@ -105,11 +103,11 @@ public class DurationSpec
             unit = fromSymbol(matcher.group(2));
 
             if (!MAP_UNITS_PER_MIN_UNIT.get(minUnit).contains(unit))
-                throw new ConfigurationException("Invalid duration: " + value + " Accepted units:" + MAP_UNITS_PER_MIN_UNIT.get(minUnit));
+                throw new IllegalArgumentException("Invalid duration: " + value + " Accepted units:" + MAP_UNITS_PER_MIN_UNIT.get(minUnit));
         }
         else
         {
-            throw new ConfigurationException("Invalid duration: " + value + " Accepted units:" + MAP_UNITS_PER_MIN_UNIT.get(minUnit) +
+            throw new IllegalArgumentException("Invalid duration: " + value + " Accepted units:" + MAP_UNITS_PER_MIN_UNIT.get(minUnit) +
                                              " where case matters and only non-negative values.");
         }
     }
@@ -229,7 +227,7 @@ public class DurationSpec
             case "µs": return TimeUnit.MICROSECONDS;
             case "ns": return TimeUnit.NANOSECONDS;
         }
-        throw new ConfigurationException(String.format("Unsupported time unit: %s. Supported units are: %s",
+        throw new IllegalArgumentException(String.format("Unsupported time unit: %s. Supported units are: %s",
                                                        symbol, Arrays.stream(TimeUnit.values())
                                                                      .map(DurationSpec::getSymbol)
                                                                      .collect(Collectors.joining(", "))));
diff --git a/src/java/org/apache/cassandra/config/YamlConfigurationLoader.java b/src/java/org/apache/cassandra/config/YamlConfigurationLoader.java
index b40bb9139e..09f3f1ecfb 100644
--- a/src/java/org/apache/cassandra/config/YamlConfigurationLoader.java
+++ b/src/java/org/apache/cassandra/config/YamlConfigurationLoader.java
@@ -21,8 +21,6 @@ import java.io.ByteArrayInputStream;
 import java.io.IOException;
 import java.io.InputStream;
 import java.net.URL;
-import java.nio.file.Files;
-import java.nio.file.Paths;
 import java.util.ArrayList;
 import java.util.Collections;
 import java.util.HashMap;
@@ -31,8 +29,6 @@ import java.util.List;
 import java.util.Map;
 import java.util.Objects;
 import java.util.Set;
-import java.util.regex.Matcher;
-import java.util.regex.Pattern;
 
 import com.google.common.annotations.VisibleForTesting;
 import com.google.common.collect.Lists;
@@ -116,7 +112,6 @@ public class YamlConfigurationLoader implements ConfigurationLoader
         if (storageConfigURL == null)
             storageConfigURL = getStorageConfigURL();
 
-        validateConfigFile();
         return loadConfig(storageConfigURL);
     }
 
@@ -210,46 +205,6 @@ public class YamlConfigurationLoader implements ConfigurationLoader
 
     }
 
-    private static String readStorageConfig(URL url)
-    {
-        String content;
-
-        try
-        {
-            content = new String (Files.readAllBytes(Paths.get(String.valueOf(url).substring(5))));
-        }
-        catch (IOException e)
-        {
-            throw new ConfigurationException("Invalid yaml: " + url, e);
-        }
-
-        return content;
-    }
-
-    private static void validateConfigFile()
-    {
-        String content = YamlConfigurationLoader.readStorageConfig(storageConfigURL);
-
-        if (isBlank("commitlog_sync_period", content))
-            throw new IllegalArgumentException("You should provide a value for commitlog_sync_period or comment it in " +
-                                               "order to get a default one");
-
-        if (isBlank("commitlog_sync_group_window", content))
-            throw new IllegalArgumentException("You should provide a value for commitlog_sync_group_window or comment it in " +
-                                               "order to get a default one");
-    }
-
-    /**
-     * This method helps to preserve the behavior of parameters which were originally of primitive type and
-     * without default value in Config.java (CASSANDRA-15234)
-     */
-    private static boolean isBlank(String property, String content)
-    {
-        Pattern p = Pattern.compile(String.format("%s%s *: *$", '^', property), Pattern.MULTILINE);
-        Matcher m = p.matcher(content);
-        return m.find();
-    }
-
     @VisibleForTesting
     public static <T> T fromMap(Map<String,Object> map, Class<T> klass)
     {
diff --git a/test/unit/org/apache/cassandra/config/DataRateSpecTest.java b/test/unit/org/apache/cassandra/config/DataRateSpecTest.java
index 73625fb41c..11340b0a88 100644
--- a/test/unit/org/apache/cassandra/config/DataRateSpecTest.java
+++ b/test/unit/org/apache/cassandra/config/DataRateSpecTest.java
@@ -19,7 +19,6 @@ package org.apache.cassandra.config;
 
 import org.junit.Test;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
 import org.quicktheories.core.Gen;
 import org.quicktheories.generators.SourceDSL;
 
@@ -72,18 +71,18 @@ public class DataRateSpecTest
         assertEquals(DataRateSpec.DataRateUnit.fromSymbol("KiB/s"), DataRateSpec.DataRateUnit.KIBIBYTES_PER_SECOND);
         assertEquals(DataRateSpec.DataRateUnit.fromSymbol("MiB/s"), DataRateSpec.DataRateUnit.MEBIBYTES_PER_SECOND);
         assertThatThrownBy(() -> DataRateSpec.DataRateUnit.fromSymbol("n"))
-        .isInstanceOf(ConfigurationException.class)
+        .isInstanceOf(IllegalArgumentException.class)
         .hasMessageContaining("Unsupported data rate unit: n");
     }
 
     @Test
     public void testInvalidInputs()
     {
-        assertThatThrownBy(() -> new DataRateSpec("10")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DataRateSpec("10")).isInstanceOf(IllegalArgumentException.class)
                                                         .hasMessageContaining("Invalid bit rate: 10");
-        assertThatThrownBy(() -> new DataRateSpec("-10b/s")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DataRateSpec("-10b/s")).isInstanceOf(IllegalArgumentException.class)
                                                             .hasMessageContaining("Invalid bit rate: -10b/s");
-        assertThatThrownBy(() -> new DataRateSpec("10xb/s")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DataRateSpec("10xb/s")).isInstanceOf(IllegalArgumentException.class)
                                                             .hasMessageContaining("Invalid bit rate: 10xb/s");
         assertThatThrownBy(() -> new DataRateSpec("9223372036854775809B/s")
                                  .toBytesPerSecond()).isInstanceOf(NumberFormatException.class)
diff --git a/test/unit/org/apache/cassandra/config/DataStorageSpecTest.java b/test/unit/org/apache/cassandra/config/DataStorageSpecTest.java
index 4dad97a0a8..b51ce17762 100644
--- a/test/unit/org/apache/cassandra/config/DataStorageSpecTest.java
+++ b/test/unit/org/apache/cassandra/config/DataStorageSpecTest.java
@@ -21,7 +21,6 @@ import java.util.Locale;
 
 import org.junit.Test;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
 import org.quicktheories.core.Gen;
 import org.quicktheories.generators.SourceDSL;
 
@@ -77,20 +76,20 @@ public class DataStorageSpecTest
         assertEquals(DataStorageSpec.DataStorageUnit.fromSymbol("MiB"), DataStorageSpec.DataStorageUnit.MEBIBYTES);
         assertEquals(DataStorageSpec.DataStorageUnit.fromSymbol("GiB"), DataStorageSpec.DataStorageUnit.GIBIBYTES);
         assertThatThrownBy(() -> DataStorageSpec.DataStorageUnit.fromSymbol("n"))
-        .isInstanceOf(ConfigurationException.class)
+        .isInstanceOf(IllegalArgumentException.class)
         .hasMessageContaining("Unsupported data storage unit: n");
     }
 
     @Test
     public void testInvalidInputs()
     {
-        assertThatThrownBy(() -> new DataStorageSpec("10")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DataStorageSpec("10")).isInstanceOf(IllegalArgumentException.class)
                                                            .hasMessageContaining("Invalid data storage: 10");
-        assertThatThrownBy(() -> new DataStorageSpec("-10bps")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DataStorageSpec("-10bps")).isInstanceOf(IllegalArgumentException.class)
                                                                .hasMessageContaining("Invalid data storage: -10bps");
-        assertThatThrownBy(() -> new DataStorageSpec("-10b")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DataStorageSpec("-10b")).isInstanceOf(IllegalArgumentException.class)
                                                              .hasMessageContaining("Invalid data storage: -10b");
-        assertThatThrownBy(() -> new DataStorageSpec("10HG")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DataStorageSpec("10HG")).isInstanceOf(IllegalArgumentException.class)
                                                              .hasMessageContaining("Invalid data storage: 10HG");
         assertThatThrownBy(() -> new DataStorageSpec("9223372036854775809B")
                                  .toBytes()).isInstanceOf(NumberFormatException.class)
diff --git a/test/unit/org/apache/cassandra/config/DatabaseDescriptorTest.java b/test/unit/org/apache/cassandra/config/DatabaseDescriptorTest.java
index 32f80579e3..d18799d4a8 100644
--- a/test/unit/org/apache/cassandra/config/DatabaseDescriptorTest.java
+++ b/test/unit/org/apache/cassandra/config/DatabaseDescriptorTest.java
@@ -282,9 +282,9 @@ public class DatabaseDescriptorTest
         try
         {
             DatabaseDescriptor.setColumnIndexCacheSize(-1);
-            fail("Should have received a ConfigurationException column_index_cache_size = -1");
+            fail("Should have received a IllegalArgumentException column_index_cache_size = -1");
         }
-        catch (ConfigurationException ignored) { }
+        catch (IllegalArgumentException ignored) { }
         Assert.assertEquals(2048, DatabaseDescriptor.getColumnIndexCacheSize());
 
         try
@@ -298,9 +298,9 @@ public class DatabaseDescriptorTest
         try
         {
             DatabaseDescriptor.setColumnIndexSize(-1);
-            fail("Should have received a ConfigurationException column_index_size = -1");
+            fail("Should have received a IllegalArgumentException column_index_size = -1");
         }
-        catch (ConfigurationException ignored) { }
+        catch (IllegalArgumentException ignored) { }
         Assert.assertEquals(4096, DatabaseDescriptor.getColumnIndexSize());
 
         try
@@ -314,9 +314,9 @@ public class DatabaseDescriptorTest
         try
         {
             DatabaseDescriptor.setBatchSizeWarnThresholdInKiB(-1);
-            fail("Should have received a ConfigurationException batch_size_warn_threshold = -1");
+            fail("Should have received a IllegalArgumentException batch_size_warn_threshold = -1");
         }
-        catch (ConfigurationException ignored) { }
+        catch (IllegalArgumentException ignored) { }
         Assert.assertEquals(5120, DatabaseDescriptor.getBatchSizeWarnThreshold());
 
         try
@@ -751,8 +751,8 @@ public class DatabaseDescriptorTest
         Assert.assertTrue(config.server_encryption_options.ssl_context_factory.parameters.isEmpty());
     }
 
-    @Test (expected = ConfigurationException.class)
-    public void testInvalidSub1DefaultRFs() throws ConfigurationException
+    @Test (expected = IllegalArgumentException.class)
+    public void testInvalidSub1DefaultRFs() throws IllegalArgumentException
     {
         DatabaseDescriptor.setDefaultKeyspaceRF(0);
     }
diff --git a/test/unit/org/apache/cassandra/config/DurationSpecTest.java b/test/unit/org/apache/cassandra/config/DurationSpecTest.java
index 84733d8789..004ab421e8 100644
--- a/test/unit/org/apache/cassandra/config/DurationSpecTest.java
+++ b/test/unit/org/apache/cassandra/config/DurationSpecTest.java
@@ -21,7 +21,6 @@ import java.util.concurrent.TimeUnit;
 
 import org.junit.Test;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
 import org.quicktheories.core.Gen;
 import org.quicktheories.generators.SourceDSL;
 
@@ -60,7 +59,7 @@ public class DurationSpecTest
         assertEquals(DurationSpec.fromSymbol("us"), TimeUnit.MICROSECONDS);
         assertEquals(DurationSpec.fromSymbol("µs"), TimeUnit.MICROSECONDS);
         assertEquals(DurationSpec.fromSymbol("ns"), TimeUnit.NANOSECONDS);
-        assertThatThrownBy(() -> DurationSpec.fromSymbol("n")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> DurationSpec.fromSymbol("n")).isInstanceOf(IllegalArgumentException.class)
                                                               .hasMessageContaining("Unsupported time unit: n");
     }
 
@@ -79,13 +78,13 @@ public class DurationSpecTest
     @Test
     public void testInvalidInputs()
     {
-        assertThatThrownBy(() -> new DurationSpec("10")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DurationSpec("10")).isInstanceOf(IllegalArgumentException.class)
                                                         .hasMessageContaining("Invalid duration: 10");
-        assertThatThrownBy(() -> new DurationSpec("-10s")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DurationSpec("-10s")).isInstanceOf(IllegalArgumentException.class)
                                                           .hasMessageContaining("Invalid duration: -10s");
-        assertThatThrownBy(() -> new DurationSpec("10xd")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DurationSpec("10xd")).isInstanceOf(IllegalArgumentException.class)
                                                           .hasMessageContaining("Invalid duration: 10xd");
-        assertThatThrownBy(() -> new DurationSpec("0.333555555ms")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new DurationSpec("0.333555555ms")).isInstanceOf(IllegalArgumentException.class)
                                                                    .hasMessageContaining("Invalid duration: 0.333555555ms");
     }
 
diff --git a/test/unit/org/apache/cassandra/config/SmallestDataStorageKibibytesTest.java b/test/unit/org/apache/cassandra/config/SmallestDataStorageKibibytesTest.java
index c161d12d50..d60eb758e8 100644
--- a/test/unit/org/apache/cassandra/config/SmallestDataStorageKibibytesTest.java
+++ b/test/unit/org/apache/cassandra/config/SmallestDataStorageKibibytesTest.java
@@ -20,8 +20,6 @@ package org.apache.cassandra.config;
 
 import org.junit.Test;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
-
 import static org.assertj.core.api.Assertions.assertThatThrownBy;
 import static org.junit.Assert.assertEquals;
 
@@ -30,7 +28,7 @@ public class SmallestDataStorageKibibytesTest
     @Test
     public void testInvalidUnits()
     {
-        assertThatThrownBy(() -> new SmallestDataStorageKibibytes("10B")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDataStorageKibibytes("10B")).isInstanceOf(IllegalArgumentException.class)
                                                                           .hasMessageContaining("Invalid data storage: 10B");
     }
 
diff --git a/test/unit/org/apache/cassandra/config/SmallestDataStorageMebibytesTest.java b/test/unit/org/apache/cassandra/config/SmallestDataStorageMebibytesTest.java
index a3136818fc..996ce45fd9 100644
--- a/test/unit/org/apache/cassandra/config/SmallestDataStorageMebibytesTest.java
+++ b/test/unit/org/apache/cassandra/config/SmallestDataStorageMebibytesTest.java
@@ -20,8 +20,6 @@ package org.apache.cassandra.config;
 
 import org.junit.Test;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
-
 import static org.assertj.core.api.Assertions.assertThatThrownBy;
 import static org.junit.Assert.assertEquals;
 
@@ -30,7 +28,7 @@ public class SmallestDataStorageMebibytesTest
     @Test
     public void testInvalidUnits()
     {
-        assertThatThrownBy(() -> new SmallestDataStorageMebibytes("10B")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDataStorageMebibytes("10B")).isInstanceOf(IllegalArgumentException.class)
                                                                          .hasMessageContaining("Invalid data storage: 10B");
     }
 
diff --git a/test/unit/org/apache/cassandra/config/SmallestDurationMillisecondsTest.java b/test/unit/org/apache/cassandra/config/SmallestDurationMillisecondsTest.java
index 6e7597d867..890d69adef 100644
--- a/test/unit/org/apache/cassandra/config/SmallestDurationMillisecondsTest.java
+++ b/test/unit/org/apache/cassandra/config/SmallestDurationMillisecondsTest.java
@@ -20,8 +20,6 @@ package org.apache.cassandra.config;
 
 import org.junit.Test;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
-
 import static org.assertj.core.api.Assertions.assertThatThrownBy;
 import static org.junit.Assert.assertEquals;
 
@@ -30,13 +28,13 @@ public class SmallestDurationMillisecondsTest
     @Test
     public void testInvalidUnits()
     {
-        assertThatThrownBy(() -> new SmallestDurationMilliseconds("10ns")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationMilliseconds("10ns")).isInstanceOf(IllegalArgumentException.class)
                                                                           .hasMessageContaining("Invalid duration: 10ns");
-        assertThatThrownBy(() -> new SmallestDurationMilliseconds("10us")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationMilliseconds("10us")).isInstanceOf(IllegalArgumentException.class)
                                                                           .hasMessageContaining("Invalid duration: 10us");
-        assertThatThrownBy(() -> new SmallestDurationMilliseconds("10µs")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationMilliseconds("10µs")).isInstanceOf(IllegalArgumentException.class)
                                                                           .hasMessageContaining("Invalid duration: 10µs");
-        assertThatThrownBy(() -> new SmallestDurationMilliseconds("-10s")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationMilliseconds("-10s")).isInstanceOf(IllegalArgumentException.class)
                                                                           .hasMessageContaining("Invalid duration: -10s");
     }
 
diff --git a/test/unit/org/apache/cassandra/config/SmallestDurationMinutesTest.java b/test/unit/org/apache/cassandra/config/SmallestDurationMinutesTest.java
index 68b44dbc5e..a850d15769 100644
--- a/test/unit/org/apache/cassandra/config/SmallestDurationMinutesTest.java
+++ b/test/unit/org/apache/cassandra/config/SmallestDurationMinutesTest.java
@@ -20,8 +20,6 @@ package org.apache.cassandra.config;
 
 import org.junit.Test;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
-
 import static org.assertj.core.api.Assertions.assertThatThrownBy;
 import static org.junit.Assert.assertEquals;
 
@@ -30,17 +28,17 @@ public class SmallestDurationMinutesTest
     @Test
     public void testInvalidUnits()
     {
-        assertThatThrownBy(() -> new SmallestDurationMinutes("10s")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationMinutes("10s")).isInstanceOf(IllegalArgumentException.class)
                                                                     .hasMessageContaining("Invalid duration: 10s");
-        assertThatThrownBy(() -> new SmallestDurationMinutes("10ms")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationMinutes("10ms")).isInstanceOf(IllegalArgumentException.class)
                                                                      .hasMessageContaining("Invalid duration: 10ms");
-        assertThatThrownBy(() -> new SmallestDurationMinutes("10ns")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationMinutes("10ns")).isInstanceOf(IllegalArgumentException.class)
                                                                      .hasMessageContaining("Invalid duration: 10ns");
-        assertThatThrownBy(() -> new SmallestDurationMinutes("10us")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationMinutes("10us")).isInstanceOf(IllegalArgumentException.class)
                                                                      .hasMessageContaining("Invalid duration: 10us");
-        assertThatThrownBy(() -> new SmallestDurationMinutes("10µs")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationMinutes("10µs")).isInstanceOf(IllegalArgumentException.class)
                                                                      .hasMessageContaining("Invalid duration: 10µs");
-        assertThatThrownBy(() -> new SmallestDurationMinutes("-10s")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationMinutes("-10s")).isInstanceOf(IllegalArgumentException.class)
                                                                      .hasMessageContaining("Invalid duration: -10s");
     }
 
diff --git a/test/unit/org/apache/cassandra/config/SmallestDurationSecondsTest.java b/test/unit/org/apache/cassandra/config/SmallestDurationSecondsTest.java
index c5636391fe..8380a852f8 100644
--- a/test/unit/org/apache/cassandra/config/SmallestDurationSecondsTest.java
+++ b/test/unit/org/apache/cassandra/config/SmallestDurationSecondsTest.java
@@ -20,8 +20,6 @@ package org.apache.cassandra.config;
 
 import org.junit.Test;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
-
 import static org.assertj.core.api.Assertions.assertThatThrownBy;
 import static org.junit.Assert.assertEquals;
 
@@ -30,15 +28,15 @@ public class SmallestDurationSecondsTest
     @Test
     public void testInvalidUnits()
     {
-        assertThatThrownBy(() -> new SmallestDurationSeconds("10ms")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationSeconds("10ms")).isInstanceOf(IllegalArgumentException.class)
                                                                      .hasMessageContaining("Invalid duration: 10ms");
-        assertThatThrownBy(() -> new SmallestDurationSeconds("10ns")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationSeconds("10ns")).isInstanceOf(IllegalArgumentException.class)
                                                                      .hasMessageContaining("Invalid duration: 10ns");
-        assertThatThrownBy(() -> new SmallestDurationSeconds("10us")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationSeconds("10us")).isInstanceOf(IllegalArgumentException.class)
                                                                      .hasMessageContaining("Invalid duration: 10us");
-        assertThatThrownBy(() -> new SmallestDurationSeconds("10µs")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationSeconds("10µs")).isInstanceOf(IllegalArgumentException.class)
                                                                      .hasMessageContaining("Invalid duration: 10µs");
-        assertThatThrownBy(() -> new SmallestDurationSeconds("-10s")).isInstanceOf(ConfigurationException.class)
+        assertThatThrownBy(() -> new SmallestDurationSeconds("-10s")).isInstanceOf(IllegalArgumentException.class)
                                                                      .hasMessageContaining("Invalid duration: -10s");
     }
 
diff --git a/test/unit/org/apache/cassandra/config/YamlConfigurationLoaderTest.java b/test/unit/org/apache/cassandra/config/YamlConfigurationLoaderTest.java
index aaf60e1ca7..fd7bc4050f 100644
--- a/test/unit/org/apache/cassandra/config/YamlConfigurationLoaderTest.java
+++ b/test/unit/org/apache/cassandra/config/YamlConfigurationLoaderTest.java
@@ -27,15 +27,16 @@ import java.util.Map;
 import com.google.common.collect.ImmutableMap;
 import org.junit.Test;
 
-import org.apache.cassandra.exceptions.ConfigurationException;
 import org.apache.cassandra.distributed.shared.WithProperties;
 import org.apache.cassandra.io.util.File;
+import org.yaml.snakeyaml.error.YAMLException;
 
 import static org.apache.cassandra.config.CassandraRelevantProperties.CONFIG_ALLOW_SYSTEM_PROPERTIES;
 import static org.apache.cassandra.config.YamlConfigurationLoader.SYSTEM_PROPERTY_PREFIX;
 import static org.assertj.core.api.Assertions.assertThat;
 import static org.assertj.core.api.Assertions.assertThatThrownBy;
 import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertTrue;
 
 
 public class YamlConfigurationLoaderTest
@@ -133,6 +134,28 @@ public class YamlConfigurationLoaderTest
         assertThat(c.row_index_read_size_fail_threshold).isEqualTo(DataStorageSpec.inKibibytes(1024));
     }
 
+    @Test
+    public void notNullableLegacyProperties()
+    {
+        // In  the past commitlog_sync_period and commitlog_sync_group_window were int in Config. So that meant they can't
+        // be assigned null value from the yaml file. To ensure this behavior was not changed when we moved to DurationSpec
+        // in CASSANDRA-15234, we assigned those 0 value.
+
+        Map<String, Object> map = ImmutableMap.of(
+        "commitlog_sync_period", ""
+        );
+        try
+        {
+            Config config = YamlConfigurationLoader.fromMap(map, Config.class);
+        }
+        catch (YAMLException e)
+        {
+            assertTrue(e.getMessage().contains("Cannot create property=commitlog_sync_period for JavaBean=org.apache.cassandra.config.Config"));
+        }
+
+        // loadConfig will catch this exception on startup and throw a ConfigurationException
+    }
+
     @Test
     public void fromMapTest()
     {
@@ -191,7 +214,7 @@ public class YamlConfigurationLoaderTest
         // MILLIS_DURATION
         assertThat(from("permissions_validity_in_ms", "42").permissions_validity.toMilliseconds()).isEqualTo(42);
         assertThatThrownBy(() -> from("permissions_validity", -2).permissions_validity.toMilliseconds())
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid duration: -2 Accepted units:[MILLISECONDS, SECONDS, MINUTES, HOURS, DAYS] where case matters and only non-negative values.");
 
         // MILLIS_DOUBLE_DURATION
@@ -200,20 +223,20 @@ public class YamlConfigurationLoaderTest
         assertThat(from("commitlog_sync_group_window_in_ms", "42.5").commitlog_sync_group_window.toMilliseconds()).isEqualTo(43);
         assertThat(from("commitlog_sync_group_window_in_ms", "NaN").commitlog_sync_group_window.toMilliseconds()).isEqualTo(0);
         assertThatThrownBy(() -> from("commitlog_sync_group_window_in_ms", -2).commitlog_sync_group_window.toMilliseconds())
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid duration -2: value must be positive");
 
         // MILLIS_CUSTOM_DURATION
         assertThat(from("permissions_update_interval_in_ms", 42).permissions_update_interval).isEqualTo(SmallestDurationMilliseconds.inMilliseconds(42));
         assertThat(from("permissions_update_interval_in_ms", -1).permissions_update_interval).isNull();
         assertThatThrownBy(() -> from("permissions_update_interval_in_ms", -2))
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid duration -2: value must be positive");
 
         // SECONDS_DURATION
         assertThat(from("streaming_keep_alive_period_in_secs", "42").streaming_keep_alive_period.toSeconds()).isEqualTo(42);
         assertThatThrownBy(() -> from("streaming_keep_alive_period_in_secs", -2).streaming_keep_alive_period.toSeconds())
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid duration -2: value must be positive");
 
         // NEGATIVE_SECONDS_DURATION
@@ -226,7 +249,7 @@ public class YamlConfigurationLoaderTest
         // MINUTES_DURATION
         assertThat(from("index_summary_resize_interval_in_minutes", "42").index_summary_resize_interval.toMinutes()).isEqualTo(42);
         assertThatThrownBy(() -> from("index_summary_resize_interval_in_minutes", -2).index_summary_resize_interval.toMinutes())
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid duration -2: value must be positive");
 
         // BYTES_CUSTOM_DATASTORAGE
@@ -237,37 +260,37 @@ public class YamlConfigurationLoaderTest
         // MEBIBYTES_DATA_STORAGE
         assertThat(from("memtable_heap_space_in_mb", "42").memtable_heap_space.toMebibytes()).isEqualTo(42);
         assertThatThrownBy(() -> from("memtable_heap_space_in_mb", -2).memtable_heap_space.toMebibytes())
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid data storage: value must be positive, but was -2");
 
         // KIBIBYTES_DATASTORAGE
         assertThat(from("column_index_size_in_kb", "42").column_index_size.toKibibytes()).isEqualTo(42);
         assertThatThrownBy(() -> from("column_index_size_in_kb", -2).column_index_size.toMebibytes())
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid data storage: value must be positive, but was -2");
 
         // BYTES_DATASTORAGE
         assertThat(from("internode_max_message_size_in_bytes", "42").internode_max_message_size.toBytes()).isEqualTo(42);
         assertThatThrownBy(() -> from("internode_max_message_size_in_bytes", -2).internode_max_message_size.toBytes())
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid data storage: value must be positive, but was -2");
 
         // BYTES_DATASTORAGE
         assertThat(from("internode_max_message_size_in_bytes", "42").internode_max_message_size.toBytes()).isEqualTo(42);
         assertThatThrownBy(() -> from("internode_max_message_size_in_bytes", -2).internode_max_message_size.toBytes())
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid data storage: value must be positive, but was -2");
 
         // MEBIBYTES_PER_SECOND_DATA_RATE
         assertThat(from("compaction_throughput_mb_per_sec", "42").compaction_throughput.toMebibytesPerSecondAsInt()).isEqualTo(42);
         assertThatThrownBy(() -> from("compaction_throughput_mb_per_sec", -2).compaction_throughput.toMebibytesPerSecondAsInt())
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid bit rate: value must be non-negative");
 
         // MEGABITS_TO_MEBIBYTES_PER_SECOND_DATA_RATE
         assertThat(from("stream_throughput_outbound_megabits_per_sec", "42").stream_throughput_outbound.toMegabitsPerSecondAsInt()).isEqualTo(42);
         assertThatThrownBy(() -> from("stream_throughput_outbound_megabits_per_sec", -2).stream_throughput_outbound.toMegabitsPerSecondAsInt())
-        .hasRootCauseInstanceOf(ConfigurationException.class)
+        .hasRootCauseInstanceOf(IllegalArgumentException.class)
         .hasRootCauseMessage("Invalid bit rate: value must be non-negative");
     }
 
diff --git a/test/unit/org/apache/cassandra/db/guardrails/GuardrailMinimumReplicationFactorTest.java b/test/unit/org/apache/cassandra/db/guardrails/GuardrailMinimumReplicationFactorTest.java
index 16d201e1df..9c984e99f5 100644
--- a/test/unit/org/apache/cassandra/db/guardrails/GuardrailMinimumReplicationFactorTest.java
+++ b/test/unit/org/apache/cassandra/db/guardrails/GuardrailMinimumReplicationFactorTest.java
@@ -264,7 +264,7 @@ public class GuardrailMinimumReplicationFactorTest extends ThresholdTester
             DatabaseDescriptor.setDefaultKeyspaceRF(1);
             guardrails().setMinimumReplicationFactorThreshold(MINIMUM_REPLICATION_FACTOR_WARN_THRESHOLD, MINIMUM_REPLICATION_FACTOR_FAIL_THRESHOLD);
         }
-        catch (ConfigurationException e)
+        catch (IllegalArgumentException e)
         {
             String expectedMessage = "";
 
diff --git a/test/unit/org/apache/cassandra/db/guardrails/ThresholdTester.java b/test/unit/org/apache/cassandra/db/guardrails/ThresholdTester.java
index 13ce67d142..ebd3c0304c 100644
--- a/test/unit/org/apache/cassandra/db/guardrails/ThresholdTester.java
+++ b/test/unit/org/apache/cassandra/db/guardrails/ThresholdTester.java
@@ -29,7 +29,6 @@ import org.junit.Before;
 import org.junit.Test;
 
 import org.apache.cassandra.config.DataStorageSpec;
-import org.apache.cassandra.exceptions.ConfigurationException;
 import org.assertj.core.api.Assertions;
 
 import static java.lang.String.format;
@@ -229,15 +228,6 @@ public abstract class ThresholdTester extends GuardrailTester
             assertValidProperty(setter, value);
             fail(format("Expected exception for guardrails.%s value: %d", name, value));
         }
-        catch (ConfigurationException e)
-        {
-            String expectedMessage = null;
-
-            if (value < 0)
-                expectedMessage = "Invalid data storage: value must be positive";
-
-            Assertions.assertThat(e.getMessage()).contains(expectedMessage);
-        }
         catch (IllegalArgumentException e)
         {
             String expectedMessage = null;
@@ -245,15 +235,19 @@ public abstract class ThresholdTester extends GuardrailTester
             if (value > maxValue)
                 expectedMessage = format("Invalid value %d for %s: maximum allowed value is %d",
                                          value, name, maxValue);
+
             if (value == 0 && value != disabledValue)
                 expectedMessage = format("Invalid value for %s: 0 is not allowed; if attempting to disable use %s",
                                          name, disabledValue);
 
-            if (value < 0 && value != disabledValue)
+            if (value < 0 && disabledValue != null && value != disabledValue)
                 expectedMessage = format("Invalid value %d for %s: negative values are not "
                                          + "allowed, outside of %s which disables the guardrail",
                                          value, name, disabledValue);
 
+            if (expectedMessage == null && value < 0)
+                expectedMessage = format("Invalid data storage: value must be positive, but was %d", value);
+
             assertEquals(format("Exception message '%s' does not contain '%s'", e.getMessage(), expectedMessage),
                          expectedMessage, e.getMessage());
         }
diff --git a/test/unit/org/apache/cassandra/tools/nodetool/SetGetColumnIndexSizeTest.java b/test/unit/org/apache/cassandra/tools/nodetool/SetGetColumnIndexSizeTest.java
index 2d78eb5a36..b5ecc2029c 100644
--- a/test/unit/org/apache/cassandra/tools/nodetool/SetGetColumnIndexSizeTest.java
+++ b/test/unit/org/apache/cassandra/tools/nodetool/SetGetColumnIndexSizeTest.java
@@ -66,7 +66,7 @@ public class SetGetColumnIndexSizeTest extends CQLTester
     @Test
     public void testNegative()
     {
-        assertSetInvalidColumnIndexSize("-7", "Invalid data storage: value must be positive, but was -7", 2);
+        assertSetInvalidColumnIndexSize("-7", "Invalid data storage: value must be positive, but was -7", 1);
     }
 
     @Test
diff --git a/test/unit/org/apache/cassandra/tools/nodetool/SnapshotTest.java b/test/unit/org/apache/cassandra/tools/nodetool/SnapshotTest.java
index 56d8422c8b..2fbaf954c9 100644
--- a/test/unit/org/apache/cassandra/tools/nodetool/SnapshotTest.java
+++ b/test/unit/org/apache/cassandra/tools/nodetool/SnapshotTest.java
@@ -111,8 +111,8 @@ public class SnapshotTest extends CQLTester
     public void testInvalidTTLOption()
     {
         ToolRunner.ToolResult tool = invokeNodetool("snapshot", "-t", "ttl", "--ttl", "infinity");
-        assertThat(tool.getExitCode()).isEqualTo(2);
-        assertThat(tool.getStderr()).contains("Invalid duration: infinity");
+        assertThat(tool.getExitCode()).isEqualTo(1);
+        assertThat(tool.getStdout()).contains("Invalid duration: infinity");
     }
 
     @Test
