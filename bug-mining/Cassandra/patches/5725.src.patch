diff --git a/pylib/cassandra-cqlsh-tests.sh b/pylib/cassandra-cqlsh-tests.sh
index 2458a3df80..7904166611 100755
--- a/pylib/cassandra-cqlsh-tests.sh
+++ b/pylib/cassandra-cqlsh-tests.sh
@@ -61,9 +61,10 @@ else
     TESTSUITE_NAME="${TESTSUITE_NAME}.jdk8"
 fi
 
+ant -buildfile ${CASSANDRA_DIR}/build.xml realclean
 # Loop to prevent failure due to maven-ant-tasks not downloading a jar..
 for x in $(seq 1 3); do
-    ant -buildfile ${CASSANDRA_DIR}/build.xml realclean jar
+    ant -buildfile ${CASSANDRA_DIR}/build.xml jar
     RETURN="$?"
     if [ "${RETURN}" -eq "0" ]; then
         break
@@ -143,4 +144,10 @@ mv nosetests.xml ${WORKSPACE}/cqlshlib.xml
 # /virtualenv
 deactivate
 
-exit ${RETURN}
+# circleci needs non-zero exit on failures, jenkins need zero exit to process the test failures
+if ! command -v circleci >/dev/null 2>&1
+then
+    exit 0
+else
+    exit ${RETURN}
+fi
