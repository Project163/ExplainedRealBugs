diff --git a/CHANGES.txt b/CHANGES.txt
index 5c91da12ba..6d63392d79 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 3.11.16
+ * Remove unrepaired SSTables from garbage collection when only_purge_repaired_tombstones is true (CASSANDRA-14204)
  * Wait for live endpoints in gossip waiting to settle (CASSANDRA-18543)
  * Fix error message handling when trying to use CLUSTERING ORDER with non-clustering column (CASSANDRA-17818
  * Add keyspace and table name to exception message during ColumnSubselection deserialization (CASSANDRA-18346)
diff --git a/src/java/org/apache/cassandra/db/compaction/CompactionManager.java b/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
index 82e0bf2f5e..f809d69405 100644
--- a/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
+++ b/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
@@ -512,12 +512,35 @@ public class CompactionManager implements CompactionManagerMBean
             @Override
             public Iterable<SSTableReader> filterSSTables(LifecycleTransaction transaction)
             {
-                Iterable<SSTableReader> originals = transaction.originals();
+                List<SSTableReader> filteredSSTables = new ArrayList<>();
                 if (cfStore.getCompactionStrategyManager().onlyPurgeRepairedTombstones())
-                    originals = Iterables.filter(originals, SSTableReader::isRepaired);
-                List<SSTableReader> sortedSSTables = Lists.newArrayList(originals);
-                Collections.sort(sortedSSTables, SSTableReader.maxTimestampAscending);
-                return sortedSSTables;
+                {
+                    for (SSTableReader sstable : transaction.originals())
+                    {
+                        if (!sstable.isRepaired())
+                        {
+                            try
+                            {
+                                transaction.cancel(sstable);
+                            }
+                            catch (Throwable t)
+                            {
+                                logger.warn(String.format("Unable to cancel %s from transaction %s", sstable, transaction.opId()), t);
+                            }
+                        }
+                        else
+                        {
+                            filteredSSTables.add(sstable);
+                        }
+                    }
+                }
+                else
+                {
+                    filteredSSTables.addAll(transaction.originals());
+                }
+
+                filteredSSTables.sort(SSTableReader.maxTimestampAscending);
+                return filteredSSTables;
             }
 
             @Override
diff --git a/test/unit/org/apache/cassandra/cql3/GcCompactionTest.java b/test/unit/org/apache/cassandra/cql3/GcCompactionTest.java
index ee16a4d635..79bae2126d 100644
--- a/test/unit/org/apache/cassandra/cql3/GcCompactionTest.java
+++ b/test/unit/org/apache/cassandra/cql3/GcCompactionTest.java
@@ -71,6 +71,17 @@ public class GcCompactionTest extends CQLTester
 
     @Test
     public void testGcCompactionPartitions() throws Throwable
+    {
+        testGcCompactionPartitions(false);
+    }
+
+    @Test
+    public void testGcCompactionPartitionsUnrepaired() throws Throwable
+    {
+        testGcCompactionPartitions(true);
+    }
+
+    public void testGcCompactionPartitions(boolean onlyPurgeRepairedTombstones) throws Throwable
     {
         runCompactionTest("CREATE TABLE %s(" +
                           "  key int," +
@@ -78,13 +89,25 @@ public class GcCompactionTest extends CQLTester
                           "  data int," +
                           "  extra text," +
                           "  PRIMARY KEY((key, column), data)" +
-                          ") WITH compaction = { 'class' :  'SizeTieredCompactionStrategy', 'provide_overlapping_tombstones' : 'row'  };"
-                          );
-
+                          ") WITH compaction = { 'class' :  'SizeTieredCompactionStrategy', " +
+                          "'provide_overlapping_tombstones' : 'row', " +
+                          "'only_purge_repaired_tombstones': " + onlyPurgeRepairedTombstones + " };",
+                          onlyPurgeRepairedTombstones);
     }
 
     @Test
     public void testGcCompactionRows() throws Throwable
+    {
+        testGcCompactionRows(false);
+    }
+
+    @Test
+    public void testGcCompactionRowsUnrepaired() throws Throwable
+    {
+        testGcCompactionRows(true);
+    }
+
+    public void testGcCompactionRows(boolean onlyPurgeRepairedTombstones) throws Throwable
     {
         runCompactionTest("CREATE TABLE %s(" +
                           "  key int," +
@@ -92,13 +115,27 @@ public class GcCompactionTest extends CQLTester
                           "  data int," +
                           "  extra text," +
                           "  PRIMARY KEY(key, column)" +
-                          ") WITH compaction = { 'class' :  'SizeTieredCompactionStrategy', 'provide_overlapping_tombstones' : 'row'  };"
-                          );
+                          ") WITH compaction = { 'class' :  'SizeTieredCompactionStrategy', " +
+                          "'provide_overlapping_tombstones' : 'row', " +
+                          "'only_purge_repaired_tombstones': " + onlyPurgeRepairedTombstones + " };",
+                          onlyPurgeRepairedTombstones
+        );
 
     }
 
     @Test
     public void testGcCompactionRanges() throws Throwable
+    {
+        testGcCompactionRanges(false);
+    }
+
+    @Test
+    public void testGcCompactionRangesUnrepaired() throws Throwable
+    {
+        testGcCompactionRanges(true);
+    }
+
+    public void testGcCompactionRanges(boolean onlyPurgeRepairedTombstones) throws Throwable
     {
 
         runCompactionTest("CREATE TABLE %s(" +
@@ -108,11 +145,14 @@ public class GcCompactionTest extends CQLTester
                           "  data int," +
                           "  extra text," +
                           "  PRIMARY KEY(key, column, data)" +
-                          ") WITH compaction = { 'class' :  'SizeTieredCompactionStrategy', 'provide_overlapping_tombstones' : 'row'  };"
-                          );
+                          ") WITH compaction = { 'class' :  'SizeTieredCompactionStrategy', " +
+                          "'provide_overlapping_tombstones' : 'row', " +
+                          "'only_purge_repaired_tombstones': " + onlyPurgeRepairedTombstones + " };",
+                          onlyPurgeRepairedTombstones
+        );
     }
 
-    private void runCompactionTest(String tableDef) throws Throwable
+    private void runCompactionTest(String tableDef, boolean onlyPurgeRepairedTombstones) throws Throwable
     {
         createTable(tableDef);
 
@@ -148,7 +188,7 @@ public class GcCompactionTest extends CQLTester
         assertEquals(3, cfs.getLiveSSTables().size());
         SSTableReader table3 = getNewTable(readers);
         assertEquals(0, countTombstoneMarkers(table3));
-        assertTrue(rowCount > countRows(table3));
+        assertTrue(onlyPurgeRepairedTombstones ? rowCount == countRows(table3) : rowCount > countRows(table3));
     }
 
     @Test
