diff --git a/CHANGES.txt b/CHANGES.txt
index ace4a9ec40..bc10ae2053 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -7,6 +7,7 @@
  * add CompositeType ref to the CLI doc for create/update column family (CASSANDRA-3980)
  * Pig: support Counter ColumnFamilies (CASSANDRA-3973)
  * Pig: Composite column support (CASSANDRA-384)
+ * Avoid NPE during repair when a keyspace has no CFs (CASSANDRA-3988)
 
 
 1.0.8
diff --git a/src/java/org/apache/cassandra/service/StorageService.java b/src/java/org/apache/cassandra/service/StorageService.java
index f82fe3214e..7f2f9886b6 100644
--- a/src/java/org/apache/cassandra/service/StorageService.java
+++ b/src/java/org/apache/cassandra/service/StorageService.java
@@ -1808,6 +1808,8 @@ public class StorageService implements IEndpointStateChangeSubscriber, StorageSe
         for (Range range : ranges)
         {
             AntiEntropyService.RepairFuture future = forceTableRepair(range, tableName, columnFamilies);
+            if (future == null)
+                continue;
             futures.add(future);
             // wait for a session to be done with its differencing before starting the next one
             try
@@ -1848,6 +1850,8 @@ public class StorageService implements IEndpointStateChangeSubscriber, StorageSe
             return;
 
         AntiEntropyService.RepairFuture future = forceTableRepair(getLocalPrimaryRange(), tableName, columnFamilies);
+        if (future == null)
+            return;
         try
         {
             future.get();
@@ -1867,6 +1871,12 @@ public class StorageService implements IEndpointStateChangeSubscriber, StorageSe
             names.add(cfStore.getColumnFamilyName());
         }
 
+        if (names.isEmpty())
+        {
+            logger_.info("No column family to repair for keyspace " + tableName);
+            return null;
+        }
+
         return AntiEntropyService.instance.submitRepairSession(range, tableName, names.toArray(new String[names.size()]));
     }
 
