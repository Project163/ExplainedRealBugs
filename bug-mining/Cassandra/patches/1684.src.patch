diff --git a/src/java/org/apache/cassandra/db/compaction/CompactionController.java b/src/java/org/apache/cassandra/db/compaction/CompactionController.java
index 4b42ed4fa4..90fe68d9cd 100644
--- a/src/java/org/apache/cassandra/db/compaction/CompactionController.java
+++ b/src/java/org/apache/cassandra/db/compaction/CompactionController.java
@@ -20,17 +20,18 @@ package org.apache.cassandra.db.compaction;
 import java.util.Collection;
 import java.util.Collections;
 import java.util.List;
-import java.util.Set;
 
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
 import org.apache.cassandra.config.DatabaseDescriptor;
+import org.apache.cassandra.db.ColumnFamily;
 import org.apache.cassandra.db.ColumnFamilyStore;
 import org.apache.cassandra.db.DataTracker;
 import org.apache.cassandra.db.DecoratedKey;
 import org.apache.cassandra.io.sstable.SSTableIdentityIterator;
 import org.apache.cassandra.io.sstable.SSTableReader;
+import org.apache.cassandra.service.CacheService;
 import org.apache.cassandra.service.StorageService;
 import org.apache.cassandra.utils.Throttle;
 
@@ -113,6 +114,20 @@ public class CompactionController
         cfs.invalidateCachedRow(key);
     }
 
+    public void removeDeletedInCache(DecoratedKey key)
+    {
+        // For the copying cache, we'd need to re-serialize the updated cachedRow, which would be racy
+        // vs other updates.  We'll just ignore it instead, since the next update to this row will invalidate it
+        // anyway, so the odds of a "tombstones consuming memory indefinitely" problem are minimal.
+        // See https://issues.apache.org/jira/browse/CASSANDRA-3921 for more discussion.
+        if (CacheService.instance.rowCache.isPutCopying())
+            return;
+
+        ColumnFamily cachedRow = cfs.getRawCachedRow(key);
+        if (cachedRow != null)
+            ColumnFamilyStore.removeDeleted(cachedRow, gcBefore);
+    }
+
     /**
      * @return an AbstractCompactedRow implementation to write the merged rows in question.
      *
@@ -141,7 +156,7 @@ public class CompactionController
     {
         return getCompactedRow(Collections.singletonList(row));
     }
-    
+
     public void mayThrottle(long currentBytes)
     {
         throttle.throttle(currentBytes);
