diff --git a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
index 1a447ef3a1..9337ca5aab 100644
--- a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
+++ b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
@@ -148,7 +148,7 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
         
         // scan for sstables corresponding to this cf and load them
         List<SSTableReader> sstables = new ArrayList<SSTableReader>();
-        for (Map.Entry<Descriptor,Set<Component>> sstableFiles : files(table, columnFamilyName).entrySet())
+        for (Map.Entry<Descriptor,Set<Component>> sstableFiles : files(table, columnFamilyName, false).entrySet())
         {
             SSTableReader sstable;
             try
@@ -289,7 +289,7 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
     {
         // get the max generation number, to prevent generation conflicts
         List<Integer> generations = new ArrayList<Integer>();
-        for (Descriptor desc : files(table, columnFamily).keySet())
+        for (Descriptor desc : files(table, columnFamily, true).keySet())
             generations.add(desc.generation);
         Collections.sort(generations);
         int value = (generations.size() > 0) ? (generations.get(generations.size() - 1)) : 0;
@@ -304,7 +304,7 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
      */
     static void scrubDataDirectories(String table, String columnFamily)
     {
-        for (Map.Entry<Descriptor,Set<Component>> sstableFiles : files(table, columnFamily).entrySet())
+        for (Map.Entry<Descriptor,Set<Component>> sstableFiles : files(table, columnFamily, true).entrySet())
         {
             Descriptor desc = sstableFiles.getKey();
             Set<Component> components = sstableFiles.getValue();
@@ -337,7 +337,7 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
     /**
      * Collects a map of sstable components.
      */
-    private static Map<Descriptor,Set<Component>> files(String keyspace, final String columnFamily)
+    private static Map<Descriptor,Set<Component>> files(String keyspace, final String columnFamily, final boolean includeCompacted)
     {
         final Map<Descriptor,Set<Component>> sstables = new HashMap<Descriptor,Set<Component>>();
         for (String directory : DatabaseDescriptor.getAllDataFileLocationsForTable(keyspace))
@@ -351,13 +351,18 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
                     Pair<Descriptor,Component> component = SSTable.tryComponentFromFilename(dir, name);
                     if (component != null && component.left.cfname.equals(columnFamily))
                     {
-                        Set<Component> components = sstables.get(component.left);
-                        if (components == null)
+                        if (includeCompacted || !new File(component.left.filenameFor(Component.COMPACTED_MARKER)).exists())
                         {
-                            components = new HashSet<Component>();
-                            sstables.put(component.left, components);
+                            Set<Component> components = sstables.get(component.left);
+                            if (components == null)
+                            {
+                                components = new HashSet<Component>();
+                                sstables.put(component.left, components);
+                            }
+                            components.add(component.right);
                         }
-                        components.add(component.right);
+                        else
+                            logger.debug("not including compacted sstable " + component.left.cfname + "-" + component.left.generation);
                     }
                     return false;
                 }
diff --git a/src/java/org/apache/cassandra/io/sstable/SSTable.java b/src/java/org/apache/cassandra/io/sstable/SSTable.java
index 253d9f79f3..b83fd3add2 100644
--- a/src/java/org/apache/cassandra/io/sstable/SSTable.java
+++ b/src/java/org/apache/cassandra/io/sstable/SSTable.java
@@ -167,13 +167,7 @@ public abstract class SSTable
     {
         try
         {
-            Pair<Descriptor, Component> pair = Component.fromFilename(dir, name);
-            
-            // if there exists a compaction marker, we want to return null to indicate an invalid sstable.
-            if (new File(pair.left.filenameFor(Component.COMPACTED_MARKER)).exists())
-                return null;
-            else
-                return pair;
+            return Component.fromFilename(dir, name);
         }
         catch (Exception e)
         {
diff --git a/test/system/test_thrift_server.py b/test/system/test_thrift_server.py
index 0fe8e2be66..36d3d59f28 100644
--- a/test/system/test_thrift_server.py
+++ b/test/system/test_thrift_server.py
@@ -1152,31 +1152,37 @@ class TestMutations(ThriftTester):
             client.system_rename_column_family('Standard1', 'in-validcf')
         _expect_exception(invalid_rename, InvalidRequestException)
     
-    def test_cf_recreate(self):
-        keyspace = 'Keyspace1'
-        cf_name = 'RecreatedCf'
-        _set_keyspace(keyspace)
-        
-        # create
-        newcf = CfDef(keyspace, cf_name)
-        client.system_add_column_family(newcf)
-        
-        # insert
-        client.insert('key0', ColumnParent(cf_name), Column('colA', 'colA-value', Clock(0)), ConsistencyLevel.ONE)
-        col1 = client.get_slice('key0', ColumnParent(cf_name), SlicePredicate(slice_range=SliceRange('', '', False, 100)), ConsistencyLevel.ONE)[0].column
-        assert col1.name == 'colA' and col1.value == 'colA-value'
-                
-        # drop
-        client.system_drop_column_family(cf_name) 
-                
-        # recreate
-        client.system_add_column_family(newcf)
-        
-        # query
-        cosc_list = client.get_slice('key0', ColumnParent(cf_name), SlicePredicate(slice_range=SliceRange('', '', False, 100)), ConsistencyLevel.ONE)
-        # this was failing prior to CASSANDRA-1477.
-        assert len(cosc_list) == 0
-        
+    def test_system_cf_recreate(self):
+        "ensures that keyspaces and column familes can be dropped and recreated in short order"
+        for x in range(2):
+            
+            keyspace = 'test_cf_recreate'
+            cf_name = 'recreate_cf'
+            
+            # create
+            newcf = CfDef(keyspace, cf_name)
+            newks = KsDef(keyspace, 'org.apache.cassandra.locator.SimpleStrategy', {}, 1, [newcf])
+            client.system_add_keyspace(newks)
+            _set_keyspace(keyspace)
+            
+            # insert
+            client.insert('key0', ColumnParent(cf_name), Column('colA', 'colA-value', Clock(0)), ConsistencyLevel.ONE)
+            col1 = client.get_slice('key0', ColumnParent(cf_name), SlicePredicate(slice_range=SliceRange('', '', False, 100)), ConsistencyLevel.ONE)[0].column
+            assert col1.name == 'colA' and col1.value == 'colA-value'
+                    
+            # drop
+            client.system_drop_column_family(cf_name) 
+            
+            # recreate
+            client.system_add_column_family(newcf)
+            
+            # query
+            cosc_list = client.get_slice('key0', ColumnParent(cf_name), SlicePredicate(slice_range=SliceRange('', '', False, 100)), ConsistencyLevel.ONE)
+            # this was failing prior to CASSANDRA-1477.
+            assert len(cosc_list) == 0 , 'cosc length test failed'
+            
+            client.system_drop_keyspace(keyspace)
+    
     def test_system_keyspace_operations(self):
         """ Test keyspace (add, drop, rename) operations """
         # create
