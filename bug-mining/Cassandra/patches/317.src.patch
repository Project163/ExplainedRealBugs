diff --git a/contrib/javautils/src/test/java/org/apache/cassandra/contrib/utils/service/CassandraServiceTest.java b/contrib/javautils/src/test/java/org/apache/cassandra/contrib/utils/service/CassandraServiceTest.java
index 991f9152d9..b7c4f39750 100644
--- a/contrib/javautils/src/test/java/org/apache/cassandra/contrib/utils/service/CassandraServiceTest.java
+++ b/contrib/javautils/src/test/java/org/apache/cassandra/contrib/utils/service/CassandraServiceTest.java
@@ -88,7 +88,7 @@ public class CassandraServiceTest {
             NotFoundException, AuthenticationException, AuthorizationException {
         Cassandra.Client client = getClient();
 
-        client.login("Keyspace1", null);
+        client.login(null);
 
         String key_user_id = "1";
         long timestamp = System.currentTimeMillis();   
diff --git a/interface/cassandra.thrift b/interface/cassandra.thrift
index 3031ee247c..36c947cc28 100644
--- a/interface/cassandra.thrift
+++ b/interface/cassandra.thrift
@@ -326,8 +326,11 @@ struct KsDef {
 
 service Cassandra {
   # auth methods
-  AccessLevel login(1: required string keyspace, 2:required AuthenticationRequest auth_request) throws (1:AuthenticationException authnx, 2:AuthorizationException authzx),
+  AccessLevel login(1: required AuthenticationRequest auth_request) throws (1:AuthenticationException authnx, 2:AuthorizationException authzx),
  
+  # set keyspace
+  void set_keyspace(1: required string keyspace) throws (1:InvalidRequestException ire),
+  
   # retrieval methods
 
   /**
diff --git a/interface/thrift/gen-java/org/apache/cassandra/thrift/Cassandra.java b/interface/thrift/gen-java/org/apache/cassandra/thrift/Cassandra.java
index 2ca0d25013..f5ccab9dd3 100644
--- a/interface/thrift/gen-java/org/apache/cassandra/thrift/Cassandra.java
+++ b/interface/thrift/gen-java/org/apache/cassandra/thrift/Cassandra.java
@@ -48,7 +48,9 @@ public class Cassandra {
 
   public interface Iface {
 
-    public AccessLevel login(String keyspace, AuthenticationRequest auth_request) throws AuthenticationException, AuthorizationException, TException;
+    public AccessLevel login(AuthenticationRequest auth_request) throws AuthenticationException, AuthorizationException, TException;
+
+    public void set_keyspace(String keyspace) throws InvalidRequestException, TException;
 
     /**
      * Get the Column or SuperColumn at the given column_path. If no value is present, NotFoundException is thrown. (This is
@@ -261,17 +263,16 @@ public class Cassandra {
       return this.oprot_;
     }
 
-    public AccessLevel login(String keyspace, AuthenticationRequest auth_request) throws AuthenticationException, AuthorizationException, TException
+    public AccessLevel login(AuthenticationRequest auth_request) throws AuthenticationException, AuthorizationException, TException
     {
-      send_login(keyspace, auth_request);
+      send_login(auth_request);
       return recv_login();
     }
 
-    public void send_login(String keyspace, AuthenticationRequest auth_request) throws TException
+    public void send_login(AuthenticationRequest auth_request) throws TException
     {
       oprot_.writeMessageBegin(new TMessage("login", TMessageType.CALL, seqid_));
       login_args args = new login_args();
-      args.keyspace = keyspace;
       args.auth_request = auth_request;
       args.write(oprot_);
       oprot_.writeMessageEnd();
@@ -301,6 +302,39 @@ public class Cassandra {
       throw new TApplicationException(TApplicationException.MISSING_RESULT, "login failed: unknown result");
     }
 
+    public void set_keyspace(String keyspace) throws InvalidRequestException, TException
+    {
+      send_set_keyspace(keyspace);
+      recv_set_keyspace();
+    }
+
+    public void send_set_keyspace(String keyspace) throws TException
+    {
+      oprot_.writeMessageBegin(new TMessage("set_keyspace", TMessageType.CALL, seqid_));
+      set_keyspace_args args = new set_keyspace_args();
+      args.keyspace = keyspace;
+      args.write(oprot_);
+      oprot_.writeMessageEnd();
+      oprot_.getTransport().flush();
+    }
+
+    public void recv_set_keyspace() throws InvalidRequestException, TException
+    {
+      TMessage msg = iprot_.readMessageBegin();
+      if (msg.type == TMessageType.EXCEPTION) {
+        TApplicationException x = TApplicationException.read(iprot_);
+        iprot_.readMessageEnd();
+        throw x;
+      }
+      set_keyspace_result result = new set_keyspace_result();
+      result.read(iprot_);
+      iprot_.readMessageEnd();
+      if (result.ire != null) {
+        throw result.ire;
+      }
+      return;
+    }
+
     public ColumnOrSuperColumn get(byte[] key, ColumnPath column_path, ConsistencyLevel consistency_level) throws InvalidRequestException, NotFoundException, UnavailableException, TimedOutException, TException
     {
       send_get(key, column_path, consistency_level);
@@ -1195,6 +1229,7 @@ public class Cassandra {
     {
       iface_ = iface;
       processMap_.put("login", new login());
+      processMap_.put("set_keyspace", new set_keyspace());
       processMap_.put("get", new get());
       processMap_.put("get_slice", new get_slice());
       processMap_.put("multiget_slice", new multiget_slice());
@@ -1263,7 +1298,7 @@ public class Cassandra {
         iprot.readMessageEnd();
         login_result result = new login_result();
         try {
-          result.success = iface_.login(args.keyspace, args.auth_request);
+          result.success = iface_.login(args.auth_request);
         } catch (AuthenticationException authnx) {
           result.authnx = authnx;
         } catch (AuthorizationException authzx) {
@@ -1285,6 +1320,44 @@ public class Cassandra {
 
     }
 
+    private class set_keyspace implements ProcessFunction {
+      public void process(int seqid, TProtocol iprot, TProtocol oprot) throws TException
+      {
+        set_keyspace_args args = new set_keyspace_args();
+        try {
+          args.read(iprot);
+        } catch (TProtocolException e) {
+          iprot.readMessageEnd();
+          TApplicationException x = new TApplicationException(TApplicationException.PROTOCOL_ERROR, e.getMessage());
+          oprot.writeMessageBegin(new TMessage("set_keyspace", TMessageType.EXCEPTION, seqid));
+          x.write(oprot);
+          oprot.writeMessageEnd();
+          oprot.getTransport().flush();
+          return;
+        }
+        iprot.readMessageEnd();
+        set_keyspace_result result = new set_keyspace_result();
+        try {
+          iface_.set_keyspace(args.keyspace);
+        } catch (InvalidRequestException ire) {
+          result.ire = ire;
+        } catch (Throwable th) {
+          LOGGER.error("Internal error processing set_keyspace", th);
+          TApplicationException x = new TApplicationException(TApplicationException.INTERNAL_ERROR, "Internal error processing set_keyspace");
+          oprot.writeMessageBegin(new TMessage("set_keyspace", TMessageType.EXCEPTION, seqid));
+          x.write(oprot);
+          oprot.writeMessageEnd();
+          oprot.getTransport().flush();
+          return;
+        }
+        oprot.writeMessageBegin(new TMessage("set_keyspace", TMessageType.REPLY, seqid));
+        result.write(oprot);
+        oprot.writeMessageEnd();
+        oprot.getTransport().flush();
+      }
+
+    }
+
     private class get implements ProcessFunction {
       public void process(int seqid, TProtocol iprot, TProtocol oprot) throws TException
       {
@@ -2151,16 +2224,13 @@ public class Cassandra {
   public static class login_args implements TBase<login_args._Fields>, java.io.Serializable, Cloneable   {
     private static final TStruct STRUCT_DESC = new TStruct("login_args");
 
-    private static final TField KEYSPACE_FIELD_DESC = new TField("keyspace", TType.STRING, (short)1);
-    private static final TField AUTH_REQUEST_FIELD_DESC = new TField("auth_request", TType.STRUCT, (short)2);
+    private static final TField AUTH_REQUEST_FIELD_DESC = new TField("auth_request", TType.STRUCT, (short)1);
 
-    public String keyspace;
     public AuthenticationRequest auth_request;
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements TFieldIdEnum {
-      KEYSPACE((short)1, "keyspace"),
-      AUTH_REQUEST((short)2, "auth_request");
+      AUTH_REQUEST((short)1, "auth_request");
 
       private static final Map<Integer, _Fields> byId = new HashMap<Integer, _Fields>();
       private static final Map<String, _Fields> byName = new HashMap<String, _Fields>();
@@ -2216,8 +2286,6 @@ public class Cassandra {
     // isset id assignments
 
     public static final Map<_Fields, FieldMetaData> metaDataMap = Collections.unmodifiableMap(new EnumMap<_Fields, FieldMetaData>(_Fields.class) {{
-      put(_Fields.KEYSPACE, new FieldMetaData("keyspace", TFieldRequirementType.REQUIRED, 
-          new FieldValueMetaData(TType.STRING)));
       put(_Fields.AUTH_REQUEST, new FieldMetaData("auth_request", TFieldRequirementType.REQUIRED, 
           new StructMetaData(TType.STRUCT, AuthenticationRequest.class)));
     }});
@@ -2230,11 +2298,9 @@ public class Cassandra {
     }
 
     public login_args(
-      String keyspace,
       AuthenticationRequest auth_request)
     {
       this();
-      this.keyspace = keyspace;
       this.auth_request = auth_request;
     }
 
@@ -2242,9 +2308,6 @@ public class Cassandra {
      * Performs a deep copy on <i>other</i>.
      */
     public login_args(login_args other) {
-      if (other.isSetKeyspace()) {
-        this.keyspace = other.keyspace;
-      }
       if (other.isSetAuth_request()) {
         this.auth_request = new AuthenticationRequest(other.auth_request);
       }
@@ -2259,30 +2322,6 @@ public class Cassandra {
       return new login_args(this);
     }
 
-    public String getKeyspace() {
-      return this.keyspace;
-    }
-
-    public login_args setKeyspace(String keyspace) {
-      this.keyspace = keyspace;
-      return this;
-    }
-
-    public void unsetKeyspace() {
-      this.keyspace = null;
-    }
-
-    /** Returns true if field keyspace is set (has been asigned a value) and false otherwise */
-    public boolean isSetKeyspace() {
-      return this.keyspace != null;
-    }
-
-    public void setKeyspaceIsSet(boolean value) {
-      if (!value) {
-        this.keyspace = null;
-      }
-    }
-
     public AuthenticationRequest getAuth_request() {
       return this.auth_request;
     }
@@ -2309,14 +2348,6 @@ public class Cassandra {
 
     public void setFieldValue(_Fields field, Object value) {
       switch (field) {
-      case KEYSPACE:
-        if (value == null) {
-          unsetKeyspace();
-        } else {
-          setKeyspace((String)value);
-        }
-        break;
-
       case AUTH_REQUEST:
         if (value == null) {
           unsetAuth_request();
@@ -2334,9 +2365,6 @@ public class Cassandra {
 
     public Object getFieldValue(_Fields field) {
       switch (field) {
-      case KEYSPACE:
-        return getKeyspace();
-
       case AUTH_REQUEST:
         return getAuth_request();
 
@@ -2351,8 +2379,6 @@ public class Cassandra {
     /** Returns true if field corresponding to fieldID is set (has been asigned a value) and false otherwise */
     public boolean isSet(_Fields field) {
       switch (field) {
-      case KEYSPACE:
-        return isSetKeyspace();
       case AUTH_REQUEST:
         return isSetAuth_request();
       }
@@ -2376,15 +2402,6 @@ public class Cassandra {
       if (that == null)
         return false;
 
-      boolean this_present_keyspace = true && this.isSetKeyspace();
-      boolean that_present_keyspace = true && that.isSetKeyspace();
-      if (this_present_keyspace || that_present_keyspace) {
-        if (!(this_present_keyspace && that_present_keyspace))
-          return false;
-        if (!this.keyspace.equals(that.keyspace))
-          return false;
-      }
-
       boolean this_present_auth_request = true && this.isSetAuth_request();
       boolean that_present_auth_request = true && that.isSetAuth_request();
       if (this_present_auth_request || that_present_auth_request) {
@@ -2412,14 +2429,7 @@ public class Cassandra {
           break;
         }
         switch (field.id) {
-          case 1: // KEYSPACE
-            if (field.type == TType.STRING) {
-              this.keyspace = iprot.readString();
-            } else { 
-              TProtocolUtil.skip(iprot, field.type);
-            }
-            break;
-          case 2: // AUTH_REQUEST
+          case 1: // AUTH_REQUEST
             if (field.type == TType.STRUCT) {
               this.auth_request = new AuthenticationRequest();
               this.auth_request.read(iprot);
@@ -2442,11 +2452,6 @@ public class Cassandra {
       validate();
 
       oprot.writeStructBegin(STRUCT_DESC);
-      if (this.keyspace != null) {
-        oprot.writeFieldBegin(KEYSPACE_FIELD_DESC);
-        oprot.writeString(this.keyspace);
-        oprot.writeFieldEnd();
-      }
       if (this.auth_request != null) {
         oprot.writeFieldBegin(AUTH_REQUEST_FIELD_DESC);
         this.auth_request.write(oprot);
@@ -2461,14 +2466,6 @@ public class Cassandra {
       StringBuilder sb = new StringBuilder("login_args(");
       boolean first = true;
 
-      sb.append("keyspace:");
-      if (this.keyspace == null) {
-        sb.append("null");
-      } else {
-        sb.append(this.keyspace);
-      }
-      first = false;
-      if (!first) sb.append(", ");
       sb.append("auth_request:");
       if (this.auth_request == null) {
         sb.append("null");
@@ -2482,9 +2479,6 @@ public class Cassandra {
 
     public void validate() throws TException {
       // check for required fields
-      if (keyspace == null) {
-        throw new TProtocolException("Required field 'keyspace' was not present! Struct: " + toString());
-      }
       if (auth_request == null) {
         throw new TProtocolException("Required field 'auth_request' was not present! Struct: " + toString());
       }
@@ -2958,6 +2952,571 @@ public class Cassandra {
 
   }
 
+  public static class set_keyspace_args implements TBase<set_keyspace_args._Fields>, java.io.Serializable, Cloneable, Comparable<set_keyspace_args>   {
+    private static final TStruct STRUCT_DESC = new TStruct("set_keyspace_args");
+
+    private static final TField KEYSPACE_FIELD_DESC = new TField("keyspace", TType.STRING, (short)1);
+
+    public String keyspace;
+
+    /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
+    public enum _Fields implements TFieldIdEnum {
+      KEYSPACE((short)1, "keyspace");
+
+      private static final Map<Integer, _Fields> byId = new HashMap<Integer, _Fields>();
+      private static final Map<String, _Fields> byName = new HashMap<String, _Fields>();
+
+      static {
+        for (_Fields field : EnumSet.allOf(_Fields.class)) {
+          byId.put((int)field._thriftId, field);
+          byName.put(field.getFieldName(), field);
+        }
+      }
+
+      /**
+       * Find the _Fields constant that matches fieldId, or null if its not found.
+       */
+      public static _Fields findByThriftId(int fieldId) {
+        return byId.get(fieldId);
+      }
+
+      /**
+       * Find the _Fields constant that matches fieldId, throwing an exception
+       * if it is not found.
+       */
+      public static _Fields findByThriftIdOrThrow(int fieldId) {
+        _Fields fields = findByThriftId(fieldId);
+        if (fields == null) throw new IllegalArgumentException("Field " + fieldId + " doesn't exist!");
+        return fields;
+      }
+
+      /**
+       * Find the _Fields constant that matches name, or null if its not found.
+       */
+      public static _Fields findByName(String name) {
+        return byName.get(name);
+      }
+
+      private final short _thriftId;
+      private final String _fieldName;
+
+      _Fields(short thriftId, String fieldName) {
+        _thriftId = thriftId;
+        _fieldName = fieldName;
+      }
+
+      public short getThriftFieldId() {
+        return _thriftId;
+      }
+
+      public String getFieldName() {
+        return _fieldName;
+      }
+    }
+
+    // isset id assignments
+
+    public static final Map<_Fields, FieldMetaData> metaDataMap = Collections.unmodifiableMap(new EnumMap<_Fields, FieldMetaData>(_Fields.class) {{
+      put(_Fields.KEYSPACE, new FieldMetaData("keyspace", TFieldRequirementType.REQUIRED, 
+          new FieldValueMetaData(TType.STRING)));
+    }});
+
+    static {
+      FieldMetaData.addStructMetaDataMap(set_keyspace_args.class, metaDataMap);
+    }
+
+    public set_keyspace_args() {
+    }
+
+    public set_keyspace_args(
+      String keyspace)
+    {
+      this();
+      this.keyspace = keyspace;
+    }
+
+    /**
+     * Performs a deep copy on <i>other</i>.
+     */
+    public set_keyspace_args(set_keyspace_args other) {
+      if (other.isSetKeyspace()) {
+        this.keyspace = other.keyspace;
+      }
+    }
+
+    public set_keyspace_args deepCopy() {
+      return new set_keyspace_args(this);
+    }
+
+    @Deprecated
+    public set_keyspace_args clone() {
+      return new set_keyspace_args(this);
+    }
+
+    public String getKeyspace() {
+      return this.keyspace;
+    }
+
+    public set_keyspace_args setKeyspace(String keyspace) {
+      this.keyspace = keyspace;
+      return this;
+    }
+
+    public void unsetKeyspace() {
+      this.keyspace = null;
+    }
+
+    /** Returns true if field keyspace is set (has been asigned a value) and false otherwise */
+    public boolean isSetKeyspace() {
+      return this.keyspace != null;
+    }
+
+    public void setKeyspaceIsSet(boolean value) {
+      if (!value) {
+        this.keyspace = null;
+      }
+    }
+
+    public void setFieldValue(_Fields field, Object value) {
+      switch (field) {
+      case KEYSPACE:
+        if (value == null) {
+          unsetKeyspace();
+        } else {
+          setKeyspace((String)value);
+        }
+        break;
+
+      }
+    }
+
+    public void setFieldValue(int fieldID, Object value) {
+      setFieldValue(_Fields.findByThriftIdOrThrow(fieldID), value);
+    }
+
+    public Object getFieldValue(_Fields field) {
+      switch (field) {
+      case KEYSPACE:
+        return getKeyspace();
+
+      }
+      throw new IllegalStateException();
+    }
+
+    public Object getFieldValue(int fieldId) {
+      return getFieldValue(_Fields.findByThriftIdOrThrow(fieldId));
+    }
+
+    /** Returns true if field corresponding to fieldID is set (has been asigned a value) and false otherwise */
+    public boolean isSet(_Fields field) {
+      switch (field) {
+      case KEYSPACE:
+        return isSetKeyspace();
+      }
+      throw new IllegalStateException();
+    }
+
+    public boolean isSet(int fieldID) {
+      return isSet(_Fields.findByThriftIdOrThrow(fieldID));
+    }
+
+    @Override
+    public boolean equals(Object that) {
+      if (that == null)
+        return false;
+      if (that instanceof set_keyspace_args)
+        return this.equals((set_keyspace_args)that);
+      return false;
+    }
+
+    public boolean equals(set_keyspace_args that) {
+      if (that == null)
+        return false;
+
+      boolean this_present_keyspace = true && this.isSetKeyspace();
+      boolean that_present_keyspace = true && that.isSetKeyspace();
+      if (this_present_keyspace || that_present_keyspace) {
+        if (!(this_present_keyspace && that_present_keyspace))
+          return false;
+        if (!this.keyspace.equals(that.keyspace))
+          return false;
+      }
+
+      return true;
+    }
+
+    @Override
+    public int hashCode() {
+      return 0;
+    }
+
+    public int compareTo(set_keyspace_args other) {
+      if (!getClass().equals(other.getClass())) {
+        return getClass().getName().compareTo(other.getClass().getName());
+      }
+
+      int lastComparison = 0;
+      set_keyspace_args typedOther = (set_keyspace_args)other;
+
+      lastComparison = Boolean.valueOf(isSetKeyspace()).compareTo(typedOther.isSetKeyspace());
+      if (lastComparison != 0) {
+        return lastComparison;
+      }
+      if (isSetKeyspace()) {        lastComparison = TBaseHelper.compareTo(keyspace, typedOther.keyspace);
+        if (lastComparison != 0) {
+          return lastComparison;
+        }
+      }
+      return 0;
+    }
+
+    public void read(TProtocol iprot) throws TException {
+      TField field;
+      iprot.readStructBegin();
+      while (true)
+      {
+        field = iprot.readFieldBegin();
+        if (field.type == TType.STOP) { 
+          break;
+        }
+        switch (field.id) {
+          case 1: // KEYSPACE
+            if (field.type == TType.STRING) {
+              this.keyspace = iprot.readString();
+            } else { 
+              TProtocolUtil.skip(iprot, field.type);
+            }
+            break;
+          default:
+            TProtocolUtil.skip(iprot, field.type);
+        }
+        iprot.readFieldEnd();
+      }
+      iprot.readStructEnd();
+
+      // check for required fields of primitive type, which can't be checked in the validate method
+      validate();
+    }
+
+    public void write(TProtocol oprot) throws TException {
+      validate();
+
+      oprot.writeStructBegin(STRUCT_DESC);
+      if (this.keyspace != null) {
+        oprot.writeFieldBegin(KEYSPACE_FIELD_DESC);
+        oprot.writeString(this.keyspace);
+        oprot.writeFieldEnd();
+      }
+      oprot.writeFieldStop();
+      oprot.writeStructEnd();
+    }
+
+    @Override
+    public String toString() {
+      StringBuilder sb = new StringBuilder("set_keyspace_args(");
+      boolean first = true;
+
+      sb.append("keyspace:");
+      if (this.keyspace == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.keyspace);
+      }
+      first = false;
+      sb.append(")");
+      return sb.toString();
+    }
+
+    public void validate() throws TException {
+      // check for required fields
+      if (keyspace == null) {
+        throw new TProtocolException("Required field 'keyspace' was not present! Struct: " + toString());
+      }
+    }
+
+  }
+
+  public static class set_keyspace_result implements TBase<set_keyspace_result._Fields>, java.io.Serializable, Cloneable, Comparable<set_keyspace_result>   {
+    private static final TStruct STRUCT_DESC = new TStruct("set_keyspace_result");
+
+    private static final TField IRE_FIELD_DESC = new TField("ire", TType.STRUCT, (short)1);
+
+    public InvalidRequestException ire;
+
+    /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
+    public enum _Fields implements TFieldIdEnum {
+      IRE((short)1, "ire");
+
+      private static final Map<Integer, _Fields> byId = new HashMap<Integer, _Fields>();
+      private static final Map<String, _Fields> byName = new HashMap<String, _Fields>();
+
+      static {
+        for (_Fields field : EnumSet.allOf(_Fields.class)) {
+          byId.put((int)field._thriftId, field);
+          byName.put(field.getFieldName(), field);
+        }
+      }
+
+      /**
+       * Find the _Fields constant that matches fieldId, or null if its not found.
+       */
+      public static _Fields findByThriftId(int fieldId) {
+        return byId.get(fieldId);
+      }
+
+      /**
+       * Find the _Fields constant that matches fieldId, throwing an exception
+       * if it is not found.
+       */
+      public static _Fields findByThriftIdOrThrow(int fieldId) {
+        _Fields fields = findByThriftId(fieldId);
+        if (fields == null) throw new IllegalArgumentException("Field " + fieldId + " doesn't exist!");
+        return fields;
+      }
+
+      /**
+       * Find the _Fields constant that matches name, or null if its not found.
+       */
+      public static _Fields findByName(String name) {
+        return byName.get(name);
+      }
+
+      private final short _thriftId;
+      private final String _fieldName;
+
+      _Fields(short thriftId, String fieldName) {
+        _thriftId = thriftId;
+        _fieldName = fieldName;
+      }
+
+      public short getThriftFieldId() {
+        return _thriftId;
+      }
+
+      public String getFieldName() {
+        return _fieldName;
+      }
+    }
+
+    // isset id assignments
+
+    public static final Map<_Fields, FieldMetaData> metaDataMap = Collections.unmodifiableMap(new EnumMap<_Fields, FieldMetaData>(_Fields.class) {{
+      put(_Fields.IRE, new FieldMetaData("ire", TFieldRequirementType.DEFAULT, 
+          new FieldValueMetaData(TType.STRUCT)));
+    }});
+
+    static {
+      FieldMetaData.addStructMetaDataMap(set_keyspace_result.class, metaDataMap);
+    }
+
+    public set_keyspace_result() {
+    }
+
+    public set_keyspace_result(
+      InvalidRequestException ire)
+    {
+      this();
+      this.ire = ire;
+    }
+
+    /**
+     * Performs a deep copy on <i>other</i>.
+     */
+    public set_keyspace_result(set_keyspace_result other) {
+      if (other.isSetIre()) {
+        this.ire = new InvalidRequestException(other.ire);
+      }
+    }
+
+    public set_keyspace_result deepCopy() {
+      return new set_keyspace_result(this);
+    }
+
+    @Deprecated
+    public set_keyspace_result clone() {
+      return new set_keyspace_result(this);
+    }
+
+    public InvalidRequestException getIre() {
+      return this.ire;
+    }
+
+    public set_keyspace_result setIre(InvalidRequestException ire) {
+      this.ire = ire;
+      return this;
+    }
+
+    public void unsetIre() {
+      this.ire = null;
+    }
+
+    /** Returns true if field ire is set (has been asigned a value) and false otherwise */
+    public boolean isSetIre() {
+      return this.ire != null;
+    }
+
+    public void setIreIsSet(boolean value) {
+      if (!value) {
+        this.ire = null;
+      }
+    }
+
+    public void setFieldValue(_Fields field, Object value) {
+      switch (field) {
+      case IRE:
+        if (value == null) {
+          unsetIre();
+        } else {
+          setIre((InvalidRequestException)value);
+        }
+        break;
+
+      }
+    }
+
+    public void setFieldValue(int fieldID, Object value) {
+      setFieldValue(_Fields.findByThriftIdOrThrow(fieldID), value);
+    }
+
+    public Object getFieldValue(_Fields field) {
+      switch (field) {
+      case IRE:
+        return getIre();
+
+      }
+      throw new IllegalStateException();
+    }
+
+    public Object getFieldValue(int fieldId) {
+      return getFieldValue(_Fields.findByThriftIdOrThrow(fieldId));
+    }
+
+    /** Returns true if field corresponding to fieldID is set (has been asigned a value) and false otherwise */
+    public boolean isSet(_Fields field) {
+      switch (field) {
+      case IRE:
+        return isSetIre();
+      }
+      throw new IllegalStateException();
+    }
+
+    public boolean isSet(int fieldID) {
+      return isSet(_Fields.findByThriftIdOrThrow(fieldID));
+    }
+
+    @Override
+    public boolean equals(Object that) {
+      if (that == null)
+        return false;
+      if (that instanceof set_keyspace_result)
+        return this.equals((set_keyspace_result)that);
+      return false;
+    }
+
+    public boolean equals(set_keyspace_result that) {
+      if (that == null)
+        return false;
+
+      boolean this_present_ire = true && this.isSetIre();
+      boolean that_present_ire = true && that.isSetIre();
+      if (this_present_ire || that_present_ire) {
+        if (!(this_present_ire && that_present_ire))
+          return false;
+        if (!this.ire.equals(that.ire))
+          return false;
+      }
+
+      return true;
+    }
+
+    @Override
+    public int hashCode() {
+      return 0;
+    }
+
+    public int compareTo(set_keyspace_result other) {
+      if (!getClass().equals(other.getClass())) {
+        return getClass().getName().compareTo(other.getClass().getName());
+      }
+
+      int lastComparison = 0;
+      set_keyspace_result typedOther = (set_keyspace_result)other;
+
+      lastComparison = Boolean.valueOf(isSetIre()).compareTo(typedOther.isSetIre());
+      if (lastComparison != 0) {
+        return lastComparison;
+      }
+      if (isSetIre()) {        lastComparison = TBaseHelper.compareTo(ire, typedOther.ire);
+        if (lastComparison != 0) {
+          return lastComparison;
+        }
+      }
+      return 0;
+    }
+
+    public void read(TProtocol iprot) throws TException {
+      TField field;
+      iprot.readStructBegin();
+      while (true)
+      {
+        field = iprot.readFieldBegin();
+        if (field.type == TType.STOP) { 
+          break;
+        }
+        switch (field.id) {
+          case 1: // IRE
+            if (field.type == TType.STRUCT) {
+              this.ire = new InvalidRequestException();
+              this.ire.read(iprot);
+            } else { 
+              TProtocolUtil.skip(iprot, field.type);
+            }
+            break;
+          default:
+            TProtocolUtil.skip(iprot, field.type);
+        }
+        iprot.readFieldEnd();
+      }
+      iprot.readStructEnd();
+
+      // check for required fields of primitive type, which can't be checked in the validate method
+      validate();
+    }
+
+    public void write(TProtocol oprot) throws TException {
+      oprot.writeStructBegin(STRUCT_DESC);
+
+      if (this.isSetIre()) {
+        oprot.writeFieldBegin(IRE_FIELD_DESC);
+        this.ire.write(oprot);
+        oprot.writeFieldEnd();
+      }
+      oprot.writeFieldStop();
+      oprot.writeStructEnd();
+    }
+
+    @Override
+    public String toString() {
+      StringBuilder sb = new StringBuilder("set_keyspace_result(");
+      boolean first = true;
+
+      sb.append("ire:");
+      if (this.ire == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.ire);
+      }
+      first = false;
+      sb.append(")");
+      return sb.toString();
+    }
+
+    public void validate() throws TException {
+      // check for required fields
+    }
+
+  }
+
   public static class get_args implements TBase<get_args._Fields>, java.io.Serializable, Cloneable, Comparable<get_args>   {
     private static final TStruct STRUCT_DESC = new TStruct("get_args");
 
diff --git a/src/java/org/apache/cassandra/cli/CliClient.java b/src/java/org/apache/cassandra/cli/CliClient.java
index d1003cb7d8..56afce702d 100644
--- a/src/java/org/apache/cassandra/cli/CliClient.java
+++ b/src/java/org/apache/cassandra/cli/CliClient.java
@@ -502,16 +502,19 @@ public class CliClient
         	AuthenticationRequest authRequest;
         	Map<String, String> credentials = new HashMap<String, String>();
         	
+        	
+        	thriftClient_.set_keyspace(tableName);
+   
         	if (username != null && password != null) 
         	{
         	    /* remove quotes */
         	    password = password.replace("\'", "");
         	    credentials.put(SimpleAuthenticator.USERNAME_KEY, username);
                 credentials.put(SimpleAuthenticator.PASSWORD_KEY, password);
+                authRequest = new AuthenticationRequest(credentials);
+                thriftClient_.login(authRequest);
         	}
         	
-        	authRequest = new AuthenticationRequest(credentials);
-            thriftClient_.login(tableName, authRequest);
             keySpace = tableName;
             this.username = username != null ? username : "default";
             
@@ -533,11 +536,16 @@ public class CliClient
             css_.err.println("You are not authorized to use keyspace: " + tableName);
             return;
         }
-        catch (NotFoundException e)
+        catch (InvalidRequestException e)
         {
-            css_.err.println("This keyspace does not exist: " + tableName);
+            css_.err.println(tableName + " does not exist.");
             return;
         }
+        catch (NotFoundException e)
+        {
+            css_.err.println(tableName + " does not exist.");
+            return;
+        } 
         catch (TException e) 
         {
             if (css_.debug)
@@ -545,7 +553,7 @@ public class CliClient
             
             css_.err.println("Login failure. Did you specify 'keyspace', 'username' and 'password'?");
             return;
-        } 
+        }
     }
 
     // process a statement of the form: describe table <tablename> 
diff --git a/src/java/org/apache/cassandra/cli/CliMain.java b/src/java/org/apache/cassandra/cli/CliMain.java
index 4ef06b9a40..03ed4d85bd 100644
--- a/src/java/org/apache/cassandra/cli/CliMain.java
+++ b/src/java/org/apache/cassandra/cli/CliMain.java
@@ -101,7 +101,32 @@ public class CliMain
         thriftClient_ = cassandraClient;
         cliClient_ = new CliClient(css_, thriftClient_);
         
-        if ((css_.username != null) && (css_.password != null) && (css_.keyspace != null))
+        if (css_.keyspace != null)
+        {
+            try {
+                thriftClient_.set_keyspace(css_.keyspace);
+                cliClient_.setKeyspace(css_.keyspace);
+                updateCompletor(cliClient_.getCFMetaData(css_.keyspace).keySet());
+                
+            }
+            catch (InvalidRequestException e)
+            {
+                css_.err.println("Keyspace " + css_.keyspace + " not found");
+                return;
+            }
+            catch (TException e)
+            {
+                css_.err.println("Did you specify 'keyspace'?");
+                return;
+            }
+            catch (NotFoundException e)
+            {
+                css_.err.println("Keyspace " + css_.keyspace + " not found");
+                return;
+            }
+        }
+        
+        if ((css_.username != null) && (css_.password != null))
         {
             // Authenticate 
             Map<String, String> credentials = new HashMap<String, String>();
@@ -110,9 +135,7 @@ public class CliMain
             AuthenticationRequest authRequest = new AuthenticationRequest(credentials);
             try 
             {
-                thriftClient_.login(css_.keyspace, authRequest);
-                updateCompletor(cliClient_.getCFMetaData(css_.keyspace).keySet());
-                cliClient_.setKeyspace(css_.keyspace);
+                thriftClient_.login(authRequest);
                 cliClient_.setUsername(css_.username);
             } 
             catch (AuthenticationException e) 
@@ -130,11 +153,7 @@ public class CliMain
             {
                 css_.err.println("Login failure. Did you specify 'keyspace', 'username' and 'password'?");
                 return;
-            } catch (NotFoundException e) {
-                css_.err.println("Keyspace not found.");
-                return;
-            }
-            
+            } 
         }
         
         // Lookup the cluster name, this is to make it clear which cluster the user is connected to
diff --git a/src/java/org/apache/cassandra/hadoop/ColumnFamilyRecordReader.java b/src/java/org/apache/cassandra/hadoop/ColumnFamilyRecordReader.java
index 9d4232a6ee..5c88c636a1 100644
--- a/src/java/org/apache/cassandra/hadoop/ColumnFamilyRecordReader.java
+++ b/src/java/org/apache/cassandra/hadoop/ColumnFamilyRecordReader.java
@@ -95,7 +95,6 @@ public class ColumnFamilyRecordReader extends RecordReader<byte[], SortedMap<byt
         authRequest = new AuthenticationRequest(creds);
         
         iter = new RowIterator();
-        iter.login();
     }
     
     public boolean nextKeyValue() throws IOException
@@ -115,21 +114,6 @@ public class ColumnFamilyRecordReader extends RecordReader<byte[], SortedMap<byt
         private int i = 0;
         private AbstractType comparator = DatabaseDescriptor.getComparator(keyspace, cfName);
         
-        private void login()
-        {
-            TSocket socket = new TSocket(getLocation(),DatabaseDescriptor.getRpcPort());
-            TBinaryProtocol binaryProtocol = new TBinaryProtocol(socket, false, false);
-            Cassandra.Client client = new Cassandra.Client(binaryProtocol);
-            
-            try
-            {
-                socket.open();
-                client.login(keyspace, authRequest);
-            } catch (Exception e) {
-            	throw new RuntimeException(e);
-            }
-        }
-        
         private void maybeInit()
         {
             // check if we need another batch 
@@ -166,7 +150,8 @@ public class ColumnFamilyRecordReader extends RecordReader<byte[], SortedMap<byt
                                 .setEnd_token(split.getEndToken());
             try
             {
-            	client.login(keyspace, authRequest);
+                client.set_keyspace(keyspace);
+            	client.login(authRequest);
                 rows = client.get_range_slices(new ColumnParent(cfName),
                                                predicate,
                                                keyRange,
diff --git a/src/java/org/apache/cassandra/thrift/CassandraServer.java b/src/java/org/apache/cassandra/thrift/CassandraServer.java
index 7ba3f0c3e1..3c4f76e77d 100644
--- a/src/java/org/apache/cassandra/thrift/CassandraServer.java
+++ b/src/java/org/apache/cassandra/thrift/CassandraServer.java
@@ -22,6 +22,7 @@ import java.io.IOException;
 import java.util.*;
 import java.util.concurrent.TimeoutException;
 
+import org.apache.cassandra.auth.AllowAllAuthenticator;
 import org.apache.cassandra.concurrent.StageManager;
 import org.apache.cassandra.config.ConfigurationException;
 import org.apache.cassandra.config.KSMetaData;
@@ -233,7 +234,7 @@ public class CassandraServer implements Cassandra.Iface
         if (logger.isDebugEnabled())
             logger.debug("get_slice");
         
-        checkLoginAuthorized(AccessLevel.READONLY);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.READONLY);
         return multigetSliceInternal(keySpace.get(), Arrays.asList(key), column_parent, predicate, consistency_level).get(key);
     }
     
@@ -243,7 +244,7 @@ public class CassandraServer implements Cassandra.Iface
         if (logger.isDebugEnabled())
             logger.debug("multiget_slice");
 
-        checkLoginAuthorized(AccessLevel.READONLY);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.READONLY);
 
         return multigetSliceInternal(keySpace.get(), keys, column_parent, predicate, consistency_level);
     }
@@ -282,7 +283,7 @@ public class CassandraServer implements Cassandra.Iface
         if (logger.isDebugEnabled())
             logger.debug("get");
 
-        checkLoginAuthorized(AccessLevel.READONLY);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.READONLY);
         String keyspace = keySpace.get();
 
         ThriftValidation.validateColumnPath(keyspace, column_path);
@@ -310,7 +311,7 @@ public class CassandraServer implements Cassandra.Iface
         if (logger.isDebugEnabled())
             logger.debug("get_count");
 
-        checkLoginAuthorized(AccessLevel.READONLY);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.READONLY);
 
         return get_slice(key, column_parent, predicate, consistency_level).size();
     }
@@ -321,7 +322,7 @@ public class CassandraServer implements Cassandra.Iface
         if (logger.isDebugEnabled())
             logger.debug("multiget_count");
 
-        checkLoginAuthorized(AccessLevel.READONLY);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.READONLY);
 
         Map<byte[], Integer> counts = new HashMap<byte[], Integer>();
         Map<byte[], List<ColumnOrSuperColumn>> columnFamiliesMap = multigetSliceInternal(table, keys, column_parent, predicate, consistency_level);
@@ -338,7 +339,7 @@ public class CassandraServer implements Cassandra.Iface
         if (logger.isDebugEnabled())
             logger.debug("insert");
 
-        checkLoginAuthorized(AccessLevel.READWRITE);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.READWRITE);
 
         ThriftValidation.validateKey(key);
         ThriftValidation.validateColumnParent(keySpace.get(), column_parent);
@@ -362,7 +363,7 @@ public class CassandraServer implements Cassandra.Iface
         if (logger.isDebugEnabled())
             logger.debug("batch_insert");
 
-        checkLoginAuthorized(AccessLevel.READWRITE);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.READWRITE);
 
         ThriftValidation.validateKey(key);
 
@@ -401,7 +402,7 @@ public class CassandraServer implements Cassandra.Iface
             }
         }
         
-        checkLoginAuthorized(needed);
+        checkKeyspaceAndLoginAuthorized(needed);
 
         List<RowMutation> rowMutations = new ArrayList<RowMutation>();
         for (Map.Entry<byte[], Map<String, List<Mutation>>> mutationEntry: mutation_map.entrySet())
@@ -444,7 +445,7 @@ public class CassandraServer implements Cassandra.Iface
         if (logger.isDebugEnabled())
             logger.debug("remove");
 
-        checkLoginAuthorized(AccessLevel.FULL);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.FULL);
 
         ThriftValidation.validateKey(key);
         ThriftValidation.validateColumnPathOrParent(keySpace.get(), column_path);
@@ -522,7 +523,7 @@ public class CassandraServer implements Cassandra.Iface
     private List<KeySlice> getRangeSlicesInternal(String keyspace, ColumnParent column_parent, SlicePredicate predicate, KeyRange range, ConsistencyLevel consistency_level)
             throws InvalidRequestException, UnavailableException, TimedOutException
     {
-        checkLoginAuthorized(AccessLevel.READONLY);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.READONLY);
 
         ThriftValidation.validateColumnParent(keyspace, column_parent);
         ThriftValidation.validatePredicate(keyspace, column_parent, predicate);
@@ -606,34 +607,43 @@ public class CassandraServer implements Cassandra.Iface
         return splits;
     }
 
-    public AccessLevel login(String keyspace, AuthenticationRequest auth_request) throws AuthenticationException, AuthorizationException, TException
+    public AccessLevel login(AuthenticationRequest auth_request) throws AuthenticationException, AuthorizationException, TException
     {
         AccessLevel level;
-        if (DatabaseDescriptor.getTableDefinition(keyspace) == null)
+        
+        if (keySpace.get() == null)
         {
-            throw new AuthenticationException("Keyspace does not exist");
+            throw new AuthenticationException("You have not set a specific keyspace; please call set_keyspace first");
         }
         
-        level = DatabaseDescriptor.getAuthenticator().login(keyspace, auth_request);
+        level = DatabaseDescriptor.getAuthenticator().login(keySpace.get(), auth_request);
         
         if (logger.isDebugEnabled())
-            logger.debug("login confirmed; access level is " + level);
+            logger.debug("login confirmed; new access level is " + level);
         
         loginDone.set(level);
-        keySpace.set(keyspace);
         return level;
     }
 
-    protected void checkLoginAuthorized(AccessLevel level) throws InvalidRequestException
+    protected void checkKeyspaceAndLoginAuthorized(AccessLevel level) throws InvalidRequestException
     {
-        if (keySpace.get() == null) throw new InvalidRequestException("You have not logged in to a specific keyspace");
-        if (loginDone.get() == AccessLevel.NONE) throw new InvalidRequestException("Your login access level was not sufficient to do " + level + " operations");
-        if (loginDone.get().getValue() < level.getValue()) throw new InvalidRequestException("Your login access level was not sufficient to do " + level + " operations");
+        if (keySpace.get() == null)
+        {
+            throw new InvalidRequestException("You have not assigned a keyspace; please use set_keyspace (and login if necessary)");
+        }
+        
+        if (!(DatabaseDescriptor.getAuthenticator() instanceof AllowAllAuthenticator))
+        {
+            if (loginDone.get() == null)
+                throw new InvalidRequestException("You have not logged into keyspace " + keySpace.get());
+            if (loginDone.get().getValue() < level.getValue())
+                throw new InvalidRequestException("Your credentials are not sufficient to perform " + level + " operations");
+        }
     }
 
     public void system_add_column_family(CfDef cf_def) throws InvalidRequestException, TException
     {
-        checkLoginAuthorized(AccessLevel.FULL);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.FULL);
 
         // if there is anything going on in the migration stage, fail.
         if (StageManager.getStage(StageManager.MIGRATION_STAGE).getQueue().size() > 0)
@@ -671,7 +681,7 @@ public class CassandraServer implements Cassandra.Iface
 
     public void system_drop_column_family(String keyspace, String column_family) throws InvalidRequestException, TException
     {
-        checkLoginAuthorized(AccessLevel.FULL);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.FULL);
         
         // if there is anything going on in the migration stage, fail.
         if (StageManager.getStage(StageManager.MIGRATION_STAGE).getQueue().size() > 0)
@@ -699,7 +709,7 @@ public class CassandraServer implements Cassandra.Iface
 
     public void system_rename_column_family(String keyspace, String old_name, String new_name) throws InvalidRequestException, TException
     {
-        checkLoginAuthorized(AccessLevel.FULL);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.FULL);
         
         // if there is anything going on in the migration stage, fail.
         if (StageManager.getStage(StageManager.MIGRATION_STAGE).getQueue().size() > 0)
@@ -727,7 +737,12 @@ public class CassandraServer implements Cassandra.Iface
 
     public void system_add_keyspace(KsDef ks_def) throws InvalidRequestException, TException
     {
-        
+        // IAuthenticator was devised prior to, and without thought for, dynamic keyspace creation. As
+        // a result, we must choose between letting anyone/everyone create keyspaces (which they likely
+        // won't even be able to use), or be honest and disallow it entirely if configured for auth.
+        if (!(DatabaseDescriptor.getAuthenticator() instanceof AllowAllAuthenticator))
+            throw new InvalidRequestException("Unable to create new keyspace while authentication is enabled.");
+
         // if there is anything going on in the migration stage, fail.
         if (StageManager.getStage(StageManager.MIGRATION_STAGE).getQueue().size() > 0)
             throw new InvalidRequestException("This node appears to be handling gossiped migrations.");
@@ -781,7 +796,7 @@ public class CassandraServer implements Cassandra.Iface
 
     public void system_drop_keyspace(String keyspace) throws InvalidRequestException, TException
     {
-        checkLoginAuthorized(AccessLevel.FULL);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.FULL);
         
         // if there is anything going on in the migration stage, fail.
         if (StageManager.getStage(StageManager.MIGRATION_STAGE).getQueue().size() > 0)
@@ -809,7 +824,7 @@ public class CassandraServer implements Cassandra.Iface
 
     public void system_rename_keyspace(String old_name, String new_name) throws InvalidRequestException, TException
     {
-        checkLoginAuthorized(AccessLevel.FULL);
+        checkKeyspaceAndLoginAuthorized(AccessLevel.FULL);
         
         // if there is anything going on in the migration stage, fail.
         if (StageManager.getStage(StageManager.MIGRATION_STAGE).getQueue().size() > 0)
@@ -835,5 +850,18 @@ public class CassandraServer implements Cassandra.Iface
         }
     }
 
+    public void set_keyspace(String keyspace) throws InvalidRequestException, TException {
+        if (DatabaseDescriptor.getTableDefinition(keyspace) == null)
+        {
+            throw new InvalidRequestException("Keyspace does not exist");
+        }
+        
+        // If switching, invalidate previous access level; force a new login.
+        if (keySpace.get() != null && !keySpace.get().equals(keyspace));
+            loginDone.set(AccessLevel.NONE);
+        
+        keySpace.set(keyspace); 
+    }
+
     // main method moved to CassandraDaemon
 }
diff --git a/test/system/test_thrift_server.py b/test/system/test_thrift_server.py
index 24b324a053..e465128a30 100644
--- a/test/system/test_thrift_server.py
+++ b/test/system/test_thrift_server.py
@@ -135,11 +135,8 @@ def _verify_range():
     result = client.get_slice('key1', ColumnParent('Standard1'), p, ConsistencyLevel.ONE)
     assert len(result) == 2, result
 
-def _login(keyspace, auth_request):
-    client.login(keyspace, auth_request)
-
-def _empty_login(keyspace):
-    client.login(keyspace, AuthenticationRequest({}))    
+def _set_keyspace(keyspace):
+    client.set_keyspace(keyspace)
 
 def _insert_super_range():
     client.insert('key1', ColumnParent('Super1', 'sc1'), Column(_i64(4), 'value4', 0), False)
@@ -198,24 +195,24 @@ ZERO_WAIT = 5
 
 class TestMutations(ThriftTester):
     def test_insert(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_simple(False)
         time.sleep(0.1)
         _verify_simple()
 
     def test_empty_slice(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         assert _big_slice('key1', ColumnParent('Standard2')) == []
         assert _big_slice('key1', ColumnParent('Super1')) == []
 
     def test_missing_super(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _expect_missing(lambda: client.get('key1', ColumnPath('Super1', 'sc1', _i64(1)), ConsistencyLevel.ONE))
         _insert_super()
         _expect_missing(lambda: client.get('key1', ColumnPath('Super1', 'sc1', _i64(1)), ConsistencyLevel.ONE))
 
     def test_count(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_simple()
         _insert_super()
         p = SlicePredicate(slice_range=SliceRange('', '', False, 1000))
@@ -233,23 +230,23 @@ class TestMutations(ThriftTester):
         assert client.get_count('key1', ColumnParent('Standard1'), p, ConsistencyLevel.ONE) == 3
 
     def test_insert_blocking(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_simple()
         _verify_simple()
 
     def test_super_insert(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_super()
         _verify_super()
 
     def test_super_get(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_super()
         result = client.get('key1', ColumnPath('Super1', 'sc2'), ConsistencyLevel.ONE).super_column
         assert result == _SUPER_COLUMNS[1], result
 
     def test_super_subcolumn_limit(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_super()
         p = SlicePredicate(slice_range=SliceRange('', '', False, 1))
         column_parent = ColumnParent('Super1', 'sc2')
@@ -262,7 +259,7 @@ class TestMutations(ThriftTester):
         assert slice == [Column(_i64(6), 'value6', 0)], slice
         
     def test_long_order(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         def long_xrange(start, stop, step):
             i = start
             while i < stop:
@@ -279,7 +276,7 @@ class TestMutations(ThriftTester):
     def test_time_uuid(self):
         import uuid
         L = []
-        _empty_login('Keyspace2')
+        _set_keyspace('Keyspace2')
         # 100 isn't enough to fail reliably if the comparator is borked
         for i in xrange(500):
             L.append(uuid.uuid1())
@@ -322,7 +319,7 @@ class TestMutations(ThriftTester):
     def test_long_remove(self):
         column_parent = ColumnParent('StandardLong1')
         sp = SlicePredicate(slice_range=SliceRange('', '', False, 1))
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         for i in xrange(10):
             parent = ColumnParent('StandardLong1')
 
@@ -337,18 +334,18 @@ class TestMutations(ThriftTester):
             assert slice == [Column(_i64(i), 'value2', 10 * i + 2)], (slice, i)
         
     def test_batch_insert(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_batch(False)
         time.sleep(0.1)
         _verify_batch()
 
     def test_batch_insert_blocking(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_batch(True)
         _verify_batch()
         
     def test_batch_mutate_standard_columns(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         column_families = ['Standard1', 'Standard2']
         keys = ['key_%d' % i for i in  range(27,32)] 
         mutations = [Mutation(ColumnOrSuperColumn(c)) for c in _SIMPLE_COLUMNS]
@@ -362,7 +359,7 @@ class TestMutations(ThriftTester):
                waitfor(ZERO_WAIT, _assert_column, column_family, key, 'c1', 'value1')
 
     def test_batch_mutate_standard_columns_blocking(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         
         column_families = ['Standard1', 'Standard2']
         keys = ['key_%d' % i for i in  range(38,46)]
@@ -378,7 +375,7 @@ class TestMutations(ThriftTester):
                 _assert_column(column_family, key, 'c1', 'value1')
 
     def test_batch_mutate_remove_standard_columns(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         column_families = ['Standard1', 'Standard2']
         keys = ['key_%d' % i for i in range(11,21)]
         _insert_multi(keys)
@@ -396,7 +393,7 @@ class TestMutations(ThriftTester):
                     _assert_no_columnpath(key, ColumnPath(column_family, column=c.name))
 
     def test_batch_mutate_remove_standard_row(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         column_families = ['Standard1', 'Standard2']
         keys = ['key_%d' % i for i in range(11,21)]
         _insert_multi(keys)
@@ -414,7 +411,7 @@ class TestMutations(ThriftTester):
                     _assert_no_columnpath(key, ColumnPath(column_family, column=c.name))
 
     def test_batch_mutate_remove_super_columns_with_standard_under(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         column_families = ['Super1', 'Super2']
         keys = ['key_%d' % i for i in range(11,21)]
         _insert_super()
@@ -438,7 +435,7 @@ class TestMutations(ThriftTester):
                         waitfor(ZERO_WAIT, _assert_no_columnpath, key, ColumnPath(column_family, super_column=sc.name, column=c.name))
 
     def test_batch_mutate_remove_super_columns_with_none_given_underneath(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         
         keys = ['key_%d' % i for i in range(17,21)]
 
@@ -468,7 +465,7 @@ class TestMutations(ThriftTester):
                     waitfor(ZERO_WAIT, _assert_no_columnpath, key, ColumnPath('Super1', super_column=sc.name))
     
     def test_batch_mutate_remove_super_columns_entire_row(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         
         keys = ['key_%d' % i for i in range(17,21)]
 
@@ -495,7 +492,7 @@ class TestMutations(ThriftTester):
             waitfor(ZERO_WAIT, _assert_no_columnpath, key, ColumnPath('Super1', super_column=sc.name))
 
     def test_batch_mutate_insertions_and_deletions(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         
         first_insert = SuperColumn("sc1",
                                    columns=[Column(_i64(20), 'value20', 3),
@@ -550,7 +547,7 @@ class TestMutations(ThriftTester):
 
     def test_batch_mutate_does_not_accept_cosc_and_deletion_in_same_mutation(self):
         def too_full():
-            _empty_login('Keyspace1')
+            _set_keyspace('Keyspace1')
             col = ColumnOrSuperColumn(column=Column("foo", 'bar', 0))
             dele = Deletion(2, predicate=SlicePredicate(column_names=['baz']))
             client.batch_mutate({'key_34': {'Standard1': [Mutation(col, dele)]}},
@@ -559,7 +556,7 @@ class TestMutations(ThriftTester):
 
     def test_batch_mutate_does_not_yet_accept_slice_ranges(self):
         def send_range():
-            _empty_login('Keyspace1')
+            _set_keyspace('Keyspace1')
             sp = SlicePredicate(slice_range=SliceRange(start='0', finish="", count=10))
             d = Deletion(2, predicate=sp)
             client.batch_mutate({'key_35': {'Standard1':[Mutation(deletion=d)]}},
@@ -567,7 +564,7 @@ class TestMutations(ThriftTester):
         _expect_exception(send_range, InvalidRequestException)
 
     def test_column_name_lengths(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _expect_exception(lambda: client.insert('key1', ColumnParent('Standard1'), Column('', 'value', 0), ConsistencyLevel.ONE), InvalidRequestException)
         client.insert('key1', ColumnParent('Standard1'), Column('x'*1, 'value', 0), ConsistencyLevel.ONE)
         client.insert('key1', ColumnParent('Standard1'), Column('x'*127, 'value', 0), ConsistencyLevel.ONE)
@@ -580,7 +577,7 @@ class TestMutations(ThriftTester):
         _expect_exception(lambda: client.insert('key1', ColumnParent('Standard1'), Column('x'*(2**16), 'value', 0), ConsistencyLevel.ONE), InvalidRequestException)
 
     def test_bad_calls(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         # missing arguments
         _expect_exception(lambda: client.insert(None, None, None, None), TApplicationException)
         # supercolumn in a non-super CF
@@ -632,7 +629,7 @@ class TestMutations(ThriftTester):
                           InvalidRequestException)
 
     def test_batch_insert_super(self):
-         _empty_login('Keyspace1')
+         _set_keyspace('Keyspace1')
          cfmap = {'Super1': [ColumnOrSuperColumn(super_column=c) for c in _SUPER_COLUMNS],
                   'Super2': [ColumnOrSuperColumn(super_column=c) for c in _SUPER_COLUMNS]}
          client.batch_insert('key1', cfmap, ConsistencyLevel.ZERO)
@@ -640,7 +637,7 @@ class TestMutations(ThriftTester):
          waitfor(ZERO_WAIT, _verify_super, 'Super2')
 
     def test_batch_insert_super_blocking(self):
-         _empty_login('Keyspace1')
+         _set_keyspace('Keyspace1')
          cfmap = {'Super1': [ColumnOrSuperColumn(super_column=c) for c in _SUPER_COLUMNS],
                   'Super2': [ColumnOrSuperColumn(super_column=c) for c in _SUPER_COLUMNS]}
          client.batch_insert('key1', cfmap, ConsistencyLevel.ONE)
@@ -648,7 +645,7 @@ class TestMutations(ThriftTester):
          _verify_super('Super2')
 
     def test_cf_remove_column(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_simple()
         client.remove('key1', ColumnPath('Standard1', column='c1'), 1, ConsistencyLevel.ONE)
         _expect_missing(lambda: client.get('key1', ColumnPath('Standard1', column='c1'), ConsistencyLevel.ONE))
@@ -677,7 +674,7 @@ class TestMutations(ThriftTester):
 
 
     def test_cf_remove(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         
         _insert_simple()
         _insert_super()
@@ -703,7 +700,7 @@ class TestMutations(ThriftTester):
 
 
     def test_super_cf_remove_column(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_simple()
         _insert_super()
 
@@ -742,7 +739,7 @@ class TestMutations(ThriftTester):
         assert super_columns == super_columns_expected, super_columns
 
     def test_super_cf_remove_supercolumn(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         
         _insert_simple()
         _insert_super()
@@ -781,7 +778,7 @@ class TestMutations(ThriftTester):
 
 
     def test_super_cf_resurrect_subcolumn(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         key = 'vijay'
         client.insert(key, ColumnParent('Super1', 'sc1'), Column(_i64(4), 'value4', 0), ConsistencyLevel.ONE)
 
@@ -794,13 +791,13 @@ class TestMutations(ThriftTester):
 
 
     def test_empty_range(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         assert client.get_range_slice(ColumnParent('Standard1'), SlicePredicate(column_names=['c1', 'c1']), '', '', 1000, ConsistencyLevel.ONE) == []
         _insert_simple()
         assert client.get_range_slice(ColumnParent('Super1'), SlicePredicate(column_names=['c1', 'c1']), '', '', 1000, ConsistencyLevel.ONE) == []
 
     def test_range_with_remove(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_simple()
         assert client.get_range_slice(ColumnParent('Standard1'), SlicePredicate(column_names=['c1', 'c1']), 'key1', '', 1000, ConsistencyLevel.ONE)[0].key == 'key1'
 
@@ -810,7 +807,7 @@ class TestMutations(ThriftTester):
         assert actual == [KeySlice(columns=[], key='key1')], actual
 
     def test_range_with_remove_cf(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_simple()
         assert client.get_range_slice(ColumnParent('Standard1'), SlicePredicate(column_names=['c1', 'c1']), 'key1', '', 1000, ConsistencyLevel.ONE)[0].key == 'key1'
 
@@ -819,7 +816,7 @@ class TestMutations(ThriftTester):
         assert actual == [KeySlice(columns=[], key='key1')], actual
 
     def test_range_collation(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         for key in ['-a', '-b', 'a', 'b'] + [str(i) for i in xrange(100)]:
             client.insert(key, ColumnParent('Standard1'), Column(key, 'v', 0), ConsistencyLevel.ONE)
 
@@ -831,7 +828,7 @@ class TestMutations(ThriftTester):
             assert key == ks.key
 
     def test_range_partial(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         
         for key in ['-a', '-b', 'a', 'b'] + [str(i) for i in xrange(100)]:
             client.insert(key, ColumnParent('Standard1'), Column(key, 'v', 0), ConsistencyLevel.ONE)
@@ -854,17 +851,17 @@ class TestMutations(ThriftTester):
         check_slices_against_keys(['1', '10', '11', '12', '13', '14', '15', '16', '17', '18'], slices)
 
     def test_get_slice_range(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_range()
         _verify_range()
         
     def test_get_slice_super_range(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_super_range()
         _verify_super_range()
 
     def test_get_range_slices_tokens(self):
-        _empty_login('Keyspace2')
+        _set_keyspace('Keyspace2')
         for key in ['key1', 'key2', 'key3', 'key4', 'key5']:
             for cname in ['col1', 'col2', 'col3', 'col4', 'col5']:
                 client.insert(key, ColumnParent('Super3', 'sc1'), Column(cname, 'v-' + cname, 0), ConsistencyLevel.ONE)
@@ -878,7 +875,7 @@ class TestMutations(ThriftTester):
         assert result[0].columns[1].column.name == 'col3'
 
     def test_get_range_slice_super(self):
-        _empty_login('Keyspace2')
+        _set_keyspace('Keyspace2')
         for key in ['key1', 'key2', 'key3', 'key4', 'key5']:
             for cname in ['col1', 'col2', 'col3', 'col4', 'col5']:
                 client.insert(key, ColumnParent('Super3', 'sc1'), Column(cname, 'v-' + cname, 0), ConsistencyLevel.ONE)
@@ -895,7 +892,7 @@ class TestMutations(ThriftTester):
         assert list(set(row.columns[0].super_column.name for row in result))[0] == 'sc1'
         
     def test_get_range_slice(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         for key in ['key1', 'key2', 'key3', 'key4', 'key5']:
             for cname in ['col1', 'col2', 'col3', 'col4', 'col5']:
                 client.insert(key, ColumnParent('Standard1'), Column(cname, 'v-' + cname, 0), ConsistencyLevel.ONE)
@@ -951,7 +948,7 @@ class TestMutations(ThriftTester):
         
     
     def test_get_slice_by_names(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_range()
         p = SlicePredicate(column_names=['c1', 'c2'])
         result = client.get_slice('key1', ColumnParent('Standard1'), p, ConsistencyLevel.ONE) 
@@ -968,7 +965,7 @@ class TestMutations(ThriftTester):
     def test_multiget_slice(self):
         """Insert multiple keys and retrieve them using the multiget_slice interface"""
 
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         # Generate a list of 10 keys and insert them
         num_keys = 10
         keys = ['key'+str(i) for i in range(1, num_keys+1)]
@@ -987,7 +984,7 @@ class TestMutations(ThriftTester):
 
     def test_multi_count(self):
         """Insert multiple keys and count them using the multiget interface"""
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
 
         # Generate a list of 10 keys countaining 1 to 10 columns and insert them
         num_keys = 10
@@ -1007,7 +1004,7 @@ class TestMutations(ThriftTester):
           assert counts[key] == i
 
     def test_batch_mutate_super_deletion(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         _insert_super('test')
         d = Deletion(1, predicate=SlicePredicate(column_names=['sc1']))
         cfmap = {'Super1': [Mutation(deletion=d)]}
@@ -1016,7 +1013,7 @@ class TestMutations(ThriftTester):
         _expect_missing(lambda: client.get('key1', ColumnPath('Super1', 'sc1'), ConsistencyLevel.ONE))
 
     def test_super_reinsert(self):
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         for x in xrange(3):
             client.insert('key1', ColumnParent('Super1', 'sc2'), Column(_i64(x), 'value', 1), ConsistencyLevel.ONE)
 
@@ -1055,7 +1052,7 @@ class TestMutations(ThriftTester):
         newks = client.describe_keyspace('CreateKeyspace')
         assert 'CreateKsCf' in newks
         
-        _empty_login('CreateKeyspace')
+        _set_keyspace('CreateKeyspace')
         
         # rename
         client.system_rename_keyspace('CreateKeyspace', 'RenameKeyspace')
@@ -1073,7 +1070,7 @@ class TestMutations(ThriftTester):
 
     def test_system_column_family_operations(self):
         """ Test cf (add, drop, rename) operations """
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         # create
         newcf = CfDef('Keyspace1', 'NewColumnFamily')
         client.system_add_column_family(newcf)
@@ -1095,14 +1092,14 @@ class TestMutations(ThriftTester):
 
     def test_insert_ttl(self):
         """ Test simple insertion of a column with ttl """
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         column = Column('cttl1', 'value1', 0, 5)
         client.insert('key1', ColumnParent('Standard1'), column, ConsistencyLevel.ONE)
         assert client.get('key1', ColumnPath('Standard1', column='cttl1'), ConsistencyLevel.ONE).column == column
 
     def test_simple_expiration(self):
         """ Test that column ttled do expires """
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         column = Column('cttl3', 'value1', 0, 2)
         client.insert('key1', ColumnParent('Standard1'), column, ConsistencyLevel.ONE)
         time.sleep(1)
@@ -1114,7 +1111,7 @@ class TestMutations(ThriftTester):
 
     def test_update_expiring(self):
         """ Test that updating a column with ttl override the ttl """
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         column1 = Column('cttl4', 'value1', 0, 1)
         client.insert('key1', ColumnParent('Standard1'), column1, ConsistencyLevel.ONE)
         column2 = Column('cttl4', 'value1', 1)
@@ -1124,7 +1121,7 @@ class TestMutations(ThriftTester):
 
     def test_remove_expiring(self):
         """ Test removing a column with ttl """
-        _empty_login('Keyspace1')
+        _set_keyspace('Keyspace1')
         column = Column('cttl5', 'value1', 0, 10)
         client.insert('key1', ColumnParent('Standard1'), column, ConsistencyLevel.ONE)
         client.remove('key1', ColumnPath('Standard1', column='cttl5'), 1, ConsistencyLevel.ONE)
diff --git a/test/unit/org/apache/cassandra/client/TestRingCache.java b/test/unit/org/apache/cassandra/client/TestRingCache.java
index a1e0c8a416..19f2724eb5 100644
--- a/test/unit/org/apache/cassandra/client/TestRingCache.java
+++ b/test/unit/org/apache/cassandra/client/TestRingCache.java
@@ -104,7 +104,7 @@ public class TestRingCache
 
             // now, read the row back directly from the host owning the row locally
             tester.setup(endpoints.get(0).getHostAddress(), DatabaseDescriptor.getRpcPort());
-            tester.thriftClient.login(keyspace, new AuthenticationRequest(new HashMap<String,String>()));
+            tester.thriftClient.set_keyspace(keyspace);
             tester.thriftClient.insert(row, parent, new Column("col1".getBytes(), "val1".getBytes(), 1), ConsistencyLevel.ONE);
             Column column = tester.thriftClient.get(row, col, ConsistencyLevel.ONE).column;
             System.out.println("read row " + new String(row) + " " + new String(column.name) + ":" + new String(column.value) + ":" + column.timestamp);
diff --git a/test/unit/org/apache/cassandra/service/EmbeddedCassandraServiceTest.java b/test/unit/org/apache/cassandra/service/EmbeddedCassandraServiceTest.java
index 890c1a5933..c7031509e0 100644
--- a/test/unit/org/apache/cassandra/service/EmbeddedCassandraServiceTest.java
+++ b/test/unit/org/apache/cassandra/service/EmbeddedCassandraServiceTest.java
@@ -96,7 +96,7 @@ public class EmbeddedCassandraServiceTest
             UnavailableException, TimedOutException, TException, NotFoundException
     {
         Cassandra.Client client = getClient();
-        client.login("Keyspace1", new AuthenticationRequest(new HashMap<String, String>()));
+        client.set_keyspace("Keyspace1");
 
         byte[] key_user_id = "1".getBytes();
 
