diff --git a/src/java/org/apache/cassandra/db/rows/TombstoneFilteringRow.java b/src/java/org/apache/cassandra/db/rows/TombstoneFilteringRow.java
index a1c0ddcfd2..a6167ea8fa 100644
--- a/src/java/org/apache/cassandra/db/rows/TombstoneFilteringRow.java
+++ b/src/java/org/apache/cassandra/db/rows/TombstoneFilteringRow.java
@@ -29,6 +29,12 @@ public class TombstoneFilteringRow extends FilteringRow
         this.nowInSec = nowInSec;
     }
 
+    @Override
+    protected boolean include (LivenessInfo info)
+    {
+        return info.isLive(nowInSec);
+    }
+
     @Override
     protected boolean include(DeletionTime dt)
     {
diff --git a/src/java/org/apache/cassandra/service/DataResolver.java b/src/java/org/apache/cassandra/service/DataResolver.java
index b2d195446e..f164a607d9 100644
--- a/src/java/org/apache/cassandra/service/DataResolver.java
+++ b/src/java/org/apache/cassandra/service/DataResolver.java
@@ -123,9 +123,17 @@ public class DataResolver extends ResponseResolver
 
         private boolean isReversed(List<UnfilteredRowIterator> versions)
         {
-            assert !versions.isEmpty();
-            // Everything will be in the same order
-            return versions.get(0).isReverseOrder();
+            for (UnfilteredRowIterator iter : versions)
+            {
+                if (iter == null)
+                    continue;
+
+                // Everything will be in the same order
+                return iter.isReverseOrder();
+            }
+
+            assert false : "Expected at least one iterator";
+            return false;
         }
 
         public void close()
diff --git a/test/unit/org/apache/cassandra/cql3/validation/operations/InsertUpdateIfConditionTest.java b/test/unit/org/apache/cassandra/cql3/validation/operations/InsertUpdateIfConditionTest.java
index 522495ca33..055c9d959c 100644
--- a/test/unit/org/apache/cassandra/cql3/validation/operations/InsertUpdateIfConditionTest.java
+++ b/test/unit/org/apache/cassandra/cql3/validation/operations/InsertUpdateIfConditionTest.java
@@ -166,6 +166,13 @@ public class InsertUpdateIfConditionTest extends CQLTester
         assertRows(execute("DELETE v1 FROM %s WHERE k=3 IF EXISTS"), row(true));
         assertRows(execute("DELETE FROM %s WHERE k=3 IF EXISTS"), row(true));
 
+        execute("INSERT INTO %s (k, v1) VALUES (4, 2)");
+        execute("UPDATE %s USING TTL 1 SET v1=2 WHERE k=4");
+        Thread.sleep(1001);
+        assertRows(execute("SELECT * FROM %s WHERE k=4"), row(4, null));
+        assertRows(execute("DELETE FROM %s WHERE k=4 IF EXISTS"), row(true));
+        assertEmpty(execute("SELECT * FROM %s WHERE k=4"));
+
         // static columns
         createTable("CREATE TABLE %s (k text, s text static, i int, v text, PRIMARY KEY (k, i) )");
 
