diff --git a/CHANGES.txt b/CHANGES.txt
index 7980855aff..9458627a86 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 2.1.4
+ * Fix CommitLog.forceRecycleAllSegments() memory access error (CASSANDRA-8812)
  * Improve assertions in Memory (CASSANDRA-8792)
  * Fix SSTableRewriter cleanup (CASSANDRA-8802)
  * Introduce SafeMemory for CompressionMetadata.Writer (CASSANDRA-8758)
diff --git a/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java b/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java
index a70327bc62..2ea8701b97 100644
--- a/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java
+++ b/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java
@@ -322,7 +322,7 @@ public class CommitLogSegment
 
             CLibrary.trySkipCache(fd, offset, nextMarker);
             if (close)
-                close();
+                internalClose();
         }
         catch (Exception e) // MappedByteBuffer.force() does not declare IOException but can actually throw it
         {
@@ -409,7 +409,15 @@ public class CommitLogSegment
     /**
      * Close the segment file.
      */
-    void close()
+    synchronized void close()
+    {
+        discardUnusedTail();
+        waitForModifications();
+        lastSyncedOffset = buffer.capacity();
+        internalClose();
+    }
+
+    void internalClose()
     {
         try
         {
