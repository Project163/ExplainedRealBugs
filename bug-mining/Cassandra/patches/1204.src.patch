diff --git a/CHANGES.txt b/CHANGES.txt
index 8857e8cb51..a8fb6c6b9b 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,5 +1,6 @@
 0.8.8
  * fix truncate allowing data to be replayed post-restart (CASSANDRA-3297)
+ * make iwriter final in IndexWriter to avoid NPE (CASSANDRA-2863)
 
 
 0.8.7
diff --git a/src/java/org/apache/cassandra/io/sstable/SSTableWriter.java b/src/java/org/apache/cassandra/io/sstable/SSTableWriter.java
index 17eaddeb92..6a181aeaae 100644
--- a/src/java/org/apache/cassandra/io/sstable/SSTableWriter.java
+++ b/src/java/org/apache/cassandra/io/sstable/SSTableWriter.java
@@ -302,19 +302,18 @@ public class SSTableWriter extends SSTable
         {
             if (cfs.isInvalid())
                 return null;
-            maybeOpenIndexer();
 
             File ifile = new File(desc.filenameFor(SSTable.COMPONENT_INDEX));
             File ffile = new File(desc.filenameFor(SSTable.COMPONENT_FILTER));
             assert !ifile.exists();
             assert !ffile.exists();
 
-            long estimatedRows = indexer.prepareIndexing();
+            maybeOpenIndexer();
 
             // build the index and filter
             long rows = indexer.index();
 
-            logger.debug("estimated row count was {} of real count", ((double)estimatedRows) / rows);
+            logger.debug("estimated row count was {} of real count", ((double)indexer.estimatedRows) / rows);
             return SSTableReader.open(rename(desc, SSTable.componentsFor(desc, false)));
         }
     }
@@ -324,8 +323,9 @@ public class SSTableWriter extends SSTable
         protected final Descriptor desc;
         public final BufferedRandomAccessFile dfile;
         private final OperationType type;
+        protected final IndexWriter iwriter;
+        public final long estimatedRows;
 
-        protected IndexWriter iwriter;
         protected ColumnFamilyStore cfs;
 
         RowIndexer(Descriptor desc, ColumnFamilyStore cfs, OperationType type) throws IOException
@@ -339,16 +339,11 @@ public class SSTableWriter extends SSTable
             this.dfile = dfile;
             this.type = type;
             this.cfs = cfs;
-        }
 
-        long prepareIndexing() throws IOException
-        {
-            long estimatedRows;
             try
             {
-                estimatedRows = SSTable.estimateRowsFromData(desc, dfile);
-                iwriter = new IndexWriter(desc, StorageService.getPartitioner(), estimatedRows);
-                return estimatedRows;
+                this.estimatedRows = SSTable.estimateRowsFromData(desc, dfile);
+                this.iwriter = new IndexWriter(desc, StorageService.getPartitioner(), estimatedRows);
             }
             catch(IOException e)
             {
