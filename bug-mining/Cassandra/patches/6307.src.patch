diff --git a/.build/build-rat.xml b/.build/build-rat.xml
index 6cc7943ba5..eb341c3024 100644
--- a/.build/build-rat.xml
+++ b/.build/build-rat.xml
@@ -27,7 +27,7 @@
     </target>
 
     <target name="_build_ratinclude" depends="_rat_init">
-        <exec executable="git" failifexecutionfails="false" failonerror="false" resultproperty="git.success" output="${build.dir}/.versioned_files">
+        <exec executable="git" failifexecutionfails="false" failonerror="false" resultproperty="git.success" output="${build.dir}/.ratinclude">
             <arg line="ls-tree -r HEAD --name-only"/>
         </exec>
         <condition property="rat.skip" value="true">
@@ -37,43 +37,55 @@
         </condition>
     </target>
 
-    <target name="_rat_copy_versioned_files" depends="_build_ratinclude" unless="${rat.skip}">
-        <copy file="${build.dir}/.versioned_files" tofile="${build.dir}/.ratinclude">
-            <filterchain>
-                <linecontainsregexp>
-                    <regexp pattern=".*\.(java|py|sh|xml|spec|md|iml|bat|btm|cql|css|g|html|jflex|jks|mod|name|pom|textile|yml|yaml|MIDRES|HIGHRES|LOWRES)$"/>
-                </linecontainsregexp>
-            </filterchain>
-        </copy>
-    </target>
-
-    <target name="rat-check" depends="_rat_copy_versioned_files" unless="${rat.skip}" description="License checks on source" >
+    <target name="rat-check" depends="_build_ratinclude" unless="${rat.skip}" description="License checks on source" >
         <rat:report reportFile="${build.dir}/rat.txt">
             <fileset dir="." includesfile="${build.dir}/.ratinclude">
                 <!-- Config files with not much creativity -->
-                <exclude name="**/ide/**/*"/>
-                <exclude name="**/metrics-reporter-config-sample.yaml"/>
-                <exclude name="**/cassandra.yaml"/>
-                <exclude name="**/cassandra-murmur.yaml"/>
-                <exclude name="**/cassandra-seeds.yaml"/>
-                <exclude name="**/test/conf/cassandra.yaml"/>
-                <exclude name="**/test/conf/cassandra_encryption.yaml"/>
-                <exclude name="**/test/conf/cdc.yaml"/>
-                <exclude name="**/test/conf/commitlog_compression_LZ4.yaml"/>
-                <exclude name="**/test/conf/commitlog_compression_Zstd.yaml"/>
-                <exclude name="**/test/conf/system_keyspaces_directory.yaml"/>
-                <exclude name="**/test/conf/unit-test-conf/test-native-port.yaml"/>
-                <exclude name="**/test/data/jmxdump/cassandra-3.0-jmx.yaml"/>
-                <exclude name="**/test/data/jmxdump/cassandra-3.11-jmx.yaml"/>
-                <exclude name="**/test/data/jmxdump/cassandra-4.0-jmx.yaml"/>
-                <exclude name="**/tools/cqlstress-counter-example.yaml"/>
-                <exclude name="**/tools/cqlstress-example.yaml"/>
-                <exclude name="**/tools/cqlstress-insanity-example.yaml"/>
-                <exclude name="**/tools/cqlstress-lwt-example.yaml"/>
-                <!-- NOTICE files -->
-                <exclude NAME="**/NOTICE.md"/>
-                <!-- LICENSE files -->
-                <exclude NAME="**/LICENSE.md"/>
+                 <exclude name="ide/**/*"/>
+                 <exclude name="conf/metrics-reporter-config-sample.yaml"/>
+                 <exclude name="**/cassandra*.yaml"/>
+                 <exclude NAME="doc/antora.yml"/>
+                 <exclude NAME="eclipse_compiler.properties"/>
+                 <exclude name="test/conf/cdc.yaml"/>
+                 <exclude name="pylib/cqlshlib/test/config/sslhandling*.config"/>
+                 <exclude name="test/conf/commitlog_compression_*.yaml"/>
+                 <exclude name="test/conf/system_keyspaces_directory.yaml"/>
+                 <exclude name="test/conf/unit-test-conf/test-native-port.yaml"/>
+                 <exclude name="tools/cqlstress-*.yaml"/>
+                 <!-- test data -->
+                 <exclude name="test/**/cassandra*.conf"/>
+                 <exclude name="test/**/*.csv"/>
+                 <exclude name="test/**/*.json"/>
+                 <exclude name="test/**/*.txt"/>
+                 <exclude name="test/data/**/*.adler32"/>
+                 <exclude name="test/data/**/*.crc32"/>
+                 <exclude name="test/data/**/CommitLog-*.log"/>
+                 <exclude name="test/data/**/*.bin"/>
+                 <exclude name="test/data/**/*.db"/>
+                 <exclude name="test/data/**/*.sha1"/>
+                 <exclude name="test/data/CASSANDRA-15313/lz4-jvm-crash-failure.txt"/>
+                 <exclude name="test/data/jmxdump/cassandra-*-jmx.yaml"/>
+                 <!-- Documentation files -->
+                 <exclude NAME="src/java/**/*.md"/>
+                 <exclude NAME="**/README*"/>
+                 <exclude NAME="CHANGES.txt"/>
+                 <exclude NAME="CASSANDRA-14092.txt"/>
+                 <!-- legal files -->
+                 <exclude NAME="NOTICE.txt"/>
+                 <exclude NAME="LICENSE.txt"/>
+                 <!-- misc -->
+                 <exclude NAME="**/*.patch"/>
+                 <exclude NAME="**/*.dpatch"/>
+                 <exclude NAME="**/*.diff"/>
+                 <exclude NAME="debian/TODO"/>
+                 <exclude NAME="debian/cassandra.bash-completion"/>
+                 <exclude NAME="debian/cassandra-sysctl.conf"/>
+                 <exclude NAME="debian/cassandra.install"/>
+                 <exclude NAME="debian/cassandra-tools.install"/>
+                 <exclude NAME="debian/compat"/>
+                 <exclude NAME="debian/control"/>
+                 <exclude NAME="debian/dirs"/>
+                 <exclude NAME="debian/patches/00list"/>
             </fileset>
         </rat:report>
         <exec executable="grep" outputproperty="rat.failed.files" failifexecutionfails="false">
diff --git a/.jenkins/Jenkinsfile b/.jenkins/Jenkinsfile
index 4ea5de3e8a..3f796242d7 100644
--- a/.jenkins/Jenkinsfile
+++ b/.jenkins/Jenkinsfile
@@ -6,14 +6,13 @@
 // "License"); you may not use this file except in compliance
 // with the License.  You may obtain a copy of the License at
 //
-//    https://www.apache.org/licenses/LICENSE-2.0
+//     http://www.apache.org/licenses/LICENSE-2.0
 //
-// Unless required by applicable law or agreed to in writing,
-// software distributed under the License is distributed on an
-// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
-// KIND, either express or implied.  See the License for the
-// specific language governing permissions and limitations
-// under the License.
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// Se# Licensed to the Apache Software Foundation (ASF) under onee the License for the specific language governing permissions and
+// limitations under the License.
 //
 //
 // Jenkins declaration of how to build and test the current codebase.
diff --git a/LICENSE.txt b/LICENSE.txt
index d5c4984908..e31209c0ec 100644
--- a/LICENSE.txt
+++ b/LICENSE.txt
@@ -202,8 +202,12 @@
    limitations under the License.
 
 
-THIRD-PARTY DEPENDENCIES
-========================
-Convenience copies of some third-party dependencies are distributed with
-Apache Cassandra as Java jar files in lib/. Licensing information for
-these files can be found in the lib/licenses directory.
+   APACHE CASSANDRA SUBCOMPONENTS:
+
+   Apache Cassandra includes a number of subcomponents with
+   separate copyright notices and license terms. Your use of the source
+   code for these subcomponents is subject to the terms and
+   conditions of the following licenses.
+
+   This product bundles a file (VIntCoding.java) from Protocol Buffers
+   copyright Google Inc., which is available under a BSD license.
diff --git a/build.properties.default b/build.properties.default
index 11da534e32..29042a43f0 100644
--- a/build.properties.default
+++ b/build.properties.default
@@ -1,4 +1,23 @@
+#
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
+#
 # Maven2 Repository Locations (you can override these in "build.properties" to point to a local proxy, e.g. Nexus)
+#
 artifact.remoteRepository.central:     https://repo1.maven.org/maven2
 artifact.remoteRepository.apache:      https://repo.maven.apache.org/maven2
 
diff --git a/conf/jvm.options b/conf/jvm.options
index eb2ad19e43..1e0333de9b 100644
--- a/conf/jvm.options
+++ b/conf/jvm.options
@@ -1,3 +1,21 @@
+#
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
+#
 ###########################################################################
 #                             jvm.options                                 #
 #                                                                         #
diff --git a/debian/cassandra-sysctl.conf b/debian/cassandra-sysctl.conf
index 443e83f81c..983829fd3c 100644
--- a/debian/cassandra-sysctl.conf
+++ b/debian/cassandra-sysctl.conf
@@ -1,2 +1,18 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 vm.max_map_count = 1048575
 net.ipv4.tcp_keepalive_time=300
diff --git a/debian/cassandra.conf b/debian/cassandra.conf
index 72ede9ed0b..d310d78f2c 100644
--- a/debian/cassandra.conf
+++ b/debian/cassandra.conf
@@ -1,3 +1,19 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 # Provided by the cassandra package
 cassandra  -  memlock  unlimited
 cassandra  -  nofile   100000
diff --git a/debian/cassandra.postinst b/debian/cassandra.postinst
index 752ff1f6bb..5862036efe 100644
--- a/debian/cassandra.postinst
+++ b/debian/cassandra.postinst
@@ -1,4 +1,20 @@
 #!/bin/sh
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 # postinst script for cassandra
 
 set -e
diff --git a/debian/default b/debian/default
index 1b56a980fd..1700a2dc28 100644
--- a/debian/default
+++ b/debian/default
@@ -1,3 +1,19 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 # NOTICE: See also /etc/cassandra/cassandra-env.sh
 
 # EXTRA_CLASSPATH provides the means to extend Cassandra's classpath with
diff --git a/debian/init b/debian/init
index 79a9a52e94..4f3f4370d4 100644
--- a/debian/init
+++ b/debian/init
@@ -1,4 +1,20 @@
 #! /bin/sh
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 ### BEGIN INIT INFO
 # Provides:          cassandra
 # Required-Start:    $remote_fs $network $named $time
diff --git a/debian/nodetool-completion b/debian/nodetool-completion
index f6f3d5b2ba..4318eb941d 100644
--- a/debian/nodetool-completion
+++ b/debian/nodetool-completion
@@ -1,3 +1,19 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 have nodetool && have cqlsh &&
 {
 
diff --git a/debian/rules b/debian/rules
index 9cd7f3e451..0528ff2acb 100755
--- a/debian/rules
+++ b/debian/rules
@@ -1,5 +1,20 @@
 #!/usr/bin/make -f
-
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 # Uncomment to enable verbose mode.
 #export DH_VERBOSE=1
 
diff --git a/pylib/cqlshlib/setup.cfg b/pylib/cqlshlib/setup.cfg
index 6c523ee93e..4b405c542d 100644
--- a/pylib/cqlshlib/setup.cfg
+++ b/pylib/cqlshlib/setup.cfg
@@ -1,3 +1,19 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 [nosetests]
 verbosity=3
 detailed-errors=1
diff --git a/pylib/requirements.txt b/pylib/requirements.txt
index a9b62177f5..d3ca29f34d 100644
--- a/pylib/requirements.txt
+++ b/pylib/requirements.txt
@@ -1,3 +1,20 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
+#
 # See python driver docs: futures and six have to be installed before
 # cythonizing the driver, perhaps only on old pips.
 # http://datastax.github.io/python-driver/installation.html#cython-based-extensions
diff --git a/redhat/cassandra b/redhat/cassandra
index 97a0447435..41e7d03b9b 100644
--- a/redhat/cassandra
+++ b/redhat/cassandra
@@ -1,4 +1,20 @@
 #!/bin/bash
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 #
 # /etc/init.d/cassandra
 #
diff --git a/redhat/cassandra.conf b/redhat/cassandra.conf
index a5aebe103a..518e3b0e58 100644
--- a/redhat/cassandra.conf
+++ b/redhat/cassandra.conf
@@ -1,3 +1,19 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 cassandra - memlock unlimited
 cassandra - nofile 100000
 cassandra - nproc 32768
diff --git a/redhat/default b/redhat/default
index 1b56a980fd..1700a2dc28 100644
--- a/redhat/default
+++ b/redhat/default
@@ -1,3 +1,19 @@
+# Licensed to the Apache Software Foundation (ASF) under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  The ASF licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
 # NOTICE: See also /etc/cassandra/cassandra-env.sh
 
 # EXTRA_CLASSPATH provides the means to extend Cassandra's classpath with
diff --git a/src/resources/org/apache/cassandra/cql3/functions/JavaSourceUDF.txt b/src/resources/org/apache/cassandra/cql3/functions/JavaSourceUDF.txt
index 4bd3601091..e4d5ca2ca1 100644
--- a/src/resources/org/apache/cassandra/cql3/functions/JavaSourceUDF.txt
+++ b/src/resources/org/apache/cassandra/cql3/functions/JavaSourceUDF.txt
@@ -1,3 +1,20 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
 package #package_name#;
 
 import java.nio.ByteBuffer;
