diff --git a/CHANGES.txt b/CHANGES.txt
index 4d41f0c741..f44ee6978e 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,3 +1,7 @@
+0.8.5
+ * fix NPE when encryption_options is unspecified (CASSANDRA-3007)
+
+
 0.8.4
  * include files-to-be-streamed in StreamInSession.getSources (CASSANDRA-2972)
  * use JAVA env var in cassandra-env.sh (CASSANDRA-2785, 2992)
diff --git a/src/java/org/apache/cassandra/net/MessagingService.java b/src/java/org/apache/cassandra/net/MessagingService.java
index c4b041705f..c35a3c0a09 100644
--- a/src/java/org/apache/cassandra/net/MessagingService.java
+++ b/src/java/org/apache/cassandra/net/MessagingService.java
@@ -417,7 +417,8 @@ public final class MessagingService implements MessagingServiceMBean
     public void stream(StreamHeader header, InetAddress to)
     {
         /* Streaming asynchronously on streamExector_ threads. */
-        if (DatabaseDescriptor.getEncryptionOptions().internode_encryption == EncryptionOptions.InternodeEncryption.all)
+        EncryptionOptions encryption = DatabaseDescriptor.getEncryptionOptions();
+        if (encryption != null && encryption.internode_encryption == EncryptionOptions.InternodeEncryption.all)
             streamExecutor_.execute(new SSLFileStreamTask(header, to));
         else
             streamExecutor_.execute(new FileStreamTask(header, to));
