diff --git a/CHANGES.txt b/CHANGES.txt
index 6baaa204fc..5e370ed7e8 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -8,7 +8,7 @@
  * removed in-tree redhat spec (CASSANDRA-3567)
  * "defragment" rows for name-based queries under STCS, again (CASSANDRA-2503)
  * Recycle commitlog segments for improved performance 
-   (CASSANDRA-3411, 3543, 3557)
+   (CASSANDRA-3411, 3543, 3557, 3615)
  * update size-tiered compaction to prioritize small tiers (CASSANDRA-2407)
  * add message expiration logic to OutboundTcpConnection (CASSANDRA-3005)
  * off-heap cache to use sun.misc.Unsafe instead of JNA (CASSANDRA-3271)
diff --git a/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java b/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java
index 9537e6ba42..d979a48f14 100644
--- a/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java
+++ b/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java
@@ -255,9 +255,12 @@ public class CommitLogSegment
         checksum.update(serializedRow);
         buffer.putLong(checksum.getValue());
 
-        // writes end of segment marker and rewinds back to position where it starts
-        buffer.putInt(CommitLog.END_OF_SEGMENT_MARKER);
-        buffer.position(buffer.position() - CommitLog.END_OF_SEGMENT_MARKER_SIZE);
+        if (buffer.remaining() >= 4)
+        {
+            // writes end of segment marker and rewinds back to position where it starts
+            buffer.putInt(CommitLog.END_OF_SEGMENT_MARKER);
+            buffer.position(buffer.position() - CommitLog.END_OF_SEGMENT_MARKER_SIZE);
+        }
 
         needsSync = true;
         return repPos;
diff --git a/test/unit/org/apache/cassandra/db/CommitLogTest.java b/test/unit/org/apache/cassandra/db/CommitLogTest.java
index 27cabbe938..83f780cc6c 100644
--- a/test/unit/org/apache/cassandra/db/CommitLogTest.java
+++ b/test/unit/org/apache/cassandra/db/CommitLogTest.java
@@ -159,6 +159,17 @@ public class CommitLogTest extends CleanupHelper
         assert CommitLog.instance.activeSegments() == 1 : "Expecting 1 segment, got " + CommitLog.instance.activeSegments();
     }
 
+    // CASSANDRA-3615
+    @Test
+    public void testExceedSegmentSizeWithOverhead() throws Exception
+    {
+        CommitLog.instance.resetUnsafe();
+        
+        RowMutation rm = new RowMutation("Keyspace1", bytes("k"));
+        rm.add(new QueryPath("Standard1", null, bytes("c1")), ByteBuffer.allocate((128 * 1024 * 1024) - 83), 0);
+        CommitLog.instance.add(rm);
+    }
+
     protected void testRecoveryWithBadSizeArgument(int size, int dataSize) throws Exception
     {
         Checksum checksum = new CRC32();
