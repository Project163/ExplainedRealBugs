diff --git a/CHANGES.txt b/CHANGES.txt
index 697e7ac762..b768f40d6b 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -39,6 +39,7 @@ dev
  * fix EstimatedHistogram.max (CASSANDRA-1413)
  * handle zero-length (or missing) rows during HH paging (CASSANDRA-1432)
  * include secondary indexes during schema migrations (CASSANDRA-1406)
+ * fix commitlog header race during schema change (CASSANDRA-1435)
 
 
 0.7-beta1
diff --git a/src/java/org/apache/cassandra/db/commitlog/CommitLog.java b/src/java/org/apache/cassandra/db/commitlog/CommitLog.java
index 0953e4af02..fe042afecb 100644
--- a/src/java/org/apache/cassandra/db/commitlog/CommitLog.java
+++ b/src/java/org/apache/cassandra/db/commitlog/CommitLog.java
@@ -471,31 +471,6 @@ public class CommitLog
         }
     }
     
-    public void forceNewSegment()
-    {
-        Callable task = new Callable()
-        {
-            public Object call() throws Exception
-            {
-                sync();
-                segments.add(new CommitLogSegment());
-                return null;
-            }
-        };
-        try
-        {
-            executor.submit(task).get();
-        }
-        catch (InterruptedException e)
-        {
-            throw new RuntimeException(e);
-        }
-        catch (ExecutionException e)
-        {
-            throw new RuntimeException(e);
-        }
-    }
-
     void sync() throws IOException
     {
         currentSegment().sync();
diff --git a/src/java/org/apache/cassandra/db/commitlog/CommitLogHeader.java b/src/java/org/apache/cassandra/db/commitlog/CommitLogHeader.java
index 2f02bf3668..3efdc99094 100644
--- a/src/java/org/apache/cassandra/db/commitlog/CommitLogHeader.java
+++ b/src/java/org/apache/cassandra/db/commitlog/CommitLogHeader.java
@@ -43,11 +43,10 @@ public class CommitLogHeader
     public static CommitLogHeaderSerializer serializer = new CommitLogHeaderSerializer();
 
     private Map<Integer, Integer> cfDirtiedAt; // position at which each CF was last flushed
-    private final int cfCount; // we keep this in case cfcount changes in the interim (size of lastFlushedAt is not a good indication).
-    
+
     CommitLogHeader()
     {
-        this(new HashMap<Integer, Integer>(), CFMetaData.getCfToIdMap().size());
+        this(new HashMap<Integer, Integer>());
     }
     
     /*
@@ -55,11 +54,9 @@ public class CommitLogHeader
      * also builds an index of position to column family
      * Id.
     */
-    private CommitLogHeader(Map<Integer, Integer> cfDirtiedAt, int cfCount)
+    private CommitLogHeader(Map<Integer, Integer> cfDirtiedAt)
     {
-        this.cfCount = cfCount;
         this.cfDirtiedAt = cfDirtiedAt;
-        assert cfDirtiedAt.size() <= cfCount;
     }
         
     boolean isDirty(Integer cfId)
@@ -154,13 +151,10 @@ public class CommitLogHeader
     {
         public void serialize(CommitLogHeader clHeader, DataOutput dos) throws IOException
         {
-            assert clHeader.cfDirtiedAt.size() <= clHeader.cfCount;
             Checksum checksum = new CRC32();
 
             // write the first checksum after the fixed-size part, so we won't read garbage lastFlushedAt data.
-            dos.writeInt(clHeader.cfCount); // 4
             dos.writeInt(clHeader.cfDirtiedAt.size()); // 4
-            checksum.update(clHeader.cfCount);
             checksum.update(clHeader.cfDirtiedAt.size());
             dos.writeLong(checksum.getValue());
 
@@ -173,21 +167,12 @@ public class CommitLogHeader
                 checksum.update(entry.getValue());
             }
             dos.writeLong(checksum.getValue());
-
-            // keep the size constant by padding for missing flushed-at entries.  these do not affect checksum.
-            for (int i = clHeader.cfDirtiedAt.entrySet().size(); i < clHeader.cfCount; i++)
-            {
-                dos.writeInt(0);
-                dos.writeInt(0);
-            }
         }
 
         public CommitLogHeader deserialize(DataInput dis) throws IOException
         {
             Checksum checksum = new CRC32();
 
-            int cfCount = dis.readInt();
-            checksum.update(cfCount);
             int lastFlushedAtSize = dis.readInt();
             checksum.update(lastFlushedAtSize);
             if (checksum.getValue() != dis.readLong())
@@ -208,7 +193,7 @@ public class CommitLogHeader
                 throw new IOException("Invalid or corrupt commitlog header");
             }
 
-            return new CommitLogHeader(lastFlushedAt, cfCount);
+            return new CommitLogHeader(lastFlushedAt);
         }
     }
 }
diff --git a/src/java/org/apache/cassandra/db/migration/AddColumnFamily.java b/src/java/org/apache/cassandra/db/migration/AddColumnFamily.java
index 6c6f0a99cb..03376039ac 100644
--- a/src/java/org/apache/cassandra/db/migration/AddColumnFamily.java
+++ b/src/java/org/apache/cassandra/db/migration/AddColumnFamily.java
@@ -87,10 +87,6 @@ public class AddColumnFamily extends Migration
         CFMetaData.fixMaxId();
         if (!clientMode)
             Table.open(ksm.name).initCf(cfm.cfId, cfm.cfName);
-
-        if (!clientMode)
-            // force creation of a new commit log segment.
-            CommitLog.instance().forceNewSegment();
     }
 
     public void subdeflate(org.apache.cassandra.db.migration.avro.Migration mi)
diff --git a/src/java/org/apache/cassandra/db/migration/AddKeyspace.java b/src/java/org/apache/cassandra/db/migration/AddKeyspace.java
index c54f6fa37f..f98e17e5ac 100644
--- a/src/java/org/apache/cassandra/db/migration/AddKeyspace.java
+++ b/src/java/org/apache/cassandra/db/migration/AddKeyspace.java
@@ -77,7 +77,6 @@ public class AddKeyspace extends Migration
         if (!clientMode)
         {
             Table.open(ksm.name);
-            CommitLog.instance().forceNewSegment();
         }
     }
     
diff --git a/src/java/org/apache/cassandra/db/migration/DropColumnFamily.java b/src/java/org/apache/cassandra/db/migration/DropColumnFamily.java
index b2722b18e1..b00bb044fd 100644
--- a/src/java/org/apache/cassandra/db/migration/DropColumnFamily.java
+++ b/src/java/org/apache/cassandra/db/migration/DropColumnFamily.java
@@ -92,8 +92,6 @@ public class DropColumnFamily extends Migration
         if (!clientMode)
         {
             Table.open(ksm.name).dropCf(cfm.cfId);
-            // we don't really need a new segment, but let's force it to be consistent with other operations.
-            CommitLog.instance().forceNewSegment();
         }
     }
     
diff --git a/src/java/org/apache/cassandra/db/migration/DropKeyspace.java b/src/java/org/apache/cassandra/db/migration/DropKeyspace.java
index c4cd19d20e..476c136df8 100644
--- a/src/java/org/apache/cassandra/db/migration/DropKeyspace.java
+++ b/src/java/org/apache/cassandra/db/migration/DropKeyspace.java
@@ -81,7 +81,6 @@ public class DropKeyspace extends Migration
         
         if (!clientMode)
         {
-            CommitLog.instance().forceNewSegment();
             // clear up any local hinted data for this keyspace.
             HintedHandOffManager.renameHints(name, null);
         }
diff --git a/src/java/org/apache/cassandra/db/migration/RenameColumnFamily.java b/src/java/org/apache/cassandra/db/migration/RenameColumnFamily.java
index ddfdabbd55..9c303be437 100644
--- a/src/java/org/apache/cassandra/db/migration/RenameColumnFamily.java
+++ b/src/java/org/apache/cassandra/db/migration/RenameColumnFamily.java
@@ -107,7 +107,6 @@ public class RenameColumnFamily extends Migration
         if (!clientMode)
         {
             Table.open(ksm.name).renameCf(cfId, newName);
-            CommitLog.instance().forceNewSegment();
         }
     }
     
diff --git a/src/java/org/apache/cassandra/db/migration/RenameKeyspace.java b/src/java/org/apache/cassandra/db/migration/RenameKeyspace.java
index fc16403196..b16c915df7 100644
--- a/src/java/org/apache/cassandra/db/migration/RenameKeyspace.java
+++ b/src/java/org/apache/cassandra/db/migration/RenameKeyspace.java
@@ -112,9 +112,6 @@ public class RenameKeyspace extends Migration
         {
             Table.clear(oldKsm.name);
             Table.open(newName);
-            // this isn't strictly necessary since the set of all cfs was not modified.
-            CommitLog.instance().forceNewSegment();
-    
             HintedHandOffManager.renameHints(oldName, newName);
         }
     }
diff --git a/src/java/org/apache/cassandra/service/StorageService.java b/src/java/org/apache/cassandra/service/StorageService.java
index d76de8a567..8fffdce1c2 100644
--- a/src/java/org/apache/cassandra/service/StorageService.java
+++ b/src/java/org/apache/cassandra/service/StorageService.java
@@ -1647,7 +1647,6 @@ public class StorageService implements IEndpointStateChangeSubscriber, StorageSe
        
 
         setMode("Draining: replaying commit log", false);
-        CommitLog.instance().forceNewSegment();
         // want to make sure that any segments deleted as a result of flushing are gone.
         DeletionService.waitFor();
         CommitLog.recover();
diff --git a/test/unit/org/apache/cassandra/db/commitlog/CommitLogHeaderTest.java b/test/unit/org/apache/cassandra/db/commitlog/CommitLogHeaderTest.java
index 6c1276e40c..1589267720 100644
--- a/test/unit/org/apache/cassandra/db/commitlog/CommitLogHeaderTest.java
+++ b/test/unit/org/apache/cassandra/db/commitlog/CommitLogHeaderTest.java
@@ -47,21 +47,4 @@ public class CommitLogHeaderTest extends SchemaLoader
         clh.turnOn(65, 2);
         assert clh.getReplayPosition() == 0;
     }
-        
-    @Test
-    public void constantSize() throws IOException
-    {
-        CommitLogHeader clh0 = new CommitLogHeader();
-        clh0.turnOn(2, 34);
-        ByteArrayOutputStream out0 = new ByteArrayOutputStream();
-        CommitLogHeader.serializer.serialize(clh0, new DataOutputStream(out0));
-
-        CommitLogHeader clh1 = new CommitLogHeader();
-        for (int i = 0; i < 5; i++)
-            clh1.turnOn(i, 1000 * i);
-        ByteArrayOutputStream out1 = new ByteArrayOutputStream();
-        CommitLogHeader.serializer.serialize(clh1, new DataOutputStream(out1));
-
-        assert out0.toByteArray().length == out1.toByteArray().length;
-    }
 }
