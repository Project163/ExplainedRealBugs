diff --git a/src/java/org/apache/cassandra/utils/EstimatedHistogram.java b/src/java/org/apache/cassandra/utils/EstimatedHistogram.java
index 2bc67463e9..5033723ad9 100644
--- a/src/java/org/apache/cassandra/utils/EstimatedHistogram.java
+++ b/src/java/org/apache/cassandra/utils/EstimatedHistogram.java
@@ -188,10 +188,18 @@ public class EstimatedHistogram
         return buckets.get(buckets.length() - 1) > 0;
     }
 
-    public boolean equals(EstimatedHistogram o)
+    @Override
+    public boolean equals(Object o)
     {
-        return Arrays.equals(getBucketOffsets(), o.getBucketOffsets()) &&
-               Arrays.equals(getBuckets(false), o.getBuckets(false));
+        if (this == o)
+            return true;
+        
+        if (!(o instanceof EstimatedHistogram))
+            return false;
+        
+        EstimatedHistogram that = (EstimatedHistogram) o;
+        return Arrays.equals(getBucketOffsets(), that.getBucketOffsets()) &&
+               Arrays.equals(getBuckets(false), that.getBuckets(false));
     }
 
     public static class EstimatedHistogramSerializer implements ICompactSerializer2<EstimatedHistogram>
