diff --git a/CHANGES.txt b/CHANGES.txt
index 5402ad54c4..07d526c486 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,6 @@
 2.1.3
+ * Fix ArrayIndexOutOfBoundsException when generating error message
+   for some CQL syntax errors (CASSANDRA-8455)
  * Scale memtable slab allocation logarithmically (CASSANDRA-7882)
  * cassandra-stress simultaneous inserts over same seed (CASSANDRA-7964)
  * Reduce cassandra-stress sampling memory requirements (CASSANDRA-7926)
diff --git a/src/java/org/apache/cassandra/cql3/ErrorCollector.java b/src/java/org/apache/cassandra/cql3/ErrorCollector.java
index cd628b8899..2137da23f4 100644
--- a/src/java/org/apache/cassandra/cql3/ErrorCollector.java
+++ b/src/java/org/apache/cassandra/cql3/ErrorCollector.java
@@ -132,6 +132,9 @@ public final class ErrorCollector implements ErrorListener
                              Token to,
                              Token offending)
     {
+        if (!areTokensValid(from, to, offending))
+            return;
+
         String[] lines = query.split("\n");
 
         boolean includeQueryStart = (from.getLine() == 1) && (from.getCharPositionInLine() == 0);
@@ -156,6 +159,33 @@ public final class ErrorCollector implements ErrorListener
         builder.append(")");
     }
 
+    /**
+     * Checks if the specified tokens are valid.
+     *
+     * @param tokens the tokens to check
+     * @return <code>true</code> if all the specified tokens are valid ones, <code>false</code> otherwise.
+     */
+    private static boolean areTokensValid(Token... tokens)
+    {
+        for (Token token : tokens)
+        {
+            if (!isTokenValid(token))
+                return false;
+        }
+        return true;
+    }
+
+    /**
+     * Checks that the specified token is valid.
+     *
+     * @param token the token to check
+     * @return <code>true</code> if it is considered as valid, <code>false</code> otherwise.
+     */
+    private static boolean isTokenValid(Token token)
+    {
+        return token.getLine() > 0 && token.getCharPositionInLine() >= 0;
+    }
+
     /**
      * Returns the index of the offending token. <p>In the case where the offending token is an extra
      * character at the end, the index returned by the <code>TokenStream</code> might be after the last token.
diff --git a/src/java/org/apache/cassandra/cql3/QueryProcessor.java b/src/java/org/apache/cassandra/cql3/QueryProcessor.java
index 8e829e8600..197225b6c9 100644
--- a/src/java/org/apache/cassandra/cql3/QueryProcessor.java
+++ b/src/java/org/apache/cassandra/cql3/QueryProcessor.java
@@ -542,6 +542,7 @@ public class QueryProcessor implements QueryHandler
         }
         catch (RuntimeException re)
         {
+            logger.error(String.format("The statement: [%s] could not be parsed.", queryStr), re);
             throw new SyntaxException(String.format("Failed parsing statement: [%s] reason: %s %s",
                                                     queryStr,
                                                     re.getClass().getSimpleName(),
diff --git a/test/unit/org/apache/cassandra/cql3/ErrorCollectorTest.java b/test/unit/org/apache/cassandra/cql3/ErrorCollectorTest.java
index 4f5db34f4e..fca93df7ac 100644
--- a/test/unit/org/apache/cassandra/cql3/ErrorCollectorTest.java
+++ b/test/unit/org/apache/cassandra/cql3/ErrorCollectorTest.java
@@ -107,6 +107,23 @@ public class ErrorCollectorTest
         assertEquals(expected, builder.toString());
     }
 
+    @Test
+    public void testAppendSnippetWithInvalidToToken()
+    {
+        String query = "CREATE TABLE test (a int PRIMARY KEY, b set<int>;";
+
+        ErrorCollector collector = new ErrorCollector(query);
+
+        StringBuilder builder = new StringBuilder();
+
+        Token from = new MockToken(1, 32, " ");
+        Token to = new MockToken(0, -1, "<no text>");
+        Token offending = new MockToken(1, 48, ";");
+
+        collector.appendSnippet(builder, from, to, offending);
+        assertEquals("", builder.toString());
+    }
+
     private final static class MockToken implements Token
     {
         /**
