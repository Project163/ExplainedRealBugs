diff --git a/CHANGES.txt b/CHANGES.txt
index db13556439..4d91466cb6 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -8,7 +8,8 @@
  * Log a miningfull warning when a node receive a message for a repair session
    that don't exist anymore (CASSANDRA-3256)
  * Fix FD leak when internode encryption is enabled (CASSANDRA-3257)
-
+ * FBUtilities.hexToBytes(String) to throw NumberFormatException when string
+   contains non-hex characters (CASSANDRA-3231)
 
 0.8.6
  * revert CASSANDRA-2388
diff --git a/src/java/org/apache/cassandra/utils/FBUtilities.java b/src/java/org/apache/cassandra/utils/FBUtilities.java
index d696f0977c..d34e69dc42 100644
--- a/src/java/org/apache/cassandra/utils/FBUtilities.java
+++ b/src/java/org/apache/cassandra/utils/FBUtilities.java
@@ -44,8 +44,6 @@ import org.apache.cassandra.cache.IRowCacheProvider;
 import org.apache.cassandra.config.ConfigurationException;
 import org.apache.cassandra.config.DatabaseDescriptor;
 import org.apache.cassandra.db.DecoratedKey;
-import org.apache.cassandra.db.marshal.AbstractType;
-import org.apache.cassandra.db.marshal.TypeParser;
 import org.apache.cassandra.dht.IPartitioner;
 import org.apache.cassandra.dht.Range;
 import org.apache.cassandra.dht.Token;
@@ -369,10 +367,14 @@ public class FBUtilities
     {
         if (str.length() % 2 == 1)
             str = "0" + str;
-        byte[] bytes = new byte[str.length()/2];
+        byte[] bytes = new byte[str.length() / 2];
         for (int i = 0; i < bytes.length; i++)
         {
-            bytes[i] = (byte)((charToByte[str.charAt(i * 2)] << 4) | charToByte[str.charAt(i*2 + 1)]);
+            byte halfByte1 = charToByte[str.charAt(i * 2)];
+            byte halfByte2 = charToByte[str.charAt(i * 2 + 1)];
+            if (halfByte1 == -1 || halfByte2 == -1)
+                throw new NumberFormatException("Non-hex characters in " + str);
+            bytes[i] = (byte)((halfByte1 << 4) | halfByte2);
         }
         return bytes;
     }
diff --git a/test/unit/org/apache/cassandra/db/marshal/BytesTypeTest.java b/test/unit/org/apache/cassandra/db/marshal/BytesTypeTest.java
new file mode 100644
index 0000000000..4d96b76b1e
--- /dev/null
+++ b/test/unit/org/apache/cassandra/db/marshal/BytesTypeTest.java
@@ -0,0 +1,40 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ *
+ */
+package org.apache.cassandra.db.marshal;
+
+import org.junit.Test;
+
+public class BytesTypeTest
+{
+    private static final String INVALID_HEX = "33AG45F"; // Invalid (has a G)
+    private static final String VALID_HEX = "33A45F";
+
+    @Test (expected = MarshalException.class)
+    public void testFromStringWithInvalidString()
+    {
+        BytesType.instance.fromString(INVALID_HEX);
+    }
+
+    @Test
+    public void testFromStringWithValidString()
+    {
+        BytesType.instance.fromString(VALID_HEX);
+    }
+}
