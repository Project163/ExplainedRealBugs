diff --git a/CHANGES.txt b/CHANGES.txt
index ca6c449860..c15588cd53 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,6 +1,8 @@
 1.0.0-final
  * Fix tool .bat files when CASSANDRA_HOME contains spaces (CASSANDRA-3258)
  * Force flush of status table when removing/updating token (CASSANDRA-3243)
+ * fix bug preventing obsolete commitlog segments from being removed
+   (CASSANDRA-3269)
 
 
 1.0.0-rc2
diff --git a/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java b/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java
index d4bcaf647e..b08b5d0fac 100644
--- a/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java
+++ b/src/java/org/apache/cassandra/db/commitlog/CommitLogSegment.java
@@ -97,11 +97,10 @@ public class CommitLogSegment
 
     public ReplayPosition write(RowMutation rowMutation) throws IOException
     {
-        long currentPosition = -1L;
+        ReplayPosition cLogCtx = getContext();
+
         try
         {
-            ReplayPosition cLogCtx = getContext();
-
             for (ColumnFamily columnFamily : rowMutation.getColumnFamilies())
             {
                 // check for null cfm in case a cl write goes through after the cf is
@@ -113,7 +112,7 @@ public class CommitLogSegment
                 }
                 else
                 {
-                    turnOn(cfm.cfId, (int) currentPosition);
+                    turnOn(cfm.cfId, cLogCtx.position);
                 }
             }
 
@@ -131,8 +130,7 @@ public class CommitLogSegment
         }
         catch (IOException e)
         {
-            if (currentPosition != -1)
-                logWriter.truncate(currentPosition);
+            logWriter.truncate(cLogCtx.position);
             throw e;
         }
     }
