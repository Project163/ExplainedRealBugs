diff --git a/src/java/org/apache/cassandra/db/commitlog/AbstractCommitLogSegmentManager.java b/src/java/org/apache/cassandra/db/commitlog/AbstractCommitLogSegmentManager.java
index 848c6e0218..28462ffba8 100755
--- a/src/java/org/apache/cassandra/db/commitlog/AbstractCommitLogSegmentManager.java
+++ b/src/java/org/apache/cassandra/db/commitlog/AbstractCommitLogSegmentManager.java
@@ -443,7 +443,8 @@ public abstract class AbstractCommitLogSegmentManager
     /**
      * To be used by tests only. Not safe if mutation slots are being allocated concurrently.
      */
-    void awaitManagementTasksCompletion()
+    @VisibleForTesting
+    public void awaitManagementTasksCompletion()
     {
         if (availableSegment == null && !atSegmentBufferLimit())
         {
diff --git a/test/unit/org/apache/cassandra/locator/AlibabaCloudSnitchTest.java b/test/unit/org/apache/cassandra/locator/AlibabaCloudSnitchTest.java
index fb85a23f47..04540cfdc5 100644
--- a/test/unit/org/apache/cassandra/locator/AlibabaCloudSnitchTest.java
+++ b/test/unit/org/apache/cassandra/locator/AlibabaCloudSnitchTest.java
@@ -48,6 +48,7 @@ public class AlibabaCloudSnitchTest
         System.setProperty(Gossiper.Props.DISABLE_THREAD_VALIDATION, "true");
         DatabaseDescriptor.daemonInitialization();
         CommitLog.instance.start();
+        CommitLog.instance.segmentManager.awaitManagementTasksCompletion();
         mkdirs();
         cleanup();
         Keyspace.setInitialized();
diff --git a/test/unit/org/apache/cassandra/locator/CloudstackSnitchTest.java b/test/unit/org/apache/cassandra/locator/CloudstackSnitchTest.java
index 9e39c48abd..51e8371882 100644
--- a/test/unit/org/apache/cassandra/locator/CloudstackSnitchTest.java
+++ b/test/unit/org/apache/cassandra/locator/CloudstackSnitchTest.java
@@ -49,6 +49,7 @@ public class CloudstackSnitchTest
         System.setProperty(Gossiper.Props.DISABLE_THREAD_VALIDATION, "true");
         DatabaseDescriptor.daemonInitialization();
         CommitLog.instance.start();
+        CommitLog.instance.segmentManager.awaitManagementTasksCompletion();
         mkdirs();
         cleanup();
         Keyspace.setInitialized();
diff --git a/test/unit/org/apache/cassandra/locator/EC2SnitchTest.java b/test/unit/org/apache/cassandra/locator/EC2SnitchTest.java
index f05f4a274b..69c1287918 100644
--- a/test/unit/org/apache/cassandra/locator/EC2SnitchTest.java
+++ b/test/unit/org/apache/cassandra/locator/EC2SnitchTest.java
@@ -63,6 +63,7 @@ public class EC2SnitchTest
         System.setProperty(Gossiper.Props.DISABLE_THREAD_VALIDATION, "true");
         DatabaseDescriptor.daemonInitialization();
         CommitLog.instance.start();
+        CommitLog.instance.segmentManager.awaitManagementTasksCompletion();
         mkdirs();
         cleanup();
         Keyspace.setInitialized();
diff --git a/test/unit/org/apache/cassandra/locator/GoogleCloudSnitchTest.java b/test/unit/org/apache/cassandra/locator/GoogleCloudSnitchTest.java
index e524f3a531..67192bdfa5 100644
--- a/test/unit/org/apache/cassandra/locator/GoogleCloudSnitchTest.java
+++ b/test/unit/org/apache/cassandra/locator/GoogleCloudSnitchTest.java
@@ -50,6 +50,7 @@ public class GoogleCloudSnitchTest
         System.setProperty(Gossiper.Props.DISABLE_THREAD_VALIDATION, "true");
         DatabaseDescriptor.daemonInitialization();
         CommitLog.instance.start();
+        CommitLog.instance.segmentManager.awaitManagementTasksCompletion();
         mkdirs();
         cleanup();
         Keyspace.setInitialized();
