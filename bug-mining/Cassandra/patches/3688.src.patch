diff --git a/tools/stress/src/org/apache/cassandra/stress/Stress.java b/tools/stress/src/org/apache/cassandra/stress/Stress.java
index a4ec8a0c9d..bc6d0273b3 100644
--- a/tools/stress/src/org/apache/cassandra/stress/Stress.java
+++ b/tools/stress/src/org/apache/cassandra/stress/Stress.java
@@ -57,66 +57,78 @@ public final class Stress
         if (FBUtilities.isWindows())
             WindowsTimer.startTimerPeriod(1);
 
-        final StressSettings settings;
         try
         {
-            settings = StressSettings.parse(arguments);
-        }
-        catch (IllegalArgumentException e)
-        {
-            printHelpMessage();
-            e.printStackTrace();
-            return;
-        }
 
-        PrintStream logout = settings.log.getOutput();
+            final StressSettings settings;
+            try
+            {
+                settings = StressSettings.parse(arguments);
+            }
+            catch (IllegalArgumentException e)
+            {
+                printHelpMessage();
+                e.printStackTrace();
+                return;
+            }
 
-        if (settings.sendToDaemon != null)
-        {
-            Socket socket = new Socket(settings.sendToDaemon, 2159);
+            PrintStream logout = settings.log.getOutput();
 
-            ObjectOutputStream out = new ObjectOutputStream(socket.getOutputStream());
-            BufferedReader inp = new BufferedReader(new InputStreamReader(socket.getInputStream()));
+            if (settings.sendToDaemon != null)
+            {
+                Socket socket = new Socket(settings.sendToDaemon, 2159);
 
-            Runtime.getRuntime().addShutdownHook(new ShutDown(socket, out));
+                ObjectOutputStream out = new ObjectOutputStream(socket.getOutputStream());
+                BufferedReader inp = new BufferedReader(new InputStreamReader(socket.getInputStream()));
 
-            out.writeObject(settings);
+                Runtime.getRuntime().addShutdownHook(new ShutDown(socket, out));
 
-            String line;
+                out.writeObject(settings);
 
-            try
-            {
-                while (!socket.isClosed() && (line = inp.readLine()) != null)
+                String line;
+
+                try
                 {
-                    if (line.equals("END") || line.equals("FAILURE"))
+                    while (!socket.isClosed() && (line = inp.readLine()) != null)
                     {
-                        out.writeInt(1);
-                        break;
-                    }
+                        if (line.equals("END") || line.equals("FAILURE"))
+                        {
+                            out.writeInt(1);
+                            break;
+                        }
 
-                    logout.println(line);
+                        logout.println(line);
+                    }
+                }
+                catch (SocketException e)
+                {
+                    if (!stopped)
+                        e.printStackTrace();
                 }
+
+                out.close();
+                inp.close();
+
+                socket.close();
             }
-            catch (SocketException e)
+            else
             {
-                if (!stopped)
-                    e.printStackTrace();
+                StressAction stressAction = new StressAction(settings, logout);
+                stressAction.run();
             }
 
-            out.close();
-            inp.close();
-
-            socket.close();
         }
-        else
+        catch (Throwable t)
         {
-            StressAction stressAction = new StressAction(settings, logout);
-            stressAction.run();
+            t.printStackTrace();
+        }
+        finally
+        {
+            if (FBUtilities.isWindows())
+                WindowsTimer.endTimerPeriod(1);
+            System.exit(0);
         }
 
-        if (FBUtilities.isWindows())
-            WindowsTimer.endTimerPeriod(1);
-        System.exit(0);
     }
 
     /**
