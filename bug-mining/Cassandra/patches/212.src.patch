diff --git a/src/java/org/apache/cassandra/gms/ApplicationState.java b/src/java/org/apache/cassandra/gms/ApplicationState.java
index 4af8d5e73f..9fc4fdd288 100644
--- a/src/java/org/apache/cassandra/gms/ApplicationState.java
+++ b/src/java/org/apache/cassandra/gms/ApplicationState.java
@@ -37,7 +37,7 @@ import org.apache.cassandra.io.ICompactSerializer;
  *      Gossiper.instance().addApplicationState("LOAD STATE", loadState);
  */
 
-public class ApplicationState
+public class ApplicationState implements Comparable<ApplicationState>
 {
     private static ICompactSerializer<ApplicationState> serializer_;
     static
@@ -79,6 +79,11 @@ public class ApplicationState
     {
         return version_;
     }
+
+    public int compareTo(ApplicationState apState)
+    {
+        return this.version_ - apState.getStateVersion();
+    }
 }
 
 class ApplicationStateSerializer implements ICompactSerializer<ApplicationState>
diff --git a/src/java/org/apache/cassandra/gms/EndPointState.java b/src/java/org/apache/cassandra/gms/EndPointState.java
index 68d2fa75c4..2be33d9107 100644
--- a/src/java/org/apache/cassandra/gms/EndPointState.java
+++ b/src/java/org/apache/cassandra/gms/EndPointState.java
@@ -76,7 +76,7 @@ public class EndPointState
         return applicationState_.get(key);
     }
     
-    public Map<String, ApplicationState> getApplicationState()
+    public Map<String, ApplicationState> getApplicationStateMap()
     {
         return applicationState_;
     }
@@ -118,6 +118,22 @@ public class EndPointState
         //isAlive_ = false;
         isAGossiper_ = value;        
     }
+
+    public List<Map.Entry<String,ApplicationState>> getSortedApplicationStates()
+    {
+        ArrayList<Map.Entry<String, ApplicationState>> entries = new ArrayList<Map.Entry<String, ApplicationState>>();
+        entries.addAll(applicationState_.entrySet());
+        Collections.sort(entries, new Comparator<Map.Entry<String, ApplicationState>>()
+        {
+            public int compare(Map.Entry<String, ApplicationState> lhs, Map.Entry<String, ApplicationState> rhs)
+            {
+                return lhs.getValue().compareTo(rhs.getValue());
+            }
+        });
+
+        return entries;
+    }
+
 }
 
 class EndPointStateSerializer implements ICompactSerializer<EndPointState>
diff --git a/src/java/org/apache/cassandra/gms/Gossiper.java b/src/java/org/apache/cassandra/gms/Gossiper.java
index 9f88a28959..c289839c4f 100644
--- a/src/java/org/apache/cassandra/gms/Gossiper.java
+++ b/src/java/org/apache/cassandra/gms/Gossiper.java
@@ -28,7 +28,7 @@ import org.apache.cassandra.config.DatabaseDescriptor;
 import org.apache.cassandra.net.IVerbHandler;
 import org.apache.cassandra.net.Message;
 import org.apache.cassandra.net.MessagingService;
-import org.apache.cassandra.utils.LogUtil;
+
 import org.apache.log4j.Logger;
 
 /**
@@ -209,7 +209,7 @@ public class Gossiper implements IFailureDetectionEventListener, IEndPointStateC
     {
         List<Integer> versions = new ArrayList<Integer>();
         versions.add( epState.getHeartBeatState().getHeartBeatVersion() );
-        Map<String, ApplicationState> appStateMap = epState.getApplicationState();
+        Map<String, ApplicationState> appStateMap = epState.getApplicationStateMap();
 
         Set<String> keys = appStateMap.keySet();
         for ( String key : keys )
@@ -431,7 +431,7 @@ public class Gossiper implements IFailureDetectionEventListener, IEndPointStateC
             {
                 reqdEndPointState = new EndPointState(epState.getHeartBeatState());
             }
-            Map<String, ApplicationState> appStateMap = epState.getApplicationState();
+            Map<String, ApplicationState> appStateMap = epState.getApplicationStateMap();
             /* Accumulate all application states whose versions are greater than "version" variable */
             Set<String> keys = appStateMap.keySet();
             for ( String key : keys )
@@ -627,13 +627,12 @@ public class Gossiper implements IFailureDetectionEventListener, IEndPointStateC
 
     void applyApplicationStateLocally(InetAddress addr, EndPointState localStatePtr, EndPointState remoteStatePtr)
     {
-        Map<String, ApplicationState> localAppStateMap = localStatePtr.getApplicationState();
-        Map<String, ApplicationState> remoteAppStateMap = remoteStatePtr.getApplicationState();
+        Map<String, ApplicationState> localAppStateMap = localStatePtr.getApplicationStateMap();
 
-        Set<String> remoteKeys = remoteAppStateMap.keySet();
-        for ( String remoteKey : remoteKeys )
+        for (Map.Entry<String,ApplicationState> remoteEntry : remoteStatePtr.getSortedApplicationStates())
         {
-            ApplicationState remoteAppState = remoteAppStateMap.get(remoteKey);
+            String remoteKey = remoteEntry.getKey();
+            ApplicationState remoteAppState = remoteEntry.getValue();
             ApplicationState localAppState = localAppStateMap.get(remoteKey);
 
             /* If state doesn't exist locally for this key then just apply it */
diff --git a/src/java/org/apache/cassandra/service/StorageService.java b/src/java/org/apache/cassandra/service/StorageService.java
index 37004ab59c..c74233ac9d 100644
--- a/src/java/org/apache/cassandra/service/StorageService.java
+++ b/src/java/org/apache/cassandra/service/StorageService.java
@@ -485,14 +485,10 @@ public final class StorageService implements IEndPointStateChangeSubscriber, Sto
 
     public void onJoin(InetAddress endpoint, EndPointState epState)
     {
-        ApplicationState stateNormal = epState.getApplicationState(StorageService.STATE_NORMAL);
-        ApplicationState stateBootstrapping = epState.getApplicationState(StorageService.STATE_BOOTSTRAPPING);
-
-        if (stateNormal != null)
-            onChange(endpoint, StorageService.STATE_NORMAL, stateNormal);
-
-        if (stateBootstrapping != null)
-            onChange(endpoint, StorageService.STATE_BOOTSTRAPPING, stateBootstrapping);
+        for (Map.Entry<String,ApplicationState> entry : epState.getSortedApplicationStates())
+        {
+            onChange(endpoint, entry.getKey(), entry.getValue());
+        }
     }
 
     public void onAlive(InetAddress endpoint, EndPointState state)
