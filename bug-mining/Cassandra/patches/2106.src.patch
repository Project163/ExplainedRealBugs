diff --git a/CHANGES.txt b/CHANGES.txt
index ca062d6800..c7d64b46b0 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -15,6 +15,7 @@
  * Correctly typecheck in CQL3 even with ReversedType (CASSANDRA-5386)
  * Fix streaming compressed files when using encryption (CASSANDRA-5391)
  * cassandra-all 1.2.0 pom missing netty dependency (CASSANDRA-5392)
+ * Fix writetime/ttl functions on null values (CASSANDRA-5341)
 Merged from 1.1:
  * cli: Quote ks and cf names in schema output when needed (CASSANDRA-5052)
  * Fix bad default for min/max timestamp in SSTableMetadata (CASSANDRA-5372)
diff --git a/src/java/org/apache/cassandra/cql3/statements/Selection.java b/src/java/org/apache/cassandra/cql3/statements/Selection.java
index c42b58732d..983c35bc35 100644
--- a/src/java/org/apache/cassandra/cql3/statements/Selection.java
+++ b/src/java/org/apache/cassandra/cql3/statements/Selection.java
@@ -248,20 +248,25 @@ public abstract class Selection
 
         public void add(IColumn c)
         {
-            current.add(c == null || c.isMarkedForDelete() ? null : value(c));
+            current.add(isDead(c) ? null : value(c));
             if (timestamps != null)
             {
-                timestamps[current.size() - 1] = c.timestamp();
+                timestamps[current.size() - 1] = isDead(c) ? -1 : c.timestamp();
             }
             if (ttls != null)
             {
                 int ttl = -1;
-                if (c instanceof ExpiringColumn)
+                if (!isDead(c) && c instanceof ExpiringColumn)
                     ttl = ((ExpiringColumn)c).getLocalDeletionTime() - (int) (System.currentTimeMillis() / 1000);
                 ttls[current.size() - 1] = ttl;
             }
         }
 
+        private boolean isDead(IColumn c)
+        {
+            return c == null || c.isMarkedForDelete();
+        }
+
         public void newRow() throws InvalidRequestException
         {
             if (current != null)
@@ -366,7 +371,10 @@ public abstract class Selection
         public ByteBuffer compute(ResultSetBuilder rs)
         {
             if (isWritetime)
-                return ByteBufferUtil.bytes(rs.timestamps[idx]);
+            {
+                long ts = rs.timestamps[idx];
+                return ts >= 0 ? ByteBufferUtil.bytes(ts) : null;
+            }
 
             int ttl = rs.ttls[idx];
             return ttl > 0 ? ByteBufferUtil.bytes(ttl) : null;
