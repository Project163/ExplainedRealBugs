diff --git a/CHANGES.txt b/CHANGES.txt
index e0652af353..edd1026d32 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 2.1.3
+ * Make sure we set lastCompactedKey correctly (CASSANDRA-8463)
  * (cqlsh) Fix output of CONSISTENCY command (CASSANDRA-8507)
  * (cqlsh) Fixed the handling of LIST statements (CASSANDRA-8370)
  * Make sstablescrub check leveled manifest again (CASSANDRA-8432)
diff --git a/src/java/org/apache/cassandra/db/compaction/AbstractCompactionStrategy.java b/src/java/org/apache/cassandra/db/compaction/AbstractCompactionStrategy.java
index 337657de02..10abd01fa2 100644
--- a/src/java/org/apache/cassandra/db/compaction/AbstractCompactionStrategy.java
+++ b/src/java/org/apache/cassandra/db/compaction/AbstractCompactionStrategy.java
@@ -300,6 +300,14 @@ public abstract class AbstractCompactionStrategy
         return getClass().getSimpleName();
     }
 
+    public synchronized void replaceSSTables(Collection<SSTableReader> removed, Collection<SSTableReader> added)
+    {
+        for (SSTableReader remove : removed)
+            removeSSTable(remove);
+        for (SSTableReader add : added)
+            addSSTable(add);
+    }
+
     public abstract void addSSTable(SSTableReader added);
 
     public abstract void removeSSTable(SSTableReader sstable);
diff --git a/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java b/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java
index dbb9a13827..f9e5d167fb 100644
--- a/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java
+++ b/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java
@@ -206,6 +206,12 @@ public class LeveledCompactionStrategy extends AbstractCompactionStrategy
         return new ScannerList(scanners);
     }
 
+    @Override
+    public void replaceSSTables(Collection<SSTableReader> removed, Collection<SSTableReader> added)
+    {
+        manifest.replace(removed, added);
+    }
+
     @Override
     public void addSSTable(SSTableReader added)
     {
diff --git a/src/java/org/apache/cassandra/db/compaction/WrappingCompactionStrategy.java b/src/java/org/apache/cassandra/db/compaction/WrappingCompactionStrategy.java
index 84ef97fdf5..c88bdf00a8 100644
--- a/src/java/org/apache/cassandra/db/compaction/WrappingCompactionStrategy.java
+++ b/src/java/org/apache/cassandra/db/compaction/WrappingCompactionStrategy.java
@@ -20,7 +20,9 @@ package org.apache.cassandra.db.compaction;
 import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.Collection;
+import java.util.HashSet;
 import java.util.List;
+import java.util.Set;
 import java.util.concurrent.Callable;
 
 import org.slf4j.Logger;
@@ -212,6 +214,12 @@ public final class WrappingCompactionStrategy extends AbstractCompactionStrategy
         return repaired.getName();
     }
 
+    @Override
+    public void replaceSSTables(Collection<SSTableReader> removed, Collection<SSTableReader> added)
+    {
+        throw new UnsupportedOperationException("Can't replace sstables in the wrapping compaction strategy");
+    }
+
     @Override
     public void addSSTable(SSTableReader added)
     {
@@ -237,18 +245,42 @@ public final class WrappingCompactionStrategy extends AbstractCompactionStrategy
         else if (notification instanceof SSTableListChangedNotification)
         {
             SSTableListChangedNotification listChangedNotification = (SSTableListChangedNotification) notification;
+            Set<SSTableReader> repairedRemoved = new HashSet<>();
+            Set<SSTableReader> repairedAdded = new HashSet<>();
+            Set<SSTableReader> unrepairedRemoved = new HashSet<>();
+            Set<SSTableReader> unrepairedAdded = new HashSet<>();
+
             for (SSTableReader sstable : listChangedNotification.removed)
             {
                 if (sstable.isRepaired())
-                    repaired.removeSSTable(sstable);
+                    repairedRemoved.add(sstable);
                 else
-                    unrepaired.removeSSTable(sstable);
+                    unrepairedRemoved.add(sstable);
             }
             for (SSTableReader sstable : listChangedNotification.added)
             {
                 if (sstable.isRepaired())
-                    repaired.addSSTable(sstable);
+                    repairedAdded.add(sstable);
                 else
+                    unrepairedAdded.add(sstable);
+            }
+            if (!repairedRemoved.isEmpty())
+            {
+                repaired.replaceSSTables(repairedRemoved, repairedAdded);
+            }
+            else
+            {
+                for (SSTableReader sstable : repairedAdded)
+                    repaired.addSSTable(sstable);
+            }
+
+            if (!unrepairedRemoved.isEmpty())
+            {
+                unrepaired.replaceSSTables(unrepairedRemoved, unrepairedAdded);
+            }
+            else
+            {
+                for (SSTableReader sstable : unrepairedAdded)
                     unrepaired.addSSTable(sstable);
             }
         }
