diff --git a/CHANGES.txt b/CHANGES.txt
index a0e006fe01..5dd06753ed 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 4.0.4
+ * Streaming tasks handle empty SSTables correctly (CASSANDRA-16349)
  * Prevent SSTableLoader from doing unnecessary work (CASSANDRA-16349)
 Merged from 3.0:
  * Fix flaky test - test_cqlsh_completion.TestCqlshCompletion (CASSANDRA-17338)
diff --git a/src/java/org/apache/cassandra/db/streaming/CassandraIncomingFile.java b/src/java/org/apache/cassandra/db/streaming/CassandraIncomingFile.java
index 11a18a0fde..2d6a4fdc73 100644
--- a/src/java/org/apache/cassandra/db/streaming/CassandraIncomingFile.java
+++ b/src/java/org/apache/cassandra/db/streaming/CassandraIncomingFile.java
@@ -93,7 +93,7 @@ public class CassandraIncomingFile implements IncomingStream
     @Override
     public synchronized long getSize()
     {
-        Preconditions.checkState(size > 0, "Stream hasn't been read yet");
+        Preconditions.checkState(size != -1, "Stream hasn't been read yet");
         return size;
     }
 
diff --git a/src/java/org/apache/cassandra/io/sstable/format/RangeAwareSSTableWriter.java b/src/java/org/apache/cassandra/io/sstable/format/RangeAwareSSTableWriter.java
index ef4deb7193..43b1957494 100644
--- a/src/java/org/apache/cassandra/io/sstable/format/RangeAwareSSTableWriter.java
+++ b/src/java/org/apache/cassandra/io/sstable/format/RangeAwareSSTableWriter.java
@@ -161,13 +161,13 @@ public class RangeAwareSSTableWriter implements SSTableMultiWriter
     @Override
     public long getFilePointer()
     {
-        return currentWriter.getFilePointer();
+       return currentWriter != null ? currentWriter.getFilePointer() : 0L;
     }
 
     @Override
     public TableId getTableId()
     {
-        return currentWriter.getTableId();
+        return cfs.metadata.id;
     }
 
     @Override
diff --git a/test/unit/org/apache/cassandra/io/sstable/format/RangeAwareSSTableWriterTest.java b/test/unit/org/apache/cassandra/io/sstable/format/RangeAwareSSTableWriterTest.java
new file mode 100644
index 0000000000..7ae69ea38e
--- /dev/null
+++ b/test/unit/org/apache/cassandra/io/sstable/format/RangeAwareSSTableWriterTest.java
@@ -0,0 +1,91 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.cassandra.io.sstable.format;
+
+import java.io.IOException;
+
+import org.junit.BeforeClass;
+import org.junit.Test;
+
+import org.apache.cassandra.SchemaLoader;
+import org.apache.cassandra.config.DatabaseDescriptor;
+import org.apache.cassandra.db.ColumnFamilyStore;
+import org.apache.cassandra.db.DiskBoundaries;
+import org.apache.cassandra.db.Keyspace;
+import org.apache.cassandra.db.SerializationHeader;
+import org.apache.cassandra.db.compaction.OperationType;
+import org.apache.cassandra.db.lifecycle.LifecycleTransaction;
+import org.apache.cassandra.dht.Murmur3Partitioner;
+import org.apache.cassandra.schema.KeyspaceParams;
+import org.apache.cassandra.service.StorageService;
+
+import static org.junit.Assert.assertEquals;
+
+public class RangeAwareSSTableWriterTest
+{
+    public static final String KEYSPACE1 = "Keyspace1";
+    public static final String CF_STANDARD = "Standard1";
+
+    public static ColumnFamilyStore cfs;
+
+    @BeforeClass
+    public static void defineSchema() throws Exception
+    {
+        DatabaseDescriptor.daemonInitialization();
+        DatabaseDescriptor.setPartitionerUnsafe(Murmur3Partitioner.instance);
+        SchemaLoader.cleanupAndLeaveDirs();
+        Keyspace.setInitialized();
+        StorageService.instance.initServer();
+
+        SchemaLoader.createKeyspace(KEYSPACE1,
+                                    KeyspaceParams.simple(1),
+                                    SchemaLoader.standardCFMD(KEYSPACE1, CF_STANDARD)
+                                                .partitioner(Murmur3Partitioner.instance));
+
+        Keyspace keyspace = Keyspace.open(KEYSPACE1);
+        cfs = keyspace.getColumnFamilyStore(CF_STANDARD);
+        cfs.clearUnsafe();
+        cfs.disableAutoCompaction();
+    }
+
+    @Test
+    public void testAccessWriterBeforeAppend() throws IOException
+    {
+
+        SchemaLoader.insertData(KEYSPACE1, CF_STANDARD, 0, 1);
+        cfs.forceBlockingFlush();
+
+        LifecycleTransaction txn = LifecycleTransaction.offline(OperationType.STREAM);
+
+        RangeAwareSSTableWriter writer = new RangeAwareSSTableWriter(cfs,
+                                                                     0,
+                                                                     0,
+                                                                     null,
+                                                                     false,
+                                                                     SSTableFormat.Type.BIG,
+                                                                     0,
+                                                                     0,
+                                                                     txn,
+                                                                     SerializationHeader.make(cfs.metadata(),
+                                                                                              cfs.getLiveSSTables()));
+        assertEquals(cfs.metadata.id, writer.getTableId());
+        assertEquals(0L, writer.getFilePointer());
+
+    }
+}
\ No newline at end of file
