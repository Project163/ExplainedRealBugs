diff --git a/CHANGES.txt b/CHANGES.txt
index 41ee6e5fdf..eed2c09a93 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -4,6 +4,7 @@
  * Don't fail streams on failure detector downs (CASSANDRA-3569)
  * Add optional keyspace to DROP INDEX statement (CASSANDRA-7314)
  * Reduce run time for CQL tests (CASSANDRA-7327)
+ * Fix heap size calculation on Windows (CASSANDRA-7352)
 Merged from 2.0:
  * Add per-CF range read request latency metrics (CASSANDRA-7338)
  * Fix NPE in StreamTransferTask.createMessageForRetry() (CASSANDRA-7323)
diff --git a/conf/cassandra-env.ps1 b/conf/cassandra-env.ps1
index b3f773fd6a..3f64737063 100644
--- a/conf/cassandra-env.ps1
+++ b/conf/cassandra-env.ps1
@@ -67,7 +67,7 @@ Function CalculateHeapSizes
 
     $memObject = Get-WMIObject -class win32_physicalmemory
     $memory = ($memObject | Measure-Object Capacity -Sum).sum
-    $memoryMB = $memory / (1024*1024)
+    $memoryMB = [Math]::Truncate($memory / (1024*1024))
 
     $cpu = gwmi Win32_ComputerSystem | Select-Object NumberOfLogicalProcessors
     $systemCores = $cpu.NumberOfLogicalProcessors
@@ -77,8 +77,8 @@ Function CalculateHeapSizes
     # calculate 1/2 ram and cap to 1024MB
     # calculate 1/4 ram and cap to 8192MB
     # pick the max
-    $halfMem = $memoryMB / 2
-    $quarterMem = $halfMem / 2
+    $halfMem = [Math]::Truncate($memoryMB / 2)
+    $quarterMem = [Math]::Truncate($halfMem / 2)
 
     if ($halfMem -gt 1024)
     {
@@ -103,7 +103,7 @@ Function CalculateHeapSizes
     # Young gen: min(max_sensible_per_modern_cpu_core * num_cores, 1/4
     $maxYGPerCore = 100
     $maxYGTotal = $maxYGPerCore * $systemCores
-    $desiredYG = $maxHeapMB / 4
+    $desiredYG = [Math]::Truncate($maxHeapMB / 4)
 
     if ($desiredYG -gt $maxYGTotal)
     {
