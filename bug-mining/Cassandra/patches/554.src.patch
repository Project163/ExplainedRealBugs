diff --git a/src/java/org/apache/cassandra/db/DecoratedKey.java b/src/java/org/apache/cassandra/db/DecoratedKey.java
index 1c2fc16e26..e4b9744dcb 100644
--- a/src/java/org/apache/cassandra/db/DecoratedKey.java
+++ b/src/java/org/apache/cassandra/db/DecoratedKey.java
@@ -61,7 +61,7 @@ public class DecoratedKey<T extends Token> implements Comparable<DecoratedKey>
     @Override
     public int hashCode()
     {
-        return token.hashCode();
+        return token.hashCode() + (key == null ? 0 : key.hashCode());
     }
 
     @Override
@@ -75,12 +75,40 @@ public class DecoratedKey<T extends Token> implements Comparable<DecoratedKey>
             return false;
 
         DecoratedKey other = (DecoratedKey) obj;
-        return token.equals(other.token);
+
+        if (token.equals(other.token))
+        {
+            if (key == null && other.key == null)
+                return true;
+
+            if (key == null || other.key == null)
+                return false;
+
+            return key.equals(other.key);
+        }
+
+        return false;
     }
 
     public int compareTo(DecoratedKey other)
     {
-        return token.compareTo(other.token);
+        int cmp = token.compareTo(other.token);
+
+        if (cmp == 0)
+        {
+            if (key == null && other.key == null)
+                return 0;
+
+            if (key == null)
+                return 1;
+
+            if (other.key == null)
+                return -1;
+
+            return key.compareTo(other.key);
+        }
+
+        return cmp;
     }
 
     public boolean isEmpty()
