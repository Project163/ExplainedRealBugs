diff --git a/CHANGES.txt b/CHANGES.txt
index b7243ff940..7abf402652 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -35,6 +35,7 @@ dev
  * fix using DynamicEndpointSnitch with NetworkTopologyStrategy
    (CASSANDRA-1429)
  * Add CfDef.default_validation_class (CASSANDRA-891)
+ * fix EstimatedHistogram.max (CASSANDRA-1413)
 
 
 0.7-beta1
diff --git a/src/java/org/apache/cassandra/io/sstable/SSTable.java b/src/java/org/apache/cassandra/io/sstable/SSTable.java
index 03aea64eef..86b5592f97 100644
--- a/src/java/org/apache/cassandra/io/sstable/SSTable.java
+++ b/src/java/org/apache/cassandra/io/sstable/SSTable.java
@@ -64,8 +64,8 @@ public abstract class SSTable
     public static final String TEMPFILE_MARKER = "tmp";
 
     public static List<String> components = Collections.unmodifiableList(Arrays.asList(COMPONENT_FILTER, COMPONENT_INDEX, COMPONENT_DATA));
-    protected EstimatedHistogram estimatedRowSize = new EstimatedHistogram(130);
-    protected EstimatedHistogram estimatedColumnCount = new EstimatedHistogram(112);
+    protected EstimatedHistogram estimatedRowSize = new EstimatedHistogram(150);
+    protected EstimatedHistogram estimatedColumnCount = new EstimatedHistogram(114);
 
     protected SSTable(String filename, CFMetaData metadata, IPartitioner partitioner)
     {
diff --git a/src/java/org/apache/cassandra/utils/EstimatedHistogram.java b/src/java/org/apache/cassandra/utils/EstimatedHistogram.java
index d2b7ec065a..bb36059d86 100644
--- a/src/java/org/apache/cassandra/utils/EstimatedHistogram.java
+++ b/src/java/org/apache/cassandra/utils/EstimatedHistogram.java
@@ -40,8 +40,7 @@ public class EstimatedHistogram
 
     public EstimatedHistogram()
     {
-        makeOffsets(90);
-        buckets = new AtomicLongArray(numBuckets);
+        this(90);
     }
 
     public EstimatedHistogram(int bucketCount)
@@ -118,10 +117,14 @@ public class EstimatedHistogram
 
     public long max()
     {
-        for (int i = numBuckets - 1; i >= 0; i--)
+        int lastBucket = numBuckets - 1;
+        if (buckets.get(lastBucket) > 0)
+            throw new IllegalStateException("Unable to compute ceiling for max when all buckets are full");
+
+        for (int i = lastBucket - 1; i >= 0; i--)
         {
             if (buckets.get(i) > 0)
-                return bucketOffsets[i == 0 ? 0 : i - 1];
+                return bucketOffsets[i];
         }
         return 0;
     }
diff --git a/test/unit/org/apache/cassandra/utils/EstimatedHistogramTest.java b/test/unit/org/apache/cassandra/utils/EstimatedHistogramTest.java
index c99d921d16..4bb1652440 100644
--- a/test/unit/org/apache/cassandra/utils/EstimatedHistogramTest.java
+++ b/test/unit/org/apache/cassandra/utils/EstimatedHistogramTest.java
@@ -33,8 +33,8 @@ public class EstimatedHistogramTest
         histogram.add(0L);
         assertEquals(1, histogram.get(false)[0]);
 
-        histogram.add(33282687);
-        assertEquals(1, histogram.get(false)[histogram.buckets.length()-1]);
+        histogram.add(23282687);
+        assertEquals(1, histogram.get(false)[histogram.buckets.length() - 2]);
 
         histogram.add(1);
         assertEquals(1, histogram.get(false)[1]);
