diff --git a/CHANGES.txt b/CHANGES.txt
index 73f1aeb0c0..b7bb767f20 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -4,6 +4,8 @@ dev
  * add back percentage option for cache size configuration, and replace
    SnakeYAML with YamlBeans (CASSANDRA-1313)
  * restore use of mmap_index_only option (CASSANDRA-1241)
+ * dropping a keyspace with no column families generated an error 
+   (CASSANDRA-1378)
 
 
 0.7-beta1
diff --git a/src/java/org/apache/cassandra/db/CompactionManager.java b/src/java/org/apache/cassandra/db/CompactionManager.java
index 9a86b2548a..c3604a7471 100644
--- a/src/java/org/apache/cassandra/db/CompactionManager.java
+++ b/src/java/org/apache/cassandra/db/CompactionManager.java
@@ -86,6 +86,9 @@ public class CompactionManager implements CompactionManagerMBean
             {
                 logger.debug("Cleaning up abandoned column families...");
                 ColumnFamily dropped = SystemTable.getDroppedCFs();
+                if (dropped == null)
+                    // there is nothing that needs to be cleaned up.
+                    return null;
                 Collection<IColumn> successes = new ArrayList<IColumn>();
                 for (IColumn col : dropped.getSortedColumns())
                 {
diff --git a/test/system/test_thrift_server.py b/test/system/test_thrift_server.py
index 507ba8f746..26a9a50816 100644
--- a/test/system/test_thrift_server.py
+++ b/test/system/test_thrift_server.py
@@ -1176,6 +1176,19 @@ class TestMutations(ThriftTester):
         def get_second_ks():
             client.describe_keyspace('RenameKeyspace')
         _expect_exception(get_second_ks, NotFoundException)
+    
+    def test_create_then_drop_ks(self):
+        keyspace = KsDef('AddThenDrop', 
+                strategy_class='org.apache.cassandra.locator.RackUnawareStrategy',
+                replication_factor=1,
+                cf_defs=[])
+        def test_existence():
+            client.describe_keyspace(keyspace.name)
+        _expect_exception(test_existence, NotFoundException)
+        client.set_keyspace('system')
+        client.system_add_keyspace(keyspace)
+        test_existence()
+        client.system_drop_keyspace(keyspace.name)
 
     def test_column_validators(self):
         ks = 'Keyspace1'
