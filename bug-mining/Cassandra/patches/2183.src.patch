diff --git a/CHANGES.txt b/CHANGES.txt
index d283b720c8..2b6e38f2ba 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -53,6 +53,7 @@
 
 
 1.2.6
+ * Fix dealing with ridiculously large max sstable sizes in LCS (CASSANDRA-5589)
  * Ignore pre-truncate hints (CASSANDRA-4655)
  * Move System.exit on OOM into a separate thread (CASSANDRA-5273)
  * Write row markers when serializing schema (CASSANDRA-5572)
diff --git a/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java b/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java
index 2f1c1e8188..d29deadfff 100644
--- a/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java
+++ b/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java
@@ -58,6 +58,11 @@ public class LeveledCompactionStrategy extends AbstractCompactionStrategy implem
         {
             String value = options.containsKey(SSTABLE_SIZE_OPTION) ? options.get(SSTABLE_SIZE_OPTION) : "5";
             configuredMaxSSTableSize = Integer.parseInt(value);
+            if (configuredMaxSSTableSize >= 1000)
+            {
+                // Yes, people have done this
+                logger.warn("Max sstable size of {}MB is configured; having a unit of compaction this large is probably a bad idea", configuredMaxSSTableSize);
+            }
         }
         maxSSTableSizeInMB = configuredMaxSSTableSize;
 
diff --git a/src/java/org/apache/cassandra/db/compaction/LeveledManifest.java b/src/java/org/apache/cassandra/db/compaction/LeveledManifest.java
index fb4244ddc6..f43c13e60f 100644
--- a/src/java/org/apache/cassandra/db/compaction/LeveledManifest.java
+++ b/src/java/org/apache/cassandra/db/compaction/LeveledManifest.java
@@ -65,8 +65,10 @@ public class LeveledManifest
         this.maxSSTableSizeInBytes = maxSSTableSizeInMB * 1024 * 1024;
         this.options = options;
 
-        // allocate enough generations for a PB of data
-        int n = (int) Math.log10(1000 * 1000 * 1000 / maxSSTableSizeInMB);
+        // allocate enough generations for a PB of data, with a 1-MB sstable size.  (Note that if maxSSTableSize is
+        // updated, we will still have sstables of the older, potentially smaller size.  So don't make this
+        // dependent on maxSSTableSize.)
+        int n = (int) Math.log10(1000 * 1000 * 1000);
         generations = new List[n];
         lastCompactedKeys = new RowPosition[n];
         for (int i = 0; i < generations.length; i++)
