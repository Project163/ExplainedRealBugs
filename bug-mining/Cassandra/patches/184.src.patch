diff --git a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
index c51f6467a9..257534a9b4 100644
--- a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
+++ b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
@@ -47,6 +47,8 @@ import org.apache.cassandra.db.marshal.AbstractType;
 import org.apache.commons.lang.StringUtils;
 import org.apache.commons.lang.ArrayUtils;
 import org.apache.commons.collections.IteratorUtils;
+import org.apache.commons.collections.PredicateUtils;
+import org.apache.commons.collections.iterators.FilterIterator;
 
 import org.cliffc.high_scale_lib.NonBlockingHashMap;
 
@@ -473,7 +475,7 @@ public final class ColumnFamilyStore implements ColumnFamilyStoreMBean
         return (int)(System.currentTimeMillis() / 1000) - DatabaseDescriptor.getGcGraceInSeconds();
     }
 
-    static ColumnFamily removeDeleted(ColumnFamily cf, int gcBefore)
+    public static ColumnFamily removeDeleted(ColumnFamily cf, int gcBefore)
     {
         if (cf == null)
         {
@@ -664,7 +666,9 @@ public final class ColumnFamilyStore implements ColumnFamilyStoreMBean
         {
             sstables = ssTables_.getSSTables();
         }
-        doFileCompaction(sstables);
+
+        if (sstables.size() > 1)
+            doFileCompaction(sstables);
     }
 
     /*
@@ -773,7 +777,7 @@ public final class ColumnFamilyStore implements ColumnFamilyStoreMBean
           logger_.debug("Expected bloom filter size : " + expectedBloomFilterSize);
 
         SSTableWriter writer = null;
-        CompactionIterator ci = new CompactionIterator(sstables);
+        CompactionIterator ci = new CompactionIterator(sstables, getDefaultGCBefore());
 
         try
         {
@@ -819,6 +823,11 @@ public final class ColumnFamilyStore implements ColumnFamilyStoreMBean
         return results;
     }
 
+    private int doFileCompaction(Collection<SSTableReader> sstables) throws IOException
+    {
+        return doFileCompaction(sstables, getDefaultGCBefore());
+    }
+
     /*
     * This function does the actual compaction for files.
     * It maintains a priority queue of with the first key from each file
@@ -830,7 +839,7 @@ public final class ColumnFamilyStore implements ColumnFamilyStoreMBean
     * to get the latest data.
     *
     */
-    private int doFileCompaction(Collection<SSTableReader> sstables) throws IOException
+    int doFileCompaction(Collection<SSTableReader> sstables, int gcBefore) throws IOException
     {
         if (DatabaseDescriptor.isSnapshotBeforeCompaction())
             Table.open(table_).snapshot("compact-" + columnFamily_);
@@ -855,7 +864,8 @@ public final class ColumnFamilyStore implements ColumnFamilyStoreMBean
           logger_.debug("Expected bloom filter size : " + expectedBloomFilterSize);
 
         SSTableWriter writer;
-        CompactionIterator ci = new CompactionIterator(sstables);
+        CompactionIterator ci = new CompactionIterator(sstables, gcBefore); // retain a handle so we can call close()
+        Iterator nni = new FilterIterator(ci, PredicateUtils.notNullPredicate());
 
         try
         {
@@ -868,9 +878,9 @@ public final class ColumnFamilyStore implements ColumnFamilyStoreMBean
             String newFilename = new File(compactionFileLocation, getTempSSTableFileName()).getAbsolutePath();
             writer = new SSTableWriter(newFilename, expectedBloomFilterSize, StorageService.getPartitioner());
 
-            while (ci.hasNext())
+            while (nni.hasNext())
             {
-                CompactionIterator.CompactedRow row = ci.next();
+                CompactionIterator.CompactedRow row = (CompactionIterator.CompactedRow) nni.next();
                 writer.append(row.key, row.buffer);
                 totalkeysWritten++;
             }
diff --git a/src/java/org/apache/cassandra/io/CompactionIterator.java b/src/java/org/apache/cassandra/io/CompactionIterator.java
index 513873de09..ded73c3827 100644
--- a/src/java/org/apache/cassandra/io/CompactionIterator.java
+++ b/src/java/org/apache/cassandra/io/CompactionIterator.java
@@ -11,15 +11,18 @@ import org.apache.commons.collections.iterators.CollatingIterator;
 import org.apache.cassandra.utils.ReducingIterator;
 import org.apache.cassandra.db.ColumnFamily;
 import org.apache.cassandra.db.DecoratedKey;
+import org.apache.cassandra.db.ColumnFamilyStore;
 
 public class CompactionIterator extends ReducingIterator<IteratingRow, CompactionIterator.CompactedRow> implements Closeable
 {
     private final List<IteratingRow> rows = new ArrayList<IteratingRow>();
+    private final int gcBefore;
 
     @SuppressWarnings("unchecked")
-    public CompactionIterator(Iterable<SSTableReader> sstables) throws IOException
+    public CompactionIterator(Iterable<SSTableReader> sstables, int gcBefore) throws IOException
     {
         super(getCollatingIterator(sstables));
+        this.gcBefore = gcBefore;
     }
 
     @SuppressWarnings("unchecked")
@@ -81,7 +84,10 @@ public class CompactionIterator extends ReducingIterator<IteratingRow, Compactio
                     cf.addAll(row.getColumnFamily());
                 }
             }
-            ColumnFamily.serializer().serializeWithIndexes(cf, buffer);
+            ColumnFamily cfPurged = ColumnFamilyStore.removeDeleted(cf, gcBefore);
+            if (cfPurged == null)
+                return null;
+            ColumnFamily.serializer().serializeWithIndexes(cfPurged, buffer);
         }
         else
         {
diff --git a/src/java/org/apache/cassandra/io/SSTable.java b/src/java/org/apache/cassandra/io/SSTable.java
index f673ca7dac..57dfff0983 100644
--- a/src/java/org/apache/cassandra/io/SSTable.java
+++ b/src/java/org/apache/cassandra/io/SSTable.java
@@ -173,4 +173,12 @@ public abstract class SSTable
             return key + ":" + position;
         }
     }
+
+    @Override
+    public String toString()
+    {
+        return getClass().getName() + "(" +
+               "path='" + path + '\'' +
+               ')';
+    }
 }
diff --git a/test/unit/org/apache/cassandra/db/CompactionsTest.java b/test/unit/org/apache/cassandra/db/CompactionsTest.java
index 8e3ab40c5c..4bfe855f75 100644
--- a/test/unit/org/apache/cassandra/db/CompactionsTest.java
+++ b/test/unit/org/apache/cassandra/db/CompactionsTest.java
@@ -29,6 +29,7 @@ import org.junit.Test;
 import org.apache.cassandra.io.SSTableReader;
 import org.apache.cassandra.CleanupHelper;
 import org.apache.cassandra.db.filter.QueryPath;
+import org.apache.cassandra.db.filter.IdentityQueryFilter;
 import static junit.framework.Assert.assertEquals;
 
 public class CompactionsTest extends CleanupHelper
@@ -65,4 +66,46 @@ public class CompactionsTest extends CleanupHelper
         }
         assertEquals(inserted.size(), table.getColumnFamilyStore("Standard1").getKeyRange("", "", 10000).keys.size());
     }
+
+    @Test
+    public void testCompactionPurge() throws IOException, ExecutionException, InterruptedException
+    {
+        Table table = Table.open("Keyspace1");
+        ColumnFamilyStore store = table.getColumnFamilyStore("Standard1");
+
+        String key = "key1";
+        RowMutation rm;
+
+        CompactionManager.instance().disableCompactions();
+
+        // inserts
+        rm = new RowMutation("Keyspace1", key);
+        for (int i = 0; i < 10; i++)
+        {
+            rm.add(new QueryPath("Standard1", null, String.valueOf(i).getBytes()), new byte[0], 0);
+        }
+        rm.apply();
+        store.forceBlockingFlush();
+
+        // deletes
+        for (int i = 0; i < 10; i++)
+        {
+            rm = new RowMutation("Keyspace1", key);
+            rm.delete(new QueryPath("Standard1", null, String.valueOf(i).getBytes()), 1);
+            rm.apply();
+        }
+        store.forceBlockingFlush();
+
+        // resurrect one row
+        rm = new RowMutation("Keyspace1", key);
+        rm.add(new QueryPath("Standard1", null, String.valueOf(5).getBytes()), new byte[0], 2);
+        rm.apply();
+        store.forceBlockingFlush();
+
+        // compact and test that all columns but the resurrected one is completely gone
+        store.doFileCompaction(store.getSSTables(), Integer.MAX_VALUE);
+        ColumnFamily cf = table.getColumnFamilyStore("Standard1").getColumnFamily(new IdentityQueryFilter(key, new QueryPath("Standard1")));
+        assert cf.getColumnCount() == 1;
+        assert cf.getColumn(String.valueOf(5).getBytes()) != null;
+    }
 }
