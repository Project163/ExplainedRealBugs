diff --git a/src/java/org/apache/cassandra/db/HintedHandOffManager.java b/src/java/org/apache/cassandra/db/HintedHandOffManager.java
index 6e9d3397ae..4f26803fc8 100644
--- a/src/java/org/apache/cassandra/db/HintedHandOffManager.java
+++ b/src/java/org/apache/cassandra/db/HintedHandOffManager.java
@@ -39,9 +39,14 @@ import org.apache.cassandra.service.*;
 
 
 /**
- * Author : Avinash Lakshman ( alakshman@facebook.com) & Prashant Malik ( pmalik@facebook.com )
+ * There are two ways hinted data gets delivered to the intended nodes.
+ *
+ * runHints() runs periodically and pushes the hinted data on this node to
+ * every intended node.
+ *
+ * runDelieverHints() is called when some other node starts up (potentially
+ * from a failure) and delivers the hinted data just to that node.
  */
-
 public class HintedHandOffManager implements IComponentShutdown
 {
     private static HintedHandOffManager instance_;
@@ -70,184 +75,153 @@ public class HintedHandOffManager implements IComponentShutdown
         return instance_;
     }
 
-    class HintedHandOff implements Runnable
+    private static boolean sendMessage(String endpointAddress, String key) throws DigestMismatchException, TimeoutException, IOException
     {
-        private ColumnFamilyStore columnFamilyStore_ = null;
-        private EndPoint endPoint_ = null;
-
-        HintedHandOff(ColumnFamilyStore columnFamilyStore)
-        {
-        	columnFamilyStore_ = columnFamilyStore;
-        }
-        HintedHandOff(EndPoint endPoint)
+        EndPoint endPoint = new EndPoint(endpointAddress, DatabaseDescriptor.getStoragePort());
+        if (!FailureDetector.instance().isAlive(endPoint))
         {
-        	endPoint_ = endPoint;
+            return false;
         }
 
-        private boolean sendMessage(String endpointAddress, String key) throws DigestMismatchException, TimeoutException, IOException
-        {
-            EndPoint endPoint = new EndPoint(endpointAddress, DatabaseDescriptor.getStoragePort());
-            if (!FailureDetector.instance().isAlive(endPoint))
-            {
-                return false;
-            }
+        Table table = Table.open(DatabaseDescriptor.getTables().get(0));
+        Row row = table.get(key);
+        RowMutation rm = new RowMutation(DatabaseDescriptor.getTables().get(0), row);
+        Message message = rm.makeRowMutationMessage();
 
-            Table table = Table.open(DatabaseDescriptor.getTables().get(0));
-            Row row = table.get(key);
-            RowMutation rm = new RowMutation(DatabaseDescriptor.getTables().get(0), row);
-            Message message = rm.makeRowMutationMessage();
+        QuorumResponseHandler<Boolean> quorumResponseHandler = new QuorumResponseHandler<Boolean>(1, new WriteResponseResolver());
+        MessagingService.getMessagingInstance().sendRR(message, new EndPoint[]{ endPoint }, quorumResponseHandler);
+        return quorumResponseHandler.get();
+    }
 
-            QuorumResponseHandler<Boolean> quorumResponseHandler = new QuorumResponseHandler<Boolean>(1, new WriteResponseResolver());
-            MessagingService.getMessagingInstance().sendRR(message, new EndPoint[]{ endPoint }, quorumResponseHandler);
-            return quorumResponseHandler.get();
-        }
+    private static void deleteEndPoint(String endpointAddress, String key) throws Exception
+    {
+        RowMutation rm = new RowMutation(DatabaseDescriptor.getTables().get(0), key_);
+        rm.delete(Table.hints_ + ":" + key + ":" + endpointAddress, System.currentTimeMillis());
+        rm.apply();
+    }
 
-        private void deleteEndPoint(String endpointAddress, String key) throws Exception
-        {
-        	RowMutation rm = new RowMutation(DatabaseDescriptor.getTables().get(0), key_);
-        	rm.delete(Table.hints_ + ":" + key + ":" + endpointAddress, System.currentTimeMillis());
-        	rm.apply();
-        }
+    private static void deleteKey(String key) throws Exception
+    {
+        // delete the hint record
+        RowMutation rm = new RowMutation(DatabaseDescriptor.getTables().get(0), key_);
+        rm.delete(Table.hints_ + ":" + key, System.currentTimeMillis());
+        rm.apply();
+    }
 
-        private void deleteKey(String key) throws Exception
-        {
-        	RowMutation rm = new RowMutation(DatabaseDescriptor.getTables().get(0), key_);
-        	rm.delete(Table.hints_ + ":" + key, System.currentTimeMillis());
-        	rm.apply();
-        }
+    private static void deliverAllHints(ColumnFamilyStore columnFamilyStore)
+    {
+        logger_.debug("Started hinted handoff of " + columnFamilyStore.columnFamily_);
 
-        private void runHints()
+        // 1. Scan through all the keys that we need to handoff
+        // 2. For each key read the list of recepients and send
+        // 3. Delete that recepient from the key if write was successful
+        // 4. If all writes were success for a given key we can even delete the key .
+        // 5. Now force a flush
+        // 6. Do major compaction to clean up all deletes etc.
+        // 7. I guess we r done
+        Table table = Table.open(DatabaseDescriptor.getTables().get(0));
+        ColumnFamily hintColumnFamily = null;
+        try
         {
-            logger_.debug("Started  hinted handoff " + columnFamilyStore_.columnFamily_);
-
-            // 1. Scan through all the keys that we need to handoff
-            // 2. For each key read the list of recepients and send
-            // 3. Delete that recepient from the key if write was successful
-            // 4. If all writes were success for a given key we can even delete the key .
-            // 5. Now force a flush
-            // 6. Do major compaction to clean up all deletes etc.
-            // 7. I guess we r done
-            Table table =  Table.open(DatabaseDescriptor.getTables().get(0));
-            ColumnFamily hintedColumnFamily = null;
-            boolean success = false;
-            boolean allsuccess = true;
-            try
+            hintColumnFamily = table.get(key_, Table.hints_);
+            if (hintColumnFamily == null)
             {
-            	hintedColumnFamily = table.get(key_, Table.hints_);
-            	if(hintedColumnFamily == null)
-            	{
-                    // Force flush now
-                    columnFamilyStore_.forceFlush();
-            		return;
-            	}
-            	Collection<IColumn> keys = hintedColumnFamily.getAllColumns();
-            	if(keys != null)
-            	{
-                	for(IColumn key : keys)
-                	{
-                		// Get all the endpoints for teh key
-                		Collection<IColumn> endpoints =  key.getSubColumns();
-                		allsuccess = true;
-                		if ( endpoints != null )
-                		{
-                			for(IColumn endpoint : endpoints )
-                			{
-                				success = sendMessage(endpoint.name(), key.name());
-                				if(success)
-                				{
-                					// Delete the endpoint from the list
-                					deleteEndPoint(endpoint.name(), key.name());
-                				}
-                				else
-                				{
-                					allsuccess = false;
-                				}
-                			}
-                		}
-                		if(endpoints == null || allsuccess)
-                		{
-                			// Delete the key itself.
-                			deleteKey(key.name());
-                		}
-                	}
-            	}
-                // Force flush now
-                columnFamilyStore_.forceFlush();
-
-                // Now do a major compaction
-                columnFamilyStore_.forceCompaction(null, null, 0, null);
+                columnFamilyStore.forceFlush();
+                return;
             }
-            catch ( Exception ex)
+            Collection<IColumn> keys = hintColumnFamily.getAllColumns();
+            if (keys == null)
             {
-            	logger_.warn(ex.getMessage());
+                return;
             }
-            logger_.debug("Finished hinted handoff ..."+columnFamilyStore_.columnFamily_);
-        }
 
-        private void runDeliverHints(EndPoint to)
+            for (IColumn keyColumn : keys)
+            {
+                Collection<IColumn> endpoints = keyColumn.getSubColumns();
+                // endpoints could be null if the server were terminated during a previous runHints
+                // after deleteEndPoint but before deleteKey.
+                boolean allsuccess = true;
+                if (endpoints != null)
+                {
+                    for (IColumn endpoint : endpoints)
+                    {
+                        if (sendMessage(endpoint.name(), keyColumn.name()))
+                        {
+                            deleteEndPoint(endpoint.name(), keyColumn.name());
+                        }
+                        else
+                        {
+                            allsuccess = false;
+                        }
+                    }
+                }
+                if (allsuccess)
+                {
+                    deleteKey(keyColumn.name());
+                }
+            }
+            columnFamilyStore.forceFlush();
+            columnFamilyStore.forceCompaction(null, null, 0, null);
+        }
+        catch (Exception ex)
         {
-            logger_.debug("Started  hinted handoff for endPoint " + endPoint_.getHost());
+            logger_.error(ex.getMessage());
+        }
+        finally
+        {
+            logger_.debug("Finished hinted handoff of " + columnFamilyStore.columnFamily_);
+        }
+    }
 
-            // 1. Scan through all the keys that we need to handoff
-            // 2. For each key read the list of recepients if teh endpoint matches send
-            // 3. Delete that recepient from the key if write was successful
+    private static void deliverHintsToEndpoint(EndPoint endPoint)
+    {
+        logger_.debug("Started hinted handoff for endPoint " + endPoint.getHost());
 
-            Table table =  Table.open(DatabaseDescriptor.getTables().get(0));
-            ColumnFamily hintedColumnFamily = null;
-            boolean success = false;
-            try
+        // 1. Scan through all the keys that we need to handoff
+        // 2. For each key read the list of recepients if teh endpoint matches send
+        // 3. Delete that recepient from the key if write was successful
+        Table table = Table.open(DatabaseDescriptor.getTables().get(0));
+        ColumnFamily hintedColumnFamily = null;
+        try
+        {
+            hintedColumnFamily = table.get(key_, Table.hints_);
+            if (hintedColumnFamily == null)
             {
-            	hintedColumnFamily = table.get(key_, Table.hints_);
-            	if(hintedColumnFamily == null)
-            		return;
-            	Collection<IColumn> keys = hintedColumnFamily.getAllColumns();
-            	if(keys != null)
-            	{
-                	for(IColumn key : keys)
-                	{
-                		// Get all the endpoints for teh key
-                		Collection<IColumn> endpoints =  key.getSubColumns();
-                		if ( endpoints != null )
-                		{
-                			for(IColumn endpoint : endpoints )
-                			{
-                				if(endpoint.name().equals(endPoint_.getHost()))
-                				{
-	                				success = sendMessage(endpoint.name(), key.name());
-	                				if(success)
-	                				{
-	                					// Delete the endpoint from the list
-	                					deleteEndPoint(endpoint.name(), key.name());
-	                				}
-                				}
-                			}
-                		}
-                		if(endpoints == null)
-                		{
-                			// Delete the key itself.
-                			deleteKey(key.name());
-                		}
-                	}
-            	}
+                return;
             }
-            catch ( Exception ex)
+            Collection<IColumn> keys = hintedColumnFamily.getAllColumns();
+            if (keys == null)
             {
-            	logger_.warn(ex.getMessage());
+                return;
             }
-            logger_.debug("Finished hinted handoff for endpoint ..." + endPoint_.getHost());
-        }
 
-        public void run()
+            for (IColumn keyColumn : keys)
+            {
+                Collection<IColumn> endpoints = keyColumn.getSubColumns();
+                if (endpoints == null)
+                {
+                    deleteKey(keyColumn.name());
+                    continue;
+                }
+                for (IColumn endpoint : endpoints)
+                {
+                    if (endpoint.name().equals(endPoint.getHost()))
+                    {
+                        if (sendMessage(endpoint.name(), keyColumn.name()))
+                        {
+                            deleteEndPoint(endpoint.name(), keyColumn.name());
+                        }
+                    }
+                }
+            }
+        }
+        catch (Exception ex)
         {
-        	if(endPoint_ == null)
-        	{
-        		runHints();
-        	}
-        	else
-        	{
-        		runDeliverHints(endPoint_);
-        	}
-
+            logger_.error(ex.getMessage());
+        }
+        finally
+        {
+            logger_.debug("Finished hinted handoff for endpoint " + endPoint.getHost());
         }
     }
 
@@ -256,10 +230,16 @@ public class HintedHandOffManager implements IComponentShutdown
     	StorageService.instance().registerComponentForShutdown(this);
     }
 
-    public void submit(ColumnFamilyStore columnFamilyStore)
+    public void submit(final ColumnFamilyStore columnFamilyStore)
     {
-    	executor_.scheduleWithFixedDelay(new HintedHandOff(columnFamilyStore), HintedHandOffManager.intervalInMins_,
-    			HintedHandOffManager.intervalInMins_, TimeUnit.MINUTES);
+        Runnable r = new Runnable()
+        {
+            public void run()
+            {
+                deliverAllHints(columnFamilyStore);
+            }
+        };
+    	executor_.scheduleWithFixedDelay(r, HintedHandOffManager.intervalInMins_, HintedHandOffManager.intervalInMins_, TimeUnit.MINUTES);
     }
 
     /*
@@ -267,9 +247,16 @@ public class HintedHandOffManager implements IComponentShutdown
      * When we learn that some endpoint is back up we deliver the data
      * to him via an event driven mechanism.
     */
-    public void deliverHints(EndPoint to)
+    public void deliverHints(final EndPoint to)
     {
-    	executor_.submit(new HintedHandOff(to));
+        Runnable r = new Runnable()
+        {
+            public void run()
+            {
+                deliverHintsToEndpoint(to);
+            }
+        };
+    	executor_.submit(r);
     }
 
     public void shutdown()
diff --git a/src/java/org/apache/cassandra/db/MinorCompactionManager.java b/src/java/org/apache/cassandra/db/MinorCompactionManager.java
index ef69e5c153..c27bdf9437 100644
--- a/src/java/org/apache/cassandra/db/MinorCompactionManager.java
+++ b/src/java/org/apache/cassandra/db/MinorCompactionManager.java
@@ -31,15 +31,11 @@ import java.util.concurrent.locks.ReentrantLock;
 
 import org.apache.cassandra.concurrent.DebuggableScheduledThreadPoolExecutor;
 import org.apache.cassandra.concurrent.ThreadFactoryImpl;
-import org.apache.cassandra.db.HintedHandOffManager.HintedHandOff;
 import org.apache.cassandra.dht.Range;
 import org.apache.cassandra.net.EndPoint;
 import org.apache.cassandra.service.IComponentShutdown;
 import org.apache.cassandra.service.StorageService;
-import org.apache.cassandra.utils.BloomFilter;
-import org.apache.cassandra.utils.LogUtil;
 import org.apache.log4j.Logger;
-import org.apache.cassandra.concurrent.*;
 
 /**
  * Author : Avinash Lakshman ( alakshman@facebook.com) & Prashant Malik ( pmalik@facebook.com )
