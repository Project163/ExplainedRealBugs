diff --git a/interface/cassandra.thrift b/interface/cassandra.thrift
index 03c968c7be..d31c1a2f4b 100644
--- a/interface/cassandra.thrift
+++ b/interface/cassandra.thrift
@@ -342,10 +342,19 @@ struct Mutation {
     2: optional Deletion deletion,
 }
 
+/**
+    A TokenRange describes part of the Cassandra ring, it is a mapping from a range to
+    endpoints responsible for that range.
+    @param start_token The first token in the range
+    @param end_token The last token in the range
+    @param endpoints The endpoints responsible for the range (listed by their configured listen_address)
+    @param rpc_endpoints The endpoints responsible for the range (listed by their configured rpc_address)
+*/
 struct TokenRange {
     1: required string start_token,
     2: required string end_token,
     3: required list<string> endpoints,
+    4: optional list<string> rpc_endpoints
 }
 
 /**
diff --git a/interface/thrift/gen-java/org/apache/cassandra/thrift/AuthenticationRequest.java b/interface/thrift/gen-java/org/apache/cassandra/thrift/AuthenticationRequest.java
index 1cec461883..2aa2378905 100644
--- a/interface/thrift/gen-java/org/apache/cassandra/thrift/AuthenticationRequest.java
+++ b/interface/thrift/gen-java/org/apache/cassandra/thrift/AuthenticationRequest.java
@@ -308,15 +308,15 @@ public class AuthenticationRequest implements org.apache.thrift.TBase<Authentica
         case 1: // CREDENTIALS
           if (field.type == org.apache.thrift.protocol.TType.MAP) {
             {
-              org.apache.thrift.protocol.TMap _map24 = iprot.readMapBegin();
-              this.credentials = new HashMap<String,String>(2*_map24.size);
-              for (int _i25 = 0; _i25 < _map24.size; ++_i25)
+              org.apache.thrift.protocol.TMap _map28 = iprot.readMapBegin();
+              this.credentials = new HashMap<String,String>(2*_map28.size);
+              for (int _i29 = 0; _i29 < _map28.size; ++_i29)
               {
-                String _key26;
-                String _val27;
-                _key26 = iprot.readString();
-                _val27 = iprot.readString();
-                this.credentials.put(_key26, _val27);
+                String _key30;
+                String _val31;
+                _key30 = iprot.readString();
+                _val31 = iprot.readString();
+                this.credentials.put(_key30, _val31);
               }
               iprot.readMapEnd();
             }
@@ -343,10 +343,10 @@ public class AuthenticationRequest implements org.apache.thrift.TBase<Authentica
       oprot.writeFieldBegin(CREDENTIALS_FIELD_DESC);
       {
         oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.STRING, this.credentials.size()));
-        for (Map.Entry<String, String> _iter28 : this.credentials.entrySet())
+        for (Map.Entry<String, String> _iter32 : this.credentials.entrySet())
         {
-          oprot.writeString(_iter28.getKey());
-          oprot.writeString(_iter28.getValue());
+          oprot.writeString(_iter32.getKey());
+          oprot.writeString(_iter32.getValue());
         }
         oprot.writeMapEnd();
       }
diff --git a/interface/thrift/gen-java/org/apache/cassandra/thrift/Cassandra.java b/interface/thrift/gen-java/org/apache/cassandra/thrift/Cassandra.java
index 6be5d808cd..a5c2f75d1d 100644
--- a/interface/thrift/gen-java/org/apache/cassandra/thrift/Cassandra.java
+++ b/interface/thrift/gen-java/org/apache/cassandra/thrift/Cassandra.java
@@ -7736,14 +7736,14 @@ public class Cassandra {
           case 0: // SUCCESS
             if (field.type == org.apache.thrift.protocol.TType.LIST) {
               {
-                org.apache.thrift.protocol.TList _list75 = iprot.readListBegin();
-                this.success = new ArrayList<ColumnOrSuperColumn>(_list75.size);
-                for (int _i76 = 0; _i76 < _list75.size; ++_i76)
+                org.apache.thrift.protocol.TList _list79 = iprot.readListBegin();
+                this.success = new ArrayList<ColumnOrSuperColumn>(_list79.size);
+                for (int _i80 = 0; _i80 < _list79.size; ++_i80)
                 {
-                  ColumnOrSuperColumn _elem77;
-                  _elem77 = new ColumnOrSuperColumn();
-                  _elem77.read(iprot);
-                  this.success.add(_elem77);
+                  ColumnOrSuperColumn _elem81;
+                  _elem81 = new ColumnOrSuperColumn();
+                  _elem81.read(iprot);
+                  this.success.add(_elem81);
                 }
                 iprot.readListEnd();
               }
@@ -7793,9 +7793,9 @@ public class Cassandra {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, this.success.size()));
-          for (ColumnOrSuperColumn _iter78 : this.success)
+          for (ColumnOrSuperColumn _iter82 : this.success)
           {
-            _iter78.write(oprot);
+            _iter82.write(oprot);
           }
           oprot.writeListEnd();
         }
@@ -9597,13 +9597,13 @@ public class Cassandra {
           case 1: // KEYS
             if (field.type == org.apache.thrift.protocol.TType.LIST) {
               {
-                org.apache.thrift.protocol.TList _list79 = iprot.readListBegin();
-                this.keys = new ArrayList<ByteBuffer>(_list79.size);
-                for (int _i80 = 0; _i80 < _list79.size; ++_i80)
+                org.apache.thrift.protocol.TList _list83 = iprot.readListBegin();
+                this.keys = new ArrayList<ByteBuffer>(_list83.size);
+                for (int _i84 = 0; _i84 < _list83.size; ++_i84)
                 {
-                  ByteBuffer _elem81;
-                  _elem81 = iprot.readBinary();
-                  this.keys.add(_elem81);
+                  ByteBuffer _elem85;
+                  _elem85 = iprot.readBinary();
+                  this.keys.add(_elem85);
                 }
                 iprot.readListEnd();
               }
@@ -9653,9 +9653,9 @@ public class Cassandra {
         oprot.writeFieldBegin(KEYS_FIELD_DESC);
         {
           oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, this.keys.size()));
-          for (ByteBuffer _iter82 : this.keys)
+          for (ByteBuffer _iter86 : this.keys)
           {
-            oprot.writeBinary(_iter82);
+            oprot.writeBinary(_iter86);
           }
           oprot.writeListEnd();
         }
@@ -10244,26 +10244,26 @@ public class Cassandra {
           case 0: // SUCCESS
             if (field.type == org.apache.thrift.protocol.TType.MAP) {
               {
-                org.apache.thrift.protocol.TMap _map83 = iprot.readMapBegin();
-                this.success = new HashMap<ByteBuffer,List<ColumnOrSuperColumn>>(2*_map83.size);
-                for (int _i84 = 0; _i84 < _map83.size; ++_i84)
+                org.apache.thrift.protocol.TMap _map87 = iprot.readMapBegin();
+                this.success = new HashMap<ByteBuffer,List<ColumnOrSuperColumn>>(2*_map87.size);
+                for (int _i88 = 0; _i88 < _map87.size; ++_i88)
                 {
-                  ByteBuffer _key85;
-                  List<ColumnOrSuperColumn> _val86;
-                  _key85 = iprot.readBinary();
+                  ByteBuffer _key89;
+                  List<ColumnOrSuperColumn> _val90;
+                  _key89 = iprot.readBinary();
                   {
-                    org.apache.thrift.protocol.TList _list87 = iprot.readListBegin();
-                    _val86 = new ArrayList<ColumnOrSuperColumn>(_list87.size);
-                    for (int _i88 = 0; _i88 < _list87.size; ++_i88)
+                    org.apache.thrift.protocol.TList _list91 = iprot.readListBegin();
+                    _val90 = new ArrayList<ColumnOrSuperColumn>(_list91.size);
+                    for (int _i92 = 0; _i92 < _list91.size; ++_i92)
                     {
-                      ColumnOrSuperColumn _elem89;
-                      _elem89 = new ColumnOrSuperColumn();
-                      _elem89.read(iprot);
-                      _val86.add(_elem89);
+                      ColumnOrSuperColumn _elem93;
+                      _elem93 = new ColumnOrSuperColumn();
+                      _elem93.read(iprot);
+                      _val90.add(_elem93);
                     }
                     iprot.readListEnd();
                   }
-                  this.success.put(_key85, _val86);
+                  this.success.put(_key89, _val90);
                 }
                 iprot.readMapEnd();
               }
@@ -10313,14 +10313,14 @@ public class Cassandra {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.LIST, this.success.size()));
-          for (Map.Entry<ByteBuffer, List<ColumnOrSuperColumn>> _iter90 : this.success.entrySet())
+          for (Map.Entry<ByteBuffer, List<ColumnOrSuperColumn>> _iter94 : this.success.entrySet())
           {
-            oprot.writeBinary(_iter90.getKey());
+            oprot.writeBinary(_iter94.getKey());
             {
-              oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, _iter90.getValue().size()));
-              for (ColumnOrSuperColumn _iter91 : _iter90.getValue())
+              oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, _iter94.getValue().size()));
+              for (ColumnOrSuperColumn _iter95 : _iter94.getValue())
               {
-                _iter91.write(oprot);
+                _iter95.write(oprot);
               }
               oprot.writeListEnd();
             }
@@ -10908,13 +10908,13 @@ public class Cassandra {
           case 1: // KEYS
             if (field.type == org.apache.thrift.protocol.TType.LIST) {
               {
-                org.apache.thrift.protocol.TList _list92 = iprot.readListBegin();
-                this.keys = new ArrayList<ByteBuffer>(_list92.size);
-                for (int _i93 = 0; _i93 < _list92.size; ++_i93)
+                org.apache.thrift.protocol.TList _list96 = iprot.readListBegin();
+                this.keys = new ArrayList<ByteBuffer>(_list96.size);
+                for (int _i97 = 0; _i97 < _list96.size; ++_i97)
                 {
-                  ByteBuffer _elem94;
-                  _elem94 = iprot.readBinary();
-                  this.keys.add(_elem94);
+                  ByteBuffer _elem98;
+                  _elem98 = iprot.readBinary();
+                  this.keys.add(_elem98);
                 }
                 iprot.readListEnd();
               }
@@ -10964,9 +10964,9 @@ public class Cassandra {
         oprot.writeFieldBegin(KEYS_FIELD_DESC);
         {
           oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, this.keys.size()));
-          for (ByteBuffer _iter95 : this.keys)
+          for (ByteBuffer _iter99 : this.keys)
           {
-            oprot.writeBinary(_iter95);
+            oprot.writeBinary(_iter99);
           }
           oprot.writeListEnd();
         }
@@ -11551,15 +11551,15 @@ public class Cassandra {
           case 0: // SUCCESS
             if (field.type == org.apache.thrift.protocol.TType.MAP) {
               {
-                org.apache.thrift.protocol.TMap _map96 = iprot.readMapBegin();
-                this.success = new HashMap<ByteBuffer,Integer>(2*_map96.size);
-                for (int _i97 = 0; _i97 < _map96.size; ++_i97)
+                org.apache.thrift.protocol.TMap _map100 = iprot.readMapBegin();
+                this.success = new HashMap<ByteBuffer,Integer>(2*_map100.size);
+                for (int _i101 = 0; _i101 < _map100.size; ++_i101)
                 {
-                  ByteBuffer _key98;
-                  int _val99;
-                  _key98 = iprot.readBinary();
-                  _val99 = iprot.readI32();
-                  this.success.put(_key98, _val99);
+                  ByteBuffer _key102;
+                  int _val103;
+                  _key102 = iprot.readBinary();
+                  _val103 = iprot.readI32();
+                  this.success.put(_key102, _val103);
                 }
                 iprot.readMapEnd();
               }
@@ -11609,10 +11609,10 @@ public class Cassandra {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.I32, this.success.size()));
-          for (Map.Entry<ByteBuffer, Integer> _iter100 : this.success.entrySet())
+          for (Map.Entry<ByteBuffer, Integer> _iter104 : this.success.entrySet())
           {
-            oprot.writeBinary(_iter100.getKey());
-            oprot.writeI32(_iter100.getValue());
+            oprot.writeBinary(_iter104.getKey());
+            oprot.writeI32(_iter104.getValue());
           }
           oprot.writeMapEnd();
         }
@@ -12796,14 +12796,14 @@ public class Cassandra {
           case 0: // SUCCESS
             if (field.type == org.apache.thrift.protocol.TType.LIST) {
               {
-                org.apache.thrift.protocol.TList _list101 = iprot.readListBegin();
-                this.success = new ArrayList<KeySlice>(_list101.size);
-                for (int _i102 = 0; _i102 < _list101.size; ++_i102)
+                org.apache.thrift.protocol.TList _list105 = iprot.readListBegin();
+                this.success = new ArrayList<KeySlice>(_list105.size);
+                for (int _i106 = 0; _i106 < _list105.size; ++_i106)
                 {
-                  KeySlice _elem103;
-                  _elem103 = new KeySlice();
-                  _elem103.read(iprot);
-                  this.success.add(_elem103);
+                  KeySlice _elem107;
+                  _elem107 = new KeySlice();
+                  _elem107.read(iprot);
+                  this.success.add(_elem107);
                 }
                 iprot.readListEnd();
               }
@@ -12853,9 +12853,9 @@ public class Cassandra {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, this.success.size()));
-          for (KeySlice _iter104 : this.success)
+          for (KeySlice _iter108 : this.success)
           {
-            _iter104.write(oprot);
+            _iter108.write(oprot);
           }
           oprot.writeListEnd();
         }
@@ -14039,14 +14039,14 @@ public class Cassandra {
           case 0: // SUCCESS
             if (field.type == org.apache.thrift.protocol.TType.LIST) {
               {
-                org.apache.thrift.protocol.TList _list105 = iprot.readListBegin();
-                this.success = new ArrayList<KeySlice>(_list105.size);
-                for (int _i106 = 0; _i106 < _list105.size; ++_i106)
+                org.apache.thrift.protocol.TList _list109 = iprot.readListBegin();
+                this.success = new ArrayList<KeySlice>(_list109.size);
+                for (int _i110 = 0; _i110 < _list109.size; ++_i110)
                 {
-                  KeySlice _elem107;
-                  _elem107 = new KeySlice();
-                  _elem107.read(iprot);
-                  this.success.add(_elem107);
+                  KeySlice _elem111;
+                  _elem111 = new KeySlice();
+                  _elem111.read(iprot);
+                  this.success.add(_elem111);
                 }
                 iprot.readListEnd();
               }
@@ -14096,9 +14096,9 @@ public class Cassandra {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, this.success.size()));
-          for (KeySlice _iter108 : this.success)
+          for (KeySlice _iter112 : this.success)
           {
-            _iter108.write(oprot);
+            _iter112.write(oprot);
           }
           oprot.writeListEnd();
         }
@@ -17043,8 +17043,6 @@ public class Cassandra {
 
     private void readObject(java.io.ObjectInputStream in) throws java.io.IOException, ClassNotFoundException {
       try {
-        // it doesn't seem like you should have to do this, but java serialization is wacky, and doesn't call the default constructor.
-        __isset_bit_vector = new BitSet(1);
         read(new org.apache.thrift.protocol.TCompactProtocol(new org.apache.thrift.transport.TIOStreamTransport(in)));
       } catch (org.apache.thrift.TException te) {
         throw new java.io.IOException(te);
@@ -18943,38 +18941,38 @@ public class Cassandra {
           case 1: // MUTATION_MAP
             if (field.type == org.apache.thrift.protocol.TType.MAP) {
               {
-                org.apache.thrift.protocol.TMap _map109 = iprot.readMapBegin();
-                this.mutation_map = new HashMap<ByteBuffer,Map<String,List<Mutation>>>(2*_map109.size);
-                for (int _i110 = 0; _i110 < _map109.size; ++_i110)
+                org.apache.thrift.protocol.TMap _map113 = iprot.readMapBegin();
+                this.mutation_map = new HashMap<ByteBuffer,Map<String,List<Mutation>>>(2*_map113.size);
+                for (int _i114 = 0; _i114 < _map113.size; ++_i114)
                 {
-                  ByteBuffer _key111;
-                  Map<String,List<Mutation>> _val112;
-                  _key111 = iprot.readBinary();
+                  ByteBuffer _key115;
+                  Map<String,List<Mutation>> _val116;
+                  _key115 = iprot.readBinary();
                   {
-                    org.apache.thrift.protocol.TMap _map113 = iprot.readMapBegin();
-                    _val112 = new HashMap<String,List<Mutation>>(2*_map113.size);
-                    for (int _i114 = 0; _i114 < _map113.size; ++_i114)
+                    org.apache.thrift.protocol.TMap _map117 = iprot.readMapBegin();
+                    _val116 = new HashMap<String,List<Mutation>>(2*_map117.size);
+                    for (int _i118 = 0; _i118 < _map117.size; ++_i118)
                     {
-                      String _key115;
-                      List<Mutation> _val116;
-                      _key115 = iprot.readString();
+                      String _key119;
+                      List<Mutation> _val120;
+                      _key119 = iprot.readString();
                       {
-                        org.apache.thrift.protocol.TList _list117 = iprot.readListBegin();
-                        _val116 = new ArrayList<Mutation>(_list117.size);
-                        for (int _i118 = 0; _i118 < _list117.size; ++_i118)
+                        org.apache.thrift.protocol.TList _list121 = iprot.readListBegin();
+                        _val120 = new ArrayList<Mutation>(_list121.size);
+                        for (int _i122 = 0; _i122 < _list121.size; ++_i122)
                         {
-                          Mutation _elem119;
-                          _elem119 = new Mutation();
-                          _elem119.read(iprot);
-                          _val116.add(_elem119);
+                          Mutation _elem123;
+                          _elem123 = new Mutation();
+                          _elem123.read(iprot);
+                          _val120.add(_elem123);
                         }
                         iprot.readListEnd();
                       }
-                      _val112.put(_key115, _val116);
+                      _val116.put(_key119, _val120);
                     }
                     iprot.readMapEnd();
                   }
-                  this.mutation_map.put(_key111, _val112);
+                  this.mutation_map.put(_key115, _val116);
                 }
                 iprot.readMapEnd();
               }
@@ -19008,19 +19006,19 @@ public class Cassandra {
         oprot.writeFieldBegin(MUTATION_MAP_FIELD_DESC);
         {
           oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.MAP, this.mutation_map.size()));
-          for (Map.Entry<ByteBuffer, Map<String,List<Mutation>>> _iter120 : this.mutation_map.entrySet())
+          for (Map.Entry<ByteBuffer, Map<String,List<Mutation>>> _iter124 : this.mutation_map.entrySet())
           {
-            oprot.writeBinary(_iter120.getKey());
+            oprot.writeBinary(_iter124.getKey());
             {
-              oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.LIST, _iter120.getValue().size()));
-              for (Map.Entry<String, List<Mutation>> _iter121 : _iter120.getValue().entrySet())
+              oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.LIST, _iter124.getValue().size()));
+              for (Map.Entry<String, List<Mutation>> _iter125 : _iter124.getValue().entrySet())
               {
-                oprot.writeString(_iter121.getKey());
+                oprot.writeString(_iter125.getKey());
                 {
-                  oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, _iter121.getValue().size()));
-                  for (Mutation _iter122 : _iter121.getValue())
+                  oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, _iter125.getValue().size()));
+                  for (Mutation _iter126 : _iter125.getValue())
                   {
-                    _iter122.write(oprot);
+                    _iter126.write(oprot);
                   }
                   oprot.writeListEnd();
                 }
@@ -20835,25 +20833,25 @@ public class Cassandra {
           case 0: // SUCCESS
             if (field.type == org.apache.thrift.protocol.TType.MAP) {
               {
-                org.apache.thrift.protocol.TMap _map123 = iprot.readMapBegin();
-                this.success = new HashMap<String,List<String>>(2*_map123.size);
-                for (int _i124 = 0; _i124 < _map123.size; ++_i124)
+                org.apache.thrift.protocol.TMap _map127 = iprot.readMapBegin();
+                this.success = new HashMap<String,List<String>>(2*_map127.size);
+                for (int _i128 = 0; _i128 < _map127.size; ++_i128)
                 {
-                  String _key125;
-                  List<String> _val126;
-                  _key125 = iprot.readString();
+                  String _key129;
+                  List<String> _val130;
+                  _key129 = iprot.readString();
                   {
-                    org.apache.thrift.protocol.TList _list127 = iprot.readListBegin();
-                    _val126 = new ArrayList<String>(_list127.size);
-                    for (int _i128 = 0; _i128 < _list127.size; ++_i128)
+                    org.apache.thrift.protocol.TList _list131 = iprot.readListBegin();
+                    _val130 = new ArrayList<String>(_list131.size);
+                    for (int _i132 = 0; _i132 < _list131.size; ++_i132)
                     {
-                      String _elem129;
-                      _elem129 = iprot.readString();
-                      _val126.add(_elem129);
+                      String _elem133;
+                      _elem133 = iprot.readString();
+                      _val130.add(_elem133);
                     }
                     iprot.readListEnd();
                   }
-                  this.success.put(_key125, _val126);
+                  this.success.put(_key129, _val130);
                 }
                 iprot.readMapEnd();
               }
@@ -20887,14 +20885,14 @@ public class Cassandra {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.LIST, this.success.size()));
-          for (Map.Entry<String, List<String>> _iter130 : this.success.entrySet())
+          for (Map.Entry<String, List<String>> _iter134 : this.success.entrySet())
           {
-            oprot.writeString(_iter130.getKey());
+            oprot.writeString(_iter134.getKey());
             {
-              oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, _iter130.getValue().size()));
-              for (String _iter131 : _iter130.getValue())
+              oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, _iter134.getValue().size()));
+              for (String _iter135 : _iter134.getValue())
               {
-                oprot.writeString(_iter131);
+                oprot.writeString(_iter135);
               }
               oprot.writeListEnd();
             }
@@ -21493,14 +21491,14 @@ public class Cassandra {
           case 0: // SUCCESS
             if (field.type == org.apache.thrift.protocol.TType.LIST) {
               {
-                org.apache.thrift.protocol.TList _list132 = iprot.readListBegin();
-                this.success = new ArrayList<KsDef>(_list132.size);
-                for (int _i133 = 0; _i133 < _list132.size; ++_i133)
+                org.apache.thrift.protocol.TList _list136 = iprot.readListBegin();
+                this.success = new ArrayList<KsDef>(_list136.size);
+                for (int _i137 = 0; _i137 < _list136.size; ++_i137)
                 {
-                  KsDef _elem134;
-                  _elem134 = new KsDef();
-                  _elem134.read(iprot);
-                  this.success.add(_elem134);
+                  KsDef _elem138;
+                  _elem138 = new KsDef();
+                  _elem138.read(iprot);
+                  this.success.add(_elem138);
                 }
                 iprot.readListEnd();
               }
@@ -21534,9 +21532,9 @@ public class Cassandra {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, this.success.size()));
-          for (KsDef _iter135 : this.success)
+          for (KsDef _iter139 : this.success)
           {
-            _iter135.write(oprot);
+            _iter139.write(oprot);
           }
           oprot.writeListEnd();
         }
@@ -23249,14 +23247,14 @@ public class Cassandra {
           case 0: // SUCCESS
             if (field.type == org.apache.thrift.protocol.TType.LIST) {
               {
-                org.apache.thrift.protocol.TList _list136 = iprot.readListBegin();
-                this.success = new ArrayList<TokenRange>(_list136.size);
-                for (int _i137 = 0; _i137 < _list136.size; ++_i137)
+                org.apache.thrift.protocol.TList _list140 = iprot.readListBegin();
+                this.success = new ArrayList<TokenRange>(_list140.size);
+                for (int _i141 = 0; _i141 < _list140.size; ++_i141)
                 {
-                  TokenRange _elem138;
-                  _elem138 = new TokenRange();
-                  _elem138.read(iprot);
-                  this.success.add(_elem138);
+                  TokenRange _elem142;
+                  _elem142 = new TokenRange();
+                  _elem142.read(iprot);
+                  this.success.add(_elem142);
                 }
                 iprot.readListEnd();
               }
@@ -23290,9 +23288,9 @@ public class Cassandra {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, this.success.size()));
-          for (TokenRange _iter139 : this.success)
+          for (TokenRange _iter143 : this.success)
           {
-            _iter139.write(oprot);
+            _iter143.write(oprot);
           }
           oprot.writeListEnd();
         }
@@ -26094,13 +26092,13 @@ public class Cassandra {
           case 0: // SUCCESS
             if (field.type == org.apache.thrift.protocol.TType.LIST) {
               {
-                org.apache.thrift.protocol.TList _list140 = iprot.readListBegin();
-                this.success = new ArrayList<String>(_list140.size);
-                for (int _i141 = 0; _i141 < _list140.size; ++_i141)
+                org.apache.thrift.protocol.TList _list144 = iprot.readListBegin();
+                this.success = new ArrayList<String>(_list144.size);
+                for (int _i145 = 0; _i145 < _list144.size; ++_i145)
                 {
-                  String _elem142;
-                  _elem142 = iprot.readString();
-                  this.success.add(_elem142);
+                  String _elem146;
+                  _elem146 = iprot.readString();
+                  this.success.add(_elem146);
                 }
                 iprot.readListEnd();
               }
@@ -26134,9 +26132,9 @@ public class Cassandra {
         oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
         {
           oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, this.success.size()));
-          for (String _iter143 : this.success)
+          for (String _iter147 : this.success)
           {
-            oprot.writeString(_iter143);
+            oprot.writeString(_iter147);
           }
           oprot.writeListEnd();
         }
diff --git a/interface/thrift/gen-java/org/apache/cassandra/thrift/CfDef.java b/interface/thrift/gen-java/org/apache/cassandra/thrift/CfDef.java
index ccfc3086d2..fe8b965c5e 100644
--- a/interface/thrift/gen-java/org/apache/cassandra/thrift/CfDef.java
+++ b/interface/thrift/gen-java/org/apache/cassandra/thrift/CfDef.java
@@ -2232,14 +2232,14 @@ public class CfDef implements org.apache.thrift.TBase<CfDef, CfDef._Fields>, jav
         case 13: // COLUMN_METADATA
           if (field.type == org.apache.thrift.protocol.TType.LIST) {
             {
-              org.apache.thrift.protocol.TList _list34 = iprot.readListBegin();
-              this.column_metadata = new ArrayList<ColumnDef>(_list34.size);
-              for (int _i35 = 0; _i35 < _list34.size; ++_i35)
+              org.apache.thrift.protocol.TList _list38 = iprot.readListBegin();
+              this.column_metadata = new ArrayList<ColumnDef>(_list38.size);
+              for (int _i39 = 0; _i39 < _list38.size; ++_i39)
               {
-                ColumnDef _elem36;
-                _elem36 = new ColumnDef();
-                _elem36.read(iprot);
-                this.column_metadata.add(_elem36);
+                ColumnDef _elem40;
+                _elem40 = new ColumnDef();
+                _elem40.read(iprot);
+                this.column_metadata.add(_elem40);
               }
               iprot.readListEnd();
             }
@@ -2349,15 +2349,15 @@ public class CfDef implements org.apache.thrift.TBase<CfDef, CfDef._Fields>, jav
         case 30: // COMPACTION_STRATEGY_OPTIONS
           if (field.type == org.apache.thrift.protocol.TType.MAP) {
             {
-              org.apache.thrift.protocol.TMap _map37 = iprot.readMapBegin();
-              this.compaction_strategy_options = new HashMap<String,String>(2*_map37.size);
-              for (int _i38 = 0; _i38 < _map37.size; ++_i38)
+              org.apache.thrift.protocol.TMap _map41 = iprot.readMapBegin();
+              this.compaction_strategy_options = new HashMap<String,String>(2*_map41.size);
+              for (int _i42 = 0; _i42 < _map41.size; ++_i42)
               {
-                String _key39;
-                String _val40;
-                _key39 = iprot.readString();
-                _val40 = iprot.readString();
-                this.compaction_strategy_options.put(_key39, _val40);
+                String _key43;
+                String _val44;
+                _key43 = iprot.readString();
+                _val44 = iprot.readString();
+                this.compaction_strategy_options.put(_key43, _val44);
               }
               iprot.readMapEnd();
             }
@@ -2376,15 +2376,15 @@ public class CfDef implements org.apache.thrift.TBase<CfDef, CfDef._Fields>, jav
         case 32: // COMPRESSION_OPTIONS
           if (field.type == org.apache.thrift.protocol.TType.MAP) {
             {
-              org.apache.thrift.protocol.TMap _map41 = iprot.readMapBegin();
-              this.compression_options = new HashMap<String,String>(2*_map41.size);
-              for (int _i42 = 0; _i42 < _map41.size; ++_i42)
+              org.apache.thrift.protocol.TMap _map45 = iprot.readMapBegin();
+              this.compression_options = new HashMap<String,String>(2*_map45.size);
+              for (int _i46 = 0; _i46 < _map45.size; ++_i46)
               {
-                String _key43;
-                String _val44;
-                _key43 = iprot.readString();
-                _val44 = iprot.readString();
-                this.compression_options.put(_key43, _val44);
+                String _key47;
+                String _val48;
+                _key47 = iprot.readString();
+                _val48 = iprot.readString();
+                this.compression_options.put(_key47, _val48);
               }
               iprot.readMapEnd();
             }
@@ -2465,9 +2465,9 @@ public class CfDef implements org.apache.thrift.TBase<CfDef, CfDef._Fields>, jav
         oprot.writeFieldBegin(COLUMN_METADATA_FIELD_DESC);
         {
           oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, this.column_metadata.size()));
-          for (ColumnDef _iter45 : this.column_metadata)
+          for (ColumnDef _iter49 : this.column_metadata)
           {
-            _iter45.write(oprot);
+            _iter49.write(oprot);
           }
           oprot.writeListEnd();
         }
@@ -2554,10 +2554,10 @@ public class CfDef implements org.apache.thrift.TBase<CfDef, CfDef._Fields>, jav
         oprot.writeFieldBegin(COMPACTION_STRATEGY_OPTIONS_FIELD_DESC);
         {
           oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.STRING, this.compaction_strategy_options.size()));
-          for (Map.Entry<String, String> _iter46 : this.compaction_strategy_options.entrySet())
+          for (Map.Entry<String, String> _iter50 : this.compaction_strategy_options.entrySet())
           {
-            oprot.writeString(_iter46.getKey());
-            oprot.writeString(_iter46.getValue());
+            oprot.writeString(_iter50.getKey());
+            oprot.writeString(_iter50.getValue());
           }
           oprot.writeMapEnd();
         }
@@ -2574,10 +2574,10 @@ public class CfDef implements org.apache.thrift.TBase<CfDef, CfDef._Fields>, jav
         oprot.writeFieldBegin(COMPRESSION_OPTIONS_FIELD_DESC);
         {
           oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.STRING, this.compression_options.size()));
-          for (Map.Entry<String, String> _iter47 : this.compression_options.entrySet())
+          for (Map.Entry<String, String> _iter51 : this.compression_options.entrySet())
           {
-            oprot.writeString(_iter47.getKey());
-            oprot.writeString(_iter47.getValue());
+            oprot.writeString(_iter51.getKey());
+            oprot.writeString(_iter51.getValue());
           }
           oprot.writeMapEnd();
         }
diff --git a/interface/thrift/gen-java/org/apache/cassandra/thrift/ColumnDef.java b/interface/thrift/gen-java/org/apache/cassandra/thrift/ColumnDef.java
index 0d92f452bc..10a70f02fd 100644
--- a/interface/thrift/gen-java/org/apache/cassandra/thrift/ColumnDef.java
+++ b/interface/thrift/gen-java/org/apache/cassandra/thrift/ColumnDef.java
@@ -650,15 +650,15 @@ public class ColumnDef implements org.apache.thrift.TBase<ColumnDef, ColumnDef._
         case 5: // INDEX_OPTIONS
           if (field.type == org.apache.thrift.protocol.TType.MAP) {
             {
-              org.apache.thrift.protocol.TMap _map29 = iprot.readMapBegin();
-              this.index_options = new HashMap<String,String>(2*_map29.size);
-              for (int _i30 = 0; _i30 < _map29.size; ++_i30)
+              org.apache.thrift.protocol.TMap _map33 = iprot.readMapBegin();
+              this.index_options = new HashMap<String,String>(2*_map33.size);
+              for (int _i34 = 0; _i34 < _map33.size; ++_i34)
               {
-                String _key31;
-                String _val32;
-                _key31 = iprot.readString();
-                _val32 = iprot.readString();
-                this.index_options.put(_key31, _val32);
+                String _key35;
+                String _val36;
+                _key35 = iprot.readString();
+                _val36 = iprot.readString();
+                this.index_options.put(_key35, _val36);
               }
               iprot.readMapEnd();
             }
@@ -710,10 +710,10 @@ public class ColumnDef implements org.apache.thrift.TBase<ColumnDef, ColumnDef._
         oprot.writeFieldBegin(INDEX_OPTIONS_FIELD_DESC);
         {
           oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.STRING, this.index_options.size()));
-          for (Map.Entry<String, String> _iter33 : this.index_options.entrySet())
+          for (Map.Entry<String, String> _iter37 : this.index_options.entrySet())
           {
-            oprot.writeString(_iter33.getKey());
-            oprot.writeString(_iter33.getValue());
+            oprot.writeString(_iter37.getKey());
+            oprot.writeString(_iter37.getValue());
           }
           oprot.writeMapEnd();
         }
diff --git a/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlMetadata.java b/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlMetadata.java
index dcab531e94..e2f3256fea 100644
--- a/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlMetadata.java
+++ b/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlMetadata.java
@@ -554,15 +554,15 @@ public class CqlMetadata implements org.apache.thrift.TBase<CqlMetadata, CqlMeta
         case 1: // NAME_TYPES
           if (field.type == org.apache.thrift.protocol.TType.MAP) {
             {
-              org.apache.thrift.protocol.TMap _map61 = iprot.readMapBegin();
-              this.name_types = new HashMap<ByteBuffer,String>(2*_map61.size);
-              for (int _i62 = 0; _i62 < _map61.size; ++_i62)
+              org.apache.thrift.protocol.TMap _map65 = iprot.readMapBegin();
+              this.name_types = new HashMap<ByteBuffer,String>(2*_map65.size);
+              for (int _i66 = 0; _i66 < _map65.size; ++_i66)
               {
-                ByteBuffer _key63;
-                String _val64;
-                _key63 = iprot.readBinary();
-                _val64 = iprot.readString();
-                this.name_types.put(_key63, _val64);
+                ByteBuffer _key67;
+                String _val68;
+                _key67 = iprot.readBinary();
+                _val68 = iprot.readString();
+                this.name_types.put(_key67, _val68);
               }
               iprot.readMapEnd();
             }
@@ -573,15 +573,15 @@ public class CqlMetadata implements org.apache.thrift.TBase<CqlMetadata, CqlMeta
         case 2: // VALUE_TYPES
           if (field.type == org.apache.thrift.protocol.TType.MAP) {
             {
-              org.apache.thrift.protocol.TMap _map65 = iprot.readMapBegin();
-              this.value_types = new HashMap<ByteBuffer,String>(2*_map65.size);
-              for (int _i66 = 0; _i66 < _map65.size; ++_i66)
+              org.apache.thrift.protocol.TMap _map69 = iprot.readMapBegin();
+              this.value_types = new HashMap<ByteBuffer,String>(2*_map69.size);
+              for (int _i70 = 0; _i70 < _map69.size; ++_i70)
               {
-                ByteBuffer _key67;
-                String _val68;
-                _key67 = iprot.readBinary();
-                _val68 = iprot.readString();
-                this.value_types.put(_key67, _val68);
+                ByteBuffer _key71;
+                String _val72;
+                _key71 = iprot.readBinary();
+                _val72 = iprot.readString();
+                this.value_types.put(_key71, _val72);
               }
               iprot.readMapEnd();
             }
@@ -622,10 +622,10 @@ public class CqlMetadata implements org.apache.thrift.TBase<CqlMetadata, CqlMeta
       oprot.writeFieldBegin(NAME_TYPES_FIELD_DESC);
       {
         oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.STRING, this.name_types.size()));
-        for (Map.Entry<ByteBuffer, String> _iter69 : this.name_types.entrySet())
+        for (Map.Entry<ByteBuffer, String> _iter73 : this.name_types.entrySet())
         {
-          oprot.writeBinary(_iter69.getKey());
-          oprot.writeString(_iter69.getValue());
+          oprot.writeBinary(_iter73.getKey());
+          oprot.writeString(_iter73.getValue());
         }
         oprot.writeMapEnd();
       }
@@ -635,10 +635,10 @@ public class CqlMetadata implements org.apache.thrift.TBase<CqlMetadata, CqlMeta
       oprot.writeFieldBegin(VALUE_TYPES_FIELD_DESC);
       {
         oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.STRING, this.value_types.size()));
-        for (Map.Entry<ByteBuffer, String> _iter70 : this.value_types.entrySet())
+        for (Map.Entry<ByteBuffer, String> _iter74 : this.value_types.entrySet())
         {
-          oprot.writeBinary(_iter70.getKey());
-          oprot.writeString(_iter70.getValue());
+          oprot.writeBinary(_iter74.getKey());
+          oprot.writeString(_iter74.getValue());
         }
         oprot.writeMapEnd();
       }
diff --git a/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlResult.java b/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlResult.java
index 603a37ac99..8aae0ae477 100644
--- a/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlResult.java
+++ b/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlResult.java
@@ -541,14 +541,14 @@ public class CqlResult implements org.apache.thrift.TBase<CqlResult, CqlResult._
         case 2: // ROWS
           if (field.type == org.apache.thrift.protocol.TType.LIST) {
             {
-              org.apache.thrift.protocol.TList _list71 = iprot.readListBegin();
-              this.rows = new ArrayList<CqlRow>(_list71.size);
-              for (int _i72 = 0; _i72 < _list71.size; ++_i72)
+              org.apache.thrift.protocol.TList _list75 = iprot.readListBegin();
+              this.rows = new ArrayList<CqlRow>(_list75.size);
+              for (int _i76 = 0; _i76 < _list75.size; ++_i76)
               {
-                CqlRow _elem73;
-                _elem73 = new CqlRow();
-                _elem73.read(iprot);
-                this.rows.add(_elem73);
+                CqlRow _elem77;
+                _elem77 = new CqlRow();
+                _elem77.read(iprot);
+                this.rows.add(_elem77);
               }
               iprot.readListEnd();
             }
@@ -597,9 +597,9 @@ public class CqlResult implements org.apache.thrift.TBase<CqlResult, CqlResult._
         oprot.writeFieldBegin(ROWS_FIELD_DESC);
         {
           oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, this.rows.size()));
-          for (CqlRow _iter74 : this.rows)
+          for (CqlRow _iter78 : this.rows)
           {
-            _iter74.write(oprot);
+            _iter78.write(oprot);
           }
           oprot.writeListEnd();
         }
diff --git a/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlRow.java b/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlRow.java
index e3401fa1ab..5a460483fd 100644
--- a/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlRow.java
+++ b/interface/thrift/gen-java/org/apache/cassandra/thrift/CqlRow.java
@@ -395,14 +395,14 @@ public class CqlRow implements org.apache.thrift.TBase<CqlRow, CqlRow._Fields>,
         case 2: // COLUMNS
           if (field.type == org.apache.thrift.protocol.TType.LIST) {
             {
-              org.apache.thrift.protocol.TList _list57 = iprot.readListBegin();
-              this.columns = new ArrayList<Column>(_list57.size);
-              for (int _i58 = 0; _i58 < _list57.size; ++_i58)
+              org.apache.thrift.protocol.TList _list61 = iprot.readListBegin();
+              this.columns = new ArrayList<Column>(_list61.size);
+              for (int _i62 = 0; _i62 < _list61.size; ++_i62)
               {
-                Column _elem59;
-                _elem59 = new Column();
-                _elem59.read(iprot);
-                this.columns.add(_elem59);
+                Column _elem63;
+                _elem63 = new Column();
+                _elem63.read(iprot);
+                this.columns.add(_elem63);
               }
               iprot.readListEnd();
             }
@@ -434,9 +434,9 @@ public class CqlRow implements org.apache.thrift.TBase<CqlRow, CqlRow._Fields>,
       oprot.writeFieldBegin(COLUMNS_FIELD_DESC);
       {
         oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, this.columns.size()));
-        for (Column _iter60 : this.columns)
+        for (Column _iter64 : this.columns)
         {
-          _iter60.write(oprot);
+          _iter64.write(oprot);
         }
         oprot.writeListEnd();
       }
diff --git a/interface/thrift/gen-java/org/apache/cassandra/thrift/KsDef.java b/interface/thrift/gen-java/org/apache/cassandra/thrift/KsDef.java
index 7d137a8e49..7d79bc4caf 100644
--- a/interface/thrift/gen-java/org/apache/cassandra/thrift/KsDef.java
+++ b/interface/thrift/gen-java/org/apache/cassandra/thrift/KsDef.java
@@ -718,15 +718,15 @@ public class KsDef implements org.apache.thrift.TBase<KsDef, KsDef._Fields>, jav
         case 3: // STRATEGY_OPTIONS
           if (field.type == org.apache.thrift.protocol.TType.MAP) {
             {
-              org.apache.thrift.protocol.TMap _map48 = iprot.readMapBegin();
-              this.strategy_options = new HashMap<String,String>(2*_map48.size);
-              for (int _i49 = 0; _i49 < _map48.size; ++_i49)
+              org.apache.thrift.protocol.TMap _map52 = iprot.readMapBegin();
+              this.strategy_options = new HashMap<String,String>(2*_map52.size);
+              for (int _i53 = 0; _i53 < _map52.size; ++_i53)
               {
-                String _key50;
-                String _val51;
-                _key50 = iprot.readString();
-                _val51 = iprot.readString();
-                this.strategy_options.put(_key50, _val51);
+                String _key54;
+                String _val55;
+                _key54 = iprot.readString();
+                _val55 = iprot.readString();
+                this.strategy_options.put(_key54, _val55);
               }
               iprot.readMapEnd();
             }
@@ -745,14 +745,14 @@ public class KsDef implements org.apache.thrift.TBase<KsDef, KsDef._Fields>, jav
         case 5: // CF_DEFS
           if (field.type == org.apache.thrift.protocol.TType.LIST) {
             {
-              org.apache.thrift.protocol.TList _list52 = iprot.readListBegin();
-              this.cf_defs = new ArrayList<CfDef>(_list52.size);
-              for (int _i53 = 0; _i53 < _list52.size; ++_i53)
+              org.apache.thrift.protocol.TList _list56 = iprot.readListBegin();
+              this.cf_defs = new ArrayList<CfDef>(_list56.size);
+              for (int _i57 = 0; _i57 < _list56.size; ++_i57)
               {
-                CfDef _elem54;
-                _elem54 = new CfDef();
-                _elem54.read(iprot);
-                this.cf_defs.add(_elem54);
+                CfDef _elem58;
+                _elem58 = new CfDef();
+                _elem58.read(iprot);
+                this.cf_defs.add(_elem58);
               }
               iprot.readListEnd();
             }
@@ -798,10 +798,10 @@ public class KsDef implements org.apache.thrift.TBase<KsDef, KsDef._Fields>, jav
         oprot.writeFieldBegin(STRATEGY_OPTIONS_FIELD_DESC);
         {
           oprot.writeMapBegin(new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.STRING, this.strategy_options.size()));
-          for (Map.Entry<String, String> _iter55 : this.strategy_options.entrySet())
+          for (Map.Entry<String, String> _iter59 : this.strategy_options.entrySet())
           {
-            oprot.writeString(_iter55.getKey());
-            oprot.writeString(_iter55.getValue());
+            oprot.writeString(_iter59.getKey());
+            oprot.writeString(_iter59.getValue());
           }
           oprot.writeMapEnd();
         }
@@ -817,9 +817,9 @@ public class KsDef implements org.apache.thrift.TBase<KsDef, KsDef._Fields>, jav
       oprot.writeFieldBegin(CF_DEFS_FIELD_DESC);
       {
         oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRUCT, this.cf_defs.size()));
-        for (CfDef _iter56 : this.cf_defs)
+        for (CfDef _iter60 : this.cf_defs)
         {
-          _iter56.write(oprot);
+          _iter60.write(oprot);
         }
         oprot.writeListEnd();
       }
diff --git a/interface/thrift/gen-java/org/apache/cassandra/thrift/TokenRange.java b/interface/thrift/gen-java/org/apache/cassandra/thrift/TokenRange.java
index 7068f5bc6a..6880542cde 100644
--- a/interface/thrift/gen-java/org/apache/cassandra/thrift/TokenRange.java
+++ b/interface/thrift/gen-java/org/apache/cassandra/thrift/TokenRange.java
@@ -42,22 +42,33 @@ import java.util.Arrays;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
+/**
+ * A TokenRange describes part of the Cassandra ring, it is a mapping from a range to
+ * endpoints responsible for that range.
+ * @param start_token The first token in the range
+ * @param end_token The last token in the range
+ * @param endpoints The endpoints responsible for the range (listed by their configured listen_address)
+ * @param rpc_endpoints The endpoints responsible for the range (listed by their configured rpc_address)
+ */
 public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRange._Fields>, java.io.Serializable, Cloneable {
   private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("TokenRange");
 
   private static final org.apache.thrift.protocol.TField START_TOKEN_FIELD_DESC = new org.apache.thrift.protocol.TField("start_token", org.apache.thrift.protocol.TType.STRING, (short)1);
   private static final org.apache.thrift.protocol.TField END_TOKEN_FIELD_DESC = new org.apache.thrift.protocol.TField("end_token", org.apache.thrift.protocol.TType.STRING, (short)2);
   private static final org.apache.thrift.protocol.TField ENDPOINTS_FIELD_DESC = new org.apache.thrift.protocol.TField("endpoints", org.apache.thrift.protocol.TType.LIST, (short)3);
+  private static final org.apache.thrift.protocol.TField RPC_ENDPOINTS_FIELD_DESC = new org.apache.thrift.protocol.TField("rpc_endpoints", org.apache.thrift.protocol.TType.LIST, (short)4);
 
   public String start_token;
   public String end_token;
   public List<String> endpoints;
+  public List<String> rpc_endpoints;
 
   /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
   public enum _Fields implements org.apache.thrift.TFieldIdEnum {
     START_TOKEN((short)1, "start_token"),
     END_TOKEN((short)2, "end_token"),
-    ENDPOINTS((short)3, "endpoints");
+    ENDPOINTS((short)3, "endpoints"),
+    RPC_ENDPOINTS((short)4, "rpc_endpoints");
 
     private static final Map<String, _Fields> byName = new HashMap<String, _Fields>();
 
@@ -78,6 +89,8 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
           return END_TOKEN;
         case 3: // ENDPOINTS
           return ENDPOINTS;
+        case 4: // RPC_ENDPOINTS
+          return RPC_ENDPOINTS;
         default:
           return null;
       }
@@ -129,6 +142,9 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
     tmpMap.put(_Fields.ENDPOINTS, new org.apache.thrift.meta_data.FieldMetaData("endpoints", org.apache.thrift.TFieldRequirementType.REQUIRED, 
         new org.apache.thrift.meta_data.ListMetaData(org.apache.thrift.protocol.TType.LIST, 
             new org.apache.thrift.meta_data.FieldValueMetaData(org.apache.thrift.protocol.TType.STRING))));
+    tmpMap.put(_Fields.RPC_ENDPOINTS, new org.apache.thrift.meta_data.FieldMetaData("rpc_endpoints", org.apache.thrift.TFieldRequirementType.OPTIONAL, 
+        new org.apache.thrift.meta_data.ListMetaData(org.apache.thrift.protocol.TType.LIST, 
+            new org.apache.thrift.meta_data.FieldValueMetaData(org.apache.thrift.protocol.TType.STRING))));
     metaDataMap = Collections.unmodifiableMap(tmpMap);
     org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(TokenRange.class, metaDataMap);
   }
@@ -164,6 +180,13 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
       }
       this.endpoints = __this__endpoints;
     }
+    if (other.isSetRpc_endpoints()) {
+      List<String> __this__rpc_endpoints = new ArrayList<String>();
+      for (String other_element : other.rpc_endpoints) {
+        __this__rpc_endpoints.add(other_element);
+      }
+      this.rpc_endpoints = __this__rpc_endpoints;
+    }
   }
 
   public TokenRange deepCopy() {
@@ -175,6 +198,7 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
     this.start_token = null;
     this.end_token = null;
     this.endpoints = null;
+    this.rpc_endpoints = null;
   }
 
   public String getStart_token() {
@@ -264,6 +288,45 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
     }
   }
 
+  public int getRpc_endpointsSize() {
+    return (this.rpc_endpoints == null) ? 0 : this.rpc_endpoints.size();
+  }
+
+  public java.util.Iterator<String> getRpc_endpointsIterator() {
+    return (this.rpc_endpoints == null) ? null : this.rpc_endpoints.iterator();
+  }
+
+  public void addToRpc_endpoints(String elem) {
+    if (this.rpc_endpoints == null) {
+      this.rpc_endpoints = new ArrayList<String>();
+    }
+    this.rpc_endpoints.add(elem);
+  }
+
+  public List<String> getRpc_endpoints() {
+    return this.rpc_endpoints;
+  }
+
+  public TokenRange setRpc_endpoints(List<String> rpc_endpoints) {
+    this.rpc_endpoints = rpc_endpoints;
+    return this;
+  }
+
+  public void unsetRpc_endpoints() {
+    this.rpc_endpoints = null;
+  }
+
+  /** Returns true if field rpc_endpoints is set (has been assigned a value) and false otherwise */
+  public boolean isSetRpc_endpoints() {
+    return this.rpc_endpoints != null;
+  }
+
+  public void setRpc_endpointsIsSet(boolean value) {
+    if (!value) {
+      this.rpc_endpoints = null;
+    }
+  }
+
   public void setFieldValue(_Fields field, Object value) {
     switch (field) {
     case START_TOKEN:
@@ -290,6 +353,14 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
       }
       break;
 
+    case RPC_ENDPOINTS:
+      if (value == null) {
+        unsetRpc_endpoints();
+      } else {
+        setRpc_endpoints((List<String>)value);
+      }
+      break;
+
     }
   }
 
@@ -304,6 +375,9 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
     case ENDPOINTS:
       return getEndpoints();
 
+    case RPC_ENDPOINTS:
+      return getRpc_endpoints();
+
     }
     throw new IllegalStateException();
   }
@@ -321,6 +395,8 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
       return isSetEnd_token();
     case ENDPOINTS:
       return isSetEndpoints();
+    case RPC_ENDPOINTS:
+      return isSetRpc_endpoints();
     }
     throw new IllegalStateException();
   }
@@ -365,6 +441,15 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
         return false;
     }
 
+    boolean this_present_rpc_endpoints = true && this.isSetRpc_endpoints();
+    boolean that_present_rpc_endpoints = true && that.isSetRpc_endpoints();
+    if (this_present_rpc_endpoints || that_present_rpc_endpoints) {
+      if (!(this_present_rpc_endpoints && that_present_rpc_endpoints))
+        return false;
+      if (!this.rpc_endpoints.equals(that.rpc_endpoints))
+        return false;
+    }
+
     return true;
   }
 
@@ -387,6 +472,11 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
     if (present_endpoints)
       builder.append(endpoints);
 
+    boolean present_rpc_endpoints = true && (isSetRpc_endpoints());
+    builder.append(present_rpc_endpoints);
+    if (present_rpc_endpoints)
+      builder.append(rpc_endpoints);
+
     return builder.toHashCode();
   }
 
@@ -428,6 +518,16 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
         return lastComparison;
       }
     }
+    lastComparison = Boolean.valueOf(isSetRpc_endpoints()).compareTo(typedOther.isSetRpc_endpoints());
+    if (lastComparison != 0) {
+      return lastComparison;
+    }
+    if (isSetRpc_endpoints()) {
+      lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.rpc_endpoints, typedOther.rpc_endpoints);
+      if (lastComparison != 0) {
+        return lastComparison;
+      }
+    }
     return 0;
   }
 
@@ -476,6 +576,23 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
             org.apache.thrift.protocol.TProtocolUtil.skip(iprot, field.type);
           }
           break;
+        case 4: // RPC_ENDPOINTS
+          if (field.type == org.apache.thrift.protocol.TType.LIST) {
+            {
+              org.apache.thrift.protocol.TList _list23 = iprot.readListBegin();
+              this.rpc_endpoints = new ArrayList<String>(_list23.size);
+              for (int _i24 = 0; _i24 < _list23.size; ++_i24)
+              {
+                String _elem25;
+                _elem25 = iprot.readString();
+                this.rpc_endpoints.add(_elem25);
+              }
+              iprot.readListEnd();
+            }
+          } else { 
+            org.apache.thrift.protocol.TProtocolUtil.skip(iprot, field.type);
+          }
+          break;
         default:
           org.apache.thrift.protocol.TProtocolUtil.skip(iprot, field.type);
       }
@@ -505,14 +622,28 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
       oprot.writeFieldBegin(ENDPOINTS_FIELD_DESC);
       {
         oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, this.endpoints.size()));
-        for (String _iter23 : this.endpoints)
+        for (String _iter26 : this.endpoints)
         {
-          oprot.writeString(_iter23);
+          oprot.writeString(_iter26);
         }
         oprot.writeListEnd();
       }
       oprot.writeFieldEnd();
     }
+    if (this.rpc_endpoints != null) {
+      if (isSetRpc_endpoints()) {
+        oprot.writeFieldBegin(RPC_ENDPOINTS_FIELD_DESC);
+        {
+          oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, this.rpc_endpoints.size()));
+          for (String _iter27 : this.rpc_endpoints)
+          {
+            oprot.writeString(_iter27);
+          }
+          oprot.writeListEnd();
+        }
+        oprot.writeFieldEnd();
+      }
+    }
     oprot.writeFieldStop();
     oprot.writeStructEnd();
   }
@@ -545,6 +676,16 @@ public class TokenRange implements org.apache.thrift.TBase<TokenRange, TokenRang
       sb.append(this.endpoints);
     }
     first = false;
+    if (isSetRpc_endpoints()) {
+      if (!first) sb.append(", ");
+      sb.append("rpc_endpoints:");
+      if (this.rpc_endpoints == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.rpc_endpoints);
+      }
+      first = false;
+    }
     sb.append(")");
     return sb.toString();
   }
diff --git a/src/java/org/apache/cassandra/service/StorageService.java b/src/java/org/apache/cassandra/service/StorageService.java
index 895df29196..804a7716e7 100644
--- a/src/java/org/apache/cassandra/service/StorageService.java
+++ b/src/java/org/apache/cassandra/service/StorageService.java
@@ -641,11 +641,6 @@ public class StorageService implements IEndpointStateChangeSubscriber, StorageSe
      */
     public Map<Range, List<String>> getRangeToEndpointMap(String keyspace)
     {
-        // some people just want to get a visual representation of things. Allow null and set it to the first
-        // non-system table.
-        if (keyspace == null)
-            keyspace = Schema.instance.getNonSystemTables().get(0);
-
         /* All the ranges for the tokens */
         Map<Range, List<String>> map = new HashMap<Range, List<String>>();
         for (Map.Entry<Range,List<InetAddress>> entry : getRangeToAddressMap(keyspace).entrySet())
@@ -655,6 +650,21 @@ public class StorageService implements IEndpointStateChangeSubscriber, StorageSe
         return map;
     }
 
+    /**
+     * Return the rpc address associated with an endpoint as a string.
+     * @param endpoint The endpoint to get rpc address for
+     * @return
+     */
+    public String getRpcaddress(InetAddress endpoint)
+    {
+        if (endpoint.equals(FBUtilities.getBroadcastAddress()))
+            return DatabaseDescriptor.getRpcAddress().getHostAddress();
+        else if (Gossiper.instance.getEndpointStateForEndpoint(endpoint).getApplicationState(ApplicationState.RPC_ADDRESS) == null)
+            return endpoint.getHostAddress();
+        else
+            return Gossiper.instance.getEndpointStateForEndpoint(endpoint).getApplicationState(ApplicationState.RPC_ADDRESS).value;
+    }
+
     /**
      * for a keyspace, return the ranges and corresponding RPC addresses for a given keyspace.
      * @param keyspace
@@ -662,11 +672,6 @@ public class StorageService implements IEndpointStateChangeSubscriber, StorageSe
      */
     public Map<Range, List<String>> getRangeToRpcaddressMap(String keyspace)
     {
-        // some people just want to get a visual representation of things. Allow null and set it to the first
-        // non-system table.
-        if (keyspace == null)
-            keyspace = Schema.instance.getNonSystemTables().get(0);
-
         /* All the ranges for the tokens */
         Map<Range, List<String>> map = new HashMap<Range, List<String>>();
         for (Map.Entry<Range,List<InetAddress>> entry : getRangeToAddressMap(keyspace).entrySet())
@@ -674,12 +679,7 @@ public class StorageService implements IEndpointStateChangeSubscriber, StorageSe
             List<String> rpcaddrs = new ArrayList<String>();
             for (InetAddress endpoint: entry.getValue())
             {
-                if (endpoint.equals(FBUtilities.getBroadcastAddress()))
-                    rpcaddrs.add(DatabaseDescriptor.getRpcAddress().getHostAddress());
-                else if (Gossiper.instance.getEndpointStateForEndpoint(endpoint).getApplicationState(ApplicationState.RPC_ADDRESS) == null)
-                    rpcaddrs.add(endpoint.getHostAddress());
-                else
-                    rpcaddrs.add(Gossiper.instance.getEndpointStateForEndpoint(endpoint).getApplicationState(ApplicationState.RPC_ADDRESS).value);
+                rpcaddrs.add(getRpcaddress(endpoint));
             }
             map.put(entry.getKey(), rpcaddrs);
         }
@@ -704,6 +704,11 @@ public class StorageService implements IEndpointStateChangeSubscriber, StorageSe
 
     public Map<Range, List<InetAddress>> getRangeToAddressMap(String keyspace)
     {
+        // some people just want to get a visual representation of things. Allow null and set it to the first
+        // non-system table.
+        if (keyspace == null)
+            keyspace = Schema.instance.getNonSystemTables().get(0);
+
         List<Range> ranges = getAllRanges(tokenMetadata_.sortedTokens());
         return constructRangeToEndpointMap(keyspace, ranges);
     }
diff --git a/src/java/org/apache/cassandra/thrift/CassandraServer.java b/src/java/org/apache/cassandra/thrift/CassandraServer.java
index 2fba777e55..055bb2ff96 100644
--- a/src/java/org/apache/cassandra/thrift/CassandraServer.java
+++ b/src/java/org/apache/cassandra/thrift/CassandraServer.java
@@ -20,6 +20,7 @@ package org.apache.cassandra.thrift;
 
 import java.io.IOException;
 import java.io.UnsupportedEncodingException;
+import java.net.InetAddress;
 import java.net.SocketAddress;
 import java.nio.ByteBuffer;
 import java.nio.charset.CharacterCodingException;
@@ -786,11 +787,22 @@ public class CassandraServer implements Cassandra.Iface
             throw new InvalidRequestException("There is no ring for the keyspace: " + keyspace);
         List<TokenRange> ranges = new ArrayList<TokenRange>();
         Token.TokenFactory tf = StorageService.getPartitioner().getTokenFactory();
-        for (Map.Entry<Range, List<String>> entry : StorageService.instance.getRangeToRpcaddressMap(keyspace).entrySet())
+
+        Map<Range, List<InetAddress>> address_map = StorageService.instance.getRangeToAddressMap(keyspace);
+        for (Map.Entry<Range, List<InetAddress>> entry : address_map.entrySet())
         {
             Range range = entry.getKey();
-            List<String> endpoints = entry.getValue();
-            ranges.add(new TokenRange(tf.toString(range.left), tf.toString(range.right), endpoints));
+            List<String> endpoints = new ArrayList<String>();
+            List<String> rpc_endpoints = new ArrayList<String>();
+            for (InetAddress endpoint : entry.getValue())
+            {
+                endpoints.add(endpoint.getHostAddress());
+                rpc_endpoints.add(StorageService.instance.getRpcaddress(endpoint));
+            }
+
+            TokenRange tr = new TokenRange(tf.toString(range.left), tf.toString(range.right), endpoints);
+            tr.rpc_endpoints = rpc_endpoints;
+            ranges.add(tr);
         }
         return ranges;
     }
