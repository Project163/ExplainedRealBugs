diff --git a/CHANGES.txt b/CHANGES.txt
index d24980607f..64729746e1 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -21,6 +21,7 @@
  * Relax CL for auth queries for non-default users (CASSANDRA-5310)
  * Fix AssertionError during repair (CASSANDRA-5245)
 Merged from 1.1:
+ * add tmp flag to Descriptor hashcode (CASSANDRA-4021)
  * fix logging of "Found table data in data directories" when only system tables
    are present (CASSANDRA-5289)
  * cli: Add JMX authentication support (CASSANDRA-5080)
diff --git a/src/java/org/apache/cassandra/io/sstable/Descriptor.java b/src/java/org/apache/cassandra/io/sstable/Descriptor.java
index cf1907ec1b..f0709d8589 100644
--- a/src/java/org/apache/cassandra/io/sstable/Descriptor.java
+++ b/src/java/org/apache/cassandra/io/sstable/Descriptor.java
@@ -197,7 +197,7 @@ public class Descriptor
         this.cfname = cfname;
         this.generation = generation;
         temporary = temp;
-        hashCode = Objects.hashCode(directory, generation, ksname, cfname);
+        hashCode = Objects.hashCode(directory, generation, ksname, cfname, temp);
     }
 
     public Descriptor withGeneration(int newGeneration)
@@ -328,7 +328,7 @@ public class Descriptor
         if (!(o instanceof Descriptor))
             return false;
         Descriptor that = (Descriptor)o;
-        return that.directory.equals(this.directory) && that.generation == this.generation && that.ksname.equals(this.ksname) && that.cfname.equals(this.cfname);
+        return that.directory.equals(this.directory) && that.generation == this.generation && that.ksname.equals(this.ksname) && that.cfname.equals(this.cfname) && that.temporary == this.temporary;
     }
 
     @Override
