diff --git a/CHANGES.txt b/CHANGES.txt
index 49f2497cac..127a3cd51f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,3 +1,7 @@
+0.8.9
+ * acquire compactionlock during truncate (CASSANDRA-3399)
+
+
 0.8.8
  * fix truncate allowing data to be replayed post-restart (CASSANDRA-3297)
  * make iwriter final in IndexWriter to avoid NPE (CASSANDRA-2863)
diff --git a/src/java/org/apache/cassandra/db/compaction/CompactionManager.java b/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
index d0e97e3598..7460885f79 100644
--- a/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
+++ b/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
@@ -1169,15 +1169,23 @@ public class CompactionManager implements CompactionManagerMBean
         {
             public void runMayThrow() throws InterruptedException, IOException
             {
-                for (ColumnFamilyStore cfs : main.concatWithIndexes())
+                compactionLock.writeLock().lock();
+                try
                 {
-                    List<SSTableReader> truncatedSSTables = new ArrayList<SSTableReader>();
-                    for (SSTableReader sstable : cfs.getSSTables())
+                    for (ColumnFamilyStore cfs : main.concatWithIndexes())
                     {
-                        if (!sstable.newSince(truncatedAt))
-                            truncatedSSTables.add(sstable);
+                        List<SSTableReader> truncatedSSTables = new ArrayList<SSTableReader>();
+                        for (SSTableReader sstable : cfs.getSSTables())
+                        {
+                            if (!sstable.newSince(truncatedAt))
+                                truncatedSSTables.add(sstable);
+                        }
+                        cfs.markCompacted(truncatedSSTables);
                     }
-                    cfs.markCompacted(truncatedSSTables);
+                }
+                finally
+                {
+                    compactionLock.writeLock().unlock();
                 }
 
                 main.invalidateRowCache();
