diff --git a/bin/cassandra b/bin/cassandra
index 6e7a25f92e..85d85335ed 100755
--- a/bin/cassandra
+++ b/bin/cassandra
@@ -80,10 +80,10 @@ elif [ -r $CASSANDRA_INCLUDE ]; then
 fi
 
 # Use JAVA_HOME if set, otherwise look for java in PATH
-if [ -x $JAVA_HOME/bin/java ]; then
+if [ -n "$JAVA_HOME" ]; then
     JAVA=$JAVA_HOME/bin/java
 else
-    JAVA=`which java`
+    JAVA=java
 fi
 
 if [ -z $CASSANDRA_CONF -o -z $CLASSPATH ]; then
diff --git a/conf/cassandra-env.sh b/conf/cassandra-env.sh
index f6e41d8459..46374ef0dd 100644
--- a/conf/cassandra-env.sh
+++ b/conf/cassandra-env.sh
@@ -92,7 +92,7 @@ JMX_PORT="7199"
 JVM_OPTS="$JVM_OPTS -ea"
 
 # add the jamm javaagent
-check_openjdk=$(java -version 2>&1 | awk '{if (NR == 2) {print $1}}')
+check_openjdk=$("${JAVA:-java}" -version 2>&1 | awk '{if (NR == 2) {print $1}}')
 if [ "$check_openjdk" != "OpenJDK" ]
 then
     JVM_OPTS="$JVM_OPTS -javaagent:$CASSANDRA_HOME/lib/jamm-0.2.2.jar"
diff --git a/debian/cassandra.postinst b/debian/cassandra.postinst
index 1ac93852cf..18258827c1 100644
--- a/debian/cassandra.postinst
+++ b/debian/cassandra.postinst
@@ -34,7 +34,7 @@ case "$1" in
                 cassandra
         fi
 
-        if [ -n $2 ] && dpkg --compare-versions "$2" le 0.6.4-2; then
+        if [ -n "$2" ] && dpkg --compare-versions "$2" le 0.6.4-2; then
             chown -R cassandra: /var/lib/cassandra
             chown -R cassandra: /var/log/cassandra
         fi
diff --git a/debian/init b/debian/init
index 7425c61fdd..a3b268781d 100644
--- a/debian/init
+++ b/debian/init
@@ -30,23 +30,15 @@ JVM_SEARCH_DIRS="/usr/lib/jvm/java-6-openjdk /usr/lib/jvm/java-6-sun"
 [ -e /etc/cassandra/cassandra.yaml ] || exit 0
 [ -e /etc/cassandra/cassandra-env.sh ] || exit 0
 
-# Read Cassandra environment file.
-. /etc/cassandra/cassandra-env.sh
-
 # Read configuration variable file if it is present
 [ -r /etc/default/$NAME ] && . /etc/default/$NAME
 
-if [ -z "$JVM_OPTS" ]; then
-    echo "Initialization failed; \$JVM_OPTS not set!" >&2
-    exit 3
-fi
-
 # If JAVA_HOME has not been set, try to determine it.
 if [ -z "$JAVA_HOME" ]; then
     # If java is in PATH, use a JAVA_HOME that corresponds to that. This is
     # both consistent with how the upstream startup script works, and how
     # Debian works (read: the use of alternatives to set a system JVM).
-    if [ -n `which java` ]; then
+    if [ -n "`which java`" ]; then
         java=`which java`
         # Dereference symlink(s)
         while true; do
@@ -67,6 +59,15 @@ if [ -z "$JAVA_HOME" ]; then
         done
     fi
 fi
+JAVA="$JAVA_HOME/bin/java"
+
+# Read Cassandra environment file.
+. /etc/cassandra/cassandra-env.sh
+
+if [ -z "$JVM_OPTS" ]; then
+    echo "Initialization failed; \$JVM_OPTS not set!" >&2
+    exit 3
+fi
 
 # Load the VERBOSE setting and other rcS variables
 . /lib/init/vars.sh
