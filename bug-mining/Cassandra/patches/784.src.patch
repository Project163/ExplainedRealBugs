diff --git a/CHANGES.txt b/CHANGES.txt
index d9fa6eec1d..745152b1bf 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -10,6 +10,8 @@
  * reduce contention on Table.flusherLock (CASSANDRA-1954)
  * fix comparator used for non-indexed secondary expressions in index scan
    (CASSANDRA-2347)
+ * ensure size calculation and write phase of large-row compaction use
+   the same threshold for TTL expiration (CASSANDRA-2349)
 
 
 0.7.4
diff --git a/src/java/org/apache/cassandra/db/ColumnFamily.java b/src/java/org/apache/cassandra/db/ColumnFamily.java
index 9a06cc6e41..bf154cf52d 100644
--- a/src/java/org/apache/cassandra/db/ColumnFamily.java
+++ b/src/java/org/apache/cassandra/db/ColumnFamily.java
@@ -35,7 +35,7 @@ import org.apache.cassandra.config.CFMetaData;
 import org.apache.cassandra.config.DatabaseDescriptor;
 import org.apache.cassandra.db.filter.QueryPath;
 import org.apache.cassandra.db.marshal.AbstractType;
-import org.apache.cassandra.io.ICompactSerializer2;
+import org.apache.cassandra.io.IColumnSerializer;
 import org.apache.cassandra.io.util.IIterableColumns;
 import org.apache.cassandra.utils.FBUtilities;
 
@@ -70,7 +70,7 @@ public class ColumnFamily implements IColumnContainer, IIterableColumns
     private final Integer cfid;
     private final ColumnFamilyType type;
 
-    private transient ICompactSerializer2<IColumn> columnSerializer;
+    private transient IColumnSerializer columnSerializer;
     final AtomicLong markedForDeleteAt = new AtomicLong(Long.MIN_VALUE);
     final AtomicInteger localDeletionTime = new AtomicInteger(Integer.MIN_VALUE);
     private ConcurrentSkipListMap<ByteBuffer, IColumn> columns;
@@ -135,7 +135,7 @@ public class ColumnFamily implements IColumnContainer, IIterableColumns
     /**
      * FIXME: Gross.
      */
-    public ICompactSerializer2<IColumn> getColumnSerializer()
+    public IColumnSerializer getColumnSerializer()
     {
         return columnSerializer;
     }
diff --git a/src/java/org/apache/cassandra/db/ColumnSerializer.java b/src/java/org/apache/cassandra/db/ColumnSerializer.java
index 49f812f415..6eb987db76 100644
--- a/src/java/org/apache/cassandra/db/ColumnSerializer.java
+++ b/src/java/org/apache/cassandra/db/ColumnSerializer.java
@@ -29,10 +29,10 @@ import java.nio.ByteBuffer;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
-import org.apache.cassandra.io.ICompactSerializer2;
+import org.apache.cassandra.io.IColumnSerializer;
 import org.apache.cassandra.utils.ByteBufferUtil;
 
-public class ColumnSerializer implements ICompactSerializer2<IColumn>
+public class ColumnSerializer implements IColumnSerializer
 {
     private static final Logger logger = LoggerFactory.getLogger(ColumnSerializer.class);
 
@@ -62,6 +62,11 @@ public class ColumnSerializer implements ICompactSerializer2<IColumn>
     }
 
     public Column deserialize(DataInput dis) throws IOException
+    {
+        return deserialize(dis, (int) (System.currentTimeMillis() / 1000));
+    }
+
+    public Column deserialize(DataInput dis, int expireBefore) throws IOException
     {
         ByteBuffer name = ByteBufferUtil.readWithShortLength(dis);
         if (name.remaining() <= 0)
@@ -74,7 +79,7 @@ public class ColumnSerializer implements ICompactSerializer2<IColumn>
             int expiration = dis.readInt();
             long ts = dis.readLong();
             ByteBuffer value = ByteBufferUtil.readWithLength(dis);
-            if ((int) (System.currentTimeMillis() / 1000 ) > expiration)
+            if (expiration < expireBefore)
             {
                 // the column is now expired, we can safely return a simple
                 // tombstone
diff --git a/src/java/org/apache/cassandra/db/SuperColumn.java b/src/java/org/apache/cassandra/db/SuperColumn.java
index 8f73646428..abdadbb096 100644
--- a/src/java/org/apache/cassandra/db/SuperColumn.java
+++ b/src/java/org/apache/cassandra/db/SuperColumn.java
@@ -33,7 +33,7 @@ import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
 import org.apache.cassandra.db.marshal.AbstractType;
-import org.apache.cassandra.io.ICompactSerializer2;
+import org.apache.cassandra.io.IColumnSerializer;
 import org.apache.cassandra.io.util.ColumnSortedMap;
 import org.apache.cassandra.io.util.DataOutputBuffer;
 import org.apache.cassandra.utils.ByteBufferUtil;
@@ -308,7 +308,7 @@ public class SuperColumn implements IColumn, IColumnContainer
     }
 }
 
-class SuperColumnSerializer implements ICompactSerializer2<IColumn>
+class SuperColumnSerializer implements IColumnSerializer
 {
     private static Logger logger = LoggerFactory.getLogger(SuperColumnSerializer.class);
 
@@ -347,6 +347,11 @@ class SuperColumnSerializer implements ICompactSerializer2<IColumn>
     }
 
     public IColumn deserialize(DataInput dis) throws IOException
+    {
+        return deserialize(dis, (int)(System.currentTimeMillis() / 1000));
+    }
+
+    public IColumn deserialize(DataInput dis, int expireBefore) throws IOException
     {
         ByteBuffer name = ByteBufferUtil.readWithShortLength(dis);
         int localDeleteTime = dis.readInt();
@@ -359,7 +364,7 @@ class SuperColumnSerializer implements ICompactSerializer2<IColumn>
         /* read the number of columns */
         int size = dis.readInt();
         ColumnSerializer serializer = Column.serializer();
-        ColumnSortedMap preSortedMap = new ColumnSortedMap(comparator, serializer, dis, size);
+        ColumnSortedMap preSortedMap = new ColumnSortedMap(comparator, serializer, dis, size, expireBefore);
         SuperColumn superColumn = new SuperColumn(name, new ConcurrentSkipListMap<ByteBuffer,IColumn>(preSortedMap));
         if (localDeleteTime != Integer.MIN_VALUE && localDeleteTime <= 0)
         {
diff --git a/src/java/org/apache/cassandra/io/IColumnSerializer.java b/src/java/org/apache/cassandra/io/IColumnSerializer.java
new file mode 100644
index 0000000000..351543e2fb
--- /dev/null
+++ b/src/java/org/apache/cassandra/io/IColumnSerializer.java
@@ -0,0 +1,32 @@
+package org.apache.cassandra.io;
+/*
+ *
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ *
+ */
+
+import java.io.DataInput;
+import java.io.IOException;
+
+import org.apache.cassandra.db.ColumnFamilyStore;
+import org.apache.cassandra.db.IColumn;
+
+public interface IColumnSerializer extends ICompactSerializer2<IColumn>
+{
+    public IColumn deserialize(DataInput in, int expireBefore) throws IOException;
+}
diff --git a/src/java/org/apache/cassandra/io/sstable/SSTableIdentityIterator.java b/src/java/org/apache/cassandra/io/sstable/SSTableIdentityIterator.java
index fe73e51a63..d379902eb1 100644
--- a/src/java/org/apache/cassandra/io/sstable/SSTableIdentityIterator.java
+++ b/src/java/org/apache/cassandra/io/sstable/SSTableIdentityIterator.java
@@ -52,6 +52,9 @@ public class SSTableIdentityIterator implements Comparable<SSTableIdentityIterat
     public final int columnCount;
     private final long columnPosition;
 
+    // Used by lazilyCompactedRow, so that we see the same things when deserializing the first and second time
+    private final int expireBefore;
+
     /**
      * Used to iterate through the columns of a row.
      * @param sstable SSTable we are reading ffrom.
@@ -75,6 +78,7 @@ public class SSTableIdentityIterator implements Comparable<SSTableIdentityIterat
         this.key = key;
         this.dataStart = dataStart;
         this.dataSize = dataSize;
+        this.expireBefore = (int)(System.currentTimeMillis() / 1000);
         finishedAt = dataStart + dataSize;
 
         try
@@ -137,7 +141,7 @@ public class SSTableIdentityIterator implements Comparable<SSTableIdentityIterat
     {
         try
         {
-            return sstable.getColumnSerializer().deserialize(file);
+            return sstable.getColumnSerializer().deserialize(file, expireBefore);
         }
         catch (IOException e)
         {
diff --git a/src/java/org/apache/cassandra/io/sstable/SSTableReader.java b/src/java/org/apache/cassandra/io/sstable/SSTableReader.java
index c633f765a6..2d56ed17c4 100644
--- a/src/java/org/apache/cassandra/io/sstable/SSTableReader.java
+++ b/src/java/org/apache/cassandra/io/sstable/SSTableReader.java
@@ -39,7 +39,7 @@ import org.apache.cassandra.db.marshal.AbstractType;
 import org.apache.cassandra.dht.AbstractBounds;
 import org.apache.cassandra.dht.IPartitioner;
 import org.apache.cassandra.dht.Range;
-import org.apache.cassandra.io.ICompactSerializer2;
+import org.apache.cassandra.io.IColumnSerializer;
 import org.apache.cassandra.io.util.BufferedRandomAccessFile;
 import org.apache.cassandra.io.util.FileDataInput;
 import org.apache.cassandra.io.util.FileUtils;
@@ -583,7 +583,7 @@ public class SSTableReader extends SSTable implements Comparable<SSTableReader>
         return ColumnFamily.create(metadata);
     }
 
-    public ICompactSerializer2<IColumn> getColumnSerializer()
+    public IColumnSerializer getColumnSerializer()
     {
         return metadata.cfType == ColumnFamilyType.Standard
                ? Column.serializer()
diff --git a/src/java/org/apache/cassandra/io/util/ColumnSortedMap.java b/src/java/org/apache/cassandra/io/util/ColumnSortedMap.java
index 11cfce5372..42bef610f6 100644
--- a/src/java/org/apache/cassandra/io/util/ColumnSortedMap.java
+++ b/src/java/org/apache/cassandra/io/util/ColumnSortedMap.java
@@ -42,13 +42,15 @@ public class ColumnSortedMap implements SortedMap<ByteBuffer, IColumn>
     private DataInput dis;
     private Comparator<ByteBuffer> comparator;
     private int length;
+    private final int expireBefore;
 
-    public ColumnSortedMap(Comparator<ByteBuffer> comparator, ColumnSerializer serializer, DataInput dis, int length)
+    public ColumnSortedMap(Comparator<ByteBuffer> comparator, ColumnSerializer serializer, DataInput dis, int length, int expireBefore)
     {
         this.comparator = comparator;
         this.serializer = serializer;
         this.dis = dis;
         this.length = length;
+        this.expireBefore = expireBefore;
     }
 
     public int size()
@@ -138,7 +140,7 @@ public class ColumnSortedMap implements SortedMap<ByteBuffer, IColumn>
 
     public Set<Map.Entry<ByteBuffer, IColumn>> entrySet()
     {
-        return new ColumnSet(serializer, dis, length);
+        return new ColumnSet(serializer, dis, length, expireBefore);
     }
 }
 
@@ -147,12 +149,14 @@ class ColumnSet implements Set<Map.Entry<ByteBuffer, IColumn>>
     private ColumnSerializer serializer;
     private DataInput dis;
     private int length;
+    private final int expireBefore;
 
-    public ColumnSet(ColumnSerializer serializer, DataInput dis, int length)
+    public ColumnSet(ColumnSerializer serializer, DataInput dis, int length, int expireBefore)
     {
         this.serializer = serializer;
         this.dis = dis;
         this.length = length;
+        this.expireBefore = expireBefore;
     }
 
     public int size()
@@ -172,7 +176,7 @@ class ColumnSet implements Set<Map.Entry<ByteBuffer, IColumn>>
 
     public Iterator<Entry<ByteBuffer, IColumn>> iterator()
     {
-        return new ColumnIterator(serializer, dis, length);
+        return new ColumnIterator(serializer, dis, length, expireBefore);
     }
 
     public Object[] toArray()
@@ -226,12 +230,14 @@ class ColumnIterator implements Iterator<Map.Entry<ByteBuffer, IColumn>>
     private DataInput dis;
     private int length;
     private int count = 0;
+    private final int expireBefore;
 
-    public ColumnIterator(ColumnSerializer serializer, DataInput dis, int length)
+    public ColumnIterator(ColumnSerializer serializer, DataInput dis, int length, int expireBefore)
     {
         this.dis = dis;
         this.serializer = serializer;
         this.length = length;
+        this.expireBefore = expireBefore;
     }
 
     private IColumn deserializeNext()
@@ -239,7 +245,7 @@ class ColumnIterator implements Iterator<Map.Entry<ByteBuffer, IColumn>>
         try
         {
             count++;
-            return serializer.deserialize(dis);
+            return serializer.deserialize(dis, expireBefore);
         }
         catch (IOException e)
         {
