diff --git a/CHANGES.txt b/CHANGES.txt
index bed8703a8d..da6f5cc124 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 3.0.3
+ * Avoid memory leak when collecting sstable metadata (CASSANDRA-11026)
  * Mutations do not block for completion under view lock contention (CASSANDRA-10779)
  * Invalidate legacy schema tables when unloading them (CASSANDRA-11071)
  * (cqlsh) handle INSERT and UPDATE statements with LWT conditions correctly
diff --git a/src/java/org/apache/cassandra/io/sstable/metadata/MetadataCollector.java b/src/java/org/apache/cassandra/io/sstable/metadata/MetadataCollector.java
index 1c93f58907..3947dc8117 100644
--- a/src/java/org/apache/cassandra/io/sstable/metadata/MetadataCollector.java
+++ b/src/java/org/apache/cassandra/io/sstable/metadata/MetadataCollector.java
@@ -39,6 +39,7 @@ import org.apache.cassandra.io.sstable.Component;
 import org.apache.cassandra.io.sstable.SSTable;
 import org.apache.cassandra.io.sstable.format.SSTableReader;
 import org.apache.cassandra.service.ActiveRepairService;
+import org.apache.cassandra.utils.ByteBufferUtil;
 import org.apache.cassandra.utils.EstimatedHistogram;
 import org.apache.cassandra.utils.MurmurHash;
 import org.apache.cassandra.utils.StreamingHistogram;
@@ -232,12 +233,19 @@ public class MetadataCollector implements PartitionStatisticsCollector
         {
             AbstractType<?> type = comparator.subtype(i);
             ByteBuffer newValue = clustering.get(i);
-            minClusteringValues[i] = min(minClusteringValues[i], newValue, type);
-            maxClusteringValues[i] = max(maxClusteringValues[i], newValue, type);
+            minClusteringValues[i] = maybeMinimize(min(minClusteringValues[i], newValue, type));
+            maxClusteringValues[i] = maybeMinimize(max(maxClusteringValues[i], newValue, type));
         }
         return this;
     }
 
+    private static ByteBuffer maybeMinimize(ByteBuffer buffer)
+    {
+        // ByteBuffer.minimalBufferFor doesn't handle null, but we can get it in this case since it's possible
+        // for some clustering values to be null
+        return buffer == null ? null : ByteBufferUtil.minimalBufferFor(buffer);
+    }
+
     private static ByteBuffer min(ByteBuffer b1, ByteBuffer b2, AbstractType<?> comparator)
     {
         if (b1 == null)
