diff --git a/src/java/org/apache/cassandra/db/BinaryMemtable.java b/src/java/org/apache/cassandra/db/BinaryMemtable.java
index fd178f0125..6f209ff87d 100644
--- a/src/java/org/apache/cassandra/db/BinaryMemtable.java
+++ b/src/java/org/apache/cassandra/db/BinaryMemtable.java
@@ -139,7 +139,7 @@ public class BinaryMemtable
             return;
         ColumnFamilyStore cfStore = Table.open(table_).getColumnFamilyStore(cfName_);
         String directory = DatabaseDescriptor.getDataFileLocation();
-        String filename = cfStore.getNextFileName();
+        String filename = cfStore.getTempFileName();
 
         /*
          * Use the SSTable to write the contents of the TreeMap
@@ -160,7 +160,7 @@ public class BinaryMemtable
                 bf.add(key);
             }
         }
-        ssTable.close(bf);
+        ssTable.closeRename(bf);
         cfStore.storeLocation( ssTable.getDataFileLocation(), bf );
         columnFamilies_.clear();       
     }
diff --git a/src/java/org/apache/cassandra/db/Memtable.java b/src/java/org/apache/cassandra/db/Memtable.java
index 2e882b162e..57bc1d81a6 100644
--- a/src/java/org/apache/cassandra/db/Memtable.java
+++ b/src/java/org/apache/cassandra/db/Memtable.java
@@ -378,7 +378,7 @@ public class Memtable implements Comparable<Memtable>
         }
 
         String directory = DatabaseDescriptor.getDataFileLocation();
-        String filename = cfStore.getNextFileName();
+        String filename = cfStore.getTempFileName();
         SSTable ssTable = new SSTable(directory, filename, StorageService.getPartitioner());
 
         // sort keys in the order they would be in when decorated
@@ -408,7 +408,7 @@ public class Memtable implements Comparable<Memtable>
                 bf.add(key);
             }
         }
-        ssTable.close(bf);
+        ssTable.closeRename(bf);
         cfStore.onMemtableFlush(cLogCtx);
         cfStore.storeLocation( ssTable.getDataFileLocation(), bf );
         buffer.close();
