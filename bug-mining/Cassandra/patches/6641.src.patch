diff --git a/src/antlr/Parser.g b/src/antlr/Parser.g
index 30e07fddf9..dd9eb181df 100644
--- a/src/antlr/Parser.g
+++ b/src/antlr/Parser.g
@@ -989,8 +989,8 @@ alterTableStatement returns [AlterTableStatement.Raw stmt]
       | K_ALTER ( K_IF K_EXISTS { $stmt.ifColumnExists(true); } )? id=cident
               ( mask=columnMask { $stmt.mask(id, mask); }
               | K_DROP K_MASKED { $stmt.mask(id, null); }
-              | K_DROP K_CHECK { $stmt.dropConstraints(id); }
-              | (constraints=columnConstraints) { $stmt.alterConstraints(id, constraints); })
+              | K_DROP K_CHECK { $stmt.constraint(id, null); }
+              | (constraints=columnConstraints) { $stmt.constraint(id, constraints); })
 
       | K_ADD ( K_IF K_NOT K_EXISTS { $stmt.ifColumnNotExists(true); } )?
               (        id=ident  v=comparatorType  b=isStaticColumn (m=columnMask)? { $stmt.add(id,  v,  b, m);  }
diff --git a/src/java/org/apache/cassandra/cql3/statements/schema/AlterTableStatement.java b/src/java/org/apache/cassandra/cql3/statements/schema/AlterTableStatement.java
index 08dc3ea918..fc2ab582f7 100644
--- a/src/java/org/apache/cassandra/cql3/statements/schema/AlterTableStatement.java
+++ b/src/java/org/apache/cassandra/cql3/statements/schema/AlterTableStatement.java
@@ -710,65 +710,46 @@ public abstract class AlterTableStatement extends AlterSchemaStatement
         }
     }
 
-    public static class DropConstraints extends AlterTableStatement
-    {
-        final ColumnIdentifier columnName;
-
-        DropConstraints(String keyspaceName, String tableName, boolean ifTableExists, ColumnIdentifier columnName)
-        {
-            super(keyspaceName, tableName, ifTableExists);
-            this.columnName = columnName;
-        }
-
-        @Override
-        public KeyspaceMetadata apply(Epoch epoch, KeyspaceMetadata keyspace, TableMetadata table, ClusterMetadata metadata)
-        {
-            ColumnMetadata columnMetadata = table.getColumn(columnName);
-            columnMetadata.removeColumnConstraints();
-
-            TableMetadata.Builder tableBuilder = table.unbuild().epoch(epoch);
-            Views.Builder viewsBuilder = keyspace.views.unbuild();
-            TableMetadata tableMetadata = tableBuilder.build();
-            tableMetadata.validate();
-
-            return keyspace.withSwapped(keyspace.tables.withSwapped(tableMetadata))
-                           .withSwapped(viewsBuilder.build());
-        }
-    }
-
     public static class AlterConstraints extends AlterTableStatement
     {
         final ColumnIdentifier columnName;
-        final ColumnConstraints constraints;
+        final ColumnConstraints.Raw constraints;
+        final boolean ifColumnExists;
 
-        AlterConstraints(String keyspaceName, String tableName, boolean ifTableExists, ColumnIdentifier columnName, ColumnConstraints constraints)
+        AlterConstraints(String keyspaceName, String tableName, boolean ifTableExists, boolean ifColumnExists, ColumnIdentifier columnName, ColumnConstraints.Raw constraints)
         {
             super(keyspaceName, tableName, ifTableExists);
             this.columnName = columnName;
             this.constraints = constraints;
+            this.ifColumnExists = ifColumnExists;
         }
 
         @Override
         public KeyspaceMetadata apply(Epoch epoch, KeyspaceMetadata keyspace, TableMetadata table, ClusterMetadata metadata)
         {
-            TableMetadata.Builder tableBuilder = table.unbuild().epoch(epoch);
 
-            for (ColumnMetadata column : tableBuilder.columns())
+            ColumnMetadata column = table.getColumn(columnName);
+            if (column != null)
             {
-                if (column.name == columnName)
-                {
-                    constraints.validate(column);
-                    column.setColumnConstraints(constraints);
-                    break;
-                }
+                ColumnConstraints oldConstraints = column.getColumnConstraints();
+                ColumnConstraints newConstraints = constraints == null ? ColumnConstraints.NO_OP : constraints.prepare();
+                if (Objects.equals(oldConstraints, newConstraints))
+                    return keyspace;
+                newConstraints.validate(column);
+                TableMetadata.Builder tableBuilder = table.unbuild().epoch(epoch);
+                tableBuilder.alterColumnConstraints(columnName, newConstraints);
+
+                TableMetadata newTable = tableBuilder.build();
+                newTable.validate();
+
+                return keyspace.withSwapped(keyspace.tables.withSwapped(newTable));
             }
-
-            Views.Builder viewsBuilder = keyspace.views.unbuild();
-            TableMetadata tableMetadata = tableBuilder.build();
-            tableMetadata.validate();
-
-            return keyspace.withSwapped(keyspace.tables.withSwapped(tableMetadata))
-                           .withSwapped(viewsBuilder.build());
+            else
+            {
+                if (!ifColumnExists)
+                    throw ire("Column '%s' doesn't exist", columnName);
+            }
+            return keyspace;
         }
     }
 
@@ -783,7 +764,6 @@ public abstract class AlterTableStatement extends AlterSchemaStatement
             RENAME_COLUMNS,
             ALTER_OPTIONS,
             DROP_COMPACT_STORAGE,
-            DROP_CONSTRAINTS,
             ALTER_CONSTRAINTS
         }
 
@@ -792,7 +772,7 @@ public abstract class AlterTableStatement extends AlterSchemaStatement
         private boolean ifColumnExists;
         private boolean ifColumnNotExists;
         private ColumnIdentifier constraintName;
-        private ColumnConstraints constraints;
+        private ColumnConstraints.Raw constraints;
 
         private Kind kind;
 
@@ -839,8 +819,7 @@ public abstract class AlterTableStatement extends AlterSchemaStatement
                 case        RENAME_COLUMNS: return new RenameColumns(keyspaceName, tableName, renamedColumns, ifTableExists, ifColumnExists);
                 case         ALTER_OPTIONS: return new AlterOptions(keyspaceName, tableName, attrs, ifTableExists);
                 case  DROP_COMPACT_STORAGE: return new DropCompactStorage(keyspaceName, tableName, ifTableExists);
-                case      DROP_CONSTRAINTS: return new DropConstraints(keyspaceName, tableName, ifTableExists, constraintName);
-                case     ALTER_CONSTRAINTS: return new AlterConstraints(keyspaceName, tableName, ifTableExists, constraintName, constraints);
+                case     ALTER_CONSTRAINTS: return new AlterConstraints(keyspaceName, tableName, ifTableExists, ifColumnExists, constraintName, constraints);
             }
 
             throw new AssertionError();
@@ -885,17 +864,11 @@ public abstract class AlterTableStatement extends AlterSchemaStatement
             kind = Kind.DROP_COMPACT_STORAGE;
         }
 
-        public void dropConstraints(ColumnIdentifier name)
-        {
-            kind = Kind.DROP_CONSTRAINTS;
-            this.constraintName = name;
-        }
-
-        public void alterConstraints(ColumnIdentifier name, ColumnConstraints.Raw rawConstraints)
+        public void constraint(ColumnIdentifier name, ColumnConstraints.Raw rawConstraints)
         {
             kind = Kind.ALTER_CONSTRAINTS;
             this.constraintName = name;
-            this.constraints = rawConstraints.prepare();
+            this.constraints = rawConstraints;
         }
 
         public void timestamp(long timestamp)
diff --git a/src/java/org/apache/cassandra/cql3/statements/schema/CreateTableStatement.java b/src/java/org/apache/cassandra/cql3/statements/schema/CreateTableStatement.java
index a527a1c2c5..997a402000 100644
--- a/src/java/org/apache/cassandra/cql3/statements/schema/CreateTableStatement.java
+++ b/src/java/org/apache/cassandra/cql3/statements/schema/CreateTableStatement.java
@@ -348,16 +348,14 @@ public final class CreateTableStatement extends AlterSchemaStatement
         {
             ColumnProperties properties = partitionKeyColumnProperties.get(i);
             ColumnIdentifier columnIdentifier = partitionKeyColumns.get(i);
-            builder.addPartitionKeyColumn(columnIdentifier, properties.type, properties.mask);
-            builder.getColumn(columnIdentifier).setColumnConstraints(columnConstraints.get(columnIdentifier));
+            builder.addPartitionKeyColumn(columnIdentifier, properties.type, properties.mask, columnConstraints.get(columnIdentifier));
         }
 
         for (int i = 0; i < clusteringColumns.size(); i++)
         {
             ColumnProperties properties = clusteringColumnProperties.get(i);
             ColumnIdentifier columnIdentifier = clusteringColumns.get(i);
-            builder.addClusteringColumn(columnIdentifier, properties.type, properties.mask);
-            builder.getColumn(columnIdentifier).setColumnConstraints(columnConstraints.get(columnIdentifier));
+            builder.addClusteringColumn(columnIdentifier, properties.type, properties.mask, columnConstraints.get(columnIdentifier));
         }
 
         if (useCompactStorage)
@@ -368,14 +366,12 @@ public final class CreateTableStatement extends AlterSchemaStatement
         {
             columns.forEach((column, properties) -> {
                 if (staticColumns.contains(column))
-                    builder.addStaticColumn(column, properties.type, properties.mask);
+                    builder.addStaticColumn(column, properties.type, properties.mask, columnConstraints.get(column));
                 else
-                    builder.addRegularColumn(column, properties.type, properties.mask);
+                    builder.addRegularColumn(column, properties.type, properties.mask, columnConstraints.get(column));
             });
         }
 
-        columns.keySet().forEach(id -> builder.getColumn(id).setColumnConstraints(columnConstraints.get(id)));
-
         return builder;
     }
 
diff --git a/src/java/org/apache/cassandra/schema/ColumnMetadata.java b/src/java/org/apache/cassandra/schema/ColumnMetadata.java
index cdaec3f80b..e28312532b 100644
--- a/src/java/org/apache/cassandra/schema/ColumnMetadata.java
+++ b/src/java/org/apache/cassandra/schema/ColumnMetadata.java
@@ -363,10 +363,15 @@ public final class ColumnMetadata extends ColumnSpecification implements Selecta
         return columnConstraints;
     }
 
-    public void setColumnConstraints(ColumnConstraints constraints)
+    public ColumnConstraints setColumnConstraints()
+    {
+        return columnConstraints;
+    }
+
+    public ColumnMetadata withNewColumnConstraints(ColumnConstraints constraints)
     {
         constraints.validate(this);
-        this.columnConstraints = constraints;
+        return new ColumnMetadata(ksName, cfName, name, type, position, kind, mask, constraints);
     }
 
     public void removeColumnConstraints()
diff --git a/src/java/org/apache/cassandra/schema/TableMetadata.java b/src/java/org/apache/cassandra/schema/TableMetadata.java
index 4dcec20f92..9fdf5e8215 100644
--- a/src/java/org/apache/cassandra/schema/TableMetadata.java
+++ b/src/java/org/apache/cassandra/schema/TableMetadata.java
@@ -455,6 +455,7 @@ public class TableMetadata implements SchemaElement
     {
         return columns.get(name.bytes);
     }
+
     /**
      * Returns the column of the provided name if it exists, but throws a user-visible exception if that column doesn't
      * exist.
@@ -1294,6 +1295,19 @@ public class TableMetadata implements SchemaElement
             return this;
         }
 
+        public Builder alterColumnConstraints(ColumnIdentifier name, ColumnConstraints constraints)
+        {
+            ColumnMetadata column = columns.get(name.bytes);
+            if (column == null)
+                throw new IllegalArgumentException();
+
+            ColumnMetadata newColumn = column.withNewColumnConstraints(constraints);
+
+            updateColumn(column, newColumn);
+
+            return this;
+        }
+
         Builder alterColumnType(ColumnIdentifier name, AbstractType<?> type)
         {
             ColumnMetadata column = columns.get(name.bytes);
diff --git a/test/distributed/org/apache/cassandra/distributed/test/ColumnConstraintsTest.java b/test/distributed/org/apache/cassandra/distributed/test/ColumnConstraintsTest.java
index 16fc38c55c..77b72ccca1 100644
--- a/test/distributed/org/apache/cassandra/distributed/test/ColumnConstraintsTest.java
+++ b/test/distributed/org/apache/cassandra/distributed/test/ColumnConstraintsTest.java
@@ -23,7 +23,6 @@ import java.util.Map;
 import java.util.Set;
 
 import org.apache.cassandra.cql3.constraints.ConstraintViolationException;
-import org.apache.cassandra.cql3.constraints.InvalidConstraintDefinitionException;
 import org.apache.cassandra.exceptions.InvalidRequestException;
 import org.junit.Test;
 
@@ -52,7 +51,12 @@ public class ColumnConstraintsTest extends TestBaseImpl
         {
             assertThrowsInvalidConstraintException(cluster, String.format("CREATE TABLE %s (pk int, ck1 text CHECK ck1 < 100, ck2 int, v int, " +
                                                                           "PRIMARY KEY ((pk), ck1, ck2));", tableName),
-                                                   "Column 'ck1' is not a number type.");
+                                                   "Constraint 'ck1 <' can be used only for columns of type " +
+                                                   "[org.apache.cassandra.db.marshal.ByteType, org.apache.cassandra.db.marshal.CounterColumnType, " +
+                                                   "org.apache.cassandra.db.marshal.DecimalType, org.apache.cassandra.db.marshal.DoubleType, " +
+                                                   "org.apache.cassandra.db.marshal.FloatType, org.apache.cassandra.db.marshal.Int32Type, " +
+                                                   "org.apache.cassandra.db.marshal.IntegerType, org.apache.cassandra.db.marshal.LongType, " +
+                                                   "org.apache.cassandra.db.marshal.ShortType] but it was class org.apache.cassandra.db.marshal.UTF8Type");
 
             assertThrowsInvalidConstraintException(cluster, String.format("CREATE TABLE %s (pk int, ck1 int CHECK LENGTH(ck1) < 100, ck2 int, v int, " +
                                                                           "PRIMARY KEY ((pk), ck1, ck2));", tableName),
@@ -320,6 +324,6 @@ public class ColumnConstraintsTest extends TestBaseImpl
         assertThatThrownBy(() -> cluster.schemaChange(statement))
                   .describedAs(description)
                   .has(new Condition<Throwable>(t -> t.getClass().getCanonicalName()
-                                                      .equals(InvalidConstraintDefinitionException.class.getCanonicalName()), description));
+                                                      .equals(InvalidRequestException.class.getCanonicalName()), description));
     }
 }
diff --git a/test/unit/org/apache/cassandra/contraints/AlterTableWithTableConstraintValidationTest.java b/test/unit/org/apache/cassandra/contraints/AlterTableWithTableConstraintValidationTest.java
index 584cd955c7..4db12f5a69 100644
--- a/test/unit/org/apache/cassandra/contraints/AlterTableWithTableConstraintValidationTest.java
+++ b/test/unit/org/apache/cassandra/contraints/AlterTableWithTableConstraintValidationTest.java
@@ -20,6 +20,8 @@ package org.apache.cassandra.contraints;
 
 import org.junit.Test;
 
+import org.apache.cassandra.exceptions.InvalidRequestException;
+
 
 public class AlterTableWithTableConstraintValidationTest extends CqlConstraintValidationTester
 {
@@ -222,4 +224,19 @@ public class AlterTableWithTableConstraintValidationTest extends CqlConstraintVa
         // It works
         execute("ALTER TABLE %s WITH cdc = true");
     }
+
+    @Test
+    public void testCreateTableAddConstraintWithIfExists() throws Throwable
+    {
+        createTable("CREATE TABLE %s (pk int, ck1 int, ck2 int, v int, PRIMARY KEY ((pk),ck1, ck2)) WITH CLUSTERING ORDER BY (ck1 ASC);");
+        execute("ALTER TABLE %s ALTER IF EXISTS foo CHECK foo < 100");
+    }
+
+    @Test
+    public void testCreateTableAddConstraintWithNonExistingColumn() throws Throwable
+    {
+        createTable("CREATE TABLE %s (pk int, ck1 int, ck2 int, v int, PRIMARY KEY ((pk),ck1, ck2)) WITH CLUSTERING ORDER BY (ck1 ASC);");
+        String expectedErrorMessage = "Column 'foo' doesn't exist";
+        assertInvalidThrowMessage(expectedErrorMessage, InvalidRequestException.class, "ALTER TABLE %s ALTER foo CHECK foo < 100");
+    }
 }
