diff --git a/CHANGES.txt b/CHANGES.txt
index c453943f6b..925a4a926c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -9,6 +9,7 @@
  * Fix division-by-zero error on get_slice (CASSANDRA-4000)
  * don't change manifest level for cleanup, scrub, and upgradesstables
    operations under LeveledCompactionStrategy (CASSANDRA-3989)
+ * fix race leading to super columns assertion failure (CASSANDRA-3957)
 
 
 1.0.8
diff --git a/src/java/org/apache/cassandra/db/ColumnFamily.java b/src/java/org/apache/cassandra/db/ColumnFamily.java
index cb715dea43..d27a963d9b 100644
--- a/src/java/org/apache/cassandra/db/ColumnFamily.java
+++ b/src/java/org/apache/cassandra/db/ColumnFamily.java
@@ -140,6 +140,26 @@ public class ColumnFamily extends AbstractColumnContainer
         return getType() == ColumnFamilyType.Super;
     }
 
+    /**
+     * Same as addAll() but do a cloneMeShallow of SuperColumn if necessary to
+     * avoid keeping references to the structure (see #3957).
+     */
+    public void addAllWithSCCopy(ColumnFamily cf, Allocator allocator)
+    {
+        if (cf.isSuper())
+        {
+            for (IColumn c : cf)
+            {
+                columns.addColumn(((SuperColumn)c).cloneMeShallow(), allocator);
+            }
+            delete(cf);
+        }
+        else
+        {
+            addAll(cf, allocator);
+        }
+    }
+
     public void addColumn(QueryPath path, ByteBuffer value, long timestamp)
     {
         addColumn(path, value, timestamp, 0);
diff --git a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
index b50662a427..60a3487e14 100644
--- a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
+++ b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
@@ -787,7 +787,10 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
         {
             ColumnFamily cachedRow = getRawCachedRow(key);
             if (cachedRow != null)
-                cachedRow.addAll(columnFamily, HeapAllocator.instance);
+                // columnFamily is what is written in the commit log. Because of the PeriodicCommitLog, this can be done in concurrency
+                // with this. So columnFamily shouldn't be modified and if it contains super columns, neither should they. So for super
+                // columns, we must make sure to clone them when adding to the cache. That's what addAllWithSCCopy does (see #3957)
+                cachedRow.addAllWithSCCopy(columnFamily, HeapAllocator.instance);
         }
     }
 
