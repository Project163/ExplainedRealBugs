diff --git a/CHANGES.txt b/CHANGES.txt
index 4f91a0ee1d..2bb67dde4c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -6,6 +6,7 @@
  * Fix assertion error in ALTER TYPE RENAME (CASSANDRA-6705)
  * Scrub should not always clear out repaired status (CASSANDRA-5351)
  * Improve handling of range tombstone for wide partitions (CASSANDRA-6446)
+ * Fix ClassCastException for compact table with composites (CASSANDRA-6738)
 
 2.1.0-beta1
  * Add flush directory distinct from compaction directories (CASSANDRA-6357)
diff --git a/src/java/org/apache/cassandra/db/composites/CompoundComposite.java b/src/java/org/apache/cassandra/db/composites/CompoundComposite.java
index 9475cc01b2..cae1c9ea6c 100644
--- a/src/java/org/apache/cassandra/db/composites/CompoundComposite.java
+++ b/src/java/org/apache/cassandra/db/composites/CompoundComposite.java
@@ -50,7 +50,11 @@ public class CompoundComposite extends AbstractComposite
 
     public ByteBuffer get(int i)
     {
-        return elements[i];
+        // Note: most consumer should validate that i is within bounds. However, for backward compatibility
+        // reasons, composite dense tables can have names that don't have all their component of the clustering
+        // columns, which may end up here with i > size(). For those calls, it's actually simpler to return null
+        // than to force the caller to special case.
+        return i >= size() ? null : elements[i];
     }
 
     @Override
diff --git a/src/java/org/apache/cassandra/db/composites/CompoundDenseCellName.java b/src/java/org/apache/cassandra/db/composites/CompoundDenseCellName.java
index e16e390e31..0f5b2f5a57 100644
--- a/src/java/org/apache/cassandra/db/composites/CompoundDenseCellName.java
+++ b/src/java/org/apache/cassandra/db/composites/CompoundDenseCellName.java
@@ -34,6 +34,11 @@ public class CompoundDenseCellName extends CompoundComposite implements CellName
         super(elements, elements.length, false);
     }
 
+    CompoundDenseCellName(ByteBuffer[] elements, int size)
+    {
+        super(elements, size, false);
+    }
+
     public int clusteringSize()
     {
         return size;
diff --git a/src/java/org/apache/cassandra/db/composites/CompoundDenseCellNameType.java b/src/java/org/apache/cassandra/db/composites/CompoundDenseCellNameType.java
index 06b25b0a3a..635b997d73 100644
--- a/src/java/org/apache/cassandra/db/composites/CompoundDenseCellNameType.java
+++ b/src/java/org/apache/cassandra/db/composites/CompoundDenseCellNameType.java
@@ -69,8 +69,7 @@ public class CompoundDenseCellNameType extends AbstractCompoundCellNameType
         if (size < fullSize || eoc != Composite.EOC.NONE)
             return new CompoundComposite(components, size, false).withEOC(eoc);
 
-        assert components.length == size;
-        return new CompoundDenseCellName(components);
+        return new CompoundDenseCellName(components, size);
     }
 
     protected Composite copyAndMakeWith(ByteBuffer[] components, int size, Composite.EOC eoc, boolean isStatic)
