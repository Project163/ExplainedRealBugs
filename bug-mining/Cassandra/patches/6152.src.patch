diff --git a/CHANGES.txt b/CHANGES.txt
index bd78e9207c..95931e0485 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,5 +1,6 @@
 3.0.29
  * Fix running Ant rat targets without git (CASSANDRA-17974)
+ * Fix intermittent failure in nodetool toppartitions (CASSANDRA-17254)
 
 
 3.0.28
diff --git a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
index e7c186827b..6e321b226a 100644
--- a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
+++ b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
@@ -1625,12 +1625,14 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
         TabularDataSupport result = new TabularDataSupport(COUNTER_TYPE);
         for (Counter<ByteBuffer> counter : samplerResults.topK)
         {
-            byte[] key = counter.getItem().array();
+            //Not duplicating the buffer for safety because AbstractSerializer and ByteBufferUtil.bytesToHex
+            //don't modify position or limit
+            ByteBuffer key = counter.getItem();
             result.put(new CompositeDataSupport(COUNTER_COMPOSITE_TYPE, COUNTER_NAMES, new Object[] {
-            Hex.bytesToHex(key), // raw
-            counter.getCount(),  // count
-            counter.getError(),  // error
-            metadata.getKeyValidator().getString(ByteBuffer.wrap(key)) })); // string
+                    ByteBufferUtil.bytesToHex(key), // raw
+                    counter.getCount(),  // count
+                    counter.getError(),  // error
+                    metadata.getKeyValidator().getString(key) })); // string
         }
         return new CompositeDataSupport(SAMPLING_RESULT, SAMPLER_NAMES, new Object[]{
         samplerResults.cardinality, result});
