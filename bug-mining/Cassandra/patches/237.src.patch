diff --git a/src/java/org/apache/cassandra/io/SSTableWriter.java b/src/java/org/apache/cassandra/io/SSTableWriter.java
index db336c1e5e..581904b577 100644
--- a/src/java/org/apache/cassandra/io/SSTableWriter.java
+++ b/src/java/org/apache/cassandra/io/SSTableWriter.java
@@ -21,11 +21,7 @@ package org.apache.cassandra.io;
  */
 
 
-import java.io.File;
-import java.io.IOException;
-import java.io.FileOutputStream;
-import java.io.DataOutputStream;
-import java.util.Comparator;
+import java.io.*;
 import java.util.ArrayList;
 
 import org.apache.log4j.Logger;
@@ -34,6 +30,7 @@ import org.apache.cassandra.db.DecoratedKey;
 import org.apache.cassandra.dht.IPartitioner;
 import org.apache.cassandra.service.StorageService;
 import org.apache.cassandra.utils.BloomFilter;
+import org.apache.cassandra.utils.FBUtilities;
 import org.apache.cassandra.config.DatabaseDescriptor;
 import com.reardencommerce.kernel.collections.shared.evictable.ConcurrentLinkedHashMap;
 
@@ -148,7 +145,14 @@ public class SSTableWriter extends SSTable
     static String rename(String tmpFilename)
     {
         String filename = tmpFilename.replace("-" + SSTable.TEMPFILE_MARKER, "");
-        new File(tmpFilename).renameTo(new File(filename));
+        try
+        {
+            FBUtilities.renameWithConfirm(tmpFilename, filename);
+        }
+        catch (IOException e)
+        {
+            throw new IOError(e);
+        }
         return filename;
     }
 
diff --git a/src/java/org/apache/cassandra/net/io/ContentStreamState.java b/src/java/org/apache/cassandra/net/io/ContentStreamState.java
index 307824e5d7..eebb987d51 100644
--- a/src/java/org/apache/cassandra/net/io/ContentStreamState.java
+++ b/src/java/org/apache/cassandra/net/io/ContentStreamState.java
@@ -86,9 +86,9 @@ class ContentStreamState extends StartState
             {       
                 if (logger_.isDebugEnabled())
                     logger_.debug("Removing stream context " + streamContext_);                 
-                handleStreamCompletion(remoteAddress.getAddress());                              
-                bytesRead_ = 0L;
                 fc_.close();
+                handleStreamCompletion(remoteAddress.getAddress());
+                bytesRead_ = 0L;
                 morphState();
             }                            
         }
diff --git a/src/java/org/apache/cassandra/utils/FBUtilities.java b/src/java/org/apache/cassandra/utils/FBUtilities.java
index 7bfb0143d7..ade808ee57 100644
--- a/src/java/org/apache/cassandra/utils/FBUtilities.java
+++ b/src/java/org/apache/cassandra/utils/FBUtilities.java
@@ -280,4 +280,12 @@ public class FBUtilities
             return null;
         return dis.readUTF();
     }
+
+    public static void renameWithConfirm(String tmpFilename, String filename) throws IOException
+    {
+        if (!new File(tmpFilename).renameTo(new File(filename)))
+        {
+            throw new IOException("rename failed of " + filename);
+        }
+    }
 }
