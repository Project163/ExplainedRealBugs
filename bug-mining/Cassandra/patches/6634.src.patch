diff --git a/CHANGES.txt b/CHANGES.txt
index 46d57bf4a0..a0726e8a36 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 5.0.4
+ * Ensure only offline tools can build IntervalTrees without first/last key fields (CASSANDRA-20407)
  * Improve IntervalTree build throughput (CASSANDRA-19596)
  * Avoid limit on RFP fetch in the case of an unresolved static row (CASSANDRA-20323)
  * Include materialized views to the output of DESCRIBE TABLE statements (CASSANDRA-20365)
diff --git a/src/java/org/apache/cassandra/db/lifecycle/SSTableIntervalTree.java b/src/java/org/apache/cassandra/db/lifecycle/SSTableIntervalTree.java
index 9f28fc5995..4d5a87f399 100644
--- a/src/java/org/apache/cassandra/db/lifecycle/SSTableIntervalTree.java
+++ b/src/java/org/apache/cassandra/db/lifecycle/SSTableIntervalTree.java
@@ -25,11 +25,14 @@ import java.util.Collection;
 import java.util.Collections;
 import java.util.List;
 
+import org.apache.cassandra.config.DatabaseDescriptor;
 import org.apache.cassandra.db.PartitionPosition;
 import org.apache.cassandra.io.sstable.format.SSTableReader;
 import org.apache.cassandra.utils.Interval;
 import org.apache.cassandra.utils.IntervalTree;
 
+import static com.google.common.base.Preconditions.checkState;
+
 public class SSTableIntervalTree extends IntervalTree<PartitionPosition, SSTableReader, Interval<PartitionPosition, SSTableReader>>
 {
     private static final SSTableIntervalTree EMPTY = new SSTableIntervalTree(null);
@@ -75,8 +78,28 @@ public class SSTableIntervalTree extends IntervalTree<PartitionPosition, SSTable
             return IntervalTree.EMPTY_ARRAY;
         Interval<PartitionPosition, SSTableReader>[] intervals = new Interval[sstables.size()];
         int i = 0;
+        int missingIntervals = 0;
         for (SSTableReader sstable : sstables)
-            intervals[i++] = sstable.getInterval();
+        {
+            Interval<PartitionPosition, SSTableReader> interval = sstable.getInterval();
+            if (interval == null)
+            {
+                missingIntervals++;
+                continue;
+            }
+            intervals[i++] = interval;
+        }
+
+        // Offline (scrub) tools create SSTableReader without a first and last key and the old interval tree
+        // built a corrupt tree that couldn't be searched so continue to do that rather than complicate Tracker/View
+        if (missingIntervals > 0)
+        {
+            checkState(DatabaseDescriptor.isToolInitialized(), "Can only safely build an interval tree on sstables with missing first and last for offline tools");
+            Interval<PartitionPosition, SSTableReader>[] replacementIntervals = new Interval[intervals.length - missingIntervals];
+            System.arraycopy(intervals, 0, replacementIntervals, 0, replacementIntervals.length);
+            return replacementIntervals;
+        }
+
         return intervals;
     }
 
diff --git a/src/java/org/apache/cassandra/io/sstable/format/SSTableReader.java b/src/java/org/apache/cassandra/io/sstable/format/SSTableReader.java
index 1824412d9b..75272a0b5f 100644
--- a/src/java/org/apache/cassandra/io/sstable/format/SSTableReader.java
+++ b/src/java/org/apache/cassandra/io/sstable/format/SSTableReader.java
@@ -475,7 +475,7 @@ public abstract class SSTableReader extends SSTable implements UnfilteredSource,
         this.openReason = builder.getOpenReason();
         this.first = builder.getFirst();
         this.last = builder.getLast();
-        this.interval = Interval.create(first, last, this);
+        this.interval = first == null || last == null ? null : Interval.create(first, last, this);
         this.bounds = first == null || last == null || AbstractBounds.strictlyWrapsAround(first.getToken(), last.getToken())
                       ? null // this will cause the validation to fail, but the reader is opened with no validation,
                              // e.g. for scrubbing, we should accept screwed bounds
diff --git a/src/java/org/apache/cassandra/utils/Interval.java b/src/java/org/apache/cassandra/utils/Interval.java
index 6e7b8c33a3..b84e0a9d83 100644
--- a/src/java/org/apache/cassandra/utils/Interval.java
+++ b/src/java/org/apache/cassandra/utils/Interval.java
@@ -19,6 +19,8 @@ package org.apache.cassandra.utils;
 
 import com.google.common.base.Objects;
 
+import static com.google.common.base.Preconditions.checkNotNull;
+
 public class Interval<C, D>
 {
     public final C min;
@@ -27,6 +29,8 @@ public class Interval<C, D>
 
     public Interval(C min, C max, D data)
     {
+        checkNotNull(min, "min is null");
+        checkNotNull(max, "max is null");
         this.min = min;
         this.max = max;
         this.data = data;
