diff --git a/src/java/org/apache/cassandra/io/util/PathUtils.java b/src/java/org/apache/cassandra/io/util/PathUtils.java
index 2e321c7e31..bb797d0712 100644
--- a/src/java/org/apache/cassandra/io/util/PathUtils.java
+++ b/src/java/org/apache/cassandra/io/util/PathUtils.java
@@ -59,7 +59,7 @@ public final class PathUtils
     private static final boolean consistentDirectoryListings = CassandraRelevantProperties.DETERMINISM_CONSISTENT_DIRECTORY_LISTINGS.getBoolean();
 
     private static final Set<StandardOpenOption> READ_OPTIONS = unmodifiableSet(EnumSet.of(READ));
-    private static final Set<StandardOpenOption> WRITE_OPTIONS = unmodifiableSet(EnumSet.of(WRITE, CREATE));
+    private static final Set<StandardOpenOption> WRITE_OPTIONS = unmodifiableSet(EnumSet.of(WRITE, CREATE, TRUNCATE_EXISTING));
     private static final Set<StandardOpenOption> WRITE_APPEND_OPTIONS = unmodifiableSet(EnumSet.of(WRITE, CREATE, APPEND));
     private static final Set<StandardOpenOption> READ_WRITE_OPTIONS = unmodifiableSet(EnumSet.of(READ, WRITE, CREATE));
     private static final FileAttribute<?>[] NO_ATTRIBUTES = new FileAttribute[0];
diff --git a/test/unit/org/apache/cassandra/io/util/FileTest.java b/test/unit/org/apache/cassandra/io/util/FileTest.java
index d7340db1ca..4f0345197f 100644
--- a/test/unit/org/apache/cassandra/io/util/FileTest.java
+++ b/test/unit/org/apache/cassandra/io/util/FileTest.java
@@ -21,8 +21,11 @@ package org.apache.cassandra.io.util;
 import java.io.IOException;
 import java.io.PrintWriter;
 import java.io.StringWriter;
+import java.nio.ByteBuffer;
+import java.nio.channels.FileChannel;
 import java.nio.file.Files;
 import java.util.List;
+import java.util.UUID;
 import java.util.concurrent.ThreadLocalRandom;
 import java.util.function.BiFunction;
 import java.util.function.Function;
@@ -30,10 +33,12 @@ import java.util.function.Predicate;
 
 import com.google.common.collect.ImmutableList;
 import com.google.common.util.concurrent.RateLimiter;
+import org.apache.commons.lang3.RandomUtils;
 import org.junit.Assert;
 import org.junit.Test;
 
 import org.apache.cassandra.config.DatabaseDescriptor;
+import org.assertj.core.api.Assertions;
 import org.psjava.util.Triple;
 
 import static java.util.concurrent.TimeUnit.NANOSECONDS;
@@ -328,4 +333,54 @@ public class FileTest
         Assert.assertTrue(new File("somewhere/../").isAncestorOf(new File("somewhere")));
         Assert.assertTrue(new File("../").isAncestorOf(new File("")));
     }
+
+    @Test
+    public void testOverwrite() throws Exception
+    {
+        File f = new File(dir, UUID.randomUUID().toString());
+
+        // write
+        ByteBuffer buf = ByteBuffer.wrap(RandomUtils.nextBytes(100));
+        try (FileChannel fc = f.newWriteChannel(File.WriteMode.OVERWRITE))
+        {
+            fc.write(buf);
+        }
+        Assertions.assertThat(f.length()).isEqualTo(buf.array().length);
+        Assertions.assertThat(Files.readAllBytes(f.toPath())).isEqualTo(buf.array());
+
+        // overwrite
+        buf = ByteBuffer.wrap(RandomUtils.nextBytes(50));
+        try (FileChannel fc = f.newWriteChannel(File.WriteMode.OVERWRITE))
+        {
+            fc.write(buf);
+        }
+        Assertions.assertThat(f.length()).isEqualTo(buf.array().length);
+        Assertions.assertThat(Files.readAllBytes(f.toPath())).isEqualTo(buf.array());
+    }
+
+    @Test
+    public void testAppend() throws Exception
+    {
+        File f = new File(dir, UUID.randomUUID().toString());
+
+        // write
+        ByteBuffer buf1 = ByteBuffer.wrap(RandomUtils.nextBytes(100));
+        try (FileChannel fc = f.newWriteChannel(File.WriteMode.APPEND))
+        {
+            fc.write(buf1);
+        }
+        Assertions.assertThat(f.length()).isEqualTo(buf1.array().length);
+        Assertions.assertThat(Files.readAllBytes(f.toPath())).isEqualTo(buf1.array());
+
+        // overwrite
+        ByteBuffer buf2 = ByteBuffer.wrap(RandomUtils.nextBytes(50));
+        try (FileChannel fc = f.newWriteChannel(File.WriteMode.APPEND))
+        {
+            fc.write(buf2);
+        }
+        Assertions.assertThat(f.length()).isEqualTo(buf1.array().length + buf2.array().length);
+        ByteBuffer buf = ByteBuffer.allocate(buf1.array().length + buf2.array().length);
+        buf.put(buf1.array()).put(buf2.array());
+        Assertions.assertThat(Files.readAllBytes(f.toPath())).isEqualTo(buf.array());
+    }
 }
