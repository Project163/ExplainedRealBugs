diff --git a/CHANGES.txt b/CHANGES.txt
index 0fd1e38d26..183e7d8fec 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -34,6 +34,8 @@
    (CASSANDRA-3170)
  * fix changing durable_writes keyspace option during CF creation
    (CASSANDRA-3292)
+ * fix Deflate compression when compression actually makes the data bigger
+   (CASSANDRA-3370)
 
 
 1.0.0-final
diff --git a/src/java/org/apache/cassandra/io/compress/DeflateCompressor.java b/src/java/org/apache/cassandra/io/compress/DeflateCompressor.java
index 1894f1141e..ba5e83ab35 100644
--- a/src/java/org/apache/cassandra/io/compress/DeflateCompressor.java
+++ b/src/java/org/apache/cassandra/io/compress/DeflateCompressor.java
@@ -76,7 +76,7 @@ public class DeflateCompressor implements ICompressor
         while (true)
         {
             offs += def.deflate(output.buffer, offs, output.buffer.length - offs);
-            if (def.needsInput())
+            if (def.finished())
             {
                 return offs - outputOffset;
             }
