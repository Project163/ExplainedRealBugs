diff --git a/src/java/org/apache/cassandra/db/lifecycle/LogFile.java b/src/java/org/apache/cassandra/db/lifecycle/LogFile.java
index 4318f9c1a0..8657869cf4 100644
--- a/src/java/org/apache/cassandra/db/lifecycle/LogFile.java
+++ b/src/java/org/apache/cassandra/db/lifecycle/LogFile.java
@@ -274,11 +274,12 @@ final class LogFile
 
     private boolean addRecord(LogRecord record)
     {
-        if (!records.add(record))
+        if (records.contains(record))
             return false;
 
         replicas.append(record);
-        return true;
+
+        return records.add(record);
     }
 
     void remove(Type type, SSTable table)
@@ -286,8 +287,8 @@ final class LogFile
         LogRecord record = makeRecord(type, table);
         assert records.contains(record) : String.format("[%s] is not tracked by %s", record, id);
 
-        records.remove(record);
         deleteRecordFiles(record);
+        records.remove(record);
     }
 
     boolean contains(Type type, SSTable table)
diff --git a/src/java/org/apache/cassandra/db/lifecycle/LogTransaction.java b/src/java/org/apache/cassandra/db/lifecycle/LogTransaction.java
index 8b82207c22..ce761653d5 100644
--- a/src/java/org/apache/cassandra/db/lifecycle/LogTransaction.java
+++ b/src/java/org/apache/cassandra/db/lifecycle/LogTransaction.java
@@ -367,14 +367,12 @@ class LogTransaction extends Transactional.AbstractTransactional implements Tran
 
     protected Throwable doCommit(Throwable accumulate)
     {
-        txnFile.commit();
-        return complete(accumulate);
+        return complete(Throwables.perform(accumulate, txnFile::commit));
     }
 
     protected Throwable doAbort(Throwable accumulate)
     {
-        txnFile.abort();
-        return complete(accumulate);
+        return complete(Throwables.perform(accumulate, txnFile::abort));
     }
 
     protected void doPrepare() { }
