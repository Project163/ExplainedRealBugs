diff --git a/src/java/org/apache/cassandra/service/StorageService.java b/src/java/org/apache/cassandra/service/StorageService.java
index 1e73567d1d..8cd5b0b076 100644
--- a/src/java/org/apache/cassandra/service/StorageService.java
+++ b/src/java/org/apache/cassandra/service/StorageService.java
@@ -524,7 +524,8 @@ public class StorageService implements IEndpointStateChangeSubscriber, StorageSe
                 continue;
             }
 
-            if (!entry.getValue().getApplicationState(ApplicationState.SCHEMA).value.equals(Schema.emptyVersion.toString()))
+            VersionedValue schemaValue = entry.getValue().getApplicationState(ApplicationState.SCHEMA);
+            if (schemaValue != null && !schemaValue.value.equals(Schema.emptyVersion.toString()))
             {
                 schemaPresent = true;
                 break;
