diff --git a/CHANGES.txt b/CHANGES.txt
index 087baccf40..0be0e3971d 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 4.0
+ * Don't add localhost to the graph when calculating where to stream from (CASSANDRA-13583)
  * Allow skipping equality-restricted clustering columns in ORDER BY clause (CASSANDRA-10271)
  * Use common nowInSec for validation compactions (CASSANDRA-13671)
  * Improve handling of IR prepare failures (CASSANDRA-13672)
diff --git a/src/java/org/apache/cassandra/dht/RangeFetchMapCalculator.java b/src/java/org/apache/cassandra/dht/RangeFetchMapCalculator.java
index 355d7a9027..1186eab1c6 100644
--- a/src/java/org/apache/cassandra/dht/RangeFetchMapCalculator.java
+++ b/src/java/org/apache/cassandra/dht/RangeFetchMapCalculator.java
@@ -251,8 +251,7 @@ public class RangeFetchMapCalculator
                 sourceFound = addEndpoints(capacityGraph, rangeVertex, false);
             }
 
-            //We could not find any source for this range which passed the filters. Ignore if localhost is part of the endpoints for this range
-            if (!sourceFound && !rangesWithSources.get(range).contains(FBUtilities.getBroadcastAddress()))
+            if (!sourceFound)
                 throw new IllegalStateException("Unable to find sufficient sources for streaming range " + range + " in keyspace " + keyspace);
 
         }
@@ -275,6 +274,9 @@ public class RangeFetchMapCalculator
             if (passFilters(endpoint, localDCCheck))
             {
                 sourceFound = true;
+                // if we pass filters, it means that we don't filter away localhost and we can count it as a source:
+                if (endpoint.equals(FBUtilities.getBroadcastAddress()))
+                    continue; // but don't add localhost to the graph to avoid streaming locally
                 final Vertex endpointVertex = new EndpointVertex(endpoint);
                 capacityGraph.insertVertex(rangeVertex);
                 capacityGraph.insertVertex(endpointVertex);
@@ -303,9 +305,6 @@ public class RangeFetchMapCalculator
                 return false;
         }
 
-        if(endpoint.equals(FBUtilities.getBroadcastAddress()))
-            return false;
-
         return !localDCCheck || isInLocalDC(endpoint);
     }
 
