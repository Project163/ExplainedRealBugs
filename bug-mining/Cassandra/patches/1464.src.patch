diff --git a/CHANGES.txt b/CHANGES.txt
index 10ff2be1ff..9481f5e381 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -75,7 +75,7 @@
    parent CF (CASSANDRA-3877)
  * Finish cleanup up tombstone purge code (CASSANDRA-3872)
  * Avoid NPE on aboarted stream-out sessions (CASSANDRA-3904)
-
+ * BulkRecordWriter throws NPE for counter columns (CASSANDRA-3906)
 
 1.0.8
  * fix race between cleanup and flush on secondary index CFSes (CASSANDRA-3712)
diff --git a/src/java/org/apache/cassandra/hadoop/BulkRecordWriter.java b/src/java/org/apache/cassandra/hadoop/BulkRecordWriter.java
index 9962f246ba..aded15e5d9 100644
--- a/src/java/org/apache/cassandra/hadoop/BulkRecordWriter.java
+++ b/src/java/org/apache/cassandra/hadoop/BulkRecordWriter.java
@@ -143,13 +143,14 @@ implements org.apache.hadoop.mapred.RecordWriter<ByteBuffer,List<Mutation>>
             if (cfType == CFType.SUPER)
             {
                 writer.newSuperColumn(mut.getColumn_or_supercolumn().getSuper_column().name);
-                for (Column column : mut.getColumn_or_supercolumn().getSuper_column().columns)
+                if (colType == ColType.COUNTER)
+                    for (CounterColumn column : mut.getColumn_or_supercolumn().getCounter_super_column().columns)
+                        writer.addCounterColumn(column.name, column.value);
+                else
                 {
-                    if (colType == ColType.COUNTER)
-                        writer.addCounterColumn(column.name, column.value.getLong());
-                    else
+                    for (Column column : mut.getColumn_or_supercolumn().getSuper_column().columns)
                     {
-                        if(0 == column.ttl)
+                        if(column.ttl == 0)
                             writer.addColumn(column.name, column.value, column.timestamp);
                         else
                             writer.addExpiringColumn(column.name, column.value, column.timestamp, column.ttl, System.currentTimeMillis() + (column.ttl * 1000));
@@ -159,10 +160,10 @@ implements org.apache.hadoop.mapred.RecordWriter<ByteBuffer,List<Mutation>>
             else
             {
                 if (colType == ColType.COUNTER)
-                    writer.addCounterColumn(mut.getColumn_or_supercolumn().column.name, mut.getColumn_or_supercolumn().column.value.getLong());
+                    writer.addCounterColumn(mut.getColumn_or_supercolumn().counter_column.name, mut.getColumn_or_supercolumn().counter_column.value);
                 else
 	            {
-                    if(0 == mut.getColumn_or_supercolumn().column.ttl)
+                    if(mut.getColumn_or_supercolumn().column.ttl == 0)
 	                     writer.addColumn(mut.getColumn_or_supercolumn().column.name, mut.getColumn_or_supercolumn().column.value, mut.getColumn_or_supercolumn().column.timestamp);
                     else
                         writer.addExpiringColumn(mut.getColumn_or_supercolumn().column.name, mut.getColumn_or_supercolumn().column.value, mut.getColumn_or_supercolumn().column.timestamp, mut.getColumn_or_supercolumn().column.ttl, System.currentTimeMillis() + (mut.getColumn_or_supercolumn().column.ttl * 1000));
