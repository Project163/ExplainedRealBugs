diff --git a/CHANGES.txt b/CHANGES.txt
index 2b0b683a8d..9fb172919b 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 4.0.4
+ * Generate valid KEYSPACE / MATERIALIZED VIEW for CQL for views (CASSANDRA-17266)
  * Fix timestamp tz parsing (CASSANDRA-17467)
  * Suppress CVE-2021-44521 from driver (CASSANDRA-17459)
  * Upgrade jackson to 2.13.2 (CASSANDRA-17460)
diff --git a/src/java/org/apache/cassandra/cql3/statements/schema/CreateViewStatement.java b/src/java/org/apache/cassandra/cql3/statements/schema/CreateViewStatement.java
index 9d6bac3872..39a4c20a4f 100644
--- a/src/java/org/apache/cassandra/cql3/statements/schema/CreateViewStatement.java
+++ b/src/java/org/apache/cassandra/cql3/statements/schema/CreateViewStatement.java
@@ -281,7 +281,8 @@ public final class CreateViewStatement extends AlterSchemaStatement
 
         attrs.validate();
 
-        if (attrs.hasOption(TableParams.Option.DEFAULT_TIME_TO_LIVE))
+        if (attrs.hasOption(TableParams.Option.DEFAULT_TIME_TO_LIVE)
+            && attrs.getInt(TableParams.Option.DEFAULT_TIME_TO_LIVE.toString(), 0) != 0)
         {
             throw ire("Cannot set default_time_to_live for a materialized view. " +
                       "Data in a materialized view always expire at the same time than " +
diff --git a/src/java/org/apache/cassandra/schema/TableMetadata.java b/src/java/org/apache/cassandra/schema/TableMetadata.java
index a5530ed629..36f2382318 100644
--- a/src/java/org/apache/cassandra/schema/TableMetadata.java
+++ b/src/java/org/apache/cassandra/schema/TableMetadata.java
@@ -1297,7 +1297,7 @@ public class TableMetadata implements SchemaElement
         }
         else
         {
-            params.appendCqlTo(builder);
+            params.appendCqlTo(builder, isView());
         }
         builder.append(";");
     }
diff --git a/src/java/org/apache/cassandra/schema/TableParams.java b/src/java/org/apache/cassandra/schema/TableParams.java
index 2be8a40c5a..62db8f78bd 100644
--- a/src/java/org/apache/cassandra/schema/TableParams.java
+++ b/src/java/org/apache/cassandra/schema/TableParams.java
@@ -255,7 +255,7 @@ public final class TableParams
                           .toString();
     }
 
-    public void appendCqlTo(CqlBuilder builder)
+    public void appendCqlTo(CqlBuilder builder, boolean isView)
     {
         // option names should be in alphabetical order
         builder.append("additional_write_policy = ").appendWithSingleQuotes(additionalWritePolicy.toString())
@@ -273,13 +273,18 @@ public final class TableParams
                .append("AND compression = ").append(compression.asMap())
                .newLine()
                .append("AND crc_check_chance = ").append(crcCheckChance)
-               .newLine()
-               .append("AND default_time_to_live = ").append(defaultTimeToLive)
-               .newLine()
-               .append("AND extensions = ").append(extensions.entrySet()
+               .newLine();
+
+        if (!isView)
+        {
+            builder.append("AND default_time_to_live = ").append(defaultTimeToLive)
+                   .newLine();
+        }
+
+        builder.append("AND extensions = ").append(extensions.entrySet()
                                                              .stream()
                                                              .collect(toMap(Entry::getKey,
-                                                                             e -> "0x" + ByteBufferUtil.bytesToHex(e.getValue()))),
+                                                                            e -> "0x" + ByteBufferUtil.bytesToHex(e.getValue()))),
                                                    false)
                .newLine()
                .append("AND gc_grace_seconds = ").append(gcGraceSeconds)
@@ -293,7 +298,6 @@ public final class TableParams
                .append("AND read_repair = ").appendWithSingleQuotes(readRepair.toString())
                .newLine()
                .append("AND speculative_retry = ").appendWithSingleQuotes(speculativeRetry.toString());
-
     }
 
     public static final class Builder
diff --git a/test/unit/org/apache/cassandra/cql3/ViewTimesTest.java b/test/unit/org/apache/cassandra/cql3/ViewTimesTest.java
index 14d7566d6b..6d375018b0 100644
--- a/test/unit/org/apache/cassandra/cql3/ViewTimesTest.java
+++ b/test/unit/org/apache/cassandra/cql3/ViewTimesTest.java
@@ -30,6 +30,7 @@ import org.apache.cassandra.db.Keyspace;
 import org.apache.cassandra.utils.FBUtilities;
 
 import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.fail;
 
 /*
  * This test class was too large and used to timeout CASSANDRA-16777. We're splitting it into:
@@ -208,7 +209,7 @@ public class ViewTimesTest extends ViewAbstractTest
 
         Thread.sleep(TimeUnit.SECONDS.toMillis(5));
         List<Row> results = executeNet("SELECT d FROM mv WHERE c = 2 AND a = 1 AND b = 1").all();
-        Assert.assertEquals(1, results.size());
+        assertEquals(1, results.size());
         Assert.assertTrue("There should be a null result given back due to ttl expiry", results.get(0).isNull(0));
     }
 
@@ -229,7 +230,7 @@ public class ViewTimesTest extends ViewAbstractTest
         updateView("INSERT INTO %s (a, b, c, d) VALUES (?, ?, ?, ?) USING TTL 3", 1, 1, 1, 1);
 
         Thread.sleep(TimeUnit.SECONDS.toMillis(4));
-        Assert.assertEquals(0, executeNet("SELECT * FROM mv WHERE c = 1 AND a = 1 AND b = 1").all().size());
+        assertEquals(0, executeNet("SELECT * FROM mv WHERE c = 1 AND a = 1 AND b = 1").all().size());
     }
 
     @Test
@@ -252,7 +253,7 @@ public class ViewTimesTest extends ViewAbstractTest
 
         ResultSet mvRows = executeNet("SELECT c FROM mv");
         List<Row> rows = executeNet("SELECT c FROM %s").all();
-        Assert.assertEquals("There should be exactly one row in base", 1, rows.size());
+        assertEquals("There should be exactly one row in base", 1, rows.size());
         int expected = rows.get(0).getInt("c");
         assertRowsNet(mvRows, row(expected));
     }
@@ -272,31 +273,31 @@ public class ViewTimesTest extends ViewAbstractTest
         try
         {
             createView("mv_ttl1", "CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND c IS NOT NULL PRIMARY KEY (k,c) WITH default_time_to_live = 30");
-            Assert.fail("Should fail if TTL is provided for materialized view");
+            fail("Should fail if TTL is provided for materialized view");
         }
         catch (Exception e)
         {
+            assertEquals("Cannot set default_time_to_live for a materialized view. Data in a materialized " +
+                         "view always expire at the same time than the corresponding data in the parent table.",
+                         e.getMessage());
         }
     }
 
     @Test
-    public void testAlterMvWithTTL() throws Throwable
+    public void testAlterMvWithNoZeroTTL() throws Throwable
     {
         createTable("CREATE TABLE %s (" +
                     "k int PRIMARY KEY, " +
                     "c int, " +
                     "val int) WITH default_time_to_live = 60");
 
-        execute("USE " + keyspace());
-        executeNet("USE " + keyspace());
-
-        createView("mv_ttl2", "CREATE MATERIALIZED VIEW %s AS SELECT * FROM %%s WHERE k IS NOT NULL AND c IS NOT NULL PRIMARY KEY (k,c)");
+        createView("mv_ttl2", "CREATE MATERIALIZED VIEW " + keyspace() + ".%s AS SELECT * FROM %%s WHERE k IS NOT NULL AND c IS NOT NULL PRIMARY KEY (k,c)");
 
         // Must NOT include "default_time_to_live" on alter Materialized View
         try
         {
-            executeNet("ALTER MATERIALIZED VIEW " + keyspace()+ ".mv_ttl2 WITH default_time_to_live = 30");
-            Assert.fail("Should fail if TTL is provided while altering materialized view");
+            executeNet("ALTER MATERIALIZED VIEW " + keyspace() + ".mv_ttl2 WITH default_time_to_live = 30");
+            fail("Should fail if TTL is provided while altering materialized view");
         }
         catch (Exception e)
         {
@@ -306,4 +307,42 @@ public class ViewTimesTest extends ViewAbstractTest
                          e.getMessage());
         }
     }
+
+    @Test
+    public void testMvWithZeroTTL() throws Throwable
+    {
+        createTable("CREATE TABLE %s (" +
+                    "k int PRIMARY KEY, " +
+                    "c int, " +
+                    "val int) WITH default_time_to_live = 60");
+
+        try
+        {
+            createView("mv_ttl3", "CREATE MATERIALIZED VIEW " + keyspace() + ".%s AS SELECT * FROM %%s WHERE k IS NOT NULL AND c IS NOT NULL PRIMARY KEY (k,c) WITH default_time_to_live = 0");
+        }
+        catch (Exception e)
+        {
+            fail("Should not fail if TTL equal to 0 is provided while altering materialized view");
+        }
+    }
+
+    @Test
+    public void testAlterMvWithZeroTTL() throws Throwable
+    {
+        createTable("CREATE TABLE %s (" +
+                    "k int PRIMARY KEY, " +
+                    "c int, " +
+                    "val int) WITH default_time_to_live = 60");
+
+        createView("mv_ttl4", "CREATE MATERIALIZED VIEW " + keyspace() + ".%s AS SELECT * FROM %%s WHERE k IS NOT NULL AND c IS NOT NULL PRIMARY KEY (k,c)");
+
+        try
+        {
+            executeNet("ALTER MATERIALIZED VIEW " + keyspace() + ".mv_ttl4 WITH default_time_to_live = 0");
+        }
+        catch (Exception e)
+        {
+            fail("Should not fail if TTL equal to 0 is provided while altering materialized view");
+        }
+    }
 }
diff --git a/test/unit/org/apache/cassandra/cql3/statements/DescribeStatementTest.java b/test/unit/org/apache/cassandra/cql3/statements/DescribeStatementTest.java
index 2b64404cd8..4f41f4ac7c 100644
--- a/test/unit/org/apache/cassandra/cql3/statements/DescribeStatementTest.java
+++ b/test/unit/org/apache/cassandra/cql3/statements/DescribeStatementTest.java
@@ -536,7 +536,7 @@ public class DescribeStatementTest extends CQLTester
                                   "    WHERE pk2 IS NOT NULL AND pk1 IS NOT NULL AND ck2 IS NOT NULL AND ck1 IS NOT NULL\n" +
                                   "    PRIMARY KEY ((pk2, pk1), ck2, ck1)\n" +
                                   " WITH CLUSTERING ORDER BY (ck2 DESC, ck1 ASC)\n" +
-                                  "    AND " + tableParametersCql();
+                                  "    AND " + mvParametersCql();
 
         try
         {
@@ -703,14 +703,25 @@ public class DescribeStatementTest extends CQLTester
 
             String output = executeDescribeNet(KEYSPACE, "DESCRIBE TABLE " + table + withInternals).all().get(0).getString("create_statement");
 
+            executeDescribeNet(KEYSPACE, "CREATE MATERIALIZED VIEW " + table + "_view AS SELECT key FROM " + table
+                    + " WHERE key IS NOT NULL PRIMARY KEY(key)");
+
+            String mvCreateView = executeDescribeNet(KEYSPACE, "DESCRIBE MATERIALIZED VIEW " + table + "_view").all().get(0).getString("create_statement");
+
+            executeDescribeNet(KEYSPACE, "DROP MATERIALIZED VIEW " + table + "_view");
             execute("DROP TABLE %s");
 
             executeNet(output);
+            executeNet(mvCreateView);
 
             String output2 = executeDescribeNet(KEYSPACE, "DESCRIBE TABLE " + table + withInternals).all().get(0).getString("create_statement");
+            String mvCreateView2 = executeDescribeNet(KEYSPACE, "DESCRIBE MATERIALIZED VIEW " + table + "_view").all().get(0).getString("create_statement");
+
             assertEquals(output, output2);
+            assertEquals(mvCreateView, mvCreateView2);
 
             execute("INSERT INTO %s (key) VALUES (1)");
+            executeDescribeNet(KEYSPACE, "DROP MATERIALIZED VIEW " + table + "_view");
         }
     }
 
@@ -784,7 +795,7 @@ public class DescribeStatementTest extends CQLTester
                "    WHERE state IS NOT NULL AND username IS NOT NULL\n" +
                "    PRIMARY KEY (state, username)\n" +
                " WITH CLUSTERING ORDER BY (username ASC)\n" +
-               "    AND " + tableParametersCql();
+               "    AND " + mvParametersCql();
     }
 
     private static String indexOutput(String index, String table, String col)
@@ -845,6 +856,25 @@ public class DescribeStatementTest extends CQLTester
                "    AND speculative_retry = '99p';";
     }
 
+    private static String mvParametersCql()
+    {
+        return "additional_write_policy = '99p'\n" +
+               "    AND bloom_filter_fp_chance = 0.01\n" +
+               "    AND caching = {'keys': 'ALL', 'rows_per_partition': 'NONE'}\n" +
+               "    AND cdc = false\n" +
+               "    AND comment = ''\n" +
+               "    AND compaction = {'class': 'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy', 'max_threshold': '32', 'min_threshold': '4'}\n" +
+               "    AND compression = {'chunk_length_in_kb': '16', 'class': 'org.apache.cassandra.io.compress.LZ4Compressor'}\n" +
+               "    AND crc_check_chance = 1.0\n" +
+               "    AND extensions = {}\n" +
+               "    AND gc_grace_seconds = 864000\n" +
+               "    AND max_index_interval = 2048\n" +
+               "    AND memtable_flush_period_in_ms = 0\n" +
+               "    AND min_index_interval = 128\n" +
+               "    AND read_repair = 'BLOCKING'\n" +
+               "    AND speculative_retry = '99p';";
+    }
+
     private static String keyspaceOutput()
     {
         return "CREATE KEYSPACE test WITH replication = {'class': 'SimpleStrategy', 'replication_factor': '1'}  AND durable_writes = true;";
