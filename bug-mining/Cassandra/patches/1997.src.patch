diff --git a/CHANGES.txt b/CHANGES.txt
index f57f65679c..e3e40b655e 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 1.2.1
+ * GossipingPropertyFileSnitch loads saved dc/rack info if needed (CASSANDRA-5133)
  * drain should flush system CFs too (CASSANDRA-4446)
  * add inter_dc_tcp_nodelay setting (CASSANDRA-5148)
  * re-allow wrapping ranges for start_token/end_token range pairing (CASSANDRA-5106)
diff --git a/src/java/org/apache/cassandra/db/SystemTable.java b/src/java/org/apache/cassandra/db/SystemTable.java
index 18a2666fd0..84d6e78367 100644
--- a/src/java/org/apache/cassandra/db/SystemTable.java
+++ b/src/java/org/apache/cassandra/db/SystemTable.java
@@ -394,6 +394,26 @@ public class SystemTable
         return hostIdMap;
     }
 
+    /**
+     * Return a map of IP addresses containing a map of dc and rack info
+     */
+    public static Map<InetAddress, Map<String,String>> loadDcRackInfo()
+    {
+        Map<InetAddress, Map<String, String>> result = new HashMap<InetAddress, Map<String, String>>();
+        for (UntypedResultSet.Row row : processInternal("SELECT peer, data_center, rack from system." + PEERS_CF))
+        {
+            InetAddress peer = row.getInetAddress("peer");
+            if (row.has("data_center"))
+            {
+                Map<String, String> dcRack = new HashMap<String, String>();
+                dcRack.put("data_center", row.getString("data_center"));
+                dcRack.put("rack", row.getString("rack"));
+                result.put(peer, dcRack);
+            }
+        }
+        return result;
+    }
+
     /**
      * One of three things will happen if you try to read the system table:
      * 1. files are present and you can read them: great
diff --git a/src/java/org/apache/cassandra/locator/GossipingPropertyFileSnitch.java b/src/java/org/apache/cassandra/locator/GossipingPropertyFileSnitch.java
index aa4c4e6bee..b16c136cf6 100644
--- a/src/java/org/apache/cassandra/locator/GossipingPropertyFileSnitch.java
+++ b/src/java/org/apache/cassandra/locator/GossipingPropertyFileSnitch.java
@@ -19,7 +19,9 @@
 package org.apache.cassandra.locator;
 
 import java.net.InetAddress;
+import java.util.Map;
 
+import org.apache.cassandra.db.SystemTable;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -36,6 +38,7 @@ public class GossipingPropertyFileSnitch extends AbstractNetworkTopologySnitch
     private PropertyFileSnitch psnitch;
     private String myDC;
     private String myRack;
+    private Map<InetAddress, Map<String, String>> savedEndpoints;
 
     public GossipingPropertyFileSnitch() throws ConfigurationException
     {
@@ -69,7 +72,13 @@ public class GossipingPropertyFileSnitch extends AbstractNetworkTopologySnitch
         if (epState == null || epState.getApplicationState(ApplicationState.DC) == null)
         {
             if (psnitch == null)
+            {
+                if (savedEndpoints == null)
+                    savedEndpoints = SystemTable.loadDcRackInfo();
+                if (savedEndpoints.containsKey(endpoint))
+                    return savedEndpoints.get(endpoint).get("data_center");
                 throw new RuntimeException("Could not retrieve DC for " + endpoint + " from gossip and PFS compatibility is disabled");
+            }
             else
                 return psnitch.getDatacenter(endpoint);
         }
@@ -91,7 +100,13 @@ public class GossipingPropertyFileSnitch extends AbstractNetworkTopologySnitch
         if (epState == null || epState.getApplicationState(ApplicationState.RACK) == null)
         {
             if (psnitch == null)
+            {
+                if (savedEndpoints == null)
+                    savedEndpoints = SystemTable.loadDcRackInfo();
+                if (savedEndpoints.containsKey(endpoint))
+                    return savedEndpoints.get(endpoint).get("rack");
                 throw new RuntimeException("Could not retrieve rack for " + endpoint + " from gossip and PFS compatibility is disabled");
+            }
             else
                 return psnitch.getRack(endpoint);
         }
