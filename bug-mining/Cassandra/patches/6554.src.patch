diff --git a/CHANGES.txt b/CHANGES.txt
index 0269f479b0..0e454fa198 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 5.1
+ * In simulation tests, correctly set the tokens of replacement nodes (CASSANDRA-19997)
  * During TCM upgrade, retain all properties of existing system tables (CASSANDRA-19992)
  * Properly cancel in-flight futures and reject requests in EpochAwareDebounce during shutdown (CASSANDRA-19848)
  * Provide clearer exception message on failing commitlog_disk_access_mode combinations (CASSANDRA-19812)
diff --git a/src/java/org/apache/cassandra/tcm/sequences/BootstrapAndJoin.java b/src/java/org/apache/cassandra/tcm/sequences/BootstrapAndJoin.java
index 7d316e1ea1..15182fc92b 100644
--- a/src/java/org/apache/cassandra/tcm/sequences/BootstrapAndJoin.java
+++ b/src/java/org/apache/cassandra/tcm/sequences/BootstrapAndJoin.java
@@ -353,6 +353,8 @@ public class BootstrapAndJoin extends MultiStepOperation<Epoch>
             logger.info("Resetting bootstrap progress to start fresh");
             SystemKeyspace.resetAvailableStreamedRanges();
         }
+
+        StorageService.instance.repairPaxosForTopologyChange("bootstrap");
         Future<StreamState> bootstrapStream = StorageService.instance.startBootstrap(metadata, beingReplaced, movements, strictMovements);
         try
         {
diff --git a/test/simulator/main/org/apache/cassandra/simulator/cluster/KeyspaceActions.java b/test/simulator/main/org/apache/cassandra/simulator/cluster/KeyspaceActions.java
index 1cff2ab08f..4b6caa0164 100644
--- a/test/simulator/main/org/apache/cassandra/simulator/cluster/KeyspaceActions.java
+++ b/test/simulator/main/org/apache/cassandra/simulator/cluster/KeyspaceActions.java
@@ -281,8 +281,8 @@ public class KeyspaceActions extends ClusterActions
                     joined.add(join);
                     joined.remove(leave);
                     left.add(leave);
-                    TokenPlacementModel.ReplicatedRanges placementsAfter = placements(joined, currentRf);
                     nodeLookup.setTokenOf(join, nodeLookup.tokenOf(leave));
+                    TokenPlacementModel.ReplicatedRanges placementsAfter = placements(joined, currentRf);
                     Topology during = recomputeTopology(placementsBefore, placementsAfter);
                     updateTopology(during);
                     Topology after = recomputeTopology(placementsAfter, placementsAfter);
diff --git a/test/simulator/main/org/apache/cassandra/simulator/cluster/OnClusterJoin.java b/test/simulator/main/org/apache/cassandra/simulator/cluster/OnClusterJoin.java
index 53484ab318..bb36ad7218 100644
--- a/test/simulator/main/org/apache/cassandra/simulator/cluster/OnClusterJoin.java
+++ b/test/simulator/main/org/apache/cassandra/simulator/cluster/OnClusterJoin.java
@@ -111,7 +111,7 @@ class OnClusterJoin extends OnClusterChangeTopology
 
                 BootstrapAndJoin bootstrapAndJoin = ((BootstrapAndJoin) sequence);
                 assert bootstrapAndJoin.next.ordinal() == kind : String.format("Expected next step to be %s, but got %s", Transformation.Kind.values()[kind], bootstrapAndJoin.next);
-                boolean res = bootstrapAndJoin.finishJoiningRing().executeNext().isContinuable();
+                boolean res = bootstrapAndJoin.executeNext().isContinuable();
                 assert res;
             });
         }
