diff --git a/src/java/org/apache/cassandra/db/lifecycle/LifecycleTransaction.java b/src/java/org/apache/cassandra/db/lifecycle/LifecycleTransaction.java
index e14e2a1ebe..dfa30c7583 100644
--- a/src/java/org/apache/cassandra/db/lifecycle/LifecycleTransaction.java
+++ b/src/java/org/apache/cassandra/db/lifecycle/LifecycleTransaction.java
@@ -386,6 +386,7 @@ public class LifecycleTransaction extends Transactional.AbstractTransactional
         assert !(staged.contains(cancel) || logged.contains(cancel)) : "may only cancel a reader that has not been updated or obsoleted in this transaction: " + cancel;
         originals.remove(cancel);
         marked.remove(cancel);
+        identities.remove(cancel.instanceId);
         maybeFail(unmarkCompacting(singleton(cancel), null));
     }
 
@@ -515,4 +516,4 @@ public class LifecycleTransaction extends Transactional.AbstractTransactional
     {
         return originals.toString();
     }
-}
\ No newline at end of file
+}
diff --git a/test/unit/org/apache/cassandra/db/lifecycle/LifecycleTransactionTest.java b/test/unit/org/apache/cassandra/db/lifecycle/LifecycleTransactionTest.java
index aaa9999c18..f13d1b773c 100644
--- a/test/unit/org/apache/cassandra/db/lifecycle/LifecycleTransactionTest.java
+++ b/test/unit/org/apache/cassandra/db/lifecycle/LifecycleTransactionTest.java
@@ -185,9 +185,10 @@ public class LifecycleTransactionTest extends AbstractTransactionalTest
     {
         ColumnFamilyStore cfs = MockSchema.newCFS();
         Tracker tracker = new Tracker(null, false);
-        List<SSTableReader> readers = readers(0, 3, cfs);
+        List<SSTableReader> readers = readers(0, 4, cfs);
         tracker.addInitialSSTables(readers);
         LifecycleTransaction txn = tracker.tryModify(readers, OperationType.UNKNOWN);
+        txn.cancel(readers.get(3));
         LifecycleTransaction txn2 = txn.split(readers.subList(0, 1));
         Assert.assertEquals(2, txn.originals().size());
         Assert.assertTrue(all(readers.subList(1, 3), in(txn.originals())));
