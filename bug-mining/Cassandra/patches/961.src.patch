diff --git a/CHANGES.txt b/CHANGES.txt
index 0ec7aa720d..cd38c9ac8a 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -56,6 +56,7 @@
  * fix ConcurrentModificationException in repair when dealing with 0.7 node
    (CASSANDRA-2767)
  * use threadsafe collections for StreamInSession (CASSANDRA-2766)
+ * avoid infinite loop when creating merkle tree (CASSANDRA-2758)
 
 
 0.8.0-final
diff --git a/src/java/org/apache/cassandra/utils/MerkleTree.java b/src/java/org/apache/cassandra/utils/MerkleTree.java
index 348f2bd776..135aa20b37 100644
--- a/src/java/org/apache/cassandra/utils/MerkleTree.java
+++ b/src/java/org/apache/cassandra/utils/MerkleTree.java
@@ -178,8 +178,11 @@ public class MerkleTree implements Serializable
             return new Leaf();
         Token midpoint = partitioner.midpoint(left, right);
 
-        Hashable lchild = midpoint.equals(left) ? new Leaf() : initHelper(left, midpoint, inc(depth), max);
-        Hashable rchild =  midpoint.equals(right) ? new Leaf() : initHelper(midpoint, right, inc(depth), max);
+        if (midpoint.equals(left) || midpoint.equals(right))
+            return new Leaf();
+
+        Hashable lchild =  initHelper(left, midpoint, inc(depth), max);
+        Hashable rchild =  initHelper(midpoint, right, inc(depth), max);
         return new Inner(midpoint, lchild, rchild);
     }
 
