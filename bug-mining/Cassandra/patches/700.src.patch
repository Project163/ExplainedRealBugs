diff --git a/src/java/org/apache/cassandra/db/IndexScanCommand.java b/src/java/org/apache/cassandra/db/IndexScanCommand.java
index b9b763d6fc..c2c81f01c9 100644
--- a/src/java/org/apache/cassandra/db/IndexScanCommand.java
+++ b/src/java/org/apache/cassandra/db/IndexScanCommand.java
@@ -55,7 +55,7 @@ public class IndexScanCommand implements MessageProducer
         this.range = range;
     }
 
-    public Message getMessage(int version)
+    public Message getMessage(Integer version)
     {
         DataOutputBuffer dob = new DataOutputBuffer();
         try
diff --git a/src/java/org/apache/cassandra/db/RangeSliceCommand.java b/src/java/org/apache/cassandra/db/RangeSliceCommand.java
index 791d2d5fd4..970f85536f 100644
--- a/src/java/org/apache/cassandra/db/RangeSliceCommand.java
+++ b/src/java/org/apache/cassandra/db/RangeSliceCommand.java
@@ -86,7 +86,7 @@ public class RangeSliceCommand implements MessageProducer
         this.max_keys = max_keys;
     }
 
-    public Message getMessage(int version) throws IOException
+    public Message getMessage(Integer version) throws IOException
     {
         DataOutputBuffer dob = new DataOutputBuffer();
         serializer.serialize(this, dob, version);
diff --git a/src/java/org/apache/cassandra/db/ReadCommand.java b/src/java/org/apache/cassandra/db/ReadCommand.java
index f1b7d44279..3a3e1e3750 100644
--- a/src/java/org/apache/cassandra/db/ReadCommand.java
+++ b/src/java/org/apache/cassandra/db/ReadCommand.java
@@ -47,7 +47,7 @@ public abstract class ReadCommand implements MessageProducer
         return serializer;
     }
 
-    public Message getMessage(int version) throws IOException
+    public Message getMessage(Integer version) throws IOException
     {
         ByteArrayOutputStream bos = new ByteArrayOutputStream();
         DataOutputStream dos = new DataOutputStream(bos);
diff --git a/src/java/org/apache/cassandra/db/RowMutation.java b/src/java/org/apache/cassandra/db/RowMutation.java
index 4b82daad57..810148359f 100644
--- a/src/java/org/apache/cassandra/db/RowMutation.java
+++ b/src/java/org/apache/cassandra/db/RowMutation.java
@@ -19,7 +19,6 @@
 package org.apache.cassandra.db;
 
 import java.io.*;
-import java.net.InetAddress;
 import java.nio.ByteBuffer;
 import java.util.*;
 import java.util.concurrent.ExecutionException;
@@ -30,8 +29,6 @@ import org.apache.commons.lang.StringUtils;
 import org.apache.cassandra.config.CFMetaData;
 import org.apache.cassandra.config.DatabaseDescriptor;
 import org.apache.cassandra.db.filter.QueryPath;
-import org.apache.cassandra.db.marshal.AbstractCommutativeType;
-import org.apache.cassandra.db.marshal.AbstractType;
 import org.apache.cassandra.io.ICompactSerializer;
 import org.apache.cassandra.net.Message;
 import org.apache.cassandra.service.StorageService;
@@ -206,7 +203,7 @@ public class RowMutation implements IMutation, MessageProducer
         Table.open(table_).load(this);
     }
 
-    public Message getMessage(int version) throws IOException
+    public Message getMessage(Integer version) throws IOException
     {
         return makeRowMutationMessage(StorageService.Verb.MUTATION, version);
     }
diff --git a/src/java/org/apache/cassandra/db/Truncation.java b/src/java/org/apache/cassandra/db/Truncation.java
index e4edf33c4f..64ebf8183c 100644
--- a/src/java/org/apache/cassandra/db/Truncation.java
+++ b/src/java/org/apache/cassandra/db/Truncation.java
@@ -67,7 +67,7 @@ public class Truncation implements MessageProducer
         Table.open(keyspace).getColumnFamilyStore(columnFamily).truncate();
     }
 
-    public Message getMessage(int version) throws IOException
+    public Message getMessage(Integer version) throws IOException
     {
         ByteArrayOutputStream bos = new ByteArrayOutputStream();
         DataOutputStream dos = new DataOutputStream(bos);
diff --git a/src/java/org/apache/cassandra/gms/Gossiper.java b/src/java/org/apache/cassandra/gms/Gossiper.java
index 51aaa78901..89907bd110 100644
--- a/src/java/org/apache/cassandra/gms/Gossiper.java
+++ b/src/java/org/apache/cassandra/gms/Gossiper.java
@@ -113,7 +113,7 @@ public class Gossiper implements IFailureDetectionEventListener
                 {
                     MessageProducer prod = new MessageProducer()
                     {
-                        public Message getMessage(int version) throws IOException
+                        public Message getMessage(Integer version) throws IOException
                         {
                             return makeGossipDigestSynMessage(gDigests, version);
                         }
diff --git a/src/java/org/apache/cassandra/net/CachingMessageProducer.java b/src/java/org/apache/cassandra/net/CachingMessageProducer.java
index 88fc2d08a3..cd09ad6d6b 100644
--- a/src/java/org/apache/cassandra/net/CachingMessageProducer.java
+++ b/src/java/org/apache/cassandra/net/CachingMessageProducer.java
@@ -7,14 +7,14 @@ import java.util.Map;
 public class CachingMessageProducer implements MessageProducer
 {
     private final MessageProducer prod;
-    private final Map<Integer, Message> messages = new HashMap<Integer, Message>();
+    private final Map<Integer, Message> messages = new HashMap<Integer, Message>(2);
 
     public CachingMessageProducer(MessageProducer prod)
     {
         this.prod = prod;    
     }
 
-    public synchronized Message getMessage(int version) throws IOException
+    public synchronized Message getMessage(Integer version) throws IOException
     {
         Message msg = messages.get(version);
         if (msg == null)
diff --git a/src/java/org/apache/cassandra/net/MessageProducer.java b/src/java/org/apache/cassandra/net/MessageProducer.java
index c71e75106a..875f6564d1 100644
--- a/src/java/org/apache/cassandra/net/MessageProducer.java
+++ b/src/java/org/apache/cassandra/net/MessageProducer.java
@@ -4,5 +4,5 @@ import java.io.IOException;
 
 public interface MessageProducer
 {
-    public Message getMessage(int version) throws IOException;
+    public Message getMessage(Integer version) throws IOException;
 }
diff --git a/src/java/org/apache/cassandra/service/MigrationManager.java b/src/java/org/apache/cassandra/service/MigrationManager.java
index 9d1c0e5d82..b1abf14e4c 100644
--- a/src/java/org/apache/cassandra/service/MigrationManager.java
+++ b/src/java/org/apache/cassandra/service/MigrationManager.java
@@ -95,7 +95,7 @@ public class MigrationManager implements IEndpointStateChangeSubscriber
     public static void announce(final UUID version, Set<InetAddress> hosts)
     {
         MessageProducer prod = new CachingMessageProducer(new MessageProducer() {
-            public Message getMessage(int protocolVersion) throws IOException
+            public Message getMessage(Integer protocolVersion) throws IOException
             {
                 return makeVersionMessage(version, protocolVersion);
             }
diff --git a/src/java/org/apache/cassandra/streaming/StreamReply.java b/src/java/org/apache/cassandra/streaming/StreamReply.java
index c2b28a89f7..6a0e394c35 100644
--- a/src/java/org/apache/cassandra/streaming/StreamReply.java
+++ b/src/java/org/apache/cassandra/streaming/StreamReply.java
@@ -54,7 +54,7 @@ class StreamReply implements MessageProducer
         this.sessionId = sessionId;
     }
 
-    public Message getMessage(int version) throws IOException
+    public Message getMessage(Integer version) throws IOException
     {
         ByteArrayOutputStream bos = new ByteArrayOutputStream();
         DataOutputStream dos = new DataOutputStream( bos );
diff --git a/src/java/org/apache/cassandra/streaming/StreamRequestMessage.java b/src/java/org/apache/cassandra/streaming/StreamRequestMessage.java
index 2dc980f1ec..153b5bddf7 100644
--- a/src/java/org/apache/cassandra/streaming/StreamRequestMessage.java
+++ b/src/java/org/apache/cassandra/streaming/StreamRequestMessage.java
@@ -88,7 +88,7 @@ class StreamRequestMessage implements MessageProducer
         table = null;
     }
     
-    public Message getMessage(int version)
+    public Message getMessage(Integer version)
     {
         ByteArrayOutputStream bos = new ByteArrayOutputStream();
         DataOutputStream dos = new DataOutputStream(bos);
