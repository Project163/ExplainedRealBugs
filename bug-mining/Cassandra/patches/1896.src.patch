diff --git a/CHANGES.txt b/CHANGES.txt
index ba9e13445e..3b808856fe 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,9 +1,12 @@
 1.2-rc1
+ * acquire references to overlapping sstables during compaction so bloom filter
+   doesn't get free'd prematurely (CASSANDRA-4934)
  * Don't share slice query filter in CQL3 SelectStatement (CASSANDRA-4928)
  * Separate tracing from Log4J (CASSANDRA-4861)
  * Exclude gcable tombstones from merkle-tree computation (CASSANDRA-4905)
  * Better printing of AbstractBounds for tracing (CASSANDRA-4931)
 
+
 1.2-beta2
  * fp rate of 1.0 disables BF entirely; LCS defaults to 1.0 (CASSANDRA-4876)
  * off-heap bloom filters for row keys (CASSANDRA_4865)
diff --git a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
index 882a32256d..a91af8c7cf 100644
--- a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
+++ b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
@@ -889,6 +889,19 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
         return results;
     }
 
+    /**
+     * like getOverlappingSSTables, but acquires references before returning
+     */
+    public Set<SSTableReader> getAndReferenceOverlappingSSTables(Collection<SSTableReader> sstables)
+    {
+        while (true)
+        {
+            Set<SSTableReader> overlapped = getOverlappingSSTables(sstables);
+            if (SSTableReader.acquireReferences(overlapped))
+                return overlapped;
+        }
+    }
+
     /*
      * Called after a BinaryMemtable flushes its in-memory data, or we add a file
      * via bootstrap. This information is cached in the ColumnFamilyStore.
diff --git a/src/java/org/apache/cassandra/db/compaction/CompactionController.java b/src/java/org/apache/cassandra/db/compaction/CompactionController.java
index 3b04833c16..2c8ddba71b 100644
--- a/src/java/org/apache/cassandra/db/compaction/CompactionController.java
+++ b/src/java/org/apache/cassandra/db/compaction/CompactionController.java
@@ -20,6 +20,7 @@ package org.apache.cassandra.db.compaction;
 import java.util.Collection;
 import java.util.Collections;
 import java.util.List;
+import java.util.Set;
 
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -44,6 +45,7 @@ public class CompactionController
 
     public final ColumnFamilyStore cfs;
     private final DataTracker.SSTableIntervalTree overlappingTree;
+    private final Set<SSTableReader> overlappingSSTables;
 
     public final int gcBefore;
     public final int mergeShardBefore;
@@ -66,7 +68,7 @@ public class CompactionController
     {
         this(cfs,
              gcBefore,
-             DataTracker.buildIntervalTree(cfs.getOverlappingSSTables(sstables)));
+             cfs.getAndReferenceOverlappingSSTables(sstables));
     }
 
     /**
@@ -79,7 +81,7 @@ public class CompactionController
 
     private CompactionController(ColumnFamilyStore cfs,
                                    int gcBefore,
-                                   DataTracker.SSTableIntervalTree overlappingTree)
+                                   Set<SSTableReader> overlappingSSTables)
     {
         assert cfs != null;
         this.cfs = cfs;
@@ -89,7 +91,8 @@ public class CompactionController
         // add 5 minutes to be sure we're on the safe side in terms of thread safety (though we should be fine in our
         // current 'stop all write during memtable switch' situation).
         this.mergeShardBefore = (int) ((cfs.oldestUnflushedMemtable() + 5 * 3600) / 1000);
-        this.overlappingTree = overlappingTree;
+        this.overlappingSSTables = overlappingSSTables == null ? Collections.<SSTableReader>emptySet() : overlappingSSTables;
+        overlappingTree = overlappingSSTables == null ? null : DataTracker.buildIntervalTree(overlappingSSTables);
     }
 
     public String getKeyspace()
@@ -169,4 +172,9 @@ public class CompactionController
     {
         throttle.throttle(currentBytes);
     }
+
+    public void close()
+    {
+        SSTableReader.releaseReferences(overlappingSSTables);
+    }
 }
diff --git a/src/java/org/apache/cassandra/db/compaction/CompactionManager.java b/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
index 4f16f6a6d9..5435a576d8 100644
--- a/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
+++ b/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
@@ -661,6 +661,7 @@ public class CompactionManager implements CompactionManagerMBean
             }
             finally
             {
+                controller.close();
                 scanner.close();
                 metrics.finishCompaction(ci);
             }
diff --git a/src/java/org/apache/cassandra/db/compaction/CompactionTask.java b/src/java/org/apache/cassandra/db/compaction/CompactionTask.java
index 575731f941..3c676a6229 100644
--- a/src/java/org/apache/cassandra/db/compaction/CompactionTask.java
+++ b/src/java/org/apache/cassandra/db/compaction/CompactionTask.java
@@ -199,6 +199,8 @@ public class CompactionTask extends AbstractCompactionTask
         }
         finally
         {
+            controller.close();
+
             try
             {
                 iter.close();
diff --git a/src/java/org/apache/cassandra/db/compaction/Scrubber.java b/src/java/org/apache/cassandra/db/compaction/Scrubber.java
index 3946c37fb6..c6855e8bc6 100644
--- a/src/java/org/apache/cassandra/db/compaction/Scrubber.java
+++ b/src/java/org/apache/cassandra/db/compaction/Scrubber.java
@@ -262,6 +262,10 @@ public class Scrubber implements Closeable
                 writer.abort();
             throw Throwables.propagate(t);
         }
+        finally
+        {
+            controller.close();
+        }
 
         if (!outOfOrderRows.isEmpty())
         {
diff --git a/src/java/org/apache/cassandra/streaming/IncomingStreamReader.java b/src/java/org/apache/cassandra/streaming/IncomingStreamReader.java
index 0859eaac87..b4bea58685 100644
--- a/src/java/org/apache/cassandra/streaming/IncomingStreamReader.java
+++ b/src/java/org/apache/cassandra/streaming/IncomingStreamReader.java
@@ -201,6 +201,10 @@ public class IncomingStreamReader
             else
                 throw Throwables.propagate(e);
         }
+        finally
+        {
+            controller.close();
+        }
     }
 
     private void retry()
