diff --git a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
index e953ecfeaf..84c7e8a4af 100644
--- a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
+++ b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
@@ -611,20 +611,27 @@ public final class ColumnFamilyStore implements ColumnFamilyStoreMBean
      */
     int doCompaction(int minThreshold, int maxThreshold) throws IOException
     {
-        logger_.debug("Checking to see if compaction of " + columnFamily_ + " would be useful");
         int filesCompacted = 0;
-        for (List<SSTableReader> sstables : getCompactionBuckets(ssTables_, 50L * 1024L * 1024L))
+        if (minThreshold > 0 && maxThreshold > 0)
         {
-            if (sstables.size() < minThreshold)
+            logger_.debug("Checking to see if compaction of " + columnFamily_ + " would be useful");
+            for (List<SSTableReader> sstables : getCompactionBuckets(ssTables_, 50L * 1024L * 1024L))
             {
-                continue;
+                if (sstables.size() < minThreshold)
+                {
+                    continue;
+                }
+                // if we have too many to compact all at once, compact older ones first -- this avoids
+                // re-compacting files we just created.
+                Collections.sort(sstables);
+                filesCompacted += doFileCompaction(sstables.subList(0, Math.min(sstables.size(), maxThreshold)));
             }
-            // if we have too many to compact all at once, compact older ones first -- this avoids
-            // re-compacting files we just created.
-            Collections.sort(sstables);
-            filesCompacted += doFileCompaction(sstables.subList(0, Math.min(sstables.size(), maxThreshold)));
+            logger_.debug(filesCompacted + " files compacted");
+        }
+        else
+        {
+            logger_.debug("Compaction is currently disabled.");
         }
-        logger_.debug(filesCompacted + " files compacted");
         return filesCompacted;
     }
 
diff --git a/src/java/org/apache/cassandra/tools/NodeProbe.java b/src/java/org/apache/cassandra/tools/NodeProbe.java
index a4eab962ab..7f25e47058 100644
--- a/src/java/org/apache/cassandra/tools/NodeProbe.java
+++ b/src/java/org/apache/cassandra/tools/NodeProbe.java
@@ -429,7 +429,7 @@ public class NodeProbe
     public void setCompactionThreshold(int minimumCompactionThreshold, int maximumCompactionThreshold)
     {
         mcmProxy.setMinimumCompactionThreshold(minimumCompactionThreshold);
-        if (maximumCompactionThreshold > 0)
+        if (maximumCompactionThreshold >= 0)
         {
              mcmProxy.setMaximumCompactionThreshold(maximumCompactionThreshold);
         }
@@ -563,11 +563,25 @@ public class NodeProbe
                 System.exit(1);
             }
             int minthreshold = Integer.parseInt(arguments[1]);
-            int maxthreshold = 0;
+            int maxthreshold = CompactionManager.instance().getMaximumCompactionThreshold();
             if (arguments.length > 2)
             {
                 maxthreshold = Integer.parseInt(arguments[2]);
             }
+
+            if (minthreshold > maxthreshold)
+            {
+                System.err.println("Min threshold can't be greater than Max threshold");
+                NodeProbe.printUsage();
+                System.exit(1);
+            }
+
+            if (minthreshold < 2 && maxthreshold != 0)
+            {
+                System.err.println("Min threshold must be at least 2");
+                NodeProbe.printUsage();
+                System.exit(1);
+            }
             probe.setCompactionThreshold(minthreshold, maxthreshold);
         }
         else
