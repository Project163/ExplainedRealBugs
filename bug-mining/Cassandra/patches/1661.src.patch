diff --git a/tools/bin/cassandra-stress.bat b/tools/bin/cassandra-stress.bat
index 78e8dbbeb6..288b8fed16 100644
--- a/tools/bin/cassandra-stress.bat
+++ b/tools/bin/cassandra-stress.bat
@@ -15,12 +15,16 @@
 
 @echo off
 
+setlocal
+
 if NOT DEFINED CASSANDRA_HOME set CASSANDRA_HOME=%CD%\..\..
-if NOT DEFINED STRESS_HOME set STRESS_HOME=%CD%
+if NOT DEFINED STRESS_HOME set STRESS_HOME=%CD%\..
+
+@REM Include the build\classes\main directory so it works in development
+set CLASSPATH="%CASSANDRA_HOME%\build\classes\stress";"%CASSANDRA_HOME%\build\classes\main";"%CASSANDRA_HOME%\build\classes\thrift"
 
-set CLASSPATH="%STRESS_HOME%\..\lib\*.jar"
+for %%i in ("%STRESS_HOME%\lib\*.jar") do call :append "%%i"
 for %%i in ("%CASSANDRA_HOME%\lib\*.jar") do call :append "%%i"
-    set CLASSPATH=%CLASSPATH%;"%%i"
 goto start
 
 :append
diff --git a/tools/bin/sstablemetadata.bat b/tools/bin/sstablemetadata.bat
index 2b945ecb76..bf06bcab82 100644
--- a/tools/bin/sstablemetadata.bat
+++ b/tools/bin/sstablemetadata.bat
@@ -15,6 +15,8 @@
 
 @echo off
 
+setlocal
+
 if NOT DEFINED CASSANDRA_HOME set CASSANDRA_HOME=%CD%\..\..
 
 set CLASSPATH=""
