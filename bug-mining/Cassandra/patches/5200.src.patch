diff --git a/CHANGES.txt b/CHANGES.txt
index 364720dbc5..ef6f49c6f6 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 3.0.19
+ * Prevent RuntimeException when username or password is empty/null (CASSANDRA-15198)
  * Multiget thrift query returns null records after digest mismatch (CASSANDRA-14812)
  * Skipping illegal legacy cells can break reverse iteration of indexed partitions (CASSANDRA-15178)
  * Handle paging states serialized with a different version than the session's (CASSANDRA-15176)
diff --git a/src/java/org/apache/cassandra/auth/PasswordAuthenticator.java b/src/java/org/apache/cassandra/auth/PasswordAuthenticator.java
index 2b65783efb..602fea4e21 100644
--- a/src/java/org/apache/cassandra/auth/PasswordAuthenticator.java
+++ b/src/java/org/apache/cassandra/auth/PasswordAuthenticator.java
@@ -62,7 +62,7 @@ public class PasswordAuthenticator implements IAuthenticator
     public static final String USERNAME_KEY = "username";
     public static final String PASSWORD_KEY = "password";
 
-    private static final byte NUL = 0;
+    static final byte NUL = 0;
     private SelectStatement authenticateStatement;
 
     public static final String LEGACY_CREDENTIALS_TABLE = "credentials";
@@ -231,7 +231,7 @@ public class PasswordAuthenticator implements IAuthenticator
             byte[] user = null;
             byte[] pass = null;
             int end = bytes.length;
-            for (int i = bytes.length - 1 ; i >= 0; i--)
+            for (int i = bytes.length - 1; i >= 0; i--)
             {
                 if (bytes[i] == NUL)
                 {
@@ -239,13 +239,16 @@ public class PasswordAuthenticator implements IAuthenticator
                         pass = Arrays.copyOfRange(bytes, i + 1, end);
                     else if (user == null)
                         user = Arrays.copyOfRange(bytes, i + 1, end);
+                    else
+                        throw new AuthenticationException("Credential format error: username or password is empty or contains NUL(\\0) character");
+
                     end = i;
                 }
             }
 
-            if (user == null)
+            if (user == null || user.length == 0)
                 throw new AuthenticationException("Authentication ID must not be null");
-            if (pass == null)
+            if (pass == null || pass.length == 0)
                 throw new AuthenticationException("Password must not be null");
 
             username = new String(user, StandardCharsets.UTF_8);
diff --git a/test/unit/org/apache/cassandra/auth/PasswordAuthenticatorTest.java b/test/unit/org/apache/cassandra/auth/PasswordAuthenticatorTest.java
index 37763d74de..02850499cf 100644
--- a/test/unit/org/apache/cassandra/auth/PasswordAuthenticatorTest.java
+++ b/test/unit/org/apache/cassandra/auth/PasswordAuthenticatorTest.java
@@ -18,8 +18,21 @@
 package org.apache.cassandra.auth;
 
 
+import java.nio.charset.StandardCharsets;
+
+import com.google.common.collect.Iterables;
+import org.junit.AfterClass;
+import org.junit.BeforeClass;
 import org.junit.Test;
 
+import com.datastax.driver.core.Authenticator;
+import com.datastax.driver.core.PlainTextAuthProvider;
+import org.apache.cassandra.SchemaLoader;
+import org.apache.cassandra.config.CFMetaData;
+import org.apache.cassandra.cql3.CQLTester;
+import org.apache.cassandra.exceptions.AuthenticationException;
+import org.apache.cassandra.schema.KeyspaceParams;
+
 import static org.apache.cassandra.auth.CassandraRoleManager.*;
 import static org.apache.cassandra.auth.PasswordAuthenticator.*;
 import static org.junit.Assert.assertFalse;
@@ -27,8 +40,11 @@ import static org.junit.Assert.assertTrue;
 import static org.mindrot.jbcrypt.BCrypt.hashpw;
 import static org.mindrot.jbcrypt.BCrypt.gensalt;
 
-public class PasswordAuthenticatorTest
+public class PasswordAuthenticatorTest extends CQLTester
 {
+
+    private static PasswordAuthenticator authenticator = new PasswordAuthenticator();
+
     @Test
     public void testCheckpw() throws Exception
     {
@@ -61,4 +77,67 @@ public class PasswordAuthenticatorTest
         assertFalse(checkpw(DEFAULT_SUPERUSER_PASSWORD, "$2$6$abcdefghijklmnopqrstuvABCDEFGHIJKLMNOPQRSTUVWXYZ01234"));
         assertFalse(checkpw(DEFAULT_SUPERUSER_PASSWORD, "$2a$6$abcdefghijklmnopqrstuvABCDEFGHIJKLMNOPQRSTUVWXYZ01234"));
     }
+
+    @Test(expected = AuthenticationException.class)
+    public void testEmptyUsername()
+    {
+        testDecodeIllegalUserAndPwd("", "pwd");
+    }
+
+    @Test(expected = AuthenticationException.class)
+    public void testEmptyPassword()
+    {
+        testDecodeIllegalUserAndPwd("user", "");
+    }
+
+    @Test(expected = AuthenticationException.class)
+    public void testNULUsername0()
+    {
+        byte[] user = {'u', 's', PasswordAuthenticator.NUL, 'e', 'r'};
+        testDecodeIllegalUserAndPwd(new String(user, StandardCharsets.UTF_8), "pwd");
+    }
+
+    @Test(expected = AuthenticationException.class)
+    public void testNULUsername1()
+    {
+        testDecodeIllegalUserAndPwd(new String(new byte[4]), "pwd");
+    }
+
+    @Test(expected = AuthenticationException.class)
+    public void testNULPassword0()
+    {
+        byte[] pwd = {'p', 'w', PasswordAuthenticator.NUL, 'd'};
+        testDecodeIllegalUserAndPwd("user", new String(pwd, StandardCharsets.UTF_8));
+    }
+
+    @Test(expected = AuthenticationException.class)
+    public void testNULPassword1()
+    {
+        testDecodeIllegalUserAndPwd("user", new String(new byte[4]));
+    }
+
+    private void testDecodeIllegalUserAndPwd(String username, String password)
+    {
+        SaslNegotiator negotiator = authenticator.newSaslNegotiator(null);
+        Authenticator clientAuthenticator = (new PlainTextAuthProvider(username, password))
+                                            .newAuthenticator(null, null);
+
+        negotiator.evaluateResponse(clientAuthenticator.initialResponse());
+        negotiator.getAuthenticatedUser();
+    }
+
+    @BeforeClass
+    public static void setUp()
+    {
+        SchemaLoader.createKeyspace(AuthKeyspace.NAME,
+                                    KeyspaceParams.simple(1),
+                                    Iterables.toArray(AuthKeyspace.metadata().tables, CFMetaData.class));
+        authenticator.setup();
+    }
+
+    @AfterClass
+    public static void tearDown()
+    {
+        schemaChange("DROP KEYSPACE " + AuthKeyspace.NAME);
+    }
 }
\ No newline at end of file
