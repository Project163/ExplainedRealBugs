diff --git a/src/java/org/apache/cassandra/cql3/statements/SelectStatement.java b/src/java/org/apache/cassandra/cql3/statements/SelectStatement.java
index 37dd205530..adc8b34f68 100644
--- a/src/java/org/apache/cassandra/cql3/statements/SelectStatement.java
+++ b/src/java/org/apache/cassandra/cql3/statements/SelectStatement.java
@@ -528,6 +528,8 @@ public class SelectStatement implements CQLStatement
                 for (Term t : restriction.eqValues)
                 {
                     ByteBuffer value = t.getByteBuffer(name.type, variables);
+                    if (value.remaining() > 0xFFFF)
+                        throw new InvalidRequestException("Index expression values may not be larger than 64K");
                     expressions.add(new IndexExpression(name.name.key, IndexOperator.EQ, value));
                 }
             }
@@ -538,6 +540,8 @@ public class SelectStatement implements CQLStatement
                     if (restriction.bound(b) != null)
                     {
                         ByteBuffer value = restriction.bound(b).getByteBuffer(name.type, variables);
+                        if (value.remaining() > 0xFFFF)
+                            throw new InvalidRequestException("Index expression values may not be larger than 64K");
                         expressions.add(new IndexExpression(name.name.key, restriction.getIndexOperator(b), value));
                     }
                 }
diff --git a/src/java/org/apache/cassandra/db/RangeSliceCommand.java b/src/java/org/apache/cassandra/db/RangeSliceCommand.java
index 5511127128..6632f39fb5 100644
--- a/src/java/org/apache/cassandra/db/RangeSliceCommand.java
+++ b/src/java/org/apache/cassandra/db/RangeSliceCommand.java
@@ -233,7 +233,7 @@ class RangeSliceCommandSerializer implements IVersionedSerializer<RangeSliceComm
                     {
                         ByteBufferUtil.writeWithShortLength(expr.column_name, dos);
                         dos.writeInt(expr.op.getValue());
-                        ByteBufferUtil.writeWithLength(expr.value, dos);
+                        ByteBufferUtil.writeWithShortLength(expr.value, dos);
                     }
                 }
             }
diff --git a/src/java/org/apache/cassandra/thrift/ThriftValidation.java b/src/java/org/apache/cassandra/thrift/ThriftValidation.java
index 0b16eeffb6..cf42f9ecfd 100644
--- a/src/java/org/apache/cassandra/thrift/ThriftValidation.java
+++ b/src/java/org/apache/cassandra/thrift/ThriftValidation.java
@@ -555,6 +555,9 @@ public class ThriftValidation
                                                                 me.getMessage()));
             }
 
+            if (expression.value.remaining() > 0xFFFF)
+                throw new InvalidRequestException("Index expression values may not be larger than 64K");
+
             AbstractType<?> valueValidator = Schema.instance.getValueValidator(metadata.ksName, metadata.cfName, expression.column_name);
             try
             {
