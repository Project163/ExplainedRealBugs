diff --git a/CHANGES.txt b/CHANGES.txt
index 049ec51d9c..84cd1e3b9d 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -9,6 +9,8 @@
  * fix to SSTableSimpleUnsortedWriter bufferSize calculation (CASSANDRA-3027)
  * add a 'load new SSTables' functionality to JMX and corresponding "refresh"
    command to the nodetool (CASSANDRA-2991)
+ * make cleanup and normal compaction able to skip empty rows
+   (rows containing nothing but expired tombstones) (CASSANDRA-3039)
 
 0.8.4
  * include files-to-be-streamed in StreamInSession.getSources (CASSANDRA-2972)
diff --git a/src/java/org/apache/cassandra/db/compaction/CompactionManager.java b/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
index 037289ff0b..742536d4a6 100644
--- a/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
+++ b/src/java/org/apache/cassandra/db/compaction/CompactionManager.java
@@ -569,6 +569,9 @@ public class CompactionManager implements CompactionManagerMBean
             while (nni.hasNext())
             {
                 AbstractCompactedRow row = nni.next();
+                if (row.isEmpty())
+                    continue;
+
                 long position = writer.append(row);
                 totalkeysWritten++;
 
@@ -862,8 +865,11 @@ public class CompactionManager implements CompactionManagerMBean
                     SSTableIdentityIterator row = (SSTableIdentityIterator) scanner.next();
                     if (Range.isTokenInRanges(row.getKey().token, ranges))
                     {
+                        AbstractCompactedRow compactedRow = controller.getCompactedRow(row);
+                        if (compactedRow.isEmpty())
+                            continue;
                         writer = maybeCreateWriter(cfs, compactionFileLocation, expectedBloomFilterSize, writer, Collections.singletonList(sstable));
-                        writer.append(controller.getCompactedRow(row));
+                        writer.append(compactedRow);
                         totalkeysWritten++;
                     }
                     else
