diff --git a/CHANGES.txt b/CHANGES.txt
index 4e602c7067..8cf11ba55c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -22,7 +22,7 @@ Merged from 0.8:
  * remove nonlocal DC write optimization since it only worked with
    CL.ONE or CL.LOCAL_QUORUM (CASSANDRA-3577)
  * detect misuses of CounterColumnType (CASSANDRA-3422)
-
+ * Check for 0.0.0.0 is incorrect in CFIF (CASSANDRA-3584)
 
 1.0.5
  * revert CASSANDRA-3407 (see CASSANDRA-3540)
diff --git a/src/java/org/apache/cassandra/hadoop/ColumnFamilyInputFormat.java b/src/java/org/apache/cassandra/hadoop/ColumnFamilyInputFormat.java
index 3634767836..f27a157364 100644
--- a/src/java/org/apache/cassandra/hadoop/ColumnFamilyInputFormat.java
+++ b/src/java/org/apache/cassandra/hadoop/ColumnFamilyInputFormat.java
@@ -211,7 +211,7 @@ public class ColumnFamilyInputFormat extends InputFormat<ByteBuffer, SortedMap<B
             for (String endpoint: range.rpc_endpoints)
             {
                 String endpoint_address = endpoint;
-		        if(endpoint_address == null || endpoint_address == "0.0.0.0")
+		        if (endpoint_address == null || endpoint_address.equals("0.0.0.0"))
 			        endpoint_address = range.endpoints.get(endpointIndex);
 		        endpoints[endpointIndex++] = InetAddress.getByName(endpoint_address).getHostName();
             }
@@ -229,8 +229,13 @@ public class ColumnFamilyInputFormat extends InputFormat<ByteBuffer, SortedMap<B
     private List<String> getSubSplits(String keyspace, String cfName, TokenRange range, Configuration conf) throws IOException
     {
         int splitsize = ConfigHelper.getInputSplitSize(conf);
-        for (String host : range.rpc_endpoints)
+        for (int i = 0; i < range.rpc_endpoints.size(); i++)
         {
+            String host = range.rpc_endpoints.get(i);
+            
+            if (host == null || host.equals("0.0.0.0"))
+                host = range.endpoints.get(i);
+                        
             try
             {
                 Cassandra.Client client = ConfigHelper.createConnection(host, ConfigHelper.getRpcPort(conf), true);
