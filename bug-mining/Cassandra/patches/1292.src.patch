diff --git a/CHANGES.txt b/CHANGES.txt
index b2f08bfe14..f8a1c87ace 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 1.0.4
+ * enforce RP tokens 0..2**127 (CASSANDRA-3501)
  * canonicalize paths exposed through JMX (CASSANDRA-3504)
  * fix "liveSize" stat when sstables are removed (CASSANDRA-3496)
  * add bloom filter FP rates to nodetool cfstats (CASSANDRA-3347)
diff --git a/src/java/org/apache/cassandra/dht/RandomPartitioner.java b/src/java/org/apache/cassandra/dht/RandomPartitioner.java
index e18ec494e8..8082bd9c58 100644
--- a/src/java/org/apache/cassandra/dht/RandomPartitioner.java
+++ b/src/java/org/apache/cassandra/dht/RandomPartitioner.java
@@ -38,6 +38,7 @@ public class RandomPartitioner implements IPartitioner<BigIntegerToken>
 {
     public static final BigInteger ZERO = new BigInteger("0");
     public static final BigIntegerToken MINIMUM = new BigIntegerToken("-1");
+    public static final BigInteger MAXIMUM = new BigInteger("2").pow(127);
 
     private static final byte DELIMITER_BYTE = ":".getBytes()[0];
 
@@ -118,7 +119,11 @@ public class RandomPartitioner implements IPartitioner<BigIntegerToken>
         {
             try
             {
-                new BigInteger(token);
+                BigInteger i = new BigInteger(token);
+                if (i.compareTo(ZERO) < 0)
+                    throw new ConfigurationException("Token must be >= 0");
+                if (i.compareTo(MAXIMUM) > 0)
+                    throw new ConfigurationException("Token must be <= 2**127");
             }
             catch (NumberFormatException e)
             {
@@ -163,7 +168,7 @@ public class RandomPartitioner implements IPartitioner<BigIntegerToken>
         // n-case
         else {
             // NOTE: All divisions must take place in BigDecimals, and all modulo operators must take place in BigIntegers.
-            final BigInteger ri = new BigInteger("2").pow(127);                             //  (used for addition later)
+            final BigInteger ri = MAXIMUM(127);                             //  (used for addition later)
             final BigDecimal r  = new BigDecimal(ri);                                       // The entire range, 2**127
             Token start = (Token)i.next(); BigInteger ti = ((BigIntegerToken)start).token;  // The first token and its value
             Token t; BigInteger tim1 = ti;                                                  // The last token and its value (after loop)
diff --git a/test/unit/org/apache/cassandra/utils/MerkleTreeTest.java b/test/unit/org/apache/cassandra/utils/MerkleTreeTest.java
index 685a191051..911feb7819 100644
--- a/test/unit/org/apache/cassandra/utils/MerkleTreeTest.java
+++ b/test/unit/org/apache/cassandra/utils/MerkleTreeTest.java
@@ -102,8 +102,7 @@ public class MerkleTreeTest
     {
         if (i == -1)
             return new BigIntegerToken(new BigInteger("-1"));
-        BigInteger md5_max = new BigInteger("2").pow(127);
-        BigInteger bint = md5_max.divide(TOKEN_SCALE).multiply(new BigInteger(""+i));
+        BigInteger bint = RandomPartitioner.MAXIMUM.divide(TOKEN_SCALE).multiply(new BigInteger(""+i));
         return new BigIntegerToken(bint);
     }
 
