diff --git a/src/java/org/apache/cassandra/cql3/functions/JavaBasedUDFunction.java b/src/java/org/apache/cassandra/cql3/functions/JavaBasedUDFunction.java
index 30f4c957c6..660d494456 100644
--- a/src/java/org/apache/cassandra/cql3/functions/JavaBasedUDFunction.java
+++ b/src/java/org/apache/cassandra/cql3/functions/JavaBasedUDFunction.java
@@ -615,7 +615,7 @@ final class JavaBasedUDFunction extends UDFunction
     {
         EcjTargetClassLoader()
         {
-            super(UDFClassLoader.insecureClassLoader);
+            super(UDFunction.udfClassLoader);
         }
 
         // This map is usually empty.
diff --git a/src/java/org/apache/cassandra/cql3/functions/UDFunction.java b/src/java/org/apache/cassandra/cql3/functions/UDFunction.java
index 224d775914..f15155409c 100644
--- a/src/java/org/apache/cassandra/cql3/functions/UDFunction.java
+++ b/src/java/org/apache/cassandra/cql3/functions/UDFunction.java
@@ -173,7 +173,7 @@ public abstract class UDFunction extends AbstractFunction implements ScalarFunct
         return false;
     }
 
-    // setup the UDF class loader with no parent class loader so that we have full control about what class/resource UDF uses
+    // setup the UDF class loader with a context class loader as a parent so that we have full control about what class/resource UDF uses
     static final ClassLoader udfClassLoader = new UDFClassLoader();
 
     protected UDFunction(FunctionName name,
@@ -556,11 +556,16 @@ public abstract class UDFunction extends AbstractFunction implements ScalarFunct
             MigrationManager.announceNewFunction(this, true);
     }
 
-    static class UDFClassLoader extends ClassLoader
+    private static class UDFClassLoader extends ClassLoader
     {
         // insecureClassLoader is the C* class loader
         static final ClassLoader insecureClassLoader = Thread.currentThread().getContextClassLoader();
 
+        private UDFClassLoader()
+        {
+            super(insecureClassLoader);
+        }
+
         public URL getResource(String name)
         {
             if (!secureResource(name))
