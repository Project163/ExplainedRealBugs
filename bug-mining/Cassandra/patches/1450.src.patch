diff --git a/CHANGES.txt b/CHANGES.txt
index 63323e4f3b..5d9eaf997f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -70,6 +70,7 @@
  * fix system tests (CASSANDRA-3827)
  * CQL support for altering key_validation_class in ALTER TABLE (CASSANDRA-3781)
  * turn compression on by default (CASSANDRA-3871)
+ * make hexToBytes refuse invalid input (CASSANDRA-2851)
 
 
 1.0.8
diff --git a/src/java/org/apache/cassandra/dht/AbstractByteOrderedPartitioner.java b/src/java/org/apache/cassandra/dht/AbstractByteOrderedPartitioner.java
index 3f085e9c1a..23c01239b9 100644
--- a/src/java/org/apache/cassandra/dht/AbstractByteOrderedPartitioner.java
+++ b/src/java/org/apache/cassandra/dht/AbstractByteOrderedPartitioner.java
@@ -150,6 +150,8 @@ public abstract class AbstractByteOrderedPartitioner extends AbstractPartitioner
         {
             try
             {
+                if (token.length() % 2 == 1)
+                    token = "0" + token;
                 Hex.hexToBytes(token);
             }
             catch (NumberFormatException e)
@@ -160,6 +162,8 @@ public abstract class AbstractByteOrderedPartitioner extends AbstractPartitioner
 
         public Token<byte[]> fromString(String string)
         {
+            if (string.length() % 2 == 1)
+                string = "0" + string;
             return new BytesToken(Hex.hexToBytes(string));
         }
     };
diff --git a/src/java/org/apache/cassandra/utils/Hex.java b/src/java/org/apache/cassandra/utils/Hex.java
index 757099e5dc..7e61d9a664 100644
--- a/src/java/org/apache/cassandra/utils/Hex.java
+++ b/src/java/org/apache/cassandra/utils/Hex.java
@@ -49,7 +49,8 @@ public class Hex
     public static byte[] hexToBytes(String str)
     {
         if (str.length() % 2 == 1)
-            str = "0" + str;
+            throw new NumberFormatException("An hex string representing bytes must have an even length");
+
         byte[] bytes = new byte[str.length() / 2];
         for (int i = 0; i < bytes.length; i++)
         {
diff --git a/test/unit/org/apache/cassandra/cli/CliTest.java b/test/unit/org/apache/cassandra/cli/CliTest.java
index 5232565915..db93aed55e 100644
--- a/test/unit/org/apache/cassandra/cli/CliTest.java
+++ b/test/unit/org/apache/cassandra/cli/CliTest.java
@@ -163,8 +163,8 @@ public class CliTest extends CleanupHelper
         "create column family myCF with column_type='Super' and comparator='UTF8Type' AND subcomparator='UTF8Type' AND default_validation_class=AsciiType;",
         "assume myCF keys as utf8;",
         "create column family Countries with comparator=UTF8Type and column_metadata=[ {column_name: name, validation_class: UTF8Type} ];",
-        "set Countries[1][name] = USA;",
-        "get Countries[1][name];",
+        "set Countries[11][name] = USA;",
+        "get Countries[11][name];",
         "update column family Countries with compaction_strategy = 'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy';",
         "create column family Cities with compaction_strategy = 'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy' and compaction_strategy_options = {min_sstable_size:1024};",
         "set myCF['key']['scName']['firstname'] = 'John';",
diff --git a/test/unit/org/apache/cassandra/utils/HexTest.java b/test/unit/org/apache/cassandra/utils/HexTest.java
index 34a8b306b1..ece4be5a2a 100644
--- a/test/unit/org/apache/cassandra/utils/HexTest.java
+++ b/test/unit/org/apache/cassandra/utils/HexTest.java
@@ -42,11 +42,11 @@ public class HexTest
     {
         String[] values = new String[]
         {
-            "0",
+            "00",
             "10",
-            "100",
-            "101",
-            "f",
+            "0100",
+            "0101",
+            "0f",
             "ff"
         };
         byte[][] expected = new byte[][]
