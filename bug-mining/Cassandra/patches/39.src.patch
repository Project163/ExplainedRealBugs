diff --git a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
index 3d22fe707c..986c803b0e 100644
--- a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
+++ b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
@@ -83,7 +83,7 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
     private AtomicReference<BinaryMemtable> binaryMemtable_;
 
     /* SSTables on disk for this column family */
-    private Set<String> ssTables_ = new HashSet<String>();
+    private Set<String> ssTables_ = new TreeSet<String>(new FileNameComparator(FileNameComparator.Descending));
 
     /* Modification lock used for protecting reads from compactions. */
     private ReentrantReadWriteLock lock_ = new ReentrantReadWriteLock(true);
@@ -557,40 +557,35 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
      */
     private void getColumnFamilyFromDisk(String key, String cf, List<ColumnFamily> columnFamilies, IFilter filter) throws IOException
     {
-        /* Scan the SSTables on disk first */
-        List<String> files = new ArrayList<String>();
         lock_.readLock().lock();
         try
         {
-            files.addAll(ssTables_);
-            Collections.sort(files, new FileNameComparator(FileNameComparator.Descending));
-        }
-        finally
-        {
-            lock_.readLock().unlock();
-        }
-
-        for (String file : files)
-        {
-            /*
-             * Get the BloomFilter associated with this file. Check if the key
-             * is present in the BloomFilter. If not continue to the next file.
-            */
-            boolean bVal = SSTable.isKeyInFile(key, file);
-            if (!bVal)
-            {
-                continue;
-            }
-            ColumnFamily columnFamily = fetchColumnFamily(key, cf, filter, file);
-            if (columnFamily != null)
+            for (String file : ssTables_)
             {
-                columnFamilies.add(columnFamily);
-                if (filter.isDone())
+                /*
+                 * Get the BloomFilter associated with this file. Check if the key
+                 * is present in the BloomFilter. If not continue to the next file.
+                */
+                boolean bVal = SSTable.isKeyInFile(key, file);
+                if (!bVal)
                 {
-                    break;
+                    continue;
+                }
+                ColumnFamily columnFamily = fetchColumnFamily(key, cf, filter, file);
+                if (columnFamily != null)
+                {
+                    columnFamilies.add(columnFamily);
+                    if (filter.isDone())
+                    {
+                        break;
+                    }
                 }
             }
         }
+        finally
+        {
+            lock_.readLock().unlock();
+        }
     }
 
     private ColumnFamily fetchColumnFamily(String key, String cf, IFilter filter, String ssTableFile) throws IOException
@@ -1423,7 +1418,6 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
             }
             if (newfile != null)
             {
-                logger_.debug("Inserting bloom filter for file " + newfile);
                 SSTable.storeBloomFilter(newfile, compactedBloomFilter);
                 ssTables_.add(newfile);
                 totalBytesWritten += (new File(newfile)).length();
diff --git a/test/unit/org/apache/cassandra/CleanupHelper.java b/test/unit/org/apache/cassandra/CleanupHelper.java
index e6499a902b..ea9f872716 100644
--- a/test/unit/org/apache/cassandra/CleanupHelper.java
+++ b/test/unit/org/apache/cassandra/CleanupHelper.java
@@ -5,12 +5,12 @@ import java.io.File;
 import org.junit.BeforeClass;
 
 import org.apache.cassandra.config.DatabaseDescriptor;
-import org.apache.cassandra.db.ColumnFamilyStore;
-import org.apache.cassandra.db.CommitLog;
-import org.apache.cassandra.db.Table;
+import org.apache.log4j.Logger;
 
 public class CleanupHelper
 {
+    private static Logger logger = Logger.getLogger(CleanupHelper.class);
+
     @BeforeClass
     public static void cleanup()
     {
@@ -32,6 +32,7 @@ public class CleanupHelper
             }
             for (File f : dir.listFiles())
             {
+                logger.debug("deleting " + f);
                 f.delete();
             }
         }
diff --git a/test/unit/org/apache/cassandra/db/NameSortTest.java b/test/unit/org/apache/cassandra/db/NameSortTest.java
index 07fda81a62..064ac58813 100644
--- a/test/unit/org/apache/cassandra/db/NameSortTest.java
+++ b/test/unit/org/apache/cassandra/db/NameSortTest.java
@@ -89,7 +89,7 @@ public class NameSortTest extends ColumnFamilyStoreTest
             }
 
             cf = table.get(key, "Super1");
-            assert cf != null;
+            assert cf != null : "key " + key + " is missing!";
             Collection<IColumn> superColumns = cf.getAllColumns();
             assert superColumns.size() == 8;
             for (IColumn superColumn : superColumns)
