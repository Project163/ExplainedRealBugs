diff --git a/CHANGES.txt b/CHANGES.txt
index b01faf50e6..bea44ceb5c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -41,6 +41,8 @@ dev
  * optimize away MessagingService for local range queries (CASSANDRA-1261)
  * pre-emptively drop requests that cannot be processed within RPCTimeout
    (CASSANDRA-685)
+ * make framed transport the default so malformed requests can't OOM the 
+   server (CASSANDRA-475)
 
 
 0.6.4
diff --git a/conf/cassandra.yaml b/conf/cassandra.yaml
index b9733da127..de9b02a7fe 100644
--- a/conf/cassandra.yaml
+++ b/conf/cassandra.yaml
@@ -77,8 +77,15 @@ listen_address: localhost
 rpc_address: localhost
 # port for Thrift to listen on
 rpc_port: 9160
-# Whether or not to use a framed transport for Thrift.
-thrift_framed_transport: false
+
+# Frame size for thrift (maximum field length).
+# 0 disables TFramedTransport in favor of TSocket. 
+thrift_framed_transport_size_in_mb: 15
+
+# The max length of a thrift message, including all fields and
+# internal thrift overhead.
+thrift_max_message_length_in_mb: 16
+
 snapshot_before_compaction: false
 
 # The threshold size in megabytes the binary memtable must grow to,
diff --git a/contrib/py_stress/stress.py b/contrib/py_stress/stress.py
index 78512084ad..0aa9f0606f 100644
--- a/contrib/py_stress/stress.py
+++ b/contrib/py_stress/stress.py
@@ -75,7 +75,7 @@ parser.add_option('-f', '--file', type="string", dest="file",
                   help="write output to file")
 parser.add_option('-p', '--port', type="int", default=9160, dest="port",
                   help="thrift port")
-parser.add_option('-m', '--framed', action="store_true", dest="framed",
+parser.add_option('-m', '--unframed', action="store_false", dest="framed",
                   help="use framed transport")
 parser.add_option('-o', '--operation', type="choice", dest="operation",
                   default="insert", choices=('insert', 'read', 'rangeslice'),
@@ -139,7 +139,7 @@ if options.random:
     key_generator = key_generator_random
 
 
-def get_client(host='127.0.0.1', port=9160, framed=False):
+def get_client(host='127.0.0.1', port=9160, framed=True):
     socket = TSocket.TSocket(host, port)
     if framed:
         transport = TTransport.TFramedTransport(socket)
diff --git a/src/java/org/apache/cassandra/config/Config.java b/src/java/org/apache/cassandra/config/Config.java
index daf41099bb..44bd371224 100644
--- a/src/java/org/apache/cassandra/config/Config.java
+++ b/src/java/org/apache/cassandra/config/Config.java
@@ -43,7 +43,9 @@ public class Config {
     
     public String rpc_address;
     public Integer rpc_port = 9160;
-    public Boolean thrift_framed_transport = false;
+
+    public Integer thrift_max_message_length_in_mb = 16;
+    public Integer thrift_framed_transport_size_in_mb = 15;
     public Boolean snapshot_before_compaction = false;
     
     public Integer binary_memtable_throughput_in_mb = 256;
diff --git a/src/java/org/apache/cassandra/config/Converter.java b/src/java/org/apache/cassandra/config/Converter.java
index 0ff1de4647..86a975a92f 100644
--- a/src/java/org/apache/cassandra/config/Converter.java
+++ b/src/java/org/apache/cassandra/config/Converter.java
@@ -185,9 +185,10 @@ public class Converter {
                 conf.rpc_port = Integer.parseInt(port);
             
             String framedRaw = xmlUtils.getNodeValue("/Storage/ThriftFramedTransport");
-            if (framedRaw != null)
+            if (framedRaw != null && Boolean.valueOf(framedRaw))
             {
-                conf.thrift_framed_transport = Boolean.valueOf(framedRaw);
+                conf.thrift_framed_transport_size_in_mb = 15;
+                System.out.println("TFramedTransport will have a maximum frame size of 15MB");
             }
             
             conf.endpoint_snitch = xmlUtils.getNodeValue("/Storage/EndpointSnitch");
diff --git a/src/java/org/apache/cassandra/config/DatabaseDescriptor.java b/src/java/org/apache/cassandra/config/DatabaseDescriptor.java
index 37f75766e2..8d684416c2 100644
--- a/src/java/org/apache/cassandra/config/DatabaseDescriptor.java
+++ b/src/java/org/apache/cassandra/config/DatabaseDescriptor.java
@@ -263,6 +263,11 @@ public class DatabaseDescriptor
             if (conf.rpc_address != null)
                 rpcAddress = InetAddress.getByName(conf.rpc_address);
             
+            if (conf.thrift_framed_transport_size_in_mb > 0 && conf.thrift_max_message_length_in_mb < conf.thrift_framed_transport_size_in_mb)
+            {
+                throw new ConfigurationException("thrift_max_message_length_in_mb must be greater than thrift_framed_transport_size_in_mb when using TFramedTransport");
+            }
+            
             /* end point snitch */
             if (conf.endpoint_snitch == null)
             {
@@ -626,7 +631,17 @@ public class DatabaseDescriptor
 
     public static boolean isThriftFramed()
     {
-        return conf.thrift_framed_transport;
+        return conf.thrift_framed_transport_size_in_mb > 0;
+    }
+    
+    public static int getThriftMaxMessageLength()
+    {
+        return conf.thrift_max_message_length_in_mb * 1024 * 1024;
+    }
+    
+    public static int getThriftFramedTransportSize() 
+    {
+        return conf.thrift_framed_transport_size_in_mb * 1024 * 1024;
     }
 
     public static AbstractType getComparator(String compareWith) throws ConfigurationException
diff --git a/src/java/org/apache/cassandra/thrift/CassandraDaemon.java b/src/java/org/apache/cassandra/thrift/CassandraDaemon.java
index 8540d310ed..ede1b22871 100644
--- a/src/java/org/apache/cassandra/thrift/CassandraDaemon.java
+++ b/src/java/org/apache/cassandra/thrift/CassandraDaemon.java
@@ -153,14 +153,18 @@ public class CassandraDaemon extends org.apache.cassandra.service.AbstractCassan
         logger.info(String.format("Binding thrift service to %s:%s", listenAddr, listenPort));
 
         // Protocol factory
-        TProtocolFactory tProtocolFactory = new TBinaryProtocol.Factory();
+        TProtocolFactory tProtocolFactory = new TBinaryProtocol.Factory(false, 
+                                                                        true, 
+                                                                        DatabaseDescriptor.getThriftMaxMessageLength());
         
         // Transport factory
         TTransportFactory inTransportFactory, outTransportFactory;
         if (DatabaseDescriptor.isThriftFramed())
         {
-            inTransportFactory = new TFramedTransport.Factory();
-            outTransportFactory = new TFramedTransport.Factory();
+            int tFramedTransportSize = DatabaseDescriptor.getThriftFramedTransportSize();
+            inTransportFactory = new TFramedTransport.Factory(tFramedTransportSize);
+            outTransportFactory = new TFramedTransport.Factory(tFramedTransportSize);
+            logger.info("Using TFramedTransport with a max frame size of {} bytes.", tFramedTransportSize);
             
         }
         else
diff --git a/test/system/__init__.py b/test/system/__init__.py
index a3ffe4e2b8..567b30c786 100644
--- a/test/system/__init__.py
+++ b/test/system/__init__.py
@@ -37,7 +37,7 @@ import Cassandra
 
 def get_thrift_client(host='127.0.0.1', port=9170):
     socket = TSocket.TSocket(host, port)
-    transport = TTransport.TBufferedTransport(socket)
+    transport = TTransport.TFramedTransport(socket)
     protocol = TBinaryProtocol.TBinaryProtocolAccelerated(transport)
     client = Cassandra.Client(protocol)
     client.transport = transport
