diff --git a/CHANGES.txt b/CHANGES.txt
index 834a8ec0df..45c975417c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -51,6 +51,8 @@
  * fix handling of the empty byte buffer by ReversedType (CASSANDRA-3111)
  * optionally skip log4j configuration (CASSANDRA-3061)
  * bundle sstableloader with the debian package (CASSANDRA-3113)
+ * don't try to build secondary indexes when there is none (CASSANDRA-3123)
+
 
 0.8.4
  * include files-to-be-streamed in StreamInSession.getSources (CASSANDRA-2972)
diff --git a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
index 6bc3bab9b4..538e690e9c 100644
--- a/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
+++ b/src/java/org/apache/cassandra/db/ColumnFamilyStore.java
@@ -343,7 +343,7 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
                 {
                     throw new AssertionError(e);
                 }
-                buildSecondaryIndexes(getSSTables(), FBUtilities.singleton(info.name));
+                maybeBuildSecondaryIndexes(getSSTables(), FBUtilities.singleton(info.name));
                 SystemTable.setIndexBuilt(table.name, indexedCfMetadata.cfName);
             }
         };
@@ -360,8 +360,15 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
                                         : new LocalByPartionerType(StorageService.getPartitioner());
     }
 
-    public void buildSecondaryIndexes(Collection<SSTableReader> sstables, SortedSet<ByteBuffer> columns)
+    /**
+     * Build secondary indexes for the provided {@code columns}.
+     * This does nothing if {@code columns} is empty.
+     */
+    public void maybeBuildSecondaryIndexes(Collection<SSTableReader> sstables, SortedSet<ByteBuffer> columns)
     {
+        if (columns.isEmpty())
+            return;
+
         logger.info(String.format("Submitting index build of %s for data in %s",
                                   metadata.comparator.getString(columns), StringUtils.join(sstables, ", ")));
         Table.IndexBuilder builder = table.createIndexBuilder(this, columns, new ReducingKeyIterator(sstables));
@@ -542,7 +549,7 @@ public class ColumnFamilyStore implements ColumnFamilyStoreMBean
         data.addSSTables(sstables); // this will call updateCacheSizes() for us
 
         logger.info("Requesting a full secondary index re-build for " + table.name + "/" + columnFamily);
-        buildSecondaryIndexes(sstables, getIndexedColumns());
+        maybeBuildSecondaryIndexes(sstables, getIndexedColumns());
 
         logger.info("Setting up new generation: " + generation);
         fileIndexGenerator.set(generation);
diff --git a/src/java/org/apache/cassandra/streaming/StreamInSession.java b/src/java/org/apache/cassandra/streaming/StreamInSession.java
index 713f2b8ff7..d1d6a8b43a 100644
--- a/src/java/org/apache/cassandra/streaming/StreamInSession.java
+++ b/src/java/org/apache/cassandra/streaming/StreamInSession.java
@@ -158,8 +158,8 @@ public class StreamInSession
             // build secondary indexes
             for (Map.Entry<ColumnFamilyStore, List<SSTableReader>> entry : cfstores.entrySet())
             {
-                if (entry.getKey() != null && !entry.getKey().getIndexedColumns().isEmpty())
-                    entry.getKey().buildSecondaryIndexes(entry.getValue(), entry.getKey().getIndexedColumns());
+                if (entry.getKey() != null)
+                    entry.getKey().maybeBuildSecondaryIndexes(entry.getValue(), entry.getKey().getIndexedColumns());
             }
 
             // send reply to source that we're done
