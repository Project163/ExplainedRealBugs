diff --git a/src/java/org/apache/cassandra/io/util/MmappedSegmentedFile.java b/src/java/org/apache/cassandra/io/util/MmappedSegmentedFile.java
index 623f65a9d4..1109d374b2 100644
--- a/src/java/org/apache/cassandra/io/util/MmappedSegmentedFile.java
+++ b/src/java/org/apache/cassandra/io/util/MmappedSegmentedFile.java
@@ -269,7 +269,7 @@ public class MmappedSegmentedFile extends SegmentedFile
             private static long[] ensureCapacity(long[] boundaries, int fixedCount)
             {
                 if (fixedCount + 1 >= boundaries.length)
-                    return Arrays.copyOf(boundaries, boundaries.length * 2);
+                    return Arrays.copyOf(boundaries, Math.max(fixedCount + 2, boundaries.length * 2));
                 return boundaries;
             }
 
