diff --git a/CHANGES.txt b/CHANGES.txt
index f370ebc2d9..814fe99ec7 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,6 @@
 1.0.10
+ * avoid streaming empty files with bulk loader if sstablewriter errors out
+   (CASSANDRA-3946)
  * support PropertyFileSnitch in bulk loader (CASSANDRA-4145)
  * add auto_snapshot option allowing disabling snapshot before drop/truncate
    (CASSANDRA-3710)
diff --git a/src/java/org/apache/cassandra/io/sstable/AbstractSSTableSimpleWriter.java b/src/java/org/apache/cassandra/io/sstable/AbstractSSTableSimpleWriter.java
index 163bbbd849..80531e633a 100644
--- a/src/java/org/apache/cassandra/io/sstable/AbstractSSTableSimpleWriter.java
+++ b/src/java/org/apache/cassandra/io/sstable/AbstractSSTableSimpleWriter.java
@@ -79,7 +79,7 @@ public abstract class AbstractSSTableSimpleWriter
         int maxGen = 0;
         for (Descriptor desc : existing)
             maxGen = Math.max(maxGen, desc.generation);
-        return new Descriptor(directory, keyspace, columnFamily, maxGen + 1, false).filenameFor(Component.DATA);
+        return new Descriptor(directory, keyspace, columnFamily, maxGen + 1, true).filenameFor(Component.DATA);
     }
 
     /**
diff --git a/src/java/org/apache/cassandra/io/sstable/SSTableSimpleUnsortedWriter.java b/src/java/org/apache/cassandra/io/sstable/SSTableSimpleUnsortedWriter.java
index 40e37e2820..175512ecf1 100644
--- a/src/java/org/apache/cassandra/io/sstable/SSTableSimpleUnsortedWriter.java
+++ b/src/java/org/apache/cassandra/io/sstable/SSTableSimpleUnsortedWriter.java
@@ -105,12 +105,22 @@ public class SSTableSimpleUnsortedWriter extends AbstractSSTableSimpleWriter
         if (keys.isEmpty())
             return;
 
-        SSTableWriter writer = getWriter();
-        for (Map.Entry<DecoratedKey, ColumnFamily> entry : keys.entrySet())
+        SSTableWriter writer = null;
+        try
         {
-            writer.append(entry.getKey(), entry.getValue());
+            writer = getWriter();
+            for (Map.Entry<DecoratedKey, ColumnFamily> entry : keys.entrySet())
+            {
+                writer.append(entry.getKey(), entry.getValue());
+            }
+            writer.closeAndOpenReader();
+        }
+        catch (IOException e)
+        {
+            if (writer != null)
+                writer.abort();
+            throw e;
         }
-        writer.closeAndOpenReader();
         currentSize = 0;
         keys.clear();
     }
diff --git a/src/java/org/apache/cassandra/io/sstable/SSTableSimpleWriter.java b/src/java/org/apache/cassandra/io/sstable/SSTableSimpleWriter.java
index 340fb4fd06..92a7ba99d2 100644
--- a/src/java/org/apache/cassandra/io/sstable/SSTableSimpleWriter.java
+++ b/src/java/org/apache/cassandra/io/sstable/SSTableSimpleWriter.java
@@ -67,9 +67,17 @@ public class SSTableSimpleWriter extends AbstractSSTableSimpleWriter
 
     public void close() throws IOException
     {
-        if (currentKey != null)
-            writeRow(currentKey, columnFamily);
-        writer.closeAndOpenReader();
+        try
+        {
+            if (currentKey != null)
+                writeRow(currentKey, columnFamily);
+            writer.closeAndOpenReader();
+        }
+        catch (IOException e)
+        {
+            writer.abort();
+            throw e;
+        }
     }
 
     protected void writeRow(DecoratedKey key, ColumnFamily columnFamily) throws IOException
