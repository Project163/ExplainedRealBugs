diff --git a/src/java/org/apache/cassandra/db/CompactionManager.java b/src/java/org/apache/cassandra/db/CompactionManager.java
index d8d38bdef3..723663dad1 100644
--- a/src/java/org/apache/cassandra/db/CompactionManager.java
+++ b/src/java/org/apache/cassandra/db/CompactionManager.java
@@ -1122,6 +1122,7 @@ public class CompactionManager implements CompactionManagerMBean
 
         public void write(PageCacheInformer out) throws IOException
         {
+            assert row.dataSize != 0;
             out.writeLong(row.dataSize);
             row.echoData(out);
         }
diff --git a/src/java/org/apache/cassandra/io/LazilyCompactedRow.java b/src/java/org/apache/cassandra/io/LazilyCompactedRow.java
index 92a95499d8..3e48d38a70 100644
--- a/src/java/org/apache/cassandra/io/LazilyCompactedRow.java
+++ b/src/java/org/apache/cassandra/io/LazilyCompactedRow.java
@@ -98,6 +98,7 @@ public class LazilyCompactedRow extends AbstractCompactedRow implements IIterabl
         if (rows.size() == 1 && !shouldPurge && rows.get(0).sstable.descriptor.isLatestVersion && !forceDeserialize)
         {
             SSTableIdentityIterator row = rows.get(0);
+            assert row.dataSize != 0;
             out.writeLong(row.dataSize);
             row.echoData(out);
             return;
@@ -106,7 +107,9 @@ public class LazilyCompactedRow extends AbstractCompactedRow implements IIterabl
         DataOutputBuffer clockOut = new DataOutputBuffer();
         ColumnFamily.serializer().serializeCFInfo(emptyColumnFamily, clockOut);
 
-        out.writeLong(headerBuffer.getLength() + clockOut.getLength() + columnSerializedSize);
+        long dataSize = headerBuffer.getLength() + clockOut.getLength() + columnSerializedSize;
+        assert dataSize != 0;
+        out.writeLong(dataSize);
         out.write(headerBuffer.getData(), 0, headerBuffer.getLength());
         out.write(clockOut.getData(), 0, clockOut.getLength());
         out.writeInt(columnCount);
diff --git a/src/java/org/apache/cassandra/io/PrecompactedRow.java b/src/java/org/apache/cassandra/io/PrecompactedRow.java
index 16b5ff7d9c..2899249e09 100644
--- a/src/java/org/apache/cassandra/io/PrecompactedRow.java
+++ b/src/java/org/apache/cassandra/io/PrecompactedRow.java
@@ -118,6 +118,7 @@ public class PrecompactedRow extends AbstractCompactedRow
 
     public void write(PageCacheInformer out) throws IOException
     {
+        assert buffer.getLength() != 0;
         out.writeLong(buffer.getLength());
 
         List<Pair<Integer, Integer>> pageCacheMarkers = buffer.getPageCacheMarkers();
diff --git a/src/java/org/apache/cassandra/io/sstable/SSTableWriter.java b/src/java/org/apache/cassandra/io/sstable/SSTableWriter.java
index a46be8b7b4..9205b46303 100644
--- a/src/java/org/apache/cassandra/io/sstable/SSTableWriter.java
+++ b/src/java/org/apache/cassandra/io/sstable/SSTableWriter.java
@@ -147,7 +147,9 @@ public class SSTableWriter extends SSTable
         // seek back and write the row size (not including the size Long itself)
         long endPosition = dataFile.getFilePointer();
         dataFile.seek(sizePosition);
-        dataFile.writeLong(endPosition - (sizePosition + 8));
+        long dataSize = endPosition - (sizePosition + 8);
+        assert dataSize != 0;
+        dataFile.writeLong(dataSize);
         // finally, reset for next row
         dataFile.seek(endPosition);
         afterAppend(decoratedKey, startPosition);
