diff --git a/src/java/org/apache/cassandra/db/CompactionManager.java b/src/java/org/apache/cassandra/db/CompactionManager.java
index 3799416f7e..5c911889c5 100644
--- a/src/java/org/apache/cassandra/db/CompactionManager.java
+++ b/src/java/org/apache/cassandra/db/CompactionManager.java
@@ -681,6 +681,11 @@ public class CompactionManager implements CompactionManagerMBean
         assert !cfs.isIndex();
         Table table = cfs.table;
         Collection<Range> ranges = StorageService.instance.getLocalRanges(table.name);
+        if (ranges.isEmpty())
+        {
+            logger.info("Cleanup cannot be ran before the node join the ring");
+            return;
+        }
 
         for (SSTableReader sstable : cfs.getSSTables())
         {
