diff --git a/build.xml b/build.xml
index 76918235db..8b524f7737 100644
--- a/build.xml
+++ b/build.xml
@@ -1246,6 +1246,13 @@
         <jvmarg value="-ea"/>
         <jvmarg value="-Dcassandra.debugrefcount=true"/>
         <jvmarg value="-Xss256k"/>
+        <!-- When we do classloader manipulation SoftReferences can cause memory leaks
+             that can OOM our test runs. The next two settings informs our GC
+             algorithm to limit the metaspace size and clean up SoftReferences
+             more aggressively rather than waiting. See CASSANDRA-14922 for more details.
+        -->
+        <jvmarg value="-XX:MaxMetaspaceSize=256M" />
+        <jvmarg value="-XX:SoftRefLRUPolicyMSPerMB=0" />
         <jvmarg value="-Dcassandra.memtable_row_overhead_computation_step=100"/>
         <jvmarg value="-Dcassandra.test.use_prepared=${cassandra.test.use_prepared}"/>
 	    <jvmarg value="-Dcassandra.test.offsetseed=@{poffset}"/>
diff --git a/ide/idea-iml-file.xml b/ide/idea-iml-file.xml
index 0f2af9b942..338d7806e9 100644
--- a/ide/idea-iml-file.xml
+++ b/ide/idea-iml-file.xml
@@ -33,7 +33,8 @@
             <sourceFolder url="file://$MODULE_DIR$/test/microbench" isTestSource="true" />
             <sourceFolder url="file://$MODULE_DIR$/test/burn" isTestSource="true" />
             <sourceFolder url="file://$MODULE_DIR$/test/pig" isTestSource="true" />
-            <sourceFolder url="file://$MODULE_DIR$/test/distributed" isTestSource="true" />
+<!--              We don't include the distributed source since it has a language level of 8, and there is no clean way to set a different language level for tests in Idea without creating a separate module -->
+<!--            <sourceFolder url="file://$MODULE_DIR$/test/distributed" isTestSource="true" /> -->
             <sourceFolder url="file://$MODULE_DIR$/test/resources" type="java-test-resource" />
             <excludeFolder url="file://$MODULE_DIR$/.idea" />
             <excludeFolder url="file://$MODULE_DIR$/.settings" />
diff --git a/ide/idea/workspace.xml b/ide/idea/workspace.xml
index 1645d568c8..e632b5f040 100644
--- a/ide/idea/workspace.xml
+++ b/ide/idea/workspace.xml
@@ -168,7 +168,7 @@
       <option name="MAIN_CLASS_NAME" value="" />
       <option name="METHOD_NAME" value="" />
       <option name="TEST_OBJECT" value="class" />
-      <option name="VM_PARAMETERS" value="-Dcassandra.config=file://$PROJECT_DIR$/test/conf/cassandra.yaml -Dlogback.configurationFile=file://$PROJECT_DIR$/test/conf/logback-test.xml -Dcassandra.logdir=$PROJECT_DIR$/build/test/logs -ea" />
+      <option name="VM_PARAMETERS" value="-Dcassandra.config=file://$PROJECT_DIR$/test/conf/cassandra.yaml -Dlogback.configurationFile=file://$PROJECT_DIR$/test/conf/logback-test.xml -Dcassandra.logdir=$PROJECT_DIR$/build/test/logs -ea -XX:MaxMetaspaceSize=256M -XX:SoftRefLRUPolicyMSPerMB=0" />
       <option name="PARAMETERS" value="" />
       <option name="WORKING_DIRECTORY" value="" />
       <option name="ENV_VARIABLES" />
@@ -356,4 +356,4 @@
       </provider>
     </entry>
   </component>
-</project>
\ No newline at end of file
+</project>
diff --git a/src/java/org/apache/cassandra/concurrent/ScheduledExecutors.java b/src/java/org/apache/cassandra/concurrent/ScheduledExecutors.java
index 60f07dc744..489f58e32d 100644
--- a/src/java/org/apache/cassandra/concurrent/ScheduledExecutors.java
+++ b/src/java/org/apache/cassandra/concurrent/ScheduledExecutors.java
@@ -47,7 +47,7 @@ public class ScheduledExecutors
     {
         ExecutorService[] executors = new ExecutorService[] { scheduledTasks, nonPeriodicTasks, optionalTasks };
         for (ExecutorService executor : executors)
-            executor.shutdown();
+            executor.shutdownNow();
         for (ExecutorService executor : executors)
             executor.awaitTermination(60, TimeUnit.SECONDS);
     }
diff --git a/src/java/org/apache/cassandra/io/sstable/format/SSTableReader.java b/src/java/org/apache/cassandra/io/sstable/format/SSTableReader.java
index 6666885519..81af9f00d0 100644
--- a/src/java/org/apache/cassandra/io/sstable/format/SSTableReader.java
+++ b/src/java/org/apache/cassandra/io/sstable/format/SSTableReader.java
@@ -2325,4 +2325,11 @@ public abstract class SSTableReader extends SSTable implements SelfRefCounted<SS
                                            OpenReason openReason);
 
     }
+
+    public static void shutdownBlocking() throws InterruptedException
+    {
+        syncExecutor.shutdownNow();
+        syncExecutor.awaitTermination(0, TimeUnit.SECONDS);
+        resetTidying();
+    }
 }
diff --git a/src/java/org/apache/cassandra/net/MessagingService.java b/src/java/org/apache/cassandra/net/MessagingService.java
index 85cd51c7a9..e7ce964d5f 100644
--- a/src/java/org/apache/cassandra/net/MessagingService.java
+++ b/src/java/org/apache/cassandra/net/MessagingService.java
@@ -764,6 +764,7 @@ public final class MessagingService implements MessagingServiceMBean
         // attempt to humor tests that try to stop and restart MS
         try
         {
+            clearMessageSinks();
             for (SocketThread th : socketThreads)
                 try
                 {
diff --git a/src/java/org/apache/cassandra/service/StorageService.java b/src/java/org/apache/cassandra/service/StorageService.java
index 3f87f708b2..c5c1ca6054 100644
--- a/src/java/org/apache/cassandra/service/StorageService.java
+++ b/src/java/org/apache/cassandra/service/StorageService.java
@@ -1365,6 +1365,11 @@ public class StorageService extends NotificationBroadcasterSupport implements IE
         return bgMonitor.getSeverity(endpoint);
     }
 
+    public void shutdownBGMonitor()
+    {
+        bgMonitor.shutdown();
+    }
+
     /**
      * for a keyspace, return the ranges and corresponding listen addresses.
      * @param keyspace
diff --git a/src/java/org/apache/cassandra/utils/BackgroundActivityMonitor.java b/src/java/org/apache/cassandra/utils/BackgroundActivityMonitor.java
index 1799d10e9f..ab81c200d5 100644
--- a/src/java/org/apache/cassandra/utils/BackgroundActivityMonitor.java
+++ b/src/java/org/apache/cassandra/utils/BackgroundActivityMonitor.java
@@ -143,6 +143,18 @@ public class BackgroundActivityMonitor
         return 0.0;
     }
 
+    public void shutdown()
+    {
+        reportThread.shutdown();
+        try
+        {
+            reportThread.awaitTermination(1L, TimeUnit.MINUTES);
+        } catch (InterruptedException e)
+        {
+            throw new IllegalStateException();
+        }
+    }
+
     public class BackgroundActivityReporter implements Runnable
     {
         public void run()
diff --git a/src/java/org/apache/cassandra/utils/memory/MemtablePool.java b/src/java/org/apache/cassandra/utils/memory/MemtablePool.java
index a096ec3a55..76631034f3 100644
--- a/src/java/org/apache/cassandra/utils/memory/MemtablePool.java
+++ b/src/java/org/apache/cassandra/utils/memory/MemtablePool.java
@@ -21,6 +21,8 @@ package org.apache.cassandra.utils.memory;
 import java.util.concurrent.TimeUnit;
 import java.util.concurrent.atomic.AtomicLongFieldUpdater;
 
+import com.google.common.annotations.VisibleForTesting;
+
 import org.apache.cassandra.utils.concurrent.WaitQueue;
 
 
@@ -58,6 +60,8 @@ public abstract class MemtablePool
     }
 
     public abstract boolean needToCopyOnHeap();
+    
+    @VisibleForTesting
     public void shutdown() throws InterruptedException
     {
         cleaner.shutdown();
diff --git a/test/distributed/org/apache/cassandra/distributed/DistributedReadWritePathTest.java b/test/distributed/org/apache/cassandra/distributed/DistributedReadWritePathTest.java
index ad0cacc58e..6184bf45df 100644
--- a/test/distributed/org/apache/cassandra/distributed/DistributedReadWritePathTest.java
+++ b/test/distributed/org/apache/cassandra/distributed/DistributedReadWritePathTest.java
@@ -25,6 +25,7 @@ import org.apache.cassandra.db.ConsistencyLevel;
 
 public class DistributedReadWritePathTest extends DistributedTestBase
 {
+
     @Test
     public void coordinatorRead() throws Throwable
     {
diff --git a/test/distributed/org/apache/cassandra/distributed/Instance.java b/test/distributed/org/apache/cassandra/distributed/Instance.java
index cd5a002529..37be73c7b3 100644
--- a/test/distributed/org/apache/cassandra/distributed/Instance.java
+++ b/test/distributed/org/apache/cassandra/distributed/Instance.java
@@ -33,6 +33,9 @@ import java.util.UUID;
 import java.util.function.BiConsumer;
 import java.util.function.Function;
 
+import org.slf4j.LoggerFactory;
+
+import ch.qos.logback.classic.LoggerContext;
 import org.apache.cassandra.concurrent.ScheduledExecutors;
 import org.apache.cassandra.concurrent.SharedExecutorPool;
 import org.apache.cassandra.concurrent.StageManager;
@@ -55,6 +58,7 @@ import org.apache.cassandra.dht.Token;
 import org.apache.cassandra.gms.ApplicationState;
 import org.apache.cassandra.gms.Gossiper;
 import org.apache.cassandra.gms.VersionedValue;
+import org.apache.cassandra.io.sstable.format.SSTableReader;
 import org.apache.cassandra.io.util.DataOutputBuffer;
 import org.apache.cassandra.locator.InetAddressAndPort;
 import org.apache.cassandra.locator.SimpleSeedProvider;
@@ -338,12 +342,17 @@ public class Instance extends InvokableInstance
                     ColumnFamilyStore::shutdownPostFlushExecutor,
                     ColumnFamilyStore::shutdownReclaimExecutor,
                     PendingRangeCalculatorService.instance::shutdownExecutor,
+                    StorageService.instance::shutdownBGMonitor,
                     Ref::shutdownReferenceReaper,
                     Memtable.MEMORY_POOL::shutdown,
                     StageManager::shutdownAndWait,
                     MessagingService.instance()::shutdown,
                     SharedExecutorPool.SHARED::shutdown,
-                    ScheduledExecutors::shutdownAndWait);
+                    ScheduledExecutors::shutdownAndWait,
+                    SSTableReader::shutdownBlocking);
+
+            LoggerContext loggerContext = (LoggerContext) LoggerFactory.getILoggerFactory();
+            loggerContext.stop();
             Throwables.maybeFail(error);
         });
     }
diff --git a/test/distributed/org/apache/cassandra/distributed/TestCluster.java b/test/distributed/org/apache/cassandra/distributed/TestCluster.java
index 20a4ab259a..82b775aa3a 100644
--- a/test/distributed/org/apache/cassandra/distributed/TestCluster.java
+++ b/test/distributed/org/apache/cassandra/distributed/TestCluster.java
@@ -31,18 +31,24 @@ import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
 import java.util.Set;
+import java.util.concurrent.ExecutionException;
 import java.util.concurrent.ExecutorService;
 import java.util.concurrent.Executors;
 import java.util.concurrent.Future;
 import java.util.concurrent.TimeUnit;
 import java.util.concurrent.locks.LockSupport;
+import java.util.concurrent.TimeoutException;
 import java.util.function.IntFunction;
 import java.util.stream.Collectors;
 import java.util.stream.Stream;
 
 import com.google.common.collect.Sets;
 
+import io.netty.util.concurrent.FastThreadLocal;
+import io.netty.util.concurrent.FastThreadLocalThread;
+import io.netty.util.internal.InternalThreadLocalMap;
 import org.apache.cassandra.concurrent.NamedThreadFactory;
+
 import org.apache.cassandra.db.ColumnFamilyStore;
 import org.apache.cassandra.db.ConsistencyLevel;
 import org.apache.cassandra.db.Keyspace;
@@ -50,6 +56,7 @@ import org.apache.cassandra.io.util.FileUtils;
 import org.apache.cassandra.locator.InetAddressAndPort;
 import org.apache.cassandra.net.MessagingService;
 import org.apache.cassandra.utils.FBUtilities;
+import org.apache.cassandra.utils.Throwables;
 
 /**
  * TestCluster creates, initializes and manages Cassandra instances ({@link Instance}.
@@ -77,7 +84,7 @@ import org.apache.cassandra.utils.FBUtilities;
  */
 public class TestCluster implements AutoCloseable
 {
-    private static ExecutorService exec = Executors.newCachedThreadPool(new NamedThreadFactory("cluster-async-tasks"));
+    private final ExecutorService exec = Executors.newCachedThreadPool(new NamedThreadFactory("cluster-async-tasks"));
 
     private final File root;
     private final List<Instance> instances;
@@ -240,19 +247,38 @@ public class TestCluster implements AutoCloseable
     }
 
     @Override
-    public void close()
+    public void close() throws InterruptedException, TimeoutException, ExecutionException
     {
         List<Future<?>> futures = instances.stream()
                 .map(i -> exec.submit(i::shutdown))
                 .collect(Collectors.toList());
 
-//        withThreadLeakCheck(futures);
-
         // Make sure to only delete directory when threads are stopped
-        exec.submit(() -> {
+        Future combined = exec.submit(() -> {
             FBUtilities.waitOnFutures(futures);
             FileUtils.deleteRecursive(root);
         });
+
+        combined.get(60, TimeUnit.SECONDS);
+
+        exec.shutdownNow();
+        exec.awaitTermination(10, TimeUnit.SECONDS);
+
+//        withThreadLeakCheck(futures);
+        Set<Thread> threadSet = Thread.getAllStackTraces().keySet();
+        for (Thread thread : threadSet)
+        {
+            if (thread instanceof FastThreadLocalThread)
+                ((FastThreadLocalThread)thread).setThreadLocalMap(null);
+        }
+
+        InternalThreadLocalMap.remove();
+        InternalThreadLocalMap.destroy();
+
+        FastThreadLocal.removeAll();
+        FastThreadLocal.destroy();
+
+        System.gc();
     }
 
     // We do not want this check to run every time until we fix problems with tread stops
@@ -273,5 +299,26 @@ public class TestCluster implements AutoCloseable
         }
     }
 
+    public void runAndWait(Instance.ThrowingRunnable runnable)
+    {
+        try
+        {
+            exec.submit(() -> {
+                try
+                {
+                    runnable.run();
+                }
+                catch (Throwable throwable)
+                {
+                    Throwables.maybeFail(throwable);
+                }
+            }).get();
+        }
+        catch (Exception e)
+        {
+            Throwables.maybeFail(e.getCause());
+        }
+    }
+
 }
 
