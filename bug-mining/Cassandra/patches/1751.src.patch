diff --git a/CHANGES.txt b/CHANGES.txt
index e8f277f099..d3eafe496c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -1,4 +1,5 @@
 1.1.5
+ * avoid recursion in leveled compaction (CASSANDRA-4587)
  * increase stack size under Java7 to 180K
  * Log(info) schema changes (CASSANDRA-4547)
  * Change nodetool setcachecapcity to manipulate global caches (CASSANDRA-4563)
diff --git a/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java b/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java
index 7fb58be752..d14545c351 100644
--- a/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java
+++ b/src/java/org/apache/cassandra/db/compaction/LeveledCompactionStrategy.java
@@ -214,7 +214,8 @@ public class LeveledCompactionStrategy extends AbstractCompactionStrategy implem
             this.range = range;
             this.sstables = new ArrayList<SSTableReader>(sstables);
             Collections.sort(this.sstables, SSTable.sstableComparator);
-            this.sstableIterator = this.sstables.iterator();
+            sstableIterator = this.sstables.iterator();
+            currentScanner = sstableIterator.next().getDirectScanner(range);
 
             long length = 0;
             for (SSTableReader sstable : sstables)
@@ -226,26 +227,17 @@ public class LeveledCompactionStrategy extends AbstractCompactionStrategy implem
         {
             try
             {
-                if (currentScanner != null)
+                while (true)
                 {
                     if (currentScanner.hasNext())
-                    {
                         return currentScanner.next();
-                    }
-                    else
-                    {
-                        positionOffset += currentScanner.getLengthInBytes();
-                        currentScanner.close();
-                        currentScanner = null;
-                        return computeNext();
-                    }
-                }
-
-                if (!sstableIterator.hasNext())
-                    return endOfData();
 
-                currentScanner = sstableIterator.next().getDirectScanner(range);
-                return computeNext();
+                    positionOffset += currentScanner.getLengthInBytes();
+                    currentScanner.close();
+                    if (!sstableIterator.hasNext())
+                        return endOfData();
+                    currentScanner = sstableIterator.next().getDirectScanner(range);
+                }
             }
             catch (IOException e)
             {
