diff --git a/CHANGES.txt b/CHANGES.txt
index 08d1bb10d5..87c9b59b19 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -3,6 +3,7 @@
  * fix possibility of partition when many nodes restart at once
    in clusters with multiple seeds (CASSANDRA-150)
  * fix NPE in get_range_slice when no data is found (CASSANDRA-578)
+ * fix potential NPE in hinted handoff (CASSANDRA-585)
 
 
 0.5.0 beta
diff --git a/src/java/org/apache/cassandra/db/HintedHandOffManager.java b/src/java/org/apache/cassandra/db/HintedHandOffManager.java
index 43fb958992..55c0d62060 100644
--- a/src/java/org/apache/cassandra/db/HintedHandOffManager.java
+++ b/src/java/org/apache/cassandra/db/HintedHandOffManager.java
@@ -112,7 +112,9 @@ public class HintedHandOffManager
         RowMutation rm = new RowMutation(tableName, key);
         for (ColumnFamilyStore cfstore : table.getColumnFamilyStores().values())
         {
-            rm.add(cfstore.getColumnFamily(new IdentityQueryFilter(key, new QueryPath(cfstore.getColumnFamilyName()))));
+            ColumnFamily cf = cfstore.getColumnFamily(new IdentityQueryFilter(key, new QueryPath(cfstore.getColumnFamilyName())));
+            if (cf != null)
+                rm.add(cf);
         }
         Message message = rm.makeRowMutationMessage();
         WriteResponseHandler responseHandler = new WriteResponseHandler(1);
diff --git a/src/java/org/apache/cassandra/db/RowMutation.java b/src/java/org/apache/cassandra/db/RowMutation.java
index 7724bf1c75..76d692e4be 100644
--- a/src/java/org/apache/cassandra/db/RowMutation.java
+++ b/src/java/org/apache/cassandra/db/RowMutation.java
@@ -116,6 +116,7 @@ public class RowMutation implements Serializable
     */
     public void add(ColumnFamily columnFamily)
     {
+        assert columnFamily != null;
         if (modifications_.containsKey(columnFamily.name()))
         {
             throw new IllegalArgumentException("ColumnFamily " + columnFamily.name() + " is already being modified");
