{"url":"https://api.github.com/repos/google/gwtmockito/issues/4","repository_url":"https://api.github.com/repos/google/gwtmockito","labels_url":"https://api.github.com/repos/google/gwtmockito/issues/4/labels{/name}","comments_url":"https://api.github.com/repos/google/gwtmockito/issues/4/comments","events_url":"https://api.github.com/repos/google/gwtmockito/issues/4/events","html_url":"https://github.com/google/gwtmockito/issues/4","id":14891420,"node_id":"MDU6SXNzdWUxNDg5MTQyMA==","number":4,"title":"\"java.lang.ClassCastException: com.google.gwt.core.client.JavaScriptObject$$EnhancerByMockitoWithCGLIB$$29edae7f cannot be cast to com.google.gwt.user.client.Element\" while trying to test a widget extending SimpleLayoutPanel","user":{"login":"konradstrack","id":363290,"node_id":"MDQ6VXNlcjM2MzI5MA==","avatar_url":"https://avatars.githubusercontent.com/u/363290?v=4","gravatar_id":"","url":"https://api.github.com/users/konradstrack","html_url":"https://github.com/konradstrack","followers_url":"https://api.github.com/users/konradstrack/followers","following_url":"https://api.github.com/users/konradstrack/following{/other_user}","gists_url":"https://api.github.com/users/konradstrack/gists{/gist_id}","starred_url":"https://api.github.com/users/konradstrack/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/konradstrack/subscriptions","organizations_url":"https://api.github.com/users/konradstrack/orgs","repos_url":"https://api.github.com/users/konradstrack/repos","events_url":"https://api.github.com/users/konradstrack/events{/privacy}","received_events_url":"https://api.github.com/users/konradstrack/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":27,"created_at":"2013-05-29T14:06:36Z","updated_at":"2016-12-12T15:35:45Z","closed_at":null,"author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Let's take the following example:\n\n``` java\npublic class MyPanel extends SimpleLayoutPanel {\n\n    private Label label;\n\n    public MyPanel() {\n        label = GWT.create(Label.class);\n        label.setText(\"It's my panel\");\n\n        add(label);\n    }\n\n}\n```\n\nAnd a test case:\n\n``` java\n@RunWith(GwtMockitoTestRunner.class)\npublic class MyPanelTests {\n\n    private MyPanel myPanel;\n\n    @Before\n    public void setUp() {\n        myPanel = new MyPanel();\n    }\n\n    @Test\n    public void testTruth() {\n        assertTrue(true);\n    }\n}\n```\n\nRunning this test case will result in the following exception:\n\n```\njava.lang.ClassCastException: com.google.gwt.core.client.JavaScriptObject$$EnhancerByMockitoWithCGLIB$$bd5b9f31 cannot be cast to com.google.gwt.user.client.Element\n    at com.google.gwt.user.client.DOM.createDiv(DOM.java:149)\n    at com.google.gwt.user.client.ui.SimplePanel.<init>(SimplePanel.java:35)\n    at com.google.gwt.user.client.ui.SimpleLayoutPanel.<init>(SimpleLayoutPanel.java:31)\n    at cern.ais.plugin.gwt.client.layout.view.MyPanel.<init>(MyPanel.java:11)\n    at cern.ais.plugin.gwt.client.layout.view.MyPanelTests.setUp(MyPanelTests.java:17)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)\n    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n    at com.google.gwtmockito.GwtMockitoTestRunner.run(GwtMockitoTestRunner.java:102)\n    at org.junit.runners.Suite.runChild(Suite.java:128)\n    at org.junit.runners.Suite.runChild(Suite.java:24)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n    at org.junit.runner.JUnitCore.run(JUnitCore.java:157)\n    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:77)\n    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:195)\n    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:63)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)\n```\n\nIf MyPanel extends Composite, everything works fine, but with SimpleLayoutPanel (or just SimplePanel) the result is the same as the one above.\n\nIs this a known limitation?\n\nIn many cases widgets can be refactored to extend Composite, but is there a way of testing with gwtmockito those that have to extend something else than Composite, or is using GWTTestCase required in such cases?\n","closed_by":{"login":"konradstrack","id":363290,"node_id":"MDQ6VXNlcjM2MzI5MA==","avatar_url":"https://avatars.githubusercontent.com/u/363290?v=4","gravatar_id":"","url":"https://api.github.com/users/konradstrack","html_url":"https://github.com/konradstrack","followers_url":"https://api.github.com/users/konradstrack/followers","following_url":"https://api.github.com/users/konradstrack/following{/other_user}","gists_url":"https://api.github.com/users/konradstrack/gists{/gist_id}","starred_url":"https://api.github.com/users/konradstrack/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/konradstrack/subscriptions","organizations_url":"https://api.github.com/users/konradstrack/orgs","repos_url":"https://api.github.com/users/konradstrack/repos","events_url":"https://api.github.com/users/konradstrack/events{/privacy}","received_events_url":"https://api.github.com/users/konradstrack/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/google/gwtmockito/issues/4/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/google/gwtmockito/issues/4/timeline","performed_via_github_app":null,"state_reason":null}