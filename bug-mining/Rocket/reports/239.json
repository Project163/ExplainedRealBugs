{"url":"https://api.github.com/repos/rwf2/Rocket/issues/2533","repository_url":"https://api.github.com/repos/rwf2/Rocket","labels_url":"https://api.github.com/repos/rwf2/Rocket/issues/2533/labels{/name}","comments_url":"https://api.github.com/repos/rwf2/Rocket/issues/2533/comments","events_url":"https://api.github.com/repos/rwf2/Rocket/issues/2533/events","html_url":"https://github.com/rwf2/Rocket/issues/2533","id":1692939905,"node_id":"I_kwDOAzqMt85k6DaB","number":2533,"title":"Mounting \"/\" routes to a sub-path removes trailing slash from route","user":{"login":"stefan0xC","id":509385,"node_id":"MDQ6VXNlcjUwOTM4NQ==","avatar_url":"https://avatars.githubusercontent.com/u/509385?v=4","gravatar_id":"","url":"https://api.github.com/users/stefan0xC","html_url":"https://github.com/stefan0xC","followers_url":"https://api.github.com/users/stefan0xC/followers","following_url":"https://api.github.com/users/stefan0xC/following{/other_user}","gists_url":"https://api.github.com/users/stefan0xC/gists{/gist_id}","starred_url":"https://api.github.com/users/stefan0xC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefan0xC/subscriptions","organizations_url":"https://api.github.com/users/stefan0xC/orgs","repos_url":"https://api.github.com/users/stefan0xC/repos","events_url":"https://api.github.com/users/stefan0xC/events{/privacy}","received_events_url":"https://api.github.com/users/stefan0xC/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":758541123,"node_id":"MDU6TGFiZWw3NTg1NDExMjM=","url":"https://api.github.com/repos/rwf2/Rocket/labels/deficiency","name":"deficiency","color":"D93F0B","default":false,"description":"Something doesn't work as well as it could"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2023-05-02T18:56:56Z","updated_at":"2023-05-04T03:13:07Z","closed_at":"2023-05-04T03:13:07Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Description**\r\n\r\nMounting a `#[get(\"/\")]` route to a sub-path removes the trailing slash, which leads to unexpected behavior.\r\n\r\n**To Reproduce**\r\n\r\nCreate a `src/main.rs` : \r\n```rust\r\n#[macro_use] extern crate rocket;\r\n\r\n#[get(\"/\")]\r\nfn index() -> &'static str { \r\n    \"Hello, world!\"\r\n}\r\n\r\n#[launch]\r\nfn rocket() -> _ {\r\n    rocket::build().mount(\"/test/\", routes![index])\r\n}\r\n```\r\n\r\nand `Cargo.toml`\r\n\r\n```toml\r\n[package]\r\nname = \"rocket-example\"\r\nversion = \"0.1.0\"\r\nedition = \"2021\"\r\n\r\n[dependencies]\r\nrocket = { git = 'https://github.com/SergioBenitez/Rocket', rev = '9b0564ed27f90686b333337d9f6ed76484a84b27' }\r\n```\r\n\r\nRun `cargo run` and check difference of calling `curl http://127.0.0.1:8000/test` (which works) and `curl http://127.0.0.1:8000/test/` (404).\r\n\r\n```\r\n   Finished dev [unoptimized + debuginfo] target(s) in 0.06s\r\n     Running `target/debug/rocket-example`\r\nðŸ”§ Configured for debug.\r\n   >> address: 127.0.0.1\r\n   >> port: 8000\r\n   >> workers: 12\r\n   >> max blocking threads: 512\r\n   >> ident: Rocket\r\n   >> IP header: X-Real-IP\r\n   >> limits: bytes = 8KiB, data-form = 2MiB, file = 1MiB, form = 32KiB, json = 1MiB, msgpack = 1MiB, string = 8KiB\r\n   >> temp dir: /tmp\r\n   >> http/2: true\r\n   >> keep-alive: 5s\r\n   >> tls: disabled\r\n   >> shutdown: ctrlc = true, force = true, signals = [SIGTERM], grace = 2s, mercy = 3s\r\n   >> log level: normal\r\n   >> cli colors: true\r\nðŸ“¬ Routes:\r\n   >> (index) GET /test/\r\nðŸ“¡ Fairings:\r\n   >> Shield (liftoff, response, singleton)\r\nðŸ›¡ï¸ Shield:\r\n   >> X-Frame-Options: SAMEORIGIN\r\n   >> Permissions-Policy: interest-cohort=()\r\n   >> X-Content-Type-Options: nosniff\r\nðŸš€ Rocket has launched from http://127.0.0.1:8000\r\nGET /test/:\r\n   >> No matching routes for GET /test/.\r\n   >> No 404 catcher registered. Using Rocket default.\r\n   >> Response succeeded.\r\nGET /test:\r\n   >> Matched: (index) GET /test/\r\n   >> Outcome: Success\r\n   >> Response succeeded.\r\n```\r\n\r\n**Expected Behavior**\r\n\r\nAfter 51ed332127df2737a7d1c1a22a1e13379ea5f6d5 I expected the resource to be available only under the route `/test/` (which is also what the logs say where the route lives) but it appears the loaded route is `/test`.\r\n\r\n**Environment:**\r\n\r\n - OS Distribution and Kernel: Arch Linux 6.2.12-arch1-1\r\n - Rocket Version: master@9b0564ed27f90686b333337d9f6ed76484a84b27\r\n\r\n**Additional Context**\r\n\r\nWe ran into this issue in [vaultwarden](https://github.com/dani-garcia/vaultwarden) after we updated our Rocket dependency to 9b0564ed27f90686b333337d9f6ed76484a84b27  - \r\nDue to our custom logging the reported routes https://github.com/dani-garcia/vaultwarden/discussions/3495#discussioncomment-5783685  are the actual loaded routes.","closed_by":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/2533/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rwf2/Rocket/issues/2533/timeline","performed_via_github_app":null,"state_reason":"completed"}