[{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/822656237","html_url":"https://github.com/rwf2/Rocket/issues/1610#issuecomment-822656237","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/1610","id":822656237,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMjY1NjIzNw==","user":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-19T17:48:02Z","updated_at":"2021-04-19T17:48:02Z","body":"The problem is a race condition somewhere in this code:\r\n\r\n```rust\r\nimpl<K, C: Poolable> Drop for Connection<K, C> {\r\n    fn drop(&mut self) {\r\n        let connection = self.connection.clone();\r\n        let permit = self.permit.take();\r\n\r\n        // must spawn a task here...\r\n        tokio::spawn(async move {\r\n            // ...in order to wait for exclusive access to the connection (i.e. pending run() calls complete)\r\n            // AWAIT POINT\r\n            let mut connection = connection.lock_owned().await;\r\n\r\n            // dropping the connection might communicate with the database (blocking I/O), so it has to be done in a `spawn_blocking` call\r\n            tokio::task::spawn_blocking(move || {\r\n                if let Some(conn) = connection.take() {\r\n                    drop(conn);\r\n                }\r\n\r\n                // Explicitly dropping the permit here so that it's only\r\n                // released after the connection is.\r\n                drop(permit);\r\n            })\r\n        });\r\n    }\r\n}\r\n```\r\n\r\nWhat seems to be happening is that \"AWAIT POINT\" is reached, and then the test ends and the runtime is shut down before moving the `connection` to a blocking thread. Increasing the number of pending `run()` calls (e.g. with the `join!`) at the time of shutdown makes the problem more likely by increasing the contention at that particular `.await` point.\r\n\r\nI will take a stab at accomplishing this in a way that is less likely to cause issues; a few APIs were recently exposed in `tokio` that I believe can make this easier to do correctly.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/822656237/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4614171089,"node_id":"MDEyOkxhYmVsZWRFdmVudDQ2MTQxNzEwODk=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4614171089","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2021-04-19T17:48:10Z","label":{"name":"bug","color":"fc2929"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/822700722","html_url":"https://github.com/rwf2/Rocket/issues/1610#issuecomment-822700722","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/1610","id":822700722,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMjcwMDcyMg==","user":{"login":"kittyandrew","id":45767571,"node_id":"MDQ6VXNlcjQ1NzY3NTcx","avatar_url":"https://avatars.githubusercontent.com/u/45767571?v=4","gravatar_id":"","url":"https://api.github.com/users/kittyandrew","html_url":"https://github.com/kittyandrew","followers_url":"https://api.github.com/users/kittyandrew/followers","following_url":"https://api.github.com/users/kittyandrew/following{/other_user}","gists_url":"https://api.github.com/users/kittyandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/kittyandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kittyandrew/subscriptions","organizations_url":"https://api.github.com/users/kittyandrew/orgs","repos_url":"https://api.github.com/users/kittyandrew/repos","events_url":"https://api.github.com/users/kittyandrew/events{/privacy}","received_events_url":"https://api.github.com/users/kittyandrew/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-19T18:56:57Z","updated_at":"2021-04-19T20:11:44Z","body":"Thanks for the quick response!\r\nIndeed, likelihood of catching this error rises not only with the increased usage of `join!`, but also with amount of tests themselves, which is quite annoying.\r\nLooking forward for your solution.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/822700722/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kittyandrew","id":45767571,"node_id":"MDQ6VXNlcjQ1NzY3NTcx","avatar_url":"https://avatars.githubusercontent.com/u/45767571?v=4","gravatar_id":"","url":"https://api.github.com/users/kittyandrew","html_url":"https://github.com/kittyandrew","followers_url":"https://api.github.com/users/kittyandrew/followers","following_url":"https://api.github.com/users/kittyandrew/following{/other_user}","gists_url":"https://api.github.com/users/kittyandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/kittyandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kittyandrew/subscriptions","organizations_url":"https://api.github.com/users/kittyandrew/orgs","repos_url":"https://api.github.com/users/kittyandrew/repos","events_url":"https://api.github.com/users/kittyandrew/events{/privacy}","received_events_url":"https://api.github.com/users/kittyandrew/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4627033268,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ2MjcwMzMyNjg=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4627033268","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a2806b25cd9dd17cde540c84461e018f1f9b7945","commit_url":"https://api.github.com/repos/jebrosen/Rocket/commits/a2806b25cd9dd17cde540c84461e018f1f9b7945","created_at":"2021-04-21T20:04:12Z","performed_via_github_app":null},{"id":4627438255,"node_id":"MDExOkNsb3NlZEV2ZW50NDYyNzQzODI1NQ==","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4627438255","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"e1307ddf48dac14e6a37e526098732327bcb86f0","commit_url":"https://api.github.com/repos/rwf2/Rocket/commits/e1307ddf48dac14e6a37e526098732327bcb86f0","created_at":"2021-04-21T21:52:40Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/824428623","html_url":"https://github.com/rwf2/Rocket/issues/1610#issuecomment-824428623","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/1610","id":824428623,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNDQyODYyMw==","user":{"login":"kittyandrew","id":45767571,"node_id":"MDQ6VXNlcjQ1NzY3NTcx","avatar_url":"https://avatars.githubusercontent.com/u/45767571?v=4","gravatar_id":"","url":"https://api.github.com/users/kittyandrew","html_url":"https://github.com/kittyandrew","followers_url":"https://api.github.com/users/kittyandrew/followers","following_url":"https://api.github.com/users/kittyandrew/following{/other_user}","gists_url":"https://api.github.com/users/kittyandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/kittyandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kittyandrew/subscriptions","organizations_url":"https://api.github.com/users/kittyandrew/orgs","repos_url":"https://api.github.com/users/kittyandrew/repos","events_url":"https://api.github.com/users/kittyandrew/events{/privacy}","received_events_url":"https://api.github.com/users/kittyandrew/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-21T23:25:08Z","updated_at":"2021-04-21T23:25:08Z","body":"@jebrosen issue is indeed fixed for the repro case, but everything hangs when the amount of tests is more than three. It stays hanged for ~25 seconds and then fails with the same error. I'm not sure whether it's similar issue thing, or some different bug.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/824428623/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kittyandrew","id":45767571,"node_id":"MDQ6VXNlcjQ1NzY3NTcx","avatar_url":"https://avatars.githubusercontent.com/u/45767571?v=4","gravatar_id":"","url":"https://api.github.com/users/kittyandrew","html_url":"https://github.com/kittyandrew","followers_url":"https://api.github.com/users/kittyandrew/followers","following_url":"https://api.github.com/users/kittyandrew/following{/other_user}","gists_url":"https://api.github.com/users/kittyandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/kittyandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kittyandrew/subscriptions","organizations_url":"https://api.github.com/users/kittyandrew/orgs","repos_url":"https://api.github.com/users/kittyandrew/repos","events_url":"https://api.github.com/users/kittyandrew/events{/privacy}","received_events_url":"https://api.github.com/users/kittyandrew/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4627719975,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDYyNzcxOTk3NQ==","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4627719975","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-21T23:25:09Z","performed_via_github_app":null},{"id":4627719979,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ2Mjc3MTk5Nzk=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4627719979","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-21T23:25:09Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/824441907","html_url":"https://github.com/rwf2/Rocket/issues/1610#issuecomment-824441907","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/1610","id":824441907,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNDQ0MTkwNw==","user":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-22T00:04:30Z","updated_at":"2021-04-22T00:04:30Z","body":"> when the amount of tests is more than three\r\n\r\nCan you run with `RUST_BACKTRACE=1 cargo test -- --nocapture` to get a complete backtrace? There may be another missing `spawn_blocking` call in a different location (which would lead to the same message).","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/824441907/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4627825160,"node_id":"MDEzOlJlb3BlbmVkRXZlbnQ0NjI3ODI1MTYw","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4627825160","actor":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"reopened","commit_id":null,"commit_url":null,"created_at":"2021-04-22T00:11:50Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/824446271","html_url":"https://github.com/rwf2/Rocket/issues/1610#issuecomment-824446271","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/1610","id":824446271,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNDQ0NjI3MQ==","user":{"login":"kittyandrew","id":45767571,"node_id":"MDQ6VXNlcjQ1NzY3NTcx","avatar_url":"https://avatars.githubusercontent.com/u/45767571?v=4","gravatar_id":"","url":"https://api.github.com/users/kittyandrew","html_url":"https://github.com/kittyandrew","followers_url":"https://api.github.com/users/kittyandrew/followers","following_url":"https://api.github.com/users/kittyandrew/following{/other_user}","gists_url":"https://api.github.com/users/kittyandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/kittyandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kittyandrew/subscriptions","organizations_url":"https://api.github.com/users/kittyandrew/orgs","repos_url":"https://api.github.com/users/kittyandrew/repos","events_url":"https://api.github.com/users/kittyandrew/events{/privacy}","received_events_url":"https://api.github.com/users/kittyandrew/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-22T00:16:33Z","updated_at":"2021-04-23T14:07:58Z","body":"Sure.\r\n\r\n<details>\r\n\r\n```\r\n$ RUST_BACKTRACE=1 cargo test -- --nocapture\r\n    Finished test [unoptimized + debuginfo] target(s) in 0.12s\r\n     Running unittests (/home/kittyandrew/tmp/rocket-bug-repro/target/debug/deps/rocket_bug_repro-dc4482a295a94d90)\r\n\r\nrunning 4 tests\r\nthread 'test::test_get_entries_3' panicked at 'Cannot start a runtime from within a runtime. This happens because a function (like `block_on`) attempted to block the current thread while the thread is being used to drive asynchronous tasks.', /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:39:9\r\nError: database pool init error for pool named `storage`\r\nstack backtrace:\r\n   >> timed out waiting for connection: db error: FATAL: sorry, too many clients already\r\nthread 'test::test_get_entries_2' panicked at 'called `Result::unwrap()` on an `Err` value: FailedFairings([Info { name: \"'storage' Database Pool\", kind: Kind(1) }])', src/main.rs:54:54\r\nthread 'test::test_get_entries' panicked at 'Cannot start a runtime from within a runtime. This happens because a function (like `block_on`) attempted to block the current thread while the thread is being used to drive asynchronous tasks.', /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:39:9\r\nthread 'test::test_get_entries_4' panicked at 'Cannot start a runtime from within a runtime. This happens because a function (like `block_on`) attempted to block the current thread while the thread is being used to drive asynchronous tasks.', /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:39:9\r\n   0: std::panicking::begin_panic\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/panicking.rs:519:12\r\n   1: tokio::runtime::enter::enter\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:39:9\r\n   2: tokio::runtime::basic_scheduler::Inner<P>::block_on::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:203:26\r\n   3: tokio::runtime::basic_scheduler::enter::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:323:29\r\n   4: tokio::macros::scoped_tls::ScopedKey<T>::set\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/macros/scoped_tls.rs:61:9\r\n   5: tokio::runtime::basic_scheduler::enter\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:323:5\r\n   6: tokio::runtime::basic_scheduler::Inner<P>::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:202:9\r\n   7: tokio::runtime::basic_scheduler::InnerGuard<P>::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:481:9\r\n   8: tokio::runtime::basic_scheduler::BasicScheduler<P>::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:162:24\r\n   9: tokio::runtime::Runtime::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/mod.rs:450:46\r\n  10: postgres::connection::Connection::poll_block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/connection.rs:67:9\r\n  11: postgres::client::Client::close_inner\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/client.rs:571:9\r\n  12: <postgres::client::Client as core::ops::drop::Drop>::drop\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/client.rs:20:17\r\n  13: core::ptr::drop_in_place<postgres::client::Client>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  14: core::ptr::drop_in_place<r2d2::Conn<postgres::client::Client>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  15: core::ptr::drop_in_place<r2d2::IdleConn<postgres::client::Client>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  16: core::ptr::drop_in_place<[r2d2::IdleConn<postgres::client::Client>]>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  17: <alloc::vec::Vec<T,A> as core::ops::drop::Drop>::drop\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/vec/mod.rs:2669:13\r\n  18: core::ptr::drop_in_place<alloc::vec::Vec<r2d2::IdleConn<postgres::client::Client>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  19: core::ptr::drop_in_place<r2d2::PoolInternals<postgres::client::Client>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  20: core::ptr::drop_in_place<core::cell::UnsafeCell<r2d2::PoolInternals<postgres::client::Client>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  21: core::ptr::drop_in_place<lock_api::mutex::Mutex<parking_lot::raw_mutex::RawMutex,r2d2::PoolInternals<postgres::client::Client>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  22: core::ptr::drop_in_place<r2d2::SharedPool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  23: alloc::sync::Arc<T>::drop_slow\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/sync.rs:1039:18\r\n  24: <alloc::sync::Arc<T> as core::ops::drop::Drop>::drop\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/sync.rs:1571:13\r\n  25: core::ptr::drop_in_place<alloc::sync::Arc<r2d2::SharedPool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  26: core::ptr::drop_in_place<r2d2::Pool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  27: r2d2::config::Builder<M>::build\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/r2d2-0.8.9/src/config.rs:230:5\r\n  28: <postgres::client::Client as rocket_contrib::databases::poolable::Poolable>::pool\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/contrib/lib/src/databases/poolable.rs:178:12\r\n  29: rocket_contrib::databases::connection::ConnectionPool<K,C>::fairing::{{closure}}::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/contrib/lib/src/databases/connection.rs:80:19\r\n  30: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  31: <core::pin::Pin<P> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/future.rs:120:9\r\n  32: <rocket::fairing::ad_hoc::AdHoc as rocket::fairing::Fairing>::on_ignite::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/fairing/ad_hoc.rs:239:41\r\n  33: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  34: <core::pin::Pin<P> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/future.rs:120:9\r\n  35: rocket::fairing::fairings::Fairings::handle_ignite::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/fairing/fairings.rs:58:32\r\n  36: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  37: rocket::rocket::Rocket<rocket::phase::Build>::ignite::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/rocket.rs:467:16\r\n  38: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  39: rocket::rocket::Rocket<P>::local_launch::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/rocket.rs:792:32\r\n  40: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  41: rocket::local::asynchronous::client::Client::_new::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/local/asynchronous/client.rs:61:22\r\n  42: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  43: rocket::local::asynchronous::client::Client::tracked::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/local/client.rs:71:9\r\n  44: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  45: rocket_bug_repro::test::test_get_entries_3::{{closure}}\r\n             at ./src/main.rs:69:22\r\n  46: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  47: tokio::park::thread::CachedParkThread::block_on::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/park/thread.rs:263:54\r\n  48: tokio::coop::with_budget::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:106:9\r\n  49: std::thread::local::LocalKey<T>::try_with\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:272:16\r\n  50: std::thread::local::LocalKey<T>::with\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:248:9\r\n  51: tokio::coop::with_budget\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:99:5\r\n  52: tokio::coop::budget\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:76:5\r\n  53: tokio::park::thread::CachedParkThread::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/park/thread.rs:263:31\r\n  54: tokio::runtime::enter::Enter::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:151:13\r\n  55: tokio::runtime::thread_pool::ThreadPool::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/thread_pool/mod.rs:71:9\r\n  56: tokio::runtime::Runtime::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/mod.rs:452:43\r\n  57: rocket::async_test\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/lib.rs:186:5\r\n  58: rocket_bug_repro::test::test_get_entries_3\r\n             at ./src/main.rs:68:35\r\n  59: rocket_bug_repro::test::test_get_entries_3::{{closure}}\r\n             at ./src/main.rs:68:11\r\n  60: core::ops::function::FnOnce::call_once\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:227:5\r\n  61: core::ops::function::FnOnce::call_once\r\n             at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/ops/function.rs:227:5\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\nstack backtrace:\r\n   0: rust_begin_unwind\r\n             at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panicking.rs:493:5\r\n   1: core::panicking::panic_fmt\r\n             at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/panicking.rs:92:14\r\n   2: core::result::unwrap_failed\r\n             at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/result.rs:1355:5\r\nthread 'test::test_get_entries_3' panicked at 'Cannot start a runtime from within a runtime. This happens because a function (like `block_on`) attempted to block the current thread while the thread is being used to drive asynchronous tasks.', /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:39:9\r\n   3: core::result::Result<T,E>::unwrap\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/result.rs:1037:23\r\n   4: rocket_bug_repro::test::test_get_entries_2::{{closure}}\r\n             at ./src/main.rs:54:22\r\n   5: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n   6: tokio::park::thread::CachedParkThread::block_on::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/park/thread.rs:263:54\r\n   7: tokio::coop::with_budget::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:106:9\r\n   8: std::thread::local::LocalKey<T>::try_with\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:272:16\r\n   9: std::thread::local::LocalKey<T>::with\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:248:9\r\n  10: tokio::coop::with_budget\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:99:5\r\n  11: tokio::coop::budget\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:76:5\r\n  12: tokio::park::thread::CachedParkThread::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/park/thread.rs:263:31\r\n  13: tokio::runtime::enter::Enter::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:151:13\r\n  14: tokio::runtime::thread_pool::ThreadPool::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/thread_pool/mod.rs:71:9\r\n  15: tokio::runtime::Runtime::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/mod.rs:452:43\r\n  16: rocket::async_test\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/lib.rs:186:5\r\n  17: rocket_bug_repro::test::test_get_entries_2\r\n             at ./src/main.rs:53:35\r\n  18: rocket_bug_repro::test::test_get_entries_2::{{closure}}\r\n             at ./src/main.rs:53:11\r\n  19: core::ops::function::FnOnce::call_once\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:227:5\r\n  20: core::ops::function::FnOnce::call_once\r\n             at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/ops/function.rs:227:5\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\nstack backtrace:\r\n   0: std::panicking::begin_panic\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/panicking.rs:519:12\r\n   1: tokio::runtime::enter::enter\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:39:9\r\n   2: tokio::runtime::basic_scheduler::Inner<P>::block_on::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:203:26\r\n   3: tokio::runtime::basic_scheduler::enter::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:323:29\r\n   4: tokio::macros::scoped_tls::ScopedKey<T>::set\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/macros/scoped_tls.rs:61:9\r\n   5: tokio::runtime::basic_scheduler::enter\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:323:5\r\n   6: tokio::runtime::basic_scheduler::Inner<P>::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:202:9\r\n   7: tokio::runtime::basic_scheduler::InnerGuard<P>::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:481:9\r\n   8: tokio::runtime::basic_scheduler::BasicScheduler<Ptest test::test_get_entries_2 ... >::FAILEDblock_on\r\n\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:162:24\r\n   9: tokio::runtime::Runtime::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/mod.rs:450:46\r\n  10: postgres::connection::Connection::poll_block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/connection.rs:67:9\r\n  11: postgres::client::Client::close_inner\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/client.rs:571:9\r\n  12: <postgres::client::Client as core::ops::drop::Drop>::drop\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/client.rs:20:17\r\n  13: core::ptr::drop_in_place<postgres::client::Client>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  14: core::ptr::drop_in_place<r2d2::Conn<postgres::client::Client>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  15: core::ptr::drop_in_place<r2d2::IdleConn<postgres::client::Client>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  16: core::ptr::drop_in_place<[r2d2::IdleConn<postgres::client::Client>]>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  17: <alloc::vec::Vec<T,A> as core::ops::drop::Drop>::drop\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/vec/mod.rs:2669:13\r\n  18: core::ptr::drop_in_place<alloc::vec::Vec<r2d2::IdleConn<postgres::client::Client>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  19: core::ptr::drop_in_place<r2d2::PoolInternals<postgres::client::Client>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  20: core::ptr::drop_in_place<core::cell::UnsafeCell<r2d2::PoolInternals<postgres::client::Client>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  21: core::ptr::drop_in_place<lock_api::mutex::Mutex<parking_lot::raw_mutex::RawMutex,r2d2::PoolInternals<postgres::client::Client>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  22: core::ptr::drop_in_place<r2d2::SharedPool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  23: alloc::sync::Arc<T>::drop_slow\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/sync.rs:1039:18\r\n  24: <alloc::sync::Arc<T> as core::ops::drop::Drop>::drop\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/sync.rs:1571:13\r\n  25: core::ptr::drop_in_place<alloc::sync::Arc<r2d2::SharedPool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  26: core::ptr::drop_in_place<r2d2::Pool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  27: r2d2::config::Builder<M>::build\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/r2d2-0.8.9/src/config.rs:230:5\r\n  28: <postgres::client::Client as rocket_contrib::databases::poolable::Poolable>::pool\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/contrib/lib/src/databases/poolable.rs:178:12\r\n  29: rocket_contrib::databases::connection::ConnectionPool<K,C>::fairing::{{closure}}::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/contrib/lib/src/databases/connection.rs:80:19\r\n  30: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  31: <core::pin::Pin<P> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/future.rs:120:9\r\n  32: <rocket::fairing::ad_hoc::AdHoc as rocket::fairing::Fairing>::on_ignite::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/fairing/ad_hoc.rs:239:41\r\n  33: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  34: <core::pin::Pin<P> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/future.rs:120:9\r\n  35: rocket::fairing::fairings::Fairings::handle_ignite::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/fairing/fairings.rs:58:32\r\n  36: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  37: rocket::rocket::Rocket<rocket::phase::Build>::ignite::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/rocket.rs:467:16\r\n  38: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  39: rocket::rocket::Rocket<P>::local_launch::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/rocket.rs:792:32\r\n  40: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  41: rocket::local::asynchronous::client::Client::_new::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/local/asynchronous/client.rs:61:22\r\n  42: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  43: rocket::local::asynchronous::client::Client::tracked::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/local/client.rs:71:9\r\n  44: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  45: rocket_bug_repro::test::test_get_entries::{{closure}}\r\n             at ./src/main.rs:39:22\r\n  46: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  47: tokio::park::thread::CachedParkThread::block_on::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/park/thread.rs:263:54\r\n  48: tokio::coop::with_budget::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:106:9\r\n  49: std::thread::local::LocalKey<T>::try_with\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:272:16\r\n  50: std::thread::local::LocalKey<T>::with\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:248:9\r\n  51: tokio::coop::with_budget\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:99:5\r\n  52: tokio::coop::budget\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:76:5\r\n  53: tokio::park::thread::CachedParkThread::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/park/thread.rs:263:31\r\n  54: tokio::runtime::enter::Enter::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:151:13\r\n  55: tokio::runtime::thread_pool::ThreadPool::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/thread_pool/mod.rs:71:9\r\n  56: tokio::runtime::Runtime::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/mod.rs:452:43\r\n  57: rocket::async_test\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/lib.rs:186:5\r\n  58: rocket_bug_repro::test::test_get_entries\r\n             at ./src/main.rs:38:33\r\n  59: rocket_bug_repro::test::test_get_entries::{{closure}}\r\n             at ./src/main.rs:38:11\r\n  60: core::ops::function::FnOnce::call_once\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:227:5\r\n  61: core::ops::function::FnOnce::call_once\r\n             at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/ops/function.rs:227:5\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\nstack backtrace:\r\n   0: std::panicking::begin_panic\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/panicking.rs:519:12\r\n   1: tokio::runtime::enter::enter\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:39:9\r\n   2: tokio::runtime::basic_scheduler::Inner<P>::block_on::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:203:26\r\n   3: tokio::runtime::basic_scheduler::enter::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:323:29\r\n   4: tokio::macros::scoped_tls::ScopedKey<T>::set\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/macros/scoped_tls.rs:61:9\r\n   thread '5test::test_get_entries: ' panicked at 'tokioCannot start a runtime from within a runtime. This happens because a function (like `block_on`) attempted to block the current thread while the thread is being used to drive asynchronous tasks.::', runtime/home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:::basic_scheduler39:::enter9\r\n\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:323:5\r\n   6: tokio::runtime::basic_scheduler::Inner<P>::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:202:9\r\n   7: tokio::runtime::basic_scheduler::InnerGuard<P>::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:481:9\r\n   8: tokio::runtime::basic_scheduler::BasicScheduler<P>::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:162:24\r\n   9: tokio::runtime::Runtime::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/mod.rs:450:46\r\n  10: postgres::connection::Connection::poll_block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/connection.rs:67:9\r\n  11: postgres::client::Client::close_inner\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/client.rs:571:9\r\n  12: <postgres::client::Client as core::ops::drop::Drop>::drop\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/client.rs:20:17\r\n  13: core::ptr::drop_in_place<postgres::client::Client>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  14: core::ptr::drop_in_place<r2d2::Conn<postgres::client::Client>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  15: core::ptr::drop_in_place<r2d2::IdleConn<postgres::client::Client>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  16: core::ptr::drop_in_place<[r2d2::IdleConn<postgres::client::Client>]>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  17: <alloc::vec::Vec<T,A> as core::ops::drop::Drop>::drop\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/vec/mod.rs:2669:13\r\n  18: core::ptr::drop_in_place<alloc::vec::Vec<r2d2::IdleConn<postgres::client::Client>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  19: core::ptr::drop_in_place<r2d2::PoolInternals<postgres::client::Client>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  20: core::ptr::drop_in_place<core::cell::UnsafeCell<r2d2::PoolInternals<postgres::client::Client>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  21: core::ptr::drop_in_place<lock_api::mutex::Mutex<parking_lot::raw_mutex::RawMutex,r2d2::PoolInternals<postgres::client::Client>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  22: core::ptr::drop_in_place<r2d2::SharedPool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  23: alloc::sync::Arc<T>::drop_slow\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/sync.rs:1039:18\r\n  24: <alloc::sync::Arc<T> as core::ops::drop::Drop>::drop\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/sync.rs:1571:13\r\n  25: core::ptr::drop_in_place<alloc::sync::Arc<r2d2::SharedPool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  26: core::ptr::drop_in_place<r2d2::Pool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  27: r2d2::config::Builder<M>::build\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/r2d2-0.8.9/src/config.rs:230:5\r\n  28: <postgres::client::Client as rocket_contrib::databases::poolable::Poolable>::pool\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/contrib/lib/src/databases/poolable.rs:178:12\r\n  29: rocket_contrib::databases::connection::ConnectionPool<K,C>::fairing::{{closure}}::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/contrib/lib/src/databases/connection.rs:80:19\r\n  30: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  31: <core::pin::Pin<P> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/future.rs:120:9\r\n  32: <rocket::fairing::ad_hoc::AdHoc as rocket::fairing::Fairing>::on_ignite::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/fairing/ad_hoc.rs:239:41\r\n  33: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  34: <core::pin::Pin<P> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/future.rs:120:9\r\n  35: rocket::fairing::fairings::Fairings::handle_ignite::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/fairing/fairings.rs:58:32\r\n  36: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  37: rocket::rocket::Rocket<rocket::phase::Build>::ignite::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/rocket.rs:467:16\r\n  38: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  39: rocket::rocket::Rocket<P>::local_launch::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/rocket.rs:792:32\r\n  40: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  41: rocket::local::asynchronous::client::Client::_new::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/local/asynchronous/client.rs:61:22\r\n  42: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  43: rocket::local::asynchronous::client::Client::tracked::{{closure}}\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/local/client.rs:71:9\r\n  44: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  45: rocket_bug_repro::test::test_get_entries_4::{{closure}}\r\n             at ./src/main.rs:84:22\r\n  46: <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  47: tokio::park::thread::CachedParkThread::block_on::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/park/thread.rs:263:54\r\n  48: tokio::coop::with_budget::{{closure}}\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:106:9\r\n  49: std::thread::local::LocalKey<T>::try_with\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:272:16\r\n  50: std::thread::local::LocalKey<T>::with\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:248:9\r\n  51: tokio::coop::with_budget\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:99:5\r\n  52: tokio::coop::budget\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:76:5\r\n  53: tokio::park::thread::CachedParkThread::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/park/thread.rs:263:31\r\n  54: tokio::runtime::enter::Enter::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:151:13\r\n  55: tokio::runtime::thread_pool::ThreadPool::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/thread_pool/mod.rs:71:9\r\n  56: tokio::runtime::Runtime::block_on\r\n             at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/mod.rs:452:43\r\n  57: rocket::async_test\r\n             at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/lib.rs:186:5\r\n  58: rocket_bug_repro::test::test_get_entries_4\r\n             at ./src/main.rs:83:35\r\n  59: rocket_bug_repro::test::test_get_entries_4::{{closure}}\r\n             at ./src/main.rs:83:11\r\n  60: core::ops::function::FnOnce::call_once\r\n             at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:227:5\r\n  61: core::ops::function::FnOnce::call_once\r\n             at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/ops/function.rs:227:5\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\nstack backtrace:\r\n   0:     0x561ccb0c53d0 - std::backtrace_rs::backtrace::libunwind::trace::hdcf4f90f85129e83\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/../../backtrace/src/backtrace/libunwind.rs:90:5\r\n   1:     0x561ccb0c53d0 - std::backtrace_rs::backtrace::trace_unsynchronized::h2669e30cb82f6732\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/../../backtrace/src/backtrace/mod.rs:66:5\r\n   2:     0x561ccb0c53d0 - std::sys_common::backtrace::_print_fmt::hfbda19e17f6db318\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/sys_common/backtrace.rs:67:5\r\n   3:     0x561ccb0c53d0 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h1a8751bf59281272\r\n       thread ' test::test_get_entries_4 ' panicked at ' Cannot start a runtime from within a runtime. This happens because a function (like `block_on`) attempted to block the current thread while the thread is being used to drive asynchronous tasks. ',  /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs : 39 : 9 \r\n              at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/sys_common/backtrace.rs:46:22\r\n   4:     0x561ccb0ea92f - core::fmt::write::h7aa6cd0067dca82a\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/fmt/mod.rs:1094:17\r\n   5:     0x561ccb0bf335 - std::io::Write::write_fmt::hd7dd3a1df9b6befb\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/io/mod.rs:1580:15\r\n   6:     0x561ccb0c761b - std::sys_common::backtrace::_print::h551e9ec8a9fa8106\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/sys_common/backtrace.rs:49:5\r\n   7:     0x561ccb0c761b - std::sys_common::backtrace::print::ha4b1c5e95fa040b3\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/sys_common/backtrace.rs:36:9\r\n   8:     0x561ccb0c761b - std::panicking::default_hook::{{closure}}::h0b34c9ab7fb9f857\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panicking.rs:208:50\r\n   9:     0x561ccb0c70fd - std::panicking::default_hook::h3067e8318decd17a\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panicking.rs:225:9\r\n  10:     0x561ccb0c7bcd - std::panicking::rust_panic_with_hook::h81b8facc50f34daa\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panicking.rs:591:17\r\n  11:     0x561ccb097fd3 - std::panicking::begin_panic::{{closure}}::h99226beae825c61f\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/panicking.rs:520:9\r\n  12:     0x561ccb09a579 - std::sys_common::backtrace::__rust_end_short_backtrace::hc49d860b1a6e3031\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/sys_common/backtrace.rs:141:18\r\n  13:     0x561ccb097f09 - std::panicking::begin_panic::h732e081b9c235d56\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/panicking.rs:519:12\r\n  14:     0x561ccafe3ede - tokio::runtime::enter::enter::hc0f5c90ef5c894ad\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:39:9\r\n  15:     0x561ccab45bed - tokio::runtime::basic_scheduler::Inner<P>::block_on::{{closure}}::hed6681e77f9260cd\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:203:26\r\n  16:     0x561ccab48082 - tokio::runtime::basic_scheduler::enter::{{closure}}::hd9457608416cbd0b\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:323:29\r\n  17:     0x561ccab4ff95 - tokio::macros::scoped_tls::ScopedKey<T>::set::h57555c445c614f4c\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/macros/scoped_tls.rs:61:9\r\n  18:     0x561ccab47f1c - tokio::runtime::basic_scheduler::enter::hef3db5e04d965df2\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:323:5\r\n  19:     0x561ccab4502e - tokio::runtime::basic_scheduler::Inner<P>::block_on::hfad4f04041f5977b\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:202:9\r\n  20:     0x561ccab46ad7 - tokio::runtime::basic_scheduler::InnerGuard<P>::block_on::hf3db743b8bb44ae5\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:481:9\r\n  21:     0x561ccab4722f - tokio::runtime::basic_scheduler::BasicScheduler<P>::block_on::h81317ea8947b6220\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/basic_scheduler.rs:162:24\r\n  22:     0x561ccab54411 - tokio::runtime::Runtime::block_on::hdd6afd6059619e36\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/mod.rs:450:46\r\n  23:     0x561ccab4ddae - postgres::connection::Connection::poll_block_on::h2679b483c50a915a\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/connection.rs:67:9\r\n  24:     0x561ccab502c6 - postgres::client::Client::close_inner::h47f6c2ca10d3bf4f\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/client.rs:571:9\r\n  25:     0x561ccab5015e - <postgres::client::Client as core::ops::drop::Drop>::drop::h8e8e91aabcfa4235\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/postgres-0.19.1/src/client.rs:20:17\r\n  26:     0x561ccab4be67 - core::ptr::drop_in_place<postgres::client::Client>::h1bb55a0ebc17bef6\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  27:     0x561ccab05407 - core::ptr::drop_in_place<r2d2::Conn<postgres::client::Client>>::h1afb02d73042169b\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  28:     0x561ccab055be - core::ptr::drop_in_place<r2d2::IdleConn<postgres::client::Client>>::hbdf9d190a0f0d1a2\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  29:     0x561ccab05b30 - core::ptr::drop_in_place<[r2d2::IdleConn<postgres::client::Client>]>::h585788ba78b096b4\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  30:     0x561ccaae96e5 - <alloc::vec::Vec<T,A> as core::ops::drop::Drop>::drop::h1014dbeaed67654c\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/vec/mod.rs:2669:13\r\n  31:     0x561ccab05e97 - core::ptr::drop_in_place<alloc::vec::Vec<r2d2::IdleConn<postgres::client::Client>>>::h8e2d4d122814968e\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  32:     0x561ccab05777 - core::ptr::drop_in_place<r2d2::PoolInternals<postgres::client::Client>>::h2aa99339b8d8a7cd\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  33:     0x561ccab02e0e - core::ptr::drop_in_place<core::cell::UnsafeCell<r2d2::PoolInternals<postgres::client::Client>>>::hc7a3400199edd9c3\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  34:     0x561ccab03c32 - core::ptr::drop_in_place<lock_api::mutex::Mutex<parking_lot::raw_mutex::RawMutex,r2d2::PoolInternals<postgres::client::Client>>>::h9c597f639a3d14f0\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  35:     0x561ccab03394 - core::ptr::drop_in_place<r2d2::SharedPool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>::hfd20430b3a7ee999\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  36:     0x561ccab022d4 - alloc::sync::Arc<T>::drop_slow::hab07dd6909c7be77\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/sync.rs:1039:18\r\n  37:     0x561ccab0275c - <alloc::sync::Arc<T> as core::ops::drop::Drop>::drop::h0d6edef0d36279b3\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/alloc/src/sync.rs:1571:13\r\n  38:     0x561ccab03d5e - core::ptr::drop_in_place<alloc::sync::Arc<r2d2::SharedPool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>>::hf5479effd6eb21e6\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  39:     0x561ccab0312e - core::ptr::drop_in_place<r2d2::Pool<r2d2_postgres::PostgresConnectionManager<tokio_postgres::tls::NoTls>>>::h8a7979ea6bcfc259\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ptr/mod.rs:192:1\r\n  40:     0x561ccaafcbac - r2d2::config::Builder<M>::build::hfc571a12b6bd218d\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/r2d2-0.8.9/src/config.rs:230:5\r\n  41:     0x561ccab14fc2 - <postgres::client::Client as rocket_contrib::databases::poolable::Poolable>::pool::hb3198e4a077f798e\r\n                               at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/contrib/lib/src/databases/poolable.rs:178:12\r\n  42:     0x561ccaa799ff - rocket_contrib::databases::connection::ConnectionPool<K,C>::fairing::{{closure}}::{{closure}}::hdd1021a74bf0587d\r\n                               at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/contrib/lib/src/databases/connection.rs:80:19\r\n  43:     0x561ccaa83149 - <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll::hbafb64aece7b45e3\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  44:     0x561ccad2ca99 - <core::pin::Pin<P> as core::future::future::Future>::poll::h2066fbf9a7a3729f\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/future.rs:120:9\r\n  45:     0x561ccad15c90 - <rocket::fairing::ad_hoc::AdHoc as rocket::fairing::Fairing>::on_ignite::{{closure}}::h2fa4e16f5deb0435\r\n                               at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/fairing/ad_hoc.rs:239:41\r\n  46:     0x561ccacfd1ca - <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll::h54cd52d9a0afb3bf\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  47:     0x561ccad2ca99 - <core::pin::Pin<P> as core::future::future::Future>::poll::h2066fbf9a7a3729f\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/future.rs:120:9\r\n  48:     0x561ccac945a9 - rocket::fairing::fairings::Fairings::handle_ignite::{{closure}}::h98919c843c799273\r\n                               at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/fairing/fairings.rs:58:32\r\n  49:     0x561ccacfd0b9 - <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll::h54c05b70c2e3b3cf\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  50:     0x561ccace56d9 - rocket::rocket::Rocket<rocket::phase::Build>::ignite::{{closure}}::haab7214099777c25\r\n                               at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/rocket.rs:467:16\r\n  51:     0x561ccacfcd8b - <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll::h1d9e3a24272c9bb6\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  52:     0x561ccace893f - rocket::rocket::Rocket<P>::local_launch::{{closure}}::h6aac57ee555053b5\r\n                               at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/rocket.rs:792:32\r\n  53:     0x561ccacfcadb - <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll::h0f9ebf422705a7ec\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  54:     0x561ccad123d8 - rocket::local::asynchronous::client::Client::_new::{{closure}}::h6029e8c8e2d395de\r\n                               at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/local/asynchronous/client.rs:61:22\r\n  55:     0x561ccacfe08b - <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll::hfcf1d67ec7b4aa11\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  56:     0x561ccaa8bf51 - rocket::local::asynchronous::client::Client::tracked::{{closure}}::h499f77b817f69787\r\n                               at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/local/client.rs:71:9\r\n  57:     0x561ccaa834f9 - <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll::hd8dde10987b03c94\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  58:     0x561ccaaa4b4f - rocket_bug_repro::test::test_get_entries_3::{{closure}}::h2be08d3c9fff5505\r\n                               at /home/kittyandrew/tmp/rocket-bug-repro/src/main.rs:69:22\r\n  59:     0x561ccaa82f2b - <core::future::from_generator::GenFuture<T> as core::future::future::Future>::poll::ha3dc499a82453b1d\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80:19\r\n  60:     0x561ccaa804a0 - tokio::park::thread::CachedParkThread::block_on::{{closure}}::h32a9958efd59451f\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/park/thread.rs:263:54\r\n  61:     0x561ccaa6e16c - tokio::coop::with_budget::{{closure}}::h1554505db69c92e4\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:106:9\r\n  62:     0x561ccaa8961c - std::thread::local::LocalKey<T>::try_with::h8f0f1614611a655e\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:272:16\r\n  63:     0x561ccaa877ed - std::thread::local::LocalKey<T>::with::h26fc928251fc5cd4\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:248:9\r\n  64:     0x561ccaa7d37c - tokio::coop::with_budget::h90cf53eebfb7f247\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:99:5\r\n  65:     0x561ccaa7d37c - tokio::coop::budget::h6d27ebaa1d091a66\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/coop.rs:76:5\r\n  66:     0x561ccaa7d37c - tokio::park::thread::CachedParkThread::block_on::h469932602e9e9e5d\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/park/thread.rs:263:31\r\n  67:     0x561ccaa9043a - tokio::runtime::enter::Enter::block_on::h1b93cc8f42a1625e\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/enter.rs:151:13\r\n  68:     0x561ccaa8cc4f - tokio::runtime::thread_pool::ThreadPool::block_on::hbc328ca743e6a69f\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/thread_pool/mod.rs:71:9\r\n  69:     0x561ccaaa7151 - tokio::runtime::Runtime::block_on::hd0d31e0970912a9a\r\n                               at /home/kittyandrew/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.5.0/src/runtime/mod.rs:452:43\r\n  70:     0x561ccaaa1b6d - rocket::async_test::hefe06e8a7a83cbea\r\n                               at /home/kittyandrew/.cargo/git/checkouts/rocket-8bf16d9ca7e90bdc/e1307dd/core/lib/src/lib.rs:186:5\r\n  71:     0x561ccaaa07e9 - rocket_bug_repro::test::test_get_entries_3::h42b6aa7705e4d9ec\r\n                               at /home/kittyandrew/tmp/rocket-bug-repro/src/main.rs:68:35\r\n  72:     0x561ccaaa44dd - rocket_bug_repro::test::test_get_entries_3::{{closure}}::hd4ad733578b0f10c\r\n                               at /home/kittyandrew/tmp/rocket-bug-repro/src/main.rs:68:11\r\n  73:     0x561ccaa846ee - core::ops::function::FnOnce::call_once::hc79e620082f0803a\r\n                               at /home/kittyandrew/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:227:5\r\n  74:     0x561ccaaceab6 - core::ops::function::FnOnce::call_once::h4e9353104004bc3d\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/ops/function.rs:227:5\r\n  75:     0x561ccaaceab6 - test::__rust_begin_short_backtrace::hea4fd7fe7fb8303e\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/test/src/lib.rs:576:5\r\n  76:     0x561ccaacd516 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::hd7fd3e88849fc750\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/alloc/src/boxed.rs:1546:9\r\n  77:     0x561ccaacd516 - <std::panic::AssertUnwindSafe<F> as core::ops::function::FnOnce<()>>::call_once::h78a6897906b26c6e\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panic.rs:344:9\r\n  78:     0x561ccaacd516 - std::panicking::try::do_call::hbaa9991bef154d76\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panicking.rs:379:40\r\n  79:     0x561ccaacd516 - std::panicking::try::h0d1e876a7e6d9927\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panicking.rs:343:19\r\n  80:     0x561ccaacd516 - std::panic::catch_unwind::hf9cfc8afbc70b84f\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panic.rs:431:14\r\n  81:     0x561ccaacd516 - test::run_test_in_process::h947bacbaa4554ce4\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/test/src/lib.rs:599:18\r\n  82:     0x561ccaacd516 - test::run_test::run_test_inner::{{closure}}::he92bab8f95bf0784\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/test/src/lib.rs:491:39\r\n  83:     0x561ccaaa895e - test::run_test::run_test_inner::{{closure}}::hf54209f3d25efeee\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/test/src/lib.rs:518:37\r\n  84:     0x561ccaaa895e - std::sys_common::backtrace::__rust_begin_short_backtrace::hd6d5206cf37fd269\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/sys_common/backtrace.rs:125:18\r\n  85:     0x561ccaaac678 - std::thread::Builder::spawn_unchecked::{{closure}}::{{closure}}::h13bbfbf02991444a\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/thread/mod.rs:474:17\r\n  86:     0x561ccaaac678 - <std::panic::AssertUnwindSafe<F> as core::ops::function::FnOnce<()>>::call_once::h0e73313fa1b917d2\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panic.rs:344:9\r\n  87:     0x561ccaaac678 - std::panicking::try::do_call::h0601c6cdea59af51\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panicking.rs:379:40\r\n  88:     0x561ccaaac678 - std::panicking::try::h0d9ec6a2b7f348d3\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panicking.rs:343:19\r\n  89:     0x561ccaaac678 - std::panic::catch_unwind::h5b95c4a8cef23017\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/panic.rs:431:14\r\n  90:     0x561ccaaac678 - std::thread::Builder::spawn_unchecked::{{closure}}::hbfc50e47df131303\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/thread/mod.rs:473:30\r\n  91:     0x561ccaaac678 - core::ops::function::FnOnce::call_once{{vtable.shim}}::h5a3a0711c63b5a79\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/core/src/ops/function.rs:227:5\r\n  92:     0x561ccb0cdb37 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::h3aa31cb6360b59d9\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/alloc/src/boxed.rs:1546:9\r\n  93:     0x561ccb0cdb37 - <alloc::boxed::Box<F,A> as core::ops::function::FnOnce<Args>>::call_once::h7719d3c7c5841461\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/alloc/src/boxed.rs:1546:9\r\n  94:     0x561ccb0cdb37 - std::sys::unix::thread::Thread::new::thread_start::hfbe13ead469fd0bc\r\n                               at /rustc/16bf626a31cb5b121d0bca2baa969b4f67eb0dab/library/std/src/sys/unix/thread.rs:71:17\r\n  95:     0x7fbea4d15590 - start_thread\r\n  96:     0x7fbea4ae6223 - clone\r\n  97:                0x0 - <unknown>\r\nthread panicked while panicking. aborting.\r\nstack backtrace:\r\nerror: test failed, to rerun pass '--bin rocket-bug-repro'\r\n\r\nCaused by:\r\n  process didn't exit successfully: `/home/kittyandrew/tmp/rocket-bug-repro/target/debug/deps/rocket_bug_repro-dc4482a295a94d90 --nocapture` (signal: 4, SIGILL: illegal instruction)\r\n```\r\n\r\n</details>","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/824446271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kittyandrew","id":45767571,"node_id":"MDQ6VXNlcjQ1NzY3NTcx","avatar_url":"https://avatars.githubusercontent.com/u/45767571?v=4","gravatar_id":"","url":"https://api.github.com/users/kittyandrew","html_url":"https://github.com/kittyandrew","followers_url":"https://api.github.com/users/kittyandrew/followers","following_url":"https://api.github.com/users/kittyandrew/following{/other_user}","gists_url":"https://api.github.com/users/kittyandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/kittyandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kittyandrew/subscriptions","organizations_url":"https://api.github.com/users/kittyandrew/orgs","repos_url":"https://api.github.com/users/kittyandrew/repos","events_url":"https://api.github.com/users/kittyandrew/events{/privacy}","received_events_url":"https://api.github.com/users/kittyandrew/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/824455334","html_url":"https://github.com/rwf2/Rocket/issues/1610#issuecomment-824455334","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/1610","id":824455334,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNDQ1NTMzNA==","user":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-22T00:42:02Z","updated_at":"2021-04-22T00:42:02Z","body":"Okay, I am reproducing a similar error.\r\n\r\nI get: `db error: FATAL: remaining connection slots are reserved for non-replication superuser connections`\r\nThe problem here is that the \"obvious\" way to arrange tests tries to open more simultaneous connections the more tests there are, causing a deadlock during initialization that is broken by a timeout. Limiting the number of concurrent tests with `cargo test -- --test-threads` fixes this problem for me, and so does setting `pool_size = 1` (at least, until there are too many tests again). The technique used by the `todo` example ( <https://github.com/SergioBenitez/Rocket/blob/e1307ddf48dac14e6a37e526098732327bcb86f0/examples/todo/src/tests.rs#L11>) is another alternative that should accomplish the same.\r\n\r\nAfter this error occurs, the pool is `Drop`ped from `async` code. This wasn't noticed or fixed as part of c6298b9 because this case happens before it is wrapped into the `Drop`-safe wrapper type and needs to be fixed separately.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/824455334/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/825635687","html_url":"https://github.com/rwf2/Rocket/issues/1610#issuecomment-825635687","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/1610","id":825635687,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTYzNTY4Nw==","user":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-23T12:49:56Z","updated_at":"2021-04-23T12:49:56Z","body":"> get: `db error: FATAL: remaining connection slots are reserved for non-replication superuser connections`\r\n> The problem here is that the \"obvious\" way to arrange tests tries to open more simultaneous connections the more tests there are, causing a deadlock during initialization that is broken by a timeout.\r\n\r\nI'm confused by what you're implying, if anything. Are you saying this is something that can't be fixed in Rocket, or are you suggesting what the new issue is?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/825635687/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/825712289","html_url":"https://github.com/rwf2/Rocket/issues/1610#issuecomment-825712289","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/1610","id":825712289,"node_id":"MDEyOklzc3VlQ29tbWVudDgyNTcxMjI4OQ==","user":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-23T14:51:03Z","updated_at":"2021-04-23T14:51:38Z","body":"There are two problems shown by the output in <https://github.com/SergioBenitez/Rocket/issues/1610#issuecomment-824446271>:\r\n\r\n* Postgres limits the number of incoming connections, and running too many tests simultaneously, each with their own pool of open connections, appears to hit that limit. One solution is to have fewer simultaneous open connections, and the easiest way I know of to do this is to limit concurrent tests with `test-threads` or with the approach used in the `todo` example. Rocket *may* be able to mitigate this, but I can't think of an elegant way to do that because it's entirely application-dependent how many tests are connecting to which database at which capacity and whether that exceeds some limit.\r\n\r\n* Errors during pool initialization *should* only be printed, but it leads to panics at least in `postgres` due to a missing call to `spawn_blocking`. This is similar to the case fixed by c6298b9, but that commit only covered the \"happy path\" and not the case where the synchronous connection pool might be dropped before/instead of being placed into its `Drop`-fixing wrapper. It's thankfully not hard to fix:\r\n\r\n```diff\r\ndiff --git a/contrib/lib/src/databases/connection.rs b/contrib/lib/src/databases/connection.rs\r\nindex 0f698701..ad07cb6a 100644\r\n--- a/contrib/lib/src/databases/connection.rs\r\n+++ b/contrib/lib/src/databases/connection.rs\r\n@@ -71,6 +71,7 @@ macro_rules! dberr {\r\n impl<K: 'static, C: Poolable> ConnectionPool<K, C> {\r\n     pub fn fairing(fairing_name: &'static str, db: &'static str) -> impl Fairing {\r\n         AdHoc::try_on_ignite(fairing_name, move |rocket| async move {\r\n+            run_blocking(move || {\r\n                 let config = match Config::from(db, &rocket) {\r\n                     Ok(config) => config,\r\n                     Err(e) => dberr!(\"config\", db, \"{}\", e, rocket),\r\n@@ -88,6 +89,7 @@ impl<K: 'static, C: Poolable> ConnectionPool<K, C> {\r\n                     Err(Error::Pool(e)) => dberr!(\"pool init\", db, \"{}\", e, rocket),\r\n                     Err(Error::Custom(e)) => dberr!(\"pool manager\", db, \"{:?}\", e, rocket),\r\n                 }\r\n+            }).await\r\n         })\r\n     }\r\n```\r\n\r\nNote that this was \"wrong\" for a long time, because it ran synchronous code on a thread currently running asynchronous code. However, currently only `postgres` pools `Drop`ping reliably detect and panic when this happens, because it indirectly leads to recursive calls to tokio's `block_on`. Synchronous databases that don't have an asynchronous I/O backend would silently block anywawy, which... honestly during startup/shutdown is probably not the end of the world, but it's relatively easy and correct to fix this everywhere. I'll open the PR once I'm sure there isn't another missing `blocking` call for one of these.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/825712289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4637598295,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ2Mzc1OTgyOTU=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4637598295","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"08e543a662bb4cef70064b4b97fe3246f66cdc44","commit_url":"https://api.github.com/repos/jebrosen/Rocket/commits/08e543a662bb4cef70064b4b97fe3246f66cdc44","created_at":"2021-04-23T15:37:26Z","performed_via_github_app":null},{"id":4646836024,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ2NDY4MzYwMjQ=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4646836024","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ea8c2b205a7fb0283fc16e32d2f9822efccfa793","commit_url":"https://api.github.com/repos/jebrosen/Rocket/commits/ea8c2b205a7fb0283fc16e32d2f9822efccfa793","created_at":"2021-04-26T19:13:02Z","performed_via_github_app":null},{"id":4646841412,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ2NDY4NDE0MTI=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4646841412","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"2de21225c57d64c6805551e61ee62eb7120a535b","commit_url":"https://api.github.com/repos/jebrosen/Rocket/commits/2de21225c57d64c6805551e61ee62eb7120a535b","created_at":"2021-04-26T19:14:00Z","performed_via_github_app":null},{"id":4647228748,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ2NDcyMjg3NDg=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4647228748","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"66b580f2f2a5203412f79c918e21b3a5d546909a","commit_url":"https://api.github.com/repos/jebrosen/Rocket/commits/66b580f2f2a5203412f79c918e21b3a5d546909a","created_at":"2021-04-26T20:30:18Z","performed_via_github_app":null},{"actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-26T21:05:59Z","updated_at":"2021-04-26T21:05:59Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/1618","repository_url":"https://api.github.com/repos/rwf2/Rocket","labels_url":"https://api.github.com/repos/rwf2/Rocket/issues/1618/labels{/name}","comments_url":"https://api.github.com/repos/rwf2/Rocket/issues/1618/comments","events_url":"https://api.github.com/repos/rwf2/Rocket/issues/1618/events","html_url":"https://github.com/rwf2/Rocket/pull/1618","id":868203138,"node_id":"MDExOlB1bGxSZXF1ZXN0NjIzNzY0ODc0","number":1618,"title":"Initialize synchronous database pools inside of `spawn_blocking`.","user":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-04-26T21:05:59Z","updated_at":"2021-04-28T03:56:14Z","closed_at":"2021-04-28T02:32:38Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":54168759,"node_id":"MDEwOlJlcG9zaXRvcnk1NDE2ODc1OQ==","name":"Rocket","full_name":"rwf2/Rocket","private":false,"owner":{"login":"rwf2","id":106361765,"node_id":"O_kgDOBlbzpQ","avatar_url":"https://avatars.githubusercontent.com/u/106361765?v=4","gravatar_id":"","url":"https://api.github.com/users/rwf2","html_url":"https://github.com/rwf2","followers_url":"https://api.github.com/users/rwf2/followers","following_url":"https://api.github.com/users/rwf2/following{/other_user}","gists_url":"https://api.github.com/users/rwf2/gists{/gist_id}","starred_url":"https://api.github.com/users/rwf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rwf2/subscriptions","organizations_url":"https://api.github.com/users/rwf2/orgs","repos_url":"https://api.github.com/users/rwf2/repos","events_url":"https://api.github.com/users/rwf2/events{/privacy}","received_events_url":"https://api.github.com/users/rwf2/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rwf2/Rocket","description":"A web framework for Rust.","fork":false,"url":"https://api.github.com/repos/rwf2/Rocket","forks_url":"https://api.github.com/repos/rwf2/Rocket/forks","keys_url":"https://api.github.com/repos/rwf2/Rocket/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rwf2/Rocket/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rwf2/Rocket/teams","hooks_url":"https://api.github.com/repos/rwf2/Rocket/hooks","issue_events_url":"https://api.github.com/repos/rwf2/Rocket/issues/events{/number}","events_url":"https://api.github.com/repos/rwf2/Rocket/events","assignees_url":"https://api.github.com/repos/rwf2/Rocket/assignees{/user}","branches_url":"https://api.github.com/repos/rwf2/Rocket/branches{/branch}","tags_url":"https://api.github.com/repos/rwf2/Rocket/tags","blobs_url":"https://api.github.com/repos/rwf2/Rocket/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rwf2/Rocket/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rwf2/Rocket/git/refs{/sha}","trees_url":"https://api.github.com/repos/rwf2/Rocket/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rwf2/Rocket/statuses/{sha}","languages_url":"https://api.github.com/repos/rwf2/Rocket/languages","stargazers_url":"https://api.github.com/repos/rwf2/Rocket/stargazers","contributors_url":"https://api.github.com/repos/rwf2/Rocket/contributors","subscribers_url":"https://api.github.com/repos/rwf2/Rocket/subscribers","subscription_url":"https://api.github.com/repos/rwf2/Rocket/subscription","commits_url":"https://api.github.com/repos/rwf2/Rocket/commits{/sha}","git_commits_url":"https://api.github.com/repos/rwf2/Rocket/git/commits{/sha}","comments_url":"https://api.github.com/repos/rwf2/Rocket/comments{/number}","issue_comment_url":"https://api.github.com/repos/rwf2/Rocket/issues/comments{/number}","contents_url":"https://api.github.com/repos/rwf2/Rocket/contents/{+path}","compare_url":"https://api.github.com/repos/rwf2/Rocket/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rwf2/Rocket/merges","archive_url":"https://api.github.com/repos/rwf2/Rocket/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rwf2/Rocket/downloads","issues_url":"https://api.github.com/repos/rwf2/Rocket/issues{/number}","pulls_url":"https://api.github.com/repos/rwf2/Rocket/pulls{/number}","milestones_url":"https://api.github.com/repos/rwf2/Rocket/milestones{/number}","notifications_url":"https://api.github.com/repos/rwf2/Rocket/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rwf2/Rocket/labels{/name}","releases_url":"https://api.github.com/repos/rwf2/Rocket/releases{/id}","deployments_url":"https://api.github.com/repos/rwf2/Rocket/deployments","created_at":"2016-03-18T02:50:18Z","updated_at":"2025-11-09T18:27:08Z","pushed_at":"2025-10-01T04:53:46Z","git_url":"git://github.com/rwf2/Rocket.git","ssh_url":"git@github.com:rwf2/Rocket.git","clone_url":"https://github.com/rwf2/Rocket.git","svn_url":"https://github.com/rwf2/Rocket","homepage":"https://rocket.rs","size":8445,"stargazers_count":25480,"watchers_count":25480,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":1614,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":84,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["framework","rocket","rust","web","web-development","web-framework"],"visibility":"public","forks":1614,"open_issues":84,"watchers":25480,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/rwf2/Rocket/pulls/1618","html_url":"https://github.com/rwf2/Rocket/pull/1618","diff_url":"https://github.com/rwf2/Rocket/pull/1618.diff","patch_url":"https://github.com/rwf2/Rocket/pull/1618.patch","merged_at":"2021-04-28T02:32:38Z"},"body":"One situation where this is noticeable is when initialization failure\r\nleads to `Drop`; unlike in a successful initialization, `postgres`\r\ndetects and panics when `Drop` is called from within asynchronous code.\r\nSeveral other database pools do not panic in this same situation, but\r\nwould still block the current thread.\r\n\r\nAlso sets the minimum version of `tokio` to 1.4 in `rocket_contrib`,\r\nwhich is the version where `Handle::block_on` (used in `Drop` impls) was\r\nintroduced.\r\n\r\nFixes #1610.\r\n\r\n---\r\n\r\nThis should be reviewed closely, since there have been several bugs and regressions in this area. The goal is thus:\r\n\r\nSynchronous database pool and connection usage, *including* creation, usage, and `Drop`, should always be done inside some kind of \"blocking-safe\" environment. Since #1375 databases use `spawn_blocking`; alternatives include `block_in_place` (risky) or a dedicated thread with message passing to communicate between the async and sync code (safer, but probably not better than the status quo in terms of complexity to implement maintain or troubleshoot and likely still pretty bad ergonomically).\r\n\r\nThis problem is now addressed by starting the database pool inside a `spawn_blocking` closure. Usage of the database pool (i.e. acquiring connections) was already wrapped, along with usage of the connections themselves. This leaves `Drop`, which was also already wrapped properly -- aside from a race condition between server shutdown and handlers that were still running, which was recently fixed in e1307dd.","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/1618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rwf2/Rocket/issues/1618/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":4647396107,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ2NDczOTYxMDc=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4647396107","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a5645f464acb5b1ab0ea0173208860d2c289ee93","commit_url":"https://api.github.com/repos/jebrosen/Rocket/commits/a5645f464acb5b1ab0ea0173208860d2c289ee93","created_at":"2021-04-26T21:06:43Z","performed_via_github_app":null},{"id":4653956838,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ2NTM5NTY4Mzg=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4653956838","actor":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"37226770c9443d33e64e91579314da4ee2d3270a","commit_url":"https://api.github.com/repos/jebrosen/Rocket/commits/37226770c9443d33e64e91579314da4ee2d3270a","created_at":"2021-04-28T01:40:25Z","performed_via_github_app":null},{"id":4654081681,"node_id":"MDExOkNsb3NlZEV2ZW50NDY1NDA4MTY4MQ==","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4654081681","actor":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-04-28T02:32:38Z","state_reason":null,"performed_via_github_app":null},{"id":4654081718,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ2NTQwODE3MTg=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/4654081718","actor":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"078cf1725f5c7e50b45beeb1ec3e5e0e3a2cb0dc","commit_url":"https://api.github.com/repos/rwf2/Rocket/commits/078cf1725f5c7e50b45beeb1ec3e5e0e3a2cb0dc","created_at":"2021-04-28T02:32:40Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/828455974","html_url":"https://github.com/rwf2/Rocket/issues/1610#issuecomment-828455974","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/1610","id":828455974,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODQ1NTk3NA==","user":{"login":"kittyandrew","id":45767571,"node_id":"MDQ6VXNlcjQ1NzY3NTcx","avatar_url":"https://avatars.githubusercontent.com/u/45767571?v=4","gravatar_id":"","url":"https://api.github.com/users/kittyandrew","html_url":"https://github.com/kittyandrew","followers_url":"https://api.github.com/users/kittyandrew/followers","following_url":"https://api.github.com/users/kittyandrew/following{/other_user}","gists_url":"https://api.github.com/users/kittyandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/kittyandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kittyandrew/subscriptions","organizations_url":"https://api.github.com/users/kittyandrew/orgs","repos_url":"https://api.github.com/users/kittyandrew/repos","events_url":"https://api.github.com/users/kittyandrew/events{/privacy}","received_events_url":"https://api.github.com/users/kittyandrew/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-28T13:29:16Z","updated_at":"2021-04-28T14:00:05Z","body":"So is this something that isn't going to be fixed? For me `cargo test` still won't run without `-- --test-threads=1`.\r\nIf I have to use something like DB_LOCK and macro, how do I do that with different files?\r\n\r\nError:\r\n<details>\r\n<pre>\r\nrunning 9 tests\r\nError: database pool init error for pool named `storage`\r\n   >> timed out waiting for connection: db error: FATAL: sorry, too many clients already\r\nthread 'tests::integration_tests::test_suit_1' panicked at 'Rocket client: FailedFairings([Info { name: \"'storage' Database Pool\", kind: Kind(1) }])', src/tests/integration_tests.rs:35:5\r\nstack backtrace:\r\nError: database pool init error for pool named `storage`\r\n   >> timed out waiting for connection: db error: FATAL: sorry, too many clients already\r\nError: database pool init error for pool named `storage`\r\n   >> timed out waiting for connection: db error: FATAL: sorry, too many clients already\r\nError: database pool init error for pool named `storage`\r\n   >> timed out waiting for connection: db error: FATAL: sorry, too many clients already\r\nthread 'tests::create_one_entry::test_bad' panicked at 'called `Result::unwrap()` on an `Err` value: FailedFairings([Info { name: \"'storage' Database Pool\", kind: Kind(1) }])', src/tests/create_one_entry.rs:9:50\r\nthread 'tests::create_many_entries::test_bad' panicked at 'called `Result::unwrap()` on an `Err` value: FailedFairings([Info { name: \"'storage' Database Pool\", kind: Kind(1) }])', src/tests/create_many_entries.rs:9:50\r\nthread 'Error: database pool init error for pool named `storage`\r\n   >> timed out waiting for connection: db error: FATAL: sorry, too many clients already\r\nthread 'tests::get_entry_by_id::test_bad' panicked at 'called `Result::unwrap()` on an `Err` value: FailedFairings([Info { name: \"'storage' Database Pool\", kind: Kind(1) }])', src/tests/get_entry_by_id.rs:9:50\r\ntests::health::test_health_endpoint' panicked at 'called `Result::unwrap()` on an `Err` value: FailedFairings([Info { name: \"'storage' Database Pool\", kind: Kind(1) }])', src/tests/health.rs:7:57\r\nError: database pool init error for pool named `storage`\r\n   >> timed out waiting for connection: db error: FATAL: sorry, too many clients already\r\nthread 'tests::get_paginated_entries::test_bad' panicked at 'called `Result::unwrap()` on an `Err` value: FailedFairings([Info { name: \"'storage' Database Pool\", kind: Kind(1) }])', src/tests/get_paginated_entries.rs:9:50\r\nError: database pool init error for pool named `storage`\r\n   >> timed out waiting for connection: db error: FATAL: sorry, too many clients already\r\n</pre>\r\n</details>","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/828455974/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"kittyandrew","id":45767571,"node_id":"MDQ6VXNlcjQ1NzY3NTcx","avatar_url":"https://avatars.githubusercontent.com/u/45767571?v=4","gravatar_id":"","url":"https://api.github.com/users/kittyandrew","html_url":"https://github.com/kittyandrew","followers_url":"https://api.github.com/users/kittyandrew/followers","following_url":"https://api.github.com/users/kittyandrew/following{/other_user}","gists_url":"https://api.github.com/users/kittyandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/kittyandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kittyandrew/subscriptions","organizations_url":"https://api.github.com/users/kittyandrew/orgs","repos_url":"https://api.github.com/users/kittyandrew/repos","events_url":"https://api.github.com/users/kittyandrew/events{/privacy}","received_events_url":"https://api.github.com/users/kittyandrew/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/828536807","html_url":"https://github.com/rwf2/Rocket/issues/1610#issuecomment-828536807","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/1610","id":828536807,"node_id":"MDEyOklzc3VlQ29tbWVudDgyODUzNjgwNw==","user":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-28T15:11:32Z","updated_at":"2021-04-28T15:11:32Z","body":"> So is this something that isn't going to be fixed?\r\n\r\nPlease see my last comment explaining that this is specific to the database engine and configuration. If anyone can think of a way to fix this in Rocket without negatively impacting other users (including users who don't use databases at all, or are using databases with a higher limit) - then I would be happy to review a PR for that.\r\n\r\n> If I have to use something like DB_LOCK and macro, how do I do that with different files?\r\n\r\nI don't know what you mean by this; if you have code that isn't doing what you want, then the easiest way for me to understand it would be to see the code.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/828536807/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11603836082,"node_id":"REFE_lADOAzqMt84zV9ldzwAAAAKzpHyy","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/11603836082","actor":{"login":"pull[bot]","id":39814207,"node_id":"MDM6Qm90Mzk4MTQyMDc=","avatar_url":"https://avatars.githubusercontent.com/in/12910?v=4","gravatar_id":"","url":"https://api.github.com/users/pull%5Bbot%5D","html_url":"https://github.com/apps/pull","followers_url":"https://api.github.com/users/pull%5Bbot%5D/followers","following_url":"https://api.github.com/users/pull%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/pull%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/pull%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pull%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/pull%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/pull%5Bbot%5D/repos","events_url":"https://api.github.com/users/pull%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/pull%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e1307ddf48dac14e6a37e526098732327bcb86f0","commit_url":"https://api.github.com/repos/Necmttn/Rocket/commits/e1307ddf48dac14e6a37e526098732327bcb86f0","created_at":"2024-01-26T01:03:03Z","performed_via_github_app":null}]