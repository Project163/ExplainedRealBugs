{"url":"https://api.github.com/repos/rwf2/Rocket/issues/2131","repository_url":"https://api.github.com/repos/rwf2/Rocket","labels_url":"https://api.github.com/repos/rwf2/Rocket/issues/2131/labels{/name}","comments_url":"https://api.github.com/repos/rwf2/Rocket/issues/2131/comments","events_url":"https://api.github.com/repos/rwf2/Rocket/issues/2131/events","html_url":"https://github.com/rwf2/Rocket/issues/2131","id":1179194032,"node_id":"I_kwDOAzqMt85GSRKw","number":2131,"title":"`Vec` FromForm doesn't consider parsing strategy","user":{"login":"vhakulinen","id":4594126,"node_id":"MDQ6VXNlcjQ1OTQxMjY=","avatar_url":"https://avatars.githubusercontent.com/u/4594126?v=4","gravatar_id":"","url":"https://api.github.com/users/vhakulinen","html_url":"https://github.com/vhakulinen","followers_url":"https://api.github.com/users/vhakulinen/followers","following_url":"https://api.github.com/users/vhakulinen/following{/other_user}","gists_url":"https://api.github.com/users/vhakulinen/gists{/gist_id}","starred_url":"https://api.github.com/users/vhakulinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vhakulinen/subscriptions","organizations_url":"https://api.github.com/users/vhakulinen/orgs","repos_url":"https://api.github.com/users/vhakulinen/repos","events_url":"https://api.github.com/users/vhakulinen/events{/privacy}","received_events_url":"https://api.github.com/users/vhakulinen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":758541123,"node_id":"MDU6TGFiZWw3NTg1NDExMjM=","url":"https://api.github.com/repos/rwf2/Rocket/labels/deficiency","name":"deficiency","color":"D93F0B","default":false,"description":"Something doesn't work as well as it could"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-03-24T08:49:06Z","updated_at":"2022-04-21T15:19:27Z","closed_at":"2022-04-21T15:19:27Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Description**\r\n\r\n[FormFrom](https://api.rocket.rs/master/rocket/form/trait.FromForm.html#provided-implementations) implementation for `Vec` doesn't parse strictly even if [`Strict`](https://api.rocket.rs/master/rocket/form/struct.Strict.html) is used (e.g. always parses with lenient strategy). See the example code below.\r\n\r\n**To Reproduce**\r\n\r\nCargo.toml\r\n```toml\r\n[package]\r\nname = \"rocket-bug\"\r\nversion = \"0.1.0\"\r\nedition = \"2021\"\r\n\r\n[dependencies]\r\n\r\n[dependencies.rocket]\r\ngit = \"https://github.com/SergioBenitez/Rocket/\"\r\nbranch  = \"v0.5-rc\"\r\n```\r\n\r\nmain.rs\r\n```rust\r\n#[macro_use] extern crate rocket;\r\n\r\nuse rocket::{Rocket, Build, form::Strict};\r\n\r\n#[get(\"/foobar?<foo>\")]\r\nfn foobar(foo: Option<Strict<Vec<String>>>) {\r\n    println!(\"foo: {:?}\", foo);\r\n}\r\n\r\n#[test]\r\nfn test_foobar() {\r\n    let rocket = build();\r\n    let client = rocket::local::blocking::Client::tracked(rocket).unwrap();\r\n\r\n    let _res = client.get(\r\n        rocket::uri!(foobar(foo = _))\r\n    ).dispatch();\r\n\r\n    assert!(false);\r\n}\r\n\r\nfn build() -> Rocket<Build> {\r\n    rocket::build().mount(\"/\", routes![foobar])\r\n}\r\n\r\n#[launch]\r\nfn rocket() -> _ {\r\n    build()\r\n}\r\n```\r\n\r\nOutput of `cargo test`\r\n\r\n```\r\nrunning 1 test\r\ntest test_foobar ... FAILED\r\n\r\nfailures:\r\n\r\n---- test_foobar stdout ----\r\nðŸ”§ Configured for debug.\r\n   >> address: 127.0.0.1\r\n   >> port: 8000\r\n   >> workers: 16\r\n   >> ident: Rocket\r\n   >> limits: bytes = 8KiB, data-form = 2MiB, file = 1MiB, form = 32KiB, json = 1MiB, msgpack = 1MiB, string = 8KiB\r\n   >> temp dir: /tmp\r\n   >> keep-alive: 5s\r\n   >> tls: disabled\r\n   >> shutdown: ctrlc = true, force = true, signals = [SIGTERM], grace = 2s, mercy = 3s\r\n   >> log level: normal\r\n   >> cli colors: true\r\nðŸ“¬ Routes:\r\n   >> (foobar) GET /foobar?<foo>\r\nðŸ“¡ Fairings:\r\n   >> Shield (liftoff, response, singleton)\r\nðŸ›¡ï¸ Shield:\r\n   >> Permissions-Policy: interest-cohort=()\r\n   >> X-Content-Type-Options: nosniff\r\n   >> X-Frame-Options: SAMEORIGIN\r\nðŸš€ Rocket has launched into local orbit\r\nGET /foobar:\r\n   >> Matched: (foobar) GET /foobar?<foo>\r\nfoo: Some(Strict([]))            <------------------------------------------------- NOTICE THIS\r\n   >> Outcome: Success\r\nthread 'test_foobar' panicked at 'assertion failed: false', src/main.rs:19:5\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n\r\n\r\nfailures:\r\n    test_foobar\r\n\r\ntest result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.01s\r\n```\r\n\r\n**Expected Behavior**\r\n\r\nThe expected output for the _NOTICE THIS_ line should be `None`.\r\n\r\n**Environment:**\r\n\r\n - OS Distribution and Kernel: popos 21.10 (kernel 5.16.11)\r\n - Rocket Version: v0.5-rc#e382bc584b478092fdd53eefb9f90ea9c08a6967 (Same happens with the latest master at the time of writing)\r\n\r\n**Additional Context**\r\n\r\nConversation from matrix when discovering this bug:\r\n\r\n> **vhakulinen**\r\n> ..should it be Strict<Option<Vec<String>>> or Option<Strict<Vec<String>>>?\r\n> **Sergio**\r\n> The latter.\r\n> Option is already strict.\r\n> **vhakulinen**\r\n> It still gives Some([]) Some(Strict([])). Should I be passing something else to uri!?\r\n> **Sergio**\r\n> Maybe the Vec impl is wrong.\r\n> Hmm, yeah, it doesn't seem to consider the parsing strategy.\r\n","closed_by":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/2131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rwf2/Rocket/issues/2131/timeline","performed_via_github_app":null,"state_reason":"completed"}