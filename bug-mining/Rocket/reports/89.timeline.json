[{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/435752218","html_url":"https://github.com/rwf2/Rocket/issues/814#issuecomment-435752218","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/814","id":435752218,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNTc1MjIxOA==","user":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-05T04:30:25Z","updated_at":"2018-11-05T04:30:25Z","body":"This looks like a consequence of eda635a, the automatic cookie tracking between requests. I'm going to assume that none of Rocket's tests or examples were sharing a `Client` between threads before, since they didn't need to be changed.\r\n\r\nWhat is your use case for sharing a single `Client` between threads? It's probably a bad idea to share a `Client` between threads if the cookie tracking is enabled, but it is probably fine to do so with an `untracked` `Client`.","author_association":"COLLABORATOR","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/435752218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jebrosen","id":7102588,"node_id":"MDQ6VXNlcjcxMDI1ODg=","avatar_url":"https://avatars.githubusercontent.com/u/7102588?v=4","gravatar_id":"","url":"https://api.github.com/users/jebrosen","html_url":"https://github.com/jebrosen","followers_url":"https://api.github.com/users/jebrosen/followers","following_url":"https://api.github.com/users/jebrosen/following{/other_user}","gists_url":"https://api.github.com/users/jebrosen/gists{/gist_id}","starred_url":"https://api.github.com/users/jebrosen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jebrosen/subscriptions","organizations_url":"https://api.github.com/users/jebrosen/orgs","repos_url":"https://api.github.com/users/jebrosen/repos","events_url":"https://api.github.com/users/jebrosen/events{/privacy}","received_events_url":"https://api.github.com/users/jebrosen/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/435757299","html_url":"https://github.com/rwf2/Rocket/issues/814#issuecomment-435757299","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/814","id":435757299,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNTc1NzI5OQ==","user":{"login":"messense","id":1556054,"node_id":"MDQ6VXNlcjE1NTYwNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1556054?v=4","gravatar_id":"","url":"https://api.github.com/users/messense","html_url":"https://github.com/messense","followers_url":"https://api.github.com/users/messense/followers","following_url":"https://api.github.com/users/messense/following{/other_user}","gists_url":"https://api.github.com/users/messense/gists{/gist_id}","starred_url":"https://api.github.com/users/messense/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/messense/subscriptions","organizations_url":"https://api.github.com/users/messense/orgs","repos_url":"https://api.github.com/users/messense/repos","events_url":"https://api.github.com/users/messense/events{/privacy}","received_events_url":"https://api.github.com/users/messense/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-05T05:12:19Z","updated_at":"2018-11-05T05:12:19Z","body":"The test case code looks like this:\r\n\r\n```rust\r\n    #[test]\r\n    fn test_multiple_same_hash_requests_only_one_created() {\r\n        let client = Arc::new(Client::new(rocket()).unwrap());\r\n        client.delete(\"/_internal/cf/test\").dispatch();\r\n        client.post(\"/_internal/cf/test\").dispatch();\r\n\r\n        let (tx, rx) = channel();\r\n        for _ in 0..5 {\r\n            let tx = tx.clone();\r\n            let client = client.clone();\r\n            thread::spawn(move|| {\r\n                let response = client.post(\"/test\").header(ContentType::JSON).body(\r\n                    serde_json::to_string(&DedupeHash { id: \"123\".to_string(), hash: \"abc\".to_string(), metadata: None}).unwrap()\r\n                ).dispatch();\r\n                tx.send(response.status()).unwrap();\r\n            });\r\n        }\r\n        drop(tx);\r\n        let statuses: Vec<Status> = rx.iter().collect();\r\n        let created_count = statuses.iter().filter(|x| **x == Status::Created).count();\r\n        let ok_count = statuses.iter().filter(|x| **x == Status::Ok).count();\r\n        assert_eq!(created_count, 1);\r\n        assert_eq!(ok_count, 4);\r\n    }\r\n```\r\n\r\nI want to test that concurrent same requests will only create one item.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/435757299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"messense","id":1556054,"node_id":"MDQ6VXNlcjE1NTYwNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1556054?v=4","gravatar_id":"","url":"https://api.github.com/users/messense","html_url":"https://github.com/messense","followers_url":"https://api.github.com/users/messense/followers","following_url":"https://api.github.com/users/messense/following{/other_user}","gists_url":"https://api.github.com/users/messense/gists{/gist_id}","starred_url":"https://api.github.com/users/messense/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/messense/subscriptions","organizations_url":"https://api.github.com/users/messense/orgs","repos_url":"https://api.github.com/users/messense/repos","events_url":"https://api.github.com/users/messense/events{/privacy}","received_events_url":"https://api.github.com/users/messense/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/436004584","html_url":"https://github.com/rwf2/Rocket/issues/814#issuecomment-436004584","issue_url":"https://api.github.com/repos/rwf2/Rocket/issues/814","id":436004584,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjAwNDU4NA==","user":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-05T19:29:57Z","updated_at":"2018-11-05T19:29:57Z","body":"We should be able to change the `RefCell` for a `Mutex` or `RwLock` to regain `Sync` and `Send`.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/comments/436004584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":1947158018,"node_id":"MDEyOkxhYmVsZWRFdmVudDE5NDcxNTgwMTg=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/1947158018","actor":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2018-11-05T19:31:12Z","label":{"name":"deficiency","color":"fc2929"},"performed_via_github_app":null},{"id":1947854137,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDE5NDc4NTQxMzc=","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/1947854137","actor":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2018-11-06T02:09:01Z","milestone":{"title":"0.4.0"},"performed_via_github_app":null},{"actor":{"login":"messense","id":1556054,"node_id":"MDQ6VXNlcjE1NTYwNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1556054?v=4","gravatar_id":"","url":"https://api.github.com/users/messense","html_url":"https://github.com/messense","followers_url":"https://api.github.com/users/messense/followers","following_url":"https://api.github.com/users/messense/following{/other_user}","gists_url":"https://api.github.com/users/messense/gists{/gist_id}","starred_url":"https://api.github.com/users/messense/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/messense/subscriptions","organizations_url":"https://api.github.com/users/messense/orgs","repos_url":"https://api.github.com/users/messense/repos","events_url":"https://api.github.com/users/messense/events{/privacy}","received_events_url":"https://api.github.com/users/messense/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2018-11-06T03:00:16Z","updated_at":"2018-11-06T03:00:16Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/818","repository_url":"https://api.github.com/repos/rwf2/Rocket","labels_url":"https://api.github.com/repos/rwf2/Rocket/issues/818/labels{/name}","comments_url":"https://api.github.com/repos/rwf2/Rocket/issues/818/comments","events_url":"https://api.github.com/repos/rwf2/Rocket/issues/818/events","html_url":"https://github.com/rwf2/Rocket/pull/818","id":377672685,"node_id":"MDExOlB1bGxSZXF1ZXN0MjI4NTU5OTM3","number":818,"title":"Make local client Sync","user":{"login":"messense","id":1556054,"node_id":"MDQ6VXNlcjE1NTYwNTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1556054?v=4","gravatar_id":"","url":"https://api.github.com/users/messense","html_url":"https://github.com/messense","followers_url":"https://api.github.com/users/messense/followers","following_url":"https://api.github.com/users/messense/following{/other_user}","gists_url":"https://api.github.com/users/messense/gists{/gist_id}","starred_url":"https://api.github.com/users/messense/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/messense/subscriptions","organizations_url":"https://api.github.com/users/messense/orgs","repos_url":"https://api.github.com/users/messense/repos","events_url":"https://api.github.com/users/messense/events{/privacy}","received_events_url":"https://api.github.com/users/messense/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":763868037,"node_id":"MDU6TGFiZWw3NjM4NjgwMzc=","url":"https://api.github.com/repos/rwf2/Rocket/labels/pr:%20merged","name":"pr: merged","color":"5319E7","default":false,"description":"This pull request was merged manually."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-11-06T03:00:16Z","updated_at":"2018-11-13T02:46:41Z","closed_at":"2018-11-09T05:41:03Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":54168759,"node_id":"MDEwOlJlcG9zaXRvcnk1NDE2ODc1OQ==","name":"Rocket","full_name":"rwf2/Rocket","private":false,"owner":{"login":"rwf2","id":106361765,"node_id":"O_kgDOBlbzpQ","avatar_url":"https://avatars.githubusercontent.com/u/106361765?v=4","gravatar_id":"","url":"https://api.github.com/users/rwf2","html_url":"https://github.com/rwf2","followers_url":"https://api.github.com/users/rwf2/followers","following_url":"https://api.github.com/users/rwf2/following{/other_user}","gists_url":"https://api.github.com/users/rwf2/gists{/gist_id}","starred_url":"https://api.github.com/users/rwf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rwf2/subscriptions","organizations_url":"https://api.github.com/users/rwf2/orgs","repos_url":"https://api.github.com/users/rwf2/repos","events_url":"https://api.github.com/users/rwf2/events{/privacy}","received_events_url":"https://api.github.com/users/rwf2/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rwf2/Rocket","description":"A web framework for Rust.","fork":false,"url":"https://api.github.com/repos/rwf2/Rocket","forks_url":"https://api.github.com/repos/rwf2/Rocket/forks","keys_url":"https://api.github.com/repos/rwf2/Rocket/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rwf2/Rocket/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rwf2/Rocket/teams","hooks_url":"https://api.github.com/repos/rwf2/Rocket/hooks","issue_events_url":"https://api.github.com/repos/rwf2/Rocket/issues/events{/number}","events_url":"https://api.github.com/repos/rwf2/Rocket/events","assignees_url":"https://api.github.com/repos/rwf2/Rocket/assignees{/user}","branches_url":"https://api.github.com/repos/rwf2/Rocket/branches{/branch}","tags_url":"https://api.github.com/repos/rwf2/Rocket/tags","blobs_url":"https://api.github.com/repos/rwf2/Rocket/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rwf2/Rocket/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rwf2/Rocket/git/refs{/sha}","trees_url":"https://api.github.com/repos/rwf2/Rocket/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rwf2/Rocket/statuses/{sha}","languages_url":"https://api.github.com/repos/rwf2/Rocket/languages","stargazers_url":"https://api.github.com/repos/rwf2/Rocket/stargazers","contributors_url":"https://api.github.com/repos/rwf2/Rocket/contributors","subscribers_url":"https://api.github.com/repos/rwf2/Rocket/subscribers","subscription_url":"https://api.github.com/repos/rwf2/Rocket/subscription","commits_url":"https://api.github.com/repos/rwf2/Rocket/commits{/sha}","git_commits_url":"https://api.github.com/repos/rwf2/Rocket/git/commits{/sha}","comments_url":"https://api.github.com/repos/rwf2/Rocket/comments{/number}","issue_comment_url":"https://api.github.com/repos/rwf2/Rocket/issues/comments{/number}","contents_url":"https://api.github.com/repos/rwf2/Rocket/contents/{+path}","compare_url":"https://api.github.com/repos/rwf2/Rocket/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rwf2/Rocket/merges","archive_url":"https://api.github.com/repos/rwf2/Rocket/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rwf2/Rocket/downloads","issues_url":"https://api.github.com/repos/rwf2/Rocket/issues{/number}","pulls_url":"https://api.github.com/repos/rwf2/Rocket/pulls{/number}","milestones_url":"https://api.github.com/repos/rwf2/Rocket/milestones{/number}","notifications_url":"https://api.github.com/repos/rwf2/Rocket/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rwf2/Rocket/labels{/name}","releases_url":"https://api.github.com/repos/rwf2/Rocket/releases{/id}","deployments_url":"https://api.github.com/repos/rwf2/Rocket/deployments","created_at":"2016-03-18T02:50:18Z","updated_at":"2025-11-09T18:27:08Z","pushed_at":"2025-10-01T04:53:46Z","git_url":"git://github.com/rwf2/Rocket.git","ssh_url":"git@github.com:rwf2/Rocket.git","clone_url":"https://github.com/rwf2/Rocket.git","svn_url":"https://github.com/rwf2/Rocket","homepage":"https://rocket.rs","size":8445,"stargazers_count":25480,"watchers_count":25480,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":1614,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":84,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["framework","rocket","rust","web","web-development","web-framework"],"visibility":"public","forks":1614,"open_issues":84,"watchers":25480,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/rwf2/Rocket/pulls/818","html_url":"https://github.com/rwf2/Rocket/pull/818","diff_url":"https://github.com/rwf2/Rocket/pull/818.diff","patch_url":"https://github.com/rwf2/Rocket/pull/818.patch","merged_at":null},"body":"Fixes #814 ","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rwf2/Rocket/issues/818/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":1956075844,"node_id":"MDExOkNsb3NlZEV2ZW50MTk1NjA3NTg0NA==","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/1956075844","actor":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"64ba2056ef3678152646483c28a20231ad7ae98d","commit_url":"https://api.github.com/repos/rwf2/Rocket/commits/64ba2056ef3678152646483c28a20231ad7ae98d","created_at":"2018-11-09T05:41:02Z","state_reason":null,"performed_via_github_app":null},{"actor":{"login":"nlydv","id":39429628,"node_id":"MDQ6VXNlcjM5NDI5NjI4","avatar_url":"https://avatars.githubusercontent.com/u/39429628?v=4","gravatar_id":"","url":"https://api.github.com/users/nlydv","html_url":"https://github.com/nlydv","followers_url":"https://api.github.com/users/nlydv/followers","following_url":"https://api.github.com/users/nlydv/following{/other_user}","gists_url":"https://api.github.com/users/nlydv/gists{/gist_id}","starred_url":"https://api.github.com/users/nlydv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nlydv/subscriptions","organizations_url":"https://api.github.com/users/nlydv/orgs","repos_url":"https://api.github.com/users/nlydv/repos","events_url":"https://api.github.com/users/nlydv/events{/privacy}","received_events_url":"https://api.github.com/users/nlydv/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-01-09T21:06:01Z","updated_at":"2023-01-09T21:06:01Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/2444","repository_url":"https://api.github.com/repos/rwf2/Rocket","labels_url":"https://api.github.com/repos/rwf2/Rocket/issues/2444/labels{/name}","comments_url":"https://api.github.com/repos/rwf2/Rocket/issues/2444/comments","events_url":"https://api.github.com/repos/rwf2/Rocket/issues/2444/events","html_url":"https://github.com/rwf2/Rocket/issues/2444","id":1526322624,"node_id":"I_kwDOAzqMt85a-dXA","number":2444,"title":"Async, tracked  local `Client` docs outdated on `Send` capability?","user":{"login":"nlydv","id":39429628,"node_id":"MDQ6VXNlcjM5NDI5NjI4","avatar_url":"https://avatars.githubusercontent.com/u/39429628?v=4","gravatar_id":"","url":"https://api.github.com/users/nlydv","html_url":"https://github.com/nlydv","followers_url":"https://api.github.com/users/nlydv/followers","following_url":"https://api.github.com/users/nlydv/following{/other_user}","gists_url":"https://api.github.com/users/nlydv/gists{/gist_id}","starred_url":"https://api.github.com/users/nlydv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nlydv/subscriptions","organizations_url":"https://api.github.com/users/nlydv/orgs","repos_url":"https://api.github.com/users/nlydv/repos","events_url":"https://api.github.com/users/nlydv/events{/privacy}","received_events_url":"https://api.github.com/users/nlydv/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-01-09T21:06:01Z","updated_at":"2023-01-11T17:55:21Z","closed_at":"2023-01-11T17:55:20Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":54168759,"node_id":"MDEwOlJlcG9zaXRvcnk1NDE2ODc1OQ==","name":"Rocket","full_name":"rwf2/Rocket","private":false,"owner":{"login":"rwf2","id":106361765,"node_id":"O_kgDOBlbzpQ","avatar_url":"https://avatars.githubusercontent.com/u/106361765?v=4","gravatar_id":"","url":"https://api.github.com/users/rwf2","html_url":"https://github.com/rwf2","followers_url":"https://api.github.com/users/rwf2/followers","following_url":"https://api.github.com/users/rwf2/following{/other_user}","gists_url":"https://api.github.com/users/rwf2/gists{/gist_id}","starred_url":"https://api.github.com/users/rwf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rwf2/subscriptions","organizations_url":"https://api.github.com/users/rwf2/orgs","repos_url":"https://api.github.com/users/rwf2/repos","events_url":"https://api.github.com/users/rwf2/events{/privacy}","received_events_url":"https://api.github.com/users/rwf2/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/rwf2/Rocket","description":"A web framework for Rust.","fork":false,"url":"https://api.github.com/repos/rwf2/Rocket","forks_url":"https://api.github.com/repos/rwf2/Rocket/forks","keys_url":"https://api.github.com/repos/rwf2/Rocket/keys{/key_id}","collaborators_url":"https://api.github.com/repos/rwf2/Rocket/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/rwf2/Rocket/teams","hooks_url":"https://api.github.com/repos/rwf2/Rocket/hooks","issue_events_url":"https://api.github.com/repos/rwf2/Rocket/issues/events{/number}","events_url":"https://api.github.com/repos/rwf2/Rocket/events","assignees_url":"https://api.github.com/repos/rwf2/Rocket/assignees{/user}","branches_url":"https://api.github.com/repos/rwf2/Rocket/branches{/branch}","tags_url":"https://api.github.com/repos/rwf2/Rocket/tags","blobs_url":"https://api.github.com/repos/rwf2/Rocket/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/rwf2/Rocket/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/rwf2/Rocket/git/refs{/sha}","trees_url":"https://api.github.com/repos/rwf2/Rocket/git/trees{/sha}","statuses_url":"https://api.github.com/repos/rwf2/Rocket/statuses/{sha}","languages_url":"https://api.github.com/repos/rwf2/Rocket/languages","stargazers_url":"https://api.github.com/repos/rwf2/Rocket/stargazers","contributors_url":"https://api.github.com/repos/rwf2/Rocket/contributors","subscribers_url":"https://api.github.com/repos/rwf2/Rocket/subscribers","subscription_url":"https://api.github.com/repos/rwf2/Rocket/subscription","commits_url":"https://api.github.com/repos/rwf2/Rocket/commits{/sha}","git_commits_url":"https://api.github.com/repos/rwf2/Rocket/git/commits{/sha}","comments_url":"https://api.github.com/repos/rwf2/Rocket/comments{/number}","issue_comment_url":"https://api.github.com/repos/rwf2/Rocket/issues/comments{/number}","contents_url":"https://api.github.com/repos/rwf2/Rocket/contents/{+path}","compare_url":"https://api.github.com/repos/rwf2/Rocket/compare/{base}...{head}","merges_url":"https://api.github.com/repos/rwf2/Rocket/merges","archive_url":"https://api.github.com/repos/rwf2/Rocket/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/rwf2/Rocket/downloads","issues_url":"https://api.github.com/repos/rwf2/Rocket/issues{/number}","pulls_url":"https://api.github.com/repos/rwf2/Rocket/pulls{/number}","milestones_url":"https://api.github.com/repos/rwf2/Rocket/milestones{/number}","notifications_url":"https://api.github.com/repos/rwf2/Rocket/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/rwf2/Rocket/labels{/name}","releases_url":"https://api.github.com/repos/rwf2/Rocket/releases{/id}","deployments_url":"https://api.github.com/repos/rwf2/Rocket/deployments","created_at":"2016-03-18T02:50:18Z","updated_at":"2025-11-09T18:27:08Z","pushed_at":"2025-10-01T04:53:46Z","git_url":"git://github.com/rwf2/Rocket.git","ssh_url":"git@github.com:rwf2/Rocket.git","clone_url":"https://github.com/rwf2/Rocket.git","svn_url":"https://github.com/rwf2/Rocket","homepage":"https://rocket.rs","size":8445,"stargazers_count":25480,"watchers_count":25480,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":true,"forks_count":1614,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":84,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["framework","rocket","rust","web","web-development","web-framework"],"visibility":"public","forks":1614,"open_issues":84,"watchers":25480,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Hi there, I’m currently looking into Rocket’s `local` module and there *appears* to be some divergence with the documented guidance regarding `Client` and its async cookie tracking functionality.\r\n\r\nSpecifically:\r\n\r\nhttps://github.com/SergioBenitez/Rocket/blob/162fafa0f1b5d9045bf342356671859f0f21c4cc/core/lib/src/local/asynchronous/client.rs#L15-L30\r\n\r\nWhen looking into the source code for further information though, I saw that the tracked `CookieJar` was protected by a parking_lot `RwLock`, which shouldn’t (in and of itself) raise multi-threaded synchronization concerns.\r\n\r\nIndeed, after rummaging through the issues/PRs it looks like commit https://github.com/SergioBenitez/Rocket/commit/64ba2056ef3678152646483c28a20231ad7ae98d implemented the `RwLock` as a fix to the non-`Send` behavior brought up in issue #814.\r\n\r\nSo I just wanted to confirm whether the documented warnings about multi-threaded `Client` tracking really are just outdated. Assuming that is the case, it’d be good to update those docs with current information.\r\n\r\nIf there are other reasons that make async cookie tracking non-deterministic that I’m not aware of however, I’d be interested in learning more about why that may be.\r\n\r\nThanks in advance!","reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/2444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rwf2/Rocket/issues/2444/timeline","performed_via_github_app":null,"state_reason":"completed"}},"event":"cross-referenced"},{"id":13766682284,"node_id":"REFE_lADOAzqMt84WfEGNzwAAAAM0juas","url":"https://api.github.com/repos/rwf2/Rocket/issues/events/13766682284","actor":{"login":"Eijebong","id":3650385,"node_id":"MDQ6VXNlcjM2NTAzODU=","avatar_url":"https://avatars.githubusercontent.com/u/3650385?v=4","gravatar_id":"","url":"https://api.github.com/users/Eijebong","html_url":"https://github.com/Eijebong","followers_url":"https://api.github.com/users/Eijebong/followers","following_url":"https://api.github.com/users/Eijebong/following{/other_user}","gists_url":"https://api.github.com/users/Eijebong/gists{/gist_id}","starred_url":"https://api.github.com/users/Eijebong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Eijebong/subscriptions","organizations_url":"https://api.github.com/users/Eijebong/orgs","repos_url":"https://api.github.com/users/Eijebong/repos","events_url":"https://api.github.com/users/Eijebong/events{/privacy}","received_events_url":"https://api.github.com/users/Eijebong/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"64ba2056ef3678152646483c28a20231ad7ae98d","commit_url":"https://api.github.com/repos/Eijebong/Rocket/commits/64ba2056ef3678152646483c28a20231ad7ae98d","created_at":"2024-08-05T16:10:38Z","performed_via_github_app":null}]