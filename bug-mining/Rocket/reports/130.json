{"url":"https://api.github.com/repos/rwf2/Rocket/issues/852","repository_url":"https://api.github.com/repos/rwf2/Rocket","labels_url":"https://api.github.com/repos/rwf2/Rocket/issues/852/labels{/name}","comments_url":"https://api.github.com/repos/rwf2/Rocket/issues/852/comments","events_url":"https://api.github.com/repos/rwf2/Rocket/issues/852/events","html_url":"https://github.com/rwf2/Rocket/issues/852","id":389061706,"node_id":"MDU6SXNzdWUzODkwNjE3MDY=","number":852,"title":"Revamp Configuration","user":{"login":"svenstaro","id":1664,"node_id":"MDQ6VXNlcjE2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1664?v=4","gravatar_id":"","url":"https://api.github.com/users/svenstaro","html_url":"https://github.com/svenstaro","followers_url":"https://api.github.com/users/svenstaro/followers","following_url":"https://api.github.com/users/svenstaro/following{/other_user}","gists_url":"https://api.github.com/users/svenstaro/gists{/gist_id}","starred_url":"https://api.github.com/users/svenstaro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/svenstaro/subscriptions","organizations_url":"https://api.github.com/users/svenstaro/orgs","repos_url":"https://api.github.com/users/svenstaro/repos","events_url":"https://api.github.com/users/svenstaro/events{/privacy}","received_events_url":"https://api.github.com/users/svenstaro/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":343542068,"node_id":"MDU6TGFiZWwzNDM1NDIwNjg=","url":"https://api.github.com/repos/rwf2/Rocket/labels/enhancement","name":"enhancement","color":"5319E7","default":true,"description":"A minor feature request"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/rwf2/Rocket/milestones/8","html_url":"https://github.com/rwf2/Rocket/milestone/8","labels_url":"https://api.github.com/repos/rwf2/Rocket/milestones/8/labels","id":2300325,"node_id":"MDk6TWlsZXN0b25lMjMwMDMyNQ==","number":8,"title":"0.5.0","description":null,"creator":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":43,"state":"open","created_at":"2017-02-05T07:58:22Z","updated_at":"2023-04-05T18:18:52Z","due_on":null,"closed_at":null},"comments":9,"created_at":"2018-12-09T20:40:04Z","updated_at":"2020-10-21T02:28:29Z","closed_at":"2020-10-21T02:27:34Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"As per discussion on IRC, I think the config file handling should be revamped. The current three fixed environment system doesn't scale and if you need more you have to work around that limit. That's not nice. Also, the current extras aren't typed and are cumbersome to use.\r\n\r\nBelow are some general goals that a new system should fulfill.\r\n\r\n## Goals\r\n\r\n- [x] Get rid of the current rigid enum `Environment` structure.\r\n- [x] Allow the config to be provided via environment variables, a single config file, separate config files, or plain code.\r\n- [x] Allow for default environments still but you should easily be able to define your own set of environments.\r\n- [x] Allow for strongly typed user configs (instead of the current `extras`).\r\n\r\n## Considerations\r\n\r\n- Maybe use [config-rs](https://github.com/mehcode/config-rs)?\r\n- The current three environments fulfill the purposes of providing a bunch of defaults as well as safety checks. If we get rid of those rigid environments and if the environment are dynamic, it won't be possible to do this for a specific pre-defined environment anymore. Therefore, in order to keep a safety switch on by default, I propose we make everything safe by default. For local development (and perhaps tests and such) where we don't care about safe defaults, we can have a `ROCKET_DEBUG` env var. Since the configs are isomorphic, this will translate to `config.debug` in code.\r\n- Generally speaking, I don't think we should be talking about _Rocket_ configuration but about _app_ configuration and Rocket should then just be able to take what it needs from the app configuration.\r\n\r\n  Currently the user is supposed to stuff all of their custom config into Rocket like it's a weird thing to have extra config. I think this is the wrong way around. Rather than that, there should some general app config and Rocket should just take from that whatever it needs (like port, address, etc). For instance, if we provided a TOML config file, we might have this in our new, Rocket-unspecific `app.toml`:\r\n\r\n  ```\r\n  [general]\r\n  app_name = \"hello\"\r\n  twitter_api_key = \"something\"\r\n\r\n  [rocket]\r\n  address = \"0.0.0.0\"\r\n  port = 8080\r\n  ```\r\n\r\n  This illustration obviously glances over the problem with environments but it's how I imagine this to work. Likewise, if we're talking about environment variables, the above example would look like this:\r\n\r\n  ```\r\n  APP_NAME=\"hello\"\r\n  TWITTER_API_KEY=\"something\"\r\n  ROCKET_ADDRESS=\"0.0.0.0\"\r\n  ROCKET_PORT=8080\r\n  ```\r\n- Provide sane default environments and stay compatible with the current solution by having `rocket::ignite()` do essentially the same thing as now but then also have `rocket::ignite_with_config(???)` which would allow for custom configuration. I'm not quite sure what to pass in there yet as I do not just want it to be a single file of some sort. Perhaps a `HashMap` as provided by config-rs?\r\n\r\n## Past discussions\r\n\r\nThis issue takes some inspiration from #145 and #317. There are also #290 and #677 which would be addressed by this.","closed_by":{"login":"SergioBenitez","id":1480321,"node_id":"MDQ6VXNlcjE0ODAzMjE=","avatar_url":"https://avatars.githubusercontent.com/u/1480321?v=4","gravatar_id":"","url":"https://api.github.com/users/SergioBenitez","html_url":"https://github.com/SergioBenitez","followers_url":"https://api.github.com/users/SergioBenitez/followers","following_url":"https://api.github.com/users/SergioBenitez/following{/other_user}","gists_url":"https://api.github.com/users/SergioBenitez/gists{/gist_id}","starred_url":"https://api.github.com/users/SergioBenitez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergioBenitez/subscriptions","organizations_url":"https://api.github.com/users/SergioBenitez/orgs","repos_url":"https://api.github.com/users/SergioBenitez/repos","events_url":"https://api.github.com/users/SergioBenitez/events{/privacy}","received_events_url":"https://api.github.com/users/SergioBenitez/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/rwf2/Rocket/issues/852/reactions","total_count":13,"+1":13,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/rwf2/Rocket/issues/852/timeline","performed_via_github_app":null,"state_reason":"completed"}