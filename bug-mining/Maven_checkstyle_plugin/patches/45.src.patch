diff --git a/src/main/java/org/apache/maven/plugin/checkstyle/DefaultCheckstyleExecutor.java b/src/main/java/org/apache/maven/plugin/checkstyle/DefaultCheckstyleExecutor.java
index 94ab0f7..934bf42 100644
--- a/src/main/java/org/apache/maven/plugin/checkstyle/DefaultCheckstyleExecutor.java
+++ b/src/main/java/org/apache/maven/plugin/checkstyle/DefaultCheckstyleExecutor.java
@@ -108,8 +108,6 @@ public class DefaultCheckstyleExecutor
         List<String> outputDirectories = new ArrayList<String>();
         File sourceDirectory = request.getSourceDirectory();
         File testSourceDirectory = request.getTestSourceDirectory();
-        prepareCheckstylePaths( request, project, classPathStrings, outputDirectories, sourceDirectory,
-                                testSourceDirectory );
         if ( request.isAggregate() )
         {
             for ( MavenProject childProject : request.getReactorProjects() )
@@ -119,6 +117,11 @@ public class DefaultCheckstyleExecutor
                                         new File( childProject.getBuild().getTestSourceDirectory() ) );
             }
         }
+        else
+        {
+            prepareCheckstylePaths( request, project, classPathStrings, outputDirectories, sourceDirectory,
+                                    testSourceDirectory );
+        }
 
         List<URL> urls = new ArrayList<URL>( classPathStrings.size() );
 
@@ -182,7 +185,6 @@ public class DefaultCheckstyleExecutor
         }
 
         CheckstyleReportListener sinkListener = new CheckstyleReportListener( configuration );
-        addSourceDirectory( sinkListener, sourceDirectory, testSourceDirectory, request );
         if ( request.isAggregate() )
         {
             for ( MavenProject childProject : request.getReactorProjects() )
@@ -191,6 +193,10 @@ public class DefaultCheckstyleExecutor
                                     new File( childProject.getBuild().getSourceDirectory() ), request );
             }
         }
+        else
+        {
+            addSourceDirectory( sinkListener, sourceDirectory, testSourceDirectory, request );
+        }
 
         checker.addListener( sinkListener );
 
@@ -475,7 +481,6 @@ public class DefaultCheckstyleExecutor
         File sourceDirectory = request.getSourceDirectory();
 
         List<File> files = new ArrayList<File>();
-        addFilesToProcess( request, excludesStr, sourceDirectory, files );
         if ( request.isAggregate() )
         {
             for ( MavenProject project : request.getReactorProjects() )
@@ -483,6 +488,10 @@ public class DefaultCheckstyleExecutor
                 addFilesToProcess( request, excludesStr, new File( project.getBuild().getSourceDirectory() ), files );
             }
         }
+        else
+        {
+            addFilesToProcess( request, excludesStr, sourceDirectory, files );
+        }
 
         return (File[]) files.toArray( EMPTY_FILE_ARRAY );
     }
