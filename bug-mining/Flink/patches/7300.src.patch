diff --git a/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/hybrid/HybridSourceSplitEnumerator.java b/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/hybrid/HybridSourceSplitEnumerator.java
index 17c70ebbdc4..3cba9635d83 100644
--- a/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/hybrid/HybridSourceSplitEnumerator.java
+++ b/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/hybrid/HybridSourceSplitEnumerator.java
@@ -40,6 +40,7 @@ import java.util.HashMap;
 import java.util.HashSet;
 import java.util.List;
 import java.util.Map;
+import java.util.Objects;
 import java.util.Set;
 import java.util.TreeMap;
 import java.util.concurrent.Callable;
@@ -361,7 +362,7 @@ public class HybridSourceSplitEnumerator
             }
             Integer lastIndex = null;
             for (Integer sourceIndex : readerSourceIndex.values()) {
-                if (lastIndex != null && lastIndex != sourceIndex) {
+                if (lastIndex != null && !lastIndex.equals(sourceIndex)) {
                     return filterRegisteredReaders(readers);
                 }
                 lastIndex = sourceIndex;
@@ -372,7 +373,7 @@ public class HybridSourceSplitEnumerator
         private Map<Integer, ReaderInfo> filterRegisteredReaders(Map<Integer, ReaderInfo> readers) {
             Map<Integer, ReaderInfo> readersForSource = new HashMap<>(readers.size());
             for (Map.Entry<Integer, ReaderInfo> e : readers.entrySet()) {
-                if (readerSourceIndex.get(e.getKey()) == (Integer) sourceIndex) {
+                if (Objects.equals(readerSourceIndex.get(e.getKey()), sourceIndex)) {
                     readersForSource.put(e.getKey(), e.getValue());
                 }
             }
diff --git a/flink-connectors/flink-connector-base/src/test/java/org/apache/flink/connector/base/source/hybrid/HybridSourceSplitEnumeratorTest.java b/flink-connectors/flink-connector-base/src/test/java/org/apache/flink/connector/base/source/hybrid/HybridSourceSplitEnumeratorTest.java
index 8b068d645b6..c657ba583e0 100644
--- a/flink-connectors/flink-connector-base/src/test/java/org/apache/flink/connector/base/source/hybrid/HybridSourceSplitEnumeratorTest.java
+++ b/flink-connectors/flink-connector-base/src/test/java/org/apache/flink/connector/base/source/hybrid/HybridSourceSplitEnumeratorTest.java
@@ -88,6 +88,62 @@ public class HybridSourceSplitEnumeratorTest {
         assertThat(getCurrentSourceIndex(enumerator)).as("reader without assignment").isEqualTo(1);
     }
 
+    @Test
+    public void testHighCardinalitySources() {
+        context = new MockSplitEnumeratorContext<>(2);
+        HybridSource.HybridSourceBuilder<Integer, MockSplitEnumerator> hybridSourceBuilder =
+                HybridSource.builder(MOCK_SOURCE);
+        final int maxSources = 130;
+        for (int i = 1; i < maxSources; i++) {
+            hybridSourceBuilder = hybridSourceBuilder.addSource(MOCK_SOURCE);
+        }
+        source = hybridSourceBuilder.build();
+        enumerator = (HybridSourceSplitEnumerator) source.createEnumerator(context);
+        enumerator.start();
+        // mock enumerator assigns splits once all readers are registered
+        registerReader(context, enumerator, SUBTASK0);
+        assertThat(context.getSplitsAssignmentSequence()).isEmpty();
+        registerReader(context, enumerator, SUBTASK1);
+        assertThat(context.getSplitsAssignmentSequence()).isEmpty();
+        enumerator.handleSourceEvent(SUBTASK0, new SourceReaderFinishedEvent(-1));
+        assertThat(context.getSplitsAssignmentSequence()).isEmpty();
+        enumerator.handleSourceEvent(SUBTASK1, new SourceReaderFinishedEvent(-1));
+        assertThat(context.getSplitsAssignmentSequence()).hasSize(1);
+        splitFromSource0 =
+                context.getSplitsAssignmentSequence().get(0).assignment().get(SUBTASK0).get(0);
+        assertThat(splitFromSource0.sourceIndex()).isEqualTo(0);
+        assertThat(getCurrentSourceIndex(enumerator)).isEqualTo(0);
+
+        for (int i = 0; i < maxSources; i++) {
+            enumerator.handleSourceEvent(SUBTASK0, new SourceReaderFinishedEvent(i));
+            assertThat(getCurrentSourceIndex(enumerator)).as("one reader finished").isEqualTo(i);
+            enumerator.handleSourceEvent(SUBTASK1, new SourceReaderFinishedEvent(i));
+            if (i < maxSources - 1) {
+                assertThat(getCurrentSourceIndex(enumerator))
+                        .as("both readers finished")
+                        .isEqualTo(i + 1);
+                assertThat(context.getSplitsAssignmentSequence())
+                        .as("switch triggers split assignment")
+                        .hasSize(i + 2);
+                splitFromSource1 =
+                        context.getSplitsAssignmentSequence()
+                                .get(i)
+                                .assignment()
+                                .get(SUBTASK0)
+                                .get(0);
+                assertThat(splitFromSource1.sourceIndex()).isEqualTo(i);
+            } else {
+                assertThat(getCurrentSourceIndex(enumerator))
+                        .as("both readers finished")
+                        .isEqualTo(maxSources - 1);
+            }
+        }
+        enumerator.handleSourceEvent(SUBTASK1, new SourceReaderFinishedEvent(SUBTASK1));
+        assertThat(getCurrentSourceIndex(enumerator))
+                .as("reader without assignment")
+                .isEqualTo(maxSources - 1);
+    }
+
     @Test
     public void testRegisterReaderAfterSwitchAndReaderReset() {
         setupEnumeratorAndTriggerSourceSwitch();
