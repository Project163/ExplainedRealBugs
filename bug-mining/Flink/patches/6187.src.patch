diff --git a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/UnnestITCase.scala b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/UnnestITCase.scala
index 5a684e5f719..3072bb4771f 100644
--- a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/UnnestITCase.scala
+++ b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/UnnestITCase.scala
@@ -16,7 +16,7 @@
  * limitations under the License.
  */
 
-package org.apache.flink.table.runtime.batch.sql
+package org.apache.flink.table.planner.runtime.batch.sql
 
 import org.apache.flink.api.java.typeutils.{ObjectArrayTypeInfo, RowTypeInfo}
 import org.apache.flink.table.api.Types
@@ -251,4 +251,22 @@ class UnnestITCase extends BatchTestBase {
     )
   }
 
+  @Test
+  def testUnnestMapWithDifferentKeyValueType(): Unit = {
+    val data = List(
+      row(1, Map("a" -> 10, "b" -> 11).asJava),
+      row(2, Map("c" -> 20, "d" -> 21).asJava)
+    )
+
+    registerCollection("T", data,
+      new RowTypeInfo(Types.INT, Types.MAP(Types.STRING, Types.INT)),
+      "a, b")
+
+    checkResult(
+      "SELECT a, k, v FROM T, UNNEST(T.b) as A(k, v)",
+      Seq(row(1, "a", 10), row(1, "b", 11), row(2, "c", 20),
+        row(2, "d", 21))
+    )
+  }
+
 }
diff --git a/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/functions/SqlUnnestUtils.java b/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/functions/SqlUnnestUtils.java
index 4286d010b9a..1b5c6a4af3c 100644
--- a/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/functions/SqlUnnestUtils.java
+++ b/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/functions/SqlUnnestUtils.java
@@ -61,7 +61,7 @@ public final class SqlUnnestUtils {
                         mapType,
                         RowType.of(false, mapType.getKeyType(), mapType.getValueType()),
                         ArrayData.createElementGetter(mapType.getKeyType()),
-                        ArrayData.createElementGetter(mapType.getKeyType()));
+                        ArrayData.createElementGetter(mapType.getValueType()));
             default:
                 throw new UnsupportedOperationException("Unsupported type for UNNEST: " + t);
         }
