diff --git a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/FactoryUtil.java b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/FactoryUtil.java
index 426610f10dd..801c209d6fd 100644
--- a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/FactoryUtil.java
+++ b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/FactoryUtil.java
@@ -262,8 +262,8 @@ public final class FactoryUtil {
 					"%s",
 					factoryIdentifier,
 					factoryClass.getName(),
-					foundFactories.stream()
-						.map(f -> factories.getClass().getName())
+					matchingFactories.stream()
+						.map(f -> f.getClass().getName())
 						.sorted()
 						.collect(Collectors.joining("\n"))));
 		}
@@ -383,7 +383,7 @@ public final class FactoryUtil {
 		} catch (ValidationException e) {
 			return new ValidationException(
 				String.format(
-					"Cannot discover a connector using option '%s'.",
+					"Cannot discover a connector using option: %s",
 					stringifyOption(CONNECTOR.key(), connectorOption)),
 				e);
 		}
diff --git a/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/FactoryUtilTest.java b/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/FactoryUtilTest.java
index a72bf32a9ea..492d4fbe572 100644
--- a/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/FactoryUtilTest.java
+++ b/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/FactoryUtilTest.java
@@ -67,10 +67,21 @@ public class FactoryUtilTest {
 			"Could not find any factory for identifier 'FAIL' that implements '" +
 				DynamicTableFactory.class.getName() + "' in the classpath.\n\n" +
 			"Available factory identifiers are:\n\n" +
-			"sink-only\nsource-only\ntest\ntest-connector");
+			"conflicting\nsink-only\nsource-only\ntest\ntest-connector");
 		testError(options -> options.put("connector", "FAIL"));
 	}
 
+	@Test
+	public void testConflictingConnector() {
+		expectError(
+			"Multiple factories for identifier 'conflicting' that implement '"
+				+ DynamicTableFactory.class.getName() + "' found in the classpath.\n"
+				+ "\n" + "Ambiguous factory classes are:\n" + "\n"
+				+ TestConflictingDynamicTableFactory1.class.getName() + "\n"
+				+ TestConflictingDynamicTableFactory2.class.getName());
+		testError(options -> options.put("connector", TestConflictingDynamicTableFactory1.IDENTIFIER));
+	}
+
 	@Test
 	public void testMissingConnectorOption() {
 		expectError(
diff --git a/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/TestConflictingDynamicTableFactory1.java b/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/TestConflictingDynamicTableFactory1.java
new file mode 100644
index 00000000000..5a93cbae909
--- /dev/null
+++ b/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/TestConflictingDynamicTableFactory1.java
@@ -0,0 +1,59 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.table.factories;
+
+import org.apache.flink.configuration.ConfigOption;
+import org.apache.flink.table.connector.sink.DynamicTableSink;
+import org.apache.flink.table.connector.source.DynamicTableSource;
+
+import java.util.Collections;
+import java.util.Set;
+
+/**
+ * {@link DynamicTableFactory} that conflicts with {@link TestConflictingDynamicTableFactory2}.
+ */
+public class TestConflictingDynamicTableFactory1 implements DynamicTableSourceFactory, DynamicTableSinkFactory {
+
+	public static final String IDENTIFIER = "conflicting";
+
+	@Override
+	public DynamicTableSink createDynamicTableSink(Context context) {
+		throw new UnsupportedOperationException();
+	}
+
+	@Override
+	public DynamicTableSource createDynamicTableSource(Context context) {
+		throw new UnsupportedOperationException();
+	}
+
+	@Override
+	public String factoryIdentifier() {
+		return IDENTIFIER;
+	}
+
+	@Override
+	public Set<ConfigOption<?>> requiredOptions() {
+		return Collections.emptySet();
+	}
+
+	@Override
+	public Set<ConfigOption<?>> optionalOptions() {
+		return Collections.emptySet();
+	}
+}
diff --git a/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/TestConflictingDynamicTableFactory2.java b/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/TestConflictingDynamicTableFactory2.java
new file mode 100644
index 00000000000..126aae3d265
--- /dev/null
+++ b/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/TestConflictingDynamicTableFactory2.java
@@ -0,0 +1,57 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.table.factories;
+
+import org.apache.flink.configuration.ConfigOption;
+import org.apache.flink.table.connector.sink.DynamicTableSink;
+import org.apache.flink.table.connector.source.DynamicTableSource;
+
+import java.util.Collections;
+import java.util.Set;
+
+/**
+ * {@link DynamicTableFactory} that conflicts with {@link TestConflictingDynamicTableFactory1}.
+ */
+public class TestConflictingDynamicTableFactory2 implements DynamicTableSourceFactory, DynamicTableSinkFactory {
+
+	@Override
+	public DynamicTableSink createDynamicTableSink(Context context) {
+		throw new UnsupportedOperationException();
+	}
+
+	@Override
+	public DynamicTableSource createDynamicTableSource(Context context) {
+		throw new UnsupportedOperationException();
+	}
+
+	@Override
+	public String factoryIdentifier() {
+		return TestConflictingDynamicTableFactory1.IDENTIFIER;
+	}
+
+	@Override
+	public Set<ConfigOption<?>> requiredOptions() {
+		return Collections.emptySet();
+	}
+
+	@Override
+	public Set<ConfigOption<?>> optionalOptions() {
+		return Collections.emptySet();
+	}
+}
diff --git a/flink-table/flink-table-common/src/test/resources/META-INF/services/org.apache.flink.table.factories.Factory b/flink-table/flink-table-common/src/test/resources/META-INF/services/org.apache.flink.table.factories.Factory
index f3d6dce7e02..9c66d01e91d 100644
--- a/flink-table/flink-table-common/src/test/resources/META-INF/services/org.apache.flink.table.factories.Factory
+++ b/flink-table/flink-table-common/src/test/resources/META-INF/services/org.apache.flink.table.factories.Factory
@@ -19,3 +19,5 @@ org.apache.flink.table.factories.TestDynamicTableSourceFactory
 org.apache.flink.table.factories.TestDynamicTableSinkFactory
 org.apache.flink.table.factories.TestDynamicTableSinkOnlyFactory
 org.apache.flink.table.factories.TestDynamicTableSourceOnlyFactory
+org.apache.flink.table.factories.TestConflictingDynamicTableFactory1
+org.apache.flink.table.factories.TestConflictingDynamicTableFactory2
