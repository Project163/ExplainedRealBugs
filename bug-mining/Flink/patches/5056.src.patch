diff --git a/flink-metrics/flink-metrics-core/src/main/java/org/apache/flink/metrics/ThresholdMeter.java b/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/ThresholdMeter.java
similarity index 82%
rename from flink-metrics/flink-metrics-core/src/main/java/org/apache/flink/metrics/ThresholdMeter.java
rename to flink-runtime/src/main/java/org/apache/flink/runtime/metrics/ThresholdMeter.java
index bd6e5421b68..bd4f57c2b44 100644
--- a/flink-metrics/flink-metrics-core/src/main/java/org/apache/flink/metrics/ThresholdMeter.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/ThresholdMeter.java
@@ -16,7 +16,12 @@
  * limitations under the License.
  */
 
-package org.apache.flink.metrics;
+package org.apache.flink.runtime.metrics;
+
+import org.apache.flink.annotation.VisibleForTesting;
+import org.apache.flink.metrics.Meter;
+import org.apache.flink.util.clock.Clock;
+import org.apache.flink.util.clock.SystemClock;
 
 import java.time.Duration;
 import java.util.ArrayDeque;
@@ -25,12 +30,19 @@ import java.util.Queue;
 /** A timestamp queue based threshold meter. */
 public class ThresholdMeter implements Meter {
     private static final double MILLISECONDS_PER_SECOND = 1000.0;
+    private final Clock clock;
     private final double maxEventsPerInterval;
     private final Duration interval;
     private final Queue<Long> eventTimestamps;
     private long eventCount = 0;
 
     public ThresholdMeter(double maxEventsPerInterval, Duration interval) {
+        this(maxEventsPerInterval, interval, SystemClock.getInstance());
+    }
+
+    @VisibleForTesting
+    public ThresholdMeter(double maxEventsPerInterval, Duration interval, Clock clock) {
+        this.clock = clock;
         this.maxEventsPerInterval = maxEventsPerInterval;
         this.interval = interval;
         this.eventTimestamps = new ArrayDeque<>();
@@ -41,13 +53,13 @@ public class ThresholdMeter implements Meter {
 
     @Override
     public void markEvent() {
-        eventTimestamps.add(System.currentTimeMillis());
+        eventTimestamps.add(clock.absoluteTimeMillis());
         eventCount++;
     }
 
     @Override
     public void markEvent(long n) {
-        long timestamp = System.currentTimeMillis();
+        long timestamp = clock.absoluteTimeMillis();
         for (int i = 0; i < n; i++) {
             eventTimestamps.add(timestamp);
         }
@@ -74,7 +86,7 @@ public class ThresholdMeter implements Meter {
     }
 
     private int getEventCountsRecentInterval() {
-        Long currentTimeStamp = System.currentTimeMillis();
+        Long currentTimeStamp = clock.absoluteTimeMillis();
         while (!eventTimestamps.isEmpty()
                 && currentTimeStamp - eventTimestamps.peek() > interval.toMillis()) {
             eventTimestamps.remove();
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManager.java b/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManager.java
index 6b5c09d6b0a..f9c9a90da29 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManager.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManager.java
@@ -21,7 +21,6 @@ package org.apache.flink.runtime.resourcemanager.active;
 import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.api.common.time.Time;
 import org.apache.flink.configuration.Configuration;
-import org.apache.flink.metrics.ThresholdMeter;
 import org.apache.flink.runtime.akka.AkkaUtils;
 import org.apache.flink.runtime.clusterframework.ApplicationStatus;
 import org.apache.flink.runtime.clusterframework.TaskExecutorProcessSpec;
@@ -35,6 +34,7 @@ import org.apache.flink.runtime.heartbeat.HeartbeatServices;
 import org.apache.flink.runtime.highavailability.HighAvailabilityServices;
 import org.apache.flink.runtime.io.network.partition.ResourceManagerPartitionTrackerFactory;
 import org.apache.flink.runtime.metrics.MetricNames;
+import org.apache.flink.runtime.metrics.ThresholdMeter;
 import org.apache.flink.runtime.metrics.groups.ResourceManagerMetricGroup;
 import org.apache.flink.runtime.resourcemanager.JobLeaderIdService;
 import org.apache.flink.runtime.resourcemanager.ResourceManager;
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManagerFactory.java b/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManagerFactory.java
index c65d3972bdf..10ceb4e7443 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManagerFactory.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManagerFactory.java
@@ -22,7 +22,6 @@ import org.apache.flink.configuration.Configuration;
 import org.apache.flink.configuration.IllegalConfigurationException;
 import org.apache.flink.configuration.ResourceManagerOptions;
 import org.apache.flink.configuration.TaskManagerOptions;
-import org.apache.flink.metrics.ThresholdMeter;
 import org.apache.flink.runtime.clusterframework.TaskExecutorProcessUtils;
 import org.apache.flink.runtime.clusterframework.types.ResourceID;
 import org.apache.flink.runtime.clusterframework.types.ResourceIDRetrievable;
@@ -31,6 +30,7 @@ import org.apache.flink.runtime.heartbeat.HeartbeatServices;
 import org.apache.flink.runtime.highavailability.HighAvailabilityServices;
 import org.apache.flink.runtime.io.network.partition.ResourceManagerPartitionTrackerImpl;
 import org.apache.flink.runtime.metrics.MetricRegistry;
+import org.apache.flink.runtime.metrics.ThresholdMeter;
 import org.apache.flink.runtime.metrics.groups.ResourceManagerMetricGroup;
 import org.apache.flink.runtime.resourcemanager.ResourceManager;
 import org.apache.flink.runtime.resourcemanager.ResourceManagerFactory;
diff --git a/flink-metrics/flink-metrics-core/src/test/java/org/apache/flink/metrics/ThresholdMeterTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/metrics/ThresholdMeterTest.java
similarity index 80%
rename from flink-metrics/flink-metrics-core/src/test/java/org/apache/flink/metrics/ThresholdMeterTest.java
rename to flink-runtime/src/test/java/org/apache/flink/runtime/metrics/ThresholdMeterTest.java
index 3562a70173e..105809365fb 100644
--- a/flink-metrics/flink-metrics-core/src/test/java/org/apache/flink/metrics/ThresholdMeterTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/metrics/ThresholdMeterTest.java
@@ -16,14 +16,17 @@
  * limitations under the License.
  */
 
-package org.apache.flink.metrics;
+package org.apache.flink.runtime.metrics;
 
-import org.apache.flink.metrics.ThresholdMeter.ThresholdExceedException;
+import org.apache.flink.runtime.metrics.ThresholdMeter.ThresholdExceedException;
 import org.apache.flink.util.TestLogger;
+import org.apache.flink.util.clock.ManualClock;
 
+import org.junit.Before;
 import org.junit.Test;
 
 import java.time.Duration;
+import java.util.concurrent.TimeUnit;
 
 import static org.hamcrest.Matchers.closeTo;
 import static org.hamcrest.Matchers.is;
@@ -35,18 +38,28 @@ public class ThresholdMeterTest extends TestLogger {
     private static final double THRESHOLD_LARGE = 1000.0;
     private static final double THRESHOLD_SMALL = 5.0;
     private static final Duration INTERVAL = Duration.ofMillis(50);
+    private static final long SLEEP = 10;
     private static final double ERROR = 1e-6;
 
+    private static ManualClock clock;
+
+    @Before
+    public void setup() {
+        clock = new ManualClock(42_000_000);
+    }
+
     @Test
     public void testMarkEvent() {
         final ThresholdMeter thresholdMeter = createLargeThresholdMeter();
 
         thresholdMeter.markEvent();
+        clock.advanceTime(SLEEP, TimeUnit.MILLISECONDS);
         assertThat(thresholdMeter.getCount(), is(1L));
         assertThat(thresholdMeter.getRate(), closeTo(toPerSecondRate(1), ERROR));
 
         thresholdMeter.markEvent();
         assertThat(thresholdMeter.getCount(), is(2L));
+        clock.advanceTime(SLEEP, TimeUnit.MILLISECONDS);
         assertThat(thresholdMeter.getRate(), closeTo(toPerSecondRate(2), ERROR));
     }
 
@@ -54,6 +67,7 @@ public class ThresholdMeterTest extends TestLogger {
     public void testMarkMultipleEvents() {
         final ThresholdMeter thresholdMeter = createLargeThresholdMeter();
         thresholdMeter.markEvent(2);
+        clock.advanceTime(SLEEP * 2, TimeUnit.MILLISECONDS);
         assertThat(thresholdMeter.getCount(), is(2L));
         assertThat(thresholdMeter.getRate(), closeTo(toPerSecondRate(2), ERROR));
     }
@@ -63,6 +77,7 @@ public class ThresholdMeterTest extends TestLogger {
         final ThresholdMeter thresholdMeter = createSmallThresholdMeter();
         for (int i = 0; i < THRESHOLD_SMALL - 1; ++i) {
             thresholdMeter.markEvent();
+            clock.advanceTime(SLEEP, TimeUnit.MILLISECONDS);
             thresholdMeter.checkAgainstThreshold();
         }
     }
@@ -74,6 +89,7 @@ public class ThresholdMeterTest extends TestLogger {
         // first THRESHOLD_SMALL - 1 events should not exceed threshold
         for (int i = 0; i < THRESHOLD_SMALL - 1; ++i) {
             thresholdMeter.markEvent();
+            clock.advanceTime(SLEEP, TimeUnit.MILLISECONDS);
             thresholdMeter.checkAgainstThreshold();
         }
 
@@ -88,11 +104,11 @@ public class ThresholdMeterTest extends TestLogger {
     }
 
     @Test
-    public void testUpdateInterval() throws InterruptedException {
+    public void testUpdateInterval() {
         final ThresholdMeter thresholdMeter = createSmallThresholdMeter();
 
         thresholdMeter.markEvent();
-        Thread.sleep(INTERVAL.toMillis() * 2);
+        clock.advanceTime(INTERVAL.toMillis() * 2, TimeUnit.MILLISECONDS);
 
         for (int i = 0; i < THRESHOLD_SMALL - 1; ++i) {
             thresholdMeter.markEvent();
@@ -106,11 +122,11 @@ public class ThresholdMeterTest extends TestLogger {
     }
 
     private static ThresholdMeter createLargeThresholdMeter() {
-        return new ThresholdMeter(THRESHOLD_LARGE, INTERVAL);
+        return new ThresholdMeter(THRESHOLD_LARGE, INTERVAL, clock);
     }
 
     private static ThresholdMeter createSmallThresholdMeter() {
-        return new ThresholdMeter(THRESHOLD_SMALL, INTERVAL);
+        return new ThresholdMeter(THRESHOLD_SMALL, INTERVAL, clock);
     }
 
     private static double toPerSecondRate(int eventsPerInterval) {
