diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorage.java b/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorage.java
index e148dfb7ac3..af80af7ac7f 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorage.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorage.java
@@ -126,7 +126,7 @@ public class FsCheckpointStorage extends AbstractFsCheckpointStorage {
 			final Path path = decodePathFromReference(reference);
 
 			return new FsCheckpointStorageLocation(
-					fileSystem,
+					path.getFileSystem(),
 					path,
 					path,
 					path,
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorageLocation.java b/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorageLocation.java
index 469507a004b..5637b40db3f 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorageLocation.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorageLocation.java
@@ -18,6 +18,7 @@
 
 package org.apache.flink.runtime.state.filesystem;
 
+import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.core.fs.FileSystem;
 import org.apache.flink.core.fs.Path;
 import org.apache.flink.runtime.state.CheckpointMetadataOutputStream;
@@ -127,4 +128,9 @@ public class FsCheckpointStorageLocation extends FsCheckpointStreamFactory imple
 				", fileStateSizeThreshold=" + fileStateSizeThreshold +
 				'}';
 	}
+
+	@VisibleForTesting
+	FileSystem getFileSystem() {
+		return fileSystem;
+	}
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorageTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorageTest.java
index e391a5da670..1a9cf6c2f0b 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorageTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStorageTest.java
@@ -31,7 +31,10 @@ import org.apache.flink.runtime.state.filesystem.FsCheckpointStreamFactory.FsChe
 
 import org.junit.Test;
 
+import javax.annotation.Nonnull;
+
 import java.io.File;
+import java.io.IOException;
 import java.io.ObjectInputStream;
 import java.io.ObjectOutputStream;
 import java.util.Arrays;
@@ -41,6 +44,7 @@ import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertNotEquals;
 import static org.junit.Assert.assertTrue;
+import static org.mockito.Mockito.mock;
 
 /**
  * Tests for the {@link FsCheckpointStorage}, which implements the checkpoint storage
@@ -204,6 +208,28 @@ public class FsCheckpointStorageTest extends AbstractFileCheckpointStorageTestBa
 		assertFalse(checkpointDir.exists());
 	}
 
+	@Test
+	public void testResolveCheckpointStorageLocation() throws Exception {
+		final FileSystem checkpointFileSystem = mock(FileSystem.class);
+		final FsCheckpointStorage storage = new FsCheckpointStorage(
+			new TestingPath("hdfs:///checkpoint/", checkpointFileSystem),
+			null,
+			new JobID(),
+			FILE_SIZE_THRESHOLD);
+
+		final FsCheckpointStorageLocation checkpointStreamFactory =
+			(FsCheckpointStorageLocation) storage.resolveCheckpointStorageLocation(1L, CheckpointStorageLocationReference.getDefault());
+		assertEquals(checkpointFileSystem, checkpointStreamFactory.getFileSystem());
+
+		final CheckpointStorageLocationReference savepointLocationReference =
+			AbstractFsCheckpointStorage.encodePathAsReference(new Path("file:///savepoint/"));
+
+		final FsCheckpointStorageLocation savepointStreamFactory =
+			(FsCheckpointStorageLocation) storage.resolveCheckpointStorageLocation(2L, savepointLocationReference);
+		final FileSystem fileSystem = savepointStreamFactory.getFileSystem();
+		assertTrue(fileSystem instanceof LocalFileSystem);
+	}
+
 	// ------------------------------------------------------------------------
 	//  Utilities
 	// ------------------------------------------------------------------------
@@ -212,4 +238,23 @@ public class FsCheckpointStorageTest extends AbstractFileCheckpointStorageTestBa
 		Path path = new Path(parent, child.getName());
 		assertEquals(path, child);
 	}
+
+	private static final class TestingPath extends Path {
+
+		private static final long serialVersionUID = 2560119808844230488L;
+
+		@SuppressWarnings("TransientFieldNotInitialized")
+		@Nonnull
+		private final transient FileSystem fileSystem;
+
+		TestingPath(String pathString, @Nonnull FileSystem fileSystem) {
+			super(pathString);
+			this.fileSystem = fileSystem;
+		}
+
+		@Override
+		public FileSystem getFileSystem() throws IOException {
+			return fileSystem;
+		}
+	}
 }
