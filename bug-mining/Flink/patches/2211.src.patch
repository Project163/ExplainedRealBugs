diff --git a/flink-yarn-tests/src/test/java/org/apache/flink/yarn/TestingYarnTaskManagerRunner.java b/flink-yarn-tests/src/test/java/org/apache/flink/yarn/TestingYarnTaskManagerRunner.java
index 90cdf9fb2e0..ff030bec284 100644
--- a/flink-yarn-tests/src/test/java/org/apache/flink/yarn/TestingYarnTaskManagerRunner.java
+++ b/flink-yarn-tests/src/test/java/org/apache/flink/yarn/TestingYarnTaskManagerRunner.java
@@ -18,6 +18,8 @@
 
 package org.apache.flink.yarn;
 
+import org.apache.flink.runtime.security.SecurityUtils;
+
 import java.io.IOException;
 
 /**
@@ -25,7 +27,13 @@ import java.io.IOException;
  */
 public class TestingYarnTaskManagerRunner {
 	public static void main(String[] args) throws IOException {
-		YarnTaskManagerRunner.runYarnTaskManager(
-				args, TestingYarnTaskManager.class, System.getenv(), null);
+		YarnTaskManagerRunnerFactory.Runner tmRunner = YarnTaskManagerRunnerFactory.create(
+			args, TestingYarnTaskManager.class, System.getenv());
+
+		try {
+			SecurityUtils.getInstalledContext().runSecured(tmRunner);
+		} catch (Exception e) {
+			throw new RuntimeException(e);
+		}
 	}
 }
diff --git a/flink-yarn-tests/src/test/scala/org/apache/flink/yarn/TestingYarnTaskManager.scala b/flink-yarn-tests/src/test/scala/org/apache/flink/yarn/TestingYarnTaskManager.scala
index da95e01d16c..e33aa494ef3 100644
--- a/flink-yarn-tests/src/test/scala/org/apache/flink/yarn/TestingYarnTaskManager.scala
+++ b/flink-yarn-tests/src/test/scala/org/apache/flink/yarn/TestingYarnTaskManager.scala
@@ -24,6 +24,7 @@ import org.apache.flink.runtime.io.disk.iomanager.IOManager
 import org.apache.flink.runtime.io.network.NetworkEnvironment
 import org.apache.flink.runtime.memory.MemoryManager
 import org.apache.flink.runtime.metrics.groups.TaskManagerMetricGroup
+import org.apache.flink.runtime.security.SecurityUtils
 import org.apache.flink.runtime.taskexecutor.TaskManagerConfiguration
 import org.apache.flink.runtime.taskmanager.TaskManagerLocation
 import org.apache.flink.runtime.testingUtils.TestingTaskManagerLike
@@ -68,12 +69,19 @@ class TestingYarnTaskManager(
   object YarnTaskManager {
 
     /** Entry point (main method) to run the TaskManager on YARN.
- *
+      *
       * @param args The command line arguments.
       */
     def main(args: Array[String]): Unit = {
-      YarnTaskManagerRunner.runYarnTaskManager(
-        args, classOf[TestingYarnTaskManager], System.getenv(), null)
+      val tmRunner = YarnTaskManagerRunnerFactory.create(
+        args, classOf[TestingYarnTaskManager], System.getenv())
+
+      try {
+        SecurityUtils.getInstalledContext.runSecured(tmRunner)
+      } catch {
+        case e: Exception =>
+          throw new RuntimeException(e)
+      }
     }
 
   }
diff --git a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnApplicationMasterRunner.java b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnApplicationMasterRunner.java
index 18130348c01..9d1af35c38b 100644
--- a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnApplicationMasterRunner.java
+++ b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnApplicationMasterRunner.java
@@ -163,6 +163,9 @@ public class YarnApplicationMasterRunner {
 
 			File f = new File(currDir, Utils.KEYTAB_FILE_NAME);
 			if (remoteKeytabPrincipal != null && f.exists()) {
+				String keytabPath = f.getAbsolutePath();
+				LOG.debug("keytabPath: {}", keytabPath);
+
 				// set keytab principal and replace path with the local path of the shipped keytab file in NodeManager
 				flinkConfig.setString(SecurityOptions.KERBEROS_LOGIN_KEYTAB, f.getAbsolutePath());
 				flinkConfig.setString(SecurityOptions.KERBEROS_LOGIN_PRINCIPAL, remoteKeytabPrincipal);
@@ -248,7 +251,10 @@ public class YarnApplicationMasterRunner {
 
 			File f = new File(currDir, Utils.KEYTAB_FILE_NAME);
 			if (remoteKeytabPrincipal != null && f.exists()) {
-				config.setString(SecurityOptions.KERBEROS_LOGIN_KEYTAB, f.getAbsolutePath());
+				String keytabPath = f.getAbsolutePath();
+				LOG.debug("keytabPath: {}", keytabPath);
+
+				config.setString(SecurityOptions.KERBEROS_LOGIN_KEYTAB, keytabPath);
 				config.setString(SecurityOptions.KERBEROS_LOGIN_PRINCIPAL, remoteKeytabPrincipal);
 			}
 
diff --git a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskManagerRunner.java b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskManagerRunnerFactory.java
similarity index 77%
rename from flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskManagerRunner.java
rename to flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskManagerRunnerFactory.java
index 9d69fbd9105..d14248c1a27 100644
--- a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskManagerRunner.java
+++ b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnTaskManagerRunnerFactory.java
@@ -18,6 +18,7 @@
 
 package org.apache.flink.yarn;
 
+import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.configuration.AkkaOptions;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.configuration.CoreOptions;
@@ -47,33 +48,56 @@ import java.util.concurrent.Callable;
 /**
  * The entry point for running a TaskManager in a YARN container.
  */
-public class YarnTaskManagerRunner {
-
-	private static final Logger LOG = LoggerFactory.getLogger(YarnTaskManagerRunner.class);
-
-	private static Callable<Object> createMainRunner(
-			Configuration configuration,
-			ResourceID resourceId,
-			final Class<? extends YarnTaskManager> taskManager) {
-		return new Callable<Object>() {
-			@Override
-			public Integer call() {
-				try {
-					TaskManager.selectNetworkInterfaceAndRunTaskManager(
-							configuration, resourceId, taskManager);
-				} catch (Throwable t) {
-					LOG.error("Error while starting the TaskManager", t);
-					System.exit(TaskManager.STARTUP_FAILURE_RETURN_CODE());
-				}
-				return null;
+public class YarnTaskManagerRunnerFactory {
+
+	private static final Logger LOG = LoggerFactory.getLogger(YarnTaskManagerRunnerFactory.class);
+
+	/**
+	 * Runner for the {@link YarnTaskManager}.
+	 */
+	public static class Runner implements Callable<Object> {
+
+		private final Configuration configuration;
+		private final ResourceID resourceId;
+		private final Class<? extends YarnTaskManager> taskManager;
+
+		Runner(Configuration configuration, ResourceID resourceId, Class<? extends YarnTaskManager> taskManager) {
+			this.configuration = Preconditions.checkNotNull(configuration);
+			this.resourceId = Preconditions.checkNotNull(resourceId);
+			this.taskManager = Preconditions.checkNotNull(taskManager);
+		}
+
+		@Override
+		public Object call() throws Exception {
+			try {
+				TaskManager.selectNetworkInterfaceAndRunTaskManager(
+					configuration, resourceId, taskManager);
+			} catch (Throwable t) {
+				LOG.error("Error while starting the TaskManager", t);
+				System.exit(TaskManager.STARTUP_FAILURE_RETURN_CODE());
 			}
-		};
+			return null;
+		}
+
+		@VisibleForTesting
+		Configuration getConfiguration() {
+			return configuration;
+		}
+
+		@VisibleForTesting
+		ResourceID getResourceId() {
+			return resourceId;
+		}
 	}
 
-	public static void runYarnTaskManager(String[] args,
-																				final Class<? extends YarnTaskManager> taskManager,
-																				Map<String, String> envs,
-																				Callable<Object> mainRunner) throws IOException {
+	/**
+	 * Creates a {@link YarnTaskManagerRunnerFactory.Runner}.
+	 */
+	public static Runner create(
+			String[] args,
+			final Class<? extends YarnTaskManager> taskManager,
+			Map<String, String> envs) throws IOException {
+
 		EnvironmentInformation.logEnvironmentInfo(LOG, "YARN TaskManager", args);
 		SignalHandler.register(LOG);
 		JvmShutdownSafeguard.installAsShutdownHook(LOG);
@@ -86,7 +110,7 @@ public class YarnTaskManagerRunner {
 		catch (Throwable t) {
 			LOG.error(t.getMessage(), t);
 			System.exit(TaskManager.STARTUP_FAILURE_RETURN_CODE());
-			return;
+			return null;
 		}
 
 		// read the environment variables for YARN
@@ -129,8 +153,8 @@ public class YarnTaskManagerRunner {
 			configuration.setString(SecurityOptions.KERBEROS_LOGIN_KEYTAB, f.getAbsolutePath());
 			configuration.setString(SecurityOptions.KERBEROS_LOGIN_PRINCIPAL, remoteKeytabPrincipal);
 		}
-		try {
 
+		try {
 			SecurityConfiguration sc;
 
 			//To support Yarn Secure Integration Test Scenario
@@ -152,12 +176,9 @@ public class YarnTaskManagerRunner {
 
 			SecurityUtils.install(sc);
 
-			if (mainRunner == null) {
-				mainRunner = createMainRunner(configuration, resourceId, taskManager);
-			}
-			SecurityUtils.getInstalledContext().runSecured(mainRunner);
+			return new Runner(configuration, resourceId, taskManager);
 		} catch (Exception e) {
-			LOG.error("Exception occurred while launching Task Manager", e);
+			LOG.error("Exception occurred while building Task Manager runner", e);
 			throw new RuntimeException(e);
 		}
 
diff --git a/flink-yarn/src/main/scala/org/apache/flink/yarn/YarnTaskManager.scala b/flink-yarn/src/main/scala/org/apache/flink/yarn/YarnTaskManager.scala
index 5b8f4ca8b45..08d24b440ba 100644
--- a/flink-yarn/src/main/scala/org/apache/flink/yarn/YarnTaskManager.scala
+++ b/flink-yarn/src/main/scala/org/apache/flink/yarn/YarnTaskManager.scala
@@ -24,9 +24,12 @@ import org.apache.flink.runtime.io.disk.iomanager.IOManager
 import org.apache.flink.runtime.io.network.NetworkEnvironment
 import org.apache.flink.runtime.memory.MemoryManager
 import org.apache.flink.runtime.metrics.groups.TaskManagerMetricGroup
+import org.apache.flink.runtime.security.SecurityUtils
 import org.apache.flink.runtime.taskexecutor.TaskManagerConfiguration
 import org.apache.flink.runtime.taskmanager.{TaskManager, TaskManagerLocation}
 
+import grizzled.slf4j.Logger
+
 /** An extension of the TaskManager that listens for additional YARN related
   * messages.
   */
@@ -56,14 +59,25 @@ class YarnTaskManager(
   }
 }
 
-  object YarnTaskManager {
-    /** Entry point (main method) to run the TaskManager on YARN.
-      *
-      * @param args The command line arguments.
-      */
-    def main(args: Array[String]): Unit = {
-      YarnTaskManagerRunner.runYarnTaskManager(
-        args, classOf[YarnTaskManager], System.getenv(), null)
+object YarnTaskManager {
+
+  val LOG = Logger(classOf[TaskManager])
+
+  /** Entry point (main method) to run the TaskManager on YARN.
+    *
+    * @param args The command line arguments.
+    */
+  def main(args: Array[String]): Unit = {
+    val tmRunner = YarnTaskManagerRunnerFactory.create(
+      args, classOf[YarnTaskManager], System.getenv())
+
+    try {
+      SecurityUtils.getInstalledContext.runSecured(tmRunner)
+    } catch {
+      case e: Exception =>
+        LOG.error("Exception occurred while launching Task Manager runner", e)
+        throw new RuntimeException(e)
     }
+  }
 
 }
diff --git a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnTaskManagerRunnerTest.java b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnTaskManagerRunnerFactoryTest.java
similarity index 58%
rename from flink-yarn/src/test/java/org/apache/flink/yarn/YarnTaskManagerRunnerTest.java
rename to flink-yarn/src/test/java/org/apache/flink/yarn/YarnTaskManagerRunnerFactoryTest.java
index cdacfc001ce..7f518f14092 100644
--- a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnTaskManagerRunnerTest.java
+++ b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnTaskManagerRunnerFactoryTest.java
@@ -18,6 +18,8 @@
 
 package org.apache.flink.yarn;
 
+import org.apache.flink.configuration.Configuration;
+import org.apache.flink.configuration.SecurityOptions;
 import org.apache.flink.runtime.security.SecurityUtils;
 import org.apache.flink.runtime.security.modules.HadoopModule;
 import org.apache.flink.runtime.security.modules.SecurityModule;
@@ -34,12 +36,11 @@ import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
 import java.util.Optional;
-import java.util.concurrent.Callable;
 
 /**
- * Tests for {@link YarnTaskManagerRunner}.
+ * Tests for {@link YarnTaskManagerRunnerFactory}.
  */
-public class YarnTaskManagerRunnerTest {
+public class YarnTaskManagerRunnerFactoryTest {
 
 	@Test
 	public void testKerberosKeytabConfiguration() throws IOException {
@@ -49,26 +50,27 @@ public class YarnTaskManagerRunnerTest {
 		envs.put(YarnFlinkResourceManager.ENV_FLINK_CONTAINER_ID, "test_container_00001");
 		envs.put(YarnConfigKeys.KEYTAB_PRINCIPAL, "testuser1@domain");
 		envs.put(ApplicationConstants.Environment.PWD.key(), resourceDirPath);
-		YarnTaskManagerRunner.runYarnTaskManager(
-				new String[]{"--configDir", resourceDirPath},
-				YarnTaskManager.class,
-				envs,
-				new Callable<Object>() {
-					@Override
-					public Integer call() {
-						final List<SecurityModule> modules = SecurityUtils.getInstalledModules();
-						Optional<SecurityModule> moduleOpt =
-								modules.stream().filter(s -> s instanceof HadoopModule).findFirst();
-						if (moduleOpt.isPresent()) {
-							HadoopModule hadoopModule = (HadoopModule) moduleOpt.get();
-							assertEquals("testuser1@domain", hadoopModule.getSecurityConfig().getPrincipal());
-							assertEquals(resourceDirPath + "/krb5.keytab",
-									hadoopModule.getSecurityConfig().getKeytab());
-						} else {
-							fail("Can not find HadoopModule!");
-						}
-						return null;
-					}
-				});
+
+		final YarnTaskManagerRunnerFactory.Runner tmRunner = YarnTaskManagerRunnerFactory.create(
+			new String[]{"--configDir", resourceDirPath},
+			YarnTaskManager.class,
+			envs);
+
+		final List<SecurityModule> modules = SecurityUtils.getInstalledModules();
+		Optional<SecurityModule> moduleOpt =
+			modules.stream().filter(s -> s instanceof HadoopModule).findFirst();
+		if (moduleOpt.isPresent()) {
+			HadoopModule hadoopModule = (HadoopModule) moduleOpt.get();
+			assertEquals("testuser1@domain", hadoopModule.getSecurityConfig().getPrincipal());
+			assertEquals(resourceDirPath + "/" + Utils.KEYTAB_FILE_NAME,
+				hadoopModule.getSecurityConfig().getKeytab());
+		} else {
+			fail("Can not find HadoopModule!");
+		}
+
+		final Configuration configuration = tmRunner.getConfiguration();
+		assertEquals(resourceDirPath + "/" + Utils.KEYTAB_FILE_NAME, configuration.getString(SecurityOptions.KERBEROS_LOGIN_KEYTAB));
+		assertEquals("testuser1@domain", configuration.getString(SecurityOptions.KERBEROS_LOGIN_PRINCIPAL));
+		assertEquals("test_container_00001", tmRunner.getResourceId().toString());
 	}
 }
