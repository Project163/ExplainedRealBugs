diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/taskexecutor/TaskExecutorMemoryConfiguration.java b/flink-runtime/src/main/java/org/apache/flink/runtime/taskexecutor/TaskExecutorMemoryConfiguration.java
index 26b0cda4cff..45085161ffc 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/taskexecutor/TaskExecutorMemoryConfiguration.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/taskexecutor/TaskExecutorMemoryConfiguration.java
@@ -38,12 +38,11 @@ import static org.apache.flink.configuration.TaskManagerOptions.MANAGED_MEMORY_S
 import static org.apache.flink.configuration.TaskManagerOptions.NETWORK_MEMORY_MAX;
 import static org.apache.flink.configuration.TaskManagerOptions.TASK_HEAP_MEMORY;
 import static org.apache.flink.configuration.TaskManagerOptions.TASK_OFF_HEAP_MEMORY;
-import static org.apache.flink.configuration.TaskManagerOptions.TOTAL_FLINK_MEMORY;
-import static org.apache.flink.configuration.TaskManagerOptions.TOTAL_PROCESS_MEMORY;
+import static org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils.calculateTotalFlinkMemoryFromComponents;
+import static org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils.calculateTotalProcessMemoryFromComponents;
 
 /** TaskExecutorConfiguration collects the configuration of a TaskExecutor instance. */
 public class TaskExecutorMemoryConfiguration implements Serializable {
-
     public static final String FIELD_NAME_FRAMEWORK_HEAP = "frameworkHeap";
     public static final String FIELD_NAME_TASK_HEAP = "taskHeap";
 
@@ -116,8 +115,8 @@ public class TaskExecutorMemoryConfiguration implements Serializable {
                 getConfigurationValue(config, MANAGED_MEMORY_SIZE),
                 getConfigurationValue(config, JVM_METASPACE),
                 getConfigurationValue(config, JVM_OVERHEAD_MAX),
-                getConfigurationValue(config, TOTAL_FLINK_MEMORY),
-                getConfigurationValue(config, TOTAL_PROCESS_MEMORY));
+                calculateTotalFlinkMemoryFromComponents(config),
+                calculateTotalProcessMemoryFromComponents(config));
     }
 
     @JsonCreator
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/taskexecutor/TaskExecutorResourceUtils.java b/flink-runtime/src/main/java/org/apache/flink/runtime/taskexecutor/TaskExecutorResourceUtils.java
index 0d9570f4e36..7d35336d12b 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/taskexecutor/TaskExecutorResourceUtils.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/taskexecutor/TaskExecutorResourceUtils.java
@@ -28,6 +28,7 @@ import org.apache.flink.configuration.ReadableConfig;
 import org.apache.flink.configuration.TaskManagerOptions;
 import org.apache.flink.runtime.clusterframework.types.ResourceProfile;
 import org.apache.flink.runtime.externalresource.ExternalResourceUtils;
+import org.apache.flink.util.Preconditions;
 
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -154,6 +155,39 @@ public class TaskExecutorResourceUtils {
         return resourceSpecFromConfig(adjustForLocalExecution(config));
     }
 
+    public static long calculateTotalFlinkMemoryFromComponents(Configuration config) {
+        Preconditions.checkArgument(config.contains(TaskManagerOptions.TASK_HEAP_MEMORY));
+        Preconditions.checkArgument(config.contains(TaskManagerOptions.TASK_OFF_HEAP_MEMORY));
+        Preconditions.checkArgument(config.contains(TaskManagerOptions.NETWORK_MEMORY_MAX));
+        Preconditions.checkArgument(config.contains(TaskManagerOptions.NETWORK_MEMORY_MIN));
+        Preconditions.checkArgument(config.contains(TaskManagerOptions.MANAGED_MEMORY_SIZE));
+        Preconditions.checkArgument(config.contains(TaskManagerOptions.FRAMEWORK_HEAP_MEMORY));
+        Preconditions.checkArgument(config.contains(TaskManagerOptions.FRAMEWORK_OFF_HEAP_MEMORY));
+        Preconditions.checkArgument(
+                config.get(TaskManagerOptions.NETWORK_MEMORY_MAX)
+                        .equals(config.get(TaskManagerOptions.NETWORK_MEMORY_MIN)));
+        return config.get(TaskManagerOptions.TASK_HEAP_MEMORY)
+                .add(config.get(TaskManagerOptions.TASK_OFF_HEAP_MEMORY))
+                .add(config.get(TaskManagerOptions.NETWORK_MEMORY_MAX))
+                .add(config.get(TaskManagerOptions.MANAGED_MEMORY_SIZE))
+                .add(config.get(TaskManagerOptions.FRAMEWORK_HEAP_MEMORY))
+                .add(config.get(TaskManagerOptions.FRAMEWORK_OFF_HEAP_MEMORY))
+                .getBytes();
+    }
+
+    public static long calculateTotalProcessMemoryFromComponents(Configuration config) {
+        Preconditions.checkArgument(config.contains(TaskManagerOptions.JVM_METASPACE));
+        Preconditions.checkArgument(config.contains(TaskManagerOptions.JVM_OVERHEAD_MAX));
+        Preconditions.checkArgument(config.contains(TaskManagerOptions.JVM_OVERHEAD_MIN));
+        Preconditions.checkArgument(
+                config.get(TaskManagerOptions.JVM_OVERHEAD_MAX)
+                        .equals(config.get(TaskManagerOptions.JVM_OVERHEAD_MIN)));
+        return calculateTotalFlinkMemoryFromComponents(config)
+                + config.get(TaskManagerOptions.JVM_METASPACE)
+                        .add(config.get(TaskManagerOptions.JVM_OVERHEAD_MAX))
+                        .getBytes();
+    }
+
     public static Configuration adjustForLocalExecution(Configuration config) {
         UNUSED_CONFIG_OPTIONS.forEach(option -> warnOptionHasNoEffectIfSet(config, option));
 
@@ -167,6 +201,26 @@ public class TaskExecutorResourceUtils {
         adjustNetworkMemoryForLocalExecution(config);
         setConfigOptionToDefaultIfNotSet(
                 config, TaskManagerOptions.MANAGED_MEMORY_SIZE, DEFAULT_MANAGED_MEMORY_SIZE);
+        silentlySetConfigOptionIfNotSet(
+                config,
+                TaskManagerOptions.FRAMEWORK_HEAP_MEMORY,
+                TaskManagerOptions.FRAMEWORK_HEAP_MEMORY.defaultValue());
+        silentlySetConfigOptionIfNotSet(
+                config,
+                TaskManagerOptions.FRAMEWORK_OFF_HEAP_MEMORY,
+                TaskManagerOptions.FRAMEWORK_OFF_HEAP_MEMORY.defaultValue());
+        silentlySetConfigOptionIfNotSet(
+                config,
+                TaskManagerOptions.JVM_METASPACE,
+                TaskManagerOptions.JVM_METASPACE.defaultValue());
+        silentlySetConfigOptionIfNotSet(
+                config,
+                TaskManagerOptions.JVM_OVERHEAD_MAX,
+                TaskManagerOptions.JVM_OVERHEAD_MAX.defaultValue());
+        silentlySetConfigOptionIfNotSet(
+                config,
+                TaskManagerOptions.JVM_OVERHEAD_MIN,
+                TaskManagerOptions.JVM_OVERHEAD_MAX.defaultValue());
 
         return config;
     }
@@ -200,6 +254,13 @@ public class TaskExecutorResourceUtils {
         }
     }
 
+    private static <T> void silentlySetConfigOptionIfNotSet(
+            Configuration config, ConfigOption<T> option, T value) {
+        if (!config.contains(option)) {
+            config.set(option, value);
+        }
+    }
+
     private static <T> void setConfigOptionToDefaultIfNotSet(
             Configuration config, ConfigOption<T> option, T defaultValue) {
         setConfigOptionToDefaultIfNotSet(
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManagerTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManagerTest.java
index 746bd31ab99..18e3a319a5f 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManagerTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/active/ActiveResourceManagerTest.java
@@ -81,6 +81,8 @@ public class ActiveResourceManagerTest extends TestLogger {
     private static final long TESTING_START_WORKER_TIMEOUT_MS = 50;
 
     private static final WorkerResourceSpec WORKER_RESOURCE_SPEC = WorkerResourceSpec.ZERO;
+    private static final TaskExecutorMemoryConfiguration TESTING_CONFIG =
+            new TaskExecutorMemoryConfiguration(1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 21L, 36L);
 
     /** Tests worker successfully requested, started and registered. */
     @Test
@@ -941,7 +943,7 @@ public class ActiveResourceManagerTest extends TestLogger {
                             1234,
                             23456,
                             new HardwareDescription(1, 2L, 3L, 4L),
-                            TaskExecutorMemoryConfiguration.create(flinkConfig),
+                            TESTING_CONFIG,
                             ResourceProfile.ZERO,
                             ResourceProfile.ZERO);
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorMemoryConfigurationTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorMemoryConfigurationTest.java
index 15b51d0f66c..719700b7ee4 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorMemoryConfigurationTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorMemoryConfigurationTest.java
@@ -37,8 +37,6 @@ import static org.apache.flink.configuration.TaskManagerOptions.NETWORK_MEMORY_M
 import static org.apache.flink.configuration.TaskManagerOptions.NETWORK_MEMORY_MIN;
 import static org.apache.flink.configuration.TaskManagerOptions.TASK_HEAP_MEMORY;
 import static org.apache.flink.configuration.TaskManagerOptions.TASK_OFF_HEAP_MEMORY;
-import static org.apache.flink.configuration.TaskManagerOptions.TOTAL_FLINK_MEMORY;
-import static org.apache.flink.configuration.TaskManagerOptions.TOTAL_PROCESS_MEMORY;
 import static org.hamcrest.core.Is.is;
 import static org.junit.Assert.assertThat;
 
@@ -46,49 +44,26 @@ import static org.junit.Assert.assertThat;
 public class TaskExecutorMemoryConfigurationTest extends TestLogger {
 
     @Test
-    public void testInitializationWithAllValuesBeingSet() {
+    public void testInitialization() {
         Configuration config = new Configuration();
 
         config.set(FRAMEWORK_HEAP_MEMORY, new MemorySize(1));
         config.set(TASK_HEAP_MEMORY, new MemorySize(2));
         config.set(FRAMEWORK_OFF_HEAP_MEMORY, new MemorySize(3));
         config.set(TASK_OFF_HEAP_MEMORY, new MemorySize(4));
-        config.set(NETWORK_MEMORY_MIN, new MemorySize(5));
+        config.set(NETWORK_MEMORY_MIN, new MemorySize(6));
         config.set(NETWORK_MEMORY_MAX, new MemorySize(6));
         config.set(NETWORK_MEMORY_FRACTION, 0.1f);
         config.set(MANAGED_MEMORY_SIZE, new MemorySize(7));
         config.set(MANAGED_MEMORY_FRACTION, 0.2f);
         config.set(JVM_METASPACE, new MemorySize(8));
-        config.set(JVM_OVERHEAD_MIN, new MemorySize(9));
+        config.set(JVM_OVERHEAD_MIN, new MemorySize(10));
         config.set(JVM_OVERHEAD_MAX, new MemorySize(10));
         config.set(JVM_OVERHEAD_FRACTION, 0.3f);
-        config.set(TOTAL_FLINK_MEMORY, new MemorySize(11));
-        config.set(TOTAL_PROCESS_MEMORY, new MemorySize(12));
 
         TaskExecutorMemoryConfiguration actual = TaskExecutorMemoryConfiguration.create(config);
         TaskExecutorMemoryConfiguration expected =
-                new TaskExecutorMemoryConfiguration(1L, 2L, 3L, 4L, 6L, 7L, 8L, 10L, 11L, 12L);
-
-        assertThat(actual, is(expected));
-    }
-
-    @Test
-    public void testInitializationWithMissingValues() {
-        Configuration config = new Configuration();
-
-        TaskExecutorMemoryConfiguration actual = TaskExecutorMemoryConfiguration.create(config);
-        TaskExecutorMemoryConfiguration expected =
-                new TaskExecutorMemoryConfiguration(
-                        FRAMEWORK_HEAP_MEMORY.defaultValue().getBytes(),
-                        null,
-                        FRAMEWORK_OFF_HEAP_MEMORY.defaultValue().getBytes(),
-                        TASK_OFF_HEAP_MEMORY.defaultValue().getBytes(),
-                        NETWORK_MEMORY_MAX.defaultValue().getBytes(),
-                        null,
-                        JVM_METASPACE.defaultValue().getBytes(),
-                        JVM_OVERHEAD_MAX.defaultValue().getBytes(),
-                        null,
-                        null);
+                new TaskExecutorMemoryConfiguration(1L, 2L, 3L, 4L, 6L, 7L, 8L, 10L, 23L, 41L);
 
         assertThat(actual, is(expected));
     }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorResourceUtilsTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorResourceUtilsTest.java
index 66fb996ef92..6f833d11f36 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorResourceUtilsTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorResourceUtilsTest.java
@@ -126,6 +126,68 @@ public class TaskExecutorResourceUtilsTest extends TestLogger {
         assertThat(configuration.get(TaskManagerOptions.NETWORK_MEMORY_MAX), is(networkMemorySize));
     }
 
+    @Test
+    public void testCalculateTotalFlinkMemoryWithAllFactorsBeingSet() {
+        Configuration config = new Configuration();
+
+        config.set(TaskManagerOptions.FRAMEWORK_HEAP_MEMORY, new MemorySize(1));
+        config.set(TaskManagerOptions.TASK_HEAP_MEMORY, new MemorySize(2));
+        config.set(TaskManagerOptions.FRAMEWORK_OFF_HEAP_MEMORY, new MemorySize(3));
+        config.set(TaskManagerOptions.TASK_OFF_HEAP_MEMORY, new MemorySize(4));
+        config.set(TaskManagerOptions.NETWORK_MEMORY_MAX, new MemorySize(6));
+        config.set(TaskManagerOptions.NETWORK_MEMORY_MIN, new MemorySize(6));
+        config.set(TaskManagerOptions.MANAGED_MEMORY_SIZE, new MemorySize(7));
+
+        assertThat(
+                TaskExecutorResourceUtils.calculateTotalFlinkMemoryFromComponents(config), is(23L));
+    }
+
+    @Test(expected = IllegalArgumentException.class)
+    public void testCalculateTotalFlinkMemoryWithMissingFactors() {
+        Configuration config = new Configuration();
+
+        config.set(TaskManagerOptions.FRAMEWORK_HEAP_MEMORY, new MemorySize(1));
+        config.set(TaskManagerOptions.FRAMEWORK_OFF_HEAP_MEMORY, new MemorySize(3));
+        config.set(TaskManagerOptions.TASK_OFF_HEAP_MEMORY, new MemorySize(4));
+        config.set(TaskManagerOptions.MANAGED_MEMORY_SIZE, new MemorySize(7));
+
+        TaskExecutorResourceUtils.calculateTotalFlinkMemoryFromComponents(config);
+    }
+
+    @Test
+    public void testCalculateTotalProcessMemoryWithAllFactorsBeingSet() {
+        Configuration config = new Configuration();
+
+        config.set(TaskManagerOptions.FRAMEWORK_HEAP_MEMORY, new MemorySize(1));
+        config.set(TaskManagerOptions.TASK_HEAP_MEMORY, new MemorySize(2));
+        config.set(TaskManagerOptions.FRAMEWORK_OFF_HEAP_MEMORY, new MemorySize(3));
+        config.set(TaskManagerOptions.TASK_OFF_HEAP_MEMORY, new MemorySize(4));
+        config.set(TaskManagerOptions.NETWORK_MEMORY_MAX, new MemorySize(6));
+        config.set(TaskManagerOptions.NETWORK_MEMORY_MIN, new MemorySize(6));
+        config.set(TaskManagerOptions.MANAGED_MEMORY_SIZE, new MemorySize(7));
+        config.set(TaskManagerOptions.JVM_METASPACE, new MemorySize(8));
+        config.set(TaskManagerOptions.JVM_OVERHEAD_MAX, new MemorySize(10));
+        config.set(TaskManagerOptions.JVM_OVERHEAD_MIN, new MemorySize(10));
+
+        assertThat(
+                TaskExecutorResourceUtils.calculateTotalProcessMemoryFromComponents(config),
+                is(41L));
+    }
+
+    @Test(expected = IllegalArgumentException.class)
+    public void testCalculateTotalProcessMemoryWithMissingFactors() {
+        Configuration config = new Configuration();
+
+        config.set(TaskManagerOptions.FRAMEWORK_HEAP_MEMORY, new MemorySize(1));
+        config.set(TaskManagerOptions.FRAMEWORK_OFF_HEAP_MEMORY, new MemorySize(3));
+        config.set(TaskManagerOptions.TASK_OFF_HEAP_MEMORY, new MemorySize(4));
+        config.set(TaskManagerOptions.NETWORK_MEMORY_MAX, new MemorySize(6));
+        config.set(TaskManagerOptions.MANAGED_MEMORY_SIZE, new MemorySize(7));
+        config.set(TaskManagerOptions.JVM_METASPACE, new MemorySize(8));
+
+        TaskExecutorResourceUtils.calculateTotalProcessMemoryFromComponents(config);
+    }
+
     private static Configuration createValidConfig() {
         Configuration configuration = new Configuration();
         configuration.set(TaskManagerOptions.CPU_CORES, CPU_CORES);
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorTest.java
index af35d4494fe..99b57d4a02b 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorTest.java
@@ -214,6 +214,7 @@ public class TaskExecutorTest extends TestLogger {
                 new BlobCacheService(new Configuration(), new VoidBlobStore(), null);
 
         configuration = new Configuration();
+        TaskExecutorResourceUtils.adjustForLocalExecution(configuration);
 
         unresolvedTaskManagerLocation = new LocalUnresolvedTaskManagerLocation();
         jobId = new JobID();
@@ -2155,14 +2156,17 @@ public class TaskExecutorTest extends TestLogger {
     @Test(timeout = 10000L)
     public void testLogNotFoundHandling() throws Throwable {
         final int dataPort = NetUtils.getAvailablePort();
-        Configuration config = new Configuration();
-        config.setInteger(NettyShuffleEnvironmentOptions.DATA_PORT, dataPort);
-        config.setInteger(NettyShuffleEnvironmentOptions.NETWORK_REQUEST_BACKOFF_INITIAL, 100);
-        config.setInteger(NettyShuffleEnvironmentOptions.NETWORK_REQUEST_BACKOFF_MAX, 200);
-        config.setString(ConfigConstants.TASK_MANAGER_LOG_PATH_KEY, "/i/dont/exist");
+        configuration.setInteger(NettyShuffleEnvironmentOptions.DATA_PORT, dataPort);
+        configuration.setInteger(
+                NettyShuffleEnvironmentOptions.NETWORK_REQUEST_BACKOFF_INITIAL, 100);
+        configuration.setInteger(NettyShuffleEnvironmentOptions.NETWORK_REQUEST_BACKOFF_MAX, 200);
+        configuration.setString(ConfigConstants.TASK_MANAGER_LOG_PATH_KEY, "/i/dont/exist");
 
         try (TaskSubmissionTestEnvironment env =
-                new Builder(jobId).setConfiguration(config).setLocalCommunication(false).build()) {
+                new Builder(jobId)
+                        .setConfiguration(configuration)
+                        .setLocalCommunication(false)
+                        .build()) {
             TaskExecutorGateway tmGateway = env.getTaskExecutorGateway();
             try {
                 CompletableFuture<TransientBlobKey> logFuture =
@@ -2178,7 +2182,8 @@ public class TaskExecutorTest extends TestLogger {
 
     @Test(timeout = 10000L)
     public void testTerminationOnFatalError() throws Throwable {
-        try (TaskSubmissionTestEnvironment env = new Builder(jobId).build()) {
+        try (TaskSubmissionTestEnvironment env =
+                new Builder(jobId).setConfiguration(configuration).build()) {
             String testExceptionMsg = "Test exception of fatal error.";
 
             env.getTaskExecutor().onFatalError(new Exception(testExceptionMsg));
diff --git a/flink-tests/src/test/java/org/apache/flink/test/recovery/AbstractTaskManagerProcessFailureRecoveryTest.java b/flink-tests/src/test/java/org/apache/flink/test/recovery/AbstractTaskManagerProcessFailureRecoveryTest.java
index 9029adac7e7..3e7666069c8 100644
--- a/flink-tests/src/test/java/org/apache/flink/test/recovery/AbstractTaskManagerProcessFailureRecoveryTest.java
+++ b/flink-tests/src/test/java/org/apache/flink/test/recovery/AbstractTaskManagerProcessFailureRecoveryTest.java
@@ -30,6 +30,7 @@ import org.apache.flink.configuration.TaskManagerOptions;
 import org.apache.flink.core.plugin.PluginManager;
 import org.apache.flink.core.plugin.PluginUtils;
 import org.apache.flink.runtime.entrypoint.StandaloneSessionClusterEntrypoint;
+import org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils;
 import org.apache.flink.runtime.taskexecutor.TaskManagerRunner;
 import org.apache.flink.runtime.util.BlobServerResource;
 import org.apache.flink.runtime.zookeeper.ZooKeeperResource;
@@ -335,6 +336,7 @@ public abstract class AbstractTaskManagerProcessFailureRecoveryTest extends Test
                 Configuration cfg = parameterTool.getConfiguration();
                 final PluginManager pluginManager =
                         PluginUtils.createPluginManagerFromRootFolder(cfg);
+                TaskExecutorResourceUtils.adjustForLocalExecution(cfg);
 
                 TaskManagerRunner.runTaskManager(cfg, pluginManager);
             } catch (Throwable t) {
diff --git a/flink-tests/src/test/java/org/apache/flink/test/recovery/JobManagerHAProcessFailureRecoveryITCase.java b/flink-tests/src/test/java/org/apache/flink/test/recovery/JobManagerHAProcessFailureRecoveryITCase.java
index cb234634050..c6168ae8fb8 100644
--- a/flink-tests/src/test/java/org/apache/flink/test/recovery/JobManagerHAProcessFailureRecoveryITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/test/recovery/JobManagerHAProcessFailureRecoveryITCase.java
@@ -45,6 +45,7 @@ import org.apache.flink.runtime.leaderretrieval.LeaderRetrievalService;
 import org.apache.flink.runtime.rpc.RpcService;
 import org.apache.flink.runtime.rpc.RpcUtils;
 import org.apache.flink.runtime.rpc.akka.AkkaRpcServiceUtils;
+import org.apache.flink.runtime.taskexecutor.TaskExecutorResourceUtils;
 import org.apache.flink.runtime.taskexecutor.TaskManagerRunner;
 import org.apache.flink.runtime.testingUtils.TestingUtils;
 import org.apache.flink.runtime.testutils.DispatcherProcess;
@@ -268,6 +269,7 @@ public class JobManagerHAProcessFailureRecoveryITCase extends TestLogger {
         config.setInteger(TaskManagerOptions.NUM_TASK_SLOTS, 2);
         config.set(TaskManagerOptions.TASK_HEAP_MEMORY, MemorySize.parse("128m"));
         config.set(TaskManagerOptions.CPU_CORES, 1.0);
+        TaskExecutorResourceUtils.adjustForLocalExecution(config);
 
         final RpcService rpcService =
                 AkkaRpcServiceUtils.remoteServiceBuilder(config, "localhost", 0).createAndStart();
