diff --git a/flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/runtime/operators/rank/UpdatableTopNFunction.java b/flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/runtime/operators/rank/UpdatableTopNFunction.java
index 8d0cf531e98..40333578892 100644
--- a/flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/runtime/operators/rank/UpdatableTopNFunction.java
+++ b/flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/runtime/operators/rank/UpdatableTopNFunction.java
@@ -331,6 +331,7 @@ public class UpdatableTopNFunction extends AbstractTopNFunction implements Check
         RowData currentRow = null;
         // whether we have found the sort key in the buffer
         boolean findsSortKey = false;
+        boolean oldRowRetracted = false;
 
         while (iterator.hasNext() && isInRankEnd(currentRank)) {
             Map.Entry<RowData, Collection<RowData>> entry = iterator.next();
@@ -349,6 +350,11 @@ public class UpdatableTopNFunction extends AbstractTopNFunction implements Check
                         RowData rowKey = rowKeyIter.next();
                         RankRow prevRow = rowKeyMap.get(rowKey);
                         collectUpdateBefore(out, prevRow.row, currentRank);
+                        if (currentRow == inputRow && oldRow != null && !oldRowRetracted) {
+                            // In a same unique key, we should retract oldRow first.
+                            collectUpdateBefore(out, oldRow.row, oldRank);
+                            oldRowRetracted = true;
+                        }
                         collectUpdateAfter(out, currentRow, currentRank);
                         currentRow = prevRow.row;
                         currentRank += 1;
@@ -363,6 +369,11 @@ public class UpdatableTopNFunction extends AbstractTopNFunction implements Check
                             RowData rowKey = rowKeyIter.next();
                             RankRow prevRow = rowKeyMap.get(rowKey);
                             collectUpdateBefore(out, prevRow.row, currentRank);
+                            if (currentRow == inputRow && oldRow != null && !oldRowRetracted) {
+                                // In a same unique key, we should retract oldRow first.
+                                collectUpdateBefore(out, oldRow.row, oldRank);
+                                oldRowRetracted = true;
+                            }
                             collectUpdateAfter(out, currentRow, currentRank);
                             currentRow = prevRow.row;
                             currentRank += 1;
@@ -386,7 +397,9 @@ public class UpdatableTopNFunction extends AbstractTopNFunction implements Check
                 // input is an update record, current we reach the old rank position of
                 // the old record, so emit UPDATE_BEFORE and UPDATE_AFTER for this rank number
                 checkArgument(currentRank == oldRank);
-                collectUpdateBefore(out, oldRow.row, oldRank);
+                if (!oldRowRetracted) {
+                    collectUpdateBefore(out, oldRow.row, oldRank);
+                }
                 collectUpdateAfter(out, currentRow, currentRank);
             }
             // this is either a new record within top-n range or an update record,
diff --git a/flink-table/flink-table-runtime-blink/src/test/java/org/apache/flink/table/runtime/operators/rank/UpdatableTopNFunctionTest.java b/flink-table/flink-table-runtime-blink/src/test/java/org/apache/flink/table/runtime/operators/rank/UpdatableTopNFunctionTest.java
index e6bbc860875..13a34dfd903 100644
--- a/flink-table/flink-table-runtime-blink/src/test/java/org/apache/flink/table/runtime/operators/rank/UpdatableTopNFunctionTest.java
+++ b/flink-table/flink-table-runtime-blink/src/test/java/org/apache/flink/table/runtime/operators/rank/UpdatableTopNFunctionTest.java
@@ -132,8 +132,8 @@ public class UpdatableTopNFunctionTest extends TopNFunctionTestBase {
         expectedOutput.add(insertRecord("book", 2L, 19, 2L));
         // U ("book", 2L, 11)
         expectedOutput.add(updateBeforeRecord("book", 3L, 16, 1L));
-        expectedOutput.add(updateAfterRecord("book", 2L, 11, 1L));
         expectedOutput.add(updateBeforeRecord("book", 2L, 19, 2L));
+        expectedOutput.add(updateAfterRecord("book", 2L, 11, 1L));
         expectedOutput.add(updateAfterRecord("book", 3L, 16, 2L));
         // U ("book", 3L, 15)
         expectedOutput.add(updateBeforeRecord("book", 3L, 16, 2L));
@@ -145,8 +145,8 @@ public class UpdatableTopNFunctionTest extends TopNFunctionTestBase {
         expectedOutput.add(updateAfterRecord("book", 2L, 11, 2L));
         // U ("book", 2L, 1)
         expectedOutput.add(updateBeforeRecord("book", 4L, 2, 1L));
-        expectedOutput.add(updateAfterRecord("book", 2L, 1, 1L));
         expectedOutput.add(updateBeforeRecord("book", 2L, 11, 2L));
+        expectedOutput.add(updateAfterRecord("book", 2L, 1, 1L));
         expectedOutput.add(updateAfterRecord("book", 4L, 2, 2L));
 
         assertorWithRowNumber.assertOutputEquals(
