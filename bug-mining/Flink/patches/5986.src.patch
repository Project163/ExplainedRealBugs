diff --git a/flink-connectors/flink-connector-rabbitmq/src/test/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSourceTest.java b/flink-connectors/flink-connector-rabbitmq/src/test/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSourceTest.java
index dab807c9032..e9361fef6a5 100644
--- a/flink-connectors/flink-connector-rabbitmq/src/test/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSourceTest.java
+++ b/flink-connectors/flink-connector-rabbitmq/src/test/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSourceTest.java
@@ -116,6 +116,7 @@ public class RMQSourceTest {
         source.initializeState(mockContext);
         source.open(config);
 
+        DummySourceContext.numElementsCollected = 0;
         messageId = 0;
         generateCorrelationIds = true;
 
@@ -388,12 +389,14 @@ public class RMQSourceTest {
             testHarness.snapshot(snapshotId, System.currentTimeMillis());
             source.notifyCheckpointComplete(snapshotId);
             lastMessageId = messageId;
+
+            // check if all the messages are being collected and acknowledged
+            long totalNumberOfAcks = numMsgRedelivered + lastMessageId;
+            assertEquals(lastMessageId, DummySourceContext.numElementsCollected);
+            assertEquals(totalNumberOfAcks, ((RMQTestSource) source).addIdCalls);
         }
 
-        // check if all the messages are being acknowledged
-        long totalNumberOfAcks = numMsgRedelivered + lastMessageId;
-        assertEquals(lastMessageId, DummySourceContext.numElementsCollected);
-        assertEquals(totalNumberOfAcks, ((RMQTestSource) source).addIdCalls);
+        // check if all the acks are being sent
         Mockito.verify(source.channel, Mockito.times((int) lastMessageId))
                 .basicAck(Mockito.anyLong(), Mockito.eq(false));
         Mockito.verify(source.channel, Mockito.times((int) numMsgRedelivered))
