diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherResourceCleanupTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherResourceCleanupTest.java
index c20e313c0d1..dd69c123dd3 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherResourceCleanupTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherResourceCleanupTest.java
@@ -350,6 +350,10 @@ public class DispatcherResourceCleanupTest extends TestLogger {
 		final TestingJobManagerRunner testingJobManagerRunner = jobManagerRunnerFactory.takeCreatedJobManagerRunner();
 		testingJobManagerRunner.completeResultFutureExceptionally(new JobNotFinishedException(jobId));
 
+		// wait until termination JobManagerRunner closeAsync has been called.
+		// this is necessary to avoid race conditions with completion of the 1st job and the submission of the 2nd job (DuplicateJobSubmissionException).
+		testingJobManagerRunner.getCloseAsyncCalledLatch().await();
+
 		final CompletableFuture<Acknowledge> submissionFuture = dispatcherGateway.submitJob(jobGraph, timeout);
 
 		try {
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/jobmaster/TestingJobManagerRunner.java b/flink-runtime/src/test/java/org/apache/flink/runtime/jobmaster/TestingJobManagerRunner.java
index b9a480c14f7..5e3edfdb00a 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/jobmaster/TestingJobManagerRunner.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/jobmaster/TestingJobManagerRunner.java
@@ -19,6 +19,7 @@
 package org.apache.flink.runtime.jobmaster;
 
 import org.apache.flink.api.common.JobID;
+import org.apache.flink.core.testutils.OneShotLatch;
 import org.apache.flink.runtime.executiongraph.ArchivedExecutionGraph;
 import org.apache.flink.util.Preconditions;
 
@@ -39,6 +40,8 @@ public class TestingJobManagerRunner implements JobManagerRunner {
 
 	private final CompletableFuture<ArchivedExecutionGraph> resultFuture;
 
+	private final OneShotLatch closeAsyncCalledLatch = new OneShotLatch();
+
 	private TestingJobManagerRunner(JobID jobId,
 			boolean blockingTermination,
 			CompletableFuture<JobMasterGateway> jobMasterGatewayFuture,
@@ -76,9 +79,14 @@ public class TestingJobManagerRunner implements JobManagerRunner {
 			terminationFuture.complete(null);
 		}
 
+		closeAsyncCalledLatch.trigger();
 		return terminationFuture;
 	}
 
+	public OneShotLatch getCloseAsyncCalledLatch() {
+		return closeAsyncCalledLatch;
+	}
+
 	public void completeResultFuture(ArchivedExecutionGraph archivedExecutionGraph) {
 		resultFuture.complete(archivedExecutionGraph);
 	}
