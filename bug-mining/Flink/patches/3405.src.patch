diff --git a/flink-java/src/main/java/org/apache/flink/api/java/Utils.java b/flink-java/src/main/java/org/apache/flink/api/java/Utils.java
index c514b333ec9..23528330634 100644
--- a/flink-java/src/main/java/org/apache/flink/api/java/Utils.java
+++ b/flink-java/src/main/java/org/apache/flink/api/java/Utils.java
@@ -36,6 +36,7 @@ import javax.annotation.Nullable;
 import java.io.IOException;
 import java.lang.reflect.Field;
 import java.lang.reflect.Modifier;
+import java.util.Arrays;
 import java.util.Optional;
 import java.util.Random;
 
@@ -317,6 +318,32 @@ public final class Utils {
 		return Optional.ofNullable(factory);
 	}
 
+	/**
+	 * Get the key from the given args. Keys have to start with '-' or '--'. For example, --key1 value1 -key2 value2.
+	 * @param args all given args.
+	 * @param index the index of args to be parsed.
+	 * @return the key of the given arg.
+	 */
+	public static String getKeyFromArgs(String[] args, int index) {
+		String key;
+		if (args[index].startsWith("--")) {
+			key = args[index].substring(2);
+		} else if (args[index].startsWith("-")) {
+			key = args[index].substring(1);
+		} else {
+			throw new IllegalArgumentException(
+				String.format("Error parsing arguments '%s' on '%s'. Please prefix keys with -- or -.",
+					Arrays.toString(args), args[index]));
+		}
+
+		if (key.isEmpty()) {
+			throw new IllegalArgumentException(
+				"The input " + Arrays.toString(args) + " contains an empty argument");
+		}
+
+		return key;
+	}
+
 	/**
 	 * Private constructor to prevent instantiation.
 	 */
diff --git a/flink-java/src/main/java/org/apache/flink/api/java/utils/AbstractParameterTool.java b/flink-java/src/main/java/org/apache/flink/api/java/utils/AbstractParameterTool.java
new file mode 100644
index 00000000000..439e9ff3e83
--- /dev/null
+++ b/flink-java/src/main/java/org/apache/flink/api/java/utils/AbstractParameterTool.java
@@ -0,0 +1,308 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.api.java.utils;
+
+import org.apache.flink.annotation.Public;
+import org.apache.flink.annotation.PublicEvolving;
+import org.apache.flink.api.common.ExecutionConfig;
+
+import java.io.Serializable;
+import java.util.Collections;
+import java.util.Map;
+import java.util.Set;
+
+/**
+ * This class provides common utility methods of {@link ParameterTool} and {@link MultipleParameterTool}.
+ */
+@Public
+public abstract class AbstractParameterTool extends ExecutionConfig.GlobalJobParameters implements Serializable, Cloneable {
+	private static final long serialVersionUID = 1L;
+
+	protected static final String NO_VALUE_KEY = "__NO_VALUE_KEY";
+	protected static final String DEFAULT_UNDEFINED = "<undefined>";
+
+	// ------------------ ParameterUtil  ------------------------
+
+	// data which is only used on the client and does not need to be transmitted
+	protected transient Map<String, String> defaultData;
+	protected transient Set<String> unrequestedParameters;
+
+	/**
+	 * Returns the set of parameter names which have not been requested with
+	 * {@link #has(String)} or one of the {@code get} methods. Access to the
+	 * map returned by {@link #toMap()} is not tracked.
+	 */
+	@PublicEvolving
+	public Set<String> getUnrequestedParameters() {
+		return Collections.unmodifiableSet(unrequestedParameters);
+	}
+
+	// ------------------ Get data from the util ----------------
+
+	/**
+	 * Returns number of parameters in {@link AbstractParameterTool}.
+	 */
+	protected abstract int getNumberOfParameters();
+
+	/**
+	 * Returns the String value for the given key.
+	 * If the key does not exist it will return null.
+	 */
+	protected abstract String get(String key);
+
+	/**
+	 * Check if value is set.
+	 */
+	public abstract boolean has(String value);
+
+	/**
+	 * Returns the String value for the given key.
+	 * If the key does not exist it will throw a {@link RuntimeException}.
+	 */
+	public String getRequired(String key) {
+		addToDefaults(key, null);
+		String value = get(key);
+		if (value == null) {
+			throw new RuntimeException("No data for required key '" + key + "'");
+		}
+		return value;
+	}
+
+	/**
+	 * Returns the String value for the given key.
+	 * If the key does not exist it will return the given default value.
+	 */
+	public String get(String key, String defaultValue) {
+		addToDefaults(key, defaultValue);
+		String value = get(key);
+		if (value == null) {
+			return defaultValue;
+		} else {
+			return value;
+		}
+	}
+
+	// -------------- Integer
+
+	/**
+	 * Returns the Integer value for the given key.
+	 * The method fails if the key does not exist or the value is not an Integer.
+	 */
+	public int getInt(String key) {
+		addToDefaults(key, null);
+		String value = getRequired(key);
+		return Integer.parseInt(value);
+	}
+
+	/**
+	 * Returns the Integer value for the given key. If the key does not exists it will return the default value given.
+	 * The method fails if the value is not an Integer.
+	 */
+	public int getInt(String key, int defaultValue) {
+		addToDefaults(key, Integer.toString(defaultValue));
+		String value = get(key);
+		if (value == null) {
+			return defaultValue;
+		}
+		return Integer.parseInt(value);
+	}
+
+	// -------------- LONG
+
+	/**
+	 * Returns the Long value for the given key.
+	 * The method fails if the key does not exist.
+	 */
+	public long getLong(String key) {
+		addToDefaults(key, null);
+		String value = getRequired(key);
+		return Long.parseLong(value);
+	}
+
+	/**
+	 * Returns the Long value for the given key. If the key does not exists it will return the default value given.
+	 * The method fails if the value is not a Long.
+	 */
+	public long getLong(String key, long defaultValue) {
+		addToDefaults(key, Long.toString(defaultValue));
+		String value = get(key);
+		if (value == null) {
+			return defaultValue;
+		}
+		return Long.parseLong(value);
+	}
+
+	// -------------- FLOAT
+
+	/**
+	 * Returns the Float value for the given key.
+	 * The method fails if the key does not exist.
+	 */
+	public float getFloat(String key) {
+		addToDefaults(key, null);
+		String value = getRequired(key);
+		return Float.valueOf(value);
+	}
+
+	/**
+	 * Returns the Float value for the given key. If the key does not exists it will return the default value given.
+	 * The method fails if the value is not a Float.
+	 */
+	public float getFloat(String key, float defaultValue) {
+		addToDefaults(key, Float.toString(defaultValue));
+		String value = get(key);
+		if (value == null) {
+			return defaultValue;
+		} else {
+			return Float.valueOf(value);
+		}
+	}
+
+	// -------------- DOUBLE
+
+	/**
+	 * Returns the Double value for the given key.
+	 * The method fails if the key does not exist.
+	 */
+	public double getDouble(String key) {
+		addToDefaults(key, null);
+		String value = getRequired(key);
+		return Double.valueOf(value);
+	}
+
+	/**
+	 * Returns the Double value for the given key. If the key does not exists it will return the default value given.
+	 * The method fails if the value is not a Double.
+	 */
+	public double getDouble(String key, double defaultValue) {
+		addToDefaults(key, Double.toString(defaultValue));
+		String value = get(key);
+		if (value == null) {
+			return defaultValue;
+		} else {
+			return Double.valueOf(value);
+		}
+	}
+
+	// -------------- BOOLEAN
+
+	/**
+	 * Returns the Boolean value for the given key.
+	 * The method fails if the key does not exist.
+	 */
+	public boolean getBoolean(String key) {
+		addToDefaults(key, null);
+		String value = getRequired(key);
+		return Boolean.valueOf(value);
+	}
+
+	/**
+	 * Returns the Boolean value for the given key. If the key does not exists it will return the default value given.
+	 * The method returns whether the string of the value is "true" ignoring cases.
+	 */
+	public boolean getBoolean(String key, boolean defaultValue) {
+		addToDefaults(key, Boolean.toString(defaultValue));
+		String value = get(key);
+		if (value == null) {
+			return defaultValue;
+		} else {
+			return Boolean.valueOf(value);
+		}
+	}
+
+	// -------------- SHORT
+
+	/**
+	 * Returns the Short value for the given key.
+	 * The method fails if the key does not exist.
+	 */
+	public short getShort(String key) {
+		addToDefaults(key, null);
+		String value = getRequired(key);
+		return Short.valueOf(value);
+	}
+
+	/**
+	 * Returns the Short value for the given key. If the key does not exists it will return the default value given.
+	 * The method fails if the value is not a Short.
+	 */
+	public short getShort(String key, short defaultValue) {
+		addToDefaults(key, Short.toString(defaultValue));
+		String value = get(key);
+		if (value == null) {
+			return defaultValue;
+		} else {
+			return Short.valueOf(value);
+		}
+	}
+
+	// -------------- BYTE
+
+	/**
+	 * Returns the Byte value for the given key.
+	 * The method fails if the key does not exist.
+	 */
+	public byte getByte(String key) {
+		addToDefaults(key, null);
+		String value = getRequired(key);
+		return Byte.valueOf(value);
+	}
+
+	/**
+	 * Returns the Byte value for the given key. If the key does not exists it will return the default value given.
+	 * The method fails if the value is not a Byte.
+	 */
+	public byte getByte(String key, byte defaultValue) {
+		addToDefaults(key, Byte.toString(defaultValue));
+		String value = get(key);
+		if (value == null) {
+			return defaultValue;
+		} else {
+			return Byte.valueOf(value);
+		}
+	}
+
+	// --------------- Internals
+
+	protected void addToDefaults(String key, String value) {
+		final String currentValue = defaultData.get(key);
+		if (currentValue == null) {
+			if (value == null) {
+				value = DEFAULT_UNDEFINED;
+			}
+			defaultData.put(key, value);
+		} else {
+			// there is already an entry for this key. Check if the value is the undefined
+			if (currentValue.equals(DEFAULT_UNDEFINED) && value != null) {
+				// update key with better default value
+				defaultData.put(key, value);
+			}
+		}
+	}
+
+	// ------------------------- Export to different targets -------------------------
+
+	@Override
+	protected abstract Object clone() throws CloneNotSupportedException;
+
+	// ------------------------- ExecutionConfig.UserConfig interface -------------------------
+
+	@Override
+	public abstract Map<String, String> toMap();
+}
diff --git a/flink-java/src/main/java/org/apache/flink/api/java/utils/MultipleParameterTool.java b/flink-java/src/main/java/org/apache/flink/api/java/utils/MultipleParameterTool.java
new file mode 100644
index 00000000000..1e68db2bbfa
--- /dev/null
+++ b/flink-java/src/main/java/org/apache/flink/api/java/utils/MultipleParameterTool.java
@@ -0,0 +1,272 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.api.java.utils;
+
+import org.apache.flink.annotation.PublicEvolving;
+import org.apache.flink.api.java.Utils;
+import org.apache.flink.util.Preconditions;
+
+import org.apache.commons.lang3.math.NumberUtils;
+
+import java.io.IOException;
+import java.io.ObjectInputStream;
+import java.util.ArrayList;
+import java.util.Collection;
+import java.util.Collections;
+import java.util.HashMap;
+import java.util.HashSet;
+import java.util.Map;
+import java.util.Objects;
+import java.util.concurrent.ConcurrentHashMap;
+import java.util.stream.Collectors;
+
+/**
+ * This class provides simple utility methods for reading and parsing program arguments from different sources.
+ * Multiple values parameter in args could be supported. For example, --multi multiValue1 --multi multiValue2.
+ * If {@link MultipleParameterTool} object is used for GlobalJobParameters, the last one of multiple values will be used.
+ * Navigate to {@link #toMap()} for more information.
+ */
+@PublicEvolving
+public class MultipleParameterTool extends AbstractParameterTool {
+	private static final long serialVersionUID = 1L;
+
+	// ------------------ Constructors ------------------------
+
+	/**
+	 * Returns {@link MultipleParameterTool} for the given arguments. The arguments are keys followed by values.
+	 * Keys have to start with '-' or '--'
+	 *
+	 * <p><strong>Example arguments:</strong>
+	 * --key1 value1 --key2 value2 -key3 value3
+	 * --multi multiValue1 --multi multiValue2
+	 *
+	 * @param args Input array arguments
+	 * @return A {@link MultipleParameterTool}
+	 */
+	public static MultipleParameterTool fromArgs(String[] args) {
+		final Map<String, Collection<String>> map = new HashMap<>(args.length / 2);
+
+		int i = 0;
+		while (i < args.length) {
+			final String key = Utils.getKeyFromArgs(args, i);
+
+			i += 1; // try to find the value
+
+			map.putIfAbsent(key, new ArrayList<>());
+			if (i >= args.length) {
+				map.get(key).add(NO_VALUE_KEY);
+			} else if (NumberUtils.isNumber(args[i])) {
+				map.get(key).add(args[i]);
+				i += 1;
+			} else if (args[i].startsWith("--") || args[i].startsWith("-")) {
+				// the argument cannot be a negative number because we checked earlier
+				// -> the next argument is a parameter name
+				map.get(key).add(NO_VALUE_KEY);
+			} else {
+				map.get(key).add(args[i]);
+				i += 1;
+			}
+		}
+
+		return fromMultiMap(map);
+	}
+
+	/**
+	 * Returns {@link MultipleParameterTool} for the given multi map.
+	 *
+	 * @param multiMap A map of arguments. Key is String and value is a Collection.
+	 * @return A {@link MultipleParameterTool}
+	 */
+	public static MultipleParameterTool fromMultiMap(Map<String, Collection<String>> multiMap) {
+		Preconditions.checkNotNull(multiMap, "Unable to initialize from empty map");
+		return new MultipleParameterTool(multiMap);
+	}
+
+	// ------------------ ParameterUtil  ------------------------
+	protected final Map<String, Collection<String>> data;
+
+	private MultipleParameterTool(Map<String, Collection<String>> data) {
+		this.data = Collections.unmodifiableMap(new HashMap<>(data));
+
+		this.defaultData = new ConcurrentHashMap<>(data.size());
+
+		this.unrequestedParameters = Collections.newSetFromMap(new ConcurrentHashMap<>(data.size()));
+
+		unrequestedParameters.addAll(data.keySet());
+	}
+
+	@Override
+	public boolean equals(Object o) {
+		if (this == o) {
+			return true;
+		}
+		if (o == null || getClass() != o.getClass()) {
+			return false;
+		}
+		MultipleParameterTool that = (MultipleParameterTool) o;
+		return Objects.equals(data, that.data) &&
+			Objects.equals(defaultData, that.defaultData) &&
+			Objects.equals(unrequestedParameters, that.unrequestedParameters);
+	}
+
+	@Override
+	public int hashCode() {
+		return Objects.hash(data, defaultData, unrequestedParameters);
+	}
+
+	// ------------------ Get data from the util ----------------
+
+	/**
+	 * Returns number of parameters in {@link ParameterTool}.
+	 */
+	@Override
+	public int getNumberOfParameters() {
+		return data.size();
+	}
+
+	/**
+	 * Returns the String value for the given key. The value should only have one item.
+	 * Use {@link #getMultiParameter(String)} instead if want to get multiple values parameter.
+	 * If the key does not exist it will return null.
+	 */
+	@Override
+	public String get(String key) {
+		addToDefaults(key, null);
+		unrequestedParameters.remove(key);
+		if (!data.containsKey(key)) {
+			return null;
+		}
+		Preconditions.checkState(data.get(key).size() == 1,
+			"Key %s should has only one value.", key);
+		return (String) data.get(key).toArray()[0];
+	}
+
+	/**
+	 * Check if value is set.
+	 */
+	@Override
+	public boolean has(String value) {
+		addToDefaults(value, null);
+		unrequestedParameters.remove(value);
+		return data.containsKey(value);
+	}
+
+	/**
+	 * Returns the Collection of String values for the given key.
+	 * If the key does not exist it will return null.
+	 */
+	public Collection<String> getMultiParameter(String key) {
+		addToDefaults(key, null);
+		unrequestedParameters.remove(key);
+		return data.getOrDefault(key, null);
+	}
+
+	/**
+	 * Returns the Collection of String values for the given key.
+	 * If the key does not exist it will throw a {@link RuntimeException}.
+	 */
+	public Collection<String> getMultiParameterRequired(String key) {
+		addToDefaults(key, null);
+		Collection<String> value = getMultiParameter(key);
+		if (value == null) {
+			throw new RuntimeException("No data for required key '" + key + "'");
+		}
+		return value;
+	}
+
+	// ------------------------- Export to different targets -------------------------
+
+	/**
+	 * Return MultiMap of all the parameters processed by {@link MultipleParameterTool}.
+	 *
+	 * @return MultiMap of the {@link MultipleParameterTool}. Key is String and Value is a Collection of String.
+	 */
+	public Map<String, Collection<String>> toMultiMap() {
+		return data;
+	}
+
+	@Override
+	protected Object clone() throws CloneNotSupportedException {
+		return new MultipleParameterTool(this.data);
+	}
+
+	// ------------------------- Interaction with other ParameterUtils -------------------------
+
+	/**
+	 * Merges two {@link MultipleParameterTool}.
+	 *
+	 * @param other Other {@link MultipleParameterTool} object
+	 * @return The Merged {@link MultipleParameterTool}
+	 */
+	public MultipleParameterTool mergeWith(MultipleParameterTool other) {
+		final Map<String, Collection<String>> resultData = new HashMap<>(data.size() + other.data.size());
+		resultData.putAll(data);
+		other.data.forEach((key, value) -> {
+			resultData.putIfAbsent(key, new ArrayList<>());
+			resultData.get(key).addAll(value);
+		});
+
+		final MultipleParameterTool ret = new MultipleParameterTool(resultData);
+
+		final HashSet<String> requestedParametersLeft = new HashSet<>(data.keySet());
+		requestedParametersLeft.removeAll(unrequestedParameters);
+
+		final HashSet<String> requestedParametersRight = new HashSet<>(other.data.keySet());
+		requestedParametersRight.removeAll(other.unrequestedParameters);
+
+		ret.unrequestedParameters.removeAll(requestedParametersLeft);
+		ret.unrequestedParameters.removeAll(requestedParametersRight);
+
+		return ret;
+	}
+
+	// ------------------------- ExecutionConfig.UserConfig interface -------------------------
+
+	@Override
+	public Map<String, String> toMap() {
+		return getFlatMapOfData(data);
+	}
+
+	/**
+	 * Get the flat map of the multiple map data. If the key have multiple values, only the last one will be used. This
+	 * is also the current behavior when multiple parameters is specified for {@link ParameterTool}.
+	 * @param data multiple map of data.
+	 * @return flat map of data.
+	 */
+	private static Map<String, String> getFlatMapOfData(Map<String, Collection<String>> data) {
+		return data.entrySet().stream().collect(Collectors.toMap(
+			Map.Entry::getKey,
+			e -> {
+				if (e.getValue().size() > 0) {
+					return (String) e.getValue().toArray()[e.getValue().size() - 1];
+				} else {
+					return NO_VALUE_KEY;
+				}
+			}));
+	}
+
+	// ------------------------- Serialization ---------------------------------------------
+
+	private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException {
+		in.defaultReadObject();
+
+		defaultData = new ConcurrentHashMap<>(data.size());
+		unrequestedParameters = Collections.newSetFromMap(new ConcurrentHashMap<>(data.size()));
+	}
+}
diff --git a/flink-java/src/main/java/org/apache/flink/api/java/utils/ParameterTool.java b/flink-java/src/main/java/org/apache/flink/api/java/utils/ParameterTool.java
index 33b6ab9d379..9d9ef3da56b 100644
--- a/flink-java/src/main/java/org/apache/flink/api/java/utils/ParameterTool.java
+++ b/flink-java/src/main/java/org/apache/flink/api/java/utils/ParameterTool.java
@@ -19,8 +19,7 @@
 package org.apache.flink.api.java.utils;
 
 import org.apache.flink.annotation.Public;
-import org.apache.flink.annotation.PublicEvolving;
-import org.apache.flink.api.common.ExecutionConfig;
+import org.apache.flink.api.java.Utils;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.util.Preconditions;
 
@@ -34,7 +33,6 @@ import java.io.IOException;
 import java.io.InputStream;
 import java.io.ObjectInputStream;
 import java.io.OutputStream;
-import java.io.Serializable;
 import java.util.Arrays;
 import java.util.Collections;
 import java.util.HashMap;
@@ -42,19 +40,16 @@ import java.util.HashSet;
 import java.util.Map;
 import java.util.Objects;
 import java.util.Properties;
-import java.util.Set;
 import java.util.concurrent.ConcurrentHashMap;
 
 /**
  * This class provides simple utility methods for reading and parsing program arguments from different sources.
+ * Only single value parameter could be supported in args.
  */
 @Public
-public class ParameterTool extends ExecutionConfig.GlobalJobParameters implements Serializable, Cloneable {
+public class ParameterTool extends AbstractParameterTool {
 	private static final long serialVersionUID = 1L;
 
-	protected static final String NO_VALUE_KEY = "__NO_VALUE_KEY";
-	protected static final String DEFAULT_UNDEFINED = "<undefined>";
-
 	// ------------------ Constructors ------------------------
 
 	/**
@@ -72,17 +67,7 @@ public class ParameterTool extends ExecutionConfig.GlobalJobParameters implement
 
 		int i = 0;
 		while (i < args.length) {
-			final String key;
-
-			if (args[i].startsWith("--")) {
-				key = args[i].substring(2);
-			} else if (args[i].startsWith("-")) {
-				key = args[i].substring(1);
-			} else {
-				throw new IllegalArgumentException(
-					String.format("Error parsing arguments '%s' on '%s'. Please prefix keys with -- or -.",
-						Arrays.toString(args), args[i]));
-			}
+			final String key = Utils.getKeyFromArgs(args, i);
 
 			if (key.isEmpty()) {
 				throw new IllegalArgumentException(
@@ -178,10 +163,6 @@ public class ParameterTool extends ExecutionConfig.GlobalJobParameters implement
 	// ------------------ ParameterUtil  ------------------------
 	protected final Map<String, String> data;
 
-	// data which is only used on the client and does not need to be transmitted
-	protected transient Map<String, String> defaultData;
-	protected transient Set<String> unrequestedParameters;
-
 	private ParameterTool(Map<String, String> data) {
 		this.data = Collections.unmodifiableMap(new HashMap<>(data));
 
@@ -211,21 +192,12 @@ public class ParameterTool extends ExecutionConfig.GlobalJobParameters implement
 		return Objects.hash(data, defaultData, unrequestedParameters);
 	}
 
-	/**
-	 * Returns the set of parameter names which have not been requested with
-	 * {@link #has(String)} or one of the {@code get} methods. Access to the
-	 * map returned by {@link #toMap()} is not tracked.
-	 */
-	@PublicEvolving
-	public Set<String> getUnrequestedParameters() {
-		return Collections.unmodifiableSet(unrequestedParameters);
-	}
-
 	// ------------------ Get data from the util ----------------
 
 	/**
 	 * Returns number of parameters in {@link ParameterTool}.
 	 */
+	@Override
 	public int getNumberOfParameters() {
 		return data.size();
 	}
@@ -234,246 +206,23 @@ public class ParameterTool extends ExecutionConfig.GlobalJobParameters implement
 	 * Returns the String value for the given key.
 	 * If the key does not exist it will return null.
 	 */
+	@Override
 	public String get(String key) {
 		addToDefaults(key, null);
 		unrequestedParameters.remove(key);
 		return data.get(key);
 	}
 
-	/**
-	 * Returns the String value for the given key.
-	 * If the key does not exist it will throw a {@link RuntimeException}.
-	 */
-	public String getRequired(String key) {
-		addToDefaults(key, null);
-		String value = get(key);
-		if (value == null) {
-			throw new RuntimeException("No data for required key '" + key + "'");
-		}
-		return value;
-	}
-
-	/**
-	 * Returns the String value for the given key.
-	 * If the key does not exist it will return the given default value.
-	 */
-	public String get(String key, String defaultValue) {
-		addToDefaults(key, defaultValue);
-		String value = get(key);
-		if (value == null) {
-			return defaultValue;
-		} else {
-			return value;
-		}
-	}
-
 	/**
 	 * Check if value is set.
 	 */
+	@Override
 	public boolean has(String value) {
 		addToDefaults(value, null);
 		unrequestedParameters.remove(value);
 		return data.containsKey(value);
 	}
 
-	// -------------- Integer
-
-	/**
-	 * Returns the Integer value for the given key.
-	 * The method fails if the key does not exist or the value is not an Integer.
-	 */
-	public int getInt(String key) {
-		addToDefaults(key, null);
-		String value = getRequired(key);
-		return Integer.parseInt(value);
-	}
-
-	/**
-	 * Returns the Integer value for the given key. If the key does not exists it will return the default value given.
-	 * The method fails if the value is not an Integer.
-	 */
-	public int getInt(String key, int defaultValue) {
-		addToDefaults(key, Integer.toString(defaultValue));
-		String value = get(key);
-		if (value == null) {
-			return defaultValue;
-		}
-		return Integer.parseInt(value);
-	}
-
-	// -------------- LONG
-
-	/**
-	 * Returns the Long value for the given key.
-	 * The method fails if the key does not exist.
-	 */
-	public long getLong(String key) {
-		addToDefaults(key, null);
-		String value = getRequired(key);
-		return Long.parseLong(value);
-	}
-
-	/**
-	 * Returns the Long value for the given key. If the key does not exists it will return the default value given.
-	 * The method fails if the value is not a Long.
-	 */
-	public long getLong(String key, long defaultValue) {
-		addToDefaults(key, Long.toString(defaultValue));
-		String value = get(key);
-		if (value == null) {
-			return defaultValue;
-		}
-		return Long.parseLong(value);
-	}
-
-	// -------------- FLOAT
-
-	/**
-	 * Returns the Float value for the given key.
-	 * The method fails if the key does not exist.
-	 */
-	public float getFloat(String key) {
-		addToDefaults(key, null);
-		String value = getRequired(key);
-		return Float.valueOf(value);
-	}
-
-	/**
-	 * Returns the Float value for the given key. If the key does not exists it will return the default value given.
-	 * The method fails if the value is not a Float.
-	 */
-	public float getFloat(String key, float defaultValue) {
-		addToDefaults(key, Float.toString(defaultValue));
-		String value = get(key);
-		if (value == null) {
-			return defaultValue;
-		} else {
-			return Float.valueOf(value);
-		}
-	}
-
-	// -------------- DOUBLE
-
-	/**
-	 * Returns the Double value for the given key.
-	 * The method fails if the key does not exist.
-	 */
-	public double getDouble(String key) {
-		addToDefaults(key, null);
-		String value = getRequired(key);
-		return Double.valueOf(value);
-	}
-
-	/**
-	 * Returns the Double value for the given key. If the key does not exists it will return the default value given.
-	 * The method fails if the value is not a Double.
-	 */
-	public double getDouble(String key, double defaultValue) {
-		addToDefaults(key, Double.toString(defaultValue));
-		String value = get(key);
-		if (value == null) {
-			return defaultValue;
-		} else {
-			return Double.valueOf(value);
-		}
-	}
-
-	// -------------- BOOLEAN
-
-	/**
-	 * Returns the Boolean value for the given key.
-	 * The method fails if the key does not exist.
-	 */
-	public boolean getBoolean(String key) {
-		addToDefaults(key, null);
-		String value = getRequired(key);
-		return Boolean.valueOf(value);
-	}
-
-	/**
-	 * Returns the Boolean value for the given key. If the key does not exists it will return the default value given.
-	 * The method returns whether the string of the value is "true" ignoring cases.
-	 */
-	public boolean getBoolean(String key, boolean defaultValue) {
-		addToDefaults(key, Boolean.toString(defaultValue));
-		String value = get(key);
-		if (value == null) {
-			return defaultValue;
-		} else {
-			return Boolean.valueOf(value);
-		}
-	}
-
-	// -------------- SHORT
-
-	/**
-	 * Returns the Short value for the given key.
-	 * The method fails if the key does not exist.
-	 */
-	public short getShort(String key) {
-		addToDefaults(key, null);
-		String value = getRequired(key);
-		return Short.valueOf(value);
-	}
-
-	/**
-	 * Returns the Short value for the given key. If the key does not exists it will return the default value given.
-	 * The method fails if the value is not a Short.
-	 */
-	public short getShort(String key, short defaultValue) {
-		addToDefaults(key, Short.toString(defaultValue));
-		String value = get(key);
-		if (value == null) {
-			return defaultValue;
-		} else {
-			return Short.valueOf(value);
-		}
-	}
-
-	// -------------- BYTE
-
-	/**
-	 * Returns the Byte value for the given key.
-	 * The method fails if the key does not exist.
-	 */
-	public byte getByte(String key) {
-		addToDefaults(key, null);
-		String value = getRequired(key);
-		return Byte.valueOf(value);
-	}
-
-	/**
-	 * Returns the Byte value for the given key. If the key does not exists it will return the default value given.
-	 * The method fails if the value is not a Byte.
-	 */
-	public byte getByte(String key, byte defaultValue) {
-		addToDefaults(key, Byte.toString(defaultValue));
-		String value = get(key);
-		if (value == null) {
-			return defaultValue;
-		} else {
-			return Byte.valueOf(value);
-		}
-	}
-
-	// --------------- Internals
-
-	protected void addToDefaults(String key, String value) {
-		final String currentValue = defaultData.get(key);
-		if (currentValue == null) {
-			if (value == null) {
-				value = DEFAULT_UNDEFINED;
-			}
-			defaultData.put(key, value);
-		} else {
-			// there is already an entry for this key. Check if the value is the undefined
-			if (currentValue.equals(DEFAULT_UNDEFINED) && value != null) {
-				// update key with better default value
-				defaultData.put(key, value);
-			}
-		}
-	}
-
 	// ------------------------- Export to different targets -------------------------
 
 	/**
diff --git a/flink-java/src/test/java/org/apache/flink/api/java/utils/AbstractParameterToolTest.java b/flink-java/src/test/java/org/apache/flink/api/java/utils/AbstractParameterToolTest.java
index 40cf28e7b84..07e7c35f20f 100644
--- a/flink-java/src/test/java/org/apache/flink/api/java/utils/AbstractParameterToolTest.java
+++ b/flink-java/src/test/java/org/apache/flink/api/java/utils/AbstractParameterToolTest.java
@@ -24,11 +24,18 @@ import org.apache.flink.util.InstantiationUtil;
 
 import org.junit.Assert;
 import org.junit.Rule;
+import org.junit.Test;
+import org.junit.rules.ExpectedException;
 import org.junit.rules.TemporaryFolder;
 
 import java.io.FileInputStream;
 import java.io.IOException;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.HashSet;
+import java.util.List;
 import java.util.Properties;
+import java.util.Set;
 
 /**
  * Base class for tests for {@link ParameterTool}.
@@ -38,21 +45,511 @@ public abstract class AbstractParameterToolTest {
 	@Rule
 	public TemporaryFolder tmp = new TemporaryFolder();
 
-	protected void validate(ParameterTool parameter) {
+	@Rule
+	public final ExpectedException exception = ExpectedException.none();
+
+	// Test parser
+
+	@Test
+	public void testThrowExceptionIfParameterIsNotPrefixed() {
+		exception.expect(IllegalArgumentException.class);
+		exception.expectMessage("Error parsing arguments '[a]' on 'a'. Please prefix keys with -- or -.");
+
+		createParameterToolFromArgs(new String[]{"a"});
+	}
+
+	@Test
+	public void testNoVal() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-berlin"});
+		Assert.assertEquals(1, parameter.getNumberOfParameters());
+		Assert.assertTrue(parameter.has("berlin"));
+	}
+
+	@Test
+	public void testNoValDouble() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"--berlin"});
+		Assert.assertEquals(1, parameter.getNumberOfParameters());
+		Assert.assertTrue(parameter.has("berlin"));
+	}
+
+	@Test
+	public void testMultipleNoVal() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"--a", "--b", "--c", "--d", "--e", "--f"});
+		Assert.assertEquals(6, parameter.getNumberOfParameters());
+		Assert.assertTrue(parameter.has("a"));
+		Assert.assertTrue(parameter.has("b"));
+		Assert.assertTrue(parameter.has("c"));
+		Assert.assertTrue(parameter.has("d"));
+		Assert.assertTrue(parameter.has("e"));
+		Assert.assertTrue(parameter.has("f"));
+	}
+
+	@Test
+	public void testMultipleNoValMixed() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"--a", "-b", "-c", "-d", "--e", "--f"});
+		Assert.assertEquals(6, parameter.getNumberOfParameters());
+		Assert.assertTrue(parameter.has("a"));
+		Assert.assertTrue(parameter.has("b"));
+		Assert.assertTrue(parameter.has("c"));
+		Assert.assertTrue(parameter.has("d"));
+		Assert.assertTrue(parameter.has("e"));
+		Assert.assertTrue(parameter.has("f"));
+	}
+
+	@Test
+	public void testEmptyVal() {
+		exception.expect(IllegalArgumentException.class);
+		exception.expectMessage("The input [--a, -b, --] contains an empty argument");
+
+		createParameterToolFromArgs(new String[]{"--a", "-b", "--"});
+	}
+
+	@Test
+	public void testEmptyValShort() {
+		exception.expect(IllegalArgumentException.class);
+		exception.expectMessage("The input [--a, -b, -] contains an empty argument");
+
+		createParameterToolFromArgs(new String[]{"--a", "-b", "-"});
+	}
+
+	// Test unrequested
+	// Boolean
+
+	@Test
+	public void testUnrequestedBoolean() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-boolean", "true"});
+		Assert.assertEquals(createHashSet("boolean"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertTrue(parameter.getBoolean("boolean"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertTrue(parameter.getBoolean("boolean"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedBooleanWithDefaultValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-boolean", "true"});
+		Assert.assertEquals(createHashSet("boolean"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertTrue(parameter.getBoolean("boolean", false));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertTrue(parameter.getBoolean("boolean", false));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedBooleanWithMissingValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-boolean"});
+		Assert.assertEquals(createHashSet("boolean"), parameter.getUnrequestedParameters());
+
+		parameter.getBoolean("boolean");
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	// Byte
+
+	@Test
+	public void testUnrequestedByte() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-byte", "1"});
+		Assert.assertEquals(createHashSet("byte"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(1, parameter.getByte("byte"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(1, parameter.getByte("byte"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedByteWithDefaultValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-byte", "1"});
+		Assert.assertEquals(createHashSet("byte"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(1, parameter.getByte("byte", (byte) 0));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(1, parameter.getByte("byte", (byte) 0));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedByteWithMissingValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-byte"});
+		Assert.assertEquals(createHashSet("byte"), parameter.getUnrequestedParameters());
+
+		exception.expect(RuntimeException.class);
+		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
+
+		parameter.getByte("byte");
+	}
+
+	// Short
+
+	@Test
+	public void testUnrequestedShort() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-short", "2"});
+		Assert.assertEquals(createHashSet("short"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(2, parameter.getShort("short"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(2, parameter.getShort("short"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedShortWithDefaultValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-short", "2"});
+		Assert.assertEquals(createHashSet("short"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(2, parameter.getShort("short", (short) 0));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(2, parameter.getShort("short", (short) 0));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedShortWithMissingValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-short"});
+		Assert.assertEquals(createHashSet("short"), parameter.getUnrequestedParameters());
+
+		exception.expect(RuntimeException.class);
+		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
+
+		parameter.getShort("short");
+	}
+
+	// Int
+
+	@Test
+	public void testUnrequestedInt() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-int", "4"});
+		Assert.assertEquals(createHashSet("int"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(4, parameter.getInt("int"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(4, parameter.getInt("int"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedIntWithDefaultValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-int", "4"});
+		Assert.assertEquals(createHashSet("int"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(4, parameter.getInt("int", 0));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(4, parameter.getInt("int", 0));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedIntWithMissingValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-int"});
+		Assert.assertEquals(createHashSet("int"), parameter.getUnrequestedParameters());
+
+		exception.expect(RuntimeException.class);
+		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
+
+		parameter.getInt("int");
+	}
+
+	// Long
+
+	@Test
+	public void testUnrequestedLong() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-long", "8"});
+		Assert.assertEquals(createHashSet("long"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(8, parameter.getLong("long"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(8, parameter.getLong("long"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedLongWithDefaultValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-long", "8"});
+		Assert.assertEquals(createHashSet("long"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(8, parameter.getLong("long", 0));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(8, parameter.getLong("long", 0));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedLongWithMissingValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-long"});
+		Assert.assertEquals(createHashSet("long"), parameter.getUnrequestedParameters());
+
+		exception.expect(RuntimeException.class);
+		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
+
+		parameter.getLong("long");
+	}
+
+	// Float
+
+	@Test
+	public void testUnrequestedFloat() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-float", "4"});
+		Assert.assertEquals(createHashSet("float"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(4.0, parameter.getFloat("float"), 0.00001);
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(4.0, parameter.getFloat("float"), 0.00001);
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedFloatWithDefaultValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-float", "4"});
+		Assert.assertEquals(createHashSet("float"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(4.0, parameter.getFloat("float", 0.0f), 0.00001);
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(4.0, parameter.getFloat("float", 0.0f), 0.00001);
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedFloatWithMissingValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-float"});
+		Assert.assertEquals(createHashSet("float"), parameter.getUnrequestedParameters());
+
+		exception.expect(RuntimeException.class);
+		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
+
+		parameter.getFloat("float");
+	}
+
+	// Double
+
+	@Test
+	public void testUnrequestedDouble() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-double", "8"});
+		Assert.assertEquals(createHashSet("double"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(8.0, parameter.getDouble("double"), 0.00001);
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(8.0, parameter.getDouble("double"), 0.00001);
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedDoubleWithDefaultValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-double", "8"});
+		Assert.assertEquals(createHashSet("double"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals(8.0, parameter.getDouble("double", 0.0), 0.00001);
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals(8.0, parameter.getDouble("double", 0.0), 0.00001);
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedDoubleWithMissingValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-double"});
+		Assert.assertEquals(createHashSet("double"), parameter.getUnrequestedParameters());
+
+		exception.expect(RuntimeException.class);
+		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
+
+		parameter.getDouble("double");
+	}
+
+	// String
+
+	@Test
+	public void testUnrequestedString() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-string", "∞"});
+		Assert.assertEquals(createHashSet("string"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals("∞", parameter.get("string"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals("∞", parameter.get("string"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedStringWithDefaultValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-string", "∞"});
+		Assert.assertEquals(createHashSet("string"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals("∞", parameter.get("string", "0.0"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals("∞", parameter.get("string", "0.0"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedStringWithMissingValue() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-string"});
+		Assert.assertEquals(createHashSet("string"), parameter.getUnrequestedParameters());
+
+		parameter.get("string");
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	// Additional methods
+
+	@Test
+	public void testUnrequestedHas() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-boolean"});
+		Assert.assertEquals(createHashSet("boolean"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertTrue(parameter.has("boolean"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertTrue(parameter.has("boolean"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedRequired() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-required", "∞"});
+		Assert.assertEquals(createHashSet("required"), parameter.getUnrequestedParameters());
+
+		// test parameter access
+		Assert.assertEquals("∞", parameter.getRequired("required"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		// test repeated access
+		Assert.assertEquals("∞", parameter.getRequired("required"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedMultiple() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{"-boolean", "true", "-byte", "1",
+			"-short", "2", "-int", "4", "-long", "8", "-float", "4.0", "-double", "8.0", "-string", "∞"});
+		Assert.assertEquals(createHashSet("boolean", "byte", "short", "int", "long", "float", "double", "string"),
+			parameter.getUnrequestedParameters());
+
+		Assert.assertTrue(parameter.getBoolean("boolean"));
+		Assert.assertEquals(createHashSet("byte", "short", "int", "long", "float", "double", "string"),
+			parameter.getUnrequestedParameters());
+
+		Assert.assertEquals(1, parameter.getByte("byte"));
+		Assert.assertEquals(createHashSet("short", "int", "long", "float", "double", "string"),
+			parameter.getUnrequestedParameters());
+
+		Assert.assertEquals(2, parameter.getShort("short"));
+		Assert.assertEquals(createHashSet("int", "long", "float", "double", "string"),
+			parameter.getUnrequestedParameters());
+
+		Assert.assertEquals(4, parameter.getInt("int"));
+		Assert.assertEquals(createHashSet("long", "float", "double", "string"),
+			parameter.getUnrequestedParameters());
+
+		Assert.assertEquals(8, parameter.getLong("long"));
+		Assert.assertEquals(createHashSet("float", "double", "string"),
+			parameter.getUnrequestedParameters());
+
+		Assert.assertEquals(4.0, parameter.getFloat("float"), 0.00001);
+		Assert.assertEquals(createHashSet("double", "string"),
+			parameter.getUnrequestedParameters());
+
+		Assert.assertEquals(8.0, parameter.getDouble("double"), 0.00001);
+		Assert.assertEquals(createHashSet("string"),
+			parameter.getUnrequestedParameters());
+
+		Assert.assertEquals("∞", parameter.get("string"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testUnrequestedUnknown() {
+		AbstractParameterTool parameter = createParameterToolFromArgs(new String[]{});
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+
+		Assert.assertTrue(parameter.getBoolean("boolean", true));
+		Assert.assertEquals(0, parameter.getByte("byte", (byte) 0));
+		Assert.assertEquals(0, parameter.getShort("short", (short) 0));
+		Assert.assertEquals(0, parameter.getInt("int", 0));
+		Assert.assertEquals(0, parameter.getLong("long", 0));
+		Assert.assertEquals(0, parameter.getFloat("float", 0), 0.00001);
+		Assert.assertEquals(0, parameter.getDouble("double", 0), 0.00001);
+		Assert.assertEquals("0", parameter.get("string", "0"));
+
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	protected AbstractParameterTool createParameterToolFromArgs(String[] args) {
+		return ParameterTool.fromArgs(args);
+	}
+
+	protected static <T> Set<T> createHashSet(T... elements) {
+		Set<T> set = new HashSet<>();
+		for (T element : elements) {
+			set.add(element);
+		}
+		return set;
+	}
+
+	protected void validate(AbstractParameterTool parameter) {
 		ClosureCleaner.ensureSerializable(parameter);
 		internalValidate(parameter);
 
 		// -------- test behaviour after serialization ------------
 		try {
 			byte[] b = InstantiationUtil.serializeObject(parameter);
-			final ParameterTool copy = InstantiationUtil.deserializeObject(b, getClass().getClassLoader());
+			final AbstractParameterTool copy = InstantiationUtil.deserializeObject(b, getClass().getClassLoader());
 			internalValidate(copy);
 		} catch (IOException | ClassNotFoundException e) {
 			throw new RuntimeException(e);
 		}
 	}
 
-	private void internalValidate(ParameterTool parameter) {
+	private void internalValidate(AbstractParameterTool parameter) {
 		Assert.assertEquals("myInput", parameter.getRequired("input"));
 		Assert.assertEquals("myDefaultValue", parameter.get("output", "myDefaultValue"));
 		Assert.assertNull(parameter.get("whatever"));
@@ -61,27 +558,39 @@ public abstract class AbstractParameterToolTest {
 		Assert.assertEquals(42, parameter.getByte("myDefaultByte", (byte) 42));
 		Assert.assertEquals(42, parameter.getShort("myDefaultShort", (short) 42));
 
-		final Configuration config = parameter.getConfiguration();
-		Assert.assertEquals(15L, config.getLong("expectedCount", -1L));
+		if (parameter instanceof ParameterTool) {
+			ParameterTool parameterTool = (ParameterTool) parameter;
+			final Configuration config = parameterTool.getConfiguration();
+			Assert.assertEquals(15L, config.getLong("expectedCount", -1L));
 
-		final Properties props = parameter.getProperties();
-		Assert.assertEquals("myInput", props.getProperty("input"));
+			final Properties props = parameterTool.getProperties();
+			Assert.assertEquals("myInput", props.getProperty("input"));
 
-		// -------- test the default file creation ------------
-		try {
-			final String pathToFile = tmp.newFile().getAbsolutePath();
-			parameter.createPropertiesFile(pathToFile);
-			final Properties defaultProps = new Properties();
-			try (FileInputStream fis = new FileInputStream(pathToFile)) {
-				defaultProps.load(fis);
+			// -------- test the default file creation ------------
+			try {
+				final String pathToFile = tmp.newFile().getAbsolutePath();
+				parameterTool.createPropertiesFile(pathToFile);
+				final Properties defaultProps = new Properties();
+				try (FileInputStream fis = new FileInputStream(pathToFile)) {
+					defaultProps.load(fis);
+				}
+
+				Assert.assertEquals("myDefaultValue", defaultProps.get("output"));
+				Assert.assertEquals("-1", defaultProps.get("expectedCount"));
+				Assert.assertTrue(defaultProps.containsKey("input"));
+
+			} catch (IOException e) {
+				throw new RuntimeException(e);
 			}
+		} else if (parameter instanceof MultipleParameterTool) {
+			MultipleParameterTool multipleParameterTool = (MultipleParameterTool) parameter;
+			List<String> multiValues = Arrays.asList("multiValue1", "multiValue2");
+			Assert.assertEquals(multiValues, multipleParameterTool.getMultiParameter("multi"));
 
-			Assert.assertEquals("myDefaultValue", defaultProps.get("output"));
-			Assert.assertEquals("-1", defaultProps.get("expectedCount"));
-			Assert.assertTrue(defaultProps.containsKey("input"));
+			Assert.assertEquals(multiValues, multipleParameterTool.toMultiMap().get("multi"));
 
-		} catch (IOException e) {
-			throw new RuntimeException(e);
+			// The last value is used.
+			Assert.assertEquals("multiValue2", multipleParameterTool.toMap().get("multi"));
 		}
 	}
 }
diff --git a/flink-java/src/test/java/org/apache/flink/api/java/utils/MultipleParameterToolTest.java b/flink-java/src/test/java/org/apache/flink/api/java/utils/MultipleParameterToolTest.java
new file mode 100644
index 00000000000..b6c8fa31fa8
--- /dev/null
+++ b/flink-java/src/test/java/org/apache/flink/api/java/utils/MultipleParameterToolTest.java
@@ -0,0 +1,79 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.api.java.utils;
+
+import org.junit.Assert;
+import org.junit.Test;
+
+import java.util.Arrays;
+import java.util.Collections;
+
+/**
+ * Tests for {@link MultipleParameterTool}.
+ */
+public class MultipleParameterToolTest extends AbstractParameterToolTest {
+
+	@Test
+	public void testFromCliArgsWithMultipleParameters() {
+		MultipleParameterTool parameter = (MultipleParameterTool) createParameterToolFromArgs(new String[]{
+			"--input", "myInput", "-expectedCount", "15", "--multi", "multiValue1", "--multi", "multiValue2",
+			"--withoutValues", "--negativeFloat", "-0.58", "-isWorking", "true", "--maxByte", "127", "-negativeShort", "-1024"});
+
+		Assert.assertEquals(8, parameter.getNumberOfParameters());
+		validate(parameter);
+		Assert.assertTrue(parameter.has("withoutValues"));
+		Assert.assertEquals(-0.58, parameter.getFloat("negativeFloat"), 0.1);
+		Assert.assertTrue(parameter.getBoolean("isWorking"));
+		Assert.assertEquals(127, parameter.getByte("maxByte"));
+		Assert.assertEquals(-1024, parameter.getShort("negativeShort"));
+
+		exception.expect(IllegalStateException.class);
+		exception.expectMessage("Key multi should has only one value");
+		parameter.get("multi");
+	}
+
+	@Test
+	public void testUnrequestedMultiParameter() {
+		MultipleParameterTool parameter = (MultipleParameterTool) createParameterToolFromArgs(new String[]{
+			"--multi", "v1", "--multi", "v2", "--multi2", "vv1"});
+		Assert.assertEquals(createHashSet("multi", "multi2"), parameter.getUnrequestedParameters());
+
+		Assert.assertEquals(Arrays.asList("v1", "v2"), parameter.getMultiParameter("multi"));
+		Assert.assertEquals(createHashSet("multi2"), parameter.getUnrequestedParameters());
+
+		Assert.assertEquals(Collections.singletonList("vv1"), parameter.getMultiParameterRequired("multi2"));
+		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
+	}
+
+	@Test
+	public void testMerged() {
+		MultipleParameterTool parameter1 = (MultipleParameterTool) createParameterToolFromArgs(new String[]{
+			"--input", "myInput", "--merge", "v1", "--merge", "v2"});
+		MultipleParameterTool parameter2 = (MultipleParameterTool) createParameterToolFromArgs(new String[]{
+			"--multi", "multiValue1", "--multi", "multiValue2", "-expectedCount", "15", "--merge", "v3"});
+		MultipleParameterTool parameter = parameter1.mergeWith(parameter2);
+		validate(parameter);
+		Assert.assertEquals(Arrays.asList("v1", "v2", "v3"), parameter.getMultiParameter("merge"));
+	}
+
+	@Override
+	protected AbstractParameterTool createParameterToolFromArgs(String[] args) {
+		return MultipleParameterTool.fromArgs(args);
+	}
+}
diff --git a/flink-java/src/test/java/org/apache/flink/api/java/utils/ParameterToolTest.java b/flink-java/src/test/java/org/apache/flink/api/java/utils/ParameterToolTest.java
index 69f95de0013..fc2f1277112 100644
--- a/flink-java/src/test/java/org/apache/flink/api/java/utils/ParameterToolTest.java
+++ b/flink-java/src/test/java/org/apache/flink/api/java/utils/ParameterToolTest.java
@@ -19,9 +19,7 @@
 package org.apache.flink.api.java.utils;
 
 import org.junit.Assert;
-import org.junit.Rule;
 import org.junit.Test;
-import org.junit.rules.ExpectedException;
 
 import java.io.ByteArrayInputStream;
 import java.io.ByteArrayOutputStream;
@@ -34,11 +32,8 @@ import java.io.ObjectOutputStream;
 import java.io.OutputStream;
 import java.util.ArrayList;
 import java.util.Collection;
-import java.util.Collections;
-import java.util.HashSet;
 import java.util.Map;
 import java.util.Properties;
-import java.util.Set;
 import java.util.UUID;
 import java.util.concurrent.CompletableFuture;
 import java.util.concurrent.CompletionException;
@@ -52,76 +47,11 @@ import java.util.concurrent.TimeUnit;
  */
 public class ParameterToolTest extends AbstractParameterToolTest {
 
-	@Rule
-	public final ExpectedException exception = ExpectedException.none();
-
 	// ----- Parser tests -----------------
 
-	@Test
-	public void testThrowExceptionIfParameterIsNotPrefixed() {
-		exception.expect(IllegalArgumentException.class);
-		exception.expectMessage("Error parsing arguments '[a]' on 'a'. Please prefix keys with -- or -.");
-
-		ParameterTool.fromArgs(new String[]{"a"});
-	}
-
-	@Test
-	public void testNoVal() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-berlin"});
-		Assert.assertEquals(1, parameter.getNumberOfParameters());
-		Assert.assertTrue(parameter.has("berlin"));
-	}
-
-	@Test
-	public void testNoValDouble() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"--berlin"});
-		Assert.assertEquals(1, parameter.getNumberOfParameters());
-		Assert.assertTrue(parameter.has("berlin"));
-	}
-
-	@Test
-	public void testMultipleNoVal() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"--a", "--b", "--c", "--d", "--e", "--f"});
-		Assert.assertEquals(6, parameter.getNumberOfParameters());
-		Assert.assertTrue(parameter.has("a"));
-		Assert.assertTrue(parameter.has("b"));
-		Assert.assertTrue(parameter.has("c"));
-		Assert.assertTrue(parameter.has("d"));
-		Assert.assertTrue(parameter.has("e"));
-		Assert.assertTrue(parameter.has("f"));
-	}
-
-	@Test
-	public void testMultipleNoValMixed() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"--a", "-b", "-c", "-d", "--e", "--f"});
-		Assert.assertEquals(6, parameter.getNumberOfParameters());
-		Assert.assertTrue(parameter.has("a"));
-		Assert.assertTrue(parameter.has("b"));
-		Assert.assertTrue(parameter.has("c"));
-		Assert.assertTrue(parameter.has("d"));
-		Assert.assertTrue(parameter.has("e"));
-		Assert.assertTrue(parameter.has("f"));
-	}
-
-	@Test
-	public void testEmptyVal() {
-		exception.expect(IllegalArgumentException.class);
-		exception.expectMessage("The input [--a, -b, --] contains an empty argument");
-
-		ParameterTool.fromArgs(new String[]{"--a", "-b", "--"});
-	}
-
-	@Test
-	public void testEmptyValShort() {
-		exception.expect(IllegalArgumentException.class);
-		exception.expectMessage("The input [--a, -b, -] contains an empty argument");
-
-		ParameterTool.fromArgs(new String[]{"--a", "-b", "-"});
-	}
-
 	@Test
 	public void testFromCliArgs() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"--input", "myInput", "-expectedCount", "15", "--withoutValues",
+		ParameterTool parameter = (ParameterTool) createParameterToolFromArgs(new String[]{"--input", "myInput", "-expectedCount", "15", "--withoutValues",
 				"--negativeFloat", "-0.58", "-isWorking", "true", "--maxByte", "127", "-negativeShort", "-1024"});
 		Assert.assertEquals(7, parameter.getNumberOfParameters());
 		validate(parameter);
@@ -179,422 +109,14 @@ public class ParameterToolTest extends AbstractParameterToolTest {
 
 	@Test
 	public void testMerged() {
-		ParameterTool parameter1 = ParameterTool.fromArgs(new String[]{"--input", "myInput"});
+		ParameterTool parameter1 = (ParameterTool) createParameterToolFromArgs(new String[]{"--input", "myInput"});
 		System.setProperty("expectedCount", "15");
 		ParameterTool parameter2 = ParameterTool.fromSystemProperties();
 		ParameterTool parameter = parameter1.mergeWith(parameter2);
 		validate(parameter);
 	}
 
-	// Boolean
-
-	@Test
-	public void testUnrequestedBoolean() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-boolean", "true"});
-		Assert.assertEquals(createHashSet("boolean"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertTrue(parameter.getBoolean("boolean"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertTrue(parameter.getBoolean("boolean"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedBooleanWithDefaultValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-boolean", "true"});
-		Assert.assertEquals(createHashSet("boolean"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertTrue(parameter.getBoolean("boolean", false));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertTrue(parameter.getBoolean("boolean", false));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedBooleanWithMissingValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-boolean"});
-		Assert.assertEquals(createHashSet("boolean"), parameter.getUnrequestedParameters());
-
-		parameter.getBoolean("boolean");
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	// Byte
-
-	@Test
-	public void testUnrequestedByte() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-byte", "1"});
-		Assert.assertEquals(createHashSet("byte"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(1, parameter.getByte("byte"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(1, parameter.getByte("byte"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedByteWithDefaultValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-byte", "1"});
-		Assert.assertEquals(createHashSet("byte"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(1, parameter.getByte("byte", (byte) 0));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(1, parameter.getByte("byte", (byte) 0));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedByteWithMissingValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-byte"});
-		Assert.assertEquals(createHashSet("byte"), parameter.getUnrequestedParameters());
-
-		exception.expect(RuntimeException.class);
-		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
-
-		parameter.getByte("byte");
-	}
-
-	// Short
-
-	@Test
-	public void testUnrequestedShort() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-short", "2"});
-		Assert.assertEquals(createHashSet("short"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(2, parameter.getShort("short"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(2, parameter.getShort("short"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedShortWithDefaultValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-short", "2"});
-		Assert.assertEquals(createHashSet("short"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(2, parameter.getShort("short", (short) 0));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(2, parameter.getShort("short", (short) 0));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedShortWithMissingValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-short"});
-		Assert.assertEquals(createHashSet("short"), parameter.getUnrequestedParameters());
-
-		exception.expect(RuntimeException.class);
-		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
-
-		parameter.getShort("short");
-	}
-
-	// Int
-
-	@Test
-	public void testUnrequestedInt() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-int", "4"});
-		Assert.assertEquals(createHashSet("int"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(4, parameter.getInt("int"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(4, parameter.getInt("int"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedIntWithDefaultValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-int", "4"});
-		Assert.assertEquals(createHashSet("int"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(4, parameter.getInt("int", 0));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(4, parameter.getInt("int", 0));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedIntWithMissingValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-int"});
-		Assert.assertEquals(createHashSet("int"), parameter.getUnrequestedParameters());
-
-		exception.expect(RuntimeException.class);
-		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
-
-		parameter.getInt("int");
-	}
-
-	// Long
-
-	@Test
-	public void testUnrequestedLong() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-long", "8"});
-		Assert.assertEquals(createHashSet("long"), parameter.getUnrequestedParameters());
 
-		// test parameter access
-		Assert.assertEquals(8, parameter.getLong("long"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(8, parameter.getLong("long"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedLongWithDefaultValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-long", "8"});
-		Assert.assertEquals(createHashSet("long"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(8, parameter.getLong("long", 0));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(8, parameter.getLong("long", 0));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedLongWithMissingValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-long"});
-		Assert.assertEquals(createHashSet("long"), parameter.getUnrequestedParameters());
-
-		exception.expect(RuntimeException.class);
-		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
-
-		parameter.getLong("long");
-	}
-
-	// Float
-
-	@Test
-	public void testUnrequestedFloat() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-float", "4"});
-		Assert.assertEquals(createHashSet("float"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(4.0, parameter.getFloat("float"), 0.00001);
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(4.0, parameter.getFloat("float"), 0.00001);
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedFloatWithDefaultValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-float", "4"});
-		Assert.assertEquals(createHashSet("float"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(4.0, parameter.getFloat("float", 0.0f), 0.00001);
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(4.0, parameter.getFloat("float", 0.0f), 0.00001);
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedFloatWithMissingValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-float"});
-		Assert.assertEquals(createHashSet("float"), parameter.getUnrequestedParameters());
-
-		exception.expect(RuntimeException.class);
-		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
-
-		parameter.getFloat("float");
-	}
-
-	// Double
-
-	@Test
-	public void testUnrequestedDouble() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-double", "8"});
-		Assert.assertEquals(createHashSet("double"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(8.0, parameter.getDouble("double"), 0.00001);
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(8.0, parameter.getDouble("double"), 0.00001);
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedDoubleWithDefaultValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-double", "8"});
-		Assert.assertEquals(createHashSet("double"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals(8.0, parameter.getDouble("double", 0.0), 0.00001);
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals(8.0, parameter.getDouble("double", 0.0), 0.00001);
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedDoubleWithMissingValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-double"});
-		Assert.assertEquals(createHashSet("double"), parameter.getUnrequestedParameters());
-
-		exception.expect(RuntimeException.class);
-		exception.expectMessage("For input string: \"__NO_VALUE_KEY\"");
-
-		parameter.getDouble("double");
-	}
-
-	// String
-
-	@Test
-	public void testUnrequestedString() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-string", "∞"});
-		Assert.assertEquals(createHashSet("string"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals("∞", parameter.get("string"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals("∞", parameter.get("string"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedStringWithDefaultValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-string", "∞"});
-		Assert.assertEquals(createHashSet("string"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals("∞", parameter.get("string", "0.0"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals("∞", parameter.get("string", "0.0"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedStringWithMissingValue() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-string"});
-		Assert.assertEquals(createHashSet("string"), parameter.getUnrequestedParameters());
-
-		parameter.get("string");
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	// Additional methods
-
-	@Test
-	public void testUnrequestedHas() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-boolean"});
-		Assert.assertEquals(createHashSet("boolean"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertTrue(parameter.has("boolean"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertTrue(parameter.has("boolean"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedRequired() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-required", "∞"});
-		Assert.assertEquals(createHashSet("required"), parameter.getUnrequestedParameters());
-
-		// test parameter access
-		Assert.assertEquals("∞", parameter.getRequired("required"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		// test repeated access
-		Assert.assertEquals("∞", parameter.getRequired("required"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedMultiple() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{"-boolean", "true", "-byte", "1",
-			"-short", "2", "-int", "4", "-long", "8", "-float", "4.0", "-double", "8.0", "-string", "∞"});
-		Assert.assertEquals(createHashSet("boolean", "byte", "short", "int", "long", "float", "double", "string"),
-			parameter.getUnrequestedParameters());
-
-		Assert.assertTrue(parameter.getBoolean("boolean"));
-		Assert.assertEquals(createHashSet("byte", "short", "int", "long", "float", "double", "string"),
-			parameter.getUnrequestedParameters());
-
-		Assert.assertEquals(1, parameter.getByte("byte"));
-		Assert.assertEquals(createHashSet("short", "int", "long", "float", "double", "string"),
-			parameter.getUnrequestedParameters());
-
-		Assert.assertEquals(2, parameter.getShort("short"));
-		Assert.assertEquals(createHashSet("int", "long", "float", "double", "string"),
-			parameter.getUnrequestedParameters());
-
-		Assert.assertEquals(4, parameter.getInt("int"));
-		Assert.assertEquals(createHashSet("long", "float", "double", "string"),
-			parameter.getUnrequestedParameters());
-
-		Assert.assertEquals(8, parameter.getLong("long"));
-		Assert.assertEquals(createHashSet("float", "double", "string"),
-			parameter.getUnrequestedParameters());
-
-		Assert.assertEquals(4.0, parameter.getFloat("float"), 0.00001);
-		Assert.assertEquals(createHashSet("double", "string"),
-			parameter.getUnrequestedParameters());
-
-		Assert.assertEquals(8.0, parameter.getDouble("double"), 0.00001);
-		Assert.assertEquals(createHashSet("string"),
-			parameter.getUnrequestedParameters());
-
-		Assert.assertEquals("∞", parameter.get("string"));
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
-
-	@Test
-	public void testUnrequestedUnknown() {
-		ParameterTool parameter = ParameterTool.fromArgs(new String[]{});
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-
-		Assert.assertTrue(parameter.getBoolean("boolean", true));
-		Assert.assertEquals(0, parameter.getByte("byte", (byte) 0));
-		Assert.assertEquals(0, parameter.getShort("short", (short) 0));
-		Assert.assertEquals(0, parameter.getInt("int", 0));
-		Assert.assertEquals(0, parameter.getLong("long", 0));
-		Assert.assertEquals(0, parameter.getFloat("float", 0), 0.00001);
-		Assert.assertEquals(0, parameter.getDouble("double", 0), 0.00001);
-		Assert.assertEquals("0", parameter.get("string", "0"));
-
-		Assert.assertEquals(Collections.emptySet(), parameter.getUnrequestedParameters());
-	}
 
 	/**
 	 * Tests that we can concurrently serialize and access the ParameterTool. See FLINK-7943
@@ -612,7 +134,7 @@ public class ParameterToolTest extends AbstractParameterToolTest {
 
 		final String[] args = input.toArray(new String[0]);
 
-		final ParameterTool parameterTool = ParameterTool.fromArgs(args);
+		final ParameterTool parameterTool = (ParameterTool) createParameterToolFromArgs(args);
 
 		final int numThreads = 5;
 		final int numSerializations = 100;
@@ -667,12 +189,4 @@ public class ParameterToolTest extends AbstractParameterToolTest {
 			ParameterTool deserializedParameterTool = ((ParameterTool) ois.readObject());
 		}
 	}
-
-	private static <T> Set<T> createHashSet(T... elements) {
-		Set<T> set = new HashSet<>();
-		for (T element : elements) {
-			set.add(element);
-		}
-		return set;
-	}
 }
