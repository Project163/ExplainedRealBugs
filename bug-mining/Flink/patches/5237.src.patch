diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/highavailability/zookeeper/ZooKeeperRunningJobsRegistry.java b/flink-runtime/src/main/java/org/apache/flink/runtime/highavailability/zookeeper/ZooKeeperRunningJobsRegistry.java
index 5ddf760b23f..cf8c3363e79 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/highavailability/zookeeper/ZooKeeperRunningJobsRegistry.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/highavailability/zookeeper/ZooKeeperRunningJobsRegistry.java
@@ -24,6 +24,7 @@ import org.apache.flink.configuration.HighAvailabilityOptions;
 import org.apache.flink.runtime.highavailability.RunningJobsRegistry;
 
 import org.apache.flink.shaded.curator4.org.apache.curator.framework.CuratorFramework;
+import org.apache.flink.shaded.zookeeper3.org.apache.zookeeper.KeeperException;
 import org.apache.flink.shaded.zookeeper3.org.apache.zookeeper.data.Stat;
 
 import org.slf4j.Logger;
@@ -111,10 +112,15 @@ public class ZooKeeperRunningJobsRegistry implements RunningJobsRegistry {
     public void clearJob(JobID jobID) throws IOException {
         checkNotNull(jobID);
 
+        final String zkPath = createZkPath(jobID);
+
         try {
-            final String zkPath = createZkPath(jobID);
-            this.client.newNamespaceAwareEnsurePath(zkPath).ensure(client.getZookeeperClient());
-            this.client.delete().forPath(zkPath);
+            final Stat stat = this.client.checkExists().forPath(zkPath);
+            if (stat != null) {
+                this.client.delete().forPath(zkPath);
+            }
+        } catch (KeeperException.NoNodeException ignored) {
+            // The zNode has been deleted by somebody else. This works as well.
         } catch (Exception e) {
             throw new IOException("Failed to clear job state from ZooKeeper for job " + jobID, e);
         }
@@ -127,7 +133,21 @@ public class ZooKeeperRunningJobsRegistry implements RunningJobsRegistry {
     private void writeEnumToZooKeeper(JobID jobID, JobSchedulingStatus status) throws Exception {
         LOG.debug("Setting scheduling state for job {} to {}.", jobID, status);
         final String zkPath = createZkPath(jobID);
-        this.client.newNamespaceAwareEnsurePath(zkPath).ensure(client.getZookeeperClient());
-        this.client.setData().forPath(zkPath, status.name().getBytes(ENCODING));
+        while (true) {
+            try {
+                final Stat stat = this.client.checkExists().forPath(zkPath);
+                if (stat != null) {
+                    this.client.setData().forPath(zkPath, status.name().getBytes(ENCODING));
+                } else {
+                    this.client
+                            .create()
+                            .creatingParentContainersIfNeeded()
+                            .forPath(zkPath, status.name().getBytes(ENCODING));
+                }
+                return;
+            } catch (KeeperException.NoNodeException | KeeperException.NodeExistsException e) {
+                LOG.debug("Retrying failure to set job state from ZooKeeper for job {}", jobID, e);
+            }
+        }
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/highavailability/zookeeper/ZooKeeperRegistryTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/highavailability/zookeeper/ZooKeeperRegistryTest.java
index e4e035fc4d6..e13bdac3e3f 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/highavailability/zookeeper/ZooKeeperRegistryTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/highavailability/zookeeper/ZooKeeperRegistryTest.java
@@ -29,6 +29,8 @@ import org.apache.flink.runtime.highavailability.RunningJobsRegistry.JobScheduli
 import org.apache.flink.runtime.util.ZooKeeperUtils;
 import org.apache.flink.util.TestLogger;
 
+import org.apache.flink.shaded.curator4.org.apache.curator.framework.CuratorFramework;
+
 import org.apache.curator.test.TestingServer;
 import org.junit.After;
 import org.junit.Before;
@@ -53,7 +55,7 @@ public class ZooKeeperRegistryTest extends TestLogger {
 
     /**
      * Tests that the function of ZookeeperRegistry, setJobRunning(), setJobFinished(),
-     * isJobRunning()
+     * isJobRunning().
      */
     @Test
     public void testZooKeeperRegistry() throws Exception {
@@ -62,12 +64,11 @@ public class ZooKeeperRegistryTest extends TestLogger {
                 HighAvailabilityOptions.HA_ZOOKEEPER_QUORUM, testingServer.getConnectString());
         configuration.setString(HighAvailabilityOptions.HA_MODE, "zookeeper");
 
+        final CuratorFramework zkClient = ZooKeeperUtils.startCuratorFramework(configuration);
+
         final HighAvailabilityServices zkHaService =
                 new ZooKeeperHaServices(
-                        ZooKeeperUtils.startCuratorFramework(configuration),
-                        Executors.directExecutor(),
-                        configuration,
-                        new VoidBlobStore());
+                        zkClient, Executors.directExecutor(), configuration, new VoidBlobStore());
 
         final RunningJobsRegistry zkRegistry = zkHaService.getRunningJobsRegistry();
 
@@ -75,16 +76,21 @@ public class ZooKeeperRegistryTest extends TestLogger {
             JobID jobID = JobID.generate();
             assertEquals(JobSchedulingStatus.PENDING, zkRegistry.getJobSchedulingStatus(jobID));
 
+            // set when znode does not exist for job
             zkRegistry.setJobRunning(jobID);
             assertEquals(JobSchedulingStatus.RUNNING, zkRegistry.getJobSchedulingStatus(jobID));
 
+            // set when znode does exist for job
             zkRegistry.setJobFinished(jobID);
             assertEquals(JobSchedulingStatus.DONE, zkRegistry.getJobSchedulingStatus(jobID));
 
             zkRegistry.clearJob(jobID);
             assertEquals(JobSchedulingStatus.PENDING, zkRegistry.getJobSchedulingStatus(jobID));
+
+            // clear when znode does not exist for job
+            zkRegistry.clearJob(jobID);
         } finally {
-            zkHaService.close();
+            zkHaService.closeAndCleanupAllData();
         }
     }
 }
