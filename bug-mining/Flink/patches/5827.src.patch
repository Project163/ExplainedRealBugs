diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/operators/sink/SinkOperator.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/operators/sink/SinkOperator.java
index d01434b39d9..015e90cdf59 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/operators/sink/SinkOperator.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/operators/sink/SinkOperator.java
@@ -104,6 +104,9 @@ class SinkOperator<InputT, CommT, WriterStateT> extends AbstractStreamOperator<b
 
     private final MailboxExecutor mailboxExecutor;
     private Counter numRecordsOutCounter;
+    // record endOfInput state to avoid duplicate prepareCommit on final notifyCheckpointComplete
+    // once FLIP-147 is fully operational all endOfInput processing needs to be removed
+    private boolean endOfInput = false;
 
     SinkOperator(
             ProcessingTimeService processingTimeService,
@@ -165,8 +168,10 @@ class SinkOperator<InputT, CommT, WriterStateT> extends AbstractStreamOperator<b
     @Override
     public void prepareSnapshotPreBarrier(long checkpointId) throws Exception {
         super.prepareSnapshotPreBarrier(checkpointId);
-        emitCommittables(
-                committerHandler.processCommittables(() -> sinkWriter.prepareCommit(false)));
+        if (!endOfInput) {
+            emitCommittables(
+                    committerHandler.processCommittables(() -> sinkWriter.prepareCommit(false)));
+        }
     }
 
     @Override
@@ -186,6 +191,7 @@ class SinkOperator<InputT, CommT, WriterStateT> extends AbstractStreamOperator<b
 
     @Override
     public void endInput() throws Exception {
+        endOfInput = true;
         emitCommittables(
                 committerHandler.processCommittables(() -> sinkWriter.prepareCommit(true)));
         emitCommittables(committerHandler.endOfInput());
