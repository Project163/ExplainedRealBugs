diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyServer.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyServer.java
index 3cf14b8b155..ee3e9234d9f 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyServer.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/NettyServer.java
@@ -121,8 +121,8 @@ class NettyServer {
 		}
 
 		// Low and high water marks for flow control
-		bootstrap.childOption(ChannelOption.WRITE_BUFFER_LOW_WATER_MARK, config.getMemorySegmentSize() + 1);
 		bootstrap.childOption(ChannelOption.WRITE_BUFFER_HIGH_WATER_MARK, 2 * config.getMemorySegmentSize());
+		bootstrap.childOption(ChannelOption.WRITE_BUFFER_LOW_WATER_MARK, config.getMemorySegmentSize() + 1);
 
 		// SSL related configuration
 		try {
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/query/netty/KvStateServer.java b/flink-runtime/src/main/java/org/apache/flink/runtime/query/netty/KvStateServer.java
index 925a7757f60..c6f46d15520 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/query/netty/KvStateServer.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/query/netty/KvStateServer.java
@@ -141,8 +141,8 @@ public class KvStateServer {
 				.option(ChannelOption.ALLOCATOR, bufferPool)
 				// Child channel options
 				.childOption(ChannelOption.ALLOCATOR, bufferPool)
-				.childOption(ChannelOption.WRITE_BUFFER_LOW_WATER_MARK, LOW_WATER_MARK)
 				.childOption(ChannelOption.WRITE_BUFFER_HIGH_WATER_MARK, HIGH_WATER_MARK)
+				.childOption(ChannelOption.WRITE_BUFFER_LOW_WATER_MARK, LOW_WATER_MARK)
 				// See initializer for pipeline details
 				.childHandler(new KvStateServerChannelInitializer(serverHandler));
 	}
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/netty/NettyServerLowAndHighWatermarkTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/netty/NettyServerLowAndHighWatermarkTest.java
index 0038640b3e9..e8b65506227 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/netty/NettyServerLowAndHighWatermarkTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/netty/NettyServerLowAndHighWatermarkTest.java
@@ -34,12 +34,17 @@ import static org.apache.flink.runtime.io.network.netty.NettyTestUtil.connect;
 import static org.apache.flink.runtime.io.network.netty.NettyTestUtil.createConfig;
 import static org.apache.flink.runtime.io.network.netty.NettyTestUtil.initServerAndClient;
 import static org.apache.flink.runtime.io.network.netty.NettyTestUtil.shutdown;
+import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertTrue;
 
 public class NettyServerLowAndHighWatermarkTest {
 
-	private final static int PageSize = 1024;
+	/**
+	 * Pick a larger memory segment size here in order to trigger
+	 * <a href="https://issues.apache.org/jira/browse/FLINK-7258">FLINK-7258</a>.
+	 */
+	private final static int PageSize = 65536;
 
 	/**
 	 * Verifies that the high and low watermark are set in relation to the page size.
@@ -54,12 +59,16 @@ public class NettyServerLowAndHighWatermarkTest {
 	 */
 	@Test
 	public void testLowAndHighWatermarks() throws Throwable {
+		final int expectedLowWatermark = PageSize + 1;
+		final int expectedHighWatermark = 2 * PageSize;
+
 		final AtomicReference<Throwable> error = new AtomicReference<Throwable>();
 		final NettyProtocol protocol = new NettyProtocol() {
 			@Override
 			public ChannelHandler[] getServerChannelHandlers() {
 				// The channel handler implements the test
-				return new ChannelHandler[] {new TestLowAndHighWatermarkHandler(error)};
+				return new ChannelHandler[] {new TestLowAndHighWatermarkHandler(
+					expectedLowWatermark, expectedHighWatermark, error)};
 			}
 
 			@Override
@@ -97,11 +106,17 @@ public class NettyServerLowAndHighWatermarkTest {
 	 */
 	private static class TestLowAndHighWatermarkHandler extends ChannelInboundHandlerAdapter {
 
+		private final int expectedLowWatermark;
+
+		private final int expectedHighWatermark;
+
 		private final AtomicReference<Throwable> error;
 
 		private boolean hasFlushed;
 
-		public TestLowAndHighWatermarkHandler(AtomicReference<Throwable> error) {
+		public TestLowAndHighWatermarkHandler(int expectedLowWatermark, int expectedHighWatermark, AtomicReference<Throwable> error) {
+			this.expectedLowWatermark = expectedLowWatermark;
+			this.expectedHighWatermark = expectedHighWatermark;
 			this.error = error;
 		}
 
@@ -109,6 +124,9 @@ public class NettyServerLowAndHighWatermarkTest {
 		public void channelActive(ChannelHandlerContext ctx) throws Exception {
 			final Channel ch = ctx.channel();
 
+			assertEquals("Low watermark", expectedLowWatermark, ch.config().getWriteBufferLowWaterMark());
+			assertEquals("High watermark", expectedHighWatermark, ch.config().getWriteBufferHighWaterMark());
+
 			// Start with a writable channel
 			assertTrue(ch.isWritable());
 
