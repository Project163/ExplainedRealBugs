diff --git a/flink-python/pyflink/table/environment_settings.py b/flink-python/pyflink/table/environment_settings.py
index bc615824961..04af4532301 100644
--- a/flink-python/pyflink/table/environment_settings.py
+++ b/flink-python/pyflink/table/environment_settings.py
@@ -18,6 +18,7 @@
 import warnings
 
 from pyflink.java_gateway import get_gateway
+from pyflink.util.java_utils import create_url_class_loader
 
 from pyflink.common import Configuration
 
@@ -129,6 +130,10 @@ class EnvironmentSettings(object):
 
             :return: an immutable instance of EnvironmentSettings.
             """
+            gateway = get_gateway()
+            context_classloader = gateway.jvm.Thread.currentThread().getContextClassLoader()
+            new_classloader = create_url_class_loader([], context_classloader)
+            gateway.jvm.Thread.currentThread().setContextClassLoader(new_classloader)
             return EnvironmentSettings(self._j_builder.build())
 
     def __init__(self, j_environment_settings):
@@ -201,6 +206,10 @@ class EnvironmentSettings(object):
                 :func:`EnvironmentSettings.Builder.with_configuration` instead.
         """
         warnings.warn("Deprecated in 1.15.", DeprecationWarning)
+        gateway = get_gateway()
+        context_classloader = gateway.jvm.Thread.currentThread().getContextClassLoader()
+        new_classloader = create_url_class_loader([], context_classloader)
+        gateway.jvm.Thread.currentThread().setContextClassLoader(new_classloader)
         return EnvironmentSettings(
             get_gateway().jvm.EnvironmentSettings.fromConfiguration(config._j_configuration))
 
@@ -217,8 +226,7 @@ class EnvironmentSettings(object):
 
         :return: EnvironmentSettings.
         """
-        return EnvironmentSettings(
-            get_gateway().jvm.EnvironmentSettings.inStreamingMode())
+        return EnvironmentSettings.new_instance().in_streaming_mode().build()
 
     @staticmethod
     def in_batch_mode() -> 'EnvironmentSettings':
@@ -234,5 +242,4 @@ class EnvironmentSettings(object):
 
         :return: EnvironmentSettings.
         """
-        return EnvironmentSettings(
-            get_gateway().jvm.EnvironmentSettings.inBatchMode())
+        return EnvironmentSettings.new_instance().in_batch_mode().build()
diff --git a/flink-python/pyflink/util/java_utils.py b/flink-python/pyflink/util/java_utils.py
index 86ab74ecf1d..baea98a294c 100644
--- a/flink-python/pyflink/util/java_utils.py
+++ b/flink-python/pyflink/util/java_utils.py
@@ -151,22 +151,28 @@ def add_jars_to_context_class_loader(jar_urls):
     if all([url.toString() in existing_urls for url in jar_urls]):
         # if urls all existed, no need to create new class loader.
         return
+
     URLClassLoaderClass = load_java_class("java.net.URLClassLoader")
-    addURL = URLClassLoaderClass.getDeclaredMethod(
-        "addURL",
-        to_jarray(
-            gateway.jvm.Class,
-            [load_java_class("java.net.URL")]))
-    addURL.setAccessible(True)
-    if class_loader_name == "org.apache.flink.runtime.execution.librarycache." \
-                            "FlinkUserCodeClassLoaders$SafetyNetWrapperClassLoader":
-        ensureInner = context_classloader.getClass().getDeclaredMethod("ensureInner", None)
-        ensureInner.setAccessible(True)
-        loader = ensureInner.invoke(context_classloader, None)
+    if is_instance_of(context_classloader, URLClassLoaderClass):
+        if class_loader_name == "org.apache.flink.runtime.execution.librarycache." \
+                                "FlinkUserCodeClassLoaders$SafetyNetWrapperClassLoader":
+            ensureInner = context_classloader.getClass().getDeclaredMethod("ensureInner", None)
+            ensureInner.setAccessible(True)
+            context_classloader = ensureInner.invoke(context_classloader, None)
+
+        addURL = URLClassLoaderClass.getDeclaredMethod(
+            "addURL",
+            to_jarray(
+                gateway.jvm.Class,
+                [load_java_class("java.net.URL")]))
+        addURL.setAccessible(True)
+
+        for url in jar_urls:
+            addURL.invoke(context_classloader, to_jarray(get_gateway().jvm.Object, [url]))
+
     else:
-        loader = context_classloader
-    for url in jar_urls:
-        addURL.invoke(loader, to_jarray(get_gateway().jvm.Object, [url]))
+        context_classloader = create_url_class_loader(jar_urls, context_classloader)
+        gateway.jvm.Thread.currentThread().setContextClassLoader(context_classloader)
 
 
 def to_j_explain_detail_arr(p_extra_details):
@@ -189,3 +195,10 @@ def to_j_explain_detail_arr(p_extra_details):
         j_arr[i] = to_j_explain_detail(p_extra_details[i])
 
     return j_arr
+
+
+def create_url_class_loader(urls, parent_class_loader):
+    gateway = get_gateway()
+    url_class_loader = gateway.jvm.java.net.URLClassLoader(
+        to_jarray(gateway.jvm.java.net.URL, urls), parent_class_loader)
+    return url_class_loader
