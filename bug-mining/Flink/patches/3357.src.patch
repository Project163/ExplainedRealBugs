diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherResourceCleanupTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherResourceCleanupTest.java
index 36110be2fb7..6b137be6dcf 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherResourceCleanupTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherResourceCleanupTest.java
@@ -204,11 +204,11 @@ public class DispatcherResourceCleanupTest extends TestLogger {
 				() -> CompletableFuture.completedFuture(resourceManagerGateway),
 				blobServer,
 				heartbeatServices,
-				UnregisteredMetricGroups.createUnregisteredJobManagerMetricGroup(),
 				archivedExecutionGraphStore,
 				fatalErrorHandler,
 				VoidHistoryServerArchivist.INSTANCE,
 				null,
+				UnregisteredMetricGroups.createUnregisteredJobManagerMetricGroup(),
 				jobGraphWriter,
 				jobManagerRunnerFactory));
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherTest.java
index 0bf6722a096..f136a8cdfb6 100755
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/DispatcherTest.java
@@ -254,11 +254,11 @@ public class DispatcherTest extends TestLogger {
 					() -> CompletableFuture.completedFuture(resourceManagerGateway),
 					blobServer,
 					heartbeatServices,
-					UnregisteredMetricGroups.createUnregisteredJobManagerMetricGroup(),
 					archivedExecutionGraphStore,
 					fatalErrorHandler,
 					VoidHistoryServerArchivist.INSTANCE,
 					null,
+					UnregisteredMetricGroups.createUnregisteredJobManagerMetricGroup(),
 					jobGraphWriter,
 					jobManagerRunnerFactory));
 		}
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/runner/DefaultDispatcherRunnerITCase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/runner/DefaultDispatcherRunnerITCase.java
index 8617996370b..eb6fc5d1975 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/runner/DefaultDispatcherRunnerITCase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/runner/DefaultDispatcherRunnerITCase.java
@@ -21,18 +21,29 @@ package org.apache.flink.runtime.dispatcher.runner;
 import org.apache.flink.api.common.JobID;
 import org.apache.flink.api.common.time.Time;
 import org.apache.flink.configuration.Configuration;
+import org.apache.flink.runtime.dispatcher.Dispatcher;
+import org.apache.flink.runtime.dispatcher.DispatcherFactory;
 import org.apache.flink.runtime.dispatcher.DispatcherGateway;
+import org.apache.flink.runtime.dispatcher.DispatcherId;
+import org.apache.flink.runtime.dispatcher.DispatcherServices;
+import org.apache.flink.runtime.dispatcher.JobManagerRunnerFactory;
 import org.apache.flink.runtime.dispatcher.MemoryArchivedExecutionGraphStore;
 import org.apache.flink.runtime.dispatcher.PartialDispatcherServices;
+import org.apache.flink.runtime.dispatcher.PartialDispatcherServicesWithJobGraphStore;
+import org.apache.flink.runtime.dispatcher.SingleJobJobGraphStore;
+import org.apache.flink.runtime.dispatcher.StandaloneDispatcher;
+import org.apache.flink.runtime.dispatcher.TestingJobManagerRunnerFactory;
 import org.apache.flink.runtime.dispatcher.VoidHistoryServerArchivist;
 import org.apache.flink.runtime.heartbeat.TestingHeartbeatServices;
 import org.apache.flink.runtime.highavailability.TestingHighAvailabilityServicesBuilder;
 import org.apache.flink.runtime.jobgraph.JobGraph;
 import org.apache.flink.runtime.jobgraph.JobVertex;
 import org.apache.flink.runtime.jobmanager.JobGraphStore;
+import org.apache.flink.runtime.jobmaster.TestingJobManagerRunner;
 import org.apache.flink.runtime.leaderelection.TestingLeaderElectionService;
 import org.apache.flink.runtime.metrics.groups.UnregisteredMetricGroups;
 import org.apache.flink.runtime.minicluster.SessionDispatcherWithUUIDFactory;
+import org.apache.flink.runtime.rpc.RpcService;
 import org.apache.flink.runtime.rpc.TestingRpcServiceResource;
 import org.apache.flink.runtime.testingUtils.TestingUtils;
 import org.apache.flink.runtime.testtasks.NoOpInvokable;
@@ -45,13 +56,20 @@ import org.junit.After;
 import org.junit.Before;
 import org.junit.ClassRule;
 import org.junit.Test;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+
+import javax.annotation.Nonnull;
 
 import java.util.Collection;
 import java.util.UUID;
 import java.util.concurrent.CompletableFuture;
+import java.util.concurrent.TimeUnit;
 
 import static org.hamcrest.Matchers.contains;
+import static org.hamcrest.Matchers.equalTo;
 import static org.hamcrest.Matchers.hasSize;
+import static org.hamcrest.Matchers.is;
 import static org.junit.Assert.assertThat;
 
 /**
@@ -59,6 +77,8 @@ import static org.junit.Assert.assertThat;
  */
 public class DefaultDispatcherRunnerITCase extends TestLogger {
 
+	private static final Logger LOG = LoggerFactory.getLogger(DefaultDispatcherRunnerITCase.class);
+
 	private static final Time TIMEOUT = Time.seconds(10L);
 
 	private static final JobID TEST_JOB_ID = new JobID();
@@ -79,8 +99,11 @@ public class DefaultDispatcherRunnerITCase extends TestLogger {
 
 	private PartialDispatcherServices partialDispatcherServices;
 
+	private DefaultDispatcherRunnerFactory dispatcherRunnerFactory;
+
 	@Before
 	public void setup() {
+		dispatcherRunnerFactory = DefaultDispatcherRunnerFactory.createSessionRunner(SessionDispatcherWithUUIDFactory.INSTANCE);
 		jobGraph = createJobGraph();
 		dispatcherLeaderElectionService = new TestingLeaderElectionService();
 		fatalErrorHandler = new TestingFatalErrorHandler();
@@ -92,7 +115,7 @@ public class DefaultDispatcherRunnerITCase extends TestLogger {
 			CompletableFuture::new,
 			blobServerResource.getBlobServer(),
 			new TestingHeartbeatServices(),
-			UnregisteredMetricGroups.createUnregisteredJobManagerMetricGroup(),
+			UnregisteredMetricGroups::createUnregisteredJobManagerMetricGroup,
 			new MemoryArchivedExecutionGraphStore(),
 			fatalErrorHandler,
 			VoidHistoryServerArchivist.INSTANCE,
@@ -131,6 +154,65 @@ public class DefaultDispatcherRunnerITCase extends TestLogger {
 		}
 	}
 
+	/**
+	 * See FLINK-11843. This is a probabilistic test which needs to be executed several times to fail.
+	 */
+	@Test
+	public void leaderChange_withBlockingJobManagerTermination_doesNotAffectNewLeader() throws Exception {
+		final TestingJobManagerRunnerFactory jobManagerRunnerFactory = new TestingJobManagerRunnerFactory(1);
+		dispatcherRunnerFactory = DefaultDispatcherRunnerFactory.createSessionRunner(new TestingDispatcherFactory(jobManagerRunnerFactory));
+		jobGraphStore = new SingleJobJobGraphStore(jobGraph);
+
+		try (final DispatcherRunner dispatcherRunner = createDispatcherRunner()) {
+
+			// initial run
+			dispatcherLeaderElectionService.isLeader(UUID.randomUUID()).get();
+			final TestingJobManagerRunner testingJobManagerRunner = jobManagerRunnerFactory.takeCreatedJobManagerRunner();
+
+			dispatcherLeaderElectionService.notLeader();
+
+			LOG.info("Re-grant leadership first time.");
+			dispatcherLeaderElectionService.isLeader(UUID.randomUUID());
+
+			// give the Dispatcher some time to recover jobs
+			Thread.sleep(1L);
+
+			dispatcherLeaderElectionService.notLeader();
+
+			LOG.info("Re-grant leadership second time.");
+			final UUID leaderSessionId = UUID.randomUUID();
+			final CompletableFuture<UUID> leaderFuture = dispatcherLeaderElectionService.isLeader(leaderSessionId);
+			assertThat(leaderFuture.isDone(), is(false));
+
+			LOG.info("Complete the termination of the first job manager runner.");
+			testingJobManagerRunner.completeTerminationFuture();
+
+			assertThat(leaderFuture.get(TIMEOUT.toMilliseconds(), TimeUnit.MILLISECONDS), is(equalTo(leaderSessionId)));
+		}
+	}
+
+	private static class TestingDispatcherFactory implements DispatcherFactory {
+		private final JobManagerRunnerFactory jobManagerRunnerFactory;
+
+		private TestingDispatcherFactory(JobManagerRunnerFactory jobManagerRunnerFactory) {
+			this.jobManagerRunnerFactory = jobManagerRunnerFactory;
+		}
+
+		@Override
+		public Dispatcher createDispatcher(
+			@Nonnull RpcService rpcService,
+			@Nonnull DispatcherId fencingToken,
+			@Nonnull Collection<JobGraph> recoveredJobs,
+			@Nonnull PartialDispatcherServicesWithJobGraphStore partialDispatcherServicesWithJobGraphStore) throws Exception {
+			return new StandaloneDispatcher(
+				rpcService,
+				generateEndpointIdWithUUID(),
+				fencingToken,
+				recoveredJobs,
+				DispatcherServices.from(partialDispatcherServicesWithJobGraphStore, jobManagerRunnerFactory));
+		}
+	}
+
 	private static JobGraph createJobGraph() {
 		final JobVertex testVertex = new JobVertex("testVertex");
 		testVertex.setInvokableClass(NoOpInvokable.class);
@@ -141,9 +223,7 @@ public class DefaultDispatcherRunnerITCase extends TestLogger {
 	}
 
 	private DefaultDispatcherRunner createDispatcherRunner() throws Exception {
-		final DefaultDispatcherRunnerFactory runnerFactory = DefaultDispatcherRunnerFactory.createSessionRunner(SessionDispatcherWithUUIDFactory.INSTANCE);
-
-		return runnerFactory.createDispatcherRunner(
+		return dispatcherRunnerFactory.createDispatcherRunner(
 			dispatcherLeaderElectionService,
 			fatalErrorHandler,
 			() -> jobGraphStore,
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/runner/DispatcherRunnerImplTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/runner/DispatcherRunnerImplTest.java
deleted file mode 100644
index e94a96c49b5..00000000000
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/dispatcher/runner/DispatcherRunnerImplTest.java
+++ /dev/null
@@ -1,206 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.flink.runtime.dispatcher.runner;
-
-import org.apache.flink.api.common.time.Time;
-import org.apache.flink.configuration.Configuration;
-import org.apache.flink.runtime.blob.BlobServer;
-import org.apache.flink.runtime.blob.VoidBlobStore;
-import org.apache.flink.runtime.dispatcher.Dispatcher;
-import org.apache.flink.runtime.dispatcher.DispatcherFactory;
-import org.apache.flink.runtime.dispatcher.DispatcherGateway;
-import org.apache.flink.runtime.dispatcher.DispatcherId;
-import org.apache.flink.runtime.dispatcher.DispatcherServices;
-import org.apache.flink.runtime.dispatcher.JobManagerRunnerFactory;
-import org.apache.flink.runtime.dispatcher.MemoryArchivedExecutionGraphStore;
-import org.apache.flink.runtime.dispatcher.PartialDispatcherServices;
-import org.apache.flink.runtime.dispatcher.PartialDispatcherServicesWithJobGraphStore;
-import org.apache.flink.runtime.dispatcher.SingleJobJobGraphStore;
-import org.apache.flink.runtime.dispatcher.StandaloneDispatcher;
-import org.apache.flink.runtime.dispatcher.TestingJobManagerRunnerFactory;
-import org.apache.flink.runtime.dispatcher.VoidHistoryServerArchivist;
-import org.apache.flink.runtime.heartbeat.TestingHeartbeatServices;
-import org.apache.flink.runtime.highavailability.TestingHighAvailabilityServices;
-import org.apache.flink.runtime.highavailability.TestingHighAvailabilityServicesBuilder;
-import org.apache.flink.runtime.jobgraph.JobGraph;
-import org.apache.flink.runtime.jobmanager.JobGraphStoreFactory;
-import org.apache.flink.runtime.jobmaster.TestingJobManagerRunner;
-import org.apache.flink.runtime.leaderelection.TestingLeaderElectionService;
-import org.apache.flink.runtime.metrics.groups.UnregisteredMetricGroups;
-import org.apache.flink.runtime.rpc.RpcService;
-import org.apache.flink.runtime.rpc.TestingRpcService;
-import org.apache.flink.runtime.rpc.TestingRpcServiceResource;
-import org.apache.flink.runtime.testingUtils.TestingUtils;
-import org.apache.flink.runtime.util.TestingFatalErrorHandler;
-import org.apache.flink.util.TestLogger;
-
-import org.junit.After;
-import org.junit.Before;
-import org.junit.ClassRule;
-import org.junit.Test;
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-
-import javax.annotation.Nonnull;
-
-import java.util.Collection;
-import java.util.UUID;
-import java.util.concurrent.CompletableFuture;
-import java.util.concurrent.TimeUnit;
-
-import static org.hamcrest.Matchers.equalTo;
-import static org.hamcrest.Matchers.is;
-import static org.junit.Assert.assertThat;
-
-/**
- * Tests for the {@link DefaultDispatcherRunner}.
- */
-public class DispatcherRunnerImplTest extends TestLogger {
-
-	private static final Logger LOG = LoggerFactory.getLogger(DispatcherRunnerImplTest.class);
-
-	private static final Time TESTING_TIMEOUT = Time.seconds(10L);
-
-	@ClassRule
-	public static TestingRpcServiceResource testingRpcServiceResource = new TestingRpcServiceResource();
-
-	private TestingFatalErrorHandler fatalErrorHandler;
-
-	@Before
-	public void setup() {
-		fatalErrorHandler = new TestingFatalErrorHandler();
-	}
-
-	@After
-	public void teardown() throws Exception {
-		if (fatalErrorHandler != null) {
-			fatalErrorHandler.rethrowError();
-		}
-	}
-
-	/**
-	 * See FLINK-11843. This is a probabilistic test which needs to be executed several times to fail.
-	 */
-	@Test
-	public void testJobRecoveryUnderLeaderChange() throws Exception {
-		final TestingRpcService rpcService = testingRpcServiceResource.getTestingRpcService();
-		final TestingLeaderElectionService dispatcherLeaderElectionService = new TestingLeaderElectionService();
-		final Configuration configuration = new Configuration();
-
-		final JobGraph jobGraph = new JobGraph();
-
-		try (final BlobServer blobServer = new BlobServer(configuration, new VoidBlobStore());
-			final TestingHighAvailabilityServices highAvailabilityServices = new TestingHighAvailabilityServicesBuilder()
-			.setDispatcherLeaderElectionService(dispatcherLeaderElectionService)
-			.build()) {
-
-			final PartialDispatcherServices partialDispatcherServices = new PartialDispatcherServices(
-				configuration,
-				highAvailabilityServices,
-				CompletableFuture::new,
-				blobServer,
-				new TestingHeartbeatServices(),
-				UnregisteredMetricGroups::createUnregisteredJobManagerMetricGroup,
-				new MemoryArchivedExecutionGraphStore(),
-				fatalErrorHandler,
-				VoidHistoryServerArchivist.INSTANCE,
-				null);
-
-			final TestingJobManagerRunnerFactory jobManagerRunnerFactory = new TestingJobManagerRunnerFactory(1);
-
-			final DefaultDispatcherRunnerFactory dispatcherRunnerFactory = DefaultDispatcherRunnerFactory.createSessionRunner(new TestingDispatcherFactory(jobManagerRunnerFactory));
-
-			try (final DispatcherRunner dispatcherRunner = createDispatcherRunner(
-					rpcService,
-					dispatcherLeaderElectionService,
-					partialDispatcherServices,
-					dispatcherRunnerFactory,
-					() -> new SingleJobJobGraphStore(jobGraph))) {
-				// initial run
-				grantLeadership(dispatcherLeaderElectionService, dispatcherRunner);
-				final TestingJobManagerRunner testingJobManagerRunner = jobManagerRunnerFactory.takeCreatedJobManagerRunner();
-
-				dispatcherLeaderElectionService.notLeader();
-
-				LOG.info("Re-grant leadership first time.");
-				dispatcherLeaderElectionService.isLeader(UUID.randomUUID());
-
-				// give the Dispatcher some time to recover jobs
-				Thread.sleep(1L);
-
-				dispatcherLeaderElectionService.notLeader();
-
-				LOG.info("Re-grant leadership second time.");
-				final UUID leaderSessionId = UUID.randomUUID();
-				final CompletableFuture<UUID> leaderFuture = dispatcherLeaderElectionService.isLeader(leaderSessionId);
-
-				LOG.info("Complete the termination of the first job manager runner.");
-				testingJobManagerRunner.completeTerminationFuture();
-
-				assertThat(leaderFuture.get(TESTING_TIMEOUT.toMilliseconds(), TimeUnit.MILLISECONDS), is(equalTo(leaderSessionId)));
-			}
-		}
-	}
-
-	private DispatcherRunner createDispatcherRunner(
-			TestingRpcService rpcService,
-			TestingLeaderElectionService dispatcherLeaderElectionService,
-			PartialDispatcherServices partialDispatcherServices,
-			DispatcherRunnerFactory dispatcherRunnerFactory,
-			JobGraphStoreFactory jobGraphStoreFactory) throws Exception {
-		return dispatcherRunnerFactory.createDispatcherRunner(
-			dispatcherLeaderElectionService,
-			fatalErrorHandler,
-			jobGraphStoreFactory,
-			TestingUtils.defaultExecutor(),
-			rpcService,
-			partialDispatcherServices);
-	}
-
-	private DispatcherGateway grantLeadership(
-			TestingLeaderElectionService dispatcherLeaderElectionService,
-			DispatcherRunner dispatcherRunner) throws InterruptedException, java.util.concurrent.ExecutionException {
-		final UUID leaderSessionId = UUID.randomUUID();
-		dispatcherLeaderElectionService.isLeader(leaderSessionId).get();
-
-		return dispatcherRunner.getDispatcherGateway().get();
-	}
-
-	private static class TestingDispatcherFactory implements DispatcherFactory {
-		private final JobManagerRunnerFactory jobManagerRunnerFactory;
-
-		private TestingDispatcherFactory(JobManagerRunnerFactory jobManagerRunnerFactory) {
-			this.jobManagerRunnerFactory = jobManagerRunnerFactory;
-		}
-
-		@Override
-		public Dispatcher createDispatcher(
-			@Nonnull RpcService rpcService,
-			@Nonnull DispatcherId fencingToken,
-			@Nonnull Collection<JobGraph> recoveredJobs,
-			@Nonnull PartialDispatcherServicesWithJobGraphStore partialDispatcherServicesWithJobGraphStore) throws Exception {
-			return new StandaloneDispatcher(
-				rpcService,
-				generateEndpointIdWithUUID(),
-				fencingToken,
-				recoveredJobs,
-				DispatcherServices.from(partialDispatcherServicesWithJobGraphStore, jobManagerRunnerFactory));
-		}
-	}
-}
