diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/GenericRelDataType.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/GenericRelDataType.scala
index 3a533cb47ac..9b246835d7e 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/GenericRelDataType.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/GenericRelDataType.scala
@@ -39,7 +39,6 @@ class GenericRelDataType(
     typeSystem,
     SqlTypeName.ANY) {
 
-  isNullable = nullable
   computeDigest()
 
   override def toString = s"RAW($genericType)"
@@ -59,6 +58,8 @@ class GenericRelDataType(
     genericType.hashCode()
   }
 
+  override def isNullable: Boolean = nullable
+
   /**
     * [[ArraySqlType]], [[MapSqlType]]... use generateTypeString to equals and hashcode.
     */
diff --git a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/calcite/FlinkTypeFactoryTest.scala b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/calcite/FlinkTypeFactoryTest.scala
index 3f145d88066..a1636d0d0b6 100644
--- a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/calcite/FlinkTypeFactoryTest.scala
+++ b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/calcite/FlinkTypeFactoryTest.scala
@@ -18,14 +18,17 @@
 
 package org.apache.flink.table.planner.calcite
 
-import java.time.DayOfWeek
-
 import org.apache.flink.api.common.ExecutionConfig
+import org.apache.flink.api.common.typeinfo.Types
 import org.apache.flink.api.java.typeutils.runtime.kryo.KryoSerializer
-import org.apache.flink.table.types.logical.utils.LogicalTypeChecks.hasRoot
 import org.apache.flink.table.types.logical._
+import org.apache.flink.table.types.logical.utils.LogicalTypeChecks.hasRoot
+
+import junit.framework.TestCase.{assertFalse, assertTrue}
 import org.junit.{Assert, Test}
 
+import java.time.DayOfWeek
+
 class FlinkTypeFactoryTest {
 
   @Test
@@ -91,4 +94,26 @@ class FlinkTypeFactoryTest {
     Assert.assertEquals(new DecimalType(38, 5), FlinkTypeSystem.inferAggSumType(5))
     Assert.assertEquals(new DecimalType(false, 38, 6), FlinkTypeSystem.inferAggAvgType(5))
   }
+
+  @Test
+  def testCanonizeType(): Unit = {
+    val typeFactory = FlinkTypeFactory.INSTANCE
+    val genericTypeInfo = Types.GENERIC(classOf[TestClass])
+    val genericTypeInfo2 = Types.GENERIC(classOf[TestClass2])
+    val genericRelType = typeFactory
+        .createFieldTypeFromLogicalType(new TypeInformationRawType(genericTypeInfo))
+    val genericRelType2 = typeFactory
+        .createFieldTypeFromLogicalType(new TypeInformationRawType(genericTypeInfo))
+    val genericRelType3 = typeFactory
+        .createFieldTypeFromLogicalType(new TypeInformationRawType(genericTypeInfo2))
+
+    assertTrue("The type expect to be canonized", genericRelType eq genericRelType2)
+    assertFalse("The type expect to be not canonized", genericRelType eq genericRelType3)
+    assertFalse("The type expect to be not canonized",
+      typeFactory.builder().add("f0", genericRelType).build()
+          eq typeFactory.builder().add("f0", genericRelType3).build())
+  }
+
+  case class TestClass(f0: Int, f1: String)
+  case class TestClass2(f0: Int, f1: String)
 }
diff --git a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/ArrayRelDataType.scala b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/ArrayRelDataType.scala
index ed64c624e1e..3455e18c031 100644
--- a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/ArrayRelDataType.scala
+++ b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/ArrayRelDataType.scala
@@ -51,4 +51,7 @@ class ArrayRelDataType(
     typeInfo.hashCode()
   }
 
+  override def generateTypeString(sb: java.lang.StringBuilder, withDetail: Boolean): Unit = {
+    sb.append(s"$elementType ARRAY($typeInfo)")
+  }
 }
diff --git a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/GenericRelDataType.scala b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/GenericRelDataType.scala
index 84dd669636a..05f8c6551ad 100644
--- a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/GenericRelDataType.scala
+++ b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/GenericRelDataType.scala
@@ -37,8 +37,6 @@ class GenericRelDataType(
     typeSystem,
     SqlTypeName.ANY) {
 
-  isNullable = nullable
-
   override def toString = s"ANY($typeInfo)"
 
   def canEqual(other: Any): Boolean = other.isInstanceOf[GenericRelDataType]
@@ -55,4 +53,10 @@ class GenericRelDataType(
   override def hashCode(): Int = {
     typeInfo.hashCode()
   }
+
+  override def isNullable: Boolean = nullable
+
+  override def generateTypeString(sb: java.lang.StringBuilder, withDetail: Boolean): Unit = {
+    sb.append(s"ANY($typeInfo)")
+  }
 }
diff --git a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/MapRelDataType.scala b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/MapRelDataType.scala
index b3ff99fc85d..2f37a71c0ae 100644
--- a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/MapRelDataType.scala
+++ b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/MapRelDataType.scala
@@ -45,5 +45,4 @@ class MapRelDataType(
   override def hashCode(): Int = {
     Objects.hashCode(keyType, valueType)
   }
-
 }
diff --git a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/MultisetRelDataType.scala b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/MultisetRelDataType.scala
index 859fc41daa0..8a4dee1f0b3 100644
--- a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/MultisetRelDataType.scala
+++ b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/plan/schema/MultisetRelDataType.scala
@@ -47,4 +47,7 @@ class MultisetRelDataType(
     typeInfo.hashCode()
   }
 
+  override def generateTypeString(sb: java.lang.StringBuilder, withDetail: Boolean): Unit = {
+    sb.append(s"$elementType MULTISET($typeInfo)")
+  }
 }
diff --git a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/calcite/FlinkTypeFactoryTest.scala b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/calcite/FlinkTypeFactoryTest.scala
new file mode 100644
index 00000000000..9bd0a41d3c4
--- /dev/null
+++ b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/calcite/FlinkTypeFactoryTest.scala
@@ -0,0 +1,71 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.table.calcite
+
+import org.apache.flink.api.scala.typeutils.Types
+
+import org.apache.calcite.sql.`type`.SqlTypeName
+import org.junit.Assert.{assertFalse, assertTrue}
+import org.junit.Test
+
+/** Test cases for [[FlinkTypeFactory]]. */
+class FlinkTypeFactoryTest {
+
+  @Test
+  def testCanonizeType(): Unit = {
+    val typeFactory = FlinkTypeFactory.INSTANCE
+    val genericRelType = typeFactory
+        .createTypeFromTypeInfo(Types.GENERIC(classOf[TestClass]), isNullable = true)
+    val genericRelType2 = typeFactory
+        .createTypeFromTypeInfo(Types.GENERIC(classOf[TestClass]), isNullable = true)
+    val genericRelType3 = typeFactory
+        .createTypeFromTypeInfo(Types.GENERIC(classOf[TestClass2]), isNullable = true)
+
+    assertTrue("The type expect to be canonized", genericRelType eq genericRelType2)
+    assertFalse("The type expect to be not canonized", genericRelType eq genericRelType3)
+    assertFalse("The type expect to be not canonized",
+      typeFactory.builder().add("f0", genericRelType).build()
+          eq typeFactory.builder().add("f0", genericRelType3).build())
+
+    val varchar20Type = typeFactory.createSqlType(SqlTypeName.VARCHAR, 20)
+    val bigintType = typeFactory.createSqlType(SqlTypeName.BIGINT)
+
+    val arrayRelType = typeFactory.createArrayType(varchar20Type, 10)
+    val arrayRelType2 = typeFactory.createArrayType(varchar20Type, 10)
+    val arrayRelType3 = typeFactory.createArrayType(bigintType, 10)
+    assertTrue("The type expect to be canonized", arrayRelType eq arrayRelType2)
+    assertFalse("The type expect to be not canonized", arrayRelType eq arrayRelType3)
+    assertFalse("The type expect to be not canonized",
+      typeFactory.builder().add("f0", arrayRelType).build()
+          eq typeFactory.builder().add("f0", arrayRelType3).build())
+
+    val multisetRelType = typeFactory.createMultisetType(varchar20Type, 10)
+    val multisetRelType2 = typeFactory.createMultisetType(varchar20Type, 10)
+    val multisetRelType3 = typeFactory.createMultisetType(bigintType, 10)
+    assertTrue("The type expect to be canonized", multisetRelType eq multisetRelType2)
+    assertFalse("The type expect to be not canonized", multisetRelType eq multisetRelType3)
+    assertFalse("The type expect to be not canonized",
+      typeFactory.builder().add("f0", multisetRelType).build()
+          eq typeFactory.builder().add("f0", multisetRelType3).build())
+  }
+
+  case class TestClass(f0: Int, f1: String)
+
+  case class TestClass2(f0: Int, f1: String)
+}
