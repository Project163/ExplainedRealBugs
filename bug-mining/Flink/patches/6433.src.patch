diff --git a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/AggCodeGenHelper.scala b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/AggCodeGenHelper.scala
index 5d1556f0918..bb1135fc236 100644
--- a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/AggCodeGenHelper.scala
+++ b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/AggCodeGenHelper.scala
@@ -718,11 +718,11 @@ object AggCodeGenHelper {
             val externalAccTypeTerm = typeTerm(externalAccType.getConversionClass)
             val externalAccTerm = newName("acc")
             val externalAccCode = genToExternalConverter(ctx, externalAccType, aggBufferName)
+            val aggParametersCode = s"""${(Seq(externalAccTerm) ++ operandTerms).mkString(", ")}"""
             s"""
                |$externalAccTypeTerm $externalAccTerm = $externalAccCode;
                |${functionIdentifiers(function)}.accumulate(
-               |  $externalAccTerm,
-               |  ${operandTerms.mkString(", ")});
+               | $aggParametersCode);
                |$aggBufferName = ${genToInternalConverter(ctx, externalAccType)(externalAccTerm)};
                |${aggBufferExpr.nullTerm} = false;
           """.stripMargin
diff --git a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/table/AggregationITCase.scala b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/table/AggregationITCase.scala
index d1a4296597f..ca62f705f37 100644
--- a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/table/AggregationITCase.scala
+++ b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/table/AggregationITCase.scala
@@ -246,15 +246,22 @@ class AggregationITCase extends BatchTestBase {
     val t2 = BatchTableEnvUtil
       .fromCollection(tEnv, new mutable.MutableList[(Int, String)], "a, b")
       .select('a.sum, myAgg('b), 'a.count)
+    // test agg with empty parameter
+    val t3 = BatchTableEnvUtil
+      .fromCollection(tEnv, new mutable.MutableList[(Int, String)], "a, b")
+      .select('a.sum, myAgg(), 'a.count)
 
     val expected1 = "null,0"
     val expected2 = "null,0,0"
+    val expected3 = "null,0,0"
 
     val results1 = executeQuery(t1)
     val results2 = executeQuery(t2)
+    val results3 = executeQuery(t3)
 
     TestBaseUtils.compareResultAsText(results1.asJava, expected1)
     TestBaseUtils.compareResultAsText(results2.asJava, expected2)
+    TestBaseUtils.compareResultAsText(results3.asJava, expected3)
 
   }
 
diff --git a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/utils/UserDefinedAggFunctions.scala b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/utils/UserDefinedAggFunctions.scala
index 4938dda9a07..78d7b5f31c0 100644
--- a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/utils/UserDefinedAggFunctions.scala
+++ b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/utils/UserDefinedAggFunctions.scala
@@ -132,6 +132,10 @@ class NonMergableCount extends AggregateFunction[Long, NonMergableCountAcc] {
     }
   }
 
+  def accumulate(acc: NonMergableCountAcc): Unit = {
+    acc.count = acc.count + 1
+  }
+
   override def createAccumulator(): NonMergableCountAcc = NonMergableCountAcc(0)
 
   override def getValue(acc: NonMergableCountAcc): Long = acc.count
