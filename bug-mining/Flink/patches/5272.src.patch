diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/CodeGenUtils.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/CodeGenUtils.scala
index c4e791bc5a4..385938bf9b2 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/CodeGenUtils.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/CodeGenUtils.scala
@@ -257,7 +257,9 @@ object CodeGenUtils {
     case TIMESTAMP_WITHOUT_TIME_ZONE | TIMESTAMP_WITH_LOCAL_TIME_ZONE =>
       s"$term.hashCode()"
     case TIMESTAMP_WITH_TIME_ZONE | ARRAY | MULTISET | MAP =>
-      throw new UnsupportedOperationException("Unsupported type: " + t)
+      throw new UnsupportedOperationException(
+        s"Unsupported type($t) to generate hash code," +
+            s" the type($t) is not supported as a GROUP_BY/PARTITION_BY/JOIN_EQUAL/UNION field.")
     case INTERVAL_DAY_TIME => s"${className[JLong]}.hashCode($term)"
     case ROW | STRUCTURED_TYPE =>
       val fieldCount = getFieldCount(t)
diff --git a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/CalcITCase.scala b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/CalcITCase.scala
index d1736f7bbea..0c6225858d8 100644
--- a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/CalcITCase.scala
+++ b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/CalcITCase.scala
@@ -45,6 +45,7 @@ import org.apache.flink.types.Row
 
 import org.junit.Assert.assertEquals
 import org.junit._
+import org.junit.rules.ExpectedException
 
 import java.nio.charset.StandardCharsets
 import java.sql.{Date, Time, Timestamp}
@@ -55,6 +56,11 @@ import scala.collection.Seq
 
 class CalcITCase extends BatchTestBase {
 
+  var _expectedEx: ExpectedException = ExpectedException.none
+
+  @Rule
+  def expectedEx: ExpectedException = _expectedEx
+
   @Before
   override def before(): Unit = {
     super.before()
@@ -793,6 +799,15 @@ class CalcITCase extends BatchTestBase {
     )
   }
 
+  @Test
+  def testMapTypeGroupBy(): Unit = {
+    _expectedEx.expectMessage("is not supported as a GROUP_BY/PARTITION_BY/JOIN_EQUAL/UNION field")
+    checkResult(
+      "SELECT COUNT(*) FROM SmallTable3 GROUP BY MAP[1, 'Hello', 2, 'Hi']",
+      Seq()
+    )
+  }
+
   @Test
   def testValueConstructor(): Unit = {
     val data = Seq(row("foo", 12, localDateTime("1984-07-12 14:34:24.001")))
