diff --git a/flink-core/src/main/java/org/apache/flink/core/fs/EntropyInjector.java b/flink-core/src/main/java/org/apache/flink/core/fs/EntropyInjector.java
index bc63ae3fce8..d8e22d2ee81 100644
--- a/flink-core/src/main/java/org/apache/flink/core/fs/EntropyInjector.java
+++ b/flink-core/src/main/java/org/apache/flink/core/fs/EntropyInjector.java
@@ -22,6 +22,7 @@ import org.apache.flink.annotation.PublicEvolving;
 import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.core.fs.FileSystem.WriteMode;
 import org.apache.flink.util.FlinkRuntimeException;
+import org.apache.flink.util.WrappingProxy;
 
 import javax.annotation.Nullable;
 
@@ -95,23 +96,14 @@ public class EntropyInjector {
     private static EntropyInjectingFileSystem getEntropyFs(FileSystem fs) {
         if (fs instanceof EntropyInjectingFileSystem) {
             return (EntropyInjectingFileSystem) fs;
-        } else if (fs instanceof SafetyNetWrapperFileSystem) {
-            FileSystem delegate = ((SafetyNetWrapperFileSystem) fs).getWrappedDelegate();
-            if (delegate instanceof EntropyInjectingFileSystem) {
-                return (EntropyInjectingFileSystem) delegate;
-            } else if (delegate instanceof PluginFileSystemFactory.ClassLoaderFixingFileSystem) {
-                FileSystem innerFs =
-                        ((PluginFileSystemFactory.ClassLoaderFixingFileSystem) delegate).getInner();
-                if (innerFs instanceof EntropyInjectingFileSystem) {
-                    return (EntropyInjectingFileSystem) innerFs;
-                }
-                return null;
-            } else {
-                return null;
-            }
-        } else {
-            return null;
         }
+
+        if (fs instanceof WrappingProxy) {
+            FileSystem delegate = ((WrappingProxy<FileSystem>) fs).getWrappedDelegate();
+            return getEntropyFs(delegate);
+        }
+
+        return null;
     }
 
     @VisibleForTesting
diff --git a/flink-core/src/main/java/org/apache/flink/core/fs/PluginFileSystemFactory.java b/flink-core/src/main/java/org/apache/flink/core/fs/PluginFileSystemFactory.java
index 994062a0bfc..0d1e889c61b 100644
--- a/flink-core/src/main/java/org/apache/flink/core/fs/PluginFileSystemFactory.java
+++ b/flink-core/src/main/java/org/apache/flink/core/fs/PluginFileSystemFactory.java
@@ -19,6 +19,7 @@ package org.apache.flink.core.fs;
 
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.util.TemporaryClassLoaderContext;
+import org.apache.flink.util.WrappingProxy;
 
 import java.io.IOException;
 import java.net.URI;
@@ -67,7 +68,8 @@ public class PluginFileSystemFactory implements FileSystemFactory {
         return String.format("Plugin %s", inner.getClass().getName());
     }
 
-    static class ClassLoaderFixingFileSystem extends FileSystem {
+    static class ClassLoaderFixingFileSystem extends FileSystem
+            implements WrappingProxy<FileSystem> {
         private final FileSystem inner;
         private final ClassLoader loader;
 
@@ -190,7 +192,8 @@ public class PluginFileSystemFactory implements FileSystemFactory {
             }
         }
 
-        public FileSystem getInner() {
+        @Override
+        public FileSystem getWrappedDelegate() {
             return inner;
         }
     }
diff --git a/flink-core/src/test/java/org/apache/flink/core/fs/EntropyInjectorTest.java b/flink-core/src/test/java/org/apache/flink/core/fs/EntropyInjectorTest.java
index 5118a75be70..802f2ec523e 100644
--- a/flink-core/src/test/java/org/apache/flink/core/fs/EntropyInjectorTest.java
+++ b/flink-core/src/test/java/org/apache/flink/core/fs/EntropyInjectorTest.java
@@ -169,7 +169,7 @@ public class EntropyInjectorTest {
     }
 
     @Test
-    public void testClassLoaderFixingFs() throws Exception {
+    public void testClassLoaderFixingFsWithSafeyNet() throws Exception {
         final String entropyKey = "__ekey__";
         final String entropyValue = "abc";
 
@@ -194,6 +194,26 @@ public class EntropyInjectorTest {
         }
     }
 
+    @Test
+    public void testClassLoaderFixingFsWithoutSafeyNet() throws Exception {
+        final String entropyKey = "__ekey__";
+        final String entropyValue = "abc";
+
+        final File folder = TMP_FOLDER.newFolder();
+
+        final Path path = new Path(Path.fromLocalFile(folder), entropyKey + "/path/");
+        final Path pathWithEntropy = new Path(Path.fromLocalFile(folder), entropyValue + "/path/");
+
+        PluginFileSystemFactory pluginFsFactory =
+                PluginFileSystemFactory.of(new TestFileSystemFactory(entropyKey, entropyValue));
+        FileSystem testFs = pluginFsFactory.create(URI.create("test"));
+
+        OutputStreamAndPath streamAndPath =
+                EntropyInjector.createEntropyAware(testFs, path, WriteMode.NO_OVERWRITE);
+
+        assertEquals(pathWithEntropy, streamAndPath.path());
+    }
+
     @Test
     public void testIsEntropyFs() {
         final FileSystem efs = new TestEntropyInjectingFs("test", "ignored");
