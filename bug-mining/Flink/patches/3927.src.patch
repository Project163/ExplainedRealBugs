diff --git a/flink-python/pyflink/java_gateway.py b/flink-python/pyflink/java_gateway.py
index a3d70c33951..182526f66ff 100644
--- a/flink-python/pyflink/java_gateway.py
+++ b/flink-python/pyflink/java_gateway.py
@@ -34,6 +34,14 @@ _gateway = None
 _lock = RLock()
 
 
+def is_launch_gateway_disabled():
+    if "PYFLINK_GATEWAY_DISABLED" in os.environ \
+            and os.environ["PYFLINK_GATEWAY_DISABLED"].lower() not in ["0", "false", ""]:
+        return True
+    else:
+        return False
+
+
 def get_gateway():
     # type: () -> JavaGateway
     global _gateway
@@ -59,7 +67,11 @@ def launch_gateway():
     """
     launch jvm gateway
     """
-
+    if is_launch_gateway_disabled():
+        raise Exception("It's launching the PythonGatewayServer during Python UDF execution "
+                        "which is unexpected. It usually happens when the job codes are "
+                        "in the top level of the Python script file and are not enclosed in a "
+                        "`if name == 'main'` statement.")
     FLINK_HOME = _find_flink_home()
     # TODO windows support
     on_windows = platform.system() == "Windows"
diff --git a/flink-python/pyflink/table/tests/test_dependency.py b/flink-python/pyflink/table/tests/test_dependency.py
index 38f11f76c37..66930ff30a7 100644
--- a/flink-python/pyflink/table/tests/test_dependency.py
+++ b/flink-python/pyflink/table/tests/test_dependency.py
@@ -178,7 +178,7 @@ class BlinkStreamDependencyTests(DependencyTests, PyFlinkBlinkStreamTableTestCas
         actual = source_sink_utils.results()
         self.assert_equals(actual, ["3,1", "4,2", "5,3"])
 
-    def test_set_python_exec(self):
+    def test_set_environment(self):
         if getattr(os, "symlink", None) is None:
             self.skipTest("Symbolic link is not supported, skip testing 'test_set_python_exec'...")
 
@@ -196,11 +196,27 @@ class BlinkStreamDependencyTests(DependencyTests, PyFlinkBlinkStreamTableTestCas
         self.t_env.register_function("check_python_exec",
                                      udf(check_python_exec, DataTypes.BIGINT(),
                                          DataTypes.BIGINT()))
+
+        def check_pyflink_gateway_disabled(i):
+            try:
+                from pyflink.java_gateway import get_gateway
+                get_gateway()
+            except Exception as e:
+                assert str(e).startswith("It's launching the PythonGatewayServer during Python UDF"
+                                         " execution which is unexpected.")
+            else:
+                raise Exception("The gateway server is not disabled!")
+            return i
+
+        self.t_env.register_function("check_pyflink_gateway_disabled",
+                                     udf(check_pyflink_gateway_disabled, DataTypes.BIGINT(),
+                                         DataTypes.BIGINT()))
+
         table_sink = source_sink_utils.TestAppendSink(
             ['a', 'b'], [DataTypes.BIGINT(), DataTypes.BIGINT()])
         self.t_env.register_table_sink("Results", table_sink)
         t = self.t_env.from_elements([(1, 2), (2, 5), (3, 1)], ['a', 'b'])
-        t.select("check_python_exec(a), a").insert_into("Results")
+        t.select("check_python_exec(a), check_pyflink_gateway_disabled(a)").insert_into("Results")
         self.t_env.execute("test")
 
         actual = source_sink_utils.results()
diff --git a/flink-python/src/main/java/org/apache/flink/python/env/ProcessPythonEnvironmentManager.java b/flink-python/src/main/java/org/apache/flink/python/env/ProcessPythonEnvironmentManager.java
index 9be690db35e..f29133350d2 100644
--- a/flink-python/src/main/java/org/apache/flink/python/env/ProcessPythonEnvironmentManager.java
+++ b/flink-python/src/main/java/org/apache/flink/python/env/ProcessPythonEnvironmentManager.java
@@ -60,6 +60,8 @@ public final class ProcessPythonEnvironmentManager implements PythonEnvironmentM
 
 	private static final Logger LOG = LoggerFactory.getLogger(ProcessPythonEnvironmentManager.class);
 
+	@VisibleForTesting
+	static final String PYFLINK_GATEWAY_DISABLED = "PYFLINK_GATEWAY_DISABLED";
 	@VisibleForTesting
 	public static final String PYTHON_REQUIREMENTS_FILE = "_PYTHON_REQUIREMENTS_FILE";
 	@VisibleForTesting
@@ -190,6 +192,14 @@ public final class ProcessPythonEnvironmentManager implements PythonEnvironmentM
 		// set BOOT_LOG_DIR.
 		env.put("BOOT_LOG_DIR", baseDirectory);
 
+		// disable the launching of gateway server to prevent from this dead loop:
+		// launch UDF worker -> import udf -> import job code
+		//        ^                                    | (If the job code is not enclosed in a
+		//        									   |  if name == 'main' statement)
+		//        |                                    V
+		// execute job in local mode <- launch gateway server and submit job to local executor
+		env.put(PYFLINK_GATEWAY_DISABLED, "true");
+
 		// set the path of python interpreter, it will be used to execute the udf worker.
 		env.put("python", dependencyInfo.getPythonExec());
 		LOG.info("Python interpreter path: {}", dependencyInfo.getPythonExec());
diff --git a/flink-python/src/test/java/org/apache/flink/python/env/ProcessPythonEnvironmentManagerTest.java b/flink-python/src/test/java/org/apache/flink/python/env/ProcessPythonEnvironmentManagerTest.java
index 3c555da2038..ecc40e25036 100644
--- a/flink-python/src/test/java/org/apache/flink/python/env/ProcessPythonEnvironmentManagerTest.java
+++ b/flink-python/src/test/java/org/apache/flink/python/env/ProcessPythonEnvironmentManagerTest.java
@@ -42,6 +42,7 @@ import java.util.LinkedHashMap;
 import java.util.Map;
 import java.util.Set;
 
+import static org.apache.flink.python.env.ProcessPythonEnvironmentManager.PYFLINK_GATEWAY_DISABLED;
 import static org.apache.flink.python.env.ProcessPythonEnvironmentManager.PYTHON_ARCHIVES_DIR;
 import static org.apache.flink.python.env.ProcessPythonEnvironmentManager.PYTHON_FILES_DIR;
 import static org.apache.flink.python.env.ProcessPythonEnvironmentManager.PYTHON_REQUIREMENTS_CACHE;
@@ -379,6 +380,7 @@ public class ProcessPythonEnvironmentManagerTest {
 		String tmpBase = environmentManager.getBaseDirectory();
 		map.put("python", "python");
 		map.put("BOOT_LOG_DIR", tmpBase);
+		map.put(PYFLINK_GATEWAY_DISABLED, "true");
 		return map;
 	}
 
