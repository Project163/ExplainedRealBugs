diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/metrics/InputBufferPoolUsageGauge.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/metrics/InputBufferPoolUsageGauge.java
index 992f5611203..c7a6d4e76a9 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/metrics/InputBufferPoolUsageGauge.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/metrics/InputBufferPoolUsageGauge.java
@@ -19,6 +19,7 @@
 package org.apache.flink.runtime.io.network.metrics;
 
 import org.apache.flink.metrics.Gauge;
+import org.apache.flink.runtime.io.network.buffer.BufferPool;
 import org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate;
 
 /**
@@ -38,8 +39,11 @@ public class InputBufferPoolUsageGauge implements Gauge<Float> {
 		int bufferPoolSize = 0;
 
 		for (SingleInputGate inputGate : inputGates) {
-			usedBuffers += inputGate.getBufferPool().bestEffortGetNumOfUsedBuffers();
-			bufferPoolSize += inputGate.getBufferPool().getNumBuffers();
+			BufferPool bufferPool = inputGate.getBufferPool();
+			if (bufferPool != null) {
+				usedBuffers += bufferPool.bestEffortGetNumOfUsedBuffers();
+				bufferPoolSize += bufferPool.getNumBuffers();
+			}
 		}
 
 		if (bufferPoolSize != 0) {
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/metrics/OutputBufferPoolUsageGauge.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/metrics/OutputBufferPoolUsageGauge.java
index 9aad92ce628..b8f771ba823 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/metrics/OutputBufferPoolUsageGauge.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/metrics/OutputBufferPoolUsageGauge.java
@@ -19,6 +19,7 @@
 package org.apache.flink.runtime.io.network.metrics;
 
 import org.apache.flink.metrics.Gauge;
+import org.apache.flink.runtime.io.network.buffer.BufferPool;
 import org.apache.flink.runtime.io.network.partition.ResultPartition;
 
 /**
@@ -38,8 +39,12 @@ public class OutputBufferPoolUsageGauge implements Gauge<Float> {
 		int bufferPoolSize = 0;
 
 		for (ResultPartition resultPartition : resultPartitions) {
-			usedBuffers += resultPartition.getBufferPool().bestEffortGetNumOfUsedBuffers();
-			bufferPoolSize += resultPartition.getBufferPool().getNumBuffers();
+			BufferPool bufferPool = resultPartition.getBufferPool();
+
+			if (bufferPool != null) {
+				usedBuffers += bufferPool.bestEffortGetNumOfUsedBuffers();
+				bufferPoolSize += bufferPool.getNumBuffers();
+			}
 		}
 
 		if (bufferPoolSize != 0) {
