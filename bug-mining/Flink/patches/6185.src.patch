diff --git a/flink-connectors/flink-connector-aws-base/src/main/java/org/apache/flink/connector/aws/util/AWSGeneralUtil.java b/flink-connectors/flink-connector-aws-base/src/main/java/org/apache/flink/connector/aws/util/AWSGeneralUtil.java
index 2c0c48c4eb4..989f56e5ff2 100644
--- a/flink-connectors/flink-connector-aws-base/src/main/java/org/apache/flink/connector/aws/util/AWSGeneralUtil.java
+++ b/flink-connectors/flink-connector-aws-base/src/main/java/org/apache/flink/connector/aws/util/AWSGeneralUtil.java
@@ -21,6 +21,7 @@ import org.apache.flink.annotation.Internal;
 import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.connector.aws.config.AWSConfigConstants;
 import org.apache.flink.connector.aws.config.AWSConfigConstants.CredentialProvider;
+import org.apache.flink.util.ExceptionUtils;
 
 import software.amazon.awssdk.auth.credentials.AwsBasicCredentials;
 import software.amazon.awssdk.auth.credentials.AwsCredentialsProvider;
@@ -40,6 +41,7 @@ import software.amazon.awssdk.services.sts.StsClient;
 import software.amazon.awssdk.services.sts.auth.StsAssumeRoleCredentialsProvider;
 import software.amazon.awssdk.services.sts.model.AssumeRoleRequest;
 import software.amazon.awssdk.utils.AttributeMap;
+import software.amazon.awssdk.utils.SdkAutoCloseable;
 
 import java.nio.file.Paths;
 import java.time.Duration;
@@ -351,4 +353,20 @@ public class AWSGeneralUtil {
             }
         }
     }
+
+    public static void closeResources(SdkAutoCloseable... resources) {
+        RuntimeException exception = null;
+        for (SdkAutoCloseable resource : resources) {
+            if (resource != null) {
+                try {
+                    resource.close();
+                } catch (RuntimeException e) {
+                    exception = ExceptionUtils.firstOrSuppressed(e, exception);
+                }
+            }
+        }
+        if (exception != null) {
+            throw exception;
+        }
+    }
 }
diff --git a/flink-connectors/flink-connector-aws-base/src/test/java/org/apache/flink/connector/aws/testutils/AWSServicesTestUtils.java b/flink-connectors/flink-connector-aws-base/src/test/java/org/apache/flink/connector/aws/testutils/AWSServicesTestUtils.java
index ff915faec66..79fbe704e51 100644
--- a/flink-connectors/flink-connector-aws-base/src/test/java/org/apache/flink/connector/aws/testutils/AWSServicesTestUtils.java
+++ b/flink-connectors/flink-connector-aws-base/src/test/java/org/apache/flink/connector/aws/testutils/AWSServicesTestUtils.java
@@ -25,7 +25,6 @@ import software.amazon.awssdk.auth.credentials.AwsCredentialsProvider;
 import software.amazon.awssdk.auth.credentials.StaticCredentialsProvider;
 import software.amazon.awssdk.core.ResponseBytes;
 import software.amazon.awssdk.core.async.AsyncResponseTransformer;
-import software.amazon.awssdk.core.waiters.WaiterResponse;
 import software.amazon.awssdk.http.async.SdkAsyncHttpClient;
 import software.amazon.awssdk.regions.Region;
 import software.amazon.awssdk.services.iam.IamAsyncClient;
@@ -36,14 +35,12 @@ import software.amazon.awssdk.services.s3.model.CreateBucketRequest;
 import software.amazon.awssdk.services.s3.model.GetObjectRequest;
 import software.amazon.awssdk.services.s3.model.GetObjectResponse;
 import software.amazon.awssdk.services.s3.model.HeadBucketRequest;
-import software.amazon.awssdk.services.s3.model.HeadBucketResponse;
 import software.amazon.awssdk.services.s3.model.ListObjectsRequest;
 import software.amazon.awssdk.services.s3.model.ListObjectsResponse;
 import software.amazon.awssdk.services.s3.model.S3Object;
 import software.amazon.awssdk.services.s3.waiters.S3AsyncWaiter;
 
 import java.net.URI;
-import java.net.URISyntaxException;
 import java.util.List;
 import java.util.Properties;
 import java.util.concurrent.CompletableFuture;
@@ -64,30 +61,30 @@ public class AWSServicesTestUtils {
     private static final String ACCESS_KEY_ID = "accessKeyId";
     private static final String SECRET_ACCESS_KEY = "secretAccessKey";
 
-    public static S3AsyncClient getS3Client(String endpoint) throws URISyntaxException {
+    public static S3AsyncClient createS3Client(String endpoint, SdkAsyncHttpClient httpClient) {
         return S3AsyncClient.builder()
-                .httpClient(getHttpClient(endpoint))
+                .httpClient(httpClient)
                 .region(Region.AP_SOUTHEAST_1)
-                .endpointOverride(new URI(endpoint))
-                .credentialsProvider(getDefaultCredentials())
+                .endpointOverride(URI.create(endpoint))
+                .credentialsProvider(createDefaultCredentials())
                 .build();
     }
 
-    public static IamAsyncClient getIamClient(String endpoint) throws URISyntaxException {
+    public static IamAsyncClient createIamClient(String endpoint, SdkAsyncHttpClient httpClient) {
         return IamAsyncClient.builder()
-                .httpClient(getHttpClient(endpoint))
+                .httpClient(httpClient)
                 .region(Region.AWS_GLOBAL)
-                .endpointOverride(new URI(endpoint))
-                .credentialsProvider(getDefaultCredentials())
+                .endpointOverride(URI.create(endpoint))
+                .credentialsProvider(createDefaultCredentials())
                 .build();
     }
 
-    public static AwsCredentialsProvider getDefaultCredentials() {
+    public static AwsCredentialsProvider createDefaultCredentials() {
         return StaticCredentialsProvider.create(
                 AwsBasicCredentials.create(ACCESS_KEY_ID, SECRET_ACCESS_KEY));
     }
 
-    public static Properties getConfig(String endpoint) {
+    public static Properties createConfig(String endpoint) {
         Properties config = new Properties();
         config.setProperty(AWS_REGION, Region.AP_SOUTHEAST_1.toString());
         config.setProperty(AWS_ENDPOINT, endpoint);
@@ -98,8 +95,8 @@ public class AWSServicesTestUtils {
         return config;
     }
 
-    public static SdkAsyncHttpClient getHttpClient(String endpoint) {
-        return AWSGeneralUtil.createAsyncHttpClient(getConfig(endpoint));
+    public static SdkAsyncHttpClient createHttpClient(String endpoint) {
+        return AWSGeneralUtil.createAsyncHttpClient(createConfig(endpoint));
     }
 
     public static void createBucket(S3AsyncClient s3Client, String bucketName)
@@ -111,11 +108,9 @@ public class AWSServicesTestUtils {
         HeadBucketRequest bucketRequestWait =
                 HeadBucketRequest.builder().bucket(bucketName).build();
 
-        S3AsyncWaiter s3Waiter = s3Client.waiter();
-        CompletableFuture<WaiterResponse<HeadBucketResponse>> waiterResponseFuture =
-                s3Waiter.waitUntilBucketExists(bucketRequestWait);
-
-        waiterResponseFuture.get();
+        try (final S3AsyncWaiter waiter = s3Client.waiter()) {
+            waiter.waitUntilBucketExists(bucketRequestWait).get();
+        }
     }
 
     public static void createIAMRole(IamAsyncClient iam, String roleName)
diff --git a/flink-connectors/flink-connector-aws-base/src/test/java/org/apache/flink/connector/aws/testutils/LocalstackContainer.java b/flink-connectors/flink-connector-aws-base/src/test/java/org/apache/flink/connector/aws/testutils/LocalstackContainer.java
index cc5afae442e..f5af6316b89 100644
--- a/flink-connectors/flink-connector-aws-base/src/test/java/org/apache/flink/connector/aws/testutils/LocalstackContainer.java
+++ b/flink-connectors/flink-connector-aws-base/src/test/java/org/apache/flink/connector/aws/testutils/LocalstackContainer.java
@@ -23,10 +23,10 @@ import org.rnorth.ducttape.unreliables.Unreliables;
 import org.testcontainers.containers.GenericContainer;
 import org.testcontainers.containers.wait.strategy.AbstractWaitStrategy;
 import org.testcontainers.utility.DockerImageName;
+import software.amazon.awssdk.http.async.SdkAsyncHttpClient;
 import software.amazon.awssdk.services.s3.S3AsyncClient;
 import software.amazon.awssdk.services.s3.model.S3Object;
 
-import java.net.URISyntaxException;
 import java.util.List;
 import java.util.concurrent.ExecutionException;
 
@@ -73,12 +73,15 @@ public class LocalstackContainer extends GenericContainer<LocalstackContainer> {
                     () -> rateLimiter.getWhenReady(this::list));
         }
 
-        private List<S3Object> list()
-                throws ExecutionException, InterruptedException, URISyntaxException {
-            String bucketName = "bucket-name-not-to-be-used";
-            S3AsyncClient client = AWSServicesTestUtils.getS3Client(getEndpoint());
-            AWSServicesTestUtils.createBucket(client, bucketName);
-            return AWSServicesTestUtils.listBucketObjects(client, bucketName);
+        private List<S3Object> list() throws ExecutionException, InterruptedException {
+            final String bucketName = "bucket-name-not-to-be-used";
+            try (final SdkAsyncHttpClient httpClient =
+                            AWSServicesTestUtils.createHttpClient(getEndpoint());
+                    final S3AsyncClient client =
+                            AWSServicesTestUtils.createS3Client(getEndpoint(), httpClient)) {
+                AWSServicesTestUtils.createBucket(client, bucketName);
+                return AWSServicesTestUtils.listBucketObjects(client, bucketName);
+            }
         }
     }
 }
diff --git a/flink-connectors/flink-connector-aws-kinesis-firehose/src/main/java/org/apache/flink/connector/firehose/sink/KinesisFirehoseSinkWriter.java b/flink-connectors/flink-connector-aws-kinesis-firehose/src/main/java/org/apache/flink/connector/firehose/sink/KinesisFirehoseSinkWriter.java
index b41103fbd83..0d6ff23ea46 100644
--- a/flink-connectors/flink-connector-aws-kinesis-firehose/src/main/java/org/apache/flink/connector/firehose/sink/KinesisFirehoseSinkWriter.java
+++ b/flink-connectors/flink-connector-aws-kinesis-firehose/src/main/java/org/apache/flink/connector/firehose/sink/KinesisFirehoseSinkWriter.java
@@ -56,8 +56,23 @@ import java.util.function.Consumer;
  */
 @Internal
 class KinesisFirehoseSinkWriter<InputT> extends AsyncSinkWriter<InputT, Record> {
+
     private static final Logger LOG = LoggerFactory.getLogger(KinesisFirehoseSinkWriter.class);
 
+    private static SdkAsyncHttpClient createHttpClient(Properties firehoseClientProperties) {
+        return AWSGeneralUtil.createAsyncHttpClient(firehoseClientProperties);
+    }
+
+    private static FirehoseAsyncClient createFirehoseClient(
+            Properties firehoseClientProperties, SdkAsyncHttpClient httpClient) {
+        return AWSAsyncSinkUtil.createAwsAsyncClient(
+                firehoseClientProperties,
+                httpClient,
+                FirehoseAsyncClient.builder(),
+                KinesisFirehoseConfigConstants.BASE_FIREHOSE_USER_AGENT_PREFIX_FORMAT,
+                KinesisFirehoseConfigConstants.FIREHOSE_CLIENT_USER_AGENT_PREFIX);
+    }
+
     /* A counter for the total number of records that have encountered an error during put */
     private final Counter numRecordsOutErrorsCounter;
 
@@ -67,8 +82,11 @@ class KinesisFirehoseSinkWriter<InputT> extends AsyncSinkWriter<InputT, Record>
     /* The sink writer metric group */
     private final SinkWriterMetricGroup metrics;
 
-    /* The asynchronous Firehose client - construction is by firehoseClientProperties */
-    private final FirehoseAsyncClient client;
+    /* The asynchronous http client */
+    private final SdkAsyncHttpClient httpClient;
+
+    /* The asynchronous Firehose client */
+    private final FirehoseAsyncClient firehoseClient;
 
     /* Flag to whether fatally fail any time we encounter an exception when persisting records */
     private final boolean failOnError;
@@ -98,19 +116,8 @@ class KinesisFirehoseSinkWriter<InputT> extends AsyncSinkWriter<InputT, Record>
         this.deliveryStreamName = deliveryStreamName;
         this.metrics = context.metricGroup();
         this.numRecordsOutErrorsCounter = metrics.getNumRecordsOutErrorsCounter();
-        this.client = buildClient(firehoseClientProperties);
-    }
-
-    private FirehoseAsyncClient buildClient(Properties firehoseClientProperties) {
-        final SdkAsyncHttpClient httpClient =
-                AWSGeneralUtil.createAsyncHttpClient(firehoseClientProperties);
-
-        return AWSAsyncSinkUtil.createAwsAsyncClient(
-                firehoseClientProperties,
-                httpClient,
-                FirehoseAsyncClient.builder(),
-                KinesisFirehoseConfigConstants.BASE_FIREHOSE_USER_AGENT_PREFIX_FORMAT,
-                KinesisFirehoseConfigConstants.FIREHOSE_CLIENT_USER_AGENT_PREFIX);
+        this.httpClient = createHttpClient(firehoseClientProperties);
+        this.firehoseClient = createFirehoseClient(firehoseClientProperties, httpClient);
     }
 
     @Override
@@ -125,7 +132,8 @@ class KinesisFirehoseSinkWriter<InputT> extends AsyncSinkWriter<InputT, Record>
 
         LOG.trace("Request to submit {} entries to KDF using KDF Sink.", requestEntries.size());
 
-        CompletableFuture<PutRecordBatchResponse> future = client.putRecordBatch(batchRequest);
+        CompletableFuture<PutRecordBatchResponse> future =
+                firehoseClient.putRecordBatch(batchRequest);
 
         future.whenComplete(
                 (response, err) -> {
@@ -144,6 +152,11 @@ class KinesisFirehoseSinkWriter<InputT> extends AsyncSinkWriter<InputT, Record>
         return requestEntry.data().asByteArrayUnsafe().length;
     }
 
+    @Override
+    public void close() {
+        AWSGeneralUtil.closeResources(httpClient, firehoseClient);
+    }
+
     private void handleFullyFailedRequest(
             Throwable err, List<Record> requestEntries, Consumer<List<Record>> requestResult) {
         LOG.warn(
diff --git a/flink-connectors/flink-connector-aws-kinesis-firehose/src/test/java/org/apache/flink/connector/firehose/sink/KinesisFirehoseSinkITCase.java b/flink-connectors/flink-connector-aws-kinesis-firehose/src/test/java/org/apache/flink/connector/firehose/sink/KinesisFirehoseSinkITCase.java
index aab696d8f60..0e37f1527cb 100644
--- a/flink-connectors/flink-connector-aws-kinesis-firehose/src/test/java/org/apache/flink/connector/firehose/sink/KinesisFirehoseSinkITCase.java
+++ b/flink-connectors/flink-connector-aws-kinesis-firehose/src/test/java/org/apache/flink/connector/firehose/sink/KinesisFirehoseSinkITCase.java
@@ -18,7 +18,9 @@
 package org.apache.flink.connector.firehose.sink;
 
 import org.apache.flink.api.common.serialization.SimpleStringSchema;
+import org.apache.flink.connector.aws.testutils.AWSServicesTestUtils;
 import org.apache.flink.connector.aws.testutils.LocalstackContainer;
+import org.apache.flink.connector.aws.util.AWSGeneralUtil;
 import org.apache.flink.streaming.api.datastream.DataStream;
 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
 import org.apache.flink.util.DockerImageVersions;
@@ -33,6 +35,7 @@ import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 import org.testcontainers.utility.DockerImageName;
 import software.amazon.awssdk.core.SdkSystemSetting;
+import software.amazon.awssdk.http.async.SdkAsyncHttpClient;
 import software.amazon.awssdk.services.firehose.FirehoseAsyncClient;
 import software.amazon.awssdk.services.iam.IamAsyncClient;
 import software.amazon.awssdk.services.s3.S3AsyncClient;
@@ -43,10 +46,10 @@ import java.util.ArrayList;
 import java.util.List;
 
 import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.createBucket;
+import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.createConfig;
 import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.createIAMRole;
-import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.getConfig;
-import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.getIamClient;
-import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.getS3Client;
+import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.createIamClient;
+import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.createS3Client;
 import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.listBucketObjects;
 import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.readObjectsFromS3Bucket;
 import static org.apache.flink.connector.firehose.sink.testutils.KinesisFirehoseTestUtils.createDeliveryStream;
@@ -63,6 +66,7 @@ public class KinesisFirehoseSinkITCase {
     private static final String STREAM_NAME = "s3-stream";
     private static final int NUMBER_OF_ELEMENTS = 92;
 
+    private SdkAsyncHttpClient httpClient;
     private S3AsyncClient s3AsyncClient;
     private FirehoseAsyncClient firehoseAsyncClient;
     private IamAsyncClient iamAsyncClient;
@@ -74,14 +78,17 @@ public class KinesisFirehoseSinkITCase {
     @Before
     public void setup() throws Exception {
         System.setProperty(SdkSystemSetting.CBOR_ENABLED.property(), "false");
-        s3AsyncClient = getS3Client(mockFirehoseContainer.getEndpoint());
-        firehoseAsyncClient = getFirehoseClient(mockFirehoseContainer.getEndpoint());
-        iamAsyncClient = getIamClient(mockFirehoseContainer.getEndpoint());
+        httpClient = AWSServicesTestUtils.createHttpClient(mockFirehoseContainer.getEndpoint());
+        s3AsyncClient = createS3Client(mockFirehoseContainer.getEndpoint(), httpClient);
+        firehoseAsyncClient = getFirehoseClient(mockFirehoseContainer.getEndpoint(), httpClient);
+        iamAsyncClient = createIamClient(mockFirehoseContainer.getEndpoint(), httpClient);
     }
 
     @After
     public void teardown() {
         System.clearProperty(SdkSystemSetting.CBOR_ENABLED.property());
+        AWSGeneralUtil.closeResources(
+                httpClient, s3AsyncClient, firehoseAsyncClient, iamAsyncClient);
     }
 
     @Test
@@ -112,14 +119,17 @@ public class KinesisFirehoseSinkITCase {
                         .setSerializationSchema(new SimpleStringSchema())
                         .setDeliveryStreamName(STREAM_NAME)
                         .setMaxBatchSize(1)
-                        .setFirehoseClientProperties(getConfig(mockFirehoseContainer.getEndpoint()))
+                        .setFirehoseClientProperties(
+                                createConfig(mockFirehoseContainer.getEndpoint()))
                         .build();
 
         generator.sinkTo(kdsSink);
         env.execute("Integration Test");
 
         List<S3Object> objects =
-                listBucketObjects(getS3Client(mockFirehoseContainer.getEndpoint()), BUCKET_NAME);
+                listBucketObjects(
+                        createS3Client(mockFirehoseContainer.getEndpoint(), httpClient),
+                        BUCKET_NAME);
         assertThat(objects.size()).isEqualTo(NUMBER_OF_ELEMENTS);
         assertThat(
                         readObjectsFromS3Bucket(
diff --git a/flink-connectors/flink-connector-aws-kinesis-firehose/src/test/java/org/apache/flink/connector/firehose/sink/testutils/KinesisFirehoseTestUtils.java b/flink-connectors/flink-connector-aws-kinesis-firehose/src/test/java/org/apache/flink/connector/firehose/sink/testutils/KinesisFirehoseTestUtils.java
index 1de389d3882..4496662195c 100644
--- a/flink-connectors/flink-connector-aws-kinesis-firehose/src/test/java/org/apache/flink/connector/firehose/sink/testutils/KinesisFirehoseTestUtils.java
+++ b/flink-connectors/flink-connector-aws-kinesis-firehose/src/test/java/org/apache/flink/connector/firehose/sink/testutils/KinesisFirehoseTestUtils.java
@@ -20,6 +20,7 @@ package org.apache.flink.connector.firehose.sink.testutils;
 import org.apache.flink.connector.aws.util.AWSAsyncSinkUtil;
 import org.apache.flink.connector.firehose.sink.KinesisFirehoseConfigConstants;
 
+import software.amazon.awssdk.http.async.SdkAsyncHttpClient;
 import software.amazon.awssdk.services.firehose.FirehoseAsyncClient;
 import software.amazon.awssdk.services.firehose.model.CreateDeliveryStreamRequest;
 import software.amazon.awssdk.services.firehose.model.CreateDeliveryStreamResponse;
@@ -31,19 +32,21 @@ import java.net.URISyntaxException;
 import java.util.concurrent.CompletableFuture;
 import java.util.concurrent.ExecutionException;
 
-import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.getConfig;
-import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.getHttpClient;
+import static org.apache.flink.connector.aws.testutils.AWSServicesTestUtils.createConfig;
 
 /**
  * A set of static methods that can be used to call common AWS services on the Localstack container.
  */
 public class KinesisFirehoseTestUtils {
 
-    public static FirehoseAsyncClient getFirehoseClient(String endpoint) throws URISyntaxException {
+    public static FirehoseAsyncClient getFirehoseClient(
+            String endpoint, SdkAsyncHttpClient httpClient) throws URISyntaxException {
         return AWSAsyncSinkUtil.createAwsAsyncClient(
-                getConfig(endpoint),
-                getHttpClient(endpoint),
-                FirehoseAsyncClient.builder().endpointOverride(new URI(endpoint)),
+                createConfig(endpoint),
+                httpClient,
+                FirehoseAsyncClient.builder()
+                        .httpClient(httpClient)
+                        .endpointOverride(new URI(endpoint)),
                 KinesisFirehoseConfigConstants.BASE_FIREHOSE_USER_AGENT_PREFIX_FORMAT,
                 KinesisFirehoseConfigConstants.FIREHOSE_CLIENT_USER_AGENT_PREFIX);
     }
diff --git a/flink-test-utils-parent/flink-test-utils-junit/src/main/java/org/apache/flink/util/DockerImageVersions.java b/flink-test-utils-parent/flink-test-utils-junit/src/main/java/org/apache/flink/util/DockerImageVersions.java
index 46bd001680f..531fdb3ac6f 100644
--- a/flink-test-utils-parent/flink-test-utils-junit/src/main/java/org/apache/flink/util/DockerImageVersions.java
+++ b/flink-test-utils-parent/flink-test-utils-junit/src/main/java/org/apache/flink/util/DockerImageVersions.java
@@ -40,7 +40,7 @@ public class DockerImageVersions {
 
     public static final String KINESALITE = "instructure/kinesalite:latest";
 
-    public static final String LOCALSTACK = "localstack/localstack:latest";
+    public static final String LOCALSTACK = "localstack/localstack:0.13.3";
 
     public static final String PULSAR = "apachepulsar/pulsar:2.8.0";
 
