diff --git a/flink-tests/src/test/java/org/apache/flink/test/checkpointing/IgnoreInFlightDataITCase.java b/flink-tests/src/test/java/org/apache/flink/test/checkpointing/IgnoreInFlightDataITCase.java
index 55a41a38913..c5cc5294339 100644
--- a/flink-tests/src/test/java/org/apache/flink/test/checkpointing/IgnoreInFlightDataITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/test/checkpointing/IgnoreInFlightDataITCase.java
@@ -206,7 +206,7 @@ public class IgnoreInFlightDataITCase extends TestLogger {
         private static final long serialVersionUID = 1L;
         private final SharedReference<AtomicInteger> lastCheckpointValue;
         private ListState<Integer> valueState;
-        private boolean isRunning = true;
+        private volatile boolean isRunning = true;
 
         public NumberSource(SharedReference<AtomicInteger> lastCheckpointValue) {
             this.lastCheckpointValue = lastCheckpointValue;
@@ -229,18 +229,19 @@ public class IgnoreInFlightDataITCase extends TestLogger {
                 }
             } else {
                 int next = 0;
+
+                synchronized (ctx.getCheckpointLock()) {
+                    // Emit batch of data in order to having the downstream data for each subtask of
+                    // the Map before the first checkpoint.
+                    do {
+                        next++;
+                        valueState.update(singletonList(next));
+                        ctx.collect(next);
+                    } while (next % 50 != 0 && isRunning);
+                }
+
                 while (isRunning) {
-                    synchronized (ctx.getCheckpointLock()) {
-                        // Emit data by batches to reduce the probability that before the first
-                        // checkpoint will be generated not enough data.
-                        do {
-                            next++;
-                            valueState.update(singletonList(next));
-                            ctx.collect(next);
-                        } while (next % 50 != 0 && isRunning);
-                    }
-
-                    // Avoid the huge backpressure.
+                    // Wait for the checkpoint.
                     LockSupport.parkNanos(100000);
                 }
             }
