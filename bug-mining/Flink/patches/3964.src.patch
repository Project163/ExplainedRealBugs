diff --git a/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/HiveCatalog.java b/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/HiveCatalog.java
index e114f1faf09..e1d92934389 100644
--- a/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/HiveCatalog.java
+++ b/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/catalog/hive/HiveCatalog.java
@@ -147,14 +147,21 @@ public class HiveCatalog extends AbstractCatalog {
 		this(catalogName,
 			defaultDatabase == null ? DEFAULT_DB : defaultDatabase,
 			createHiveConf(hiveConfDir),
-			hiveVersion);
+			hiveVersion,
+			false);
 	}
 
 	@VisibleForTesting
-	protected HiveCatalog(String catalogName, String defaultDatabase, @Nullable HiveConf hiveConf, String hiveVersion) {
+	protected HiveCatalog(String catalogName, String defaultDatabase, @Nullable HiveConf hiveConf, String hiveVersion,
+			boolean allowEmbedded) {
 		super(catalogName, defaultDatabase == null ? DEFAULT_DB : defaultDatabase);
 
 		this.hiveConf = hiveConf == null ? createHiveConf(null) : hiveConf;
+		if (!allowEmbedded) {
+			checkArgument(!StringUtils.isNullOrWhitespaceOnly(this.hiveConf.getVar(HiveConf.ConfVars.METASTOREURIS)),
+					"Embedded metastore is not allowed. Make sure you have set a valid value for " +
+							HiveConf.ConfVars.METASTOREURIS.toString());
+		}
 		checkArgument(!StringUtils.isNullOrWhitespaceOnly(hiveVersion), "hiveVersion cannot be null or empty");
 		this.hiveVersion = hiveVersion;
 		hiveShim = HiveShimLoader.loadHiveShim(hiveVersion);
diff --git a/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/connectors/hive/HiveTableSourceTest.java b/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/connectors/hive/HiveTableSourceTest.java
index 93f21f041f4..e18586e5442 100644
--- a/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/connectors/hive/HiveTableSourceTest.java
+++ b/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/connectors/hive/HiveTableSourceTest.java
@@ -534,7 +534,7 @@ public class HiveTableSourceTest {
 
 		TestPartitionFilterCatalog(String catalogName, String defaultDatabase,
 				@Nullable HiveConf hiveConf, String hiveVersion) {
-			super(catalogName, defaultDatabase, hiveConf, hiveVersion);
+			super(catalogName, defaultDatabase, hiveConf, hiveVersion, true);
 		}
 
 		@Override
diff --git a/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/HiveTestUtils.java b/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/HiveTestUtils.java
index b3753351cd4..f823f0c2db8 100644
--- a/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/HiveTestUtils.java
+++ b/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/HiveTestUtils.java
@@ -66,11 +66,11 @@ public class HiveTestUtils {
 
 	public static HiveCatalog createHiveCatalog(String name, String hiveVersion) {
 		return new HiveCatalog(name, null, createHiveConf(),
-				StringUtils.isNullOrWhitespaceOnly(hiveVersion) ? HiveShimLoader.getHiveVersion() : hiveVersion);
+				StringUtils.isNullOrWhitespaceOnly(hiveVersion) ? HiveShimLoader.getHiveVersion() : hiveVersion, true);
 	}
 
 	public static HiveCatalog createHiveCatalog(HiveConf hiveConf) {
-		return new HiveCatalog(CatalogTest.TEST_CATALOG_NAME, null, hiveConf, HiveShimLoader.getHiveVersion());
+		return new HiveCatalog(CatalogTest.TEST_CATALOG_NAME, null, hiveConf, HiveShimLoader.getHiveVersion(), true);
 	}
 
 	public static HiveConf createHiveConf() {
diff --git a/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/factories/HiveCatalogFactoryTest.java b/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/factories/HiveCatalogFactoryTest.java
index 0db52b499b2..6a838bd772d 100644
--- a/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/factories/HiveCatalogFactoryTest.java
+++ b/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/table/catalog/hive/factories/HiveCatalogFactoryTest.java
@@ -23,7 +23,6 @@ import org.apache.flink.table.catalog.Catalog;
 import org.apache.flink.table.catalog.hive.HiveCatalog;
 import org.apache.flink.table.catalog.hive.HiveTestUtils;
 import org.apache.flink.table.catalog.hive.descriptors.HiveCatalogDescriptor;
-import org.apache.flink.table.descriptors.CatalogDescriptor;
 import org.apache.flink.table.factories.CatalogFactory;
 import org.apache.flink.table.factories.TableFactoryService;
 import org.apache.flink.util.TestLogger;
@@ -31,12 +30,14 @@ import org.apache.flink.util.TestLogger;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.junit.Rule;
 import org.junit.Test;
+import org.junit.rules.ExpectedException;
 import org.junit.rules.TemporaryFolder;
 
 import java.io.File;
 import java.io.FileOutputStream;
 import java.io.IOException;
 import java.io.PrintStream;
+import java.net.URL;
 import java.util.HashMap;
 import java.util.Map;
 
@@ -46,16 +47,23 @@ import static org.junit.Assert.assertEquals;
  * Test for {@link HiveCatalog} created by {@link HiveCatalogFactory}.
  */
 public class HiveCatalogFactoryTest extends TestLogger {
+
+	private static final URL CONF_DIR = Thread.currentThread().getContextClassLoader().getResource("test-catalog-factory-conf");
+
 	@Rule
 	public final TemporaryFolder tempFolder = new TemporaryFolder();
 
+	@Rule
+	public ExpectedException expectedException = ExpectedException.none();
+
 	@Test
 	public void test() {
 		final String catalogName = "mycatalog";
 
 		final HiveCatalog expectedCatalog = HiveTestUtils.createHiveCatalog(catalogName, null);
 
-		final CatalogDescriptor catalogDescriptor = new HiveCatalogDescriptor();
+		final HiveCatalogDescriptor catalogDescriptor = new HiveCatalogDescriptor();
+		catalogDescriptor.hiveSitePath(CONF_DIR.getPath());
 
 		final Map<String, String> properties = catalogDescriptor.toProperties();
 
@@ -92,7 +100,8 @@ public class HiveCatalogFactoryTest extends TestLogger {
 		CommonTestUtils.setEnv(newEnv);
 
 		// create HiveCatalog use the Hadoop Configuration
-		final CatalogDescriptor catalogDescriptor = new HiveCatalogDescriptor();
+		final HiveCatalogDescriptor catalogDescriptor = new HiveCatalogDescriptor();
+		catalogDescriptor.hiveSitePath(CONF_DIR.getPath());
 		final Map<String, String> properties = catalogDescriptor.toProperties();
 		final HiveConf hiveConf;
 		try {
@@ -109,6 +118,14 @@ public class HiveCatalogFactoryTest extends TestLogger {
 		}
 	}
 
+	@Test
+	public void testDisallowEmbedded() {
+		expectedException.expect(IllegalArgumentException.class);
+		final Map<String, String> properties = new HiveCatalogDescriptor().toProperties();
+
+		TableFactoryService.find(CatalogFactory.class, properties).createCatalog("my_catalog", properties);
+	}
+
 	private static void checkEquals(HiveCatalog c1, HiveCatalog c2) {
 		// Only assert a few selected properties for now
 		assertEquals(c1.getName(), c2.getName());
diff --git a/flink-connectors/flink-connector-hive/src/test/resources/test-catalog-factory-conf/hive-site.xml b/flink-connectors/flink-connector-hive/src/test/resources/test-catalog-factory-conf/hive-site.xml
new file mode 100644
index 00000000000..197217697ad
--- /dev/null
+++ b/flink-connectors/flink-connector-hive/src/test/resources/test-catalog-factory-conf/hive-site.xml
@@ -0,0 +1,48 @@
+<?xml version="1.0"?>
+<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one or more
+   contributor license agreements.  See the NOTICE file distributed with
+   this work for additional information regarding copyright ownership.
+   The ASF licenses this file to You under the Apache License, Version 2.0
+   (the "License"); you may not use this file except in compliance with
+   the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.
+-->
+
+<configuration>
+
+	<property>
+		<name>hive.metastore.schema.verification</name>
+		<value>false</value>
+	</property>
+
+	<property>
+		<name>hive.metastore.client.capability.check</name>
+		<value>false</value>
+	</property>
+
+	<property>
+		<name>datanucleus.schema.autoCreateTables</name>
+		<value>true</value>
+	</property>
+
+	<property>
+		<name>datanucleus.schema.autoCreateAll</name>
+		<value>true</value>
+	</property>
+
+    <!-- production code doesn't allow embedded mode, set a dummy value here which is OK as long as the created HiveCatalog is not used -->
+	<property>
+		<name>hive.metastore.uris</name>
+		<value>dummy-hms</value>
+	</property>
+
+</configuration>
diff --git a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/gateway/local/DependencyTest.java b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/gateway/local/DependencyTest.java
index 1797003f49b..33633f34b2d 100644
--- a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/gateway/local/DependencyTest.java
+++ b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/gateway/local/DependencyTest.java
@@ -65,7 +65,6 @@ import static org.apache.flink.table.descriptors.CatalogDescriptorValidator.CATA
 import static org.apache.flink.table.descriptors.CatalogDescriptorValidator.CATALOG_TYPE;
 import static org.apache.flink.table.descriptors.ModuleDescriptorValidator.MODULE_TYPE;
 import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertTrue;
 
 /**
  * Dependency tests for {@link LocalExecutor}. Mainly for testing classloading of dependencies.
@@ -234,10 +233,6 @@ public class DependencyTest {
 
 		@Override
 		public Catalog createCatalog(String name, Map<String, String> properties) {
-			// Test HiveCatalogFactory.createCatalog
-			// But not use it for testing purpose
-			assertTrue(super.createCatalog(name, properties) != null);
-
 			// Developers may already have their own production/testing hive-site.xml set in their environment,
 			// and Flink tests should avoid using those hive-site.xml.
 			// Thus, explicitly create a testing HiveConf for unit tests here
