diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/EdgeManagerBuildUtil.java b/flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/EdgeManagerBuildUtil.java
index 5a5bd9a2c6a..651867e03de 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/EdgeManagerBuildUtil.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/EdgeManagerBuildUtil.java
@@ -131,9 +131,8 @@ public class EdgeManagerBuildUtil {
                 ConsumedPartitionGroup consumerPartitionGroup =
                         ConsumedPartitionGroup.fromSinglePartition(partition.getPartitionId());
 
-                float factor = ((float) targetCount) / sourceCount;
-                int start = (int) (Math.ceil(partitionNum * factor));
-                int end = (int) (Math.ceil((partitionNum + 1) * factor));
+                int start = (partitionNum * targetCount + sourceCount - 1) / sourceCount;
+                int end = ((partitionNum + 1) * targetCount + sourceCount - 1) / sourceCount;
 
                 List<ExecutionVertexID> consumers = new ArrayList<>(end - start);
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/PointwisePatternTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/PointwisePatternTest.java
index cba3bdbce3a..f9712b88923 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/PointwisePatternTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/PointwisePatternTest.java
@@ -145,6 +145,7 @@ public class PointwisePatternTest {
         testLowToHigh(19, 21);
         testLowToHigh(15, 20);
         testLowToHigh(11, 31);
+        testLowToHigh(11, 29);
     }
 
     @Test
