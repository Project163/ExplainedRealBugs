diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/common/TieredStorageConfiguration.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/common/TieredStorageConfiguration.java
index 4590597d8c2..d031d7278c4 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/common/TieredStorageConfiguration.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/common/TieredStorageConfiguration.java
@@ -45,13 +45,15 @@ public class TieredStorageConfiguration {
 
     private static final int DEFAULT_REMOTE_TIER_EXCLUSIVE_BUFFERS = 1;
 
+    private static final int DEFAULT_MEMORY_TIER_SUBPARTITION_MAX_QUEUED_BUFFERS = 3;
+
     private static final int DEFAULT_NUM_BUFFERS_USE_SORT_ACCUMULATOR_THRESHOLD = 512;
 
-    private static final int DEFAULT_MEMORY_TIER_NUM_BYTES_PER_SEGMENT = 320 * 1024;
+    private static final int DEFAULT_MEMORY_TIER_NUM_BYTES_PER_SEGMENT = 2 * 32 * 1024;
 
-    private static final int DEFAULT_DISK_TIER_NUM_BYTES_PER_SEGMENT = 8 * 1024 * 1024;
+    private static final int DEFAULT_DISK_TIER_NUM_BYTES_PER_SEGMENT = 16 * 32 * 1024;
 
-    private static final int DEFAULT_REMOTE_TIER_NUM_BYTES_PER_SEGMENT = 8 * 1024 * 1024;
+    private static final int DEFAULT_REMOTE_TIER_NUM_BYTES_PER_SEGMENT = 16 * 32 * 1024;
 
     private static final float DEFAULT_NUM_BUFFERS_TRIGGER_FLUSH_RATIO = 0.6f;
 
@@ -304,6 +306,9 @@ public class TieredStorageConfiguration {
 
         private int remoteTierExclusiveBuffers = DEFAULT_REMOTE_TIER_EXCLUSIVE_BUFFERS;
 
+        private int memoryTierSubpartitionMaxQueuedBuffers =
+                DEFAULT_MEMORY_TIER_SUBPARTITION_MAX_QUEUED_BUFFERS;
+
         private int numBuffersUseSortAccumulatorThreshold =
                 DEFAULT_NUM_BUFFERS_USE_SORT_ACCUMULATOR_THRESHOLD;
 
@@ -375,6 +380,12 @@ public class TieredStorageConfiguration {
             return this;
         }
 
+        public Builder setMemoryTierSubpartitionMaxQueuedBuffers(
+                int memoryTierSubpartitionMaxQueuedBuffers) {
+            this.memoryTierSubpartitionMaxQueuedBuffers = memoryTierSubpartitionMaxQueuedBuffers;
+            return this;
+        }
+
         public Builder setNumBuffersTriggerFlushRatio(float numBuffersTriggerFlushRatio) {
             this.numBuffersTriggerFlushRatio = numBuffersTriggerFlushRatio;
             return this;
@@ -429,7 +440,10 @@ public class TieredStorageConfiguration {
             tierFactories = new ArrayList<>();
             tierExclusiveBuffers = new ArrayList<>();
             tierFactories.add(
-                    new MemoryTierFactory(memoryTierNumBytesPerSegment, tieredStorageBufferSize));
+                    new MemoryTierFactory(
+                            memoryTierNumBytesPerSegment,
+                            tieredStorageBufferSize,
+                            memoryTierSubpartitionMaxQueuedBuffers));
             tierExclusiveBuffers.add(memoryTierExclusiveBuffers);
             tierFactories.add(
                     new DiskTierFactory(
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/shuffle/TieredResultPartitionFactory.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/shuffle/TieredResultPartitionFactory.java
index ba557e5b3f0..eb54970441b 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/shuffle/TieredResultPartitionFactory.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/shuffle/TieredResultPartitionFactory.java
@@ -178,9 +178,11 @@ public class TieredResultPartitionFactory {
         tieredStorageMemorySpecs.add(
                 new TieredStorageMemorySpec(
                         bufferAccumulator,
-                        Math.min(
-                                numberOfSubpartitions + 1,
-                                tieredStorageConfiguration.getAccumulatorExclusiveBuffers())));
+                        2
+                                * Math.min(
+                                        numberOfSubpartitions + 1,
+                                        tieredStorageConfiguration
+                                                .getAccumulatorExclusiveBuffers())));
         List<Integer> tierExclusiveBuffers =
                 tieredStorageConfiguration.getEachTierExclusiveBufferNum();
 
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/SortBufferAccumulator.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/SortBufferAccumulator.java
index e8223d41c16..fc0d1a56f5e 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/SortBufferAccumulator.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/SortBufferAccumulator.java
@@ -221,7 +221,7 @@ public class SortBufferAccumulator implements BufferAccumulator {
         checkState(dataType != Buffer.DataType.EVENT_BUFFER);
         while (record.hasRemaining()) {
             int toCopy = Math.min(record.remaining(), bufferSizeBytes);
-            MemorySegment writeBuffer = checkNotNull(getFreeSegment());
+            MemorySegment writeBuffer = requestBuffer().getMemorySegment();
             writeBuffer.put(0, record, toCopy);
 
             flushBuffer(
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/TieredStorageSortBuffer.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/TieredStorageSortBuffer.java
index 5695bf4504e..ea29f8b8d18 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/TieredStorageSortBuffer.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/TieredStorageSortBuffer.java
@@ -22,6 +22,7 @@ import org.apache.flink.core.memory.MemorySegment;
 import org.apache.flink.core.memory.MemorySegmentFactory;
 import org.apache.flink.runtime.io.network.buffer.Buffer;
 import org.apache.flink.runtime.io.network.buffer.BufferRecycler;
+import org.apache.flink.runtime.io.network.buffer.FreeingBufferRecycler;
 import org.apache.flink.runtime.io.network.buffer.NetworkBuffer;
 import org.apache.flink.runtime.io.network.partition.BufferWithChannel;
 import org.apache.flink.runtime.io.network.partition.SortBasedDataBuffer;
@@ -59,9 +60,7 @@ public class TieredStorageSortBuffer extends SortBuffer {
         checkState(!isReleased, "Sort buffer is already released.");
 
         if (!hasRemaining()) {
-            if (transitBuffer != null) {
-                bufferRecycler.recycle(transitBuffer);
-            }
+            freeSegments.add(transitBuffer);
             return null;
         }
 
@@ -95,8 +94,8 @@ public class TieredStorageSortBuffer extends SortBuffer {
             toReadOffsetInBuffer += INDEX_ENTRY_SIZE;
 
             // Allocate a temp buffer for the event, recycle the original buffer
-            if (bufferDataType.isEvent() && transitBuffer.size() < recordLength) {
-                bufferRecycler.recycle(transitBuffer);
+            if (bufferDataType.isEvent()) {
+                freeSegments.add(transitBuffer);
                 transitBuffer = MemorySegmentFactory.allocateUnpooledSegment(recordLength);
             }
 
@@ -122,7 +121,13 @@ public class TieredStorageSortBuffer extends SortBuffer {
 
         numTotalBytesRead += numBytesRead;
         return new BufferWithChannel(
-                new NetworkBuffer(transitBuffer, bufferRecycler, bufferDataType, numBytesRead),
+                new NetworkBuffer(
+                        transitBuffer,
+                        bufferDataType == Buffer.DataType.DATA_BUFFER
+                                ? bufferRecycler
+                                : FreeingBufferRecycler.INSTANCE,
+                        bufferDataType,
+                        numBytesRead),
                 currentReadingSubpartitionId);
     }
 }
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierFactory.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierFactory.java
index a4b10350d9d..8bb3cf3834b 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierFactory.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierFactory.java
@@ -41,9 +41,13 @@ public class MemoryTierFactory implements TierFactory {
 
     private final int bufferSizeBytes;
 
-    public MemoryTierFactory(int segmentSizeBytes, int bufferSizeBytes) {
+    private final int subpartitionMaxQueuedBuffers;
+
+    public MemoryTierFactory(
+            int segmentSizeBytes, int bufferSizeBytes, int subpartitionMaxQueuedBuffers) {
         this.segmentSizeBytes = segmentSizeBytes;
         this.bufferSizeBytes = bufferSizeBytes;
+        this.subpartitionMaxQueuedBuffers = subpartitionMaxQueuedBuffers;
     }
 
     @Override
@@ -71,6 +75,7 @@ public class MemoryTierFactory implements TierFactory {
                 numSubpartitions,
                 bufferSizeBytes,
                 segmentSizeBytes,
+                subpartitionMaxQueuedBuffers,
                 isBroadcastOnly,
                 memoryManager,
                 nettyService,
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierProducerAgent.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierProducerAgent.java
index 35981500929..97641af1970 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierProducerAgent.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierProducerAgent.java
@@ -47,6 +47,8 @@ public class MemoryTierProducerAgent implements TierProducerAgent, NettyServiceP
 
     private final int numBuffersPerSegment;
 
+    private final int subpartitionMaxQueuedBuffers;
+
     private final TieredStorageMemoryManager memoryManager;
 
     /**
@@ -68,6 +70,7 @@ public class MemoryTierProducerAgent implements TierProducerAgent, NettyServiceP
             int numSubpartitions,
             int bufferSizeBytes,
             int segmentSizeBytes,
+            int subpartitionMaxQueuedBuffers,
             boolean isBroadcastOnly,
             TieredStorageMemoryManager memoryManager,
             TieredStorageNettyService nettyService,
@@ -80,6 +83,7 @@ public class MemoryTierProducerAgent implements TierProducerAgent, NettyServiceP
                 "Broadcast only partition is not allowed to use the memory tier.");
 
         this.numBuffersPerSegment = segmentSizeBytes / bufferSizeBytes;
+        this.subpartitionMaxQueuedBuffers = subpartitionMaxQueuedBuffers;
         this.memoryManager = memoryManager;
         this.currentSubpartitionWriteBuffers = new int[numSubpartitions];
         this.nettyConnectionEstablished = new boolean[numSubpartitions];
@@ -98,6 +102,11 @@ public class MemoryTierProducerAgent implements TierProducerAgent, NettyServiceP
     public boolean tryStartNewSegment(TieredStorageSubpartitionId subpartitionId, int segmentId) {
         boolean canStartNewSegment =
                 nettyConnectionEstablished[subpartitionId.getSubpartitionId()]
+                        // Ensure that a subpartition's memory tier does not excessively use
+                        // buffers, which may result in insufficient buffers for other subpartitions
+                        && subpartitionProducerAgents[subpartitionId.getSubpartitionId()]
+                                        .numQueuedBuffers()
+                                < subpartitionMaxQueuedBuffers
                         && (memoryManager.getMaxNonReclaimableBuffers(this)
                                         - memoryManager.numOwnerRequestedBuffer(this))
                                 > numBuffersPerSegment;
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierSubpartitionProducerAgent.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierSubpartitionProducerAgent.java
index 5642b0c1d6e..6c40668ff88 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierSubpartitionProducerAgent.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierSubpartitionProducerAgent.java
@@ -63,6 +63,12 @@ class MemoryTierSubpartitionProducerAgent {
         addFinishedBuffer(segmentNettyPayload);
     }
 
+    int numQueuedBuffers() {
+        return nettyConnectionWriter == null
+                ? 0
+                : checkNotNull(nettyConnectionWriter).numQueuedBuffers();
+    }
+
     void release() {
         if (nettyConnectionWriter != null) {
             checkNotNull(nettyConnectionWriter).close(null);
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/TieredStorageSortBufferTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/TieredStorageSortBufferTest.java
index 607f1909689..346875cd165 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/TieredStorageSortBufferTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/storage/TieredStorageSortBufferTest.java
@@ -139,7 +139,7 @@ class TieredStorageSortBufferTest {
                         numSubpartitions,
                         BUFFER_SIZE_BYTES,
                         numBuffersForSort);
-        MemorySegment memorySegment = bufferPool.requestMemorySegmentBlocking();
+        MemorySegment memorySegment = segments.poll();
         sortBuffer.finish();
         assertThat(sortBuffer.getNextBuffer(memorySegment)).isNull();
         assertThat(bufferPool.bestEffortGetNumOfUsedBuffers()).isEqualTo(numBuffersForSort);
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierProducerAgentTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierProducerAgentTest.java
index 09e4e8c5735..e02cda0c6ab 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierProducerAgentTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/tiered/tier/memory/MemoryTierProducerAgentTest.java
@@ -45,6 +45,8 @@ class MemoryTierProducerAgentTest {
 
     private static final int SEGMENT_SIZE_BYTES = BUFFER_SIZE * 2;
 
+    private static final int MEMORY_TIER_SUBPARTITION_MAX_QUEUED_BUFFERS = 3;
+
     private static final TieredStoragePartitionId PARTITION_ID =
             TieredStorageIdMappingUtils.convertId(new ResultPartitionID());
     private static final TieredStorageSubpartitionId SUBPARTITION_ID =
@@ -61,6 +63,42 @@ class MemoryTierProducerAgentTest {
         }
     }
 
+    @Test
+    void testStartSegmentSuccessWhenSubpartitionOccupyFewBuffers() {
+        int numQueuedBuffers = MEMORY_TIER_SUBPARTITION_MAX_QUEUED_BUFFERS - 1;
+        try (MemoryTierProducerAgent memoryTierProducerAgent =
+                createMemoryTierProducerAgent(
+                        false,
+                        SEGMENT_SIZE_BYTES,
+                        MEMORY_TIER_SUBPARTITION_MAX_QUEUED_BUFFERS,
+                        new TieredStorageResourceRegistry())) {
+            TestingNettyConnectionWriter connectionWriter =
+                    new TestingNettyConnectionWriter.Builder()
+                            .setNumQueuedBuffersSupplier(() -> numQueuedBuffers)
+                            .build();
+            memoryTierProducerAgent.connectionEstablished(SUBPARTITION_ID, connectionWriter);
+            assertThat(memoryTierProducerAgent.tryStartNewSegment(SUBPARTITION_ID, 0)).isTrue();
+        }
+    }
+
+    @Test
+    void testStartSegmentFailedWhenSubpartitionOccupyTooManyBuffers() {
+        int numQueuedBuffers = MEMORY_TIER_SUBPARTITION_MAX_QUEUED_BUFFERS;
+        try (MemoryTierProducerAgent memoryTierProducerAgent =
+                createMemoryTierProducerAgent(
+                        false,
+                        SEGMENT_SIZE_BYTES,
+                        numQueuedBuffers,
+                        new TieredStorageResourceRegistry())) {
+            TestingNettyConnectionWriter connectionWriter =
+                    new TestingNettyConnectionWriter.Builder()
+                            .setNumQueuedBuffersSupplier(() -> numQueuedBuffers)
+                            .build();
+            memoryTierProducerAgent.connectionEstablished(SUBPARTITION_ID, connectionWriter);
+            assertThat(memoryTierProducerAgent.tryStartNewSegment(SUBPARTITION_ID, 0)).isFalse();
+        }
+    }
+
     @Test
     void testStartSegmentFailedWithInsufficientMemory() {
         TestingTieredStorageMemoryManager memoryManager =
@@ -78,6 +116,7 @@ class MemoryTierProducerAgentTest {
                         NUM_SUBPARTITIONS,
                         BUFFER_SIZE,
                         SEGMENT_SIZE_BYTES,
+                        MEMORY_TIER_SUBPARTITION_MAX_QUEUED_BUFFERS,
                         false,
                         memoryManager,
                         nettyService,
@@ -147,6 +186,18 @@ class MemoryTierProducerAgentTest {
             boolean isBroadcastOnly,
             int segmentSizeBytes,
             TieredStorageResourceRegistry resourceRegistry) {
+        return createMemoryTierProducerAgent(
+                isBroadcastOnly,
+                segmentSizeBytes,
+                MEMORY_TIER_SUBPARTITION_MAX_QUEUED_BUFFERS,
+                resourceRegistry);
+    }
+
+    private static MemoryTierProducerAgent createMemoryTierProducerAgent(
+            boolean isBroadcastOnly,
+            int segmentSizeBytes,
+            int memoryTierSubpartitionMaxQueuedBuffers,
+            TieredStorageResourceRegistry resourceRegistry) {
         TestingTieredStorageMemoryManager memoryManager =
                 new TestingTieredStorageMemoryManager.Builder()
                         .setGetMaxNonReclaimableBuffersFunction(ignore -> Integer.MAX_VALUE)
@@ -162,6 +213,7 @@ class MemoryTierProducerAgentTest {
                 NUM_SUBPARTITIONS,
                 BUFFER_SIZE,
                 segmentSizeBytes,
+                memoryTierSubpartitionMaxQueuedBuffers,
                 isBroadcastOnly,
                 memoryManager,
                 nettyService,
