diff --git a/flink-clients/src/test/java/org/apache/flink/client/program/StreamContextEnvironmentTest.java b/flink-clients/src/test/java/org/apache/flink/client/program/StreamContextEnvironmentTest.java
index 0d1b29c6358..9a1fb3bbd50 100644
--- a/flink-clients/src/test/java/org/apache/flink/client/program/StreamContextEnvironmentTest.java
+++ b/flink-clients/src/test/java/org/apache/flink/client/program/StreamContextEnvironmentTest.java
@@ -20,6 +20,8 @@ package org.apache.flink.client.program;
 
 import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.RuntimeExecutionMode;
+import org.apache.flink.api.connector.sink2.Sink;
+import org.apache.flink.api.connector.sink2.SinkWriter;
 import org.apache.flink.configuration.CheckpointingOptions;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.configuration.DeploymentOptions;
@@ -161,6 +163,22 @@ class StreamContextEnvironmentTest {
                 .isInstanceOf(ExecutorReachedException.class);
     }
 
+    @ParameterizedTest
+    @MethodSource("provideExecutors")
+    void testForSinkTransformation(
+            ThrowingConsumer<StreamExecutionEnvironment, Exception> executor) {
+        final Configuration clusterConfig = new Configuration();
+        clusterConfig.set(DeploymentOptions.PROGRAM_CONFIG_ENABLED, false);
+        clusterConfig.set(DeploymentOptions.TARGET, "local");
+
+        final StreamContextEnvironment environment =
+                constructStreamContextEnvironment(clusterConfig, Collections.emptyList());
+
+        environment.fromCollection(Collections.singleton(1)).sinkTo(new DiscardingSinkV2());
+        assertThatThrownBy(() -> executor.accept(environment))
+                .isInstanceOf(ExecutorReachedException.class);
+    }
+
     @ParameterizedTest
     @MethodSource("provideExecutors")
     void testAllowProgramConfigurationWildcards(
@@ -230,4 +248,20 @@ class StreamContextEnvironmentTest {
     }
 
     private static class ExecutorReachedException extends RuntimeException {}
+
+    private static class DiscardingSinkV2<T> implements Sink<T> {
+        @Override
+        public SinkWriter<T> createWriter(InitContext context) {
+            return new SinkWriter<T>() {
+                @Override
+                public void write(T element, Context context) {}
+
+                @Override
+                public void flush(boolean endOfInput) {}
+
+                @Override
+                public void close() {}
+            };
+        }
+    }
 }
diff --git a/flink-core/src/main/java/org/apache/flink/api/common/ExecutionConfig.java b/flink-core/src/main/java/org/apache/flink/api/common/ExecutionConfig.java
index 1e75154edc3..06473aa9308 100644
--- a/flink-core/src/main/java/org/apache/flink/api/common/ExecutionConfig.java
+++ b/flink-core/src/main/java/org/apache/flink/api/common/ExecutionConfig.java
@@ -344,6 +344,11 @@ public class ExecutionConfig implements Serializable, Archiveable<ArchivedExecut
         return this;
     }
 
+    @Internal
+    public void resetParallelism() {
+        configuration.removeConfig(CoreOptions.DEFAULT_PARALLELISM);
+    }
+
     /**
      * Gets the maximum degree of parallelism defined for the program.
      *
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/translators/SinkTransformationTranslator.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/translators/SinkTransformationTranslator.java
index 6c630247519..e4ba29b4512 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/translators/SinkTransformationTranslator.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/translators/SinkTransformationTranslator.java
@@ -25,6 +25,7 @@ import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.connector.sink2.Sink;
 import org.apache.flink.api.connector.sink2.TwoPhaseCommittingSink;
 import org.apache.flink.api.dag.Transformation;
+import org.apache.flink.configuration.CoreOptions;
 import org.apache.flink.streaming.api.connector.sink2.CommittableMessage;
 import org.apache.flink.streaming.api.connector.sink2.CommittableMessageTypeInfo;
 import org.apache.flink.streaming.api.connector.sink2.StandardSinkTopologies;
@@ -104,7 +105,7 @@ public class SinkTransformationTranslator<Input, Output>
         private final Context context;
         private final DataStream<T> inputStream;
         private final StreamExecutionEnvironment executionEnvironment;
-        private final int environmentParallelism;
+        private final Optional<Integer> environmentParallelism;
         private final boolean isBatchMode;
         private final boolean isCheckpointingEnabled;
 
@@ -116,7 +117,11 @@ public class SinkTransformationTranslator<Input, Output>
                 boolean isBatchMode) {
             this.inputStream = inputStream;
             this.executionEnvironment = inputStream.getExecutionEnvironment();
-            this.environmentParallelism = executionEnvironment.getParallelism();
+            this.environmentParallelism =
+                    executionEnvironment
+                            .getConfig()
+                            .toConfiguration()
+                            .getOptional(CoreOptions.DEFAULT_PARALLELISM);
             this.isCheckpointingEnabled =
                     executionEnvironment.getCheckpointConfig().isCheckpointingEnabled();
             this.transformation = transformation;
@@ -338,7 +343,11 @@ public class SinkTransformationTranslator<Input, Output>
             }
 
             // Restore the previous parallelism of the environment before adjusting transformations
-            executionEnvironment.setParallelism(environmentParallelism);
+            if (environmentParallelism.isPresent()) {
+                executionEnvironment.getConfig().setParallelism(environmentParallelism.get());
+            } else {
+                executionEnvironment.getConfig().resetParallelism();
+            }
 
             return result;
         }
