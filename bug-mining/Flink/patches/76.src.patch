diff --git a/flink-core/src/main/java/org/apache/flink/util/ClassUtils.java b/flink-core/src/main/java/org/apache/flink/util/ClassUtils.java
index c1483f82cbc..073082de35b 100644
--- a/flink-core/src/main/java/org/apache/flink/util/ClassUtils.java
+++ b/flink-core/src/main/java/org/apache/flink/util/ClassUtils.java
@@ -19,7 +19,9 @@
 package org.apache.flink.util;
 
 import java.util.HashMap;
+import java.util.HashSet;
 import java.util.Map;
+import java.util.Set;
 
 import org.apache.flink.core.fs.FileSystem;
 import org.apache.flink.core.io.IOReadableWritable;
@@ -109,10 +111,20 @@ public final class ClassUtils {
 		}
 	}
 	
+	public static boolean isPrimitiveOrBoxedOrString(Class<?> clazz) {
+		return clazz != null && (clazz.isPrimitive() || ClassUtils.isBoxedTypeOrString(clazz));
+	}
+	
+	public static boolean isBoxedTypeOrString(Class<?> clazz) {
+		return BOXED_TYPES.contains(clazz);
+	}
+	
 	// --------------------------------------------------------------------------------------------
 	
 	private static final Map<String, Class<?>> PRIMITIVE_TYPES = new HashMap<String, Class<?>>(9);
 	
+	private static final Set<Class<?>> BOXED_TYPES = new HashSet<Class<?>>();
+	
 	static {
 		PRIMITIVE_TYPES.put("byte", byte.class);
 		PRIMITIVE_TYPES.put("short", short.class);
@@ -123,5 +135,16 @@ public final class ClassUtils {
 		PRIMITIVE_TYPES.put("boolean", boolean.class);
 		PRIMITIVE_TYPES.put("char", char.class);
 		PRIMITIVE_TYPES.put("void", void.class);
+		
+		BOXED_TYPES.add(Byte.class);
+		BOXED_TYPES.add(Short.class);
+		BOXED_TYPES.add(Integer.class);
+		BOXED_TYPES.add(Long.class);
+		BOXED_TYPES.add(Float.class);
+		BOXED_TYPES.add(Double.class);
+		BOXED_TYPES.add(Boolean.class);
+		BOXED_TYPES.add(Character.class);
+		BOXED_TYPES.add(Void.class);
+		BOXED_TYPES.add(String.class);
 	}
 }
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/ipc/RPC.java b/flink-runtime/src/main/java/org/apache/flink/runtime/ipc/RPC.java
index c72f266aa8c..92cb45a203b 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/ipc/RPC.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/ipc/RPC.java
@@ -152,7 +152,7 @@ public class RPC {
 		public void doTypeConversion() throws IOException {
 			try {
 				for (int i = 0; i < parameterClasses.length; i++) {
-					if (!IOReadableWritable.class.isAssignableFrom(parameterClasses[i])) {
+					if (parameters[i] != null && ClassUtils.isPrimitiveOrBoxedOrString(parameterClasses[i])) {
 						try {
 							parameters[i] = JavaToValueConverter.convertBoxedJavaType(parameters[i]);
 						}
@@ -175,7 +175,7 @@ public class RPC {
 		
 		public void undoTypeConversion() {
 			for (int i = 0; i < parameterClasses.length; i++) {
-				if (!IOReadableWritable.class.isAssignableFrom(parameterClasses[i])) {
+				if (parameters[i] != null &&  ClassUtils.isPrimitiveOrBoxedOrString(parameterClasses[i])) {
 					parameters[i] = JavaToValueConverter.convertValueType((Value) parameters[i]);
 				}
 			}
@@ -252,14 +252,17 @@ public class RPC {
 			Invocation invocation = new Invocation(method, args);
 			invocation.doTypeConversion();
 			
-			Object retValue = this.client.call(invocation, this.address, method.getDeclaringClass());
+			IOReadableWritable retValue = this.client.call(invocation, this.address, method.getDeclaringClass());
 			
-			if (IOReadableWritable.class.isAssignableFrom(method.getReturnType())) {
-				return retValue;
+			if (retValue == null) {
+				return null;
 			}
-			else {
+			else if (ClassUtils.isPrimitiveOrBoxedOrString(method.getReturnType())) {
 				return JavaToValueConverter.convertValueType((Value) retValue);
 			}
+			else {
+				return retValue;
+			}
 		}
 
 		/* close the IPC client that's responsible for this invoker's RPCs */
@@ -404,8 +407,7 @@ public class RPC {
 			this.instance = instance;
 		}
 
-		public IOReadableWritable call(Class<?> protocol, IOReadableWritable param, long receivedTime)
-				throws IOException {
+		public IOReadableWritable call(Class<?> protocol, IOReadableWritable param, long receivedTime) throws IOException {
 			
 			try {
 				
@@ -417,20 +419,24 @@ public class RPC {
 
 				final Object value = method.invoke((Object) instance, (Object[]) call.getParameters());
 
-				if (IOReadableWritable.class.isAssignableFrom(method.getReturnType())) {
+				final Class<?> retType = method.getReturnType();
+				
+				if (value == null || retType == null || retType == void.class || retType == Void.class) {
+					return null;
+				}
+				
+				if (ClassUtils.isPrimitiveOrBoxedOrString(method.getReturnType())) {
+					return JavaToValueConverter.convertBoxedJavaType(value);
+				}
+				else if (value instanceof IOReadableWritable) {
 					return (IOReadableWritable) value;
 				}
 				else {
-					try {
-						return JavaToValueConverter.convertBoxedJavaType(value);
-					}
-					catch (IllegalArgumentException e) {
-						throw new IOException("The return type of method " + method.getName()
-								+ " is not a primitive type (or boxed primitive) and not of type IOReadableWriteable");
-					}
+					throw new IOException("The return type of method " + method.getName()
+							+ " is not a primitive type (or boxed primitive) and not of type IOReadableWriteable");
 				}
-
-			} catch (InvocationTargetException e) {
+			}
+			catch (InvocationTargetException e) {
 				
 				final Throwable target = e.getTargetException();
 				if (target instanceof IOException) {
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/jobmanager/TaskManagerFailsWithSlotSharingITCase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/jobmanager/TaskManagerFailsWithSlotSharingITCase.java
index 70766a54461..239ab9d4398 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/jobmanager/TaskManagerFailsWithSlotSharingITCase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/jobmanager/TaskManagerFailsWithSlotSharingITCase.java
@@ -22,11 +22,9 @@ import static org.apache.flink.runtime.jobgraph.JobManagerTestUtils.startJobMana
 import static org.apache.flink.runtime.jobgraph.JobManagerTestUtils.waitForTaskThreadsToBeTerminated;
 import static org.junit.Assert.*;
 
-import org.apache.flink.runtime.blob.BlobKey;
 import org.apache.flink.runtime.client.AbstractJobResult;
 import org.apache.flink.runtime.client.JobSubmissionResult;
 import org.apache.flink.runtime.execution.ExecutionState;
-import org.apache.flink.runtime.execution.librarycache.BlobLibraryCacheManager;
 import org.apache.flink.runtime.executiongraph.ExecutionGraph;
 import org.apache.flink.runtime.executiongraph.ExecutionVertex;
 import org.apache.flink.runtime.instance.LocalInstanceManager;
@@ -40,8 +38,6 @@ import org.apache.flink.runtime.jobmanager.tasks.Sender;
 import org.apache.flink.runtime.taskmanager.TaskManager;
 import org.junit.Test;
 
-import java.util.ArrayList;
-
 public class TaskManagerFailsWithSlotSharingITCase {
 
 	@Test
