diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/ZooKeeperCheckpointIDCounter.java b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/ZooKeeperCheckpointIDCounter.java
index 49bdd254898..c13a993e2e0 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/ZooKeeperCheckpointIDCounter.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/ZooKeeperCheckpointIDCounter.java
@@ -112,7 +112,7 @@ public class ZooKeeperCheckpointIDCounter implements CheckpointIDCounter {
 	@Override
 	public long getAndIncrement() throws Exception {
 		while (true) {
-			checkConnectionState();
+			connStateListener.checkConnectionState();
 
 			VersionedValue<Integer> current = sharedCount.getVersionedValue();
 			int newCount = current.getValue() + 1;
@@ -131,18 +131,14 @@ public class ZooKeeperCheckpointIDCounter implements CheckpointIDCounter {
 
 	@Override
 	public long get() {
-		checkConnectionState();
+		connStateListener.checkConnectionState();
 
 		return sharedCount.getVersionedValue().getValue();
 	}
 
 	@Override
 	public void setCount(long newId) throws Exception {
-		ConnectionState connState = connStateListener.getLastState();
-
-		if (connState != null) {
-			throw new IllegalStateException("Connection state: " + connState);
-		}
+		connStateListener.checkConnectionState();
 
 		if (newId > Integer.MAX_VALUE) {
 			throw new IllegalArgumentException("ZooKeeper checkpoint counter only supports " +
@@ -153,14 +149,6 @@ public class ZooKeeperCheckpointIDCounter implements CheckpointIDCounter {
 		sharedCount.setCount((int) newId);
 	}
 
-	private void checkConnectionState() {
-		ConnectionState connState = connStateListener.getLastState();
-
-		if (connState != null) {
-			throw new IllegalStateException("Connection state: " + connState);
-		}
-	}
-
 	/**
 	 * Connection state listener. In case of {@link ConnectionState#SUSPENDED} or {@link
 	 * ConnectionState#LOST} we are not guaranteed to read a current count from ZooKeeper.
@@ -171,13 +159,17 @@ public class ZooKeeperCheckpointIDCounter implements CheckpointIDCounter {
 
 		@Override
 		public void stateChanged(CuratorFramework client, ConnectionState newState) {
-			if (newState == ConnectionState.SUSPENDED || newState == ConnectionState.LOST) {
-				lastState = newState;
-			}
+			lastState = newState;
 		}
 
-		private ConnectionState getLastState() {
-			return lastState;
+		private void checkConnectionState() {
+			if (lastState == null) {
+				return;
+			}
+
+			if (lastState != ConnectionState.CONNECTED && lastState != ConnectionState.RECONNECTED) {
+				throw new IllegalStateException("Connection state: " + lastState);
+			}
 		}
 	}
 }
