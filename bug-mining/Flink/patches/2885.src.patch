diff --git a/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBase.java b/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBase.java
index e50140ddfc9..5399c98e040 100644
--- a/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBase.java
+++ b/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBase.java
@@ -304,10 +304,7 @@ public abstract class ElasticsearchSinkBase<T, C extends AutoCloseable> extends
 
 	@Override
 	public void invoke(T value) throws Exception {
-		// if bulk processor callbacks have previously reported an error, we rethrow the error and fail the sink
-		checkErrorAndRethrow();
-
-		failureRequestIndexer.processBufferedRequests(requestIndexer);
+		checkAsyncErrorsAndRequests();
 		elasticsearchSinkFunction.process(value, getRuntimeContext(), requestIndexer);
 	}
 
@@ -318,12 +315,12 @@ public abstract class ElasticsearchSinkBase<T, C extends AutoCloseable> extends
 
 	@Override
 	public void snapshotState(FunctionSnapshotContext context) throws Exception {
-		checkErrorAndRethrow();
+		checkAsyncErrorsAndRequests();
 
 		if (flushOnCheckpoint) {
 			while (numPendingRequests.get() != 0) {
 				bulkProcessor.flush();
-				checkErrorAndRethrow();
+				checkAsyncErrorsAndRequests();
 			}
 		}
 	}
@@ -385,6 +382,11 @@ public abstract class ElasticsearchSinkBase<T, C extends AutoCloseable> extends
 		}
 	}
 
+	private void checkAsyncErrorsAndRequests() {
+		checkErrorAndRethrow();
+		failureRequestIndexer.processBufferedRequests(requestIndexer);
+	}
+
 	private class BulkProcessorListener implements BulkProcessor.Listener {
 		@Override
 		public void beforeBulk(long executionId, BulkRequest request) { }
diff --git a/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBaseTest.java b/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBaseTest.java
index fdfdece9e53..322d64cbe0e 100644
--- a/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBaseTest.java
+++ b/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBaseTest.java
@@ -366,9 +366,9 @@ public class ElasticsearchSinkBaseTest {
 
 		// since the previous flush should have resulted in a request re-add from the failure handler,
 		// we should have flushed again, and eventually be blocked before snapshot triggers the 2nd flush
-//		while (snapshotThread.getState() != Thread.State.WAITING) {
-//			Thread.sleep(10);
-//		}
+		while (snapshotThread.getState() != Thread.State.WAITING) {
+			Thread.sleep(10);
+		}
 
 		// current number of pending request should be 1 due to the re-add
 		Assert.assertEquals(1, sink.getNumPendingRequests());
