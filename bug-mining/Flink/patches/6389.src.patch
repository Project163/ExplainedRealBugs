diff --git a/flink-python/pyflink/table/table_environment.py b/flink-python/pyflink/table/table_environment.py
index 75f0c81d42e..bf8a364d2b5 100644
--- a/flink-python/pyflink/table/table_environment.py
+++ b/flink-python/pyflink/table/table_environment.py
@@ -1156,27 +1156,32 @@ class TableEnvironment(object):
         """
         if isinstance(table_or_data_stream, Table):
             self._j_tenv.createTemporaryView(view_path, table_or_data_stream._j_table)
-        elif len(fields_or_schema) == 0:
-            self._j_tenv.createTemporaryView(view_path, table_or_data_stream._j_data_stream)
-        elif len(fields_or_schema) == 1 and isinstance(fields_or_schema[0], str):
-            self._j_tenv.createTemporaryView(
-                view_path,
-                table_or_data_stream._j_data_stream,
-                fields_or_schema[0])
-        elif len(fields_or_schema) == 1 and isinstance(fields_or_schema[0], Schema):
-            self._j_tenv.createTemporaryView(
-                view_path,
-                table_or_data_stream._j_data_stream,
-                fields_or_schema[0]._j_schema)
-        elif (len(fields_or_schema) > 0 and
-              all(isinstance(elem, Expression) for elem in fields_or_schema)):
-            self._j_tenv.createTemporaryView(
-                view_path,
-                table_or_data_stream._j_data_stream,
-                to_expression_jarray(fields_or_schema))
         else:
-            raise ValueError("Invalid arguments for 'fields': %r" %
-                             ','.join([repr(item) for item in fields_or_schema]))
+            j_data_stream = table_or_data_stream._j_data_stream
+            JPythonConfigUtil = get_gateway().jvm.org.apache.flink.python.util.PythonConfigUtil
+            JPythonConfigUtil.configPythonOperator(j_data_stream.getExecutionEnvironment())
+
+            if len(fields_or_schema) == 0:
+                self._j_tenv.createTemporaryView(view_path, j_data_stream)
+            elif len(fields_or_schema) == 1 and isinstance(fields_or_schema[0], str):
+                self._j_tenv.createTemporaryView(
+                    view_path,
+                    j_data_stream,
+                    fields_or_schema[0])
+            elif len(fields_or_schema) == 1 and isinstance(fields_or_schema[0], Schema):
+                self._j_tenv.createTemporaryView(
+                    view_path,
+                    j_data_stream,
+                    fields_or_schema[0]._j_schema)
+            elif (len(fields_or_schema) > 0 and
+                  all(isinstance(elem, Expression) for elem in fields_or_schema)):
+                self._j_tenv.createTemporaryView(
+                    view_path,
+                    j_data_stream,
+                    to_expression_jarray(fields_or_schema))
+            else:
+                raise ValueError("Invalid arguments for 'fields': %r" %
+                                 ','.join([repr(item) for item in fields_or_schema]))
 
     def add_python_file(self, file_path: str):
         """
diff --git a/flink-python/src/main/java/org/apache/flink/streaming/api/runners/python/beam/BeamPythonFunctionRunner.java b/flink-python/src/main/java/org/apache/flink/streaming/api/runners/python/beam/BeamPythonFunctionRunner.java
index 86264ab90ea..da4e111cdfa 100644
--- a/flink-python/src/main/java/org/apache/flink/streaming/api/runners/python/beam/BeamPythonFunctionRunner.java
+++ b/flink-python/src/main/java/org/apache/flink/streaming/api/runners/python/beam/BeamPythonFunctionRunner.java
@@ -232,9 +232,10 @@ public abstract class BeamPythonFunctionRunner implements PythonFunctionRunner {
         if (memoryManager != null && config.isUsingManagedMemory()) {
             Preconditions.checkArgument(
                     managedMemoryFraction > 0 && managedMemoryFraction <= 1.0,
-                    "The configured managed memory fraction for Python worker process must be within (0, 1], was: %s. "
-                            + "It may be because the consumer type \"Python\" was missing or set to 0 for the config option \"taskmanager.memory.managed.consumer-weights\"."
-                            + managedMemoryFraction);
+                    String.format(
+                            "The configured managed memory fraction for Python worker process must be within (0, 1], was: %s. "
+                                    + "It may be because the consumer type \"Python\" was missing or set to 0 for the config option \"taskmanager.memory.managed.consumer-weights\".",
+                            managedMemoryFraction));
 
             final LongFunctionWithException<PythonSharedResources, Exception> initializer =
                     (size) ->
