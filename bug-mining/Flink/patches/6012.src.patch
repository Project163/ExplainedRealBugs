diff --git a/flink-core/src/main/java/org/apache/flink/core/fs/AutoCloseableRegistry.java b/flink-core/src/main/java/org/apache/flink/core/fs/AutoCloseableRegistry.java
new file mode 100644
index 00000000000..5a91f8a2c1d
--- /dev/null
+++ b/flink-core/src/main/java/org/apache/flink/core/fs/AutoCloseableRegistry.java
@@ -0,0 +1,74 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.core.fs;
+
+import org.apache.flink.annotation.Internal;
+import org.apache.flink.util.AbstractAutoCloseableRegistry;
+import org.apache.flink.util.IOUtils;
+
+import javax.annotation.Nonnull;
+import javax.annotation.concurrent.ThreadSafe;
+
+import java.io.Closeable;
+import java.util.LinkedHashMap;
+import java.util.List;
+import java.util.Map;
+
+import static org.apache.flink.shaded.guava30.com.google.common.collect.Lists.reverse;
+
+/**
+ * This class allows to register instances of {@link AutoCloseable}, which are all closed if this
+ * registry is closed.
+ *
+ * <p>Registering to an already closed registry will throw an exception and close the provided
+ * {@link AutoCloseable}.
+ *
+ * <p>Unlike {@link CloseableRegistry} this class can throw an exception during the close.
+ *
+ * <p>This class closes all registered {@link Closeable}s in the reverse registration order.
+ */
+@ThreadSafe
+@Internal
+public class AutoCloseableRegistry
+        extends AbstractAutoCloseableRegistry<AutoCloseable, AutoCloseable, Object, Exception> {
+
+    private static final Object DUMMY = new Object();
+
+    public AutoCloseableRegistry() {
+        super(new LinkedHashMap<>());
+    }
+
+    @Override
+    protected void doRegister(
+            @Nonnull AutoCloseable closeable, @Nonnull Map<AutoCloseable, Object> closeableMap) {
+        closeableMap.put(closeable, DUMMY);
+    }
+
+    @Override
+    protected boolean doUnRegister(
+            @Nonnull AutoCloseable closeable, @Nonnull Map<AutoCloseable, Object> closeableMap) {
+        return closeableMap.remove(closeable) != null;
+    }
+
+    /** This implementation implies that any exception is possible during closing. */
+    @Override
+    protected void doClose(List<AutoCloseable> toClose) throws Exception {
+        IOUtils.closeAll(reverse(toClose), Throwable.class);
+    }
+}
diff --git a/flink-core/src/main/java/org/apache/flink/core/fs/CloseableRegistry.java b/flink-core/src/main/java/org/apache/flink/core/fs/CloseableRegistry.java
index da1786d3141..54315f090ad 100644
--- a/flink-core/src/main/java/org/apache/flink/core/fs/CloseableRegistry.java
+++ b/flink-core/src/main/java/org/apache/flink/core/fs/CloseableRegistry.java
@@ -19,17 +19,19 @@
 package org.apache.flink.core.fs;
 
 import org.apache.flink.annotation.Internal;
-import org.apache.flink.util.AbstractCloseableRegistry;
+import org.apache.flink.util.AbstractAutoCloseableRegistry;
+import org.apache.flink.util.IOUtils;
 
 import javax.annotation.Nonnull;
 
 import java.io.Closeable;
-import java.util.ArrayList;
-import java.util.Collection;
-import java.util.Collections;
+import java.io.IOException;
 import java.util.LinkedHashMap;
+import java.util.List;
 import java.util.Map;
 
+import static org.apache.flink.shaded.guava30.com.google.common.collect.Lists.reverse;
+
 /**
  * This class allows to register instances of {@link Closeable}, which are all closed if this
  * registry is closed.
@@ -42,7 +44,9 @@ import java.util.Map;
  * <p>This class closes all registered {@link Closeable}s in the reverse registration order.
  */
 @Internal
-public class CloseableRegistry extends AbstractCloseableRegistry<Closeable, Object> {
+public class CloseableRegistry
+        extends AbstractAutoCloseableRegistry<Closeable, Closeable, Object, IOException>
+        implements Closeable {
 
     private static final Object DUMMY = new Object();
 
@@ -62,10 +66,11 @@ public class CloseableRegistry extends AbstractCloseableRegistry<Closeable, Obje
         return closeableMap.remove(closeable) != null;
     }
 
+    /**
+     * This implementation doesn't imply any exception during closing due to backward compatibility.
+     */
     @Override
-    protected Collection<Closeable> getReferencesToClose() {
-        ArrayList<Closeable> closeablesToClose = new ArrayList<>(closeableToRef.keySet());
-        Collections.reverse(closeablesToClose);
-        return closeablesToClose;
+    public void doClose(List<Closeable> toClose) throws IOException {
+        IOUtils.closeAllQuietly(reverse(toClose));
     }
 }
diff --git a/flink-core/src/main/java/org/apache/flink/core/fs/SafetyNetCloseableRegistry.java b/flink-core/src/main/java/org/apache/flink/core/fs/SafetyNetCloseableRegistry.java
index 37d8e20e4b2..0dc049f22fe 100644
--- a/flink-core/src/main/java/org/apache/flink/core/fs/SafetyNetCloseableRegistry.java
+++ b/flink-core/src/main/java/org/apache/flink/core/fs/SafetyNetCloseableRegistry.java
@@ -20,7 +20,8 @@ package org.apache.flink.core.fs;
 
 import org.apache.flink.annotation.Internal;
 import org.apache.flink.annotation.VisibleForTesting;
-import org.apache.flink.util.AbstractCloseableRegistry;
+import org.apache.flink.util.AbstractAutoCloseableRegistry;
+import org.apache.flink.util.IOUtils;
 import org.apache.flink.util.Preconditions;
 import org.apache.flink.util.WrappingProxyUtil;
 
@@ -34,11 +35,12 @@ import java.io.IOException;
 import java.lang.ref.PhantomReference;
 import java.lang.ref.ReferenceQueue;
 import java.util.IdentityHashMap;
+import java.util.List;
 import java.util.Map;
 import java.util.function.Supplier;
 
 /**
- * This implementation of an {@link AbstractCloseableRegistry} registers {@link
+ * This implementation of an {@link AbstractAutoCloseableRegistry} registers {@link
  * WrappingProxyCloseable}. When the proxy becomes subject to GC, this registry takes care of
  * closing unclosed {@link Closeable}s.
  *
@@ -52,9 +54,11 @@ import java.util.function.Supplier;
  */
 @Internal
 public class SafetyNetCloseableRegistry
-        extends AbstractCloseableRegistry<
+        extends AbstractAutoCloseableRegistry<
+                Closeable,
                 WrappingProxyCloseable<? extends Closeable>,
-                SafetyNetCloseableRegistry.PhantomDelegatingCloseableRef> {
+                SafetyNetCloseableRegistry.PhantomDelegatingCloseableRef,
+                IOException> {
 
     private static final Logger LOG = LoggerFactory.getLogger(SafetyNetCloseableRegistry.class);
 
@@ -126,10 +130,13 @@ public class SafetyNetCloseableRegistry
         return null != innerCloseable && closeableMap.remove(innerCloseable) != null;
     }
 
+    /**
+     * This implementation doesn't imply any exception during closing due to backward compatibility.
+     */
     @Override
-    public void close() throws IOException {
+    protected void doClose(List<Closeable> toClose) throws IOException {
         try {
-            super.close();
+            IOUtils.closeAllQuietly(toClose);
         } finally {
             synchronized (REAPER_THREAD_LOCK) {
                 --GLOBAL_SAFETY_NET_REGISTRY_COUNT;
diff --git a/flink-core/src/main/java/org/apache/flink/util/AbstractCloseableRegistry.java b/flink-core/src/main/java/org/apache/flink/util/AbstractAutoCloseableRegistry.java
similarity index 79%
rename from flink-core/src/main/java/org/apache/flink/util/AbstractCloseableRegistry.java
rename to flink-core/src/main/java/org/apache/flink/util/AbstractAutoCloseableRegistry.java
index 7648b59f16d..07c4b9d0249 100644
--- a/flink-core/src/main/java/org/apache/flink/util/AbstractCloseableRegistry.java
+++ b/flink-core/src/main/java/org/apache/flink/util/AbstractAutoCloseableRegistry.java
@@ -27,7 +27,7 @@ import javax.annotation.concurrent.GuardedBy;
 import java.io.Closeable;
 import java.io.IOException;
 import java.util.ArrayList;
-import java.util.Collection;
+import java.util.List;
 import java.util.Map;
 
 /**
@@ -43,31 +43,34 @@ import java.util.Map;
  * @param <T> Type for potential meta data associated with the registering closeables
  */
 @Internal
-public abstract class AbstractCloseableRegistry<C extends Closeable, T> implements Closeable {
+public abstract class AbstractAutoCloseableRegistry<
+                R extends AutoCloseable, C extends R, T, E extends Exception>
+        implements AutoCloseable {
 
     /** Lock that guards state of this registry. * */
     private final Object lock;
 
     /** Map from tracked Closeables to some associated meta data. */
     @GuardedBy("lock")
-    protected final Map<Closeable, T> closeableToRef;
+    protected final Map<R, T> closeableToRef;
 
     /** Indicates if this registry is closed. */
     @GuardedBy("lock")
     private boolean closed;
 
-    public AbstractCloseableRegistry(@Nonnull Map<Closeable, T> closeableToRef) {
+    public AbstractAutoCloseableRegistry(@Nonnull Map<R, T> closeableToRef) {
         this.lock = new Object();
         this.closeableToRef = Preconditions.checkNotNull(closeableToRef);
         this.closed = false;
     }
 
     /**
-     * Registers a {@link Closeable} with the registry. In case the registry is already closed, this
-     * method throws an {@link IllegalStateException} and closes the passed {@link Closeable}.
+     * Registers a {@link AutoCloseable} with the registry. In case the registry is already closed,
+     * this method throws an {@link IllegalStateException} and closes the passed {@link
+     * AutoCloseable}.
      *
-     * @param closeable Closeable tor register
-     * @throws IOException exception when the registry was closed before
+     * @param closeable Closeable to register.
+     * @throws IOException exception when the registry was closed before.
      */
     public final void registerCloseable(C closeable) throws IOException {
 
@@ -106,8 +109,8 @@ public abstract class AbstractCloseableRegistry<C extends Closeable, T> implemen
     }
 
     @Override
-    public void close() throws IOException {
-        Collection<Closeable> toCloseCopy;
+    public void close() throws E {
+        List<R> toCloseCopy;
 
         synchronized (getSynchronizationLock()) {
             if (closed) {
@@ -116,38 +119,34 @@ public abstract class AbstractCloseableRegistry<C extends Closeable, T> implemen
 
             closed = true;
 
-            toCloseCopy = getReferencesToClose();
+            toCloseCopy = new ArrayList<>(closeableToRef.keySet());
 
             closeableToRef.clear();
         }
 
-        IOUtils.closeAllQuietly(toCloseCopy);
+        doClose(toCloseCopy);
     }
 
+    protected abstract void doClose(List<R> toClose) throws E;
+
     public boolean isClosed() {
         synchronized (getSynchronizationLock()) {
             return closed;
         }
     }
 
-    protected Collection<Closeable> getReferencesToClose() {
-        return new ArrayList<>(closeableToRef.keySet());
-    }
-
     /**
      * Does the actual registration of the closeable with the registry map. This should not do any
      * long running or potentially blocking operations as is is executed under the registry's lock.
      */
-    protected abstract void doRegister(
-            @Nonnull C closeable, @Nonnull Map<Closeable, T> closeableMap);
+    protected abstract void doRegister(@Nonnull C closeable, @Nonnull Map<R, T> closeableMap);
 
     /**
      * Does the actual un-registration of the closeable from the registry map. This should not do
      * any long running or potentially blocking operations as is is executed under the registry's
      * lock.
      */
-    protected abstract boolean doUnRegister(
-            @Nonnull C closeable, @Nonnull Map<Closeable, T> closeableMap);
+    protected abstract boolean doUnRegister(@Nonnull C closeable, @Nonnull Map<R, T> closeableMap);
 
     /**
      * Returns the lock on which manipulations to members closeableToRef and closeable must be
@@ -158,14 +157,14 @@ public abstract class AbstractCloseableRegistry<C extends Closeable, T> implemen
     }
 
     /** Adds a mapping to the registry map, respecting locking. */
-    protected final void addCloseableInternal(Closeable closeable, T metaData) {
+    protected final void addCloseableInternal(R closeable, T metaData) {
         synchronized (getSynchronizationLock()) {
             closeableToRef.put(closeable, metaData);
         }
     }
 
     /** Removes a mapping from the registry map, respecting locking. */
-    protected final boolean removeCloseableInternal(Closeable closeable) {
+    protected final boolean removeCloseableInternal(R closeable) {
         synchronized (getSynchronizationLock()) {
             return closeableToRef.remove(closeable) != null;
         }
@@ -179,7 +178,7 @@ public abstract class AbstractCloseableRegistry<C extends Closeable, T> implemen
     }
 
     @VisibleForTesting
-    public final boolean isCloseableRegistered(Closeable c) {
+    public final boolean isCloseableRegistered(R c) {
         synchronized (getSynchronizationLock()) {
             return closeableToRef.containsKey(c);
         }
diff --git a/flink-core/src/main/java/org/apache/flink/util/IOUtils.java b/flink-core/src/main/java/org/apache/flink/util/IOUtils.java
index 374878b5a6f..4ce4cf03793 100644
--- a/flink-core/src/main/java/org/apache/flink/util/IOUtils.java
+++ b/flink-core/src/main/java/org/apache/flink/util/IOUtils.java
@@ -230,6 +230,20 @@ public final class IOUtils {
      * @throws Exception collected exceptions that occurred during closing
      */
     public static void closeAll(Iterable<? extends AutoCloseable> closeables) throws Exception {
+        closeAll(closeables, Exception.class);
+    }
+
+    /**
+     * Closes all {@link AutoCloseable} objects in the parameter, suppressing exceptions. Exception
+     * will be emitted after calling close() on every object.
+     *
+     * @param closeables iterable with closeables to close.
+     * @param suppressedException class of exceptions which should be suppressed during the closing.
+     * @throws Exception collected exceptions that occurred during closing
+     */
+    public static <T extends Throwable> void closeAll(
+            Iterable<? extends AutoCloseable> closeables, Class<T> suppressedException)
+            throws Exception {
         if (null != closeables) {
 
             Exception collectedExceptions = null;
@@ -239,8 +253,13 @@ public final class IOUtils {
                     if (null != closeable) {
                         closeable.close();
                     }
-                } catch (Exception e) {
-                    collectedExceptions = ExceptionUtils.firstOrSuppressed(e, collectedExceptions);
+                } catch (Throwable e) {
+                    if (!suppressedException.isAssignableFrom(e.getClass())) {
+                        throw e;
+                    }
+
+                    Exception ex = e instanceof Exception ? (Exception) e : new Exception(e);
+                    collectedExceptions = ExceptionUtils.firstOrSuppressed(ex, collectedExceptions);
                 }
             }
 
diff --git a/flink-core/src/test/java/org/apache/flink/core/fs/AbstractCloseableRegistryTest.java b/flink-core/src/test/java/org/apache/flink/core/fs/AbstractAutoCloseableRegistryTest.java
similarity index 90%
rename from flink-core/src/test/java/org/apache/flink/core/fs/AbstractCloseableRegistryTest.java
rename to flink-core/src/test/java/org/apache/flink/core/fs/AbstractAutoCloseableRegistryTest.java
index 2b5be0a1e4c..58203e3deed 100644
--- a/flink-core/src/test/java/org/apache/flink/core/fs/AbstractCloseableRegistryTest.java
+++ b/flink-core/src/test/java/org/apache/flink/core/fs/AbstractAutoCloseableRegistryTest.java
@@ -18,7 +18,7 @@
 
 package org.apache.flink.core.fs;
 
-import org.apache.flink.util.AbstractCloseableRegistry;
+import org.apache.flink.util.AbstractAutoCloseableRegistry;
 
 import org.junit.Assert;
 import org.junit.Test;
@@ -34,21 +34,21 @@ import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertTrue;
 import static org.junit.Assert.fail;
 
-/** Tests for the {@link AbstractCloseableRegistry}. */
-public abstract class AbstractCloseableRegistryTest<C extends Closeable, T> {
+/** Tests for the {@link AbstractAutoCloseableRegistry}. */
+public abstract class AbstractAutoCloseableRegistryTest<C extends Closeable, E extends C, T> {
 
     private static final int TEST_TIMEOUT_SECONDS = 10;
 
     protected ProducerThread[] streamOpenThreads;
-    protected AbstractCloseableRegistry<C, T> closeableRegistry;
+    protected AbstractAutoCloseableRegistry<C, E, T, IOException> closeableRegistry;
     protected AtomicInteger unclosedCounter;
 
     protected abstract void registerCloseable(Closeable closeable) throws IOException;
 
-    protected abstract AbstractCloseableRegistry<C, T> createRegistry();
+    protected abstract AbstractAutoCloseableRegistry<C, E, T, IOException> createRegistry();
 
-    protected abstract ProducerThread<C, T> createProducerThread(
-            AbstractCloseableRegistry<C, T> registry,
+    protected abstract ProducerThread<C, E, T> createProducerThread(
+            AbstractAutoCloseableRegistry<C, E, T, IOException> registry,
             AtomicInteger unclosedCounter,
             int maxStreams);
 
@@ -141,15 +141,18 @@ public abstract class AbstractCloseableRegistryTest<C extends Closeable, T> {
     }
 
     /** A testing producer. */
-    protected abstract static class ProducerThread<C extends Closeable, T> extends Thread {
+    protected abstract static class ProducerThread<C extends Closeable, E extends C, T>
+            extends Thread {
 
-        protected final AbstractCloseableRegistry<C, T> registry;
+        protected final AbstractAutoCloseableRegistry<C, E, T, IOException> registry;
         protected final AtomicInteger refCount;
         protected final int maxStreams;
         protected int numStreams;
 
         public ProducerThread(
-                AbstractCloseableRegistry<C, T> registry, AtomicInteger refCount, int maxStreams) {
+                AbstractAutoCloseableRegistry<C, E, T, IOException> registry,
+                AtomicInteger refCount,
+                int maxStreams) {
             this.registry = registry;
             this.refCount = refCount;
             this.maxStreams = maxStreams;
diff --git a/flink-core/src/test/java/org/apache/flink/core/fs/AutoCloseableRegistryTest.java b/flink-core/src/test/java/org/apache/flink/core/fs/AutoCloseableRegistryTest.java
new file mode 100644
index 00000000000..693c0cf35df
--- /dev/null
+++ b/flink-core/src/test/java/org/apache/flink/core/fs/AutoCloseableRegistryTest.java
@@ -0,0 +1,74 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.core.fs;
+
+import org.apache.flink.util.TestLogger;
+
+import org.junit.Test;
+
+import java.util.ArrayList;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.fail;
+
+/** Tests for the {@link AutoCloseableRegistry}. */
+public class AutoCloseableRegistryTest extends TestLogger {
+    @Test
+    public void testReverseOrderOfClosing() throws Exception {
+        ArrayList<Integer> closeOrder = new ArrayList<>();
+        AutoCloseableRegistry autoCloseableRegistry = new AutoCloseableRegistry();
+        autoCloseableRegistry.registerCloseable(() -> closeOrder.add(3));
+        autoCloseableRegistry.registerCloseable(() -> closeOrder.add(2));
+        autoCloseableRegistry.registerCloseable(() -> closeOrder.add(1));
+
+        autoCloseableRegistry.close();
+
+        int expected = 1;
+        for (int actual : closeOrder) {
+            assertEquals(expected++, actual);
+        }
+    }
+
+    @Test
+    public void testSuppressedExceptions() throws Exception {
+        AutoCloseableRegistry autoCloseableRegistry = new AutoCloseableRegistry();
+        autoCloseableRegistry.registerCloseable(
+                () -> {
+                    throw new AssertionError("3");
+                });
+        autoCloseableRegistry.registerCloseable(
+                () -> {
+                    throw new Exception("2");
+                });
+        autoCloseableRegistry.registerCloseable(
+                () -> {
+                    throw new Exception("1");
+                });
+
+        try {
+            autoCloseableRegistry.close();
+
+            fail("Close should throw exception");
+        } catch (Exception ex) {
+            assertEquals("1", ex.getMessage());
+            assertEquals("2", ex.getSuppressed()[0].getMessage());
+            assertEquals("java.lang.AssertionError: 3", ex.getSuppressed()[1].getMessage());
+        }
+    }
+}
diff --git a/flink-core/src/test/java/org/apache/flink/core/fs/CloseableRegistryTest.java b/flink-core/src/test/java/org/apache/flink/core/fs/CloseableRegistryTest.java
index a1a2ff46228..5490df98bd0 100644
--- a/flink-core/src/test/java/org/apache/flink/core/fs/CloseableRegistryTest.java
+++ b/flink-core/src/test/java/org/apache/flink/core/fs/CloseableRegistryTest.java
@@ -18,14 +18,15 @@
 
 package org.apache.flink.core.fs;
 
-import org.apache.flink.util.AbstractCloseableRegistry;
+import org.apache.flink.util.AbstractAutoCloseableRegistry;
 
 import java.io.Closeable;
 import java.io.IOException;
 import java.util.concurrent.atomic.AtomicInteger;
 
 /** Tests for the {@link CloseableRegistry}. */
-public class CloseableRegistryTest extends AbstractCloseableRegistryTest<Closeable, Object> {
+public class CloseableRegistryTest
+        extends AbstractAutoCloseableRegistryTest<Closeable, Closeable, Object> {
 
     @Override
     protected void registerCloseable(final Closeable closeable) throws IOException {
@@ -33,18 +34,20 @@ public class CloseableRegistryTest extends AbstractCloseableRegistryTest<Closeab
     }
 
     @Override
-    protected AbstractCloseableRegistry<Closeable, Object> createRegistry() {
+    protected AbstractAutoCloseableRegistry<Closeable, Closeable, Object, IOException>
+            createRegistry() {
 
         return new CloseableRegistry();
     }
 
     @Override
-    protected ProducerThread<Closeable, Object> createProducerThread(
-            AbstractCloseableRegistry<Closeable, Object> registry,
+    protected ProducerThread<Closeable, Closeable, Object> createProducerThread(
+            AbstractAutoCloseableRegistry<Closeable, Closeable, Object, IOException> registry,
             AtomicInteger unclosedCounter,
             int maxStreams) {
 
-        return new ProducerThread<Closeable, Object>(registry, unclosedCounter, maxStreams) {
+        return new ProducerThread<Closeable, Closeable, Object>(
+                registry, unclosedCounter, maxStreams) {
             @Override
             protected void createAndRegisterStream() throws IOException {
                 TestStream testStream = new TestStream(unclosedCounter);
diff --git a/flink-core/src/test/java/org/apache/flink/core/fs/SafetyNetCloseableRegistryTest.java b/flink-core/src/test/java/org/apache/flink/core/fs/SafetyNetCloseableRegistryTest.java
index ba6316b24da..bb379b5a29d 100644
--- a/flink-core/src/test/java/org/apache/flink/core/fs/SafetyNetCloseableRegistryTest.java
+++ b/flink-core/src/test/java/org/apache/flink/core/fs/SafetyNetCloseableRegistryTest.java
@@ -19,7 +19,7 @@
 package org.apache.flink.core.fs;
 
 import org.apache.flink.core.testutils.CheckedThread;
-import org.apache.flink.util.AbstractCloseableRegistry;
+import org.apache.flink.util.AbstractAutoCloseableRegistry;
 import org.apache.flink.util.ExceptionUtils;
 
 import org.junit.After;
@@ -34,7 +34,8 @@ import java.util.concurrent.atomic.AtomicInteger;
 
 /** Tests for the {@link SafetyNetCloseableRegistry}. */
 public class SafetyNetCloseableRegistryTest
-        extends AbstractCloseableRegistryTest<
+        extends AbstractAutoCloseableRegistryTest<
+                Closeable,
                 WrappingProxyCloseable<? extends Closeable>,
                 SafetyNetCloseableRegistry.PhantomDelegatingCloseableRef> {
 
@@ -59,9 +60,11 @@ public class SafetyNetCloseableRegistryTest
     }
 
     @Override
-    protected AbstractCloseableRegistry<
+    protected AbstractAutoCloseableRegistry<
+                    Closeable,
                     WrappingProxyCloseable<? extends Closeable>,
-                    SafetyNetCloseableRegistry.PhantomDelegatingCloseableRef>
+                    SafetyNetCloseableRegistry.PhantomDelegatingCloseableRef,
+                    IOException>
             createRegistry() {
         // SafetyNetCloseableRegistry has a global reaper thread to reclaim leaking resources,
         // in normal cases, that thread will be interrupted in closing of last active registry
@@ -72,18 +75,22 @@ public class SafetyNetCloseableRegistryTest
     }
 
     @Override
-    protected AbstractCloseableRegistryTest.ProducerThread<
+    protected AbstractAutoCloseableRegistryTest.ProducerThread<
+                    Closeable,
                     WrappingProxyCloseable<? extends Closeable>,
                     SafetyNetCloseableRegistry.PhantomDelegatingCloseableRef>
             createProducerThread(
-                    AbstractCloseableRegistry<
+                    AbstractAutoCloseableRegistry<
+                                    Closeable,
                                     WrappingProxyCloseable<? extends Closeable>,
-                                    SafetyNetCloseableRegistry.PhantomDelegatingCloseableRef>
+                                    SafetyNetCloseableRegistry.PhantomDelegatingCloseableRef,
+                                    IOException>
                             registry,
                     AtomicInteger unclosedCounter,
                     int maxStreams) {
 
-        return new AbstractCloseableRegistryTest.ProducerThread<
+        return new AbstractAutoCloseableRegistryTest.ProducerThread<
+                Closeable,
                 WrappingProxyCloseable<? extends Closeable>,
                 SafetyNetCloseableRegistry.PhantomDelegatingCloseableRef>(
                 registry, unclosedCounter, maxStreams) {
