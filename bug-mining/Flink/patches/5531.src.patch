diff --git a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRule.java b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRule.java
index 5fe28278f03..a9c6fbade15 100644
--- a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRule.java
+++ b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRule.java
@@ -66,7 +66,7 @@ public class PythonMapMergeRule extends RelOptRule {
                         .collect(Collectors.toList());
 
         if (topProjects.size() != 1
-                || PythonUtil.isNonPythonCall(topProjects.get(0))
+                || !PythonUtil.isPythonCall(topProjects.get(0), null)
                 || !PythonUtil.takesRowAsInput((RexCall) topProjects.get(0))) {
             return false;
         }
@@ -76,7 +76,7 @@ public class PythonMapMergeRule extends RelOptRule {
                 bottomProgram.getProjectList().stream()
                         .map(bottomProgram::expandLocalRef)
                         .collect(Collectors.toList());
-        if (bottomProjects.size() != 1 || PythonUtil.isNonPythonCall(bottomProjects.get(0))) {
+        if (bottomProjects.size() != 1 || !PythonUtil.isPythonCall(bottomProjects.get(0), null)) {
             return false;
         }
 
@@ -87,7 +87,9 @@ public class PythonMapMergeRule extends RelOptRule {
         }
 
         RexProgram middleProgram = middleCalc.getProgram();
-        if (middleProgram.getCondition() != null) {
+        if (topProgram.getCondition() != null
+                || middleProgram.getCondition() != null
+                || bottomProgram.getCondition() != null) {
             return false;
         }
 
diff --git a/flink-table/flink-table-planner-blink/src/test/resources/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRuleTest.xml b/flink-table/flink-table-planner-blink/src/test/resources/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRuleTest.xml
index 4306debf980..19c0a93fb2e 100644
--- a/flink-table/flink-table-planner-blink/src/test/resources/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRuleTest.xml
+++ b/flink-table/flink-table-planner-blink/src/test/resources/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRuleTest.xml
@@ -45,6 +45,23 @@ FlinkLogicalCalc(select=[f0.f0 AS _c0, f0.f1 AS _c1])
    +- FlinkLogicalCalc(select=[f0.f0 AS f0, f0.f1 AS f1])
       +- FlinkLogicalCalc(select=[general_func(a, b, c) AS f0])
          +- FlinkLogicalLegacyTableSourceScan(table=[[default_catalog, default_database, source, source: [TestTableSource(a, b, c)]]], fields=[a, b, c])
+]]>
+	</Resource>
+  </TestCase>
+  <TestCase name="testProjectWithOneField">
+	<Resource name="ast">
+	  <![CDATA[
+LogicalFilter(condition=[org$apache$flink$table$planner$runtime$utils$JavaUserDefinedScalarFunctions$BooleanPythonScalarFunction$98c7b7a8821989c1d64b757ebdb463b9(+($0, 1), $0)])
++- LogicalProject(a=[$0])
+   +- LogicalTableScan(table=[[default_catalog, default_database, source, source: [TestTableSource(a, b, c)]]])
+]]>
+	</Resource>
+	<Resource name="optimized rel plan">
+	  <![CDATA[
+FlinkLogicalCalc(select=[a], where=[f0])
++- FlinkLogicalCalc(select=[a, boolean_func(f0, a) AS f0])
+   +- FlinkLogicalCalc(select=[a, +(a, 1) AS f0])
+      +- FlinkLogicalLegacyTableSourceScan(table=[[default_catalog, default_database, source, source: [TestTableSource(a, b, c)]]], fields=[a, b, c])
 ]]>
 	</Resource>
   </TestCase>
diff --git a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRuleTest.scala b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRuleTest.scala
index 650980a2e0f..732bcaa37d6 100644
--- a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRuleTest.scala
+++ b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/rules/logical/PythonMapMergeRuleTest.scala
@@ -23,7 +23,7 @@ import org.apache.flink.table.api._
 import org.apache.flink.table.planner.plan.nodes.FlinkConventions
 import org.apache.flink.table.planner.plan.optimize.program._
 import org.apache.flink.table.planner.plan.rules.{FlinkBatchRuleSets, FlinkStreamRuleSets}
-import org.apache.flink.table.planner.runtime.utils.JavaUserDefinedScalarFunctions.{RowPandasScalarFunction, RowPythonScalarFunction}
+import org.apache.flink.table.planner.runtime.utils.JavaUserDefinedScalarFunctions.{BooleanPythonScalarFunction, RowPandasScalarFunction, RowPythonScalarFunction}
 import org.apache.flink.table.planner.utils.TableTestBase
 
 import org.apache.calcite.plan.hep.HepMatchOrder
@@ -75,4 +75,12 @@ class PythonMapMergeRuleTest extends TableTestBase {
       .map(pandas_func(withColumns('*)))
     util.verifyRelPlan(result)
   }
+
+  @Test
+  def testProjectWithOneField(): Unit = {
+    val sourceTable = util.addTableSource[(Int, Int, Int)]("source", 'a, 'b, 'c)
+    val booleanFunc = new BooleanPythonScalarFunction("boolean_func")
+    val result = sourceTable.select('a).where(booleanFunc('a + 1, 'a))
+    util.verifyRelPlan(result)
+  }
 }
