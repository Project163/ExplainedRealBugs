diff --git a/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/runtime/tasks/OutputHandler.java b/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/runtime/tasks/OutputHandler.java
index c953a9456d9..38f12313b1f 100644
--- a/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/runtime/tasks/OutputHandler.java
+++ b/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/runtime/tasks/OutputHandler.java
@@ -150,7 +150,11 @@ public class OutputHandler<OUT> {
 			// operator which will be returned and set it up using the wrapper
 			OneInputStreamOperator chainableOperator =
 					chainedTaskConfig.getStreamOperator(vertex.getUserCodeClassLoader());
-			chainableOperator.setup(wrapper, vertex.context);
+			
+			StreamingRuntimeContext chainedContext = vertex.createRuntimeContext(chainedTaskConfig);
+			vertex.contexts.add(chainedContext);
+			
+			chainableOperator.setup(wrapper, chainedContext);
 
 			chainedOperators.add(chainableOperator);
 			return new OperatorCollector<X>(chainableOperator);
diff --git a/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/runtime/tasks/StreamTask.java b/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/runtime/tasks/StreamTask.java
index d6789229ae4..1a3d44fa655 100644
--- a/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/runtime/tasks/StreamTask.java
+++ b/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/runtime/tasks/StreamTask.java
@@ -62,7 +62,7 @@ public abstract class StreamTask<OUT, O extends StreamOperator<OUT>> extends Abs
 
 	protected volatile boolean isRunning = false;
 
-	protected StreamingRuntimeContext context;
+	protected List<StreamingRuntimeContext> contexts;
 
 	protected ClassLoader userClassLoader;
 	
@@ -73,21 +73,26 @@ public abstract class StreamTask<OUT, O extends StreamOperator<OUT>> extends Abs
 	public StreamTask() {
 		streamOperator = null;
 		superstepListener = new SuperstepEventListener();
+		contexts = new ArrayList<StreamingRuntimeContext>();
 	}
 
 	@Override
 	public void registerInputOutput() {
 		this.userClassLoader = getUserCodeClassLoader();
 		this.configuration = new StreamConfig(getTaskConfiguration());
-		this.context = createRuntimeContext(getEnvironment().getTaskName());
 		this.stateHandleProvider = getStateHandleProvider();
 
 		outputHandler = new OutputHandler<OUT>(this);
 
 		streamOperator = configuration.getStreamOperator(userClassLoader);
+		
 		if (streamOperator != null) {
+			//Create context of the head operator
+			StreamingRuntimeContext headContext = createRuntimeContext(configuration);
+			this.contexts.add(headContext);
+
 			// IterationHead and IterationTail don't have an Operator...
-			streamOperator.setup(outputHandler.getOutput(), this.context);
+			streamOperator.setup(outputHandler.getOutput(), headContext);
 		}
 
 		hasChainedOperators = !outputHandler.getChainedOperators().isEmpty();
@@ -97,10 +102,10 @@ public abstract class StreamTask<OUT, O extends StreamOperator<OUT>> extends Abs
 		return getEnvironment().getTaskName();
 	}
 
-	public StreamingRuntimeContext createRuntimeContext(String taskName) {
+	public StreamingRuntimeContext createRuntimeContext(StreamConfig conf) {
 		Environment env = getEnvironment();
-		return new StreamingRuntimeContext(taskName, env, getUserCodeClassLoader(),
-				getExecutionConfig());
+		return new StreamingRuntimeContext(conf.getStreamOperator(userClassLoader).getClass()
+				.getSimpleName(), env, getUserCodeClassLoader(), getExecutionConfig());
 	}
 	
 	private StateHandleProvider<Serializable> getStateHandleProvider() {
diff --git a/flink-staging/flink-streaming/flink-streaming-core/src/test/java/org/apache/flink/streaming/api/ChainedRuntimeContextTest.java b/flink-staging/flink-streaming/flink-streaming-core/src/test/java/org/apache/flink/streaming/api/ChainedRuntimeContextTest.java
new file mode 100644
index 00000000000..084973f4f32
--- /dev/null
+++ b/flink-staging/flink-streaming/flink-streaming-core/src/test/java/org/apache/flink/streaming/api/ChainedRuntimeContextTest.java
@@ -0,0 +1,79 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *    http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.streaming.api;
+
+import static org.junit.Assert.*;
+
+import org.apache.flink.api.common.functions.RichMapFunction;
+import org.apache.flink.api.common.functions.RuntimeContext;
+import org.apache.flink.configuration.Configuration;
+import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
+import org.apache.flink.streaming.api.functions.source.RichParallelSourceFunction;
+import org.apache.flink.streaming.util.TestStreamEnvironment;
+import org.junit.Test;
+
+@SuppressWarnings("serial")
+public class ChainedRuntimeContextTest {
+	private static final long MEMORYSIZE = 32;
+	private static RuntimeContext srcContext;
+	private static RuntimeContext mapContext;
+
+	@Test
+	public void test() throws Exception {
+		StreamExecutionEnvironment env = new TestStreamEnvironment(1, MEMORYSIZE);
+		env.addSource(new TestSource()).map(new TestMap());
+		env.execute();
+
+		assertNotEquals(srcContext, mapContext);
+
+	}
+
+	private static class TestSource extends RichParallelSourceFunction<Integer> {
+
+		@Override
+		public boolean reachedEnd() throws Exception {
+			return true;
+		}
+
+		@Override
+		public Integer next() throws Exception {
+			return null;
+		}
+
+		@Override
+		public void open(Configuration c) {
+			srcContext = getRuntimeContext();
+		}
+
+	}
+
+	private static class TestMap extends RichMapFunction<Integer, Integer> {
+
+		@Override
+		public Integer map(Integer value) throws Exception {
+			return value;
+		}
+
+		@Override
+		public void open(Configuration c) {
+			mapContext = getRuntimeContext();
+		}
+
+	}
+
+}
