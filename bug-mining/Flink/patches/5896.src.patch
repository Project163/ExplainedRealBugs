diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/ResourceManager.java b/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/ResourceManager.java
index be1f3ea9db3..12a587faf6a 100755
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/ResourceManager.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/resourcemanager/ResourceManager.java
@@ -492,7 +492,7 @@ public abstract class ResourceManager<WorkerType extends ResourceIDRetrievable>
 
     @Override
     public void disconnectTaskManager(final ResourceID resourceId, final Exception cause) {
-        closeTaskManagerConnection(resourceId, cause);
+        closeTaskManagerConnection(resourceId, cause).ifPresent(ResourceManager.this::stopWorker);
     }
 
     @Override
@@ -988,8 +988,10 @@ public abstract class ResourceManager<WorkerType extends ResourceIDRetrievable>
      *
      * @param resourceID Id of the TaskManager that has failed.
      * @param cause The exception which cause the TaskManager failed.
+     * @return The {@link WorkerType} of the closed connection, or empty if already removed.
      */
-    protected void closeTaskManagerConnection(final ResourceID resourceID, final Exception cause) {
+    protected Optional<WorkerType> closeTaskManagerConnection(
+            final ResourceID resourceID, final Exception cause) {
         taskManagerHeartbeatManager.unmonitorTarget(resourceID);
 
         WorkerRegistration<WorkerType> workerRegistration = taskExecutors.remove(resourceID);
@@ -1011,6 +1013,8 @@ public abstract class ResourceManager<WorkerType extends ResourceIDRetrievable>
                     resourceID.getStringWithMetadata(),
                     cause.getMessage());
         }
+
+        return Optional.ofNullable(workerRegistration).map(WorkerRegistration::getWorker);
     }
 
     protected void removeJob(JobID jobId, Exception cause) {
@@ -1325,7 +1329,8 @@ public abstract class ResourceManager<WorkerType extends ResourceIDRetrievable>
 
         private void handleTaskManagerConnectionLoss(ResourceID resourceID, Exception cause) {
             validateRunsInMainThread();
-            closeTaskManagerConnection(resourceID, cause);
+            closeTaskManagerConnection(resourceID, cause)
+                    .ifPresent(ResourceManager.this::stopWorker);
         }
 
         @Override
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ResourceManagerTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ResourceManagerTest.java
index bf2f89cb38f..3093650733e 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ResourceManagerTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ResourceManagerTest.java
@@ -67,7 +67,10 @@ import java.util.UUID;
 import java.util.concurrent.CompletableFuture;
 import java.util.concurrent.TimeUnit;
 import java.util.concurrent.TimeoutException;
+import java.util.function.Consumer;
+import java.util.function.Function;
 
+import static org.hamcrest.MatcherAssert.assertThat;
 import static org.hamcrest.Matchers.anyOf;
 import static org.hamcrest.Matchers.empty;
 import static org.hamcrest.Matchers.equalTo;
@@ -75,7 +78,6 @@ import static org.hamcrest.Matchers.instanceOf;
 import static org.hamcrest.Matchers.is;
 import static org.hamcrest.Matchers.nullValue;
 import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.assertThat;
 import static org.junit.Assert.fail;
 
 /** Tests for the {@link ResourceManager}. */
@@ -136,6 +138,10 @@ public class ResourceManagerTest extends TestLogger {
         if (testingFatalErrorHandler.hasExceptionOccurred()) {
             testingFatalErrorHandler.rethrowError();
         }
+
+        if (rpcService != null) {
+            rpcService.clearGateways();
+        }
     }
 
     @AfterClass
@@ -318,6 +324,7 @@ public class ResourceManagerTest extends TestLogger {
                 });
 
         runHeartbeatTimeoutTest(
+                (ignore) -> {},
                 resourceManagerGateway -> {
                     final CompletableFuture<RegistrationResponse> registrationFuture =
                             resourceManagerGateway.registerJobManager(
@@ -373,6 +380,7 @@ public class ResourceManagerTest extends TestLogger {
                 });
 
         runHeartbeatTargetBecomesUnreachableTest(
+                (ignore) -> {},
                 resourceManagerGateway -> {
                     final CompletableFuture<RegistrationResponse> registrationFuture =
                             resourceManagerGateway.registerJobManager(
@@ -395,6 +403,7 @@ public class ResourceManagerTest extends TestLogger {
         final ResourceID taskExecutorId = ResourceID.generate();
         final CompletableFuture<ResourceID> heartbeatRequestFuture = new CompletableFuture<>();
         final CompletableFuture<Exception> disconnectFuture = new CompletableFuture<>();
+        final CompletableFuture<ResourceID> stopWorkerFuture = new CompletableFuture<>();
         final TaskExecutorGateway taskExecutorGateway =
                 new TestingTaskExecutorGatewayBuilder()
                         .setDisconnectResourceManagerConsumer(disconnectFuture::complete)
@@ -407,6 +416,12 @@ public class ResourceManagerTest extends TestLogger {
         rpcService.registerGateway(taskExecutorGateway.getAddress(), taskExecutorGateway);
 
         runHeartbeatTimeoutTest(
+                builder ->
+                        builder.withStopWorkerFunction(
+                                (worker) -> {
+                                    stopWorkerFuture.complete(worker);
+                                    return true;
+                                }),
                 resourceManagerGateway -> {
                     registerTaskExecutor(
                             resourceManagerGateway,
@@ -422,6 +437,7 @@ public class ResourceManagerTest extends TestLogger {
                             optionalHeartbeatRequestOrigin,
                             anyOf(is(resourceManagerResourceId), is(nullValue())));
                     assertThat(disconnectFuture.get(), instanceOf(TimeoutException.class));
+                    assertThat(stopWorkerFuture.get(), is(taskExecutorId));
                 });
     }
 
@@ -429,6 +445,7 @@ public class ResourceManagerTest extends TestLogger {
     public void testTaskExecutorBecomesUnreachableTriggersDisconnect() throws Exception {
         final ResourceID taskExecutorId = ResourceID.generate();
         final CompletableFuture<Exception> disconnectFuture = new CompletableFuture<>();
+        final CompletableFuture<ResourceID> stopWorkerFuture = new CompletableFuture<>();
         final TaskExecutorGateway taskExecutorGateway =
                 new TestingTaskExecutorGatewayBuilder()
                         .setAddress(UUID.randomUUID().toString())
@@ -444,15 +461,21 @@ public class ResourceManagerTest extends TestLogger {
         rpcService.registerGateway(taskExecutorGateway.getAddress(), taskExecutorGateway);
 
         runHeartbeatTargetBecomesUnreachableTest(
+                builder ->
+                        builder.withStopWorkerFunction(
+                                (worker) -> {
+                                    stopWorkerFuture.complete(worker);
+                                    return true;
+                                }),
                 resourceManagerGateway ->
                         registerTaskExecutor(
                                 resourceManagerGateway,
                                 taskExecutorId,
                                 taskExecutorGateway.getAddress()),
-                resourceManagerResourceId ->
-                        assertThat(
-                                disconnectFuture.get(),
-                                instanceOf(ResourceManagerException.class)));
+                resourceManagerResourceId -> {
+                    assertThat(disconnectFuture.get(), instanceOf(ResourceManagerException.class));
+                    assertThat(stopWorkerFuture.get(), is(taskExecutorId));
+                });
     }
 
     @Test
@@ -465,6 +488,30 @@ public class ResourceManagerTest extends TestLogger {
         testDisconnectJobManager(JobStatus.FAILING);
     }
 
+    @Test
+    public void testDisconnectTaskManager() throws Exception {
+        final ResourceID taskExecutorId = ResourceID.generate();
+        final CompletableFuture<Exception> disconnectFuture = new CompletableFuture<>();
+        final CompletableFuture<ResourceID> stopWorkerFuture = new CompletableFuture<>();
+
+        final TaskExecutorGateway taskExecutorGateway =
+                new TestingTaskExecutorGatewayBuilder()
+                        .setDisconnectResourceManagerConsumer(disconnectFuture::complete)
+                        .createTestingTaskExecutorGateway();
+        rpcService.registerGateway(taskExecutorGateway.getAddress(), taskExecutorGateway);
+
+        resourceManager =
+                new ResourceManagerBuilder()
+                        .withStopWorkerFunction(stopWorkerFuture::complete)
+                        .buildAndStart();
+
+        registerTaskExecutor(resourceManager, taskExecutorId, taskExecutorGateway.getAddress());
+        resourceManager.disconnectTaskManager(taskExecutorId, new FlinkException("Test exception"));
+
+        assertThat(disconnectFuture.get(), instanceOf(FlinkException.class));
+        assertThat(stopWorkerFuture.get(), is(taskExecutorId));
+    }
+
     private void testDisconnectJobManager(JobStatus jobStatus) throws Exception {
         final TestingJobMasterGateway jobMasterGateway =
                 new TestingJobMasterGatewayBuilder()
@@ -519,13 +566,13 @@ public class ResourceManagerTest extends TestLogger {
     }
 
     private void runHeartbeatTimeoutTest(
+            Consumer<ResourceManagerBuilder> prepareResourceManager,
             ThrowingConsumer<ResourceManagerGateway, Exception> registerComponentAtResourceManager,
             ThrowingConsumer<ResourceID, Exception> verifyHeartbeatTimeout)
             throws Exception {
-        resourceManager =
-                new ResourceManagerBuilder()
-                        .withHeartbeatServices(fastHeartbeatServices)
-                        .buildAndStart();
+        final ResourceManagerBuilder rmBuilder = new ResourceManagerBuilder();
+        prepareResourceManager.accept(rmBuilder);
+        resourceManager = rmBuilder.withHeartbeatServices(fastHeartbeatServices).buildAndStart();
         final ResourceManagerGateway resourceManagerGateway =
                 resourceManager.getSelfGateway(ResourceManagerGateway.class);
 
@@ -534,13 +581,14 @@ public class ResourceManagerTest extends TestLogger {
     }
 
     private void runHeartbeatTargetBecomesUnreachableTest(
+            Consumer<ResourceManagerBuilder> prepareResourceManager,
             ThrowingConsumer<ResourceManagerGateway, Exception> registerComponentAtResourceManager,
             ThrowingConsumer<ResourceID, Exception> verifyHeartbeatTimeout)
             throws Exception {
+        final ResourceManagerBuilder rmBuilder = new ResourceManagerBuilder();
+        prepareResourceManager.accept(rmBuilder);
         resourceManager =
-                new ResourceManagerBuilder()
-                        .withHeartbeatServices(failedRpcEnabledHeartbeatServices)
-                        .buildAndStart();
+                rmBuilder.withHeartbeatServices(failedRpcEnabledHeartbeatServices).buildAndStart();
         final ResourceManagerGateway resourceManagerGateway =
                 resourceManager.getSelfGateway(ResourceManagerGateway.class);
 
@@ -552,6 +600,7 @@ public class ResourceManagerTest extends TestLogger {
         private HeartbeatServices heartbeatServices = null;
         private JobLeaderIdService jobLeaderIdService = null;
         private SlotManager slotManager = null;
+        private Function<ResourceID, Boolean> stopWorkerFunction = null;
 
         private ResourceManagerBuilder withHeartbeatServices(HeartbeatServices heartbeatServices) {
             this.heartbeatServices = heartbeatServices;
@@ -569,6 +618,12 @@ public class ResourceManagerTest extends TestLogger {
             return this;
         }
 
+        private ResourceManagerBuilder withStopWorkerFunction(
+                Function<ResourceID, Boolean> stopWorkerFunction) {
+            this.stopWorkerFunction = stopWorkerFunction;
+            return this;
+        }
+
         private TestingResourceManager buildAndStart() throws Exception {
             if (heartbeatServices == null) {
                 heartbeatServices = ResourceManagerTest.heartbeatServices;
@@ -589,6 +644,10 @@ public class ResourceManagerTest extends TestLogger {
                                 .build();
             }
 
+            if (stopWorkerFunction == null) {
+                stopWorkerFunction = (ignore) -> false;
+            }
+
             resourceManagerId = ResourceManagerId.generate();
             final TestingResourceManager resourceManager =
                     new TestingResourceManager(
@@ -600,8 +659,8 @@ public class ResourceManagerTest extends TestLogger {
                             NoOpResourceManagerPartitionTracker::get,
                             jobLeaderIdService,
                             testingFatalErrorHandler,
-                            UnregisteredMetricGroups
-                                    .createUnregisteredResourceManagerMetricGroup());
+                            UnregisteredMetricGroups.createUnregisteredResourceManagerMetricGroup(),
+                            stopWorkerFunction);
 
             resourceManager.start();
             resourceManager.getStartedFuture().get(TIMEOUT.getSize(), TIMEOUT.getUnit());
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/TestingResourceManager.java b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/TestingResourceManager.java
index 54adb32d852..5ac1e9fc5a3 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/TestingResourceManager.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/TestingResourceManager.java
@@ -34,10 +34,13 @@ import javax.annotation.Nullable;
 
 import java.util.UUID;
 import java.util.concurrent.ForkJoinPool;
+import java.util.function.Function;
 
 /** Simple {@link ResourceManager} implementation for testing purposes. */
 public class TestingResourceManager extends ResourceManager<ResourceID> {
 
+    private final Function<ResourceID, Boolean> stopWorkerFunction;
+
     public TestingResourceManager(
             RpcService rpcService,
             UUID leaderSessionId,
@@ -47,7 +50,8 @@ public class TestingResourceManager extends ResourceManager<ResourceID> {
             ResourceManagerPartitionTrackerFactory clusterPartitionTrackerFactory,
             JobLeaderIdService jobLeaderIdService,
             FatalErrorHandler fatalErrorHandler,
-            ResourceManagerMetricGroup resourceManagerMetricGroup) {
+            ResourceManagerMetricGroup resourceManagerMetricGroup,
+            Function<ResourceID, Boolean> stopWorkerFunction) {
         super(
                 rpcService,
                 leaderSessionId,
@@ -61,6 +65,8 @@ public class TestingResourceManager extends ResourceManager<ResourceID> {
                 resourceManagerMetricGroup,
                 RpcUtils.INF_TIMEOUT,
                 ForkJoinPool.commonPool());
+
+        this.stopWorkerFunction = stopWorkerFunction;
     }
 
     @Override
@@ -92,7 +98,6 @@ public class TestingResourceManager extends ResourceManager<ResourceID> {
 
     @Override
     public boolean stopWorker(ResourceID worker) {
-        // cannot stop workers
-        return false;
+        return stopWorkerFunction.apply(worker);
     }
 }
