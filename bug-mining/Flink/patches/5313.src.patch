diff --git a/flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/runtime/hashtable/LongHashPartition.java b/flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/runtime/hashtable/LongHashPartition.java
index f022e6fa42c..951562687cb 100644
--- a/flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/runtime/hashtable/LongHashPartition.java
+++ b/flink-table/flink-table-runtime-blink/src/main/java/org/apache/flink/table/runtime/hashtable/LongHashPartition.java
@@ -160,7 +160,7 @@ public class LongHashPartition extends AbstractPagedInputView implements Seekabl
         this.partitionNum = partitionNum;
         this.recursionLevel = recursionLevel;
 
-        int numBuckets = MathUtils.roundDownToPowerOf2(bucketNumSegs * segmentSize / 16);
+        int numBuckets = MathUtils.roundDownToPowerOf2(segmentSize / 16 * bucketNumSegs);
         MemorySegment[] buckets = new MemorySegment[bucketNumSegs];
         for (int i = 0; i < bucketNumSegs; i++) {
             buckets[i] = longTable.nextSegment();
