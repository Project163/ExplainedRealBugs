diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/aggregate/ProcTimeBoundedRangeOver.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/aggregate/ProcTimeBoundedRangeOver.scala
index e00c7ace6d4..591b942571f 100644
--- a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/aggregate/ProcTimeBoundedRangeOver.scala
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/runtime/aggregate/ProcTimeBoundedRangeOver.scala
@@ -132,6 +132,14 @@ class ProcTimeBoundedRangeOver(
 
     val currentTime = timestamp - 1
     var i = 0
+    // get the list of elements of current proctime
+    val currentElements = rowMapState.get(currentTime)
+
+    // Expired clean-up timers pass the needToCleanupState() check.
+    // Perform a null check to verify that we have data to process.
+    if (null == currentElements) {
+      return
+    }
 
     // initialize the accumulators
     var accumulators = accumulatorState.value()
@@ -172,8 +180,7 @@ class ProcTimeBoundedRangeOver(
       i += 1
     }
 
-    // get the list of elements of current proctime
-    val currentElements = rowMapState.get(currentTime)
+
     // add current elements to aggregator. Multiple elements might
     // have arrived in the same proctime
     // the same accumulator value will be computed for all elements
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/harness/OverWindowHarnessTest.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/harness/OverWindowHarnessTest.scala
index 6f6fc0edb13..218cae2dc19 100644
--- a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/harness/OverWindowHarnessTest.scala
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/harness/OverWindowHarnessTest.scala
@@ -208,6 +208,21 @@ class OverWindowHarnessTest extends HarnessTestBase{
 
     testHarness.setProcessingTime(11006)
 
+    // test for clean-up timer NPE
+    testHarness.setProcessingTime(20000)
+
+    // timer registered for 23000
+    testHarness.processElement(new StreamRecord(
+      CRow(Row.of(0L: JLong, "ccc", 10L: JLong), change = true)))
+
+    // update clean-up timer to 25500. Previous timer should not clean up
+    testHarness.setProcessingTime(22500)
+    testHarness.processElement(new StreamRecord(
+      CRow(Row.of(0L: JLong, "ccc", 20L: JLong), change = true)))
+
+    // 23000 clean-up timer should fire but not fail with an NPE
+    testHarness.setProcessingTime(23001)
+
     val result = testHarness.getOutput
 
     val expectedOutput = new ConcurrentLinkedQueue[Object]()
@@ -241,6 +256,10 @@ class OverWindowHarnessTest extends HarnessTestBase{
       CRow(Row.of(0L: JLong, "aaa", 10L: JLong, 7L: JLong, 10L: JLong), change = true)))
     expectedOutput.add(new StreamRecord(
       CRow(Row.of(0L: JLong, "bbb", 40L: JLong, 40L: JLong, 40L: JLong), change = true)))
+    expectedOutput.add(new StreamRecord(
+      CRow(Row.of(0L: JLong, "ccc", 10L: JLong, 10L: JLong, 10L: JLong), change = true)))
+    expectedOutput.add(new StreamRecord(
+      CRow(Row.of(0L: JLong, "ccc", 20L: JLong, 10L: JLong, 20L: JLong), change = true)))
 
     verify(expectedOutput, result, new RowResultSortComparator())
 
