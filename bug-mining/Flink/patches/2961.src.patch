diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/PartitionRequestQueue.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/PartitionRequestQueue.java
index c3d3d1bcc10..4ca25266c71 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/PartitionRequestQueue.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/netty/PartitionRequestQueue.java
@@ -20,8 +20,6 @@ package org.apache.flink.runtime.io.network.netty;
 
 import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.runtime.io.network.NetworkSequenceViewReader;
-import org.apache.flink.runtime.io.network.api.EndOfPartitionEvent;
-import org.apache.flink.runtime.io.network.api.serialization.EventSerializer;
 import org.apache.flink.runtime.io.network.buffer.Buffer;
 import org.apache.flink.runtime.io.network.netty.NettyMessage.ErrorResponse;
 import org.apache.flink.runtime.io.network.partition.ProducerFailedException;
@@ -134,10 +132,16 @@ class PartitionRequestQueue extends ChannelInboundHandlerAdapter {
 		ctx.pipeline().fireUserEventTriggered(receiverId);
 	}
 
-	public void close() {
+	public void close() throws IOException {
 		if (ctx != null) {
 			ctx.channel().close();
 		}
+
+		for (NetworkSequenceViewReader reader : allReaders.values()) {
+			reader.notifySubpartitionConsumed();
+			reader.releaseAllResources();
+			markAsReleased(reader.getReceiverId());
+		}
 	}
 
 	/**
@@ -247,13 +251,6 @@ class PartitionRequestQueue extends ChannelInboundHandlerAdapter {
 						reader.getReceiverId(),
 						next.buffersInBacklog());
 
-					if (isEndOfPartitionEvent(next.buffer())) {
-						reader.notifySubpartitionConsumed();
-						reader.releaseAllResources();
-
-						markAsReleased(reader.getReceiverId());
-					}
-
 					// Write and flush and wait until this is done before
 					// trying to continue with the next buffer.
 					channel.writeAndFlush(msg).addListener(writeListener);
@@ -284,10 +281,6 @@ class PartitionRequestQueue extends ChannelInboundHandlerAdapter {
 		return reader;
 	}
 
-	private boolean isEndOfPartitionEvent(Buffer buffer) throws IOException {
-		return EventSerializer.isEvent(buffer, EndOfPartitionEvent.class);
-	}
-
 	@Override
 	public void channelInactive(ChannelHandlerContext ctx) throws Exception {
 		releaseAllResources();
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/ResultPartition.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/ResultPartition.java
index 4f4f5ccf89a..3b0719feb40 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/ResultPartition.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/ResultPartition.java
@@ -378,6 +378,16 @@ public class ResultPartition implements ResultPartitionWriter, BufferPoolOwner {
 		}
 	}
 
+	/**
+	 * Whether this partition is released.
+	 *
+	 * <p>A partition is released when each subpartition is either consumed and communication is closed by consumer
+	 * or failed. A partition is also released if task is cancelled.
+	 */
+	public boolean isReleased() {
+		return isReleased.get();
+	}
+
 	@Override
 	public String toString() {
 		return "ResultPartition " + partitionId.toString() + " [" + partitionType + ", "
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/ResultPartitionTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/ResultPartitionTest.java
index dbbc5c2eb21..b258ac37748 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/ResultPartitionTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/ResultPartitionTest.java
@@ -37,6 +37,7 @@ import org.junit.Test;
 import static org.apache.flink.runtime.io.network.buffer.BufferBuilderTestUtils.createFilledBufferConsumer;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertTrue;
 import static org.mockito.Matchers.any;
 import static org.mockito.Matchers.eq;
 import static org.mockito.Mockito.mock;
@@ -162,6 +163,7 @@ public class ResultPartitionTest {
 			partition.release();
 			// partition.add() silently drops the bufferConsumer but recycles it
 			partition.addBufferConsumer(bufferConsumer, 0);
+			assertTrue(partition.isReleased());
 		} finally {
 			if (!bufferConsumer.isRecycled()) {
 				bufferConsumer.close();
