diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/netty/NettyTestUtil.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/netty/NettyTestUtil.java
index 5e4b5b68711..c5bdcb85b86 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/netty/NettyTestUtil.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/netty/NettyTestUtil.java
@@ -27,6 +27,7 @@ import org.apache.flink.shaded.netty4.io.netty.buffer.ByteBuf;
 import org.apache.flink.shaded.netty4.io.netty.channel.Channel;
 import org.apache.flink.shaded.netty4.io.netty.channel.embedded.EmbeddedChannel;
 
+import java.net.BindException;
 import java.net.InetAddress;
 import java.net.InetSocketAddress;
 import java.util.concurrent.TimeUnit;
@@ -35,6 +36,7 @@ import java.util.function.Function;
 import static junit.framework.TestCase.assertEquals;
 import static org.apache.flink.runtime.io.network.netty.NettyMessage.BufferResponse;
 import static org.apache.flink.runtime.io.network.netty.NettyMessage.ErrorResponse;
+import static org.apache.flink.util.ExceptionUtils.findThrowableWithMessage;
 import static org.apache.flink.util.Preconditions.checkArgument;
 import static org.apache.flink.util.Preconditions.checkNotNull;
 import static org.junit.Assert.assertTrue;
@@ -96,7 +98,23 @@ public class NettyTestUtil {
     }
 
     static NettyServerAndClient initServerAndClient(NettyProtocol protocol) throws Exception {
-        return initServerAndClient(protocol, createConfig());
+        // It is possible that between checking a port available and binding to the port something
+        // takes this port. So we initialize a server in the loop to decrease the probability of it.
+        int attempts = 42; // The arbitrary number of attempts to avoid an infinity loop.
+        while (true) {
+            try {
+                return initServerAndClient(protocol, createConfig());
+            } catch (Exception ex) {
+                if (!(ex instanceof BindException)
+                        && !findThrowableWithMessage(ex, "Address already in use").isPresent()) {
+                    throw ex;
+                }
+
+                if (attempts-- < 0) {
+                    throw new Exception("Failed to initialize netty server and client", ex);
+                }
+            }
+        }
     }
 
     static NettyServerAndClient initServerAndClient(NettyProtocol protocol, NettyConfig config)
