diff --git a/flink-python/pyflink/fn_execution/table/operations.py b/flink-python/pyflink/fn_execution/table/operations.py
index 3f4069f7ba4..8dc2485c1f3 100644
--- a/flink-python/pyflink/fn_execution/table/operations.py
+++ b/flink-python/pyflink/fn_execution/table/operations.py
@@ -365,7 +365,11 @@ class AbstractStreamGroupAggregateOperation(BaseStatefulOperation):
                 row = input_data[1]
             self.group_agg_function.process_element(row)
         else:
-            self.group_agg_function.on_timer(input_data[3])
+            if has_cython:
+                timer = InternalRow.from_row(input_data[3])
+            else:
+                timer = input_data[3]
+            self.group_agg_function.on_timer(timer)
 
     @abc.abstractmethod
     def create_process_function(self, user_defined_aggs, input_extractors, filter_args,
diff --git a/flink-python/pyflink/table/tests/test_udaf.py b/flink-python/pyflink/table/tests/test_udaf.py
index 1b79603b12c..2fe4948bcd3 100644
--- a/flink-python/pyflink/table/tests/test_udaf.py
+++ b/flink-python/pyflink/table/tests/test_udaf.py
@@ -506,6 +506,28 @@ class StreamTableAggregateTests(PyFlinkStreamTableTestCase):
                                          ["hello.hello2", "", "hello,hello2", "hello"]],
                                         columns=['a', 'b', 'c', 'd']))
 
+    def test_clean_state(self):
+        self.t_env.register_function("my_count", CountAggregateFunction())
+        self.t_env.get_config().get_configuration().set_string("parallelism.default", "1")
+        self.t_env.get_config().get_configuration().set_string(
+            "python.fn-execution.bundle.size", "1")
+        self.t_env.get_config().get_configuration().set_string(
+            "python.state.cache-size", "0")
+        self.t_env.get_config().get_configuration().set_string(
+            "table.exec.state.ttl", "2ms")
+
+        self.t_env.execute_sql("""
+            CREATE TABLE test_source (
+                a BIGINT
+            ) WITH (
+              'connector' = 'datagen',
+              'number-of-rows' = '5',
+              'rows-per-second' = '1'
+            )
+        """)
+        t = self.t_env.from_path('test_source')
+        t.select("my_count(a) as a").to_pandas()
+
     def test_tumbling_group_window_over_time(self):
         # create source file path
         tmp_dir = self.tempdir
