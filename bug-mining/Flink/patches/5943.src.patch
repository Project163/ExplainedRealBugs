diff --git a/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/graph/TestEventSource.java b/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/graph/TestEventSource.java
index 0d32de9cff7..1badb6abef1 100644
--- a/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/graph/TestEventSource.java
+++ b/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/graph/TestEventSource.java
@@ -73,7 +73,8 @@ class TestEventSource extends RichSourceFunction<TestDataElement>
     public void run(SourceContext<TestDataElement> ctx) {
         long lastSent = 0;
         while (isRunning) {
-            TestCommand cmd = scheduledCommands.poll();
+            // Don't finish the source if it has not sent at least one value.
+            TestCommand cmd = lastSent == 0 ? null : scheduledCommands.poll();
             if (cmd == FINISH_SOURCES) {
                 ack(cmd);
                 isRunning = false;
