diff --git a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBResourceContainer.java b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBResourceContainer.java
index 5a187fc40bb..a5e2e8f2b1a 100644
--- a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBResourceContainer.java
+++ b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBResourceContainer.java
@@ -89,6 +89,10 @@ public final class RocksDBResourceContainer implements AutoCloseable {
 		// add necessary default options
 		opt = opt.setCreateIfMissing(true);
 
+		if (sharedResources != null) {
+			opt.setWriteBufferManager(sharedResources.getResourceHandle().getWriteBufferManager());
+		}
+
 		return opt;
 	}
 
diff --git a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBStateBackend.java b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBStateBackend.java
index 1984062d9b8..ba48835e194 100644
--- a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBStateBackend.java
+++ b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBStateBackend.java
@@ -55,7 +55,6 @@ import org.apache.flink.util.TernaryBoolean;
 import org.rocksdb.BlockBasedTableConfig;
 import org.rocksdb.Cache;
 import org.rocksdb.ColumnFamilyOptions;
-import org.rocksdb.DBOptions;
 import org.rocksdb.NativeLibraryLoader;
 import org.rocksdb.RocksDB;
 import org.rocksdb.TableFormatConfig;
@@ -509,7 +508,6 @@ public class RocksDBStateBackend extends AbstractStateBackend implements Configu
 
 		final RocksDBResourceContainer resourceContainer = createOptionsAndResourceContainer(sharedResources);
 
-		final DBOptions dbOptions = resourceContainer.getDbOptions();
 		final Function<String, ColumnFamilyOptions> createColumnOptions;
 
 		if (sharedResources != null) {
@@ -518,8 +516,6 @@ public class RocksDBStateBackend extends AbstractStateBackend implements Configu
 			final RocksDBSharedResources rocksResources = sharedResources.getResourceHandle();
 			final Cache blockCache = rocksResources.getCache();
 
-			dbOptions.setWriteBufferManager(rocksResources.getWriteBufferManager());
-
 			createColumnOptions = stateName -> {
 				ColumnFamilyOptions columnOptions = resourceContainer.getColumnOptions();
 				TableFormatConfig tableFormatConfig = columnOptions.tableFormatConfig();
diff --git a/flink-state-backends/flink-statebackend-rocksdb/src/test/java/org/apache/flink/contrib/streaming/state/RocksDBResourceContainerTest.java b/flink-state-backends/flink-statebackend-rocksdb/src/test/java/org/apache/flink/contrib/streaming/state/RocksDBResourceContainerTest.java
index bad29c9c943..ec590775d6a 100644
--- a/flink-state-backends/flink-statebackend-rocksdb/src/test/java/org/apache/flink/contrib/streaming/state/RocksDBResourceContainerTest.java
+++ b/flink-state-backends/flink-statebackend-rocksdb/src/test/java/org/apache/flink/contrib/streaming/state/RocksDBResourceContainerTest.java
@@ -32,10 +32,13 @@ import org.rocksdb.NativeLibraryLoader;
 import org.rocksdb.WriteBufferManager;
 
 import java.io.IOException;
+import java.lang.reflect.Field;
 import java.util.ArrayList;
+import java.util.HashSet;
 
 import static org.hamcrest.CoreMatchers.is;
 import static org.hamcrest.MatcherAssert.assertThat;
+import static org.junit.Assert.fail;
 
 /**
  * Tests to guard {@link RocksDBResourceContainer}.
@@ -75,6 +78,47 @@ public class RocksDBResourceContainerTest {
 		}
 	}
 
+	@Test
+	public void testSharedResources() throws Exception {
+		final int optionNumber = 20;
+		final long cacheSize = 1024L, writeBufferSize = 512L;
+		final LRUCache cache = new LRUCache(cacheSize, -1, false, 0.1);
+		final WriteBufferManager wbm = new WriteBufferManager(writeBufferSize, cache);
+		RocksDBSharedResources rocksDBSharedResources = new RocksDBSharedResources(cache, wbm);
+		OpaqueMemoryResource<RocksDBSharedResources> sharedResources =
+			new OpaqueMemoryResource<>(rocksDBSharedResources, cacheSize, rocksDBSharedResources::close);
+		RocksDBResourceContainer container =
+			new RocksDBResourceContainer(PredefinedOptions.DEFAULT, null, sharedResources);
+		HashSet<WriteBufferManager> writeBufferManagers = new HashSet<>();
+		for (int i = 0; i < optionNumber; i++) {
+			DBOptions dbOptions = container.getDbOptions();
+			WriteBufferManager writeBufferManager = getWriteBufferManager(dbOptions);
+			writeBufferManagers.add(writeBufferManager);
+		}
+		assertThat(writeBufferManagers.size(), is(1));
+		assertThat(writeBufferManagers.iterator().next(), is(rocksDBSharedResources.getWriteBufferManager()));
+		container.close();
+		assertThat(rocksDBSharedResources.getCache().isOwningHandle(), is(false));
+		assertThat(rocksDBSharedResources.getWriteBufferManager().isOwningHandle(), is(false));
+	}
+
+	private WriteBufferManager getWriteBufferManager(DBOptions dbOptions) {
+
+		Field writeBufferManagerField = null;
+		try {
+			writeBufferManagerField = DBOptions.class.getDeclaredField("writeBufferManager_");
+		} catch (NoSuchFieldException e) {
+			fail("writeBufferManager_ is not defined.");
+		}
+		writeBufferManagerField.setAccessible(true);
+		try {
+			return (WriteBufferManager) writeBufferManagerField.get(dbOptions);
+		} catch (IllegalAccessException e) {
+			fail("Cannot access writeBufferManager_ field.");
+			return null;
+		}
+	}
+
 	@Test
 	public void testFreeColumnOptionsAfterClose() throws Exception {
 		RocksDBResourceContainer container = new RocksDBResourceContainer();
