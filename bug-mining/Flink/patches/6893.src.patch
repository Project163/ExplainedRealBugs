diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/adaptivebatch/AdaptiveBatchSchedulerFactory.java b/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/adaptivebatch/AdaptiveBatchSchedulerFactory.java
index 73712faeacc..37a7d1801e5 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/adaptivebatch/AdaptiveBatchSchedulerFactory.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/adaptivebatch/AdaptiveBatchSchedulerFactory.java
@@ -20,10 +20,10 @@
 package org.apache.flink.runtime.scheduler.adaptivebatch;
 
 import org.apache.flink.api.common.BatchShuffleMode;
+import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.time.Time;
 import org.apache.flink.configuration.BatchExecutionOptions;
 import org.apache.flink.configuration.Configuration;
-import org.apache.flink.configuration.CoreOptions;
 import org.apache.flink.configuration.ExecutionOptions;
 import org.apache.flink.configuration.JobManagerOptions;
 import org.apache.flink.configuration.JobManagerOptions.HybridPartitionDataConsumeConstraint;
@@ -138,11 +138,12 @@ public class AdaptiveBatchSchedulerFactory implements SchedulerNGFactory {
         final ExecutionSlotAllocatorFactory allocatorFactory =
                 createExecutionSlotAllocatorFactory(jobMasterConfiguration, slotPool);
 
+        ExecutionConfig executionConfig =
+                jobGraph.getSerializedExecutionConfig().deserializeValue(userCodeLoader);
+
         final RestartBackoffTimeStrategy restartBackoffTimeStrategy =
                 RestartBackoffTimeStrategyFactoryLoader.createRestartBackoffTimeStrategyFactory(
-                                jobGraph.getSerializedExecutionConfig()
-                                        .deserializeValue(userCodeLoader)
-                                        .getRestartStrategy(),
+                                executionConfig.getRestartStrategy(),
                                 jobMasterConfiguration,
                                 jobGraph.isCheckpointingEnabled())
                         .create();
@@ -173,16 +174,7 @@ public class AdaptiveBatchSchedulerFactory implements SchedulerNGFactory {
                         loadInputConsumableDeciderFactory(hybridPartitionDataConsumeConstraint));
 
         int defaultMaxParallelism =
-                jobMasterConfiguration
-                        .getOptional(
-                                BatchExecutionOptions.ADAPTIVE_AUTO_PARALLELISM_MAX_PARALLELISM)
-                        .orElse(
-                                jobMasterConfiguration
-                                        .getOptional(CoreOptions.DEFAULT_PARALLELISM)
-                                        .orElse(
-                                                BatchExecutionOptions
-                                                        .ADAPTIVE_AUTO_PARALLELISM_MAX_PARALLELISM
-                                                        .defaultValue()));
+                getDefaultMaxParallelism(jobMasterConfiguration, executionConfig);
 
         if (enableSpeculativeExecution) {
             return new SpeculativeScheduler(
@@ -209,7 +201,8 @@ public class AdaptiveBatchSchedulerFactory implements SchedulerNGFactory {
                     executionGraphFactory,
                     shuffleMaster,
                     rpcTimeout,
-                    DefaultVertexParallelismAndInputInfosDecider.from(jobMasterConfiguration),
+                    DefaultVertexParallelismAndInputInfosDecider.from(
+                            defaultMaxParallelism, jobMasterConfiguration),
                     defaultMaxParallelism,
                     blocklistOperations,
                     hybridPartitionDataConsumeConstraint);
@@ -238,7 +231,8 @@ public class AdaptiveBatchSchedulerFactory implements SchedulerNGFactory {
                     executionGraphFactory,
                     shuffleMaster,
                     rpcTimeout,
-                    DefaultVertexParallelismAndInputInfosDecider.from(jobMasterConfiguration),
+                    DefaultVertexParallelismAndInputInfosDecider.from(
+                            defaultMaxParallelism, jobMasterConfiguration),
                     defaultMaxParallelism,
                     hybridPartitionDataConsumeConstraint);
         }
@@ -325,6 +319,17 @@ public class AdaptiveBatchSchedulerFactory implements SchedulerNGFactory {
         }
     }
 
+    static int getDefaultMaxParallelism(
+            Configuration configuration, ExecutionConfig executionConfig) {
+        return configuration
+                .getOptional(BatchExecutionOptions.ADAPTIVE_AUTO_PARALLELISM_MAX_PARALLELISM)
+                .orElse(
+                        executionConfig.getParallelism() == ExecutionConfig.PARALLELISM_DEFAULT
+                                ? BatchExecutionOptions.ADAPTIVE_AUTO_PARALLELISM_MAX_PARALLELISM
+                                        .defaultValue()
+                                : executionConfig.getParallelism());
+    }
+
     @Override
     public JobManagerOptions.SchedulerType getSchedulerType() {
         return JobManagerOptions.SchedulerType.AdaptiveBatch;
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/adaptivebatch/DefaultVertexParallelismAndInputInfosDecider.java b/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/adaptivebatch/DefaultVertexParallelismAndInputInfosDecider.java
index 52defc9ce73..00a8eb467c5 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/adaptivebatch/DefaultVertexParallelismAndInputInfosDecider.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/adaptivebatch/DefaultVertexParallelismAndInputInfosDecider.java
@@ -457,10 +457,10 @@ public class DefaultVertexParallelismAndInputInfosDecider
                 .collect(Collectors.toList());
     }
 
-    static DefaultVertexParallelismAndInputInfosDecider from(Configuration configuration) {
+    static DefaultVertexParallelismAndInputInfosDecider from(
+            int maxParallelism, Configuration configuration) {
         return new DefaultVertexParallelismAndInputInfosDecider(
-                configuration.getInteger(
-                        BatchExecutionOptions.ADAPTIVE_AUTO_PARALLELISM_MAX_PARALLELISM),
+                maxParallelism,
                 configuration.getInteger(
                         BatchExecutionOptions.ADAPTIVE_AUTO_PARALLELISM_MIN_PARALLELISM),
                 configuration.get(
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/adaptivebatch/AdaptiveBatchSchedulerFactoryTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/adaptivebatch/AdaptiveBatchSchedulerFactoryTest.java
index 46d1e3f221a..5a61a6bdbc0 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/adaptivebatch/AdaptiveBatchSchedulerFactoryTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/adaptivebatch/AdaptiveBatchSchedulerFactoryTest.java
@@ -18,6 +18,7 @@
 
 package org.apache.flink.runtime.scheduler.adaptivebatch;
 
+import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.configuration.JobManagerOptions;
 import org.apache.flink.configuration.JobManagerOptions.HybridPartitionDataConsumeConstraint;
@@ -64,6 +65,17 @@ class AdaptiveBatchSchedulerFactoryTest {
                 ALL_PRODUCERS_FINISHED, AllFinishedInputConsumableDecider.Factory.INSTANCE);
     }
 
+    @Test
+    void testMaxParallelismFallsBackToExecutionConfigDefaultParallelism() {
+        Configuration configuration = new Configuration();
+        ExecutionConfig executionConfig = new ExecutionConfig();
+        executionConfig.setParallelism(5);
+        assertThat(
+                        AdaptiveBatchSchedulerFactory.getDefaultMaxParallelism(
+                                configuration, executionConfig))
+                .isEqualTo(5);
+    }
+
     private void assertAndLoadInputConsumableDecider(
             HybridPartitionDataConsumeConstraint hybridPartitionDataConsumeConstraint,
             InputConsumableDecider.Factory expectedFactory) {
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/adaptivebatch/DefaultVertexParallelismAndInputInfosDeciderTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/adaptivebatch/DefaultVertexParallelismAndInputInfosDeciderTest.java
index 0737097c5bf..90f2287c050 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/adaptivebatch/DefaultVertexParallelismAndInputInfosDeciderTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/adaptivebatch/DefaultVertexParallelismAndInputInfosDeciderTest.java
@@ -435,8 +435,6 @@ class DefaultVertexParallelismAndInputInfosDeciderTest {
                     int minParallelism, int maxParallelism, long dataVolumePerTask) {
         Configuration configuration = new Configuration();
 
-        configuration.setInteger(
-                BatchExecutionOptions.ADAPTIVE_AUTO_PARALLELISM_MAX_PARALLELISM, maxParallelism);
         configuration.setInteger(
                 BatchExecutionOptions.ADAPTIVE_AUTO_PARALLELISM_MIN_PARALLELISM, minParallelism);
         configuration.set(
@@ -446,7 +444,7 @@ class DefaultVertexParallelismAndInputInfosDeciderTest {
                 BatchExecutionOptions.ADAPTIVE_AUTO_PARALLELISM_DEFAULT_SOURCE_PARALLELISM,
                 DEFAULT_SOURCE_PARALLELISM);
 
-        return DefaultVertexParallelismAndInputInfosDecider.from(configuration);
+        return DefaultVertexParallelismAndInputInfosDecider.from(maxParallelism, configuration);
     }
 
     private AllToAllBlockingResultInfo createAllToAllBlockingResultInfo(
