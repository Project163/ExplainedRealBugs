diff --git a/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/connector/kafka/sink/KafkaWriterITCase.java b/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/connector/kafka/sink/KafkaWriterITCase.java
index f972de49f7e..3bcd98a29c0 100644
--- a/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/connector/kafka/sink/KafkaWriterITCase.java
+++ b/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/connector/kafka/sink/KafkaWriterITCase.java
@@ -232,7 +232,7 @@ public class KafkaWriterITCase {
                 writer.write(1, SINK_WRITER_CONTEXT);
                 expected.add("testMetadataPublisher-0@" + i);
             }
-            writer.prepareCommit();
+            writer.flush(false);
             assertThat(metadataList).usingRecursiveComparison().isEqualTo(expected);
         }
     }
