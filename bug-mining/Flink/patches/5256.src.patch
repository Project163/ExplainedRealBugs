diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/calls/ScalarOperatorGens.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/calls/ScalarOperatorGens.scala
index 744db780550..8172290eb13 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/calls/ScalarOperatorGens.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/calls/ScalarOperatorGens.scala
@@ -1836,7 +1836,14 @@ object ScalarOperatorGens {
 
     val mapTerm = map.resultTerm
 
-    val equal = generateEquals(ctx, key, GeneratedExpression(tmpKey, NEVER_NULL, NO_CODE, keyType))
+    val equal = generateEquals(
+      ctx,
+      // We have to create a new GeneratedExpression from `key`, but erase the code of it.
+      // Otherwise, the code of `key` will be called twice in `accessCode`, which may lead to
+      // exceptions such as 'Redefinition of local variable'.
+      GeneratedExpression(key.resultTerm, key.nullTerm, NO_CODE, key.resultType, key.literalValue),
+      GeneratedExpression(tmpKey, NEVER_NULL, NO_CODE, keyType)
+    )
     val code =
       s"""
          |if ($mapTerm instanceof $BINARY_MAP) {
diff --git a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/expressions/MapTypeTest.scala b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/expressions/MapTypeTest.scala
index 94e1b4dac18..9b354a7fa61 100644
--- a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/expressions/MapTypeTest.scala
+++ b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/expressions/MapTypeTest.scala
@@ -45,6 +45,7 @@ class MapTypeTest extends MapTypeTestBase {
     testSqlApi("f2['b']", "13")
     testSqlApi("f3[1]", "null")
     testSqlApi("f3[12]", "a")
+    testSqlApi("f2[f3[12]]", "12")
   }
 
   @Test
