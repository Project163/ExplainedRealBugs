diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/state/SnapshotDirectoryTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/state/SnapshotDirectoryTest.java
index 76158b894ad..392e8443111 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/state/SnapshotDirectoryTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/state/SnapshotDirectoryTest.java
@@ -23,6 +23,7 @@ import org.apache.flink.configuration.CoreOptions;
 import org.apache.flink.core.fs.FileSystem;
 import org.apache.flink.core.fs.Path;
 import org.apache.flink.util.TestLogger;
+
 import org.junit.AfterClass;
 import org.junit.Assert;
 import org.junit.BeforeClass;
@@ -34,6 +35,9 @@ import java.io.IOException;
 import java.util.Arrays;
 import java.util.UUID;
 
+/**
+ * Tests for the {@link SnapshotDirectory}.
+ */
 public class SnapshotDirectoryTest extends TestLogger {
 
 	private static TemporaryFolder temporaryFolder;
@@ -81,29 +85,13 @@ public class SnapshotDirectoryTest extends TestLogger {
 		File folderA = new File(folderRoot, String.valueOf(UUID.randomUUID()));
 
 		Assert.assertFalse(folderA.isDirectory());
-		Path pathA = new Path(folderA.toURI());
-		SnapshotDirectory snapshotDirectoryA = SnapshotDirectory.permanent(pathA);
-		Assert.assertFalse(snapshotDirectoryA.exists());
+		Path path = new Path(folderA.toURI());
+		SnapshotDirectory snapshotDirectory = SnapshotDirectory.permanent(path);
+		Assert.assertFalse(snapshotDirectory.exists());
 		Assert.assertTrue(folderA.mkdirs());
-		Assert.assertTrue(snapshotDirectoryA.exists());
+		Assert.assertTrue(snapshotDirectory.exists());
 		Assert.assertTrue(folderA.delete());
-		Assert.assertFalse(snapshotDirectoryA.exists());
-
-		// ensure that snapshot directory will always use the local file system instead of the default file system
-		Configuration configuration = new Configuration();
-		configuration.setString(CoreOptions.DEFAULT_FILESYSTEM_SCHEME, "nonexistfs:///");
-		FileSystem.initialize(configuration);
-		File folderB = new File(folderRoot, String.valueOf(UUID.randomUUID()));
-		// only pass the path and leave the scheme missing
-		SnapshotDirectory snapshotDirectoryB = SnapshotDirectory.temporary(folderB);
-		Assert.assertTrue(snapshotDirectoryB.getFileSystem().equals(FileSystem.getLocalFileSystem()));
-		Assert.assertFalse(snapshotDirectoryB.exists());
-		Assert.assertTrue(folderB.mkdirs());
-		Assert.assertTrue(snapshotDirectoryB.exists());
-		Assert.assertTrue(folderB.delete());
-		Assert.assertFalse(snapshotDirectoryB.exists());
-		// restore the FileSystem configuration
-		FileSystem.initialize(new Configuration());
+		Assert.assertFalse(snapshotDirectory.exists());
 	}
 
 	/**
@@ -220,4 +208,28 @@ public class SnapshotDirectoryTest extends TestLogger {
 		Assert.assertFalse(folder.exists());
 	}
 
+	/**
+	 * Tests that we always use the local file system even if we have specified a different default
+	 * file system. See FLINK-12042.
+	 */
+	@Test
+	public void testLocalFileSystemIsUsedForTemporary() throws Exception {
+		// ensure that snapshot directory will always use the local file system instead of the default file system
+		Configuration configuration = new Configuration();
+		configuration.setString(CoreOptions.DEFAULT_FILESYSTEM_SCHEME, "nonexistfs:///");
+		FileSystem.initialize(configuration);
+
+		final File folderRoot = temporaryFolder.getRoot();
+
+		try {
+			File folderB = new File(folderRoot, String.valueOf(UUID.randomUUID()));
+			// only pass the path and leave the scheme missing
+			SnapshotDirectory snapshotDirectoryB = SnapshotDirectory.temporary(folderB);
+			Assert.assertEquals(snapshotDirectoryB.getFileSystem(), FileSystem.getLocalFileSystem());
+		} finally {
+			// restore the FileSystem configuration
+			FileSystem.initialize(new Configuration());
+		}
+	}
+
 }
