diff --git a/flink-end-to-end-tests/flink-end-to-end-tests-common/src/main/java/org/apache/flink/tests/util/flink/FlinkContainer.java b/flink-end-to-end-tests/flink-end-to-end-tests-common/src/main/java/org/apache/flink/tests/util/flink/FlinkContainer.java
index 3034bf2f97b..e49a57ce528 100644
--- a/flink-end-to-end-tests/flink-end-to-end-tests-common/src/main/java/org/apache/flink/tests/util/flink/FlinkContainer.java
+++ b/flink-end-to-end-tests/flink-end-to-end-tests-common/src/main/java/org/apache/flink/tests/util/flink/FlinkContainer.java
@@ -18,12 +18,16 @@
 
 package org.apache.flink.tests.util.flink;
 
+import org.apache.flink.client.deployment.StandaloneClusterId;
+import org.apache.flink.client.program.rest.RestClusterClient;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.configuration.GlobalConfiguration;
+import org.apache.flink.configuration.RestOptions;
 import org.apache.flink.runtime.rest.messages.taskmanager.TaskManagersInfo;
 import org.apache.flink.tests.util.parameters.ParameterProperty;
 import org.apache.flink.tests.util.util.FileUtils;
 import org.apache.flink.util.IOUtils;
+import org.apache.flink.util.function.RunnableWithException;
 
 import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.core.JsonProcessingException;
 import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.ObjectMapper;
@@ -62,6 +66,8 @@ import java.util.concurrent.TimeUnit;
 import java.util.stream.Collectors;
 import java.util.stream.IntStream;
 
+import static org.apache.flink.util.Preconditions.checkState;
+
 /**
  * A container that wraps a Flink distribution and spawns a Flink cluster in a single Docker
  * container.
@@ -77,6 +83,8 @@ public class FlinkContainer extends GenericContainer<FlinkContainer> implements
     private final Path logBackupDir;
     private final int numTaskManagers;
 
+    @Nullable private RestClusterClient<StandaloneClusterId> restClusterClient;
+
     private FlinkContainer(
             ImageFromDockerfile image, int numTaskManagers, @Nullable Path logBackupDir) {
         super(image);
@@ -126,6 +134,38 @@ public class FlinkContainer extends GenericContainer<FlinkContainer> implements
         temporaryFolder.delete();
     }
 
+    @Override
+    public void stop() {
+        if (restClusterClient != null) {
+            restClusterClient.close();
+        }
+        super.stop();
+    }
+
+    /**
+     * Get {@link RestClusterClient} connected to this FlinkContainer.
+     *
+     * <p>This method lazily initializes the REST client on-demand.
+     */
+    public RestClusterClient<StandaloneClusterId> getRestClusterClient() {
+        if (restClusterClient != null) {
+            return restClusterClient;
+        }
+        checkState(
+                this.isRunning(), "Cluster client should only be retrieved for a running cluster");
+        try {
+            final Configuration clientConfiguration = new Configuration();
+            clientConfiguration.set(RestOptions.ADDRESS, getHost());
+            clientConfiguration.set(RestOptions.PORT, getMappedPort(JOB_MANAGER_REST_PORT));
+            this.restClusterClient =
+                    new RestClusterClient<>(clientConfiguration, StandaloneClusterId.getInstance());
+        } catch (Exception e) {
+            throw new IllegalStateException(
+                    "Failed to create client for FlinkContainer cluster", e);
+        }
+        return restClusterClient;
+    }
+
     /**
      * Copies a container path to a local directory. In contrast to {@link
      * GenericContainer#copyFileFromContainer(String, String)} it supports copying whole
@@ -206,7 +246,7 @@ public class FlinkContainer extends GenericContainer<FlinkContainer> implements
      * @param afterFailAction Action to do between stopping and restarting task managers
      * @throws Exception If anything wrong happens during the restart
      */
-    public void restartTaskManager(Runnable afterFailAction) throws Exception {
+    public void restartTaskManager(RunnableWithException afterFailAction) throws Exception {
         final String[] stopCommand = {FLINK_BIN + "/taskmanager.sh", "stop-all"};
         final ExecResult stopResult = execInContainer(stopCommand);
         checkExitCode(stopResult, stopCommand);
diff --git a/flink-end-to-end-tests/flink-end-to-end-tests-common/src/main/java/org/apache/flink/tests/util/flink/FlinkContainerTestEnvironment.java b/flink-end-to-end-tests/flink-end-to-end-tests-common/src/main/java/org/apache/flink/tests/util/flink/FlinkContainerTestEnvironment.java
index fc1b5d93e0d..070bd8235f3 100644
--- a/flink-end-to-end-tests/flink-end-to-end-tests-common/src/main/java/org/apache/flink/tests/util/flink/FlinkContainerTestEnvironment.java
+++ b/flink-end-to-end-tests/flink-end-to-end-tests-common/src/main/java/org/apache/flink/tests/util/flink/FlinkContainerTestEnvironment.java
@@ -18,7 +18,6 @@
 
 package org.apache.flink.tests.util.flink;
 
-import org.apache.flink.api.common.JobStatus;
 import org.apache.flink.api.common.time.Deadline;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.connectors.test.common.environment.ClusterControllable;
@@ -28,7 +27,6 @@ import org.apache.flink.runtime.testutils.CommonTestUtils;
 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
 
 import java.time.Duration;
-import java.util.Arrays;
 
 import static org.apache.flink.configuration.HeartbeatManagerOptions.HEARTBEAT_INTERVAL;
 import static org.apache.flink.configuration.HeartbeatManagerOptions.HEARTBEAT_TIMEOUT;
@@ -88,16 +86,13 @@ public class FlinkContainerTestEnvironment implements TestEnvironment, ClusterCo
             throws Exception {
         flinkContainer.restartTaskManager(
                 () -> {
-                    try {
-                        CommonTestUtils.waitForJobStatus(
-                                jobClient,
-                                Arrays.asList(
-                                        JobStatus.FAILING, JobStatus.FAILED, JobStatus.RESTARTING),
-                                Deadline.fromNow(Duration.ofSeconds(30)));
-                    } catch (Exception e) {
-                        throw new RuntimeException(
-                                "Error waiting for job entering failure status", e);
-                    }
+                    CommonTestUtils.waitForNoTaskRunning(
+                            () ->
+                                    flinkContainer
+                                            .getRestClusterClient()
+                                            .getJobDetails(jobClient.getJobID())
+                                            .get(),
+                            Deadline.fromNow(Duration.ofMinutes(5)));
                     afterFailAction.run();
                 });
     }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/testutils/CommonTestUtils.java b/flink-runtime/src/test/java/org/apache/flink/runtime/testutils/CommonTestUtils.java
index 7af67255d3f..1c459f87354 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/testutils/CommonTestUtils.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/testutils/CommonTestUtils.java
@@ -28,6 +28,7 @@ import org.apache.flink.runtime.executiongraph.AccessExecutionVertex;
 import org.apache.flink.runtime.executiongraph.ErrorInfo;
 import org.apache.flink.runtime.jobgraph.JobVertexID;
 import org.apache.flink.runtime.minicluster.MiniCluster;
+import org.apache.flink.runtime.rest.messages.job.JobDetailsInfo;
 import org.apache.flink.util.FileUtils;
 import org.apache.flink.util.function.SupplierWithException;
 
@@ -44,6 +45,7 @@ import java.time.Duration;
 import java.time.temporal.ChronoUnit;
 import java.util.Arrays;
 import java.util.List;
+import java.util.Map;
 import java.util.concurrent.TimeUnit;
 import java.util.concurrent.TimeoutException;
 import java.util.function.Predicate;
@@ -226,6 +228,20 @@ public class CommonTestUtils {
                 timeout);
     }
 
+    public static void waitForNoTaskRunning(
+            SupplierWithException<JobDetailsInfo, Exception> jobDetailsSupplier, Deadline timeout)
+            throws Exception {
+        waitUntilCondition(
+                () -> {
+                    final Map<ExecutionState, Integer> state =
+                            jobDetailsSupplier.get().getJobVerticesPerState();
+                    final Integer numRunningTasks = state.get(ExecutionState.RUNNING);
+                    return numRunningTasks == null || numRunningTasks.equals(0);
+                },
+                timeout,
+                "Some tasks are still running until timeout");
+    }
+
     public static void waitUntilJobManagerIsInitialized(
             SupplierWithException<JobStatus, Exception> jobStatusSupplier) throws Exception {
         waitUntilJobManagerIsInitialized(
diff --git a/flink-test-utils-parent/flink-connector-testing/src/main/java/org/apache/flink/connectors/test/common/environment/MiniClusterTestEnvironment.java b/flink-test-utils-parent/flink-connector-testing/src/main/java/org/apache/flink/connectors/test/common/environment/MiniClusterTestEnvironment.java
index 097b5c35b0e..4c9c03ca021 100644
--- a/flink-test-utils-parent/flink-connector-testing/src/main/java/org/apache/flink/connectors/test/common/environment/MiniClusterTestEnvironment.java
+++ b/flink-test-utils-parent/flink-connector-testing/src/main/java/org/apache/flink/connectors/test/common/environment/MiniClusterTestEnvironment.java
@@ -19,7 +19,6 @@
 package org.apache.flink.connectors.test.common.environment;
 
 import org.apache.flink.annotation.Experimental;
-import org.apache.flink.api.common.JobStatus;
 import org.apache.flink.api.common.time.Deadline;
 import org.apache.flink.core.execution.JobClient;
 import org.apache.flink.runtime.highavailability.nonha.embedded.HaLeadershipControl;
@@ -33,7 +32,6 @@ import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
 import java.time.Duration;
-import java.util.Arrays;
 import java.util.Optional;
 import java.util.concurrent.ExecutionException;
 
@@ -41,12 +39,15 @@ import java.util.concurrent.ExecutionException;
 @Experimental
 public class MiniClusterTestEnvironment implements TestEnvironment, ClusterControllable {
 
+    private static final Logger LOG = LoggerFactory.getLogger(MiniClusterTestEnvironment.class);
+
+    // MiniCluster
     private final MiniClusterWithClientResource miniCluster;
 
+    // The index of current running TaskManager
     private int latestTMIndex = 0;
 
-    private static final Logger LOG = LoggerFactory.getLogger(MiniClusterTestEnvironment.class);
-
+    // Whether MiniCluster is running
     private boolean isStarted = false;
 
     public MiniClusterTestEnvironment() {
@@ -84,9 +85,8 @@ public class MiniClusterTestEnvironment implements TestEnvironment, ClusterContr
     public void triggerTaskManagerFailover(JobClient jobClient, Runnable afterFailAction)
             throws Exception {
         terminateTaskManager();
-        CommonTestUtils.waitForJobStatus(
-                jobClient,
-                Arrays.asList(JobStatus.FAILING, JobStatus.FAILED, JobStatus.RESTARTING),
+        CommonTestUtils.waitForNoTaskRunning(
+                () -> miniCluster.getRestClusterClient().getJobDetails(jobClient.getJobID()).get(),
                 Deadline.fromNow(Duration.ofMinutes(5)));
         afterFailAction.run();
         startTaskManager();
