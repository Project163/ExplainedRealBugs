diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/LookupJoinCodeGenerator.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/LookupJoinCodeGenerator.scala
index 96a35d6f64d..102bf598ca4 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/LookupJoinCodeGenerator.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/LookupJoinCodeGenerator.scala
@@ -397,6 +397,7 @@ object LookupJoinCodeGenerator {
           $input2TypeClass $collectedTerm = ($input2TypeClass) record;
           ${ctx.reuseLocalVariableCode()}
           ${ctx.reuseInputUnboxingCode()}
+          ${ctx.reusePerRecordCode()}
           $bodyCode
         }
 
diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/agg/AggsHandlerCodeGenerator.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/agg/AggsHandlerCodeGenerator.scala
index 05b9394f832..d6493fdf81f 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/agg/AggsHandlerCodeGenerator.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/agg/AggsHandlerCodeGenerator.scala
@@ -869,6 +869,7 @@ class AggsHandlerCodeGenerator(
 
     s"""
        |${ctx.reuseLocalVariableCode(methodName)}
+       |${ctx.reusePerRecordCode()}
        |${resultExpr.code}
        |return ${resultExpr.resultTerm};
     """.stripMargin
@@ -946,6 +947,7 @@ class AggsHandlerCodeGenerator(
       s"""
          |${ctx.reuseLocalVariableCode(methodName)}
          |${ctx.reuseInputUnboxingCode(ACCUMULATE_INPUT_TERM)}
+         |${ctx.reusePerRecordCode()}
          |$body
          |""".stripMargin
     } else {
@@ -970,6 +972,7 @@ class AggsHandlerCodeGenerator(
       s"""
          |${ctx.reuseLocalVariableCode(methodName)}
          |${ctx.reuseInputUnboxingCode(RETRACT_INPUT_TERM)}
+         |${ctx.reusePerRecordCode()}
          |$body
       """.stripMargin
     } else {
@@ -1005,6 +1008,7 @@ class AggsHandlerCodeGenerator(
       s"""
          |${ctx.reuseLocalVariableCode(methodName)}
          |${ctx.reuseInputUnboxingCode(MERGED_ACC_TERM)}
+         |${ctx.reusePerRecordCode()}
          |$body
       """.stripMargin
     } else {
diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/WindowCodeGenerator.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/WindowCodeGenerator.scala
index 4bf6408049d..a712e718e31 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/WindowCodeGenerator.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/WindowCodeGenerator.scala
@@ -553,6 +553,7 @@ abstract class WindowCodeGenerator(
          |  ${ctx.reuseLocalVariableCode()}
          |  // assign timestamp (pane/window)
          |  ${ctx.reuseInputUnboxingCode(inputTerm)}
+         |  ${ctx.reusePerRecordCode()}
          |  ${assignedTsExpr.code}
          |  $processEachInput
          |}
diff --git a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/LookupJoinITCase.scala b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/LookupJoinITCase.scala
index 9af88e21a61..653feff52e5 100644
--- a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/LookupJoinITCase.scala
+++ b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/LookupJoinITCase.scala
@@ -31,6 +31,7 @@ import org.junit.runners.Parameterized
 import org.junit.{After, Before, Test}
 
 import java.lang.{Boolean => JBoolean}
+import java.time.LocalDateTime
 import java.util.{Collection => JCollection}
 
 import scala.collection.JavaConversions._
@@ -511,6 +512,57 @@ class LookupJoinITCase(legacyTableSource: Boolean) extends StreamingTestBase {
       "3,15,Fabian,Fabian,33,34")
     assertEquals(expected.sorted, sink.getAppendResults.sorted)
   }
+
+  @Test
+  def testCurrentDateInJoinCondition(): Unit = {
+    val id1 = TestValuesTableFactory.registerData(
+      Seq(Row.of("abc", LocalDateTime.of(
+        2000, 1, 1, 0, 0))))
+    val ddl1 =
+      s"""
+         |CREATE TABLE Ta (
+         |  id VARCHAR,
+         |  ts TIMESTAMP,
+         |  proc AS PROCTIME()
+         |) WITH (
+         |  'connector' = 'values',
+         |  'data-id' = '$id1',
+         |  'bounded' = 'true'
+         |)
+         |""".stripMargin
+    tEnv.executeSql(ddl1)
+
+    val id2 = TestValuesTableFactory.registerData(
+      Seq(Row.of("abc", LocalDateTime.of(
+        2000, 1, 2, 0, 0))))
+    val ddl2 =
+      s"""
+         |CREATE TABLE Tb (
+         |  id VARCHAR,
+         |  ts TIMESTAMP
+         |) WITH (
+         |  'connector' = 'values',
+         |  'data-id' = '$id2',
+         |  'bounded' = 'true'
+         |)
+         |""".stripMargin
+    tEnv.executeSql(ddl2)
+
+    val sql =
+      """
+        |SELECT * FROM Ta AS t1
+        |INNER JOIN Tb FOR SYSTEM_TIME AS OF t1.proc AS t2
+        |ON t1.id = t2.id
+        |WHERE
+        |  CAST(coalesce(t1.ts, t2.ts) AS VARCHAR)
+        |  >=
+        |  CONCAT(CAST(CURRENT_DATE AS VARCHAR), ' 00:00:00')
+        |""".stripMargin
+    val sink = new TestingAppendSink
+    tEnv.sqlQuery(sql).toAppendStream[Row].addSink(sink)
+    env.execute()
+    assertEquals(Seq(), sink.getAppendResults)
+  }
 }
 
 object LookupJoinITCase {
