diff --git a/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/functions/FunctionDefinitionUtil.java b/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/functions/FunctionDefinitionUtil.java
index da798b6951b..374b138d7b2 100644
--- a/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/functions/FunctionDefinitionUtil.java
+++ b/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/functions/FunctionDefinitionUtil.java
@@ -45,7 +45,7 @@ public class FunctionDefinitionUtil {
 			return new TableFunctionDefinition(
 				name,
 				t,
-				t.getResultType()
+				UserDefinedFunctionHelper.getReturnTypeOfTableFunction(t)
 			);
 		} else if (udf instanceof AggregateFunction) {
 			AggregateFunction a = (AggregateFunction) udf;
@@ -53,8 +53,8 @@ public class FunctionDefinitionUtil {
 			return new AggregateFunctionDefinition(
 				name,
 				a,
-				a.getAccumulatorType(),
-				a.getResultType()
+				UserDefinedFunctionHelper.getAccumulatorTypeOfAggregateFunction(a),
+				UserDefinedFunctionHelper.getReturnTypeOfAggregateFunction(a)
 			);
 		} else if (udf instanceof TableAggregateFunction) {
 			TableAggregateFunction a = (TableAggregateFunction) udf;
@@ -62,8 +62,8 @@ public class FunctionDefinitionUtil {
 			return new TableAggregateFunctionDefinition(
 				name,
 				a,
-				a.getAccumulatorType(),
-				a.getResultType()
+				UserDefinedFunctionHelper.getAccumulatorTypeOfAggregateFunction(a),
+				UserDefinedFunctionHelper.getReturnTypeOfAggregateFunction(a)
 			);
 		} else {
 			throw new UnsupportedOperationException(
diff --git a/flink-table/flink-table-api-java/src/test/java/org/apache/flink/table/functions/FunctionDefinitionUtilTest.java b/flink-table/flink-table-api-java/src/test/java/org/apache/flink/table/functions/FunctionDefinitionUtilTest.java
index b37ed8be163..691734cc6af 100644
--- a/flink-table/flink-table-api-java/src/test/java/org/apache/flink/table/functions/FunctionDefinitionUtilTest.java
+++ b/flink-table/flink-table-api-java/src/test/java/org/apache/flink/table/functions/FunctionDefinitionUtilTest.java
@@ -40,32 +40,56 @@ public class FunctionDefinitionUtilTest {
 
 	@Test
 	public void testTableFunction() {
-		FunctionDefinition fd = FunctionDefinitionUtil.createFunctionDefinition(
+		FunctionDefinition fd1 = FunctionDefinitionUtil.createFunctionDefinition(
 			"test",
 			TestTableFunction.class.getName()
 		);
 
-		assertTrue(((TableFunctionDefinition) fd).getTableFunction() instanceof TestTableFunction);
+		assertTrue(((TableFunctionDefinition) fd1).getTableFunction() instanceof TestTableFunction);
+
+		FunctionDefinition fd2 = FunctionDefinitionUtil.createFunctionDefinition(
+				"test",
+				TestTableFunctionWithoutResultType.class.getName()
+		);
+
+		assertTrue(((TableFunctionDefinition) fd2).getTableFunction() instanceof TestTableFunctionWithoutResultType);
 	}
 
 	@Test
 	public void testAggregateFunction() {
-		FunctionDefinition fd = FunctionDefinitionUtil.createFunctionDefinition(
+		FunctionDefinition fd1 = FunctionDefinitionUtil.createFunctionDefinition(
 			"test",
 			TestAggFunction.class.getName()
 		);
 
-		assertTrue(((AggregateFunctionDefinition) fd).getAggregateFunction() instanceof TestAggFunction);
+		assertTrue(((AggregateFunctionDefinition) fd1).getAggregateFunction() instanceof TestAggFunction);
+
+		FunctionDefinition fd2 = FunctionDefinitionUtil.createFunctionDefinition(
+				"test",
+				TestAggFunctionWithoutResultType.class.getName()
+		);
+
+		assertTrue(((AggregateFunctionDefinition) fd2).getAggregateFunction()
+				instanceof TestAggFunctionWithoutResultType);
+
 	}
 
 	@Test
 	public void testTableAggregateFunction() {
-		FunctionDefinition fd = FunctionDefinitionUtil.createFunctionDefinition(
+		FunctionDefinition fd1 = FunctionDefinitionUtil.createFunctionDefinition(
 			"test",
 			TestTableAggFunction.class.getName()
 		);
 
-		assertTrue(((TableAggregateFunctionDefinition) fd).getTableAggregateFunction() instanceof TestTableAggFunction);
+		assertTrue(((TableAggregateFunctionDefinition) fd1).getTableAggregateFunction() instanceof TestTableAggFunction);
+
+		FunctionDefinition fd2 = FunctionDefinitionUtil.createFunctionDefinition(
+				"test",
+				TestTableAggFunctionWithoutResultType.class.getName()
+		);
+
+		assertTrue(((TableAggregateFunctionDefinition) fd2).getTableAggregateFunction()
+				instanceof TestTableAggFunctionWithoutResultType);
 	}
 
 	/**
@@ -85,6 +109,12 @@ public class FunctionDefinitionUtilTest {
 		}
 	}
 
+	/**
+	 * Test function.
+	 */
+	public static class TestTableFunctionWithoutResultType extends TableFunction<String> {
+	}
+
 	/**
 	 * Test function.
 	 */
@@ -110,6 +140,21 @@ public class FunctionDefinitionUtilTest {
 		}
 	}
 
+	/**
+	 * Test function.
+	 */
+	public static class TestAggFunctionWithoutResultType extends AggregateFunction<Long, Long> {
+		@Override
+		public Long createAccumulator() {
+			return null;
+		}
+
+		@Override
+		public Long getValue(Long accumulator) {
+			return null;
+		}
+	}
+
 	/**
 	 * Test function.
 	 */
@@ -129,4 +174,14 @@ public class FunctionDefinitionUtilTest {
 			return TypeInformation.of(Object.class);
 		}
 	}
+
+	/**
+	 * Test function.
+	 */
+	public static class TestTableAggFunctionWithoutResultType extends TableAggregateFunction<Long, Long> {
+		@Override
+		public Long createAccumulator() {
+			return null;
+		}
+	}
 }
