diff --git a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/ForStFlinkFileSystem.java b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/ForStFlinkFileSystem.java
index 7ee849d397f..7abde84b9af 100644
--- a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/ForStFlinkFileSystem.java
+++ b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/ForStFlinkFileSystem.java
@@ -55,6 +55,8 @@ import java.net.URI;
 import java.util.ArrayList;
 import java.util.List;
 
+import static org.apache.flink.state.forst.ForStConfigurableOptions.TARGET_FILE_SIZE_BASE;
+
 /**
  * A {@link FileSystem} delegates some requests to file system loaded by Flink FileSystem mechanism.
  *
@@ -68,8 +70,6 @@ public class ForStFlinkFileSystem extends FileSystem implements Closeable {
     // TODO: make it configurable
     private static final int DEFAULT_INPUT_STREAM_CAPACITY = 32;
 
-    private static final long SST_FILE_SIZE = 1024 * 1024 * 64;
-
     private final FileSystem localFS;
     private final FileSystem delegateFS;
     private final String remoteBase;
@@ -127,20 +127,21 @@ public class ForStFlinkFileSystem extends FileSystem implements Closeable {
             return null;
         }
         CacheLimitPolicy cacheLimitPolicy = null;
+        long targetSstFileSize = config.get(TARGET_FILE_SIZE_BASE).getBytes();
         if (cacheCapacity > 0 && cacheReservedSize >= 0) {
             cacheLimitPolicy =
                     new BundledCacheLimitPolicy(
-                            new SizeBasedCacheLimitPolicy(cacheCapacity),
+                            new SizeBasedCacheLimitPolicy(cacheCapacity, targetSstFileSize),
                             new SpaceBasedCacheLimitPolicy(
                                     new File(cacheBase.toString()),
                                     cacheReservedSize,
-                                    SST_FILE_SIZE));
+                                    targetSstFileSize));
         } else if (cacheCapacity > 0) {
-            cacheLimitPolicy = new SizeBasedCacheLimitPolicy(cacheCapacity);
+            cacheLimitPolicy = new SizeBasedCacheLimitPolicy(cacheCapacity, targetSstFileSize);
         } else if (cacheReservedSize >= 0) {
             cacheLimitPolicy =
                     new SpaceBasedCacheLimitPolicy(
-                            new File(cacheBase.toString()), cacheReservedSize, SST_FILE_SIZE);
+                            new File(cacheBase.toString()), cacheReservedSize, targetSstFileSize);
         }
         return new FileBasedCache(
                 config, cacheLimitPolicy, cacheBase.getFileSystem(), cacheBase, metricGroup);
diff --git a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/BundledCacheLimitPolicy.java b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/BundledCacheLimitPolicy.java
index bf5c3a30c63..a3bf9f05009 100644
--- a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/BundledCacheLimitPolicy.java
+++ b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/BundledCacheLimitPolicy.java
@@ -36,14 +36,19 @@ public class BundledCacheLimitPolicy implements CacheLimitPolicy {
         }
     }
 
+    @Override
+    public boolean directWriteInCache() {
+        return policies.stream().allMatch(CacheLimitPolicy::directWriteInCache);
+    }
+
     @Override
     public boolean isSafeToAdd(long toAddSize) {
         return policies.stream().allMatch(policy -> policy.isSafeToAdd(toAddSize));
     }
 
     @Override
-    public boolean isOverflow(long toAddSize) {
-        return policies.stream().anyMatch(policy -> policy.isOverflow(toAddSize));
+    public boolean isOverflow(long toAddSize, boolean hasFile) {
+        return policies.stream().anyMatch(policy -> policy.isOverflow(toAddSize, hasFile));
     }
 
     @Override
diff --git a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/CacheLimitPolicy.java b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/CacheLimitPolicy.java
index bf328111aef..24271d971e7 100644
--- a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/CacheLimitPolicy.java
+++ b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/CacheLimitPolicy.java
@@ -22,6 +22,10 @@ import org.apache.flink.metrics.MetricGroup;
 
 /** Cache limit policy. */
 public interface CacheLimitPolicy {
+
+    /** Whether to support directly write in cache. */
+    boolean directWriteInCache();
+
     /**
      * Whether the cache usage is safe to add.
      *
@@ -33,10 +37,11 @@ public interface CacheLimitPolicy {
     /**
      * Whether the cache usage is exceeded the upperbound.
      *
-     * @param toAddSize
+     * @param toAddSize the size about to add.
+     * @param hasFile whether the file is already in cache.
      * @return true if the cache usage is overflow, false otherwise.
      */
-    boolean isOverflow(long toAddSize);
+    boolean isOverflow(long toAddSize, boolean hasFile);
 
     /**
      * Acquire cache.
diff --git a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/CachedDataOutputStream.java b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/CachedDataOutputStream.java
index 51a781e7194..5f783250db0 100644
--- a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/CachedDataOutputStream.java
+++ b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/CachedDataOutputStream.java
@@ -24,6 +24,8 @@ import org.apache.flink.core.fs.Path;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
+import javax.annotation.Nullable;
+
 import java.io.IOException;
 import java.nio.ByteBuffer;
 
@@ -42,17 +44,17 @@ public class CachedDataOutputStream extends FSDataOutputStream {
     /** The path in cache. */
     private final Path cachePath;
 
-    private FSDataOutputStream cacheOutputStream;
+    @Nullable private FSDataOutputStream cacheOutputStream;
     private FSDataOutputStream originOutputStream;
 
     /** The reference of file cache. */
-    private FileBasedCache fileBasedCache;
+    private final FileBasedCache fileBasedCache;
 
     public CachedDataOutputStream(
             Path originalPath,
             Path cachePath,
             FSDataOutputStream originalOutputStream,
-            FSDataOutputStream cacheOutputStream,
+            @Nullable FSDataOutputStream cacheOutputStream,
             FileBasedCache cache) {
         this.originOutputStream = originalOutputStream;
         this.originalPath = originalPath;
@@ -64,58 +66,80 @@ public class CachedDataOutputStream extends FSDataOutputStream {
 
     @Override
     public long getPos() throws IOException {
-        return cacheOutputStream.getPos();
+        if (cacheOutputStream == null) {
+            return originOutputStream.getPos();
+        } else {
+            return cacheOutputStream.getPos();
+        }
     }
 
     @Override
     public void write(int b) throws IOException {
-        cacheOutputStream.write(b);
+        if (cacheOutputStream != null) {
+            cacheOutputStream.write(b);
+        }
         originOutputStream.write(b);
     }
 
     public void write(byte[] b) throws IOException {
-        cacheOutputStream.write(b);
+        if (cacheOutputStream != null) {
+            cacheOutputStream.write(b);
+        }
         originOutputStream.write(b);
     }
 
     @Override
     public void write(byte[] b, int off, int len) throws IOException {
-        cacheOutputStream.write(b, off, len);
+        if (cacheOutputStream != null) {
+            cacheOutputStream.write(b, off, len);
+        }
         originOutputStream.write(b, off, len);
     }
 
     @Override
     public void flush() throws IOException {
-        cacheOutputStream.flush();
+        if (cacheOutputStream != null) {
+            cacheOutputStream.flush();
+        }
         originOutputStream.flush();
     }
 
     @Override
     public void sync() throws IOException {
-        cacheOutputStream.sync();
+        if (cacheOutputStream != null) {
+            cacheOutputStream.sync();
+        }
         originOutputStream.sync();
     }
 
     @Override
     public void close() throws IOException {
+        long size = getPos();
         if (originOutputStream != null) {
             originOutputStream.close();
             originOutputStream = null;
         }
         if (cacheOutputStream != null) {
-            putIntoCache();
+            putIntoCache(size);
             cacheOutputStream.close();
             cacheOutputStream = null;
+        } else {
+            registerIntoCache(size);
         }
     }
 
-    private void putIntoCache() throws IOException {
-        long thisSize = cacheOutputStream.getPos();
+    private void putIntoCache(long size) {
         FileCacheEntry fileCacheEntry =
-                new FileCacheEntry(fileBasedCache, originalPath, cachePath, thisSize);
+                new FileCacheEntry(fileBasedCache, originalPath, cachePath, size);
         fileCacheEntry.switchStatus(
                 FileCacheEntry.EntryStatus.REMOVED, FileCacheEntry.EntryStatus.LOADED);
         fileCacheEntry.loaded();
         fileBasedCache.addFirst(cachePath.toString(), fileCacheEntry);
     }
+
+    private void registerIntoCache(long size) {
+        FileCacheEntry fileCacheEntry =
+                new FileCacheEntry(fileBasedCache, originalPath, cachePath, size);
+        fileBasedCache.addSecond(cachePath.toString(), fileCacheEntry);
+    }
 }
diff --git a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/FileBasedCache.java b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/FileBasedCache.java
index a732bb05341..72c22a1c3b2 100644
--- a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/FileBasedCache.java
+++ b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/FileBasedCache.java
@@ -196,7 +196,9 @@ public final class FileBasedCache extends DoubleListLru<String, FileCacheEntry>
                 path,
                 cachePath,
                 originalOutputStream,
-                cacheFs.create(cachePath, FileSystem.WriteMode.OVERWRITE),
+                cacheLimitPolicy.directWriteInCache()
+                        ? cacheFs.create(cachePath, FileSystem.WriteMode.OVERWRITE)
+                        : null,
                 this);
     }
 
@@ -290,7 +292,8 @@ public final class FileBasedCache extends DoubleListLru<String, FileCacheEntry>
     @Override
     void addedToFirst(FileCacheEntry value) {
         LOG.trace("Cache entry {} added to first link.", value.cachePath);
-        while (cacheLimitPolicy.isOverflow(value.entrySize)) {
+        while (cacheLimitPolicy.isOverflow(
+                value.entrySize, value.checkStatus(FileCacheEntry.EntryStatus.LOADED))) {
             moveMiddleFront();
         }
         cacheLimitPolicy.acquire(value.entrySize);
@@ -380,7 +383,9 @@ public final class FileBasedCache extends DoubleListLru<String, FileCacheEntry>
     @Override
     void promotedToFirst(FileCacheEntry value) {
         value.accessCountInColdLink = 0;
-        while (cacheLimitPolicy.isOverflow(value.entrySize)) {
+        // the loading has started, so we believe the entry has file. Even if it's not, won't cause
+        // anything here.
+        while (cacheLimitPolicy.isOverflow(value.entrySize, true)) {
             moveMiddleFront();
         }
         cacheLimitPolicy.acquire(value.entrySize);
diff --git a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/SizeBasedCacheLimitPolicy.java b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/SizeBasedCacheLimitPolicy.java
index 6a1785cda8b..9519fe907dc 100644
--- a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/SizeBasedCacheLimitPolicy.java
+++ b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/SizeBasedCacheLimitPolicy.java
@@ -33,22 +33,31 @@ public class SizeBasedCacheLimitPolicy implements CacheLimitPolicy {
     /** The capacity. */
     private final long capacity;
 
+    /** The estimated sst file size. */
+    private final long sstFileSize;
+
     /** The usage size. */
     private long usageSize;
 
-    public SizeBasedCacheLimitPolicy(long capacity) {
+    public SizeBasedCacheLimitPolicy(long capacity, long sstFileSize) {
         this.capacity = capacity;
+        this.sstFileSize = sstFileSize;
         this.usageSize = 0;
         LOG.info("Creating SizeBasedCacheLimitPolicy with capacity {}", capacity);
     }
 
+    @Override
+    public boolean directWriteInCache() {
+        return isSafeToAdd(sstFileSize);
+    }
+
     @Override
     public boolean isSafeToAdd(long toAddSize) {
-        return toAddSize < capacity;
+        return toAddSize <= capacity;
     }
 
     @Override
-    public boolean isOverflow(long toAddSize) {
+    public boolean isOverflow(long toAddSize, boolean hasFile) {
         return usageSize + toAddSize > capacity;
     }
 
diff --git a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/SpaceBasedCacheLimitPolicy.java b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/SpaceBasedCacheLimitPolicy.java
index 87c289876f4..d4f7e68e4f0 100644
--- a/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/SpaceBasedCacheLimitPolicy.java
+++ b/flink-state-backends/flink-statebackend-forst/src/main/java/org/apache/flink/state/forst/fs/cache/SpaceBasedCacheLimitPolicy.java
@@ -32,21 +32,34 @@ import java.io.File;
  */
 public class SpaceBasedCacheLimitPolicy implements CacheLimitPolicy {
     private static final Logger LOG = LoggerFactory.getLogger(SpaceBasedCacheLimitPolicy.class);
+
+    /** The reserved size of space that should always be available. */
     private final long reservedSize;
+
+    /** The base path of the instance where the cache is stored. */
     private final File instanceBasePath;
+
+    /** The estimated size of the SST file. */
+    private final long sstFileSize;
+
+    /** The current usage size of the cache. */
     private long usageSize;
 
     public SpaceBasedCacheLimitPolicy(
             File instanceBasePath, long reservedSize, long baseTargetFileSize) {
         this.reservedSize = reservedSize;
         this.instanceBasePath = instanceBasePath;
+        this.sstFileSize = baseTargetFileSize;
         this.usageSize = 0;
         long initFreeSpace = instanceBasePath.getFreeSpace();
         if (initFreeSpace < reservedSize || reservedSize < baseTargetFileSize) {
             LOG.warn(
-                    "Illegal configuration of preserved space, current free space %s, reserve space %s "
-                            + "and base targetFile size %s on instance base path %s.",
-                    initFreeSpace, reservedSize, baseTargetFileSize, instanceBasePath);
+                    "Illegal configuration of preserved space, current free space {}, reserve space {} "
+                            + "and base targetFile size {} on instance base path {}.",
+                    initFreeSpace,
+                    reservedSize,
+                    baseTargetFileSize,
+                    instanceBasePath);
         }
         LOG.info(
                 "Creating SpaceBasedCacheLimitPolicy with initFreeSpace {} and preserved space {}",
@@ -58,14 +71,21 @@ public class SpaceBasedCacheLimitPolicy implements CacheLimitPolicy {
         return toAddSize > instanceBasePath.getFreeSpace() - leftSpace;
     }
 
+    @Override
+    public boolean directWriteInCache() {
+        return isSafeToAdd(sstFileSize);
+    }
+
     @Override
     public boolean isSafeToAdd(long toAddSize) {
-        return toAddSize < instanceBasePath.getFreeSpace() - reservedSize + usageSize;
+        return toAddSize <= instanceBasePath.getFreeSpace() - reservedSize + usageSize;
     }
 
     @Override
-    public boolean isOverflow(long toAddSize) {
-        return isOverSpace(toAddSize, reservedSize);
+    public boolean isOverflow(long toAddSize, boolean hasFile) {
+        // hasFile = true means the file is already in cache, so the toAddSize is 0 considering the
+        // reserved size.
+        return isOverSpace(hasFile ? 0 : toAddSize, reservedSize);
     }
 
     @Override
diff --git a/flink-state-backends/flink-statebackend-forst/src/test/java/org/apache/flink/state/forst/fs/ForStFlinkFileSystemTest.java b/flink-state-backends/flink-statebackend-forst/src/test/java/org/apache/flink/state/forst/fs/ForStFlinkFileSystemTest.java
index 4cf2b51e01e..cd41dc4cda0 100644
--- a/flink-state-backends/flink-statebackend-forst/src/test/java/org/apache/flink/state/forst/fs/ForStFlinkFileSystemTest.java
+++ b/flink-state-backends/flink-statebackend-forst/src/test/java/org/apache/flink/state/forst/fs/ForStFlinkFileSystemTest.java
@@ -72,7 +72,7 @@ public class ForStFlinkFileSystemTest {
                     {
                         new FileBasedCache(
                                 new Configuration(),
-                                new SizeBasedCacheLimitPolicy(1024 * 3),
+                                new SizeBasedCacheLimitPolicy(1024 * 3, 64 * 1024 * 1024),
                                 FileSystem.getLocalFileSystem(),
                                 new org.apache.flink.core.fs.Path(tempDir.toString() + "/cache"),
                                 null)
@@ -236,7 +236,7 @@ public class ForStFlinkFileSystemTest {
         BundledCacheLimitPolicy cacheLimitPolicy =
                 new BundledCacheLimitPolicy(
                         new SpaceBasedCacheLimitPolicy(new File(cachePath.toString()), 0, 0),
-                        new SizeBasedCacheLimitPolicy(250));
+                        new SizeBasedCacheLimitPolicy(250, 250));
         UnregisteredMetricsGroup metricsGroup =
                 new UnregisteredMetricsGroup() {
                     @Override
