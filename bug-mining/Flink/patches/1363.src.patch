diff --git a/flink-runtime/src/main/java/org/apache/flink/migration/runtime/checkpoint/savepoint/SavepointV0Serializer.java b/flink-runtime/src/main/java/org/apache/flink/migration/runtime/checkpoint/savepoint/SavepointV0Serializer.java
index e4125e5796f..dc307e27673 100644
--- a/flink-runtime/src/main/java/org/apache/flink/migration/runtime/checkpoint/savepoint/SavepointV0Serializer.java
+++ b/flink-runtime/src/main/java/org/apache/flink/migration/runtime/checkpoint/savepoint/SavepointV0Serializer.java
@@ -45,6 +45,7 @@ import org.apache.flink.runtime.state.StreamStateHandle;
 import org.apache.flink.runtime.state.filesystem.FileStateHandle;
 import org.apache.flink.runtime.state.memory.ByteStreamStateHandle;
 import org.apache.flink.runtime.state.memory.MemCheckpointStreamFactory;
+import org.apache.flink.util.IOUtils;
 import org.apache.flink.util.InstantiationUtil;
 import org.apache.flink.util.Preconditions;
 
@@ -286,16 +287,21 @@ public class SavepointV0Serializer implements SavepointSerializer<SavepointV1> {
 			CheckpointStreamFactory.CheckpointStateOutputStream keyedStateOut =
 					checkpointStreamFactory.createCheckpointStateOutputStream(checkpointID, 0L);
 
-			final long offset = keyedStateOut.getPos();
+			try {
+				final long offset = keyedStateOut.getPos();
 
-			InstantiationUtil.serializeObject(keyedStateOut, oldKeyedState);
-			StreamStateHandle streamStateHandle = keyedStateOut.closeAndGetHandle();
+				InstantiationUtil.serializeObject(keyedStateOut, oldKeyedState);
+				StreamStateHandle streamStateHandle = keyedStateOut.closeAndGetHandle();
+				keyedStateOut = null; // makes IOUtils.closeQuietly(...) ignore this
 
-			if (null != streamStateHandle) {
-				KeyGroupRangeOffsets keyGroupRangeOffsets =
-						new KeyGroupRangeOffsets(parallelInstanceIdx, parallelInstanceIdx, new long[]{offset});
+				if (null != streamStateHandle) {
+					KeyGroupRangeOffsets keyGroupRangeOffsets =
+							new KeyGroupRangeOffsets(parallelInstanceIdx, parallelInstanceIdx, new long[]{offset});
 
-				return new MigrationKeyGroupStateHandle(keyGroupRangeOffsets, streamStateHandle);
+					return new MigrationKeyGroupStateHandle(keyGroupRangeOffsets, streamStateHandle);
+				}
+			} finally {
+				IOUtils.closeQuietly(keyedStateOut);
 			}
 		}
 		return null;
