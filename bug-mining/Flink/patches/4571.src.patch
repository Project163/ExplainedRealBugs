diff --git a/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/KeyedStateInputFormat.java b/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/KeyedStateInputFormat.java
index 5fd91d81938..58fd1e1251f 100644
--- a/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/KeyedStateInputFormat.java
+++ b/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/KeyedStateInputFormat.java
@@ -44,14 +44,15 @@ import org.apache.flink.streaming.api.operators.InternalTimeServiceManager;
 import org.apache.flink.streaming.api.operators.StreamOperatorStateContext;
 import org.apache.flink.streaming.api.operators.StreamTaskStateInitializer;
 import org.apache.flink.streaming.api.operators.StreamTaskStateInitializerImpl;
+import org.apache.flink.util.CloseableIterator;
 import org.apache.flink.util.CollectionUtil;
+import org.apache.flink.util.IOUtils;
 import org.apache.flink.util.Preconditions;
 
 import javax.annotation.Nonnull;
 
 import java.io.IOException;
 import java.util.Comparator;
-import java.util.Iterator;
 import java.util.List;
 
 /**
@@ -77,7 +78,7 @@ public class KeyedStateInputFormat<K, N, OUT> extends RichInputFormat<OUT, KeyGr
 
 	private transient BufferingCollector<OUT> out;
 
-	private transient Iterator<Tuple2<K, N>> keysAndNamespaces;
+	private transient CloseableIterator<Tuple2<K, N>> keysAndNamespaces;
 
 	/**
 	 * Creates an input format for reading partitioned state from an operator in a savepoint.
@@ -191,6 +192,7 @@ public class KeyedStateInputFormat<K, N, OUT> extends RichInputFormat<OUT, KeyGr
 	@Override
 	public void close() throws IOException {
 		try {
+			IOUtils.closeQuietly(keysAndNamespaces);
 			operator.close();
 			registry.close();
 		} catch (Exception e) {
diff --git a/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/MultiStateKeyIterator.java b/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/MultiStateKeyIterator.java
index 4af28f4ba0b..fb61a16737b 100644
--- a/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/MultiStateKeyIterator.java
+++ b/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/MultiStateKeyIterator.java
@@ -21,11 +21,14 @@ package org.apache.flink.state.api.input;
 import org.apache.flink.annotation.Internal;
 import org.apache.flink.api.common.state.State;
 import org.apache.flink.api.common.state.StateDescriptor;
+import org.apache.flink.core.fs.CloseableRegistry;
 import org.apache.flink.runtime.state.KeyedStateBackend;
 import org.apache.flink.runtime.state.VoidNamespace;
 import org.apache.flink.runtime.state.VoidNamespaceSerializer;
+import org.apache.flink.util.CloseableIterator;
 import org.apache.flink.util.Preconditions;
 
+import java.io.IOException;
 import java.util.Iterator;
 import java.util.List;
 
@@ -37,23 +40,33 @@ import java.util.List;
  * @param <K> Type of the key by which state is keyed.
  */
 @Internal
-public final class MultiStateKeyIterator<K> implements Iterator<K> {
+public final class MultiStateKeyIterator<K> implements CloseableIterator<K> {
 	private final List<? extends StateDescriptor<?, ?>> descriptors;
 
 	private final KeyedStateBackend<K> backend;
 
 	private final Iterator<K> internal;
 
+	private final CloseableRegistry registry;
+
 	private K currentKey;
 
 	public MultiStateKeyIterator(List<? extends StateDescriptor<?, ?>> descriptors, KeyedStateBackend<K> backend) {
 		this.descriptors = Preconditions.checkNotNull(descriptors);
-
 		this.backend = Preconditions.checkNotNull(backend);
 
+		this.registry = new CloseableRegistry();
 		this.internal = descriptors
 			.stream()
-			.flatMap(descriptor -> backend.getKeys(descriptor.getName(), VoidNamespace.INSTANCE))
+			.map(descriptor -> backend.getKeys(descriptor.getName(), VoidNamespace.INSTANCE))
+			.peek(stream -> {
+				try {
+					registry.registerCloseable(stream::close);
+				} catch (IOException e) {
+					throw new RuntimeException("Failed to read keys from configured StateBackend", e);
+				}
+			})
+			.flatMap(stream -> stream)
 			.iterator();
 	}
 
@@ -88,5 +101,10 @@ public final class MultiStateKeyIterator<K> implements Iterator<K> {
 			}
 		}
 	}
+
+	@Override
+	public void close() throws Exception {
+		registry.close();
+	}
 }
 
diff --git a/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/KeyedStateReaderOperator.java b/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/KeyedStateReaderOperator.java
index 1c99a5b3e51..9842bf36280 100644
--- a/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/KeyedStateReaderOperator.java
+++ b/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/KeyedStateReaderOperator.java
@@ -33,10 +33,10 @@ import org.apache.flink.state.api.functions.KeyedStateReaderFunction;
 import org.apache.flink.state.api.input.MultiStateKeyIterator;
 import org.apache.flink.state.api.runtime.SavepointRuntimeContext;
 import org.apache.flink.streaming.api.operators.InternalTimerService;
+import org.apache.flink.util.CloseableIterator;
 import org.apache.flink.util.Collector;
 
 import java.util.Collections;
-import java.util.Iterator;
 import java.util.List;
 import java.util.Set;
 import java.util.stream.Collectors;
@@ -74,10 +74,10 @@ public class KeyedStateReaderOperator<KEY, OUT>
 	}
 
 	@Override
-	public Iterator<Tuple2<KEY, VoidNamespace>> getKeysAndNamespaces(SavepointRuntimeContext ctx) throws Exception {
+	public CloseableIterator<Tuple2<KEY, VoidNamespace>> getKeysAndNamespaces(SavepointRuntimeContext ctx) throws Exception {
 		ctx.disableStateRegistration();
 		List<StateDescriptor<?, ?>> stateDescriptors = ctx.getStateDescriptors();
-		Iterator<KEY> keys = new MultiStateKeyIterator<>(stateDescriptors, getKeyedStateBackend());
+		MultiStateKeyIterator<KEY> keys = new MultiStateKeyIterator<>(stateDescriptors, getKeyedStateBackend());
 		return new NamespaceDecorator<>(keys);
 	}
 
@@ -140,11 +140,11 @@ public class KeyedStateReaderOperator<KEY, OUT>
 		}
 	}
 
-	private static class NamespaceDecorator<KEY> implements Iterator<Tuple2<KEY, VoidNamespace>> {
+	private static class NamespaceDecorator<KEY> implements CloseableIterator<Tuple2<KEY, VoidNamespace>> {
 
-		private final Iterator<KEY> keys;
+		private final CloseableIterator<KEY> keys;
 
-		private NamespaceDecorator(Iterator<KEY> keys) {
+		private NamespaceDecorator(CloseableIterator<KEY> keys) {
 			this.keys = keys;
 		}
 
@@ -163,5 +163,10 @@ public class KeyedStateReaderOperator<KEY, OUT>
 		public void remove() {
 			keys.remove();
 		}
+
+		@Override
+		public void close() throws Exception {
+			keys.close();
+		}
 	}
 }
diff --git a/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/StateReaderOperator.java b/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/StateReaderOperator.java
index 87c1c57ceb1..a86b7ebfa24 100644
--- a/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/StateReaderOperator.java
+++ b/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/StateReaderOperator.java
@@ -33,11 +33,11 @@ import org.apache.flink.streaming.api.operators.InternalTimeServiceManager;
 import org.apache.flink.streaming.api.operators.InternalTimerService;
 import org.apache.flink.streaming.api.operators.KeyContext;
 import org.apache.flink.streaming.api.operators.TimerSerializer;
+import org.apache.flink.util.CloseableIterator;
 import org.apache.flink.util.Collector;
 import org.apache.flink.util.Preconditions;
 
 import java.io.Serializable;
-import java.util.Iterator;
 
 /**
  * Base class for executing functions that read keyed state.
@@ -78,7 +78,7 @@ public abstract class StateReaderOperator<F extends Function, KEY, N, OUT> imple
 
 	public abstract void processElement(KEY key, N namespace, Collector<OUT> out) throws Exception;
 
-	public abstract Iterator<Tuple2<KEY, N>> getKeysAndNamespaces(SavepointRuntimeContext ctx) throws Exception;
+	public abstract CloseableIterator<Tuple2<KEY, N>> getKeysAndNamespaces(SavepointRuntimeContext ctx) throws Exception;
 
 	public final void setup(
 		ExecutionConfig executionConfig,
diff --git a/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/WindowReaderOperator.java b/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/WindowReaderOperator.java
index 1e463466ed2..2d04676d7fe 100644
--- a/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/WindowReaderOperator.java
+++ b/flink-libraries/flink-state-processing-api/src/main/java/org/apache/flink/state/api/input/operator/WindowReaderOperator.java
@@ -45,6 +45,7 @@ import org.apache.flink.streaming.api.operators.InternalTimerService;
 import org.apache.flink.streaming.api.windowing.windows.Window;
 import org.apache.flink.streaming.runtime.streamrecord.StreamElementSerializer;
 import org.apache.flink.streaming.runtime.streamrecord.StreamRecord;
+import org.apache.flink.util.CloseableIterator;
 import org.apache.flink.util.Collector;
 import org.apache.flink.util.Preconditions;
 
@@ -53,6 +54,7 @@ import java.util.Iterator;
 import java.util.List;
 import java.util.Set;
 import java.util.stream.Collectors;
+import java.util.stream.Stream;
 import java.util.stream.StreamSupport;
 
 /**
@@ -157,9 +159,9 @@ public class WindowReaderOperator<S extends State, KEY, IN, W extends Window, OU
 	}
 
 	@Override
-	public Iterator<Tuple2<KEY, W>> getKeysAndNamespaces(SavepointRuntimeContext ctx) throws Exception {
-		Iterator<Tuple2<KEY, W>> keysAndWindows = getKeyedStateBackend()
-			.<W>getKeysAndNamespaces(descriptor.getName()).iterator();
+	public CloseableIterator<Tuple2<KEY, W>> getKeysAndNamespaces(SavepointRuntimeContext ctx) throws Exception {
+		Stream<Tuple2<KEY, W>> keysAndWindows = getKeyedStateBackend()
+			.getKeysAndNamespaces(descriptor.getName());
 
 		return new IteratorWithRemove<>(keysAndWindows);
 	}
@@ -261,12 +263,15 @@ public class WindowReaderOperator<S extends State, KEY, IN, W extends Window, OU
 		}
 	}
 
-	private static class IteratorWithRemove<T> implements Iterator<T> {
+	private static class IteratorWithRemove<T> implements CloseableIterator<T> {
 
 		private final Iterator<T> iterator;
 
-		private IteratorWithRemove(Iterator<T> iterator) {
-			this.iterator = iterator;
+		private final AutoCloseable resource;
+
+		private IteratorWithRemove(Stream<T> stream) {
+			this.iterator = stream.iterator();
+			this.resource = stream;
 		}
 
 		@Override
@@ -281,5 +286,10 @@ public class WindowReaderOperator<S extends State, KEY, IN, W extends Window, OU
 
 		@Override
 		public void remove() { }
+
+		@Override
+		public void close() throws Exception {
+			resource.close();
+		}
 	}
 }
