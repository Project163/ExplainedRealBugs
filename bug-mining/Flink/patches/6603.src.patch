diff --git a/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/planner/delegation/hive/HiveParser.java b/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/planner/delegation/hive/HiveParser.java
index 4214dbda09c..713ee146a7a 100644
--- a/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/planner/delegation/hive/HiveParser.java
+++ b/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/table/planner/delegation/hive/HiveParser.java
@@ -390,8 +390,20 @@ public class HiveParser extends ParserImpl {
 
     private boolean isMultiDestQuery(HiveParserASTNode astNode) {
         // Hive's multi dest insert will always be [FROM, INSERT+]
-        // so, if it's children count is more than 2, it should be a multi-dest query
-        return astNode.getChildCount() > 2;
+        // so, if it's children count is more than 2, and the first one
+        // is FROM, others are INSERT nodes, it should be multi dest query
+        if (astNode.getChildCount() > 2) {
+            if (astNode.getChild(0).getType() == HiveASTParser.TOK_FROM) {
+                // the others should be insert tokens
+                for (int i = 1; i < astNode.getChildCount(); i++) {
+                    if (astNode.getChild(i).getType() != HiveASTParser.TOK_INSERT) {
+                        return false;
+                    }
+                }
+                return true;
+            }
+        }
+        return false;
     }
 
     private Operation processMultiDestQuery(
diff --git a/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/connectors/hive/HiveDialectQueryITCase.java b/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/connectors/hive/HiveDialectQueryITCase.java
index 890c000f090..97bb586b4b5 100644
--- a/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/connectors/hive/HiveDialectQueryITCase.java
+++ b/flink-connectors/flink-connector-hive/src/test/java/org/apache/flink/connectors/hive/HiveDialectQueryITCase.java
@@ -181,7 +181,8 @@ public class HiveDialectQueryITCase {
                                         + " (select salary,count(*) as cnt from employee group by salary) a",
                                 "select a, one from binary_t lateral view explode(ab) abs as one where a > 0",
                                 "select /*+ mapjoin(dest) */ foo.x from foo join dest on foo.x = dest.x union"
-                                        + " all select /*+ mapjoin(dest) */ foo.x from foo join dest on foo.y = dest.y"));
+                                        + " all select /*+ mapjoin(dest) */ foo.x from foo join dest on foo.y = dest.y",
+                                "with cte as (select * from src) select * from cte"));
         if (HiveVersionTestUtil.HIVE_230_OR_LATER) {
             toRun.add(
                     "select weekofyear(current_timestamp()), dayofweek(current_timestamp()) from src limit 1");
