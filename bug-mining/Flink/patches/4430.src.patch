diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/SinkCodeGenerator.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/SinkCodeGenerator.scala
index efe906b100e..f46bd7c1172 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/SinkCodeGenerator.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/codegen/SinkCodeGenerator.scala
@@ -94,6 +94,7 @@ object SinkCodeGenerator {
         afterIndexModify = CodeGenUtils.newName("afterIndexModify")
         s"""
            |${conversion.code}
+           |${conversion.resultTerm}.setRowKind(${inputTerm}.getRowKind());
            |${classOf[RowData].getCanonicalName} $afterIndexModify = ${conversion.resultTerm};
            |""".stripMargin
       case _ =>
diff --git a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/StreamTableEnvironmentITCase.scala b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/StreamTableEnvironmentITCase.scala
index 3248965e244..1282aba6cdb 100644
--- a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/StreamTableEnvironmentITCase.scala
+++ b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/runtime/stream/sql/StreamTableEnvironmentITCase.scala
@@ -114,4 +114,27 @@ class StreamTableEnvironmentITCase extends StreamingTestBase {
       "(true,Person{name='Jack', age=3})")
     assertEquals(expected.sorted, sink.getResults.sorted)
   }
+
+  @Test
+  def testRetractMsgWithPojoType(): Unit = {
+    val orders = env.fromCollection(Seq(
+      new Order(1L, new ProductItem("beer", 10L), 1),
+      new Order(1L, new ProductItem("beer", 10L), 2)
+    ))
+
+    val table = tEnv.fromDataStream(orders, 'user, 'product, 'amount)
+
+    val sink = new StringSink[(Boolean, Order)]()
+    tEnv.sqlQuery(s"""|SELECT user, product, sum(amount) as amount
+                      |FROM $table
+                      |GROUP BY user, product
+                      |""".stripMargin).toRetractStream[Order].addSink(sink)
+    env.execute()
+
+    val expected = List(
+      "(true,Order{user=1, product='Product{name='beer', id=10}', amount=1})",
+      "(false,Order{user=1, product='Product{name='beer', id=10}', amount=1})",
+      "(true,Order{user=1, product='Product{name='beer', id=10}', amount=3})")
+    assertEquals(expected.sorted, sink.getResults.sorted)
+  }
 }
