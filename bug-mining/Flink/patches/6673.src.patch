diff --git a/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/connector/upserttest/sink/UpsertTestSinkWriter.java b/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/connector/upserttest/sink/UpsertTestSinkWriter.java
index c6c8889e951..a91ff3bdfbf 100644
--- a/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/connector/upserttest/sink/UpsertTestSinkWriter.java
+++ b/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/connector/upserttest/sink/UpsertTestSinkWriter.java
@@ -27,6 +27,7 @@ import java.io.File;
 import java.io.FileNotFoundException;
 import java.io.FileOutputStream;
 import java.io.IOException;
+import java.nio.file.Files;
 import java.util.HashMap;
 import java.util.Map;
 
@@ -53,6 +54,11 @@ class UpsertTestSinkWriter<IN> implements SinkWriter<IN> {
         this.keySerializationSchema = checkNotNull(keySerializationSchema);
         this.valueSerializationSchema = checkNotNull(valueSerializationSchema);
         checkNotNull(outputFile);
+        try {
+            Files.createDirectories(outputFile.toPath().getParent());
+        } catch (IOException e) {
+            throw new FlinkRuntimeException("Could not parent directories for path: " + outputFile);
+        }
         try {
             this.bufferedOutputStream =
                     new BufferedOutputStream(new FileOutputStream(outputFile, true));
diff --git a/flink-tests/src/test/java/org/apache/flink/connector/upserttest/sink/UpsertTestSinkWriterITCase.java b/flink-tests/src/test/java/org/apache/flink/connector/upserttest/sink/UpsertTestSinkWriterITCase.java
index 3493a4dec53..c3430ca461a 100644
--- a/flink-tests/src/test/java/org/apache/flink/connector/upserttest/sink/UpsertTestSinkWriterITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/connector/upserttest/sink/UpsertTestSinkWriterITCase.java
@@ -35,6 +35,7 @@ import org.junit.jupiter.api.io.TempDir;
 
 import java.io.File;
 import java.io.IOException;
+import java.nio.file.Paths;
 import java.util.ArrayList;
 import java.util.List;
 import java.util.Map;
@@ -60,7 +61,7 @@ class UpsertTestSinkWriterITCase {
 
     @BeforeEach
     void setup() {
-        outputFile = new File(tempDir, "records.out");
+        outputFile = tempDir.toPath().resolve(Paths.get("dir", "records.out")).toFile();
         writer = createSinkWriter(outputFile);
         expectedRecords = writeTestData(writer);
     }
