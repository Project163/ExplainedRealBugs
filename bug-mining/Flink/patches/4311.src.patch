diff --git a/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/main/java/org/apache/flink/tests/util/kafka/KafkaResource.java b/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/main/java/org/apache/flink/tests/util/kafka/KafkaResource.java
index bd5ba46dbb7..82bf498157d 100644
--- a/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/main/java/org/apache/flink/tests/util/kafka/KafkaResource.java
+++ b/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/main/java/org/apache/flink/tests/util/kafka/KafkaResource.java
@@ -50,6 +50,18 @@ public interface KafkaResource extends ExternalResource {
 	 */
 	void sendMessages(String topic, String ... messages) throws IOException;
 
+	/**
+	 * Sends the given keyed messages to the given topic. The messages themselves should contain
+	 * the specified {@code keySeparator}.
+	 *
+	 * @param topic topic name
+	 * @param keySeparator the separator used to parse key from value in the messages
+	 * @param messages messages to send
+	 * @throws IOException
+	 */
+	void sendKeyedMessages(
+			String topic, String keySeparator, String ... messages) throws IOException;
+
 	/**
 	 * Returns the kafka bootstrap server addresses.
 	 * @return kafka bootstrap server addresses
diff --git a/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/main/java/org/apache/flink/tests/util/kafka/LocalStandaloneKafkaResource.java b/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/main/java/org/apache/flink/tests/util/kafka/LocalStandaloneKafkaResource.java
index eb18f7ef1eb..7b0ecf07c13 100644
--- a/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/main/java/org/apache/flink/tests/util/kafka/LocalStandaloneKafkaResource.java
+++ b/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/main/java/org/apache/flink/tests/util/kafka/LocalStandaloneKafkaResource.java
@@ -41,6 +41,7 @@ import java.nio.file.Paths;
 import java.nio.file.StandardOpenOption;
 import java.time.Duration;
 import java.util.ArrayList;
+import java.util.Arrays;
 import java.util.Collection;
 import java.util.Collections;
 import java.util.List;
@@ -246,14 +247,40 @@ public class LocalStandaloneKafkaResource implements KafkaResource {
 
 	@Override
 	public void sendMessages(String topic, String... messages) throws IOException {
-		try (AutoClosableProcess autoClosableProcess = AutoClosableProcess.runNonBlocking(
-			kafkaDir.resolve(Paths.get("bin", "kafka-console-producer.sh")).toString(),
-			"--broker-list",
-			KAFKA_ADDRESS,
-			"--topic",
-			topic)) {
+		List<String> args = createSendMessageArguments(topic);
+		sendMessagesAndWait(args, messages);
+	}
+
+	@Override
+	public void sendKeyedMessages(String topic, String keySeparator, String... messages) throws IOException {
+		List<String> args = new ArrayList<>(createSendMessageArguments(topic));
+		args.add("--property");
+		args.add("parse.key=true");
+		args.add("--property");
+		args.add("key.separator=" + keySeparator);
+
+		sendMessagesAndWait(args, messages);
+	}
+
+	private List<String> createSendMessageArguments(String topic) {
+		return Arrays.asList(
+				kafkaDir.resolve(Paths.get("bin", "kafka-console-producer.sh")).toString(),
+				"--broker-list",
+				KAFKA_ADDRESS,
+				"--topic",
+				topic);
+	}
+
+	private void sendMessagesAndWait(
+			List<String> kafkaArgs,
+			String... messages) throws IOException {
+		try (AutoClosableProcess autoClosableProcess =
+					AutoClosableProcess.runNonBlocking(kafkaArgs.toArray(new String[0]))) {
 
-			try (PrintStream printStream = new PrintStream(autoClosableProcess.getProcess().getOutputStream(), true, StandardCharsets.UTF_8.name())) {
+			try (PrintStream printStream =
+						new PrintStream(autoClosableProcess
+								.getProcess()
+								.getOutputStream(), true, StandardCharsets.UTF_8.name())) {
 				for (final String message : messages) {
 					printStream.println(message);
 				}
diff --git a/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/test/java/org/apache/flink/tests/util/kafka/StreamingKafkaITCase.java b/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/test/java/org/apache/flink/tests/util/kafka/StreamingKafkaITCase.java
index d5c194de533..db516991b1f 100644
--- a/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/test/java/org/apache/flink/tests/util/kafka/StreamingKafkaITCase.java
+++ b/flink-end-to-end-tests/flink-end-to-end-tests-common-kafka/src/test/java/org/apache/flink/tests/util/kafka/StreamingKafkaITCase.java
@@ -113,13 +113,13 @@ public class StreamingKafkaITCase extends TestLogger {
 
 			LOG.info("Sending messages to Kafka topic [{}] ...", inputTopic);
 			// send some data to Kafka
-			kafka.sendMessages(inputTopic,
-				"elephant,5,45218",
-				"squirrel,12,46213",
-				"bee,3,51348",
-				"squirrel,22,52444",
-				"bee,10,53412",
-				"elephant,9,54867");
+			kafka.sendKeyedMessages(inputTopic, "\t",
+				"key\telephant,5,45218",
+				"key\tsquirrel,12,46213",
+				"key\tbee,3,51348",
+				"key\tsquirrel,22,52444",
+				"key\tbee,10,53412",
+				"key\telephant,9,54867");
 
 			LOG.info("Verifying messages from Kafka topic [{}] ...", outputTopic);
 			{
@@ -142,11 +142,11 @@ public class StreamingKafkaITCase extends TestLogger {
 
 			// send some more messages to Kafka
 			LOG.info("Sending more messages to Kafka topic [{}] ...", inputTopic);
-			kafka.sendMessages(inputTopic,
-				"elephant,13,64213",
-				"giraffe,9,65555",
-				"bee,5,65647",
-				"squirrel,18,66413");
+			kafka.sendKeyedMessages(inputTopic, "\t",
+				"key\telephant,13,64213",
+				"key\tgiraffe,9,65555",
+				"key\tbee,5,65647",
+				"key\tsquirrel,18,66413");
 
 			// verify that our assumption that the new partition actually has written messages is correct
 			Assert.assertNotEquals(
