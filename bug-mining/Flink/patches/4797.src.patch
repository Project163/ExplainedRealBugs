diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PrioritizedDeque.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PrioritizedDeque.java
index 6b4caa3f8ab..dabb4a3199a 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PrioritizedDeque.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PrioritizedDeque.java
@@ -202,8 +202,11 @@ public final class PrioritizedDeque<T> implements Iterable<T> {
 		return size() - getNumPriorityElements();
 	}
 
+	/**
+	 * @return read-only iterator
+	 */
 	public Iterator<T> iterator() {
-		return deque.iterator();
+		return Collections.unmodifiableCollection(deque).iterator();
 	}
 
 	/**
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGate.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGate.java
index ef0e074583f..ee08164c7b9 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGate.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGate.java
@@ -27,7 +27,6 @@ import org.apache.flink.shaded.guava18.com.google.common.collect.Sets;
 
 import java.io.IOException;
 import java.util.Arrays;
-import java.util.Iterator;
 import java.util.Map;
 import java.util.Optional;
 import java.util.Set;
@@ -339,9 +338,7 @@ public class UnionInputGate extends InputGate {
 			}
 		}
 
-		Iterator<IndexedInputGate> inputGateIterator = inputGatesWithData.iterator();
-		IndexedInputGate inputGate = inputGateIterator.next();
-		inputGateIterator.remove();
+		IndexedInputGate inputGate = inputGatesWithData.poll();
 
 		if (inputGatesWithData.isEmpty()) {
 			availabilityHelper.resetUnavailable();
