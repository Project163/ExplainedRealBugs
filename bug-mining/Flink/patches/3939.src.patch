diff --git a/flink-end-to-end-tests/test-scripts/common_utils.sh b/flink-end-to-end-tests/test-scripts/common_utils.sh
index f0653ba66ce..01bc6897661 100644
--- a/flink-end-to-end-tests/test-scripts/common_utils.sh
+++ b/flink-end-to-end-tests/test-scripts/common_utils.sh
@@ -22,6 +22,8 @@
 _on_exit_commands=()
 
 function _on_exit_callback {
+  # Export the exit code so that it could be used by the callback commands
+  export TRAPPED_EXIT_CODE=$?
   # Un-register the callback, to avoid multiple invocations: some shells may treat some signals as subset of others.
   trap "" INT EXIT
   # Fast exit, if there is another keyboard interrupt.
diff --git a/flink-end-to-end-tests/test-scripts/common_yarn_docker.sh b/flink-end-to-end-tests/test-scripts/common_yarn_docker.sh
index 3d245de58a3..bcdff3e3b34 100755
--- a/flink-end-to-end-tests/test-scripts/common_yarn_docker.sh
+++ b/flink-end-to-end-tests/test-scripts/common_yarn_docker.sh
@@ -38,6 +38,9 @@ start_time=$(date +%s)
 
 # make sure we stop our cluster at the end
 function cluster_shutdown {
+  if [ $TRAPPED_EXIT_CODE != 0 ];then
+      debug_copy_and_show_logs
+  fi
   docker-compose -f $END_TO_END_DIR/test-scripts/docker-hadoop-secure-cluster/docker-compose.yml down
   rm $FLINK_TARBALL_DIR/$FLINK_TARBALL
 }
diff --git a/flink-end-to-end-tests/test-scripts/test_yarn_kerberos_docker.sh b/flink-end-to-end-tests/test-scripts/test_yarn_kerberos_docker.sh
index 0c5fe91b066..a86860f4a26 100755
--- a/flink-end-to-end-tests/test-scripts/test_yarn_kerberos_docker.sh
+++ b/flink-end-to-end-tests/test-scripts/test_yarn_kerberos_docker.sh
@@ -57,14 +57,12 @@ then
     echo "$OUTPUT"
 else
     echo "Running the job failed."
-    debug_copy_and_show_logs
     exit 1
 fi
 
 for expected_result in ${EXPECTED_RESULT_LOG_CONTAINS[@]}; do
     if [[ ! "$OUTPUT" =~ $expected_result ]]; then
         echo "Output does not contain '$expected_result' as required"
-        debug_copy_and_show_logs
         exit 1
     fi
 done
