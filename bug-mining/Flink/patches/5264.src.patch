diff --git a/flink-tests/src/test/java/org/apache/flink/test/checkpointing/NotifyCheckpointAbortedITCase.java b/flink-tests/src/test/java/org/apache/flink/test/checkpointing/NotifyCheckpointAbortedITCase.java
index 352589d0a6a..b3670424831 100644
--- a/flink-tests/src/test/java/org/apache/flink/test/checkpointing/NotifyCheckpointAbortedITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/test/checkpointing/NotifyCheckpointAbortedITCase.java
@@ -60,7 +60,6 @@ import org.apache.flink.runtime.state.SnapshotResult;
 import org.apache.flink.runtime.state.SnapshotStrategy;
 import org.apache.flink.runtime.state.SnapshotStrategyRunner;
 import org.apache.flink.runtime.state.StateBackend;
-import org.apache.flink.runtime.state.StateSnapshotContext;
 import org.apache.flink.runtime.state.filesystem.FsStateBackend;
 import org.apache.flink.runtime.testutils.MiniClusterResourceConfiguration;
 import org.apache.flink.streaming.api.CheckpointingMode;
@@ -129,6 +128,7 @@ public class NotifyCheckpointAbortedITCase extends TestLogger {
                                 .build());
         cluster.before();
 
+        NormalSource.reset();
         NormalMap.reset();
         DeclineSink.reset();
         TestingCompletedCheckpointStore.reset();
@@ -185,7 +185,7 @@ public class NotifyCheckpointAbortedITCase extends TestLogger {
         resetAllOperatorsNotifyAbortedLatches();
         verifyAllOperatorsNotifyAbortedTimes(1);
 
-        DeclineSink.waitLatch.trigger();
+        NormalSource.waitLatch.trigger();
         log.info("Verifying whether all operators have been notified of checkpoint-2 aborted.");
         verifyAllOperatorsNotifyAborted();
         log.info("Verified that all operators have been notified of checkpoint-2 aborted.");
@@ -211,9 +211,11 @@ public class NotifyCheckpointAbortedITCase extends TestLogger {
     }
 
     /** Normal source function. */
-    private static class NormalSource implements SourceFunction<Tuple2<Integer, Integer>> {
+    private static class NormalSource
+            implements SourceFunction<Tuple2<Integer, Integer>>, CheckpointedFunction {
         private static final long serialVersionUID = 1L;
         protected volatile boolean running;
+        private static final OneShotLatch waitLatch = new OneShotLatch();
 
         NormalSource() {
             this.running = true;
@@ -236,6 +238,20 @@ public class NotifyCheckpointAbortedITCase extends TestLogger {
         public void cancel() {
             this.running = false;
         }
+
+        @Override
+        public void snapshotState(FunctionSnapshotContext context) throws Exception {
+            if (context.getCheckpointId() == DECLINE_CHECKPOINT_ID) {
+                waitLatch.await();
+            }
+        }
+
+        @Override
+        public void initializeState(FunctionInitializationContext context) throws Exception {}
+
+        static void reset() {
+            waitLatch.reset();
+        }
     }
 
     private static class NormalMap extends StreamMap<Tuple2<Integer, Integer>, Integer> {
@@ -286,7 +302,6 @@ public class NotifyCheckpointAbortedITCase extends TestLogger {
     private static class DeclineSink extends StreamSink<Integer> {
         private static final long serialVersionUID = 1L;
         private static final OneShotLatch notifiedAbortedLatch = new OneShotLatch();
-        private static final OneShotLatch waitLatch = new OneShotLatch();
         private static final AtomicInteger notifiedAbortedTimes = new AtomicInteger(0);
 
         public DeclineSink() {
@@ -296,14 +311,6 @@ public class NotifyCheckpointAbortedITCase extends TestLogger {
                     });
         }
 
-        @Override
-        public void snapshotState(StateSnapshotContext context) throws Exception {
-            if (context.getCheckpointId() == DECLINE_CHECKPOINT_ID) {
-                DeclineSink.waitLatch.await();
-            }
-            super.snapshotState(context);
-        }
-
         @Override
         public void notifyCheckpointAborted(long checkpointId) {
             notifiedAbortedTimes.incrementAndGet();
@@ -312,7 +319,6 @@ public class NotifyCheckpointAbortedITCase extends TestLogger {
 
         static void reset() {
             notifiedAbortedLatch.reset();
-            waitLatch.reset();
             notifiedAbortedTimes.set(0);
         }
     }
