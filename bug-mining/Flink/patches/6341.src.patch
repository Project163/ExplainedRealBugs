diff --git a/flink-python/pyflink/datastream/tests/test_window.py b/flink-python/pyflink/datastream/tests/test_window.py
index b42bf24786b..76654cd3fdb 100644
--- a/flink-python/pyflink/datastream/tests/test_window.py
+++ b/flink-python/pyflink/datastream/tests/test_window.py
@@ -202,6 +202,23 @@ class WindowTests(PyFlinkStreamingTestCase):
                     "current window start at 8, reduce result ('b', 17)"]
         self.assert_equals_sorted(expected, results)
 
+    def test_session_window_late_merge(self):
+        data_stream = self.env.from_collection([
+            ('hi', 0), ('hi', 8), ('hi', 4)],
+            type_info=Types.TUPLE([Types.STRING(), Types.INT()]))  # type: DataStream
+        watermark_strategy = WatermarkStrategy.for_monotonous_timestamps() \
+            .with_timestamp_assigner(SecondColumnTimestampAssigner())
+        data_stream.assign_timestamps_and_watermarks(watermark_strategy) \
+            .key_by(lambda x: x[0], key_type=Types.STRING()) \
+            .window(EventTimeSessionWindows.with_gap(Time.milliseconds(5))) \
+            .process(CountWindowProcessFunction(), Types.TUPLE([Types.STRING(), Types.INT()])) \
+            .add_sink(self.test_sink)
+
+        self.env.execute('test_session_window_late_merge')
+        results = self.test_sink.get_results()
+        expected = ['(hi,3)']
+        self.assert_equals_sorted(expected, results)
+
 
 class SecondColumnTimestampAssigner(TimestampAssigner):
 
diff --git a/flink-python/pyflink/fn_execution/datastream/window/merging_window_set.py b/flink-python/pyflink/fn_execution/datastream/window/merging_window_set.py
index 639a87e53db..a8058177132 100644
--- a/flink-python/pyflink/fn_execution/datastream/window/merging_window_set.py
+++ b/flink-python/pyflink/fn_execution/datastream/window/merging_window_set.py
@@ -102,7 +102,7 @@ class MergingWindowSet(Generic[W]):
             self._mapping[merge_result] = merged_state_window
             merged_state_windows.remove(merged_state_window)
 
-            if merge_result not in merged_windows and len(merged_windows) == 1:
+            if merge_result not in merged_windows or len(merged_windows) != 1:
                 merge_function.merge(
                     merge_result,
                     merged_windows,
diff --git a/flink-python/pyflink/fn_execution/state_impl.py b/flink-python/pyflink/fn_execution/state_impl.py
index bccb5a6ea89..0b2d2d5db88 100644
--- a/flink-python/pyflink/fn_execution/state_impl.py
+++ b/flink-python/pyflink/fn_execution/state_impl.py
@@ -1155,13 +1155,14 @@ class RemoteKeyedStateBackend(object):
             self._map_state_handler.clear(self._clear_iterator_mark)
 
     def merge_namespaces(self, state: SynchronousMergingRuntimeState, target, sources, ttl_config):
+        for source in sources:
+            state.set_current_namespace(source)
+            self.commit_internal_state(state.get_internal_state())
         state.set_current_namespace(target)
         self.commit_internal_state(state.get_internal_state())
         encoded_target_namespace = self._encode_namespace(target)
-        encoded_namespaces = [encoded_target_namespace]
-        for source in sources:
-            encoded_namespaces.append(self._encode_namespace(source))
-        self.clear_state_cache(state, encoded_namespaces)
+        encoded_namespaces = [self._encode_namespace(source) for source in sources]
+        self.clear_state_cache(state, [encoded_target_namespace] + encoded_namespaces)
 
         state_key = self.get_bag_state_key(
             state.name, self._encoded_current_key, encoded_target_namespace, ttl_config)
diff --git a/flink-python/src/main/java/org/apache/flink/streaming/api/operators/python/timer/TimerRegistration.java b/flink-python/src/main/java/org/apache/flink/streaming/api/operators/python/timer/TimerRegistration.java
index d554c696b9c..ccd80a55586 100644
--- a/flink-python/src/main/java/org/apache/flink/streaming/api/operators/python/timer/TimerRegistration.java
+++ b/flink-python/src/main/java/org/apache/flink/streaming/api/operators/python/timer/TimerRegistration.java
@@ -27,6 +27,7 @@ import org.apache.flink.runtime.state.VoidNamespace;
 import org.apache.flink.runtime.state.VoidNamespaceSerializer;
 import org.apache.flink.streaming.api.operators.InternalTimerService;
 import org.apache.flink.streaming.api.operators.KeyContext;
+import org.apache.flink.streaming.api.utils.PythonOperatorUtils;
 import org.apache.flink.types.Row;
 
 import java.util.HashMap;
@@ -83,9 +84,11 @@ public final class TimerRegistration {
         }
     }
 
-    private void setTimer(TimerOperandType operandType, long timestamp, Row key, Object namespace) {
+    private void setTimer(TimerOperandType operandType, long timestamp, Row key, Object namespace)
+            throws Exception {
         synchronized (keyedStateBackend) {
             keyContext.setCurrentKey(key);
+            PythonOperatorUtils.setCurrentKeyForTimerService(internalTimerService, key);
             switch (operandType) {
                 case REGISTER_EVENT_TIMER:
                     internalTimerService.registerEventTimeTimer(namespace, timestamp);
diff --git a/flink-python/src/main/java/org/apache/flink/streaming/api/utils/PythonOperatorUtils.java b/flink-python/src/main/java/org/apache/flink/streaming/api/utils/PythonOperatorUtils.java
index f929ef9273b..dc26f452ab5 100644
--- a/flink-python/src/main/java/org/apache/flink/streaming/api/utils/PythonOperatorUtils.java
+++ b/flink-python/src/main/java/org/apache/flink/streaming/api/utils/PythonOperatorUtils.java
@@ -20,6 +20,8 @@ package org.apache.flink.streaming.api.utils;
 
 import org.apache.flink.annotation.Internal;
 import org.apache.flink.runtime.state.KeyedStateBackend;
+import org.apache.flink.streaming.api.operators.InternalTimerService;
+import org.apache.flink.streaming.api.operators.sorted.state.BatchExecutionInternalTimeService;
 import org.apache.flink.streaming.api.operators.sorted.state.BatchExecutionKeyedStateBackend;
 
 /** Utilities used by Python operators. */
@@ -34,6 +36,15 @@ public class PythonOperatorUtils {
         }
     }
 
+    /** Set the current key for the timer service. */
+    public static <K, N> void setCurrentKeyForTimerService(
+            InternalTimerService<N> internalTimerService, K currentKey) throws Exception {
+        if (internalTimerService instanceof BatchExecutionInternalTimeService) {
+            ((BatchExecutionInternalTimeService<K, N>) internalTimerService)
+                    .setCurrentKey(currentKey);
+        }
+    }
+
     public static <K> boolean inBatchExecutionMode(KeyedStateBackend<K> stateBackend) {
         return stateBackend instanceof BatchExecutionKeyedStateBackend;
     }
