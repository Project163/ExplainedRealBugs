diff --git a/flink-java/src/main/java/org/apache/flink/api/java/functions/SemanticPropUtil.java b/flink-java/src/main/java/org/apache/flink/api/java/functions/SemanticPropUtil.java
index 33436714f03..4569be3ae3b 100644
--- a/flink-java/src/main/java/org/apache/flink/api/java/functions/SemanticPropUtil.java
+++ b/flink-java/src/main/java/org/apache/flink/api/java/functions/SemanticPropUtil.java
@@ -153,6 +153,85 @@ public class SemanticPropUtil {
 		return dsp;
 	}
 
+	/**
+	 * Creates SemanticProperties by adding an offset to each input field index of the given SemanticProperties.
+	 *
+	 * @param props The SemanticProperties to which the offset is added.
+	 * @param numInputFields The original number of fields of the input.
+	 * @param offset The offset that is added to each input field index.
+	 * @return New SemanticProperties with added offset.
+	 */
+	public static SingleInputSemanticProperties addSourceFieldOffset(SingleInputSemanticProperties props,
+																		int numInputFields, int offset) {
+
+		SingleInputSemanticProperties offsetProps = new SingleInputSemanticProperties();
+		if (props.getReadFields(0) != null) {
+			FieldSet offsetReadFields = new FieldSet();
+			for (int r : props.getReadFields(0)) {
+				offsetReadFields = offsetReadFields.addField(r + offset);
+			}
+			offsetProps.addReadFields(offsetReadFields);
+		}
+		for (int s = 0; s < numInputFields; s++) {
+			FieldSet targetFields = props.getForwardingTargetFields(0, s);
+			for (int t : targetFields) {
+				offsetProps.addForwardedField(s + offset, t);
+			}
+		}
+		return offsetProps;
+	}
+
+	/**
+	 * Creates SemanticProperties by adding offsets to each input field index of the given SemanticProperties.
+	 *
+	 * @param props The SemanticProperties to which the offset is added.
+	 * @param numInputFields1 The original number of fields of the first input.
+	 * @param numInputFields2 The original number of fields of the second input.
+	 * @param offset1 The offset that is added to each input field index of the first input.
+	 * @param offset2 The offset that is added to each input field index of the second input.
+	 * @return New SemanticProperties with added offsets.
+	 */
+	public static DualInputSemanticProperties addSourceFieldOffsets(DualInputSemanticProperties props,
+																	int numInputFields1, int numInputFields2,
+																	int offset1, int offset2) {
+
+		DualInputSemanticProperties offsetProps = new DualInputSemanticProperties();
+
+		// add offset to read fields on first input
+		if(props.getReadFields(0) != null) {
+			FieldSet offsetReadFields = new FieldSet();
+			for(int r : props.getReadFields(0)) {
+				offsetReadFields = offsetReadFields.addField(r+offset1);
+			}
+			offsetProps.addReadFields(0, offsetReadFields);
+		}
+		// add offset to read fields on second input
+		if(props.getReadFields(1) != null) {
+			FieldSet offsetReadFields = new FieldSet();
+			for(int r : props.getReadFields(1)) {
+				offsetReadFields = offsetReadFields.addField(r+offset2);
+			}
+			offsetProps.addReadFields(1, offsetReadFields);
+		}
+
+		// add offset to forward fields on first input
+		for(int s = 0; s < numInputFields1; s++) {
+			FieldSet targetFields = props.getForwardingTargetFields(0, s);
+			for(int t : targetFields) {
+				offsetProps.addForwardedField(0, s + offset1, t);
+			}
+		}
+		// add offset to forward fields on second input
+		for(int s = 0; s < numInputFields2; s++) {
+			FieldSet targetFields = props.getForwardingTargetFields(1, s);
+			for(int t : targetFields) {
+				offsetProps.addForwardedField(1, s + offset2, t);
+			}
+		}
+
+		return offsetProps;
+	}
+
 	public static SingleInputSemanticProperties getSemanticPropsSingle(
 			Set<Annotation> set, TypeInformation<?> inType, TypeInformation<?> outType) {
 		if (set == null) {
diff --git a/flink-java/src/main/java/org/apache/flink/api/java/operators/CoGroupOperator.java b/flink-java/src/main/java/org/apache/flink/api/java/operators/CoGroupOperator.java
index a051eb0e03e..115a238ad12 100644
--- a/flink-java/src/main/java/org/apache/flink/api/java/operators/CoGroupOperator.java
+++ b/flink-java/src/main/java/org/apache/flink/api/java/operators/CoGroupOperator.java
@@ -30,6 +30,7 @@ import org.apache.flink.api.common.functions.CoGroupFunction;
 import org.apache.flink.api.common.functions.MapFunction;
 import org.apache.flink.api.common.functions.Partitioner;
 import org.apache.flink.api.common.operators.BinaryOperatorInformation;
+import org.apache.flink.api.common.operators.DualInputSemanticProperties;
 import org.apache.flink.api.common.operators.Operator;
 import org.apache.flink.api.common.operators.Order;
 import org.apache.flink.api.common.operators.Ordering;
@@ -40,6 +41,7 @@ import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.common.typeutils.CompositeType;
 import org.apache.flink.api.java.DataSet;
 import org.apache.flink.api.java.Utils;
+import org.apache.flink.api.java.functions.SemanticPropUtil;
 import org.apache.flink.api.java.operators.DeltaIteration.SolutionSetPlaceHolder;
 import org.apache.flink.api.java.functions.KeySelector;
 import org.apache.flink.api.java.operators.Keys.ExpressionKeys;
@@ -129,6 +131,29 @@ public class CoGroupOperator<I1, I2, OUT> extends TwoInputUdfOperator<I1, I2, OU
 		return function;
 	}
 
+	@Override
+	public DualInputSemanticProperties getSemanticProperties() {
+
+		DualInputSemanticProperties props = super.getSemanticProperties();
+
+		// offset semantic information by extracted key fields
+		if(props != null &&
+					(this.keys1 instanceof Keys.SelectorFunctionKeys ||
+					this.keys2 instanceof Keys.SelectorFunctionKeys)) {
+
+			int numFields1 = this.getInput1Type().getTotalFields();
+			int numFields2 = this.getInput2Type().getTotalFields();
+			int offset1 = (this.keys1 instanceof Keys.SelectorFunctionKeys) ?
+					((Keys.SelectorFunctionKeys) this.keys1).getKeyType().getTotalFields() : 0;
+			int offset2 = (this.keys2 instanceof Keys.SelectorFunctionKeys) ?
+					((Keys.SelectorFunctionKeys) this.keys2).getKeyType().getTotalFields() : 0;
+
+			props = SemanticPropUtil.addSourceFieldOffsets(props, numFields1, numFields2, offset1, offset2);
+		}
+
+		return props;
+	}
+
 	protected Keys<I1> getKeys1() {
 		return this.keys1;
 	}
diff --git a/flink-java/src/main/java/org/apache/flink/api/java/operators/GroupCombineOperator.java b/flink-java/src/main/java/org/apache/flink/api/java/operators/GroupCombineOperator.java
index 911c608e3e8..dc26fecd2cd 100644
--- a/flink-java/src/main/java/org/apache/flink/api/java/operators/GroupCombineOperator.java
+++ b/flink-java/src/main/java/org/apache/flink/api/java/operators/GroupCombineOperator.java
@@ -23,11 +23,13 @@ import org.apache.flink.api.common.functions.MapFunction;
 import org.apache.flink.api.common.operators.Operator;
 import org.apache.flink.api.common.operators.Order;
 import org.apache.flink.api.common.operators.Ordering;
+import org.apache.flink.api.common.operators.SingleInputSemanticProperties;
 import org.apache.flink.api.common.operators.UnaryOperatorInformation;
 import org.apache.flink.api.common.operators.base.GroupCombineOperatorBase;
 import org.apache.flink.api.common.operators.base.MapOperatorBase;
 import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.java.DataSet;
+import org.apache.flink.api.java.functions.SemanticPropUtil;
 import org.apache.flink.api.java.operators.translation.KeyExtractingMapper;
 import org.apache.flink.api.java.operators.translation.PlanUnwrappingGroupCombineOperator;
 import org.apache.flink.api.java.operators.translation.PlanUnwrappingSortedGroupCombineOperator;
@@ -86,6 +88,27 @@ public class GroupCombineOperator<IN, OUT> extends SingleInputUdfOperator<IN, OU
 		return function;
 	}
 
+	@Override
+	public SingleInputSemanticProperties getSemanticProperties() {
+
+		SingleInputSemanticProperties props = super.getSemanticProperties();
+
+		// offset semantic information by extracted key fields
+		if(props != null &&
+				this.grouper != null &&
+				this.grouper.keys instanceof Keys.SelectorFunctionKeys) {
+
+			int offset = ((Keys.SelectorFunctionKeys) this.grouper.keys).getKeyType().getTotalFields();
+			if(this.grouper instanceof SortedGrouping) {
+				offset += ((SortedGrouping) this.grouper).getSortSelectionFunctionKey().getKeyType().getTotalFields();
+			}
+
+			props = SemanticPropUtil.addSourceFieldOffset(props, this.getInputType().getTotalFields(), offset);
+		}
+
+		return props;
+	}
+
 	// --------------------------------------------------------------------------------------------
 	//  Translation
 	// --------------------------------------------------------------------------------------------
diff --git a/flink-java/src/main/java/org/apache/flink/api/java/operators/GroupReduceOperator.java b/flink-java/src/main/java/org/apache/flink/api/java/operators/GroupReduceOperator.java
index c96b7c6977e..bc4413f795e 100644
--- a/flink-java/src/main/java/org/apache/flink/api/java/operators/GroupReduceOperator.java
+++ b/flink-java/src/main/java/org/apache/flink/api/java/operators/GroupReduceOperator.java
@@ -24,11 +24,13 @@ import org.apache.flink.api.common.functions.MapFunction;
 import org.apache.flink.api.common.operators.Operator;
 import org.apache.flink.api.common.operators.Order;
 import org.apache.flink.api.common.operators.Ordering;
+import org.apache.flink.api.common.operators.SingleInputSemanticProperties;
 import org.apache.flink.api.common.operators.UnaryOperatorInformation;
 import org.apache.flink.api.common.operators.base.GroupReduceOperatorBase;
 import org.apache.flink.api.common.operators.base.MapOperatorBase;
 import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.common.functions.RichGroupReduceFunction;
+import org.apache.flink.api.java.functions.SemanticPropUtil;
 import org.apache.flink.api.java.operators.translation.KeyExtractingMapper;
 import org.apache.flink.api.java.operators.translation.PlanUnwrappingReduceGroupOperator;
 import org.apache.flink.api.java.operators.translation.PlanUnwrappingSortedReduceGroupOperator;
@@ -120,6 +122,26 @@ public class GroupReduceOperator<IN, OUT> extends SingleInputUdfOperator<IN, OUT
 		return this;
 	}
 
+	@Override
+	public SingleInputSemanticProperties getSemanticProperties() {
+
+		SingleInputSemanticProperties props = super.getSemanticProperties();
+
+		// offset semantic information by extracted key fields
+		if(props != null &&
+				this.grouper != null &&
+				this.grouper.keys instanceof Keys.SelectorFunctionKeys) {
+
+			int offset = ((Keys.SelectorFunctionKeys) this.grouper.keys).getKeyType().getTotalFields();
+			if(this.grouper instanceof SortedGrouping) {
+				offset += ((SortedGrouping) this.grouper).getSortSelectionFunctionKey().getKeyType().getTotalFields();
+			}
+			props = SemanticPropUtil.addSourceFieldOffset(props, this.getInputType().getTotalFields(), offset);
+		}
+
+		return props;
+	}
+
 	// --------------------------------------------------------------------------------------------
 	//  Translation
 	// --------------------------------------------------------------------------------------------
diff --git a/flink-java/src/main/java/org/apache/flink/api/java/operators/JoinOperator.java b/flink-java/src/main/java/org/apache/flink/api/java/operators/JoinOperator.java
index e450ae184e1..4adf6b329b5 100644
--- a/flink-java/src/main/java/org/apache/flink/api/java/operators/JoinOperator.java
+++ b/flink-java/src/main/java/org/apache/flink/api/java/operators/JoinOperator.java
@@ -224,6 +224,29 @@ public abstract class JoinOperator<I1, I2, OUT> extends TwoInputUdfOperator<I1,
 			return function;
 		}
 
+		@Override
+		public DualInputSemanticProperties getSemanticProperties() {
+
+			DualInputSemanticProperties props = super.getSemanticProperties();
+
+			// offset semantic information by extracted key fields
+			if(props != null &&
+					(this.keys1 instanceof Keys.SelectorFunctionKeys ||
+							this.keys2 instanceof Keys.SelectorFunctionKeys)) {
+
+				int numFields1 = this.getInput1Type().getTotalFields();
+				int numFields2 = this.getInput2Type().getTotalFields();
+				int offset1 = (this.keys1 instanceof Keys.SelectorFunctionKeys) ?
+						((Keys.SelectorFunctionKeys) this.keys1).getKeyType().getTotalFields() : 0;
+				int offset2 = (this.keys2 instanceof Keys.SelectorFunctionKeys) ?
+						((Keys.SelectorFunctionKeys) this.keys2).getKeyType().getTotalFields() : 0;
+
+				props = SemanticPropUtil.addSourceFieldOffsets(props, numFields1, numFields2, offset1, offset2);
+			}
+
+			return props;
+		}
+
 		@Override
 		protected DualInputSemanticProperties extractSemanticAnnotationsFromUdf(Class<?> udfClass) {
 			if (function instanceof DefaultJoin.WrappingFlatJoinFunction) {
diff --git a/flink-java/src/main/java/org/apache/flink/api/java/operators/ReduceOperator.java b/flink-java/src/main/java/org/apache/flink/api/java/operators/ReduceOperator.java
index 5951df832c7..e7702784597 100644
--- a/flink-java/src/main/java/org/apache/flink/api/java/operators/ReduceOperator.java
+++ b/flink-java/src/main/java/org/apache/flink/api/java/operators/ReduceOperator.java
@@ -21,10 +21,12 @@ package org.apache.flink.api.java.operators;
 import org.apache.flink.api.common.functions.MapFunction;
 import org.apache.flink.api.common.functions.ReduceFunction;
 import org.apache.flink.api.common.operators.Operator;
+import org.apache.flink.api.common.operators.SingleInputSemanticProperties;
 import org.apache.flink.api.common.operators.UnaryOperatorInformation;
 import org.apache.flink.api.common.operators.base.MapOperatorBase;
 import org.apache.flink.api.common.operators.base.ReduceOperatorBase;
 import org.apache.flink.api.common.typeinfo.TypeInformation;
+import org.apache.flink.api.java.functions.SemanticPropUtil;
 import org.apache.flink.api.java.operators.translation.KeyExtractingMapper;
 import org.apache.flink.api.java.operators.translation.KeyRemovingMapper;
 import org.apache.flink.api.java.operators.translation.PlanUnwrappingReduceOperator;
@@ -77,6 +79,26 @@ public class ReduceOperator<IN> extends SingleInputUdfOperator<IN, IN, ReduceOpe
 		return function;
 	}
 
+	@Override
+	public SingleInputSemanticProperties getSemanticProperties() {
+
+		SingleInputSemanticProperties props = super.getSemanticProperties();
+
+		// offset semantic information by extracted key fields
+		if(props != null &&
+				this.grouper != null &&
+				this.grouper.keys instanceof Keys.SelectorFunctionKeys) {
+
+			int offset = ((Keys.SelectorFunctionKeys) this.grouper.keys).getKeyType().getTotalFields();
+			if(this.grouper instanceof SortedGrouping) {
+				offset += ((SortedGrouping) this.grouper).getSortSelectionFunctionKey().getKeyType().getTotalFields();
+			}
+			props = SemanticPropUtil.addSourceFieldOffset(props, this.getInputType().getTotalFields(), offset);
+		}
+
+		return props;
+	}
+
 	@Override
 	protected org.apache.flink.api.common.operators.SingleInputOperator<?, IN, ?> translateToDataFlow(Operator<IN> input) {
 		
diff --git a/flink-java/src/main/java/org/apache/flink/api/java/operators/translation/TwoKeyExtractingMapper.java b/flink-java/src/main/java/org/apache/flink/api/java/operators/translation/TwoKeyExtractingMapper.java
index 48d2d1ac42e..a98c8996004 100644
--- a/flink-java/src/main/java/org/apache/flink/api/java/operators/translation/TwoKeyExtractingMapper.java
+++ b/flink-java/src/main/java/org/apache/flink/api/java/operators/translation/TwoKeyExtractingMapper.java
@@ -18,11 +18,12 @@
 
 package org.apache.flink.api.java.operators.translation;
 
+import org.apache.flink.api.java.functions.FunctionAnnotation.ForwardedFields;
 import org.apache.flink.api.java.functions.KeySelector;
 import org.apache.flink.api.common.functions.RichMapFunction;
 import org.apache.flink.api.java.tuple.Tuple3;
 
-
+@ForwardedFields("*->2")
 public final class TwoKeyExtractingMapper<T, K1, K2> extends RichMapFunction<T, Tuple3<K1, K2, T>> {
 
 	private static final long serialVersionUID = 1L;
diff --git a/flink-java/src/test/java/org/apache/flink/api/java/functions/SemanticPropUtilTest.java b/flink-java/src/test/java/org/apache/flink/api/java/functions/SemanticPropUtilTest.java
index cf81550f32c..372c0f75cac 100644
--- a/flink-java/src/test/java/org/apache/flink/api/java/functions/SemanticPropUtilTest.java
+++ b/flink-java/src/test/java/org/apache/flink/api/java/functions/SemanticPropUtilTest.java
@@ -19,6 +19,7 @@
 
 package org.apache.flink.api.java.functions;
 
+import org.apache.flink.api.common.operators.SemanticProperties;
 import org.apache.flink.api.common.operators.SemanticProperties.InvalidSemanticAnnotationException;
 import org.apache.flink.api.common.typeutils.CompositeType;
 import org.apache.flink.api.java.typeutils.TypeExtractor;
@@ -34,6 +35,8 @@ import org.apache.flink.api.java.tuple.Tuple5;
 import org.apache.flink.api.java.typeutils.TupleTypeInfo;
 import org.junit.Test;
 
+import static org.junit.Assert.assertTrue;
+
 public class SemanticPropUtilTest {
 	
 	private final TypeInformation<?> threeIntTupleType = new TupleTypeInfo<Tuple3<Integer, Integer, Integer>>(BasicTypeInfo.INT_TYPE_INFO,
@@ -74,43 +77,43 @@ public class SemanticPropUtilTest {
 
 		int[] pMap = new int[] {3,0,4};
 		SingleInputSemanticProperties sp = SemanticPropUtil.createProjectionPropertiesSingle(pMap, (CompositeType<?>) fiveIntTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(2));
 
 		pMap = new int[] {2,2,1,1};
 		sp = SemanticPropUtil.createProjectionPropertiesSingle(pMap, (CompositeType<?>) fiveIntTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).size() == 2);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 2);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 1).size() == 2);
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 2);
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
 
 		pMap = new int[] {2,0};
 		sp = SemanticPropUtil.createProjectionPropertiesSingle(pMap, (CompositeType<?>) nestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
 
 		pMap = new int[] {2,0,1};
 		sp = SemanticPropUtil.createProjectionPropertiesSingle(pMap, (CompositeType<?>) deepNestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 6).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(5));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).contains(6));
+		assertTrue(sp.getForwardingTargetFields(0, 6).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 5).contains(6));
 
 		pMap = new int[] {2, 1};
 		sp = SemanticPropUtil.createProjectionPropertiesSingle(pMap, (CompositeType<?>) pojoInTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(4));
 
 	}
 
@@ -121,88 +124,199 @@ public class SemanticPropUtilTest {
 		boolean[] iMap = new boolean[]{true, true, false, true, false, false};
 		DualInputSemanticProperties sp = SemanticPropUtil.createProjectionPropertiesDual(pMap, iMap,
 				fiveIntTupleType, fiveIntTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 0).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 3).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 4).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
+		assertTrue(sp.getForwardingTargetFields(1, 0).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(3));
+		assertTrue(sp.getForwardingTargetFields(1, 3).contains(4));
+		assertTrue(sp.getForwardingTargetFields(1, 4).contains(5));
 
 		pMap = new int[]{4,2,0,4,0,1};
 		iMap = new boolean[]{true, true, false, true, false, false};
 		sp = SemanticPropUtil.createProjectionPropertiesDual(pMap, iMap, fiveIntTupleType, fiveIntTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).size() == 2);
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 0).size() == 2);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 0).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 0).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 1).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 4).size() == 2);
+		assertTrue(sp.getForwardingTargetFields(1, 0).size() == 2);
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
+		assertTrue(sp.getForwardingTargetFields(1, 0).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(3));
+		assertTrue(sp.getForwardingTargetFields(1, 0).contains(4));
+		assertTrue(sp.getForwardingTargetFields(1, 1).contains(5));
 
 		pMap = new int[]{2,1,0,1};
 		iMap = new boolean[]{false, false, true, true};
 		sp = SemanticPropUtil.createProjectionPropertiesDual(pMap, iMap, nestedTupleType, threeIntTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 2).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(5));
+		assertTrue(sp.getForwardingTargetFields(1, 2).contains(0));
+		assertTrue(sp.getForwardingTargetFields(1, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(5));
 
 		pMap = new int[]{1,0,0};
 		iMap = new boolean[]{false, false, true};
 		sp = SemanticPropUtil.createProjectionPropertiesDual(pMap, iMap, nestedTupleType, deepNestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 1).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 2).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 3).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 4).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 5).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 0).contains(5));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(6));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(7));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(8));
+		assertTrue(sp.getForwardingTargetFields(1, 1).contains(0));
+		assertTrue(sp.getForwardingTargetFields(1, 2).contains(1));
+		assertTrue(sp.getForwardingTargetFields(1, 3).contains(2));
+		assertTrue(sp.getForwardingTargetFields(1, 4).contains(3));
+		assertTrue(sp.getForwardingTargetFields(1, 5).contains(4));
+		assertTrue(sp.getForwardingTargetFields(1, 0).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(6));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(7));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(8));
 
 		pMap = new int[]{4,2,1,0};
 		iMap = new boolean[]{true, false, true, false};
 		sp = SemanticPropUtil.createProjectionPropertiesDual(pMap, iMap, fiveIntTupleType, pojoInTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 2).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 3).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 4).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 5).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(5));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 0).contains(6));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(0));
+		assertTrue(sp.getForwardingTargetFields(1, 2).contains(1));
+		assertTrue(sp.getForwardingTargetFields(1, 3).contains(2));
+		assertTrue(sp.getForwardingTargetFields(1, 4).contains(3));
+		assertTrue(sp.getForwardingTargetFields(1, 5).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(5));
+		assertTrue(sp.getForwardingTargetFields(1, 0).contains(6));
 
 		pMap = new int[]{2,3,-1,0};
 		iMap = new boolean[]{true, true, false, true};
 		sp = SemanticPropUtil.createProjectionPropertiesDual(pMap, iMap, fiveIntTupleType, intType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 0).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(sp.getForwardingTargetFields(1, 0).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(3));
 
 		pMap = new int[]{-1,-1};
 		iMap = new boolean[]{false, true};
 		sp = SemanticPropUtil.createProjectionPropertiesDual(pMap, iMap, intType, nestedPojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 3).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 4).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 5).contains(5));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(6));
+		assertTrue(sp.getForwardingTargetFields(1, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(1, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(1, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(1, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(1, 4).contains(4));
+		assertTrue(sp.getForwardingTargetFields(1, 5).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(6));
 
 		pMap = new int[]{-1,-1};
 		iMap = new boolean[]{true, false};
 		sp = SemanticPropUtil.createProjectionPropertiesDual(pMap, iMap, intType, nestedPojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 0).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 1).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 2).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 3).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 4).contains(5));
-		Assert.assertTrue(sp.getForwardingTargetFields(1, 5).contains(6));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(1, 0).contains(1));
+		assertTrue(sp.getForwardingTargetFields(1, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(1, 2).contains(3));
+		assertTrue(sp.getForwardingTargetFields(1, 3).contains(4));
+		assertTrue(sp.getForwardingTargetFields(1, 4).contains(5));
+		assertTrue(sp.getForwardingTargetFields(1, 5).contains(6));
+
+	}
+
+	// --------------------------------------------------------------------------------------------
+	// Offset
+	// --------------------------------------------------------------------------------------------
+
+	@Test
+	public void testAddSourceFieldOffset() {
+
+		SingleInputSemanticProperties semProps = new SingleInputSemanticProperties();
+		semProps.addForwardedField(0, 1);
+		semProps.addForwardedField(0, 4);
+		semProps.addForwardedField(2, 0);
+		semProps.addForwardedField(4, 3);
+		semProps.addReadFields(new FieldSet(0,3));
+
+		SemanticProperties offsetProps = SemanticPropUtil.addSourceFieldOffset(semProps, 5, 0);
+
+		assertTrue(offsetProps.getForwardingTargetFields(0, 0).size() == 2);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 0).contains(1));
+		assertTrue(offsetProps.getForwardingTargetFields(0, 0).contains(4));
+		assertTrue(offsetProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(offsetProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 4).contains(3));
+
+		assertTrue(offsetProps.getReadFields(0).size() == 2);
+		assertTrue(offsetProps.getReadFields(0).contains(0));
+		assertTrue(offsetProps.getReadFields(0).contains(3));
+
+		offsetProps = SemanticPropUtil.addSourceFieldOffset(semProps, 5, 3);
+
+		assertTrue(offsetProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 3).size() == 2);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(offsetProps.getForwardingTargetFields(0, 3).contains(4));
+		assertTrue(offsetProps.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 5).size() == 1);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 5).contains(0));
+		assertTrue(offsetProps.getForwardingTargetFields(0, 6).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 7).size() == 1);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 7).contains(3));
+
+		assertTrue(offsetProps.getReadFields(0).size() == 2);
+		assertTrue(offsetProps.getReadFields(0).contains(3));
+		assertTrue(offsetProps.getReadFields(0).contains(6));
+
+		semProps = new SingleInputSemanticProperties();
+		SemanticPropUtil.addSourceFieldOffset(semProps, 1, 0);
+
+		semProps = new SingleInputSemanticProperties();
+		semProps.addForwardedField(0, 0);
+		semProps.addForwardedField(1, 2);
+		semProps.addForwardedField(2, 4);
+
+		offsetProps = SemanticPropUtil.addSourceFieldOffset(semProps, 3, 2);
+
+		assertTrue(offsetProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(offsetProps.getForwardingTargetFields(0, 3).size() == 1);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 3).contains(2));
+		assertTrue(offsetProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 4).contains(4));
+
+	}
+
+	@Test
+	public void testAddSourceFieldOffsets() {
+
+		DualInputSemanticProperties semProps = new DualInputSemanticProperties();
+		semProps.addForwardedField(0, 0, 1);
+		semProps.addForwardedField(0, 3, 3);
+		semProps.addForwardedField(1, 1, 2);
+		semProps.addForwardedField(1, 1, 4);
+		semProps.addReadFields(0, new FieldSet(1, 2));
+		semProps.addReadFields(1, new FieldSet(0, 3, 4));
+
+		DualInputSemanticProperties offsetProps = SemanticPropUtil.addSourceFieldOffsets(semProps, 4, 3, 1, 2);
+
+		assertTrue(offsetProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 1).size() == 1);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(offsetProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(offsetProps.getForwardingTargetFields(0, 4).contains(3));
+
+		assertTrue(offsetProps.getForwardingTargetFields(1, 0).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(1, 1).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(1, 2).size() == 0);
+		assertTrue(offsetProps.getForwardingTargetFields(1, 3).size() == 2);
+		assertTrue(offsetProps.getForwardingTargetFields(1, 3).contains(2));
+		assertTrue(offsetProps.getForwardingTargetFields(1, 3).contains(4));
+
+		assertTrue(offsetProps.getReadFields(0).size() == 2);
+		assertTrue(offsetProps.getReadFields(0).contains(2));
+		assertTrue(offsetProps.getReadFields(0).contains(3));
+		assertTrue(offsetProps.getReadFields(1).size() == 3);
+		assertTrue(offsetProps.getReadFields(1).contains(2));
+		assertTrue(offsetProps.getReadFields(1).contains(5));
+		assertTrue(offsetProps.getReadFields(1).contains(6));
+
+		semProps = new DualInputSemanticProperties();
+		SemanticPropUtil.addSourceFieldOffsets(semProps, 4, 3, 2, 2);
 
 	}
 
@@ -216,9 +330,9 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, fiveIntTupleType, fiveIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
 	}
 
 	@Test
@@ -227,23 +341,23 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, fiveIntTupleType, fiveIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
 
 		forwardedFields[0] = "2;3;0";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, fiveIntTupleType, fiveIntTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
 
 		forwardedFields[0] = "2;3;0;";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, fiveIntTupleType, fiveIntTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
 	}
 
 	@Test
@@ -252,9 +366,9 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, fiveIntTupleType, fiveIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
 	}
 
 	@Test
@@ -263,8 +377,8 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, threeIntTupleType, fiveIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
 	}
 
 	@Test
@@ -273,14 +387,14 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, threeIntTupleType, fiveIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
 
 		forwardedFields[0] = "0->0;1->2";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, threeIntTupleType, fiveIntTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
 	}
 
 	@Test
@@ -289,8 +403,8 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, threeIntTupleType, fiveIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
 	}
 	
 	@Test
@@ -299,10 +413,10 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, fiveIntTupleType, fiveIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(0));
 	}
 
 	@Test
@@ -311,19 +425,19 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, threeIntTupleType, intType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
 
 		forwardedFields[0] = "*->f2";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, intType, threeIntTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(2));
 
 		forwardedFields[0] = "*->*";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, intType, intType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
 	}
 
 	@Test
@@ -332,19 +446,19 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, threeIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
 
 		forwardedFields[0] = "*";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, deepNestedTupleType, deepNestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
 
 	}
 
@@ -353,79 +467,79 @@ public class SemanticPropUtilTest {
 		String[] forwardedFields = { "f0->f0.f0; f1->f0.f1; f2->f0.f2" };
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, threeIntTupleType, nestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
 
 		forwardedFields[0] = "f0.f0->f1.f0.f2; f0.f1->f2; f2->f1.f2; f1->f0";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, nestedTupleType, deepNestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(6));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(5));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(6));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(0));
 
 		forwardedFields[0] = "0.0->1.0.2; 0.1->2; 2->1.2; 1->0";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, nestedTupleType, deepNestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(6));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(5));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(6));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(0));
 
 		forwardedFields[0] = "f1.f0.*->f0.*; f0->f2";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, deepNestedTupleType, nestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(4));
 
 		forwardedFields[0] = "1.0.*->0.*; 0->2";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, deepNestedTupleType, nestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(4));
 
 		forwardedFields[0] = "f1.f0->f0; f0->f2";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, deepNestedTupleType, nestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(4));
 
 		forwardedFields[0] = "1.0->0; 0->2";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, deepNestedTupleType, nestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(4));
 
 		forwardedFields[0] = "f1.f0.f1; f1.f1; f2";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, deepNestedTupleType, deepNestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 6).contains(6));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 6).contains(6));
+		assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
 
 		forwardedFields[0] = "f1.f0.*; f1.f2";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, deepNestedTupleType, deepNestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).contains(5));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 6).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 5).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 6).size() == 0);
 
 	}
 
@@ -435,118 +549,118 @@ public class SemanticPropUtilTest {
 		String[] forwardedFields = { "int1->int2; int3->int1; string1 " };
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, pojoType, pojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
 
 		forwardedFields[0] = "f1->int1; f0->int3 ";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, threeIntTupleType, pojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
 
 		forwardedFields[0] = "int1->f2; int2->f0; int3->f1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, pojoType, threeIntTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(1));
 
 		forwardedFields[0] = "*->pojo1.*";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, pojoType, nestedPojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(4));
 
 		forwardedFields[0] = "*->pojo1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, pojoType, nestedPojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(4));
 
 		forwardedFields[0] = "int1; string1; int2->pojo1.int3";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, pojoType, nestedPojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(5));
 
 		forwardedFields[0] = "pojo1.*->f2.*; int1->f1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, nestedPojoType, pojoInTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(5));
 
 		forwardedFields[0] = "f2.*->*";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, pojoInTupleType, pojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 5).contains(3));
 
 		forwardedFields[0] = "pojo1->f2; int1->f1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, nestedPojoType, pojoInTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(5));
 
 		forwardedFields[0] = "f2->*";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, pojoInTupleType, pojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 5).contains(3));
 
 		forwardedFields[0] = "int2; string1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, pojoType, pojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
 
 		forwardedFields[0] = "pojo1.int1; string1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, nestedPojoType, nestedPojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).contains(5));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 5).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 4).size() == 0);
 
 		forwardedFields[0] = "pojo1.*; int1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, nestedPojoType, nestedPojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
 
 		forwardedFields[0] = "pojo1; int1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, null, nestedPojoType, nestedPojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
 	}
 
 	@Test(expected = InvalidSemanticAnnotationException.class)
@@ -664,9 +778,9 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, threeIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
 	}
 
 	@Test
@@ -675,17 +789,17 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, threeIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
 
 		nonForwardedFields[0] = "f1;f2;";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, threeIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
 	}
 
 	@Test
@@ -694,9 +808,9 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, threeIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
 	}
 
 	@Test
@@ -705,9 +819,9 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, threeIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
 	}
 
 	@Test
@@ -716,36 +830,36 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, deepNestedTupleType, deepNestedTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 6).contains(6));
+		assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 6).contains(6));
 
 		nonForwardedFields[0] = "f1.f0; f1.f2; f0";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, deepNestedTupleType, deepNestedTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 6).contains(6));
+		assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 6).contains(6));
 
 		nonForwardedFields[0] = "f2; f1.f1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, deepNestedTupleType, deepNestedTupleType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).contains(5));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 6).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 5).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 6).size() == 0);
 
 	}
 
@@ -755,10 +869,10 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, pojoType, pojoType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
 
 	}
 
@@ -768,22 +882,22 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, nestedPojoType, nestedPojoType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).contains(5));
+		assertTrue(sp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 5).contains(5));
 
 		nonForwardedFields[0] = "pojo1.int2; string1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, null, nestedPojoType, nestedPojoType);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(1));
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(sp.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(sp.getForwardingTargetFields(0, 5).size() == 0);
 	}
 
 	@Test(expected = InvalidSemanticAnnotationException.class)
@@ -847,9 +961,9 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, threeIntTupleType, threeIntTupleType);
 
 		FieldSet fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 2);
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(1));
+		assertTrue(fs.size() == 2);
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(1));
 	}
 	
 	@Test
@@ -859,18 +973,18 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, threeIntTupleType, threeIntTupleType);
 
 		FieldSet fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 2);
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(1));
+		assertTrue(fs.size() == 2);
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(1));
 
 		readFields[0] = "f1;f2;";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, threeIntTupleType, threeIntTupleType);
 
 		fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 2);
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(1));
+		assertTrue(fs.size() == 2);
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(1));
 	}
 
 	@Test
@@ -880,9 +994,9 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, threeIntTupleType, threeIntTupleType);
 
 		FieldSet fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 2);
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(1));
+		assertTrue(fs.size() == 2);
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(1));
 	}
 
 	@Test
@@ -892,15 +1006,15 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, intType, intType);
 
 		FieldSet fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 1);
-		Assert.assertTrue(fs.contains(0));
+		assertTrue(fs.size() == 1);
+		assertTrue(fs.contains(0));
 
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, intType, fiveIntTupleType);
 
 		fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 1);
-		Assert.assertTrue(fs.contains(0));
+		assertTrue(fs.size() == 1);
+		assertTrue(fs.contains(0));
 	}
 
 	@Test
@@ -910,21 +1024,21 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, nestedTupleType, intType);
 
 		FieldSet fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 3);
-		Assert.assertTrue(fs.contains(1));
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(4));
+		assertTrue(fs.size() == 3);
+		assertTrue(fs.contains(1));
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(4));
 
 		readFields[0] = "f0;f1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, nestedTupleType, intType);
 
 		fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 4);
-		Assert.assertTrue(fs.contains(0));
-		Assert.assertTrue(fs.contains(1));
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(3));
+		assertTrue(fs.size() == 4);
+		assertTrue(fs.contains(0));
+		assertTrue(fs.contains(1));
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(3));
 	}
 
 	@Test
@@ -934,23 +1048,23 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, nestedTupleType, intType);
 
 		FieldSet fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 5);
-		Assert.assertTrue(fs.contains(0));
-		Assert.assertTrue(fs.contains(1));
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(3));
-		Assert.assertTrue(fs.contains(4));
+		assertTrue(fs.size() == 5);
+		assertTrue(fs.contains(0));
+		assertTrue(fs.contains(1));
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(3));
+		assertTrue(fs.contains(4));
 
 		readFields[0] = "f0.*;f1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, nestedTupleType, intType);
 
 		fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 4);
-		Assert.assertTrue(fs.contains(0));
-		Assert.assertTrue(fs.contains(1));
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(3));
+		assertTrue(fs.size() == 4);
+		assertTrue(fs.contains(0));
+		assertTrue(fs.contains(1));
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(3));
 
 	}
 
@@ -961,20 +1075,20 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, pojoType, threeIntTupleType);
 
 		FieldSet fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 2);
-		Assert.assertTrue(fs.contains(1));
-		Assert.assertTrue(fs.contains(3));
+		assertTrue(fs.size() == 2);
+		assertTrue(fs.contains(1));
+		assertTrue(fs.contains(3));
 
 		readFields[0] = "*";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, pojoType, intType);
 
 		fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 4);
-		Assert.assertTrue(fs.contains(0));
-		Assert.assertTrue(fs.contains(1));
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(3));
+		assertTrue(fs.size() == 4);
+		assertTrue(fs.contains(0));
+		assertTrue(fs.contains(1));
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(3));
 	}
 
 	@Test
@@ -984,32 +1098,32 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, nestedPojoType, intType);
 
 		FieldSet fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 3);
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(4));
-		Assert.assertTrue(fs.contains(5));
+		assertTrue(fs.size() == 3);
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(4));
+		assertTrue(fs.contains(5));
 
 		readFields[0] = "pojo1.*";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, nestedPojoType, intType);
 
 		fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 4);
-		Assert.assertTrue(fs.contains(1));
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(3));
-		Assert.assertTrue(fs.contains(4));
+		assertTrue(fs.size() == 4);
+		assertTrue(fs.contains(1));
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(3));
+		assertTrue(fs.contains(4));
 
 		readFields[0] = "pojo1";
 		sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, nestedPojoType, intType);
 
 		fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 4);
-		Assert.assertTrue(fs.contains(1));
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(3));
-		Assert.assertTrue(fs.contains(4));
+		assertTrue(fs.size() == 4);
+		assertTrue(fs.contains(1));
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(3));
+		assertTrue(fs.contains(4));
 	}
 
 	@Test
@@ -1019,10 +1133,10 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, null, readFields, pojoInTupleType, pojo2Type);
 
 		FieldSet fs = sp.getReadFields(0);
-		Assert.assertTrue(fs.size() == 3);
-		Assert.assertTrue(fs.contains(0));
-		Assert.assertTrue(fs.contains(2));
-		Assert.assertTrue(fs.contains(5));
+		assertTrue(fs.size() == 3);
+		assertTrue(fs.contains(0));
+		assertTrue(fs.contains(2));
+		assertTrue(fs.contains(5));
 	}
 
 	@Test(expected = InvalidSemanticAnnotationException.class)
@@ -1044,12 +1158,12 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, forwardedFieldsFirst, forwardedFieldsSecond, null,
 				null, null, null, fourIntTupleType, fourIntTupleType, fourIntTupleType);
 
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 1).contains(2));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 2).contains(3));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 2).contains(0));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 3).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(dsp.getForwardingTargetFields(0, 2).contains(3));
+		assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
+		assertTrue(dsp.getForwardingTargetFields(1, 2).contains(0));
+		assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 3).size() == 0);
 
 		forwardedFieldsFirst[0] = "f1->f0;f3->f1";
 		forwardedFieldsSecond[0] = "*->f2.*";
@@ -1057,14 +1171,14 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, forwardedFieldsFirst, forwardedFieldsSecond, null,
 				null, null, null, fourIntTupleType, pojoType, pojoInTupleType);
 
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 1).contains(0));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 3).contains(1));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 0).contains(2));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 1).contains(3));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 2).contains(4));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 3).contains(5));
+		assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 1).contains(0));
+		assertTrue(dsp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(dsp.getForwardingTargetFields(1, 0).contains(2));
+		assertTrue(dsp.getForwardingTargetFields(1, 1).contains(3));
+		assertTrue(dsp.getForwardingTargetFields(1, 2).contains(4));
+		assertTrue(dsp.getForwardingTargetFields(1, 3).contains(5));
 
 		forwardedFieldsFirst[0] = "f1.f0.f2->int1; f2->pojo1.int3";
 		forwardedFieldsSecond[0] = "string1; int2->pojo1.int1; int1->pojo1.int2";
@@ -1072,17 +1186,17 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, forwardedFieldsFirst, forwardedFieldsSecond, null,
 				null, null, null, deepNestedTupleType, pojoType, nestedPojoType);
 
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 3).contains(0));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 4).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 5).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 6).contains(3));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 0).contains(2));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 2).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 3).contains(5));
+		assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 3).contains(0));
+		assertTrue(dsp.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 6).contains(3));
+		assertTrue(dsp.getForwardingTargetFields(1, 0).contains(2));
+		assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
+		assertTrue(dsp.getForwardingTargetFields(1, 2).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 3).contains(5));
 
 		String[] forwardedFieldsFirst2 = { "f1.f0.f2->int1", "f2->pojo1.int3" };
 		String[] forwardedFieldsSecond2 = { "string1", "int2->pojo1.int1", "int1->pojo1.int2" };
@@ -1090,17 +1204,17 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, forwardedFieldsFirst2, forwardedFieldsSecond2, null,
 				null, null, null, deepNestedTupleType, pojoType, nestedPojoType);
 
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 3).contains(0));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 4).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 5).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 6).contains(3));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 0).contains(2));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 2).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 3).contains(5));
+		assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 3).contains(0));
+		assertTrue(dsp.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 6).contains(3));
+		assertTrue(dsp.getForwardingTargetFields(1, 0).contains(2));
+		assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
+		assertTrue(dsp.getForwardingTargetFields(1, 2).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 3).contains(5));
 	}
 
 
@@ -1112,12 +1226,12 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, null, null,
 				nonNorwardedFieldsFirst, nonNorwardedFieldsSecond, null, null, threeIntTupleType, threeIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 0).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 2).contains(2));
+		assertTrue(dsp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 0).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
+		assertTrue(dsp.getForwardingTargetFields(1, 2).contains(2));
 
 		nonNorwardedFieldsFirst[0] = "f1";
 		nonNorwardedFieldsSecond[0] = "";
@@ -1125,12 +1239,12 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, null, null,
 				nonNorwardedFieldsFirst, null, null, null, threeIntTupleType, fiveIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 0).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 1).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 2).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(dsp.getForwardingTargetFields(1, 0).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 1).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 2).size() == 0);
 
 		nonNorwardedFieldsFirst[0] = "";
 		nonNorwardedFieldsSecond[0] = "f2;f0";
@@ -1138,33 +1252,33 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, null, null,
 				null, nonNorwardedFieldsSecond, null, null, fiveIntTupleType, threeIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 0).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 2).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 0).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
+		assertTrue(dsp.getForwardingTargetFields(1, 2).size() == 0);
 
 		String[] nonForwardedFields = {"f1", "f3"};
 		dsp = new DualInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, null, null,
 				nonForwardedFields, null, null, null, fiveIntTupleType, threeIntTupleType, fiveIntTupleType);
 
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 2).contains(2));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 3).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(dsp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(dsp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 2).contains(2));
+		assertTrue(dsp.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(0, 4).contains(4));
 
 		dsp = new DualInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, null, null,
 				null, nonForwardedFields, null, null, threeIntTupleType, fiveIntTupleType, fiveIntTupleType);
 
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 0).contains(0));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 1).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 2).contains(2));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 3).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 4).contains(4));
+		assertTrue(dsp.getForwardingTargetFields(1, 0).contains(0));
+		assertTrue(dsp.getForwardingTargetFields(1, 1).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 2).contains(2));
+		assertTrue(dsp.getForwardingTargetFields(1, 3).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 4).contains(4));
 	}
 
 	@Test(expected = InvalidSemanticAnnotationException.class)
@@ -1193,11 +1307,11 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, null, null,
 				null, null, readFieldsFirst, readFieldsSecond, threeIntTupleType, threeIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(dsp.getReadFields(0).size() == 2);
-		Assert.assertTrue(dsp.getReadFields(0).contains(1));
-		Assert.assertTrue(dsp.getReadFields(0).contains(2));
-		Assert.assertTrue(dsp.getReadFields(1).size() == 1);
-		Assert.assertTrue(dsp.getReadFields(1).contains(0));
+		assertTrue(dsp.getReadFields(0).size() == 2);
+		assertTrue(dsp.getReadFields(0).contains(1));
+		assertTrue(dsp.getReadFields(0).contains(2));
+		assertTrue(dsp.getReadFields(1).size() == 1);
+		assertTrue(dsp.getReadFields(1).contains(0));
 
 		readFieldsFirst[0] = "f0.*; f2";
 		readFieldsSecond[0] = "int1; string1";
@@ -1205,14 +1319,14 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, null, null,
 				null, null, readFieldsFirst, readFieldsSecond, nestedTupleType, pojoType, threeIntTupleType);
 
-		Assert.assertTrue(dsp.getReadFields(0).size() == 4);
-		Assert.assertTrue(dsp.getReadFields(0).contains(0));
-		Assert.assertTrue(dsp.getReadFields(0).contains(1));
-		Assert.assertTrue(dsp.getReadFields(0).contains(2));
-		Assert.assertTrue(dsp.getReadFields(0).contains(4));
-		Assert.assertTrue(dsp.getReadFields(1).size() == 2);
-		Assert.assertTrue(dsp.getReadFields(1).contains(0));
-		Assert.assertTrue(dsp.getReadFields(1).contains(3));
+		assertTrue(dsp.getReadFields(0).size() == 4);
+		assertTrue(dsp.getReadFields(0).contains(0));
+		assertTrue(dsp.getReadFields(0).contains(1));
+		assertTrue(dsp.getReadFields(0).contains(2));
+		assertTrue(dsp.getReadFields(0).contains(4));
+		assertTrue(dsp.getReadFields(1).size() == 2);
+		assertTrue(dsp.getReadFields(1).contains(0));
+		assertTrue(dsp.getReadFields(1).contains(3));
 
 		readFieldsFirst[0] = "pojo1.int2; string1";
 		readFieldsSecond[0] = "f2.int2";
@@ -1220,25 +1334,25 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, null, null,
 				null, null, readFieldsFirst, readFieldsSecond, nestedPojoType, pojoInTupleType, threeIntTupleType);
 
-		Assert.assertTrue(dsp.getReadFields(0).size() == 2);
-		Assert.assertTrue(dsp.getReadFields(0).contains(2));
-		Assert.assertTrue(dsp.getReadFields(0).contains(5));
-		Assert.assertTrue(dsp.getReadFields(1).size() == 1);
-		Assert.assertTrue(dsp.getReadFields(1).contains(3));
+		assertTrue(dsp.getReadFields(0).size() == 2);
+		assertTrue(dsp.getReadFields(0).contains(2));
+		assertTrue(dsp.getReadFields(0).contains(5));
+		assertTrue(dsp.getReadFields(1).size() == 1);
+		assertTrue(dsp.getReadFields(1).contains(3));
 
 		String[] readFields = {"f0", "f2", "f4"};
 		dsp = new DualInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, null, null,
 				null, null, readFields, readFields, fiveIntTupleType, fiveIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(dsp.getReadFields(0).size() == 3);
-		Assert.assertTrue(dsp.getReadFields(0).contains(0));
-		Assert.assertTrue(dsp.getReadFields(0).contains(2));
-		Assert.assertTrue(dsp.getReadFields(0).contains(4));
-		Assert.assertTrue(dsp.getReadFields(1).size() == 3);
-		Assert.assertTrue(dsp.getReadFields(1).contains(0));
-		Assert.assertTrue(dsp.getReadFields(1).contains(2));
-		Assert.assertTrue(dsp.getReadFields(1).contains(4));
+		assertTrue(dsp.getReadFields(0).size() == 3);
+		assertTrue(dsp.getReadFields(0).contains(0));
+		assertTrue(dsp.getReadFields(0).contains(2));
+		assertTrue(dsp.getReadFields(0).contains(4));
+		assertTrue(dsp.getReadFields(1).size() == 3);
+		assertTrue(dsp.getReadFields(1).contains(0));
+		assertTrue(dsp.getReadFields(1).contains(2));
+		assertTrue(dsp.getReadFields(1).contains(4));
 	}
 
 	// --------------------------------------------------------------------------------------------
@@ -1252,11 +1366,11 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, forwardedFields, null, readFields, threeIntTupleType, fiveIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
-		Assert.assertTrue(sp.getReadFields(0).size() == 2);
-		Assert.assertTrue(sp.getReadFields(0).contains(0));
-		Assert.assertTrue(sp.getReadFields(0).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(sp.getReadFields(0).size() == 2);
+		assertTrue(sp.getReadFields(0).contains(0));
+		assertTrue(sp.getReadFields(0).contains(2));
 	}
 
 	@Test
@@ -1266,12 +1380,12 @@ public class SemanticPropUtilTest {
 		SingleInputSemanticProperties sp = new SingleInputSemanticProperties();
 		SemanticPropUtil.getSemanticPropsSingleFromString(sp, null, nonForwardedFields, readFields, threeIntTupleType, threeIntTupleType);
 
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
-		Assert.assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
-		Assert.assertTrue(sp.getReadFields(0).size() == 2);
-		Assert.assertTrue(sp.getReadFields(0).contains(0));
-		Assert.assertTrue(sp.getReadFields(0).contains(2));
+		assertTrue(sp.getForwardingTargetFields(0, 0).contains(0));
+		assertTrue(sp.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(sp.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(sp.getReadFields(0).size() == 2);
+		assertTrue(sp.getReadFields(0).contains(0));
+		assertTrue(sp.getReadFields(0).contains(2));
 	}
 
 	@Test
@@ -1284,17 +1398,17 @@ public class SemanticPropUtilTest {
 		SemanticPropUtil.getSemanticPropsDualFromString(dsp, forwardedFieldsFirst, forwardedFieldsSecond, null,
 				null, readFieldsFirst, readFieldsSecond, fourIntTupleType, fourIntTupleType, fourIntTupleType);
 
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 1).contains(2));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 2).contains(3));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 2).contains(0));
-		Assert.assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
-		Assert.assertTrue(dsp.getForwardingTargetFields(1, 3).size() == 0);
-		Assert.assertTrue(dsp.getReadFields(0).size() == 2);
-		Assert.assertTrue(dsp.getReadFields(0).contains(0));
-		Assert.assertTrue(dsp.getReadFields(0).contains(2));
-		Assert.assertTrue(dsp.getReadFields(1).size() == 1);
-		Assert.assertTrue(dsp.getReadFields(1).contains(1));
+		assertTrue(dsp.getForwardingTargetFields(0, 1).contains(2));
+		assertTrue(dsp.getForwardingTargetFields(0, 2).contains(3));
+		assertTrue(dsp.getForwardingTargetFields(1, 1).contains(1));
+		assertTrue(dsp.getForwardingTargetFields(1, 2).contains(0));
+		assertTrue(dsp.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(dsp.getForwardingTargetFields(1, 3).size() == 0);
+		assertTrue(dsp.getReadFields(0).size() == 2);
+		assertTrue(dsp.getReadFields(0).contains(0));
+		assertTrue(dsp.getReadFields(0).contains(2));
+		assertTrue(dsp.getReadFields(1).size() == 1);
+		assertTrue(dsp.getReadFields(1).contains(1));
 
 	}
 
diff --git a/flink-java/src/test/java/org/apache/flink/api/java/operator/CoGroupOperatorTest.java b/flink-java/src/test/java/org/apache/flink/api/java/operator/CoGroupOperatorTest.java
index d686633fc64..60754e661d2 100644
--- a/flink-java/src/test/java/org/apache/flink/api/java/operator/CoGroupOperatorTest.java
+++ b/flink-java/src/test/java/org/apache/flink/api/java/operator/CoGroupOperatorTest.java
@@ -21,6 +21,12 @@ package org.apache.flink.api.java.operator;
 import java.util.ArrayList;
 import java.util.List;
 
+import org.apache.flink.api.common.functions.CoGroupFunction;
+import org.apache.flink.api.common.operators.SemanticProperties;
+import org.apache.flink.api.java.functions.FunctionAnnotation;
+import org.apache.flink.api.java.operators.CoGroupOperator;
+import org.apache.flink.api.java.tuple.Tuple2;
+import org.apache.flink.util.Collector;
 import org.junit.Assert;
 import org.apache.flink.api.common.InvalidProgramException;
 import org.apache.flink.api.common.typeinfo.BasicTypeInfo;
@@ -33,6 +39,8 @@ import org.apache.flink.api.java.DataSet;
 import org.apache.flink.api.java.ExecutionEnvironment;
 import org.apache.flink.api.java.operator.JoinOperatorTest.CustomType;
 
+import static org.junit.Assert.assertTrue;
+
 @SuppressWarnings("serial")
 public class CoGroupOperatorTest {
 
@@ -348,4 +356,128 @@ public class CoGroupOperatorTest {
 					}
 				);
 	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector1() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs1 = env.fromCollection(emptyTupleData, tupleTypeInfo);
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs2 = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		CoGroupOperator<?,?,?> coGroupOp = tupleDs1.coGroup(tupleDs2)
+				.where(new DummyTestKeySelector()).equalTo(new DummyTestKeySelector())
+				.with(new DummyTestCoGroupFunction1());
+
+		SemanticProperties semProps = coGroupOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0,2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0,3).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0,3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0,3).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0,4).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,6).size() == 0);
+
+		assertTrue(semProps.getForwardingTargetFields(1,0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(1,4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(1,5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(1,6).contains(0));
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(2));
+		assertTrue(semProps.getReadFields(0).contains(4));
+		assertTrue(semProps.getReadFields(0).contains(6));
+
+		assertTrue(semProps.getReadFields(1).size() == 2);
+		assertTrue(semProps.getReadFields(1).contains(3));
+		assertTrue(semProps.getReadFields(1).contains(5));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector2() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs1 = env.fromCollection(emptyTupleData, tupleTypeInfo);
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs2 = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		CoGroupOperator<?,?,?> coGroupOp = tupleDs1.coGroup(tupleDs2)
+				.where(new DummyTestKeySelector()).equalTo(new DummyTestKeySelector())
+				.with(new DummyTestCoGroupFunction2())
+				.withForwardedFieldsFirst("2;4->0")
+				.withForwardedFieldsSecond("0->4;1;1->3");
+
+		SemanticProperties semProps = coGroupOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0,0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0,4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0,5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0,6).contains(0));
+
+		assertTrue(semProps.getForwardingTargetFields(1,0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(1,2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(1,3).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(1,3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(1,3).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(1,4).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,6).size() == 0);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(2));
+		assertTrue(semProps.getReadFields(0).contains(3));
+		assertTrue(semProps.getReadFields(0).contains(4));
+
+		assertTrue(semProps.getReadFields(1) == null);
+	}
+
+	public static class DummyTestKeySelector implements KeySelector<Tuple5<Integer, Long, String, Long, Integer>, Tuple2<Long, Integer>> {
+		@Override
+		public Tuple2<Long, Integer> getKey(Tuple5<Integer, Long, String, Long, Integer> value) throws Exception {
+			return new Tuple2<Long, Integer>();
+		}
+	}
+
+	@FunctionAnnotation.ForwardedFieldsFirst("0->4;1;1->3")
+	@FunctionAnnotation.ForwardedFieldsSecond("2;4->0")
+	@FunctionAnnotation.ReadFieldsFirst("0;2;4")
+	@FunctionAnnotation.ReadFieldsSecond("1;3")
+	public static class DummyTestCoGroupFunction1
+			implements CoGroupFunction<Tuple5<Integer, Long, String, Long, Integer>,
+						Tuple5<Integer, Long, String, Long, Integer>,
+						Tuple5<Integer, Long, String, Long, Integer>> {
+
+		@Override
+		public void coGroup(Iterable<Tuple5<Integer, Long, String, Long, Integer>> first,
+							Iterable<Tuple5<Integer, Long, String, Long, Integer>> second,
+							Collector<Tuple5<Integer, Long, String, Long, Integer>> out) throws Exception {
+		}
+	}
+
+	@FunctionAnnotation.ReadFieldsFirst("0;1;2")
+	public static class DummyTestCoGroupFunction2
+			implements CoGroupFunction<Tuple5<Integer, Long, String, Long, Integer>,
+			Tuple5<Integer, Long, String, Long, Integer>,
+			Tuple5<Integer, Long, String, Long, Integer>> {
+
+		@Override
+		public void coGroup(Iterable<Tuple5<Integer, Long, String, Long, Integer>> first,
+							Iterable<Tuple5<Integer, Long, String, Long, Integer>> second,
+							Collector<Tuple5<Integer, Long, String, Long, Integer>> out) throws Exception {
+		}
+	}
 }
diff --git a/flink-java/src/test/java/org/apache/flink/api/java/operator/GroupCombineOperatorTest.java b/flink-java/src/test/java/org/apache/flink/api/java/operator/GroupCombineOperatorTest.java
new file mode 100644
index 00000000000..4870d29f963
--- /dev/null
+++ b/flink-java/src/test/java/org/apache/flink/api/java/operator/GroupCombineOperatorTest.java
@@ -0,0 +1,345 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.api.java.operator;
+
+import org.apache.flink.api.common.functions.GroupCombineFunction;
+import org.apache.flink.api.common.operators.Order;
+import org.apache.flink.api.common.operators.SemanticProperties;
+import org.apache.flink.api.common.typeinfo.BasicTypeInfo;
+import org.apache.flink.api.java.DataSet;
+import org.apache.flink.api.java.ExecutionEnvironment;
+import org.apache.flink.api.java.functions.FunctionAnnotation;
+import org.apache.flink.api.java.functions.KeySelector;
+import org.apache.flink.api.java.operators.GroupCombineOperator;
+import org.apache.flink.api.java.tuple.Tuple2;
+import org.apache.flink.api.java.tuple.Tuple5;
+import org.apache.flink.api.java.typeutils.TupleTypeInfo;
+import org.apache.flink.util.Collector;
+import org.junit.Test;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import static org.junit.Assert.assertTrue;
+
+@SuppressWarnings("serial")
+public class GroupCombineOperatorTest {
+
+	private final List<Tuple5<Integer, Long, String, Long, Integer>> emptyTupleData =
+			new ArrayList<Tuple5<Integer, Long, String, Long, Integer>>();
+	
+	private final TupleTypeInfo<Tuple5<Integer, Long, String, Long, Integer>> tupleTypeInfo = new 
+			TupleTypeInfo<Tuple5<Integer, Long, String, Long, Integer>>(
+					BasicTypeInfo.INT_TYPE_INFO,
+					BasicTypeInfo.LONG_TYPE_INFO,
+					BasicTypeInfo.STRING_TYPE_INFO,
+					BasicTypeInfo.LONG_TYPE_INFO,
+					BasicTypeInfo.INT_TYPE_INFO
+			);
+	
+	@Test
+	public void testSemanticPropsWithKeySelector1() {
+		
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupCombineOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> combineOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.combineGroup(new DummyGroupCombineFunction1());
+
+		SemanticProperties semProps = combineOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 4);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 4) == 2);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(2));
+		assertTrue(semProps.getReadFields(0).contains(5));
+		assertTrue(semProps.getReadFields(0).contains(6));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector2() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupCombineOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> combineOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.sortGroup(new DummyTestKeySelector(), Order.ASCENDING)
+						.combineGroup(new DummyGroupCombineFunction1());
+
+		SemanticProperties semProps = combineOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 7).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 8).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 6);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 4) == 4);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(4));
+		assertTrue(semProps.getReadFields(0).contains(7));
+		assertTrue(semProps.getReadFields(0).contains(8));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector3() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupCombineOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> combineOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.combineGroup(new DummyGroupCombineFunction2())
+							.withForwardedFields("0->4;1;1->3;2");
+
+		SemanticProperties semProps = combineOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 4);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 4) == 2);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(2));
+		assertTrue(semProps.getReadFields(0).contains(5));
+		assertTrue(semProps.getReadFields(0).contains(6));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector4() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupCombineOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> combineOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.sortGroup(new DummyTestKeySelector(), Order.ASCENDING)
+						.combineGroup(new DummyGroupCombineFunction2())
+							.withForwardedFields("0->4;1;1->3;2");
+
+		SemanticProperties semProps = combineOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 7).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 8).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 6);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 4) == 4);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(4));
+		assertTrue(semProps.getReadFields(0).contains(7));
+		assertTrue(semProps.getReadFields(0).contains(8));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector5() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupCombineOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> combineOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.combineGroup(new DummyGroupCombineFunction3())
+						.withForwardedFields("4->0;3;3->1;2");
+
+		SemanticProperties semProps = combineOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).contains(0));
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) == 6);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 4);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 4) < 0);
+
+		assertTrue(semProps.getReadFields(0) == null);
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector6() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupCombineOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> combineOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.sortGroup(new DummyTestKeySelector(), Order.ASCENDING)
+						.combineGroup(new DummyGroupCombineFunction3())
+						.withForwardedFields("4->0;3;3->1;2");
+
+		SemanticProperties semProps = combineOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 7).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 7).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 7).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 8).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 8).contains(0));
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) == 8);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 7);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 6);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 7);
+		assertTrue(semProps.getForwardingSourceField(0, 4) < 0);
+
+		assertTrue(semProps.getReadFields(0) == null);
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector7() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupCombineOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> combineOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.combineGroup(new DummyGroupCombineFunction4());
+
+		SemanticProperties semProps = combineOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) == 2);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 2) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 4) < 0);
+
+		assertTrue(semProps.getReadFields(0) == null);
+	}
+
+	public static class DummyTestKeySelector implements KeySelector<Tuple5<Integer, Long, String, Long, Integer>, Tuple2<Long, Integer>> {
+		@Override
+		public Tuple2<Long, Integer> getKey(Tuple5<Integer, Long, String, Long, Integer> value) throws Exception {
+			return new Tuple2<Long, Integer>();
+		}
+	}
+
+	@FunctionAnnotation.ForwardedFields("0->4;1;1->3;2")
+	@FunctionAnnotation.ReadFields("0;3;4")
+	public static class DummyGroupCombineFunction1 implements GroupCombineFunction<Tuple5<Integer, Long, String, Long, Integer>, Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public void combine(Iterable<Tuple5<Integer, Long, String, Long, Integer>> values, Collector<Tuple5<Integer, Long, String, Long, Integer>> out) throws Exception {
+		}
+	}
+
+	@FunctionAnnotation.ReadFields("0;3;4")
+	public static class DummyGroupCombineFunction2 implements GroupCombineFunction<Tuple5<Integer, Long, String, Long, Integer>, Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public void combine(Iterable<Tuple5<Integer, Long, String, Long, Integer>> values, Collector<Tuple5<Integer, Long, String, Long, Integer>> out) throws Exception {
+		}
+	}
+
+	public static class DummyGroupCombineFunction3 implements GroupCombineFunction<Tuple5<Integer, Long, String, Long, Integer>, Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public void combine(Iterable<Tuple5<Integer, Long, String, Long, Integer>> values, Collector<Tuple5<Integer, Long, String, Long, Integer>> out) throws Exception {
+		}
+	}
+
+	@FunctionAnnotation.NonForwardedFields("2;4")
+	public static class DummyGroupCombineFunction4 implements GroupCombineFunction<Tuple5<Integer, Long, String, Long, Integer>, Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public void combine(Iterable<Tuple5<Integer, Long, String, Long, Integer>> values, Collector<Tuple5<Integer, Long, String, Long, Integer>> out) throws Exception {
+		}
+	}
+}
diff --git a/flink-java/src/test/java/org/apache/flink/api/java/operator/GroupReduceOperatorTest.java b/flink-java/src/test/java/org/apache/flink/api/java/operator/GroupReduceOperatorTest.java
new file mode 100644
index 00000000000..0bfe566d7b6
--- /dev/null
+++ b/flink-java/src/test/java/org/apache/flink/api/java/operator/GroupReduceOperatorTest.java
@@ -0,0 +1,345 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.api.java.operator;
+
+import org.apache.flink.api.common.functions.GroupReduceFunction;
+import org.apache.flink.api.common.operators.Order;
+import org.apache.flink.api.common.operators.SemanticProperties;
+import org.apache.flink.api.common.typeinfo.BasicTypeInfo;
+import org.apache.flink.api.java.DataSet;
+import org.apache.flink.api.java.ExecutionEnvironment;
+import org.apache.flink.api.java.functions.FunctionAnnotation;
+import org.apache.flink.api.java.functions.KeySelector;
+import org.apache.flink.api.java.operators.GroupReduceOperator;
+import org.apache.flink.api.java.tuple.Tuple2;
+import org.apache.flink.api.java.tuple.Tuple5;
+import org.apache.flink.api.java.typeutils.TupleTypeInfo;
+import org.apache.flink.util.Collector;
+import org.junit.Test;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import static org.junit.Assert.assertTrue;
+
+@SuppressWarnings("serial")
+public class GroupReduceOperatorTest {
+
+	private final List<Tuple5<Integer, Long, String, Long, Integer>> emptyTupleData =
+			new ArrayList<Tuple5<Integer, Long, String, Long, Integer>>();
+	
+	private final TupleTypeInfo<Tuple5<Integer, Long, String, Long, Integer>> tupleTypeInfo = new 
+			TupleTypeInfo<Tuple5<Integer, Long, String, Long, Integer>>(
+					BasicTypeInfo.INT_TYPE_INFO,
+					BasicTypeInfo.LONG_TYPE_INFO,
+					BasicTypeInfo.STRING_TYPE_INFO,
+					BasicTypeInfo.LONG_TYPE_INFO,
+					BasicTypeInfo.INT_TYPE_INFO
+			);
+	
+	@Test
+	public void testSemanticPropsWithKeySelector1() {
+		
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupReduceOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.reduceGroup(new DummyGroupReduceFunction1());
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 4);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 4) == 2);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(2));
+		assertTrue(semProps.getReadFields(0).contains(5));
+		assertTrue(semProps.getReadFields(0).contains(6));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector2() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupReduceOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.sortGroup(new DummyTestKeySelector(), Order.ASCENDING)
+						.reduceGroup(new DummyGroupReduceFunction1());
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 7).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 8).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 6);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 4) == 4);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(4));
+		assertTrue(semProps.getReadFields(0).contains(7));
+		assertTrue(semProps.getReadFields(0).contains(8));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector3() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupReduceOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.reduceGroup(new DummyGroupReduceFunction2())
+							.withForwardedFields("0->4;1;1->3;2");
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 4);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 4) == 2);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(2));
+		assertTrue(semProps.getReadFields(0).contains(5));
+		assertTrue(semProps.getReadFields(0).contains(6));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector4() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupReduceOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.sortGroup(new DummyTestKeySelector(), Order.ASCENDING)
+						.reduceGroup(new DummyGroupReduceFunction2())
+							.withForwardedFields("0->4;1;1->3;2");
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 7).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 8).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 6);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 4) == 4);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(4));
+		assertTrue(semProps.getReadFields(0).contains(7));
+		assertTrue(semProps.getReadFields(0).contains(8));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector5() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupReduceOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.reduceGroup(new DummyGroupReduceFunction3())
+						.withForwardedFields("4->0;3;3->1;2");
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).contains(0));
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) == 6);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 4);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 4) < 0);
+
+		assertTrue(semProps.getReadFields(0) == null);
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector6() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupReduceOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.sortGroup(new DummyTestKeySelector(), Order.ASCENDING)
+						.reduceGroup(new DummyGroupReduceFunction3())
+						.withForwardedFields("4->0;3;3->1;2");
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 7).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 7).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 7).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 8).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 8).contains(0));
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) == 8);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 7);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 6);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 7);
+		assertTrue(semProps.getForwardingSourceField(0, 4) < 0);
+
+		assertTrue(semProps.getReadFields(0) == null);
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector7() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		GroupReduceOperator<Tuple5<Integer, Long, String, Long, Integer>,Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.reduceGroup(new DummyGroupReduceFunction4());
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) == 2);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 2) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 4) < 0);
+
+		assertTrue(semProps.getReadFields(0) == null);
+	}
+
+	public static class DummyTestKeySelector implements KeySelector<Tuple5<Integer, Long, String, Long, Integer>, Tuple2<Long, Integer>> {
+		@Override
+		public Tuple2<Long, Integer> getKey(Tuple5<Integer, Long, String, Long, Integer> value) throws Exception {
+			return new Tuple2<Long, Integer>();
+		}
+	}
+
+	@FunctionAnnotation.ForwardedFields("0->4;1;1->3;2")
+	@FunctionAnnotation.ReadFields("0;3;4")
+	public static class DummyGroupReduceFunction1 implements GroupReduceFunction<Tuple5<Integer, Long, String, Long, Integer>, Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public void reduce(Iterable<Tuple5<Integer, Long, String, Long, Integer>> values, Collector<Tuple5<Integer, Long, String, Long, Integer>> out) throws Exception {
+		}
+	}
+
+	@FunctionAnnotation.ReadFields("0;3;4")
+	public static class DummyGroupReduceFunction2 implements GroupReduceFunction<Tuple5<Integer, Long, String, Long, Integer>, Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public void reduce(Iterable<Tuple5<Integer, Long, String, Long, Integer>> values, Collector<Tuple5<Integer, Long, String, Long, Integer>> out) throws Exception {
+		}
+	}
+
+	public static class DummyGroupReduceFunction3 implements GroupReduceFunction<Tuple5<Integer, Long, String, Long, Integer>, Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public void reduce(Iterable<Tuple5<Integer, Long, String, Long, Integer>> values, Collector<Tuple5<Integer, Long, String, Long, Integer>> out) throws Exception {
+		}
+	}
+
+	@FunctionAnnotation.NonForwardedFields("2;4")
+	public static class DummyGroupReduceFunction4 implements GroupReduceFunction<Tuple5<Integer, Long, String, Long, Integer>, Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public void reduce(Iterable<Tuple5<Integer, Long, String, Long, Integer>> values, Collector<Tuple5<Integer, Long, String, Long, Integer>> out) throws Exception {
+		}
+	}
+}
diff --git a/flink-java/src/test/java/org/apache/flink/api/java/operator/JoinOperatorTest.java b/flink-java/src/test/java/org/apache/flink/api/java/operator/JoinOperatorTest.java
index 3d4551db999..f1aadca25e7 100644
--- a/flink-java/src/test/java/org/apache/flink/api/java/operator/JoinOperatorTest.java
+++ b/flink-java/src/test/java/org/apache/flink/api/java/operator/JoinOperatorTest.java
@@ -23,20 +23,29 @@ import java.util.ArrayList;
 import java.util.List;
 
 import org.apache.flink.api.common.InvalidProgramException;
+import org.apache.flink.api.common.functions.JoinFunction;
+import org.apache.flink.api.common.operators.SemanticProperties;
 import org.apache.flink.api.common.typeinfo.BasicTypeInfo;
 import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.common.typeutils.CompositeType;
 import org.apache.flink.api.java.DataSet;
 import org.apache.flink.api.java.ExecutionEnvironment;
+import org.apache.flink.api.java.functions.FunctionAnnotation;
 import org.apache.flink.api.java.functions.KeySelector;
+import org.apache.flink.api.java.operators.GroupReduceOperator;
+import org.apache.flink.api.java.operators.JoinOperator;
+import org.apache.flink.api.java.tuple.Tuple;
 import org.apache.flink.api.java.tuple.Tuple2;
 import org.apache.flink.api.java.tuple.Tuple5;
 import org.apache.flink.api.java.typeutils.TupleTypeInfo;
 import org.apache.flink.api.java.typeutils.TypeExtractor;
+import org.apache.hadoop.io.Writable;
 import org.junit.Assert;
 import org.junit.BeforeClass;
 import org.junit.Test;
 
+import static org.junit.Assert.assertTrue;
+
 @SuppressWarnings("serial")
 public class JoinOperatorTest {
 
@@ -298,7 +307,7 @@ public class JoinOperatorTest {
 		DataSet<Tuple5<Integer, Long, String, Long, Integer>> ds2 = env.fromCollection(emptyTupleData, tupleTypeInfo);
 		try {
 			TypeInformation<?> t = ds1.join(ds2).where("f0.myInt").equalTo(4).getType();
-			Assert.assertTrue("not a composite type", t instanceof CompositeType);
+			assertTrue("not a composite type", t instanceof CompositeType);
 		} catch(Exception e) {
 			e.printStackTrace();
 			Assert.fail();
@@ -946,7 +955,136 @@ public class JoinOperatorTest {
 		.projectFirst(0)
 		.projectSecond(-1);
 	}
-	
+
+	@Test
+	public void testSemanticPropsWithKeySelector1() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs1 = env.fromCollection(emptyTupleData, tupleTypeInfo);
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs2 = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		JoinOperator<?,?,?> joinOp = tupleDs1.join(tupleDs2)
+				.where(new DummyTestKeySelector()).equalTo(new DummyTestKeySelector())
+				.with(new DummyTestJoinFunction1());
+
+		SemanticProperties semProps = joinOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0,2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0,3).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0,3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0,3).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0,4).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,6).size() == 0);
+
+		assertTrue(semProps.getForwardingTargetFields(1,0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(1,4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(1,5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(1,6).contains(0));
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(2));
+		assertTrue(semProps.getReadFields(0).contains(4));
+		assertTrue(semProps.getReadFields(0).contains(6));
+
+		assertTrue(semProps.getReadFields(1).size() == 2);
+		assertTrue(semProps.getReadFields(1).contains(3));
+		assertTrue(semProps.getReadFields(1).contains(5));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector2() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs1 = env.fromCollection(emptyTupleData, tupleTypeInfo);
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs2 = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		JoinOperator<?,?,?> joinOp = tupleDs1.join(tupleDs2)
+				.where(new DummyTestKeySelector()).equalTo(new DummyTestKeySelector())
+				.with(new DummyTestJoinFunction2())
+					.withForwardedFieldsFirst("2;4->0")
+					.withForwardedFieldsSecond("0->4;1;1->3");
+
+		SemanticProperties semProps = joinOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0,0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0,4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0,5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0,6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0,6).contains(0));
+
+		assertTrue(semProps.getForwardingTargetFields(1,0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(1,2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(1,3).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(1,3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(1,3).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(1,4).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1,6).size() == 0);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(2));
+		assertTrue(semProps.getReadFields(0).contains(3));
+		assertTrue(semProps.getReadFields(0).contains(4));
+
+		assertTrue(semProps.getReadFields(1) == null);
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector3() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs1 = env.fromCollection(emptyTupleData, tupleTypeInfo);
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs2 = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		JoinOperator<?, ?, ? extends Tuple> joinOp = tupleDs1.join(tupleDs2)
+				.where(new DummyTestKeySelector()).equalTo(new DummyTestKeySelector())
+				.projectFirst(2)
+				.projectSecond(0, 0, 3)
+				.projectFirst(0, 4)
+				.projectSecond(2);
+
+		SemanticProperties semProps = joinOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(0));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).contains(5));
+
+		assertTrue(semProps.getForwardingTargetFields(1, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1, 2).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(1, 2).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(1, 2).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(1, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(1, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(1, 4).contains(6));
+		assertTrue(semProps.getForwardingTargetFields(1, 5).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(1, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(1, 6).size() == 0);
+
+	}
+
 	/*
 	 * ####################################################################
 	 */
@@ -1001,8 +1139,8 @@ public class JoinOperatorTest {
 		public NestedCustomType nested;
 		public String myString;
 		public Object nothing;
-	//	public List<String> countries; need Kryo to support this
-	//	public Writable interfaceTest; need kryo
+		public List<String> countries;
+		public Writable interfaceTest;
 		
 		public CustomType() {};
 		
@@ -1010,6 +1148,8 @@ public class JoinOperatorTest {
 			myInt = i;
 			myLong = l;
 			myString = s;
+			countries = null;
+			interfaceTest = null;
 			nested = new NestedCustomType(i, l, s);
 		}
 		
@@ -1046,5 +1186,40 @@ public class JoinOperatorTest {
 		}
 	}
 
+	public static class DummyTestKeySelector implements KeySelector<Tuple5<Integer, Long, String, Long, Integer>, Tuple2<Long, Integer>> {
+		@Override
+		public Tuple2<Long, Integer> getKey(Tuple5<Integer, Long, String, Long, Integer> value) throws Exception {
+			return new Tuple2<Long, Integer>();
+		}
+	}
+
+	@FunctionAnnotation.ForwardedFieldsFirst("0->4;1;1->3")
+	@FunctionAnnotation.ForwardedFieldsSecond("2;4->0")
+	@FunctionAnnotation.ReadFieldsFirst("0;2;4")
+	@FunctionAnnotation.ReadFieldsSecond("1;3")
+	public static class DummyTestJoinFunction1
+			implements JoinFunction<Tuple5<Integer, Long, String, Long, Integer>,
+									Tuple5<Integer, Long, String, Long, Integer>,
+									Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public Tuple5<Integer, Long, String, Long, Integer> join(
+				Tuple5<Integer, Long, String, Long, Integer> first,
+				Tuple5<Integer, Long, String, Long, Integer> second) throws Exception {
+			return new Tuple5<Integer, Long, String, Long, Integer>();
+		}
+	}
+
+	@FunctionAnnotation.ReadFieldsFirst("0;1;2")
+	public static class DummyTestJoinFunction2
+			implements JoinFunction<Tuple5<Integer, Long, String, Long, Integer>,
+			Tuple5<Integer, Long, String, Long, Integer>,
+			Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public Tuple5<Integer, Long, String, Long, Integer> join(
+				Tuple5<Integer, Long, String, Long, Integer> first,
+				Tuple5<Integer, Long, String, Long, Integer> second) throws Exception {
+			return new Tuple5<Integer, Long, String, Long, Integer>();
+		}
+	}
 	
 }
diff --git a/flink-java/src/test/java/org/apache/flink/api/java/operator/ReduceOperatorTest.java b/flink-java/src/test/java/org/apache/flink/api/java/operator/ReduceOperatorTest.java
new file mode 100644
index 00000000000..dafc1f2e77f
--- /dev/null
+++ b/flink-java/src/test/java/org/apache/flink/api/java/operator/ReduceOperatorTest.java
@@ -0,0 +1,238 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.api.java.operator;
+
+import org.apache.flink.api.common.functions.GroupReduceFunction;
+import org.apache.flink.api.common.functions.ReduceFunction;
+import org.apache.flink.api.common.operators.SemanticProperties;
+import org.apache.flink.api.common.typeinfo.BasicTypeInfo;
+import org.apache.flink.api.java.DataSet;
+import org.apache.flink.api.java.ExecutionEnvironment;
+import org.apache.flink.api.java.functions.FunctionAnnotation;
+import org.apache.flink.api.java.functions.KeySelector;
+import org.apache.flink.api.java.operators.GroupReduceOperator;
+import org.apache.flink.api.java.operators.ReduceOperator;
+import org.apache.flink.api.java.tuple.Tuple2;
+import org.apache.flink.api.java.tuple.Tuple5;
+import org.apache.flink.api.java.typeutils.TupleTypeInfo;
+import org.apache.flink.util.Collector;
+import org.junit.Test;
+
+import java.util.ArrayList;
+import java.util.List;
+
+import static org.junit.Assert.assertTrue;
+
+@SuppressWarnings("serial")
+public class ReduceOperatorTest {
+
+	private final List<Tuple5<Integer, Long, String, Long, Integer>> emptyTupleData =
+			new ArrayList<Tuple5<Integer, Long, String, Long, Integer>>();
+	
+	private final TupleTypeInfo<Tuple5<Integer, Long, String, Long, Integer>> tupleTypeInfo = new 
+			TupleTypeInfo<Tuple5<Integer, Long, String, Long, Integer>>(
+					BasicTypeInfo.INT_TYPE_INFO,
+					BasicTypeInfo.LONG_TYPE_INFO,
+					BasicTypeInfo.STRING_TYPE_INFO,
+					BasicTypeInfo.LONG_TYPE_INFO,
+					BasicTypeInfo.INT_TYPE_INFO
+			);
+	
+	@Test
+	public void testSemanticPropsWithKeySelector1() {
+		
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		ReduceOperator<Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.reduce(new DummyReduceFunction1());
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 4);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 4) == 2);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(2));
+		assertTrue(semProps.getReadFields(0).contains(5));
+		assertTrue(semProps.getReadFields(0).contains(6));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector2() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		ReduceOperator<Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.reduce(new DummyReduceFunction2())
+							.withForwardedFields("0->4;1;1->3;2");
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).contains(4));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 4);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 4) == 2);
+
+		assertTrue(semProps.getReadFields(0).size() == 3);
+		assertTrue(semProps.getReadFields(0).contains(2));
+		assertTrue(semProps.getReadFields(0).contains(5));
+		assertTrue(semProps.getReadFields(0).contains(6));
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector3() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		ReduceOperator<Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.reduce(new DummyReduceFunction3())
+						.withForwardedFields("4->0;3;3->1;2");
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 4).contains(2));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 2);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 6).contains(0));
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) == 6);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 2) == 4);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 4) < 0);
+
+		assertTrue(semProps.getReadFields(0) == null);
+	}
+
+	@Test
+	public void testSemanticPropsWithKeySelector4() {
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		DataSet<Tuple5<Integer, Long, String, Long, Integer>> tupleDs = env.fromCollection(emptyTupleData, tupleTypeInfo);
+
+		ReduceOperator<Tuple5<Integer, Long, String, Long, Integer>> reduceOp =
+				tupleDs.groupBy(new DummyTestKeySelector())
+						.reduce(new DummyReduceFunction4());
+
+		SemanticProperties semProps = reduceOp.getSemanticProperties();
+
+		assertTrue(semProps.getForwardingTargetFields(0, 0).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 1).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 2).contains(0));
+		assertTrue(semProps.getForwardingTargetFields(0, 3).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 3).contains(1));
+		assertTrue(semProps.getForwardingTargetFields(0, 4).size() == 0);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).size() == 1);
+		assertTrue(semProps.getForwardingTargetFields(0, 5).contains(3));
+		assertTrue(semProps.getForwardingTargetFields(0, 6).size() == 0);
+
+		assertTrue(semProps.getForwardingSourceField(0, 0) == 2);
+		assertTrue(semProps.getForwardingSourceField(0, 1) == 3);
+		assertTrue(semProps.getForwardingSourceField(0, 2) < 0);
+		assertTrue(semProps.getForwardingSourceField(0, 3) == 5);
+		assertTrue(semProps.getForwardingSourceField(0, 4) < 0);
+
+		assertTrue(semProps.getReadFields(0) == null);
+	}
+
+	public static class DummyTestKeySelector implements KeySelector<Tuple5<Integer, Long, String, Long, Integer>, Tuple2<Long, Integer>> {
+		@Override
+		public Tuple2<Long, Integer> getKey(Tuple5<Integer, Long, String, Long, Integer> value) throws Exception {
+			return new Tuple2<Long, Integer>();
+		}
+	}
+
+	@FunctionAnnotation.ForwardedFields("0->4;1;1->3;2")
+	@FunctionAnnotation.ReadFields("0;3;4")
+	public static class DummyReduceFunction1 implements ReduceFunction<Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public Tuple5<Integer, Long, String, Long, Integer> reduce(Tuple5<Integer, Long, String, Long, Integer> v1,
+																	Tuple5<Integer, Long, String, Long, Integer> v2) throws Exception {
+			return new Tuple5<Integer, Long, String, Long, Integer>();
+		}
+	}
+
+	@FunctionAnnotation.ReadFields("0;3;4")
+	public static class DummyReduceFunction2 implements ReduceFunction<Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public Tuple5<Integer, Long, String, Long, Integer> reduce(Tuple5<Integer, Long, String, Long, Integer> v1,
+																   Tuple5<Integer, Long, String, Long, Integer> v2) throws Exception {
+			return new Tuple5<Integer, Long, String, Long, Integer>();
+		}
+	}
+
+	public static class DummyReduceFunction3 implements ReduceFunction<Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public Tuple5<Integer, Long, String, Long, Integer> reduce(Tuple5<Integer, Long, String, Long, Integer> v1,
+																   Tuple5<Integer, Long, String, Long, Integer> v2) throws Exception {
+			return new Tuple5<Integer, Long, String, Long, Integer>();
+		}
+	}
+
+	@FunctionAnnotation.NonForwardedFields("2;4")
+	public static class DummyReduceFunction4 implements ReduceFunction<Tuple5<Integer, Long, String, Long, Integer>> {
+		@Override
+		public Tuple5<Integer, Long, String, Long, Integer> reduce(Tuple5<Integer, Long, String, Long, Integer> v1,
+																   Tuple5<Integer, Long, String, Long, Integer> v2) throws Exception {
+			return new Tuple5<Integer, Long, String, Long, Integer>();
+		}
+	}
+}
diff --git a/flink-tests/src/test/java/org/apache/flink/test/javaApiOperators/GroupReduceITCase.java b/flink-tests/src/test/java/org/apache/flink/test/javaApiOperators/GroupReduceITCase.java
index c5067f9d102..9eb9a378d5f 100644
--- a/flink-tests/src/test/java/org/apache/flink/test/javaApiOperators/GroupReduceITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/test/javaApiOperators/GroupReduceITCase.java
@@ -1005,6 +1005,64 @@ public class GroupReduceITCase extends MultipleProgramsTestBase {
 				"PojoWithCollection{pojos.size()=2, key=0, sqlDate=1976-05-03, bigInt=92233720368547758070, bigDecimalKeepItNull=null, scalaBigInt=31104000, mixed=null}\n";
 	}
 
+	@Test
+	public void testGroupReduceSelectorKeysWithSemProps() throws Exception {
+
+		/*
+		 * Test that semantic properties are correctly adapted when using Selector Keys
+		 */
+
+		final ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
+		env.setParallelism(4);
+
+		DataSet<Tuple5<Integer, Long, Integer, String, Long>> ds = CollectionDataSets.get5TupleDataSet(env);
+		DataSet<Tuple2<Integer, Long>> reduceDs = ds
+				// group by selector key
+				.groupBy(new KeySelector<Tuple5<Integer,Long,Integer,String,Long>, Long>() {
+					@Override
+					public Long getKey(Tuple5<Integer, Long, Integer, String, Long> v) throws Exception {
+						return (v.f0*v.f1)-(v.f2*v.f4);
+					}
+				})
+				.reduceGroup(
+						new GroupReduceFunction<Tuple5<Integer, Long, Integer, String, Long>, Tuple5<Integer, Long, Integer, String, Long>>() {
+							@Override
+							public void reduce(Iterable<Tuple5<Integer, Long, Integer, String, Long>> values, Collector<Tuple5<Integer, Long, Integer, String, Long>> out) throws Exception {
+								for (Tuple5<Integer, Long, Integer, String, Long> v : values) {
+									out.collect(v);
+								}
+							}
+						})
+				// add forward field information
+				.withForwardedFields("0")
+				// group again and reduce
+				.groupBy(0).reduceGroup(
+						new GroupReduceFunction<Tuple5<Integer, Long, Integer, String, Long>, Tuple2<Integer, Long>>() {
+							@Override
+							public void reduce(Iterable<Tuple5<Integer, Long, Integer, String, Long>> values, Collector<Tuple2<Integer, Long>> out) throws Exception {
+								int k = 0;
+								long s = 0;
+								for (Tuple5<Integer, Long, Integer, String, Long> v : values) {
+									k = v.f0;
+									s += v.f1;
+								}
+								out.collect(new Tuple2<Integer, Long>(k, s));
+							}
+						}
+				);
+
+		reduceDs.writeAsCsv(resultPath);
+
+		env.execute();
+
+		expected = "1,1\n" +
+				"2,5\n" +
+				"3,15\n" +
+				"4,34\n" +
+				"5,65\n";
+
+	}
+
 	public static class GroupReducer8 implements GroupReduceFunction<CollectionDataSets.PojoWithCollection, String> {
 		@Override
 		public void reduce(
