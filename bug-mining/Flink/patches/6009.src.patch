diff --git a/flink-connectors/flink-connector-elasticsearch7/src/main/java/org/apache/flink/connector/elasticsearch/sink/ElasticsearchWriter.java b/flink-connectors/flink-connector-elasticsearch7/src/main/java/org/apache/flink/connector/elasticsearch/sink/ElasticsearchWriter.java
index c17dc523969..d47fb7f90bd 100644
--- a/flink-connectors/flink-connector-elasticsearch7/src/main/java/org/apache/flink/connector/elasticsearch/sink/ElasticsearchWriter.java
+++ b/flink-connectors/flink-connector-elasticsearch7/src/main/java/org/apache/flink/connector/elasticsearch/sink/ElasticsearchWriter.java
@@ -17,6 +17,7 @@
 
 package org.apache.flink.connector.elasticsearch.sink;
 
+import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.api.common.operators.MailboxExecutor;
 import org.apache.flink.api.connector.sink.SinkWriter;
 import org.apache.flink.metrics.Counter;
@@ -146,6 +147,15 @@ class ElasticsearchWriter<IN> implements SinkWriter<IN, Void, Void> {
         return Collections.emptyList();
     }
 
+    @VisibleForTesting
+    void blockingFlushAllActions() throws InterruptedException {
+        while (pendingActions != 0) {
+            bulkProcessor.flush();
+            LOG.info("Waiting for the response of {} pending actions.", pendingActions);
+            mailboxExecutor.yield();
+        }
+    }
+
     @Override
     public void close() throws Exception {
         closed = true;
diff --git a/flink-connectors/flink-connector-elasticsearch7/src/test/java/org/apache/flink/connector/elasticsearch/sink/ElasticsearchWriterITCase.java b/flink-connectors/flink-connector-elasticsearch7/src/test/java/org/apache/flink/connector/elasticsearch/sink/ElasticsearchWriterITCase.java
index 91779dd1ba4..9ea14db865b 100644
--- a/flink-connectors/flink-connector-elasticsearch7/src/test/java/org/apache/flink/connector/elasticsearch/sink/ElasticsearchWriterITCase.java
+++ b/flink-connectors/flink-connector-elasticsearch7/src/test/java/org/apache/flink/connector/elasticsearch/sink/ElasticsearchWriterITCase.java
@@ -18,7 +18,6 @@
 package org.apache.flink.connector.elasticsearch.sink;
 
 import org.apache.flink.api.common.operators.MailboxExecutor;
-import org.apache.flink.api.common.time.Deadline;
 import org.apache.flink.api.java.tuple.Tuple2;
 import org.apache.flink.metrics.Counter;
 import org.apache.flink.metrics.Gauge;
@@ -33,7 +32,6 @@ import org.apache.flink.util.TestLogger;
 import org.apache.flink.util.function.ThrowingRunnable;
 
 import org.apache.http.HttpHost;
-import org.elasticsearch.ElasticsearchStatusException;
 import org.elasticsearch.client.RestClient;
 import org.elasticsearch.client.RestHighLevelClient;
 import org.junit.jupiter.api.AfterEach;
@@ -48,12 +46,10 @@ import org.testcontainers.junit.jupiter.Testcontainers;
 import org.testcontainers.utility.DockerImageName;
 
 import java.io.IOException;
-import java.time.Duration;
 import java.util.Collections;
 import java.util.Optional;
 
 import static org.apache.flink.connector.elasticsearch.sink.TestClient.buildMessage;
-import static org.apache.flink.runtime.testutils.CommonTestUtils.waitUntilCondition;
 import static org.hamcrest.MatcherAssert.assertThat;
 import static org.hamcrest.Matchers.greaterThan;
 import static org.junit.jupiter.api.Assertions.assertEquals;
@@ -117,7 +113,7 @@ class ElasticsearchWriterITCase extends TestLogger {
             context.assertThatIdsAreNotWritten(index, 6);
 
             // Force flush
-            writer.prepareCommit(true);
+            writer.blockingFlushAllActions();
             context.assertThatIdsAreWritten(index, 1, 2, 3, 4, 5, 6);
         }
     }
@@ -136,18 +132,10 @@ class ElasticsearchWriterITCase extends TestLogger {
             writer.write(Tuple2.of(2, buildMessage(2)), null);
             writer.write(Tuple2.of(3, buildMessage(3)), null);
             writer.write(Tuple2.of(4, buildMessage(4)), null);
-            waitUntilCondition(
-                    () -> {
-                        try {
-                            context.assertThatIdsAreWritten(index, 1, 2, 3, 4);
-                            return true;
-                        } catch (ElasticsearchStatusException e) {
-                            return false;
-                        }
-                    },
-                    // Wait for at-least one flush to happen
-                    Deadline.fromNow(Duration.ofSeconds(2)));
+            writer.blockingFlushAllActions();
         }
+
+        context.assertThatIdsAreWritten(index, 1, 2, 3, 4);
     }
 
     @Test
@@ -191,6 +179,7 @@ class ElasticsearchWriterITCase extends TestLogger {
             writer.write(Tuple2.of(1, buildMessage(1)), null);
             writer.write(Tuple2.of(2, buildMessage(2)), null);
 
+            writer.blockingFlushAllActions();
             long first = numBytesOut.getCount();
 
             assertTrue(first > 0);
@@ -198,6 +187,7 @@ class ElasticsearchWriterITCase extends TestLogger {
             writer.write(Tuple2.of(1, buildMessage(1)), null);
             writer.write(Tuple2.of(2, buildMessage(2)), null);
 
+            writer.blockingFlushAllActions();
             assertTrue(numBytesOut.getCount() > first);
         }
     }
@@ -216,6 +206,8 @@ class ElasticsearchWriterITCase extends TestLogger {
             writer.write(Tuple2.of(1, buildMessage(1)), null);
             writer.write(Tuple2.of(2, buildMessage(2)), null);
 
+            writer.blockingFlushAllActions();
+
             assertTrue(currentSendTime.isPresent());
             assertThat(currentSendTime.get().getValue(), greaterThan(0L));
         }
