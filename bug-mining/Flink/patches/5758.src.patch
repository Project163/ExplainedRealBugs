diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/strategy/ConsumedPartitionGroup.java b/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/strategy/ConsumedPartitionGroup.java
index ef0690d5a18..790f3b436ae 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/strategy/ConsumedPartitionGroup.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/scheduler/strategy/ConsumedPartitionGroup.java
@@ -19,6 +19,7 @@
 package org.apache.flink.runtime.scheduler.strategy;
 
 import org.apache.flink.annotation.VisibleForTesting;
+import org.apache.flink.runtime.jobgraph.IntermediateDataSetID;
 import org.apache.flink.runtime.jobgraph.IntermediateResultPartitionID;
 
 import java.util.Collections;
@@ -26,6 +27,8 @@ import java.util.Iterator;
 import java.util.List;
 import java.util.concurrent.atomic.AtomicInteger;
 
+import static org.apache.flink.util.Preconditions.checkArgument;
+
 /** Group of consumed {@link IntermediateResultPartitionID}s. */
 public class ConsumedPartitionGroup implements Iterable<IntermediateResultPartitionID> {
 
@@ -33,8 +36,22 @@ public class ConsumedPartitionGroup implements Iterable<IntermediateResultPartit
 
     private final AtomicInteger unfinishedPartitions;
 
+    private final IntermediateDataSetID intermediateDataSetID;
+
     private ConsumedPartitionGroup(List<IntermediateResultPartitionID> resultPartitions) {
+        checkArgument(
+                resultPartitions.size() > 0,
+                "The size of result partitions in the ConsumedPartitionGroup should be larger than 0.");
+        this.intermediateDataSetID = resultPartitions.get(0).getIntermediateDataSetID();
+
+        // Sanity check: all the partitions in one ConsumedPartitionGroup should have the same
+        // IntermediateDataSetID
+        for (IntermediateResultPartitionID resultPartition : resultPartitions) {
+            checkArgument(
+                    resultPartition.getIntermediateDataSetID().equals(this.intermediateDataSetID));
+        }
         this.resultPartitions = resultPartitions;
+
         this.unfinishedPartitions = new AtomicInteger(resultPartitions.size());
     }
 
@@ -65,6 +82,11 @@ public class ConsumedPartitionGroup implements Iterable<IntermediateResultPartit
         return iterator().next();
     }
 
+    /** Get the ID of IntermediateDataSet this ConsumedPartitionGroup belongs to. */
+    public IntermediateDataSetID getIntermediateDataSetID() {
+        return intermediateDataSetID;
+    }
+
     public int partitionUnfinished() {
         return unfinishedPartitions.incrementAndGet();
     }
