diff --git a/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/BoundedSourceITCase.java b/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/BoundedSourceITCase.java
index 6234ba2ed5a..ffeb08d4ecd 100644
--- a/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/BoundedSourceITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/BoundedSourceITCase.java
@@ -64,7 +64,10 @@ public class BoundedSourceITCase extends AbstractTestBase {
                 graphBuilder.build(
                         sharedObjects,
                         cfg -> cfg.setBoolean(ENABLE_CHECKPOINTS_AFTER_TASKS_FINISH, true),
-                        env -> {});
+                        env ->
+                                env.getCheckpointConfig()
+                                        .setCheckpointStorage(
+                                                TEMPORARY_FOLDER.newFolder().toURI()));
 
         TestJobExecutor.execute(testJob, miniClusterResource)
                 .waitForEvent(CheckpointCompletedEvent.class)
diff --git a/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/PartiallyFinishedSourcesITCase.java b/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/PartiallyFinishedSourcesITCase.java
index 3fdea20f2db..ef4ac6689a2 100644
--- a/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/PartiallyFinishedSourcesITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/PartiallyFinishedSourcesITCase.java
@@ -32,8 +32,10 @@ import org.apache.flink.util.TestLogger;
 
 import org.junit.After;
 import org.junit.Before;
+import org.junit.ClassRule;
 import org.junit.Rule;
 import org.junit.Test;
+import org.junit.rules.TemporaryFolder;
 import org.junit.runner.RunWith;
 import org.junit.runners.Parameterized;
 import org.junit.runners.Parameterized.Parameter;
@@ -66,6 +68,8 @@ import static org.apache.flink.streaming.api.environment.ExecutionCheckpointingO
 @RunWith(Parameterized.class)
 public class PartiallyFinishedSourcesITCase extends TestLogger {
 
+    @ClassRule public static final TemporaryFolder TEMPORARY_FOLDER = new TemporaryFolder();
+
     @Rule public final SharedObjects sharedObjects = SharedObjects.create();
 
     private MiniClusterWithClientResource miniClusterResource;
@@ -135,7 +139,7 @@ public class PartiallyFinishedSourcesITCase extends TestLogger {
         checkDataFlow(testJob);
     }
 
-    private TestJobWithDescription buildJob() {
+    private TestJobWithDescription buildJob() throws Exception {
         return graphBuilder.build(
                 sharedObjects,
                 cfg -> cfg.setBoolean(ENABLE_CHECKPOINTS_AFTER_TASKS_FINISH, true),
@@ -150,6 +154,10 @@ public class PartiallyFinishedSourcesITCase extends TestLogger {
                             .setTolerableCheckpointFailureNumber(Integer.MAX_VALUE);
                     // explicitly set to one to ease avoiding race conditions
                     env.getCheckpointConfig().setMaxConcurrentCheckpoints(1);
+                    env.getCheckpointConfig()
+                            // with unaligned checkpoints state size can grow beyond the default
+                            // limits of in-memory storage
+                            .setCheckpointStorage(TEMPORARY_FOLDER.newFolder().toURI());
                 });
     }
 
diff --git a/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/StopWithSavepointITCase.java b/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/StopWithSavepointITCase.java
index ea100b1f5cc..a787eed55e5 100644
--- a/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/StopWithSavepointITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/StopWithSavepointITCase.java
@@ -108,7 +108,14 @@ public class StopWithSavepointITCase extends AbstractTestBase {
 
     @Test
     public void test() throws Exception {
-        TestJobWithDescription testJob = graphBuilder.build(sharedObjects, cfg -> {}, env -> {});
+        TestJobWithDescription testJob =
+                graphBuilder.build(
+                        sharedObjects,
+                        cfg -> {},
+                        env ->
+                                env.getCheckpointConfig()
+                                        .setCheckpointStorage(
+                                                TEMPORARY_FOLDER.newFolder().toURI()));
 
         TestJobExecutor.execute(testJob, miniClusterResource)
                 .waitForEvent(WatermarkReceivedEvent.class)
diff --git a/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/graph/TestJobBuilders.java b/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/graph/TestJobBuilders.java
index 4afeec7a63d..7bb921635ab 100644
--- a/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/graph/TestJobBuilders.java
+++ b/flink-tests/src/test/java/org/apache/flink/runtime/operators/lifecycle/graph/TestJobBuilders.java
@@ -36,11 +36,11 @@ import org.apache.flink.streaming.api.functions.sink.DiscardingSink;
 import org.apache.flink.streaming.api.operators.ChainingStrategy;
 import org.apache.flink.streaming.api.transformations.MultipleInputTransformation;
 import org.apache.flink.testutils.junit.SharedObjects;
+import org.apache.flink.util.function.ThrowingConsumer;
 
 import java.util.HashMap;
 import java.util.HashSet;
 import java.util.Map;
-import java.util.function.Consumer;
 
 import static java.util.Arrays.asList;
 import static java.util.Collections.singleton;
@@ -56,8 +56,9 @@ public class TestJobBuilders {
     public interface TestingGraphBuilder {
         TestJobWithDescription build(
                 SharedObjects shared,
-                Consumer<Configuration> modifyConfig,
-                Consumer<StreamExecutionEnvironment> modifyEnvironment);
+                ThrowingConsumer<Configuration, Exception> modifyConfig,
+                ThrowingConsumer<StreamExecutionEnvironment, Exception> modifyEnvironment)
+                throws Exception;
     }
 
     private TestJobBuilders() {}
@@ -67,8 +68,9 @@ public class TestJobBuilders {
                 @Override
                 public TestJobWithDescription build(
                         SharedObjects shared,
-                        Consumer<Configuration> confConsumer,
-                        Consumer<StreamExecutionEnvironment> envConsumer) {
+                        ThrowingConsumer<Configuration, Exception> confConsumer,
+                        ThrowingConsumer<StreamExecutionEnvironment, Exception> envConsumer)
+                        throws Exception {
 
                     TestEventQueue eventQueue = TestEventQueue.createShared(shared);
                     TestCommandDispatcher commandQueue = TestCommandDispatcher.createShared(shared);
@@ -119,8 +121,9 @@ public class TestJobBuilders {
                 @Override
                 public TestJobWithDescription build(
                         SharedObjects shared,
-                        Consumer<Configuration> confConsumer,
-                        Consumer<StreamExecutionEnvironment> envConsumer) {
+                        ThrowingConsumer<Configuration, Exception> confConsumer,
+                        ThrowingConsumer<StreamExecutionEnvironment, Exception> envConsumer)
+                        throws Exception {
 
                     TestEventQueue eventQueue = TestEventQueue.createShared(shared);
                     TestCommandDispatcher commandQueue = TestCommandDispatcher.createShared(shared);
@@ -251,8 +254,9 @@ public class TestJobBuilders {
             };
 
     private static StreamExecutionEnvironment prepareEnv(
-            Consumer<Configuration> confConsumer,
-            Consumer<StreamExecutionEnvironment> envConsumer) {
+            ThrowingConsumer<Configuration, Exception> confConsumer,
+            ThrowingConsumer<StreamExecutionEnvironment, Exception> envConsumer)
+            throws Exception {
         Configuration configuration = new Configuration();
         configuration.set(EXECUTION_FAILOVER_STRATEGY, "full");
         confConsumer.accept(configuration);
