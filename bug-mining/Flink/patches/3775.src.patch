diff --git a/flink-runtime-web/src/main/java/org/apache/flink/runtime/webmonitor/history/HistoryServerStaticFileServerHandler.java b/flink-runtime-web/src/main/java/org/apache/flink/runtime/webmonitor/history/HistoryServerStaticFileServerHandler.java
index 4e3a6b980da..751d3d64a26 100644
--- a/flink-runtime-web/src/main/java/org/apache/flink/runtime/webmonitor/history/HistoryServerStaticFileServerHandler.java
+++ b/flink-runtime-web/src/main/java/org/apache/flink/runtime/webmonitor/history/HistoryServerStaticFileServerHandler.java
@@ -26,6 +26,8 @@ package org.apache.flink.runtime.webmonitor.history;
  * https://github.com/netty/netty/blob/4.0/example/src/main/java/io/netty/example/http/file/HttpStaticFileServerHandler.java
  *****************************************************************************/
 
+import org.apache.flink.runtime.rest.NotFoundException;
+import org.apache.flink.runtime.rest.handler.RestHandlerException;
 import org.apache.flink.runtime.rest.handler.legacy.files.StaticFileServerHandler;
 import org.apache.flink.runtime.rest.handler.router.RoutedRequest;
 import org.apache.flink.runtime.rest.handler.util.HandlerUtils;
@@ -106,14 +108,23 @@ public class HistoryServerStaticFileServerHandler extends SimpleChannelInboundHa
 	public void channelRead0(ChannelHandlerContext ctx, RoutedRequest routedRequest) throws Exception {
 		String requestPath = routedRequest.getPath();
 
-		respondWithFile(ctx, routedRequest.getRequest(), requestPath);
+		try {
+			respondWithFile(ctx, routedRequest.getRequest(), requestPath);
+		} catch (RestHandlerException rhe) {
+			HandlerUtils.sendErrorResponse(
+				ctx,
+				routedRequest.getRequest(),
+				new ErrorResponseBody(rhe.getMessage()),
+				rhe.getHttpResponseStatus(),
+				Collections.emptyMap());
+		}
 	}
 
 	/**
 	 * Response when running with leading JobManager.
 	 */
 	private void respondWithFile(ChannelHandlerContext ctx, HttpRequest request, String requestPath)
-		throws IOException, ParseException {
+		throws IOException, ParseException, RestHandlerException {
 
 		// make sure we request the "index.html" in case there is a directory request
 		if (requestPath.endsWith("/")) {
@@ -159,19 +170,13 @@ public class HistoryServerStaticFileServerHandler extends SimpleChannelInboundHa
 				} finally {
 					if (!success) {
 						LOG.debug("Unable to load requested file {} from classloader", requestPath);
-						HandlerUtils.sendErrorResponse(
-							ctx,
-							request,
-							new ErrorResponseBody("File not found."),
-							NOT_FOUND,
-							Collections.emptyMap());
-						return;
+						throw new NotFoundException("File not found.");
 					}
 				}
 			}
 		}
 
-		StaticFileServerHandler.checkFileValidity(file, rootPath, ctx, request, Collections.emptyMap(), LOG);
+		StaticFileServerHandler.checkFileValidity(file, rootPath, LOG);
 
 		// cache validation
 		final String ifModifiedSince = request.headers().get(IF_MODIFIED_SINCE);
@@ -250,12 +255,7 @@ public class HistoryServerStaticFileServerHandler extends SimpleChannelInboundHa
 		} catch (Exception e) {
 			raf.close();
 			LOG.error("Failed to serve file.", e);
-			HandlerUtils.sendErrorResponse(
-				ctx,
-				request,
-				new ErrorResponseBody("Internal server error."),
-				INTERNAL_SERVER_ERROR,
-				Collections.emptyMap());
+			throw new RestHandlerException("Internal server error.", INTERNAL_SERVER_ERROR);
 		}
 	}
 
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/legacy/files/StaticFileServerHandler.java b/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/legacy/files/StaticFileServerHandler.java
index 378bf587d86..a03fb9a1841 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/legacy/files/StaticFileServerHandler.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/legacy/files/StaticFileServerHandler.java
@@ -27,7 +27,9 @@ package org.apache.flink.runtime.rest.handler.legacy.files;
  *****************************************************************************/
 
 import org.apache.flink.api.common.time.Time;
+import org.apache.flink.runtime.rest.NotFoundException;
 import org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler;
+import org.apache.flink.runtime.rest.handler.RestHandlerException;
 import org.apache.flink.runtime.rest.handler.router.RoutedRequest;
 import org.apache.flink.runtime.rest.handler.util.HandlerUtils;
 import org.apache.flink.runtime.rest.handler.util.MimeTypes;
@@ -47,7 +49,6 @@ import org.apache.flink.shaded.netty4.io.netty.handler.codec.http.HttpChunkedInp
 import org.apache.flink.shaded.netty4.io.netty.handler.codec.http.HttpHeaders;
 import org.apache.flink.shaded.netty4.io.netty.handler.codec.http.HttpRequest;
 import org.apache.flink.shaded.netty4.io.netty.handler.codec.http.HttpResponse;
-import org.apache.flink.shaded.netty4.io.netty.handler.codec.http.HttpResponseStatus;
 import org.apache.flink.shaded.netty4.io.netty.handler.codec.http.LastHttpContent;
 import org.apache.flink.shaded.netty4.io.netty.handler.ssl.SslHandler;
 import org.apache.flink.shaded.netty4.io.netty.handler.stream.ChunkedFile;
@@ -70,7 +71,6 @@ import java.util.Collections;
 import java.util.Date;
 import java.util.GregorianCalendar;
 import java.util.Locale;
-import java.util.Map;
 import java.util.TimeZone;
 
 import static org.apache.flink.shaded.netty4.io.netty.handler.codec.http.HttpHeaders.Names.CACHE_CONTROL;
@@ -143,14 +143,23 @@ public class StaticFileServerHandler<T extends RestfulGateway> extends LeaderRet
 			requestPath = routedRequest.getPath();
 		}
 
-		respondToRequest(channelHandlerContext, request, requestPath);
+		try {
+			respondToRequest(channelHandlerContext, request, requestPath);
+		} catch (RestHandlerException rhe) {
+			HandlerUtils.sendErrorResponse(
+				channelHandlerContext,
+				routedRequest.getRequest(),
+				new ErrorResponseBody(rhe.getMessage()),
+				rhe.getHttpResponseStatus(),
+				responseHeaders);
+		}
 	}
 
 	/**
 	 * Response when running with leading JobManager.
 	 */
 	private void respondToRequest(ChannelHandlerContext ctx, HttpRequest request, String requestPath)
-			throws IOException, ParseException, URISyntaxException {
+			throws IOException, ParseException, URISyntaxException, RestHandlerException {
 
 		// convert to absolute path
 		final File file = new File(rootPath, requestPath);
@@ -187,19 +196,13 @@ public class StaticFileServerHandler<T extends RestfulGateway> extends LeaderRet
 				} finally {
 					if (!success) {
 						logger.debug("Unable to load requested file {} from classloader", requestPath);
-						HandlerUtils.sendErrorResponse(
-							ctx,
-							request,
-							new ErrorResponseBody(String.format("Unable to load requested file %s.", requestPath)),
-							NOT_FOUND,
-							responseHeaders);
-						return;
+						throw new NotFoundException(String.format("Unable to load requested file %s.", requestPath));
 					}
 				}
 			}
 		}
 
-		checkFileValidity(file, rootPath, ctx, request, responseHeaders, logger);
+		checkFileValidity(file, rootPath, logger);
 
 		// cache validation
 		final String ifModifiedSince = request.headers().get(IF_MODIFIED_SINCE);
@@ -234,13 +237,7 @@ public class StaticFileServerHandler<T extends RestfulGateway> extends LeaderRet
 			if (logger.isDebugEnabled()) {
 				logger.debug("Could not find file {}.", file.getAbsolutePath());
 			}
-			HandlerUtils.sendErrorResponse(
-				ctx,
-				request,
-				new ErrorResponseBody("File not found."),
-				HttpResponseStatus.NOT_FOUND,
-				responseHeaders);
-			return;
+			throw new NotFoundException("File not found.");
 		}
 
 		try {
@@ -279,12 +276,7 @@ public class StaticFileServerHandler<T extends RestfulGateway> extends LeaderRet
 		} catch (Exception e) {
 			raf.close();
 			logger.error("Failed to serve file.", e);
-			HandlerUtils.sendErrorResponse(
-				ctx,
-				request,
-				new ErrorResponseBody("Internal server error."),
-				INTERNAL_SERVER_ERROR,
-				responseHeaders);
+			throw new RestHandlerException("Internal server error.", INTERNAL_SERVER_ERROR);
 		}
 	}
 
@@ -365,45 +357,33 @@ public class StaticFileServerHandler<T extends RestfulGateway> extends LeaderRet
 		response.headers().set(CONTENT_TYPE, mimeFinal);
 	}
 
-	public static void checkFileValidity(File file, File rootPath, ChannelHandlerContext ctx, HttpRequest request, Map<String, String> responseHeaders, Logger logger) throws IOException {
+	/**
+	 * Checks various conditions for file access.
+	 * If all checks pass this method returns, and processing of the request may continue.
+	 * If any check fails this method throws a {@link RestHandlerException}, and further processing of the request
+	 * must be limited to sending an error response.
+	 */
+	public static void checkFileValidity(File file, File rootPath, Logger logger) throws IOException, RestHandlerException {
 		// this check must be done first to prevent probing for arbitrary files
 		if (!file.getCanonicalFile().toPath().startsWith(rootPath.toPath())) {
 			if (logger.isDebugEnabled()) {
 				logger.debug("Requested path {} points outside the root directory.", file.getAbsolutePath());
 			}
-			HandlerUtils.sendErrorResponse(
-				ctx,
-				request,
-				new ErrorResponseBody("Forbidden."),
-				FORBIDDEN,
-				responseHeaders);
-			return;
+			throw new RestHandlerException("Forbidden.", FORBIDDEN);
 		}
 
 		if (!file.exists() || file.isHidden()) {
 			if (logger.isDebugEnabled()) {
 				logger.debug("Requested path {} cannot be found.", file.getAbsolutePath());
 			}
-			HandlerUtils.sendErrorResponse(
-				ctx,
-				request,
-				new ErrorResponseBody("File not found."),
-				NOT_FOUND,
-				responseHeaders);
-			return;
+			throw new RestHandlerException("File not found.", NOT_FOUND);
 		}
 
 		if (file.isDirectory() || !file.isFile()) {
 			if (logger.isDebugEnabled()) {
 				logger.debug("Requested path {} does not point to a file.", file.getAbsolutePath());
 			}
-			HandlerUtils.sendErrorResponse(
-				ctx,
-				request,
-				new ErrorResponseBody("File not found."),
-				METHOD_NOT_ALLOWED,
-				responseHeaders);
-			return;
+			throw new RestHandlerException("File not found.", METHOD_NOT_ALLOWED);
 		}
 	}
 }
