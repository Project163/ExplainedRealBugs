diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/blob/BlobServer.java b/flink-runtime/src/main/java/org/apache/flink/runtime/blob/BlobServer.java
index a50f535dd97..d647d79a99e 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/blob/BlobServer.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/blob/BlobServer.java
@@ -637,20 +637,9 @@ public class BlobServer extends Thread implements BlobService, BlobWriter, Perma
 		}
 
 		File incomingFile = createTemporaryFilename();
-		MessageDigest md = BlobUtils.createMessageDigest();
 		BlobKey blobKey = null;
-		try (FileOutputStream fos = new FileOutputStream(incomingFile)) {
-			// read stream
-			byte[] buf = new byte[BUFFER_SIZE];
-			while (true) {
-				final int bytesRead = inputStream.read(buf);
-				if (bytesRead == -1) {
-					// done
-					break;
-				}
-				fos.write(buf, 0, bytesRead);
-				md.update(buf, 0, bytesRead);
-			}
+		try {
+			MessageDigest md = writeStreamToFileAndCreateDigest(inputStream, incomingFile);
 
 			// persist file
 			blobKey = moveTempFileToStore(incomingFile, jobId, md.digest(), blobType);
@@ -665,6 +654,24 @@ public class BlobServer extends Thread implements BlobService, BlobWriter, Perma
 		}
 	}
 
+	private static MessageDigest writeStreamToFileAndCreateDigest(InputStream inputStream, File file) throws IOException {
+		try (FileOutputStream fos = new FileOutputStream(file)) {
+			MessageDigest md = BlobUtils.createMessageDigest();
+			// read stream
+			byte[] buf = new byte[BUFFER_SIZE];
+			while (true) {
+				final int bytesRead = inputStream.read(buf);
+				if (bytesRead == -1) {
+					// done
+					break;
+				}
+				fos.write(buf, 0, bytesRead);
+				md.update(buf, 0, bytesRead);
+			}
+			return md;
+		}
+	}
+
 	/**
 	 * Moves the temporary <tt>incomingFile</tt> to its permanent location where it is available for
 	 * use.
