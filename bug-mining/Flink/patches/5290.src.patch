diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/AvailabilityProvider.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/AvailabilityProvider.java
index 815c5b32d03..542246e08d9 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/AvailabilityProvider.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/AvailabilityProvider.java
@@ -147,5 +147,13 @@ public interface AvailabilityProvider {
         public CompletableFuture<?> getAvailableFuture() {
             return availableFuture;
         }
+
+        @Override
+        public String toString() {
+            if (availableFuture == AVAILABLE) {
+                return "AVAILABLE";
+            }
+            return availableFuture.toString();
+        }
     }
 }
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGate.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGate.java
index 390a2c1fc7d..f881a13ff6b 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGate.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGate.java
@@ -367,13 +367,7 @@ public class UnionInputGate extends InputGate {
             }
         }
 
-        IndexedInputGate inputGate = inputGatesWithData.poll();
-
-        if (inputGatesWithData.isEmpty()) {
-            availabilityHelper.resetUnavailable();
-        }
-
-        return Optional.of(inputGate);
+        return Optional.of(inputGatesWithData.poll());
     }
 
     @Override
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGateTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGateTest.java
index 2436092c17a..30931efa4bd 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGateTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/UnionInputGateTest.java
@@ -19,6 +19,7 @@
 package org.apache.flink.runtime.io.network.partition.consumer;
 
 import org.apache.flink.runtime.clusterframework.types.ResourceID;
+import org.apache.flink.runtime.io.network.buffer.BufferBuilderTestUtils;
 import org.apache.flink.runtime.io.network.partition.NoOpResultSubpartitionView;
 import org.apache.flink.runtime.io.network.partition.ResultPartitionID;
 import org.apache.flink.runtime.io.network.partition.consumer.SingleInputGateTest.TestingResultPartitionManager;
@@ -26,6 +27,8 @@ import org.apache.flink.runtime.io.network.partition.consumer.SingleInputGateTes
 import org.hamcrest.Matchers;
 import org.junit.Test;
 
+import java.io.IOException;
+
 import static org.apache.flink.runtime.io.network.partition.consumer.SingleInputGateTest.verifyBufferOrEvent;
 import static org.apache.flink.runtime.util.NettyShuffleDescriptorBuilder.createRemoteWithIdAndLocation;
 import static org.junit.Assert.assertEquals;
@@ -123,6 +126,26 @@ public class UnionInputGateTest extends InputGateTestBase {
         testIsAvailable(new UnionInputGate(inputGate1, inputGate2), inputGate1, inputChannel1);
     }
 
+    @Test
+    public void testAvailability() throws IOException, InterruptedException {
+        final SingleInputGate inputGate1 = createInputGate(1);
+        TestInputChannel inputChannel1 = new TestInputChannel(inputGate1, 0, false, true);
+        inputGate1.setInputChannels(inputChannel1);
+
+        final SingleInputGate inputGate2 = createInputGate(1);
+        TestInputChannel inputChannel2 = new TestInputChannel(inputGate2, 0, false, true);
+        inputGate2.setInputChannels(inputChannel2);
+
+        UnionInputGate inputGate = new UnionInputGate(inputGate1, inputGate2);
+
+        inputChannel1.read(BufferBuilderTestUtils.buildSomeBuffer(1));
+        assertTrue(inputGate.getAvailableFuture().isDone());
+        inputChannel1.read(BufferBuilderTestUtils.buildSomeBuffer(2));
+        assertTrue(inputGate.getAvailableFuture().isDone());
+        assertEquals(1, inputGate.getNext().get().getBuffer().getSize());
+        assertTrue(inputGate.getAvailableFuture().isDone());
+    }
+
     @Test
     public void testIsAvailableAfterFinished() throws Exception {
         final SingleInputGate inputGate1 = createInputGate(1);
@@ -187,4 +210,22 @@ public class UnionInputGateTest extends InputGateTestBase {
         // Check that updated input channel is visible via UnionInputGate
         assertThat(unionInputGate.getChannel(1), Matchers.is(inputChannel2));
     }
+
+    @Test
+    public void testEmptyPull() throws IOException, InterruptedException {
+        final SingleInputGate inputGate1 = createInputGate(1);
+        TestInputChannel inputChannel1 = new TestInputChannel(inputGate1, 0, false, true);
+        inputGate1.setInputChannels(inputChannel1);
+
+        final SingleInputGate inputGate2 = createInputGate(1);
+        TestInputChannel inputChannel2 = new TestInputChannel(inputGate2, 0, false, true);
+        inputGate2.setInputChannels(inputChannel2);
+
+        UnionInputGate inputGate = new UnionInputGate(inputGate1, inputGate2);
+
+        inputChannel1.notifyChannelNonEmpty();
+        assertTrue(inputGate.getAvailableFuture().isDone());
+        assertFalse(inputGate.pollNext().isPresent());
+        assertFalse(inputGate.getAvailableFuture().isDone());
+    }
 }
