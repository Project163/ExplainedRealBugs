diff --git a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/plan/nodes/logical/FlinkLogicalOverAggregate.scala b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/plan/nodes/logical/FlinkLogicalOverAggregate.scala
index 0c9891f0f17..899a1719094 100644
--- a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/plan/nodes/logical/FlinkLogicalOverAggregate.scala
+++ b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/plan/nodes/logical/FlinkLogicalOverAggregate.scala
@@ -88,7 +88,7 @@ class FlinkLogicalOverAggregateConverter(config: Config) extends ConverterRule(c
           winAggCall =>
             if (orderKeySize == 0 && winAggCall.op.isInstanceOf[SqlRankFunction]) {
               throw new ValidationException(
-                "Over Agg: The window rank function without order by. " +
+                "Over Agg: The window rank function requires order by clause with non-constant fields. " +
                   "please re-check the over window statement.")
             }
         }
diff --git a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/plan/batch/sql/RankTest.scala b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/plan/batch/sql/RankTest.scala
index 01a0100b1c9..9c4eff755a7 100644
--- a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/plan/batch/sql/RankTest.scala
+++ b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/plan/batch/sql/RankTest.scala
@@ -21,6 +21,7 @@ import org.apache.flink.api.scala._
 import org.apache.flink.table.api._
 import org.apache.flink.table.planner.utils.TableTestBase
 
+import org.assertj.core.api.Assertions.assertThatThrownBy
 import org.junit.Test
 
 class RankTest extends TableTestBase {
@@ -28,13 +29,36 @@ class RankTest extends TableTestBase {
   private val util = batchTestUtil()
   util.addTableSource[(Int, String, Long)]("MyTable", 'a, 'b, 'c)
 
-  @Test(expected = classOf[RuntimeException])
   def testRowNumberWithoutOrderBy(): Unit = {
     val sqlQuery =
       """
         |SELECT ROW_NUMBER() over (partition by a) FROM MyTable
       """.stripMargin
-    util.verifyExecPlan(sqlQuery)
+    assertThatThrownBy(() => util.tableEnv.executeSql(sqlQuery))
+      .hasRootCauseMessage(
+        "Over Agg: The window rank function requires order by clause with non-constant fields. " +
+          "please re-check the over window statement.")
+  }
+
+  @Test
+  def testRowNumberWithOrderByConstant(): Unit = {
+    val sqlQuery =
+      """
+        |SELECT *
+        |FROM (
+        |  SELECT a, b,
+        |  ROW_NUMBER() OVER (PARTITION BY b ORDER BY key) AS row_num
+        |  FROM (
+        |  SELECT *, '2023-03-29' AS key
+        |  FROM MyTable
+        |  ) tmp)
+        |WHERE row_num <= 10
+      """.stripMargin
+
+    assertThatThrownBy(() => util.tableEnv.executeSql(sqlQuery))
+      .hasRootCauseMessage(
+        "Over Agg: The window rank function requires order by clause with non-constant fields. " +
+          "please re-check the over window statement.")
   }
 
   @Test(expected = classOf[RuntimeException])
diff --git a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/plan/stream/sql/RankTest.scala b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/plan/stream/sql/RankTest.scala
index b079f356d3d..a6fcd9f0bc1 100644
--- a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/plan/stream/sql/RankTest.scala
+++ b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/plan/stream/sql/RankTest.scala
@@ -22,6 +22,7 @@ import org.apache.flink.table.api._
 import org.apache.flink.table.planner.plan.optimize.RelNodeBlockPlanBuilder
 import org.apache.flink.table.planner.utils.TableTestBase
 
+import org.assertj.core.api.Assertions.assertThatThrownBy
 import org.junit.Test
 
 class RankTest extends TableTestBase {
@@ -418,6 +419,38 @@ class RankTest extends TableTestBase {
     util.verifyRelPlan(sql2, ExplainDetail.CHANGELOG_MODE)
   }
 
+  def testRowNumberWithoutOrderBy(): Unit = {
+    val sqlQuery =
+      """
+        |SELECT ROW_NUMBER() over (partition by a) FROM MyTable
+      """.stripMargin
+    assertThatThrownBy(() => util.tableEnv.executeSql(sqlQuery))
+      .hasRootCauseMessage(
+        "Over Agg: The window rank function requires order by clause with non-constant fields. " +
+          "please re-check the over window statement.")
+  }
+
+  @Test
+  def testRowNumberWithOrderByConstant(): Unit = {
+    val sqlQuery =
+      """
+        |SELECT *
+        |FROM (
+        |  SELECT a, b,
+        |  ROW_NUMBER() OVER (PARTITION BY b ORDER BY key) AS row_num
+        |  FROM (
+        |  SELECT *, '2023-03-29' AS key
+        |  FROM MyTable
+        |  ) tmp)
+        |WHERE row_num <= 10
+      """.stripMargin
+
+    assertThatThrownBy(() => util.tableEnv.executeSql(sqlQuery))
+      .hasRootCauseMessage(
+        "Over Agg: The window rank function requires order by clause with non-constant fields. " +
+          "please re-check the over window statement.")
+  }
+
   @Test
   def testTopNOrderBySumWithCond(): Unit = {
     val subquery =
