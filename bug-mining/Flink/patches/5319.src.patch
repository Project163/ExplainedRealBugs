diff --git a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/SqlClient.java b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/SqlClient.java
index c13556211fc..572437e2a67 100644
--- a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/SqlClient.java
+++ b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/SqlClient.java
@@ -18,6 +18,7 @@
 
 package org.apache.flink.table.client;
 
+import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.table.client.cli.CliClient;
 import org.apache.flink.table.client.cli.CliOptions;
 import org.apache.flink.table.client.cli.CliOptionsParser;
@@ -29,6 +30,7 @@ import org.apache.flink.table.client.gateway.local.LocalExecutor;
 
 import org.apache.commons.io.IOUtils;
 import org.apache.commons.lang3.SystemUtils;
+import org.jline.terminal.Terminal;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
@@ -38,6 +40,9 @@ import java.nio.charset.StandardCharsets;
 import java.nio.file.Path;
 import java.nio.file.Paths;
 import java.util.Arrays;
+import java.util.function.Supplier;
+
+import static org.apache.flink.table.client.cli.CliClient.DEFAULT_TERMINAL_FACTORY;
 
 /**
  * SQL Client for submitting SQL statements. The client can be executed in two modes: a gateway and
@@ -60,13 +65,15 @@ public class SqlClient {
 
     private final boolean isEmbedded;
     private final CliOptions options;
+    private final Supplier<Terminal> terminalFactory;
 
     public static final String MODE_EMBEDDED = "embedded";
     public static final String MODE_GATEWAY = "gateway";
 
-    public SqlClient(boolean isEmbedded, CliOptions options) {
+    public SqlClient(boolean isEmbedded, CliOptions options, Supplier<Terminal> terminalFactory) {
         this.isEmbedded = isEmbedded;
         this.options = options;
+        this.terminalFactory = terminalFactory;
     }
 
     private void start() {
@@ -123,7 +130,7 @@ public class SqlClient {
                             CliOptionsParser.OPTION_FILE.getOpt()));
         }
 
-        try (CliClient cli = new CliClient(sessionId, executor, historyFilePath)) {
+        try (CliClient cli = new CliClient(terminalFactory, sessionId, executor, historyFilePath)) {
             if (options.getInitFile() != null) {
                 boolean success = cli.executeInitialization(readFromURL(options.getInitFile()));
                 if (!success) {
@@ -151,6 +158,11 @@ public class SqlClient {
     // --------------------------------------------------------------------------------------------
 
     public static void main(String[] args) {
+        startClient(args, DEFAULT_TERMINAL_FACTORY);
+    }
+
+    @VisibleForTesting
+    protected static void startClient(String[] args, Supplier<Terminal> terminalFactory) {
         final String mode;
         final String[] modeArgs;
         if (args.length < 1 || args[0].startsWith("-")) {
@@ -171,7 +183,7 @@ public class SqlClient {
                     CliOptionsParser.printHelpEmbeddedModeClient();
                 } else {
                     try {
-                        final SqlClient client = new SqlClient(true, options);
+                        final SqlClient client = new SqlClient(true, options, terminalFactory);
                         client.start();
                     } catch (SqlClientException e) {
                         // make space in terminal
diff --git a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliClient.java b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliClient.java
index a738c977d46..e0772f2ae57 100644
--- a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliClient.java
+++ b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/CliClient.java
@@ -20,7 +20,6 @@ package org.apache.flink.table.client.cli;
 
 import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.table.api.TableResult;
-import org.apache.flink.table.client.SqlClient;
 import org.apache.flink.table.client.SqlClientException;
 import org.apache.flink.table.client.config.ResultMode;
 import org.apache.flink.table.client.config.SqlClientOptions;
@@ -74,6 +73,7 @@ import java.util.List;
 import java.util.Map;
 import java.util.Objects;
 import java.util.Optional;
+import java.util.function.Supplier;
 
 import static org.apache.flink.table.api.config.TableConfigOptions.TABLE_DML_SYNC;
 import static org.apache.flink.table.api.internal.TableResultImpl.TABLE_RESULT_OK;
@@ -99,6 +99,8 @@ import static org.apache.flink.util.Preconditions.checkState;
 public class CliClient implements AutoCloseable {
 
     private static final Logger LOG = LoggerFactory.getLogger(CliClient.class);
+    public static final Supplier<Terminal> DEFAULT_TERMINAL_FACTORY =
+            TerminalUtils::createDefaultTerminal;
 
     private final Executor executor;
 
@@ -110,6 +112,8 @@ public class CliClient implements AutoCloseable {
 
     private final @Nullable MaskingCallback inputTransformer;
 
+    private final Supplier<Terminal> terminalFactory;
+
     private Terminal terminal;
 
     private boolean isRunning;
@@ -127,13 +131,13 @@ public class CliClient implements AutoCloseable {
      * using {@link #close()}.
      */
     @VisibleForTesting
-    CliClient(
-            Terminal terminal,
+    public CliClient(
+            Supplier<Terminal> terminalFactory,
             String sessionId,
             Executor executor,
             Path historyFilePath,
             @Nullable MaskingCallback inputTransformer) {
-        this.terminal = terminal;
+        this.terminalFactory = terminalFactory;
         this.sessionId = sessionId;
         this.executor = executor;
         this.inputTransformer = inputTransformer;
@@ -153,8 +157,12 @@ public class CliClient implements AutoCloseable {
      * Creates a CLI instance with a prepared terminal. Make sure to close the CLI instance
      * afterwards using {@link #close()}.
      */
-    public CliClient(String sessionId, Executor executor, Path historyFilePath) {
-        this(null, sessionId, executor, historyFilePath, null);
+    public CliClient(
+            Supplier<Terminal> terminalFactory,
+            String sessionId,
+            Executor executor,
+            Path historyFilePath) {
+        this(terminalFactory, sessionId, executor, historyFilePath, null);
     }
 
     public Terminal getTerminal() {
@@ -208,9 +216,8 @@ public class CliClient implements AutoCloseable {
 
     /** Opens the interactive CLI shell. */
     public void executeInInteractiveMode() {
-        terminal = TerminalUtils.createDefaultTerminal(useSystemInOutStream);
-
         try {
+            terminal = terminalFactory.get();
             executeInteractive();
         } finally {
             closeTerminal();
@@ -219,7 +226,7 @@ public class CliClient implements AutoCloseable {
 
     public void executeInNonInteractiveMode(String content) {
         try {
-            terminal = TerminalUtils.createDefaultTerminal(useSystemInOutStream);
+            terminal = terminalFactory.get();
             executeFile(content, ExecutionMode.NON_INTERACTIVE_EXECUTION);
         } finally {
             closeTerminal();
@@ -229,7 +236,7 @@ public class CliClient implements AutoCloseable {
     public boolean executeInitialization(String content) {
         try {
             OutputStream outputStream = new ByteArrayOutputStream(256);
-            terminal = TerminalUtils.createDummyTerminal(outputStream);
+            terminal = TerminalUtils.createDumbTerminal(outputStream);
             boolean success = executeFile(content, ExecutionMode.INITIALIZATION);
             LOG.info(outputStream.toString());
             return success;
@@ -254,8 +261,7 @@ public class CliClient implements AutoCloseable {
      * Execute statement from the user input and prints status information and/or errors on the
      * terminal.
      */
-    @VisibleForTesting
-    void executeInteractive() {
+    private void executeInteractive() {
         isRunning = true;
         LineReader lineReader = createLineReader(terminal);
 
@@ -297,8 +303,7 @@ public class CliClient implements AutoCloseable {
      *
      * @param content SQL file content
      */
-    @VisibleForTesting
-    boolean executeFile(String content, ExecutionMode mode) {
+    private boolean executeFile(String content, ExecutionMode mode) {
         terminal.writer().println(CliStrings.messageInfo(CliStrings.MESSAGE_EXECUTE_FILE).toAnsi());
 
         for (String statement : CliStatementSplitter.splitContent(content)) {
@@ -648,21 +653,14 @@ public class CliClient implements AutoCloseable {
         if (Files.exists(historyFilePath) || CliUtils.createFile(historyFilePath)) {
             String msg = "Command history file path: " + historyFilePath;
             // print it in the command line as well as log file
-            System.out.println(msg);
+            terminal.writer().println(msg);
             LOG.info(msg);
             lineReader.setVariable(LineReader.HISTORY_FILE, historyFilePath);
         } else {
             String msg = "Unable to create history file: " + historyFilePath;
-            System.out.println(msg);
+            terminal.writer().println(msg);
             LOG.warn(msg);
         }
         return lineReader;
     }
-
-    /**
-     * Internal flag to use {@link System#in} and {@link System#out} stream to construct {@link
-     * Terminal} for tests. This allows tests can easily mock input stream when startup {@link
-     * SqlClient}.
-     */
-    protected static boolean useSystemInOutStream = false;
 }
diff --git a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/TerminalUtils.java b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/TerminalUtils.java
index b3ba988de65..b1ae40860c1 100644
--- a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/TerminalUtils.java
+++ b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/cli/TerminalUtils.java
@@ -35,11 +35,11 @@ public class TerminalUtils {
         // do not instantiate
     }
 
-    public static Terminal createDummyTerminal() {
-        return createDummyTerminal(new MockOutputStream());
+    public static Terminal createDumbTerminal() {
+        return createDumbTerminal(new MockOutputStream());
     }
 
-    public static Terminal createDummyTerminal(OutputStream out) {
+    public static Terminal createDumbTerminal(OutputStream out) {
         try {
             return new DumbTerminal(new MockInputStream(), out);
         } catch (IOException e) {
@@ -47,16 +47,17 @@ public class TerminalUtils {
         }
     }
 
-    public static Terminal createDefaultTerminal(boolean useSystemInOutStream) {
+    public static Terminal createDumbTerminal(InputStream in, OutputStream out) {
         try {
-            if (useSystemInOutStream) {
-                return TerminalBuilder.builder()
-                        .name(CliStrings.CLI_NAME)
-                        .streams(System.in, System.out)
-                        .build();
-            } else {
-                return TerminalBuilder.builder().name(CliStrings.CLI_NAME).build();
-            }
+            return new DumbTerminal(in, out);
+        } catch (IOException e) {
+            throw new SqlClientException("Unable to create dummy terminal.", e);
+        }
+    }
+
+    public static Terminal createDefaultTerminal() {
+        try {
+            return TerminalBuilder.builder().name(CliStrings.CLI_NAME).build();
         } catch (IOException e) {
             throw new SqlClientException("Error opening command line interface.", e);
         }
diff --git a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/SqlClientTest.java b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/SqlClientTest.java
index a20a8486a50..25e8df21732 100644
--- a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/SqlClientTest.java
+++ b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/SqlClientTest.java
@@ -19,22 +19,23 @@
 package org.apache.flink.table.client;
 
 import org.apache.flink.core.testutils.CommonTestUtils;
-import org.apache.flink.table.client.cli.TerminalStreamsResource;
+import org.apache.flink.table.client.cli.TerminalUtils;
 import org.apache.flink.util.FileUtils;
 
+import org.jline.terminal.Terminal;
 import org.junit.After;
 import org.junit.Before;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.rules.ExpectedException;
 import org.junit.rules.TemporaryFolder;
+import org.junit.rules.Timeout;
 
 import java.io.ByteArrayInputStream;
 import java.io.ByteArrayOutputStream;
 import java.io.File;
 import java.io.IOException;
-import java.io.InputStream;
-import java.io.PrintStream;
+import java.io.OutputStream;
 import java.net.URL;
 import java.nio.charset.StandardCharsets;
 import java.nio.file.Files;
@@ -45,12 +46,11 @@ import java.util.Collections;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
-import java.util.Objects;
+import java.util.concurrent.TimeUnit;
 
 import static org.apache.flink.configuration.ConfigConstants.ENV_FLINK_CONF_DIR;
 import static org.hamcrest.CoreMatchers.containsString;
 import static org.hamcrest.CoreMatchers.not;
-import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertThat;
 
 /** Tests for {@link SqlClient}. */
@@ -60,27 +60,15 @@ public class SqlClientTest {
 
     @Rule public TemporaryFolder tempFolder = new TemporaryFolder();
 
-    @Rule public final TerminalStreamsResource useSystemStream = TerminalStreamsResource.INSTANCE;
-
-    private PrintStream originalPrintStream;
-
-    private InputStream originalInputStream;
-
-    private ByteArrayOutputStream testOutputStream;
-
     private Map<String, String> originalEnv;
 
     private String historyPath;
 
+    @Rule public Timeout timeout = new Timeout(1000, TimeUnit.SECONDS);
+
     @Before
     public void before() throws IOException {
         originalEnv = System.getenv();
-        originalPrintStream = System.out;
-        originalInputStream = System.in;
-        testOutputStream = new ByteArrayOutputStream();
-        System.setOut(new PrintStream(testOutputStream, true));
-        // send "QUIT;" command to gracefully shutdown the terminal
-        System.setIn(new ByteArrayInputStream("QUIT;\n".getBytes(StandardCharsets.UTF_8)));
 
         // prepare conf dir
         File confFolder = tempFolder.newFolder("conf");
@@ -99,41 +87,35 @@ public class SqlClientTest {
 
     @After
     public void after() {
-        System.setOut(originalPrintStream);
-        System.setIn(originalInputStream);
         CommonTestUtils.setEnv(originalEnv);
     }
 
-    private String getStdoutString() {
-        return testOutputStream.toString();
-    }
-
     @Test
-    public void testEmbeddedWithOptions() {
+    public void testEmbeddedWithOptions() throws Exception {
         String[] args = new String[] {"embedded", "-hist", historyPath};
-        SqlClient.main(args);
-        assertThat(getStdoutString(), containsString("Command history file path: " + historyPath));
+        String actual = runSqlClient(args);
+        assertThat(actual, containsString("Command history file path: " + historyPath));
     }
 
     @Test
-    public void testEmbeddedWithLongOptions() {
+    public void testEmbeddedWithLongOptions() throws Exception {
         String[] args = new String[] {"embedded", "--history", historyPath};
-        SqlClient.main(args);
-        assertThat(getStdoutString(), containsString("Command history file path: " + historyPath));
+        String actual = runSqlClient(args);
+        assertThat(actual, containsString("Command history file path: " + historyPath));
     }
 
     @Test
-    public void testEmbeddedWithoutOptions() {
+    public void testEmbeddedWithoutOptions() throws Exception {
         String[] args = new String[] {"embedded"};
-        SqlClient.main(args);
-        assertThat(getStdoutString(), containsString("Command history file path"));
+        String actual = runSqlClient(args);
+        assertThat(actual, containsString("Command history file path: "));
     }
 
     @Test
-    public void testEmptyOptions() {
+    public void testEmptyOptions() throws Exception {
         String[] args = new String[] {};
-        SqlClient.main(args);
-        assertThat(getStdoutString(), containsString("Command history file path"));
+        String actual = runSqlClient(args);
+        assertThat(actual, containsString("Command history file path"));
     }
 
     @Test
@@ -145,26 +127,14 @@ public class SqlClientTest {
     }
 
     @Test
-    public void testPrintHelpForUnknownMode() throws IOException {
-        String[] args = new String[] {"unknown"};
-        SqlClient.main(args);
-        final URL url = getClass().getClassLoader().getResource("sql-client-help.out");
-        Objects.requireNonNull(url);
-        final String help = FileUtils.readFileUtf8(new File(url.getFile()));
-        assertEquals(help, getStdoutString());
-    }
-
-    @Test
-    public void testErrorMessage() {
+    public void testErrorMessage() throws Exception {
         // prepare statements which will throw exception
         String stmts =
                 "CREATE TABLE T (a int) WITH ('connector' = 'invalid');\n"
                         + "SELECT * FROM T;\n"
                         + "QUIT;\n";
-        System.setIn(new ByteArrayInputStream(stmts.getBytes(StandardCharsets.UTF_8)));
         String[] args = new String[] {};
-        SqlClient.main(args);
-        String output = getStdoutString();
+        String output = runSqlClient(args, stmts);
         assertThat(
                 output,
                 containsString(
@@ -182,17 +152,15 @@ public class SqlClientTest {
     }
 
     @Test
-    public void testVerboseErrorMessage() {
+    public void testVerboseErrorMessage() throws Exception {
         // prepare statements which will throw exception
         String stmts =
                 "CREATE TABLE T (a int) WITH ('connector' = 'invalid');\n"
                         + "SET sql-client.verbose=true;\n"
                         + "SELECT * FROM T;\n"
                         + "QUIT;\n";
-        System.setIn(new ByteArrayInputStream(stmts.getBytes(StandardCharsets.UTF_8)));
         String[] args = new String[] {};
-        SqlClient.main(args);
-        String output = getStdoutString();
+        String output = runSqlClient(args, stmts);
         String[] errors =
                 new String[] {
                     "org.apache.flink.table.api.ValidationException: Could not find any factory for identifier 'invalid'",
@@ -205,7 +173,7 @@ public class SqlClientTest {
     }
 
     @Test
-    public void testInitFile() throws IOException {
+    public void testInitFile() throws Exception {
         List<String> statements =
                 Arrays.asList(
                         "CREATE TABLE source ("
@@ -214,30 +182,44 @@ public class SqlClientTest {
                                 + ") WITH ("
                                 + "  'connector' = 'values'"
                                 + ");\n",
-                        "SET key=value;\n");
+                        "SET key = value;\n");
         String initFile = createSqlFile(statements, "init-sql.sql");
 
         String[] args = new String[] {"-i", initFile};
-        SqlClient.main(args);
-
-        assertThat(getStdoutString(), containsString("Successfully initialized from sql script: "));
+        String output = runSqlClient(args, "SET;\nQUIT;\n");
+        assertThat(output, containsString("key=value"));
     }
 
     @Test
-    public void testExecuteSqlFile() throws IOException {
-        List<String> statements = Collections.singletonList("HELP;");
+    public void testExecuteSqlFile() throws Exception {
+        List<String> statements = Collections.singletonList("HELP;\n");
         String sqlFilePath = createSqlFile(statements, "test-sql.sql");
         String[] args = new String[] {"-f", sqlFilePath};
-        SqlClient.main(args);
+        String output = runSqlClient(args);
         final URL url = getClass().getClassLoader().getResource("sql-client-help-command.out");
         final String help = FileUtils.readFileUtf8(new File(url.getFile()));
-        final String output = getStdoutString();
 
         for (String command : help.split("\n")) {
             assertThat(output, containsString(command));
         }
     }
 
+    private String runSqlClient(String[] args) throws Exception {
+        return runSqlClient(args, "QUIT;\n");
+    }
+
+    private String runSqlClient(String[] args, String statements) throws Exception {
+        try (OutputStream out = new ByteArrayOutputStream();
+                Terminal terminal =
+                        TerminalUtils.createDumbTerminal(
+                                new ByteArrayInputStream(
+                                        statements.getBytes(StandardCharsets.UTF_8)),
+                                out)) {
+            SqlClient.startClient(args, () -> terminal);
+            return out.toString();
+        }
+    }
+
     private String createSqlFile(List<String> statements, String name) throws IOException {
         // create sql file
         File sqlFileFolder = tempFolder.newFolder("sql-file");
diff --git a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliClientITCase.java b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliClientITCase.java
index 634f7ee1388..ea018877d84 100644
--- a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliClientITCase.java
+++ b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliClientITCase.java
@@ -156,12 +156,12 @@ public class CliClientITCase extends AbstractTestBase {
         try (Terminal terminal = new DumbTerminal(inputStream, outputStream);
                 CliClient client =
                         new CliClient(
-                                terminal,
+                                () -> terminal,
                                 sessionId,
                                 executor,
                                 historyPath,
                                 HideSqlStatement.INSTANCE)) {
-            client.executeInteractive();
+            client.executeInInteractiveMode();
             String output = new String(outputStream.toByteArray());
             return normalizeOutput(output);
         }
diff --git a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliClientTest.java b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliClientTest.java
index 2d31f089170..e4173ae9a45 100644
--- a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliClientTest.java
+++ b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliClientTest.java
@@ -72,6 +72,7 @@ import java.util.List;
 import java.util.Map;
 
 import static org.apache.flink.table.api.config.TableConfigOptions.TABLE_DML_SYNC;
+import static org.apache.flink.table.client.cli.CliClient.DEFAULT_TERMINAL_FACTORY;
 import static org.apache.flink.table.client.cli.CliStrings.MESSAGE_SQL_EXECUTION_ERROR;
 import static org.hamcrest.CoreMatchers.containsString;
 import static org.junit.Assert.assertEquals;
@@ -137,8 +138,9 @@ public class CliClientTest extends TestLogger {
         try (Terminal terminal =
                         new DumbTerminal(inputStream, new TerminalUtils.MockOutputStream());
                 CliClient client =
-                        new CliClient(terminal, sessionId, mockExecutor, historyFilePath, null)) {
-            client.executeInteractive();
+                        new CliClient(
+                                () -> terminal, sessionId, mockExecutor, historyFilePath, null)) {
+            client.executeInInteractiveMode();
             List<String> content = Files.readAllLines(historyFilePath);
             assertEquals(2, content.size());
             assertTrue(content.get(0).contains("help"));
@@ -231,7 +233,8 @@ public class CliClientTest extends TestLogger {
 
         final MockExecutor mockExecutor = new MockExecutor();
         String sessionId = mockExecutor.openSession("test-session");
-        CliClient cliClient = new CliClient(sessionId, mockExecutor, historyTempFile());
+        CliClient cliClient =
+                new CliClient(DEFAULT_TERMINAL_FACTORY, sessionId, mockExecutor, historyTempFile());
 
         assertFalse("Should fail", cliClient.executeInitialization(content));
     }
@@ -273,17 +276,12 @@ public class CliClientTest extends TestLogger {
 
         try (CliClient client =
                 new CliClient(
-                        TerminalUtils.createDummyTerminal(outputStream),
+                        () -> TerminalUtils.createDumbTerminal(outputStream),
                         sessionId,
                         mockExecutor,
                         historyFilePath,
                         null)) {
-            Thread thread =
-                    new Thread(
-                            () ->
-                                    client.executeFile(
-                                            content,
-                                            CliClient.ExecutionMode.NON_INTERACTIVE_EXECUTION));
+            Thread thread = new Thread(() -> client.executeInNonInteractiveMode(content));
             thread.start();
 
             while (!mockExecutor.isAwait) {
@@ -330,7 +328,7 @@ public class CliClientTest extends TestLogger {
         final SqlCompleter completer = new SqlCompleter(sessionId, mockExecutor);
         final SqlMultiLineParser parser = new SqlMultiLineParser();
 
-        try (Terminal terminal = TerminalUtils.createDummyTerminal()) {
+        try (Terminal terminal = TerminalUtils.createDumbTerminal()) {
             final LineReader reader = LineReaderBuilder.builder().terminal(terminal).build();
 
             final ParsedLine parsedLine =
@@ -356,12 +354,12 @@ public class CliClientTest extends TestLogger {
         OutputStream outputStream = new ByteArrayOutputStream(256);
         try (CliClient client =
                 new CliClient(
-                        TerminalUtils.createDummyTerminal(outputStream),
+                        () -> TerminalUtils.createDumbTerminal(outputStream),
                         sessionId,
                         executor,
                         historyTempFile(),
                         null)) {
-            client.executeFile(content, CliClient.ExecutionMode.NON_INTERACTIVE_EXECUTION);
+            client.executeInNonInteractiveMode(content);
         }
         return outputStream.toString();
     }
diff --git a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliResultViewTest.java b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliResultViewTest.java
index c2c0d2a9004..220ebb3c2fa 100644
--- a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliResultViewTest.java
+++ b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliResultViewTest.java
@@ -31,12 +31,15 @@ import org.apache.flink.table.operations.Operation;
 import org.apache.flink.table.operations.QueryOperation;
 import org.apache.flink.types.Row;
 
+import org.jline.reader.MaskingCallback;
+import org.jline.terminal.Terminal;
 import org.jline.utils.AttributedString;
 import org.junit.Test;
 
 import javax.annotation.Nullable;
 
 import java.io.File;
+import java.nio.file.Path;
 import java.util.Collections;
 import java.util.List;
 import java.util.Map;
@@ -95,8 +98,8 @@ public class CliResultViewTest {
                         true);
 
         try (CliClient cli =
-                new CliClient(
-                        TerminalUtils.createDummyTerminal(),
+                new TestingCliClient(
+                        TerminalUtils.createDumbTerminal(),
                         sessionId,
                         executor,
                         File.createTempFile("history", "tmp").toPath(),
@@ -264,4 +267,34 @@ public class CliResultViewTest {
             return Collections.emptyList();
         }
     }
+
+    private static class TestingCliClient extends CliClient {
+
+        private final Terminal terminal;
+
+        public TestingCliClient(
+                Terminal terminal,
+                String sessionId,
+                Executor executor,
+                Path historyFilePath,
+                @Nullable MaskingCallback inputTransformer) {
+            super(() -> terminal, sessionId, executor, historyFilePath, inputTransformer);
+            this.terminal = terminal;
+        }
+
+        @Override
+        public Terminal getTerminal() {
+            return terminal;
+        }
+
+        @Override
+        public boolean isPlainTerminal() {
+            return true;
+        }
+
+        @Override
+        public void clearTerminal() {
+            // do nothing
+        }
+    }
 }
diff --git a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliTableauResultViewTest.java b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliTableauResultViewTest.java
index 2f06b0776a5..89d6d138de8 100644
--- a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliTableauResultViewTest.java
+++ b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/CliTableauResultViewTest.java
@@ -60,7 +60,7 @@ public class CliTableauResultViewTest {
     @Before
     public void setUp() {
         terminalOutput = new ByteArrayOutputStream();
-        terminal = TerminalUtils.createDummyTerminal(terminalOutput);
+        terminal = TerminalUtils.createDumbTerminal(terminalOutput);
 
         schema =
                 ResolvedSchema.of(
diff --git a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/TerminalStreamsResource.java b/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/TerminalStreamsResource.java
deleted file mode 100644
index c2d2fcd29bc..00000000000
--- a/flink-table/flink-sql-client/src/test/java/org/apache/flink/table/client/cli/TerminalStreamsResource.java
+++ /dev/null
@@ -1,50 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.flink.table.client.cli;
-
-import org.junit.rules.ExternalResource;
-
-import java.io.PrintStream;
-
-/**
- * Enables {@link org.apache.flink.table.client.SqlClient} to create a default terminal using {@link
- * System#in} and {@link System#out} as the input and output stream. This can allows tests to easily
- * mock input stream of the SqlClient by hijacking the standard stream.
- */
-public class TerminalStreamsResource extends ExternalResource {
-
-    public static final TerminalStreamsResource INSTANCE = new TerminalStreamsResource();
-    public static final PrintStream STD_OUT = System.out;
-
-    private TerminalStreamsResource() {
-        // singleton
-    }
-
-    @Override
-    protected void before() throws Throwable {
-        CliClient.useSystemInOutStream = true;
-    }
-
-    @Override
-    protected void after() {
-        CliClient.useSystemInOutStream = false;
-        // Reset the System.out
-        System.setOut(STD_OUT);
-    }
-}
diff --git a/flink-table/flink-sql-client/src/test/resources/sql-client-help.out b/flink-table/flink-sql-client/src/test/resources/sql-client-help.out
deleted file mode 100644
index cfdc1a869af..00000000000
--- a/flink-table/flink-sql-client/src/test/resources/sql-client-help.out
+++ /dev/null
@@ -1,126 +0,0 @@
-./sql-client [MODE] [OPTIONS]
-
-The following options are available:
-
-Mode "embedded" (default) submits Flink jobs from the local machine.
-
-  Syntax: [embedded] [OPTIONS]
-  "embedded" mode options:
-     -d,--defaults <environment file>      Deprecated feature: the environment
-                                           properties with which every new
-                                           session is initialized. Properties
-                                           might be overwritten by session
-                                           properties.
-     -e,--environment <environment file>   Deprecated feature: the environment
-                                           properties to be imported into the
-                                           session. It might overwrite default
-                                           environment properties.
-     -f,--file <script file>               Script file that should be executed.
-                                           In this mode, the client will not
-                                           open an interactive terminal.
-     -h,--help                             Show the help message with
-                                           descriptions of all options.
-     -hist,--history <History file path>   The file which you want to save the
-                                           command history into. If not
-                                           specified, we will auto-generate one
-                                           under your user's home directory.
-     -i,--init <initialization file>       Script file that used to init the
-                                           session context. If get error in
-                                           execution, the sql client will exit.
-                                           Notice it's not allowed to add query
-                                           or insert into the init file.
-     -j,--jar <JAR file>                   A JAR file to be imported into the
-                                           session. The file might contain
-                                           user-defined classes needed for the
-                                           execution of statements such as
-                                           functions, table sources, or sinks.
-                                           Can be used multiple times.
-     -l,--library <JAR directory>          A JAR file directory with which every
-                                           new session is initialized. The files
-                                           might contain user-defined classes
-                                           needed for the execution of
-                                           statements such as functions, table
-                                           sources, or sinks. Can be used
-                                           multiple times.
-     -pyarch,--pyArchives <arg>            Add python archive files for job. The
-                                           archive files will be extracted to
-                                           the working directory of python UDF
-                                           worker. Currently only zip-format is
-                                           supported. For each archive file, a
-                                           target directory be specified. If the
-                                           target directory name is specified,
-                                           the archive file will be extracted to
-                                           a name can directory with the
-                                           specified name. Otherwise, the
-                                           archive file will be extracted to a
-                                           directory with the same name of the
-                                           archive file. The files uploaded via
-                                           this option are accessible via
-                                           relative path. '#' could be used as
-                                           the separator of the archive file
-                                           path and the target directory name.
-                                           Comma (',') could be used as the
-                                           separator to specify multiple archive
-                                           files. This option can be used to
-                                           upload the virtual environment, the
-                                           data files used in Python UDF (e.g.:
-                                           --pyArchives
-                                           file:///tmp/py37.zip,file:///tmp/data
-                                           .zip#data --pyExecutable
-                                           py37.zip/py37/bin/python). The data
-                                           files could be accessed in Python
-                                           UDF, e.g.: f = open('data/data.txt',
-                                           'r').
-     -pyexec,--pyExecutable <arg>          Specify the path of the python
-                                           interpreter used to execute the
-                                           python UDF worker (e.g.:
-                                           --pyExecutable
-                                           /usr/local/bin/python3). The python
-                                           UDF worker depends on Python 3.6+,
-                                           Apache Beam (version == 2.27.0), Pip
-                                           (version >= 7.1.0) and SetupTools
-                                           (version >= 37.0.0). Please ensure
-                                           that the specified environment meets
-                                           the above requirements.
-     -pyfs,--pyFiles <pythonFiles>         Attach custom python files for job.
-                                           The standard python resource file
-                                           suffixes such as .py/.egg/.zip or
-                                           directory are all supported. These
-                                           files will be added to the PYTHONPATH
-                                           of both the local client and the
-                                           remote python UDF worker. Files
-                                           suffixed with .zip will be extracted
-                                           and added to PYTHONPATH. Comma (',')
-                                           could be used as the separator to
-                                           specify multiple files (e.g.:
-                                           --pyFiles
-                                           file:///tmp/myresource.zip,hdfs:///$n
-                                           amenode_address/myresource2.zip).
-     -pyreq,--pyRequirements <arg>         Specify a requirements.txt file which
-                                           defines the third-party dependencies.
-                                           These dependencies will be installed
-                                           and added to the PYTHONPATH of the
-                                           python UDF worker. A directory which
-                                           contains the installation packages of
-                                           these dependencies could be specified
-                                           optionally. Use '#' as the separator
-                                           if the optional parameter exists
-                                           (e.g.: --pyRequirements
-                                           file:///tmp/requirements.txt#file:///
-                                           tmp/cached_dir).
-     -s,--session <session identifier>     The identifier for a session.
-                                           'default' is the default identifier.
-     -u,--update <SQL update statement>    Deprecated Experimental (for testing
-                                           only!) feature: Instructs the SQL
-                                           Client to immediately execute the
-                                           given update statement after starting
-                                           up. The process is shut down after
-                                           the statement has been submitted to
-                                           the cluster and returns an
-                                           appropriate return code. Currently,
-                                           this feature is only supported for
-                                           INSERT INTO statements that declare
-                                           the target sink table.Please use
-                                           option -f to submit update statement.
-
-
