diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/state/changelog/inmemory/InMemoryStateChangelogWriter.java b/flink-runtime/src/main/java/org/apache/flink/runtime/state/changelog/inmemory/InMemoryStateChangelogWriter.java
index 62cd9f365d4..3e33aea6ebc 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/state/changelog/inmemory/InMemoryStateChangelogWriter.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/state/changelog/inmemory/InMemoryStateChangelogWriter.java
@@ -99,7 +99,9 @@ class InMemoryStateChangelogWriter implements StateChangelogWriter<InMemoryChang
         LOG.debug("Persist after {}", from);
         Preconditions.checkNotNull(from);
         return completedFuture(
-                SnapshotResult.of(
+                SnapshotResult.withLocalState(
+                        new InMemoryChangelogStateHandle(
+                                collectChanges(from), from, sqn, keyGroupRange),
                         new InMemoryChangelogStateHandle(
                                 collectChanges(from), from, sqn, keyGroupRange)));
     }
diff --git a/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogKeyedStateBackend.java b/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogKeyedStateBackend.java
index b9f5f93911b..8d2b41a532d 100644
--- a/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogKeyedStateBackend.java
+++ b/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogKeyedStateBackend.java
@@ -95,6 +95,7 @@ import java.util.concurrent.FutureTask;
 import java.util.concurrent.RunnableFuture;
 import java.util.concurrent.TimeUnit;
 import java.util.concurrent.TimeoutException;
+import java.util.concurrent.atomic.AtomicBoolean;
 import java.util.stream.Stream;
 
 import static java.util.Collections.emptyList;
@@ -199,6 +200,14 @@ public class ChangelogKeyedStateBackend<K>
 
     private final ChangelogTruncateHelper changelogTruncateHelper;
 
+    /**
+     * The local snapshot is considered complete when there is at least one successful
+     * materialization after rescaling.
+     */
+    private AtomicBoolean hasCompletedMaterialization = new AtomicBoolean(false);
+
+    private boolean isRescaling = false;
+
     public ChangelogKeyedStateBackend(
             AbstractKeyedStateBackend<K> keyedStateBackend,
             String subtaskName,
@@ -500,8 +509,9 @@ public class ChangelogKeyedStateBackend<K>
         if (prevDeltaCopy.isEmpty()
                 && changelogStateBackendStateCopy.getMaterializedSnapshot().isEmpty()) {
             return SnapshotResult.empty();
-        } else if (!changelogStateBackendStateCopy.getLocalMaterializedSnapshot().isEmpty()
-                || delta.getTaskLocalSnapshot() != null) {
+        } else if ((!isRescaling || hasCompletedMaterialization.get())
+                && (!changelogStateBackendStateCopy.getLocalMaterializedSnapshot().isEmpty()
+                        || delta.getTaskLocalSnapshot() != null)) {
             List<ChangelogStateHandle> localDeltaCopy =
                     new ArrayList<>(
                             changelogStateBackendStateCopy.getLocalRestoredNonMaterialized());
@@ -771,7 +781,7 @@ public class ChangelogKeyedStateBackend<K>
 
         List<KeyedStateHandle> localMaterialized = new ArrayList<>();
         List<ChangelogStateHandle> localRestoredNonMaterialized = new ArrayList<>();
-
+        isRescaling = stateHandles.size() > 1;
         for (ChangelogStateBackendHandle h : stateHandles) {
             if (h != null) {
                 if (h instanceof ChangelogStateBackendLocalHandle) {
@@ -794,7 +804,8 @@ public class ChangelogKeyedStateBackend<K>
         this.lastConfirmedMaterializationId = materializationId;
         this.materializedId = materializationId + 1;
 
-        if (!localMaterialized.isEmpty() || !localRestoredNonMaterialized.isEmpty()) {
+        if (!isRescaling
+                && (!localMaterialized.isEmpty() || !localRestoredNonMaterialized.isEmpty())) {
             return new ChangelogSnapshotState(
                     materialized,
                     localMaterialized,
@@ -904,7 +915,7 @@ public class ChangelogKeyedStateBackend<K>
                                 Collections.emptyList(),
                                 upTo,
                                 materializationID);
-
+        hasCompletedMaterialization.set(true);
         changelogTruncateHelper.materialized(upTo);
     }
 
diff --git a/flink-tests/src/test/java/org/apache/flink/test/checkpointing/AutoRescalingITCase.java b/flink-tests/src/test/java/org/apache/flink/test/checkpointing/AutoRescalingITCase.java
index 29db74d9295..c7638aff79a 100644
--- a/flink-tests/src/test/java/org/apache/flink/test/checkpointing/AutoRescalingITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/test/checkpointing/AutoRescalingITCase.java
@@ -37,7 +37,6 @@ import org.apache.flink.configuration.Configuration;
 import org.apache.flink.configuration.JobManagerOptions;
 import org.apache.flink.configuration.NettyShuffleEnvironmentOptions;
 import org.apache.flink.configuration.StateBackendOptions;
-import org.apache.flink.configuration.StateChangelogOptions;
 import org.apache.flink.configuration.StateRecoveryOptions;
 import org.apache.flink.configuration.WebOptions;
 import org.apache.flink.contrib.streaming.state.RocksDBConfigurableOptions;
@@ -165,8 +164,6 @@ public class AutoRescalingITCase extends TestLogger {
             config.set(StateBackendOptions.STATE_BACKEND, currentBackend);
             config.set(RocksDBConfigurableOptions.USE_INGEST_DB_RESTORE_MODE, useIngestDB);
             config.set(CheckpointingOptions.INCREMENTAL_CHECKPOINTS, true);
-            // todo: local rescaling is not supported by changelog.
-            config.set(StateChangelogOptions.ENABLE_STATE_CHANGE_LOG, false);
             config.set(StateRecoveryOptions.LOCAL_RECOVERY, true);
             config.set(
                     CheckpointingOptions.CHECKPOINTS_DIRECTORY, checkpointDir.toURI().toString());
