diff --git a/docs/dev/batch/dataset_transformations.md b/docs/dev/batch/dataset_transformations.md
index 1f942d4869c..fb85b076efc 100644
--- a/docs/dev/batch/dataset_transformations.md
+++ b/docs/dev/batch/dataset_transformations.md
@@ -620,6 +620,7 @@ val output = input.groupBy(0).sortGroup(1, Order.ASCENDING).reduceGroup {
         for (t <- in) {
           if (prev == null || prev != t)
             out.collect(t)
+            prev = t
         }
     }
 
