diff --git a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/abilities/source/ReadingMetadataSpec.java b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/abilities/source/ReadingMetadataSpec.java
index ff05707005f..f67d2dc2fa0 100644
--- a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/abilities/source/ReadingMetadataSpec.java
+++ b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/abilities/source/ReadingMetadataSpec.java
@@ -55,6 +55,10 @@ public class ReadingMetadataSpec extends SourceAbilitySpecBase {
         this.metadataKeys = new ArrayList<>(checkNotNull(metadataKeys));
     }
 
+    public List<String> getMetadataKeys() {
+        return metadataKeys;
+    }
+
     @Override
     public void apply(DynamicTableSource tableSource, SourceAbilityContext context) {
         if (tableSource instanceof SupportsReadingMetadata) {
diff --git a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PushProjectIntoTableSourceScanRule.java b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PushProjectIntoTableSourceScanRule.java
index 1f478220f09..9c512735903 100644
--- a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PushProjectIntoTableSourceScanRule.java
+++ b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/rules/logical/PushProjectIntoTableSourceScanRule.java
@@ -155,8 +155,8 @@ public class PushProjectIntoTableSourceScanRule extends RelOptRule {
 
         DynamicTableSource newSource = oldSource.copy();
         SourceAbilityContext context = SourceAbilityContext.from(scan);
-        for (SourceAbilitySpec pushDownSpec : sourceAbilitySpecs) {
-            pushDownSpec.apply(newSource, context);
+        for (SourceAbilitySpec abilitySpec : sourceAbilitySpecs) {
+            abilitySpec.apply(newSource, context);
         }
 
         RelDataType newRowType = flinkTypeFactory.buildRelNodeRowType(newProducedType);
@@ -166,9 +166,7 @@ public class PushProjectIntoTableSourceScanRule extends RelOptRule {
                 oldTableSourceTable.copy(
                         newSource,
                         newRowType,
-                        new String[] {
-                            ("project=[" + String.join(", ", newRowType.getFieldNames()) + "]")
-                        },
+                        getExtraDigests(newRowType, sourceAbilitySpecs),
                         sourceAbilitySpecs.toArray(new SourceAbilitySpec[0]));
         LogicalTableScan newScan =
                 new LogicalTableScan(
@@ -194,6 +192,24 @@ public class PushProjectIntoTableSourceScanRule extends RelOptRule {
         }
     }
 
+    private static String[] getExtraDigests(
+            RelDataType rowType, List<SourceAbilitySpec> abilitySpecs) {
+        final List<String> digests = new ArrayList<>();
+        digests.add(String.format("project=[%s]", String.join(", ", rowType.getFieldNames())));
+
+        for (SourceAbilitySpec abilitySpec : abilitySpecs) {
+            if (abilitySpec instanceof ReadingMetadataSpec) {
+                final ReadingMetadataSpec metadataSpec = (ReadingMetadataSpec) abilitySpec;
+                digests.add(
+                        String.format(
+                                "metadata=[%s]",
+                                String.join(", ", metadataSpec.getMetadataKeys())));
+            }
+        }
+
+        return digests.toArray(new String[0]);
+    }
+
     /** Returns true if the primary key is required and should be retained. */
     private static boolean isPrimaryKeyFieldsRequired(TableSourceTable table, TableConfig config) {
         return DynamicSourceUtils.isUpsertSource(table.catalogTable(), table.tableSource())
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/rules/logical/PushProjectIntoTableSourceScanRuleTest.xml b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/rules/logical/PushProjectIntoTableSourceScanRuleTest.xml
index 6dfaa2e9639..a5284026487 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/rules/logical/PushProjectIntoTableSourceScanRuleTest.xml
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/rules/logical/PushProjectIntoTableSourceScanRuleTest.xml
@@ -157,7 +157,7 @@ LogicalProject(id=[$0], nested1=[$1.nested1], results=[+(+($1.nested1.value, $1.
     <Resource name="optimized rel plan">
       <![CDATA[
 LogicalProject(id=[$0], nested1=[$1], results=[+(+($1.value, $2), $3)])
-+- LogicalTableScan(table=[[default_catalog, default_database, MetadataTable, project=[id, deepNested_nested1, deepNested_nested2_num, metadata_1]]])
++- LogicalTableScan(table=[[default_catalog, default_database, MetadataTable, project=[id, deepNested_nested1, deepNested_nested2_num, metadata_1], metadata=[metadata_1]]])
 ]]>
     </Resource>
   </TestCase>
@@ -176,7 +176,7 @@ LogicalProject(id=[$0], nested1=[$1.nested1], results=[+(+($1.nested1.value, $1.
     <Resource name="optimized rel plan">
       <![CDATA[
 LogicalProject(id=[$0], nested1=[$1], results=[+(+($1.value, $2), $3)])
-+- LogicalTableScan(table=[[default_catalog, default_database, MetadataTable, project=[id, deepNested_nested1, deepNested_nested2_num, metadata_1]]])
++- LogicalTableScan(table=[[default_catalog, default_database, MetadataTable, project=[id, deepNested_nested1, deepNested_nested2_num, metadata_1], metadata=[metadata_1]]])
 ]]>
     </Resource>
   </TestCase>
