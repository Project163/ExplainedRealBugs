diff --git a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBKeyedStateBackend.java b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBKeyedStateBackend.java
index 6a661210ec7..41b7bd00dbf 100644
--- a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBKeyedStateBackend.java
+++ b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBKeyedStateBackend.java
@@ -1620,7 +1620,6 @@ public class RocksDBKeyedStateBackend<K> extends AbstractKeyedStateBackend<K> {
 			CheckpointOptions checkpointOptions) throws Exception {
 
 			long startTime = System.currentTimeMillis();
-			final CloseableRegistry snapshotCloseableRegistry = new CloseableRegistry();
 
 			if (kvStateInformation.isEmpty()) {
 				if (LOG.isDebugEnabled()) {
@@ -1647,6 +1646,8 @@ public class RocksDBKeyedStateBackend<K> extends AbstractKeyedStateBackend<K> {
 						CheckpointedStateScope.EXCLUSIVE,
 						primaryStreamFactory);
 
+			final CloseableRegistry snapshotCloseableRegistry = new CloseableRegistry();
+
 			final RocksDBFullSnapshotOperation<K> snapshotOperation =
 				new RocksDBFullSnapshotOperation<>(
 					RocksDBKeyedStateBackend.this,
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/AbstractStreamOperator.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/AbstractStreamOperator.java
index 4d3f9f57fc7..e447cbeec05 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/AbstractStreamOperator.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/AbstractStreamOperator.java
@@ -248,8 +248,8 @@ public abstract class AbstractStreamOperator<OUT>
 				context.isRestored(), // information whether we restore or start for the first time
 				operatorStateBackend, // access to operator state backend
 				keyedStateStore, // access to keyed state backend
-				keyedStateInputs, // access to operator state stream
-				operatorStateInputs); // access to keyed state stream
+				keyedStateInputs, // access to keyed state stream
+				operatorStateInputs); // access to operator state stream
 
 			initializeState(initializationContext);
 		} finally {
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/StreamTaskStateInitializerImpl.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/StreamTaskStateInitializerImpl.java
index 7e915544e4c..d9bd089b1bc 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/StreamTaskStateInitializerImpl.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/StreamTaskStateInitializerImpl.java
@@ -166,11 +166,12 @@ public class StreamTaskStateInitializerImpl implements StreamTaskStateInitialize
 
 			// cleanup if something went wrong before results got published.
 			if (streamTaskCloseableRegistry.unregisterCloseable(keyedStatedBackend)) {
-				IOUtils.closeQuietly(keyedStatedBackend);
+				// release resource (e.g native resource)
+				keyedStatedBackend.dispose();
 			}
 
 			if (streamTaskCloseableRegistry.unregisterCloseable(operatorStateBackend)) {
-				IOUtils.closeQuietly(keyedStatedBackend);
+				operatorStateBackend.dispose();
 			}
 
 			if (streamTaskCloseableRegistry.unregisterCloseable(rawKeyedStateInputs)) {
@@ -181,10 +182,6 @@ public class StreamTaskStateInitializerImpl implements StreamTaskStateInitialize
 				IOUtils.closeQuietly(rawOperatorStateInputs);
 			}
 
-			if (streamTaskCloseableRegistry.unregisterCloseable(rawOperatorStateInputs)) {
-				IOUtils.closeQuietly(rawOperatorStateInputs);
-			}
-
 			throw new Exception("Exception while creating StreamOperatorStateContext.", ex);
 		}
 	}
