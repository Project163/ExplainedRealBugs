diff --git a/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/connector/kafka/source/enumerator/subscriber/KafkaSubscriberTest.java b/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/connector/kafka/source/enumerator/subscriber/KafkaSubscriberTest.java
index 76a12633932..3296a5758ee 100644
--- a/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/connector/kafka/source/enumerator/subscriber/KafkaSubscriberTest.java
+++ b/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/connector/kafka/source/enumerator/subscriber/KafkaSubscriberTest.java
@@ -83,7 +83,7 @@ public class KafkaSubscriberTest {
 				subscriber.getPartitionChanges(adminClient, currentAssignment);
 
 		Set<TopicPartition> expectedNewPartitions = new HashSet<>();
-		for (int i = 0; i < KafkaSourceTestEnv.NUM_RECORDS_PER_PARTITION; i++) {
+		for (int i = 0; i < KafkaSourceTestEnv.NUM_PARTITIONS; i++) {
 			if (i != assignedPartition2.partition()) {
 				expectedNewPartitions.add(new TopicPartition(TOPIC2, i));
 			}
diff --git a/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/streaming/connectors/kafka/KafkaTestEnvironmentImpl.java b/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/streaming/connectors/kafka/KafkaTestEnvironmentImpl.java
index 40fefff74b4..eb1117cb1d8 100644
--- a/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/streaming/connectors/kafka/KafkaTestEnvironmentImpl.java
+++ b/flink-connectors/flink-connector-kafka/src/test/java/org/apache/flink/streaming/connectors/kafka/KafkaTestEnvironmentImpl.java
@@ -18,6 +18,7 @@
 package org.apache.flink.streaming.connectors.kafka;
 
 import org.apache.flink.api.common.serialization.SerializationSchema;
+import org.apache.flink.core.testutils.CommonTestUtils;
 import org.apache.flink.networking.NetworkFailuresProxy;
 import org.apache.flink.streaming.api.datastream.DataStream;
 import org.apache.flink.streaming.api.datastream.DataStreamSink;
@@ -186,6 +187,12 @@ public class KafkaTestEnvironmentImpl extends KafkaTestEnvironment {
 		try (AdminClient adminClient = AdminClient.create(getStandardProperties())) {
 			NewTopic topicObj = new NewTopic(topic, numberOfPartitions, (short) replicationFactor);
 			adminClient.createTopics(Collections.singleton(topicObj)).all().get();
+			for (KafkaServer kafkaServer : brokers) {
+				CommonTestUtils.waitUtil(
+					() -> kafkaServer.metadataCache().contains(topic),
+					Duration.ofSeconds(10),
+					"The topic metadata failed to propagate to Kafka broker.");
+			}
 		} catch (Exception e) {
 			e.printStackTrace();
 			fail("Create test topic : " + topic + " failed, " + e.getMessage());
