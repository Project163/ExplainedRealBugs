diff --git a/flink-clients/src/main/java/org/apache/flink/client/program/PackagedProgram.java b/flink-clients/src/main/java/org/apache/flink/client/program/PackagedProgram.java
index fbc818701ca..c25d94304f8 100644
--- a/flink-clients/src/main/java/org/apache/flink/client/program/PackagedProgram.java
+++ b/flink-clients/src/main/java/org/apache/flink/client/program/PackagedProgram.java
@@ -696,7 +696,9 @@ public class PackagedProgram {
 					for (int i = 0; i < containedJarFileEntries.size(); i++) {
 						final JarEntry entry = containedJarFileEntries.get(i);
 						String name = entry.getName();
-						name = name.replace(File.separatorChar, '_');
+						// '/' as in case of zip, jar
+						// java.util.zip.ZipEntry#isDirectory always looks only for '/' not for File.separator
+						name = name.replace('/', '_');
 
 						File tempFile;
 						try {
diff --git a/flink-clients/src/test/java/org/apache/flink/client/program/PackagedProgramTest.java b/flink-clients/src/test/java/org/apache/flink/client/program/PackagedProgramTest.java
index e137adae3d3..355e663774e 100644
--- a/flink-clients/src/test/java/org/apache/flink/client/program/PackagedProgramTest.java
+++ b/flink-clients/src/test/java/org/apache/flink/client/program/PackagedProgramTest.java
@@ -19,18 +19,29 @@
 package org.apache.flink.client.program;
 
 import org.apache.flink.client.cli.CliFrontendTestUtils;
+import org.apache.flink.configuration.ConfigConstants;
 
 import org.junit.Assert;
+import org.junit.Rule;
 import org.junit.Test;
+import org.junit.rules.TemporaryFolder;
 
 import java.io.File;
+import java.io.FileOutputStream;
 import java.io.PrintStream;
+import java.nio.file.Files;
+import java.util.List;
+import java.util.zip.ZipEntry;
+import java.util.zip.ZipOutputStream;
 
 /**
  * Tests for the {@link PackagedProgramTest}.
  */
 public class PackagedProgramTest {
 
+	@Rule
+	public final TemporaryFolder temporaryFolder = new TemporaryFolder();
+
 	@Test
 	public void testGetPreviewPlan() {
 		try {
@@ -56,6 +67,23 @@ public class PackagedProgramTest {
 		}
 	}
 
+	@Test
+	public void testExtractContainedLibraries() throws Exception {
+		String s = "testExtractContainedLibraries";
+		byte[] nestedJarContent = s.getBytes(ConfigConstants.DEFAULT_CHARSET);
+		File fakeJar = temporaryFolder.newFile("test.jar");
+		try (ZipOutputStream zos = new ZipOutputStream(new FileOutputStream(fakeJar))) {
+			ZipEntry entry = new ZipEntry("lib/internalTest.jar");
+			zos.putNextEntry(entry);
+			zos.write(nestedJarContent);
+			zos.closeEntry();
+		}
+
+		final List<File> files = PackagedProgram.extractContainedLibraries(fakeJar.toURI().toURL());
+		Assert.assertEquals(1, files.size());
+		Assert.assertArrayEquals(nestedJarContent, Files.readAllBytes(files.iterator().next().toPath()));
+	}
+
 	private static final class NullOutputStream extends java.io.OutputStream {
 		@Override
 		public void write(int b) {}
