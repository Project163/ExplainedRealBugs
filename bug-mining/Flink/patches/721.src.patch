diff --git a/flink-streaming-connectors/flink-connector-rabbitmq/src/main/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSource.java b/flink-streaming-connectors/flink-connector-rabbitmq/src/main/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSource.java
index 50149dc2a1f..e8e867eeb78 100644
--- a/flink-streaming-connectors/flink-connector-rabbitmq/src/main/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSource.java
+++ b/flink-streaming-connectors/flink-connector-rabbitmq/src/main/java/org/apache/flink/streaming/connectors/rabbitmq/RMQSource.java
@@ -18,17 +18,21 @@
 package org.apache.flink.streaming.connectors.rabbitmq;
 
 import java.io.IOException;
+import java.util.List;
 
+import org.apache.flink.api.common.typeinfo.TypeInformation;
+import org.apache.flink.api.java.typeutils.ResultTypeQueryable;
 import org.apache.flink.configuration.Configuration;
-import org.apache.flink.streaming.api.functions.source.ConnectorSource;
+import org.apache.flink.streaming.api.functions.source.MessageAcknowledingSourceBase;
 import org.apache.flink.streaming.util.serialization.DeserializationSchema;
 
+import com.esotericsoftware.minlog.Log;
 import com.rabbitmq.client.Channel;
 import com.rabbitmq.client.Connection;
 import com.rabbitmq.client.ConnectionFactory;
 import com.rabbitmq.client.QueueingConsumer;
 
-public class RMQSource<OUT> extends ConnectorSource<OUT> {
+public class RMQSource<OUT> extends MessageAcknowledingSourceBase<OUT, Long> implements ResultTypeQueryable<OUT>{
 	private static final long serialVersionUID = 1L;
 
 	private final String QUEUE_NAME;
@@ -41,10 +45,15 @@ public class RMQSource<OUT> extends ConnectorSource<OUT> {
 	private transient QueueingConsumer.Delivery delivery;
 
 	private transient volatile boolean running;
+	
+	protected DeserializationSchema<OUT> schema;
 
+	int count = 0;
+	
 	public RMQSource(String HOST_NAME, String QUEUE_NAME,
 			DeserializationSchema<OUT> deserializationSchema) {
-		super(deserializationSchema);
+		super(Long.class);
+		this.schema = deserializationSchema;
 		this.HOST_NAME = HOST_NAME;
 		this.QUEUE_NAME = QUEUE_NAME;
 	}
@@ -58,9 +67,9 @@ public class RMQSource<OUT> extends ConnectorSource<OUT> {
 		try {
 			connection = factory.newConnection();
 			channel = connection.createChannel();
-			channel.queueDeclare(QUEUE_NAME, false, false, false, null);
+			channel.queueDeclare(QUEUE_NAME, true, false, false, null);
 			consumer = new QueueingConsumer(channel);
-			channel.basicConsume(QUEUE_NAME, true, consumer);
+			channel.basicConsume(QUEUE_NAME, false, consumer);
 		} catch (IOException e) {
 			throw new RuntimeException("Cannot create RMQ connection with " + QUEUE_NAME + " at "
 					+ HOST_NAME, e);
@@ -69,6 +78,7 @@ public class RMQSource<OUT> extends ConnectorSource<OUT> {
 
 	@Override
 	public void open(Configuration config) throws Exception {
+		super.open(config);
 		initializeConnection();
 		running = true;
 	}
@@ -89,12 +99,16 @@ public class RMQSource<OUT> extends ConnectorSource<OUT> {
 		while (running) {
 			delivery = consumer.nextDelivery();
 
-			OUT result = schema.deserialize(delivery.getBody());
-			if (schema.isEndOfStream(result)) {
-				break;
+			synchronized (ctx.getCheckpointLock()) {
+				OUT result = schema.deserialize(delivery.getBody());
+				addId(ctx, delivery.getEnvelope().getDeliveryTag());
+				
+				if (schema.isEndOfStream(result)) {
+					break;
+				}
+				
+				ctx.collect(result);
 			}
-
-			ctx.collect(result);
 		}
 	}
 
@@ -102,4 +116,18 @@ public class RMQSource<OUT> extends ConnectorSource<OUT> {
 	public void cancel() {
 		running = false;
 	}
+
+	@Override
+	protected void acknowledgeIDs(List<Long> ids) {
+		try {
+			channel.basicAck(ids.get(ids.size() - 1), true);
+		} catch (IOException e) {
+			Log.error("Messages could not be acknowledged", e);
+		}
+	}
+
+	@Override
+	public TypeInformation<OUT> getProducedType() {
+		return schema.getProducedType();
+	}
 }
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/MessageAcknowledingSourceBase.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/MessageAcknowledingSourceBase.java
index 3ac63af71f1..1a24bd878ac 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/MessageAcknowledingSourceBase.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/MessageAcknowledingSourceBase.java
@@ -18,6 +18,11 @@
 
 package org.apache.flink.streaming.api.functions.source;
 
+import java.util.ArrayDeque;
+import java.util.ArrayList;
+import java.util.Iterator;
+import java.util.List;
+
 import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
@@ -27,11 +32,8 @@ import org.apache.flink.configuration.Configuration;
 import org.apache.flink.streaming.api.checkpoint.CheckpointNotifier;
 import org.apache.flink.streaming.api.checkpoint.Checkpointed;
 import org.apache.flink.runtime.state.SerializedCheckpointData;
-
-import java.util.ArrayDeque;
-import java.util.ArrayList;
-import java.util.Iterator;
-import java.util.List;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 /**
  * Abstract base class for data sources that receive elements from a message queue and
@@ -76,6 +78,8 @@ public abstract class MessageAcknowledingSourceBase<Type, Id> extends RichSource
 	
 	private static final long serialVersionUID = -8689291992192955579L;
 	
+	private static final Logger LOG = LoggerFactory.getLogger(MessageAcknowledingSourceBase.class);
+	
 	/** Serializer used to serialize the IDs for checkpoints */
 	private final TypeSerializer<Id> idSerializer;
 	
@@ -84,8 +88,7 @@ public abstract class MessageAcknowledingSourceBase<Type, Id> extends RichSource
 
 	/** The list with IDs from checkpoints that were triggered, but not yet completed or notified of completion */
 	private transient ArrayDeque<Tuple2<Long, List<Id>>> pendingCheckpoints;
-
-
+	
 	// ------------------------------------------------------------------------
 
 	/**
@@ -133,7 +136,7 @@ public abstract class MessageAcknowledingSourceBase<Type, Id> extends RichSource
 	 * Adds an ID to be stored with the current checkpoint.
 	 * @param id The ID to add.
 	 */
-	protected void addId(Id id) {
+	protected void addId(SourceContext<Type> ctx, Id id) {
 		idsForCurrentCheckpoint.add(id);
 	}
 
@@ -143,6 +146,11 @@ public abstract class MessageAcknowledingSourceBase<Type, Id> extends RichSource
 	
 	@Override
 	public SerializedCheckpointData[] snapshotState(long checkpointId, long checkpointTimestamp) throws Exception {
+		if (LOG.isDebugEnabled()) {
+			LOG.debug("Snapshotting state. Messages: {}, checkpoint id: {}, timestamp: {}",
+					idsForCurrentCheckpoint, checkpointId, checkpointTimestamp);
+		}
+		
 		pendingCheckpoints.addLast(new Tuple2<Long, List<Id>>(checkpointId, idsForCurrentCheckpoint));
 		idsForCurrentCheckpoint = new ArrayList<>(64);
 		
@@ -155,12 +163,20 @@ public abstract class MessageAcknowledingSourceBase<Type, Id> extends RichSource
 	}
 
 	@Override
-	public void notifyCheckpointComplete(long checkpointId) throws Exception {
+	public void notifyCheckpointComplete(long checkpointId) throws Exception {	
+		// only one commit operation must be in progress
+		if (LOG.isDebugEnabled()) {
+			LOG.debug("Committing Messages externally for checkpoint {}", checkpointId);
+		}
+		
 		for (Iterator<Tuple2<Long, List<Id>>> iter = pendingCheckpoints.iterator(); iter.hasNext();) {
 			Tuple2<Long, List<Id>> checkpoint = iter.next();
 			long id = checkpoint.f0;
 			
 			if (id <= checkpointId) {
+				if (LOG.isTraceEnabled()) {
+					LOG.trace("Committing Messages with following IDs {}", checkpoint.f1);
+				}
 				acknowledgeIDs(checkpoint.f1);
 				iter.remove();
 			}
