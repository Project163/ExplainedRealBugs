diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/SchedulerBenchmarkBase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/SchedulerBenchmarkBase.java
new file mode 100644
index 00000000000..192b205a86c
--- /dev/null
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/SchedulerBenchmarkBase.java
@@ -0,0 +1,38 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License
+ */
+
+package org.apache.flink.runtime.scheduler.benchmark;
+
+import org.apache.flink.runtime.testutils.TestingUtils;
+
+import java.util.concurrent.ScheduledExecutorService;
+
+/** Base class of all scheduler benchmarks. */
+public class SchedulerBenchmarkBase {
+    public ScheduledExecutorService scheduledExecutorService;
+
+    public void setup() {
+        scheduledExecutorService = TestingUtils.defaultExecutor();
+    }
+
+    public void teardown() {
+        if (scheduledExecutorService != null) {
+            scheduledExecutorService.shutdownNow();
+        }
+    }
+}
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/SchedulerBenchmarkUtils.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/SchedulerBenchmarkUtils.java
index 2a3c1f6212c..4cd4084e4bb 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/SchedulerBenchmarkUtils.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/SchedulerBenchmarkUtils.java
@@ -39,13 +39,14 @@ import org.apache.flink.runtime.scheduler.DefaultScheduler;
 import org.apache.flink.runtime.scheduler.SchedulerTestingUtils;
 import org.apache.flink.runtime.taskmanager.TaskExecutionState;
 import org.apache.flink.runtime.testtasks.NoOpInvokable;
-import org.apache.flink.runtime.testutils.TestingUtils;
+import org.apache.flink.util.concurrent.ScheduledExecutorServiceAdapter;
 
 import java.io.IOException;
 import java.util.ArrayList;
 import java.util.Collections;
 import java.util.List;
 import java.util.concurrent.ExecutionException;
+import java.util.concurrent.ScheduledExecutorService;
 
 /** Utilities for scheduler benchmarks. */
 public class SchedulerBenchmarkUtils {
@@ -92,7 +93,10 @@ public class SchedulerBenchmarkUtils {
     }
 
     public static ExecutionGraph createAndInitExecutionGraph(
-            List<JobVertex> jobVertices, JobConfiguration jobConfiguration) throws Exception {
+            List<JobVertex> jobVertices,
+            JobConfiguration jobConfiguration,
+            ScheduledExecutorService scheduledExecutorService)
+            throws Exception {
 
         final JobGraph jobGraph = createJobGraph(jobVertices, jobConfiguration);
 
@@ -100,7 +104,12 @@ public class SchedulerBenchmarkUtils {
                 ComponentMainThreadExecutorServiceAdapter.forMainThread();
 
         final DefaultScheduler scheduler =
-                SchedulerTestingUtils.createScheduler(jobGraph, mainThreadExecutor);
+                SchedulerTestingUtils.createSchedulerBuilder(jobGraph, mainThreadExecutor)
+                        .setIoExecutor(scheduledExecutorService)
+                        .setFutureExecutor(scheduledExecutorService)
+                        .setDelayExecutor(
+                                new ScheduledExecutorServiceAdapter(scheduledExecutorService))
+                        .build();
 
         return scheduler.getExecutionGraph();
     }
@@ -163,8 +172,4 @@ public class SchedulerBenchmarkUtils {
                 vertex.getTaskVertices()[subtask].getCurrentExecutionAttempt().getAttemptId();
         scheduler.updateTaskExecutionState(new TaskExecutionState(attemptId, executionState));
     }
-
-    public static void shutdownTestingUtilDefaultExecutor() {
-        TestingUtils.defaultExecutor().shutdownNow();
-    }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingDownstreamTasksInBatchJobBenchmark.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingDownstreamTasksInBatchJobBenchmark.java
index d078eabb3ea..9d88b3b2d8d 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingDownstreamTasksInBatchJobBenchmark.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingDownstreamTasksInBatchJobBenchmark.java
@@ -31,8 +31,9 @@ public class DeployingDownstreamTasksInBatchJobBenchmark extends DeployingTasksB
 
     private ExecutionVertex[] vertices;
 
+    @Override
     public void setup(JobConfiguration jobConfiguration) throws Exception {
-        createAndSetupExecutionGraph(jobConfiguration);
+        super.setup(jobConfiguration);
 
         final JobVertex source = jobVertices.get(0);
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingDownstreamTasksInBatchJobBenchmarkTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingDownstreamTasksInBatchJobBenchmarkTest.java
index 27b605a067a..36dfc3b0b49 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingDownstreamTasksInBatchJobBenchmarkTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingDownstreamTasksInBatchJobBenchmarkTest.java
@@ -36,5 +36,6 @@ public class DeployingDownstreamTasksInBatchJobBenchmarkTest extends TestLogger
                 new DeployingDownstreamTasksInBatchJobBenchmark();
         benchmark.setup(JobConfiguration.BATCH_TEST);
         benchmark.deployDownstreamTasks();
+        benchmark.teardown();
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksBenchmarkBase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksBenchmarkBase.java
index 4498255a3db..b5aed705d68 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksBenchmarkBase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksBenchmarkBase.java
@@ -26,6 +26,7 @@ import org.apache.flink.runtime.jobgraph.JobVertex;
 import org.apache.flink.runtime.jobmaster.LogicalSlot;
 import org.apache.flink.runtime.jobmaster.TestingLogicalSlotBuilder;
 import org.apache.flink.runtime.scheduler.benchmark.JobConfiguration;
+import org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkBase;
 
 import java.util.List;
 
@@ -33,16 +34,19 @@ import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUti
 import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUtils.createDefaultJobVertices;
 
 /** The base class of benchmarks related to deploying tasks. */
-public class DeployingTasksBenchmarkBase {
+public class DeployingTasksBenchmarkBase extends SchedulerBenchmarkBase {
 
     List<JobVertex> jobVertices;
     ExecutionGraph executionGraph;
 
-    public void createAndSetupExecutionGraph(JobConfiguration jobConfiguration) throws Exception {
+    public void setup(JobConfiguration jobConfiguration) throws Exception {
+        super.setup();
 
         jobVertices = createDefaultJobVertices(jobConfiguration);
 
-        executionGraph = createAndInitExecutionGraph(jobVertices, jobConfiguration);
+        executionGraph =
+                createAndInitExecutionGraph(
+                        jobVertices, jobConfiguration, scheduledExecutorService);
 
         final TestingLogicalSlotBuilder slotBuilder = new TestingLogicalSlotBuilder();
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksInStreamingJobBenchmark.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksInStreamingJobBenchmark.java
index 8c16158ff91..78268d6bb01 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksInStreamingJobBenchmark.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksInStreamingJobBenchmark.java
@@ -29,8 +29,9 @@ import org.apache.flink.runtime.scheduler.benchmark.JobConfiguration;
  */
 public class DeployingTasksInStreamingJobBenchmark extends DeployingTasksBenchmarkBase {
 
+    @Override
     public void setup(JobConfiguration jobConfiguration) throws Exception {
-        createAndSetupExecutionGraph(jobConfiguration);
+        super.setup(jobConfiguration);
     }
 
     public void deployAllTasks() throws Exception {
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksInStreamingJobBenchmarkTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksInStreamingJobBenchmarkTest.java
index 88bc0c8afc0..cf00652e1fd 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksInStreamingJobBenchmarkTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/deploying/DeployingTasksInStreamingJobBenchmarkTest.java
@@ -36,5 +36,6 @@ public class DeployingTasksInStreamingJobBenchmarkTest extends TestLogger {
                 new DeployingTasksInStreamingJobBenchmark();
         benchmark.setup(JobConfiguration.STREAMING_TEST);
         benchmark.deployAllTasks();
+        benchmark.teardown();
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/CreateSchedulerBenchmark.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/CreateSchedulerBenchmark.java
index e3f72ad30ce..c91d37d59cd 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/CreateSchedulerBenchmark.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/CreateSchedulerBenchmark.java
@@ -21,9 +21,10 @@ package org.apache.flink.runtime.scheduler.benchmark.e2e;
 import org.apache.flink.runtime.scheduler.DefaultScheduler;
 
 /** The benchmark of creating the scheduler in a STREAMING/BATCH job. */
-public class CreateSchedulerBenchmark extends SchedulerBenchmarkBase {
+public class CreateSchedulerBenchmark extends SchedulerEndToEndBenchmarkBase {
 
     public DefaultScheduler createScheduler() throws Exception {
-        return createScheduler(jobGraph, physicalSlotProvider, mainThreadExecutor);
+        return createScheduler(
+                jobGraph, physicalSlotProvider, mainThreadExecutor, scheduledExecutorService);
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/SchedulerBenchmarkBase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/SchedulerEndToEndBenchmarkBase.java
similarity index 92%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/SchedulerBenchmarkBase.java
rename to flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/SchedulerEndToEndBenchmarkBase.java
index c088b199032..bf1472f66af 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/SchedulerBenchmarkBase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/SchedulerEndToEndBenchmarkBase.java
@@ -35,16 +35,17 @@ import org.apache.flink.runtime.jobmaster.slotpool.SlotPoolImpl;
 import org.apache.flink.runtime.scheduler.DefaultScheduler;
 import org.apache.flink.runtime.scheduler.SchedulerTestingUtils;
 import org.apache.flink.runtime.scheduler.benchmark.JobConfiguration;
+import org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkBase;
 import org.apache.flink.runtime.taskexecutor.TestingTaskExecutorGateway;
 import org.apache.flink.runtime.taskexecutor.TestingTaskExecutorGatewayBuilder;
 import org.apache.flink.runtime.taskexecutor.slot.SlotOffer;
 import org.apache.flink.runtime.taskmanager.LocalTaskManagerLocation;
 import org.apache.flink.runtime.taskmanager.TaskManagerLocation;
+import org.apache.flink.util.concurrent.ScheduledExecutorServiceAdapter;
 
 import java.util.Collection;
 import java.util.List;
 import java.util.concurrent.CompletableFuture;
-import java.util.concurrent.Executors;
 import java.util.concurrent.ScheduledExecutorService;
 import java.util.stream.Collectors;
 import java.util.stream.IntStream;
@@ -56,16 +57,16 @@ import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUti
  * The base class of benchmarks related to {@link DefaultScheduler}'s creation, scheduling and
  * deploying.
  */
-public class SchedulerBenchmarkBase {
+public class SchedulerEndToEndBenchmarkBase extends SchedulerBenchmarkBase {
 
-    ScheduledExecutorService scheduledExecutorService;
     ComponentMainThreadExecutor mainThreadExecutor;
 
     JobGraph jobGraph;
     PhysicalSlotProvider physicalSlotProvider;
 
     public void setup(JobConfiguration jobConfiguration) throws Exception {
-        scheduledExecutorService = Executors.newSingleThreadScheduledExecutor();
+        super.setup();
+
         mainThreadExecutor =
                 ComponentMainThreadExecutorServiceAdapter.forSingleThreadExecutor(
                         scheduledExecutorService);
@@ -78,12 +79,6 @@ public class SchedulerBenchmarkBase {
                         jobConfiguration, jobVertices.size(), mainThreadExecutor);
     }
 
-    public void teardown() throws Exception {
-        if (scheduledExecutorService != null) {
-            scheduledExecutorService.shutdownNow();
-        }
-    }
-
     private static PhysicalSlotProvider createPhysicalSlotProvider(
             JobConfiguration jobConfiguration,
             int numberOfJobVertices,
@@ -132,9 +127,13 @@ public class SchedulerBenchmarkBase {
     static DefaultScheduler createScheduler(
             JobGraph jobGraph,
             PhysicalSlotProvider physicalSlotProvider,
-            ComponentMainThreadExecutor mainThreadExecutor)
+            ComponentMainThreadExecutor mainThreadExecutor,
+            ScheduledExecutorService executorService)
             throws Exception {
         return SchedulerTestingUtils.newSchedulerBuilder(jobGraph, mainThreadExecutor)
+                .setFutureExecutor(executorService)
+                .setIoExecutor(executorService)
+                .setDelayExecutor(new ScheduledExecutorServiceAdapter(executorService))
                 .setExecutionSlotAllocatorFactory(
                         SchedulerTestingUtils.newSlotSharingExecutionSlotAllocatorFactory(
                                 physicalSlotProvider))
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/SchedulingAndDeployingBenchmark.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/SchedulingAndDeployingBenchmark.java
index 11745c34616..76d59a75a40 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/SchedulingAndDeployingBenchmark.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/e2e/SchedulingAndDeployingBenchmark.java
@@ -27,7 +27,7 @@ import java.util.concurrent.CompletableFuture;
  * The benchmark of scheduling and deploying tasks in a STREAMING/BATCH job. The related method is
  * {@link DefaultScheduler#startScheduling}.
  */
-public class SchedulingAndDeployingBenchmark extends SchedulerBenchmarkBase {
+public class SchedulingAndDeployingBenchmark extends SchedulerEndToEndBenchmarkBase {
 
     private DefaultScheduler scheduler;
 
@@ -36,7 +36,12 @@ public class SchedulingAndDeployingBenchmark extends SchedulerBenchmarkBase {
 
         super.setup(jobConfiguration);
 
-        scheduler = createScheduler(jobGraph, physicalSlotProvider, mainThreadExecutor);
+        scheduler =
+                createScheduler(
+                        jobGraph,
+                        physicalSlotProvider,
+                        mainThreadExecutor,
+                        scheduledExecutorService);
     }
 
     public void startScheduling() throws Exception {
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/FailoverBenchmarkBase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/FailoverBenchmarkBase.java
index 2de6d72f30d..5b062ab0e68 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/FailoverBenchmarkBase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/FailoverBenchmarkBase.java
@@ -22,6 +22,7 @@ import org.apache.flink.runtime.executiongraph.ExecutionGraph;
 import org.apache.flink.runtime.executiongraph.failover.flip1.RestartPipelinedRegionFailoverStrategy;
 import org.apache.flink.runtime.jobgraph.JobVertex;
 import org.apache.flink.runtime.scheduler.benchmark.JobConfiguration;
+import org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkBase;
 import org.apache.flink.runtime.scheduler.strategy.SchedulingTopology;
 
 import java.util.List;
@@ -30,7 +31,7 @@ import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUti
 import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUtils.createDefaultJobVertices;
 
 /** The base class of benchmarks related to failover. */
-public class FailoverBenchmarkBase {
+public class FailoverBenchmarkBase extends SchedulerBenchmarkBase {
 
     JobVertex source;
     List<JobVertex> jobVertices;
@@ -39,11 +40,14 @@ public class FailoverBenchmarkBase {
     SchedulingTopology schedulingTopology;
     RestartPipelinedRegionFailoverStrategy strategy;
 
-    public void createRestartPipelinedRegionFailoverStrategy(JobConfiguration jobConfiguration)
-            throws Exception {
+    public void setup(JobConfiguration jobConfiguration) throws Exception {
+        super.setup();
+
         jobVertices = createDefaultJobVertices(jobConfiguration);
         source = jobVertices.get(0);
-        executionGraph = createAndInitExecutionGraph(jobVertices, jobConfiguration);
+        executionGraph =
+                createAndInitExecutionGraph(
+                        jobVertices, jobConfiguration, scheduledExecutorService);
         schedulingTopology = executionGraph.getSchedulingTopology();
         strategy = new RestartPipelinedRegionFailoverStrategy(schedulingTopology);
     }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInBatchJobBenchmark.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInBatchJobBenchmark.java
index 0f98cf22bcf..879e7a3dac7 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInBatchJobBenchmark.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInBatchJobBenchmark.java
@@ -36,8 +36,9 @@ import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUti
  */
 public class RegionToRestartInBatchJobBenchmark extends FailoverBenchmarkBase {
 
+    @Override
     public void setup(JobConfiguration jobConfiguration) throws Exception {
-        createRestartPipelinedRegionFailoverStrategy(jobConfiguration);
+        super.setup(jobConfiguration);
 
         final JobVertex source = jobVertices.get(0);
         final JobVertex sink = jobVertices.get(1);
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInBatchJobBenchmarkTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInBatchJobBenchmarkTest.java
index a9c12dab966..de5f172d56e 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInBatchJobBenchmarkTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInBatchJobBenchmarkTest.java
@@ -35,5 +35,6 @@ public class RegionToRestartInBatchJobBenchmarkTest extends TestLogger {
         RegionToRestartInBatchJobBenchmark benchmark = new RegionToRestartInBatchJobBenchmark();
         benchmark.setup(JobConfiguration.BATCH_TEST);
         benchmark.calculateRegionToRestart();
+        benchmark.teardown();
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInStreamingJobBenchmark.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInStreamingJobBenchmark.java
index 08d3b9ef689..7f69e293208 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInStreamingJobBenchmark.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInStreamingJobBenchmark.java
@@ -34,8 +34,9 @@ import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUti
  */
 public class RegionToRestartInStreamingJobBenchmark extends FailoverBenchmarkBase {
 
+    @Override
     public void setup(JobConfiguration jobConfiguration) throws Exception {
-        createRestartPipelinedRegionFailoverStrategy(jobConfiguration);
+        super.setup(jobConfiguration);
 
         TestingLogicalSlotBuilder slotBuilder = new TestingLogicalSlotBuilder();
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInStreamingJobBenchmarkTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInStreamingJobBenchmarkTest.java
index a7b3e49a02b..85d24e5ca5f 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInStreamingJobBenchmarkTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/failover/RegionToRestartInStreamingJobBenchmarkTest.java
@@ -36,5 +36,6 @@ public class RegionToRestartInStreamingJobBenchmarkTest extends TestLogger {
                 new RegionToRestartInStreamingJobBenchmark();
         benchmark.setup(JobConfiguration.STREAMING_TEST);
         benchmark.calculateRegionToRestart();
+        benchmark.teardown();
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/partitionrelease/PartitionReleaseInBatchJobBenchmark.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/partitionrelease/PartitionReleaseInBatchJobBenchmark.java
index 0c9c70ffc76..e093a2c2de5 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/partitionrelease/PartitionReleaseInBatchJobBenchmark.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/partitionrelease/PartitionReleaseInBatchJobBenchmark.java
@@ -24,6 +24,7 @@ import org.apache.flink.runtime.executiongraph.failover.flip1.partitionrelease.R
 import org.apache.flink.runtime.jobgraph.JobVertex;
 import org.apache.flink.runtime.jobmaster.TestingLogicalSlotBuilder;
 import org.apache.flink.runtime.scheduler.benchmark.JobConfiguration;
+import org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkBase;
 
 import java.util.List;
 
@@ -36,15 +37,19 @@ import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUti
  * The benchmark of releasing partitions in a BATCH job. The related method is {@link
  * RegionPartitionReleaseStrategy#vertexFinished}.
  */
-public class PartitionReleaseInBatchJobBenchmark {
+public class PartitionReleaseInBatchJobBenchmark extends SchedulerBenchmarkBase {
 
     private ExecutionGraph executionGraph;
     private JobVertex sink;
 
     public void setup(JobConfiguration jobConfiguration) throws Exception {
+        super.setup();
+
         final List<JobVertex> jobVertices = createDefaultJobVertices(jobConfiguration);
 
-        executionGraph = createAndInitExecutionGraph(jobVertices, jobConfiguration);
+        executionGraph =
+                createAndInitExecutionGraph(
+                        jobVertices, jobConfiguration, scheduledExecutorService);
 
         final JobVertex source = jobVertices.get(0);
         sink = jobVertices.get(1);
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/partitionrelease/PartitionReleaseInBatchJobBenchmarkTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/partitionrelease/PartitionReleaseInBatchJobBenchmarkTest.java
index cee29e2cffc..fbbc6e9ad66 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/partitionrelease/PartitionReleaseInBatchJobBenchmarkTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/partitionrelease/PartitionReleaseInBatchJobBenchmarkTest.java
@@ -35,5 +35,6 @@ public class PartitionReleaseInBatchJobBenchmarkTest extends TestLogger {
         PartitionReleaseInBatchJobBenchmark benchmark = new PartitionReleaseInBatchJobBenchmark();
         benchmark.setup(JobConfiguration.BATCH_TEST);
         benchmark.partitionRelease();
+        benchmark.teardown();
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/InitSchedulingStrategyBenchmark.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/InitSchedulingStrategyBenchmark.java
index 34158d0c870..de6cb9e3ee2 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/InitSchedulingStrategyBenchmark.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/InitSchedulingStrategyBenchmark.java
@@ -28,8 +28,9 @@ public class InitSchedulingStrategyBenchmark extends SchedulingBenchmarkBase {
 
     public InitSchedulingStrategyBenchmark() {}
 
+    @Override
     public void setup(JobConfiguration jobConfiguration) throws Exception {
-        initSchedulingTopology(jobConfiguration);
+        super.setup(jobConfiguration);
     }
 
     public PipelinedRegionSchedulingStrategy initSchedulingStrategy() {
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/InitSchedulingStrategyBenchmarkTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/InitSchedulingStrategyBenchmarkTest.java
index 1b9aaced097..3530477a4ad 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/InitSchedulingStrategyBenchmarkTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/InitSchedulingStrategyBenchmarkTest.java
@@ -34,6 +34,7 @@ public class InitSchedulingStrategyBenchmarkTest extends TestLogger {
         InitSchedulingStrategyBenchmark benchmark = new InitSchedulingStrategyBenchmark();
         benchmark.setup(JobConfiguration.STREAMING_TEST);
         benchmark.initSchedulingStrategy();
+        benchmark.teardown();
     }
 
     @Test
@@ -41,5 +42,6 @@ public class InitSchedulingStrategyBenchmarkTest extends TestLogger {
         InitSchedulingStrategyBenchmark benchmark = new InitSchedulingStrategyBenchmark();
         benchmark.setup(JobConfiguration.BATCH_TEST);
         benchmark.initSchedulingStrategy();
+        benchmark.teardown();
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingBenchmarkBase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingBenchmarkBase.java
index 3a8cd08f94a..75251ba8b22 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingBenchmarkBase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingBenchmarkBase.java
@@ -21,6 +21,7 @@ package org.apache.flink.runtime.scheduler.benchmark.scheduling;
 import org.apache.flink.runtime.executiongraph.ExecutionGraph;
 import org.apache.flink.runtime.jobgraph.JobVertex;
 import org.apache.flink.runtime.scheduler.benchmark.JobConfiguration;
+import org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkBase;
 import org.apache.flink.runtime.scheduler.strategy.SchedulingTopology;
 import org.apache.flink.runtime.scheduler.strategy.TestingSchedulerOperations;
 
@@ -30,17 +31,21 @@ import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUti
 import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUtils.createDefaultJobVertices;
 
 /** The base class of benchmarks related to scheduling tasks. */
-public class SchedulingBenchmarkBase {
+public class SchedulingBenchmarkBase extends SchedulerBenchmarkBase {
 
     TestingSchedulerOperations schedulerOperations;
     List<JobVertex> jobVertices;
     ExecutionGraph executionGraph;
     SchedulingTopology schedulingTopology;
 
-    public void initSchedulingTopology(JobConfiguration jobConfiguration) throws Exception {
+    public void setup(JobConfiguration jobConfiguration) throws Exception {
+        super.setup();
+
         schedulerOperations = new TestingSchedulerOperations();
         jobVertices = createDefaultJobVertices(jobConfiguration);
-        executionGraph = createAndInitExecutionGraph(jobVertices, jobConfiguration);
+        executionGraph =
+                createAndInitExecutionGraph(
+                        jobVertices, jobConfiguration, scheduledExecutorService);
         schedulingTopology = executionGraph.getSchedulingTopology();
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingDownstreamTasksInBatchJobBenchmark.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingDownstreamTasksInBatchJobBenchmark.java
index 04e0fe8623a..60eda9998fc 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingDownstreamTasksInBatchJobBenchmark.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingDownstreamTasksInBatchJobBenchmark.java
@@ -36,8 +36,9 @@ public class SchedulingDownstreamTasksInBatchJobBenchmark extends SchedulingBenc
     private ExecutionVertexID executionVertexID;
     private PipelinedRegionSchedulingStrategy schedulingStrategy;
 
+    @Override
     public void setup(JobConfiguration jobConfiguration) throws Exception {
-        initSchedulingTopology(jobConfiguration);
+        super.setup(jobConfiguration);
 
         schedulingStrategy =
                 new PipelinedRegionSchedulingStrategy(schedulerOperations, schedulingTopology);
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingDownstreamTasksInBatchJobBenchmarkTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingDownstreamTasksInBatchJobBenchmarkTest.java
index 277fbe5e61d..8c0b919e760 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingDownstreamTasksInBatchJobBenchmarkTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/scheduling/SchedulingDownstreamTasksInBatchJobBenchmarkTest.java
@@ -36,5 +36,6 @@ public class SchedulingDownstreamTasksInBatchJobBenchmarkTest extends TestLogger
                 new SchedulingDownstreamTasksInBatchJobBenchmark();
         benchmark.setup(JobConfiguration.BATCH_TEST);
         benchmark.schedulingDownstreamTasks();
+        benchmark.teardown();
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/topology/BuildExecutionGraphBenchmark.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/topology/BuildExecutionGraphBenchmark.java
index 92419c1dc6a..4618ac5f388 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/topology/BuildExecutionGraphBenchmark.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/topology/BuildExecutionGraphBenchmark.java
@@ -25,6 +25,7 @@ import org.apache.flink.runtime.jobgraph.JobVertex;
 import org.apache.flink.runtime.scheduler.SchedulerBase;
 import org.apache.flink.runtime.scheduler.VertexParallelismStore;
 import org.apache.flink.runtime.scheduler.benchmark.JobConfiguration;
+import org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkBase;
 
 import java.util.List;
 
@@ -35,7 +36,7 @@ import static org.apache.flink.runtime.scheduler.benchmark.SchedulerBenchmarkUti
  * The benchmark of building the topology of {@link ExecutionGraph} in a STREAMING/BATCH job. The
  * related method is {@link ExecutionGraph#attachJobGraph},
  */
-public class BuildExecutionGraphBenchmark {
+public class BuildExecutionGraphBenchmark extends SchedulerBenchmarkBase {
 
     private List<JobVertex> jobVertices;
     private ExecutionGraph executionGraph;
@@ -43,6 +44,8 @@ public class BuildExecutionGraphBenchmark {
     public BuildExecutionGraphBenchmark() {}
 
     public void setup(JobConfiguration jobConfiguration) throws Exception {
+        super.setup();
+
         jobVertices = createDefaultJobVertices(jobConfiguration);
         final JobGraph jobGraph = createJobGraph(jobConfiguration);
         final VertexParallelismStore parallelismStore =
@@ -51,6 +54,8 @@ public class BuildExecutionGraphBenchmark {
                 TestingDefaultExecutionGraphBuilder.newBuilder()
                         .setVertexParallelismStore(parallelismStore)
                         .setJobGraph(jobGraph)
+                        .setFutureExecutor(scheduledExecutorService)
+                        .setIoExecutor(scheduledExecutorService)
                         .build();
     }
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/topology/BuildExecutionGraphBenchmarkTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/topology/BuildExecutionGraphBenchmarkTest.java
index 91fa252280b..0acccd099fd 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/topology/BuildExecutionGraphBenchmarkTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/scheduler/benchmark/topology/BuildExecutionGraphBenchmarkTest.java
@@ -35,6 +35,7 @@ public class BuildExecutionGraphBenchmarkTest extends TestLogger {
         BuildExecutionGraphBenchmark benchmark = new BuildExecutionGraphBenchmark();
         benchmark.setup(JobConfiguration.STREAMING_TEST);
         benchmark.buildTopology();
+        benchmark.teardown();
     }
 
     @Test
@@ -42,5 +43,6 @@ public class BuildExecutionGraphBenchmarkTest extends TestLogger {
         BuildExecutionGraphBenchmark benchmark = new BuildExecutionGraphBenchmark();
         benchmark.setup(JobConfiguration.BATCH_TEST);
         benchmark.buildTopology();
+        benchmark.teardown();
     }
 }
