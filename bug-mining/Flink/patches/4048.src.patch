diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamEdge.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamEdge.java
index 05a641a7f55..2ee4a7ca560 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamEdge.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamEdge.java
@@ -24,6 +24,7 @@ import org.apache.flink.util.OutputTag;
 
 import java.io.Serializable;
 import java.util.List;
+import java.util.Objects;
 
 import static org.apache.flink.util.Preconditions.checkNotNull;
 
@@ -137,7 +138,7 @@ public class StreamEdge implements Serializable {
 
 	@Override
 	public int hashCode() {
-		return edgeId.hashCode();
+		return Objects.hash(edgeId, outputTag);
 	}
 
 	@Override
@@ -150,8 +151,8 @@ public class StreamEdge implements Serializable {
 		}
 
 		StreamEdge that = (StreamEdge) o;
-
-		return edgeId.equals(that.edgeId);
+		return Objects.equals(edgeId, that.edgeId) &&
+			Objects.equals(outputTag, that.outputTag);
 	}
 
 	@Override
diff --git a/flink-streaming-scala/src/test/scala/org/apache/flink/streaming/api/scala/SideOutputITCase.scala b/flink-streaming-scala/src/test/scala/org/apache/flink/streaming/api/scala/SideOutputITCase.scala
index e8449289248..ef77937977c 100644
--- a/flink-streaming-scala/src/test/scala/org/apache/flink/streaming/api/scala/SideOutputITCase.scala
+++ b/flink-streaming-scala/src/test/scala/org/apache/flink/streaming/api/scala/SideOutputITCase.scala
@@ -325,6 +325,94 @@ class SideOutputITCase extends AbstractTestBase {
     assertEquals(util.Arrays.asList("sideout-1", "sideout-2", "sideout-5"),
       sideOutputResultSink.getResult)
   }
+
+  /**
+   * Test the union of two side outputs.
+   */
+  @Test
+  def testUnionOfTwoSideOutputs() {
+    val evensResultSink = new TestListResultSink[Int]
+    val oddsResultSink = new TestListResultSink[Int]
+    val oddsUEvensResultSink = new TestListResultSink[Int]
+    val evensUOddsResultSink = new TestListResultSink[Int]
+    val oddsUOddsResultSink = new TestListResultSink[Int]
+    val evensUEvensResultSink = new TestListResultSink[Int]
+    val oddsUEvensExternalResultSink = new TestListResultSink[Int]
+
+    val resultSink = new TestListResultSink[Int]
+
+    val env = StreamExecutionEnvironment.getExecutionEnvironment
+    env.setParallelism(3)
+
+    val input = env.fromElements(1, 2, 3, 4)
+
+    val oddTag = OutputTag[Int]("odds")
+    val evenTag = OutputTag[Int]("even")
+
+    val passThroughStream =
+      input.process(new ProcessFunction[Int, Int] {
+        override def processElement(value: Int,
+                                    ctx: ProcessFunction[Int, Int]#Context,
+                                    out: Collector[Int]): Unit = {
+          if (value % 2 != 0) {
+            ctx.output(oddTag, value)
+          } else {
+            ctx.output(evenTag, value)
+          }
+          out.collect(value)
+        }
+      })
+
+    val evens = passThroughStream.getSideOutput(evenTag)
+    val odds = passThroughStream.getSideOutput(oddTag)
+
+    evens.addSink(evensResultSink)
+    odds.addSink(oddsResultSink)
+    passThroughStream.addSink(resultSink)
+
+    odds.union(evens).addSink(oddsUEvensResultSink)
+    evens.union(odds).addSink(evensUOddsResultSink)
+
+    odds.union(odds).addSink(oddsUOddsResultSink)
+    evens.union(evens).addSink(evensUEvensResultSink)
+
+    odds.union(env.fromElements(2, 4)).addSink(oddsUEvensExternalResultSink)
+
+    env.execute()
+
+    assertEquals(
+      util.Arrays.asList(1, 3),
+      oddsResultSink.getSortedResult)
+
+    assertEquals(
+      util.Arrays.asList(2, 4),
+      evensResultSink.getSortedResult)
+
+    assertEquals(
+      util.Arrays.asList(1, 2, 3, 4),
+      resultSink.getSortedResult)
+
+    assertEquals(
+      util.Arrays.asList(1, 2, 3, 4),
+      oddsUEvensResultSink.getSortedResult)
+
+    assertEquals(
+      util.Arrays.asList(1, 2, 3, 4),
+      evensUOddsResultSink.getSortedResult)
+
+    assertEquals(
+      util.Arrays.asList(1, 1, 3, 3),
+      oddsUOddsResultSink.getSortedResult)
+
+    assertEquals(
+      util.Arrays.asList(2, 2, 4, 4),
+      evensUEvensResultSink.getSortedResult)
+
+    assertEquals(
+      util.Arrays.asList(1, 2, 3, 4),
+      oddsUEvensExternalResultSink.getSortedResult)
+  }
+
 }
 
 class TestAssigner extends AssignerWithPunctuatedWatermarks[(String, Int)] {
diff --git a/flink-tests/src/test/java/org/apache/flink/test/streaming/runtime/SideOutputITCase.java b/flink-tests/src/test/java/org/apache/flink/test/streaming/runtime/SideOutputITCase.java
index 13876ed4f39..60e0b242685 100644
--- a/flink-tests/src/test/java/org/apache/flink/test/streaming/runtime/SideOutputITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/test/streaming/runtime/SideOutputITCase.java
@@ -903,4 +903,87 @@ public class SideOutputITCase extends AbstractTestBase implements Serializable {
 		assertEquals(Arrays.asList("sideout-1", "sideout-2", "sideout-5"), sideOutputResultSink.getSortedResult());
 		assertEquals(Arrays.asList(1, 2, 5), resultSink.getSortedResult());
 	}
+
+	@Test
+	public void testUnionOfTwoSideOutputs() throws Exception {
+		TestListResultSink<Integer> evensResultSink = new TestListResultSink<>();
+		TestListResultSink<Integer> oddsResultSink = new TestListResultSink<>();
+		TestListResultSink<Integer> oddsUEvensResultSink = new TestListResultSink<>();
+		TestListResultSink<Integer> evensUOddsResultSink = new TestListResultSink<>();
+		TestListResultSink<Integer> oddsUOddsResultSink = new TestListResultSink<>();
+		TestListResultSink<Integer> evensUEvensResultSink = new TestListResultSink<>();
+		TestListResultSink<Integer> oddsUEvensExternalResultSink = new TestListResultSink<>();
+		TestListResultSink<Integer> resultSink = new TestListResultSink<>();
+
+		StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();
+		env.setParallelism(3);
+
+		DataStream<Integer> input = env.fromElements(1, 2, 3, 4);
+
+		OutputTag<Integer> oddTag = new OutputTag<Integer>("odds"){};
+		OutputTag<Integer> evenTag = new OutputTag<Integer>("even"){};
+
+		SingleOutputStreamOperator<Integer> passThroughStream =
+			input.process(new ProcessFunction<Integer, Integer>() {
+				@Override
+				public void processElement(Integer value, Context ctx, Collector<Integer> out) throws Exception {
+					if (value % 2 != 0) {
+						ctx.output(oddTag, value);
+					}
+					else {
+						ctx.output(evenTag, value);
+					}
+					out.collect(value);
+				}
+			});
+
+		DataStream<Integer> evens = passThroughStream.getSideOutput(evenTag);
+		DataStream<Integer> odds = passThroughStream.getSideOutput(oddTag);
+
+		evens.addSink(evensResultSink);
+		odds.addSink(oddsResultSink);
+		passThroughStream.addSink(resultSink);
+
+		odds.union(evens).addSink(oddsUEvensResultSink);
+		evens.union(odds).addSink(evensUOddsResultSink);
+
+		odds.union(odds).addSink(oddsUOddsResultSink);
+		evens.union(evens).addSink(evensUEvensResultSink);
+
+		odds.union(env.fromElements(2, 4)).addSink(oddsUEvensExternalResultSink);
+
+		env.execute();
+
+		assertEquals(
+			Arrays.asList(1, 3),
+			oddsResultSink.getSortedResult());
+
+		assertEquals(
+			Arrays.asList(2, 4),
+			evensResultSink.getSortedResult());
+
+		assertEquals(
+			Arrays.asList(1, 2, 3, 4),
+			resultSink.getSortedResult());
+
+		assertEquals(
+			Arrays.asList(1, 2, 3, 4),
+			oddsUEvensResultSink.getSortedResult());
+
+		assertEquals(
+			Arrays.asList(1, 2, 3, 4),
+			evensUOddsResultSink.getSortedResult());
+
+		assertEquals(
+			Arrays.asList(1, 1, 3, 3),
+			oddsUOddsResultSink.getSortedResult());
+
+		assertEquals(
+			Arrays.asList(2, 2, 4, 4),
+			evensUEvensResultSink.getSortedResult());
+
+		assertEquals(
+			Arrays.asList(1, 2, 3, 4),
+			oddsUEvensExternalResultSink.getSortedResult());
+	}
 }
