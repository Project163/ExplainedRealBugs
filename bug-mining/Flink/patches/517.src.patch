diff --git a/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/api/windowing/deltafunction/CosineDistance.java b/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/api/windowing/deltafunction/CosineDistance.java
index 15aaf51fe3e..77486d09a3e 100644
--- a/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/api/windowing/deltafunction/CosineDistance.java
+++ b/flink-staging/flink-streaming/flink-streaming-core/src/main/java/org/apache/flink/streaming/api/windowing/deltafunction/CosineDistance.java
@@ -52,6 +52,11 @@ public class CosineDistance<DATA> extends ExtractionAwareDeltaFunction<DATA, dou
 			return 0;
 		}
 
+		if (oldDataPoint.length != newDataPoint.length) {
+			throw new IllegalArgumentException(
+					"The size of two input arrays are not same, can not compute cosine distance");
+		}
+
 		double sum1 = 0;
 		double sum2 = 0;
 		for (int i = 0; i < oldDataPoint.length; i++) {
