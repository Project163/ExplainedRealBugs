diff --git a/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogKeyedStateBackend.java b/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogKeyedStateBackend.java
index c593b114e7a..1012d37619e 100644
--- a/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogKeyedStateBackend.java
+++ b/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogKeyedStateBackend.java
@@ -92,7 +92,6 @@ import static java.util.Collections.singletonList;
 import static java.util.Collections.unmodifiableList;
 import static org.apache.flink.state.changelog.PeriodicMaterializationManager.MaterializationRunnable;
 import static org.apache.flink.util.Preconditions.checkNotNull;
-import static org.apache.flink.util.Preconditions.checkState;
 
 /**
  * A {@link KeyedStateBackend} that keeps state on the underlying delegated keyed state backend as
@@ -144,9 +143,7 @@ public class ChangelogKeyedStateBackend<K>
     private final Map<String, InternalKvState<K, ?, ?>> keyValueStatesByName;
 
     /**
-     * Unwrapped changelog states used for recovery (not wrapped into e.g. TTL).
-     *
-     * <p>WARN: cleared upon recovery completion.
+     * Unwrapped changelog states used for recovery (not wrapped into e.g. TTL, latency tracking).
      */
     private final Map<String, ChangelogState> changelogStates;
 
@@ -266,6 +263,8 @@ public class ChangelogKeyedStateBackend<K>
         lastName = null;
         lastState = null;
         keyValueStatesByName.clear();
+        changelogStates.clear();
+        priorityQueueStatesByName.clear();
     }
 
     @Override
@@ -559,7 +558,6 @@ public class ChangelogKeyedStateBackend<K>
             }
         }
 
-        changelogStates.clear();
         return new ChangelogSnapshotState(
                 materialized,
                 restoredNonMaterialized,
@@ -604,9 +602,8 @@ public class ChangelogKeyedStateBackend<K>
                             upTo);
 
             // log metadata after materialization is triggered
-            for (InternalKvState<K, ?, ?> changelogState : keyValueStatesByName.values()) {
-                checkState(changelogState instanceof ChangelogState);
-                ((ChangelogState) changelogState).resetWritingMetaFlag();
+            for (ChangelogState changelogState : changelogStates.values()) {
+                changelogState.resetWritingMetaFlag();
             }
 
             for (ChangelogKeyGroupedPriorityQueue<?> priorityQueueState :
diff --git a/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateEmbeddedRocksDBStateBackendTest.java b/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateEmbeddedRocksDBStateBackendTest.java
index 20224b1fd38..1d9819c5b2e 100644
--- a/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateEmbeddedRocksDBStateBackendTest.java
+++ b/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateEmbeddedRocksDBStateBackendTest.java
@@ -18,7 +18,11 @@
 
 package org.apache.flink.state.changelog;
 
+import org.apache.flink.api.common.state.StateTtlConfig;
+import org.apache.flink.api.common.time.Time;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
+import org.apache.flink.configuration.Configuration;
+import org.apache.flink.configuration.StateBackendOptions;
 import org.apache.flink.contrib.streaming.state.EmbeddedRocksDBStateBackend;
 import org.apache.flink.contrib.streaming.state.EmbeddedRocksDBStateBackendTest;
 import org.apache.flink.runtime.execution.Environment;
@@ -26,6 +30,7 @@ import org.apache.flink.runtime.state.CheckpointStreamFactory;
 import org.apache.flink.runtime.state.CheckpointableKeyedStateBackend;
 import org.apache.flink.runtime.state.ConfigurableStateBackend;
 import org.apache.flink.runtime.state.KeyGroupRange;
+import org.apache.flink.runtime.state.StateBackend;
 import org.apache.flink.runtime.state.TestTaskStateManager;
 
 import org.junit.Ignore;
@@ -91,7 +96,23 @@ public class ChangelogDelegateEmbeddedRocksDBStateBackendTest
         CheckpointStreamFactory streamFactory = createStreamFactory();
 
         ChangelogStateBackendTestUtils.testMaterializedRestore(
-                getStateBackend(), env, streamFactory);
+                getStateBackend(), StateTtlConfig.DISABLED, env, streamFactory);
+    }
+
+    @Test
+    public void testMaterializedRestoreWithWrappedState() throws Exception {
+        CheckpointStreamFactory streamFactory = createStreamFactory();
+
+        Configuration configuration = new Configuration();
+        configuration.set(StateBackendOptions.LATENCY_TRACK_ENABLED, true);
+        StateBackend stateBackend =
+                getStateBackend()
+                        .configure(configuration, Thread.currentThread().getContextClassLoader());
+        ChangelogStateBackendTestUtils.testMaterializedRestore(
+                stateBackend,
+                StateTtlConfig.newBuilder(Time.minutes(1)).build(),
+                env,
+                streamFactory);
     }
 
     @Test
diff --git a/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateFileStateBackendTest.java b/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateFileStateBackendTest.java
index 4b55462e91c..e75e5acae6e 100644
--- a/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateFileStateBackendTest.java
+++ b/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateFileStateBackendTest.java
@@ -18,7 +18,11 @@
 
 package org.apache.flink.state.changelog;
 
+import org.apache.flink.api.common.state.StateTtlConfig;
+import org.apache.flink.api.common.time.Time;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
+import org.apache.flink.configuration.Configuration;
+import org.apache.flink.configuration.StateBackendOptions;
 import org.apache.flink.runtime.execution.Environment;
 import org.apache.flink.runtime.state.CheckpointStorage;
 import org.apache.flink.runtime.state.CheckpointStreamFactory;
@@ -26,6 +30,7 @@ import org.apache.flink.runtime.state.CheckpointableKeyedStateBackend;
 import org.apache.flink.runtime.state.ConfigurableStateBackend;
 import org.apache.flink.runtime.state.FileStateBackendTest;
 import org.apache.flink.runtime.state.KeyGroupRange;
+import org.apache.flink.runtime.state.StateBackend;
 import org.apache.flink.runtime.state.TestTaskStateManager;
 import org.apache.flink.runtime.state.filesystem.FsStateBackend;
 import org.apache.flink.runtime.state.storage.JobManagerCheckpointStorage;
@@ -87,7 +92,23 @@ public class ChangelogDelegateFileStateBackendTest extends FileStateBackendTest
         CheckpointStreamFactory streamFactory = createStreamFactory();
 
         ChangelogStateBackendTestUtils.testMaterializedRestore(
-                getStateBackend(), env, streamFactory);
+                getStateBackend(), StateTtlConfig.DISABLED, env, streamFactory);
+    }
+
+    @Test
+    public void testMaterializedRestoreWithWrappedState() throws Exception {
+        CheckpointStreamFactory streamFactory = createStreamFactory();
+
+        Configuration configuration = new Configuration();
+        configuration.set(StateBackendOptions.LATENCY_TRACK_ENABLED, true);
+        StateBackend stateBackend =
+                getStateBackend()
+                        .configure(configuration, Thread.currentThread().getContextClassLoader());
+        ChangelogStateBackendTestUtils.testMaterializedRestore(
+                stateBackend,
+                StateTtlConfig.newBuilder(Time.minutes(1)).build(),
+                env,
+                streamFactory);
     }
 
     @Test
diff --git a/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateHashMapTest.java b/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateHashMapTest.java
index b7a266bbdbd..3040d403b25 100644
--- a/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateHashMapTest.java
+++ b/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateHashMapTest.java
@@ -18,13 +18,18 @@
 
 package org.apache.flink.state.changelog;
 
+import org.apache.flink.api.common.state.StateTtlConfig;
+import org.apache.flink.api.common.time.Time;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
+import org.apache.flink.configuration.Configuration;
+import org.apache.flink.configuration.StateBackendOptions;
 import org.apache.flink.runtime.execution.Environment;
 import org.apache.flink.runtime.state.CheckpointStreamFactory;
 import org.apache.flink.runtime.state.CheckpointableKeyedStateBackend;
 import org.apache.flink.runtime.state.ConfigurableStateBackend;
 import org.apache.flink.runtime.state.HashMapStateBackendTest;
 import org.apache.flink.runtime.state.KeyGroupRange;
+import org.apache.flink.runtime.state.StateBackend;
 import org.apache.flink.runtime.state.TestTaskStateManager;
 
 import org.junit.Rule;
@@ -78,7 +83,23 @@ public class ChangelogDelegateHashMapTest extends HashMapStateBackendTest {
         CheckpointStreamFactory streamFactory = createStreamFactory();
 
         ChangelogStateBackendTestUtils.testMaterializedRestore(
-                getStateBackend(), env, streamFactory);
+                getStateBackend(), StateTtlConfig.DISABLED, env, streamFactory);
+    }
+
+    @Test
+    public void testMaterializedRestoreWithWrappedState() throws Exception {
+        CheckpointStreamFactory streamFactory = createStreamFactory();
+
+        Configuration configuration = new Configuration();
+        configuration.set(StateBackendOptions.LATENCY_TRACK_ENABLED, true);
+        StateBackend stateBackend =
+                getStateBackend()
+                        .configure(configuration, Thread.currentThread().getContextClassLoader());
+        ChangelogStateBackendTestUtils.testMaterializedRestore(
+                stateBackend,
+                StateTtlConfig.newBuilder(Time.minutes(1)).build(),
+                env,
+                streamFactory);
     }
 
     @Test
diff --git a/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateMemoryStateBackendTest.java b/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateMemoryStateBackendTest.java
index b2f684dd335..16b50ad1165 100644
--- a/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateMemoryStateBackendTest.java
+++ b/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogDelegateMemoryStateBackendTest.java
@@ -18,7 +18,11 @@
 
 package org.apache.flink.state.changelog;
 
+import org.apache.flink.api.common.state.StateTtlConfig;
+import org.apache.flink.api.common.time.Time;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
+import org.apache.flink.configuration.Configuration;
+import org.apache.flink.configuration.StateBackendOptions;
 import org.apache.flink.runtime.execution.Environment;
 import org.apache.flink.runtime.state.CheckpointStorage;
 import org.apache.flink.runtime.state.CheckpointStreamFactory;
@@ -26,6 +30,7 @@ import org.apache.flink.runtime.state.CheckpointableKeyedStateBackend;
 import org.apache.flink.runtime.state.ConfigurableStateBackend;
 import org.apache.flink.runtime.state.KeyGroupRange;
 import org.apache.flink.runtime.state.MemoryStateBackendTest;
+import org.apache.flink.runtime.state.StateBackend;
 import org.apache.flink.runtime.state.TestTaskStateManager;
 import org.apache.flink.runtime.state.memory.MemoryStateBackend;
 import org.apache.flink.runtime.state.storage.JobManagerCheckpointStorage;
@@ -87,7 +92,23 @@ public class ChangelogDelegateMemoryStateBackendTest extends MemoryStateBackendT
         CheckpointStreamFactory streamFactory = createStreamFactory();
 
         ChangelogStateBackendTestUtils.testMaterializedRestore(
-                getStateBackend(), env, streamFactory);
+                getStateBackend(), StateTtlConfig.DISABLED, env, streamFactory);
+    }
+
+    @Test
+    public void testMaterializedRestoreWithWrappedState() throws Exception {
+        CheckpointStreamFactory streamFactory = createStreamFactory();
+
+        Configuration configuration = new Configuration();
+        configuration.set(StateBackendOptions.LATENCY_TRACK_ENABLED, true);
+        StateBackend stateBackend =
+                getStateBackend()
+                        .configure(configuration, Thread.currentThread().getContextClassLoader());
+        ChangelogStateBackendTestUtils.testMaterializedRestore(
+                stateBackend,
+                StateTtlConfig.newBuilder(Time.minutes(1)).build(),
+                env,
+                streamFactory);
     }
 
     @Test
diff --git a/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogStateBackendTestUtils.java b/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogStateBackendTestUtils.java
index 7d955baa6d7..1874cff9057 100644
--- a/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogStateBackendTestUtils.java
+++ b/flink-state-backends/flink-statebackend-changelog/src/test/java/org/apache/flink/state/changelog/ChangelogStateBackendTestUtils.java
@@ -19,6 +19,7 @@
 package org.apache.flink.state.changelog;
 
 import org.apache.flink.api.common.JobID;
+import org.apache.flink.api.common.state.StateTtlConfig;
 import org.apache.flink.api.common.state.ValueState;
 import org.apache.flink.api.common.state.ValueStateDescriptor;
 import org.apache.flink.api.common.typeinfo.TypeInformation;
@@ -139,7 +140,10 @@ public class ChangelogStateBackendTestUtils {
     }
 
     public static void testMaterializedRestore(
-            StateBackend stateBackend, Environment env, CheckpointStreamFactory streamFactory)
+            StateBackend stateBackend,
+            StateTtlConfig stateTtlConfig,
+            Environment env,
+            CheckpointStreamFactory streamFactory)
             throws Exception {
         SharedStateRegistry sharedStateRegistry = new SharedStateRegistryImpl();
 
@@ -147,6 +151,9 @@ public class ChangelogStateBackendTestUtils {
                 new GenericTypeInfo<>(StateBackendTestBase.TestPojo.class);
         ValueStateDescriptor<StateBackendTestBase.TestPojo> kvId =
                 new ValueStateDescriptor<>("id", pojoType);
+        if (stateTtlConfig.isEnabled()) {
+            kvId.enableTimeToLive(stateTtlConfig);
+        }
 
         ChangelogKeyedStateBackend<Integer> keyedBackend =
                 (ChangelogKeyedStateBackend<Integer>) createKeyedBackend(stateBackend, env);
