diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/AbstractFineGrainedSlotManagerITCase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/AbstractFineGrainedSlotManagerITCase.java
index a90e74b1cb6..cbcc43a5ea7 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/AbstractFineGrainedSlotManagerITCase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/AbstractFineGrainedSlotManagerITCase.java
@@ -565,12 +565,14 @@ public abstract class AbstractFineGrainedSlotManagerITCase extends FineGrainedSl
                                     });
                             assertFutureCompleteAndReturn(slotRequestCallFuture);
 
-                            getSlotManager()
-                                    .unregisterTaskManager(
-                                            taskExecutionConnection.getInstanceID(),
-                                            TEST_EXCEPTION);
-
-                            slotRequestFuture.complete(Acknowledge.get());
+                            runInMainThread(
+                                    () -> {
+                                        getSlotManager()
+                                                .unregisterTaskManager(
+                                                        taskExecutionConnection.getInstanceID(),
+                                                        TEST_EXCEPTION);
+                                        slotRequestFuture.complete(Acknowledge.get());
+                                    });
 
                             assertThat(
                                     trackingSecurityManager.getSystemExitFuture().isDone(),
@@ -626,13 +628,15 @@ public abstract class AbstractFineGrainedSlotManagerITCase extends FineGrainedSl
 
                             final AllocationID allocationId =
                                     assertFutureCompleteAndReturn(allocationIdFuture);
-                            getSlotManager()
-                                    .reportSlotStatus(
-                                            taskExecutionConnection.getInstanceID(),
-                                            new SlotReport(
-                                                    createAllocatedSlotStatus(
-                                                            allocationId,
-                                                            DEFAULT_SLOT_RESOURCE_PROFILE)));
+                            runInMainThread(
+                                    () ->
+                                            getSlotManager()
+                                                    .reportSlotStatus(
+                                                            taskExecutionConnection.getInstanceID(),
+                                                            new SlotReport(
+                                                                    createAllocatedSlotStatus(
+                                                                            allocationId,
+                                                                            DEFAULT_SLOT_RESOURCE_PROFILE))));
 
                             assertThat(
                                     trackingSecurityManager.getSystemExitFuture().isDone(),
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/FineGrainedSlotManagerTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/FineGrainedSlotManagerTest.java
index bdb8bd6c67a..068bb8660f5 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/FineGrainedSlotManagerTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/slotmanager/FineGrainedSlotManagerTest.java
@@ -508,9 +508,9 @@ public class FineGrainedSlotManagerTest extends FineGrainedSlotManagerTestBase {
             {
                 resourceActionsBuilder.setNotEnoughResourcesConsumer(
                         (jobId1, acquiredResources) -> {
-                            notifyNotEnoughResourceFuture.complete(null);
                             notEnoughResourceNotifications.add(
                                     Tuple2.of(jobId1, acquiredResources));
+                            notifyNotEnoughResourceFuture.complete(null);
                         });
                 resourceAllocationStrategyBuilder.setTryFulfillRequirementsFunction(
                         ((jobIDCollectionMap, taskManagerResourceInfoProvider) ->
