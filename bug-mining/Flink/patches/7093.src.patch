diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/legacy/metrics/MetricStore.java b/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/legacy/metrics/MetricStore.java
index fde960dd09b..d485917eb80 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/legacy/metrics/MetricStore.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/rest/handler/legacy/metrics/MetricStore.java
@@ -101,20 +101,30 @@ public class MetricStore {
                         Map<Integer, Integer> vertexAttempts =
                                 jobRepresentativeAttempts.compute(
                                         vertexId, (k, overwritten) -> new HashMap<>());
-                        JobMetricStore jobMetricStore = this.jobs.get(jobId);
-                        TaskMetricStore taskMetricStore =
-                                jobMetricStore.getTaskMetricStore(vertexId);
+                        Optional<TaskMetricStore> taskMetricStoreOptional =
+                                Optional.ofNullable(this.jobs.get(jobId))
+                                        .map(map -> map.getTaskMetricStore(vertexId));
+
                         // Retains current active subtasks to accommodate dynamic scaling
-                        taskMetricStore.retainSubtasks(subtaskAttempts.keySet());
+                        taskMetricStoreOptional.ifPresent(
+                                taskMetricStore ->
+                                        taskMetricStore.retainSubtasks(subtaskAttempts.keySet()));
+
                         subtaskAttempts.forEach(
                                 (subtaskIndex, attempts) -> {
                                     // Updates representative attempts
                                     vertexAttempts.put(
                                             subtaskIndex, attempts.getRepresentativeAttempt());
                                     // Retains current attempt metrics to avoid memory leak
-                                    taskMetricStore
-                                            .getSubtaskMetricStore(subtaskIndex)
-                                            .retainAttempts(attempts.getCurrentAttempts());
+                                    taskMetricStoreOptional
+                                            .map(
+                                                    taskMetricStore ->
+                                                            taskMetricStore.getSubtaskMetricStore(
+                                                                    subtaskIndex))
+                                            .ifPresent(
+                                                    subtaskMetricStore ->
+                                                            subtaskMetricStore.retainAttempts(
+                                                                    attempts.getCurrentAttempts()));
                                 });
                     });
         }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/rest/handler/legacy/metrics/MetricStoreTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/rest/handler/legacy/metrics/MetricStoreTest.java
index 0c7d0b650ba..72cd8d1dcff 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/rest/handler/legacy/metrics/MetricStoreTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/rest/handler/legacy/metrics/MetricStoreTest.java
@@ -39,6 +39,7 @@ import java.util.Set;
 import java.util.stream.Collectors;
 
 import static org.assertj.core.api.Assertions.assertThat;
+import static org.assertj.core.api.Assertions.assertThatCode;
 
 /** Tests for the MetricStore. */
 class MetricStoreTest {
@@ -136,6 +137,33 @@ class MetricStoreTest {
         assertThat(store.getJobs()).isEmpty();
     }
 
+    @Test
+    void testUpdateCurrentExecutionAttemptsWithNonExistentComponentMetricStore() {
+        MetricStore metricStore = new MetricStore();
+        assertThat(metricStore.getJobs()).isEmpty();
+
+        JobDetails jobDetail =
+                new JobDetails(
+                        JOB_ID,
+                        "jobname",
+                        0,
+                        0,
+                        0,
+                        JobStatus.RUNNING,
+                        0,
+                        new int[10],
+                        1,
+                        Collections.singletonMap(
+                                "taskid",
+                                Collections.singletonMap(
+                                        1, new CurrentAttempts(1, new HashSet<>()))));
+        assertThatCode(
+                        () ->
+                                metricStore.updateCurrentExecutionAttempts(
+                                        Collections.singletonList(jobDetail)))
+                .doesNotThrowAnyException();
+    }
+
     @Test
     void testTaskMetricStoreCleanup() {
         MetricStore store = setupStore(new MetricStore());
