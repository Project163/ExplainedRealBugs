diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerBase.java b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerBase.java
index 180ca9c0f8a..8620261f4c9 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerBase.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerBase.java
@@ -206,7 +206,7 @@ public abstract class FileMergingSnapshotManagerBase implements FileMergingSnaps
             // According
             // to the FLIP-306, we later consider move these files to the new introduced
             // task-manager-owned directory.
-            Path managedExclusivePath = new Path(taskOwnedStateDir, id);
+            Path managedExclusivePath = new Path(taskOwnedStateDir, uriEscape(id));
             boolean newCreated = createManagedDirectory(managedExclusivePath);
             this.managedExclusiveStateDir = managedExclusivePath;
             this.managedExclusiveStateDirHandle =
@@ -219,7 +219,7 @@ public abstract class FileMergingSnapshotManagerBase implements FileMergingSnaps
     @Override
     public void registerSubtaskForSharedStates(SubtaskKey subtaskKey) {
         String managedDirName = subtaskKey.getManagedDirName();
-        Path managedPath = new Path(sharedStateDir, managedDirName);
+        Path managedPath = new Path(sharedStateDir, uriEscape(managedDirName));
         if (!managedSharedStateDir.containsKey(subtaskKey)) {
             boolean newCreated = createManagedDirectory(managedPath);
             managedSharedStateDir.put(subtaskKey, managedPath);
@@ -773,6 +773,13 @@ public abstract class FileMergingSnapshotManagerBase implements FileMergingSnaps
         return true;
     }
 
+    private static String uriEscape(String input) {
+        // All reserved characters (RFC 2396) will be removed. This is enough for flink's resource
+        // id, job id and operator id.
+        // Ref: https://docs.oracle.com/javase/8/docs/api/index.html?java/net/URI.html
+        return input.replaceAll("[;/?:@&=+$,\\[\\]]", "-");
+    }
+
     // ------------------------------------------------------------------------
     //  utilities
     // ------------------------------------------------------------------------
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerTestBase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerTestBase.java
index f22a9dcf2f4..613c278ad90 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerTestBase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerTestBase.java
@@ -115,6 +115,36 @@ public abstract class FileMergingSnapshotManagerTestBase {
         }
     }
 
+    @Test
+    public void testSpecialCharactersInPath() throws IOException {
+        FileSystem fs = LocalFileSystem.getSharedInstance();
+        if (!fs.exists(checkpointBaseDir)) {
+            fs.mkdirs(checkpointBaseDir);
+            fs.mkdirs(sharedStateDir);
+            fs.mkdirs(taskOwnedStateDir);
+        }
+        // No exception will throw.
+        try (FileMergingSnapshotManager fmsm =
+                new FileMergingSnapshotManagerBuilder(
+                                jobID,
+                                new ResourceID("localhost:53424-,;:$&+=?/[]@#qqq"),
+                                getFileMergingType())
+                        .setMetricGroup(
+                                new UnregisteredMetricGroups
+                                        .UnregisteredTaskManagerJobMetricGroup())
+                        .build()) {
+            fmsm.initFileSystem(
+                    LocalFileSystem.getSharedInstance(),
+                    checkpointBaseDir,
+                    sharedStateDir,
+                    taskOwnedStateDir,
+                    writeBufferSize);
+            assertThat(fmsm).isNotNull();
+            fmsm.registerSubtaskForSharedStates(
+                    new SubtaskKey(jobID.toString(), ",;:$&+=?/[]@#www", 0, 1));
+        }
+    }
+
     @Test
     void testRefCountBetweenLogicalAndPhysicalFiles() throws IOException {
         try (FileMergingSnapshotManagerBase fmsm =
