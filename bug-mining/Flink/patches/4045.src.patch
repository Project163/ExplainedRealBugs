diff --git a/flink-connectors/flink-connector-kafka-0.11/src/main/java/org/apache/flink/streaming/connectors/kafka/internal/FlinkKafkaProducer.java b/flink-connectors/flink-connector-kafka-0.11/src/main/java/org/apache/flink/streaming/connectors/kafka/internal/FlinkKafkaProducer.java
index 1e731399c05..7d600534dad 100644
--- a/flink-connectors/flink-connector-kafka-0.11/src/main/java/org/apache/flink/streaming/connectors/kafka/internal/FlinkKafkaProducer.java
+++ b/flink-connectors/flink-connector-kafka-0.11/src/main/java/org/apache/flink/streaming/connectors/kafka/internal/FlinkKafkaProducer.java
@@ -190,17 +190,17 @@ public class FlinkKafkaProducer<K, V> implements Producer<K, V> {
 
 	@Override
 	public void close() {
-		closed = true;
 		synchronized (producerClosingLock) {
 			kafkaProducer.close();
+			closed = true;
 		}
 	}
 
 	@Override
 	public void close(long timeout, TimeUnit unit) {
-		closed = true;
 		synchronized (producerClosingLock) {
 			kafkaProducer.close(timeout, unit);
+			closed = true;
 		}
 	}
 
diff --git a/flink-connectors/flink-connector-kafka/src/main/java/org/apache/flink/streaming/connectors/kafka/internal/FlinkKafkaInternalProducer.java b/flink-connectors/flink-connector-kafka/src/main/java/org/apache/flink/streaming/connectors/kafka/internal/FlinkKafkaInternalProducer.java
index 8c2246ed9ed..8ecb5ab21d3 100644
--- a/flink-connectors/flink-connector-kafka/src/main/java/org/apache/flink/streaming/connectors/kafka/internal/FlinkKafkaInternalProducer.java
+++ b/flink-connectors/flink-connector-kafka/src/main/java/org/apache/flink/streaming/connectors/kafka/internal/FlinkKafkaInternalProducer.java
@@ -145,25 +145,25 @@ public class FlinkKafkaInternalProducer<K, V> implements Producer<K, V> {
 
 	@Override
 	public void close() {
-		closed = true;
 		synchronized (producerClosingLock) {
 			kafkaProducer.close();
+			closed = true;
 		}
 	}
 
 	@Override
 	public void close(long timeout, TimeUnit unit) {
-		closed = true;
 		synchronized (producerClosingLock) {
 			kafkaProducer.close(timeout, unit);
+			closed = true;
 		}
 	}
 
 	@Override
 	public void close(Duration duration) {
-		closed = true;
 		synchronized (producerClosingLock) {
 			kafkaProducer.close(duration);
+			closed = true;
 		}
 	}
 
