diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsStorageLocationReferenceTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsStorageLocationReferenceTest.java
index b0bad644dc4..6afb46126cd 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsStorageLocationReferenceTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsStorageLocationReferenceTest.java
@@ -72,19 +72,26 @@ public class FsStorageLocationReferenceTest extends TestLogger {
 	// ------------------------------------------------------------------------
 
 	private static Path randomPath(Random rnd) {
-		final StringBuilder path = new StringBuilder();
-
-		// scheme
-		path.append(StringUtils.getRandomString(rnd, 1, 5, 'a', 'z'));
-		path.append("://");
-		path.append(StringUtils.getRandomString(rnd, 10, 20)); // authority
-		path.append(rnd.nextInt(50000) + 1); // port
-
-		for (int i = rnd.nextInt(5) + 1; i > 0; i--) {
-			path.append('/');
-			path.append(StringUtils.getRandomString(rnd, 3, 15));
+		while (true) {
+			try {
+				final StringBuilder path = new StringBuilder();
+
+				// scheme
+				path.append(StringUtils.getRandomString(rnd, 1, 5, 'a', 'z'));
+				path.append("://");
+				path.append(StringUtils.getRandomString(rnd, 10, 20)); // authority
+				path.append(":");
+				path.append(rnd.nextInt(50000) + 1); // port
+
+				for (int j = rnd.nextInt(5) + 1; j > 0; j--) {
+					path.append('/');
+					path.append(StringUtils.getRandomString(rnd, 3, 15));
+				}
+
+				return new Path(path.toString());
+			} catch (Throwable t) {
+				// ignore the exception and retry
+			}
 		}
-
-		return new Path(path.toString());
 	}
 }
