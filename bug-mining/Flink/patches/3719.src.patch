diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/memory/MemoryManager.java b/flink-runtime/src/main/java/org/apache/flink/runtime/memory/MemoryManager.java
index 8e7c2dda42b..3bcfa7c285e 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/memory/MemoryManager.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/memory/MemoryManager.java
@@ -495,23 +495,32 @@ public class MemoryManager {
 				reservations.compute(
 					memoryType,
 					(mt, currentlyReserved) -> {
-						if (currentlyReserved == null || currentlyReserved < size) {
-							LOG.warn(
-								"Trying to release more memory {} than it was reserved {} so far for the owner {}",
-								size,
-								currentlyReserved == null ? 0 : currentlyReserved,
-								owner);
-							//noinspection ReturnOfNull
-							return null;
-						} else {
-							return currentlyReserved - size;
+						long newReservedMemory = 0;
+						if (currentlyReserved != null) {
+							if (currentlyReserved < size) {
+								LOG.warn(
+									"Trying to release more memory {} than it was reserved {} so far for the owner {}",
+									size,
+									currentlyReserved,
+									owner);
+							}
+
+							newReservedMemory = releaseAndCalculateReservedMemory(size, memoryType, currentlyReserved);
 						}
+
+						return newReservedMemory == 0 ? null : newReservedMemory;
 					});
 			}
 			//noinspection ReturnOfNull
 			return reservations == null || reservations.isEmpty() ? null : reservations;
 		});
-		budgetByType.releaseBudgetForKey(memoryType, size);
+	}
+
+	private long releaseAndCalculateReservedMemory(long memoryToFree, MemoryType memoryType, long currentlyReserved) {
+		final long effectiveMemoryToRelease = Math.min(currentlyReserved, memoryToFree);
+		budgetByType.releaseBudgetForKey(memoryType, effectiveMemoryToRelease);
+
+		return currentlyReserved - effectiveMemoryToRelease;
 	}
 
 	private void checkMemoryReservationPreconditions(Object owner, MemoryType memoryType, long size) {
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/memory/MemoryManagerTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/memory/MemoryManagerTest.java
index 868e3f104a0..75a315139cd 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/memory/MemoryManagerTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/memory/MemoryManagerTest.java
@@ -278,6 +278,39 @@ public class MemoryManagerTest {
 		testCannotReserveAnymore(MemoryType.HEAP, size);
 	}
 
+	@Test
+	public void testMemoryReleaseMultipleTimes() throws MemoryReservationException {
+		Object owner = new Object();
+		Object owner2 = new Object();
+		long totalHeapMemorySize = memoryManager.availableMemory(MemoryType.HEAP);
+		// to prevent memory size exceeding the limit, reserve some memory from another owner.
+		memoryManager.reserveMemory(owner2, MemoryType.HEAP, PAGE_SIZE);
+
+		// reserve once but release twice
+		memoryManager.reserveMemory(owner, MemoryType.HEAP, PAGE_SIZE);
+		memoryManager.releaseMemory(owner, MemoryType.HEAP, PAGE_SIZE);
+		memoryManager.releaseMemory(owner, MemoryType.HEAP, PAGE_SIZE);
+		long heapMemoryLeft = memoryManager.availableMemory(MemoryType.HEAP);
+		assertEquals("Memory leak happens", totalHeapMemorySize - PAGE_SIZE, heapMemoryLeft);
+		memoryManager.releaseAllMemory(owner2, MemoryType.HEAP);
+	}
+
+	@Test
+	public void testMemoryReleaseMoreThanReserved() throws MemoryReservationException {
+		Object owner = new Object();
+		Object owner2 = new Object();
+		long totalHeapMemorySize = memoryManager.availableMemory(MemoryType.HEAP);
+		// to prevent memory size exceeding the limit, reserve some memory from another owner.
+		memoryManager.reserveMemory(owner2, MemoryType.HEAP, PAGE_SIZE);
+
+		// release more than reserved size
+		memoryManager.reserveMemory(owner, MemoryType.HEAP, PAGE_SIZE);
+		memoryManager.releaseMemory(owner, MemoryType.HEAP, PAGE_SIZE * 2);
+		long heapMemoryLeft = memoryManager.availableMemory(MemoryType.HEAP);
+		assertEquals("Memory leak happens", totalHeapMemorySize - PAGE_SIZE, heapMemoryLeft);
+		memoryManager.releaseAllMemory(owner2, MemoryType.HEAP);
+	}
+
 	@Test
 	public void testMemoryAllocationAndReservation() throws MemoryAllocationException, MemoryReservationException {
 		MemoryType type = MemoryType.OFF_HEAP;
