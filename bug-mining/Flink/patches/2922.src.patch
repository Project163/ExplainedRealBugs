diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStreamFactory.java b/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStreamFactory.java
index 825360628d9..fcb77084815 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStreamFactory.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStreamFactory.java
@@ -187,7 +187,7 @@ public class FsCheckpointStreamFactory implements CheckpointStreamFactory {
 
 		@Override
 		public void write(byte[] b, int off, int len) throws IOException {
-			if (len < writeBuffer.length / 2) {
+			if (len < writeBuffer.length) {
 				// copy it into our write buffer first
 				final int remaining = writeBuffer.length - pos;
 				if (len > remaining) {
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStateOutputStreamTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStateOutputStreamTest.java
index 8bafdf729af..c06cdfa177a 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStateOutputStreamTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/state/filesystem/FsCheckpointStateOutputStreamTest.java
@@ -86,7 +86,7 @@ public class FsCheckpointStateOutputStreamTest {
 
 	@Test
 	public void testStateBelowMemThreshold() throws Exception {
-		runTest(222, 999, 512, false);
+		runTest(999, 1024, 1000, false);
 	}
 
 	@Test
@@ -216,7 +216,8 @@ public class FsCheckpointStateOutputStreamTest {
 				stream.write(bytes[pos++]);
 			}
 			else {
-				int num = rnd.nextInt(Math.min(10, bytes.length - pos));
+				int num = rnd.nextBoolean() ?
+					(bytes.length - pos) : rnd.nextInt(bytes.length - pos);
 				stream.write(bytes, pos, num);
 				pos += num;
 			}
