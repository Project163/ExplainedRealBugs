diff --git a/flink-connectors/flink-connector-kafka-0.9/src/test/java/org/apache/flink/streaming/connectors/kafka/Kafka09ITCase.java b/flink-connectors/flink-connector-kafka-0.9/src/test/java/org/apache/flink/streaming/connectors/kafka/Kafka09ITCase.java
index 5a4e77521da..47d910d993e 100644
--- a/flink-connectors/flink-connector-kafka-0.9/src/test/java/org/apache/flink/streaming/connectors/kafka/Kafka09ITCase.java
+++ b/flink-connectors/flink-connector-kafka-0.9/src/test/java/org/apache/flink/streaming/connectors/kafka/Kafka09ITCase.java
@@ -29,16 +29,16 @@ import org.apache.flink.core.memory.DataInputView;
 import org.apache.flink.core.memory.DataInputViewStreamWrapper;
 import org.apache.flink.streaming.api.datastream.DataStream;
 import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
-import org.apache.flink.streaming.api.functions.sink.SinkFunction;
+import org.apache.flink.streaming.api.functions.sink.DiscardingSink;
 import org.apache.flink.streaming.api.functions.source.SourceFunction;
 import org.apache.flink.streaming.util.serialization.KeyedDeserializationSchema;
 
 import org.junit.Assert;
-import org.junit.Ignore;
 import org.junit.Test;
 
 import java.io.ByteArrayInputStream;
 import java.io.IOException;
+import java.util.Properties;
 
 /**
  * IT cases for Kafka 0.9 .
@@ -167,7 +167,6 @@ public class Kafka09ITCase extends KafkaConsumerTestBase {
 	 * a desired rate of 3 bytes / second. Based on the execution time, the test asserts that this rate was not surpassed.
 	 * If no rate limiter is set on the consumer, the test should fail.
 	 */
-	@Ignore
 	@Test(timeout = 60000)
 	public void testRateLimitedConsumer() throws Exception {
 		final String testTopic = "testRateLimitedConsumer";
@@ -185,11 +184,13 @@ public class Kafka09ITCase extends KafkaConsumerTestBase {
 			boolean running = true;
 
 			@Override
-			public void run(SourceContext<String> ctx) throws Exception {
+			public void run(SourceContext<String> ctx) {
 				long i = 0;
 				while (running) {
 					byte[] data = new byte[] {1};
-					ctx.collect(new String(data)); // 1 byte
+					synchronized (ctx.getCheckpointLock()) {
+						ctx.collect(new String(data)); // 1 byte
+					}
 					if (i++ == 100L) {
 						running = false;
 					}
@@ -202,7 +203,12 @@ public class Kafka09ITCase extends KafkaConsumerTestBase {
 			}
 		});
 
-		stream.addSink(new FlinkKafkaProducer09<>(testTopic, new SimpleStringSchema(), standardProps)).setParallelism(1);
+		Properties producerProperties = new Properties();
+		producerProperties.putAll(standardProps);
+		producerProperties.putAll(secureProps);
+		producerProperties.put("retries", 3);
+
+		stream.addSink(new FlinkKafkaProducer09<>(testTopic, new SimpleStringSchema(), producerProperties));
 		env.execute("Produce 100 bytes of data to test topic");
 
 		// ---------- Consumer from Kafka in a ratelimited way -----------
@@ -213,7 +219,7 @@ public class Kafka09ITCase extends KafkaConsumerTestBase {
 		env.getConfig().disableSysoutLogging();
 
 		// ---------- RateLimiter config -------------
-		long globalRate = 3; // bytes/second
+		final long globalRate = 10; // bytes/second
 		FlinkKafkaConsumer09<String> consumer09 = new FlinkKafkaConsumer09<>(testTopic,
 			new StringDeserializer(globalRate), standardProps);
 		FlinkConnectorRateLimiter rateLimiter = new GuavaFlinkConnectorRateLimiter();
@@ -221,17 +227,12 @@ public class Kafka09ITCase extends KafkaConsumerTestBase {
 		consumer09.setRateLimiter(rateLimiter);
 
 		DataStream<String> stream1 = env.addSource(consumer09);
-		stream1.addSink(new SinkFunction<String>() {
-			@Override
-			public void invoke(String value, Context context) throws Exception {
-
-			}
-		});
+		stream1.addSink(new DiscardingSink<>());
 		env.execute("Consume 100 bytes of data from test topic");
 
 		// ------- Assertions --------------
 		Assert.assertNotNull(consumer09.getRateLimiter());
-		Assert.assertEquals(consumer09.getRateLimiter().getRate(), globalRate);
+		Assert.assertEquals(globalRate, consumer09.getRateLimiter().getRate());
 
 		deleteTestTopic(testTopic);
 	}
