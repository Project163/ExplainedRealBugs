diff --git a/flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/util/serialization/TypeInformationKeyValueSerializationSchema.java b/flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/util/serialization/TypeInformationKeyValueSerializationSchema.java
index 3e0cdb52d54..96b887912e6 100644
--- a/flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/util/serialization/TypeInformationKeyValueSerializationSchema.java
+++ b/flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/util/serialization/TypeInformationKeyValueSerializationSchema.java
@@ -24,8 +24,8 @@ import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.java.tuple.Tuple2;
 import org.apache.flink.api.java.typeutils.TupleTypeInfo;
 import org.apache.flink.api.java.typeutils.TypeExtractor;
-import org.apache.flink.runtime.util.DataInputDeserializer;
-import org.apache.flink.runtime.util.DataOutputSerializer;
+import org.apache.flink.core.memory.DataInputDeserializer;
+import org.apache.flink.core.memory.DataOutputSerializer;
 
 import java.io.IOException;
 
diff --git a/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/state/serialization/DataInputDeserializer.java b/flink-core/src/main/java/org/apache/flink/core/memory/DataInputDeserializer.java
similarity index 97%
rename from flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/state/serialization/DataInputDeserializer.java
rename to flink-core/src/main/java/org/apache/flink/core/memory/DataInputDeserializer.java
index 878df859428..088f9d29bc5 100644
--- a/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/state/serialization/DataInputDeserializer.java
+++ b/flink-core/src/main/java/org/apache/flink/core/memory/DataInputDeserializer.java
@@ -16,10 +16,7 @@
  * limitations under the License.
  */
 
-package org.apache.flink.queryablestate.client.state.serialization;
-
-import org.apache.flink.core.memory.DataInputView;
-import org.apache.flink.core.memory.MemoryUtils;
+package org.apache.flink.core.memory;
 
 import java.io.EOFException;
 import java.io.IOException;
@@ -29,8 +26,6 @@ import java.nio.ByteOrder;
 
 /**
  * A simple and efficient deserializer for the {@link java.io.DataInput} interface.
- *
- * <p><b>THIS WAS COPIED FROM RUNTIME SO THAT WE AVOID THE DEPENDENCY.</b>
  */
 public class DataInputDeserializer implements DataInputView, java.io.Serializable {
 
diff --git a/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/state/serialization/DataOutputSerializer.java b/flink-core/src/main/java/org/apache/flink/core/memory/DataOutputSerializer.java
similarity index 93%
rename from flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/state/serialization/DataOutputSerializer.java
rename to flink-core/src/main/java/org/apache/flink/core/memory/DataOutputSerializer.java
index 5811c91f3d2..7b8acb7ae63 100644
--- a/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/state/serialization/DataOutputSerializer.java
+++ b/flink-core/src/main/java/org/apache/flink/core/memory/DataOutputSerializer.java
@@ -16,11 +16,7 @@
  * limitations under the License.
  */
 
-package org.apache.flink.queryablestate.client.state.serialization;
-
-import org.apache.flink.core.memory.DataInputView;
-import org.apache.flink.core.memory.DataOutputView;
-import org.apache.flink.core.memory.MemoryUtils;
+package org.apache.flink.core.memory;
 
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -34,8 +30,6 @@ import java.util.Arrays;
 
 /**
  * A simple and efficient serializer for the {@link java.io.DataOutput} interface.
- *
- * <p><b>THIS WAS COPIED FROM RUNTIME SO THAT WE AVOID THE DEPENDENCY.</b>
  */
 public class DataOutputSerializer implements DataOutputView {
 
@@ -170,7 +164,6 @@ public class DataOutputSerializer implements DataOutputView {
 		if (this.position >= this.buffer.length - 2 * sLen) {
 			resize(2 * sLen);
 		}
-
 		for (int i = 0; i < sLen; i++) {
 			writeChar(s.charAt(i));
 		}
@@ -218,7 +211,7 @@ public class DataOutputSerializer implements DataOutputView {
 			resize(2);
 		}
 		this.buffer[this.position++] = (byte) ((v >>> 8) & 0xff);
-		this.buffer[this.position++] = (byte) ((v >>> 0) & 0xff);
+		this.buffer[this.position++] = (byte) (v & 0xff);
 	}
 
 	@Override
@@ -250,9 +243,9 @@ public class DataOutputSerializer implements DataOutputView {
 		int count = this.position;
 
 		bytearr[count++] = (byte) ((utflen >>> 8) & 0xFF);
-		bytearr[count++] = (byte) ((utflen >>> 0) & 0xFF);
+		bytearr[count++] = (byte) (utflen & 0xFF);
 
-		int i = 0;
+		int i;
 		for (i = 0; i < strlen; i++) {
 			c = str.charAt(i);
 			if (!((c >= 0x0001) && (c <= 0x007F))) {
@@ -268,11 +261,11 @@ public class DataOutputSerializer implements DataOutputView {
 
 			} else if (c > 0x07FF) {
 				bytearr[count++] = (byte) (0xE0 | ((c >> 12) & 0x0F));
-				bytearr[count++] = (byte) (0x80 | ((c >> 6) & 0x3F));
-				bytearr[count++] = (byte) (0x80 | ((c >> 0) & 0x3F));
+				bytearr[count++] = (byte) (0x80 | ((c >>  6) & 0x3F));
+				bytearr[count++] = (byte) (0x80 | (c & 0x3F));
 			} else {
 				bytearr[count++] = (byte) (0xC0 | ((c >> 6) & 0x1F));
-				bytearr[count++] = (byte) (0x80 | ((c >> 0) & 0x3F));
+				bytearr[count++] = (byte) (0x80 | (c & 0x3F));
 			}
 		}
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/util/DataInputDeserializerTest.java b/flink-core/src/test/java/org/apache/flink/core/memory/DataInputDeserializerTest.java
similarity index 97%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/util/DataInputDeserializerTest.java
rename to flink-core/src/test/java/org/apache/flink/core/memory/DataInputDeserializerTest.java
index 2032d45333d..26d407d95fa 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/util/DataInputDeserializerTest.java
+++ b/flink-core/src/test/java/org/apache/flink/core/memory/DataInputDeserializerTest.java
@@ -16,7 +16,7 @@
  * limitations under the License.
  */
 
-package org.apache.flink.runtime.util;
+package org.apache.flink.core.memory;
 
 import org.junit.Assert;
 import org.junit.Test;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/util/DataInputOutputSerializerTest.java b/flink-core/src/test/java/org/apache/flink/core/memory/DataInputOutputSerializerTest.java
similarity index 89%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/util/DataInputOutputSerializerTest.java
rename to flink-core/src/test/java/org/apache/flink/core/memory/DataInputOutputSerializerTest.java
index 3631ba18c63..02a7ea7baca 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/util/DataInputOutputSerializerTest.java
+++ b/flink-core/src/test/java/org/apache/flink/core/memory/DataInputOutputSerializerTest.java
@@ -16,21 +16,22 @@
  * limitations under the License.
  */
 
-package org.apache.flink.runtime.util;
+package org.apache.flink.core.memory;
 
-import org.apache.flink.core.memory.MemorySegmentFactory;
-import org.junit.Assert;
+import org.apache.flink.testutils.serialization.types.SerializationTestType;
+import org.apache.flink.testutils.serialization.types.SerializationTestTypeFactory;
+import org.apache.flink.testutils.serialization.types.Util;
 
-import org.apache.flink.core.memory.MemorySegment;
-import org.apache.flink.runtime.io.network.api.serialization.types.SerializationTestType;
-import org.apache.flink.runtime.io.network.api.serialization.types.SerializationTestTypeFactory;
-import org.apache.flink.runtime.io.network.api.serialization.types.Util;
+import org.junit.Assert;
 import org.junit.Test;
 
 import java.io.IOException;
 import java.nio.ByteBuffer;
 import java.util.ArrayDeque;
 
+/**
+ * Tests for the combination of {@link DataOutputSerializer} and {@link DataInputDeserializer}.
+ */
 public class DataInputOutputSerializerTest {
 
 	@Test
@@ -88,7 +89,7 @@ public class DataInputOutputSerializerTest {
 	@Test
 	public void testRandomValuesWriteRead() {
 		final int numElements = 100000;
-		final ArrayDeque<SerializationTestType> reference = new ArrayDeque<SerializationTestType>();
+		final ArrayDeque<SerializationTestType> reference = new ArrayDeque<>();
 
 		DataOutputSerializer serializer = new DataOutputSerializer(1);
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/AsciiStringType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/AsciiStringType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/AsciiStringType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/AsciiStringType.java
index 74de096d1c8..d845a3929d6 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/AsciiStringType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/AsciiStringType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import org.apache.flink.configuration.ConfigConstants;
 import org.apache.flink.core.memory.DataInputView;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/BooleanType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/BooleanType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/BooleanType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/BooleanType.java
index 66b099dc94f..cb696b1ad52 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/BooleanType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/BooleanType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Random;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ByteArrayType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ByteArrayType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ByteArrayType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ByteArrayType.java
index 66fa22c113b..c33e43d1667 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ByteArrayType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ByteArrayType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Arrays;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ByteSubArrayType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ByteSubArrayType.java
similarity index 97%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ByteSubArrayType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ByteSubArrayType.java
index 6431f14f73e..2d5a48a6e26 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ByteSubArrayType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ByteSubArrayType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Arrays;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ByteType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ByteType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ByteType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ByteType.java
index 87fd7c0a894..8b843be5517 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ByteType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ByteType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Random;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/CharType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/CharType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/CharType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/CharType.java
index b162ea0bcbb..962de7fe5cb 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/CharType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/CharType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Random;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/DoubleType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/DoubleType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/DoubleType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/DoubleType.java
index 654b6853814..7119c34bcb8 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/DoubleType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/DoubleType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Random;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/FloatType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/FloatType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/FloatType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/FloatType.java
index 653be45cc0a..9fa6e639365 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/FloatType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/FloatType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Random;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/IntType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/IntType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/IntType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/IntType.java
index 4c6429db90c..52313abd821 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/IntType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/IntType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Random;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/LongType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/LongType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/LongType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/LongType.java
index 934dfb78a33..3e47b4b4a55 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/LongType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/LongType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Random;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/SerializationTestType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/SerializationTestType.java
similarity index 93%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/SerializationTestType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/SerializationTestType.java
index 69db122f606..1edd7967a53 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/SerializationTestType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/SerializationTestType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.util.Random;
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/SerializationTestTypeFactory.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/SerializationTestTypeFactory.java
similarity index 95%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/SerializationTestTypeFactory.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/SerializationTestTypeFactory.java
index 03a093f805c..392e15abf15 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/SerializationTestTypeFactory.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/SerializationTestTypeFactory.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 public enum SerializationTestTypeFactory {
 	
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ShortType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ShortType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ShortType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ShortType.java
index 69e0ffc0ec9..b5b3c275dc4 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/ShortType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/ShortType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Random;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/UnsignedByteType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/UnsignedByteType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/UnsignedByteType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/UnsignedByteType.java
index eabb1dd6032..29b897abaa1 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/UnsignedByteType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/UnsignedByteType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Random;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/UnsignedShortType.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/UnsignedShortType.java
similarity index 96%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/UnsignedShortType.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/UnsignedShortType.java
index 6242900d42e..47d0156b49d 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/UnsignedShortType.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/UnsignedShortType.java
@@ -17,7 +17,7 @@
  */
 
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.io.IOException;
 import java.util.Random;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/Util.java b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/Util.java
similarity index 97%
rename from flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/Util.java
rename to flink-core/src/test/java/org/apache/flink/testutils/serialization/types/Util.java
index 110f7ce5081..b34701f7a9b 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/types/Util.java
+++ b/flink-core/src/test/java/org/apache/flink/testutils/serialization/types/Util.java
@@ -16,7 +16,7 @@
  * limitations under the License.
  */
 
-package org.apache.flink.runtime.io.network.api.serialization.types;
+package org.apache.flink.testutils.serialization.types;
 
 import java.util.Iterator;
 import java.util.NoSuchElementException;
diff --git a/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/state/serialization/KvStateSerializer.java b/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/state/serialization/KvStateSerializer.java
index 4c69483989b..4a64678e550 100644
--- a/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/state/serialization/KvStateSerializer.java
+++ b/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/state/serialization/KvStateSerializer.java
@@ -20,6 +20,8 @@ package org.apache.flink.queryablestate.client.state.serialization;
 
 import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.java.tuple.Tuple2;
+import org.apache.flink.core.memory.DataInputDeserializer;
+import org.apache.flink.core.memory.DataOutputSerializer;
 
 import java.io.IOException;
 import java.nio.ByteBuffer;
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/AdaptiveSpanningRecordDeserializer.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/AdaptiveSpanningRecordDeserializer.java
index 8f2c8fd6d1a..04a7a21edfe 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/AdaptiveSpanningRecordDeserializer.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/AdaptiveSpanningRecordDeserializer.java
@@ -22,8 +22,8 @@ import org.apache.flink.core.io.IOReadableWritable;
 import org.apache.flink.core.memory.DataInputView;
 import org.apache.flink.core.memory.MemorySegment;
 import org.apache.flink.runtime.io.network.buffer.Buffer;
-import org.apache.flink.runtime.util.DataInputDeserializer;
-import org.apache.flink.runtime.util.DataOutputSerializer;
+import org.apache.flink.core.memory.DataInputDeserializer;
+import org.apache.flink.core.memory.DataOutputSerializer;
 
 import java.io.EOFException;
 import java.io.IOException;
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/EventSerializer.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/EventSerializer.java
index aa8133ff54b..742410ec059 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/EventSerializer.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/EventSerializer.java
@@ -30,8 +30,8 @@ import org.apache.flink.runtime.io.network.api.EndOfPartitionEvent;
 import org.apache.flink.runtime.io.network.api.EndOfSuperstepEvent;
 import org.apache.flink.runtime.io.network.buffer.Buffer;
 import org.apache.flink.runtime.io.network.buffer.FreeingBufferRecycler;
-import org.apache.flink.runtime.util.DataInputDeserializer;
-import org.apache.flink.runtime.util.DataOutputSerializer;
+import org.apache.flink.core.memory.DataInputDeserializer;
+import org.apache.flink.core.memory.DataOutputSerializer;
 import org.apache.flink.util.InstantiationUtil;
 
 import java.io.IOException;
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializer.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializer.java
index 6c541a9b723..87b9e4cb23e 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializer.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializer.java
@@ -26,7 +26,7 @@ import org.apache.flink.core.io.IOReadableWritable;
 import org.apache.flink.core.memory.MemorySegment;
 import org.apache.flink.runtime.metrics.groups.TaskIOMetricGroup;
 import org.apache.flink.runtime.io.network.buffer.Buffer;
-import org.apache.flink.runtime.util.DataOutputSerializer;
+import org.apache.flink.core.memory.DataOutputSerializer;
 
 /**
  * Record serializer which serializes the complete record to an intermediate
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/SpillingAdaptiveSpanningRecordDeserializer.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/SpillingAdaptiveSpanningRecordDeserializer.java
index 7c213b4565b..74260d453ef 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/SpillingAdaptiveSpanningRecordDeserializer.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/api/serialization/SpillingAdaptiveSpanningRecordDeserializer.java
@@ -23,7 +23,7 @@ import org.apache.flink.core.memory.DataInputView;
 import org.apache.flink.core.memory.DataInputViewStreamWrapper;
 import org.apache.flink.core.memory.MemorySegment;
 import org.apache.flink.runtime.io.network.buffer.Buffer;
-import org.apache.flink.runtime.util.DataInputDeserializer;
+import org.apache.flink.core.memory.DataInputDeserializer;
 import org.apache.flink.util.StringUtils;
 
 import java.io.BufferedInputStream;
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/dump/MetricDumpSerialization.java b/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/dump/MetricDumpSerialization.java
index 1791fe1039c..d821e0fdd69 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/dump/MetricDumpSerialization.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/dump/MetricDumpSerialization.java
@@ -19,15 +19,15 @@
 package org.apache.flink.runtime.metrics.dump;
 
 import org.apache.flink.api.java.tuple.Tuple2;
+import org.apache.flink.core.memory.DataInputDeserializer;
 import org.apache.flink.core.memory.DataInputView;
+import org.apache.flink.core.memory.DataOutputSerializer;
 import org.apache.flink.metrics.Counter;
 import org.apache.flink.metrics.Gauge;
 import org.apache.flink.metrics.Histogram;
 import org.apache.flink.metrics.HistogramStatistics;
 import org.apache.flink.metrics.Meter;
 import org.apache.flink.metrics.Metric;
-import org.apache.flink.runtime.util.DataInputDeserializer;
-import org.apache.flink.runtime.util.DataOutputSerializer;
 import org.apache.flink.util.Preconditions;
 
 import org.slf4j.Logger;
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/util/DataInputDeserializer.java b/flink-runtime/src/main/java/org/apache/flink/runtime/util/DataInputDeserializer.java
deleted file mode 100644
index 4e8871a86d7..00000000000
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/util/DataInputDeserializer.java
+++ /dev/null
@@ -1,390 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.flink.runtime.util;
-
-import java.io.EOFException;
-import java.io.IOException;
-import java.io.UTFDataFormatException;
-import java.nio.ByteBuffer;
-import java.nio.ByteOrder;
-
-import org.apache.flink.core.memory.DataInputView;
-import org.apache.flink.core.memory.MemoryUtils;
-
-/**
- * A simple and efficient deserializer for the {@link java.io.DataInput} interface.
- */
-public class DataInputDeserializer implements DataInputView, java.io.Serializable {
-	
-	private static final long serialVersionUID = 1L;
-
-	// ------------------------------------------------------------------------
-	
-	private byte[] buffer;
-	
-	private int end;
-
-	private int position;
-
-	// ------------------------------------------------------------------------
-	
-	public DataInputDeserializer() {}
-
-	public DataInputDeserializer(byte[] buffer) {
-		setBuffer(buffer, 0, buffer.length);
-	}
-
-	public DataInputDeserializer(byte[] buffer, int start, int len) {
-		setBuffer(buffer, start, len);
-	}
-	
-	public DataInputDeserializer(ByteBuffer buffer) {
-		setBuffer(buffer);
-	}
-
-	// ------------------------------------------------------------------------
-	//  Changing buffers
-	// ------------------------------------------------------------------------
-	
-	public void setBuffer(ByteBuffer buffer) {
-		if (buffer.hasArray()) {
-			this.buffer = buffer.array();
-			this.position = buffer.arrayOffset() + buffer.position();
-			this.end = this.position + buffer.remaining();
-		} else if (buffer.isDirect()) {
-			this.buffer = new byte[buffer.remaining()];
-			this.position = 0;
-			this.end = this.buffer.length;
-
-			buffer.get(this.buffer);
-		} else {
-			throw new IllegalArgumentException("The given buffer is neither an array-backed heap ByteBuffer, nor a direct ByteBuffer.");
-		}
-	}
-
-	public void setBuffer(byte[] buffer, int start, int len) {
-		if (buffer == null) {
-			throw new NullPointerException();
-		}
-
-		if (start < 0 || len < 0 || start + len > buffer.length) {
-			throw new IllegalArgumentException();
-		}
-
-		this.buffer = buffer;
-		this.position = start;
-		this.end = start + len;
-	}
-	
-	public void releaseArrays() {
-		this.buffer = null;
-	}
-
-	// ----------------------------------------------------------------------------------------
-	//                               Data Input
-	// ----------------------------------------------------------------------------------------
-
-	public int available() {
-		if (position < end) {
-			return end - position;
-		} else {
-			return 0;
-		}
-	}
-	
-	@Override
-	public boolean readBoolean() throws IOException {
-		if (this.position < this.end) {
-			return this.buffer[this.position++] != 0;
-		} else {
-			throw new EOFException();
-		}
-	}
-
-	@Override
-	public byte readByte() throws IOException {
-		if (this.position < this.end) {
-			return this.buffer[this.position++];
-		} else {
-			throw new EOFException();
-		}
-	}
-
-	@Override
-	public char readChar() throws IOException {
-		if (this.position < this.end - 1) {
-			return (char) (((this.buffer[this.position++] & 0xff) << 8) | (this.buffer[this.position++] & 0xff));
-		} else {
-			throw new EOFException();
-		}
-	}
-
-	@Override
-	public double readDouble() throws IOException {
-		return Double.longBitsToDouble(readLong());
-	}
-
-	@Override
-	public float readFloat() throws IOException {
-		return Float.intBitsToFloat(readInt());
-	}
-
-	@Override
-	public void readFully(byte[] b) throws IOException {
-		readFully(b, 0, b.length);
-	}
-
-	@Override
-	public void readFully(byte[] b, int off, int len) throws IOException {
-		if (len >= 0) {
-			if (off <= b.length - len) {
-				if (this.position <= this.end - len) {
-					System.arraycopy(this.buffer, position, b, off, len);
-					position += len;
-				} else {
-					throw new EOFException();
-				}
-			} else {
-				throw new ArrayIndexOutOfBoundsException();
-			}
-		} else if (len < 0) {
-			throw new IllegalArgumentException("Length may not be negative.");
-		}
-	}
-
-	@Override
-	public int readInt() throws IOException {
-		if (this.position >= 0 && this.position < this.end - 3) {
-			@SuppressWarnings("restriction")
-			int value = UNSAFE.getInt(this.buffer, BASE_OFFSET + this.position);
-			if (LITTLE_ENDIAN) {
-				value = Integer.reverseBytes(value);
-			}
-			
-			this.position += 4;
-			return value;
-		} else {
-			throw new EOFException();
-		}
-	}
-
-	@Override
-	public String readLine() throws IOException {
-		if (this.position < this.end) {
-			// read until a newline is found
-			StringBuilder bld = new StringBuilder();
-			char curr = (char) readUnsignedByte();
-			while (position < this.end && curr != '\n') {
-				bld.append(curr);
-				curr = (char) readUnsignedByte();
-			}
-			// trim a trailing carriage return
-			int len = bld.length();
-			if (len > 0 && bld.charAt(len - 1) == '\r') {
-				bld.setLength(len - 1);
-			}
-			String s = bld.toString();
-			bld.setLength(0);
-			return s;
-		} else {
-			return null;
-		}
-	}
-
-	@Override
-	public long readLong() throws IOException {
-		if (position >= 0 && position < this.end - 7) {
-			@SuppressWarnings("restriction")
-			long value = UNSAFE.getLong(this.buffer, BASE_OFFSET + this.position);
-			if (LITTLE_ENDIAN) {
-				value = Long.reverseBytes(value);
-			}
-			this.position += 8;
-			return value;
-		} else {
-			throw new EOFException();
-		}
-	}
-
-	@Override
-	public short readShort() throws IOException {
-		if (position >= 0 && position < this.end - 1) {
-			return (short) ((((this.buffer[position++]) & 0xff) << 8) | ((this.buffer[position++]) & 0xff));
-		} else {
-			throw new EOFException();
-		}
-	}
-
-	@Override
-	public String readUTF() throws IOException {
-		int utflen = readUnsignedShort();
-		byte[] bytearr = new byte[utflen];
-		char[] chararr = new char[utflen];
-
-		int c, char2, char3;
-		int count = 0;
-		int chararr_count = 0;
-
-		readFully(bytearr, 0, utflen);
-
-		while (count < utflen) {
-			c = (int) bytearr[count] & 0xff;
-			if (c > 127) {
-				break;
-			}
-			count++;
-			chararr[chararr_count++] = (char) c;
-		}
-
-		while (count < utflen) {
-			c = (int) bytearr[count] & 0xff;
-			switch (c >> 4) {
-			case 0:
-			case 1:
-			case 2:
-			case 3:
-			case 4:
-			case 5:
-			case 6:
-			case 7:
-				/* 0xxxxxxx */
-				count++;
-				chararr[chararr_count++] = (char) c;
-				break;
-			case 12:
-			case 13:
-				/* 110x xxxx 10xx xxxx */
-				count += 2;
-				if (count > utflen) {
-					throw new UTFDataFormatException("malformed input: partial character at end");
-				}
-				char2 = (int) bytearr[count - 1];
-				if ((char2 & 0xC0) != 0x80) {
-					throw new UTFDataFormatException("malformed input around byte " + count);
-				}
-				chararr[chararr_count++] = (char) (((c & 0x1F) << 6) | (char2 & 0x3F));
-				break;
-			case 14:
-				/* 1110 xxxx 10xx xxxx 10xx xxxx */
-				count += 3;
-				if (count > utflen) {
-					throw new UTFDataFormatException("malformed input: partial character at end");
-				}
-				char2 = (int) bytearr[count - 2];
-				char3 = (int) bytearr[count - 1];
-				if (((char2 & 0xC0) != 0x80) || ((char3 & 0xC0) != 0x80)) {
-					throw new UTFDataFormatException("malformed input around byte " + (count - 1));
-				}
-				chararr[chararr_count++] = (char) (((c & 0x0F) << 12) | ((char2 & 0x3F) << 6) | (char3 & 0x3F));
-				break;
-			default:
-				/* 10xx xxxx, 1111 xxxx */
-				throw new UTFDataFormatException("malformed input around byte " + count);
-			}
-		}
-		// The number of chars produced may be less than utflen
-		return new String(chararr, 0, chararr_count);
-	}
-
-	@Override
-	public int readUnsignedByte() throws IOException {
-		if (this.position < this.end) {
-			return (this.buffer[this.position++] & 0xff);
-		} else {
-			throw new EOFException();
-		}
-	}
-
-	@Override
-	public int readUnsignedShort() throws IOException {
-		if (this.position < this.end - 1) {
-			return ((this.buffer[this.position++] & 0xff) << 8) | (this.buffer[this.position++] & 0xff);
-		} else {
-			throw new EOFException();
-		}
-	}
-	
-	@Override
-	public int skipBytes(int n) throws IOException {
-		if (this.position <= this.end - n) {
-			this.position += n;
-			return n;
-		} else {
-			n = this.end - this.position;
-			this.position = this.end;
-			return n;
-		}
-	}
-
-	@Override
-	public void skipBytesToRead(int numBytes) throws IOException {
-		int skippedBytes = skipBytes(numBytes);
-
-		if (skippedBytes < numBytes){
-			throw new EOFException("Could not skip " + numBytes +" bytes.");
-		}
-	}
-
-	@Override
-	public int read(byte[] b, int off, int len) throws IOException {
-		if (b == null){
-			throw new NullPointerException("Byte array b cannot be null.");
-		}
-
-		if (off < 0){
-			throw new IndexOutOfBoundsException("Offset cannot be negative.");
-		}
-
-		if (len < 0){
-			throw new IndexOutOfBoundsException("Length cannot be negative.");
-		}
-
-		if (b.length - off < len){
-			throw new IndexOutOfBoundsException("Byte array does not provide enough space to store requested data" +
-					".");
-		}
-
-		if (this.position >= this.end) {
-			return -1;
-		} else {
-			int toRead = Math.min(this.end-this.position, len);
-			System.arraycopy(this.buffer,this.position,b,off,toRead);
-			this.position += toRead;
-
-			return toRead;
-		}
-	}
-
-	@Override
-	public int read(byte[] b) throws IOException {
-		return read(b, 0, b.length);
-	}
-
-	// ------------------------------------------------------------------------
-	//  Utilities
-	// ------------------------------------------------------------------------
-
-	@SuppressWarnings("restriction")
-	private static final sun.misc.Unsafe UNSAFE = MemoryUtils.UNSAFE;
-
-	@SuppressWarnings("restriction")
-	private static final long BASE_OFFSET = UNSAFE.arrayBaseOffset(byte[].class);
-
-	private static final boolean LITTLE_ENDIAN = (MemoryUtils.NATIVE_BYTE_ORDER == ByteOrder.LITTLE_ENDIAN);
-}
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/util/DataOutputSerializer.java b/flink-runtime/src/main/java/org/apache/flink/runtime/util/DataOutputSerializer.java
deleted file mode 100644
index 4f1cf77d054..00000000000
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/util/DataOutputSerializer.java
+++ /dev/null
@@ -1,342 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.flink.runtime.util;
-
-import org.apache.flink.core.memory.DataInputView;
-import org.apache.flink.core.memory.DataOutputView;
-import org.apache.flink.core.memory.MemoryUtils;
-
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-
-import java.io.EOFException;
-import java.io.IOException;
-import java.io.UTFDataFormatException;
-import java.nio.ByteBuffer;
-import java.nio.ByteOrder;
-import java.util.Arrays;
-
-/**
- * A simple and efficient serializer for the {@link java.io.DataOutput} interface.
- */
-public class DataOutputSerializer implements DataOutputView {
-	
-	private static final Logger LOG = LoggerFactory.getLogger(DataOutputSerializer.class);
-	
-	private static final int PRUNE_BUFFER_THRESHOLD = 5 * 1024 * 1024;
-
-	// ------------------------------------------------------------------------
-	
-	private final byte[] startBuffer;
-	
-	private byte[] buffer;
-	
-	private int position;
-
-	private ByteBuffer wrapper;
-
-	// ------------------------------------------------------------------------
-	
-	public DataOutputSerializer(int startSize) {
-		if (startSize < 1) {
-			throw new IllegalArgumentException();
-		}
-
-		this.startBuffer = new byte[startSize];
-		this.buffer = this.startBuffer;
-		this.wrapper = ByteBuffer.wrap(buffer);
-	}
-	
-	public ByteBuffer wrapAsByteBuffer() {
-		this.wrapper.position(0);
-		this.wrapper.limit(this.position);
-		return this.wrapper;
-	}
-
-	public byte[] getByteArray() {
-		return buffer;
-	}
-	
-	public byte[] getCopyOfBuffer() {
-		return Arrays.copyOf(buffer, position);
-	}
-
-	public void clear() {
-		this.position = 0;
-	}
-
-	public int length() {
-		return this.position;
-	}
-	
-	public void pruneBuffer() {
-		if (this.buffer.length > PRUNE_BUFFER_THRESHOLD) {
-			if (LOG.isDebugEnabled()) {
-				LOG.debug("Releasing serialization buffer of " + this.buffer.length + " bytes.");
-			}
-			
-			this.buffer = this.startBuffer;
-			this.wrapper = ByteBuffer.wrap(this.buffer);
-		}
-	}
-
-	@Override
-	public String toString() {
-		return String.format("[pos=%d cap=%d]", this.position, this.buffer.length);
-	}
-
-	// ----------------------------------------------------------------------------------------
-	//                               Data Output
-	// ----------------------------------------------------------------------------------------
-	
-	@Override
-	public void write(int b) throws IOException {
-		if (this.position >= this.buffer.length) {
-			resize(1);
-		}
-		this.buffer[this.position++] = (byte) (b & 0xff);
-	}
-
-	@Override
-	public void write(byte[] b) throws IOException {
-		write(b, 0, b.length);
-	}
-
-	@Override
-	public void write(byte[] b, int off, int len) throws IOException {
-		if (len < 0 || off > b.length - len) {
-			throw new ArrayIndexOutOfBoundsException();
-		}
-		if (this.position > this.buffer.length - len) {
-			resize(len);
-		}
-		System.arraycopy(b, off, this.buffer, this.position, len);
-		this.position += len;
-	}
-
-	@Override
-	public void writeBoolean(boolean v) throws IOException {
-		write(v ? 1 : 0);
-	}
-
-	@Override
-	public void writeByte(int v) throws IOException {
-		write(v);
-	}
-
-	@Override
-	public void writeBytes(String s) throws IOException {
-		final int sLen = s.length();
-		if (this.position >= this.buffer.length - sLen) {
-			resize(sLen);
-		}
-		
-		for (int i = 0; i < sLen; i++) {
-			writeByte(s.charAt(i));
-		}
-		this.position += sLen;
-	}
-
-	@Override
-	public void writeChar(int v) throws IOException {
-		if (this.position >= this.buffer.length - 1) {
-			resize(2);
-		}
-		this.buffer[this.position++] = (byte) (v >> 8);
-		this.buffer[this.position++] = (byte) v;
-	}
-
-	@Override
-	public void writeChars(String s) throws IOException {
-		final int sLen = s.length();
-		if (this.position >= this.buffer.length - 2*sLen) {
-			resize(2*sLen);
-		} 
-		for (int i = 0; i < sLen; i++) {
-			writeChar(s.charAt(i));
-		}
-	}
-
-	@Override
-	public void writeDouble(double v) throws IOException {
-		writeLong(Double.doubleToLongBits(v));
-	}
-
-	@Override
-	public void writeFloat(float v) throws IOException {
-		writeInt(Float.floatToIntBits(v));
-	}
-
-	@SuppressWarnings("restriction")
-	@Override
-	public void writeInt(int v) throws IOException {
-		if (this.position >= this.buffer.length - 3) {
-			resize(4);
-		}
-		if (LITTLE_ENDIAN) {
-			v = Integer.reverseBytes(v);
-		}			
-		UNSAFE.putInt(this.buffer, BASE_OFFSET + this.position, v);
-		this.position += 4;
-	}
-
-	@SuppressWarnings("restriction")
-	@Override
-	public void writeLong(long v) throws IOException {
-		if (this.position >= this.buffer.length - 7) {
-			resize(8);
-		}
-		if (LITTLE_ENDIAN) {
-			v = Long.reverseBytes(v);
-		}
-		UNSAFE.putLong(this.buffer, BASE_OFFSET + this.position, v);
-		this.position += 8;
-	}
-
-	@Override
-	public void writeShort(int v) throws IOException {
-		if (this.position >= this.buffer.length - 1) {
-			resize(2);
-		}
-		this.buffer[this.position++] = (byte) ((v >>> 8) & 0xff);
-		this.buffer[this.position++] = (byte) ((v >>> 0) & 0xff);
-	}
-
-	@Override
-	public void writeUTF(String str) throws IOException {
-		int strlen = str.length();
-		int utflen = 0;
-		int c;
-
-		/* use charAt instead of copying String to char array */
-		for (int i = 0; i < strlen; i++) {
-			c = str.charAt(i);
-			if ((c >= 0x0001) && (c <= 0x007F)) {
-				utflen++;
-			} else if (c > 0x07FF) {
-				utflen += 3;
-			} else {
-				utflen += 2;
-			}
-		}
-
-		if (utflen > 65535) {
-			throw new UTFDataFormatException("Encoded string is too long: " + utflen);
-		}
-		else if (this.position > this.buffer.length - utflen - 2) {
-			resize(utflen + 2);
-		}
-		
-		byte[] bytearr = this.buffer;
-		int count = this.position;
-
-		bytearr[count++] = (byte) ((utflen >>> 8) & 0xFF);
-		bytearr[count++] = (byte) ((utflen >>> 0) & 0xFF);
-
-		int i = 0;
-		for (i = 0; i < strlen; i++) {
-			c = str.charAt(i);
-			if (!((c >= 0x0001) && (c <= 0x007F))) {
-				break;
-			}
-			bytearr[count++] = (byte) c;
-		}
-
-		for (; i < strlen; i++) {
-			c = str.charAt(i);
-			if ((c >= 0x0001) && (c <= 0x007F)) {
-				bytearr[count++] = (byte) c;
-
-			} else if (c > 0x07FF) {
-				bytearr[count++] = (byte) (0xE0 | ((c >> 12) & 0x0F));
-				bytearr[count++] = (byte) (0x80 | ((c >> 6) & 0x3F));
-				bytearr[count++] = (byte) (0x80 | ((c >> 0) & 0x3F));
-			} else {
-				bytearr[count++] = (byte) (0xC0 | ((c >> 6) & 0x1F));
-				bytearr[count++] = (byte) (0x80 | ((c >> 0) & 0x3F));
-			}
-		}
-
-		this.position = count;
-	}
-	
-	
-	private void resize(int minCapacityAdd) throws IOException {
-		int newLen = Math.max(this.buffer.length * 2, this.buffer.length + minCapacityAdd);
-		byte[] nb;
-		try {
-			nb = new byte[newLen];
-		}
-		catch (NegativeArraySizeException e) {
-			throw new IOException("Serialization failed because the record length would exceed 2GB (max addressable array size in Java).");
-		}
-		catch (OutOfMemoryError e) {
-			// this was too large to allocate, try the smaller size (if possible)
-			if (newLen > this.buffer.length + minCapacityAdd) {
-				newLen = this.buffer.length + minCapacityAdd;
-				try {
-					nb = new byte[newLen];
-				}
-				catch (OutOfMemoryError ee) {
-					// still not possible. give an informative exception message that reports the size
-					throw new IOException("Failed to serialize element. Serialized size (> "
-							+ newLen + " bytes) exceeds JVM heap space", ee);
-				}
-			} else {
-				throw new IOException("Failed to serialize element. Serialized size (> "
-						+ newLen + " bytes) exceeds JVM heap space", e);
-			}
-		}
-
-		System.arraycopy(this.buffer, 0, nb, 0, this.position);
-		this.buffer = nb;
-		this.wrapper = ByteBuffer.wrap(this.buffer);
-	}
-
-	@Override
-	public void skipBytesToWrite(int numBytes) throws IOException {
-		if(buffer.length - this.position < numBytes){
-			throw new EOFException("Could not skip " + numBytes + " bytes.");
-		}
-
-		this.position += numBytes;
-	}
-
-	@Override
-	public void write(DataInputView source, int numBytes) throws IOException {
-		if(buffer.length - this.position < numBytes){
-			throw new EOFException("Could not write " + numBytes + " bytes. Buffer overflow.");
-		}
-
-		source.readFully(this.buffer, this.position, numBytes);
-		this.position += numBytes;
-	}
-
-	// ------------------------------------------------------------------------
-	//  Utilities
-	// ------------------------------------------------------------------------
-
-	@SuppressWarnings("restriction")
-	private static final sun.misc.Unsafe UNSAFE = MemoryUtils.UNSAFE;
-
-	@SuppressWarnings("restriction")
-	private static final long BASE_OFFSET = UNSAFE.arrayBaseOffset(byte[].class);
-
-	private static final boolean LITTLE_ENDIAN = (MemoryUtils.NATIVE_BYTE_ORDER == ByteOrder.LITTLE_ENDIAN);
-}
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/CheckpointBarrierTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/CheckpointBarrierTest.java
index c8bffb5df80..7e652ad49de 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/CheckpointBarrierTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/CheckpointBarrierTest.java
@@ -19,8 +19,8 @@
 package org.apache.flink.runtime.io.network.api;
 
 import org.apache.flink.runtime.checkpoint.CheckpointOptions;
-import org.apache.flink.runtime.util.DataInputDeserializer;
-import org.apache.flink.runtime.util.DataOutputSerializer;
+import org.apache.flink.core.memory.DataInputDeserializer;
+import org.apache.flink.core.memory.DataOutputSerializer;
 
 import org.junit.Test;
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/PagedViewsTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/PagedViewsTest.java
index 8455402eb35..aad7ee1006c 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/PagedViewsTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/PagedViewsTest.java
@@ -20,9 +20,9 @@ package org.apache.flink.runtime.io.network.api.serialization;
 
 import org.apache.flink.core.memory.MemorySegment;
 import org.apache.flink.core.memory.MemorySegmentFactory;
-import org.apache.flink.runtime.io.network.api.serialization.types.SerializationTestType;
-import org.apache.flink.runtime.io.network.api.serialization.types.SerializationTestTypeFactory;
-import org.apache.flink.runtime.io.network.api.serialization.types.Util;
+import org.apache.flink.testutils.serialization.types.SerializationTestType;
+import org.apache.flink.testutils.serialization.types.SerializationTestTypeFactory;
+import org.apache.flink.testutils.serialization.types.Util;
 import org.apache.flink.runtime.memory.AbstractPagedInputView;
 import org.apache.flink.runtime.memory.AbstractPagedOutputView;
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializationTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializationTest.java
index 9d0ee67134f..f988c555a7e 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializationTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializationTest.java
@@ -20,9 +20,9 @@ package org.apache.flink.runtime.io.network.api.serialization;
 
 import org.apache.flink.core.memory.MemorySegment;
 import org.apache.flink.core.memory.MemorySegmentFactory;
-import org.apache.flink.runtime.io.network.api.serialization.types.SerializationTestType;
-import org.apache.flink.runtime.io.network.api.serialization.types.SerializationTestTypeFactory;
-import org.apache.flink.runtime.io.network.api.serialization.types.Util;
+import org.apache.flink.testutils.serialization.types.SerializationTestType;
+import org.apache.flink.testutils.serialization.types.SerializationTestTypeFactory;
+import org.apache.flink.testutils.serialization.types.Util;
 import org.apache.flink.runtime.io.network.buffer.Buffer;
 import org.apache.flink.runtime.io.network.buffer.BufferRecycler;
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializerTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializerTest.java
index b7bcb3e6b16..fe9a386c2c9 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializerTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/api/serialization/SpanningRecordSerializerTest.java
@@ -22,9 +22,9 @@ import org.apache.flink.core.memory.DataInputView;
 import org.apache.flink.core.memory.DataOutputView;
 import org.apache.flink.core.memory.MemorySegment;
 import org.apache.flink.core.memory.MemorySegmentFactory;
-import org.apache.flink.runtime.io.network.api.serialization.types.SerializationTestType;
-import org.apache.flink.runtime.io.network.api.serialization.types.SerializationTestTypeFactory;
-import org.apache.flink.runtime.io.network.api.serialization.types.Util;
+import org.apache.flink.testutils.serialization.types.SerializationTestType;
+import org.apache.flink.testutils.serialization.types.SerializationTestTypeFactory;
+import org.apache.flink.testutils.serialization.types.Util;
 import org.apache.flink.runtime.io.network.buffer.Buffer;
 import org.apache.flink.runtime.io.network.buffer.BufferRecycler;
 import org.junit.Assert;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/serialization/LargeRecordsTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/serialization/LargeRecordsTest.java
index 25523db2d20..d596863feba 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/serialization/LargeRecordsTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/serialization/LargeRecordsTest.java
@@ -24,8 +24,8 @@ import org.apache.flink.runtime.io.network.api.serialization.AdaptiveSpanningRec
 import org.apache.flink.runtime.io.network.api.serialization.RecordDeserializer;
 import org.apache.flink.runtime.io.network.api.serialization.RecordSerializer;
 import org.apache.flink.runtime.io.network.api.serialization.SpanningRecordSerializer;
-import org.apache.flink.runtime.io.network.api.serialization.types.IntType;
-import org.apache.flink.runtime.io.network.api.serialization.types.SerializationTestType;
+import org.apache.flink.testutils.serialization.types.IntType;
+import org.apache.flink.testutils.serialization.types.SerializationTestType;
 import org.apache.flink.runtime.io.network.buffer.Buffer;
 import org.apache.flink.runtime.io.network.buffer.BufferRecycler;
 import org.apache.flink.runtime.io.network.serialization.types.LargeObjectType;
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/serialization/types/LargeObjectType.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/serialization/types/LargeObjectType.java
index 21be6e4e5f0..8efd2bb7021 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/serialization/types/LargeObjectType.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/serialization/types/LargeObjectType.java
@@ -24,7 +24,7 @@ import java.util.Random;
 
 import org.apache.flink.core.memory.DataInputView;
 import org.apache.flink.core.memory.DataOutputView;
-import org.apache.flink.runtime.io.network.api.serialization.types.SerializationTestType;
+import org.apache.flink.testutils.serialization.types.SerializationTestType;
 
 public class LargeObjectType implements SerializationTestType {
 
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/SerializedCheckpointData.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/SerializedCheckpointData.java
index 26cc5ad6811..1a8bc58f7bc 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/SerializedCheckpointData.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/SerializedCheckpointData.java
@@ -20,8 +20,8 @@ package org.apache.flink.streaming.api.functions.source;
 
 import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.java.tuple.Tuple2;
-import org.apache.flink.runtime.util.DataInputDeserializer;
-import org.apache.flink.runtime.util.DataOutputSerializer;
+import org.apache.flink.core.memory.DataInputDeserializer;
+import org.apache.flink.core.memory.DataOutputSerializer;
 
 import java.io.IOException;
 import java.util.ArrayDeque;
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/util/serialization/TypeInformationSerializationSchema.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/util/serialization/TypeInformationSerializationSchema.java
index b187b041f72..1c50dc2987f 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/util/serialization/TypeInformationSerializationSchema.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/util/serialization/TypeInformationSerializationSchema.java
@@ -22,8 +22,8 @@ import org.apache.flink.annotation.Public;
 import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
-import org.apache.flink.runtime.util.DataInputDeserializer;
-import org.apache.flink.runtime.util.DataOutputSerializer;
+import org.apache.flink.core.memory.DataInputDeserializer;
+import org.apache.flink.core.memory.DataOutputSerializer;
 
 import java.io.IOException;
 
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/streamrecord/StreamElementSerializerTest.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/streamrecord/StreamElementSerializerTest.java
index 79b2b75c360..4a993179793 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/streamrecord/StreamElementSerializerTest.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/streamrecord/StreamElementSerializerTest.java
@@ -21,8 +21,8 @@ package org.apache.flink.streaming.runtime.streamrecord;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.common.typeutils.base.LongSerializer;
 import org.apache.flink.api.common.typeutils.base.StringSerializer;
-import org.apache.flink.runtime.util.DataInputDeserializer;
-import org.apache.flink.runtime.util.DataOutputSerializer;
+import org.apache.flink.core.memory.DataInputDeserializer;
+import org.apache.flink.core.memory.DataOutputSerializer;
 import org.apache.flink.streaming.api.watermark.Watermark;
 
 import org.junit.Test;
