diff --git a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnResourceManager.java b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnResourceManager.java
index a3427277de8..ec76acc6d1a 100755
--- a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnResourceManager.java
+++ b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnResourceManager.java
@@ -417,10 +417,21 @@ public class YarnResourceManager extends ResourceManager<YarnWorkerNode> impleme
 
 			nodeManagerClient.startContainerAsync(container, taskExecutorLaunchContext);
 		} catch (Throwable t) {
-			onStartContainerError(container.getId(), t);
+			releaseFailedContainerAndRequestNewContainerIfRequired(container.getId(), t);
 		}
 	}
 
+	private void releaseFailedContainerAndRequestNewContainerIfRequired(ContainerId containerId, Throwable throwable) {
+		log.error("Could not start TaskManager in container {}.", containerId, throwable);
+
+		final ResourceID resourceId = new ResourceID(containerId.toString());
+		// release the failed container
+		workerNodeMap.remove(resourceId);
+		resourceManagerClient.releaseAssignedContainer(containerId);
+		// and ask for a new one
+		requestYarnContainerIfRequired();
+	}
+
 	private void returnExcessContainer(Container excessContainer) {
 		log.info("Returning excess container {}.", excessContainer.getId());
 		resourceManagerClient.releaseAssignedContainer(excessContainer.getId());
@@ -490,15 +501,8 @@ public class YarnResourceManager extends ResourceManager<YarnWorkerNode> impleme
 	}
 
 	@Override
-	public void onStartContainerError(ContainerId containerId, Throwable throwable) {
-		log.error("Could not start TaskManager in container {}.", containerId, throwable);
-
-		final ResourceID resourceId = new ResourceID(containerId.toString());
-		// release the failed container
-		workerNodeMap.remove(resourceId);
-		resourceManagerClient.releaseAssignedContainer(containerId);
-		// and ask for a new one
-		requestYarnContainerIfRequired();
+	public void onStartContainerError(ContainerId containerId, Throwable t) {
+		runAsync(() -> releaseFailedContainerAndRequestNewContainerIfRequired(containerId, t));
 	}
 
 	@Override
diff --git a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnResourceManagerTest.java b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnResourceManagerTest.java
index 9f4716f03da..a705eb8b93f 100755
--- a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnResourceManagerTest.java
+++ b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnResourceManagerTest.java
@@ -89,6 +89,7 @@ import java.util.HashMap;
 import java.util.Map;
 import java.util.concurrent.Callable;
 import java.util.concurrent.CompletableFuture;
+import java.util.concurrent.ExecutionException;
 import java.util.concurrent.TimeUnit;
 
 import static org.apache.flink.configuration.GlobalConfiguration.FLINK_CONF_FILENAME;
@@ -170,6 +171,11 @@ public class YarnResourceManagerTest extends TestLogger {
 	static class TestingYarnResourceManager extends YarnResourceManager {
 		AMRMClientAsync<AMRMClient.ContainerRequest> mockResourceManagerClient;
 		NMClientAsync mockNMClient;
+		/**
+		 * When runAsync is called, runAsyncCalledNum will increase one. This variable could be used to check whether
+		 * callback methods of AMRMClientAsync and NMClientAsync are executed in ResourceManager's main thread.
+		 */
+		int runAsyncCalledNum;
 
 		TestingYarnResourceManager(
 				RpcService rpcService,
@@ -203,6 +209,7 @@ public class YarnResourceManagerTest extends TestLogger {
 				resourceManagerMetricGroup);
 			this.mockNMClient = mockNMClient;
 			this.mockResourceManagerClient = mockResourceManagerClient;
+			this.runAsyncCalledNum = 0;
 		}
 
 		<T> CompletableFuture<T> runInMainThread(Callable<T> callable) {
@@ -228,6 +235,7 @@ public class YarnResourceManagerTest extends TestLogger {
 
 		@Override
 		protected void runAsync(final Runnable runnable) {
+			runAsyncCalledNum++;
 			runnable.run();
 		}
 
@@ -370,14 +378,7 @@ public class YarnResourceManagerTest extends TestLogger {
 		new Context() {{
 			runTest(() -> {
 				// Request slot from SlotManager.
-				CompletableFuture<?> registerSlotRequestFuture = resourceManager.runInMainThread(() -> {
-					rmServices.slotManager.registerSlotRequest(
-						new SlotRequest(new JobID(), new AllocationID(), resourceProfile1, taskHost));
-					return null;
-				});
-
-				// wait for the registerSlotRequest completion
-				registerSlotRequestFuture.get();
+				registerSlotRequest(resourceManager, rmServices, resourceProfile1, taskHost);
 
 				// Callback from YARN when container is allocated.
 				Container testingContainer = mockContainer("container", 1234, 1, resourceManager.getContainerResource());
@@ -473,14 +474,7 @@ public class YarnResourceManagerTest extends TestLogger {
 	public void testOnContainerCompleted() throws Exception {
 		new Context() {{
 			runTest(() -> {
-				CompletableFuture<?> registerSlotRequestFuture = resourceManager.runInMainThread(() -> {
-					rmServices.slotManager.registerSlotRequest(
-						new SlotRequest(new JobID(), new AllocationID(), resourceProfile1, taskHost));
-					return null;
-				});
-
-				// wait for the registerSlotRequest completion
-				registerSlotRequestFuture.get();
+				registerSlotRequest(resourceManager, rmServices, resourceProfile1, taskHost);
 
 				// Callback from YARN when container is allocated.
 				Container testingContainer = mockContainer("container", 1234, 1, resourceManager.getContainerResource());
@@ -504,7 +498,49 @@ public class YarnResourceManagerTest extends TestLogger {
 				// slot is already fulfilled by pending containers, no need to request new container.
 				resourceManager.onContainersCompleted(ImmutableList.of(testingContainerStatus));
 				verify(mockResourceManagerClient, times(2)).addContainerRequest(any(AMRMClient.ContainerRequest.class));
+
+				assertEquals(3, resourceManager.runAsyncCalledNum);
+			});
+		}};
+	}
+
+	@Test
+	public void testOnStartContainerError() throws Exception {
+		new Context() {{
+			runTest(() -> {
+				registerSlotRequest(resourceManager, rmServices, resourceProfile1, taskHost);
+				Container testingContainer = mockContainer("container", 1234, 1, resourceManager.getContainerResource());
+
+				doReturn(Collections.singletonList(Collections.singletonList(resourceManager.getContainerRequest())))
+					.when(mockResourceManagerClient).getMatchingRequests(any(Priority.class), anyString(), any(Resource.class));
+
+				resourceManager.onContainersAllocated(ImmutableList.of(testingContainer));
+				verify(mockResourceManagerClient).addContainerRequest(any(AMRMClient.ContainerRequest.class));
+				verify(mockResourceManagerClient).removeContainerRequest(any(AMRMClient.ContainerRequest.class));
+				verify(mockNMClient).startContainerAsync(eq(testingContainer), any(ContainerLaunchContext.class));
+
+				resourceManager.onStartContainerError(testingContainer.getId(), new Exception("start error"));
+				verify(mockResourceManagerClient).releaseAssignedContainer(testingContainer.getId());
+				verify(mockResourceManagerClient, times(2)).addContainerRequest(any(AMRMClient.ContainerRequest.class));
+
+				assertEquals(2, resourceManager.runAsyncCalledNum);
 			});
 		}};
 	}
+
+	private void registerSlotRequest(
+			TestingYarnResourceManager resourceManager,
+			MockResourceManagerRuntimeServices rmServices,
+			ResourceProfile resourceProfile,
+			String taskHost) throws ExecutionException, InterruptedException {
+
+		CompletableFuture<?> registerSlotRequestFuture = resourceManager.runInMainThread(() -> {
+			rmServices.slotManager.registerSlotRequest(
+				new SlotRequest(new JobID(), new AllocationID(), resourceProfile, taskHost));
+			return null;
+		});
+
+		// wait for the registerSlotRequest completion
+		registerSlotRequestFuture.get();
+	}
 }
