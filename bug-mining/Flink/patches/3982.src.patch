diff --git a/flink-core/src/main/java/org/apache/flink/core/fs/EntropyInjector.java b/flink-core/src/main/java/org/apache/flink/core/fs/EntropyInjector.java
index 0fba138d71f..fb4900833d9 100644
--- a/flink-core/src/main/java/org/apache/flink/core/fs/EntropyInjector.java
+++ b/flink-core/src/main/java/org/apache/flink/core/fs/EntropyInjector.java
@@ -99,6 +99,13 @@ public class EntropyInjector {
 			if (delegate instanceof EntropyInjectingFileSystem) {
 				return (EntropyInjectingFileSystem) delegate;
 			}
+			else if (delegate instanceof PluginFileSystemFactory.ClassLoaderFixingFileSystem) {
+				FileSystem innerFs = ((PluginFileSystemFactory.ClassLoaderFixingFileSystem) delegate).getInner();
+				if (innerFs instanceof EntropyInjectingFileSystem) {
+					return (EntropyInjectingFileSystem) innerFs;
+				}
+				return null;
+			}
 			else {
 				return null;
 			}
diff --git a/flink-core/src/main/java/org/apache/flink/core/fs/PluginFileSystemFactory.java b/flink-core/src/main/java/org/apache/flink/core/fs/PluginFileSystemFactory.java
index 0d27fd8831f..828d12ec161 100644
--- a/flink-core/src/main/java/org/apache/flink/core/fs/PluginFileSystemFactory.java
+++ b/flink-core/src/main/java/org/apache/flink/core/fs/PluginFileSystemFactory.java
@@ -62,7 +62,7 @@ public class PluginFileSystemFactory implements FileSystemFactory {
 		}
 	}
 
-	private static class ClassLoaderFixingFileSystem extends FileSystem {
+	static class ClassLoaderFixingFileSystem extends FileSystem {
 		private final FileSystem inner;
 		private final ClassLoader loader;
 
@@ -185,5 +185,9 @@ public class PluginFileSystemFactory implements FileSystemFactory {
 				return inner.rename(src, dst);
 			}
 		}
+
+		public FileSystem getInner() {
+			return inner;
+		}
 	}
 }
diff --git a/flink-core/src/test/java/org/apache/flink/core/fs/EntropyInjectorTest.java b/flink-core/src/test/java/org/apache/flink/core/fs/EntropyInjectorTest.java
index e7c89113248..5c3d2532a8f 100644
--- a/flink-core/src/test/java/org/apache/flink/core/fs/EntropyInjectorTest.java
+++ b/flink-core/src/test/java/org/apache/flink/core/fs/EntropyInjectorTest.java
@@ -27,6 +27,7 @@ import org.junit.rules.TemporaryFolder;
 
 import java.io.File;
 import java.io.IOException;
+import java.net.URI;
 
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertTrue;
@@ -160,6 +161,33 @@ public class EntropyInjectorTest {
 		} catch (IOException ignored) {}
 	}
 
+	@Test
+	public void testClassLoaderFixingFs() throws Exception {
+		final String entropyKey = "__ekey__";
+		final String entropyValue = "abc";
+
+		final File folder = TMP_FOLDER.newFolder();
+
+		final Path path = new Path(Path.fromLocalFile(folder), entropyKey + "/path/");
+		final Path pathWithEntropy = new Path(Path.fromLocalFile(folder), entropyValue + "/path/");
+
+		PluginFileSystemFactory pluginFsFactory = PluginFileSystemFactory.of(
+				new TestFileSystemFactory(entropyKey, entropyValue));
+		FileSystem testFs = pluginFsFactory.create(URI.create("test"));
+
+		FileSystemSafetyNet.initializeSafetyNetForThread();
+		FileSystem fs = FileSystemSafetyNet.wrapWithSafetyNetWhenActivated(testFs);
+		try  {
+			OutputStreamAndPath streamAndPath = EntropyInjector.createEntropyAware(
+					fs, path, WriteMode.NO_OVERWRITE);
+
+			assertEquals(pathWithEntropy, streamAndPath.path());
+		}
+		finally {
+			FileSystemSafetyNet.closeSafetyNetAndGuardedResourcesForThread();
+		}
+	}
+
 	// ------------------------------------------------------------------------
 
 	private static final class TestEntropyInjectingFs extends LocalFileSystem implements EntropyInjectingFileSystem {
@@ -183,4 +211,25 @@ public class EntropyInjectorTest {
 			return entropy;
 		}
 	}
+
+	private static class TestFileSystemFactory implements FileSystemFactory {
+
+		private final String key;
+		private final String entropy;
+
+		TestFileSystemFactory(String key, String entropy) {
+			this.key = key;
+			this.entropy = entropy;
+		}
+
+		@Override
+		public String getScheme() {
+			return null;
+		}
+
+		@Override
+		public FileSystem create(URI fsUri) {
+			return new TestEntropyInjectingFs(key, entropy);
+		}
+	}
 }
