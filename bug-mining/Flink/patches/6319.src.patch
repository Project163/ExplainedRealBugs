diff --git a/flink-connectors/flink-connector-files/src/main/java/org/apache/flink/connector/file/sink/compactor/operator/CompactCoordinator.java b/flink-connectors/flink-connector-files/src/main/java/org/apache/flink/connector/file/sink/compactor/operator/CompactCoordinator.java
index 8509423cae3..c7ab72fcd7c 100644
--- a/flink-connectors/flink-connector-files/src/main/java/org/apache/flink/connector/file/sink/compactor/operator/CompactCoordinator.java
+++ b/flink-connectors/flink-connector-files/src/main/java/org/apache/flink/connector/file/sink/compactor/operator/CompactCoordinator.java
@@ -222,10 +222,6 @@ public class CompactCoordinator extends AbstractStreamOperator<CompactorRequest>
         }
 
         public CompactTriggerResult onElement(FileSinkCommittable committable) {
-            if (threshold < 0) {
-                return CompactTriggerResult.CONTINUE;
-            }
-
             PendingFileRecoverable file = committable.getPendingFile();
             if (file == null) {
                 return CompactTriggerResult.PASS_THROUGH;
@@ -244,6 +240,10 @@ public class CompactCoordinator extends AbstractStreamOperator<CompactorRequest>
                 return CompactTriggerResult.PASS_THROUGH;
             }
 
+            if (threshold < 0) {
+                return CompactTriggerResult.CONTINUE;
+            }
+
             size += curSize;
             return size >= threshold
                     ? CompactTriggerResult.FIRE_AND_PURGE
diff --git a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/BatchCompactingFileSinkITCase.java b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/BatchCompactingFileSinkITCase.java
index 5167e974ab1..0ca6820e446 100644
--- a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/BatchCompactingFileSinkITCase.java
+++ b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/BatchCompactingFileSinkITCase.java
@@ -24,6 +24,7 @@ import org.apache.flink.connector.file.sink.compactor.FileCompactor;
 import org.apache.flink.connector.file.sink.compactor.RecordWiseFileCompactor;
 import org.apache.flink.connector.file.sink.utils.IntegerFileSinkTestDataUtils;
 import org.apache.flink.connector.file.sink.utils.IntegerFileSinkTestDataUtils.IntDecoder;
+import org.apache.flink.connector.file.sink.utils.PartSizeAndCheckpointRollingPolicy;
 import org.apache.flink.core.fs.Path;
 import org.apache.flink.runtime.minicluster.RpcServiceSharing;
 import org.apache.flink.runtime.testutils.MiniClusterResourceConfiguration;
@@ -54,7 +55,7 @@ public class BatchCompactingFileSinkITCase extends BatchExecutionFileSinkITCase
         return FileSink.forRowFormat(new Path(path), new IntegerFileSinkTestDataUtils.IntEncoder())
                 .withBucketAssigner(
                         new IntegerFileSinkTestDataUtils.ModuloBucketAssigner(NUM_BUCKETS))
-                .withRollingPolicy(new PartSizeAndCheckpointRollingPolicy(1024))
+                .withRollingPolicy(new PartSizeAndCheckpointRollingPolicy<>(1024, false))
                 .enableCompact(createFileCompactStrategy(), createFileCompactor())
                 .build();
     }
diff --git a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/FileSinkCompactionSwitchITCase.java b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/FileSinkCompactionSwitchITCase.java
index 6cec1e38084..b34d8def6df 100644
--- a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/FileSinkCompactionSwitchITCase.java
+++ b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/FileSinkCompactionSwitchITCase.java
@@ -34,6 +34,7 @@ import org.apache.flink.connector.file.sink.compactor.RecordWiseFileCompactor;
 import org.apache.flink.connector.file.sink.utils.IntegerFileSinkTestDataUtils.IntDecoder;
 import org.apache.flink.connector.file.sink.utils.IntegerFileSinkTestDataUtils.IntEncoder;
 import org.apache.flink.connector.file.sink.utils.IntegerFileSinkTestDataUtils.ModuloBucketAssigner;
+import org.apache.flink.connector.file.sink.utils.PartSizeAndCheckpointRollingPolicy;
 import org.apache.flink.core.execution.SavepointFormatType;
 import org.apache.flink.core.fs.Path;
 import org.apache.flink.runtime.jobgraph.JobGraph;
@@ -214,8 +215,7 @@ public class FileSinkCompactionSwitchITCase {
         DefaultRowFormatBuilder<Integer> sinkBuilder =
                 FileSink.forRowFormat(new Path(path), new IntEncoder())
                         .withBucketAssigner(new ModuloBucketAssigner(NUM_BUCKETS))
-                        .withRollingPolicy(
-                                new FileSinkITBase.PartSizeAndCheckpointRollingPolicy(1024));
+                        .withRollingPolicy(new PartSizeAndCheckpointRollingPolicy<>(1024, false));
 
         if (compactionEnabled) {
             sinkBuilder =
diff --git a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/FileSinkITBase.java b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/FileSinkITBase.java
index 50f8107f669..de8de90eb22 100644
--- a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/FileSinkITBase.java
+++ b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/FileSinkITBase.java
@@ -21,13 +21,11 @@ package org.apache.flink.connector.file.sink;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.configuration.RestOptions;
 import org.apache.flink.connector.file.sink.utils.IntegerFileSinkTestDataUtils;
+import org.apache.flink.connector.file.sink.utils.PartSizeAndCheckpointRollingPolicy;
 import org.apache.flink.core.fs.Path;
 import org.apache.flink.runtime.jobgraph.JobGraph;
 import org.apache.flink.runtime.minicluster.MiniCluster;
 import org.apache.flink.runtime.minicluster.MiniClusterConfiguration;
-import org.apache.flink.streaming.api.functions.sink.filesystem.PartFileInfo;
-import org.apache.flink.streaming.api.functions.sink.filesystem.RollingPolicy;
-import org.apache.flink.streaming.api.functions.sink.filesystem.rollingpolicies.CheckpointRollingPolicy;
 import org.apache.flink.util.TestLogger;
 
 import org.junit.ClassRule;
@@ -35,7 +33,6 @@ import org.junit.Test;
 import org.junit.rules.TemporaryFolder;
 import org.junit.runners.Parameterized;
 
-import java.io.IOException;
 import java.util.Arrays;
 import java.util.Collection;
 
@@ -91,30 +88,7 @@ public abstract class FileSinkITBase extends TestLogger {
         return FileSink.forRowFormat(new Path(path), new IntegerFileSinkTestDataUtils.IntEncoder())
                 .withBucketAssigner(
                         new IntegerFileSinkTestDataUtils.ModuloBucketAssigner(NUM_BUCKETS))
-                .withRollingPolicy(new PartSizeAndCheckpointRollingPolicy(1024))
+                .withRollingPolicy(new PartSizeAndCheckpointRollingPolicy<>(1024, true))
                 .build();
     }
-
-    /** The testing {@link RollingPolicy} based on maximum file size. */
-    protected static class PartSizeAndCheckpointRollingPolicy
-            extends CheckpointRollingPolicy<Integer, String> {
-
-        private final long maxPartSize;
-
-        public PartSizeAndCheckpointRollingPolicy(long maxPartSize) {
-            this.maxPartSize = maxPartSize;
-        }
-
-        @Override
-        public boolean shouldRollOnEvent(PartFileInfo<String> partFileState, Integer element)
-                throws IOException {
-            return partFileState.getSize() >= maxPartSize;
-        }
-
-        @Override
-        public boolean shouldRollOnProcessingTime(
-                PartFileInfo<String> partFileState, long currentTime) {
-            return false;
-        }
-    }
 }
diff --git a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/StreamingCompactingFileSinkITCase.java b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/StreamingCompactingFileSinkITCase.java
index 227d49a2f71..8b3748dcd89 100644
--- a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/StreamingCompactingFileSinkITCase.java
+++ b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/StreamingCompactingFileSinkITCase.java
@@ -24,6 +24,7 @@ import org.apache.flink.connector.file.sink.compactor.FileCompactor;
 import org.apache.flink.connector.file.sink.compactor.RecordWiseFileCompactor;
 import org.apache.flink.connector.file.sink.utils.IntegerFileSinkTestDataUtils;
 import org.apache.flink.connector.file.sink.utils.IntegerFileSinkTestDataUtils.IntDecoder;
+import org.apache.flink.connector.file.sink.utils.PartSizeAndCheckpointRollingPolicy;
 import org.apache.flink.core.fs.Path;
 import org.apache.flink.runtime.minicluster.RpcServiceSharing;
 import org.apache.flink.runtime.testutils.MiniClusterResourceConfiguration;
@@ -54,7 +55,7 @@ public class StreamingCompactingFileSinkITCase extends StreamingExecutionFileSin
         return FileSink.forRowFormat(new Path(path), new IntegerFileSinkTestDataUtils.IntEncoder())
                 .withBucketAssigner(
                         new IntegerFileSinkTestDataUtils.ModuloBucketAssigner(NUM_BUCKETS))
-                .withRollingPolicy(new PartSizeAndCheckpointRollingPolicy(1024))
+                .withRollingPolicy(new PartSizeAndCheckpointRollingPolicy<>(1024, false))
                 .enableCompact(createFileCompactStrategy(), createFileCompactor())
                 .build();
     }
diff --git a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/compactor/CompactCoordinatorTest.java b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/compactor/CompactCoordinatorTest.java
index 9a076838666..8b900e008e0 100644
--- a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/compactor/CompactCoordinatorTest.java
+++ b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/compactor/CompactCoordinatorTest.java
@@ -91,11 +91,13 @@ public class CompactCoordinatorTest extends AbstractCompactTestBase {
             harness.setup();
             harness.open();
 
+            FileSinkCommittable passThroughCommittable = committable("0", "4", 5);
             FileSinkCommittable committable0 = committable("0", ".0", 5);
             FileSinkCommittable committable1 = committable("0", ".1", 6);
             FileSinkCommittable committable2 = committable("0", ".2", 5);
             FileSinkCommittable committable3 = committable("1", ".0", 5);
 
+            harness.processElement(message(passThroughCommittable));
             harness.processElement(message(committable0));
             harness.processElement(message(committable1));
 
@@ -117,6 +119,7 @@ public class CompactCoordinatorTest extends AbstractCompactTestBase {
             List<CompactorRequest> results = harness.extractOutputValues();
             Assert.assertEquals(3, results.size());
             assertToCompact(results.get(0), committable0, committable1);
+            assertToPassthrough(results.get(0), passThroughCommittable);
             assertToCompact(results.get(1), committable2);
             assertToCompact(results.get(2), committable3);
         }
diff --git a/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/utils/PartSizeAndCheckpointRollingPolicy.java b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/utils/PartSizeAndCheckpointRollingPolicy.java
new file mode 100644
index 00000000000..e2e0bd4eb51
--- /dev/null
+++ b/flink-connectors/flink-connector-files/src/test/java/org/apache/flink/connector/file/sink/utils/PartSizeAndCheckpointRollingPolicy.java
@@ -0,0 +1,55 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.connector.file.sink.utils;
+
+import org.apache.flink.streaming.api.functions.sink.filesystem.PartFileInfo;
+import org.apache.flink.streaming.api.functions.sink.filesystem.RollingPolicy;
+
+import java.io.IOException;
+
+/** Testing {@link RollingPolicy} that rolls in consideration of the file size and checkpoint. */
+public class PartSizeAndCheckpointRollingPolicy<IN, BucketID>
+        implements RollingPolicy<IN, BucketID> {
+
+    private final long maxPartSize;
+
+    private final boolean rollingOnCheckpoint;
+
+    public PartSizeAndCheckpointRollingPolicy(long maxPartSize, boolean rollingOnCheckpoint) {
+        this.maxPartSize = maxPartSize;
+        this.rollingOnCheckpoint = rollingOnCheckpoint;
+    }
+
+    @Override
+    public boolean shouldRollOnCheckpoint(PartFileInfo<BucketID> partFileState) {
+        return rollingOnCheckpoint;
+    }
+
+    @Override
+    public boolean shouldRollOnEvent(PartFileInfo<BucketID> partFileState, IN element)
+            throws IOException {
+        return partFileState.getSize() >= maxPartSize;
+    }
+
+    @Override
+    public boolean shouldRollOnProcessingTime(
+            PartFileInfo<BucketID> partFileState, long currentTime) {
+        return false;
+    }
+}
