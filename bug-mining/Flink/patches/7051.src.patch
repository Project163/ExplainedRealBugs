diff --git a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/nodes/exec/serde/AggregateCallJsonDeserializer.java b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/nodes/exec/serde/AggregateCallJsonDeserializer.java
index 8af08c2f80d..cc61db407a1 100644
--- a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/nodes/exec/serde/AggregateCallJsonDeserializer.java
+++ b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/nodes/exec/serde/AggregateCallJsonDeserializer.java
@@ -24,6 +24,7 @@ import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.core.JsonParser;
 import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.DeserializationContext;
 import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.JsonNode;
 import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.deser.std.StdDeserializer;
+import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.node.JsonNodeType;
 
 import org.apache.calcite.rel.RelCollations;
 import org.apache.calcite.rel.core.AggregateCall;
@@ -61,7 +62,8 @@ final class AggregateCallJsonDeserializer extends StdDeserializer<AggregateCall>
         final JsonNode jsonNode = jsonParser.readValueAsTree();
         final SerdeContext serdeContext = SerdeContext.get(ctx);
 
-        final String name = jsonNode.required(FIELD_NAME_NAME).asText();
+        JsonNode nameNode = jsonNode.required(FIELD_NAME_NAME);
+        final String name = nameNode.getNodeType() == JsonNodeType.NULL ? null : nameNode.asText();
         final SqlAggFunction aggFunction =
                 (SqlAggFunction)
                         RexNodeJsonDeserializer.deserializeSqlOperator(jsonNode, serdeContext);
diff --git a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/nodes/exec/serde/RexNodeJsonSerializer.java b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/nodes/exec/serde/RexNodeJsonSerializer.java
index f0b6bf80fae..f559f6445e5 100644
--- a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/nodes/exec/serde/RexNodeJsonSerializer.java
+++ b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/nodes/exec/serde/RexNodeJsonSerializer.java
@@ -63,6 +63,7 @@ import org.apache.calcite.util.Sarg;
 import java.io.IOException;
 import java.math.BigDecimal;
 
+import static org.apache.calcite.sql.type.SqlTypeName.SARG;
 import static org.apache.flink.table.functions.UserDefinedFunctionHelper.isClassNameSerializable;
 import static org.apache.flink.table.planner.typeutils.SymbolUtil.calciteToSerializable;
 
@@ -192,22 +193,17 @@ final class RexNodeJsonSerializer extends StdSerializer<RexNode> {
         gen.writeStartObject();
         gen.writeStringField(FIELD_NAME_KIND, KIND_LITERAL);
         final Comparable<?> value = literal.getValueAs(Comparable.class);
-        serializeLiteralValue(
-                value,
-                literal.getTypeName(),
-                literal.getType().getSqlTypeName(),
-                gen,
-                serializerProvider);
+        if (literal.getTypeName() == SARG) {
+            serializeSargValue((Sarg<?>) value, literal.getType().getSqlTypeName(), gen);
+        } else {
+            serializeLiteralValue(value, literal.getType().getSqlTypeName(), gen);
+        }
         serializerProvider.defaultSerializeField(FIELD_NAME_TYPE, literal.getType(), gen);
         gen.writeEndObject();
     }
 
     private static void serializeLiteralValue(
-            Comparable<?> value,
-            SqlTypeName literalTypeName,
-            SqlTypeName elementTypeName,
-            JsonGenerator gen,
-            SerializerProvider serializerProvider)
+            Comparable<?> value, SqlTypeName literalTypeName, JsonGenerator gen)
             throws IOException {
         if (value == null) {
             gen.writeNullField(FIELD_NAME_VALUE);
@@ -230,12 +226,8 @@ final class RexNodeJsonSerializer extends StdSerializer<RexNode> {
             case BIGINT:
                 gen.writeNumberField(FIELD_NAME_VALUE, ((BigDecimal) value).longValue());
                 break;
-            case FLOAT:
-                gen.writeNumberField(FIELD_NAME_VALUE, ((BigDecimal) value).floatValue());
-                break;
             case DOUBLE:
-                gen.writeNumberField(FIELD_NAME_VALUE, ((BigDecimal) value).doubleValue());
-                break;
+            case FLOAT:
             case DECIMAL:
             case INTERVAL_YEAR:
             case INTERVAL_YEAR_MONTH:
@@ -269,9 +261,6 @@ final class RexNodeJsonSerializer extends StdSerializer<RexNode> {
                 gen.writeStringField(FIELD_NAME_SYMBOL, symbol.getKind());
                 gen.writeStringField(FIELD_NAME_VALUE, symbol.getValue());
                 break;
-            case SARG:
-                serializeSargValue((Sarg<?>) value, elementTypeName, gen, serializerProvider);
-                break;
             default:
                 throw new TableException(
                         String.format(
@@ -282,11 +271,7 @@ final class RexNodeJsonSerializer extends StdSerializer<RexNode> {
 
     @SuppressWarnings("UnstableApiUsage")
     private static void serializeSargValue(
-            Sarg<?> value,
-            SqlTypeName sqlTypeName,
-            JsonGenerator gen,
-            SerializerProvider serializerProvider)
-            throws IOException {
+            Sarg<?> value, SqlTypeName sqlTypeName, JsonGenerator gen) throws IOException {
         gen.writeFieldName(FIELD_NAME_SARG);
         gen.writeStartObject();
         gen.writeFieldName(FIELD_NAME_RANGES);
@@ -296,8 +281,7 @@ final class RexNodeJsonSerializer extends StdSerializer<RexNode> {
             if (range.hasLowerBound()) {
                 gen.writeFieldName(FIELD_NAME_BOUND_LOWER);
                 gen.writeStartObject();
-                serializeLiteralValue(
-                        range.lowerEndpoint(), sqlTypeName, sqlTypeName, gen, serializerProvider);
+                serializeLiteralValue(range.lowerEndpoint(), sqlTypeName, gen);
                 final SerializableSymbol symbol = calciteToSerializable(range.lowerBoundType());
                 gen.writeStringField(FIELD_NAME_BOUND_TYPE, symbol.getValue());
                 gen.writeEndObject();
@@ -305,8 +289,7 @@ final class RexNodeJsonSerializer extends StdSerializer<RexNode> {
             if (range.hasUpperBound()) {
                 gen.writeFieldName(FIELD_NAME_BOUND_UPPER);
                 gen.writeStartObject();
-                serializeLiteralValue(
-                        range.upperEndpoint(), sqlTypeName, sqlTypeName, gen, serializerProvider);
+                serializeLiteralValue(range.upperEndpoint(), sqlTypeName, gen);
                 final SerializableSymbol symbol = calciteToSerializable(range.upperBoundType());
                 gen.writeStringField(FIELD_NAME_BOUND_TYPE, symbol.getValue());
                 gen.writeEndObject();
diff --git a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/AggregateCallSerdeTest.java b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/AggregateCallSerdeTest.java
new file mode 100644
index 00000000000..c227ca2a155
--- /dev/null
+++ b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/AggregateCallSerdeTest.java
@@ -0,0 +1,158 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.table.planner.plan.nodes.exec.serde;
+
+import org.apache.flink.api.java.tuple.Tuple2;
+import org.apache.flink.table.api.TableException;
+import org.apache.flink.table.functions.FunctionIdentifier;
+import org.apache.flink.table.functions.TableAggregateFunction;
+import org.apache.flink.table.functions.UserDefinedFunctionHelper;
+import org.apache.flink.table.planner.calcite.FlinkTypeFactory;
+import org.apache.flink.table.planner.calcite.FlinkTypeSystem;
+import org.apache.flink.table.planner.functions.utils.AggSqlFunction;
+import org.apache.flink.table.planner.utils.Top3;
+import org.apache.flink.table.planner.utils.Top3Accum;
+import org.apache.flink.table.types.DataType;
+import org.apache.flink.table.types.logical.BigIntType;
+import org.apache.flink.table.types.logical.DoubleType;
+import org.apache.flink.table.types.logical.LogicalType;
+import org.apache.flink.table.types.utils.TypeConversions;
+
+import org.apache.flink.shaded.guava30.com.google.common.collect.ImmutableList;
+
+import org.apache.calcite.rel.RelCollations;
+import org.apache.calcite.rel.core.AggregateCall;
+import org.apache.calcite.rel.type.RelDataType;
+import org.apache.calcite.sql.fun.SqlStdOperatorTable;
+import org.apache.calcite.sql.type.BasicSqlType;
+import org.apache.calcite.sql.type.SqlTypeName;
+import org.junit.jupiter.api.Test;
+import org.junit.jupiter.api.parallel.Execution;
+import org.junit.jupiter.api.parallel.ExecutionMode;
+import org.junit.jupiter.params.ParameterizedTest;
+import org.junit.jupiter.params.provider.Arguments;
+import org.junit.jupiter.params.provider.MethodSource;
+
+import java.io.IOException;
+import java.util.stream.Stream;
+
+import static org.apache.flink.table.planner.plan.nodes.exec.serde.JsonSerdeTestUtil.testJsonRoundTrip;
+import static org.assertj.core.api.Assertions.assertThatThrownBy;
+
+/**
+ * Tests for {@link org.apache.calcite.rel.core.AggregateCall} serialization and deserialization.
+ */
+@Execution(ExecutionMode.CONCURRENT)
+public class AggregateCallSerdeTest {
+
+    private static final FlinkTypeFactory FACTORY =
+            new FlinkTypeFactory(
+                    AggregateCallSerdeTest.class.getClassLoader(), FlinkTypeSystem.INSTANCE);
+
+    @MethodSource("aggregateCallSpecs")
+    @ParameterizedTest
+    void testAggregateCallSerde(AggregateCall aggCall) throws IOException {
+        testJsonRoundTrip(aggCall, AggregateCall.class);
+    }
+
+    @Test
+    void testUnsupportedLegacyAggFunc() {
+        assertThatThrownBy(() -> testJsonRoundTrip(getLegacyAggCall(), AggregateCall.class))
+                .hasRootCauseInstanceOf(TableException.class)
+                .hasRootCauseMessage(
+                        "Functions of the deprecated function stack are not supported. Please update 'top3' to the new interfaces.");
+    }
+
+    public static Stream<Arguments> aggregateCallSpecs() {
+        return Stream.of(
+                Arguments.of(
+                        AggregateCall.create(
+                                SqlStdOperatorTable.RANK,
+                                false,
+                                false,
+                                false,
+                                ImmutableList.of(),
+                                -1,
+                                null,
+                                RelCollations.EMPTY,
+                                fromLogicalType(new BigIntType(false)),
+                                "rk")),
+                Arguments.of(
+                        AggregateCall.create(
+                                SqlStdOperatorTable.MAX,
+                                false,
+                                false,
+                                false,
+                                ImmutableList.of(3),
+                                -1,
+                                null,
+                                RelCollations.EMPTY,
+                                fromLogicalType(new DoubleType(false)),
+                                "max_d")),
+                Arguments.of(
+                        AggregateCall.create(
+                                SqlStdOperatorTable.COUNT,
+                                false,
+                                false,
+                                false,
+                                ImmutableList.of(),
+                                -1,
+                                null,
+                                RelCollations.EMPTY,
+                                fromLogicalType(new BigIntType(false)),
+                                null)));
+    }
+
+    private static RelDataType fromLogicalType(LogicalType type) {
+        return FACTORY.createFieldTypeFromLogicalType(type);
+    }
+
+    private static AggregateCall getLegacyAggCall() {
+        TableAggregateFunction<Tuple2<Integer, Integer>, Top3Accum> top3 = new Top3();
+        DataType externalResultType =
+                TypeConversions.fromLegacyInfoToDataType(
+                        UserDefinedFunctionHelper.getReturnTypeOfAggregateFunction(top3));
+        DataType externalAccType =
+                TypeConversions.fromLegacyInfoToDataType(
+                        UserDefinedFunctionHelper.getAccumulatorTypeOfAggregateFunction(top3));
+        AggSqlFunction aggFunction =
+                AggSqlFunction.apply(
+                        FunctionIdentifier.of("top3"),
+                        "top3",
+                        top3,
+                        externalResultType,
+                        externalAccType,
+                        FACTORY,
+                        false);
+        return AggregateCall.create(
+                aggFunction,
+                false,
+                false,
+                false,
+                ImmutableList.of(3),
+                -1,
+                null,
+                RelCollations.of(),
+                FACTORY.builder()
+                        .add("f0", new BasicSqlType(FACTORY.getTypeSystem(), SqlTypeName.INTEGER))
+                        .add("f1", new BasicSqlType(FACTORY.getTypeSystem(), SqlTypeName.INTEGER))
+                        .build(),
+                "top3");
+    }
+}
diff --git a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/JsonSerdeTestUtil.java b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/JsonSerdeTestUtil.java
index def856fef93..1aba5f8a4c4 100644
--- a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/JsonSerdeTestUtil.java
+++ b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/JsonSerdeTestUtil.java
@@ -98,6 +98,7 @@ class JsonSerdeTestUtil {
         T actual = toObject(serdeContext, actualJson, clazz);
 
         assertThat(actual).isEqualTo(spec);
+        assertThat(actualJson).isEqualTo(toJson(serdeContext, actual));
         return actual;
     }
 
diff --git a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/RexNodeJsonSerdeTest.java b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/RexNodeJsonSerdeTest.java
index 2dfa427db96..489f10a6123 100644
--- a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/RexNodeJsonSerdeTest.java
+++ b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/nodes/exec/serde/RexNodeJsonSerdeTest.java
@@ -205,8 +205,8 @@ public class RexNodeJsonSerdeTest {
                                 TableException.class,
                                 "Could not lookup system function '" + FUNCTION_NAME + "'."));
 
-        // Registered temporary function
-        registerTemporaryFunction(serdeContext);
+        // Registered temporary system function
+        registerTemporarySystemFunction(serdeContext);
         callable.call();
     }
 
@@ -758,6 +758,13 @@ public class RexNodeJsonSerdeTest {
                         UNRESOLVED_FUNCTION_CAT_ID, NON_SER_FUNCTION_DEF_IMPL, false);
     }
 
+    private static void registerTemporarySystemFunction(SerdeContext serdeContext) {
+        serdeContext
+                .getFlinkContext()
+                .getFunctionCatalog()
+                .registerTemporarySystemFunction(FUNCTION_NAME, NON_SER_FUNCTION_DEF_IMPL, false);
+    }
+
     private JsonNode serializePermanentFunction(SerdeContext serdeContext) throws Exception {
         final byte[] actualSerialized =
                 createObjectWriter(serdeContext)
diff --git a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/utils/JsonTestUtils.java b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/utils/JsonTestUtils.java
index c4595a5ccd3..52394523578 100644
--- a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/utils/JsonTestUtils.java
+++ b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/utils/JsonTestUtils.java
@@ -21,6 +21,7 @@ package org.apache.flink.table.planner.utils;
 import org.apache.flink.FlinkVersion;
 import org.apache.flink.util.jackson.JacksonMapperFactory;
 
+import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.core.JsonProcessingException;
 import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.JsonNode;
 import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.ObjectMapper;
 import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.node.ObjectNode;
@@ -43,6 +44,10 @@ public final class JsonTestUtils {
         return OBJECT_MAPPER_INSTANCE.readTree(path);
     }
 
+    public static String writeToString(JsonNode target) throws JsonProcessingException {
+        return OBJECT_MAPPER_INSTANCE.writeValueAsString(target);
+    }
+
     public static JsonNode setFlinkVersion(JsonNode target, FlinkVersion flinkVersion) {
         return ((ObjectNode) target)
                 .set("flinkVersion", OBJECT_MAPPER_INSTANCE.valueToTree(flinkVersion.toString()));
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/CalcJsonPlanTest_jsonplan/testComplexCalc.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/CalcJsonPlanTest_jsonplan/testComplexCalc.out
index 4dcf71adccd..4edfe7963c3 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/CalcJsonPlanTest_jsonplan/testComplexCalc.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/CalcJsonPlanTest_jsonplan/testComplexCalc.out
@@ -101,11 +101,11 @@
           "type" : "VARCHAR(2147483647)"
         }, {
           "kind" : "LITERAL",
-          "value" : "1",
+          "value" : 1,
           "type" : "INT NOT NULL"
         }, {
           "kind" : "LITERAL",
-          "value" : "5",
+          "value" : 5,
           "type" : "INT NOT NULL"
         } ],
         "type" : "VARCHAR(2147483647)"
@@ -121,7 +121,7 @@
         "type" : "TIMESTAMP(3)"
       }, {
         "kind" : "LITERAL",
-        "value" : "1000",
+        "value" : 1000,
         "type" : "INT NOT NULL"
       } ],
       "type" : "TIMESTAMP(3)"
@@ -149,7 +149,7 @@
             "type" : "BIGINT NOT NULL"
           }, {
             "kind" : "LITERAL",
-            "value" : "0",
+            "value" : 0,
             "type" : "INT NOT NULL"
           } ],
           "type" : "BOOLEAN NOT NULL"
@@ -173,7 +173,7 @@
             "type" : "BIGINT"
           }, {
             "kind" : "LITERAL",
-            "value" : "100",
+            "value" : 100,
             "type" : "INT NOT NULL"
           } ],
           "type" : "BOOLEAN"
@@ -189,7 +189,7 @@
           "type" : "INT NOT NULL"
         }, {
           "kind" : "LITERAL",
-          "value" : "10",
+          "value" : 10,
           "type" : "INT NOT NULL"
         } ],
         "type" : "BOOLEAN NOT NULL"
@@ -277,4 +277,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/CalcJsonPlanTest_jsonplan/testSimpleFilter.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/CalcJsonPlanTest_jsonplan/testSimpleFilter.out
index 6028828ca81..781cef67ab5 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/CalcJsonPlanTest_jsonplan/testSimpleFilter.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/CalcJsonPlanTest_jsonplan/testSimpleFilter.out
@@ -68,7 +68,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "0",
+        "value" : 0,
         "type" : "INT NOT NULL"
       } ],
       "type" : "BOOLEAN NOT NULL"
@@ -145,4 +145,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/ExpandJsonPlanTest_jsonplan/testExpand.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/ExpandJsonPlanTest_jsonplan/testExpand.out
index 8262813cced..c764125a8e2 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/ExpandJsonPlanTest_jsonplan/testExpand.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/ExpandJsonPlanTest_jsonplan/testExpand.out
@@ -60,7 +60,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1024",
+        "value" : 1024,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT NOT NULL"
@@ -78,7 +78,7 @@
         "type" : "INT"
       }, {
         "kind" : "LITERAL",
-        "value" : "1024",
+        "value" : 1024,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT"
@@ -118,7 +118,7 @@
       "type" : "INT"
     }, {
       "kind" : "LITERAL",
-      "value" : "1",
+      "value" : 1,
       "type" : "BIGINT NOT NULL"
     } ], [ {
       "kind" : "INPUT_REF",
@@ -142,7 +142,7 @@
       "type" : "INT"
     }, {
       "kind" : "LITERAL",
-      "value" : "2",
+      "value" : 2,
       "type" : "BIGINT NOT NULL"
     } ] ],
     "inputProperties" : [ {
@@ -187,7 +187,7 @@
         "type" : "BIGINT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "BOOLEAN NOT NULL"
@@ -201,7 +201,7 @@
         "type" : "BIGINT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "2",
+        "value" : 2,
         "type" : "INT NOT NULL"
       } ],
       "type" : "BOOLEAN NOT NULL"
@@ -425,4 +425,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testDistinctAggCalls[isMiniBatchEnabled=false].out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testDistinctAggCalls[isMiniBatchEnabled=false].out
index 1af9ee2c41c..0b48cdf32cb 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testDistinctAggCalls[isMiniBatchEnabled=false].out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testDistinctAggCalls[isMiniBatchEnabled=false].out
@@ -55,7 +55,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "10",
+        "value" : 10,
         "type" : "INT NOT NULL"
       } ],
       "type" : "BOOLEAN NOT NULL"
@@ -336,4 +336,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testDistinctAggCalls[isMiniBatchEnabled=true].out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testDistinctAggCalls[isMiniBatchEnabled=true].out
index 12b2452fbef..d9ea30c54cd 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testDistinctAggCalls[isMiniBatchEnabled=true].out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testDistinctAggCalls[isMiniBatchEnabled=true].out
@@ -71,7 +71,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "10",
+        "value" : 10,
         "type" : "INT NOT NULL"
       } ],
       "type" : "BOOLEAN NOT NULL"
@@ -598,4 +598,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggCallsWithGroupBy[isMiniBatchEnabled=false].out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggCallsWithGroupBy[isMiniBatchEnabled=false].out
index f564a72dbad..d0194c21577 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggCallsWithGroupBy[isMiniBatchEnabled=false].out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggCallsWithGroupBy[isMiniBatchEnabled=false].out
@@ -64,7 +64,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "BOOLEAN NOT NULL"
@@ -279,4 +279,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggCallsWithGroupBy[isMiniBatchEnabled=true].out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggCallsWithGroupBy[isMiniBatchEnabled=true].out
index bfbee492d41..16b72f28c46 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggCallsWithGroupBy[isMiniBatchEnabled=true].out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggCallsWithGroupBy[isMiniBatchEnabled=true].out
@@ -80,7 +80,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "BOOLEAN NOT NULL"
@@ -358,4 +358,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggWithoutGroupBy[isMiniBatchEnabled=false].out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggWithoutGroupBy[isMiniBatchEnabled=false].out
index ab5ecc94b19..99ec25cd936 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggWithoutGroupBy[isMiniBatchEnabled=false].out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggWithoutGroupBy[isMiniBatchEnabled=false].out
@@ -72,7 +72,7 @@
           "type" : "BIGINT"
         }, {
           "kind" : "LITERAL",
-          "value" : "1",
+          "value" : 1,
           "type" : "INT NOT NULL"
         } ],
         "type" : "BOOLEAN"
@@ -305,4 +305,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggWithoutGroupBy[isMiniBatchEnabled=true].out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggWithoutGroupBy[isMiniBatchEnabled=true].out
index 8e9e1e6e283..17d677399cf 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggWithoutGroupBy[isMiniBatchEnabled=true].out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testSimpleAggWithoutGroupBy[isMiniBatchEnabled=true].out
@@ -88,7 +88,7 @@
           "type" : "BIGINT"
         }, {
           "kind" : "LITERAL",
-          "value" : "1",
+          "value" : 1,
           "type" : "INT NOT NULL"
         } ],
         "type" : "BOOLEAN"
@@ -393,4 +393,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testUserDefinedAggCalls[isMiniBatchEnabled=false].out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testUserDefinedAggCalls[isMiniBatchEnabled=false].out
index 41573678da6..1fb96ffad72 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testUserDefinedAggCalls[isMiniBatchEnabled=false].out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testUserDefinedAggCalls[isMiniBatchEnabled=false].out
@@ -43,11 +43,11 @@
       "type" : "INT NOT NULL"
     }, {
       "kind" : "LITERAL",
-      "value" : "10",
+      "value" : 10,
       "type" : "INT NOT NULL"
     }, {
       "kind" : "LITERAL",
-      "value" : "5",
+      "value" : 5,
       "type" : "INT NOT NULL"
     }, {
       "kind" : "INPUT_REF",
@@ -272,4 +272,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testUserDefinedAggCalls[isMiniBatchEnabled=true].out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testUserDefinedAggCalls[isMiniBatchEnabled=true].out
index 36478bc1dd5..9a3a2629d58 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testUserDefinedAggCalls[isMiniBatchEnabled=true].out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/GroupAggregateJsonPlanTest_jsonplan/testUserDefinedAggCalls[isMiniBatchEnabled=true].out
@@ -59,11 +59,11 @@
       "type" : "INT NOT NULL"
     }, {
       "kind" : "LITERAL",
-      "value" : "10",
+      "value" : 10,
       "type" : "INT NOT NULL"
     }, {
       "kind" : "LITERAL",
-      "value" : "5",
+      "value" : 5,
       "type" : "INT NOT NULL"
     }, {
       "kind" : "INPUT_REF",
@@ -295,4 +295,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/IncrementalAggregateJsonPlanTest_jsonplan/testIncrementalAggregate.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/IncrementalAggregateJsonPlanTest_jsonplan/testIncrementalAggregate.out
index 2f0585073c6..a457f742d3d 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/IncrementalAggregateJsonPlanTest_jsonplan/testIncrementalAggregate.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/IncrementalAggregateJsonPlanTest_jsonplan/testIncrementalAggregate.out
@@ -84,7 +84,7 @@
         "type" : "INT"
       }, {
         "kind" : "LITERAL",
-        "value" : "1024",
+        "value" : 1024,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT"
@@ -387,4 +387,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/IncrementalAggregateJsonPlanTest_jsonplan/testIncrementalAggregateWithSumCountDistinctAndRetraction.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/IncrementalAggregateJsonPlanTest_jsonplan/testIncrementalAggregateWithSumCountDistinctAndRetraction.out
index 517dc8bc130..f29f49ac995 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/IncrementalAggregateJsonPlanTest_jsonplan/testIncrementalAggregateWithSumCountDistinctAndRetraction.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/IncrementalAggregateJsonPlanTest_jsonplan/testIncrementalAggregateWithSumCountDistinctAndRetraction.out
@@ -177,7 +177,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1024",
+        "value" : 1024,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT NOT NULL"
@@ -566,4 +566,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/MatchRecognizeJsonPlanTest_jsonplan/testMatch.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/MatchRecognizeJsonPlanTest_jsonplan/testMatch.out
index 62fc80c1cbc..47816fcfb17 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/MatchRecognizeJsonPlanTest_jsonplan/testMatch.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/MatchRecognizeJsonPlanTest_jsonplan/testMatch.out
@@ -167,7 +167,7 @@
               "type" : "VARCHAR(2147483647)"
             }, {
               "kind" : "LITERAL",
-              "value" : "0",
+              "value" : 0,
               "type" : "INT NOT NULL"
             } ],
             "type" : "VARCHAR(2147483647)"
@@ -192,7 +192,7 @@
               "type" : "VARCHAR(2147483647)"
             }, {
               "kind" : "LITERAL",
-              "value" : "0",
+              "value" : 0,
               "type" : "INT NOT NULL"
             } ],
             "type" : "VARCHAR(2147483647)"
@@ -217,7 +217,7 @@
               "type" : "VARCHAR(2147483647)"
             }, {
               "kind" : "LITERAL",
-              "value" : "0",
+              "value" : 0,
               "type" : "INT NOT NULL"
             } ],
             "type" : "VARCHAR(2147483647)"
@@ -374,4 +374,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRangeOver.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRangeOver.out
index 15f5426ec99..cb0835c8abd 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRangeOver.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRangeOver.out
@@ -386,7 +386,7 @@
               "type" : "BIGINT NOT NULL"
             }, {
               "kind" : "LITERAL",
-              "value" : "0",
+              "value" : 0,
               "type" : "BIGINT NOT NULL"
             } ],
             "type" : "BOOLEAN NOT NULL"
@@ -512,4 +512,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRowsOverWithBuiltinProctime.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRowsOverWithBuiltinProctime.out
index 5d722f46d04..bcfa04121e2 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRowsOverWithBuiltinProctime.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRowsOverWithBuiltinProctime.out
@@ -263,7 +263,7 @@
       } ],
       "constants" : [ {
         "kind" : "LITERAL",
-        "value" : "4",
+        "value" : 4,
         "type" : "INT NOT NULL"
       } ],
       "originalInputFields" : 4
@@ -327,7 +327,7 @@
           "type" : "BIGINT NOT NULL"
         }, {
           "kind" : "LITERAL",
-          "value" : "0",
+          "value" : 0,
           "type" : "BIGINT NOT NULL"
         } ],
         "type" : "BOOLEAN NOT NULL"
@@ -445,4 +445,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeUnboundedPartitionedRangeOver.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeUnboundedPartitionedRangeOver.out
index c4a29465ec8..8bb57718f8f 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeUnboundedPartitionedRangeOver.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProcTimeUnboundedPartitionedRangeOver.out
@@ -363,7 +363,7 @@
             "type" : "BIGINT NOT NULL"
           }, {
             "kind" : "LITERAL",
-            "value" : "0",
+            "value" : 0,
             "type" : "BIGINT NOT NULL"
           } ],
           "type" : "BOOLEAN NOT NULL"
@@ -486,4 +486,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProctimeBoundedDistinctPartitionedRowOver.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProctimeBoundedDistinctPartitionedRowOver.out
index 4eaf0b63f03..64b37ff923c 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProctimeBoundedDistinctPartitionedRowOver.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProctimeBoundedDistinctPartitionedRowOver.out
@@ -301,7 +301,7 @@
       } ],
       "constants" : [ {
         "kind" : "LITERAL",
-        "value" : "2",
+        "value" : 2,
         "type" : "INT NOT NULL"
       } ],
       "originalInputFields" : 3
@@ -373,7 +373,7 @@
             "type" : "BIGINT NOT NULL"
           }, {
             "kind" : "LITERAL",
-            "value" : "0",
+            "value" : 0,
             "type" : "BIGINT NOT NULL"
           } ],
           "type" : "BOOLEAN NOT NULL"
@@ -496,4 +496,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProctimeBoundedDistinctWithNonDistinctPartitionedRowOver.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProctimeBoundedDistinctWithNonDistinctPartitionedRowOver.out
index b7477b9ae92..3e483c4ce90 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProctimeBoundedDistinctWithNonDistinctPartitionedRowOver.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testProctimeBoundedDistinctWithNonDistinctPartitionedRowOver.out
@@ -341,7 +341,7 @@
       } ],
       "constants" : [ {
         "kind" : "LITERAL",
-        "value" : "2",
+        "value" : 2,
         "type" : "INT NOT NULL"
       } ],
       "originalInputFields" : 4
@@ -425,7 +425,7 @@
             "type" : "BIGINT NOT NULL"
           }, {
             "kind" : "LITERAL",
-            "value" : "0",
+            "value" : 0,
             "type" : "BIGINT NOT NULL"
           } ],
           "type" : "BOOLEAN NOT NULL"
@@ -465,7 +465,7 @@
           "type" : "BIGINT NOT NULL"
         }, {
           "kind" : "LITERAL",
-          "value" : "0",
+          "value" : 0,
           "type" : "BIGINT NOT NULL"
         } ],
         "type" : "BOOLEAN NOT NULL"
@@ -592,4 +592,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testRowTimeBoundedPartitionedRowsOver.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testRowTimeBoundedPartitionedRowsOver.out
index 9eb9209956e..514303f1ed3 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testRowTimeBoundedPartitionedRowsOver.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/OverAggregateJsonPlanTest_jsonplan/testRowTimeBoundedPartitionedRowsOver.out
@@ -179,7 +179,7 @@
       } ],
       "constants" : [ {
         "kind" : "LITERAL",
-        "value" : "5",
+        "value" : 5,
         "type" : "INT NOT NULL"
       } ],
       "originalInputFields" : 3
@@ -313,4 +313,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonCalcJsonPlanTest_jsonplan/testPythonFunctionInWhereClause.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonCalcJsonPlanTest_jsonplan/testPythonFunctionInWhereClause.out
index bca1175329b..5ea0d3005b1 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonCalcJsonPlanTest_jsonplan/testPythonFunctionInWhereClause.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonCalcJsonPlanTest_jsonplan/testPythonFunctionInWhereClause.out
@@ -67,7 +67,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT NOT NULL"
@@ -213,4 +213,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonCorrelateJsonPlanTest_jsonplan/testJoinWithFilter.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonCorrelateJsonPlanTest_jsonplan/testJoinWithFilter.out
index 91a1a1ced71..a4d1a5dbd7d 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonCorrelateJsonPlanTest_jsonplan/testJoinWithFilter.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonCorrelateJsonPlanTest_jsonplan/testJoinWithFilter.out
@@ -144,7 +144,7 @@
             "type" : "INT"
           }, {
             "kind" : "LITERAL",
-            "value" : "1",
+            "value" : 1,
             "type" : "INT NOT NULL"
           } ],
           "type" : "INT"
@@ -261,4 +261,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupAggregateJsonPlanTest_jsonplan/tesPythonAggCallsWithGroupBy.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupAggregateJsonPlanTest_jsonplan/tesPythonAggCallsWithGroupBy.out
index 3a983fd2938..5275647c919 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupAggregateJsonPlanTest_jsonplan/tesPythonAggCallsWithGroupBy.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupAggregateJsonPlanTest_jsonplan/tesPythonAggCallsWithGroupBy.out
@@ -68,7 +68,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "BOOLEAN NOT NULL"
@@ -229,4 +229,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeHopWindow.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeHopWindow.out
index 4eb78b8425c..ae5cde333a0 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeHopWindow.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeHopWindow.out
@@ -187,7 +187,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT NOT NULL"
@@ -387,4 +387,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeSessionWindow.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeSessionWindow.out
index 0b404642a70..1cf29460bfc 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeSessionWindow.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeSessionWindow.out
@@ -187,7 +187,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT NOT NULL"
@@ -385,4 +385,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeTumbleWindow.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeTumbleWindow.out
index 5adfce323c1..96e8440a89a 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeTumbleWindow.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testEventTimeTumbleWindow.out
@@ -187,7 +187,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT NOT NULL"
@@ -510,4 +510,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeHopWindow.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeHopWindow.out
index f0e145c90e1..e44b53bc2f1 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeHopWindow.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeHopWindow.out
@@ -236,7 +236,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT NOT NULL"
@@ -440,4 +440,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeSessionWindow.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeSessionWindow.out
index cb5438d8ec5..86ab8d82dd2 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeSessionWindow.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeSessionWindow.out
@@ -236,7 +236,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT NOT NULL"
@@ -438,4 +438,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeTumbleWindow.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeTumbleWindow.out
index 08990c9201e..544d4db6ce8 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeTumbleWindow.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonGroupWindowAggregateJsonPlanTest_jsonplan/testProcTimeTumbleWindow.out
@@ -236,7 +236,7 @@
         "type" : "INT NOT NULL"
       }, {
         "kind" : "LITERAL",
-        "value" : "1",
+        "value" : 1,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT NOT NULL"
@@ -539,4 +539,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonOverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRowsOverWithBuiltinProctime.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonOverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRowsOverWithBuiltinProctime.out
index 2a37b63d4df..04d23d8209a 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonOverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRowsOverWithBuiltinProctime.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonOverAggregateJsonPlanTest_jsonplan/testProcTimeBoundedPartitionedRowsOverWithBuiltinProctime.out
@@ -244,7 +244,7 @@
       } ],
       "constants" : [ {
         "kind" : "LITERAL",
-        "value" : "4",
+        "value" : 4,
         "type" : "INT NOT NULL"
       } ],
       "originalInputFields" : 4
@@ -389,4 +389,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonOverAggregateJsonPlanTest_jsonplan/testRowTimeBoundedPartitionedRowsOver.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonOverAggregateJsonPlanTest_jsonplan/testRowTimeBoundedPartitionedRowsOver.out
index d7e652d3bb1..bd6753fc60e 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonOverAggregateJsonPlanTest_jsonplan/testRowTimeBoundedPartitionedRowsOver.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/PythonOverAggregateJsonPlanTest_jsonplan/testRowTimeBoundedPartitionedRowsOver.out
@@ -240,7 +240,7 @@
       } ],
       "constants" : [ {
         "kind" : "LITERAL",
-        "value" : "5",
+        "value" : 5,
         "type" : "INT NOT NULL"
       } ],
       "originalInputFields" : 4
@@ -384,4 +384,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/TableSourceJsonPlanTest_jsonplan/testFilterPushDown.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/TableSourceJsonPlanTest_jsonplan/testFilterPushDown.out
index eed66e54fd2..25a53489e38 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/TableSourceJsonPlanTest_jsonplan/testFilterPushDown.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/TableSourceJsonPlanTest_jsonplan/testFilterPushDown.out
@@ -40,7 +40,7 @@
             "type" : "BIGINT"
           }, {
             "kind" : "LITERAL",
-            "value" : "0",
+            "value" : 0,
             "type" : "INT NOT NULL"
           } ],
           "type" : "BOOLEAN"
@@ -103,4 +103,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/ValuesJsonPlanTest_jsonplan/testValues.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/ValuesJsonPlanTest_jsonplan/testValues.out
index fd83244d9dd..718cff0937e 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/ValuesJsonPlanTest_jsonplan/testValues.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/ValuesJsonPlanTest_jsonplan/testValues.out
@@ -5,11 +5,11 @@
     "type" : "stream-exec-values_1",
     "tuples" : [ [ {
       "kind" : "LITERAL",
-      "value" : "1",
+      "value" : 1,
       "type" : "INT NOT NULL"
     }, {
       "kind" : "LITERAL",
-      "value" : "2",
+      "value" : 2,
       "type" : "INT NOT NULL"
     }, {
       "kind" : "LITERAL",
@@ -17,11 +17,11 @@
       "type" : "CHAR(2) NOT NULL"
     } ], [ {
       "kind" : "LITERAL",
-      "value" : "3",
+      "value" : 3,
       "type" : "INT NOT NULL"
     }, {
       "kind" : "LITERAL",
-      "value" : "4",
+      "value" : 4,
       "type" : "INT NOT NULL"
     }, {
       "kind" : "LITERAL",
@@ -136,4 +136,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/WindowAggregateJsonPlanTest_jsonplan/testDistinctSplitEnabled.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/WindowAggregateJsonPlanTest_jsonplan/testDistinctSplitEnabled.out
index 94423a78862..7b2c254af5c 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/WindowAggregateJsonPlanTest_jsonplan/testDistinctSplitEnabled.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/WindowAggregateJsonPlanTest_jsonplan/testDistinctSplitEnabled.out
@@ -194,7 +194,7 @@
         "type" : "INT"
       }, {
         "kind" : "LITERAL",
-        "value" : "1024",
+        "value" : 1024,
         "type" : "INT NOT NULL"
       } ],
       "type" : "INT"
@@ -921,4 +921,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/WindowTableFunctionJsonPlanTest_jsonplan/testFollowedByWindowJoin.out b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/WindowTableFunctionJsonPlanTest_jsonplan/testFollowedByWindowJoin.out
index df66bb07961..f1f33d283a6 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/WindowTableFunctionJsonPlanTest_jsonplan/testFollowedByWindowJoin.out
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/nodes/exec/stream/WindowTableFunctionJsonPlanTest_jsonplan/testFollowedByWindowJoin.out
@@ -261,7 +261,7 @@
         "type" : "BIGINT"
       }, {
         "kind" : "LITERAL",
-        "value" : "10",
+        "value" : 10,
         "type" : "INT NOT NULL"
       } ],
       "type" : "BOOLEAN"
@@ -549,7 +549,7 @@
         "type" : "BIGINT"
       }, {
         "kind" : "LITERAL",
-        "value" : "10",
+        "value" : 10,
         "type" : "INT NOT NULL"
       } ],
       "type" : "BOOLEAN"
@@ -838,4 +838,4 @@
     },
     "shuffleMode" : "PIPELINED"
   } ]
-}
\ No newline at end of file
+}
diff --git a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/utils/TableTestBase.scala b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/utils/TableTestBase.scala
index cde16f76502..06f782d66c3 100644
--- a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/utils/TableTestBase.scala
+++ b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/utils/TableTestBase.scala
@@ -17,6 +17,7 @@
  */
 package org.apache.flink.table.planner.utils
 
+import org.apache.flink.FlinkVersion
 import org.apache.flink.api.common.typeinfo.{AtomicType, TypeInformation}
 import org.apache.flink.api.java.typeutils.{PojoTypeInfo, RowTypeInfo, TupleTypeInfo}
 import org.apache.flink.api.scala.typeutils.CaseClassTypeInfo
@@ -804,7 +805,7 @@ abstract class TableTestUtilBase(test: TableTestBase, isStreamingMode: Boolean)
 
   final val PLAN_TEST_FORCE_OVERWRITE = "PLAN_TEST_FORCE_OVERWRITE"
 
-  /** Verify the json plan for the given insert statement. */
+  /** Verify the serialized JSON of [[CompiledPlan]] for the given insert statement. */
   def verifyJsonPlan(insert: String): Unit = {
     ExecNodeContext.resetIdCounter()
     val jsonPlan = getTableEnv.asInstanceOf[TableEnvironmentInternal].compilePlanSql(insert)
@@ -828,8 +829,20 @@ abstract class TableTestUtilBase(test: TableTestBase, isStreamingMode: Boolean)
     } else {
       val expected = String.join("\n", Files.readAllLines(path))
       assertEquals(
-        TableTestUtil.replaceExecNodeId(TableTestUtil.getFormattedJson(expected)),
-        TableTestUtil.replaceExecNodeId(TableTestUtil.getFormattedJson(jsonPlanWithoutFlinkVersion))
+        TableTestUtil.replaceExecNodeId(TableTestUtil.getPrettyJson(expected)),
+        TableTestUtil.replaceExecNodeId(TableTestUtil.getPrettyJson(jsonPlanWithoutFlinkVersion))
+      )
+      // check json serde round trip as well
+      val expectedWithFlinkVersion = JsonTestUtils.writeToString(
+        JsonTestUtils
+          .setFlinkVersion(JsonTestUtils.readFromString(expected), FlinkVersion.current()))
+      assertEquals(
+        TableTestUtil.replaceExecNodeId(TableTestUtil.getFormattedJson(expectedWithFlinkVersion)),
+        TableTestUtil.replaceExecNodeId(
+          TableTestUtil.getFormattedJson(
+            getPlanner
+              .loadPlan(PlanReference.fromJsonString(expectedWithFlinkVersion))
+              .asJsonString()))
       )
     }
   }
