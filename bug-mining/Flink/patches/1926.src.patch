diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/rpc/akka/FencedAkkaRpcActor.java b/flink-runtime/src/main/java/org/apache/flink/runtime/rpc/akka/FencedAkkaRpcActor.java
index b10f7deccec..1ace3b79fdb 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/rpc/akka/FencedAkkaRpcActor.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/rpc/akka/FencedAkkaRpcActor.java
@@ -58,7 +58,10 @@ public class FencedAkkaRpcActor<F extends Serializable, T extends FencedRpcEndpo
 						"not match the expected fencing token {}.", message, fencingToken, rpcEndpoint.getFencingToken());
 				}
 
-				sendErrorIfSender(new FencingTokenMismatchException("Expected fencing token " + rpcEndpoint.getFencingToken() + ", actual fencing token " + fencingToken));
+				sendErrorIfSender(
+					new FencingTokenMismatchException("Fencing token mismatch: Ignoring message " + message +
+						" because the fencing token " + fencingToken + " did not match the expected fencing token " +
+						rpcEndpoint.getFencingToken() + '.'));
 			}
 		} else if (message instanceof UnfencedMessage) {
 			super.handleMessage(((UnfencedMessage<?>) message).getPayload());
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorITCase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorITCase.java
index 348dce647e0..e448cccbcaa 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorITCase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/taskexecutor/TaskExecutorITCase.java
@@ -68,6 +68,7 @@ import java.util.concurrent.CompletableFuture;
 import java.util.concurrent.ScheduledExecutorService;
 import java.util.concurrent.ScheduledThreadPoolExecutor;
 
+import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertTrue;
 import static org.mockito.Matchers.any;
 import static org.mockito.Matchers.argThat;
@@ -188,7 +189,10 @@ public class TaskExecutorITCase extends TestLogger {
 			final ResourceManagerGateway rmGateway = resourceManager.getSelfGateway(ResourceManagerGateway.class);
 
 			// notify the RM that it is the leader
-			rmLeaderElectionService.isLeader(rmLeaderId);
+			CompletableFuture<UUID> isLeaderFuture = rmLeaderElectionService.isLeader(rmLeaderId);
+
+			// wait for the completion of the leader election
+			assertEquals(rmLeaderId, isLeaderFuture.get());
 
 			// notify the TM about the new RM leader
 			rmLeaderRetrievalService.notifyListener(rmAddress, rmLeaderId);
@@ -216,6 +220,8 @@ public class TaskExecutorITCase extends TestLogger {
 			if (testingFatalErrorHandler.hasExceptionOccurred()) {
 				testingFatalErrorHandler.rethrowError();
 			}
+
+			rpcService.stopService();
 		}
 
 
