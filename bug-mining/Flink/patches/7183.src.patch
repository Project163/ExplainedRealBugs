diff --git a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/reuse/ReusableScanVisitor.java b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/reuse/ReusableScanVisitor.java
index a74bb819018..b0b4050ccb2 100644
--- a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/reuse/ReusableScanVisitor.java
+++ b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/reuse/ReusableScanVisitor.java
@@ -42,6 +42,11 @@ public class ReusableScanVisitor extends RelVisitor {
             CommonPhysicalTableSourceScan scan = (CommonPhysicalTableSourceScan) node;
             String digest = getDigest(scan, true);
             digestToReusableScans.computeIfAbsent(digest, k -> new ArrayList<>()).add(scan);
+            // If the scan has input such as dpp dynamic scan node, so also need to consider the
+            // input
+            if (!scan.getInputs().isEmpty()) {
+                super.visit(scan.getInput(0), 0, scan);
+            }
         } else {
             super.visit(node, ordinal, parent);
         }
diff --git a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/reuse/ScanReuserUtils.java b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/reuse/ScanReuserUtils.java
index effadac1ada..5c79cd4cd25 100644
--- a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/reuse/ScanReuserUtils.java
+++ b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/planner/plan/reuse/ScanReuserUtils.java
@@ -329,6 +329,17 @@ public class ScanReuserUtils {
         TableSourceTable table = scan.tableSourceTable();
         List<String> digest = new ArrayList<>();
         digest.addAll(table.getNames());
+
+        // input should be the first item
+        if (!scan.getInputs().isEmpty()) {
+            digest.add(
+                    "input=["
+                            + scan.getInputs().stream()
+                                    .map(RelNode::getDigest)
+                                    .collect(Collectors.joining(","))
+                            + "]");
+        }
+
         if (withoutEscape) {
             digest.addAll(extraDigestsWithoutEscapedAndIgnored(table));
         } else {
diff --git a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/optimize/program/DynamicPartitionPruningProgramTest.java b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/optimize/program/DynamicPartitionPruningProgramTest.java
index 8e957e2958a..dd776667a15 100644
--- a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/optimize/program/DynamicPartitionPruningProgramTest.java
+++ b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/plan/optimize/program/DynamicPartitionPruningProgramTest.java
@@ -76,6 +76,7 @@ public class DynamicPartitionPruningProgramTest extends TableTestBase {
                                 + "  dim_date_sk BIGINT\n"
                                 + ") WITH (\n"
                                 + " 'connector' = 'values',\n"
+                                + " 'runtime-source' = 'NewSource',\n"
                                 + " 'bounded' = 'true'\n"
                                 + ")");
     }
@@ -658,4 +659,44 @@ public class DynamicPartitionPruningProgramTest extends TableTestBase {
                         + " and dim.price < 500 and dim.price > 300";
         util.verifyRelPlan(query);
     }
+
+    @Test
+    public void testDppFactSideCannotReuseWithSameCommonSource() {
+        String query =
+                "SELECT * FROM(\n"
+                        + " Select fact_part.id, fact_part.price, fact_part.amount from fact_part join (Select * from dim) t1"
+                        + " on fact_part.fact_date_sk = dim_date_sk where t1.price < 500\n"
+                        + " UNION ALL Select fact_part.id, fact_part.price, fact_part.amount from fact_part)";
+        util.verifyExecPlan(query);
+    }
+
+    @Test
+    public void testDimSideReuseAfterProjectionPushdown() {
+        util.tableEnv()
+                .executeSql(
+                        "CREATE TABLE fact_part2 (\n"
+                                + "  id BIGINT,\n"
+                                + "  name STRING,\n"
+                                + "  amount BIGINT,\n"
+                                + "  price BIGINT,\n"
+                                + "  fact_date_sk BIGINT\n"
+                                + ") PARTITIONED BY (fact_date_sk)\n"
+                                + "WITH (\n"
+                                + " 'connector' = 'values',\n"
+                                + " 'runtime-source' = 'NewSource',\n"
+                                + " 'partition-list' = 'fact_date_sk:1990;fact_date_sk:1991;fact_date_sk:1992',\n"
+                                + " 'dynamic-filtering-fields' = 'fact_date_sk;amount',\n"
+                                + " 'bounded' = 'true'\n"
+                                + ")");
+
+        String query =
+                "SELECT /*+ BROADCAST(dim) */ fact3.* FROM\n"
+                        + "(SELECT /*+ BROADCAST(dim) */ fact.id, fact.price, fact.amount FROM (\n"
+                        + " SELECT id, price, amount, fact_date_sk FROM fact_part "
+                        + " UNION ALL SELECT id, price, amount, fact_date_sk FROM fact_part2) fact, dim\n"
+                        + " WHERE fact_date_sk = dim_date_sk"
+                        + " and dim.price < 500 and dim.price > 300)\n fact3 JOIN dim"
+                        + " ON fact3.amount = dim.id AND dim.amount < 10";
+        util.verifyExecPlan(query);
+    }
 }
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/batch/sql/DynamicFilteringTest.xml b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/batch/sql/DynamicFilteringTest.xml
index 79f393a63c7..0731970c05a 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/batch/sql/DynamicFilteringTest.xml
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/batch/sql/DynamicFilteringTest.xml
@@ -145,10 +145,7 @@ Calc(select=[a1, b1, c1, p1, x, y, z, p, a10, b10, c10, p10])
    :           +- TableSourceScan(table=[[default_catalog, default_database, dim, filter=[]]], fields=[x, y, z, p])
    +- Exchange(distribution=[hash[b10]])
       +- Calc(select=[a1, b1, c1, p1, CAST(b1 AS BIGINT) AS b10])
-         +- DynamicFilteringTableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])
-            +- DynamicFilteringDataCollector(fields=[p])
-               +- Calc(select=[x, y, z, p], where=[>(x, 10)])
-                  +- TableSourceScan(table=[[default_catalog, default_database, dim, filter=[]]], fields=[x, y, z, p])
+         +- TableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])
 
 == Optimized Execution Plan ==
 Calc(select=[a1, b1, c1, p1, x, y, z, p, a10, b10, c10, p10])
@@ -156,7 +153,7 @@ Calc(select=[a1, b1, c1, p1, x, y, z, p, a10, b10, c10, p10])
    :- Exchange(distribution=[hash[y]])
    :  +- HashJoin(joinType=[InnerJoin], where=[(p1 = p)], select=[a1, b1, c1, p1, x, y, z, p], build=[right])
    :     :- Exchange(distribution=[hash[p1]])
-   :     :  +- DynamicFilteringTableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])(reuse_id=[2])
+   :     :  +- DynamicFilteringTableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])
    :     :     +- DynamicFilteringDataCollector(fields=[p])
    :     :        +- Calc(select=[x, y, z, p], where=[(x > 10)])(reuse_id=[1])
    :     :           +- TableSourceScan(table=[[default_catalog, default_database, dim, filter=[]]], fields=[x, y, z, p])
@@ -164,7 +161,7 @@ Calc(select=[a1, b1, c1, p1, x, y, z, p, a10, b10, c10, p10])
    :        +- Reused(reference_id=[1])
    +- Exchange(distribution=[hash[b10]])
       +- Calc(select=[a1, b1, c1, p1, CAST(b1 AS BIGINT) AS b10])
-         +- Reused(reference_id=[2])
+         +- TableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])
 
 == Physical Execution Plan ==
 {
@@ -232,6 +229,12 @@ Calc(select=[a1, b1, c1, p1, x, y, z, p, a10, b10, c10, p10])
       "ship_strategy" : "HASH[p1]",
       "side" : "second"
     } ]
+  }, {
+    "id" : ,
+    "type" : "Source: fact1[]",
+    "pact" : "Data Source",
+    "contents" : "[]:TableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])",
+    "parallelism" : 10
   }, {
     "id" : ,
     "type" : "Calc[]",
@@ -302,10 +305,7 @@ Calc(select=[a1, b1, c1, p1, x, y, z, p, a10, b10, c10, p10])
    :           +- TableSourceScan(table=[[default_catalog, default_database, dim, filter=[]]], fields=[x, y, z, p])
    +- Exchange(distribution=[hash[b10]])
       +- Calc(select=[a1, b1, c1, p1, CAST(b1 AS BIGINT) AS b10])
-         +- DynamicFilteringTableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])
-            +- DynamicFilteringDataCollector(fields=[p])
-               +- Calc(select=[x, y, z, p], where=[>(x, 10)])
-                  +- TableSourceScan(table=[[default_catalog, default_database, dim, filter=[]]], fields=[x, y, z, p])
+         +- TableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])
 
 == Optimized Execution Plan ==
 Calc(select=[a1, b1, c1, p1, x, y, z, p, a10, b10, c10, p10])
@@ -313,16 +313,16 @@ Calc(select=[a1, b1, c1, p1, x, y, z, p, a10, b10, c10, p10])
    :- Exchange(distribution=[hash[y]])
    :  +- HashJoin(joinType=[InnerJoin], where=[(p1 = p)], select=[a1, b1, c1, p1, x, y, z, p], build=[right])
    :     :- Exchange(distribution=[hash[p1]])
-   :     :  +- DynamicFilteringTableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])(reuse_id=[2])
+   :     :  +- DynamicFilteringTableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])
    :     :     +- Exchange(distribution=[any], shuffle_mode=[BATCH])
    :     :        +- DynamicFilteringDataCollector(fields=[p])
    :     :           +- Calc(select=[x, y, z, p], where=[(x > 10)])(reuse_id=[1])
    :     :              +- TableSourceScan(table=[[default_catalog, default_database, dim, filter=[]]], fields=[x, y, z, p])
    :     +- Exchange(distribution=[hash[p]], shuffle_mode=[BATCH])
    :        +- Reused(reference_id=[1])
-   +- Exchange(distribution=[hash[b10]], shuffle_mode=[BATCH])
+   +- Exchange(distribution=[hash[b10]])
       +- Calc(select=[a1, b1, c1, p1, CAST(b1 AS BIGINT) AS b10])
-         +- Reused(reference_id=[2])
+         +- TableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])
 
 == Physical Execution Plan ==
 {
@@ -390,6 +390,12 @@ Calc(select=[a1, b1, c1, p1, x, y, z, p, a10, b10, c10, p10])
       "ship_strategy" : "HASH[p1]",
       "side" : "second"
     } ]
+  }, {
+    "id" : ,
+    "type" : "Source: fact1[]",
+    "pact" : "Data Source",
+    "contents" : "[]:TableSourceScan(table=[[default_catalog, default_database, fact1]], fields=[a1, b1, c1, p1])",
+    "parallelism" : 10
   }, {
     "id" : ,
     "type" : "Calc[]",
diff --git a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/optimize/program/DynamicPartitionPruningProgramTest.xml b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/optimize/program/DynamicPartitionPruningProgramTest.xml
index 115df42c3bd..4ba1f656e7e 100644
--- a/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/optimize/program/DynamicPartitionPruningProgramTest.xml
+++ b/flink-table/flink-table-planner/src/test/resources/org/apache/flink/table/planner/plan/optimize/program/DynamicPartitionPruningProgramTest.xml
@@ -140,6 +140,48 @@ HashJoin(joinType=[InnerJoin], where=[=(fact_date_sk, dim_date_sk)], select=[id,
       :        +- TableSourceScan(table=[[testCatalog, test_database, sales, filter=[]]], fields=[id, amount, price])
       +- Exchange(distribution=[hash[id]])
          +- TableSourceScan(table=[[testCatalog, test_database, item]], fields=[id, amount, price])
+]]>
+    </Resource>
+  </TestCase>
+  <TestCase name="testDimSideReuseAfterProjectionPushdown">
+    <Resource name="sql">
+      <![CDATA[SELECT /*+ BROADCAST(dim) */ fact3.* FROM
+(SELECT /*+ BROADCAST(dim) */ fact.id, fact.price, fact.amount FROM (
+ SELECT id, price, amount, fact_date_sk FROM fact_part  UNION ALL SELECT id, price, amount, fact_date_sk FROM fact_part2) fact, dim
+ WHERE fact_date_sk = dim_date_sk and dim.price < 500 and dim.price > 300)
+ fact3 JOIN dim ON fact3.amount = dim.id AND dim.amount < 10]]>
+    </Resource>
+    <Resource name="ast">
+      <![CDATA[
+LogicalProject(id=[$0], price=[$1], amount=[$2])
++- LogicalJoin(condition=[AND(=($2, $3), <($5, 10))], joinType=[inner], joinHints=[[[BROADCAST inheritPath:[0] options:[dim]]]])
+   :- LogicalProject(id=[$0], price=[$1], amount=[$2])
+   :  +- LogicalFilter(condition=[AND(=($3, $8), <($7, 500), >($7, 300))])
+   :     +- LogicalJoin(condition=[true], joinType=[inner], joinHints=[[[BROADCAST inheritPath:[0, 0] options:[dim]]]])
+   :        :- LogicalUnion(all=[true])
+   :        :  :- LogicalProject(id=[$0], price=[$3], amount=[$2], fact_date_sk=[$4])
+   :        :  :  +- LogicalTableScan(table=[[testCatalog, test_database, fact_part]], hints=[[[ALIAS inheritPath:[] options:[fact_part]]]])
+   :        :  +- LogicalProject(id=[$0], price=[$3], amount=[$2], fact_date_sk=[$4])
+   :        :     +- LogicalTableScan(table=[[testCatalog, test_database, fact_part2]], hints=[[[ALIAS inheritPath:[] options:[fact_part2]]]])
+   :        +- LogicalTableScan(table=[[testCatalog, test_database, dim]], hints=[[[ALIAS inheritPath:[] options:[dim]]]])
+   +- LogicalTableScan(table=[[testCatalog, test_database, dim]], hints=[[[ALIAS inheritPath:[] options:[dim]]]])
+]]>
+    </Resource>
+    <Resource name="optimized exec plan">
+      <![CDATA[
+Calc(select=[id, price, amount])
++- MultipleInput(readOrder=[0,0,1,1], members=[\nHashJoin(joinType=[InnerJoin], where=[(amount = id0)], select=[id, price, amount, id0], isBroadcast=[true], build=[right])\n:- Calc(select=[id, price, amount])\n:  +- HashJoin(joinType=[InnerJoin], where=[(fact_date_sk = dim_date_sk)], select=[id, price, amount, fact_date_sk, dim_date_sk], isBroadcast=[true], build=[right])\n:     :- Union(all=[true], union=[id, price, amount, fact_date_sk])\n:     :  :- [#3] DynamicFilteringTableSourceScan(table=[[testCatalog, test_database, fact_part, project=[id, price, amount, fact_date_sk], metadata=[]]], fields=[id, price, amount, fact_date_sk])\n:     :  +- [#4] DynamicFilteringTableSourceScan(table=[[testCatalog, test_database, fact_part2, project=[id, price, amount, fact_date_sk], metadata=[]]], fields=[id, price, amount, fact_date_sk])\n:     +- [#2] Exchange(distribution=[broadcast])\n+- [#1] Exchange(distribution=[broadcast])\n])
+   :- Exchange(distribution=[broadcast])
+   :  +- Calc(select=[id], where=[(amount < 10)])(reuse_id=[2])
+   :     +- TableSourceScan(table=[[testCatalog, test_database, dim, filter=[], project=[id, amount, price, dim_date_sk], metadata=[]]], fields=[id, amount, price, dim_date_sk])(reuse_id=[1])
+   :- Exchange(distribution=[broadcast])
+   :  +- Calc(select=[dim_date_sk], where=[SEARCH(price, Sarg[(300..500)])])
+   :     +- Reused(reference_id=[1])
+   :- DynamicFilteringTableSourceScan(table=[[testCatalog, test_database, fact_part, project=[id, price, amount, fact_date_sk], metadata=[]]], fields=[id, price, amount, fact_date_sk])
+   :  +- DynamicFilteringDataCollector(fields=[id])(reuse_id=[3])
+   :     +- Reused(reference_id=[2])
+   +- DynamicFilteringTableSourceScan(table=[[testCatalog, test_database, fact_part2, project=[id, price, amount, fact_date_sk], metadata=[]]], fields=[id, price, amount, fact_date_sk])
+      +- Reused(reference_id=[3])
 ]]>
     </Resource>
   </TestCase>
@@ -240,6 +282,42 @@ HashJoin(joinType=[InnerJoin], where=[=(fact_date_sk, dim_date_sk)], select=[id,
 :     +- TableSourceScan(table=[[testCatalog, test_database, dim, filter=[]]], fields=[id, male, amount, price, dim_date_sk])
 +- Exchange(distribution=[hash[fact_date_sk]])
    +- TableSourceScan(table=[[testCatalog, test_database, fact_part]], fields=[id, name, amount, price, fact_date_sk])
+]]>
+    </Resource>
+  </TestCase>
+  <TestCase name="testDppFactSideCannotReuseWithSameCommonSource">
+    <Resource name="sql">
+      <![CDATA[SELECT * FROM(
+ Select fact_part.id, fact_part.price, fact_part.amount from fact_part join (Select * from dim) t1 on fact_part.fact_date_sk = dim_date_sk where t1.price < 500
+ UNION ALL Select fact_part.id, fact_part.price, fact_part.amount from fact_part)]]>
+    </Resource>
+    <Resource name="ast">
+      <![CDATA[
+LogicalProject(id=[$0], price=[$1], amount=[$2])
++- LogicalUnion(all=[true])
+   :- LogicalProject(id=[$0], price=[$3], amount=[$2])
+   :  +- LogicalFilter(condition=[<($8, 500)])
+   :     +- LogicalJoin(condition=[=($4, $9)], joinType=[inner])
+   :        :- LogicalTableScan(table=[[testCatalog, test_database, fact_part]])
+   :        +- LogicalProject(id=[$0], male=[$1], amount=[$2], price=[$3], dim_date_sk=[$4])
+   :           +- LogicalTableScan(table=[[testCatalog, test_database, dim]])
+   +- LogicalProject(id=[$0], price=[$3], amount=[$2])
+      +- LogicalTableScan(table=[[testCatalog, test_database, fact_part]])
+]]>
+    </Resource>
+    <Resource name="optimized exec plan">
+      <![CDATA[
+Union(all=[true], union=[id, price, amount])
+:- Calc(select=[id, price, amount])
+:  +- HashJoin(joinType=[InnerJoin], where=[(fact_date_sk = dim_date_sk)], select=[id, amount, price, fact_date_sk, dim_date_sk], build=[right])
+:     :- Exchange(distribution=[hash[fact_date_sk]])
+:     :  +- DynamicFilteringTableSourceScan(table=[[testCatalog, test_database, fact_part, project=[id, amount, price, fact_date_sk], metadata=[]]], fields=[id, amount, price, fact_date_sk])
+:     :     +- DynamicFilteringDataCollector(fields=[dim_date_sk])
+:     :        +- Calc(select=[dim_date_sk], where=[(price < 500)])(reuse_id=[1])
+:     :           +- TableSourceScan(table=[[testCatalog, test_database, dim, filter=[], project=[price, dim_date_sk], metadata=[]]], fields=[price, dim_date_sk])
+:     +- Exchange(distribution=[hash[dim_date_sk]])
+:        +- Reused(reference_id=[1])
++- TableSourceScan(table=[[testCatalog, test_database, fact_part, project=[id, price, amount], metadata=[]]], fields=[id, price, amount])
 ]]>
     </Resource>
   </TestCase>
@@ -541,17 +619,18 @@ HashJoin(joinType=[InnerJoin], where=[=(fact_date_sk, dim_date_sk)], select=[id,
 :     :     +- DynamicFilteringDataCollector(fields=[dim_date_sk])
 :     :        +- HashJoin(joinType=[LeftSemiJoin], where=[=(price, price0)], select=[id, male, amount, price, dim_date_sk], build=[right])
 :     :           :- Exchange(distribution=[hash[price]])
-:     :           :  +- TableSourceScan(table=[[testCatalog, test_database, dim]], fields=[id, male, amount, price, dim_date_sk])
+:     :           :  +- TableSourceScan(table=[[testCatalog, test_database, dim, project=[id, male, amount, price, dim_date_sk], metadata=[]]], fields=[id, male, amount, price, dim_date_sk])
 :     :           +- Exchange(distribution=[hash[price]])
 :     :              +- Calc(select=[price])
 :     :                 +- NestedLoopJoin(joinType=[InnerJoin], where=[=(amount, $f0)], select=[amount, price, $f0], build=[right], singleRowJoin=[true])
-:     :                    :- TableSourceScan(table=[[testCatalog, test_database, dim, project=[amount, price], metadata=[]]], fields=[amount, price])
+:     :                    :- Calc(select=[amount, price])
+:     :                    :  +- TableSourceScan(table=[[testCatalog, test_database, dim, project=[id, male, amount, price, dim_date_sk], metadata=[]]], fields=[id, male, amount, price, dim_date_sk])
 :     :                    +- Exchange(distribution=[broadcast])
 :     :                       +- HashAggregate(isMerge=[true], select=[Final_SINGLE_VALUE(value$0, count$1) AS $f0])
 :     :                          +- Exchange(distribution=[single])
 :     :                             +- LocalHashAggregate(select=[Partial_SINGLE_VALUE(amount) AS (value$0, count$1)])
 :     :                                +- Calc(select=[CAST(2000 AS BIGINT) AS amount], where=[=(amount, 2000)])
-:     :                                   +- TableSourceScan(table=[[testCatalog, test_database, dim, filter=[], project=[amount], metadata=[]]], fields=[amount])
+:     :                                   +- TableSourceScan(table=[[testCatalog, test_database, dim, project=[id, male, amount, price, dim_date_sk], metadata=[]]], fields=[id, male, amount, price, dim_date_sk])
 :     +- Exchange(distribution=[hash[id]])
 :        +- TableSourceScan(table=[[testCatalog, test_database, item]], fields=[id, amount, price])
 +- Exchange(distribution=[hash[dim_date_sk]])
