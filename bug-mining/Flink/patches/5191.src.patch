diff --git a/flink-connectors/flink-connector-kafka/src/main/java/org/apache/flink/connector/kafka/source/enumerator/KafkaSourceEnumerator.java b/flink-connectors/flink-connector-kafka/src/main/java/org/apache/flink/connector/kafka/source/enumerator/KafkaSourceEnumerator.java
index 92ac770f31a..1f3f3c64e7b 100644
--- a/flink-connectors/flink-connector-kafka/src/main/java/org/apache/flink/connector/kafka/source/enumerator/KafkaSourceEnumerator.java
+++ b/flink-connectors/flink-connector-kafka/src/main/java/org/apache/flink/connector/kafka/source/enumerator/KafkaSourceEnumerator.java
@@ -407,7 +407,12 @@ public class KafkaSourceEnumerator
                         .thenApply(
                                 result -> {
                                     Map<TopicPartition, Long> offsets = new HashMap<>();
-                                    result.forEach((tp, oam) -> offsets.put(tp, oam.offset()));
+                                    result.forEach(
+                                            (tp, oam) -> {
+                                                if (oam != null) {
+                                                    offsets.put(tp, oam.offset());
+                                                }
+                                            });
                                     return offsets;
                                 })
                         .get();
