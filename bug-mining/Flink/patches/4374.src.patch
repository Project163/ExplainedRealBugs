diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/CheckpointFailureManager.java b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/CheckpointFailureManager.java
index a994351dbc4..1618b3a0526 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/CheckpointFailureManager.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/CheckpointFailureManager.java
@@ -40,6 +40,7 @@ public class CheckpointFailureManager {
 	private final FailJobCallback failureCallback;
 	private final AtomicInteger continuousFailureCounter;
 	private final Set<Long> countedCheckpointIds;
+	private long lastSucceededCheckpointId = Long.MIN_VALUE;
 
 	public CheckpointFailureManager(int tolerableCpFailureNumber, FailJobCallback failureCallback) {
 		checkArgument(tolerableCpFailureNumber >= 0,
@@ -82,10 +83,12 @@ public class CheckpointFailureManager {
 	}
 
 	private void handleCheckpointException(CheckpointException exception, long checkpointId, Consumer<FlinkRuntimeException> errorHandler) {
-		checkFailureCounter(exception, checkpointId);
-		if (continuousFailureCounter.get() > tolerableCpFailureNumber) {
-			clearCount();
-			errorHandler.accept(new FlinkRuntimeException("Exceeded checkpoint tolerable failure threshold."));
+		if (checkpointId > lastSucceededCheckpointId) {
+			checkFailureCounter(exception, checkpointId);
+			if (continuousFailureCounter.get() > tolerableCpFailureNumber) {
+				clearCount();
+				errorHandler.accept(new FlinkRuntimeException("Exceeded checkpoint tolerable failure threshold."));
+			}
 		}
 	}
 
@@ -146,8 +149,11 @@ public class CheckpointFailureManager {
 	 * @param checkpointId the failed checkpoint id used to count the continuous failure number based on
 	 *                     checkpoint id sequence.
 	 */
-	public void handleCheckpointSuccess(@SuppressWarnings("unused") long checkpointId) {
-		clearCount();
+	public void handleCheckpointSuccess(long checkpointId) {
+		if (checkpointId > lastSucceededCheckpointId) {
+			lastSucceededCheckpointId = checkpointId;
+			clearCount();
+		}
 	}
 
 	private void clearCount() {
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/CheckpointFailureManagerTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/CheckpointFailureManagerTest.java
index 8d43ed75c28..974657f3d02 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/CheckpointFailureManagerTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/CheckpointFailureManagerTest.java
@@ -22,6 +22,7 @@ import org.apache.flink.util.TestLogger;
 
 import org.junit.Test;
 
+import static org.apache.flink.runtime.checkpoint.CheckpointFailureReason.CHECKPOINT_EXPIRED;
 import static org.junit.Assert.assertEquals;
 
 /**
@@ -29,6 +30,19 @@ import static org.junit.Assert.assertEquals;
  */
 public class CheckpointFailureManagerTest extends TestLogger {
 
+	@Test
+	public void testIgnoresPastCheckpoints() {
+		TestFailJobCallback callback = new TestFailJobCallback();
+		CheckpointFailureManager failureManager = new CheckpointFailureManager(2, callback);
+		failureManager.handleJobLevelCheckpointException(new CheckpointException(CHECKPOINT_EXPIRED), 1L);
+		failureManager.handleJobLevelCheckpointException(new CheckpointException(CHECKPOINT_EXPIRED), 2L);
+		failureManager.handleCheckpointSuccess(2L);
+		failureManager.handleJobLevelCheckpointException(new CheckpointException(CHECKPOINT_EXPIRED), 1L);
+		failureManager.handleJobLevelCheckpointException(new CheckpointException(CHECKPOINT_EXPIRED), 3L);
+		failureManager.handleJobLevelCheckpointException(new CheckpointException(CHECKPOINT_EXPIRED), 4L);
+		assertEquals(0, callback.getInvokeCounter());
+	}
+
 	@Test
 	public void testContinuousFailure() {
 		TestFailJobCallback callback = new TestFailJobCallback();
@@ -64,7 +78,7 @@ public class CheckpointFailureManagerTest extends TestLogger {
 		failureManager.handleCheckpointSuccess(4);
 
 		failureManager.handleJobLevelCheckpointException(
-			new CheckpointException(CheckpointFailureReason.CHECKPOINT_EXPIRED), 5);
+			new CheckpointException(CHECKPOINT_EXPIRED), 5);
 		assertEquals(0, callback.getInvokeCounter());
 	}
 
