diff --git a/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/table/TestContext.java b/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/table/TestContext.java
index e4978fc118a..32db4d35414 100644
--- a/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/table/TestContext.java
+++ b/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/table/TestContext.java
@@ -69,6 +69,11 @@ class TestContext {
 			public ClassLoader getClassLoader() {
 				return TestContext.class.getClassLoader();
 			}
+
+			@Override
+			public boolean isTemporary() {
+				return false;
+			}
 		};
 	}
 
diff --git a/flink-connectors/flink-connector-hbase-1.4/src/test/java/org/apache/flink/connector/hbase1/HBaseDynamicTableFactoryTest.java b/flink-connectors/flink-connector-hbase-1.4/src/test/java/org/apache/flink/connector/hbase1/HBaseDynamicTableFactoryTest.java
index 9a901c3d053..edb61d7726a 100644
--- a/flink-connectors/flink-connector-hbase-1.4/src/test/java/org/apache/flink/connector/hbase1/HBaseDynamicTableFactoryTest.java
+++ b/flink-connectors/flink-connector-hbase-1.4/src/test/java/org/apache/flink/connector/hbase1/HBaseDynamicTableFactoryTest.java
@@ -334,7 +334,8 @@ public class HBaseDynamicTableFactoryTest {
 			ObjectIdentifier.of("default", "default", "t1"),
 			new CatalogTableImpl(schema, options, "mock source"),
 			new Configuration(),
-			HBase1DynamicTableFactory.class.getClassLoader());
+			HBase1DynamicTableFactory.class.getClassLoader(),
+			false);
 	}
 
 	private static DynamicTableSink createTableSink(TableSchema schema, Map<String, String> options) {
@@ -343,7 +344,8 @@ public class HBaseDynamicTableFactoryTest {
 			ObjectIdentifier.of("default", "default", "t1"),
 			new CatalogTableImpl(schema, options, "mock sink"),
 			new Configuration(),
-			HBase1DynamicTableFactory.class.getClassLoader());
+			HBase1DynamicTableFactory.class.getClassLoader(),
+			false);
 	}
 
 }
diff --git a/flink-connectors/flink-connector-hbase-2.2/src/test/java/org/apache/flink/connector/hbase2/HBaseDynamicTableFactoryTest.java b/flink-connectors/flink-connector-hbase-2.2/src/test/java/org/apache/flink/connector/hbase2/HBaseDynamicTableFactoryTest.java
index 94530b50071..81a73d2e57b 100644
--- a/flink-connectors/flink-connector-hbase-2.2/src/test/java/org/apache/flink/connector/hbase2/HBaseDynamicTableFactoryTest.java
+++ b/flink-connectors/flink-connector-hbase-2.2/src/test/java/org/apache/flink/connector/hbase2/HBaseDynamicTableFactoryTest.java
@@ -325,7 +325,8 @@ public class HBaseDynamicTableFactoryTest {
 			ObjectIdentifier.of("default", "default", "t1"),
 			new CatalogTableImpl(schema, options, "mock source"),
 			new Configuration(),
-			HBase2DynamicTableFactory.class.getClassLoader());
+			HBase2DynamicTableFactory.class.getClassLoader(),
+			false);
 	}
 
 	private static DynamicTableSink createTableSink(TableSchema schema, Map<String, String> options) {
@@ -334,7 +335,8 @@ public class HBaseDynamicTableFactoryTest {
 			ObjectIdentifier.of("default", "default", "t1"),
 			new CatalogTableImpl(schema, options, "mock sink"),
 			new Configuration(),
-			HBase2DynamicTableFactory.class.getClassLoader());
+			HBase2DynamicTableFactory.class.getClassLoader(),
+			false);
 	}
 
 }
diff --git a/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveDynamicTableFactory.java b/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveDynamicTableFactory.java
index 56086fd77af..98ae3e77671 100644
--- a/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveDynamicTableFactory.java
+++ b/flink-connectors/flink-connector-hive/src/main/java/org/apache/flink/connectors/hive/HiveDynamicTableFactory.java
@@ -73,7 +73,8 @@ public class HiveDynamicTableFactory implements
 				context.getObjectIdentifier(),
 				removeIsGenericFlag(context.getCatalogTable()),
 				context.getConfiguration(),
-				context.getClassLoader());
+				context.getClassLoader(),
+				false);
 	}
 
 	@Override
@@ -83,6 +84,7 @@ public class HiveDynamicTableFactory implements
 				context.getObjectIdentifier(),
 				removeIsGenericFlag(context.getCatalogTable()),
 				context.getConfiguration(),
-				context.getClassLoader());
+				context.getClassLoader(),
+				false);
 	}
 }
diff --git a/flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcDynamicTableFactoryTest.java b/flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcDynamicTableFactoryTest.java
index 807f1095b91..d56727f93e6 100644
--- a/flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcDynamicTableFactoryTest.java
+++ b/flink-connectors/flink-connector-jdbc/src/test/java/org/apache/flink/connector/jdbc/table/JdbcDynamicTableFactoryTest.java
@@ -298,7 +298,8 @@ public class JdbcDynamicTableFactoryTest {
 			ObjectIdentifier.of("default", "default", "t1"),
 			new CatalogTableImpl(JdbcDynamicTableFactoryTest.schema, options, "mock source"),
 			new Configuration(),
-			JdbcDynamicTableFactoryTest.class.getClassLoader());
+			JdbcDynamicTableFactoryTest.class.getClassLoader(),
+			false);
 	}
 
 	private static DynamicTableSink createTableSink(Map<String, String> options) {
@@ -307,6 +308,7 @@ public class JdbcDynamicTableFactoryTest {
 			ObjectIdentifier.of("default", "default", "t1"),
 			new CatalogTableImpl(JdbcDynamicTableFactoryTest.schema, options, "mock sink"),
 			new Configuration(),
-			JdbcDynamicTableFactoryTest.class.getClassLoader());
+			JdbcDynamicTableFactoryTest.class.getClassLoader(),
+			false);
 	}
 }
diff --git a/flink-connectors/flink-connector-kafka-base/src/test/java/org/apache/flink/streaming/connectors/kafka/table/KafkaDynamicTableFactoryTestBase.java b/flink-connectors/flink-connector-kafka-base/src/test/java/org/apache/flink/streaming/connectors/kafka/table/KafkaDynamicTableFactoryTestBase.java
index d084613a4a2..5d1938f5d0e 100644
--- a/flink-connectors/flink-connector-kafka-base/src/test/java/org/apache/flink/streaming/connectors/kafka/table/KafkaDynamicTableFactoryTestBase.java
+++ b/flink-connectors/flink-connector-kafka-base/src/test/java/org/apache/flink/streaming/connectors/kafka/table/KafkaDynamicTableFactoryTestBase.java
@@ -149,7 +149,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 				objectIdentifier,
 				catalogTable,
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 
 		// Test scan source equals
 		final KafkaDynamicSourceBase expectedKafkaSource = getExpectedScanSource(
@@ -189,7 +190,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 			objectIdentifier,
 			catalogTable,
 			new Configuration(),
-			Thread.currentThread().getContextClassLoader());
+			Thread.currentThread().getContextClassLoader(),
+			false);
 
 		// Test commitOnCheckpoints flag should be false when do not set consumer group.
 		assertThat(tableSource, instanceOf(KafkaDynamicSourceBase.class));
@@ -230,7 +232,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 			objectIdentifier,
 			catalogTable,
 			new Configuration(),
-			Thread.currentThread().getContextClassLoader());
+			Thread.currentThread().getContextClassLoader(),
+			false);
 
 		// Test scan source equals
 		final KafkaDynamicSourceBase expectedKafkaSource = getExpectedScanSource(
@@ -271,7 +274,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 				objectIdentifier,
 				sinkTable,
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 
 		final DynamicTableSink expectedSink = getExpectedSink(
 				consumedDataType,
@@ -321,7 +325,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 				objectIdentifier,
 				catalogTable,
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 	}
 
 	@Test
@@ -345,7 +350,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 			objectIdentifier,
 			catalogTable,
 			new Configuration(),
-			Thread.currentThread().getContextClassLoader());
+			Thread.currentThread().getContextClassLoader(),
+			false);
 	}
 
 	@Test
@@ -369,7 +375,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 				objectIdentifier,
 				catalogTable,
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 	}
 
 	@Test
@@ -393,7 +400,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 				objectIdentifier,
 				catalogTable,
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 	}
 
 	@Test
@@ -417,7 +425,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 				objectIdentifier,
 				sinkTable,
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 	}
 
 	@Test
@@ -441,7 +450,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 			objectIdentifier,
 			sinkTable,
 			new Configuration(),
-			Thread.currentThread().getContextClassLoader());
+			Thread.currentThread().getContextClassLoader(),
+			false);
 	}
 
 	@Test
@@ -467,7 +477,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 				objectIdentifier,
 				sinkTable,
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 		} catch (Throwable t) {
 			assertEquals(String.format(errorMessageTemp, "'topic'", String.format("[%s]", String.join(", ", TOPIC_LIST))),
 				t.getCause().getMessage());
@@ -486,7 +497,8 @@ public abstract class KafkaDynamicTableFactoryTestBase extends TestLogger {
 				objectIdentifier,
 				sinkTable,
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 		} catch (Throwable t) {
 			assertEquals(String.format(errorMessageTemp, "'topic-pattern'", TOPIC_REGEX), t.getCause().getMessage());
 		}
diff --git a/flink-formats/flink-avro-confluent-registry/src/test/java/org/apache/flink/formats/avro/registry/confluent/RegistryAvroFormatFactoryTest.java b/flink-formats/flink-avro-confluent-registry/src/test/java/org/apache/flink/formats/avro/registry/confluent/RegistryAvroFormatFactoryTest.java
index dbfcc794c3e..cef104ce412 100644
--- a/flink-formats/flink-avro-confluent-registry/src/test/java/org/apache/flink/formats/avro/registry/confluent/RegistryAvroFormatFactoryTest.java
+++ b/flink-formats/flink-avro-confluent-registry/src/test/java/org/apache/flink/formats/avro/registry/confluent/RegistryAvroFormatFactoryTest.java
@@ -163,7 +163,8 @@ public class RegistryAvroFormatFactoryTest {
 				ObjectIdentifier.of("default", "default", "t1"),
 				new CatalogTableImpl(SCHEMA, options, "mock source"),
 				new Configuration(),
-				RegistryAvroFormatFactoryTest.class.getClassLoader());
+				RegistryAvroFormatFactoryTest.class.getClassLoader(),
+				false);
 	}
 
 	private DynamicTableSink createTableSink(Map<String, String> options) {
@@ -172,6 +173,7 @@ public class RegistryAvroFormatFactoryTest {
 				ObjectIdentifier.of("default", "default", "t1"),
 				new CatalogTableImpl(SCHEMA, options, "mock sink"),
 				new Configuration(),
-				RegistryAvroFormatFactoryTest.class.getClassLoader());
+				RegistryAvroFormatFactoryTest.class.getClassLoader(),
+				false);
 	}
 }
diff --git a/flink-formats/flink-avro/src/test/java/org/apache/flink/formats/avro/AvroFormatFactoryTest.java b/flink-formats/flink-avro/src/test/java/org/apache/flink/formats/avro/AvroFormatFactoryTest.java
index e91c81ba9c0..40ad4aa6912 100644
--- a/flink-formats/flink-avro/src/test/java/org/apache/flink/formats/avro/AvroFormatFactoryTest.java
+++ b/flink-formats/flink-avro/src/test/java/org/apache/flink/formats/avro/AvroFormatFactoryTest.java
@@ -110,7 +110,8 @@ public class AvroFormatFactoryTest extends TestLogger {
 				ObjectIdentifier.of("default", "default", "t1"),
 				new CatalogTableImpl(SCHEMA, options, "mock source"),
 				new Configuration(),
-				AvroFormatFactoryTest.class.getClassLoader());
+				AvroFormatFactoryTest.class.getClassLoader(),
+				false);
 	}
 
 	private static DynamicTableSink createTableSink(Map<String, String> options) {
@@ -119,6 +120,7 @@ public class AvroFormatFactoryTest extends TestLogger {
 				ObjectIdentifier.of("default", "default", "t1"),
 				new CatalogTableImpl(SCHEMA, options, "mock sink"),
 				new Configuration(),
-				AvroFormatFactoryTest.class.getClassLoader());
+				AvroFormatFactoryTest.class.getClassLoader(),
+				false);
 	}
 }
diff --git a/flink-formats/flink-csv/src/test/java/org/apache/flink/formats/csv/CsvFormatFactoryTest.java b/flink-formats/flink-csv/src/test/java/org/apache/flink/formats/csv/CsvFormatFactoryTest.java
index f3708252a18..8f8fd651a18 100644
--- a/flink-formats/flink-csv/src/test/java/org/apache/flink/formats/csv/CsvFormatFactoryTest.java
+++ b/flink-formats/flink-csv/src/test/java/org/apache/flink/formats/csv/CsvFormatFactoryTest.java
@@ -226,7 +226,8 @@ public class CsvFormatFactoryTest extends TestLogger {
 				ObjectIdentifier.of("default", "default", "t1"),
 				new CatalogTableImpl(SCHEMA, options, "mock source"),
 				new Configuration(),
-				CsvFormatFactoryTest.class.getClassLoader());
+				CsvFormatFactoryTest.class.getClassLoader(),
+				false);
 	}
 
 	private static DynamicTableSink createTableSink(Map<String, String> options) {
@@ -235,6 +236,7 @@ public class CsvFormatFactoryTest extends TestLogger {
 				ObjectIdentifier.of("default", "default", "t1"),
 				new CatalogTableImpl(SCHEMA, options, "mock sink"),
 				new Configuration(),
-				CsvFormatFactoryTest.class.getClassLoader());
+				CsvFormatFactoryTest.class.getClassLoader(),
+				false);
 	}
 }
diff --git a/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/JsonFormatFactoryTest.java b/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/JsonFormatFactoryTest.java
index 5c07479334c..9bb4ba9e165 100644
--- a/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/JsonFormatFactoryTest.java
+++ b/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/JsonFormatFactoryTest.java
@@ -183,7 +183,8 @@ public class JsonFormatFactoryTest extends TestLogger {
 				ObjectIdentifier.of("default", "default", "t1"),
 				new CatalogTableImpl(SCHEMA, options, "Mock scan table"),
 				new Configuration(),
-				JsonFormatFactoryTest.class.getClassLoader());
+				JsonFormatFactoryTest.class.getClassLoader(),
+				false);
 	}
 
 	private static DynamicTableSink createTableSink(Map<String, String> options) {
@@ -192,6 +193,7 @@ public class JsonFormatFactoryTest extends TestLogger {
 				ObjectIdentifier.of("default", "default", "t1"),
 				new CatalogTableImpl(SCHEMA, options, "Mock sink table"),
 				new Configuration(),
-				JsonFormatFactoryTest.class.getClassLoader());
+				JsonFormatFactoryTest.class.getClassLoader(),
+				false);
 	}
 }
diff --git a/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/canal/CanalJsonFormatFactoryTest.java b/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/canal/CanalJsonFormatFactoryTest.java
index 4767c99f2c6..8beb8eabcee 100644
--- a/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/canal/CanalJsonFormatFactoryTest.java
+++ b/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/canal/CanalJsonFormatFactoryTest.java
@@ -154,7 +154,8 @@ public class CanalJsonFormatFactoryTest extends TestLogger {
 			ObjectIdentifier.of("default", "default", "t1"),
 			new CatalogTableImpl(SCHEMA, options, "mock source"),
 			new Configuration(),
-			CanalJsonFormatFactoryTest.class.getClassLoader());
+			CanalJsonFormatFactoryTest.class.getClassLoader(),
+			false);
 
 		assert source instanceof TestDynamicTableFactory.DynamicTableSourceMock;
 		TestDynamicTableFactory.DynamicTableSourceMock scanSourceMock =
@@ -170,7 +171,8 @@ public class CanalJsonFormatFactoryTest extends TestLogger {
 			ObjectIdentifier.of("default", "default", "t1"),
 			new CatalogTableImpl(SCHEMA, options, "mock sink"),
 			new Configuration(),
-			CanalJsonFormatFactoryTest.class.getClassLoader());
+			CanalJsonFormatFactoryTest.class.getClassLoader(),
+			false);
 
 		assert sink instanceof TestDynamicTableFactory.DynamicTableSinkMock;
 		TestDynamicTableFactory.DynamicTableSinkMock sinkMock =
diff --git a/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/debezium/DebeziumJsonFormatFactoryTest.java b/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/debezium/DebeziumJsonFormatFactoryTest.java
index 40fcac5dd52..47df75c88e2 100644
--- a/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/debezium/DebeziumJsonFormatFactoryTest.java
+++ b/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/debezium/DebeziumJsonFormatFactoryTest.java
@@ -148,7 +148,8 @@ public class DebeziumJsonFormatFactoryTest extends TestLogger {
 				ObjectIdentifier.of("default", "default", "t1"),
 				new CatalogTableImpl(SCHEMA, options, "mock source"),
 				new Configuration(),
-				DebeziumJsonFormatFactoryTest.class.getClassLoader());
+				DebeziumJsonFormatFactoryTest.class.getClassLoader(),
+				false);
 	}
 
 	private static DynamicTableSink createTableSink(Map<String, String> options) {
@@ -157,6 +158,7 @@ public class DebeziumJsonFormatFactoryTest extends TestLogger {
 				ObjectIdentifier.of("default", "default", "t1"),
 				new CatalogTableImpl(SCHEMA, options, "mock sink"),
 				new Configuration(),
-				DebeziumJsonFormatFactoryTest.class.getClassLoader());
+				DebeziumJsonFormatFactoryTest.class.getClassLoader(),
+				false);
 	}
 }
diff --git a/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/maxwell/MaxwellJsonFormatFactoryTest.java b/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/maxwell/MaxwellJsonFormatFactoryTest.java
index d9dcc06d92f..569954a00a5 100644
--- a/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/maxwell/MaxwellJsonFormatFactoryTest.java
+++ b/flink-formats/flink-json/src/test/java/org/apache/flink/formats/json/maxwell/MaxwellJsonFormatFactoryTest.java
@@ -145,7 +145,8 @@ public class MaxwellJsonFormatFactoryTest extends TestLogger {
 			ObjectIdentifier.of("default", "default", "t1"),
 			new CatalogTableImpl(SCHEMA, options, "mock source"),
 			new Configuration(),
-			MaxwellJsonFormatFactoryTest.class.getClassLoader());
+			MaxwellJsonFormatFactoryTest.class.getClassLoader(),
+			false);
 	}
 
 	private static DynamicTableSink createTableSink(Map<String, String> options) {
@@ -154,6 +155,7 @@ public class MaxwellJsonFormatFactoryTest extends TestLogger {
 			ObjectIdentifier.of("default", "default", "t1"),
 			new CatalogTableImpl(SCHEMA, options, "mock sink"),
 			new Configuration(),
-			MaxwellJsonFormatFactoryTest.class.getClassLoader());
+			MaxwellJsonFormatFactoryTest.class.getClassLoader(),
+			false);
 	}
 }
diff --git a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/ExecutionContext.java b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/ExecutionContext.java
index 6c1bbebad08..eafd46e8fee 100644
--- a/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/ExecutionContext.java
+++ b/flink-table/flink-sql-client/src/main/java/org/apache/flink/table/client/gateway/local/ExecutionContext.java
@@ -395,7 +395,7 @@ public class ExecutionContext<ClusterID> {
 							tableEnv.getCurrentDatabase(),
 							name),
 					CatalogTableImpl.fromProperties(sourceProperties),
-					tableEnv.getConfig().getConfiguration()));
+					tableEnv.getConfig().getConfiguration(), true));
 		} else if (environment.getExecution().isBatchPlanner()) {
 			final BatchTableSourceFactory<?> factory = (BatchTableSourceFactory<?>)
 				TableFactoryService.find(BatchTableSourceFactory.class, sourceProperties, classLoader);
@@ -415,7 +415,7 @@ public class ExecutionContext<ClusterID> {
 							name),
 					CatalogTableImpl.fromProperties(sinkProperties),
 					tableEnv.getConfig().getConfiguration(),
-					!environment.getExecution().inStreamingMode()));
+					!environment.getExecution().inStreamingMode(), true));
 		} else if (environment.getExecution().isBatchPlanner()) {
 			final BatchTableSinkFactory<?> factory = (BatchTableSinkFactory<?>)
 				TableFactoryService.find(BatchTableSinkFactory.class, sinkProperties, classLoader);
diff --git a/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/BlackHoleSinkFactoryTest.java b/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/BlackHoleSinkFactoryTest.java
index 7dc7a35d711..6f500f05a20 100644
--- a/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/BlackHoleSinkFactoryTest.java
+++ b/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/BlackHoleSinkFactoryTest.java
@@ -61,7 +61,8 @@ public class BlackHoleSinkFactoryTest {
 				ObjectIdentifier.of("", "", ""),
 				new CatalogTableImpl(TEST_SCHEMA, properties, ""),
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 	}
 
 	@Test
diff --git a/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/DataGenTableSourceFactoryTest.java b/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/DataGenTableSourceFactoryTest.java
index d59554da645..98154cda346 100644
--- a/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/DataGenTableSourceFactoryTest.java
+++ b/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/DataGenTableSourceFactoryTest.java
@@ -330,7 +330,8 @@ public class DataGenTableSourceFactoryTest {
 				ObjectIdentifier.of("", "", ""),
 				new CatalogTableImpl(schema, options, ""),
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 	}
 
 	private static class TestContext implements SourceFunction.SourceContext<RowData> {
diff --git a/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/PrintSinkFactoryTest.java b/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/PrintSinkFactoryTest.java
index d31773e646d..10b33e31f6a 100644
--- a/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/PrintSinkFactoryTest.java
+++ b/flink-table/flink-table-api-java-bridge/src/test/java/org/apache/flink/table/factories/PrintSinkFactoryTest.java
@@ -57,7 +57,8 @@ public class PrintSinkFactoryTest {
 				ObjectIdentifier.of("", "", ""),
 				new CatalogTableImpl(TEST_SCHEMA, properties, ""),
 				new Configuration(),
-				Thread.currentThread().getContextClassLoader());
+				Thread.currentThread().getContextClassLoader(),
+				false);
 		Assert.assertEquals("Print to System.err", sink.asSummaryString());
 	}
 }
diff --git a/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/factories/TableFactoryUtil.java b/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/factories/TableFactoryUtil.java
index 14699f024d1..4ed1cbcb9c8 100644
--- a/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/factories/TableFactoryUtil.java
+++ b/flink-table/flink-table-api-java/src/main/java/org/apache/flink/table/factories/TableFactoryUtil.java
@@ -60,11 +60,13 @@ public class TableFactoryUtil {
 			Catalog catalog,
 			ObjectIdentifier objectIdentifier,
 			CatalogTable catalogTable,
-			ReadableConfig configuration) {
+			ReadableConfig configuration,
+			boolean isTemporary) {
 		TableSourceFactory.Context context = new TableSourceFactoryContextImpl(
 			objectIdentifier,
 			catalogTable,
-			configuration);
+			configuration,
+			isTemporary);
 		Optional<TableFactory> factoryOptional = catalog.getTableFactory();
 		if (factoryOptional.isPresent()) {
 			TableFactory factory = factoryOptional.get();
@@ -104,12 +106,14 @@ public class TableFactoryUtil {
 			ObjectIdentifier objectIdentifier,
 			CatalogTable catalogTable,
 			ReadableConfig configuration,
-			boolean isStreamingMode) {
+			boolean isStreamingMode,
+			boolean isTemporary) {
 		TableSinkFactory.Context context = new TableSinkFactoryContextImpl(
 			objectIdentifier,
 			catalogTable,
 			configuration,
-			!isStreamingMode);
+			!isStreamingMode,
+			isTemporary);
 		if (catalog == null) {
 			return findAndCreateTableSink(context);
 		} else {
diff --git a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/DynamicTableFactory.java b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/DynamicTableFactory.java
index 0d4f8ba4f6f..23f6cd9c812 100644
--- a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/DynamicTableFactory.java
+++ b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/DynamicTableFactory.java
@@ -69,5 +69,10 @@ public interface DynamicTableFactory extends Factory {
 		 * <p>The class loader is in particular useful for discovering further (nested) factories.
 		 */
 		ClassLoader getClassLoader();
+
+		/**
+		 * Whether the table is temporary.
+		 */
+		boolean isTemporary();
 	}
 }
diff --git a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/FactoryUtil.java b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/FactoryUtil.java
index 95f163dd57f..d19ee47bac9 100644
--- a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/FactoryUtil.java
+++ b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/FactoryUtil.java
@@ -108,12 +108,14 @@ public final class FactoryUtil {
 			ObjectIdentifier objectIdentifier,
 			CatalogTable catalogTable,
 			ReadableConfig configuration,
-			ClassLoader classLoader) {
+			ClassLoader classLoader,
+			boolean isTemporary) {
 		final DefaultDynamicTableContext context = new DefaultDynamicTableContext(
 			objectIdentifier,
 			catalogTable,
 			configuration,
-			classLoader);
+			classLoader,
+			isTemporary);
 		try {
 			final DynamicTableSourceFactory factory = getDynamicTableFactory(
 				DynamicTableSourceFactory.class,
@@ -147,12 +149,14 @@ public final class FactoryUtil {
 			ObjectIdentifier objectIdentifier,
 			CatalogTable catalogTable,
 			ReadableConfig configuration,
-			ClassLoader classLoader) {
+			ClassLoader classLoader,
+			boolean isTemporary) {
 		final DefaultDynamicTableContext context = new DefaultDynamicTableContext(
 			objectIdentifier,
 			catalogTable,
 			configuration,
-			classLoader);
+			classLoader,
+			isTemporary);
 		try {
 			final DynamicTableSinkFactory factory = getDynamicTableFactory(
 				DynamicTableSinkFactory.class,
@@ -209,8 +213,8 @@ public final class FactoryUtil {
 	 * Discovers a factory using the given factory base class and identifier.
 	 *
 	 * <p>This method is meant for cases where {@link #createTableFactoryHelper(DynamicTableFactory, DynamicTableFactory.Context)}
-	 * {@link #createTableSource(Catalog, ObjectIdentifier, CatalogTable, ReadableConfig, ClassLoader)},
-	 * and {@link #createTableSink(Catalog, ObjectIdentifier, CatalogTable, ReadableConfig, ClassLoader)}
+	 * {@link #createTableSource(Catalog, ObjectIdentifier, CatalogTable, ReadableConfig, ClassLoader, boolean)},
+	 * and {@link #createTableSink(Catalog, ObjectIdentifier, CatalogTable, ReadableConfig, ClassLoader, boolean)}
 	 * are not applicable.
 	 */
 	@SuppressWarnings("unchecked")
@@ -603,16 +607,19 @@ public final class FactoryUtil {
 		private final CatalogTable catalogTable;
 		private final ReadableConfig configuration;
 		private final ClassLoader classLoader;
+		private final boolean isTemporary;
 
 		DefaultDynamicTableContext(
 				ObjectIdentifier objectIdentifier,
 				CatalogTable catalogTable,
 				ReadableConfig configuration,
-				ClassLoader classLoader) {
+				ClassLoader classLoader,
+				boolean isTemporary) {
 			this.objectIdentifier = objectIdentifier;
 			this.catalogTable = catalogTable;
 			this.configuration = configuration;
 			this.classLoader = classLoader;
+			this.isTemporary = isTemporary;
 		}
 
 		@Override
@@ -634,6 +641,11 @@ public final class FactoryUtil {
 		public ClassLoader getClassLoader() {
 			return classLoader;
 		}
+
+		@Override
+		public boolean isTemporary() {
+			return isTemporary;
+		}
 	}
 
 	// --------------------------------------------------------------------------------------------
diff --git a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSinkFactory.java b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSinkFactory.java
index b8df00cb546..1f1ef6c30e9 100644
--- a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSinkFactory.java
+++ b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSinkFactory.java
@@ -107,6 +107,11 @@ public interface TableSinkFactory<T> extends TableFactory {
 		 * See {@link Source#getBoundedness}.
 		 */
 		boolean isBounded();
+
+		/**
+		 * Whether the table is temporary.
+		 */
+		boolean isTemporary();
 	}
 
 }
diff --git a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSinkFactoryContextImpl.java b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSinkFactoryContextImpl.java
index 4e617129f99..27547d17c5b 100644
--- a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSinkFactoryContextImpl.java
+++ b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSinkFactoryContextImpl.java
@@ -35,16 +35,19 @@ public class TableSinkFactoryContextImpl implements TableSinkFactory.Context {
 	private final CatalogTable table;
 	private final ReadableConfig config;
 	private final boolean isBounded;
+	private final boolean isTemporary;
 
 	public TableSinkFactoryContextImpl(
 			ObjectIdentifier identifier,
 			CatalogTable table,
 			ReadableConfig config,
-			boolean isBounded) {
+			boolean isBounded,
+			boolean isTemporary) {
 		this.identifier = checkNotNull(identifier);
 		this.table = checkNotNull(table);
 		this.config = checkNotNull(config);
 		this.isBounded = isBounded;
+		this.isTemporary = isTemporary;
 	}
 
 	@Override
@@ -66,4 +69,9 @@ public class TableSinkFactoryContextImpl implements TableSinkFactory.Context {
 	public boolean isBounded() {
 		return isBounded;
 	}
+
+	@Override
+	public boolean isTemporary() {
+		return isTemporary;
+	}
 }
diff --git a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSourceFactory.java b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSourceFactory.java
index 8cc5bdcd8c8..c142af4e04c 100644
--- a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSourceFactory.java
+++ b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSourceFactory.java
@@ -98,6 +98,11 @@ public interface TableSourceFactory<T> extends TableFactory {
 		 * {@code TableEnvironment} session configurations.
 		 */
 		ReadableConfig getConfiguration();
+
+		/**
+		 * Whether the table is temporary.
+		 */
+		boolean isTemporary();
 	}
 
 }
diff --git a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSourceFactoryContextImpl.java b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSourceFactoryContextImpl.java
index 5fcab42adaf..574f22708bd 100644
--- a/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSourceFactoryContextImpl.java
+++ b/flink-table/flink-table-common/src/main/java/org/apache/flink/table/factories/TableSourceFactoryContextImpl.java
@@ -34,14 +34,17 @@ public class TableSourceFactoryContextImpl implements TableSourceFactory.Context
 	private final ObjectIdentifier identifier;
 	private final CatalogTable table;
 	private final ReadableConfig config;
+	private final boolean isTemporary;
 
 	public TableSourceFactoryContextImpl(
 			ObjectIdentifier identifier,
 			CatalogTable table,
-			ReadableConfig config) {
+			ReadableConfig config,
+			boolean isTemporary) {
 		this.identifier = checkNotNull(identifier);
 		this.table = checkNotNull(table);
 		this.config = checkNotNull(config);
+		this.isTemporary = isTemporary;
 	}
 
 	@Override
@@ -58,4 +61,9 @@ public class TableSourceFactoryContextImpl implements TableSourceFactory.Context
 	public ReadableConfig getConfiguration() {
 		return config;
 	}
+
+	@Override
+	public boolean isTemporary() {
+		return isTemporary;
+	}
 }
diff --git a/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/FactoryUtilTest.java b/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/FactoryUtilTest.java
index 886f8594e5c..e38978e78a4 100644
--- a/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/FactoryUtilTest.java
+++ b/flink-table/flink-table-common/src/test/java/org/apache/flink/table/factories/FactoryUtilTest.java
@@ -237,7 +237,8 @@ public class FactoryUtilTest {
 			ObjectIdentifier.of("cat", "db", "table"),
 			new CatalogTableMock(options),
 			new Configuration(),
-			FactoryUtilTest.class.getClassLoader());
+			FactoryUtilTest.class.getClassLoader(),
+			false);
 	}
 
 	private static DynamicTableSink createTableSink(Map<String, String> options) {
@@ -246,7 +247,8 @@ public class FactoryUtilTest {
 			ObjectIdentifier.of("cat", "db", "table"),
 			new CatalogTableMock(options),
 			new Configuration(),
-			FactoryUtilTest.class.getClassLoader());
+			FactoryUtilTest.class.getClassLoader(),
+			false);
 	}
 
 	private static class CatalogTableMock implements CatalogTable {
diff --git a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/catalog/CatalogSchemaTable.java b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/catalog/CatalogSchemaTable.java
index d170f5773c8..099469aba1d 100644
--- a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/catalog/CatalogSchemaTable.java
+++ b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/catalog/CatalogSchemaTable.java
@@ -195,7 +195,7 @@ public class CatalogSchemaTable extends AbstractTable implements TemporalTable {
 				// actual TableConfig here. And currently the empty config do not affect the logic.
 				ReadableConfig config = new Configuration();
 				TableSourceFactory.Context context =
-					new TableSourceFactoryContextImpl(tableIdentifier, (CatalogTable) lookupResult.getTable(), config);
+					new TableSourceFactoryContextImpl(tableIdentifier, (CatalogTable) lookupResult.getTable(), config, lookupResult.isTemporary());
 				TableSource<?> source = TableFactoryUtil.findAndCreateTableSource(context);
 				if (source instanceof StreamTableSource) {
 					if (!isStreamingMode && !((StreamTableSource<?>) source).isBounded()) {
diff --git a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/FlinkCalciteCatalogReader.java b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/FlinkCalciteCatalogReader.java
index a8fd31e708b..8c433dfb2be 100644
--- a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/FlinkCalciteCatalogReader.java
+++ b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/FlinkCalciteCatalogReader.java
@@ -232,7 +232,8 @@ public class FlinkCalciteCatalogReader extends CalciteCatalogReader {
 					schemaTable.getCatalog(),
 					schemaTable.getTableIdentifier(),
 					catalogTable,
-					new Configuration());
+					new Configuration(),
+					schemaTable.isTemporary());
 				// success, then we will use the legacy factories
 				return true;
 			} catch (Throwable e) {
diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/delegation/PlannerBase.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/delegation/PlannerBase.scala
index 6e5941732e2..ff3ce6771b4 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/delegation/PlannerBase.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/delegation/PlannerBase.scala
@@ -340,7 +340,8 @@ abstract class PlannerBase(
       objectIdentifier: ObjectIdentifier,
       dynamicOptions: JMap[String, String])
     : Option[(CatalogTable, Any)] = {
-    JavaScalaConversionUtil.toScala(catalogManager.getTable(objectIdentifier))
+    val lookupResult = JavaScalaConversionUtil.toScala(catalogManager.getTable(objectIdentifier))
+    lookupResult
       .map(_.getTable) match {
       case Some(table: ConnectorCatalogTable[_, _]) =>
         JavaScalaConversionUtil.toScala(table.getTableSink) match {
@@ -355,13 +356,15 @@ abstract class PlannerBase(
         } else {
           table
         }
-        if (isLegacyConnectorOptions(objectIdentifier, table)) {
+        val isTemporary = lookupResult.get.isTemporary
+        if (isLegacyConnectorOptions(objectIdentifier, table, isTemporary)) {
           val tableSink = TableFactoryUtil.findAndCreateTableSink(
             catalog.orElse(null),
             objectIdentifier,
             tableToFind,
             getTableConfig.getConfiguration,
-            isStreamingMode)
+            isStreamingMode,
+            isTemporary)
           Option(table, tableSink)
         } else {
           val tableSink = FactoryUtil.createTableSink(
@@ -369,7 +372,8 @@ abstract class PlannerBase(
             objectIdentifier,
             tableToFind,
             getTableConfig.getConfiguration,
-            Thread.currentThread().getContextClassLoader)
+            Thread.currentThread().getContextClassLoader,
+            isTemporary)
           Option(table, tableSink)
         }
 
@@ -382,7 +386,8 @@ abstract class PlannerBase(
    */
   private def isLegacyConnectorOptions(
       objectIdentifier: ObjectIdentifier,
-      catalogTable: CatalogTable) = {
+      catalogTable: CatalogTable,
+      isTemporary: Boolean) = {
     // normalize option keys
     val properties = new DescriptorProperties(true)
     properties.putProperties(catalogTable.getOptions)
@@ -398,7 +403,8 @@ abstract class PlannerBase(
           objectIdentifier,
           catalogTable,
           getTableConfig.getConfiguration,
-          isStreamingMode)
+          isStreamingMode,
+          isTemporary)
         // success, then we will use the legacy factories
         true
       } catch {
diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala
index ea5a58250fc..21a623a9c99 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/CatalogSourceTable.scala
@@ -145,7 +145,8 @@ class CatalogSourceTable[T](
       schemaTable.getTableIdentifier,
       newCatalogTable,
       conf,
-      Thread.currentThread.getContextClassLoader)
+      Thread.currentThread.getContextClassLoader,
+      schemaTable.isTemporary)
 
     validateTableSource(tableSource)
 
diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/LegacyCatalogSourceTable.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/LegacyCatalogSourceTable.scala
index 7f1351dbfb3..5986de7ba46 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/LegacyCatalogSourceTable.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/schema/LegacyCatalogSourceTable.scala
@@ -181,9 +181,7 @@ class LegacyCatalogSourceTable[T](
       catalogTable
     }
     val context = new TableSourceFactoryContextImpl(
-      schemaTable.getTableIdentifier,
-      tableToFind,
-      conf)
+      schemaTable.getTableIdentifier, tableToFind, conf, schemaTable.isTemporary)
     val tableSource = if (tableFactoryOpt.isPresent) {
       tableFactoryOpt.get() match {
         case tableSourceFactory: TableSourceFactory[_] =>
diff --git a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/catalog/DatabaseCalciteSchema.java b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/catalog/DatabaseCalciteSchema.java
index 90f2eb68aa9..8c11b088ebb 100644
--- a/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/catalog/DatabaseCalciteSchema.java
+++ b/flink-table/flink-table-planner/src/main/java/org/apache/flink/table/catalog/DatabaseCalciteSchema.java
@@ -108,7 +108,8 @@ class DatabaseCalciteSchema implements Schema {
 					identifier,
 					(CatalogTable) table,
 					resolvedSchema,
-					tableFactory);
+					tableFactory,
+					lookupResult.isTemporary());
 			} else if (table instanceof CatalogView) {
 				return convertCatalogView(
 					identifier.getObjectName(),
@@ -147,10 +148,11 @@ class DatabaseCalciteSchema implements Schema {
 			ObjectIdentifier identifier,
 			CatalogTable table,
 			TableSchema resolvedSchema,
-			@Nullable TableFactory tableFactory) {
+			@Nullable TableFactory tableFactory,
+			boolean isTemporary) {
 		final TableSource<?> tableSource;
 		final TableSourceFactory.Context context = new TableSourceFactoryContextImpl(
-				identifier, table, tableConfig.getConfiguration());
+				identifier, table, tableConfig.getConfiguration(), isTemporary);
 		if (tableFactory != null) {
 			if (tableFactory instanceof TableSourceFactory) {
 				tableSource = ((TableSourceFactory<?>) tableFactory).createTableSource(context);
diff --git a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/api/internal/TableEnvImpl.scala b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/api/internal/TableEnvImpl.scala
index 3eb17072b56..512de5438a8 100644
--- a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/api/internal/TableEnvImpl.scala
+++ b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/api/internal/TableEnvImpl.scala
@@ -1073,7 +1073,8 @@ abstract class TableEnvImpl(
   }
 
   protected def getTableSink(objectIdentifier: ObjectIdentifier): Option[TableSink[_]] = {
-    JavaScalaConversionUtil.toScala(catalogManager.getTable(objectIdentifier))
+    val lookupResult = JavaScalaConversionUtil.toScala(catalogManager.getTable(objectIdentifier))
+    lookupResult
       .map(_.getTable) match {
       case Some(s) if s.isInstanceOf[ConnectorCatalogTable[_, _]] =>
 
@@ -1085,7 +1086,8 @@ abstract class TableEnvImpl(
         val catalog = catalogManager.getCatalog(objectIdentifier.getCatalogName)
         val catalogTable = s.asInstanceOf[CatalogTable]
         val context = new TableSinkFactoryContextImpl(
-          objectIdentifier, catalogTable, config.getConfiguration, true)
+          objectIdentifier, catalogTable, config.getConfiguration, true,
+          lookupResult.get.isTemporary)
         if (catalog.isPresent && catalog.get().getTableFactory.isPresent) {
           val sink = TableFactoryUtil.createTableSinkForCatalogTable(catalog.get(), context)
           if (sink.isPresent) {
diff --git a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/StreamPlanner.scala b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/StreamPlanner.scala
index eb9fd8a4b3e..19154c5593d 100644
--- a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/StreamPlanner.scala
+++ b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/StreamPlanner.scala
@@ -315,7 +315,8 @@ class StreamPlanner(
   }
 
   private def getTableSink(objectIdentifier: ObjectIdentifier): Option[TableSink[_]] = {
-    JavaScalaConversionUtil.toScala(catalogManager.getTable(objectIdentifier))
+    val lookupResult = JavaScalaConversionUtil.toScala(catalogManager.getTable(objectIdentifier))
+    lookupResult
       .map(_.getTable) match {
       case Some(s) if s.isInstanceOf[ConnectorCatalogTable[_, _]] =>
         JavaScalaConversionUtil.toScala(s.asInstanceOf[ConnectorCatalogTable[_, _]].getTableSink)
@@ -324,7 +325,8 @@ class StreamPlanner(
         val catalog = catalogManager.getCatalog(objectIdentifier.getCatalogName)
         val catalogTable = s.asInstanceOf[CatalogTable]
         val context = new TableSinkFactoryContextImpl(
-          objectIdentifier, catalogTable, config.getConfiguration, false)
+          objectIdentifier, catalogTable, config.getConfiguration, false,
+          lookupResult.get.isTemporary)
         if (catalog.isPresent && catalog.get().getTableFactory.isPresent) {
           val sink = TableFactoryUtil.createTableSinkForCatalogTable(catalog.get(), context)
           if (sink.isPresent) {
