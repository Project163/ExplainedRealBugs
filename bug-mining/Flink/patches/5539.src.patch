diff --git a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/physical/batch/BatchPhysicalPythonWindowAggregateRule.java b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/physical/batch/BatchPhysicalPythonWindowAggregateRule.java
index ffc9c6a20ad..9eadb76c50c 100644
--- a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/physical/batch/BatchPhysicalPythonWindowAggregateRule.java
+++ b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/plan/rules/physical/batch/BatchPhysicalPythonWindowAggregateRule.java
@@ -83,13 +83,13 @@ public class BatchPhysicalPythonWindowAggregateRule extends RelOptRule {
         boolean existJavaFunction =
                 aggCalls.stream().anyMatch(x -> !PythonUtil.isPythonAggregate(x, null));
         if (existPandasFunction || existGeneralPythonFunction) {
-            if (existJavaFunction) {
+            if (existGeneralPythonFunction) {
                 throw new TableException(
-                        "Python UDAF and Java/Scala UDAF cannot be used together.");
+                        "non-Pandas UDAFs are not supported in batch mode currently.");
             }
-            if (existPandasFunction && existGeneralPythonFunction) {
+            if (existJavaFunction) {
                 throw new TableException(
-                        "Pandas UDAF and non-Pandas UDAF cannot be used together.");
+                        "Python UDAF and Java/Scala UDAF cannot be used together.");
             }
             return true;
         } else {
diff --git a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/rules/physical/batch/BatchPhysicalOverAggregateRule.scala b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/rules/physical/batch/BatchPhysicalOverAggregateRule.scala
index 17502211a8a..33efd87d412 100644
--- a/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/rules/physical/batch/BatchPhysicalOverAggregateRule.scala
+++ b/flink-table/flink-table-planner-blink/src/main/scala/org/apache/flink/table/planner/plan/rules/physical/batch/BatchPhysicalOverAggregateRule.scala
@@ -117,12 +117,12 @@ class BatchPhysicalOverAggregateRule
         .map(_._2)
         .exists(_.map(_._1).exists(!isPythonAggregate(_)))
       if (existPandasFunction || existGeneralPythonFunction) {
+        if (existGeneralPythonFunction) {
+          throw new TableException("non-Pandas UDAFs are not supported in batch mode currently.")
+        }
         if (existJavaFunction) {
           throw new TableException("Python UDAF and Java/Scala UDAF cannot be used together.")
         }
-        if (existPandasFunction && existGeneralPythonFunction) {
-          throw new TableException("Pandas UDAF and non-Pandas UDAF cannot be used together.")
-        }
       }
       overWindowAgg = if (existJavaFunction) {
         new BatchPhysicalOverAggregate(
diff --git a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/batch/table/PythonGroupWindowAggregateTest.scala b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/batch/table/PythonGroupWindowAggregateTest.scala
index 2faf97e474a..a0e00aeb4a2 100644
--- a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/batch/table/PythonGroupWindowAggregateTest.scala
+++ b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/batch/table/PythonGroupWindowAggregateTest.scala
@@ -20,7 +20,7 @@ package org.apache.flink.table.planner.plan.batch.table
 
 import org.apache.flink.api.scala._
 import org.apache.flink.table.api._
-import org.apache.flink.table.planner.runtime.utils.JavaUserDefinedAggFunctions.PandasAggregateFunction
+import org.apache.flink.table.planner.runtime.utils.JavaUserDefinedAggFunctions.{PandasAggregateFunction, TestPythonAggregateFunction}
 import org.apache.flink.table.planner.utils.TableTestBase
 
 import org.junit.Test
@@ -101,4 +101,19 @@ class PythonGroupWindowAggregateTest extends TableTestBase {
 
     util.verifyExecPlan(resultTable)
   }
+
+  @Test(expected = classOf[TableException])
+  def testGeneralEventTimeTumblingGroupWindowOverTime(): Unit = {
+    val util = batchTestUtil()
+    val sourceTable = util.addTableSource[(Int, Long, Int, Long)](
+      "MyTable", 'a, 'b, 'c, 'rowtime.rowtime)
+    val func = new TestPythonAggregateFunction
+
+    val resultTable = sourceTable
+      .window(Tumble over 5.millis on 'rowtime as 'w)
+      .groupBy('w, 'b)
+      .select('b, 'w.start,'w.end, func('a, 'c))
+
+    util.verifyExecPlan(resultTable)
+  }
 }
diff --git a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/batch/table/PythonOverWindowAggregateTest.scala b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/batch/table/PythonOverWindowAggregateTest.scala
index 3d835d39b6a..6f782968ba1 100644
--- a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/batch/table/PythonOverWindowAggregateTest.scala
+++ b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/batch/table/PythonOverWindowAggregateTest.scala
@@ -20,7 +20,7 @@ package org.apache.flink.table.planner.plan.batch.table
 
 import org.apache.flink.api.scala._
 import org.apache.flink.table.api._
-import org.apache.flink.table.planner.runtime.utils.JavaUserDefinedAggFunctions.PandasAggregateFunction
+import org.apache.flink.table.planner.runtime.utils.JavaUserDefinedAggFunctions.{PandasAggregateFunction, TestPythonAggregateFunction}
 import org.apache.flink.table.planner.utils.TableTestBase
 import org.junit.Test
 
@@ -63,4 +63,23 @@ class PythonOverWindowAggregateTest extends TableTestBase {
 
     util.verifyExecPlan(resultTable)
   }
+
+  @Test(expected = classOf[TableException])
+  def testGeneralRangeOverWindowAggregate(): Unit = {
+    val util = batchTestUtil()
+    val sourceTable = util.addTableSource[(Int, Long, Int, Long)](
+      "MyTable", 'a, 'b, 'c, 'rowtime.rowtime)
+    val func = new TestPythonAggregateFunction
+
+    val resultTable = sourceTable
+      .window(
+        Over
+          partitionBy 'b
+          orderBy 'rowtime
+          preceding UNBOUNDED_RANGE
+          as 'w)
+      .select('b, func('a, 'c) over 'w)
+
+    util.verifyExecPlan(resultTable)
+  }
 }
