diff --git a/flink-end-to-end-tests/flink-plugins-test/another-dummy-fs/src/main/java/org/apache/flink/fs/anotherdummy/AnotherDummyFSFactory.java b/flink-end-to-end-tests/flink-plugins-test/another-dummy-fs/src/main/java/org/apache/flink/fs/anotherdummy/AnotherDummyFSFactory.java
index 2c1cb100685..fb91a67ef3c 100644
--- a/flink-end-to-end-tests/flink-plugins-test/another-dummy-fs/src/main/java/org/apache/flink/fs/anotherdummy/AnotherDummyFSFactory.java
+++ b/flink-end-to-end-tests/flink-plugins-test/another-dummy-fs/src/main/java/org/apache/flink/fs/anotherdummy/AnotherDummyFSFactory.java
@@ -21,7 +21,6 @@ package org.apache.flink.fs.anotherdummy;
 import org.apache.flink.core.fs.FileSystem;
 import org.apache.flink.core.fs.FileSystemFactory;
 
-import java.io.IOException;
 import java.net.URI;
 import java.util.HashMap;
 import java.util.Map;
@@ -39,7 +38,15 @@ public class AnotherDummyFSFactory implements FileSystemFactory {
 	}
 
 	@Override
-	public FileSystem create(URI fsUri) throws IOException {
+	public FileSystem create(URI fsUri) {
+		String dummyFileSystemClassName = "org.apache.flink.fs.dummy.DummyFSFileSystem";
+		try {
+			this.getClassLoader().loadClass(dummyFileSystemClassName);
+			throw new RuntimeException(String.format("Class %s should not be visible for classloader of %s",
+				dummyFileSystemClassName, this.getClass().getCanonicalName()));
+		} catch (ClassNotFoundException e) {
+			// Expected exception.
+		}
 		return fileSystem;
 	}
 
diff --git a/flink-end-to-end-tests/flink-plugins-test/dummy-fs/src/main/java/org/apache/flink/fs/dummy/DummyFSFactory.java b/flink-end-to-end-tests/flink-plugins-test/dummy-fs/src/main/java/org/apache/flink/fs/dummy/DummyFSFactory.java
index 351879661b4..a7107350360 100644
--- a/flink-end-to-end-tests/flink-plugins-test/dummy-fs/src/main/java/org/apache/flink/fs/dummy/DummyFSFactory.java
+++ b/flink-end-to-end-tests/flink-plugins-test/dummy-fs/src/main/java/org/apache/flink/fs/dummy/DummyFSFactory.java
@@ -21,7 +21,6 @@ package org.apache.flink.fs.dummy;
 import org.apache.flink.core.fs.FileSystem;
 import org.apache.flink.core.fs.FileSystemFactory;
 
-import java.io.IOException;
 import java.net.URI;
 import java.util.HashMap;
 import java.util.Map;
@@ -39,7 +38,15 @@ public class DummyFSFactory implements FileSystemFactory {
 	}
 
 	@Override
-	public FileSystem create(URI fsUri) throws IOException {
+	public FileSystem create(URI fsUri) {
+		String anotherFileSystemClassName = "org.apache.flink.fs.anotherdummy.AnotherDummyFSFileSystem";
+		try {
+			this.getClassLoader().loadClass(anotherFileSystemClassName);
+			throw new RuntimeException(String.format("Class %s should not be visible for classloader of %s",
+				anotherFileSystemClassName, this.getClass().getCanonicalName()));
+		} catch (ClassNotFoundException e) {
+			// Expected exception.
+		}
 		return fileSystem;
 	}
 
diff --git a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterDescriptor.java b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterDescriptor.java
index aad6d3600dd..50c2fff6342 100644
--- a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterDescriptor.java
+++ b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterDescriptor.java
@@ -725,7 +725,10 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 		}
 
 		ApplicationSubmissionContext appContext = yarnApplication.getApplicationSubmissionContext();
+		// The files need to be shipped and added to classpath.
 		Set<File> systemShipFiles = new HashSet<>(shipFiles.size());
+		// The files only need to be shipped.
+		Set<File> shipOnlyFiles = new HashSet<>();
 		for (File file : shipFiles) {
 			systemShipFiles.add(file.getAbsoluteFile());
 		}
@@ -735,7 +738,10 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 			systemShipFiles.add(new File(logConfigFilePath));
 		}
 
-		addEnvironmentFoldersToShipFiles(systemShipFiles);
+		addLibFoldersToShipFiles(systemShipFiles);
+
+		// Plugin files only need to be shipped and should not be added to classpath.
+		addPluginsFoldersToShipFiles(shipOnlyFiles);
 
 		// Set-up ApplicationSubmissionContext for the application
 
@@ -781,7 +787,7 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 		// ship list that enables reuse of resources for task manager containers
 		StringBuilder envShipFileList = new StringBuilder();
 
-		// upload and register ship files
+		// upload and register ship files, these files will be added to classpath.
 		List<String> systemClassPaths = uploadAndRegisterFiles(
 				systemShipFiles,
 				fs,
@@ -791,6 +797,16 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 				localResources,
 				envShipFileList);
 
+		// upload and register ship-only files
+		uploadAndRegisterFiles(
+			shipOnlyFiles,
+			fs,
+			homeDir,
+			appId,
+			paths,
+			localResources,
+			envShipFileList);
+
 		final List<String> userClassPaths = uploadAndRegisterFiles(
 				userJarFiles,
 				fs,
@@ -1559,12 +1575,8 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 		}
 	}
 
-	void addEnvironmentFoldersToShipFiles(Collection<File> effectiveShipFiles) {
-		addLibFoldersToShipFiles(effectiveShipFiles);
-		addPluginsFoldersToShipFiles(effectiveShipFiles);
-	}
-
-	private void addLibFoldersToShipFiles(Collection<File> effectiveShipFiles) {
+	@VisibleForTesting
+	void addLibFoldersToShipFiles(Collection<File> effectiveShipFiles) {
 		// Add lib folder to the ship files if the environment variable is set.
 		// This is for convenience when running from the command-line.
 		// (for other files users explicitly set the ship files)
@@ -1583,7 +1595,8 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 		}
 	}
 
-	private void addPluginsFoldersToShipFiles(Collection<File> effectiveShipFiles) {
+	@VisibleForTesting
+	void addPluginsFoldersToShipFiles(Collection<File> effectiveShipFiles) {
 		final Optional<File> pluginsDir = PluginConfig.getPluginsDir();
 		pluginsDir.ifPresent(effectiveShipFiles::add);
 	}
diff --git a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorTest.java b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorTest.java
index 30ba407ecb5..b39fbf8825d 100644
--- a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorTest.java
+++ b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorTest.java
@@ -440,7 +440,7 @@ public class YarnClusterDescriptorTest extends TestLogger {
 
 			// only execute part of the deployment to test for shipped files
 			Set<File> effectiveShipFiles = new HashSet<>();
-			descriptor.addEnvironmentFoldersToShipFiles(effectiveShipFiles);
+			descriptor.addLibFoldersToShipFiles(effectiveShipFiles);
 
 			Assert.assertEquals(0, effectiveShipFiles.size());
 			Assert.assertEquals(2, descriptor.getShipFiles().size());
@@ -451,15 +451,15 @@ public class YarnClusterDescriptorTest extends TestLogger {
 
 	@Test
 	public void testEnvironmentLibShipping() throws Exception {
-		testEnvironmentDirectoryShipping(ConfigConstants.ENV_FLINK_LIB_DIR);
+		testEnvironmentDirectoryShipping(ConfigConstants.ENV_FLINK_LIB_DIR, false);
 	}
 
 	@Test
 	public void testEnvironmentPluginsShipping() throws Exception {
-		testEnvironmentDirectoryShipping(ConfigConstants.ENV_FLINK_PLUGINS_DIR);
+		testEnvironmentDirectoryShipping(ConfigConstants.ENV_FLINK_PLUGINS_DIR, true);
 	}
 
-	private void testEnvironmentDirectoryShipping(String environmentVariable) throws Exception {
+	private void testEnvironmentDirectoryShipping(String environmentVariable, boolean onlyShip) throws Exception {
 		try (YarnClusterDescriptor descriptor = createYarnClusterDescriptor()) {
 			File libFolder = temporaryFolder.newFolder().getAbsoluteFile();
 			File libFile = new File(libFolder, "libFile.jar");
@@ -473,7 +473,11 @@ public class YarnClusterDescriptorTest extends TestLogger {
 				env.put(environmentVariable, libFolder.getAbsolutePath());
 				CommonTestUtils.setEnv(env);
 				// only execute part of the deployment to test for shipped files
-				descriptor.addEnvironmentFoldersToShipFiles(effectiveShipFiles);
+				if (onlyShip) {
+					descriptor.addPluginsFoldersToShipFiles(effectiveShipFiles);
+				} else {
+					descriptor.addLibFoldersToShipFiles(effectiveShipFiles);
+				}
 			} finally {
 				CommonTestUtils.setEnv(oldEnv);
 			}
@@ -498,7 +502,7 @@ public class YarnClusterDescriptorTest extends TestLogger {
 				env.put(ConfigConstants.ENV_FLINK_PLUGINS_DIR, pluginsFolder.getAbsolutePath());
 				CommonTestUtils.setEnv(env);
 				// only execute part of the deployment to test for shipped files
-				descriptor.addEnvironmentFoldersToShipFiles(effectiveShipFiles);
+				descriptor.addPluginsFoldersToShipFiles(effectiveShipFiles);
 			} finally {
 				CommonTestUtils.setEnv(oldEnv);
 			}
