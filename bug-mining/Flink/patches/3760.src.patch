diff --git a/flink-core/src/main/java/org/apache/flink/configuration/Configuration.java b/flink-core/src/main/java/org/apache/flink/configuration/Configuration.java
index 346e33611f3..90fdf973531 100644
--- a/flink-core/src/main/java/org/apache/flink/configuration/Configuration.java
+++ b/flink-core/src/main/java/org/apache/flink/configuration/Configuration.java
@@ -43,6 +43,7 @@ import java.util.Properties;
 import java.util.Set;
 import java.util.stream.Collectors;
 
+import static org.apache.flink.configuration.StructuredOptionsSplitter.escapeWithSingleQuote;
 import static org.apache.flink.util.Preconditions.checkNotNull;
 
 /**
@@ -769,7 +770,7 @@ public class Configuration extends ExecutionConfig.GlobalJobParameters
 		synchronized (this.confData){
 			Map<String, String> ret = new HashMap<>(this.confData.size());
 			for (Map.Entry<String, Object> entry : confData.entrySet()) {
-				ret.put(entry.getKey(), entry.getValue().toString());
+				ret.put(entry.getKey(), convertToString(entry.getValue()));
 			}
 			return ret;
 		}
@@ -958,6 +959,19 @@ public class Configuration extends ExecutionConfig.GlobalJobParameters
 		} else if (o.getClass() == Duration.class) {
 			Duration duration = (Duration) o;
 			return String.format("%d ns", duration.toNanos());
+		} else if (o instanceof List) {
+			return ((List<?>) o).stream()
+				.map(e -> escapeWithSingleQuote(convertToString(e), ";"))
+				.collect(Collectors.joining(";"));
+		} else if (o instanceof Map) {
+			return ((Map<?, ?>) o).entrySet().stream()
+				.map(e -> {
+					String escapedKey = escapeWithSingleQuote(e.getKey().toString(), ":");
+					String escapedValue = escapeWithSingleQuote(e.getValue().toString(), ":");
+
+					return escapeWithSingleQuote(escapedKey + ":" + escapedValue, ",");
+				})
+				.collect(Collectors.joining(","));
 		}
 
 		return o.toString();
diff --git a/flink-core/src/main/java/org/apache/flink/configuration/StructuredOptionsSplitter.java b/flink-core/src/main/java/org/apache/flink/configuration/StructuredOptionsSplitter.java
index 44ae82ad610..8be69c6505b 100644
--- a/flink-core/src/main/java/org/apache/flink/configuration/StructuredOptionsSplitter.java
+++ b/flink-core/src/main/java/org/apache/flink/configuration/StructuredOptionsSplitter.java
@@ -21,6 +21,7 @@ package org.apache.flink.configuration;
 import org.apache.flink.annotation.Internal;
 
 import java.util.ArrayList;
+import java.util.Arrays;
 import java.util.List;
 
 import static org.apache.flink.util.Preconditions.checkNotNull;
@@ -52,6 +53,36 @@ class StructuredOptionsSplitter {
 		return processTokens(tokens);
 	}
 
+	/**
+	 * Escapes the given string with single quotes, if the input string contains a double quote or any of the
+	 * given {@code charsToEscape}. Any single quotes in the input string will be escaped by doubling.
+	 *
+	 * <p>Given that the escapeChar is (;)
+	 *
+	 * <p>Examples:
+	 * <ul>
+	 *     <li>A,B,C,D => A,B,C,D</li>
+	 *     <li>A'B'C'D => 'A''B''C''D'</li>
+	 *     <li>A;BCD => 'A;BCD'</li>
+	 *     <li>AB"C"D => 'AB"C"D'</li>
+	 *     <li>AB'"D:B => 'AB''"D:B'</li>
+	 * </ul>
+	 *
+	 * @param string a string which needs to be escaped
+	 * @param charsToEscape escape chars for the escape conditions
+	 * @return escaped string by single quote
+	 */
+	static String escapeWithSingleQuote(String string, String... charsToEscape) {
+		boolean escape = Arrays.stream(charsToEscape).anyMatch(string::contains)
+			|| string.contains("\"") || string.contains("'");
+
+		if (escape) {
+			return "'" + string.replaceAll("'", "''") + "'";
+		}
+
+		return string;
+	}
+
 	private static List<String> processTokens(List<Token> tokens) {
 		final List<String> splits = new ArrayList<>();
 		for (int i = 0; i < tokens.size(); i++) {
diff --git a/flink-core/src/test/java/org/apache/flink/configuration/ConfigurationTest.java b/flink-core/src/test/java/org/apache/flink/configuration/ConfigurationTest.java
index 0b1e61c83bc..d54da40043a 100644
--- a/flink-core/src/test/java/org/apache/flink/configuration/ConfigurationTest.java
+++ b/flink-core/src/test/java/org/apache/flink/configuration/ConfigurationTest.java
@@ -23,6 +23,12 @@ import org.apache.flink.util.TestLogger;
 
 import org.junit.Test;
 
+import java.time.Duration;
+import java.util.Arrays;
+import java.util.List;
+import java.util.Map;
+import java.util.stream.Collectors;
+
 import static org.hamcrest.Matchers.containsString;
 import static org.junit.Assert.assertArrayEquals;
 import static org.junit.Assert.assertEquals;
@@ -321,6 +327,29 @@ public class ConfigurationTest extends TestLogger {
 		}
 	}
 
+	@Test
+	public void testToMap() {
+		final ConfigOption<List<String>> listConfigOption = createListStringConfigOption();
+		final Configuration configuration = new Configuration();
+		final String listValues = "value1;value2;value3";
+		configuration.set(listConfigOption, Arrays.asList(listValues.split(";")));
+
+		final ConfigOption<Map<String, String>> mapConfigOption = createMapConfigOption();
+		final String mapValues = "key1:value1,key2:value2";
+		configuration.set(
+			mapConfigOption,
+			Arrays.stream(mapValues.split(","))
+				.collect(Collectors.toMap(e -> e.split(":")[0], e -> e.split(":")[1])));
+
+		final ConfigOption<Duration> durationConfigOption = createDurationConfigOption();
+		final Duration duration = Duration.ofMillis(3000);
+		configuration.set(durationConfigOption, duration);
+
+		assertEquals(listValues, configuration.toMap().get(listConfigOption.key()));
+		assertEquals(mapValues, configuration.toMap().get(mapConfigOption.key()));
+		assertEquals(duration.toNanos() + " ns", configuration.toMap().get(durationConfigOption.key()));
+	}
+
 	enum TestEnum {
 		VALUE1,
 		VALUE2
@@ -331,4 +360,26 @@ public class ConfigurationTest extends TestLogger {
 			.key("test-string-key")
 			.noDefaultValue();
 	}
+
+	private static ConfigOption<List<String>> createListStringConfigOption() {
+		return ConfigOptions
+			.key("test-list-key")
+			.stringType()
+			.asList()
+			.noDefaultValue();
+	}
+
+	private static ConfigOption<Map<String, String>> createMapConfigOption() {
+		return ConfigOptions
+			.key("test-map-key")
+			.mapType()
+			.noDefaultValue();
+	}
+
+	private static ConfigOption<Duration> createDurationConfigOption() {
+		return ConfigOptions
+			.key("test-duration-key")
+			.durationType()
+			.noDefaultValue();
+	}
 }
diff --git a/flink-core/src/test/java/org/apache/flink/configuration/StructuredOptionsSplitterEscapeTest.java b/flink-core/src/test/java/org/apache/flink/configuration/StructuredOptionsSplitterEscapeTest.java
new file mode 100644
index 00000000000..f6257aed346
--- /dev/null
+++ b/flink-core/src/test/java/org/apache/flink/configuration/StructuredOptionsSplitterEscapeTest.java
@@ -0,0 +1,96 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.configuration;
+
+import org.junit.Assert;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
+import java.util.Arrays;
+import java.util.Collection;
+
+/**
+ * Tests for {@link StructuredOptionsSplitter#escapeWithSingleQuote}.
+ */
+@RunWith(Parameterized.class)
+public class StructuredOptionsSplitterEscapeTest {
+
+	@Parameterized.Parameters(name = "{0}")
+	public static Collection<TestSpec> getEncodeSpecs() {
+		return Arrays.asList(
+			TestSpec.encode("A,B,C,D", ";").expect("A,B,C,D"),
+			TestSpec.encode("A;BCD", ";").expect("'A;BCD'"),
+			TestSpec.encode("A'B'C'D", ";").expect("'A''B''C''D'"),
+			TestSpec.encode("AB\"C\"D", ";").expect("'AB\"C\"D'"),
+			TestSpec.encode("AB'\"D:B", ";").expect("'AB''\"D:B'"),
+
+			TestSpec.encode("A,B,C,D", ",").expect("'A,B,C,D'"),
+			TestSpec.encode("A;BCD", ",").expect("A;BCD"),
+			TestSpec.encode("AB\"C\"D", ",").expect("'AB\"C\"D'"),
+			TestSpec.encode("AB'\"D:B", ",").expect("'AB''\"D:B'"),
+
+			TestSpec.encode("A;B;C;D", ",", ":").expect("A;B;C;D"),
+			TestSpec.encode("A;B;C:D", ",", ":").expect("'A;B;C:D'")
+		);
+	}
+
+	@Parameterized.Parameter
+	public TestSpec testSpec;
+
+	@Test
+	public void testEscapeWithSingleQuote() {
+		String encoded = StructuredOptionsSplitter.escapeWithSingleQuote(
+			testSpec.getString(),
+			testSpec.getEscapeChars());
+		Assert.assertEquals(testSpec.getEncodedString(), encoded);
+	}
+
+	private static class TestSpec {
+		private final String string;
+		private final String[] escapeChars;
+		private String encodedString;
+
+		private TestSpec(String string, String... escapeChars) {
+			this.string = string;
+			this.escapeChars = escapeChars;
+		}
+
+		public static TestSpec encode(String string, String... escapeChars) {
+			return new TestSpec(string, escapeChars);
+		}
+
+		public TestSpec expect(String string) {
+			this.encodedString = string;
+			return this;
+		}
+
+		public String getString() {
+			return string;
+		}
+
+		public String getEncodedString() {
+			return encodedString;
+		}
+
+		public String[] getEscapeChars() {
+			return escapeChars;
+		}
+	}
+}
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/clusterframework/BootstrapTools.java b/flink-runtime/src/main/java/org/apache/flink/runtime/clusterframework/BootstrapTools.java
index 4deae0ee074..88f2676b4b5 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/clusterframework/BootstrapTools.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/clusterframework/BootstrapTools.java
@@ -288,11 +288,10 @@ public class BootstrapTools {
 	public static void writeConfiguration(Configuration cfg, File file) throws IOException {
 		try (FileWriter fwrt = new FileWriter(file);
 			PrintWriter out = new PrintWriter(fwrt)) {
-			for (String key : cfg.keySet()) {
-				String value = cfg.getString(key, null);
-				out.print(key);
+			for (Map.Entry<String, String> entry : cfg.toMap().entrySet()) {
+				out.print(entry.getKey());
 				out.print(": ");
-				out.println(value);
+				out.println(entry.getValue());
 			}
 		}
 	}
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/clusterframework/BootstrapToolsTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/clusterframework/BootstrapToolsTest.java
index bf036865c98..9338ac2d925 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/clusterframework/BootstrapToolsTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/clusterframework/BootstrapToolsTest.java
@@ -20,8 +20,11 @@ package org.apache.flink.runtime.clusterframework;
 
 import org.apache.flink.api.common.resources.CPUResource;
 import org.apache.flink.configuration.ConfigConstants;
+import org.apache.flink.configuration.ConfigOption;
+import org.apache.flink.configuration.ConfigOptions;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.configuration.CoreOptions;
+import org.apache.flink.configuration.GlobalConfiguration;
 import org.apache.flink.configuration.MemorySize;
 import org.apache.flink.configuration.ResourceManagerOptions;
 import org.apache.flink.runtime.akka.AkkaUtils;
@@ -34,13 +37,19 @@ import org.apache.flink.util.function.CheckedSupplier;
 
 import akka.actor.ActorSystem;
 import org.junit.Assert;
+import org.junit.Rule;
 import org.junit.Test;
+import org.junit.rules.TemporaryFolder;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
+import java.io.File;
+import java.io.IOException;
 import java.net.BindException;
 import java.net.InetAddress;
 import java.net.ServerSocket;
+import java.time.Duration;
+import java.util.Arrays;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
@@ -52,6 +61,8 @@ import java.util.concurrent.TimeUnit;
 import java.util.stream.Collectors;
 import java.util.stream.IntStream;
 
+import static org.apache.flink.configuration.GlobalConfiguration.FLINK_CONF_FILENAME;
+import static org.hamcrest.Matchers.containsInAnyOrder;
 import static org.hamcrest.Matchers.is;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
@@ -66,6 +77,9 @@ public class BootstrapToolsTest extends TestLogger {
 
 	private static final Logger LOG = LoggerFactory.getLogger(BootstrapToolsTest.class);
 
+	@Rule
+	public TemporaryFolder temporaryFolder = new TemporaryFolder();
+
 	@Test
 	public void testSubstituteConfigKey() {
 		String deprecatedKey1 = "deprecated-key";
@@ -534,4 +548,56 @@ public class BootstrapToolsTest extends TestLogger {
 
 		Assert.assertEquals(0, res.size());
 	}
+
+	@Test
+	public void testWriteConfigurationAndReload() throws IOException {
+		final File flinkConfDir = temporaryFolder.newFolder().getAbsoluteFile();
+		final Configuration flinkConfig = new Configuration();
+
+		final ConfigOption<List<String>> listStringConfigOption = ConfigOptions
+			.key("test-list-string-key")
+			.stringType()
+			.asList()
+			.noDefaultValue();
+		final List<String> list = Arrays.asList("A,B,C,D", "A'B'C'D", "A;BCD", "AB\"C\"D", "AB'\"D:B");
+		flinkConfig.set(listStringConfigOption, list);
+		assertThat(flinkConfig.get(listStringConfigOption), containsInAnyOrder(list.toArray()));
+
+		final ConfigOption<List<Duration>> listDurationConfigOption = ConfigOptions
+			.key("test-list-duration-key")
+			.durationType()
+			.asList()
+			.noDefaultValue();
+		final List<Duration> durationList = Arrays.asList(Duration.ofSeconds(3), Duration.ofMinutes(1));
+		flinkConfig.set(listDurationConfigOption, durationList);
+		assertThat(flinkConfig.get(listDurationConfigOption), containsInAnyOrder(durationList.toArray()));
+
+		final ConfigOption<Map<String, String>> mapConfigOption = ConfigOptions
+			.key("test-map-key")
+			.mapType()
+			.noDefaultValue();
+		final Map<String, String> map = new HashMap<>();
+		map.put("key1", "A,B,C,D");
+		map.put("key2", "A;BCD");
+		map.put("key3", "A'B'C'D");
+		map.put("key4", "AB\"C\"D");
+		map.put("key5", "AB'\"D:B");
+		flinkConfig.set(mapConfigOption, map);
+		assertThat(flinkConfig.get(mapConfigOption).entrySet(), containsInAnyOrder(map.entrySet().toArray()));
+
+		final ConfigOption<Duration> durationConfigOption = ConfigOptions
+			.key("test-duration-key")
+			.durationType()
+			.noDefaultValue();
+		final Duration duration = Duration.ofMillis(3000);
+		flinkConfig.set(durationConfigOption, duration);
+		assertEquals(duration, flinkConfig.get(durationConfigOption));
+
+		BootstrapTools.writeConfiguration(flinkConfig, new File(flinkConfDir, FLINK_CONF_FILENAME));
+		final Configuration loadedFlinkConfig = GlobalConfiguration.loadConfiguration(flinkConfDir.getAbsolutePath());
+		assertThat(loadedFlinkConfig.get(listStringConfigOption), containsInAnyOrder(list.toArray()));
+		assertThat(loadedFlinkConfig.get(listDurationConfigOption), containsInAnyOrder(durationList.toArray()));
+		assertThat(loadedFlinkConfig.get(mapConfigOption).entrySet(), containsInAnyOrder(map.entrySet().toArray()));
+		assertEquals(duration, loadedFlinkConfig.get(durationConfigOption));
+	}
 }
