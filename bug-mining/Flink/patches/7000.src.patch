diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/HsSubpartitionFileReaderImpl.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/HsSubpartitionFileReaderImpl.java
index c190690d45c..e9ca896ac3c 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/HsSubpartitionFileReaderImpl.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/hybrid/HsSubpartitionFileReaderImpl.java
@@ -27,6 +27,7 @@ import org.apache.flink.runtime.io.network.partition.ResultSubpartition;
 import org.apache.flink.util.ExceptionUtils;
 
 import javax.annotation.Nullable;
+import javax.annotation.concurrent.GuardedBy;
 
 import java.io.IOException;
 import java.nio.ByteBuffer;
@@ -69,7 +70,13 @@ public class HsSubpartitionFileReaderImpl implements HsSubpartitionFileReader {
 
     private final Consumer<HsSubpartitionFileReader> fileReaderReleaser;
 
-    private volatile boolean isFailed;
+    private final Object lock = new Object();
+
+    @GuardedBy("lock")
+    private boolean isFailed;
+
+    @GuardedBy("lock")
+    private boolean isReleased;
 
     public HsSubpartitionFileReaderImpl(
             int subpartitionId,
@@ -119,72 +126,83 @@ public class HsSubpartitionFileReaderImpl implements HsSubpartitionFileReader {
      * read ahead the downstream consuming offset.
      */
     @Override
-    public synchronized void readBuffers(Queue<MemorySegment> buffers, BufferRecycler recycler)
+    public void readBuffers(Queue<MemorySegment> buffers, BufferRecycler recycler)
             throws IOException {
-        if (isFailed) {
-            throw new IOException("subpartition reader has already failed.");
-        }
-        int firstBufferToLoad = bufferIndexManager.getNextToLoad();
-        if (firstBufferToLoad < 0) {
-            return;
-        }
+        synchronized (lock) {
+            if (isReleased) {
+                return;
+            }
+            if (isFailed) {
+                throw new IOException("subpartition reader has already failed.");
+            }
+            int firstBufferToLoad = bufferIndexManager.getNextToLoad();
+            if (firstBufferToLoad < 0) {
+                return;
+            }
 
-        // If lookup result is empty, it means that one the following things have happened:
-        // 1) The target buffer has not been spilled into disk.
-        // 2) The target buffer has not been released from memory.
-        // So, just skip this round reading.
-        int numRemainingBuffer = cachedRegionManager.getRemainingBuffersInRegion(firstBufferToLoad);
-        if (numRemainingBuffer == 0) {
-            return;
-        }
-        moveFileOffsetToBuffer(firstBufferToLoad);
-
-        int indexToLoad;
-        int numLoaded = 0;
-        while (!buffers.isEmpty()
-                && (indexToLoad = bufferIndexManager.getNextToLoad()) >= 0
-                && numRemainingBuffer-- > 0) {
-            MemorySegment segment = buffers.poll();
-            Buffer buffer;
-            try {
-                if ((buffer = readFromByteChannel(dataFileChannel, headerBuf, segment, recycler))
-                        == null) {
+            // If lookup result is empty, it means that one the following things have happened:
+            // 1) The target buffer has not been spilled into disk.
+            // 2) The target buffer has not been released from memory.
+            // So, just skip this round reading.
+            int numRemainingBuffer =
+                    cachedRegionManager.getRemainingBuffersInRegion(firstBufferToLoad);
+            if (numRemainingBuffer == 0) {
+                return;
+            }
+            moveFileOffsetToBuffer(firstBufferToLoad);
+
+            int indexToLoad;
+            int numLoaded = 0;
+            while (!buffers.isEmpty()
+                    && (indexToLoad = bufferIndexManager.getNextToLoad()) >= 0
+                    && numRemainingBuffer-- > 0) {
+                MemorySegment segment = buffers.poll();
+                Buffer buffer;
+                try {
+                    if ((buffer =
+                                    readFromByteChannel(
+                                            dataFileChannel, headerBuf, segment, recycler))
+                            == null) {
+                        buffers.add(segment);
+                        break;
+                    }
+                } catch (Throwable throwable) {
                     buffers.add(segment);
-                    break;
+                    throw throwable;
                 }
-            } catch (Throwable throwable) {
-                buffers.add(segment);
-                throw throwable;
-            }
 
-            loadedBuffers.add(BufferIndexOrError.newBuffer(buffer, indexToLoad));
-            bufferIndexManager.updateLastLoaded(indexToLoad);
-            cachedRegionManager.advance(
-                    buffer.readableBytes() + BufferReaderWriterUtil.HEADER_LENGTH);
-            ++numLoaded;
-        }
+                loadedBuffers.add(BufferIndexOrError.newBuffer(buffer, indexToLoad));
+                bufferIndexManager.updateLastLoaded(indexToLoad);
+                cachedRegionManager.advance(
+                        buffer.readableBytes() + BufferReaderWriterUtil.HEADER_LENGTH);
+                ++numLoaded;
+            }
 
-        if (loadedBuffers.size() <= numLoaded) {
-            operations.notifyDataAvailable();
+            if (loadedBuffers.size() <= numLoaded) {
+                operations.notifyDataAvailable();
+            }
         }
     }
 
     @Override
-    public synchronized void fail(Throwable failureCause) {
-        if (isFailed) {
-            return;
-        }
-        isFailed = true;
-        BufferIndexOrError bufferIndexOrError;
-        // empty from tail, in-case subpartition view consumes concurrently and gets the wrong order
-        while ((bufferIndexOrError = loadedBuffers.pollLast()) != null) {
-            if (bufferIndexOrError.getBuffer().isPresent()) {
-                checkNotNull(bufferIndexOrError.buffer).recycleBuffer();
+    public void fail(Throwable failureCause) {
+        synchronized (lock) {
+            if (isFailed) {
+                return;
+            }
+            isFailed = true;
+            BufferIndexOrError bufferIndexOrError;
+            // empty from tail, in-case subpartition view consumes concurrently and gets the wrong
+            // order
+            while ((bufferIndexOrError = loadedBuffers.pollLast()) != null) {
+                if (bufferIndexOrError.getBuffer().isPresent()) {
+                    checkNotNull(bufferIndexOrError.buffer).recycleBuffer();
+                }
             }
-        }
 
-        loadedBuffers.add(BufferIndexOrError.newError(failureCause));
-        operations.notifyDataAvailable();
+            loadedBuffers.add(BufferIndexOrError.newError(failureCause));
+            operations.notifyDataAvailable();
+        }
     }
 
     /** Refresh downstream consumption progress for another round scheduling of reading. */
@@ -251,6 +269,9 @@ public class HsSubpartitionFileReaderImpl implements HsSubpartitionFileReader {
 
     @Override
     public void releaseDataView() {
+        synchronized (lock) {
+            isReleased = true;
+        }
         fileReaderReleaser.accept(this);
     }
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/HsSubpartitionFileReaderImplTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/HsSubpartitionFileReaderImplTest.java
index 2bef058599f..2c828e8e424 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/HsSubpartitionFileReaderImplTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/hybrid/HsSubpartitionFileReaderImplTest.java
@@ -57,7 +57,9 @@ import java.util.Queue;
 import java.util.Random;
 import java.util.UUID;
 import java.util.concurrent.BlockingDeque;
+import java.util.concurrent.CompletableFuture;
 import java.util.concurrent.atomic.AtomicInteger;
+import java.util.function.Consumer;
 
 import static org.assertj.core.api.Assertions.assertThat;
 import static org.assertj.core.api.Assertions.assertThatThrownBy;
@@ -559,6 +561,28 @@ class HsSubpartitionFileReaderImplTest {
         checkData(consumer2, 1, 2, 3);
     }
 
+    @Test
+    void testReadBuffersAfterReleased() throws Throwable {
+        TestingSubpartitionConsumerInternalOperation viewNotifier =
+                new TestingSubpartitionConsumerInternalOperation();
+        CompletableFuture<Void> isReleased = new CompletableFuture<>();
+        HsSubpartitionFileReaderImpl subpartitionFileReader =
+                createSubpartitionFileReader(
+                        0,
+                        HsConsumerId.DEFAULT,
+                        viewNotifier,
+                        (ignore) -> isReleased.complete(null));
+
+        writeDataToFile(0, 0, 2);
+        subpartitionFileReader.prepareForScheduling();
+        Queue<MemorySegment> memorySegments = createsMemorySegments(2);
+        subpartitionFileReader.releaseDataView();
+
+        subpartitionFileReader.readBuffers(memorySegments, (ignore) -> {});
+        assertThat(memorySegments).hasSize(2);
+        assertThat(isReleased).isCompleted();
+    }
+
     private static void checkData(
             HsSubpartitionFileReaderImpl fileReader,
             BufferDecompressor bufferDecompressor,
@@ -595,6 +619,14 @@ class HsSubpartitionFileReaderImplTest {
             int targetChannel,
             HsConsumerId consumerId,
             HsSubpartitionConsumerInternalOperations operations) {
+        return createSubpartitionFileReader(targetChannel, consumerId, operations, ignore -> {});
+    }
+
+    private HsSubpartitionFileReaderImpl createSubpartitionFileReader(
+            int targetChannel,
+            HsConsumerId consumerId,
+            HsSubpartitionConsumerInternalOperations operations,
+            Consumer<HsSubpartitionFileReader> fileReaderReleaser) {
         return new HsSubpartitionFileReaderImpl(
                 targetChannel,
                 consumerId,
@@ -602,7 +634,7 @@ class HsSubpartitionFileReaderImplTest {
                 operations,
                 diskIndex,
                 MAX_BUFFERS_READ_AHEAD,
-                (ignore) -> {},
+                fileReaderReleaser,
                 BufferReaderWriterUtil.allocatedHeaderBuffer());
     }
 
