diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/tasks/AbstractInvokable.java b/flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/tasks/AbstractInvokable.java
index 70a9f4ab701..f05db0775eb 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/tasks/AbstractInvokable.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/tasks/AbstractInvokable.java
@@ -218,7 +218,7 @@ public abstract class AbstractInvokable {
      * @return future with value of {@code false} if the checkpoint was not carried out, {@code
      *     true} otherwise
      */
-    public Future<Boolean> triggerCheckpointAsync(
+    public CompletableFuture<Boolean> triggerCheckpointAsync(
             CheckpointMetaData checkpointMetaData, CheckpointOptions checkpointOptions) {
         throw new UnsupportedOperationException(
                 String.format(
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/taskmanager/Task.java b/flink-runtime/src/main/java/org/apache/flink/runtime/taskmanager/Task.java
index f50bb44080f..b0891f89030 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/taskmanager/Task.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/taskmanager/Task.java
@@ -1305,7 +1305,19 @@ public class Task
 
         if (executionState == ExecutionState.RUNNING && invokable != null) {
             try {
-                invokable.triggerCheckpointAsync(checkpointMetaData, checkpointOptions);
+                invokable
+                        .triggerCheckpointAsync(checkpointMetaData, checkpointOptions)
+                        .handle(
+                                (triggerResult, exception) -> {
+                                    if (exception != null || !triggerResult) {
+                                        declineCheckpoint(
+                                                checkpointID,
+                                                CheckpointFailureReason.TASK_FAILURE,
+                                                exception);
+                                        return false;
+                                    }
+                                    return true;
+                                });
             } catch (RejectedExecutionException ex) {
                 // This may happen if the mailbox is closed. It means that the task is shutting
                 // down, so we just ignore it.
@@ -1314,6 +1326,8 @@ public class Task
                         checkpointID,
                         taskNameWithSubtask,
                         executionId);
+                declineCheckpoint(
+                        checkpointID, CheckpointFailureReason.CHECKPOINT_DECLINED_TASK_CLOSING);
             } catch (Throwable t) {
                 if (getExecutionState() == ExecutionState.RUNNING) {
                     failExternally(
@@ -1340,16 +1354,29 @@ public class Task
                     executionId);
 
             // send back a message that we did not do the checkpoint
-            checkpointResponder.declineCheckpoint(
-                    jobId,
-                    executionId,
-                    checkpointID,
-                    new CheckpointException(
-                            "Task name with subtask : " + taskNameWithSubtask,
-                            CheckpointFailureReason.CHECKPOINT_DECLINED_TASK_NOT_READY));
+            declineCheckpoint(
+                    checkpointID, CheckpointFailureReason.CHECKPOINT_DECLINED_TASK_NOT_READY);
         }
     }
 
+    private void declineCheckpoint(long checkpointID, CheckpointFailureReason failureReason) {
+        declineCheckpoint(checkpointID, failureReason, null);
+    }
+
+    private void declineCheckpoint(
+            long checkpointID,
+            CheckpointFailureReason failureReason,
+            @Nullable Throwable failureCause) {
+        checkpointResponder.declineCheckpoint(
+                jobId,
+                executionId,
+                checkpointID,
+                new CheckpointException(
+                        "Task name with subtask : " + taskNameWithSubtask,
+                        failureReason,
+                        failureCause));
+    }
+
     public void notifyCheckpointComplete(final long checkpointID) {
         final AbstractInvokable invokable = this.invokable;
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/operators/coordination/CoordinatorEventsExactlyOnceITCase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/operators/coordination/CoordinatorEventsExactlyOnceITCase.java
index 0add10e211e..9815fe881de 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/operators/coordination/CoordinatorEventsExactlyOnceITCase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/operators/coordination/CoordinatorEventsExactlyOnceITCase.java
@@ -592,7 +592,7 @@ public class CoordinatorEventsExactlyOnceITCase extends TestLogger {
         }
 
         @Override
-        public Future<Boolean> triggerCheckpointAsync(
+        public CompletableFuture<Boolean> triggerCheckpointAsync(
                 CheckpointMetaData checkpointMetaData, CheckpointOptions checkpointOptions) {
             actions.add(checkpointMetaData); // this signals the main thread should do a checkpoint
             return CompletableFuture.completedFuture(true);
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskAsyncCallTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskAsyncCallTest.java
index 5e4ddbef08f..784bcfce6a2 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskAsyncCallTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskAsyncCallTest.java
@@ -257,7 +257,7 @@ public class TaskAsyncCallTest extends TestLogger {
         }
 
         @Override
-        public Future<Boolean> triggerCheckpointAsync(
+        public CompletableFuture<Boolean> triggerCheckpointAsync(
                 CheckpointMetaData checkpointMetaData, CheckpointOptions checkpointOptions) {
             lastCheckpointId++;
             if (checkpointMetaData.getCheckpointId() == lastCheckpointId) {
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskTest.java
index 82b359cc8e6..70b218b629a 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TaskTest.java
@@ -22,6 +22,10 @@ import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.configuration.TaskManagerOptions;
 import org.apache.flink.core.testutils.OneShotLatch;
+import org.apache.flink.runtime.checkpoint.CheckpointFailureReason;
+import org.apache.flink.runtime.checkpoint.CheckpointMetaData;
+import org.apache.flink.runtime.checkpoint.CheckpointOptions;
+import org.apache.flink.runtime.checkpoint.CheckpointType;
 import org.apache.flink.runtime.deployment.InputGateDeploymentDescriptor;
 import org.apache.flink.runtime.deployment.ResultPartitionDeploymentDescriptor;
 import org.apache.flink.runtime.execution.CancelTaskException;
@@ -37,10 +41,12 @@ import org.apache.flink.runtime.io.network.partition.consumer.RemoteChannelState
 import org.apache.flink.runtime.jobgraph.IntermediateDataSetID;
 import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
 import org.apache.flink.runtime.jobmanager.PartitionProducerDisposedException;
+import org.apache.flink.runtime.operators.testutils.ExpectedTestException;
 import org.apache.flink.runtime.shuffle.PartitionDescriptor;
 import org.apache.flink.runtime.shuffle.PartitionDescriptorBuilder;
 import org.apache.flink.runtime.shuffle.ShuffleDescriptor;
 import org.apache.flink.runtime.shuffle.ShuffleEnvironment;
+import org.apache.flink.runtime.state.CheckpointStorageLocationReference;
 import org.apache.flink.runtime.taskexecutor.PartitionProducerStateChecker;
 import org.apache.flink.runtime.util.NettyShuffleDescriptorBuilder;
 import org.apache.flink.util.FlinkException;
@@ -65,6 +71,7 @@ import java.util.concurrent.BlockingQueue;
 import java.util.concurrent.CompletableFuture;
 import java.util.concurrent.Future;
 import java.util.concurrent.LinkedBlockingDeque;
+import java.util.concurrent.RejectedExecutionException;
 import java.util.concurrent.TimeoutException;
 import java.util.concurrent.atomic.AtomicInteger;
 
@@ -1081,6 +1088,71 @@ public class TaskTest extends TestLogger {
         assertFalse(task.isBackPressured());
     }
 
+    @Test
+    public void testDeclineCheckpoint() throws Exception {
+        TestCheckpointResponder testCheckpointResponder = new TestCheckpointResponder();
+        final Task task =
+                createTaskBuilder()
+                        .setInvokable(InvokableDeclingingCheckpoints.class)
+                        .setCheckpointResponder(testCheckpointResponder)
+                        .build();
+        assertCheckpointDeclined(
+                task,
+                testCheckpointResponder,
+                1,
+                CheckpointFailureReason.CHECKPOINT_DECLINED_TASK_NOT_READY);
+
+        task.startTaskThread();
+        try {
+            awaitLatch.await();
+            assertEquals(ExecutionState.RUNNING, task.getExecutionState());
+
+            assertCheckpointDeclined(
+                    task,
+                    testCheckpointResponder,
+                    InvokableDeclingingCheckpoints.REJECTED_EXECUTION_CHECKPOINT_ID,
+                    CheckpointFailureReason.CHECKPOINT_DECLINED_TASK_CLOSING);
+            assertCheckpointDeclined(
+                    task,
+                    testCheckpointResponder,
+                    InvokableDeclingingCheckpoints.THROWING_CHECKPOINT_ID,
+                    CheckpointFailureReason.TASK_FAILURE);
+            assertCheckpointDeclined(
+                    task,
+                    testCheckpointResponder,
+                    InvokableDeclingingCheckpoints.TRIGGERING_FAILED_CHECKPOINT_ID,
+                    CheckpointFailureReason.TASK_FAILURE);
+        } finally {
+            triggerLatch.trigger();
+            task.getExecutingThread().join();
+        }
+        assertEquals(ExecutionState.FINISHED, task.getTerminationFuture().getNow(null));
+    }
+
+    private void assertCheckpointDeclined(
+            Task task,
+            TestCheckpointResponder testCheckpointResponder,
+            long checkpointId,
+            CheckpointFailureReason failureReason) {
+        CheckpointOptions checkpointOptions =
+                CheckpointOptions.alignedNoTimeout(
+                        CheckpointType.CHECKPOINT, CheckpointStorageLocationReference.getDefault());
+        task.triggerCheckpointBarrier(checkpointId, 1, checkpointOptions);
+
+        assertEquals(1, testCheckpointResponder.getDeclineReports().size());
+        assertEquals(
+                checkpointId, testCheckpointResponder.getDeclineReports().get(0).getCheckpointId());
+        assertEquals(
+                failureReason,
+                testCheckpointResponder
+                        .getDeclineReports()
+                        .get(0)
+                        .getCause()
+                        .getCheckpointFailureReason());
+
+        testCheckpointResponder.clear();
+    }
+
     // ------------------------------------------------------------------------
     //  customized TaskManagerActions
     // ------------------------------------------------------------------------
@@ -1198,7 +1270,7 @@ public class TaskTest extends TestLogger {
         }
     }
 
-    private static final class InvokableBlockingWithTrigger extends AbstractInvokable {
+    private static class InvokableBlockingWithTrigger extends AbstractInvokable {
         public InvokableBlockingWithTrigger(Environment environment) {
             super(environment);
         }
@@ -1211,6 +1283,35 @@ public class TaskTest extends TestLogger {
         }
     }
 
+    private static class InvokableDeclingingCheckpoints extends InvokableBlockingWithTrigger {
+        public static final int REJECTED_EXECUTION_CHECKPOINT_ID = 2;
+        public static final int THROWING_CHECKPOINT_ID = 3;
+        public static final int TRIGGERING_FAILED_CHECKPOINT_ID = 4;
+
+        public InvokableDeclingingCheckpoints(Environment environment) {
+            super(environment);
+        }
+
+        @Override
+        public CompletableFuture<Boolean> triggerCheckpointAsync(
+                CheckpointMetaData checkpointMetaData, CheckpointOptions checkpointOptions) {
+            long checkpointId = checkpointMetaData.getCheckpointId();
+            switch (Math.toIntExact(checkpointId)) {
+                case REJECTED_EXECUTION_CHECKPOINT_ID:
+                    throw new RejectedExecutionException();
+                case THROWING_CHECKPOINT_ID:
+                    CompletableFuture<Boolean> result = new CompletableFuture<>();
+                    result.completeExceptionally(new ExpectedTestException());
+                    return result;
+                case TRIGGERING_FAILED_CHECKPOINT_ID:
+                    return CompletableFuture.completedFuture(false);
+                default:
+                    throw new UnsupportedOperationException(
+                            "Unsupported checkpointId: " + checkpointId);
+            }
+        }
+    }
+
     private static final class InvokableBlockingInInvoke extends AbstractInvokable {
         public InvokableBlockingInInvoke(Environment environment) {
             super(environment);
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TestTaskBuilder.java b/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TestTaskBuilder.java
index 8174025aa2f..078640c9139 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TestTaskBuilder.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TestTaskBuilder.java
@@ -89,6 +89,7 @@ public final class TestTaskBuilder {
     private ExecutionAttemptID executionAttemptId = new ExecutionAttemptID();
     private ExternalResourceInfoProvider externalResourceInfoProvider =
             ExternalResourceInfoProvider.NO_EXTERNAL_RESOURCES;
+    private TestCheckpointResponder testCheckpointResponder = new TestCheckpointResponder();
 
     public TestTaskBuilder(ShuffleEnvironment<?, ?> shuffleEnvironment) {
         this.shuffleEnvironment = Preconditions.checkNotNull(shuffleEnvironment);
@@ -185,6 +186,11 @@ public final class TestTaskBuilder {
         return this;
     }
 
+    public TestTaskBuilder setCheckpointResponder(TestCheckpointResponder testCheckpointResponder) {
+        this.testCheckpointResponder = testCheckpointResponder;
+        return this;
+    }
+
     public Task build() throws Exception {
         final JobVertexID jobVertexId = new JobVertexID();
 
@@ -226,7 +232,7 @@ public final class TestTaskBuilder {
                 new TestTaskStateManager(),
                 taskManagerActions,
                 new MockInputSplitProvider(),
-                new TestCheckpointResponder(),
+                testCheckpointResponder,
                 new NoOpTaskOperatorEventGateway(),
                 new TestGlobalAggregateManager(),
                 classLoaderHandle,
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointSequenceValidator.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointSequenceValidator.java
index cce35b8bbb6..ec9c8aa6be3 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointSequenceValidator.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointSequenceValidator.java
@@ -25,6 +25,7 @@ import org.apache.flink.runtime.checkpoint.CheckpointOptions;
 import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
 import org.apache.flink.runtime.operators.testutils.DummyEnvironment;
 
+import java.util.concurrent.CompletableFuture;
 import java.util.concurrent.Future;
 
 import static org.junit.Assert.assertEquals;
@@ -49,7 +50,7 @@ class CheckpointSequenceValidator extends AbstractInvokable {
     }
 
     @Override
-    public Future<Boolean> triggerCheckpointAsync(
+    public CompletableFuture<Boolean> triggerCheckpointAsync(
             CheckpointMetaData checkpointMetaData, CheckpointOptions checkpointOptions) {
         throw new UnsupportedOperationException("should never be called");
     }
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/ValidatingCheckpointHandler.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/ValidatingCheckpointHandler.java
index 8fa85ae4cab..180ba867758 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/ValidatingCheckpointHandler.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/checkpointing/ValidatingCheckpointHandler.java
@@ -101,7 +101,7 @@ public class ValidatingCheckpointHandler extends AbstractInvokable {
     }
 
     @Override
-    public Future<Boolean> triggerCheckpointAsync(
+    public CompletableFuture<Boolean> triggerCheckpointAsync(
             CheckpointMetaData checkpointMetaData, CheckpointOptions checkpointOptions) {
         throw new UnsupportedOperationException("should never be called");
     }
diff --git a/flink-tests/src/test/java/org/apache/flink/runtime/jobmaster/JobMasterTriggerSavepointITCase.java b/flink-tests/src/test/java/org/apache/flink/runtime/jobmaster/JobMasterTriggerSavepointITCase.java
index 99b090ab14a..1361c4ef7ec 100644
--- a/flink-tests/src/test/java/org/apache/flink/runtime/jobmaster/JobMasterTriggerSavepointITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/runtime/jobmaster/JobMasterTriggerSavepointITCase.java
@@ -239,7 +239,7 @@ public class JobMasterTriggerSavepointITCase extends AbstractTestBase {
         }
 
         @Override
-        public Future<Boolean> triggerCheckpointAsync(
+        public CompletableFuture<Boolean> triggerCheckpointAsync(
                 final CheckpointMetaData checkpointMetaData,
                 final CheckpointOptions checkpointOptions) {
             final TaskStateSnapshot checkpointStateHandles = new TaskStateSnapshot();
