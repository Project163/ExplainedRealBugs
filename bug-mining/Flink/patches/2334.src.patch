diff --git a/flink-core/src/main/java/org/apache/flink/api/common/ExecutionConfig.java b/flink-core/src/main/java/org/apache/flink/api/common/ExecutionConfig.java
index fb888c07f27..7a0a574ad20 100644
--- a/flink-core/src/main/java/org/apache/flink/api/common/ExecutionConfig.java
+++ b/flink-core/src/main/java/org/apache/flink/api/common/ExecutionConfig.java
@@ -69,6 +69,7 @@ public class ExecutionConfig implements Serializable, Archiveable<ArchivedExecut
 	 * The constant to use for the parallelism, if the system should use the number
 	 * of currently available slots.
 	 */
+	@Deprecated
 	public static final int PARALLELISM_AUTO_MAX = Integer.MAX_VALUE;
 
 	/**
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/ExecutionGraphBuilder.java b/flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/ExecutionGraphBuilder.java
index 5d076e271c1..f1a861d2ca1 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/ExecutionGraphBuilder.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/executiongraph/ExecutionGraphBuilder.java
@@ -72,12 +72,55 @@ import static org.apache.flink.util.Preconditions.checkNotNull;
  * Utility class to encapsulate the logic of building an {@link ExecutionGraph} from a {@link JobGraph}.
  */
 public class ExecutionGraphBuilder {
+	public static final String PARALLELISM_AUTO_MAX_ERROR_MESSAGE =
+		"PARALLELISM_AUTO_MAX is no longer supported. Please specify a concrete value for the parallelism.";
 
 	/**
 	 * Builds the ExecutionGraph from the JobGraph.
 	 * If a prior execution graph exists, the JobGraph will be attached. If no prior execution
 	 * graph exists, then the JobGraph will become attach to a new empty execution graph.
 	 */
+	public static ExecutionGraph buildGraph(
+			@Nullable ExecutionGraph prior,
+			JobGraph jobGraph,
+			Configuration jobManagerConfig,
+			ScheduledExecutorService futureExecutor,
+			Executor ioExecutor,
+			SlotProvider slotProvider,
+			ClassLoader classLoader,
+			CheckpointRecoveryFactory recoveryFactory,
+			Time rpcTimeout,
+			RestartStrategy restartStrategy,
+			MetricGroup metrics,
+			BlobWriter blobWriter,
+			Time allocationTimeout,
+			Logger log)
+		throws JobExecutionException, JobException {
+
+		return buildGraph(
+			prior,
+			jobGraph,
+			jobManagerConfig,
+			futureExecutor,
+			ioExecutor,
+			slotProvider,
+			classLoader,
+			recoveryFactory,
+			rpcTimeout,
+			restartStrategy,
+			metrics,
+			-1,
+			blobWriter,
+			allocationTimeout,
+			log);
+	}
+
+	/**
+	 * Builds the ExecutionGraph from the JobGraph.
+	 * If a prior execution graph exists, the JobGraph will be attached. If no prior execution
+	 * graph exists, then the JobGraph will become attach to a new empty execution graph.
+	 */
+	@Deprecated
 	public static ExecutionGraph buildGraph(
 			@Nullable ExecutionGraph prior,
 			JobGraph jobGraph,
@@ -159,7 +202,14 @@ public class ExecutionGraphBuilder {
 			}
 
 			if (vertex.getParallelism() == ExecutionConfig.PARALLELISM_AUTO_MAX) {
-				vertex.setParallelism(parallelismForAutoMax);
+				if (parallelismForAutoMax < 0) {
+					throw new JobSubmissionException(
+						jobId,
+						PARALLELISM_AUTO_MAX_ERROR_MESSAGE);
+				}
+				else {
+					vertex.setParallelism(parallelismForAutoMax);
+				}
 			}
 
 			try {
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/JobMaster.java b/flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/JobMaster.java
index d17c97d9e92..1e38792034f 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/JobMaster.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/jobmaster/JobMaster.java
@@ -1135,7 +1135,6 @@ public class JobMaster extends FencedRpcEndpoint<JobMasterId> implements JobMast
 			rpcTimeout,
 			restartStrategy,
 			currentJobManagerJobMetricGroup,
-			-1,
 			blobServer,
 			jobMasterConfiguration.getSlotRequestTimeout(),
 			log);
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java
index 977ec1445cc..69764e7adc0 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/executiongraph/ExecutionGraphRescalingTest.java
@@ -75,7 +75,6 @@ public class ExecutionGraphRescalingTest extends TestLogger {
 			AkkaUtils.getDefaultTimeout(),
 			new NoRestartStrategy(),
 			new UnregisteredMetricsGroup(),
-			-1,
 			VoidBlobWriter.getInstance(),
 			AkkaUtils.getDefaultTimeout(),
 			TEST_LOGGER);
@@ -105,7 +104,6 @@ public class ExecutionGraphRescalingTest extends TestLogger {
 			AkkaUtils.getDefaultTimeout(),
 			new NoRestartStrategy(),
 			new UnregisteredMetricsGroup(),
-			-1,
 			VoidBlobWriter.getInstance(),
 			AkkaUtils.getDefaultTimeout(),
 			TEST_LOGGER);
@@ -135,7 +133,6 @@ public class ExecutionGraphRescalingTest extends TestLogger {
 			AkkaUtils.getDefaultTimeout(),
 			new NoRestartStrategy(),
 			new UnregisteredMetricsGroup(),
-			-1,
 			VoidBlobWriter.getInstance(),
 			AkkaUtils.getDefaultTimeout(),
 			TEST_LOGGER);
@@ -178,7 +175,6 @@ public class ExecutionGraphRescalingTest extends TestLogger {
 				AkkaUtils.getDefaultTimeout(),
 				new NoRestartStrategy(),
 				new UnregisteredMetricsGroup(),
-				-1,
 				VoidBlobWriter.getInstance(),
 				AkkaUtils.getDefaultTimeout(),
 				TEST_LOGGER);
diff --git a/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/test/util/MiniClusterResource.java b/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/test/util/MiniClusterResource.java
index dbd292cd2d0..545be8659fd 100644
--- a/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/test/util/MiniClusterResource.java
+++ b/flink-test-utils-parent/flink-test-utils/src/main/java/org/apache/flink/test/util/MiniClusterResource.java
@@ -93,6 +93,10 @@ public class MiniClusterResource extends ExternalResource {
 		this.enableClusterClient = enableClusterClient;
 	}
 
+	public MiniClusterType getMiniClusterType() {
+		return miniClusterType;
+	}
+
 	public int getNumberSlots() {
 		return numberSlots;
 	}
diff --git a/flink-tests/src/test/java/org/apache/flink/test/misc/AutoParallelismITCase.java b/flink-tests/src/test/java/org/apache/flink/test/misc/AutoParallelismITCase.java
index 9cafee624f0..dd1c39806d3 100644
--- a/flink-tests/src/test/java/org/apache/flink/test/misc/AutoParallelismITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/test/misc/AutoParallelismITCase.java
@@ -22,17 +22,19 @@ import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.functions.RichMapPartitionFunction;
 import org.apache.flink.api.common.io.GenericInputFormat;
 import org.apache.flink.api.java.DataSet;
+import org.apache.flink.api.java.ExecutionEnvironment;
 import org.apache.flink.api.java.io.LocalCollectionOutputFormat;
-import org.apache.flink.configuration.ConfigConstants;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.core.io.GenericInputSplit;
-import org.apache.flink.runtime.minicluster.LocalFlinkMiniCluster;
-import org.apache.flink.test.util.TestEnvironment;
+import org.apache.flink.runtime.executiongraph.ExecutionGraphBuilder;
+import org.apache.flink.test.util.MiniClusterResource;
+import org.apache.flink.test.util.MiniClusterResource.MiniClusterResourceConfiguration;
+import org.apache.flink.test.util.MiniClusterResource.MiniClusterType;
 import org.apache.flink.util.Collector;
+import org.apache.flink.util.ExceptionUtils;
 import org.apache.flink.util.TestLogger;
 
-import org.junit.AfterClass;
-import org.junit.BeforeClass;
+import org.junit.ClassRule;
 import org.junit.Test;
 
 import java.io.IOException;
@@ -40,7 +42,7 @@ import java.util.ArrayList;
 import java.util.List;
 
 import static org.junit.Assert.assertEquals;
-import static org.junit.Assert.fail;
+import static org.junit.Assert.assertTrue;
 
 /**
  * This test verifies that the auto parallelism is properly forwarded to the runtime.
@@ -52,55 +54,38 @@ public class AutoParallelismITCase extends TestLogger {
 	private static final int SLOTS_PER_TM = 7;
 	private static final int PARALLELISM = NUM_TM * SLOTS_PER_TM;
 
-	private static LocalFlinkMiniCluster cluster;
+	@ClassRule
+	public static final MiniClusterResource MINI_CLUSTER_RESOURCE = new MiniClusterResource(
+		new MiniClusterResourceConfiguration(
+			new Configuration(),
+			NUM_TM,
+			SLOTS_PER_TM));
 
-	private static TestEnvironment env;
+	@Test
+	public void testProgramWithAutoParallelism() throws Exception {
+		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
 
-	@BeforeClass
-	public static void setupCluster() {
-		Configuration config = new Configuration();
-		config.setInteger(ConfigConstants.LOCAL_NUMBER_TASK_MANAGER, NUM_TM);
-		config.setInteger(ConfigConstants.TASK_MANAGER_NUM_TASK_SLOTS, SLOTS_PER_TM);
-		cluster = new LocalFlinkMiniCluster(config, false);
+		env.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);
+		env.getConfig().disableSysoutLogging();
 
-		cluster.start();
+		DataSet<Integer> result = env
+				.createInput(new ParallelismDependentInputFormat())
+				.rebalance()
+				.mapPartition(new ParallelismDependentMapPartition());
 
-		env = new TestEnvironment(cluster, NUM_TM * SLOTS_PER_TM, false);
-	}
+		List<Integer> resultCollection = new ArrayList<>();
+		result.output(new LocalCollectionOutputFormat<>(resultCollection));
 
-	@AfterClass
-	public static void teardownCluster() {
 		try {
-			cluster.stop();
-		}
-		catch (Throwable t) {
-			System.err.println("Error stopping cluster on shutdown");
-			t.printStackTrace();
-			fail("ClusterClient shutdown caused an exception: " + t.getMessage());
-		}
-	}
-
-	@Test
-	public void testProgramWithAutoParallelism() {
-		try {
-			env.setParallelism(ExecutionConfig.PARALLELISM_AUTO_MAX);
-			env.getConfig().disableSysoutLogging();
-
-			DataSet<Integer> result = env
-					.createInput(new ParallelismDependentInputFormat())
-					.rebalance()
-					.mapPartition(new ParallelismDependentMapPartition());
-
-			List<Integer> resultCollection = new ArrayList<Integer>();
-			result.output(new LocalCollectionOutputFormat<Integer>(resultCollection));
-
 			env.execute();
-
 			assertEquals(PARALLELISM, resultCollection.size());
 		}
-		catch (Exception e) {
-			e.printStackTrace();
-			fail(e.getMessage());
+		catch (Exception ex) {
+			if (MINI_CLUSTER_RESOURCE.getMiniClusterType().equals(MiniClusterType.OLD)) {
+				throw ex;
+			}
+			assertTrue(
+				ExceptionUtils.findThrowableWithMessage(ex, ExecutionGraphBuilder.PARALLELISM_AUTO_MAX_ERROR_MESSAGE).isPresent());
 		}
 	}
 
