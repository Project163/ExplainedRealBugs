diff --git a/flink-java/src/main/java/org/apache/flink/api/java/typeutils/TypeExtractor.java b/flink-java/src/main/java/org/apache/flink/api/java/typeutils/TypeExtractor.java
index 124055cc374..c99a80f248b 100644
--- a/flink-java/src/main/java/org/apache/flink/api/java/typeutils/TypeExtractor.java
+++ b/flink-java/src/main/java/org/apache/flink/api/java/typeutils/TypeExtractor.java
@@ -680,10 +680,20 @@ public class TypeExtractor {
 		}
 	}
 	
-	private static void validateInputType(Class<?> baseClass, Class<?> clazz, int inputParamPos, TypeInformation<?> inType) {
+	private static void validateInputType(Class<?> baseClass, Class<?> clazz, int inputParamPos, TypeInformation<?> inTypeInfo) {
 		ArrayList<Type> typeHierarchy = new ArrayList<Type>();
+
+		// try to get generic parameter
+		Type inType;
+		try {
+			inType = getParameterType(baseClass, typeHierarchy, clazz, inputParamPos);
+		}
+		catch (IllegalArgumentException e) {
+			return; // skip input validation e.g. for raw types
+		}
+
 		try {
-			validateInfo(typeHierarchy, getParameterType(baseClass, typeHierarchy, clazz, inputParamPos), inType);
+			validateInfo(typeHierarchy, inType, inTypeInfo);
 		}
 		catch(InvalidTypesException e) {
 			throw new InvalidTypesException("Input mismatch: " + e.getMessage());
diff --git a/flink-java/src/test/java/org/apache/flink/api/java/type/extractor/TypeExtractorTest.java b/flink-java/src/test/java/org/apache/flink/api/java/type/extractor/TypeExtractorTest.java
index 748f81c2131..b96b3bcc084 100644
--- a/flink-java/src/test/java/org/apache/flink/api/java/type/extractor/TypeExtractorTest.java
+++ b/flink-java/src/test/java/org/apache/flink/api/java/type/extractor/TypeExtractorTest.java
@@ -1731,8 +1731,31 @@ public class TypeExtractorTest {
 				+ ">>>", ti.toString());
 		
 		// generic array
-		// TODO depends on #315
-		//ti = TypeExtractor.getMapReturnTypes((MapFunction) new MapperWithMultiDimGenericArray<String>(), TypeInfoParser.parse("String[][][]"));
-		//Assert.assertEquals("ObjectArrayTypeInfo<ObjectArrayTypeInfo<ObjectArrayTypeInfo<Java Tuple1<String>>>>",);
+		ti = TypeExtractor.getMapReturnTypes((MapFunction) new MapperWithMultiDimGenericArray<String>(), TypeInfoParser.parse("String[][][]"));
+		Assert.assertEquals("ObjectArrayTypeInfo<ObjectArrayTypeInfo<ObjectArrayTypeInfo<Java Tuple1<String>>>>", ti.toString());
+	}
+
+	@SuppressWarnings("rawtypes")
+	public static class MapWithResultTypeQueryable implements MapFunction, ResultTypeQueryable {
+		private static final long serialVersionUID = 1L;
+
+		@Override
+		public TypeInformation getProducedType() {
+			return BasicTypeInfo.STRING_TYPE_INFO;
+		}
+
+		@Override
+		public Object map(Object value) throws Exception {
+			return null;
+		}
+	}
+
+	@SuppressWarnings({ "unchecked", "rawtypes" })
+	@Test
+	public void testInputMismatchWithRawFuntion() {
+		MapFunction<?, ?> function = new MapWithResultTypeQueryable();
+
+		TypeInformation<?> ti = TypeExtractor.getMapReturnTypes((MapFunction)function, BasicTypeInfo.INT_TYPE_INFO);
+		Assert.assertEquals(BasicTypeInfo.STRING_TYPE_INFO, ti);
 	}
 }
