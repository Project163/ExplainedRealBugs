diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/channel/ChannelStateWriter.java b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/channel/ChannelStateWriter.java
index 829208994ec..9764989136e 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/channel/ChannelStateWriter.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/channel/ChannelStateWriter.java
@@ -146,7 +146,12 @@ public interface ChannelStateWriter extends Closeable, CheckpointListener {
 	 */
 	ChannelStateWriteResult getWriteResult(long checkpointId);
 
-	ChannelStateWriter NO_OP = new ChannelStateWriter() {
+	ChannelStateWriter NO_OP = new NoOpChannelStateWriter();
+
+	/**
+	 * No-op implementation of {@link ChannelStateWriter}.
+	 */
+	class NoOpChannelStateWriter implements ChannelStateWriter {
 		@Override
 		public void start(long checkpointId, CheckpointOptions checkpointOptions) {
 		}
@@ -185,5 +190,5 @@ public interface ChannelStateWriter extends Closeable, CheckpointListener {
 		@Override
 		public void notifyCheckpointComplete(long checkpointId) {
 		}
-	};
+	}
 }
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/InputChannel.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/InputChannel.java
index c02ee70a293..fa683e7ac60 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/InputChannel.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/InputChannel.java
@@ -19,6 +19,7 @@
 package org.apache.flink.runtime.io.network.partition.consumer;
 
 import org.apache.flink.metrics.Counter;
+import org.apache.flink.runtime.checkpoint.channel.ChannelStateWriter;
 import org.apache.flink.runtime.checkpoint.channel.InputChannelInfo;
 import org.apache.flink.runtime.event.AbstractEvent;
 import org.apache.flink.runtime.event.TaskEvent;
@@ -33,8 +34,6 @@ import org.apache.flink.runtime.io.network.partition.ResultSubpartitionView;
 import javax.annotation.Nullable;
 
 import java.io.IOException;
-import java.util.Collections;
-import java.util.List;
 import java.util.Optional;
 import java.util.concurrent.atomic.AtomicReference;
 
@@ -152,8 +151,7 @@ public abstract class InputChannel {
 		inputGate.notifyChannelNonEmpty(this);
 	}
 
-	public List<Buffer> requestInflightBuffers(long checkpointId) throws IOException {
-		return Collections.emptyList();
+	public void spillInflightBuffers(long checkpointId, ChannelStateWriter channelStateWriter) throws IOException {
 	}
 
 	// ------------------------------------------------------------------------
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RemoteInputChannel.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RemoteInputChannel.java
index a2ab2a970db..09dd0e72f40 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RemoteInputChannel.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RemoteInputChannel.java
@@ -21,6 +21,7 @@ package org.apache.flink.runtime.io.network.partition.consumer;
 import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.core.memory.MemorySegment;
 import org.apache.flink.core.memory.MemorySegmentProvider;
+import org.apache.flink.runtime.checkpoint.channel.ChannelStateWriter;
 import org.apache.flink.runtime.event.TaskEvent;
 import org.apache.flink.runtime.io.network.ConnectionID;
 import org.apache.flink.runtime.io.network.ConnectionManager;
@@ -111,7 +112,10 @@ public class RemoteInputChannel extends InputChannel implements BufferRecycler,
 	@Nonnull
 	private final MemorySegmentProvider memorySegmentProvider;
 
-	/** The latest already triggered checkpoint id which would be updated during {@link #requestInflightBuffers(long)}.*/
+	/**
+	 * The latest already triggered checkpoint id which would be updated during
+	 * {@link #spillInflightBuffers(long, ChannelStateWriter)}.
+	 */
 	@GuardedBy("receivedBuffers")
 	private long lastRequestedCheckpointId = -1;
 
@@ -216,7 +220,7 @@ public class RemoteInputChannel extends InputChannel implements BufferRecycler,
 	}
 
 	@Override
-	public List<Buffer> requestInflightBuffers(long checkpointId) throws IOException {
+	public void spillInflightBuffers(long checkpointId, ChannelStateWriter channelStateWriter) throws IOException {
 		synchronized (receivedBuffers) {
 			checkState(checkpointId > lastRequestedCheckpointId, "Need to request the next checkpointId");
 
@@ -233,7 +237,11 @@ public class RemoteInputChannel extends InputChannel implements BufferRecycler,
 
 			lastRequestedCheckpointId = checkpointId;
 
-			return inflightBuffers;
+			channelStateWriter.addInputData(
+				checkpointId,
+				channelInfo,
+				ChannelStateWriter.SEQUENCE_NUMBER_UNKNOWN,
+				inflightBuffers.toArray(new Buffer[0]));
 		}
 	}
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateTest.java
index d8b1e2b4433..e0651e9d9f0 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateTest.java
@@ -23,6 +23,8 @@ import org.apache.flink.core.memory.MemorySegmentFactory;
 import org.apache.flink.metrics.groups.UnregisteredMetricsGroup;
 import org.apache.flink.runtime.checkpoint.CheckpointOptions;
 import org.apache.flink.runtime.checkpoint.CheckpointType;
+import org.apache.flink.runtime.checkpoint.channel.ChannelStateWriter;
+import org.apache.flink.runtime.checkpoint.channel.ChannelStateWriterImpl;
 import org.apache.flink.runtime.checkpoint.channel.InputChannelInfo;
 import org.apache.flink.runtime.clusterframework.types.ResourceID;
 import org.apache.flink.runtime.deployment.InputGateDeploymentDescriptor;
@@ -60,6 +62,7 @@ import org.apache.flink.runtime.shuffle.NettyShuffleDescriptor;
 import org.apache.flink.runtime.shuffle.ShuffleDescriptor;
 import org.apache.flink.runtime.shuffle.UnknownShuffleDescriptor;
 import org.apache.flink.runtime.state.CheckpointStorageLocationReference;
+import org.apache.flink.util.ExceptionUtils;
 
 import org.junit.Test;
 
@@ -67,6 +70,7 @@ import java.io.IOException;
 import java.nio.ByteBuffer;
 import java.nio.ByteOrder;
 import java.util.ArrayList;
+import java.util.Arrays;
 import java.util.Collection;
 import java.util.HashMap;
 import java.util.List;
@@ -83,6 +87,7 @@ import static org.apache.flink.runtime.util.NettyShuffleDescriptorBuilder.create
 import static org.hamcrest.MatcherAssert.assertThat;
 import static org.hamcrest.Matchers.instanceOf;
 import static org.hamcrest.Matchers.is;
+import static org.junit.Assert.assertArrayEquals;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertNotNull;
@@ -672,13 +677,13 @@ public class SingleInputGateTest extends InputGateTestBase {
 
 		remoteInputChannel1.onBuffer(createBuffer(1), 0, 0);
 		remoteInputChannel2.onBuffer(EventSerializer.toBuffer(new CheckpointBarrier(0, 0, options)), 0, 0);
-		remoteInputChannel1.requestInflightBuffers(0);
-		remoteInputChannel2.requestInflightBuffers(0);
+		remoteInputChannel1.spillInflightBuffers(0, ChannelStateWriter.NO_OP);
+		remoteInputChannel2.spillInflightBuffers(0, ChannelStateWriter.NO_OP);
 		remoteInputChannel1.onBuffer(createBuffer(11), 1, 0);
 		remoteInputChannel2.onBuffer(createBuffer(12), 1, 0);
 		remoteInputChannel1.onBuffer(EventSerializer.toBuffer(new CheckpointBarrier(1, 0, options)), 2, 0);
-		remoteInputChannel1.requestInflightBuffers(1);
-		remoteInputChannel2.requestInflightBuffers(1);
+		remoteInputChannel1.spillInflightBuffers(1, ChannelStateWriter.NO_OP);
+		remoteInputChannel2.spillInflightBuffers(1, ChannelStateWriter.NO_OP);
 		remoteInputChannel1.onBuffer(createBuffer(21), 3, 0);
 		remoteInputChannel2.onBuffer(createBuffer(22), 2, 0);
 
@@ -767,6 +772,59 @@ public class SingleInputGateTest extends InputGateTestBase {
 		}
 	}
 
+	@Test
+	public void testConcurrentReceiveBuffersAndSpillInflightBuffers() throws Exception {
+		NettyShuffleEnvironment network = createNettyShuffleEnvironment();
+		SingleInputGate inputGate = createInputGate(network, 1, ResultPartitionType.PIPELINED);
+		RemoteInputChannel inputChannel = InputChannelBuilder.newBuilder()
+			.setChannelIndex(0)
+			.setupFromNettyShuffleEnvironment(network)
+			.setConnectionManager(new TestingConnectionManager())
+			.buildRemoteChannel(inputGate);
+
+		List<Buffer> inflightBuffers = new ArrayList<>();
+		inputGate.registerBufferReceivedListener(new BufferReceivedListener() {
+			@Override
+			public void notifyBufferReceived(Buffer buffer, InputChannelInfo channelInfo) {
+				inflightBuffers.add(buffer);
+			}
+
+			@Override
+			public void notifyBarrierReceived(CheckpointBarrier barrier, InputChannelInfo channelInfo) {
+			}
+		});
+
+		List<Buffer> buffers = new ArrayList<>();
+		for (int i = 0; i < 1024; ++i) {
+			buffers.add(BufferBuilderTestUtils.buildSomeBuffer(1024));
+		}
+		CheckpointBarrier barrier = new CheckpointBarrier(0, 0, CheckpointOptions.forCheckpointWithDefaultLocation());
+		Thread bufferReceiver = new Thread(() -> {
+			try {
+				for (int i = 0; i < buffers.size(); ++i) {
+					inputChannel.onBuffer(buffers.get(i), i, 0);
+				}
+				// add checkpoint barrier
+				inputChannel.onBuffer(EventSerializer.toBuffer(barrier), buffers.size(), 0);
+				// one additional buffer which won't be added to inflight buffer queue
+				inputChannel.onBuffer(BufferBuilderTestUtils.buildSomeBuffer(1024), buffers.size() + 1, 0);
+			} catch (IOException e) {
+				ExceptionUtils.rethrow(e);
+			}
+		});
+		bufferReceiver.start();
+
+		inputChannel.spillInflightBuffers(0, new ChannelStateWriterImpl.NoOpChannelStateWriter() {
+			@Override
+			public void addInputData(long checkpointId, InputChannelInfo info, int startSeqNum, Buffer... data) {
+				inflightBuffers.addAll(Arrays.asList(data));
+			}
+		});
+
+		bufferReceiver.join();
+		assertArrayEquals(buffers.toArray(), inflightBuffers.toArray());
+	}
+
 	// ---------------------------------------------------------------------------------------------
 
 	private static Map<InputGateID, SingleInputGate> createInputGateWithLocalChannels(
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/CheckpointedInputGate.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/CheckpointedInputGate.java
index 90c22c273f0..c670c492861 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/CheckpointedInputGate.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/CheckpointedInputGate.java
@@ -19,11 +19,11 @@ package org.apache.flink.streaming.runtime.io;
 
 import org.apache.flink.annotation.Internal;
 import org.apache.flink.annotation.VisibleForTesting;
+import org.apache.flink.runtime.checkpoint.channel.ChannelStateWriter;
 import org.apache.flink.runtime.io.PullingAsyncDataInput;
 import org.apache.flink.runtime.io.network.api.CancelCheckpointMarker;
 import org.apache.flink.runtime.io.network.api.CheckpointBarrier;
 import org.apache.flink.runtime.io.network.api.EndOfPartitionEvent;
-import org.apache.flink.runtime.io.network.buffer.Buffer;
 import org.apache.flink.runtime.io.network.partition.consumer.BufferOrEvent;
 import org.apache.flink.runtime.io.network.partition.consumer.InputChannel;
 import org.apache.flink.runtime.io.network.partition.consumer.InputGate;
@@ -34,8 +34,6 @@ import org.slf4j.LoggerFactory;
 
 import java.io.Closeable;
 import java.io.IOException;
-import java.util.Collections;
-import java.util.List;
 import java.util.Optional;
 import java.util.concurrent.CompletableFuture;
 
@@ -138,12 +136,13 @@ public class CheckpointedInputGate implements PullingAsyncDataInput<BufferOrEven
 		}
 	}
 
-	public List<Buffer> requestInflightBuffers(long checkpointId, int channelIndex) throws IOException {
+	public void spillInflightBuffers(
+			long checkpointId,
+			int channelIndex,
+			ChannelStateWriter channelStateWriter) throws IOException {
 		if (((CheckpointBarrierUnaligner) barrierHandler).hasInflightData(checkpointId, channelIndex)) {
-			return inputGate.getChannel(channelIndex).requestInflightBuffers(checkpointId);
+			inputGate.getChannel(channelIndex).spillInflightBuffers(checkpointId, channelStateWriter);
 		}
-
-		return Collections.emptyList();
 	}
 
 	public CompletableFuture<Void> getAllBarriersReceivedFuture(long checkpointId) {
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamTaskNetworkInput.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamTaskNetworkInput.java
index 46e7a925521..abe11122031 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamTaskNetworkInput.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamTaskNetworkInput.java
@@ -217,11 +217,7 @@ public final class StreamTaskNetworkInput<T> implements StreamTaskInput<T> {
 					ChannelStateWriter.SEQUENCE_NUMBER_UNKNOWN,
 					buffer));
 
-			channelStateWriter.addInputData(
-				checkpointId,
-				channel.getChannelInfo(),
-				ChannelStateWriter.SEQUENCE_NUMBER_UNKNOWN,
-				checkpointedInputGate.requestInflightBuffers(checkpointId, channelIndex).toArray(new Buffer[0]));
+			checkpointedInputGate.spillInflightBuffers(checkpointId, channelIndex, channelStateWriter);
 		}
 		return checkpointedInputGate.getAllBarriersReceivedFuture(checkpointId);
 	}
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/CheckpointBarrierUnalignerTest.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/CheckpointBarrierUnalignerTest.java
index d0c52f073bc..44e2ba6f3f0 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/CheckpointBarrierUnalignerTest.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/io/CheckpointBarrierUnalignerTest.java
@@ -52,6 +52,7 @@ import java.util.concurrent.Future;
 import java.util.stream.Collectors;
 import java.util.stream.IntStream;
 
+import static org.apache.flink.runtime.checkpoint.channel.ChannelStateWriter.NO_OP;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertTrue;
@@ -612,7 +613,7 @@ public class CheckpointBarrierUnalignerTest {
 			nextExpectedCheckpointId = checkpointMetaData.getCheckpointId() + 1;
 
 			for (int index = 0; index < inputGate.getNumberOfInputChannels(); index++) {
-				inputGate.getChannel(index).requestInflightBuffers(checkpointMetaData.getCheckpointId());
+				inputGate.getChannel(index).spillInflightBuffers(checkpointMetaData.getCheckpointId(), NO_OP);
 			}
 		}
 
