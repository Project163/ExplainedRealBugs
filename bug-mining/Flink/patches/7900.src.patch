diff --git a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/factories/TestValuesRuntimeFunctions.java b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/factories/TestValuesRuntimeFunctions.java
index f214bba8358..f6ee4cd24f9 100644
--- a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/factories/TestValuesRuntimeFunctions.java
+++ b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/factories/TestValuesRuntimeFunctions.java
@@ -29,6 +29,7 @@ import org.apache.flink.api.common.state.ListStateDescriptor;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.connector.source.Boundedness;
 import org.apache.flink.configuration.Configuration;
+import org.apache.flink.connector.source.TerminatingLogic;
 import org.apache.flink.core.memory.DataInputView;
 import org.apache.flink.core.memory.DataInputViewStreamWrapper;
 import org.apache.flink.core.memory.DataOutputViewStreamWrapper;
@@ -240,13 +241,17 @@ public final class TestValuesRuntimeFunctions {
 
         private final String tableName;
 
+        private final TerminatingLogic terminating;
+
         public FromElementSourceFunctionWithWatermark(
                 String tableName,
                 TypeSerializer<RowData> serializer,
                 Iterable<RowData> elements,
-                WatermarkStrategy<RowData> watermarkStrategy)
+                WatermarkStrategy<RowData> watermarkStrategy,
+                TerminatingLogic terminating)
                 throws IOException {
             this.tableName = tableName;
+            this.terminating = terminating;
             ByteArrayOutputStream baos = new ByteArrayOutputStream();
             DataOutputViewStreamWrapper wrapper = new DataOutputViewStreamWrapper(baos);
 
@@ -307,6 +312,13 @@ public final class TestValuesRuntimeFunctions {
                     generator.onPeriodicEmit(output);
                 }
             }
+
+            if (terminating == TerminatingLogic.INFINITE) {
+                // wait until being canceled
+                while (isRunning) {
+                    Thread.sleep(100);
+                }
+            }
         }
 
         @Override
diff --git a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/factories/TestValuesTableFactory.java b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/factories/TestValuesTableFactory.java
index f0d984209a6..7de96b601f6 100644
--- a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/factories/TestValuesTableFactory.java
+++ b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/factories/TestValuesTableFactory.java
@@ -1717,7 +1717,7 @@ public final class TestValuesTableFactory
             try {
                 return SourceFunctionProvider.of(
                         new TestValuesRuntimeFunctions.FromElementSourceFunctionWithWatermark(
-                                tableName, serializer, values, watermarkStrategy),
+                                tableName, serializer, values, watermarkStrategy, terminating),
                         false);
             } catch (IOException e) {
                 throw new TableException("Fail to init source function", e);
