diff --git a/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkTestBase.java b/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkTestBase.java
index fa72a0f40f4..8d65e428412 100644
--- a/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkTestBase.java
+++ b/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkTestBase.java
@@ -92,6 +92,27 @@ public abstract class ElasticsearchSinkTestBase<C extends AutoCloseable, A> exte
 		runElasticSearchSinkTest(SourceSinkDataTestKit::getJsonSinkFunction);
 	}
 
+	/**
+	 * Tests that the Elasticsearch sink works properly with cbor.
+	 */
+	public void runElasticsearchSinkCborTest() throws Exception {
+		runElasticSearchSinkTest(SourceSinkDataTestKit::getCborSinkFunction);
+	}
+
+	/**
+	 * Tests that the Elasticsearch sink works properly with smile.
+	 */
+	public void runElasticsearchSinkSmileTest() throws Exception {
+		runElasticSearchSinkTest(SourceSinkDataTestKit::getSmileSinkFunction);
+	}
+
+	/**
+	 * Tests that the Elasticsearch sink works properly with yaml.
+	 */
+	public void runElasticsearchSinkYamlTest() throws Exception {
+		runElasticSearchSinkTest(SourceSinkDataTestKit::getYamlSinkFunction);
+	}
+
 	private void runElasticSearchSinkTest(Function<String, ElasticsearchSinkFunction<Tuple2<Integer, String>>> functionFactory) throws Exception {
 		final String index = "elasticsearch-sink-test-index";
 
diff --git a/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/testutils/SourceSinkDataTestKit.java b/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/testutils/SourceSinkDataTestKit.java
index 95aba9f75f6..7bcc7001f45 100644
--- a/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/testutils/SourceSinkDataTestKit.java
+++ b/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/testutils/SourceSinkDataTestKit.java
@@ -70,10 +70,22 @@ public class SourceSinkDataTestKit {
 		}
 	}
 
+	public static ElasticsearchSinkFunction<Tuple2<Integer, String>> getCborSinkFunction(String index) {
+		return new TestElasticsearchSinkFunction(index, XContentFactory::cborBuilder);
+	}
+
 	public static ElasticsearchSinkFunction<Tuple2<Integer, String>> getJsonSinkFunction(String index) {
 		return new TestElasticsearchSinkFunction(index, XContentFactory::jsonBuilder);
 	}
 
+	public static ElasticsearchSinkFunction<Tuple2<Integer, String>> getSmileSinkFunction(String index) {
+		return new TestElasticsearchSinkFunction(index, XContentFactory::smileBuilder);
+	}
+
+	public static ElasticsearchSinkFunction<Tuple2<Integer, String>> getYamlSinkFunction(String index) {
+		return new TestElasticsearchSinkFunction(index, XContentFactory::yamlBuilder);
+	}
+
 	private static class TestElasticsearchSinkFunction implements ElasticsearchSinkFunction<Tuple2<Integer, String>> {
 		private static final long serialVersionUID = 1L;
 
diff --git a/flink-connectors/flink-connector-elasticsearch2/src/test/java/org/apache/flink/streaming/connectors/elasticsearch2/ElasticsearchSinkITCase.java b/flink-connectors/flink-connector-elasticsearch2/src/test/java/org/apache/flink/streaming/connectors/elasticsearch2/ElasticsearchSinkITCase.java
index 7887e72fa10..f50fe0cc4f7 100644
--- a/flink-connectors/flink-connector-elasticsearch2/src/test/java/org/apache/flink/streaming/connectors/elasticsearch2/ElasticsearchSinkITCase.java
+++ b/flink-connectors/flink-connector-elasticsearch2/src/test/java/org/apache/flink/streaming/connectors/elasticsearch2/ElasticsearchSinkITCase.java
@@ -41,6 +41,21 @@ public class ElasticsearchSinkITCase extends ElasticsearchSinkTestBase<Transport
 		runElasticsearchSinkTest();
 	}
 
+	@Test
+	public void testElasticsearchSinkWithCbor() throws Exception {
+		runElasticsearchSinkCborTest();
+	}
+
+	@Test
+	public void testElasticsearchSinkWithSmile() throws Exception {
+		runElasticsearchSinkSmileTest();
+	}
+
+	@Test
+	public void testElasticsearchSinkWithYaml() throws Exception {
+		runElasticsearchSinkYamlTest();
+	}
+
 	@Test
 	public void testNullAddresses() throws Exception {
 		runNullAddressesTest();
diff --git a/flink-connectors/flink-connector-elasticsearch5/src/test/java/org/apache/flink/streaming/connectors/elasticsearch5/ElasticsearchSinkITCase.java b/flink-connectors/flink-connector-elasticsearch5/src/test/java/org/apache/flink/streaming/connectors/elasticsearch5/ElasticsearchSinkITCase.java
index 67daa409b7b..80dc8c01320 100644
--- a/flink-connectors/flink-connector-elasticsearch5/src/test/java/org/apache/flink/streaming/connectors/elasticsearch5/ElasticsearchSinkITCase.java
+++ b/flink-connectors/flink-connector-elasticsearch5/src/test/java/org/apache/flink/streaming/connectors/elasticsearch5/ElasticsearchSinkITCase.java
@@ -46,6 +46,21 @@ public class ElasticsearchSinkITCase extends ElasticsearchSinkTestBase<Transport
 		runElasticsearchSinkTest();
 	}
 
+	@Test
+	public void testElasticsearchSinkWithCbor() throws Exception {
+		runElasticsearchSinkCborTest();
+	}
+
+	@Test
+	public void testElasticsearchSinkWithSmile() throws Exception {
+		runElasticsearchSinkSmileTest();
+	}
+
+	@Test
+	public void testElasticsearchSinkWithYaml() throws Exception {
+		runElasticsearchSinkYamlTest();
+	}
+
 	@Test
 	public void testNullAddresses() throws Exception {
 		runNullAddressesTest();
diff --git a/flink-connectors/flink-connector-elasticsearch6/src/test/java/org/apache/flink/streaming/connectors/elasticsearch6/ElasticsearchSinkITCase.java b/flink-connectors/flink-connector-elasticsearch6/src/test/java/org/apache/flink/streaming/connectors/elasticsearch6/ElasticsearchSinkITCase.java
index a6f01258940..f2db06254d7 100644
--- a/flink-connectors/flink-connector-elasticsearch6/src/test/java/org/apache/flink/streaming/connectors/elasticsearch6/ElasticsearchSinkITCase.java
+++ b/flink-connectors/flink-connector-elasticsearch6/src/test/java/org/apache/flink/streaming/connectors/elasticsearch6/ElasticsearchSinkITCase.java
@@ -44,6 +44,11 @@ public class ElasticsearchSinkITCase extends ElasticsearchSinkTestBase<RestHighL
 		runElasticsearchSinkTest();
 	}
 
+	@Test
+	public void testElasticsearchSinkWithSmile() throws Exception {
+		runElasticsearchSinkSmileTest();
+	}
+
 	@Test
 	public void testNullAddresses() throws Exception {
 		runNullAddressesTest();
diff --git a/flink-connectors/flink-connector-elasticsearch7/src/test/java/org/apache/flink/streaming/connectors/elasticsearch7/ElasticsearchSinkITCase.java b/flink-connectors/flink-connector-elasticsearch7/src/test/java/org/apache/flink/streaming/connectors/elasticsearch7/ElasticsearchSinkITCase.java
index c8de4473a70..65ad40a057e 100644
--- a/flink-connectors/flink-connector-elasticsearch7/src/test/java/org/apache/flink/streaming/connectors/elasticsearch7/ElasticsearchSinkITCase.java
+++ b/flink-connectors/flink-connector-elasticsearch7/src/test/java/org/apache/flink/streaming/connectors/elasticsearch7/ElasticsearchSinkITCase.java
@@ -44,6 +44,11 @@ public class ElasticsearchSinkITCase extends ElasticsearchSinkTestBase<RestHighL
 		runElasticsearchSinkTest();
 	}
 
+	@Test
+	public void testElasticsearchSinkWithSmile() throws Exception {
+		runElasticsearchSinkSmileTest();
+	}
+
 	@Test
 	public void testNullAddresses() throws Exception {
 		runNullAddressesTest();
