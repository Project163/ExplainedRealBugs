diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/groups/AbstractMetricGroup.java b/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/groups/AbstractMetricGroup.java
index 8f7521f375e..73cf6ce1e4f 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/groups/AbstractMetricGroup.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/metrics/groups/AbstractMetricGroup.java
@@ -120,11 +120,14 @@ public abstract class AbstractMetricGroup<A extends AbstractMetricGroup<?>> impl
 	}
 
 	public Map<String, String> getAllVariables(int reporterIndex, Set<String> excludedVariables) {
-		// offset cache location to account for general cache at position 0
-		reporterIndex += 1;
 		if (reporterIndex < 0 || reporterIndex >= logicalScopeStrings.length) {
-			reporterIndex = 0;
+			// invalid reporter index; either a programming mistake, or we try to retrieve variables outside of a reporter
+			reporterIndex = -1;
 		}
+
+		// offset cache location to account for general cache at position 0
+		reporterIndex += 1;
+
 		// if no variables are excluded (which is the default!) we re-use the general variables map to save space
 		return internalGetAllVariables(excludedVariables.isEmpty() ? 0 : reporterIndex, excludedVariables);
 	}
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/metrics/groups/AbstractMetricGroupTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/metrics/groups/AbstractMetricGroupTest.java
index a60b647f03b..c712b62ebda 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/metrics/groups/AbstractMetricGroupTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/metrics/groups/AbstractMetricGroupTest.java
@@ -43,9 +43,11 @@ import org.junit.Test;
 
 import java.util.Arrays;
 import java.util.Collections;
+import java.util.Map;
 import java.util.concurrent.atomic.AtomicReference;
 
 import static org.hamcrest.MatcherAssert.assertThat;
+import static org.hamcrest.core.IsNot.not;
 import static org.junit.Assert.assertEquals;
 import static org.junit.Assert.assertTrue;
 
@@ -93,6 +95,26 @@ public class AbstractMetricGroupTest extends TestLogger {
 		assertEquals(group.getAllVariables(-1, Collections.singleton(ScopeFormat.SCOPE_HOST)).size(), 0);
 	}
 
+	@Test
+	public void testGetAllVariablesWithExclusionsForReporters() {
+		MetricRegistry registry = TestingMetricRegistry.builder().setNumberReporters(2).build();
+
+		AbstractMetricGroup<?> group = new GenericMetricGroup(registry, null, "test") {
+			@Override
+			protected void putVariables(Map<String, String> variables) {
+				variables.put("k1", "v1");
+				variables.put("k2", "v2");
+			}
+		};
+
+		group.getAllVariables(-1, Collections.emptySet());
+
+		assertThat(group.getAllVariables(0, Collections.singleton("k1")), not(IsMapContaining.hasKey("k1")));
+		assertThat(group.getAllVariables(0, Collections.singleton("k1")), IsMapContaining.hasKey("k2"));
+		assertThat(group.getAllVariables(1, Collections.singleton("k2")), IsMapContaining.hasKey("k1"));
+		assertThat(group.getAllVariables(1, Collections.singleton("k2")), not(IsMapContaining.hasKey("k2")));
+	}
+
 	// ========================================================================
 	// Scope Caching
 	// ========================================================================
