diff --git a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/functions/BuiltInAggregateFunctionTestBase.java b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/functions/BuiltInAggregateFunctionTestBase.java
index 158d2f03acb..961b69a8c03 100644
--- a/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/functions/BuiltInAggregateFunctionTestBase.java
+++ b/flink-table/flink-table-planner/src/test/java/org/apache/flink/table/planner/functions/BuiltInAggregateFunctionTestBase.java
@@ -18,7 +18,8 @@
 
 package org.apache.flink.table.planner.functions;
 
-import org.apache.flink.configuration.StateChangelogOptions;
+import org.apache.flink.configuration.Configuration;
+import org.apache.flink.configuration.StateBackendOptions;
 import org.apache.flink.streaming.api.functions.source.SourceFunction;
 import org.apache.flink.table.api.EnvironmentSettings;
 import org.apache.flink.table.api.Schema;
@@ -56,6 +57,8 @@ import java.util.function.Function;
 import java.util.stream.Collectors;
 import java.util.stream.Stream;
 
+import static org.apache.flink.runtime.state.StateBackendLoader.HASHMAP_STATE_BACKEND_NAME;
+import static org.apache.flink.runtime.state.StateBackendLoader.ROCKSDB_STATE_BACKEND_NAME;
 import static org.apache.flink.table.test.TableAssertions.assertThat;
 import static org.apache.flink.table.types.DataType.getFieldDataTypes;
 import static org.assertj.core.api.Assertions.assertThat;
@@ -204,12 +207,16 @@ abstract class BuiltInAggregateFunctionTestBase {
             return this;
         }
 
-        private Executable createTestItemExecutable(TestItem testItem) {
+        private Executable createTestItemExecutable(TestItem testItem, String stateBackend) {
             return () -> {
+                Configuration conf = new Configuration();
+                conf.set(StateBackendOptions.STATE_BACKEND, stateBackend);
                 final TableEnvironment tEnv =
-                        TableEnvironment.create(EnvironmentSettings.inStreamingMode());
-                // see https://issues.apache.org/jira/browse/FLINK-26092
-                tEnv.getConfig().set(StateChangelogOptions.ENABLE_STATE_CHANGE_LOG, false);
+                        TableEnvironment.create(
+                                EnvironmentSettings.newInstance()
+                                        .inStreamingMode()
+                                        .withConfiguration(conf)
+                                        .build());
                 final Table sourceTable = asTable(tEnv, sourceRowType, sourceRows);
 
                 testItem.execute(tEnv, sourceTable);
@@ -217,12 +224,22 @@ abstract class BuiltInAggregateFunctionTestBase {
         }
 
         Stream<BuiltInFunctionTestBase.TestCase> getTestCases() {
-            return testItems.stream()
-                    .map(
-                            testItem ->
-                                    new BuiltInFunctionTestBase.TestCase(
-                                            testItem.toString(),
-                                            createTestItemExecutable(testItem)));
+            return Stream.concat(
+                    testItems.stream()
+                            .map(
+                                    testItem ->
+                                            new BuiltInFunctionTestBase.TestCase(
+                                                    testItem.toString(),
+                                                    createTestItemExecutable(
+                                                            testItem, HASHMAP_STATE_BACKEND_NAME))),
+                    testItems.stream()
+                            .map(
+                                    testItem ->
+                                            new BuiltInFunctionTestBase.TestCase(
+                                                    testItem.toString(),
+                                                    createTestItemExecutable(
+                                                            testItem,
+                                                            ROCKSDB_STATE_BACKEND_NAME))));
         }
 
         @Override
diff --git a/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/functions/aggregate/JsonObjectAggFunction.java b/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/functions/aggregate/JsonObjectAggFunction.java
index 8152f988fe3..4be69c92592 100644
--- a/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/functions/aggregate/JsonObjectAggFunction.java
+++ b/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/functions/aggregate/JsonObjectAggFunction.java
@@ -57,6 +57,7 @@ public class JsonObjectAggFunction
         extends BuiltInAggregateFunction<String, JsonObjectAggFunction.Accumulator> {
 
     private static final long serialVersionUID = 1L;
+    private static final StringData NULL_STRING_DATA = StringData.fromBytes(new byte[] {});
     private static final NullNode NULL_NODE = getNodeFactory().nullNode();
 
     private final transient List<DataType> argumentTypes;
@@ -107,7 +108,9 @@ public class JsonObjectAggFunction
 
         if (valueData == null) {
             if (!skipNulls) {
-                acc.map.put(keyData, null);
+                // We cannot use null for StringData here, since it's not supported by the
+                // StringDataSerializer, instead use a StringData with an empty byte[]
+                acc.map.put(keyData, NULL_STRING_DATA);
             }
         } else {
             acc.map.put(keyData, valueData);
@@ -135,7 +138,7 @@ public class JsonObjectAggFunction
             for (final StringData key : acc.map.keys()) {
                 final StringData value = acc.map.get(key);
                 final JsonNode valueNode =
-                        value == null
+                        value.toBytes().length == 0
                                 ? NULL_NODE
                                 : getNodeFactory().rawValueNode(new RawValue(value.toString()));
 
