diff --git a/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogStateBackend.java b/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogStateBackend.java
index d00222d3186..aa96f32d430 100644
--- a/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogStateBackend.java
+++ b/flink-state-backends/flink-statebackend-changelog/src/main/java/org/apache/flink/state/changelog/ChangelogStateBackend.java
@@ -36,6 +36,7 @@ import org.apache.flink.runtime.state.OperatorStateBackend;
 import org.apache.flink.runtime.state.OperatorStateHandle;
 import org.apache.flink.runtime.state.StateBackend;
 import org.apache.flink.runtime.state.changelog.ChangelogStateBackendHandle;
+import org.apache.flink.runtime.state.changelog.ChangelogStateBackendHandle.ChangelogStateBackendHandleImpl;
 import org.apache.flink.runtime.state.changelog.StateChangelogStorage;
 import org.apache.flink.runtime.state.delegate.DelegatingStateBackend;
 import org.apache.flink.runtime.state.ttl.TtlTimeProvider;
@@ -49,8 +50,12 @@ import org.slf4j.LoggerFactory;
 import javax.annotation.Nonnull;
 
 import java.util.Collection;
+import java.util.Objects;
 import java.util.stream.Collectors;
 
+import static java.util.Collections.emptyList;
+import static java.util.Collections.singletonList;
+
 /**
  * This state backend holds the working state in the underlying delegatedStateBackend, and forwards
  * state changes to State Changelog.
@@ -221,8 +226,21 @@ public class ChangelogStateBackend implements DelegatingStateBackend, Configurab
 
     private Collection<ChangelogStateBackendHandle> castHandles(
             Collection<KeyedStateHandle> stateHandles) {
+        if (stateHandles.stream().anyMatch(h -> !(h instanceof ChangelogStateBackendHandle))) {
+            LOG.warn(
+                    "Some state handles do not contain changelog: {} (ok if recovery from a savepoint)",
+                    stateHandles);
+        }
         return stateHandles.stream()
-                .map(keyedStateHandle -> (ChangelogStateBackendHandle) keyedStateHandle)
+                .filter(Objects::nonNull)
+                .map(
+                        keyedStateHandle ->
+                                keyedStateHandle instanceof ChangelogStateBackendHandle
+                                        ? (ChangelogStateBackendHandle) keyedStateHandle
+                                        : new ChangelogStateBackendHandleImpl(
+                                                singletonList(keyedStateHandle),
+                                                emptyList(),
+                                                keyedStateHandle.getKeyGroupRange()))
                 .collect(Collectors.toList());
     }
 }
