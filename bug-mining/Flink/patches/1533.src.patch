diff --git a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/plan/nodes/CommonCorrelate.scala b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/plan/nodes/CommonCorrelate.scala
index 61b7ffb96d9..6c4066b7af9 100644
--- a/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/plan/nodes/CommonCorrelate.scala
+++ b/flink-libraries/flink-table/src/main/scala/org/apache/flink/table/plan/nodes/CommonCorrelate.scala
@@ -188,7 +188,7 @@ trait CommonCorrelate {
         |getCollector().collect(${crossResultExpr.resultTerm});
         |""".stripMargin
     } else {
-      val filterGenerator = new CodeGenerator(config, false, udtfTypeInfo)
+      val filterGenerator = new CodeGenerator(config, false, udtfTypeInfo, None, pojoFieldMapping)
       filterGenerator.input1Term = filterGenerator.input2Term
       val filterCondition = filterGenerator.generateExpression(condition.get)
       s"""
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/dataset/DataSetUserDefinedFunctionITCase.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/dataset/DataSetUserDefinedFunctionITCase.scala
index d2685947029..3d20803ed18 100644
--- a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/dataset/DataSetUserDefinedFunctionITCase.scala
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/dataset/DataSetUserDefinedFunctionITCase.scala
@@ -140,11 +140,12 @@ class DataSetUserDefinedFunctionITCase(
     val pojo = new PojoTableFunc()
     val result = in
       .join(pojo('c))
+      .where(('age > 20))
       .select('c, 'name, 'age)
       .toDataSet[Row]
 
     val results = result.collect()
-    val expected = "Jack#22,Jack,22\n" + "John#19,John,19\n" + "Anna#44,Anna,44\n"
+    val expected = "Jack#22,Jack,22\n" + "Anna#44,Anna,44\n"
     TestBaseUtils.compareResultAsText(results.asJava, expected)
   }
 
diff --git a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/datastream/DataSetUserDefinedFunctionITCase.scala b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/datastream/DataStreamUserDefinedFunctionITCase.scala
similarity index 95%
rename from flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/datastream/DataSetUserDefinedFunctionITCase.scala
rename to flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/datastream/DataStreamUserDefinedFunctionITCase.scala
index 21b87e97548..e7ce45761cf 100644
--- a/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/datastream/DataSetUserDefinedFunctionITCase.scala
+++ b/flink-libraries/flink-table/src/test/scala/org/apache/flink/table/runtime/datastream/DataStreamUserDefinedFunctionITCase.scala
@@ -25,13 +25,14 @@ import org.apache.flink.table.api.scala._
 import org.apache.flink.table.api.scala.stream.utils.{StreamITCase, StreamTestData}
 import org.apache.flink.table.expressions.utils.{Func13, RichFunc2}
 import org.apache.flink.table.utils.{RichTableFunc1, TableFunc0, TableFunc3, UserDefinedFunctionTestUtils}
+import org.apache.flink.table.utils.PojoTableFunc
 import org.apache.flink.types.Row
 import org.junit.Assert._
 import org.junit.Test
 
 import scala.collection.mutable
 
-class DataSetUserDefinedFunctionITCase extends StreamingMultipleProgramsTestBase {
+class DataStreamUserDefinedFunctionITCase extends StreamingMultipleProgramsTestBase {
 
   @Test
   def testCrossJoin(): Unit = {
@@ -41,16 +42,20 @@ class DataSetUserDefinedFunctionITCase extends StreamingMultipleProgramsTestBase
 
     val t = testData(env).toTable(tEnv).as('a, 'b, 'c)
     val func0 = new TableFunc0
+    val pojoFunc0 = new PojoTableFunc()
 
     val result = t
       .join(func0('c) as('d, 'e))
       .select('c, 'd, 'e)
+      .join(pojoFunc0('c))
+      .where(('age > 20))
+      .select('c, 'name, 'age)
       .toDataStream[Row]
 
     result.addSink(new StreamITCase.StringSink)
     env.execute()
 
-    val expected = mutable.MutableList("Jack#22,Jack,22", "John#19,John,19", "Anna#44,Anna,44")
+    val expected = mutable.MutableList("Jack#22,Jack,22", "Anna#44,Anna,44")
     assertEquals(expected.sorted, StreamITCase.testResults.sorted)
   }
 
