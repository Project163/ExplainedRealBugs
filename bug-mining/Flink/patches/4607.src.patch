diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/LocalRecoveredInputChannel.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/LocalRecoveredInputChannel.java
index ba1ca9fe12a..30610fa101a 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/LocalRecoveredInputChannel.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/LocalRecoveredInputChannel.java
@@ -42,8 +42,17 @@ public class LocalRecoveredInputChannel extends RecoveredInputChannel {
 			TaskEventPublisher taskEventPublisher,
 			int initialBackOff,
 			int maxBackoff,
+			int networkBuffersPerChannel,
 			InputChannelMetrics metrics) {
-		super(inputGate, channelIndex, partitionId, initialBackOff, maxBackoff, metrics.getNumBytesInLocalCounter(), metrics.getNumBuffersInLocalCounter());
+		super(
+			inputGate,
+			channelIndex,
+			partitionId,
+			initialBackOff,
+			maxBackoff,
+			metrics.getNumBytesInLocalCounter(),
+			metrics.getNumBuffersInLocalCounter(),
+			networkBuffersPerChannel);
 
 		this.partitionManager = checkNotNull(partitionManager);
 		this.taskEventPublisher = checkNotNull(taskEventPublisher);
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RecoveredInputChannel.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RecoveredInputChannel.java
index 084fa2f38d7..15defe5f011 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RecoveredInputChannel.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RecoveredInputChannel.java
@@ -64,6 +64,9 @@ public abstract class RecoveredInputChannel extends InputChannel implements Chan
 	/** The buffer number of recovered buffers. Starts at MIN_VALUE to have no collisions with actual buffer numbers. */
 	private int sequenceNumber = Integer.MIN_VALUE;
 
+	protected final int networkBuffersPerChannel;
+	private boolean exclusiveBuffersAssigned;
+
 	RecoveredInputChannel(
 			SingleInputGate inputGate,
 			int channelIndex,
@@ -71,10 +74,12 @@ public abstract class RecoveredInputChannel extends InputChannel implements Chan
 			int initialBackoff,
 			int maxBackoff,
 			Counter numBytesIn,
-			Counter numBuffersIn) {
+			Counter numBuffersIn,
+			int networkBuffersPerChannel) {
 		super(inputGate, channelIndex, partitionId, initialBackoff, maxBackoff, numBytesIn, numBuffersIn);
 
 		bufferManager = new BufferManager(inputGate.getMemorySegmentProvider(), this, 0);
+		this.networkBuffersPerChannel = networkBuffersPerChannel;
 	}
 
 	@Override
@@ -236,4 +241,11 @@ public abstract class RecoveredInputChannel extends InputChannel implements Chan
 			return receivedBuffers.size();
 		}
 	}
+
+	void assignExclusiveSegments() throws IOException {
+		checkState(!exclusiveBuffersAssigned, "Exclusive buffers should be assigned only once.");
+
+		bufferManager.requestExclusiveBuffers(networkBuffersPerChannel);
+		exclusiveBuffersAssigned = true;
+	}
 }
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RemoteRecoveredInputChannel.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RemoteRecoveredInputChannel.java
index bfc10987949..aaec5a15605 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RemoteRecoveredInputChannel.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/RemoteRecoveredInputChannel.java
@@ -27,7 +27,6 @@ import org.apache.flink.runtime.io.network.partition.ResultPartitionID;
 import java.io.IOException;
 
 import static org.apache.flink.util.Preconditions.checkNotNull;
-import static org.apache.flink.util.Preconditions.checkState;
 
 /**
  * An input channel reads recovered state from previous unaligned checkpoint snapshots
@@ -36,9 +35,6 @@ import static org.apache.flink.util.Preconditions.checkState;
 public class RemoteRecoveredInputChannel extends RecoveredInputChannel {
 	private final ConnectionID connectionId;
 	private final ConnectionManager connectionManager;
-	private final int networkBuffersPerChannel;
-
-	private boolean exclusiveBuffersAssigned;
 
 	RemoteRecoveredInputChannel(
 			SingleInputGate inputGate,
@@ -50,11 +46,18 @@ public class RemoteRecoveredInputChannel extends RecoveredInputChannel {
 			int maxBackoff,
 			int networkBuffersPerChannel,
 			InputChannelMetrics metrics) {
-		super(inputGate, channelIndex, partitionId, initialBackOff, maxBackoff, metrics.getNumBytesInRemoteCounter(), metrics.getNumBuffersInRemoteCounter());
+		super(
+			inputGate,
+			channelIndex,
+			partitionId,
+			initialBackOff,
+			maxBackoff,
+			metrics.getNumBytesInRemoteCounter(),
+			metrics.getNumBuffersInRemoteCounter(),
+			networkBuffersPerChannel);
 
 		this.connectionId = checkNotNull(connectionId);
 		this.connectionManager = checkNotNull(connectionManager);
-		this.networkBuffersPerChannel = networkBuffersPerChannel;
 	}
 
 	@Override
@@ -77,10 +80,4 @@ public class RemoteRecoveredInputChannel extends RecoveredInputChannel {
 		return remoteInputChannel;
 	}
 
-	void assignExclusiveSegments() throws IOException {
-		checkState(!exclusiveBuffersAssigned, "Exclusive buffers should be assigned only once.");
-
-		bufferManager.requestExclusiveBuffers(networkBuffersPerChannel);
-		exclusiveBuffersAssigned = true;
-	}
 }
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGate.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGate.java
index e428507e53c..0382f85d5e0 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGate.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGate.java
@@ -254,8 +254,8 @@ public class SingleInputGate extends IndexedInputGate {
 				return FutureUtils.completedVoidFuture();
 			}
 			for (InputChannel inputChannel : inputChannels.values()) {
-				if (inputChannel instanceof RemoteRecoveredInputChannel) {
-					((RemoteRecoveredInputChannel) inputChannel).assignExclusiveSegments();
+				if (inputChannel instanceof RecoveredInputChannel) {
+					((RecoveredInputChannel) inputChannel).assignExclusiveSegments();
 				}
 			}
 		}
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateFactory.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateFactory.java
index 0ec13209a20..74e5bf27685 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateFactory.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateFactory.java
@@ -219,6 +219,7 @@ public class SingleInputGateFactory {
 				taskEventPublisher,
 				partitionRequestInitialBackoff,
 				partitionRequestMaxBackoff,
+				networkBuffersPerChannel,
 				metrics);
 		} else {
 			// Different instances => remote
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/InputChannelBuilder.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/InputChannelBuilder.java
index 4b361173ed3..ec80a1c4fcd 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/InputChannelBuilder.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/InputChannelBuilder.java
@@ -160,6 +160,7 @@ public class InputChannelBuilder {
 			taskEventPublisher,
 			initialBackoff,
 			maxBackoff,
+			networkBuffersPerChannel,
 			metrics);
 	}
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateTest.java
index 21ca2b57fd0..b0f4e5c387a 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGateTest.java
@@ -151,11 +151,11 @@ public class SingleInputGateTest extends InputGateTestBase {
 	 */
 	@Test
 	public void testReadRecoveredState() throws Exception {
-		final int totalStates = 5;
-		final int[] states = {1, 2, 3, 4};
+		final int totalStates = 7;
+		final int[] states = {1, 2, 3, 4, 5, 6};
 		final ChannelStateReader stateReader = new ResultPartitionTest.FiniteChannelStateReader(totalStates, states);
 
-		final int totalBuffers = 3; // the total buffers are less than the requirement from total states
+		final int totalBuffers = 5; // the total buffers are less than the requirement from total states
 		final NettyShuffleEnvironment environment = new NettyShuffleEnvironmentBuilder()
 			.setBufferSize(states.length * Integer.BYTES)
 			.setNumNetworkBuffers(totalBuffers)
@@ -193,11 +193,11 @@ public class SingleInputGateTest extends InputGateTestBase {
 	 */
 	@Test
 	public void testConcurrentReadStateAndProcessAndClose() throws Exception {
-		final int totalStates = 5;
-		final int[] states = {1, 2, 3, 4};
+		final int totalStates = 7;
+		final int[] states = {1, 2, 3, 4, 5, 6};
 		final ChannelStateReader stateReader = new ResultPartitionTest.FiniteChannelStateReader(totalStates, states);
 
-		final int totalBuffers = 3;
+		final int totalBuffers = 5;
 		final NettyShuffleEnvironment environment = new NettyShuffleEnvironmentBuilder()
 			.setBufferSize(states.length * Integer.BYTES)
 			.setNumNetworkBuffers(totalBuffers)
