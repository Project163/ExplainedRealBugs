diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/windowing/windows/GlobalWindow.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/windowing/windows/GlobalWindow.java
index 236cf7d251a..5324a645a1f 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/windowing/windows/GlobalWindow.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/windowing/windows/GlobalWindow.java
@@ -89,7 +89,7 @@ public class GlobalWindow extends Window {
 
         @Override
         public int getLength() {
-            return 0;
+            return Byte.BYTES;
         }
 
         @Override
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/windowing/windows/TimeWindow.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/windowing/windows/TimeWindow.java
index 5532a84c785..3346b397859 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/windowing/windows/TimeWindow.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/windowing/windows/TimeWindow.java
@@ -137,7 +137,7 @@ public class TimeWindow extends Window {
 
         @Override
         public TimeWindow createInstance() {
-            return null;
+            return new TimeWindow(0L, 1L);
         }
 
         @Override
@@ -152,7 +152,7 @@ public class TimeWindow extends Window {
 
         @Override
         public int getLength() {
-            return 0;
+            return Long.BYTES + Long.BYTES;
         }
 
         @Override
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/operators/windowing/TimeWindowSerializerTest.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/operators/windowing/TimeWindowSerializerTest.java
new file mode 100644
index 00000000000..e53f50298a7
--- /dev/null
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/operators/windowing/TimeWindowSerializerTest.java
@@ -0,0 +1,48 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.streaming.runtime.operators.windowing;
+
+import org.apache.flink.api.common.typeutils.SerializerTestBase;
+import org.apache.flink.api.common.typeutils.TypeSerializer;
+import org.apache.flink.streaming.api.windowing.windows.TimeWindow;
+
+/** Tests for {@link TimeWindow.Serializer}. */
+public class TimeWindowSerializerTest extends SerializerTestBase<TimeWindow> {
+    @Override
+    protected TypeSerializer<TimeWindow> createSerializer() {
+        return new TimeWindow.Serializer();
+    }
+
+    @Override
+    protected int getLength() {
+        return Long.BYTES * 2;
+    }
+
+    @Override
+    protected Class<TimeWindow> getTypeClass() {
+        return TimeWindow.class;
+    }
+
+    @Override
+    protected TimeWindow[] getTestData() {
+        return new TimeWindow[] {
+            new TimeWindow(10, 20), new TimeWindow(100, 200), new TimeWindow(20, 21)
+        };
+    }
+}
diff --git a/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/operators/window/CountWindow.java b/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/operators/window/CountWindow.java
index d4727417c14..2413c67a2d9 100644
--- a/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/operators/window/CountWindow.java
+++ b/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/operators/window/CountWindow.java
@@ -110,7 +110,7 @@ public class CountWindow extends Window {
 
         @Override
         public int getLength() {
-            return 0;
+            return Long.BYTES;
         }
 
         @Override
diff --git a/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/operators/window/TimeWindow.java b/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/operators/window/TimeWindow.java
index f1c1d09c046..e358c994d8e 100644
--- a/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/operators/window/TimeWindow.java
+++ b/flink-table/flink-table-runtime/src/main/java/org/apache/flink/table/runtime/operators/window/TimeWindow.java
@@ -162,7 +162,7 @@ public class TimeWindow extends Window {
 
         @Override
         public int getLength() {
-            return 0;
+            return Long.BYTES + Long.BYTES;
         }
 
         @Override
