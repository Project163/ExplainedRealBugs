diff --git a/flink-core/src/main/java/org/apache/flink/configuration/DelegatingConfiguration.java b/flink-core/src/main/java/org/apache/flink/configuration/DelegatingConfiguration.java
index 91f81d46979..dba77f37232 100644
--- a/flink-core/src/main/java/org/apache/flink/configuration/DelegatingConfiguration.java
+++ b/flink-core/src/main/java/org/apache/flink/configuration/DelegatingConfiguration.java
@@ -19,6 +19,7 @@ package org.apache.flink.configuration;
 
 import org.apache.flink.core.memory.DataInputView;
 import org.apache.flink.core.memory.DataOutputView;
+import org.apache.flink.util.Preconditions;
 
 import java.io.IOException;
 import java.util.HashSet;
@@ -56,7 +57,7 @@ public final class DelegatingConfiguration extends Configuration {
 	 */
 	public DelegatingConfiguration(Configuration backingConfig, String prefix)
 	{
-		this.backingConfig = backingConfig;
+		this.backingConfig = Preconditions.checkNotNull(backingConfig);
 		this.prefix = prefix;
 	}
 
@@ -178,14 +179,19 @@ public final class DelegatingConfiguration extends Configuration {
 
 	@Override
 	public Set<String> keySet() {
+		if (this.prefix == null) {
+			return this.backingConfig.keySet();
+		}
+
 		final HashSet<String> set = new HashSet<String>();
-		final int prefixLen = this.prefix == null ? 0 : this.prefix.length();
+		int prefixLen = this.prefix.length();
 
 		for (String key : this.backingConfig.keySet()) {
-			if (key.startsWith(this.prefix)) {
+			if (key.startsWith(prefix)) {
 				set.add(key.substring(prefixLen));
 			}
 		}
+
 		return set;
 	}
 
diff --git a/flink-core/src/test/java/org/apache/flink/configuration/DelegatingConfigurationTest.java b/flink-core/src/test/java/org/apache/flink/configuration/DelegatingConfigurationTest.java
index 6d421292ef4..d8b782d4dba 100644
--- a/flink-core/src/test/java/org/apache/flink/configuration/DelegatingConfigurationTest.java
+++ b/flink-core/src/test/java/org/apache/flink/configuration/DelegatingConfigurationTest.java
@@ -26,8 +26,10 @@ import java.lang.reflect.Method;
 import java.lang.reflect.Modifier;
 import java.util.Arrays;
 import java.util.Comparator;
+import java.util.Set;
 
 import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.assertEquals;
 
 
 public class DelegatingConfigurationTest {
@@ -88,4 +90,47 @@ public class DelegatingConfigurationTest {
 			assertTrue("Foo method '" + configurationMethod.getName() + "' has not been wrapped correctly in DelegatingConfiguration wrapper", hasMethod);
 		}
 	}
+	
+	@Test
+	public void testDelegationConfigurationWithNullPrefix() {
+		Configuration backingConf = new Configuration();
+		backingConf.setValueInternal("test-key", "value");
+
+		DelegatingConfiguration configuration = new DelegatingConfiguration(
+				backingConf, null);
+		Set<String> keySet = configuration.keySet();
+
+		assertEquals(keySet, backingConf.keySet());
+
+	}
+
+	@Test
+	public void testDelegationConfigurationWithPrefix() {
+		String prefix = "pref-";
+		String expectedKey = "key";
+
+		/*
+		 * Key matches the prefix
+		 */
+		Configuration backingConf = new Configuration();
+		backingConf.setValueInternal(prefix + expectedKey, "value");
+
+		DelegatingConfiguration configuration = new DelegatingConfiguration(backingConf, prefix);
+		Set<String> keySet = configuration.keySet();
+		
+
+		assertEquals(keySet.size(), 1);
+		assertEquals(keySet.iterator().next(), expectedKey);
+
+		/*
+		 * Key does not match the prefix
+		 */
+		backingConf = new Configuration();
+		backingConf.setValueInternal("test-key", "value");
+
+		configuration = new DelegatingConfiguration(backingConf, prefix);
+		keySet = configuration.keySet();
+
+		assertTrue(keySet.isEmpty());
+	}
 }
