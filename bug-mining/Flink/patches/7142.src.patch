diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/BufferWritingResultPartition.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/BufferWritingResultPartition.java
index 85a6163bb70..c4ced3d7c25 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/BufferWritingResultPartition.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/BufferWritingResultPartition.java
@@ -246,7 +246,7 @@ public abstract class BufferWritingResultPartition extends ResultPartition {
         finishUnicastBufferBuilders();
 
         for (ResultSubpartition subpartition : subpartitions) {
-            subpartition.finish();
+            totalWrittenBytes += subpartition.finish();
         }
 
         super.finish();
@@ -313,6 +313,13 @@ public abstract class BufferWritingResultPartition extends ResultPartition {
         resizeBuffer(buffer, desirableBufferSize, minDesirableBufferSize);
     }
 
+    protected int addToSubpartition(
+            int targetSubpartition, BufferConsumer bufferConsumer, int partialRecordLength)
+            throws IOException {
+        totalWrittenBytes += bufferConsumer.getWrittenBytes();
+        return subpartitions[targetSubpartition].add(bufferConsumer, partialRecordLength);
+    }
+
     private void resizeBuffer(
             BufferBuilder buffer, int desirableBufferSize, int minDesirableBufferSize) {
         if (desirableBufferSize > 0) {
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PipelinedResultPartition.java b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PipelinedResultPartition.java
index 12de80e29e4..268f34c9b13 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PipelinedResultPartition.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/PipelinedResultPartition.java
@@ -263,10 +263,9 @@ public class PipelinedResultPartition extends BufferWritingResultPartition
         }
         try (BufferConsumer eventBufferConsumer =
                 EventSerializer.toBufferConsumer(EndOfChannelStateEvent.INSTANCE, false)) {
-            for (ResultSubpartition resultSubpartition : subpartitions) {
-                PipelinedSubpartition subpartition = (PipelinedSubpartition) resultSubpartition;
-                if (subpartition.isSupportChannelStateRecover()) {
-                    subpartition.add(eventBufferConsumer.copy(), 0);
+            for (int i = 0; i < subpartitions.length; i++) {
+                if (((PipelinedSubpartition) subpartitions[i]).isSupportChannelStateRecover()) {
+                    addToSubpartition(i, eventBufferConsumer.copy(), 0);
                 }
             }
         }
@@ -287,7 +286,8 @@ public class PipelinedResultPartition extends BufferWritingResultPartition
                 bufferConsumer,
                 getOwningTaskName(),
                 subpartition.subpartitionInfo);
-        if (subpartition.add(bufferConsumer, Integer.MIN_VALUE)
+
+        if (addToSubpartition(subpartitionIndex, bufferConsumer, Integer.MIN_VALUE)
                 == ResultSubpartition.ADD_BUFFER_ERROR_CODE) {
             throw new IOException("Buffer consumer couldn't be added to ResultSubpartition");
         }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/ResultPartitionTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/ResultPartitionTest.java
index e6df02363a6..af66ea24df8 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/ResultPartitionTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/io/network/partition/ResultPartitionTest.java
@@ -28,10 +28,13 @@ import org.apache.flink.runtime.io.network.api.EndOfPartitionEvent;
 import org.apache.flink.runtime.io.network.api.StopMode;
 import org.apache.flink.runtime.io.network.api.serialization.EventSerializer;
 import org.apache.flink.runtime.io.network.buffer.Buffer;
+import org.apache.flink.runtime.io.network.buffer.BufferBuilder;
+import org.apache.flink.runtime.io.network.buffer.BufferConsumer;
 import org.apache.flink.runtime.io.network.buffer.BufferPool;
 import org.apache.flink.runtime.io.network.buffer.NetworkBufferPool;
 import org.apache.flink.runtime.util.EnvironmentInformation;
 
+import org.jetbrains.annotations.NotNull;
 import org.junit.jupiter.api.AfterAll;
 import org.junit.jupiter.api.BeforeAll;
 import org.junit.jupiter.api.Test;
@@ -743,12 +746,12 @@ class ResultPartitionTest {
     }
 
     @Test
-    void testSizeOfQueuedBuffers() throws IOException {
+    void testSizeOfQueuedBuffers() throws Exception {
         // given: Configured pipelined result with 2 subpartitions.
-        BufferWritingResultPartition bufferWritingResultPartition =
-                createResultPartition(ResultPartitionType.PIPELINED);
+        PipelinedResultPartition resultPartition =
+                (PipelinedResultPartition) createResultPartition(ResultPartitionType.PIPELINED);
 
-        ResultSubpartition[] subpartitions = bufferWritingResultPartition.subpartitions;
+        ResultSubpartition[] subpartitions = resultPartition.subpartitions;
         assertThat(subpartitions).hasSize(2);
 
         PipelinedSubpartition subpartition0 = (PipelinedSubpartition) subpartitions[0];
@@ -759,62 +762,102 @@ class ResultPartitionTest {
         subpartition1.bufferSize(10);
 
         // when: Emit different records into different subpartitions.
+        // Emit the recovered state.
+        try (BufferBuilder bufferBuilder = getFinishedBufferBuilder(resultPartition, 6);
+                BufferConsumer bufferConsumer = bufferBuilder.createBufferConsumerFromBeginning()) {
+            resultPartition.addRecovered(0, bufferConsumer.copy());
+            assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(6);
+
+            resultPartition.addRecovered(1, bufferConsumer.copy());
+            assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(12);
+        }
+
+        // Emit the EndOfChannelStateEvent for all channel
+        resultPartition.finishReadRecoveredState(true);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(20);
+
         // Emit the record less than buffer size.
-        bufferWritingResultPartition.emitRecord(ByteBuffer.allocate(3), 0);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(3);
+        resultPartition.emitRecord(ByteBuffer.allocate(3), 0);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(23);
 
-        bufferWritingResultPartition.emitRecord(ByteBuffer.allocate(3), 1);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(6);
+        resultPartition.emitRecord(ByteBuffer.allocate(3), 1);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(26);
 
         // Emit the record the equal to buffer size.
-        bufferWritingResultPartition.emitRecord(ByteBuffer.allocate(10), 0);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(16);
+        resultPartition.emitRecord(ByteBuffer.allocate(10), 0);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(36);
 
-        bufferWritingResultPartition.emitRecord(ByteBuffer.allocate(10), 1);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(26);
+        resultPartition.emitRecord(ByteBuffer.allocate(10), 1);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(46);
 
         // Broadcast event.
-        bufferWritingResultPartition.broadcastEvent(EndOfPartitionEvent.INSTANCE, false);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(34);
+        resultPartition.broadcastEvent(EndOfPartitionEvent.INSTANCE, false);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(54);
 
         // Emit one more record to the one subpartition.
-        bufferWritingResultPartition.emitRecord(ByteBuffer.allocate(5), 0);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(39);
+        resultPartition.emitRecord(ByteBuffer.allocate(5), 0);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(59);
 
         // Broadcast record.
-        bufferWritingResultPartition.broadcastRecord(ByteBuffer.allocate(7));
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(53);
+        resultPartition.broadcastRecord(ByteBuffer.allocate(7));
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(73);
+
+        // Poll the recovered state.
+        assertThat(subpartition0.pollBuffer().buffer().getSize()).isEqualTo(6);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(67);
+
+        assertThat(subpartition1.pollBuffer().buffer().getSize()).isEqualTo(6);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(61);
+
+        // Poll the EndOfChannelStateEvent and resume the consumption.
+        assertThat(subpartition0.pollBuffer().buffer().getSize()).isEqualTo(4);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(57);
+
+        assertThat(subpartition1.pollBuffer().buffer().getSize()).isEqualTo(4);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(53);
+
+        subpartition0.resumeConsumption();
+        subpartition1.resumeConsumption();
 
         // when: Poll finished buffers.
         assertThat(subpartition0.pollBuffer().buffer().getSize()).isEqualTo(10);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(43);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(43);
 
         assertThat(subpartition1.pollBuffer().buffer().getSize()).isEqualTo(10);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(33);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(33);
 
         // Poll records which were unfinished because of broadcasting event.
         assertThat(subpartition0.pollBuffer().buffer().getSize()).isEqualTo(3);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(30);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(30);
 
         assertThat(subpartition1.pollBuffer().buffer().getSize()).isEqualTo(3);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(27);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(27);
 
         // Poll the event.
         assertThat(subpartition0.pollBuffer().buffer().getSize()).isEqualTo(4);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(23);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(23);
 
         assertThat(subpartition1.pollBuffer().buffer().getSize()).isEqualTo(4);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(19);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(19);
 
         // Poll the unfinished buffer.
         assertThat(subpartition0.pollBuffer().buffer().getSize()).isEqualTo(5);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(14);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(14);
 
         // Poll broadcasted record.
         assertThat(subpartition0.pollBuffer().buffer().getSize()).isEqualTo(7);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(7);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(7);
 
         assertThat(subpartition1.pollBuffer().buffer().getSize()).isEqualTo(7);
-        assertThat(bufferWritingResultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(0);
+        assertThat(resultPartition.getSizeOfQueuedBuffersUnsafe()).isEqualTo(0);
+    }
+
+    @NotNull
+    private BufferBuilder getFinishedBufferBuilder(
+            PipelinedResultPartition resultPartition, int bufferSize) throws Exception {
+        BufferBuilder bufferBuilder = resultPartition.requestBufferBuilderBlocking();
+        bufferBuilder.appendAndCommit(ByteBuffer.allocate(bufferSize));
+        bufferBuilder.finish();
+        return bufferBuilder;
     }
 }
