diff --git a/flink-runtime/src/main/scala/org/apache/flink/runtime/taskmanager/TaskManager.scala b/flink-runtime/src/main/scala/org/apache/flink/runtime/taskmanager/TaskManager.scala
index 20a83b0ca1f..6d765b35b7e 100644
--- a/flink-runtime/src/main/scala/org/apache/flink/runtime/taskmanager/TaskManager.scala
+++ b/flink-runtime/src/main/scala/org/apache/flink/runtime/taskmanager/TaskManager.scala
@@ -315,13 +315,7 @@ class TaskManager(
     case msg: StopCluster =>
       log.info(s"Stopping TaskManager with final application status ${msg.finalStatus()} " +
         s"and diagnostics: ${msg.message()}")
-      context.system.shutdown()
-
-      // Await actor system termination and shut down JVM
-      new ProcessShutDownThread(
-        log.logger,
-        context.system,
-        FiniteDuration(10, SECONDS)).start()
+      shutdown()
 
     case FatalError(message, cause) =>
       killTaskManagerFatal(message, cause)
@@ -1299,6 +1293,16 @@ class TaskManager(
 
     self ! decorateMessage(PoisonPill)
   }
+
+  protected def shutdown(): Unit = {
+    context.system.shutdown()
+
+    // Await actor system termination and shut down JVM
+    new ProcessShutDownThread(
+      log.logger,
+      context.system,
+      FiniteDuration(10, SECONDS)).start()
+  }
 }
 
 /**
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ClusterShutdownITCase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ClusterShutdownITCase.java
index f23db09c8a8..32c6cac3a9a 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ClusterShutdownITCase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/resourcemanager/ClusterShutdownITCase.java
@@ -18,46 +18,28 @@
 
 package org.apache.flink.runtime.resourcemanager;
 
-import akka.actor.ActorRef;
 import akka.actor.ActorSystem;
 import akka.testkit.JavaTestKit;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.runtime.akka.AkkaUtils;
-import org.apache.flink.runtime.checkpoint.CheckpointRecoveryFactory;
-import org.apache.flink.runtime.checkpoint.SavepointStore;
 import org.apache.flink.runtime.clusterframework.ApplicationStatus;
 import org.apache.flink.runtime.clusterframework.messages.StopCluster;
 import org.apache.flink.runtime.clusterframework.messages.StopClusterSuccessful;
-import org.apache.flink.runtime.execution.librarycache.BlobLibraryCacheManager;
-import org.apache.flink.runtime.executiongraph.restart.RestartStrategy;
 import org.apache.flink.runtime.instance.ActorGateway;
-import org.apache.flink.runtime.instance.InstanceManager;
-import org.apache.flink.runtime.jobmanager.JobManager;
-import org.apache.flink.runtime.jobmanager.SubmittedJobGraphStore;
-import org.apache.flink.runtime.jobmanager.scheduler.Scheduler;
-import org.apache.flink.runtime.leaderelection.LeaderElectionService;
 import org.apache.flink.runtime.messages.Messages;
+import org.apache.flink.runtime.testingUtils.TestingMessages;
 import org.apache.flink.runtime.testingUtils.TestingUtils;
 import org.apache.flink.runtime.testutils.TestingResourceManager;
 import org.apache.flink.util.TestLogger;
 import org.junit.AfterClass;
 import org.junit.BeforeClass;
-import org.junit.FixMethodOrder;
 import org.junit.Test;
-import org.junit.runners.MethodSorters;
 import scala.Option;
-import scala.concurrent.duration.FiniteDuration;
-
-import java.util.concurrent.ExecutorService;
-
-import static org.junit.Assert.assertTrue;
 
 
 /**
- * Starts a dedicated Actor system and runs a shutdown test to shut it down.
+ * Runs tests to ensure that a cluster is shutdown properly.
  */
-// The last test shuts down the actor system
-@FixMethodOrder(MethodSorters.NAME_ASCENDING)
 public class ClusterShutdownITCase extends TestLogger {
 
 	private static ActorSystem system;
@@ -75,10 +57,10 @@ public class ClusterShutdownITCase extends TestLogger {
 	}
 
 	/**
-	 * Tests a faked cluster shutdown procedure with and without the ResourceManager.
+	 * Tests a faked cluster shutdown procedure without the ResourceManager.
 	 */
 	@Test
-	public void testClusterShutdownScenarios() {
+	public void testClusterShutdownWithoutResourceManager() {
 
 		new JavaTestKit(system){{
 		new Within(duration("30 seconds")) {
@@ -90,37 +72,37 @@ public class ClusterShutdownITCase extends TestLogger {
 
 			// start job manager which doesn't shutdown the actor system
 			ActorGateway jobManager =
-				TestingUtils.createJobManager(system, config, TestJobManager.class, "fakeShutdown");
+				TestingUtils.createJobManager(system, config, "jobmanager1");
 
-			// No resource manager connected
-			jobManager.tell(new StopCluster(ApplicationStatus.SUCCEEDED, "Shutting down."), me);
+			// Tell the JobManager to inform us of shutdown actions
+			jobManager.tell(TestingMessages.getNotifyOfComponentShutdown(), me);
 
-			expectMsgClass(StopClusterSuccessful.class);
+			// Register a TaskManager
+			ActorGateway taskManager =
+				TestingUtils.createTaskManager(system, jobManager, config, true, true);
 
-			// Start resource manager and let it register
-			ActorGateway resourceManager =
-				TestingUtils.createResourceManager(system, jobManager.actor(), config);
+			// Tell the TaskManager to inform us of TaskManager shutdowns
+			taskManager.tell(TestingMessages.getNotifyOfComponentShutdown(), me);
 
-			// notify about a resource manager registration at the job manager
-			resourceManager.tell(new TestingResourceManager.NotifyWhenResourceManagerConnected(), me);
-
-			// Wait for resource manager
-			expectMsgEquals(Messages.getAcknowledge());
 
-			// Resource Manager connected
+			// No resource manager connected
 			jobManager.tell(new StopCluster(ApplicationStatus.SUCCEEDED, "Shutting down."), me);
 
-			expectMsgClass(StopClusterSuccessful.class);
+			expectMsgAllOf(
+				new TestingMessages.ComponentShutdown(taskManager.actor()),
+				new TestingMessages.ComponentShutdown(jobManager.actor()),
+				StopClusterSuccessful.getInstance()
+			);
 
 		}};
 		}};
 	}
 
 	/**
-	 * Tests proper cluster shutdown procedure of RM.
+	 * Tests a faked cluster shutdown procedure with the ResourceManager.
 	 */
 	@Test
-	public void testProperClusterShutdown() {
+	public void testClusterShutdownWithResourceManager() {
 
 		new JavaTestKit(system){{
 		new Within(duration("30 seconds")) {
@@ -130,74 +112,45 @@ public class ClusterShutdownITCase extends TestLogger {
 			ActorGateway me =
 				TestingUtils.createForwardingActor(system, getTestActor(), Option.<String>empty());
 
-			ActorGateway jobManager = TestingUtils.createJobManager(system, config);
+			// start job manager which doesn't shutdown the actor system
+			ActorGateway jobManager =
+				TestingUtils.createJobManager(system, config, "jobmanager2");
+
+			// Tell the JobManager to inform us of shutdown actions
+			jobManager.tell(TestingMessages.getNotifyOfComponentShutdown(), me);
+
+			// Register a TaskManager
+			ActorGateway taskManager =
+				TestingUtils.createTaskManager(system, jobManager, config, true, true);
 
+			// Tell the TaskManager to inform us of TaskManager shutdowns
+			taskManager.tell(TestingMessages.getNotifyOfComponentShutdown(), me);
+
+			// Start resource manager and let it register
 			ActorGateway resourceManager =
 				TestingUtils.createResourceManager(system, jobManager.actor(), config);
 
+			// Tell the ResourceManager to inform us of ResourceManager shutdowns
+			resourceManager.tell(TestingMessages.getNotifyOfComponentShutdown(), me);
+
 			// notify about a resource manager registration at the job manager
 			resourceManager.tell(new TestingResourceManager.NotifyWhenResourceManagerConnected(), me);
 
 			// Wait for resource manager
 			expectMsgEquals(Messages.getAcknowledge());
 
-			jobManager.tell(new StopCluster(ApplicationStatus.SUCCEEDED, "Shutting down."), me);
-
-			expectMsgClass(StopClusterSuccessful.class);
 
-			boolean isTerminated = false;
-			for (int i=0; i < 10 && !isTerminated; i++) {
-				isTerminated = system.isTerminated();
-				try {
-					Thread.sleep(1000);
-				} catch (InterruptedException e) {
-					// try again
-				}
-			}
+			// Shutdown cluster with resource manager connected
+			jobManager.tell(new StopCluster(ApplicationStatus.SUCCEEDED, "Shutting down."), me);
 
-			assertTrue(isTerminated);
+			expectMsgAllOf(
+				new TestingMessages.ComponentShutdown(taskManager.actor()),
+				new TestingMessages.ComponentShutdown(jobManager.actor()),
+				new TestingMessages.ComponentShutdown(resourceManager.actor()),
+				StopClusterSuccessful.getInstance()
+			);
 
 		}};
 		}};
 	}
-
-	/**
-	 * A job manager which doesn't execute the final shutdown code
-	 */
-	private static class TestJobManager extends JobManager {
-
-		public TestJobManager(Configuration flinkConfiguration,
-			 ExecutorService executorService,
-			 InstanceManager instanceManager,
-			 Scheduler scheduler,
-			 BlobLibraryCacheManager libraryCacheManager,
-			 ActorRef archive,
-			 RestartStrategy defaultRestartStrategy,
-			 FiniteDuration timeout,
-			 LeaderElectionService leaderElectionService,
-			 SubmittedJobGraphStore submittedJobGraphs,
-			 CheckpointRecoveryFactory checkpointRecoveryFactory,
-			 SavepointStore savepointStore,
-			 FiniteDuration jobRecoveryTimeout) {
-			super(flinkConfiguration,
-			 executorService,
-			 instanceManager,
-			 scheduler,
-			 libraryCacheManager,
-			 archive,
-			 defaultRestartStrategy,
-			 timeout,
-			 leaderElectionService,
-			 submittedJobGraphs,
-			 checkpointRecoveryFactory,
-			 savepointStore,
-			 jobRecoveryTimeout);
-		}
-
-		@Override
-		public void shutdown() {
-			// do not shutdown
-		}
-	}
-
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/testutils/TestingResourceManager.java b/flink-runtime/src/test/java/org/apache/flink/runtime/testutils/TestingResourceManager.java
index 9b85dcf2f44..401299c2ffd 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/testutils/TestingResourceManager.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/testutils/TestingResourceManager.java
@@ -20,16 +20,19 @@ package org.apache.flink.runtime.testutils;
 
 import akka.actor.ActorRef;
 import org.apache.flink.configuration.Configuration;
+import org.apache.flink.runtime.clusterframework.ApplicationStatus;
 import org.apache.flink.runtime.clusterframework.messages.RegisterResourceManagerSuccessful;
 import org.apache.flink.runtime.clusterframework.standalone.StandaloneResourceManager;
 import org.apache.flink.runtime.clusterframework.types.ResourceID;
 import org.apache.flink.runtime.leaderretrieval.LeaderRetrievalService;
 import org.apache.flink.runtime.messages.Messages;
+import org.apache.flink.runtime.testingUtils.TestingMessages;
 
 import java.util.Collection;
 import java.util.HashSet;
 import java.util.Set;
 
+
 /**
  * A testing resource manager which may alter the default standalone resource master's behavior.
  */
@@ -38,6 +41,9 @@ public class TestingResourceManager extends StandaloneResourceManager {
 	/** Set of Actors which want to be informed of a connection to the job manager */
 	private Set<ActorRef> waitForResourceManagerConnected = new HashSet<>();
 
+	/** Set of Actors which want to be informed of a shutdown */
+	private Set<ActorRef> waitForShutdown = new HashSet<>();
+
 	/** Flag to signal a connection to the JobManager */
 	private boolean isConnected = false;
 
@@ -77,6 +83,8 @@ public class TestingResourceManager extends StandaloneResourceManager {
 			}
 			waitForResourceManagerConnected.clear();
 
+		} else if (message instanceof TestingMessages.NotifyOfComponentShutdown$) {
+			waitForShutdown.add(sender());
 		} else {
 			super.handleMessage(message);
 		}
@@ -112,7 +120,16 @@ public class TestingResourceManager extends StandaloneResourceManager {
 	/**
 	 * The sender of this message will be informed of a connection to the Job Manager
 	 */
-	public static class NotifyWhenResourceManagerConnected {
+	public static class NotifyWhenResourceManagerConnected {}
 
+	/**
+	 * Inform registered listeners about a shutdown of the application.
+     */
+	@Override
+	protected void shutdownApplication(ApplicationStatus finalStatus, String optionalDiagnostics) {
+		for (ActorRef listener : waitForShutdown) {
+			listener.tell(new TestingMessages.ComponentShutdown(self()), self());
+		}
+		waitForShutdown.clear();
 	}
 }
diff --git a/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingJobManagerLike.scala b/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingJobManagerLike.scala
index 3f026d0d689..8ea603fa410 100644
--- a/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingJobManagerLike.scala
+++ b/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingJobManagerLike.scala
@@ -18,7 +18,7 @@
 
 package org.apache.flink.runtime.testingUtils
 
-import akka.actor.{Terminated, Cancellable, ActorRef}
+import akka.actor.{ActorRef, Cancellable, Terminated}
 import akka.pattern.{ask, pipe}
 import org.apache.flink.api.common.JobID
 import org.apache.flink.runtime.FlinkActor
@@ -32,14 +32,12 @@ import org.apache.flink.runtime.messages.Messages.{Acknowledge, Disconnect}
 import org.apache.flink.runtime.messages.RegistrationMessages.RegisterTaskManager
 import org.apache.flink.runtime.messages.TaskManagerMessages.Heartbeat
 import org.apache.flink.runtime.testingUtils.TestingJobManagerMessages._
-import org.apache.flink.runtime.testingUtils.TestingMessages.{DisableDisconnect,
-CheckIfJobRemoved, Alive}
+import org.apache.flink.runtime.testingUtils.TestingMessages._
 import org.apache.flink.runtime.testingUtils.TestingTaskManagerMessages.AccumulatorsChanged
 
 import scala.collection.mutable
 import scala.concurrent.Future
 import scala.concurrent.duration._
-
 import language.postfixOps
 
 /** This mixin can be used to decorate a JobManager with messages for testing purpose.  */
@@ -69,6 +67,8 @@ trait TestingJobManagerLike extends FlinkActor {
       override def compare(x: (Int, ActorRef), y: (Int, ActorRef)): Int = y._1 - x._1
     })
 
+  val waitForShutdown = scala.collection.mutable.HashSet[ActorRef]()
+
   var disconnectDisabled = false
 
   var postStopEnabled = true
@@ -190,6 +190,10 @@ trait TestingJobManagerLike extends FlinkActor {
         }
       }
 
+    // see shutdown method for reply
+    case NotifyOfComponentShutdown =>
+      waitForShutdown += sender()
+
     case NotifyWhenAccumulatorChange(jobID) =>
 
       val (updated, registered) = waitForAccumulatorUpdate.
@@ -393,6 +397,8 @@ trait TestingJobManagerLike extends FlinkActor {
     * No killing of the VM for testing.
     */
   override protected def shutdown(): Unit = {
-    system.shutdown()
+    log.info("Shutting down TestingJobManager.")
+    waitForShutdown.foreach(_ ! ComponentShutdown(self))
+    waitForShutdown.clear()
   }
 }
diff --git a/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingMessages.scala b/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingMessages.scala
index c840ff09d0d..91d169a1618 100644
--- a/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingMessages.scala
+++ b/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingMessages.scala
@@ -18,6 +18,7 @@
 
 package org.apache.flink.runtime.testingUtils
 
+import akka.actor.ActorRef
 import org.apache.flink.api.common.JobID
 
 object TestingMessages {
@@ -31,4 +32,9 @@ object TestingMessages {
   def getAlive: AnyRef = Alive
 
   def getDisableDisconnect: AnyRef = DisableDisconnect
+
+  case object NotifyOfComponentShutdown
+  case class ComponentShutdown(ref: ActorRef)
+
+  def getNotifyOfComponentShutdown(): AnyRef = NotifyOfComponentShutdown
 }
diff --git a/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingTaskManagerLike.scala b/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingTaskManagerLike.scala
index 994e25687e7..f8df89c05d6 100644
--- a/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingTaskManagerLike.scala
+++ b/flink-runtime/src/test/scala/org/apache/flink/runtime/testingUtils/TestingTaskManagerLike.scala
@@ -18,24 +18,21 @@
 
 package org.apache.flink.runtime.testingUtils
 
-import akka.actor.{Terminated, ActorRef}
+import akka.actor.{ActorRef, Terminated}
 import org.apache.flink.api.common.JobID
 import org.apache.flink.runtime.FlinkActor
 import org.apache.flink.runtime.execution.ExecutionState
 import org.apache.flink.runtime.executiongraph.ExecutionAttemptID
-import org.apache.flink.runtime.messages.JobManagerMessages.{ResponseLeaderSessionID,
-RequestLeaderSessionID}
+import org.apache.flink.runtime.messages.JobManagerMessages.{RequestLeaderSessionID, ResponseLeaderSessionID}
 import org.apache.flink.runtime.messages.Messages.{Acknowledge, Disconnect}
-import org.apache.flink.runtime.messages.RegistrationMessages.{AlreadyRegistered,
-AcknowledgeRegistration}
-import org.apache.flink.runtime.messages.TaskMessages.{SubmitTask, UpdateTaskExecutionState, TaskInFinalState}
+import org.apache.flink.runtime.messages.RegistrationMessages.{AcknowledgeRegistration, AlreadyRegistered}
+import org.apache.flink.runtime.messages.TaskMessages.{SubmitTask, TaskInFinalState, UpdateTaskExecutionState}
 import org.apache.flink.runtime.taskmanager.TaskManager
 import org.apache.flink.runtime.testingUtils.TestingJobManagerMessages.NotifyWhenJobRemoved
-import org.apache.flink.runtime.testingUtils.TestingMessages.{DisableDisconnect, CheckIfJobRemoved, Alive}
+import org.apache.flink.runtime.testingUtils.TestingMessages._
 import org.apache.flink.runtime.testingUtils.TestingTaskManagerMessages._
 
 import scala.concurrent.duration._
-
 import language.postfixOps
 
 /** This mixin can be used to decorate a TaskManager with messages for testing purposes. */
@@ -54,6 +51,8 @@ trait TestingTaskManagerLike extends FlinkActor {
   /** Map of registered task submit listeners */
   val registeredSubmitTaskListeners = scala.collection.mutable.HashMap[JobID, ActorRef]()
 
+  val waitForShutdown = scala.collection.mutable.HashSet[ActorRef]()
+
   var disconnectDisabled = false
 
   /**
@@ -199,6 +198,9 @@ trait TestingTaskManagerLike extends FlinkActor {
     case DisableDisconnect =>
       disconnectDisabled = true
 
+    case NotifyOfComponentShutdown =>
+      waitForShutdown += sender()
+
     case msg @ UpdateTaskExecutionState(taskExecutionState) =>
       super.handleMessage(msg)
 
@@ -234,4 +236,13 @@ trait TestingTaskManagerLike extends FlinkActor {
         }
       }
   }
+
+  /**
+    * No killing of the VM for testing.
+    */
+  override protected def shutdown(): Unit = {
+    log.info("Shutting down TestingJobManager.")
+    waitForShutdown.foreach(_ ! ComponentShutdown(self))
+    waitForShutdown.clear()
+  }
 }
