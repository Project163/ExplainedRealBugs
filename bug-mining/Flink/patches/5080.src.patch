diff --git a/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/QueryableStateClient.java b/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/QueryableStateClient.java
index 8bf601f0a2a..ecb3f396eed 100644
--- a/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/QueryableStateClient.java
+++ b/flink-queryable-state/flink-queryable-state-client-java/src/main/java/org/apache/flink/queryablestate/client/QueryableStateClient.java
@@ -115,6 +115,9 @@ public class QueryableStateClient {
     /** The execution configuration used to instantiate the different (de-)serializers. */
     private ExecutionConfig executionConfig;
 
+    /** The user code classloader, used in loading serializers. */
+    private ClassLoader userClassLoader;
+
     /**
      * Create the Queryable State Client.
      *
@@ -197,6 +200,18 @@ public class QueryableStateClient {
         return prev;
     }
 
+    /**
+     * * Replaces the existing {@link ClassLoader} (possibly {@code null}), with the provided one.
+     *
+     * @param userClassLoader The new {@code userClassLoader}.
+     * @return The old classloader, or {@code null} if none was specified.
+     */
+    public ClassLoader setUserClassLoader(ClassLoader userClassLoader) {
+        ClassLoader prev = this.userClassLoader;
+        this.userClassLoader = userClassLoader;
+        return prev;
+    }
+
     /**
      * Returns a future holding the request result.
      *
@@ -293,12 +308,15 @@ public class QueryableStateClient {
             return FutureUtils.getFailedFuture(e);
         }
 
-        ClassLoader contextLoader = Thread.currentThread().getContextClassLoader();
+        ClassLoader classLoaderToUse =
+                userClassLoader != null
+                        ? userClassLoader
+                        : Thread.currentThread().getContextClassLoader();
         return getKvState(jobId, queryableStateName, key.hashCode(), serializedKeyAndNamespace)
                 .thenApply(
                         stateResponse ->
                                 LambdaUtil.withContextClassLoader(
-                                        contextLoader,
+                                        classLoaderToUse,
                                         () -> createState(stateResponse, stateDescriptor)));
     }
 
diff --git a/flink-queryable-state/flink-queryable-state-runtime/src/test/java/org/apache/flink/queryablestate/itcases/AbstractQueryableStateTestBase.java b/flink-queryable-state/flink-queryable-state-runtime/src/test/java/org/apache/flink/queryablestate/itcases/AbstractQueryableStateTestBase.java
index 7c15a22e63c..368dd572042 100644
--- a/flink-queryable-state/flink-queryable-state-runtime/src/test/java/org/apache/flink/queryablestate/itcases/AbstractQueryableStateTestBase.java
+++ b/flink-queryable-state/flink-queryable-state-runtime/src/test/java/org/apache/flink/queryablestate/itcases/AbstractQueryableStateTestBase.java
@@ -67,7 +67,6 @@ import org.apache.flink.streaming.runtime.streamrecord.StreamRecord;
 import org.apache.flink.testutils.ClassLoaderUtils;
 import org.apache.flink.util.Collector;
 import org.apache.flink.util.ExceptionUtils;
-import org.apache.flink.util.LambdaUtil;
 import org.apache.flink.util.Preconditions;
 import org.apache.flink.util.TestLogger;
 
@@ -424,11 +423,13 @@ public abstract class AbstractQueryableStateTestBase extends TestLogger {
             jobGraph.setClasspaths(Arrays.asList(userClassLoader.getURLs()));
 
             clusterClient.submitJob(jobGraph).get();
-            LambdaUtil.withContextClassLoader(
-                    userClassLoader,
-                    () ->
-                            executeValueQuery(
-                                    deadline, client, jobId, stateName, valueState, numElements));
+
+            try {
+                client.setUserClassLoader(userClassLoader);
+                executeValueQuery(deadline, client, jobId, stateName, valueState, numElements);
+            } finally {
+                client.setUserClassLoader(null);
+            }
         }
     }
 
@@ -1389,7 +1390,6 @@ public abstract class AbstractQueryableStateTestBase extends TestLogger {
         if (!resultFuture.isDone()) {
             CompletableFuture<S> expected =
                     client.getKvState(jobId, queryName, key, keyTypeInfo, stateDescriptor);
-            ClassLoader contextLoader = Thread.currentThread().getContextClassLoader();
             expected.whenCompleteAsync(
                     (result, throwable) -> {
                         if (throwable != null) {
@@ -1400,20 +1400,17 @@ public abstract class AbstractQueryableStateTestBase extends TestLogger {
                                                     instanceof UnknownKeyOrNamespaceException)) {
                                 resultFuture.completeExceptionally(throwable.getCause());
                             } else if (deadline.hasTimeLeft()) {
-                                LambdaUtil.withContextClassLoader(
-                                        contextLoader,
-                                        () ->
-                                                getKvStateIgnoringCertainExceptions(
-                                                        deadline,
-                                                        resultFuture,
-                                                        client,
-                                                        jobId,
-                                                        queryName,
-                                                        key,
-                                                        keyTypeInfo,
-                                                        stateDescriptor,
-                                                        failForUnknownKeyOrNamespace,
-                                                        executor));
+                                getKvStateIgnoringCertainExceptions(
+                                        deadline,
+                                        resultFuture,
+                                        client,
+                                        jobId,
+                                        queryName,
+                                        key,
+                                        keyTypeInfo,
+                                        stateDescriptor,
+                                        failForUnknownKeyOrNamespace,
+                                        executor);
                             }
                         } else {
                             resultFuture.complete(result);
