diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/LogicalFile.java b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/LogicalFile.java
index 4ee3f5595dd..3ec0ec891d9 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/LogicalFile.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/LogicalFile.java
@@ -25,6 +25,7 @@ import javax.annotation.Nonnull;
 
 import java.io.IOException;
 import java.util.UUID;
+import java.util.concurrent.atomic.AtomicBoolean;
 
 import static org.apache.flink.runtime.checkpoint.filemerging.FileMergingSnapshotManager.SubtaskKey;
 
@@ -59,7 +60,7 @@ public class LogicalFile {
     private long lastUsedCheckpointID = -1L;
 
     /** Whether this logical file is removed by checkpoint subsumption/abortion. */
-    boolean discarded = false;
+    AtomicBoolean discarded = new AtomicBoolean(false);
 
     /** The physical file where this logical file is stored. This should never be null. */
     @Nonnull private final PhysicalFile physicalFile;
@@ -114,10 +115,9 @@ public class LogicalFile {
      * @throws IOException if anything goes wrong with file system.
      */
     public void discardWithCheckpointId(long checkpointId) throws IOException {
-        if (!discarded && checkpointId >= lastUsedCheckpointID) {
+        if (checkpointId >= lastUsedCheckpointID && discarded.compareAndSet(false, true)) {
             physicalFile.decRefCount();
             physicalFile.decSize(length);
-            discarded = true;
         }
     }
 
@@ -145,7 +145,7 @@ public class LogicalFile {
 
     @VisibleForTesting
     public boolean isDiscarded() {
-        return discarded;
+        return discarded.get();
     }
 
     @Override
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerTestBase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerTestBase.java
index 613c278ad90..582a4281b2d 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerTestBase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerTestBase.java
@@ -180,6 +180,10 @@ public abstract class FileMergingSnapshotManagerTestBase {
             assertThat(physicalFile1.isDeleted()).isFalse();
             assertThat(physicalFile1.getRefCount()).isZero();
 
+            // duplicated discard takes no effect
+            logicalFile1.discardWithCheckpointId(2);
+            assertThat(physicalFile1.getRefCount()).isZero();
+
             physicalFile1.close();
             assertThat(physicalFile1.isOpen()).isFalse();
             assertThat(physicalFile1.isDeleted()).isTrue();
