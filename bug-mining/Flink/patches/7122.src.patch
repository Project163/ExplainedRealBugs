diff --git a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/ProjectionCodeGenerator.scala b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/ProjectionCodeGenerator.scala
index 78095999e2c..e3621176163 100644
--- a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/ProjectionCodeGenerator.scala
+++ b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/ProjectionCodeGenerator.scala
@@ -146,9 +146,13 @@ object ProjectionCodeGenerator {
       outClass: Class[_ <: RowData] = classOf[BinaryRowData],
       inputTerm: String = DEFAULT_INPUT1_TERM,
       aggInfos: Array[AggregateInfo],
+      auxGrouping: Array[Int],
       outRecordTerm: String = DEFAULT_OUT_RECORD_TERM,
       outRecordWriterTerm: String = DEFAULT_OUT_RECORD_WRITER_TERM): String = {
     val fieldExprs: ArrayBuffer[GeneratedExpression] = ArrayBuffer()
+    // The auxGrouping also need to consider which is aggBuffer field
+    auxGrouping.foreach(i => fieldExprs += reuseFieldExprForAggFunc(ctx, inputType, inputTerm, i))
+
     aggInfos.map {
       aggInfo =>
         aggInfo.function match {
diff --git a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/HashAggCodeGenerator.scala b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/HashAggCodeGenerator.scala
index 80881bb25ad..3b9dea7f64e 100644
--- a/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/HashAggCodeGenerator.scala
+++ b/flink-table/flink-table-planner/src/main/scala/org/apache/flink/table/planner/codegen/agg/batch/HashAggCodeGenerator.scala
@@ -257,6 +257,7 @@ object HashAggCodeGenerator {
           classOf[BinaryRowData],
           inputTerm = inputTerm,
           aggInfos,
+          auxGrouping,
           outRecordTerm = currentValueTerm,
           outRecordWriterTerm = currentValueWriterTerm
         )
diff --git a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/agg/HashAggITCase.scala b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/agg/HashAggITCase.scala
index 6d815ebb81f..3cb7996733a 100644
--- a/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/agg/HashAggITCase.scala
+++ b/flink-table/flink-table-planner/src/test/scala/org/apache/flink/table/planner/runtime/batch/sql/agg/HashAggITCase.scala
@@ -21,7 +21,9 @@ import org.apache.flink.api.scala._
 import org.apache.flink.table.api.DataTypes
 import org.apache.flink.table.api.config.{ExecutionConfigOptions, OptimizerConfigOptions}
 import org.apache.flink.table.planner.codegen.agg.batch.HashAggCodeGenerator
+import org.apache.flink.table.planner.plan.stats.FlinkStatistic
 import org.apache.flink.table.planner.runtime.utils.BatchTestBase.row
+import org.apache.flink.table.planner.runtime.utils.TestData.{data1, nullablesOfData1, type1}
 import org.apache.flink.testutils.junit.extensions.parameterized.{Parameter, ParameterizedTestExtension, Parameters}
 
 import org.junit.jupiter.api.TestTemplate
@@ -29,6 +31,8 @@ import org.junit.jupiter.api.extension.ExtendWith
 
 import java.math.BigDecimal
 
+import scala.collection.JavaConverters._
+
 /** AggregateITCase using HashAgg Operator. */
 @ExtendWith(Array(classOf[ParameterizedTestExtension]))
 class HashAggITCase extends AggregateITCaseBase("HashAggregate") {
@@ -36,6 +40,14 @@ class HashAggITCase extends AggregateITCaseBase("HashAggregate") {
   @Parameter var adaptiveLocalHashAggEnable: Boolean = _
 
   override def prepareAggOp(): Unit = {
+    registerCollection(
+      "AuxGroupingTable",
+      data1,
+      type1,
+      "a, b, c",
+      nullablesOfData1,
+      FlinkStatistic.builder().uniqueKeys(Set(Set("a").asJava).asJava).build())
+
     tEnv.getConfig.set(ExecutionConfigOptions.TABLE_EXEC_DISABLED_OPERATORS, "SortAgg")
     if (adaptiveLocalHashAggEnable) {
       tEnv.getConfig
@@ -45,7 +57,7 @@ class HashAggITCase extends AggregateITCaseBase("HashAggregate") {
         Boolean.box(true))
       tEnv.getConfig.set(
         HashAggCodeGenerator.TABLE_EXEC_LOCAL_HASH_AGG_ADAPTIVE_SAMPLING_THRESHOLD,
-        Long.box(5L))
+        Long.box(3L))
     }
   }
 
@@ -331,6 +343,21 @@ class HashAggITCase extends AggregateITCaseBase("HashAggregate") {
       )
     )
   }
+
+  @TestTemplate
+  def testAdaptiveHashAggWithAuxGrouping(): Unit = {
+    checkResult(
+      "SELECT a, b, COUNT(c) FROM AuxGroupingTable GROUP BY a, b",
+      Seq(
+        row(1, "a", 1),
+        row(2, "a", 1),
+        row(3, "b", 1),
+        row(4, "b", 1),
+        row(5, "c", 1),
+        row(6, "c", 1)
+      )
+    )
+  }
 }
 
 object HashAggITCase {
