diff --git a/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/DeclarationRewriter.java b/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/DeclarationRewriter.java
index 9fcc1e4a024..bff06567dd7 100644
--- a/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/DeclarationRewriter.java
+++ b/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/DeclarationRewriter.java
@@ -132,6 +132,11 @@ public class DeclarationRewriter implements CodeRewriter {
             return visitChildren(ctx);
         }
 
+        @Override
+        public Void visitConstructorDeclaration(JavaParser.ConstructorDeclarationContext ctx) {
+            return visitFunctionBody(ctx.constructorBody);
+        }
+
         @Override
         public Void visitMethodDeclaration(JavaParser.MethodDeclarationContext ctx) {
             if ("void".equals(ctx.typeTypeOrVoid().getText())) {
@@ -142,17 +147,21 @@ public class DeclarationRewriter implements CodeRewriter {
 
         @Override
         public Void visitMethodBody(JavaParser.MethodBodyContext ctx) {
+            return visitFunctionBody(ctx.block());
+        }
+
+        public Void visitFunctionBody(JavaParser.BlockContext blockContext) {
             // this condition must be the same with the condition in
             // FunctionSplitter::visitMethodDeclaration
-            if (CodeSplitUtil.getContextTextLength(ctx.block()) <= maxMethodLength) {
+            if (CodeSplitUtil.getContextTextLength(blockContext) <= maxMethodLength) {
                 return null;
             }
 
             hasRewrite = true;
             InnerBlockStatementExtractor extractor = new InnerBlockStatementExtractor();
-            if (ctx.block() != null && ctx.block().blockStatement() != null) {
+            if (blockContext != null && blockContext.blockStatement() != null) {
                 for (JavaParser.BlockStatementContext blockStatementContext :
-                        ctx.block().blockStatement()) {
+                        blockContext.blockStatement()) {
                     extractor.visitBlockStatement(blockStatementContext);
                 }
                 newFields.peek().append(extractor.getNewLocalVariables());
diff --git a/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/FunctionSplitter.java b/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/FunctionSplitter.java
index 5e68ab853a1..cb3e9bf0dcf 100644
--- a/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/FunctionSplitter.java
+++ b/flink-table/flink-table-code-splitter/src/main/java/org/apache/flink/table/codesplit/FunctionSplitter.java
@@ -21,6 +21,7 @@ import org.apache.flink.annotation.Internal;
 
 import org.antlr.v4.runtime.CharStreams;
 import org.antlr.v4.runtime.CommonTokenStream;
+import org.antlr.v4.runtime.ParserRuleContext;
 import org.antlr.v4.runtime.TokenStreamRewriter;
 import org.antlr.v4.runtime.atn.PredictionMode;
 
@@ -142,6 +143,18 @@ public class FunctionSplitter implements CodeRewriter {
             return visitChildren(ctx);
         }
 
+        @Override
+        public Void visitConstructorDeclaration(JavaParser.ConstructorDeclarationContext ctx) {
+            return doFunctionSplit(
+                    ctx,
+                    ctx.constructorBody,
+                    "void",
+                    ctx.IDENTIFIER().getText(),
+                    CodeSplitUtil.getContextString(ctx.formalParameters()),
+                    ctx.THROWS() != null,
+                    CodeSplitUtil.getContextString(ctx.qualifiedNameList()));
+        }
+
         @Override
         public Void visitMethodDeclaration(JavaParser.MethodDeclarationContext ctx) {
 
@@ -149,14 +162,32 @@ public class FunctionSplitter implements CodeRewriter {
                 return null;
             }
 
-            long methodBodyLength = CodeSplitUtil.getContextTextLength(ctx.methodBody().block());
+            return doFunctionSplit(
+                    ctx,
+                    ctx.methodBody().block(),
+                    CodeSplitUtil.getContextString(ctx.typeTypeOrVoid()),
+                    ctx.IDENTIFIER().getText(),
+                    CodeSplitUtil.getContextString(ctx.formalParameters()),
+                    ctx.THROWS() != null,
+                    CodeSplitUtil.getContextString(ctx.qualifiedNameList()));
+        }
+
+        private Void doFunctionSplit(
+                ParserRuleContext ctx,
+                JavaParser.BlockContext blockContext,
+                String returnType,
+                String functionName,
+                String parameters,
+                boolean hasThrowable,
+                String throwables) {
+            long methodBodyLength = CodeSplitUtil.getContextTextLength(blockContext);
 
             if (methodBodyLength < maxMethodLength) {
                 return null;
             }
 
-            if (ctx.methodBody().block().blockStatement() == null
-                    || ctx.methodBody().block().blockStatement().size() <= 1) {
+            if (blockContext.blockStatement() == null
+                    || blockContext.blockStatement().size() <= 1) {
                 return null;
             }
 
@@ -173,13 +204,8 @@ public class FunctionSplitter implements CodeRewriter {
                 }
             }.visit(ctx);
 
-            // function definition
-            String type = CodeSplitUtil.getContextString(ctx.typeTypeOrVoid());
-            String functionName = ctx.IDENTIFIER().getText();
-            String parameters = CodeSplitUtil.getContextString(ctx.formalParameters());
-
             for (JavaParser.BlockStatementContext blockStatementContext :
-                    ctx.methodBody().block().blockStatement()) {
+                    blockContext.blockStatement()) {
                 blockStatementContexts.add(blockStatementContext);
                 splitFuncBodies.add(CodeSplitUtil.getContextString(blockStatementContext));
             }
@@ -189,16 +215,14 @@ public class FunctionSplitter implements CodeRewriter {
             List<String> newSplitMethodCalls = new ArrayList<>();
 
             String methodQualifier = "";
-            if (ctx.THROWS() != null) {
-                methodQualifier =
-                        " throws " + CodeSplitUtil.getContextString(ctx.qualifiedNameList());
+            if (hasThrowable) {
+                methodQualifier = " throws " + throwables;
             }
 
             String hasReturnedVarName = boolVarNames.get(classCount).get(functionName + parameters);
             if (hasReturnedVarName != null) {
                 rewriter.insertAfter(
-                        ctx.methodBody().block().start,
-                        String.format("\n%s = false;", hasReturnedVarName));
+                        blockContext.start, String.format("\n%s = false;", hasReturnedVarName));
             }
 
             for (String methodBody : mergedCodeBlocks) {
@@ -206,7 +230,7 @@ public class FunctionSplitter implements CodeRewriter {
 
                 // void f_splitXX(int x, String y)
                 String splitMethodDef =
-                        type
+                        returnType
                                 + " "
                                 + functionName
                                 + "_split"
diff --git a/flink-table/flink-table-code-splitter/src/test/resources/splitter/code/TestSplitJavaCode.java b/flink-table/flink-table-code-splitter/src/test/resources/splitter/code/TestSplitJavaCode.java
index daec894a8a5..b55e3e53e41 100644
--- a/flink-table/flink-table-code-splitter/src/test/resources/splitter/code/TestSplitJavaCode.java
+++ b/flink-table/flink-table-code-splitter/src/test/resources/splitter/code/TestSplitJavaCode.java
@@ -4,6 +4,26 @@ public class TestSplitJavaCode {
 
     public TestSplitJavaCode(int[] b) {
         this.b = b;
+        int b0 = this.b[0] + b[0];
+        System.out.println("b0 = " + b0);
+        int b1 = this.b[1] + b[1];
+        System.out.println("b1 = " + b1);
+        int b2 = this.b[2] + b[2];
+        System.out.println("b2 = " + b2);
+        int b3 = this.b[3] + b[3];
+        System.out.println("b3 = " + b3);
+        int b4 = this.b[4] + b[4];
+        System.out.println("b4 = " + b4);
+        int b5 = this.b[5] + b[5];
+        System.out.println("b5 = " + b5);
+        int b6 = this.b[6] + b[6];
+        System.out.println("b6 = " + b6);
+        int b7 = this.b[7] + b[7];
+        System.out.println("b7 = " + b7);
+        int b8 = this.b[8] + b[8];
+        System.out.println("b8 = " + b8);
+        int b9 = this.b[9] + b[9];
+        System.out.println("b9 = " + b9);
     }
 
     public void myFun1(int a) {
diff --git a/flink-table/flink-table-code-splitter/src/test/resources/splitter/expected/TestSplitJavaCode.java b/flink-table/flink-table-code-splitter/src/test/resources/splitter/expected/TestSplitJavaCode.java
index 31c59177322..4b17bb1ffb8 100644
--- a/flink-table/flink-table-code-splitter/src/test/resources/splitter/expected/TestSplitJavaCode.java
+++ b/flink-table/flink-table-code-splitter/src/test/resources/splitter/expected/TestSplitJavaCode.java
@@ -1,11 +1,12 @@
 public class TestSplitJavaCode {
-    boolean[] rewrite$16 = new boolean[2];
-    int[][] rewrite$17 = new int[1][];
-    int[] rewrite$18 = new int[6];
+boolean[] rewrite$26 = new boolean[2];
+int[][] rewrite$27 = new int[1][];
+int[] rewrite$28 = new int[16];
+
+{
+rewrite$28[15] = 1;
+}
 
-    {
-        rewrite$18[5] = 1;
-    }
 
 
 
@@ -19,131 +20,210 @@ public class TestSplitJavaCode {
 
 
 
-    public TestSplitJavaCode(int[] b) {
-        this.rewrite$17[0] = b;
-    }
 
-    public void myFun1(int a) {
-        rewrite$16[0] = false;
-        myFun1_split6(a);
 
-        myFun1_split7(a);
 
-        myFun1_split8(a);
 
-        myFun1_split9(a);
-        if (rewrite$16[0]) { return; }
 
 
 
 
 
+public TestSplitJavaCode(int[] b) {
+TestSplitJavaCode_split9(b);
 
+TestSplitJavaCode_split10(b);
 
+TestSplitJavaCode_split11(b);
 
-    }
-    void myFun1_split6(int a) {
+TestSplitJavaCode_split12(b);
 
-        this.rewrite$18[5] = a;
-        rewrite$17[0][0] += rewrite$17[0][1];
-        rewrite$17[0][1] += rewrite$17[0][2];
-        rewrite$17[0][2] += rewrite$17[0][3];
-        rewrite$18[0] = rewrite$17[0][0] + rewrite$17[0][1];
-        rewrite$18[1] = rewrite$17[0][1] + rewrite$17[0][2];
-    }
+TestSplitJavaCode_split13(b);
 
-    void myFun1_split7(int a) {
-        rewrite$18[2] = rewrite$17[0][2] + rewrite$17[0][0];
-    }
+TestSplitJavaCode_split14(b);
 
-    void myFun1_split8(int a) {
-        for (int x : rewrite$17[0]) {rewrite$18[3] = x;
-            System.out.println(rewrite$18[3] + rewrite$18[0] + rewrite$18[1] + rewrite$18[2]);
-        }
-    }
+TestSplitJavaCode_split15(b);
 
-    void myFun1_split9(int a) {
-        if (rewrite$18[0] > 0) {
-            myFun1_0_0_rewriteGroup5(a);
-        } else {
-            rewrite$17[0][0] += 50;
-            rewrite$17[0][1] += 100;
-            rewrite$17[0][2] += 150;
-            rewrite$17[0][3] += 200;
-            rewrite$17[0][4] += 250;
-            rewrite$17[0][5] += 300;
-            rewrite$17[0][6] += 350;
-            { rewrite$16[0] = true; return; }
-        }
-    }
 
 
-    void myFun1_0_0_rewriteGroup5(int a) {
-        myFun1_0_0_rewriteGroup5_split10(a);
 
-        myFun1_0_0_rewriteGroup5_split11(a);
 
-    }
-    void myFun1_0_0_rewriteGroup5_split10(int a) {
 
-        rewrite$17[0][0] += 100;
-    }
 
-    void myFun1_0_0_rewriteGroup5_split11(int a) {
-        if (rewrite$18[1] > 0) {
-            myFun1_0_0_rewriteGroup1_2_rewriteGroup4(a);
-        } else {
-            rewrite$17[0][1] += 50;
-        }
-    }
 
 
-    void myFun1_0_0_rewriteGroup1_2_rewriteGroup4(int a) {
-        myFun1_0_0_rewriteGroup1_2_rewriteGroup4_split12(a);
 
-        myFun1_0_0_rewriteGroup1_2_rewriteGroup4_split13(a);
 
-    }
-    void myFun1_0_0_rewriteGroup1_2_rewriteGroup4_split12(int a) {
 
-        rewrite$17[0][1] += 100;
-    }
 
-    void myFun1_0_0_rewriteGroup1_2_rewriteGroup4_split13(int a) {
-        if (rewrite$18[2] > 0) {
-            rewrite$17[0][2] += 100;
-        } else {
-            rewrite$17[0][2] += 50;
-        }
-    }
 
 
+}
+void TestSplitJavaCode_split9(int[] b) {
+
+this.rewrite$27[0] = b;
+rewrite$28[0] = this.rewrite$27[0][0] + b[0];
+System.out.println("b0 = " + rewrite$28[0]);
+rewrite$28[1] = this.rewrite$27[0][1] + b[1];
+}
+
+void TestSplitJavaCode_split10(int[] b) {
+System.out.println("b1 = " + rewrite$28[1]);
+rewrite$28[2] = this.rewrite$27[0][2] + b[2];
+System.out.println("b2 = " + rewrite$28[2]);
+}
+
+void TestSplitJavaCode_split11(int[] b) {
+rewrite$28[3] = this.rewrite$27[0][3] + b[3];
+System.out.println("b3 = " + rewrite$28[3]);
+rewrite$28[4] = this.rewrite$27[0][4] + b[4];
+}
+
+void TestSplitJavaCode_split12(int[] b) {
+System.out.println("b4 = " + rewrite$28[4]);
+rewrite$28[5] = this.rewrite$27[0][5] + b[5];
+System.out.println("b5 = " + rewrite$28[5]);
+}
+
+void TestSplitJavaCode_split13(int[] b) {
+rewrite$28[6] = this.rewrite$27[0][6] + b[6];
+System.out.println("b6 = " + rewrite$28[6]);
+rewrite$28[7] = this.rewrite$27[0][7] + b[7];
+}
+
+void TestSplitJavaCode_split14(int[] b) {
+System.out.println("b7 = " + rewrite$28[7]);
+rewrite$28[8] = this.rewrite$27[0][8] + b[8];
+System.out.println("b8 = " + rewrite$28[8]);
+}
+
+void TestSplitJavaCode_split15(int[] b) {
+rewrite$28[9] = this.rewrite$27[0][9] + b[9];
+System.out.println("b9 = " + rewrite$28[9]);
+}
 
-    public int myFun2(int[] a) { myFun2Impl(a); return rewrite$18[4]; }
 
-    void myFun2Impl(int[] a) {
-        rewrite$16[1] = false;
-        myFun2Impl_split14(a);
+public void myFun1(int a) {
+rewrite$26[0] = false;
+myFun1_split16(a);
 
-        myFun2Impl_split15(a);
-        if (rewrite$16[1]) { return; }
+myFun1_split17(a);
 
+myFun1_split18(a);
 
+myFun1_split19(a);
+if (rewrite$26[0]) { return; }
 
 
 
-    }
-    void myFun2Impl_split14(int[] a) {
 
-        a[0] += 1;
-        a[1] += 2;
-        a[2] += 3;
-        a[3] += 4;
-        a[4] += 5;
-    }
 
-    void myFun2Impl_split15(int[] a) {
-        { rewrite$18[4] = a[0] + a[1] + a[2] + a[3] + a[4]; { rewrite$16[1] = true; return; } }
-    }
+
+
+
+}
+void myFun1_split16(int a) {
+
+this.rewrite$28[15] = a;
+rewrite$27[0][0] += rewrite$27[0][1];
+rewrite$27[0][1] += rewrite$27[0][2];
+rewrite$27[0][2] += rewrite$27[0][3];
+rewrite$28[10] = rewrite$27[0][0] + rewrite$27[0][1];
+rewrite$28[11] = rewrite$27[0][1] + rewrite$27[0][2];
+}
+
+void myFun1_split17(int a) {
+rewrite$28[12] = rewrite$27[0][2] + rewrite$27[0][0];
+}
+
+void myFun1_split18(int a) {
+for (int x : rewrite$27[0]) {rewrite$28[13] = x;
+System.out.println(rewrite$28[13] + rewrite$28[10] + rewrite$28[11] + rewrite$28[12]);
+}
+}
+
+void myFun1_split19(int a) {
+if (rewrite$28[10] > 0) {
+myFun1_0_0_rewriteGroup5(a);
+} else {
+rewrite$27[0][0] += 50;
+rewrite$27[0][1] += 100;
+rewrite$27[0][2] += 150;
+rewrite$27[0][3] += 200;
+rewrite$27[0][4] += 250;
+rewrite$27[0][5] += 300;
+rewrite$27[0][6] += 350;
+{ rewrite$26[0] = true; return; }
+}
+}
+
+
+void myFun1_0_0_rewriteGroup5(int a) {
+myFun1_0_0_rewriteGroup5_split20(a);
+
+myFun1_0_0_rewriteGroup5_split21(a);
+
+}
+void myFun1_0_0_rewriteGroup5_split20(int a) {
+
+rewrite$27[0][0] += 100;
+}
+
+void myFun1_0_0_rewriteGroup5_split21(int a) {
+if (rewrite$28[11] > 0) {
+myFun1_0_0_rewriteGroup1_2_rewriteGroup4(a);
+} else {
+rewrite$27[0][1] += 50;
+}
+}
+
+
+void myFun1_0_0_rewriteGroup1_2_rewriteGroup4(int a) {
+myFun1_0_0_rewriteGroup1_2_rewriteGroup4_split22(a);
+
+myFun1_0_0_rewriteGroup1_2_rewriteGroup4_split23(a);
+
+}
+void myFun1_0_0_rewriteGroup1_2_rewriteGroup4_split22(int a) {
+
+rewrite$27[0][1] += 100;
+}
+
+void myFun1_0_0_rewriteGroup1_2_rewriteGroup4_split23(int a) {
+if (rewrite$28[12] > 0) {
+rewrite$27[0][2] += 100;
+} else {
+rewrite$27[0][2] += 50;
+}
+}
+
+
+
+public int myFun2(int[] a) { myFun2Impl(a); return rewrite$28[14]; }
+
+void myFun2Impl(int[] a) {
+rewrite$26[1] = false;
+myFun2Impl_split24(a);
+
+myFun2Impl_split25(a);
+if (rewrite$26[1]) { return; }
+
+
+
+
+
+}
+void myFun2Impl_split24(int[] a) {
+
+a[0] += 1;
+a[1] += 2;
+a[2] += 3;
+a[3] += 4;
+a[4] += 5;
+}
+
+void myFun2Impl_split25(int[] a) {
+{ rewrite$28[14] = a[0] + a[1] + a[2] + a[3] + a[4]; { rewrite$26[1] = true; return; } }
+}
 
 }
