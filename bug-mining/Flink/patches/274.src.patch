diff --git a/flink-tests/src/test/java/org/apache/flink/test/actions/CountCollectITCase.java b/flink-tests/src/test/java/org/apache/flink/test/actions/CountCollectITCase.java
index c29b4f362dd..b4321057a45 100644
--- a/flink-tests/src/test/java/org/apache/flink/test/actions/CountCollectITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/test/actions/CountCollectITCase.java
@@ -22,35 +22,29 @@ import org.apache.flink.api.java.DataSet;
 import org.apache.flink.api.java.ExecutionEnvironment;
 import org.apache.flink.api.java.tuple.Tuple2;
 
-import java.io.PrintStream;
 import java.util.ArrayList;
 import java.util.HashMap;
 
 import static org.junit.Assert.*;
 
-import org.junit.BeforeClass;
+import org.apache.flink.test.util.MultipleProgramsTestBase;
 import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
 
 /**
  * Tests the methods that bring elements back to the client driver program.
  */
-public class CountCollectITCase {
+@RunWith(Parameterized.class)
+public class CountCollectITCase extends MultipleProgramsTestBase {
 
-	@BeforeClass
-	public static void suppressStandardOut() {
-		java.io.OutputStream blackhole = new java.io.OutputStream() {
-			@Override
-			public void write(int b){}
-		};
-
-		System.setOut(new PrintStream(blackhole));
-		System.setErr(new PrintStream(blackhole));
+	public CountCollectITCase(ExecutionMode mode) {
+		super(mode);
 	}
 
 	@Test
 	public void testSimple() throws Exception {
 		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
-		env.setDegreeOfParallelism(5);
 
 		Integer[] input = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
 
@@ -68,7 +62,6 @@ public class CountCollectITCase {
 	@Test
 	public void testAdvanced() throws Exception {
 		ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();
-		env.setDegreeOfParallelism(5);
 		env.getConfig().disableObjectReuse();
 
 
diff --git a/flink-tests/src/test/scala/org/apache/flink/api/scala/actions/CountCollectITCase.scala b/flink-tests/src/test/scala/org/apache/flink/api/scala/actions/CountCollectITCase.scala
index de20bc943c0..a1bbd2edbee 100644
--- a/flink-tests/src/test/scala/org/apache/flink/api/scala/actions/CountCollectITCase.scala
+++ b/flink-tests/src/test/scala/org/apache/flink/api/scala/actions/CountCollectITCase.scala
@@ -19,16 +19,20 @@
 package org.apache.flink.api.scala.actions
 
 import org.apache.flink.api.scala._
+import org.apache.flink.test.util.MultipleProgramsTestBase
+import org.apache.flink.test.util.MultipleProgramsTestBase.ExecutionMode
 
 import org.junit.Test
 import org.junit.Assert._
+import org.junit.runner.RunWith
+import org.junit.runners.Parameterized
 
-class CountCollectITCase {
+@RunWith(classOf[Parameterized])
+class CountCollectITCase(mode: ExecutionMode) extends MultipleProgramsTestBase(mode) {
 
   @Test
-  def testCountCollectOnSimpleJob: Unit = {
+  def testCountCollectOnSimpleJob(): Unit = {
     val env = ExecutionEnvironment.getExecutionEnvironment
-    env.setDegreeOfParallelism(5)
 
     val input = 1 to 10
 
@@ -44,9 +48,8 @@ class CountCollectITCase {
   }
 
   @Test
-  def testCountCollectOnAdvancedJob: Unit = {
+  def testCountCollectOnAdvancedJob(): Unit = {
     val env = ExecutionEnvironment.getExecutionEnvironment
-    env.setDegreeOfParallelism(5)
     env.getConfig.disableObjectReuse()
 
     val input1 = 1 to 10
@@ -69,5 +72,4 @@ class CountCollectITCase {
       marker(x-1)(y-1) = true
     }
   }
-
 }
