diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/AggFunctionTestBase.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/AggFunctionTestBase.java
index 6b46e567dc8..62023598c0a 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/AggFunctionTestBase.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/AggFunctionTestBase.java
@@ -18,12 +18,19 @@
 
 package org.apache.flink.table.planner.functions.aggfunctions;
 
+import org.apache.flink.api.common.ExecutionConfig;
+import org.apache.flink.api.common.typeinfo.TypeInformation;
+import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.java.tuple.Tuple2;
 import org.apache.flink.table.api.TableException;
+import org.apache.flink.table.dataformat.BinaryGeneric;
+import org.apache.flink.table.dataformat.GenericRow;
 import org.apache.flink.table.functions.AggregateFunction;
 import org.apache.flink.table.planner.functions.aggfunctions.MaxWithRetractAggFunction.MaxWithRetractAccumulator;
 import org.apache.flink.table.planner.functions.aggfunctions.MinWithRetractAggFunction.MinWithRetractAccumulator;
 import org.apache.flink.table.planner.functions.utils.UserDefinedFunctionUtils;
+import org.apache.flink.table.runtime.typeutils.BaseRowTypeInfo;
+import org.apache.flink.table.runtime.typeutils.BinaryGenericSerializer;
 import org.apache.flink.util.Preconditions;
 
 import org.junit.Test;
@@ -35,7 +42,9 @@ import java.util.ArrayList;
 import java.util.Collections;
 import java.util.List;
 
+import static org.apache.flink.table.utils.BinaryGenericAsserter.equivalent;
 import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertThat;
 
 /**
  * Base class for aggregate function test.
@@ -45,6 +54,29 @@ import static org.junit.Assert.assertEquals;
  */
 public abstract class AggFunctionTestBase<T, ACC> {
 
+	/**
+	 * Spec for parameterized aggregate function tests.
+	 */
+	protected static class AggFunctionTestSpec<T, ACC> {
+		final AggregateFunction<T, ACC> aggregator;
+		final List<List<T>> inputValueSets;
+		final List<T> expectedResults;
+
+		public AggFunctionTestSpec(
+				AggregateFunction<T, ACC> aggregator,
+				List<List<T>> inputValueSets,
+				List<T> expectedResults) {
+			this.aggregator = aggregator;
+			this.inputValueSets = inputValueSets;
+			this.expectedResults = expectedResults;
+		}
+
+		@Override
+		public String toString() {
+			return aggregator.getClass().getSimpleName();
+		}
+	}
+
 	protected abstract List<List<T>> getInputValueSets();
 
 	protected abstract List<T> getExpectedResults();
@@ -77,20 +109,20 @@ public abstract class AggFunctionTestBase<T, ACC> {
 			T expected = expectedResults.get(i);
 			ACC acc = accumulateValues(inputValues);
 			T result = aggregator.getValue(acc);
-			validateResult(expected, result);
+			validateResult(expected, result, aggregator.getAccumulatorType());
 
 			if (UserDefinedFunctionUtils.ifMethodExistInFunction("retract", aggregator)) {
 				retractValues(acc, inputValues);
 				ACC expectedAcc = aggregator.createAccumulator();
 				// The two accumulators should be exactly same
-				validateResult(expectedAcc, acc);
+				validateResult(expectedAcc, acc, aggregator.getAccumulatorType());
 			}
 		}
 	}
 
 	@Test
-	public void testAggregateWithMerge() throws NoSuchMethodException, InvocationTargetException,
-			IllegalAccessException {
+	public void testAggregateWithMerge()
+			throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {
 		AggregateFunction<T, ACC> aggregator = getAggregator();
 		if (UserDefinedFunctionUtils.ifMethodExistInFunction("merge", aggregator)) {
 			Method mergeFunc = aggregator.getClass().getMethod("merge", getAccClass(), Iterable.class);
@@ -115,14 +147,14 @@ public abstract class AggFunctionTestBase<T, ACC> {
 				mergeFunc.invoke(aggregator, (Object) acc, accumulators);
 
 				T result = aggregator.getValue(acc);
-				validateResult(expected, result);
+				validateResult(expected, result, aggregator.getResultType());
 
 				// 2. verify merge with accumulate & retract
 				if (UserDefinedFunctionUtils.ifMethodExistInFunction("retract", aggregator)) {
 					retractValues(acc, inputValues);
 					ACC expectedAcc = aggregator.createAccumulator();
 					// The two accumulators should be exactly same
-					validateResult(expectedAcc, acc);
+					validateResult(expectedAcc, acc, aggregator.getAccumulatorType());
 				}
 			}
 
@@ -138,13 +170,14 @@ public abstract class AggFunctionTestBase<T, ACC> {
 				mergeFunc.invoke(aggregator, (Object) acc, accumulators);
 
 				T result = aggregator.getValue(acc);
-				validateResult(expected, result);
+				validateResult(expected, result, aggregator.getResultType());
 			}
 		}
 	}
 
 	@Test
-	public void testMergeReservedAccumulator() throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {
+	public void testMergeReservedAccumulator()
+			throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {
 		AggregateFunction<T, ACC> aggregator = getAggregator();
 		boolean hasMerge = UserDefinedFunctionUtils.ifMethodExistInFunction("merge", aggregator);
 		boolean hasRetract = UserDefinedFunctionUtils.ifMethodExistInFunction("retract", aggregator);
@@ -180,7 +213,7 @@ public abstract class AggFunctionTestBase<T, ACC> {
 
 			// getValue
 			T result = aggregator.getValue(accWithSubset);
-			validateResult(expectedValue, result);
+			validateResult(expectedValue, result, aggregator.getResultType());
 		}
 	}
 
@@ -202,12 +235,12 @@ public abstract class AggFunctionTestBase<T, ACC> {
 				resetAccFunc.invoke(aggregator, (Object) acc);
 				ACC expectedAcc = aggregator.createAccumulator();
 				//The accumulator after reset should be exactly same as the new accumulator
-				validateResult(expectedAcc, acc);
+				validateResult(expectedAcc, acc, aggregator.getAccumulatorType());
 			}
 		}
 	}
 
-	protected <E> void validateResult(E expected, E result) {
+	protected <E> void validateResult(E expected, E result, TypeInformation<?> typeInfo) {
 		if (expected instanceof BigDecimal && result instanceof BigDecimal) {
 			// BigDecimal.equals() value and scale but we are only interested in value.
 			assertEquals(0, ((BigDecimal) expected).compareTo((BigDecimal) result));
@@ -223,11 +256,28 @@ public abstract class AggFunctionTestBase<T, ACC> {
 			MaxWithRetractAccumulator r = (MaxWithRetractAccumulator) result;
 			assertEquals(e.max, r.max);
 			assertEquals(e.mapSize, r.mapSize);
+		} else if (expected instanceof BinaryGeneric && result instanceof BinaryGeneric) {
+			TypeSerializer<?> serializer = typeInfo.createSerializer(new ExecutionConfig());
+			assertThat(
+					(BinaryGeneric) result,
+					equivalent((BinaryGeneric) expected, new BinaryGenericSerializer(serializer)));
+		} else if (expected instanceof GenericRow && result instanceof GenericRow) {
+			validateGenericRow((GenericRow) expected, (GenericRow) result, (BaseRowTypeInfo) typeInfo);
 		} else {
 			assertEquals(expected, result);
 		}
 	}
 
+	private void validateGenericRow(GenericRow expected, GenericRow result, BaseRowTypeInfo typeInfo) {
+		assertEquals(expected.getArity(), result.getArity());
+
+		for (int i = 0; i < expected.getArity(); ++i) {
+			Object expectedObj = expected.getField(i);
+			Object resultObj = result.getField(i);
+			validateResult(expectedObj, resultObj, typeInfo.getTypeAt(i));
+		}
+	}
+
 	protected ACC accumulateValues(List<T> values)
 			throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {
 		AggregateFunction<T, ACC> aggregator = getAggregator();
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstLastValueAggFunctionWithOrderTestBase.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstLastValueAggFunctionWithOrderTestBase.java
index 1b6bfeed307..06f84a5fadd 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstLastValueAggFunctionWithOrderTestBase.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstLastValueAggFunctionWithOrderTestBase.java
@@ -36,6 +36,23 @@ import java.util.List;
  */
 public abstract class FirstLastValueAggFunctionWithOrderTestBase<T> extends AggFunctionTestBase<T, GenericRow> {
 
+	/**
+	 * An AggFunctionTestSpec with input order.
+	 */
+	protected static class AggFunctionWithOrderTestSpec<T> extends AggFunctionTestSpec<T, GenericRow> {
+
+		final List<List<Long>> inputOrderSets;
+
+		public AggFunctionWithOrderTestSpec(
+				AggregateFunction<T, GenericRow> aggregator,
+				List<List<Long>> inputOrderSets,
+				List<List<T>> inputValueSets,
+				List<T> expectedResults) {
+			super(aggregator, inputValueSets, expectedResults);
+			this.inputOrderSets = inputOrderSets;
+		}
+	}
+
 	protected Method getAccumulateFunc() throws NoSuchMethodException {
 		return getAggregator().getClass().getMethod("accumulate", getAccClass(), Object.class, Long.class);
 	}
@@ -68,13 +85,13 @@ public abstract class FirstLastValueAggFunctionWithOrderTestBase<T> extends AggF
 			T expected = expectedResults.get(i);
 			GenericRow acc = accumulateValues(inputValues, inputOrders);
 			T result = aggregator.getValue(acc);
-			validateResult(expected, result);
+			validateResult(expected, result, aggregator.getResultType());
 
 			if (UserDefinedFunctionUtils.ifMethodExistInFunction("retract", aggregator)) {
 				retractValues(acc, inputValues, inputOrders);
 				GenericRow expectedAcc = aggregator.createAccumulator();
 				// The two accumulators should be exactly same
-				validateResult(expectedAcc, acc);
+				validateResult(expectedAcc, acc, aggregator.getAccumulatorType());
 			}
 		}
 	}
@@ -103,7 +120,7 @@ public abstract class FirstLastValueAggFunctionWithOrderTestBase<T> extends AggF
 				resetAccFunc.invoke(aggregator, (Object) acc);
 				GenericRow expectedAcc = aggregator.createAccumulator();
 				//The accumulator after reset should be exactly same as the new accumulator
-				validateResult(expectedAcc, acc);
+				validateResult(expectedAcc, acc, aggregator.getAccumulatorType());
 			}
 		}
 	}
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueAggFunctionWithOrderTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueAggFunctionWithOrderTest.java
index f72aa1be6d9..dbd9b8391cc 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueAggFunctionWithOrderTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueAggFunctionWithOrderTest.java
@@ -33,434 +33,357 @@ import org.apache.flink.table.planner.functions.aggfunctions.FirstValueAggFuncti
 import org.apache.flink.table.planner.functions.aggfunctions.FirstValueAggFunction.StringFirstValueAggFunction;
 import org.apache.flink.table.runtime.typeutils.DecimalTypeInfo;
 
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
 import java.util.Arrays;
 import java.util.List;
+import java.util.function.Function;
 
 /**
  * Test case for built-in FirstValue aggregate function.
  * This class tests `accumulate` method with order argument.
  */
-public abstract class FirstValueAggFunctionWithOrderTest<T> extends FirstLastValueAggFunctionWithOrderTestBase<T> {
-	/**
-	 * Test FirstValueAggFunction for number type.
-	 */
-	public abstract static class NumberFirstValueAggFunctionWithOrderTest<T>
-			extends FirstValueAggFunctionWithOrderTest<T> {
-		protected abstract T getValue(String v);
+@RunWith(Parameterized.class)
+public class FirstValueAggFunctionWithOrderTest<T> extends FirstLastValueAggFunctionWithOrderTestBase<T> {
 
-		@Override
-		protected List<List<T>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							getValue("1"),
-							null,
-							getValue("-99"),
-							getValue("3"),
-							null,
-							getValue("3"),
-							getValue("2"),
-							getValue("-99")
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							getValue("10"),
-							null,
-							getValue("5")
-					)
-			);
-		}
+	@Parameterized.Parameter
+	public AggFunctionWithOrderTestSpec<T> aggFunctionTestSpec;
 
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							6L,
-							11L,
-							3L,
-							7L,
-							5L
-					),
-					Arrays.asList(
-							8L,
-							6L,
-							9L,
-							5L
-					),
-					Arrays.asList(
-							null,
-							6L,
-							4L,
-							3L
-					)
-			);
-		}
+	private static final int DECIMAL_PRECISION = 20;
+	private static final int DECIMAL_SCALE = 6;
 
-		@Override
-		protected List<T> getExpectedResults() {
-			return Arrays.asList(
-					getValue("3"),
-					null,
-					getValue("5")
-			);
-		}
+	@Override
+	protected List<List<Long>> getInputOrderSets() {
+		return aggFunctionTestSpec.inputOrderSets;
 	}
 
-	/**
-	 * Test for ByteFirstValueAggFunction.
-	 */
-	public static class ByteFirstValueAggFunctionWithOrderTest
-			extends NumberFirstValueAggFunctionWithOrderTest<Byte> {
-
-		@Override
-		protected Byte getValue(String v) {
-			return Byte.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Byte, GenericRow> getAggregator() {
-			return new ByteFirstValueAggFunction();
-		}
+	@Override
+	protected List<List<T>> getInputValueSets() {
+		return aggFunctionTestSpec.inputValueSets;
 	}
 
-	/**
-	 * Test for ShortFirstValueAggFunction.
-	 */
-	public static class ShortFirstValueAggFunctionWithOrderTest
-			extends NumberFirstValueAggFunctionWithOrderTest<Short> {
-
-		@Override
-		protected Short getValue(String v) {
-			return Short.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Short, GenericRow> getAggregator() {
-			return new ShortFirstValueAggFunction();
-		}
+	@Override
+	protected List<T> getExpectedResults() {
+		return aggFunctionTestSpec.expectedResults;
 	}
 
-	/**
-	 * Test for IntFirstValueAggFunction.
-	 */
-	public static class IntFirstValueAggFunctionWithOrderTest
-			extends NumberFirstValueAggFunctionWithOrderTest<Integer> {
-
-		@Override
-		protected Integer getValue(String v) {
-			return Integer.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Integer, GenericRow> getAggregator() {
-			return new IntFirstValueAggFunction();
-		}
-	}
-
-	/**
-	 * Test for LongFirstValueAggFunction.
-	 */
-	public static class LongFirstValueAggFunctionWithOrderTest
-			extends NumberFirstValueAggFunctionWithOrderTest<Long> {
-
-		@Override
-		protected Long getValue(String v) {
-			return Long.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Long, GenericRow> getAggregator() {
-			return new LongFirstValueAggFunction();
-		}
-	}
-
-	/**
-	 * Test for FloatFirstValueAggFunction.
-	 */
-	public static class FloatFirstValueAggFunctionWithOrderTest
-			extends NumberFirstValueAggFunctionWithOrderTest<Float> {
-
-		@Override
-		protected Float getValue(String v) {
-			return Float.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Float, GenericRow> getAggregator() {
-			return new FloatFirstValueAggFunction();
-		}
+	@Override
+	protected AggregateFunction<T, GenericRow> getAggregator() {
+		return aggFunctionTestSpec.aggregator;
 	}
 
-	/**
-	 * Test for DoubleFirstValueAggFunction.
-	 */
-	public static class DoubleFirstValueAggFunctionWithOrderTest
-			extends NumberFirstValueAggFunctionWithOrderTest<Double> {
-
-		@Override
-		protected Double getValue(String v) {
-			return Double.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Double, GenericRow> getAggregator() {
-			return new DoubleFirstValueAggFunction();
-		}
+	@Parameterized.Parameters(name = "{index}: {0}")
+	public static List<AggFunctionTestSpec> testData() {
+		return Arrays.asList(
+				/**
+				 * Test for ByteFirstValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new ByteFirstValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Byte::valueOf),
+						numberExpectedResults(Byte::valueOf)
+				),
+				/**
+				 * Test for ShortFirstValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new ShortFirstValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Short::valueOf),
+						numberExpectedResults(Short::valueOf)
+				),
+				/**
+				 * Test for IntFirstValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new IntFirstValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Integer::valueOf),
+						numberExpectedResults(Integer::valueOf)
+				),
+				/**
+				 * Test for LongFirstValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new LongFirstValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Long::valueOf),
+						numberExpectedResults(Long::valueOf)
+				),
+				/**
+				 * Test for FloatFirstValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new FloatFirstValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Float::valueOf),
+						numberExpectedResults(Float::valueOf)
+				),
+				/**
+				 * Test for DoubleFirstValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new DoubleFirstValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Double::valueOf),
+						numberExpectedResults(Double::valueOf)
+				),
+				/**
+				 * Test for BooleanFirstValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new BooleanFirstValueAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										6L,
+										2L,
+										3L
+								),
+								Arrays.asList(
+										1L,
+										2L,
+										3L
+								),
+								Arrays.asList(
+										10L,
+										2L,
+										5L,
+										11L,
+										3L,
+										7L,
+										5L
+								),
+								Arrays.asList(
+										6L,
+										9L,
+										5L
+								),
+								Arrays.asList(
+										4L,
+										3L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										false,
+										false,
+										false
+								),
+								Arrays.asList(
+										true,
+										true,
+										true
+								),
+								Arrays.asList(
+										true,
+										false,
+										null,
+										true,
+										false,
+										true,
+										null
+								),
+								Arrays.asList(
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										true
+								)
+						),
+						Arrays.asList(
+								false,
+								true,
+								false,
+								null,
+								true
+						)
+				),
+				/**
+				 * Test for DecimalFirstValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new DecimalFirstValueAggFunction(DecimalTypeInfo.of(DECIMAL_PRECISION, DECIMAL_SCALE)),
+						Arrays.asList(
+								Arrays.asList(
+										10L,
+										2L,
+										1L,
+										5L,
+										null,
+										3L,
+										1L,
+										5L,
+										2L
+								),
+								Arrays.asList(
+										6L,
+										5L,
+										null,
+										8L,
+										null
+								),
+								Arrays.asList(
+										8L,
+										6L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("1000.000001", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.998999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+								)
+						),
+						Arrays.asList(
+								Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+								null,
+								Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+						)
+				),
+				/**
+				 * Test for StringFirstValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new StringFirstValueAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										10L,
+										2L,
+										5L,
+										null,
+										3L,
+										1L,
+										5L
+								),
+								Arrays.asList(
+										6L,
+										5L
+								),
+								Arrays.asList(
+										8L,
+										6L
+								),
+								Arrays.asList(
+										6L,
+										4L,
+										3L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("ghi"),
+										null,
+										BinaryString.fromString("jkl"),
+										null,
+										BinaryString.fromString("zzz")
+								),
+								Arrays.asList(
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										BinaryString.fromString("a")
+								),
+								Arrays.asList(
+										BinaryString.fromString("x"),
+										null,
+										BinaryString.fromString("e")
+								)
+						),
+						Arrays.asList(
+								BinaryString.fromString("def"),
+								null,
+								BinaryString.fromString("a"),
+								BinaryString.fromString("e")
+						)
+				)
+				);
 	}
 
-	/**
-	 * Test for BooleanFirstValueAggFunction.
-	 */
-	public static class BooleanFirstValueAggFunctionWithOrderTest
-			extends FirstValueAggFunctionWithOrderTest<Boolean> {
-
-		@Override
-		protected List<List<Boolean>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							false,
-							false,
-							false
-					),
-					Arrays.asList(
-							true,
-							true,
-							true
-					),
-					Arrays.asList(
-							true,
-							false,
-							null,
-							true,
-							false,
-							true,
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							true
-					));
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							6L,
-							2L,
-							3L
-					),
-					Arrays.asList(
-							1L,
-							2L,
-							3L
-					),
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							11L,
-							3L,
-							7L,
-							5L
-					),
-					Arrays.asList(
-							6L,
-							9L,
-							5L
-					),
-					Arrays.asList(
-							4L,
-							3L
-					)
-			);
-		}
-
-		@Override
-		protected List<Boolean> getExpectedResults() {
-			return Arrays.asList(
-					false,
-					true,
-					false,
-					null,
-					true
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Boolean, GenericRow> getAggregator() {
-			return new BooleanFirstValueAggFunction();
-		}
+	private static List<List<Long>> numberInputOrderSets() {
+		return Arrays.asList(
+				Arrays.asList(
+						10L,
+						2L,
+						5L,
+						6L,
+						11L,
+						3L,
+						7L,
+						5L
+				),
+				Arrays.asList(
+						8L,
+						6L,
+						9L,
+						5L
+				),
+				Arrays.asList(
+						null,
+						6L,
+						4L,
+						3L
+				)
+		);
 	}
 
-	/**
-	 * Test for DecimalFirstValueAggFunction.
-	 */
-	public static class DecimalFirstValueAggFunctionWithOrderTest
-			extends FirstValueAggFunctionWithOrderTest<Decimal> {
-
-		private int precision = 20;
-		private int scale = 6;
-
-		@Override
-		protected List<List<Decimal>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							Decimal.castFrom("1", precision, scale),
-							Decimal.castFrom("1000.000001", precision, scale),
-							Decimal.castFrom("-1", precision, scale),
-							Decimal.castFrom("-999.998999", precision, scale),
-							null,
-							Decimal.castFrom("0", precision, scale),
-							Decimal.castFrom("-999.999", precision, scale),
-							null,
-							Decimal.castFrom("999.999", precision, scale)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							Decimal.castFrom("0", precision, scale)
-					)
-			);
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							1L,
-							5L,
-							null,
-							3L,
-							1L,
-							5L,
-							2L
-					),
-					Arrays.asList(
-							6L,
-							5L,
-							null,
-							8L,
-							null
-					),
-					Arrays.asList(
-							8L,
-							6L
-					)
-			);
-		}
-
-		@Override
-		protected List<Decimal> getExpectedResults() {
-			return Arrays.asList(
-					Decimal.castFrom("-1", precision, scale),
-					null,
-					Decimal.castFrom("0", precision, scale)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Decimal, GenericRow> getAggregator() {
-			return new DecimalFirstValueAggFunction(DecimalTypeInfo.of(precision, scale));
-		}
+	private static <N> List<List<N>> numberInputValueSets(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				Arrays.asList(
+						strToValueFun.apply("1"),
+						null,
+						strToValueFun.apply("-99"),
+						strToValueFun.apply("3"),
+						null,
+						strToValueFun.apply("3"),
+						strToValueFun.apply("2"),
+						strToValueFun.apply("-99")
+				),
+				Arrays.asList(
+						null,
+						null,
+						null,
+						null
+				),
+				Arrays.asList(
+						null,
+						strToValueFun.apply("10"),
+						null,
+						strToValueFun.apply("5")
+				)
+		);
 	}
 
-	/**
-	 * Test for StringFirstValueAggFunction.
-	 */
-	public static class StringFirstValueAggFunctionWithOrderTest
-			extends FirstValueAggFunctionWithOrderTest<BinaryString> {
-
-		@Override
-		protected List<List<BinaryString>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("ghi"),
-							null,
-							BinaryString.fromString("jkl"),
-							null,
-							BinaryString.fromString("zzz")
-					),
-					Arrays.asList(
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							BinaryString.fromString("a")
-					),
-					Arrays.asList(
-							BinaryString.fromString("x"),
-							null,
-							BinaryString.fromString("e")
-					)
-			);
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							null,
-							3L,
-							1L,
-							5L
-					),
-					Arrays.asList(
-							6L,
-							5L
-					),
-					Arrays.asList(
-							8L,
-							6L
-					),
-					Arrays.asList(
-							6L,
-							4L,
-							3L
-					)
-			);
-		}
-
-		@Override
-		protected List<BinaryString> getExpectedResults() {
-			return Arrays.asList(
-					BinaryString.fromString("def"),
-					null,
-					BinaryString.fromString("a"),
-					BinaryString.fromString("e")
-			);
-		}
-
-		@Override
-		protected AggregateFunction<BinaryString, GenericRow> getAggregator() {
-			return new StringFirstValueAggFunction();
-		}
+	private static <N> List<N> numberExpectedResults(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				strToValueFun.apply("3"),
+				null,
+				strToValueFun.apply("5")
+		);
 	}
 }
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueAggFunctionWithoutOrderTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueAggFunctionWithoutOrderTest.java
index d72b38fb330..3bfe52a3009 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueAggFunctionWithoutOrderTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueAggFunctionWithoutOrderTest.java
@@ -33,319 +33,243 @@ import org.apache.flink.table.planner.functions.aggfunctions.FirstValueAggFuncti
 import org.apache.flink.table.planner.functions.aggfunctions.FirstValueAggFunction.StringFirstValueAggFunction;
 import org.apache.flink.table.runtime.typeutils.DecimalTypeInfo;
 
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
 import java.util.Arrays;
 import java.util.List;
+import java.util.function.Function;
 
 /**
  * Test case for built-in FirstValue aggregate function.
  * This class tests `accumulate` method without order argument.
  */
-public abstract class FirstValueAggFunctionWithoutOrderTest<T> extends AggFunctionTestBase<T, GenericRow> {
-
-	@Override
-	protected Class<?> getAccClass() {
-		return GenericRow.class;
-	}
-
-	/**
-	 * Test FirstValueAggFunction for number type.
-	 */
-	public abstract static class NumberFirstValueAggFunctionWithoutOrderTest<T>
-			extends FirstValueAggFunctionWithoutOrderTest<T> {
-		protected abstract T getValue(String v);
-
-		@Override
-		protected List<List<T>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							getValue("1"),
-							null,
-							getValue("-99"),
-							getValue("3"),
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							getValue("10"),
-							null,
-							getValue("3")
-					)
-			);
-		}
-
-		@Override
-		protected List<T> getExpectedResults() {
-			return Arrays.asList(
-					getValue("1"),
-					null,
-					getValue("10")
-			);
-		}
-	}
+@RunWith(Parameterized.class)
+public class FirstValueAggFunctionWithoutOrderTest<T> extends AggFunctionTestBase<T, GenericRow> {
 
-	/**
-	 * Test for ByteFirstValueAggFunction.
-	 */
-	public static class ByteFirstValueAggFunctionWithoutOrderTest
-			extends NumberFirstValueAggFunctionWithoutOrderTest<Byte> {
+	@Parameterized.Parameter
+	public AggFunctionTestSpec<T, GenericRow> aggFunctionTestSpec;
 
-		@Override
-		protected Byte getValue(String v) {
-			return Byte.valueOf(v);
-		}
+	private static final int DECIMAL_PRECISION = 20;
+	private static final int DECIMAL_SCALE = 6;
 
-		@Override
-		protected AggregateFunction<Byte, GenericRow> getAggregator() {
-			return new ByteFirstValueAggFunction();
-		}
-	}
-
-	/**
-	 * Test for ShortFirstValueAggFunction.
-	 */
-	public static class ShortFirstValueAggFunctionWithoutOrderTest
-			extends NumberFirstValueAggFunctionWithoutOrderTest<Short> {
-
-		@Override
-		protected Short getValue(String v) {
-			return Short.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Short, GenericRow> getAggregator() {
-			return new ShortFirstValueAggFunction();
-		}
-	}
-
-	/**
-	 * Test for IntFirstValueAggFunction.
-	 */
-	public static class IntFirstValueAggFunctionWithoutOrderTest
-			extends NumberFirstValueAggFunctionWithoutOrderTest<Integer> {
-
-		@Override
-		protected Integer getValue(String v) {
-			return Integer.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Integer, GenericRow> getAggregator() {
-			return new IntFirstValueAggFunction();
-		}
+	@Override
+	protected List<List<T>> getInputValueSets() {
+		return aggFunctionTestSpec.inputValueSets;
 	}
 
-	/**
-	 * Test for LongFirstValueAggFunction.
-	 */
-	public static class LongFirstValueAggFunctionWithoutOrderTest
-			extends NumberFirstValueAggFunctionWithoutOrderTest<Long> {
-
-		@Override
-		protected Long getValue(String v) {
-			return Long.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Long, GenericRow> getAggregator() {
-			return new LongFirstValueAggFunction();
-		}
+	@Override
+	protected List<T> getExpectedResults() {
+		return aggFunctionTestSpec.expectedResults;
 	}
 
-	/**
-	 * Test for FloatFirstValueAggFunction.
-	 */
-	public static class FloatFirstValueAggFunctionWithoutOrderTest
-			extends NumberFirstValueAggFunctionWithoutOrderTest<Float> {
-
-		@Override
-		protected Float getValue(String v) {
-			return Float.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Float, GenericRow> getAggregator() {
-			return new FloatFirstValueAggFunction();
-		}
+	@Override
+	protected AggregateFunction<T, GenericRow> getAggregator() {
+		return aggFunctionTestSpec.aggregator;
 	}
 
-	/**
-	 * Test for DoubleFirstValueAggFunction.
-	 */
-	public static class DoubleFirstValueAggFunctionWithoutOrderTest
-			extends NumberFirstValueAggFunctionWithoutOrderTest<Double> {
-
-		@Override
-		protected Double getValue(String v) {
-			return Double.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Double, GenericRow> getAggregator() {
-			return new DoubleFirstValueAggFunction();
-		}
+	@Override
+	protected Class<?> getAccClass() {
+		return GenericRow.class;
 	}
 
-	/**
-	 * Test for BooleanFirstValueAggFunction.
-	 */
-	public static class BooleanFirstValueAggFunctionWithoutOrderTest extends
-			FirstValueAggFunctionWithoutOrderTest<Boolean> {
-
-		@Override
-		protected List<List<Boolean>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							false,
-							false,
-							false
-					),
-					Arrays.asList(
-							true,
-							true,
-							true
-					),
-					Arrays.asList(
-							true,
-							false,
-							null,
-							true,
-							false,
-							true,
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							true
-					));
-		}
-
-		@Override
-		protected List<Boolean> getExpectedResults() {
-			return Arrays.asList(
-					false,
-					true,
-					true,
-					null,
-					true
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Boolean, GenericRow> getAggregator() {
-			return new BooleanFirstValueAggFunction();
-		}
+	@Parameterized.Parameters(name = "{index}: {0}")
+	public static List<AggFunctionTestSpec> testData() {
+		return Arrays.asList(
+				/**
+				 * Test for ByteFirstValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ByteFirstValueAggFunction(),
+						numberInputValueSets(Byte::valueOf),
+						numberExpectedResults(Byte::valueOf)
+				),
+				/**
+				 * Test for ShortFirstValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ShortFirstValueAggFunction(),
+						numberInputValueSets(Short::valueOf),
+						numberExpectedResults(Short::valueOf)
+				),
+				/**
+				 * Test for IntFirstValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new IntFirstValueAggFunction(),
+						numberInputValueSets(Integer::valueOf),
+						numberExpectedResults(Integer::valueOf)
+				),
+				/**
+				 * Test for LongFirstValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new LongFirstValueAggFunction(),
+						numberInputValueSets(Long::valueOf),
+						numberExpectedResults(Long::valueOf)
+				),
+				/**
+				 * Test for FloatFirstValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new FloatFirstValueAggFunction(),
+						numberInputValueSets(Float::valueOf),
+						numberExpectedResults(Float::valueOf)
+				),
+				/**
+				 * Test for DoubleFirstValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DoubleFirstValueAggFunction(),
+						numberInputValueSets(Double::valueOf),
+						numberExpectedResults(Double::valueOf)
+				),
+				/**
+				 * Test for BooleanFirstValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new BooleanFirstValueAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										false,
+										false,
+										false
+								),
+								Arrays.asList(
+										true,
+										true,
+										true
+								),
+								Arrays.asList(
+										true,
+										false,
+										null,
+										true,
+										false,
+										true,
+										null
+								),
+								Arrays.asList(
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										true
+								)
+						),
+						Arrays.asList(
+								false,
+								true,
+								true,
+								null,
+								true
+						)
+				),
+				/**
+				 * Test for DecimalFirstValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DecimalFirstValueAggFunction(DecimalTypeInfo.of(DECIMAL_PRECISION, DECIMAL_SCALE)),
+						Arrays.asList(
+								Arrays.asList(
+										Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("1000.000001", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.998999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+								)
+						),
+						Arrays.asList(
+								Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+								null,
+								Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+						)
+				),
+				/**
+				 * Test for StringFirstValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new StringFirstValueAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("ghi"),
+										null,
+										BinaryString.fromString("jkl"),
+										null,
+										BinaryString.fromString("zzz")
+								),
+								Arrays.asList(
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										BinaryString.fromString("a")
+								),
+								Arrays.asList(
+										BinaryString.fromString("x"),
+										null,
+										BinaryString.fromString("e")
+								)
+						),
+						Arrays.asList(
+								BinaryString.fromString("abc"),
+								null,
+								BinaryString.fromString("a"),
+								BinaryString.fromString("x")
+						)
+				)
+		);
 	}
 
-	/**
-	 * Test for DecimalFirstValueAggFunction.
-	 */
-	public static class DecimalFirstValueAggFunctionWithoutOrderTest extends
-			FirstValueAggFunctionWithoutOrderTest<Decimal> {
-
-		private int precision = 20;
-		private int scale = 6;
-
-		@Override
-		protected List<List<Decimal>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							Decimal.castFrom("1", precision, scale),
-							Decimal.castFrom("1000.000001", precision, scale),
-							Decimal.castFrom("-1", precision, scale),
-							Decimal.castFrom("-999.998999", precision, scale),
-							null,
-							Decimal.castFrom("0", precision, scale),
-							Decimal.castFrom("-999.999", precision, scale),
-							null,
-							Decimal.castFrom("999.999", precision, scale)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							Decimal.castFrom("0", precision, scale)
-					)
-			);
-		}
-
-		@Override
-		protected List<Decimal> getExpectedResults() {
-			return Arrays.asList(
-					Decimal.castFrom("1", precision, scale),
-					null,
-					Decimal.castFrom("0", precision, scale)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Decimal, GenericRow> getAggregator() {
-			return new DecimalFirstValueAggFunction(DecimalTypeInfo.of(precision, scale));
-		}
+	private static <N> List<List<N>> numberInputValueSets(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				Arrays.asList(
+						strToValueFun.apply("1"),
+						null,
+						strToValueFun.apply("-99"),
+						strToValueFun.apply("3"),
+						null
+				),
+				Arrays.asList(
+						null,
+						null,
+						null,
+						null
+				),
+				Arrays.asList(
+						null,
+						strToValueFun.apply("10"),
+						null,
+						strToValueFun.apply("3")
+				)
+		);
 	}
 
-	/**
-	 * Test for StringFirstValueAggFunction.
-	 */
-	public static class StringFirstValueAggFunctionWithoutOrderTest extends
-			FirstValueAggFunctionWithoutOrderTest<BinaryString> {
-
-		@Override
-		protected List<List<BinaryString>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("ghi"),
-							null,
-							BinaryString.fromString("jkl"),
-							null,
-							BinaryString.fromString("zzz")
-					),
-					Arrays.asList(
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							BinaryString.fromString("a")
-					),
-					Arrays.asList(
-							BinaryString.fromString("x"),
-							null,
-							BinaryString.fromString("e")
-					)
-			);
-		}
-
-		@Override
-		protected List<BinaryString> getExpectedResults() {
-			return Arrays.asList(
-					BinaryString.fromString("abc"),
-					null,
-					BinaryString.fromString("a"),
-					BinaryString.fromString("x")
-			);
-		}
-
-		@Override
-		protected AggregateFunction<BinaryString, GenericRow> getAggregator() {
-			return new StringFirstValueAggFunction();
-		}
+	private static <N> List<N> numberExpectedResults(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				strToValueFun.apply("1"),
+				null,
+				strToValueFun.apply("10")
+		);
 	}
 }
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueWithRetractAggFunctionWithOrderTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueWithRetractAggFunctionWithOrderTest.java
index e685e02353d..caf14857901 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueWithRetractAggFunctionWithOrderTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueWithRetractAggFunctionWithOrderTest.java
@@ -33,442 +33,364 @@ import org.apache.flink.table.planner.functions.aggfunctions.FirstValueWithRetra
 import org.apache.flink.table.planner.functions.aggfunctions.FirstValueWithRetractAggFunction.StringFirstValueWithRetractAggFunction;
 import org.apache.flink.table.runtime.typeutils.DecimalTypeInfo;
 
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
 import java.lang.reflect.Method;
 import java.util.Arrays;
 import java.util.List;
+import java.util.function.Function;
 
 /**
  * Test case for built-in FirstValue with retract aggregate function.
  * This class tests `accumulate` method with order argument.
  */
-public abstract class FirstValueWithRetractAggFunctionWithOrderTest<T>
-		extends FirstLastValueAggFunctionWithOrderTestBase<T> {
-
-	@Override
-	protected Method getRetractFunc() throws NoSuchMethodException {
-		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class, Long.class);
-	}
-
-	/**
-	 * Test FirstValueWithRetractAggFunction for number type.
-	 */
-	public abstract static class NumberFirstValueWithRetractAggFunctionWithOrderTest<T>
-			extends FirstValueWithRetractAggFunctionWithOrderTest<T> {
-		protected abstract T getValue(String v);
-
-		@Override
-		protected List<List<T>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							getValue("1"),
-							null,
-							getValue("-99"),
-							getValue("3"),
-							null,
-							getValue("3"),
-							getValue("2"),
-							getValue("-99")
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							getValue("10"),
-							null,
-							getValue("5")
-					)
-			);
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							6L,
-							11L,
-							3L,
-							7L,
-							5L
-					),
-					Arrays.asList(
-							8L,
-							6L,
-							9L,
-							5L
-					),
-					Arrays.asList(
-							null,
-							6L,
-							4L,
-							3L
-					)
-			);
-		}
-
-		@Override
-		protected List<T> getExpectedResults() {
-			return Arrays.asList(
-					getValue("3"),
-					null,
-					getValue("5")
-			);
-		}
-	}
+@RunWith(Parameterized.class)
+public class FirstValueWithRetractAggFunctionWithOrderTest<T> extends FirstLastValueAggFunctionWithOrderTestBase<T> {
 
-	/**
-	 * Test for ByteFirstValueWithRetractAggFunction.
-	 */
-	public static class ByteFirstValueWithRetractAggFunctionWithOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithOrderTest<Byte> {
+	@Parameterized.Parameter
+	public AggFunctionWithOrderTestSpec<T> aggFunctionTestSpec;
 
-		@Override
-		protected Byte getValue(String v) {
-			return Byte.valueOf(v);
-		}
+	private static final int DECIMAL_PRECISION = 20;
+	private static final int DECIMAL_SCALE = 6;
 
-		@Override
-		protected AggregateFunction<Byte, GenericRow> getAggregator() {
-			return new ByteFirstValueWithRetractAggFunction();
-		}
+	@Override
+	protected List<List<Long>> getInputOrderSets() {
+		return aggFunctionTestSpec.inputOrderSets;
 	}
 
-	/**
-	 * Test for ShortFirstValueWithRetractAggFunction.
-	 */
-	public static class ShortFirstValueWithRetractAggFunctionWithOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithOrderTest<Short> {
-
-		@Override
-		protected Short getValue(String v) {
-			return Short.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Short, GenericRow> getAggregator() {
-			return new ShortFirstValueWithRetractAggFunction();
-		}
+	@Override
+	protected List<List<T>> getInputValueSets() {
+		return aggFunctionTestSpec.inputValueSets;
 	}
 
-	/**
-	 * Test for IntFirstValueWithRetractAggFunction.
-	 */
-	public static class IntFirstValueWithRetractAggFunctionWithOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithOrderTest<Integer> {
-
-		@Override
-		protected Integer getValue(String v) {
-			return Integer.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Integer, GenericRow> getAggregator() {
-			return new IntFirstValueWithRetractAggFunction();
-		}
+	@Override
+	protected List<T> getExpectedResults() {
+		return aggFunctionTestSpec.expectedResults;
 	}
 
-	/**
-	 * Test for LongFirstValueWithRetractAggFunction.
-	 */
-	public static class LongFirstValueWithRetractAggFunctionWithOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithOrderTest<Long> {
-
-		@Override
-		protected Long getValue(String v) {
-			return Long.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Long, GenericRow> getAggregator() {
-			return new LongFirstValueWithRetractAggFunction();
-		}
+	@Override
+	protected AggregateFunction<T, GenericRow> getAggregator() {
+		return aggFunctionTestSpec.aggregator;
 	}
 
-	/**
-	 * Test for FloatFirstValueWithRetractAggFunction.
-	 */
-	public static class FloatFirstValueWithRetractAggFunctionWithOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithOrderTest<Float> {
-
-		@Override
-		protected Float getValue(String v) {
-			return Float.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Float, GenericRow> getAggregator() {
-			return new FloatFirstValueWithRetractAggFunction();
-		}
+	@Override
+	protected Method getRetractFunc() throws NoSuchMethodException {
+		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class, Long.class);
 	}
 
-	/**
-	 * Test for DoubleFirstValueWithRetractAggFunction.
-	 */
-	public static class DoubleFirstValueWithRetractAggFunctionWithOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithOrderTest<Double> {
-
-		@Override
-		protected Double getValue(String v) {
-			return Double.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Double, GenericRow> getAggregator() {
-			return new DoubleFirstValueWithRetractAggFunction();
-		}
+	@Parameterized.Parameters(name = "{index}: {0}")
+	public static List<AggFunctionTestSpec> testData() {
+		return Arrays.asList(
+				/**
+				 * Test for ByteFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new ByteFirstValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Byte::valueOf),
+						numberExpectedResults(Byte::valueOf)
+				),
+				/**
+				 * Test for ShortFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new ShortFirstValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Short::valueOf),
+						numberExpectedResults(Short::valueOf)
+				),
+				/**
+				 * Test for IntFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new IntFirstValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Integer::valueOf),
+						numberExpectedResults(Integer::valueOf)
+				),
+				/**
+				 * Test for LongFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new LongFirstValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Long::valueOf),
+						numberExpectedResults(Long::valueOf)
+				),
+				/**
+				 * Test for FloatFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new FloatFirstValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Float::valueOf),
+						numberExpectedResults(Float::valueOf)
+				),
+				/**
+				 * Test for DoubleFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new DoubleFirstValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Double::valueOf),
+						numberExpectedResults(Double::valueOf)
+				),
+				/**
+				 * Test for BooleanFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new BooleanFirstValueWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										6L,
+										2L,
+										3L
+								),
+								Arrays.asList(
+										1L,
+										2L,
+										3L
+								),
+								Arrays.asList(
+										10L,
+										2L,
+										5L,
+										11L,
+										3L,
+										7L,
+										5L
+								),
+								Arrays.asList(
+										6L,
+										9L,
+										5L
+								),
+								Arrays.asList(
+										4L,
+										3L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										false,
+										false,
+										false
+								),
+								Arrays.asList(
+										true,
+										true,
+										true
+								),
+								Arrays.asList(
+										true,
+										false,
+										null,
+										true,
+										false,
+										true,
+										null
+								),
+								Arrays.asList(
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										true
+								)
+						),
+						Arrays.asList(
+								false,
+								true,
+								false,
+								null,
+								true
+						)
+				),
+				/**
+				 * Test for DecimalFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new DecimalFirstValueWithRetractAggFunction(
+								DecimalTypeInfo.of(DECIMAL_PRECISION, DECIMAL_SCALE)),
+						Arrays.asList(
+								Arrays.asList(
+										10L,
+										2L,
+										1L,
+										5L,
+										null,
+										3L,
+										1L,
+										5L,
+										2L
+								),
+								Arrays.asList(
+										6L,
+										5L,
+										null,
+										8L,
+										null
+								),
+								Arrays.asList(
+										8L,
+										6L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("1000.000001", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.998999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+								)
+						),
+						Arrays.asList(
+								Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+								null,
+								Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+						)
+				),
+				/**
+				 * Test for StringFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new StringFirstValueWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										10L,
+										2L,
+										5L,
+										null,
+										3L,
+										1L,
+										5L
+								),
+								Arrays.asList(
+										6L,
+										5L
+								),
+								Arrays.asList(
+										8L,
+										6L
+								),
+								Arrays.asList(
+										6L,
+										4L,
+										3L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("ghi"),
+										null,
+										BinaryString.fromString("jkl"),
+										null,
+										BinaryString.fromString("zzz")
+								),
+								Arrays.asList(
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										BinaryString.fromString("a")
+								),
+								Arrays.asList(
+										BinaryString.fromString("x"),
+										null,
+										BinaryString.fromString("e")
+								)
+						),
+						Arrays.asList(
+								BinaryString.fromString("def"),
+								null,
+								BinaryString.fromString("a"),
+								BinaryString.fromString("e")
+						)
+				)
+		);
 	}
 
-	/**
-	 * Test for BooleanFirstValueWithRetractAggFunction.
-	 */
-	public static class BooleanFirstValueWithRetractAggFunctionWithOrderTest
-			extends FirstValueWithRetractAggFunctionWithOrderTest<Boolean> {
-
-		@Override
-		protected List<List<Boolean>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							false,
-							false,
-							false
-					),
-					Arrays.asList(
-							true,
-							true,
-							true
-					),
-					Arrays.asList(
-							true,
-							false,
-							null,
-							true,
-							false,
-							true,
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							true
-					));
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							6L,
-							2L,
-							3L
-					),
-					Arrays.asList(
-							1L,
-							2L,
-							3L
-					),
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							11L,
-							3L,
-							7L,
-							5L
-					),
-					Arrays.asList(
-							6L,
-							9L,
-							5L
-					),
-					Arrays.asList(
-							4L,
-							3L
-					)
-			);
-		}
-
-		@Override
-		protected List<Boolean> getExpectedResults() {
-			return Arrays.asList(
-					false,
-					true,
-					false,
-					null,
-					true
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Boolean, GenericRow> getAggregator() {
-			return new BooleanFirstValueWithRetractAggFunction();
-		}
+	private static List<List<Long>> numberInputOrderSets() {
+		return Arrays.asList(
+				Arrays.asList(
+						10L,
+						2L,
+						5L,
+						6L,
+						11L,
+						3L,
+						7L,
+						5L
+				),
+				Arrays.asList(
+						8L,
+						6L,
+						9L,
+						5L
+				),
+				Arrays.asList(
+						null,
+						6L,
+						4L,
+						3L
+				)
+		);
 	}
 
-	/**
-	 * Test for DecimalFirstValueWithRetractAggFunction.
-	 */
-	public static class DecimalFirstValueWithRetractAggFunctionWithOrderTest
-			extends FirstValueWithRetractAggFunctionWithOrderTest<Decimal> {
-
-		private int precision = 20;
-		private int scale = 6;
-
-		@Override
-		protected List<List<Decimal>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							Decimal.castFrom("1", precision, scale),
-							Decimal.castFrom("1000.000001", precision, scale),
-							Decimal.castFrom("-1", precision, scale),
-							Decimal.castFrom("-999.998999", precision, scale),
-							null,
-							Decimal.castFrom("0", precision, scale),
-							Decimal.castFrom("-999.999", precision, scale),
-							null,
-							Decimal.castFrom("999.999", precision, scale)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							Decimal.castFrom("0", precision, scale)
-					)
-			);
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							1L,
-							5L,
-							null,
-							3L,
-							1L,
-							5L,
-							2L
-					),
-					Arrays.asList(
-							6L,
-							5L,
-							null,
-							8L,
-							null
-					),
-					Arrays.asList(
-							8L,
-							6L
-					)
-			);
-		}
-
-		@Override
-		protected List<Decimal> getExpectedResults() {
-			return Arrays.asList(
-					Decimal.castFrom("-1", precision, scale),
-					null,
-					Decimal.castFrom("0", precision, scale)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Decimal, GenericRow> getAggregator() {
-			return new DecimalFirstValueWithRetractAggFunction(DecimalTypeInfo.of(precision, scale));
-		}
+	private static <N> List<List<N>> numberInputValueSets(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				Arrays.asList(
+						strToValueFun.apply("1"),
+						null,
+						strToValueFun.apply("-99"),
+						strToValueFun.apply("3"),
+						null,
+						strToValueFun.apply("3"),
+						strToValueFun.apply("2"),
+						strToValueFun.apply("-99")
+				),
+				Arrays.asList(
+						null,
+						null,
+						null,
+						null
+				),
+				Arrays.asList(
+						null,
+						strToValueFun.apply("10"),
+						null,
+						strToValueFun.apply("5")
+				)
+		);
 	}
 
-	/**
-	 * Test for StringFirstValueWithRetractAggFunction.
-	 */
-	public static class StringFirstValueWithRetractAggFunctionWithOrderTest
-			extends FirstValueWithRetractAggFunctionWithOrderTest<BinaryString> {
-
-		@Override
-		protected List<List<BinaryString>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("ghi"),
-							null,
-							BinaryString.fromString("jkl"),
-							null,
-							BinaryString.fromString("zzz")
-					),
-					Arrays.asList(
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							BinaryString.fromString("a")
-					),
-					Arrays.asList(
-							BinaryString.fromString("x"),
-							null,
-							BinaryString.fromString("e")
-					)
-			);
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							null,
-							3L,
-							1L,
-							5L
-					),
-					Arrays.asList(
-							6L,
-							5L
-					),
-					Arrays.asList(
-							8L,
-							6L
-					),
-					Arrays.asList(
-							6L,
-							4L,
-							3L
-					)
-			);
-		}
-
-		@Override
-		protected List<BinaryString> getExpectedResults() {
-			return Arrays.asList(
-					BinaryString.fromString("def"),
-					null,
-					BinaryString.fromString("a"),
-					BinaryString.fromString("e")
-			);
-		}
-
-		@Override
-		protected AggregateFunction<BinaryString, GenericRow> getAggregator() {
-			return new StringFirstValueWithRetractAggFunction();
-		}
+	private static <N> List<N> numberExpectedResults(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				strToValueFun.apply("3"),
+				null,
+				strToValueFun.apply("5")
+		);
 	}
 }
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueWithRetractAggFunctionWithoutOrderTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueWithRetractAggFunctionWithoutOrderTest.java
index d14c31237d6..386f80302e6 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueWithRetractAggFunctionWithoutOrderTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/FirstValueWithRetractAggFunctionWithoutOrderTest.java
@@ -33,325 +33,250 @@ import org.apache.flink.table.planner.functions.aggfunctions.FirstValueWithRetra
 import org.apache.flink.table.planner.functions.aggfunctions.FirstValueWithRetractAggFunction.StringFirstValueWithRetractAggFunction;
 import org.apache.flink.table.runtime.typeutils.DecimalTypeInfo;
 
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
 import java.lang.reflect.Method;
 import java.util.Arrays;
 import java.util.List;
+import java.util.function.Function;
 
 /**
  * Test case for built-in FirstValue with retract aggregate function.
  * This class tests `accumulate` method without order argument.
  */
-public abstract class FirstValueWithRetractAggFunctionWithoutOrderTest<T> extends AggFunctionTestBase<T, GenericRow> {
-
-	@Override
-	protected Class<?> getAccClass() {
-		return GenericRow.class;
-	}
+@RunWith(Parameterized.class)
+public class FirstValueWithRetractAggFunctionWithoutOrderTest<T> extends AggFunctionTestBase<T, GenericRow> {
 
-	@Override
-	protected Method getRetractFunc() throws NoSuchMethodException {
-		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class);
-	}
-
-	/**
-	 * Test FirstValueWithRetractAggFunction for number type.
-	 */
-	public abstract static class NumberFirstValueWithRetractAggFunctionWithoutOrderTest<T>
-			extends FirstValueWithRetractAggFunctionWithoutOrderTest<T> {
-		protected abstract T getValue(String v);
+	@Parameterized.Parameter
+	public AggFunctionTestSpec<T, GenericRow> aggFunctionTestSpec;
 
-		@Override
-		protected List<List<T>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							getValue("1"),
-							null,
-							getValue("-99"),
-							getValue("3"),
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							getValue("10"),
-							null,
-							getValue("3")
-					)
-			);
-		}
+	private static final int DECIMAL_PRECISION = 20;
+	private static final int DECIMAL_SCALE = 6;
 
-		@Override
-		protected List<T> getExpectedResults() {
-			return Arrays.asList(
-					getValue("1"),
-					null,
-					getValue("10")
-			);
-		}
-	}
-
-	/**
-	 * Test for ByteFirstValueWithRetractAggFunction.
-	 */
-	public static class ByteFirstValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithoutOrderTest<Byte> {
-
-		@Override
-		protected Byte getValue(String v) {
-			return Byte.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Byte, GenericRow> getAggregator() {
-			return new ByteFirstValueWithRetractAggFunction();
-		}
-	}
-
-	/**
-	 * Test for ShortFirstValueWithRetractAggFunction.
-	 */
-	public static class ShortFirstValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithoutOrderTest<Short> {
-
-		@Override
-		protected Short getValue(String v) {
-			return Short.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Short, GenericRow> getAggregator() {
-			return new ShortFirstValueWithRetractAggFunction();
-		}
+	@Override
+	protected List<List<T>> getInputValueSets() {
+		return aggFunctionTestSpec.inputValueSets;
 	}
 
-	/**
-	 * Test for IntFirstValueWithRetractAggFunction.
-	 */
-	public static class IntFirstValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithoutOrderTest<Integer> {
-
-		@Override
-		protected Integer getValue(String v) {
-			return Integer.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Integer, GenericRow> getAggregator() {
-			return new IntFirstValueWithRetractAggFunction();
-		}
+	@Override
+	protected List<T> getExpectedResults() {
+		return aggFunctionTestSpec.expectedResults;
 	}
 
-	/**
-	 * Test for LongFirstValueWithRetractAggFunction.
-	 */
-	public static class LongFirstValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithoutOrderTest<Long> {
-
-		@Override
-		protected Long getValue(String v) {
-			return Long.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Long, GenericRow> getAggregator() {
-			return new LongFirstValueWithRetractAggFunction();
-		}
+	@Override
+	protected AggregateFunction<T, GenericRow> getAggregator() {
+		return aggFunctionTestSpec.aggregator;
 	}
 
-	/**
-	 * Test for FloatFirstValueWithRetractAggFunction.
-	 */
-	public static class FloatFirstValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithoutOrderTest<Float> {
-
-		@Override
-		protected Float getValue(String v) {
-			return Float.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Float, GenericRow> getAggregator() {
-			return new FloatFirstValueWithRetractAggFunction();
-		}
+	@Override
+	protected Class<?> getAccClass() {
+		return GenericRow.class;
 	}
 
-	/**
-	 * Test for DoubleFirstValueWithRetractAggFunction.
-	 */
-	public static class DoubleFirstValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberFirstValueWithRetractAggFunctionWithoutOrderTest<Double> {
-
-		@Override
-		protected Double getValue(String v) {
-			return Double.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Double, GenericRow> getAggregator() {
-			return new DoubleFirstValueWithRetractAggFunction();
-		}
+	@Override
+	protected Method getRetractFunc() throws NoSuchMethodException {
+		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class);
 	}
 
-	/**
-	 * Test for BooleanFirstValueWithRetractAggFunction.
-	 */
-	public static class BooleanFirstValueWithRetractAggFunctionWithoutOrderTest extends
-			FirstValueWithRetractAggFunctionWithoutOrderTest<Boolean> {
-
-		@Override
-		protected List<List<Boolean>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							false,
-							false,
-							false
-					),
-					Arrays.asList(
-							true,
-							true,
-							true
-					),
-					Arrays.asList(
-							true,
-							false,
-							null,
-							true,
-							false,
-							true,
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							true
-					));
-		}
-
-		@Override
-		protected List<Boolean> getExpectedResults() {
-			return Arrays.asList(
-					false,
-					true,
-					true,
-					null,
-					true
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Boolean, GenericRow> getAggregator() {
-			return new BooleanFirstValueWithRetractAggFunction();
-		}
+	@Parameterized.Parameters(name = "{index}: {0}")
+	public static List<AggFunctionTestSpec> testData() {
+		return Arrays.asList(
+				/**
+				 * Test for ByteFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ByteFirstValueWithRetractAggFunction(),
+						numberInputValueSets(Byte::valueOf),
+						numberExpectedResults(Byte::valueOf)
+				),
+				/**
+				 * Test for ShortFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ShortFirstValueWithRetractAggFunction(),
+						numberInputValueSets(Short::valueOf),
+						numberExpectedResults(Short::valueOf)
+				),
+				/**
+				 * Test for IntFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new IntFirstValueWithRetractAggFunction(),
+						numberInputValueSets(Integer::valueOf),
+						numberExpectedResults(Integer::valueOf)
+				),
+				/**
+				 * Test for LongFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new LongFirstValueWithRetractAggFunction(),
+						numberInputValueSets(Long::valueOf),
+						numberExpectedResults(Long::valueOf)
+				),
+				/**
+				 * Test for FloatFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new FloatFirstValueWithRetractAggFunction(),
+						numberInputValueSets(Float::valueOf),
+						numberExpectedResults(Float::valueOf)
+				),
+				/**
+				 * Test for DoubleFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DoubleFirstValueWithRetractAggFunction(),
+						numberInputValueSets(Double::valueOf),
+						numberExpectedResults(Double::valueOf)
+				),
+				/**
+				 * Test for BooleanFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new BooleanFirstValueWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										false,
+										false,
+										false
+								),
+								Arrays.asList(
+										true,
+										true,
+										true
+								),
+								Arrays.asList(
+										true,
+										false,
+										null,
+										true,
+										false,
+										true,
+										null
+								),
+								Arrays.asList(
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										true
+								)),
+						Arrays.asList(
+								false,
+								true,
+								true,
+								null,
+								true
+						)
+				),
+				/**
+				 * Test for DecimalFirstValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DecimalFirstValueWithRetractAggFunction(
+								DecimalTypeInfo.of(DECIMAL_PRECISION, DECIMAL_SCALE)),
+						Arrays.asList(
+								Arrays.asList(
+										Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("1000.000001", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.998999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+								)
+						),
+						Arrays.asList(
+								Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+								null,
+								Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+						)
+				),
+				/**
+				 * Test for StringLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new StringFirstValueWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("ghi"),
+										null,
+										BinaryString.fromString("jkl"),
+										null,
+										BinaryString.fromString("zzz")
+								),
+								Arrays.asList(
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										BinaryString.fromString("a")
+								),
+								Arrays.asList(
+										BinaryString.fromString("x"),
+										null,
+										BinaryString.fromString("e")
+								)
+						),
+						Arrays.asList(
+								BinaryString.fromString("abc"),
+								null,
+								BinaryString.fromString("a"),
+								BinaryString.fromString("x")
+						)
+				)
+
+		);
 	}
 
-	/**
-	 * Test for DecimalFirstValueWithRetractAggFunction.
-	 */
-	public static class DecimalFirstValueWithRetractAggFunctionWithoutOrderTest extends
-			FirstValueWithRetractAggFunctionWithoutOrderTest<Decimal> {
-
-		private int precision = 20;
-		private int scale = 6;
-
-		@Override
-		protected List<List<Decimal>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							Decimal.castFrom("1", precision, scale),
-							Decimal.castFrom("1000.000001", precision, scale),
-							Decimal.castFrom("-1", precision, scale),
-							Decimal.castFrom("-999.998999", precision, scale),
-							null,
-							Decimal.castFrom("0", precision, scale),
-							Decimal.castFrom("-999.999", precision, scale),
-							null,
-							Decimal.castFrom("999.999", precision, scale)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							Decimal.castFrom("0", precision, scale)
-					)
-			);
-		}
-
-		@Override
-		protected List<Decimal> getExpectedResults() {
-			return Arrays.asList(
-					Decimal.castFrom("1", precision, scale),
-					null,
-					Decimal.castFrom("0", precision, scale)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Decimal, GenericRow> getAggregator() {
-			return new DecimalFirstValueWithRetractAggFunction(DecimalTypeInfo.of(precision, scale));
-		}
+	private static <N> List<List<N>> numberInputValueSets(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				Arrays.asList(
+						strToValueFun.apply("1"),
+						null,
+						strToValueFun.apply("-99"),
+						strToValueFun.apply("3"),
+						null
+				),
+				Arrays.asList(
+						null,
+						null,
+						null,
+						null
+				),
+				Arrays.asList(
+						null,
+						strToValueFun.apply("10"),
+						null,
+						strToValueFun.apply("3")
+				)
+		);
 	}
 
-	/**
-	 * Test for StringFirstValueWithRetractAggFunction.
-	 */
-	public static class StringFirstValueWithRetractAggFunctionWithoutOrderTest extends
-			FirstValueWithRetractAggFunctionWithoutOrderTest<BinaryString> {
-
-		@Override
-		protected List<List<BinaryString>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("ghi"),
-							null,
-							BinaryString.fromString("jkl"),
-							null,
-							BinaryString.fromString("zzz")
-					),
-					Arrays.asList(
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							BinaryString.fromString("a")
-					),
-					Arrays.asList(
-							BinaryString.fromString("x"),
-							null,
-							BinaryString.fromString("e")
-					)
-			);
-		}
-
-		@Override
-		protected List<BinaryString> getExpectedResults() {
-			return Arrays.asList(
-					BinaryString.fromString("abc"),
-					null,
-					BinaryString.fromString("a"),
-					BinaryString.fromString("x")
-			);
-		}
-
-		@Override
-		protected AggregateFunction<BinaryString, GenericRow> getAggregator() {
-			return new StringFirstValueWithRetractAggFunction();
-		}
+	private static <N> List<N> numberExpectedResults(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				strToValueFun.apply("1"),
+				null,
+				strToValueFun.apply("10")
+		);
 	}
 }
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueAggFunctionWithOrderTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueAggFunctionWithOrderTest.java
index ebcb50e7953..1ffad8a6285 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueAggFunctionWithOrderTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueAggFunctionWithOrderTest.java
@@ -33,435 +33,357 @@ import org.apache.flink.table.planner.functions.aggfunctions.LastValueAggFunctio
 import org.apache.flink.table.planner.functions.aggfunctions.LastValueAggFunction.StringLastValueAggFunction;
 import org.apache.flink.table.runtime.typeutils.DecimalTypeInfo;
 
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
 import java.util.Arrays;
 import java.util.List;
+import java.util.function.Function;
 
 /**
  * Test case for built-in LastValue aggregate function.
  * This class tests `accumulate` method with order argument.
  */
-public abstract class LastValueAggFunctionWithOrderTest<T> extends FirstLastValueAggFunctionWithOrderTestBase<T> {
-
-	/**
-	 * Test LastValueAggFunction for number type.
-	 */
-	public abstract static class NumberLastValueAggFunctionWithOrderTest<T>
-			extends LastValueAggFunctionWithOrderTest<T> {
-		protected abstract T getValue(String v);
+@RunWith(Parameterized.class)
+public class LastValueAggFunctionWithOrderTest<T> extends FirstLastValueAggFunctionWithOrderTestBase<T> {
 
-		@Override
-		protected List<List<T>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							getValue("1"),
-							null,
-							getValue("-99"),
-							getValue("3"),
-							null,
-							getValue("3"),
-							getValue("2"),
-							getValue("-99")
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							getValue("10"),
-							null,
-							getValue("5")
-					)
-			);
-		}
+	@Parameterized.Parameter
+	public AggFunctionWithOrderTestSpec<T> aggFunctionTestSpec;
 
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							6L,
-							11L,
-							3L,
-							17L,
-							5L
-					),
-					Arrays.asList(
-							8L,
-							6L,
-							9L,
-							5L
-					),
-					Arrays.asList(
-							null,
-							6L,
-							4L,
-							3L
-					)
-			);
-		}
+	private static final int DECIMAL_PRECISION = 20;
+	private static final int DECIMAL_SCALE = 6;
 
-		@Override
-		protected List<T> getExpectedResults() {
-			return Arrays.asList(
-					getValue("2"),
-					null,
-					getValue("10")
-			);
-		}
+	@Override
+	protected List<List<Long>> getInputOrderSets() {
+		return aggFunctionTestSpec.inputOrderSets;
 	}
 
-	/**
-	 * Test for ByteLastValueAggFunction.
-	 */
-	public static class ByteLastValueAggFunctionWithOrderTest
-			extends NumberLastValueAggFunctionWithOrderTest<Byte> {
-
-		@Override
-		protected Byte getValue(String v) {
-			return Byte.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Byte, GenericRow> getAggregator() {
-			return new ByteLastValueAggFunction();
-		}
+	@Override
+	protected List<List<T>> getInputValueSets() {
+		return aggFunctionTestSpec.inputValueSets;
 	}
 
-	/**
-	 * Test for ShortLastValueAggFunction.
-	 */
-	public static class ShortLastValueAggFunctionWithOrderTest
-			extends NumberLastValueAggFunctionWithOrderTest<Short> {
-
-		@Override
-		protected Short getValue(String v) {
-			return Short.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Short, GenericRow> getAggregator() {
-			return new ShortLastValueAggFunction();
-		}
+	@Override
+	protected List<T> getExpectedResults() {
+		return aggFunctionTestSpec.expectedResults;
 	}
 
-	/**
-	 * Test for IntLastValueAggFunction.
-	 */
-	public static class IntLastValueAggFunctionWithOrderTest
-			extends NumberLastValueAggFunctionWithOrderTest<Integer> {
-
-		@Override
-		protected Integer getValue(String v) {
-			return Integer.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Integer, GenericRow> getAggregator() {
-			return new IntLastValueAggFunction();
-		}
+	@Override
+	protected AggregateFunction<T, GenericRow> getAggregator() {
+		return aggFunctionTestSpec.aggregator;
 	}
 
-	/**
-	 * Test for LongLastValueAggFunction.
-	 */
-	public static class LongLastValueAggFunctionWithOrderTest
-			extends NumberLastValueAggFunctionWithOrderTest<Long> {
-
-		@Override
-		protected Long getValue(String v) {
-			return Long.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Long, GenericRow> getAggregator() {
-			return new LongLastValueAggFunction();
-		}
+	@Parameterized.Parameters(name = "{index}: {0}")
+	public static List<AggFunctionTestSpec> testData() {
+		return Arrays.asList(
+				/**
+				 * Test for ByteLastValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new ByteLastValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Byte::valueOf),
+						numberExpectedResults(Byte::valueOf)
+				),
+				/**
+				 * Test for ShortLastValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new ShortLastValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Short::valueOf),
+						numberExpectedResults(Short::valueOf)
+				),
+				/**
+				 * Test for IntLastValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new IntLastValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Integer::valueOf),
+						numberExpectedResults(Integer::valueOf)
+				),
+				/**
+				 * Test for LongLastValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new LongLastValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Long::valueOf),
+						numberExpectedResults(Long::valueOf)
+				),
+				/**
+				 * Test for FloatLastValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new FloatLastValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Float::valueOf),
+						numberExpectedResults(Float::valueOf)
+				),
+				/**
+				 * Test for DoubleLastValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new DoubleLastValueAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Double::valueOf),
+						numberExpectedResults(Double::valueOf)
+				),
+				/**
+				 * Test for BooleanLastValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new BooleanLastValueAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										6L,
+										2L,
+										3L
+								),
+								Arrays.asList(
+										1L,
+										2L,
+										3L
+								),
+								Arrays.asList(
+										10L,
+										2L,
+										5L,
+										3L,
+										11L,
+										7L,
+										5L
+								),
+								Arrays.asList(
+										6L,
+										9L,
+										5L
+								),
+								Arrays.asList(
+										4L,
+										3L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										false,
+										false,
+										false
+								),
+								Arrays.asList(
+										true,
+										true,
+										true
+								),
+								Arrays.asList(
+										true,
+										false,
+										null,
+										true,
+										false,
+										true,
+										null
+								),
+								Arrays.asList(
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										true
+								)
+						),
+						Arrays.asList(
+								false,
+								true,
+								false,
+								null,
+								true
+						)
+				),
+				/**
+				 * Test for DecimalLastValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new DecimalLastValueAggFunction(DecimalTypeInfo.of(DECIMAL_PRECISION, DECIMAL_SCALE)),
+						Arrays.asList(
+								Arrays.asList(
+										10L,
+										2L,
+										1L,
+										5L,
+										null,
+										3L,
+										1L,
+										5L,
+										2L
+								),
+								Arrays.asList(
+										6L,
+										5L,
+										null,
+										8L,
+										null
+								),
+								Arrays.asList(
+										8L,
+										6L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("1000.000001", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.998999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+								)
+						),
+						Arrays.asList(
+								Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+								null,
+								Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+						)
+				),
+				/**
+				 * Test for StringLastValueAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new StringLastValueAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										10L,
+										2L,
+										5L,
+										null,
+										3L,
+										1L,
+										15L
+								),
+								Arrays.asList(
+										6L,
+										5L
+								),
+								Arrays.asList(
+										8L,
+										6L
+								),
+								Arrays.asList(
+										6L,
+										4L,
+										3L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("ghi"),
+										null,
+										BinaryString.fromString("jkl"),
+										null,
+										BinaryString.fromString("zzz")
+								),
+								Arrays.asList(
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										BinaryString.fromString("a")
+								),
+								Arrays.asList(
+										BinaryString.fromString("x"),
+										null,
+										BinaryString.fromString("e")
+								)
+						),
+						Arrays.asList(
+								BinaryString.fromString("zzz"),
+								null,
+								BinaryString.fromString("a"),
+								BinaryString.fromString("x")
+						)
+				)
+		);
 	}
 
-	/**
-	 * Test for FloatLastValueAggFunction.
-	 */
-	public static class FloatLastValueAggFunctionWithOrderTest
-			extends NumberLastValueAggFunctionWithOrderTest<Float> {
-
-		@Override
-		protected Float getValue(String v) {
-			return Float.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Float, GenericRow> getAggregator() {
-			return new FloatLastValueAggFunction();
-		}
+	private static List<List<Long>> numberInputOrderSets() {
+		return Arrays.asList(
+				Arrays.asList(
+						10L,
+						2L,
+						5L,
+						6L,
+						11L,
+						3L,
+						17L,
+						5L
+				),
+				Arrays.asList(
+						8L,
+						6L,
+						9L,
+						5L
+				),
+				Arrays.asList(
+						null,
+						6L,
+						4L,
+						3L
+				)
+		);
 	}
 
-	/**
-	 * Test for DoubleLastValueAggFunction.
-	 */
-	public static class DoubleLastValueAggFunctionWithOrderTest
-			extends NumberLastValueAggFunctionWithOrderTest<Double> {
-
-		@Override
-		protected Double getValue(String v) {
-			return Double.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Double, GenericRow> getAggregator() {
-			return new DoubleLastValueAggFunction();
-		}
+	private static <N> List<List<N>> numberInputValueSets(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				Arrays.asList(
+						strToValueFun.apply("1"),
+						null,
+						strToValueFun.apply("-99"),
+						strToValueFun.apply("3"),
+						null,
+						strToValueFun.apply("3"),
+						strToValueFun.apply("2"),
+						strToValueFun.apply("-99")
+				),
+				Arrays.asList(
+						null,
+						null,
+						null,
+						null
+				),
+				Arrays.asList(
+						null,
+						strToValueFun.apply("10"),
+						null,
+						strToValueFun.apply("5")
+				)
+		);
 	}
 
-	/**
-	 * Test for BooleanLastValueAggFunction.
-	 */
-	public static class BooleanLastValueAggFunctionWithOrderTest
-			extends LastValueAggFunctionWithOrderTest<Boolean> {
-
-		@Override
-		protected List<List<Boolean>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							false,
-							false,
-							false
-					),
-					Arrays.asList(
-							true,
-							true,
-							true
-					),
-					Arrays.asList(
-							true,
-							false,
-							null,
-							true,
-							false,
-							true,
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							true
-					));
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							6L,
-							2L,
-							3L
-					),
-					Arrays.asList(
-							1L,
-							2L,
-							3L
-					),
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							3L,
-							11L,
-							7L,
-							5L
-					),
-					Arrays.asList(
-							6L,
-							9L,
-							5L
-					),
-					Arrays.asList(
-							4L,
-							3L
-					)
-			);
-		}
-
-		@Override
-		protected List<Boolean> getExpectedResults() {
-			return Arrays.asList(
-					false,
-					true,
-					false,
-					null,
-					true
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Boolean, GenericRow> getAggregator() {
-			return new BooleanLastValueAggFunction();
-		}
-	}
-
-	/**
-	 * Test for DecimalLastValueAggFunction.
-	 */
-	public static class DecimalLastValueAggFunctionWithOrderTest
-			extends LastValueAggFunctionWithOrderTest<Decimal> {
-
-		private int precision = 20;
-		private int scale = 6;
-
-		@Override
-		protected List<List<Decimal>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							Decimal.castFrom("1", precision, scale),
-							Decimal.castFrom("1000.000001", precision, scale),
-							Decimal.castFrom("-1", precision, scale),
-							Decimal.castFrom("-999.998999", precision, scale),
-							null,
-							Decimal.castFrom("0", precision, scale),
-							Decimal.castFrom("-999.999", precision, scale),
-							null,
-							Decimal.castFrom("999.999", precision, scale)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							Decimal.castFrom("0", precision, scale)
-					)
-			);
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							1L,
-							5L,
-							null,
-							3L,
-							1L,
-							5L,
-							2L
-					),
-					Arrays.asList(
-							6L,
-							5L,
-							null,
-							8L,
-							null
-					),
-					Arrays.asList(
-							8L,
-							6L
-					)
-			);
-		}
-
-		@Override
-		protected List<Decimal> getExpectedResults() {
-			return Arrays.asList(
-					Decimal.castFrom("1", precision, scale),
-					null,
-					Decimal.castFrom("0", precision, scale)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Decimal, GenericRow> getAggregator() {
-			return new DecimalLastValueAggFunction(DecimalTypeInfo.of(precision, scale));
-		}
-	}
-
-	/**
-	 * Test for StringLastValueAggFunction.
-	 */
-	public static class StringLastValueAggFunctionWithOrderTest
-			extends LastValueAggFunctionWithOrderTest<BinaryString> {
-
-		@Override
-		protected List<List<BinaryString>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("ghi"),
-							null,
-							BinaryString.fromString("jkl"),
-							null,
-							BinaryString.fromString("zzz")
-					),
-					Arrays.asList(
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							BinaryString.fromString("a")
-					),
-					Arrays.asList(
-							BinaryString.fromString("x"),
-							null,
-							BinaryString.fromString("e")
-					)
-			);
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							null,
-							3L,
-							1L,
-							15L
-					),
-					Arrays.asList(
-							6L,
-							5L
-					),
-					Arrays.asList(
-							8L,
-							6L
-					),
-					Arrays.asList(
-							6L,
-							4L,
-							3L
-					)
-			);
-		}
-
-		@Override
-		protected List<BinaryString> getExpectedResults() {
-			return Arrays.asList(
-					BinaryString.fromString("zzz"),
-					null,
-					BinaryString.fromString("a"),
-					BinaryString.fromString("x")
-			);
-		}
-
-		@Override
-		protected AggregateFunction<BinaryString, GenericRow> getAggregator() {
-			return new StringLastValueAggFunction();
-		}
+	private static <N> List<N> numberExpectedResults(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				strToValueFun.apply("2"),
+				null,
+				strToValueFun.apply("10")
+		);
 	}
 }
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueAggFunctionWithoutOrderTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueAggFunctionWithoutOrderTest.java
index 74e42ca1e87..96d199e959e 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueAggFunctionWithoutOrderTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueAggFunctionWithoutOrderTest.java
@@ -33,320 +33,244 @@ import org.apache.flink.table.planner.functions.aggfunctions.LastValueAggFunctio
 import org.apache.flink.table.planner.functions.aggfunctions.LastValueAggFunction.StringLastValueAggFunction;
 import org.apache.flink.table.runtime.typeutils.DecimalTypeInfo;
 
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
 import java.util.Arrays;
 import java.util.List;
+import java.util.function.Function;
 
 /**
  * Test case for built-in LastValue aggregate function.
  * This class tests `accumulate` method without order argument.
  */
-public abstract class LastValueAggFunctionWithoutOrderTest<T> extends AggFunctionTestBase<T, GenericRow> {
-
-	@Override
-	protected Class<?> getAccClass() {
-		return GenericRow.class;
-	}
-
-	/**
-	 * Test LastValueAggFunction for number type.
-	 */
-	public abstract static class NumberLastValueAggFunctionWithoutOrderTest<T>
-			extends LastValueAggFunctionWithoutOrderTest<T> {
-		protected abstract T getValue(String v);
-
-		@Override
-		protected List<List<T>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							getValue("1"),
-							null,
-							getValue("-99"),
-							getValue("3"),
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							getValue("10"),
-							null,
-							getValue("3")
-					)
-			);
-		}
-
-		@Override
-		protected List<T> getExpectedResults() {
-			return Arrays.asList(
-					getValue("3"),
-					null,
-					getValue("3")
-			);
-		}
-	}
+@RunWith(Parameterized.class)
+public class LastValueAggFunctionWithoutOrderTest<T> extends AggFunctionTestBase<T, GenericRow> {
 
-	/**
-	 * Test for ByteLastValueAggFunction.
-	 */
-	public static class ByteLastValueAggFunctionWithoutOrderTest
-			extends NumberLastValueAggFunctionWithoutOrderTest<Byte> {
+	@Parameterized.Parameter
+	public AggFunctionTestSpec<T, GenericRow> aggFunctionTestSpec;
 
-		@Override
-		protected Byte getValue(String v) {
-			return Byte.valueOf(v);
-		}
+	private static final int DECIMAL_PRECISION = 20;
+	private static final int DECIMAL_SCALE = 6;
 
-		@Override
-		protected AggregateFunction<Byte, GenericRow> getAggregator() {
-			return new ByteLastValueAggFunction();
-		}
-	}
-
-	/**
-	 * Test for ShortLastValueAggFunction.
-	 */
-	public static class ShortLastValueAggFunctionWithoutOrderTest
-			extends NumberLastValueAggFunctionWithoutOrderTest<Short> {
-
-		@Override
-		protected Short getValue(String v) {
-			return Short.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Short, GenericRow> getAggregator() {
-			return new ShortLastValueAggFunction();
-		}
-	}
-
-	/**
-	 * Test for IntLastValueAggFunction.
-	 */
-	public static class IntLastValueAggFunctionWithoutOrderTest
-			extends NumberLastValueAggFunctionWithoutOrderTest<Integer> {
-
-		@Override
-		protected Integer getValue(String v) {
-			return Integer.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Integer, GenericRow> getAggregator() {
-			return new IntLastValueAggFunction();
-		}
+	@Override
+	protected List<List<T>> getInputValueSets() {
+		return aggFunctionTestSpec.inputValueSets;
 	}
 
-	/**
-	 * Test for LongLastValueAggFunction.
-	 */
-	public static class LongLastValueAggFunctionWithoutOrderTest
-			extends NumberLastValueAggFunctionWithoutOrderTest<Long> {
-
-		@Override
-		protected Long getValue(String v) {
-			return Long.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Long, GenericRow> getAggregator() {
-			return new LongLastValueAggFunction();
-		}
+	@Override
+	protected List<T> getExpectedResults() {
+		return aggFunctionTestSpec.expectedResults;
 	}
 
-	/**
-	 * Test for FloatLastValueAggFunction.
-	 */
-	public static class FloatLastValueAggFunctionWithoutOrderTest
-			extends NumberLastValueAggFunctionWithoutOrderTest<Float> {
-
-		@Override
-		protected Float getValue(String v) {
-			return Float.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Float, GenericRow> getAggregator() {
-			return new FloatLastValueAggFunction();
-		}
+	@Override
+	protected AggregateFunction<T, GenericRow> getAggregator() {
+		return aggFunctionTestSpec.aggregator;
 	}
 
-	/**
-	 * Test for DoubleLastValueAggFunction.
-	 */
-	public static class DoubleLastValueAggFunctionWithoutOrderTest
-			extends NumberLastValueAggFunctionWithoutOrderTest<Double> {
-
-		@Override
-		protected Double getValue(String v) {
-			return Double.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Double, GenericRow> getAggregator() {
-			return new DoubleLastValueAggFunction();
-		}
+	@Override
+	protected Class<?> getAccClass() {
+		return GenericRow.class;
 	}
 
-	/**
-	 * Test for BooleanLastValueAggFunction.
-	 */
-	public static class BooleanLastValueAggFunctionWithoutOrderTest extends
-			LastValueAggFunctionWithoutOrderTest<Boolean> {
-
-		@Override
-		protected List<List<Boolean>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							false,
-							false,
-							false
-					),
-					Arrays.asList(
-							true,
-							true,
-							true
-					),
-					Arrays.asList(
-							true,
-							false,
-							null,
-							true,
-							false,
-							true,
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							true
-					));
-		}
-
-		@Override
-		protected List<Boolean> getExpectedResults() {
-			return Arrays.asList(
-					false,
-					true,
-					true,
-					null,
-					true
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Boolean, GenericRow> getAggregator() {
-			return new BooleanLastValueAggFunction();
-		}
+	@Parameterized.Parameters(name = "{index}: {0}")
+	public static List<AggFunctionTestSpec> testData() {
+		return Arrays.asList(
+				/**
+				 * Test for ByteLastValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ByteLastValueAggFunction(),
+						numberInputValueSets(Byte::valueOf),
+						numberExpectedResults(Byte::valueOf)
+				),
+				/**
+				 * Test for ShortLastValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ShortLastValueAggFunction(),
+						numberInputValueSets(Short::valueOf),
+						numberExpectedResults(Short::valueOf)
+				),
+				/**
+				 * Test for IntLastValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new IntLastValueAggFunction(),
+						numberInputValueSets(Integer::valueOf),
+						numberExpectedResults(Integer::valueOf)
+				),
+				/**
+				 * Test for LongLastValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new LongLastValueAggFunction(),
+						numberInputValueSets(Long::valueOf),
+						numberExpectedResults(Long::valueOf)
+				),
+				/**
+				 * Test for FloatLastValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new FloatLastValueAggFunction(),
+						numberInputValueSets(Float::valueOf),
+						numberExpectedResults(Float::valueOf)
+				),
+				/**
+				 * Test for DoubleLastValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DoubleLastValueAggFunction(),
+						numberInputValueSets(Double::valueOf),
+						numberExpectedResults(Double::valueOf)
+				),
+				/**
+				 * Test for BooleanLastValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new BooleanLastValueAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										false,
+										false,
+										false
+								),
+								Arrays.asList(
+										true,
+										true,
+										true
+								),
+								Arrays.asList(
+										true,
+										false,
+										null,
+										true,
+										false,
+										true,
+										null
+								),
+								Arrays.asList(
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										true
+								)
+						),
+						Arrays.asList(
+								false,
+								true,
+								true,
+								null,
+								true
+						)
+				),
+				/**
+				 * Test for DecimalLastValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DecimalLastValueAggFunction(DecimalTypeInfo.of(DECIMAL_PRECISION, DECIMAL_SCALE)),
+						Arrays.asList(
+								Arrays.asList(
+										Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("1000.000001", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.998999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+								)
+						),
+						Arrays.asList(
+								Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+								null,
+								Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+						)
+				),
+				/**
+				 * Test for StringLastValueAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new StringLastValueAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("ghi"),
+										null,
+										BinaryString.fromString("jkl"),
+										null,
+										BinaryString.fromString("zzz")
+								),
+								Arrays.asList(
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										BinaryString.fromString("a"),
+										null
+								),
+								Arrays.asList(
+										BinaryString.fromString("x"),
+										null,
+										BinaryString.fromString("e")
+								)
+						),
+						Arrays.asList(
+								BinaryString.fromString("zzz"),
+								null,
+								BinaryString.fromString("a"),
+								BinaryString.fromString("e")
+						)
+				)
+		);
 	}
 
-	/**
-	 * Test for DecimalLastValueAggFunction.
-	 */
-	public static class DecimalLastValueAggFunctionWithoutOrderTest extends
-			LastValueAggFunctionWithoutOrderTest<Decimal> {
-
-		private int precision = 20;
-		private int scale = 6;
-
-		@Override
-		protected List<List<Decimal>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							Decimal.castFrom("1", precision, scale),
-							Decimal.castFrom("1000.000001", precision, scale),
-							Decimal.castFrom("-1", precision, scale),
-							Decimal.castFrom("-999.998999", precision, scale),
-							null,
-							Decimal.castFrom("0", precision, scale),
-							Decimal.castFrom("-999.999", precision, scale),
-							null,
-							Decimal.castFrom("999.999", precision, scale)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							Decimal.castFrom("0", precision, scale)
-					)
-			);
-		}
-
-		@Override
-		protected List<Decimal> getExpectedResults() {
-			return Arrays.asList(
-					Decimal.castFrom("999.999", precision, scale),
-					null,
-					Decimal.castFrom("0", precision, scale)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Decimal, GenericRow> getAggregator() {
-			return new DecimalLastValueAggFunction(DecimalTypeInfo.of(precision, scale));
-		}
+	private static <N> List<List<N>> numberInputValueSets(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				Arrays.asList(
+						strToValueFun.apply("1"),
+						null,
+						strToValueFun.apply("-99"),
+						strToValueFun.apply("3"),
+						null
+				),
+				Arrays.asList(
+						null,
+						null,
+						null,
+						null
+				),
+				Arrays.asList(
+						null,
+						strToValueFun.apply("10"),
+						null,
+						strToValueFun.apply("3")
+				)
+		);
 	}
 
-	/**
-	 * Test for StringLastValueAggFunction.
-	 */
-	public static class StringLastValueAggFunctionWithoutOrderTest extends
-			LastValueAggFunctionWithoutOrderTest<BinaryString> {
-
-		@Override
-		protected List<List<BinaryString>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("ghi"),
-							null,
-							BinaryString.fromString("jkl"),
-							null,
-							BinaryString.fromString("zzz")
-					),
-					Arrays.asList(
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							BinaryString.fromString("a"),
-							null
-					),
-					Arrays.asList(
-							BinaryString.fromString("x"),
-							null,
-							BinaryString.fromString("e")
-					)
-			);
-		}
-
-		@Override
-		protected List<BinaryString> getExpectedResults() {
-			return Arrays.asList(
-					BinaryString.fromString("zzz"),
-					null,
-					BinaryString.fromString("a"),
-					BinaryString.fromString("e")
-			);
-		}
-
-		@Override
-		protected AggregateFunction<BinaryString, GenericRow> getAggregator() {
-			return new StringLastValueAggFunction();
-		}
+	private static <N> List<N> numberExpectedResults(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				strToValueFun.apply("3"),
+				null,
+				strToValueFun.apply("3")
+		);
 	}
 }
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueWithRetractAggFunctionWithOrderTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueWithRetractAggFunctionWithOrderTest.java
index 303bb130eca..861953e3a52 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueWithRetractAggFunctionWithOrderTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueWithRetractAggFunctionWithOrderTest.java
@@ -33,448 +33,372 @@ import org.apache.flink.table.planner.functions.aggfunctions.LastValueWithRetrac
 import org.apache.flink.table.planner.functions.aggfunctions.LastValueWithRetractAggFunction.StringLastValueWithRetractAggFunction;
 import org.apache.flink.table.runtime.typeutils.DecimalTypeInfo;
 
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
 import java.lang.reflect.Method;
 import java.util.Arrays;
 import java.util.List;
+import java.util.function.Function;
 
 /**
  * Test case for built-in LastValue with retract aggregate function.
  * This class tests `accumulate` method with order argument.
  */
-public abstract class LastValueWithRetractAggFunctionWithOrderTest<T>
-		extends FirstLastValueAggFunctionWithOrderTestBase<T> {
-
-	@Override
-	protected Method getRetractFunc() throws NoSuchMethodException {
-		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class, Long.class);
-	}
+@RunWith(Parameterized.class)
+public class LastValueWithRetractAggFunctionWithOrderTest<T> extends FirstLastValueAggFunctionWithOrderTestBase<T> {
 
-	/**
-	 * Test LastValueWithRetractAggFunction for number type.
-	 */
-	public abstract static class NumberLastValueWithRetractAggFunctionWithOrderTest<T>
-			extends LastValueWithRetractAggFunctionWithOrderTest<T> {
-		protected abstract T getValue(String v);
+	@Parameterized.Parameter
+	public AggFunctionWithOrderTestSpec<T> aggFunctionTestSpec;
 
-		@Override
-		protected List<List<T>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							getValue("1"),
-							null,
-							getValue("-99"),
-							getValue("3"),
-							null,
-							getValue("3"),
-							getValue("2"),
-							getValue("-99")
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							getValue("10"),
-							null,
-							getValue("5")
-					)
-			);
-		}
+	private static final int DECIMAL_PRECISION = 20;
+	private static final int DECIMAL_SCALE = 6;
 
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							6L,
-							11L,
-							13L,
-							7L,
-							5L
-					),
-					Arrays.asList(
-							8L,
-							6L,
-							9L,
-							5L
-					),
-					Arrays.asList(
-							null,
-							6L,
-							4L,
-							3L
-					)
-			);
-		}
-
-		@Override
-		protected List<T> getExpectedResults() {
-			return Arrays.asList(
-					getValue("3"),
-					null,
-					getValue("10")
-			);
-		}
+	@Override
+	protected List<List<Long>> getInputOrderSets() {
+		return aggFunctionTestSpec.inputOrderSets;
 	}
 
-	/**
-	 * Test for ByteLastValueWithRetractAggFunction.
-	 */
-	public static class ByteLastValueWithRetractAggFunctionWithOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithOrderTest<Byte> {
-
-		@Override
-		protected Byte getValue(String v) {
-			return Byte.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Byte, GenericRow> getAggregator() {
-			return new ByteLastValueWithRetractAggFunction();
-		}
+	@Override
+	protected List<List<T>> getInputValueSets() {
+		return aggFunctionTestSpec.inputValueSets;
 	}
 
-	/**
-	 * Test for ShortLastValueWithRetractAggFunction.
-	 */
-	public static class ShortLastValueWithRetractAggFunctionWithOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithOrderTest<Short> {
-
-		@Override
-		protected Short getValue(String v) {
-			return Short.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Short, GenericRow> getAggregator() {
-			return new ShortLastValueWithRetractAggFunction();
-		}
+	@Override
+	protected List<T> getExpectedResults() {
+		return aggFunctionTestSpec.expectedResults;
 	}
 
-	/**
-	 * Test for IntLastValueWithRetractAggFunction.
-	 */
-	public static class IntLastValueWithRetractAggFunctionWithOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithOrderTest<Integer> {
-
-		@Override
-		protected Integer getValue(String v) {
-			return Integer.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Integer, GenericRow> getAggregator() {
-			return new IntLastValueWithRetractAggFunction();
-		}
+	@Override
+	protected AggregateFunction<T, GenericRow> getAggregator() {
+		return aggFunctionTestSpec.aggregator;
 	}
 
-	/**
-	 * Test for LongLastValueWithRetractAggFunction.
-	 */
-	public static class LongLastValueWithRetractAggFunctionWithOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithOrderTest<Long> {
-
-		@Override
-		protected Long getValue(String v) {
-			return Long.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Long, GenericRow> getAggregator() {
-			return new LongLastValueWithRetractAggFunction();
-		}
+	@Override
+	protected Method getRetractFunc() throws NoSuchMethodException {
+		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class, Long.class);
 	}
 
-	/**
-	 * Test for FloatLastValueWithRetractAggFunction.
-	 */
-	public static class FloatLastValueWithRetractAggFunctionWithOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithOrderTest<Float> {
-
-		@Override
-		protected Float getValue(String v) {
-			return Float.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Float, GenericRow> getAggregator() {
-			return new FloatLastValueWithRetractAggFunction();
-		}
+	@Parameterized.Parameters(name = "{index}: {0}")
+	public static List<AggFunctionTestSpec> testData() {
+		return Arrays.asList(
+				/**
+				 * Test for ByteLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new ByteLastValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Byte::valueOf),
+						numberExpectedResults(Byte::valueOf)
+				),
+				/**
+				 * Test for ShortLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new ShortLastValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Short::valueOf),
+						numberExpectedResults(Short::valueOf)
+				),
+				/**
+				 * Test for IntLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new IntLastValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Integer::valueOf),
+						numberExpectedResults(Integer::valueOf)
+				),
+				/**
+				 * Test for LongLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new LongLastValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Long::valueOf),
+						numberExpectedResults(Long::valueOf)
+				),
+				/**
+				 * Test for FloatLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new FloatLastValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Float::valueOf),
+						numberExpectedResults(Float::valueOf)
+				),
+				/**
+				 * Test for DoubleLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new DoubleLastValueWithRetractAggFunction(),
+						numberInputOrderSets(),
+						numberInputValueSets(Double::valueOf),
+						numberExpectedResults(Double::valueOf)
+				),
+				/**
+				 * Test for BooleanLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new BooleanLastValueWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										6L,
+										2L,
+										3L
+								),
+								Arrays.asList(
+										1L,
+										2L,
+										3L
+								),
+								Arrays.asList(
+										10L,
+										2L,
+										5L,
+										11L,
+										3L,
+										7L,
+										5L
+								),
+								Arrays.asList(
+										6L,
+										9L,
+										5L
+								),
+								Arrays.asList(
+										4L,
+										3L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										false,
+										false,
+										false
+								),
+								Arrays.asList(
+										true,
+										true,
+										true
+								),
+								Arrays.asList(
+										true,
+										false,
+										null,
+										true,
+										false,
+										true,
+										null
+								),
+								Arrays.asList(
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										true
+								)
+						),
+						Arrays.asList(
+								false,
+								true,
+								true,
+								null,
+								true
+						)
+				),
+				/**
+				 * Test for DecimalLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new DecimalLastValueWithRetractAggFunction(
+								DecimalTypeInfo.of(DECIMAL_PRECISION, DECIMAL_SCALE)),
+						Arrays.asList(
+								Arrays.asList(
+										10L,
+										2L,
+										1L,
+										5L,
+										null,
+										3L,
+										1L,
+										5L,
+										2L
+								),
+								Arrays.asList(
+										6L,
+										5L,
+										null,
+										8L,
+										null
+								),
+								Arrays.asList(
+										8L,
+										6L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("1000.000001", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.998999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+								)
+						),
+						Arrays.asList(
+								Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+								null,
+								Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+						)
+				),
+				/**
+				 * Test for StringLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionWithOrderTestSpec<>(
+						new StringLastValueWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										10L,
+										2L,
+										5L,
+										null,
+										3L,
+										1L,
+										5L,
+										10L,
+										15L,
+										11L
+								),
+								Arrays.asList(
+										6L,
+										5L
+								),
+								Arrays.asList(
+										8L,
+										6L
+								),
+								Arrays.asList(
+										6L,
+										4L,
+										3L
+								)
+						),
+						Arrays.asList(
+								Arrays.asList(
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("ghi"),
+										null,
+										BinaryString.fromString("jkl"),
+										null,
+										BinaryString.fromString("zzz"),
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("abc")
+								),
+								Arrays.asList(
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										BinaryString.fromString("a")
+								),
+								Arrays.asList(
+										BinaryString.fromString("x"),
+										null,
+										BinaryString.fromString("e")
+								)
+						),
+						Arrays.asList(
+								BinaryString.fromString("def"),
+								null,
+								BinaryString.fromString("a"),
+								BinaryString.fromString("x")
+						)
+				)
+		);
 	}
 
-	/**
-	 * Test for DoubleLastValueWithRetractAggFunction.
-	 */
-	public static class DoubleLastValueWithRetractAggFunctionWithOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithOrderTest<Double> {
-
-		@Override
-		protected Double getValue(String v) {
-			return Double.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Double, GenericRow> getAggregator() {
-			return new DoubleLastValueWithRetractAggFunction();
-		}
+	private static List<List<Long>> numberInputOrderSets() {
+		return Arrays.asList(
+				Arrays.asList(
+						10L,
+						2L,
+						5L,
+						6L,
+						11L,
+						13L,
+						7L,
+						5L
+				),
+				Arrays.asList(
+						8L,
+						6L,
+						9L,
+						5L
+				),
+				Arrays.asList(
+						null,
+						6L,
+						4L,
+						3L
+				)
+		);
 	}
 
-	/**
-	 * Test for BooleanLastValueWithRetractAggFunction.
-	 */
-	public static class BooleanLastValueWithRetractAggFunctionWithOrderTest
-			extends LastValueWithRetractAggFunctionWithOrderTest<Boolean> {
-
-		@Override
-		protected List<List<Boolean>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							false,
-							false,
-							false
-					),
-					Arrays.asList(
-							true,
-							true,
-							true
-					),
-					Arrays.asList(
-							true,
-							false,
-							null,
-							true,
-							false,
-							true,
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							true
-					));
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							6L,
-							2L,
-							3L
-					),
-					Arrays.asList(
-							1L,
-							2L,
-							3L
-					),
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							11L,
-							3L,
-							7L,
-							5L
-					),
-					Arrays.asList(
-							6L,
-							9L,
-							5L
-					),
-					Arrays.asList(
-							4L,
-							3L
-					)
-			);
-		}
-
-		@Override
-		protected List<Boolean> getExpectedResults() {
-			return Arrays.asList(
-					false,
-					true,
-					true,
-					null,
-					true
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Boolean, GenericRow> getAggregator() {
-			return new BooleanLastValueWithRetractAggFunction();
-		}
+	private static <N> List<List<N>> numberInputValueSets(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				Arrays.asList(
+						strToValueFun.apply("1"),
+						null,
+						strToValueFun.apply("-99"),
+						strToValueFun.apply("3"),
+						null,
+						strToValueFun.apply("3"),
+						strToValueFun.apply("2"),
+						strToValueFun.apply("-99")
+				),
+				Arrays.asList(
+						null,
+						null,
+						null,
+						null
+				),
+				Arrays.asList(
+						null,
+						strToValueFun.apply("10"),
+						null,
+						strToValueFun.apply("5")
+				)
+		);
 	}
 
-	/**
-	 * Test for DecimalLastValueWithRetractAggFunction.
-	 */
-	public static class DecimalLastValueWithRetractAggFunctionWithOrderTest
-			extends LastValueWithRetractAggFunctionWithOrderTest<Decimal> {
-
-		private int precision = 20;
-		private int scale = 6;
-
-		@Override
-		protected List<List<Decimal>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							Decimal.castFrom("1", precision, scale),
-							Decimal.castFrom("1000.000001", precision, scale),
-							Decimal.castFrom("-1", precision, scale),
-							Decimal.castFrom("-999.998999", precision, scale),
-							null,
-							Decimal.castFrom("0", precision, scale),
-							Decimal.castFrom("-999.999", precision, scale),
-							null,
-							Decimal.castFrom("999.999", precision, scale)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							Decimal.castFrom("0", precision, scale)
-					)
-			);
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							1L,
-							5L,
-							null,
-							3L,
-							1L,
-							5L,
-							2L
-					),
-					Arrays.asList(
-							6L,
-							5L,
-							null,
-							8L,
-							null
-					),
-					Arrays.asList(
-							8L,
-							6L
-					)
-			);
-		}
-
-		@Override
-		protected List<Decimal> getExpectedResults() {
-			return Arrays.asList(
-					Decimal.castFrom("1", precision, scale),
-					null,
-					Decimal.castFrom("0", precision, scale)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Decimal, GenericRow> getAggregator() {
-			return new DecimalLastValueWithRetractAggFunction(DecimalTypeInfo.of(precision, scale));
-		}
+	private static <N> List<N> numberExpectedResults(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				strToValueFun.apply("3"),
+				null,
+				strToValueFun.apply("10")
+		);
 	}
+}
 
-	/**
-	 * Test for StringLastValueWithRetractAggFunction.
-	 */
-	public static class StringLastValueWithRetractAggFunctionWithOrderTest
-			extends LastValueWithRetractAggFunctionWithOrderTest<BinaryString> {
-
-		@Override
-		protected List<List<BinaryString>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("ghi"),
-							null,
-							BinaryString.fromString("jkl"),
-							null,
-							BinaryString.fromString("zzz"),
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("abc")
-					),
-					Arrays.asList(
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							BinaryString.fromString("a")
-					),
-					Arrays.asList(
-							BinaryString.fromString("x"),
-							null,
-							BinaryString.fromString("e")
-					)
-			);
-		}
-
-		@Override
-		protected List<List<Long>> getInputOrderSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							10L,
-							2L,
-							5L,
-							null,
-							3L,
-							1L,
-							5L,
-							10L,
-							15L,
-							11L
-					),
-					Arrays.asList(
-							6L,
-							5L
-					),
-					Arrays.asList(
-							8L,
-							6L
-					),
-					Arrays.asList(
-							6L,
-							4L,
-							3L
-					)
-			);
-		}
-
-		@Override
-		protected List<BinaryString> getExpectedResults() {
-			return Arrays.asList(
-					BinaryString.fromString("def"),
-					null,
-					BinaryString.fromString("a"),
-					BinaryString.fromString("x")
-			);
-		}
 
-		@Override
-		protected AggregateFunction<BinaryString, GenericRow> getAggregator() {
-			return new StringLastValueWithRetractAggFunction();
-		}
-	}
-}
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueWithRetractAggFunctionWithoutOrderTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueWithRetractAggFunctionWithoutOrderTest.java
index 6face9767c2..774f82e0051 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueWithRetractAggFunctionWithoutOrderTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/LastValueWithRetractAggFunctionWithoutOrderTest.java
@@ -33,325 +33,251 @@ import org.apache.flink.table.planner.functions.aggfunctions.LastValueWithRetrac
 import org.apache.flink.table.planner.functions.aggfunctions.LastValueWithRetractAggFunction.StringLastValueWithRetractAggFunction;
 import org.apache.flink.table.runtime.typeutils.DecimalTypeInfo;
 
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
 import java.lang.reflect.Method;
 import java.util.Arrays;
 import java.util.List;
+import java.util.function.Function;
 
 /**
  * Test case for built-in LastValue with retract aggregate function.
  * This class tests `accumulate` method without order argument.
  */
-public abstract class LastValueWithRetractAggFunctionWithoutOrderTest<T> extends AggFunctionTestBase<T, GenericRow> {
-
-	@Override
-	protected Class<?> getAccClass() {
-		return GenericRow.class;
-	}
+@RunWith(Parameterized.class)
+public class LastValueWithRetractAggFunctionWithoutOrderTest<T> extends AggFunctionTestBase<T, GenericRow> {
 
-	@Override
-	protected Method getRetractFunc() throws NoSuchMethodException {
-		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class);
-	}
-
-	/**
-	 * Test LastValueWithRetractAggFunction for number type.
-	 */
-	public abstract static class NumberLastValueWithRetractAggFunctionWithoutOrderTest<T>
-			extends LastValueWithRetractAggFunctionWithoutOrderTest<T> {
-		protected abstract T getValue(String v);
+	@Parameterized.Parameter
+	public AggFunctionTestSpec<T, GenericRow> aggFunctionTestSpec;
 
-		@Override
-		protected List<List<T>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							getValue("1"),
-							null,
-							getValue("-99"),
-							getValue("3"),
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							getValue("10"),
-							null,
-							getValue("3")
-					)
-			);
-		}
+	private static final int DECIMAL_PRECISION = 20;
+	private static final int DECIMAL_SCALE = 6;
 
-		@Override
-		protected List<T> getExpectedResults() {
-			return Arrays.asList(
-					getValue("3"),
-					null,
-					getValue("3")
-			);
-		}
-	}
-
-	/**
-	 * Test for ByteLastValueWithRetractAggFunction.
-	 */
-	public static class ByteLastValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithoutOrderTest<Byte> {
-
-		@Override
-		protected Byte getValue(String v) {
-			return Byte.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Byte, GenericRow> getAggregator() {
-			return new ByteLastValueWithRetractAggFunction();
-		}
-	}
-
-	/**
-	 * Test for ShortLastValueWithRetractAggFunction.
-	 */
-	public static class ShortLastValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithoutOrderTest<Short> {
-
-		@Override
-		protected Short getValue(String v) {
-			return Short.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Short, GenericRow> getAggregator() {
-			return new ShortLastValueWithRetractAggFunction();
-		}
+	@Override
+	protected List<List<T>> getInputValueSets() {
+		return aggFunctionTestSpec.inputValueSets;
 	}
 
-	/**
-	 * Test for IntLastValueWithRetractAggFunction.
-	 */
-	public static class IntLastValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithoutOrderTest<Integer> {
-
-		@Override
-		protected Integer getValue(String v) {
-			return Integer.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Integer, GenericRow> getAggregator() {
-			return new IntLastValueWithRetractAggFunction();
-		}
+	@Override
+	protected List<T> getExpectedResults() {
+		return aggFunctionTestSpec.expectedResults;
 	}
 
-	/**
-	 * Test for LongLastValueWithRetractAggFunction.
-	 */
-	public static class LongLastValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithoutOrderTest<Long> {
-
-		@Override
-		protected Long getValue(String v) {
-			return Long.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Long, GenericRow> getAggregator() {
-			return new LongLastValueWithRetractAggFunction();
-		}
+	@Override
+	protected AggregateFunction<T, GenericRow> getAggregator() {
+		return aggFunctionTestSpec.aggregator;
 	}
 
-	/**
-	 * Test for FloatLastValueWithRetractAggFunction.
-	 */
-	public static class FloatLastValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithoutOrderTest<Float> {
-
-		@Override
-		protected Float getValue(String v) {
-			return Float.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Float, GenericRow> getAggregator() {
-			return new FloatLastValueWithRetractAggFunction();
-		}
+	@Override
+	protected Class<?> getAccClass() {
+		return GenericRow.class;
 	}
 
-	/**
-	 * Test for DoubleLastValueWithRetractAggFunction.
-	 */
-	public static class DoubleLastValueWithRetractAggFunctionWithoutOrderTest
-			extends NumberLastValueWithRetractAggFunctionWithoutOrderTest<Double> {
-
-		@Override
-		protected Double getValue(String v) {
-			return Double.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Double, GenericRow> getAggregator() {
-			return new DoubleLastValueWithRetractAggFunction();
-		}
+	@Override
+	protected Method getRetractFunc() throws NoSuchMethodException {
+		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class);
 	}
 
-	/**
-	 * Test for BooleanLastValueWithRetractAggFunction.
-	 */
-	public static class BooleanLastValueWithRetractAggFunctionWithoutOrderTest extends
-			LastValueWithRetractAggFunctionWithoutOrderTest<Boolean> {
-
-		@Override
-		protected List<List<Boolean>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							false,
-							false,
-							false
-					),
-					Arrays.asList(
-							true,
-							true,
-							true
-					),
-					Arrays.asList(
-							true,
-							false,
-							null,
-							true,
-							false,
-							true,
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							true
-					));
-		}
-
-		@Override
-		protected List<Boolean> getExpectedResults() {
-			return Arrays.asList(
-					false,
-					true,
-					true,
-					null,
-					true
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Boolean, GenericRow> getAggregator() {
-			return new BooleanLastValueWithRetractAggFunction();
-		}
+	@Parameterized.Parameters(name = "{index}: {0}")
+	public static List<AggFunctionTestSpec> testData() {
+		return Arrays.asList(
+				/**
+				 * Test for ByteLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ByteLastValueWithRetractAggFunction(),
+						numberInputValueSets(Byte::valueOf),
+						numberExpectedResults(Byte::valueOf)
+				),
+				/**
+				 * Test for ShortLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ShortLastValueWithRetractAggFunction(),
+						numberInputValueSets(Short::valueOf),
+						numberExpectedResults(Short::valueOf)
+				),
+				/**
+				 * Test for IntLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new IntLastValueWithRetractAggFunction(),
+						numberInputValueSets(Integer::valueOf),
+						numberExpectedResults(Integer::valueOf)
+				),
+				/**
+				 * Test for LongLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new LongLastValueWithRetractAggFunction(),
+						numberInputValueSets(Long::valueOf),
+						numberExpectedResults(Long::valueOf)
+				),
+				/**
+				 * Test for FloatLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new FloatLastValueWithRetractAggFunction(),
+						numberInputValueSets(Float::valueOf),
+						numberExpectedResults(Float::valueOf)
+				),
+				/**
+				 * Test for DoubleLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DoubleLastValueWithRetractAggFunction(),
+						numberInputValueSets(Double::valueOf),
+						numberExpectedResults(Double::valueOf)
+				),
+				/**
+				 * Test for BooleanLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new BooleanLastValueWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										false,
+										false,
+										false
+								),
+								Arrays.asList(
+										true,
+										true,
+										true
+								),
+								Arrays.asList(
+										true,
+										false,
+										null,
+										true,
+										false,
+										true,
+										null
+								),
+								Arrays.asList(
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										true
+								)
+						),
+						Arrays.asList(
+								false,
+								true,
+								true,
+								null,
+								true
+						)
+				),
+				/**
+				 * Test for DecimalLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DecimalLastValueWithRetractAggFunction(
+								DecimalTypeInfo.of(DECIMAL_PRECISION, DECIMAL_SCALE)),
+						Arrays.asList(
+								Arrays.asList(
+										Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("1000.000001", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.998999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+								)
+						),
+						Arrays.asList(
+								Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+								null,
+								Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+						)
+				),
+				/**
+				 * Test for StringLastValueWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new StringLastValueWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("ghi"),
+										null,
+										BinaryString.fromString("jkl"),
+										null,
+										BinaryString.fromString("zzz")
+								),
+								Arrays.asList(
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										BinaryString.fromString("a")
+								),
+								Arrays.asList(
+										BinaryString.fromString("x"),
+										null,
+										BinaryString.fromString("e")
+								)
+						),
+						Arrays.asList(
+								BinaryString.fromString("zzz"),
+								null,
+								BinaryString.fromString("a"),
+								BinaryString.fromString("e")
+						)
+				)
+
+		);
 	}
 
-	/**
-	 * Test for DecimalLastValueWithRetractAggFunction.
-	 */
-	public static class DecimalLastValueWithRetractAggFunctionWithoutOrderTest extends
-			LastValueWithRetractAggFunctionWithoutOrderTest<Decimal> {
-
-		private int precision = 20;
-		private int scale = 6;
-
-		@Override
-		protected List<List<Decimal>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							Decimal.castFrom("1", precision, scale),
-							Decimal.castFrom("1000.000001", precision, scale),
-							Decimal.castFrom("-1", precision, scale),
-							Decimal.castFrom("-999.998999", precision, scale),
-							null,
-							Decimal.castFrom("0", precision, scale),
-							Decimal.castFrom("-999.999", precision, scale),
-							null,
-							Decimal.castFrom("999.999", precision, scale)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							Decimal.castFrom("0", precision, scale)
-					)
-			);
-		}
-
-		@Override
-		protected List<Decimal> getExpectedResults() {
-			return Arrays.asList(
-					Decimal.castFrom("999.999", precision, scale),
-					null,
-					Decimal.castFrom("0", precision, scale)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Decimal, GenericRow> getAggregator() {
-			return new DecimalLastValueWithRetractAggFunction(DecimalTypeInfo.of(precision, scale));
-		}
+	private static <N> List<List<N>> numberInputValueSets(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				Arrays.asList(
+						strToValueFun.apply("1"),
+						null,
+						strToValueFun.apply("-99"),
+						strToValueFun.apply("3"),
+						null
+				),
+				Arrays.asList(
+						null,
+						null,
+						null,
+						null
+				),
+				Arrays.asList(
+						null,
+						strToValueFun.apply("10"),
+						null,
+						strToValueFun.apply("3")
+				)
+		);
 	}
 
-	/**
-	 * Test for StringLastValueWithRetractAggFunction.
-	 */
-	public static class StringLastValueWithRetractAggFunctionWithoutOrderTest extends
-			LastValueWithRetractAggFunctionWithoutOrderTest<BinaryString> {
-
-		@Override
-		protected List<List<BinaryString>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("ghi"),
-							null,
-							BinaryString.fromString("jkl"),
-							null,
-							BinaryString.fromString("zzz")
-					),
-					Arrays.asList(
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							BinaryString.fromString("a")
-					),
-					Arrays.asList(
-							BinaryString.fromString("x"),
-							null,
-							BinaryString.fromString("e")
-					)
-			);
-		}
-
-		@Override
-		protected List<BinaryString> getExpectedResults() {
-			return Arrays.asList(
-					BinaryString.fromString("zzz"),
-					null,
-					BinaryString.fromString("a"),
-					BinaryString.fromString("e")
-			);
-		}
-
-		@Override
-		protected AggregateFunction<BinaryString, GenericRow> getAggregator() {
-			return new StringLastValueWithRetractAggFunction();
-		}
+	private static <N> List<N> numberExpectedResults(Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				strToValueFun.apply("3"),
+				null,
+				strToValueFun.apply("3")
+		);
 	}
 }
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/ListAggWsWithRetractAggFunctionTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/ListAggWsWithRetractAggFunctionTest.java
index 67ee8ffa6b2..3f845ce7e27 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/ListAggWsWithRetractAggFunctionTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/ListAggWsWithRetractAggFunctionTest.java
@@ -18,6 +18,7 @@
 
 package org.apache.flink.table.planner.functions.aggfunctions;
 
+import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.java.tuple.Tuple2;
 import org.apache.flink.table.dataformat.BinaryString;
 import org.apache.flink.table.functions.AggregateFunction;
@@ -105,14 +106,14 @@ public class ListAggWsWithRetractAggFunctionTest
 	}
 
 	@Override
-	protected <E> void validateResult(E expected, E result) {
+	protected <E> void validateResult(E expected, E result, TypeInformation<?> typeInfo) {
 		if (expected instanceof ListAggWsWithRetractAccumulator && result instanceof ListAggWsWithRetractAccumulator) {
 			ListAggWsWithRetractAccumulator e = (ListAggWsWithRetractAccumulator) expected;
 			ListAggWsWithRetractAccumulator r = (ListAggWsWithRetractAccumulator) result;
 			assertEquals(e.list, r.list);
 			assertEquals(e.list, r.list);
 		} else {
-			super.validateResult(expected, result);
+			super.validateResult(expected, result, typeInfo);
 		}
 	}
 
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/MaxWithRetractAggFunctionTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/MaxWithRetractAggFunctionTest.java
index 2bd0a7e3380..9f930e4308b 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/MaxWithRetractAggFunctionTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/MaxWithRetractAggFunctionTest.java
@@ -36,529 +36,351 @@ import org.apache.flink.table.planner.functions.aggfunctions.MaxWithRetractAggFu
 import org.apache.flink.table.planner.functions.aggfunctions.MaxWithRetractAggFunction.TimestampMaxWithRetractAggFunction;
 import org.apache.flink.table.runtime.typeutils.DecimalTypeInfo;
 
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
 import java.lang.reflect.Method;
 import java.sql.Date;
 import java.sql.Time;
 import java.sql.Timestamp;
 import java.util.Arrays;
 import java.util.List;
+import java.util.function.Function;
 
 /**
  * Test case for built-in Max with retraction aggregate function.
  */
-public abstract class MaxWithRetractAggFunctionTest<T> extends AggFunctionTestBase<T, MaxWithRetractAccumulator<T>> {
-
-	@Override
-	protected Class<?> getAccClass() {
-		return MaxWithRetractAccumulator.class;
-	}
-
-	@Override
-	protected Method getRetractFunc() throws NoSuchMethodException {
-		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class);
-	}
-
-	/**
-	 * Test MaxWithRetractAggFunction for number type.
-	 */
-	public abstract static class NumberMaxWithRetractAggFunctionTest<T> extends MaxWithRetractAggFunctionTest {
-		protected abstract T getMinValue();
-
-		protected abstract T getMaxValue();
-
-		protected abstract T getValue(String v);
-
-		@Override
-		protected List<List<T>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							getValue("1"),
-							null,
-							getMaxValue(),
-							getValue("-99"),
-							getValue("3"),
-							getValue("56"),
-							getValue("0"),
-							getMinValue(),
-							getValue("-20"),
-							getValue("17"),
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							getValue("10")
-					)
-			);
-		}
-
-		@Override
-		protected List<T> getExpectedResults() {
-			return Arrays.asList(
-					getMaxValue(),
-					null,
-					getValue("10")
-			);
-		}
-	}
-
-	/**
-	 * Test for ByteMaxWithRetractAggFunction.
-	 */
-	public static class ByteMaxWithRetractAggFunctionTest extends NumberMaxWithRetractAggFunctionTest<Byte> {
-
-		@Override
-		protected Byte getMinValue() {
-			return Byte.MIN_VALUE + 1;
-		}
-
-		@Override
-		protected Byte getMaxValue() {
-			return Byte.MAX_VALUE - 1;
-		}
+@RunWith(Parameterized.class)
+public class MaxWithRetractAggFunctionTest<T> extends AggFunctionTestBase<T, MaxWithRetractAccumulator<T>> {
 
-		@Override
-		protected Byte getValue(String v) {
-			return Byte.valueOf(v);
-		}
+	@Parameterized.Parameter
+	public AggFunctionTestSpec<T, MaxWithRetractAccumulator<T>> aggFunctionTestSpec;
 
-		@Override
-		protected AggregateFunction<Byte, MaxWithRetractAccumulator<Byte>> getAggregator() {
-			return new ByteMaxWithRetractAggFunction();
-		}
-	}
-
-	/**
-	 * Test for ShortMaxWithRetractAggFunction.
-	 */
-	public static class ShortMaxWithRetractAggFunctionTest extends NumberMaxWithRetractAggFunctionTest<Short> {
-
-		@Override
-		protected Short getMinValue() {
-			return Short.MIN_VALUE + 1;
-		}
-
-		@Override
-		protected Short getMaxValue() {
-			return Short.MAX_VALUE - 1;
-		}
-
-		@Override
-		protected Short getValue(String v) {
-			return Short.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Short, MaxWithRetractAccumulator<Short>> getAggregator() {
-			return new ShortMaxWithRetractAggFunction();
-		}
-	}
-
-	/**
-	 * Test for IntMaxWithRetractAggFunction.
-	 */
-	public static class IntMaxWithRetractAggFunctionTest extends NumberMaxWithRetractAggFunctionTest<Integer> {
-
-		@Override
-		protected Integer getMinValue() {
-			return Integer.MIN_VALUE + 1;
-		}
-
-		@Override
-		protected Integer getMaxValue() {
-			return Integer.MAX_VALUE - 1;
-		}
-
-		@Override
-		protected Integer getValue(String v) {
-			return Integer.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Integer, MaxWithRetractAccumulator<Integer>> getAggregator() {
-			return new IntMaxWithRetractAggFunction();
-		}
-	}
-
-	/**
-	 * Test for LongMaxWithRetractAggFunction.
-	 */
-	public static class LongMaxWithRetractAggFunctionTest extends NumberMaxWithRetractAggFunctionTest<Long> {
-
-		@Override
-		protected Long getMinValue() {
-			return Long.MIN_VALUE + 1;
-		}
-
-		@Override
-		protected Long getMaxValue() {
-			return Long.MAX_VALUE - 1;
-		}
-
-		@Override
-		protected Long getValue(String v) {
-			return Long.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Long, MaxWithRetractAccumulator<Long>> getAggregator() {
-			return new LongMaxWithRetractAggFunction();
-		}
-	}
+	private static final int DECIMAL_PRECISION = 20;
+	private static final int DECIMAL_SCALE = 6;
 
-	/**
-	 * Test for FloatMaxWithRetractAggFunction.
-	 */
-	public static class FloatMaxWithRetractAggFunctionTest extends NumberMaxWithRetractAggFunctionTest<Float> {
-
-		@Override
-		protected Float getMinValue() {
-			return -Float.MAX_VALUE / 2;
-		}
-
-		@Override
-		protected Float getMaxValue() {
-			return Float.MAX_VALUE / 2;
-		}
-
-		@Override
-		protected Float getValue(String v) {
-			return Float.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Float, MaxWithRetractAccumulator<Float>> getAggregator() {
-			return new FloatMaxWithRetractAggFunction();
-		}
+	@Override
+	protected List<List<T>> getInputValueSets() {
+		return aggFunctionTestSpec.inputValueSets;
 	}
 
-	/**
-	 * Test for DoubleMaxWithRetractAggFunction.
-	 */
-	public static class DoubleMaxWithRetractAggFunctionTest extends NumberMaxWithRetractAggFunctionTest<Double> {
-
-		@Override
-		protected Double getMinValue() {
-			return -Double.MAX_VALUE / 2;
-		}
-
-		@Override
-		protected Double getMaxValue() {
-			return Double.MAX_VALUE / 2;
-		}
-
-		@Override
-		protected Double getValue(String v) {
-			return Double.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Double, MaxWithRetractAccumulator<Double>> getAggregator() {
-			return new DoubleMaxWithRetractAggFunction();
-		}
+	@Override
+	protected List<T> getExpectedResults() {
+		return aggFunctionTestSpec.expectedResults;
 	}
 
-	/**
-	 * Test for BooleanMaxWithRetractAggFunction.
-	 */
-	public static class BooleanMaxWithRetractAggFunctionTest extends MaxWithRetractAggFunctionTest<Boolean> {
-
-		@Override
-		protected List<List<Boolean>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							false,
-							false,
-							false
-					),
-					Arrays.asList(
-							true,
-							true,
-							true
-					),
-					Arrays.asList(
-							true,
-							false,
-							null,
-							true,
-							false,
-							true,
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							true
-					));
-		}
-
-		@Override
-		protected List<Boolean> getExpectedResults() {
-			return Arrays.asList(
-					false,
-					true,
-					true,
-					null,
-					true
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Boolean, MaxWithRetractAccumulator<Boolean>> getAggregator() {
-			return new BooleanMaxWithRetractAggFunction();
-		}
-
-		@Override
-		protected Class<?> getAccClass() {
-			return MaxWithRetractAccumulator.class;
-		}
-
-		@Override
-		protected Method getRetractFunc() throws NoSuchMethodException {
-			return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class);
-		}
+	@Override
+	protected AggregateFunction<T, MaxWithRetractAccumulator<T>> getAggregator() {
+		return aggFunctionTestSpec.aggregator;
 	}
 
-	/**
-	 * Test for DecimalMaxWithRetractAggFunction.
-	 */
-	public static class DecimalMaxWithRetractAggFunctionTest extends MaxWithRetractAggFunctionTest<Decimal> {
-
-		private int precision = 20;
-		private int scale = 6;
-
-		@Override
-		protected List<List<Decimal>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							Decimal.castFrom("1", precision, scale),
-							Decimal.castFrom("1000.000001", precision, scale),
-							Decimal.castFrom("-1", precision, scale),
-							Decimal.castFrom("-999.998999", precision, scale),
-							null,
-							Decimal.castFrom("0", precision, scale),
-							Decimal.castFrom("-999.999", precision, scale),
-							null,
-							Decimal.castFrom("999.999", precision, scale)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							Decimal.castFrom("0", precision, scale)
-					)
-			);
-		}
-
-		@Override
-		protected List<Decimal> getExpectedResults() {
-			return Arrays.asList(
-					Decimal.castFrom("1000.000001", precision, scale),
-					null,
-					Decimal.castFrom("0", precision, scale)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Decimal, MaxWithRetractAccumulator<Decimal>> getAggregator() {
-			return new DecimalMaxWithRetractAggFunction(DecimalTypeInfo.of(precision, scale));
-		}
+	@Override
+	protected Class<?> getAccClass() {
+		return MaxWithRetractAccumulator.class;
 	}
 
-	/**
-	 * Test for StringMaxWithRetractAggFunction.
-	 */
-	public static class StringMaxWithRetractAggFunctionTest extends MaxWithRetractAggFunctionTest<BinaryString> {
-
-		@Override
-		protected List<List<BinaryString>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("ghi"),
-							null,
-							BinaryString.fromString("jkl"),
-							null,
-							BinaryString.fromString("zzz")
-					),
-					Arrays.asList(
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							BinaryString.fromString("a")
-					),
-					Arrays.asList(
-							BinaryString.fromString("x"),
-							null,
-							BinaryString.fromString("e")
-					)
-			);
-		}
-
-		@Override
-		protected List<BinaryString> getExpectedResults() {
-			return Arrays.asList(
-					BinaryString.fromString("zzz"),
-					null,
-					BinaryString.fromString("a"),
-					BinaryString.fromString("x")
-			);
-		}
-
-		@Override
-		protected AggregateFunction<BinaryString, MaxWithRetractAccumulator<BinaryString>> getAggregator() {
-			return new StringMaxWithRetractAggFunction();
-		}
+	@Override
+	protected Method getRetractFunc() throws NoSuchMethodException {
+		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class);
 	}
 
-	/**
-	 * Test for TimestampMaxWithRetractAggFunction.
-	 */
-	public static class TimestampMaxWithRetractAggFunctionTest extends MaxWithRetractAggFunctionTest<Timestamp> {
-
-		@Override
-		protected List<List<Timestamp>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							new Timestamp(0),
-							new Timestamp(1000),
-							new Timestamp(100),
-							null,
-							new Timestamp(10)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							new Timestamp(1)
-					)
-			);
-		}
-
-		@Override
-		protected List<Timestamp> getExpectedResults() {
-			return Arrays.asList(
-					new Timestamp(1000),
-					null,
-					new Timestamp(1)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Timestamp, MaxWithRetractAccumulator<Timestamp>> getAggregator() {
-			return new TimestampMaxWithRetractAggFunction();
-		}
+	@Parameterized.Parameters(name = "{index}: {0}")
+	public static List<AggFunctionTestSpec> testData() {
+		return Arrays.asList(
+				/**
+				 * Test for ByteMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ByteMaxWithRetractAggFunction(),
+						numberInputValueSets((byte) (Byte.MIN_VALUE + 1), (byte) (Byte.MAX_VALUE - 1), Byte::valueOf),
+						numberExpectedResults((byte) (Byte.MAX_VALUE - 1), Byte::valueOf)
+				),
+				/**
+				 * Test for ShortMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ShortMaxWithRetractAggFunction(),
+						numberInputValueSets(
+								(short) (Short.MIN_VALUE + 1), (short) (Short.MAX_VALUE - 1), Short::valueOf),
+						numberExpectedResults((short) (Short.MAX_VALUE - 1), Short::valueOf)
+				),
+				/**
+				 * Test for IntMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new IntMaxWithRetractAggFunction(),
+						numberInputValueSets(Integer.MIN_VALUE + 1, Integer.MAX_VALUE - 1, Integer::valueOf),
+						numberExpectedResults(Integer.MAX_VALUE - 1, Integer::valueOf)
+				),
+				/**
+				 * Test for LongMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new LongMaxWithRetractAggFunction(),
+						numberInputValueSets(Long.MIN_VALUE + 1L, Long.MAX_VALUE - 1L, Long::valueOf),
+						numberExpectedResults(Long.MAX_VALUE - 1L, Long::valueOf)
+				),
+				/**
+				 * Test for FloatMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new FloatMaxWithRetractAggFunction(),
+						numberInputValueSets((-Float.MAX_VALUE / 2), (Float.MAX_VALUE / 2), Float::valueOf),
+						numberExpectedResults((Float.MAX_VALUE / 2), Float::valueOf)
+				),
+				/**
+				 * Test for DoubleMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DoubleMaxWithRetractAggFunction(),
+						numberInputValueSets((-Double.MAX_VALUE / 2), (Double.MAX_VALUE / 2), Double::valueOf),
+						numberExpectedResults((Double.MAX_VALUE / 2), Double::valueOf)
+				),
+				/**
+				 * Test for BooleanMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new BooleanMaxWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										false,
+										false,
+										false
+								),
+								Arrays.asList(
+										true,
+										true,
+										true
+								),
+								Arrays.asList(
+										true,
+										false,
+										null,
+										true,
+										false,
+										true,
+										null
+								),
+								Arrays.asList(
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										true
+								)
+						),
+						Arrays.asList(
+								false,
+								true,
+								true,
+								null,
+								true
+						)
+				),
+				/**
+				 * Test for DecimalMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DecimalMaxWithRetractAggFunction(DecimalTypeInfo.of(DECIMAL_PRECISION, DECIMAL_SCALE)),
+						Arrays.asList(
+								Arrays.asList(
+										Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("1000.000001", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.998999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+								)
+						),
+						Arrays.asList(
+								Decimal.castFrom("1000.000001", DECIMAL_PRECISION, DECIMAL_SCALE),
+								null,
+								Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+						)
+				),
+				/**
+				 * Test for StringMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new StringMaxWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("ghi"),
+										null,
+										BinaryString.fromString("jkl"),
+										null,
+										BinaryString.fromString("zzz")
+								),
+								Arrays.asList(
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										BinaryString.fromString("a")
+								),
+								Arrays.asList(
+										BinaryString.fromString("x"),
+										null,
+										BinaryString.fromString("e")
+								)
+						),
+						Arrays.asList(
+								BinaryString.fromString("zzz"),
+								null,
+								BinaryString.fromString("a"),
+								BinaryString.fromString("x")
+						)
+				),
+				/**
+				 * Test for TimestampMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new TimestampMaxWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										new Timestamp(0),
+										new Timestamp(1000),
+										new Timestamp(100),
+										null,
+										new Timestamp(10)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										new Timestamp(1)
+								)
+						),
+						Arrays.asList(
+								new Timestamp(1000),
+								null,
+								new Timestamp(1)
+						)
+				),
+				/**
+				 * Test for DateMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DateMaxWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										new Date(0),
+										new Date(1000),
+										new Date(100),
+										null,
+										new Date(10)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										new Date(1)
+								)
+						),
+						Arrays.asList(
+								new Date(1000),
+								null,
+								new Date(1)
+						)
+				),
+				/**
+				 * Test for TimeMaxWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new TimeMaxWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										new Time(0),
+										new Time(1000),
+										new Time(100),
+										null,
+										new Time(10)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										new Time(1)
+								)
+						),
+						Arrays.asList(
+								new Time(1000),
+								null,
+								new Time(1)
+						)
+				)
+		);
 	}
 
-	/**
-	 * Test for DateMaxWithRetractAggFunction.
-	 */
-	public static class DateMaxWithRetractAggFunctionTest extends MaxWithRetractAggFunctionTest<Date> {
-
-		@Override
-		protected List<List<Date>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							new Date(0),
-							new Date(1000),
-							new Date(100),
-							null,
-							new Date(10)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							new Date(1)
-					)
-			);
-		}
-
-		@Override
-		protected List<Date> getExpectedResults() {
-			return Arrays.asList(
-					new Date(1000),
-					null,
-					new Date(1)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Date, MaxWithRetractAccumulator<Date>> getAggregator() {
-			return new DateMaxWithRetractAggFunction();
-		}
+	private static <N> List<List<N>> numberInputValueSets(N minValue, N maxValue, Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				Arrays.asList(
+						strToValueFun.apply("1"),
+						null,
+						maxValue,
+						strToValueFun.apply("-99"),
+						strToValueFun.apply("3"),
+						strToValueFun.apply("56"),
+						strToValueFun.apply("0"),
+						minValue,
+						strToValueFun.apply("-20"),
+						strToValueFun.apply("17"),
+						null
+				),
+				Arrays.asList(
+						null,
+						null,
+						null,
+						null,
+						null,
+						null
+				),
+				Arrays.asList(
+						null,
+						strToValueFun.apply("10")
+				)
+		);
 	}
 
-	/**
-	 * Test for TimeMaxWithRetractAggFunction.
-	 */
-	public static class TimeMaxWithRetractAggFunctionTest extends MaxWithRetractAggFunctionTest<Time> {
-
-		@Override
-		protected List<List<Time>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							new Time(0),
-							new Time(1000),
-							new Time(100),
-							null,
-							new Time(10)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							new Time(1)
-					)
-			);
-		}
-
-		@Override
-		protected List<Time> getExpectedResults() {
-			return Arrays.asList(
-					new Time(1000),
-					null,
-					new Time(1)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Time, MaxWithRetractAccumulator<Time>> getAggregator() {
-			return new TimeMaxWithRetractAggFunction();
-		}
+	private static <N> List<N> numberExpectedResults(N maxValue, Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				maxValue,
+				null,
+				strToValueFun.apply("10")
+		);
 	}
 }
diff --git a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/MinWithRetractAggFunctionTest.java b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/MinWithRetractAggFunctionTest.java
index d3e650bbf30..e45225d5c48 100644
--- a/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/MinWithRetractAggFunctionTest.java
+++ b/flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/functions/aggfunctions/MinWithRetractAggFunctionTest.java
@@ -36,521 +36,351 @@ import org.apache.flink.table.planner.functions.aggfunctions.MinWithRetractAggFu
 import org.apache.flink.table.planner.functions.aggfunctions.MinWithRetractAggFunction.TimestampMinWithRetractAggFunction;
 import org.apache.flink.table.runtime.typeutils.DecimalTypeInfo;
 
+import org.junit.runner.RunWith;
+import org.junit.runners.Parameterized;
+
 import java.lang.reflect.Method;
 import java.sql.Date;
 import java.sql.Time;
 import java.sql.Timestamp;
 import java.util.Arrays;
 import java.util.List;
+import java.util.function.Function;
 
 /**
  * Test case for built-in Min with retraction aggregate function.
  */
-public abstract class MinWithRetractAggFunctionTest<T> extends AggFunctionTestBase<T, MinWithRetractAccumulator<T>> {
-
-	@Override
-	protected Class<?> getAccClass() {
-		return MinWithRetractAccumulator.class;
-	}
-
-	@Override
-	protected Method getRetractFunc() throws NoSuchMethodException {
-		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class);
-	}
-
-	/**
-	 * Test MinWithRetractAggFunction for number type.
-	 */
-	public abstract static class NumberMinWithRetractAggFunctionTest<T> extends MinWithRetractAggFunctionTest<T> {
-		protected abstract T getMinValue();
-
-		protected abstract T getMaxValue();
-
-		protected abstract T getValue(String v);
-
-		@Override
-		protected List<List<T>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							getValue("1"),
-							null,
-							getMaxValue(),
-							getValue("-99"),
-							getValue("3"),
-							getValue("56"),
-							getValue("0"),
-							getMinValue(),
-							getValue("-20"),
-							getValue("17"),
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							getValue("10")
-					)
-			);
-		}
-
-		@Override
-		protected List<T> getExpectedResults() {
-			return Arrays.asList(
-					getMinValue(),
-					null,
-					getValue("10")
-			);
-		}
-	}
-
-	/**
-	 * Test for ByteMinWithRetractAggFunction.
-	 */
-	public static class ByteMinWithRetractAggFunctionTest extends NumberMinWithRetractAggFunctionTest<Byte> {
-
-		@Override
-		protected Byte getMinValue() {
-			return Byte.MIN_VALUE + 1;
-		}
+@RunWith(Parameterized.class)
+public class MinWithRetractAggFunctionTest<T> extends AggFunctionTestBase<T, MinWithRetractAccumulator<T>> {
 
-		@Override
-		protected Byte getMaxValue() {
-			return Byte.MAX_VALUE - 1;
-		}
+	@Parameterized.Parameter
+	public AggFunctionTestSpec<T, MinWithRetractAccumulator<T>> aggFunctionTestSpec;
 
-		@Override
-		protected Byte getValue(String v) {
-			return Byte.valueOf(v);
-		}
+	private static final int DECIMAL_PRECISION = 20;
+	private static final int DECIMAL_SCALE = 6;
 
-		@Override
-		protected AggregateFunction<Byte, MinWithRetractAccumulator<Byte>> getAggregator() {
-			return new ByteMinWithRetractAggFunction();
-		}
-	}
-
-	/**
-	 * Test for ShortMinWithRetractAggFunction.
-	 */
-	public static class ShortMinWithRetractAggFunctionTest extends NumberMinWithRetractAggFunctionTest<Short> {
-
-		@Override
-		protected Short getMinValue() {
-			return Short.MIN_VALUE + 1;
-		}
-
-		@Override
-		protected Short getMaxValue() {
-			return Short.MAX_VALUE - 1;
-		}
-
-		@Override
-		protected Short getValue(String v) {
-			return Short.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Short, MinWithRetractAccumulator<Short>> getAggregator() {
-			return new ShortMinWithRetractAggFunction();
-		}
-	}
-
-	/**
-	 * Test for IntMinWithRetractAggFunction.
-	 */
-	public static class IntMinWithRetractAggFunctionTest extends NumberMinWithRetractAggFunctionTest<Integer> {
-
-		@Override
-		protected Integer getMinValue() {
-			return Integer.MIN_VALUE + 1;
-		}
-
-		@Override
-		protected Integer getMaxValue() {
-			return Integer.MAX_VALUE - 1;
-		}
-
-		@Override
-		protected Integer getValue(String v) {
-			return Integer.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Integer, MinWithRetractAccumulator<Integer>> getAggregator() {
-			return new IntMinWithRetractAggFunction();
-		}
-	}
-
-	/**
-	 * Test for LongMinWithRetractAggFunction.
-	 */
-	public static class LongMinWithRetractAggFunctionTest extends NumberMinWithRetractAggFunctionTest<Long> {
-
-		@Override
-		protected Long getMinValue() {
-			return Long.MIN_VALUE + 1;
-		}
-
-		@Override
-		protected Long getMaxValue() {
-			return Long.MAX_VALUE - 1;
-		}
-
-		@Override
-		protected Long getValue(String v) {
-			return Long.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Long, MinWithRetractAccumulator<Long>> getAggregator() {
-			return new LongMinWithRetractAggFunction();
-		}
-	}
-
-	/**
-	 * Test for FloatMinWithRetractAggFunction.
-	 */
-	public static class FloatMinWithRetractAggFunctionTest extends NumberMinWithRetractAggFunctionTest<Float> {
-
-		@Override
-		protected Float getMinValue() {
-			return -Float.MAX_VALUE / 2;
-		}
-
-		@Override
-		protected Float getMaxValue() {
-			return Float.MAX_VALUE / 2;
-		}
-
-		@Override
-		protected Float getValue(String v) {
-			return Float.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Float, MinWithRetractAccumulator<Float>> getAggregator() {
-			return new FloatMinWithRetractAggFunction();
-		}
+	@Override
+	protected List<List<T>> getInputValueSets() {
+		return aggFunctionTestSpec.inputValueSets;
 	}
 
-	/**
-	 * Test for DoubleMinWithRetractAggFunction.
-	 */
-	public static class DoubleMinWithRetractAggFunctionTest extends NumberMinWithRetractAggFunctionTest<Double> {
-
-		@Override
-		protected Double getMinValue() {
-			return -Double.MAX_VALUE / 2;
-		}
-
-		@Override
-		protected Double getMaxValue() {
-			return Double.MAX_VALUE / 2;
-		}
-
-		@Override
-		protected Double getValue(String v) {
-			return Double.valueOf(v);
-		}
-
-		@Override
-		protected AggregateFunction<Double, MinWithRetractAccumulator<Double>> getAggregator() {
-			return new DoubleMinWithRetractAggFunction();
-		}
+	@Override
+	protected List<T> getExpectedResults() {
+		return aggFunctionTestSpec.expectedResults;
 	}
 
-	/**
-	 * Test for BooleanMinWithRetractAggFunction.
-	 */
-	public static class BooleanMinWithRetractAggFunctionTest extends MinWithRetractAggFunctionTest<Boolean> {
-
-		@Override
-		protected List<List<Boolean>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							false,
-							false,
-							false
-					),
-					Arrays.asList(
-							true,
-							true,
-							true
-					),
-					Arrays.asList(
-							true,
-							false,
-							null,
-							true,
-							false,
-							true,
-							null
-					),
-					Arrays.asList(
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							true
-					));
-		}
-
-		@Override
-		protected List<Boolean> getExpectedResults() {
-			return Arrays.asList(
-					false,
-					true,
-					false,
-					null,
-					true
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Boolean, MinWithRetractAccumulator<Boolean>> getAggregator() {
-			return new BooleanMinWithRetractAggFunction();
-		}
+	@Override
+	protected AggregateFunction<T, MinWithRetractAccumulator<T>> getAggregator() {
+		return aggFunctionTestSpec.aggregator;
 	}
 
-	/**
-	 * Test for DecimalMinWithRetractAggFunction.
-	 */
-	public static class DecimalMinWithRetractAggFunctionTest extends MinWithRetractAggFunctionTest<Decimal> {
-
-		private int precision = 20;
-		private int scale = 6;
-
-		@Override
-		protected List<List<Decimal>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							Decimal.castFrom("1", precision, scale),
-							Decimal.castFrom("1000", precision, scale),
-							Decimal.castFrom("-1", precision, scale),
-							Decimal.castFrom("-999.998999", precision, scale),
-							null,
-							Decimal.castFrom("0", precision, scale),
-							Decimal.castFrom("-999.999", precision, scale),
-							null,
-							Decimal.castFrom("999.999", precision, scale)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							Decimal.castFrom("0", precision, scale)
-					)
-			);
-		}
-
-		@Override
-		protected List<Decimal> getExpectedResults() {
-			return Arrays.asList(
-					Decimal.castFrom("-999.999", precision, scale),
-					null,
-					Decimal.castFrom("0", precision, scale)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Decimal, MinWithRetractAccumulator<Decimal>> getAggregator() {
-			return new DecimalMinWithRetractAggFunction(DecimalTypeInfo.of(precision, scale));
-		}
+	@Override
+	protected Class<?> getAccClass() {
+		return MinWithRetractAccumulator.class;
 	}
 
-	/**
-	 * Test for StringMinWithRetractAggFunction.
-	 */
-	public static class StringMinWithRetractAggFunctionTest
-			extends MinWithRetractAggFunctionTest<BinaryString> {
-
-		@Override
-		protected List<List<BinaryString>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							BinaryString.fromString("abc"),
-							BinaryString.fromString("def"),
-							BinaryString.fromString("ghi"),
-							null,
-							BinaryString.fromString("jkl"),
-							null,
-							BinaryString.fromString("zzz")
-					),
-					Arrays.asList(
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							BinaryString.fromString("a")
-					),
-					Arrays.asList(
-							BinaryString.fromString("x"),
-							null,
-							BinaryString.fromString("e")
-					)
-			);
-		}
-
-		@Override
-		protected List<BinaryString> getExpectedResults() {
-			return Arrays.asList(
-					BinaryString.fromString("abc"),
-					null,
-					BinaryString.fromString("a"),
-					BinaryString.fromString("e")
-			);
-		}
-
-		@Override
-		protected AggregateFunction<BinaryString, MinWithRetractAccumulator<BinaryString>> getAggregator() {
-			return new StringMinWithRetractAggFunction();
-		}
+	@Override
+	protected Method getRetractFunc() throws NoSuchMethodException {
+		return getAggregator().getClass().getMethod("retract", getAccClass(), Object.class);
 	}
 
-	/**
-	 * Test for TimestampMinWithRetractAggFunction.
-	 */
-	public static class TimestampMinWithRetractAggFunctionTest
-			extends MinWithRetractAggFunctionTest<Timestamp> {
-
-		@Override
-		protected List<List<Timestamp>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							new Timestamp(0),
-							new Timestamp(1000),
-							new Timestamp(100),
-							null,
-							new Timestamp(10)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							new Timestamp(1)
-					)
-			);
-		}
-
-		@Override
-		protected List<Timestamp> getExpectedResults() {
-			return Arrays.asList(
-					new Timestamp(0),
-					null,
-					new Timestamp(1)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Timestamp, MinWithRetractAccumulator<Timestamp>> getAggregator() {
-			return new TimestampMinWithRetractAggFunction();
-		}
+	@Parameterized.Parameters(name = "{index}: {0}")
+	public static List<AggFunctionTestSpec> testData() {
+		return Arrays.asList(
+				/**
+				 * Test for ByteMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ByteMinWithRetractAggFunction(),
+						numberInputValueSets((byte) (Byte.MIN_VALUE + 1), (byte) (Byte.MAX_VALUE - 1), Byte::valueOf),
+						numberExpectedResults((byte) (Byte.MIN_VALUE + 1), Byte::valueOf)
+				),
+				/**
+				 * Test for ShortMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new ShortMinWithRetractAggFunction(),
+						numberInputValueSets(
+								(short) (Short.MIN_VALUE + 1), (short) (Short.MAX_VALUE - 1), Short::valueOf),
+						numberExpectedResults((short) (Short.MIN_VALUE + 1), Short::valueOf)
+				),
+				/**
+				 * Test for IntMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new IntMinWithRetractAggFunction(),
+						numberInputValueSets(Integer.MIN_VALUE + 1, Integer.MAX_VALUE - 1, Integer::valueOf),
+						numberExpectedResults(Integer.MIN_VALUE + 1, Integer::valueOf)
+				),
+				/**
+				 * Test for LongMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new LongMinWithRetractAggFunction(),
+						numberInputValueSets(Long.MIN_VALUE + 1L, Long.MAX_VALUE - 1L, Long::valueOf),
+						numberExpectedResults(Long.MIN_VALUE + 1L, Long::valueOf)
+				),
+				/**
+				 * Test for FloatMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new FloatMinWithRetractAggFunction(),
+						numberInputValueSets((-Float.MAX_VALUE / 2), (Float.MAX_VALUE / 2), Float::valueOf),
+						numberExpectedResults((-Float.MAX_VALUE / 2), Float::valueOf)
+				),
+				/**
+				 * Test for DoubleMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DoubleMinWithRetractAggFunction(),
+						numberInputValueSets((-Double.MAX_VALUE / 2), (Double.MAX_VALUE / 2), Double::valueOf),
+						numberExpectedResults((-Double.MAX_VALUE / 2), Double::valueOf)
+				),
+				/**
+				 * Test for BooleanMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new BooleanMinWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										false,
+										false,
+										false
+								),
+								Arrays.asList(
+										true,
+										true,
+										true
+								),
+								Arrays.asList(
+										true,
+										false,
+										null,
+										true,
+										false,
+										true,
+										null
+								),
+								Arrays.asList(
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										true
+								)
+						),
+						Arrays.asList(
+								false,
+								true,
+								false,
+								null,
+								true
+						)
+				),
+				/**
+				 * Test for DecimalMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DecimalMinWithRetractAggFunction(DecimalTypeInfo.of(DECIMAL_PRECISION, DECIMAL_SCALE)),
+						Arrays.asList(
+								Arrays.asList(
+										Decimal.castFrom("1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("1000", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-1", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.998999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE),
+										Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+										null,
+										Decimal.castFrom("999.999", DECIMAL_PRECISION, DECIMAL_SCALE)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+								)
+						),
+						Arrays.asList(
+								Decimal.castFrom("-999.999", DECIMAL_PRECISION, DECIMAL_SCALE),
+								null,
+								Decimal.castFrom("0", DECIMAL_PRECISION, DECIMAL_SCALE)
+						)
+				),
+				/**
+				 * Test for StringMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new StringMinWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										BinaryString.fromString("abc"),
+										BinaryString.fromString("def"),
+										BinaryString.fromString("ghi"),
+										null,
+										BinaryString.fromString("jkl"),
+										null,
+										BinaryString.fromString("zzz")
+								),
+								Arrays.asList(
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										BinaryString.fromString("a")
+								),
+								Arrays.asList(
+										BinaryString.fromString("x"),
+										null,
+										BinaryString.fromString("e")
+								)
+						),
+						Arrays.asList(
+								BinaryString.fromString("abc"),
+								null,
+								BinaryString.fromString("a"),
+								BinaryString.fromString("e")
+						)
+				),
+				/**
+				 * Test for TimestampMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new TimestampMinWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										new Timestamp(0),
+										new Timestamp(1000),
+										new Timestamp(100),
+										null,
+										new Timestamp(10)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										new Timestamp(1)
+								)
+						),
+						Arrays.asList(
+								new Timestamp(0),
+								null,
+								new Timestamp(1)
+						)
+				),
+				/**
+				 * Test for DateMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new DateMinWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										new Date(0),
+										new Date(1000),
+										new Date(100),
+										null,
+										new Date(10)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										new Date(1)
+								)
+						),
+						Arrays.asList(
+								new Date(0),
+								null,
+								new Date(1)
+						)
+				),
+				/**
+				 * Test for TimeMinWithRetractAggFunction.
+				 */
+				new AggFunctionTestSpec<>(
+						new TimeMinWithRetractAggFunction(),
+						Arrays.asList(
+								Arrays.asList(
+										new Time(0),
+										new Time(1000),
+										new Time(100),
+										null,
+										new Time(10)
+								),
+								Arrays.asList(
+										null,
+										null,
+										null,
+										null,
+										null
+								),
+								Arrays.asList(
+										null,
+										new Time(1)
+								)
+						),
+						Arrays.asList(
+								new Time(0),
+								null,
+								new Time(1)
+						)
+				)
+		);
 	}
 
-	/**
-	 * Test for DateMinWithRetractAggFunction.
-	 */
-	public static class DateMinWithRetractAggFunctionTest extends MinWithRetractAggFunctionTest<Date> {
-
-		@Override
-		protected List<List<Date>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							new Date(0),
-							new Date(1000),
-							new Date(100),
-							null,
-							new Date(10)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							new Date(1)
-					)
-			);
-		}
-
-		@Override
-		protected List<Date> getExpectedResults() {
-			return Arrays.asList(
-					new Date(0),
-					null,
-					new Date(1)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Date, MinWithRetractAccumulator<Date>> getAggregator() {
-			return new DateMinWithRetractAggFunction();
-		}
+	private static <N> List<List<N>> numberInputValueSets(N minValue, N maxValue, Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				Arrays.asList(
+						strToValueFun.apply("1"),
+						null,
+						maxValue,
+						strToValueFun.apply("-99"),
+						strToValueFun.apply("3"),
+						strToValueFun.apply("56"),
+						strToValueFun.apply("0"),
+						minValue,
+						strToValueFun.apply("-20"),
+						strToValueFun.apply("17"),
+						null
+				),
+				Arrays.asList(
+						null,
+						null,
+						null,
+						null,
+						null,
+						null
+				),
+				Arrays.asList(
+						null,
+						strToValueFun.apply("10")
+				)
+		);
 	}
 
-	/**
-	 * Test for TimeMinWithRetractAggFunction.
-	 */
-	public static class TimeMinWithRetractAggFunctionTest extends MinWithRetractAggFunctionTest<Time> {
-
-		@Override
-		protected List<List<Time>> getInputValueSets() {
-			return Arrays.asList(
-					Arrays.asList(
-							new Time(0),
-							new Time(1000),
-							new Time(100),
-							null,
-							new Time(10)
-					),
-					Arrays.asList(
-							null,
-							null,
-							null,
-							null,
-							null
-					),
-					Arrays.asList(
-							null,
-							new Time(1)
-					)
-			);
-		}
-
-		@Override
-		protected List<Time> getExpectedResults() {
-			return Arrays.asList(
-					new Time(0),
-					null,
-					new Time(1)
-			);
-		}
-
-		@Override
-		protected AggregateFunction<Time, MinWithRetractAccumulator<Time>> getAggregator() {
-			return new TimeMinWithRetractAggFunction();
-		}
+	private static <N> List<N> numberExpectedResults(N minValue, Function<String, N> strToValueFun) {
+		return Arrays.asList(
+				minValue,
+				null,
+				strToValueFun.apply("10")
+		);
 	}
 }
