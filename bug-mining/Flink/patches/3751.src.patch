diff --git a/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchUpsertTableSinkFactoryBase.java b/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchUpsertTableSinkFactoryBase.java
index 2b4cb8379c0..efbbb7e694a 100644
--- a/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchUpsertTableSinkFactoryBase.java
+++ b/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchUpsertTableSinkFactoryBase.java
@@ -243,7 +243,8 @@ public abstract class ElasticsearchUpsertTableSinkFactoryBase implements StreamT
 		@SuppressWarnings("unchecked")
 		final SerializationSchemaFactory<Row> formatFactory = TableFactoryService.find(
 			SerializationSchemaFactory.class,
-			properties);
+			properties,
+			this.getClass().getClassLoader());
 		return formatFactory.createSerializationSchema(properties);
 	}
 
diff --git a/flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/connectors/kafka/KafkaTableSourceSinkFactoryBase.java b/flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/connectors/kafka/KafkaTableSourceSinkFactoryBase.java
index 0bbb9db67cd..072091a5ff8 100644
--- a/flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/connectors/kafka/KafkaTableSourceSinkFactoryBase.java
+++ b/flink-connectors/flink-connector-kafka-base/src/main/java/org/apache/flink/streaming/connectors/kafka/KafkaTableSourceSinkFactoryBase.java
@@ -280,7 +280,8 @@ public abstract class KafkaTableSourceSinkFactoryBase implements
 		@SuppressWarnings("unchecked")
 		final DeserializationSchemaFactory<Row> formatFactory = TableFactoryService.find(
 			DeserializationSchemaFactory.class,
-			properties);
+			properties,
+			this.getClass().getClassLoader());
 		return formatFactory.createDeserializationSchema(properties);
 	}
 
@@ -288,7 +289,8 @@ public abstract class KafkaTableSourceSinkFactoryBase implements
 		@SuppressWarnings("unchecked")
 		final SerializationSchemaFactory<Row> formatFactory = TableFactoryService.find(
 			SerializationSchemaFactory.class,
-			properties);
+			properties,
+			this.getClass().getClassLoader());
 		return formatFactory.createSerializationSchema(properties);
 	}
 
