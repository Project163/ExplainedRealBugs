diff --git a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/utils/Expander.java b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/utils/Expander.java
index 8a3e403319a..43a5bacdc8c 100644
--- a/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/utils/Expander.java
+++ b/flink-table/flink-table-planner-blink/src/main/java/org/apache/flink/table/planner/utils/Expander.java
@@ -94,7 +94,12 @@ public class Expander {
 			}
 
 			@Override public Void visit(SqlIdentifier identifier) {
-				identifiers.putIfAbsent(identifier.getParserPosition(), identifier);
+				// See SqlUtil#deriveAliasFromOrdinal, there is no good solution
+				// to distinguish between system alias (EXPR${number}) and user defines,
+				// and we stop expanding all of them.
+				if (!identifier.names.get(0).startsWith("EXPR$")) {
+					identifiers.putIfAbsent(identifier.getParserPosition(), identifier);
+				}
 				return null;
 			}
 		});
diff --git a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/common/ViewsExpandingTest.scala b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/common/ViewsExpandingTest.scala
index 666de8d5d8a..de7b6b8da44 100644
--- a/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/common/ViewsExpandingTest.scala
+++ b/flink-table/flink-table-planner-blink/src/test/scala/org/apache/flink/table/planner/plan/common/ViewsExpandingTest.scala
@@ -172,6 +172,35 @@ class ViewsExpandingTest(tableTestUtil: TableTestBase => TableTestUtil) extends
       is("SELECT `default_catalog`.`default_database`.`func`(1, 2, 'abc')"))
   }
 
+  @Test
+  def testExpandQueryWithSystemAlias(): Unit = {
+    val tableUtil = tableTestUtil(this)
+    val tableEnv = tableUtil.tableEnv
+    tableEnv.createTemporaryView("source",
+      tableEnv.fromValues("danny#21", "julian#55", "fabian#30").as("f0"))
+    val createView =
+      """
+        |create view tmp_view as
+        |select * from (
+        |  select f0,
+        |  row_number() over (partition by f0 order by f0 desc) as rowNum
+        |  from source)
+        |  where rowNum = 1
+        |""".stripMargin
+    tableEnv.executeSql(createView)
+    val objectID = ObjectIdentifier.of(tableEnv.getCurrentCatalog,
+      tableEnv.getCurrentDatabase, "tmp_view")
+    val view: CatalogBaseTable = tableEnv.getCatalog(objectID.getCatalogName)
+      .get().getTable(objectID.toObjectPath)
+    assertThat(view.asInstanceOf[CatalogView].getExpandedQuery,
+      is("SELECT *\n"
+        + "FROM (SELECT `source`.`f0`, "
+        + "ROW_NUMBER() "
+        + "OVER (PARTITION BY `source`.`f0` ORDER BY `source`.`f0` DESC) AS `rowNum`\n"
+        + "FROM `default_catalog`.`default_database`.`source`)\n"
+        + "WHERE `rowNum` = 1"))
+  }
+
   private def createSqlView(originTable: String): CatalogView = {
       new CatalogViewImpl(
         s"select * as c from $originTable",
