diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerBase.java b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerBase.java
index cf68f8128b6..fd50eed7e6c 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerBase.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/filemerging/FileMergingSnapshotManagerBase.java
@@ -42,7 +42,6 @@ import org.slf4j.LoggerFactory;
 import javax.annotation.Nonnull;
 import javax.annotation.concurrent.GuardedBy;
 
-import java.io.File;
 import java.io.FileNotFoundException;
 import java.io.IOException;
 import java.util.Collection;
@@ -210,8 +209,7 @@ public abstract class FileMergingSnapshotManagerBase implements FileMergingSnaps
             createManagedDirectory(managedExclusivePath);
             this.managedExclusiveStateDir = managedExclusivePath;
             this.managedExclusiveStateDirHandle =
-                    DirectoryStreamStateHandle.forPathWithZeroSize(
-                            new File(managedExclusivePath.getPath()).toPath());
+                    DirectoryStreamStateHandle.of(managedExclusivePath);
             this.writeBufferSize = writeBufferSize;
         }
     }
@@ -224,9 +222,7 @@ public abstract class FileMergingSnapshotManagerBase implements FileMergingSnaps
             createManagedDirectory(managedPath);
             managedSharedStateDir.put(subtaskKey, managedPath);
             managedSharedStateDirHandles.put(
-                    subtaskKey,
-                    DirectoryStreamStateHandle.forPathWithZeroSize(
-                            new File(managedPath.getPath()).toPath()));
+                    subtaskKey, DirectoryStreamStateHandle.of(managedPath));
         }
     }
 
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/metadata/MetadataV2V3SerializerBase.java b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/metadata/MetadataV2V3SerializerBase.java
index 7f7727c6d12..9f26090fd2c 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/metadata/MetadataV2V3SerializerBase.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/metadata/MetadataV2V3SerializerBase.java
@@ -73,7 +73,6 @@ import java.io.ByteArrayInputStream;
 import java.io.ByteArrayOutputStream;
 import java.io.DataInputStream;
 import java.io.DataOutputStream;
-import java.io.File;
 import java.io.IOException;
 import java.nio.charset.StandardCharsets;
 import java.util.ArrayList;
@@ -675,17 +674,13 @@ public abstract class MetadataV2V3SerializerBase {
                 Preconditions.checkArgument(stateHandle instanceof SegmentFileStateHandle);
                 return isEmpty
                         ? new EmptyFileMergingOperatorStreamStateHandle(
-                                DirectoryStreamStateHandle.forPathWithZeroSize(
-                                        new File(taskOwnedDirPathStr).toPath()),
-                                DirectoryStreamStateHandle.forPathWithZeroSize(
-                                        new File(sharedDirPathStr).toPath()),
+                                DirectoryStreamStateHandle.of(new Path(taskOwnedDirPathStr)),
+                                DirectoryStreamStateHandle.of(new Path(sharedDirPathStr)),
                                 offsetsMap,
                                 stateHandle)
                         : new FileMergingOperatorStreamStateHandle(
-                                DirectoryStreamStateHandle.forPathWithZeroSize(
-                                        new File(taskOwnedDirPathStr).toPath()),
-                                DirectoryStreamStateHandle.forPathWithZeroSize(
-                                        new File(sharedDirPathStr).toPath()),
+                                DirectoryStreamStateHandle.of(new Path(taskOwnedDirPathStr)),
+                                DirectoryStreamStateHandle.of(new Path(sharedDirPathStr)),
                                 offsetsMap,
                                 stateHandle);
             } else {
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/state/filemerging/DirectoryStreamStateHandle.java b/flink-runtime/src/main/java/org/apache/flink/runtime/state/filemerging/DirectoryStreamStateHandle.java
index dacebae4c10..b66c119f0d0 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/state/filemerging/DirectoryStreamStateHandle.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/state/filemerging/DirectoryStreamStateHandle.java
@@ -19,23 +19,28 @@
 package org.apache.flink.runtime.state.filemerging;
 
 import org.apache.flink.core.fs.FSDataInputStream;
-import org.apache.flink.runtime.state.DirectoryStateHandle;
+import org.apache.flink.core.fs.FileSystem;
+import org.apache.flink.core.fs.Path;
 import org.apache.flink.runtime.state.PhysicalStateHandleID;
 import org.apache.flink.runtime.state.SharedStateRegistryKey;
 import org.apache.flink.runtime.state.StreamStateHandle;
 
 import javax.annotation.Nonnull;
 
-import java.nio.file.Path;
 import java.util.Optional;
 
-/** Wrap {@link DirectoryStateHandle} to a {@link StreamStateHandle}. */
-public class DirectoryStreamStateHandle extends DirectoryStateHandle implements StreamStateHandle {
+/**
+ * This state handle represents a directory, usually used to be registered to {@link
+ * org.apache.flink.runtime.state.SharedStateRegistry} to track the life cycle of the directory.
+ */
+public class DirectoryStreamStateHandle implements StreamStateHandle {
 
     private static final long serialVersionUID = 1L;
 
-    public DirectoryStreamStateHandle(@Nonnull Path directory, long directorySize) {
-        super(directory, directorySize);
+    private final Path directory;
+
+    public DirectoryStreamStateHandle(@Nonnull Path directory) {
+        this.directory = directory;
     }
 
     @Override
@@ -50,11 +55,16 @@ public class DirectoryStreamStateHandle extends DirectoryStateHandle implements
 
     @Override
     public PhysicalStateHandleID getStreamStateHandleID() {
-        return new PhysicalStateHandleID(getDirectory().toString());
+        return new PhysicalStateHandleID(directory.toString());
     }
 
     public SharedStateRegistryKey createStateRegistryKey() {
-        return new SharedStateRegistryKey(getDirectory().toUri().toString());
+        return new SharedStateRegistryKey(directory.toString());
+    }
+
+    @Override
+    public int hashCode() {
+        return directory.hashCode();
     }
 
     @Override
@@ -68,7 +78,7 @@ public class DirectoryStreamStateHandle extends DirectoryStateHandle implements
 
         DirectoryStreamStateHandle that = (DirectoryStreamStateHandle) o;
 
-        return getDirectory().equals(that.getDirectory());
+        return directory.equals(that.directory);
     }
 
     @Override
@@ -76,15 +86,26 @@ public class DirectoryStreamStateHandle extends DirectoryStateHandle implements
         return "DirectoryStreamStateHandle{" + "directory=" + getDirectory() + '}';
     }
 
+    public Path getDirectory() {
+        return directory;
+    }
+
+    @Override
+    public void discardState() throws Exception {
+        FileSystem fs = directory.getFileSystem();
+        fs.delete(directory, true);
+    }
+
     /**
-     * Return a {@link DirectoryStreamStateHandle} with zero size, which usually used to be
-     * registered to {@link org.apache.flink.runtime.state.SharedStateRegistry} to track the life
-     * cycle of the directory, therefore a fake size is provided.
-     *
-     * @param directory the directory.
-     * @return DirectoryStreamStateHandle with zero size.
+     * This handle usually used to track the life cycle of the directory, therefore a fake size is
+     * provided.
      */
-    public static DirectoryStreamStateHandle forPathWithZeroSize(@Nonnull Path directory) {
-        return new DirectoryStreamStateHandle(directory, 0);
+    @Override
+    public long getStateSize() {
+        return 0;
+    }
+
+    public static DirectoryStreamStateHandle of(@Nonnull Path directory) {
+        return new DirectoryStreamStateHandle(directory);
     }
 }
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/metadata/CheckpointTestUtils.java b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/metadata/CheckpointTestUtils.java
index cb49de152fd..63836bdc920 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/metadata/CheckpointTestUtils.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/metadata/CheckpointTestUtils.java
@@ -50,7 +50,6 @@ import org.apache.flink.util.StringUtils;
 
 import javax.annotation.Nullable;
 
-import java.io.File;
 import java.nio.charset.StandardCharsets;
 import java.util.ArrayList;
 import java.util.Collection;
@@ -212,11 +211,9 @@ public class CheckpointTestUtils {
         boolean enableFileMerging = rnd.nextBoolean();
         if (enableFileMerging) {
             DirectoryStreamStateHandle taskOwnedDirHandle =
-                    DirectoryStreamStateHandle.forPathWithZeroSize(
-                            new File(String.valueOf(createRandomUUID(rnd))).toPath());
+                    DirectoryStreamStateHandle.of(new Path(createRandomUUID(rnd).toString()));
             DirectoryStreamStateHandle sharedDirHandle =
-                    DirectoryStreamStateHandle.forPathWithZeroSize(
-                            new File(String.valueOf(createRandomUUID(rnd))).toPath());
+                    DirectoryStreamStateHandle.of(new Path(createRandomUUID(rnd).toString()));
             return rnd.nextBoolean()
                     ? new FileMergingOperatorStreamStateHandle(
                             taskOwnedDirHandle,
