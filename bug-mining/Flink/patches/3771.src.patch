diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/graph/StreamingJobGraphGeneratorTest.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/graph/StreamingJobGraphGeneratorTest.java
index e5f624aaa5f..e942aebce7e 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/graph/StreamingJobGraphGeneratorTest.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/graph/StreamingJobGraphGeneratorTest.java
@@ -71,6 +71,7 @@ import javax.annotation.Nullable;
 
 import java.lang.reflect.Method;
 import java.math.BigDecimal;
+import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.Collections;
 import java.util.HashMap;
@@ -785,10 +786,11 @@ public class StreamingJobGraphGeneratorTest extends TestLogger {
 		final List<JobVertex> verticesSorted = jobGraph.getVerticesSortedTopologicallyFromSources();
 		assertEquals(4, verticesSorted.size());
 
-		final JobVertex source1Vertex = verticesSorted.get(0);
-		final JobVertex source2Vertex = verticesSorted.get(1);
-		final JobVertex map1Vertex = verticesSorted.get(2);
-		final JobVertex map2Vertex = verticesSorted.get(3);
+		final List<JobVertex> verticesMatched = getExpectedVerticesList(verticesSorted);
+		final JobVertex source1Vertex = verticesMatched.get(0);
+		final JobVertex source2Vertex = verticesMatched.get(1);
+		final JobVertex map1Vertex = verticesMatched.get(2);
+		final JobVertex map2Vertex = verticesMatched.get(3);
 
 		// all vertices should be in the same default slot sharing group
 		// except for map1 which has a specified slot sharing group
@@ -805,10 +807,11 @@ public class StreamingJobGraphGeneratorTest extends TestLogger {
 		final List<JobVertex> verticesSorted = jobGraph.getVerticesSortedTopologicallyFromSources();
 		assertEquals(4, verticesSorted.size());
 
-		final JobVertex source1Vertex = verticesSorted.get(0);
-		final JobVertex source2Vertex = verticesSorted.get(1);
-		final JobVertex map1Vertex = verticesSorted.get(2);
-		final JobVertex map2Vertex = verticesSorted.get(3);
+		final List<JobVertex> verticesMatched = getExpectedVerticesList(verticesSorted);
+		final JobVertex source1Vertex = verticesMatched.get(0);
+		final JobVertex source2Vertex = verticesMatched.get(1);
+		final JobVertex map1Vertex = verticesMatched.get(2);
+		final JobVertex map2Vertex = verticesMatched.get(3);
 
 		// vertices in the same region should be in the same slot sharing group
 		assertSameSlotSharingGroup(source1Vertex, map1Vertex);
@@ -817,6 +820,19 @@ public class StreamingJobGraphGeneratorTest extends TestLogger {
 		assertDistinctSharingGroups(source1Vertex, source2Vertex, map2Vertex);
 	}
 
+	private static List<JobVertex> getExpectedVerticesList(List<JobVertex> vertices) {
+		final List<JobVertex> verticesMatched = new ArrayList<JobVertex>();
+		final List<String> expectedOrder = Arrays.asList("source1", "source2", "map1", "map2");
+		for (int i = 0; i < expectedOrder.size(); i++) {
+			for (JobVertex vertex : vertices) {
+				if (vertex.getName().contains(expectedOrder.get(i))) {
+					verticesMatched.add(vertex);
+				}
+			}
+		}
+		return verticesMatched;
+	}
+
 	/**
 	 * Create a StreamGraph as below.
 	 *
