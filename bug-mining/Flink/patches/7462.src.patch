diff --git a/flink-datastream/pom.xml b/flink-datastream/pom.xml
index 80a13c8317a..dd93b3eccf5 100644
--- a/flink-datastream/pom.xml
+++ b/flink-datastream/pom.xml
@@ -34,6 +34,16 @@ under the License.
 
 	<packaging>jar</packaging>
 
+	<properties>
+		<surefire.module.config><!--
+			we use reflection to register sink transformation translator,
+			it's a final map, we need to set this to pass tests in jdk17 or higher.
+			-->--add-opens=java.base/java.util=ALL-UNNAMED
+		</surefire.module.config>
+	</properties>
+
+
+
 	<dependencies>
 		<dependency>
 			<groupId>org.apache.flink</groupId>
diff --git a/flink-datastream/src/main/java/org/apache/flink/datastream/impl/ExecutionEnvironmentImpl.java b/flink-datastream/src/main/java/org/apache/flink/datastream/impl/ExecutionEnvironmentImpl.java
index 4a3f2bdad0b..fd68cf872f9 100644
--- a/flink-datastream/src/main/java/org/apache/flink/datastream/impl/ExecutionEnvironmentImpl.java
+++ b/flink-datastream/src/main/java/org/apache/flink/datastream/impl/ExecutionEnvironmentImpl.java
@@ -96,7 +96,7 @@ public class ExecutionEnvironmentImpl implements ExecutionEnvironment {
             DataStreamV2SinkTransformationTranslator.registerSinkTransformationTranslator();
         } catch (Exception e) {
             throw new RuntimeException(
-                    "Can not register process function transformation translator.");
+                    "Can not register process function transformation translator.", e);
         }
     }
 
diff --git a/flink-runtime-web/pom.xml b/flink-runtime-web/pom.xml
index 6ff53c16d29..0ac98b429d5 100644
--- a/flink-runtime-web/pom.xml
+++ b/flink-runtime-web/pom.xml
@@ -37,6 +37,11 @@ under the License.
 		<test.parameterProgram.name>parameter-program</test.parameterProgram.name>
 		<test.ParameterProgramNoManifest.name>parameter-program-without-manifest</test.ParameterProgramNoManifest.name>
 		<test.ParameterProgramWithEagerSink.name>parameter-program-with-eager-sink</test.ParameterProgramWithEagerSink.name>
+		<surefire.module.config><!--
+			DataStream V2 use reflection to register sink transformation translator,
+			it's a final map, we need to set this to pass tests in jdk17 or higher.
+			-->--add-opens=java.base/java.util=ALL-UNNAMED
+		</surefire.module.config>
 	</properties>
 
 	<dependencies>
