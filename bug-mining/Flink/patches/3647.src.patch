diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/DefaultLastStateConnectionStateListener.java b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/DefaultLastStateConnectionStateListener.java
new file mode 100644
index 00000000000..8004b3297db
--- /dev/null
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/DefaultLastStateConnectionStateListener.java
@@ -0,0 +1,42 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *    http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.runtime.checkpoint;
+
+import org.apache.curator.framework.CuratorFramework;
+import org.apache.curator.framework.state.ConnectionState;
+
+import javax.annotation.Nullable;
+
+import java.util.Optional;
+
+public class DefaultLastStateConnectionStateListener implements LastStateConnectionStateListener {
+
+	@Nullable
+	private volatile ConnectionState lastState = null;
+
+	@Override
+	public Optional<ConnectionState> getLastState() {
+		return Optional.ofNullable(lastState);
+	}
+
+	@Override
+	public void stateChanged(CuratorFramework client, ConnectionState newState) {
+		lastState = newState;
+	}
+}
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/LastStateConnectionStateListener.java b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/LastStateConnectionStateListener.java
new file mode 100644
index 00000000000..8d5e8c15591
--- /dev/null
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/LastStateConnectionStateListener.java
@@ -0,0 +1,37 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *    http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.runtime.checkpoint;
+
+import org.apache.curator.framework.state.ConnectionState;
+import org.apache.curator.framework.state.ConnectionStateListener;
+
+import java.util.Optional;
+
+/**
+ * {@link ConnectionStateListener} which records the last state it was notified about.
+ */
+public interface LastStateConnectionStateListener extends ConnectionStateListener {
+
+	/**
+	 * Return the last state the listener was notified about.
+	 *
+	 * @return the last state or none if the listener has not received an update
+	 */
+	Optional<ConnectionState> getLastState();
+}
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/ZooKeeperCheckpointIDCounter.java b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/ZooKeeperCheckpointIDCounter.java
index 315db4c22c9..6ee1622c123 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/ZooKeeperCheckpointIDCounter.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/checkpoint/ZooKeeperCheckpointIDCounter.java
@@ -18,7 +18,6 @@
 
 package org.apache.flink.runtime.checkpoint;
 
-import org.apache.flink.annotation.VisibleForTesting;
 import org.apache.flink.api.common.JobStatus;
 import org.apache.flink.runtime.jobmanager.HighAvailabilityMode;
 
@@ -26,15 +25,12 @@ import org.apache.curator.framework.CuratorFramework;
 import org.apache.curator.framework.recipes.shared.SharedCount;
 import org.apache.curator.framework.recipes.shared.VersionedValue;
 import org.apache.curator.framework.state.ConnectionState;
-import org.apache.curator.framework.state.ConnectionStateListener;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
 
-import javax.annotation.Nullable;
 import javax.annotation.concurrent.GuardedBy;
 
-import java.util.ArrayList;
-import java.util.Collection;
+import java.util.Optional;
 
 import static org.apache.flink.util.Preconditions.checkNotNull;
 
@@ -66,13 +62,10 @@ public class ZooKeeperCheckpointIDCounter implements CheckpointIDCounter {
 	/** Curator recipe for shared counts. */
 	private final SharedCount sharedCount;
 
-	private final Collection<ConnectionStateListener> connectionStateListeners;
+	private final LastStateConnectionStateListener connectionStateListener;
 
 	private final Object startStopLock = new Object();
 
-	@Nullable
-	private volatile ConnectionState lastState;
-
 	@GuardedBy("startStopLock")
 	private boolean isStarted;
 
@@ -82,19 +75,11 @@ public class ZooKeeperCheckpointIDCounter implements CheckpointIDCounter {
 	 * @param client      Curator ZooKeeper client
 	 * @param counterPath ZooKeeper path for the counter. It's sufficient to have a path per-job.
 	 */
-	public ZooKeeperCheckpointIDCounter(CuratorFramework client, String counterPath) {
+	public ZooKeeperCheckpointIDCounter(CuratorFramework client, String counterPath, LastStateConnectionStateListener connectionStateListener) {
 		this.client = checkNotNull(client, "Curator client");
 		this.counterPath = checkNotNull(counterPath, "Counter path");
 		this.sharedCount = new SharedCount(client, counterPath, 1);
-
-		this.connectionStateListeners = new ArrayList<>();
-		this.connectionStateListeners.add((ignore, newState) -> lastState = newState);
-	}
-
-	@VisibleForTesting
-	ZooKeeperCheckpointIDCounter(CuratorFramework client, String counterPath, Collection<ConnectionStateListener> listeners) {
-		this(client, counterPath);
-		this.connectionStateListeners.addAll(listeners);
+		this.connectionStateListener = connectionStateListener;
 	}
 
 	@Override
@@ -103,9 +88,7 @@ public class ZooKeeperCheckpointIDCounter implements CheckpointIDCounter {
 			if (!isStarted) {
 				sharedCount.start();
 
-				for (ConnectionStateListener listener : connectionStateListeners) {
-					client.getConnectionStateListenable().addListener(listener);
-				}
+				client.getConnectionStateListenable().addListener(connectionStateListener);
 
 				isStarted = true;
 			}
@@ -119,9 +102,7 @@ public class ZooKeeperCheckpointIDCounter implements CheckpointIDCounter {
 				LOG.info("Shutting down.");
 				sharedCount.close();
 
-				for (ConnectionStateListener listener : connectionStateListeners) {
-					client.getConnectionStateListenable().removeListener(listener);
-				}
+				client.getConnectionStateListenable().removeListener(connectionStateListener);
 
 				if (jobStatus.isGloballyTerminalState()) {
 					LOG.info("Removing {} from ZooKeeper", counterPath);
@@ -174,14 +155,12 @@ public class ZooKeeperCheckpointIDCounter implements CheckpointIDCounter {
 	}
 
 	private void checkConnectionState() {
-		final ConnectionState currentLastState = this.lastState;
-
-		if (currentLastState == null) {
-			return;
-		}
+		final Optional<ConnectionState> optionalLastState = connectionStateListener.getLastState();
 
-		if (currentLastState != ConnectionState.CONNECTED && currentLastState != ConnectionState.RECONNECTED) {
-			throw new IllegalStateException("Connection state: " + currentLastState);
-		}
+		optionalLastState.ifPresent(lastState -> {
+			if (lastState != ConnectionState.CONNECTED && lastState != ConnectionState.RECONNECTED) {
+				throw new IllegalStateException("Connection state: " + lastState);
+			}
+		});
 	}
 }
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/util/ZooKeeperUtils.java b/flink-runtime/src/main/java/org/apache/flink/runtime/util/ZooKeeperUtils.java
index f29f3351cdf..826543110aa 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/util/ZooKeeperUtils.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/util/ZooKeeperUtils.java
@@ -25,6 +25,7 @@ import org.apache.flink.configuration.IllegalConfigurationException;
 import org.apache.flink.configuration.SecurityOptions;
 import org.apache.flink.runtime.checkpoint.CompletedCheckpoint;
 import org.apache.flink.runtime.checkpoint.CompletedCheckpointStore;
+import org.apache.flink.runtime.checkpoint.DefaultLastStateConnectionStateListener;
 import org.apache.flink.runtime.checkpoint.ZooKeeperCheckpointIDCounter;
 import org.apache.flink.runtime.checkpoint.ZooKeeperCompletedCheckpointStore;
 import org.apache.flink.runtime.highavailability.HighAvailabilityServicesUtils;
@@ -345,7 +346,7 @@ public class ZooKeeperUtils {
 
 		checkpointIdCounterPath += ZooKeeperJobGraphStore.getPathForJob(jobId);
 
-		return new ZooKeeperCheckpointIDCounter(client, checkpointIdCounterPath);
+		return new ZooKeeperCheckpointIDCounter(client, checkpointIdCounterPath, new DefaultLastStateConnectionStateListener());
 	}
 
 	/**
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/CheckpointIDCounterTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/CheckpointIDCounterTest.java
index 1774fb5d2a3..0fc18b43a61 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/CheckpointIDCounterTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/CheckpointIDCounterTest.java
@@ -99,8 +99,10 @@ public abstract class CheckpointIDCounterTest extends TestLogger {
 
 		@Override
 		protected CheckpointIDCounter createCompletedCheckpoints() throws Exception {
-			return new ZooKeeperCheckpointIDCounter(ZooKeeper.getClient(),
-					"/checkpoint-id-counter");
+			return new ZooKeeperCheckpointIDCounter(
+				ZooKeeper.getClient(),
+				"/checkpoint-id-counter",
+				new DefaultLastStateConnectionStateListener());
 		}
 	}
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/ZKCheckpointIDCounterMultiServersTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/ZKCheckpointIDCounterMultiServersTest.java
index 61b0998813c..b31fa1d3a75 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/ZKCheckpointIDCounterMultiServersTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/checkpoint/ZKCheckpointIDCounterMultiServersTest.java
@@ -27,11 +27,9 @@ import org.apache.flink.util.TestLogger;
 
 import org.apache.curator.framework.CuratorFramework;
 import org.apache.curator.framework.state.ConnectionState;
-import org.apache.curator.framework.state.ConnectionStateListener;
 import org.junit.Rule;
 import org.junit.Test;
 
-import java.util.Collections;
 import java.util.concurrent.atomic.AtomicLong;
 
 import static org.hamcrest.CoreMatchers.is;
@@ -62,20 +60,14 @@ public final class ZKCheckpointIDCounterMultiServersTest extends TestLogger {
 			OneShotLatch connectionLossLatch = new OneShotLatch();
 			OneShotLatch reconnectedLatch = new OneShotLatch();
 
-			ConnectionStateListener listener = (ignore, newState) -> {
-				if (newState == ConnectionState.LOST || newState == ConnectionState.SUSPENDED) {
-					connectionLossLatch.trigger();
-				}
-
-				if (newState == ConnectionState.RECONNECTED) {
-					reconnectedLatch.trigger();
-				}
-			};
+			TestingLastStateConnectionStateListener listener = new TestingLastStateConnectionStateListener(
+				connectionLossLatch,
+				reconnectedLatch);
 
 			ZooKeeperCheckpointIDCounter idCounter = new ZooKeeperCheckpointIDCounter(
 				client,
 				"/checkpoint-id-counter",
-				Collections.singleton(listener));
+				listener);
 			idCounter.start();
 
 			AtomicLong localCounter = new AtomicLong(1L);
@@ -99,4 +91,28 @@ public final class ZKCheckpointIDCounterMultiServersTest extends TestLogger {
 		}
 	}
 
+	private static final class TestingLastStateConnectionStateListener extends DefaultLastStateConnectionStateListener {
+
+		private final OneShotLatch connectionLossLatch;
+		private final OneShotLatch reconnectedLatch;
+
+		private TestingLastStateConnectionStateListener(OneShotLatch connectionLossLatch, OneShotLatch reconnectedLatch) {
+			this.connectionLossLatch = connectionLossLatch;
+			this.reconnectedLatch = reconnectedLatch;
+		}
+
+		@Override
+		public void stateChanged(CuratorFramework client, ConnectionState newState) {
+			super.stateChanged(client, newState);
+
+			if (newState == ConnectionState.LOST || newState == ConnectionState.SUSPENDED) {
+				connectionLossLatch.trigger();
+			}
+
+			if (newState == ConnectionState.RECONNECTED) {
+				reconnectedLatch.trigger();
+			}
+		}
+	}
+
 }
