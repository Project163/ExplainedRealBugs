diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/sink/filesystem/StreamingFileSink.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/sink/filesystem/StreamingFileSink.java
index 6c7e135caf8..6f57fee81f3 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/sink/filesystem/StreamingFileSink.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/sink/filesystem/StreamingFileSink.java
@@ -375,6 +375,8 @@ public class StreamingFileSink<IN>
 
 	@Override
 	public void close() throws Exception {
-		buckets.close();
+		if (buckets != null) {
+			buckets.close();
+		}
 	}
 }
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/functions/sink/filesystem/LocalStreamingFileSinkTest.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/functions/sink/filesystem/LocalStreamingFileSinkTest.java
index ab487d168bc..8bb35ff244a 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/functions/sink/filesystem/LocalStreamingFileSinkTest.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/functions/sink/filesystem/LocalStreamingFileSinkTest.java
@@ -59,6 +59,16 @@ public class LocalStreamingFileSinkTest extends TestLogger {
 		}
 	}
 
+	@Test
+	public void testClosingWithoutInitializingStateShouldNotFail() throws Exception {
+		final File outDir = TEMP_FOLDER.newFolder();
+
+		try (OneInputStreamOperatorTestHarness<Tuple2<String, Integer>, Object> testHarness =
+					TestUtils.createRescalingTestSink(outDir, 1, 0, 100L, 124L)) {
+			testHarness.setup();
+		}
+	}
+
 	@Test
 	public void testTruncateAfterRecoveryAndOverwrite() throws Exception {
 		final File outDir = TEMP_FOLDER.newFolder();
