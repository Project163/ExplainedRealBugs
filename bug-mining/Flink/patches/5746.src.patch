diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/JobVertex.java b/flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/JobVertex.java
index ac214cd766e..9e8394b0d8b 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/JobVertex.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/jobgraph/JobVertex.java
@@ -24,7 +24,7 @@ import org.apache.flink.configuration.Configuration;
 import org.apache.flink.core.io.InputSplitSource;
 import org.apache.flink.runtime.OperatorIDPair;
 import org.apache.flink.runtime.io.network.partition.ResultPartitionType;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.jobmanager.scheduler.CoLocationGroup;
 import org.apache.flink.runtime.jobmanager.scheduler.CoLocationGroupImpl;
 import org.apache.flink.runtime.jobmanager.scheduler.SlotSharingGroup;
@@ -244,7 +244,7 @@ public class JobVertex implements java.io.Serializable {
         return this.configuration;
     }
 
-    public void setInvokableClass(Class<? extends AbstractInvokable> invokable) {
+    public void setInvokableClass(Class<? extends TaskInvokable> invokable) {
         Preconditions.checkNotNull(invokable);
         this.invokableClassName = invokable.getName();
     }
@@ -264,7 +264,7 @@ public class JobVertex implements java.io.Serializable {
      * @param cl The classloader used to resolve user-defined classes
      * @return The invokable class, <code>null</code> if it is not set
      */
-    public Class<? extends AbstractInvokable> getInvokableClass(ClassLoader cl) {
+    public Class<? extends TaskInvokable> getInvokableClass(ClassLoader cl) {
         if (cl == null) {
             throw new NullPointerException("The classloader must not be null.");
         }
@@ -273,13 +273,12 @@ public class JobVertex implements java.io.Serializable {
         }
 
         try {
-            return Class.forName(invokableClassName, true, cl).asSubclass(AbstractInvokable.class);
+            return Class.forName(invokableClassName, true, cl).asSubclass(TaskInvokable.class);
         } catch (ClassNotFoundException e) {
             throw new RuntimeException("The user-code class could not be resolved.", e);
         } catch (ClassCastException e) {
             throw new RuntimeException(
-                    "The user-code class is no subclass of " + AbstractInvokable.class.getName(),
-                    e);
+                    "The user-code class is no subclass of " + TaskInvokable.class.getName(), e);
         }
     }
 
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/ExternalSorter.java b/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/ExternalSorter.java
index da8cf0c8351..ffbff34678a 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/ExternalSorter.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/ExternalSorter.java
@@ -18,10 +18,12 @@
 
 package org.apache.flink.runtime.operators.sort;
 
+import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.typeutils.TypeComparator;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.core.memory.MemorySegment;
 import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.memory.MemoryManager;
 import org.apache.flink.util.MutableObjectIterator;
 import org.apache.flink.util.WrappingRuntimeException;
@@ -261,16 +263,32 @@ public class ExternalSorter<E> implements Sorter<E> {
         }
     }
 
+    /** Creates a builder for the {@link ExternalSorter}. */
+    public static <E> ExternalSorterBuilder<E> newBuilder(
+            MemoryManager memoryManager,
+            TaskInvokable parentTask,
+            TypeSerializer<E> serializer,
+            TypeComparator<E> comparator,
+            ExecutionConfig executionConfig) {
+        return new ExternalSorterBuilder<>(
+                checkNotNull(memoryManager),
+                checkNotNull(parentTask),
+                checkNotNull(serializer),
+                checkNotNull(comparator),
+                checkNotNull(executionConfig));
+    }
+
     /** Creates a builder for the {@link ExternalSorter}. */
     public static <E> ExternalSorterBuilder<E> newBuilder(
             MemoryManager memoryManager,
             AbstractInvokable parentTask,
             TypeSerializer<E> serializer,
             TypeComparator<E> comparator) {
-        return new ExternalSorterBuilder<>(
+        return newBuilder(
                 checkNotNull(memoryManager),
                 checkNotNull(parentTask),
                 checkNotNull(serializer),
-                checkNotNull(comparator));
+                checkNotNull(comparator),
+                parentTask.getExecutionConfig());
     }
 }
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/ExternalSorterBuilder.java b/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/ExternalSorterBuilder.java
index 40eb00e4718..81a4e7f5a39 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/ExternalSorterBuilder.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/ExternalSorterBuilder.java
@@ -18,6 +18,7 @@
 
 package org.apache.flink.runtime.operators.sort;
 
+import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.functions.GroupCombineFunction;
 import org.apache.flink.api.common.typeutils.TypeComparator;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
@@ -26,7 +27,7 @@ import org.apache.flink.configuration.ConfigConstants;
 import org.apache.flink.configuration.Configuration;
 import org.apache.flink.core.memory.MemorySegment;
 import org.apache.flink.runtime.io.disk.iomanager.IOManager;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.memory.MemoryAllocationException;
 import org.apache.flink.runtime.memory.MemoryManager;
 import org.apache.flink.util.MutableObjectIterator;
@@ -68,7 +69,7 @@ public final class ExternalSorterBuilder<T> {
     private static final int MIN_NUM_SORT_MEM_SEGMENTS = 10;
 
     private final MemoryManager memoryManager;
-    private final AbstractInvokable parentTask;
+    private final TaskInvokable parentTask;
     private final TypeSerializer<T> serializer;
     private final TypeComparator<T> comparator;
     private InMemorySorterFactory<T> inMemorySorterFactory;
@@ -83,14 +84,17 @@ public final class ExternalSorterBuilder<T> {
     private GroupCombineFunction<T, T> combineFunction;
     private Configuration udfConfig;
     private List<MemorySegment> memorySegments = null;
+    private final ExecutionConfig executionConfig;
 
     ExternalSorterBuilder(
             MemoryManager memoryManager,
-            AbstractInvokable parentTask,
+            TaskInvokable parentTask,
             TypeSerializer<T> serializer,
-            TypeComparator<T> comparator) {
+            TypeComparator<T> comparator,
+            ExecutionConfig executionConfig) {
         this.memoryManager = memoryManager;
         this.parentTask = parentTask;
+        this.executionConfig = executionConfig;
         this.serializer = serializer;
         this.comparator = comparator;
         this.inMemorySorterFactory =
@@ -358,7 +362,8 @@ public final class ExternalSorterBuilder<T> {
                             memoryManager,
                             mem,
                             parentTask,
-                            maxNumFileHandles);
+                            maxNumFileHandles,
+                            executionConfig);
         } else {
             largeRecordHandler = null;
         }
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/LargeRecordHandler.java b/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/LargeRecordHandler.java
index 30657b4623c..81c17d733b1 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/LargeRecordHandler.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/operators/sort/LargeRecordHandler.java
@@ -34,7 +34,7 @@ import org.apache.flink.runtime.io.disk.InputViewIterator;
 import org.apache.flink.runtime.io.disk.SeekableFileChannelInputView;
 import org.apache.flink.runtime.io.disk.iomanager.FileIOChannel;
 import org.apache.flink.runtime.io.disk.iomanager.IOManager;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.memory.MemoryAllocationException;
 import org.apache.flink.runtime.memory.MemoryManager;
 import org.apache.flink.types.NullKeyFieldException;
@@ -90,7 +90,7 @@ public class LargeRecordHandler<T> {
 
     private Sorter<Tuple> keySorter;
 
-    private final AbstractInvokable memoryOwner;
+    private final TaskInvokable memoryOwner;
 
     private long recordCounter;
 
@@ -110,8 +110,9 @@ public class LargeRecordHandler<T> {
             IOManager ioManager,
             MemoryManager memManager,
             List<MemorySegment> memory,
-            AbstractInvokable memoryOwner,
-            int maxFilehandles) {
+            TaskInvokable memoryOwner,
+            int maxFilehandles,
+            ExecutionConfig executionConfig) {
         this.serializer = checkNotNull(serializer);
         this.comparator = checkNotNull(comparator);
         this.ioManager = checkNotNull(ioManager);
@@ -119,8 +120,7 @@ public class LargeRecordHandler<T> {
         this.memory = checkNotNull(memory);
         this.memoryOwner = checkNotNull(memoryOwner);
         this.maxFilehandles = maxFilehandles;
-
-        this.executionConfig = memoryOwner.getExecutionConfig();
+        this.executionConfig = checkNotNull(executionConfig);
 
         checkArgument(maxFilehandles >= 2);
     }
@@ -276,7 +276,12 @@ public class LargeRecordHandler<T> {
 
         try {
             keySorter =
-                    ExternalSorter.newBuilder(memManager, memoryOwner, keySerializer, keyComparator)
+                    ExternalSorter.newBuilder(
+                                    memManager,
+                                    memoryOwner,
+                                    keySerializer,
+                                    keyComparator,
+                                    executionConfig)
                             .maxNumFileHandles(maxFilehandles)
                             .sortBuffers(1)
                             .enableSpilling(ioManager, 1.0f)
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/operators/sort/LargeRecordHandlerITCase.java b/flink-runtime/src/test/java/org/apache/flink/runtime/operators/sort/LargeRecordHandlerITCase.java
index b47beb203dc..80b38f85cae 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/operators/sort/LargeRecordHandlerITCase.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/operators/sort/LargeRecordHandlerITCase.java
@@ -91,7 +91,14 @@ public class LargeRecordHandlerITCase extends TestLogger {
 
             LargeRecordHandler<Tuple3<Long, SomeVeryLongValue, Byte>> handler =
                     new LargeRecordHandler<Tuple3<Long, SomeVeryLongValue, Byte>>(
-                            serializer, comparator, ioMan, memMan, initialMemory, owner, 128);
+                            serializer,
+                            comparator,
+                            ioMan,
+                            memMan,
+                            initialMemory,
+                            owner,
+                            128,
+                            owner.getExecutionConfig());
 
             assertFalse(handler.hasData());
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/operators/sort/LargeRecordHandlerTest.java b/flink-runtime/src/test/java/org/apache/flink/runtime/operators/sort/LargeRecordHandlerTest.java
index c60e4934ef8..2ac6657cac2 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/operators/sort/LargeRecordHandlerTest.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/operators/sort/LargeRecordHandlerTest.java
@@ -40,7 +40,9 @@ import org.junit.Test;
 import java.util.List;
 import java.util.Random;
 
-import static org.junit.Assert.*;
+import static org.junit.Assert.assertFalse;
+import static org.junit.Assert.assertTrue;
+import static org.junit.Assert.fail;
 
 public class LargeRecordHandlerTest {
 
@@ -70,7 +72,14 @@ public class LargeRecordHandlerTest {
 
             LargeRecordHandler<Tuple2<Long, String>> handler =
                     new LargeRecordHandler<Tuple2<Long, String>>(
-                            serializer, comparator, ioMan, memMan, memory, owner, 128);
+                            serializer,
+                            comparator,
+                            ioMan,
+                            memMan,
+                            memory,
+                            owner,
+                            128,
+                            owner.getExecutionConfig());
 
             assertFalse(handler.hasData());
 
@@ -123,7 +132,14 @@ public class LargeRecordHandlerTest {
 
             LargeRecordHandler<Tuple2<Long, String>> handler =
                     new LargeRecordHandler<Tuple2<Long, String>>(
-                            serializer, comparator, ioMan, memMan, initialMemory, owner, 128);
+                            serializer,
+                            comparator,
+                            ioMan,
+                            memMan,
+                            initialMemory,
+                            owner,
+                            128,
+                            owner.getExecutionConfig());
 
             assertFalse(handler.hasData());
 
@@ -209,7 +225,14 @@ public class LargeRecordHandlerTest {
 
             LargeRecordHandler<Tuple3<Long, String, Byte>> handler =
                     new LargeRecordHandler<Tuple3<Long, String, Byte>>(
-                            serializer, comparator, ioMan, memMan, initialMemory, owner, 128);
+                            serializer,
+                            comparator,
+                            ioMan,
+                            memMan,
+                            initialMemory,
+                            owner,
+                            128,
+                            owner.getExecutionConfig());
 
             assertFalse(handler.hasData());
 
diff --git a/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TestTaskBuilder.java b/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TestTaskBuilder.java
index 078640c9139..dec19f8b92f 100644
--- a/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TestTaskBuilder.java
+++ b/flink-runtime/src/test/java/org/apache/flink/runtime/taskmanager/TestTaskBuilder.java
@@ -40,6 +40,7 @@ import org.apache.flink.runtime.io.network.partition.NoOpResultPartitionConsumab
 import org.apache.flink.runtime.io.network.partition.ResultPartitionConsumableNotifier;
 import org.apache.flink.runtime.jobgraph.JobVertexID;
 import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.memory.MemoryManagerBuilder;
 import org.apache.flink.runtime.metrics.groups.TaskMetricGroup;
 import org.apache.flink.runtime.metrics.groups.UnregisteredMetricGroups;
@@ -67,7 +68,7 @@ import static org.mockito.Mockito.mock;
 /** Util that helps building {@link Task} objects for testing. */
 public final class TestTaskBuilder {
 
-    private Class<? extends AbstractInvokable> invokable = AbstractInvokable.class;
+    private Class<? extends TaskInvokable> invokable = AbstractInvokable.class;
     private TaskManagerActions taskManagerActions = new NoOpTaskManagerActions();
     private LibraryCacheManager.ClassLoaderHandle classLoaderHandle =
             TestingClassLoaderLease.newBuilder().build();
@@ -95,7 +96,7 @@ public final class TestTaskBuilder {
         this.shuffleEnvironment = Preconditions.checkNotNull(shuffleEnvironment);
     }
 
-    public TestTaskBuilder setInvokable(Class<? extends AbstractInvokable> invokable) {
+    public TestTaskBuilder setInvokable(Class<? extends TaskInvokable> invokable) {
         this.invokable = invokable;
         return this;
     }
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamGraph.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamGraph.java
index ad31d01cde7..e1813376d37 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamGraph.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamGraph.java
@@ -38,7 +38,7 @@ import org.apache.flink.runtime.clusterframework.types.ResourceProfile;
 import org.apache.flink.runtime.jobgraph.JobGraph;
 import org.apache.flink.runtime.jobgraph.JobType;
 import org.apache.flink.runtime.jobgraph.SavepointRestoreSettings;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.state.CheckpointStorage;
 import org.apache.flink.runtime.state.StateBackend;
 import org.apache.flink.streaming.api.TimeCharacteristic;
@@ -370,7 +370,7 @@ public class StreamGraph implements Pipeline {
             TypeInformation<IN> inTypeInfo,
             TypeInformation<OUT> outTypeInfo,
             String operatorName) {
-        Class<? extends AbstractInvokable> invokableClass =
+        Class<? extends TaskInvokable> invokableClass =
                 operatorFactory.isStreamSource()
                         ? SourceStreamTask.class
                         : OneInputStreamTask.class;
@@ -393,7 +393,7 @@ public class StreamGraph implements Pipeline {
             TypeInformation<IN> inTypeInfo,
             TypeInformation<OUT> outTypeInfo,
             String operatorName,
-            Class<? extends AbstractInvokable> invokableClass) {
+            Class<? extends TaskInvokable> invokableClass) {
 
         addNode(
                 vertexID,
@@ -428,7 +428,7 @@ public class StreamGraph implements Pipeline {
             TypeInformation<OUT> outTypeInfo,
             String operatorName) {
 
-        Class<? extends AbstractInvokable> vertexClass = TwoInputStreamTask.class;
+        Class<? extends TaskInvokable> vertexClass = TwoInputStreamTask.class;
 
         addNode(
                 vertexID,
@@ -465,7 +465,7 @@ public class StreamGraph implements Pipeline {
             TypeInformation<OUT> outTypeInfo,
             String operatorName) {
 
-        Class<? extends AbstractInvokable> vertexClass = MultipleInputStreamTask.class;
+        Class<? extends TaskInvokable> vertexClass = MultipleInputStreamTask.class;
 
         addNode(
                 vertexID,
@@ -491,7 +491,7 @@ public class StreamGraph implements Pipeline {
             Integer vertexID,
             @Nullable String slotSharingGroup,
             @Nullable String coLocationGroup,
-            Class<? extends AbstractInvokable> vertexClass,
+            Class<? extends TaskInvokable> vertexClass,
             StreamOperatorFactory<?> operatorFactory,
             String operatorName) {
 
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamNode.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamNode.java
index 151a4b7d6c1..2717fa45477 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamNode.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamNode.java
@@ -26,7 +26,7 @@ import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.java.functions.KeySelector;
 import org.apache.flink.core.memory.ManagedMemoryUseCase;
 import org.apache.flink.runtime.jobgraph.OperatorID;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.operators.coordination.OperatorCoordinator;
 import org.apache.flink.streaming.api.operators.CoordinatedOperatorFactory;
 import org.apache.flink.streaming.api.operators.SimpleOperatorFactory;
@@ -77,7 +77,7 @@ public class StreamNode {
     private List<StreamEdge> inEdges = new ArrayList<StreamEdge>();
     private List<StreamEdge> outEdges = new ArrayList<StreamEdge>();
 
-    private final Class<? extends AbstractInvokable> jobVertexClass;
+    private final Class<? extends TaskInvokable> jobVertexClass;
 
     private InputFormat<?, ?> inputFormat;
     private OutputFormat<?> outputFormat;
@@ -94,7 +94,7 @@ public class StreamNode {
             @Nullable String coLocationGroup,
             StreamOperator<?> operator,
             String operatorName,
-            Class<? extends AbstractInvokable> jobVertexClass) {
+            Class<? extends TaskInvokable> jobVertexClass) {
         this(
                 id,
                 slotSharingGroup,
@@ -110,7 +110,7 @@ public class StreamNode {
             @Nullable String coLocationGroup,
             StreamOperatorFactory<?> operatorFactory,
             String operatorName,
-            Class<? extends AbstractInvokable> jobVertexClass) {
+            Class<? extends TaskInvokable> jobVertexClass) {
         this.id = id;
         this.operatorName = operatorName;
         this.operatorFactory = operatorFactory;
@@ -263,7 +263,7 @@ public class StreamNode {
         this.typeSerializerOut = typeSerializerOut;
     }
 
-    public Class<? extends AbstractInvokable> getJobVertexClass() {
+    public Class<? extends TaskInvokable> getJobVertexClass() {
         return jobVertexClass;
     }
 
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamingJobGraphGenerator.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamingJobGraphGenerator.java
index 020f0a0c323..f0123e582df 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamingJobGraphGenerator.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/graph/StreamingJobGraphGenerator.java
@@ -41,9 +41,9 @@ import org.apache.flink.runtime.jobgraph.JobGraphUtils;
 import org.apache.flink.runtime.jobgraph.JobVertex;
 import org.apache.flink.runtime.jobgraph.JobVertexID;
 import org.apache.flink.runtime.jobgraph.OperatorID;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
 import org.apache.flink.runtime.jobgraph.tasks.CheckpointCoordinatorConfiguration;
 import org.apache.flink.runtime.jobgraph.tasks.JobCheckpointingSettings;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.jobgraph.topology.DefaultLogicalPipelinedRegion;
 import org.apache.flink.runtime.jobgraph.topology.DefaultLogicalTopology;
 import org.apache.flink.runtime.jobgraph.topology.LogicalVertex;
@@ -741,7 +741,7 @@ public class StreamingJobGraphGenerator {
         }
         config.setStateKeySerializer(vertex.getStateKeySerializer());
 
-        Class<? extends AbstractInvokable> vertexClass = vertex.getJobVertexClass();
+        Class<? extends TaskInvokable> vertexClass = vertex.getJobVertexClass();
 
         if (vertexClass.equals(StreamIterationHead.class)
                 || vertexClass.equals(StreamIterationTail.class)) {
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/sort/MultiInputSortingDataInput.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/sort/MultiInputSortingDataInput.java
index 22a0799993b..7355e5b0fde 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/sort/MultiInputSortingDataInput.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/sort/MultiInputSortingDataInput.java
@@ -17,6 +17,7 @@
 
 package org.apache.flink.streaming.api.operators.sort;
 
+import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.typeutils.TypeComparator;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.java.functions.KeySelector;
@@ -27,7 +28,7 @@ import org.apache.flink.core.memory.DataOutputSerializer;
 import org.apache.flink.runtime.checkpoint.channel.ChannelStateWriter;
 import org.apache.flink.runtime.io.AvailabilityProvider;
 import org.apache.flink.runtime.io.disk.iomanager.IOManager;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.memory.MemoryAllocationException;
 import org.apache.flink.runtime.memory.MemoryManager;
 import org.apache.flink.runtime.operators.sort.ExternalSorter;
@@ -139,7 +140,7 @@ public final class MultiInputSortingDataInput<IN, K> implements StreamTaskInput<
     }
 
     public static <K> SelectableSortingInputs wrapInputs(
-            AbstractInvokable containingTask,
+            TaskInvokable containingTask,
             StreamTaskInput<Object>[] sortingInputs,
             KeySelector<Object, K>[] keySelectors,
             TypeSerializer<Object>[] inputSerializers,
@@ -149,7 +150,8 @@ public final class MultiInputSortingDataInput<IN, K> implements StreamTaskInput<
             IOManager ioManager,
             boolean objectReuse,
             double managedMemoryFraction,
-            Configuration jobConfiguration) {
+            Configuration jobConfiguration,
+            ExecutionConfig executionConfig) {
         int keyLength = keySerializer.getLength();
         final TypeComparator<Tuple2<byte[], StreamRecord<Object>>> comparator;
         DataOutputSerializer dataOutputSerializer;
@@ -187,7 +189,8 @@ public final class MultiInputSortingDataInput<IN, K> implements StreamTaskInput<
                                                                 memoryManager,
                                                                 containingTask,
                                                                 keyAndValueSerializer,
-                                                                comparator)
+                                                                comparator,
+                                                                executionConfig)
                                                         .memoryFraction(
                                                                 managedMemoryFraction
                                                                         / numberOfInputs)
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/sort/SortingDataInput.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/sort/SortingDataInput.java
index 264dbb8ebb7..f68d4962c8c 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/sort/SortingDataInput.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/sort/SortingDataInput.java
@@ -18,6 +18,7 @@
 
 package org.apache.flink.streaming.api.operators.sort;
 
+import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.typeutils.TypeComparator;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.java.functions.KeySelector;
@@ -29,7 +30,7 @@ import org.apache.flink.runtime.checkpoint.CheckpointException;
 import org.apache.flink.runtime.checkpoint.channel.ChannelStateWriter;
 import org.apache.flink.runtime.io.AvailabilityProvider;
 import org.apache.flink.runtime.io.disk.iomanager.IOManager;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.memory.MemoryAllocationException;
 import org.apache.flink.runtime.memory.MemoryManager;
 import org.apache.flink.runtime.operators.sort.ExternalSorter;
@@ -86,7 +87,8 @@ public final class SortingDataInput<T, K> implements StreamTaskInput<T> {
             boolean objectReuse,
             double managedMemoryFraction,
             Configuration jobConfiguration,
-            AbstractInvokable containingTask) {
+            TaskInvokable containingTask,
+            ExecutionConfig executionConfig) {
         try {
             this.forwardingDataOutput = new ForwardingDataOutput();
             this.keySelector = keySelector;
@@ -108,7 +110,8 @@ public final class SortingDataInput<T, K> implements StreamTaskInput<T> {
                                     memoryManager,
                                     containingTask,
                                     keyAndValueSerializer,
-                                    comparator)
+                                    comparator,
+                                    executionConfig)
                             .memoryFraction(managedMemoryFraction)
                             .enableSpilling(
                                     ioManager,
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamMultipleInputProcessorFactory.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamMultipleInputProcessorFactory.java
index 7ba9e82d40c..fcfffffc805 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamMultipleInputProcessorFactory.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamMultipleInputProcessorFactory.java
@@ -29,7 +29,7 @@ import org.apache.flink.metrics.Counter;
 import org.apache.flink.metrics.SimpleCounter;
 import org.apache.flink.runtime.checkpoint.InflightDataRescalingDescriptor;
 import org.apache.flink.runtime.io.disk.iomanager.IOManager;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.memory.MemoryManager;
 import org.apache.flink.runtime.metrics.groups.TaskIOMetricGroup;
 import org.apache.flink.streaming.api.graph.StreamConfig;
@@ -65,7 +65,7 @@ public class StreamMultipleInputProcessorFactory {
 
     @SuppressWarnings({"unchecked", "rawtypes"})
     public static StreamMultipleInputProcessor create(
-            AbstractInvokable ownerTask,
+            TaskInvokable ownerTask,
             CheckpointedInputGate[] checkpointedInputGates,
             StreamConfig.InputConfig[] configuredInputs,
             IOManager ioManager,
@@ -175,7 +175,8 @@ public class StreamMultipleInputProcessorFactory {
                                     ManagedMemoryUseCase.OPERATOR,
                                     taskManagerConfig,
                                     userClassloader),
-                            jobConfig);
+                            jobConfig,
+                            executionConfig);
 
             StreamTaskInput<?>[] sortedInputs = selectableSortingInputs.getSortedInputs();
             StreamTaskInput<?>[] passedThroughInputs =
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamTwoInputProcessorFactory.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamTwoInputProcessorFactory.java
index ddc172e3aea..199f4b67964 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamTwoInputProcessorFactory.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/StreamTwoInputProcessorFactory.java
@@ -27,7 +27,7 @@ import org.apache.flink.core.memory.ManagedMemoryUseCase;
 import org.apache.flink.metrics.Counter;
 import org.apache.flink.runtime.checkpoint.InflightDataRescalingDescriptor;
 import org.apache.flink.runtime.io.disk.iomanager.IOManager;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.memory.MemoryManager;
 import org.apache.flink.runtime.metrics.groups.TaskIOMetricGroup;
 import org.apache.flink.streaming.api.graph.StreamConfig;
@@ -58,7 +58,7 @@ import static org.apache.flink.util.Preconditions.checkNotNull;
 /** A factory to create {@link StreamMultipleInputProcessor} for two input case. */
 public class StreamTwoInputProcessorFactory {
     public static <IN1, IN2> StreamMultipleInputProcessor create(
-            AbstractInvokable ownerTask,
+            TaskInvokable ownerTask,
             CheckpointedInputGate[] checkpointedInputGates,
             IOManager ioManager,
             MemoryManager memoryManager,
@@ -155,7 +155,8 @@ public class StreamTwoInputProcessorFactory {
                                     ManagedMemoryUseCase.OPERATOR,
                                     taskManagerConfig,
                                     userClassloader),
-                            jobConfig);
+                            jobConfig,
+                            executionConfig);
             inputSelectable = selectableSortingInputs.getInputSelectable();
             StreamTaskInput<?>[] sortedInputs = selectableSortingInputs.getSortedInputs();
             StreamTaskInput<?>[] passThroughInputs = selectableSortingInputs.getPassThroughInputs();
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointBarrierHandler.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointBarrierHandler.java
index 61286d0d93f..a67dfe4e2cb 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointBarrierHandler.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointBarrierHandler.java
@@ -25,7 +25,7 @@ import org.apache.flink.runtime.checkpoint.CheckpointMetricsBuilder;
 import org.apache.flink.runtime.checkpoint.channel.InputChannelInfo;
 import org.apache.flink.runtime.io.network.api.CancelCheckpointMarker;
 import org.apache.flink.runtime.io.network.api.CheckpointBarrier;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.CheckpointableTask;
 import org.apache.flink.util.clock.Clock;
 import org.apache.flink.util.concurrent.FutureUtils;
 
@@ -45,7 +45,7 @@ public abstract class CheckpointBarrierHandler implements Closeable {
     private static final long OUTSIDE_OF_ALIGNMENT = Long.MIN_VALUE;
 
     /** The listener to be notified on complete checkpoints. */
-    private final AbstractInvokable toNotifyOnCheckpoint;
+    private final CheckpointableTask toNotifyOnCheckpoint;
 
     private final Clock clock;
 
@@ -75,7 +75,7 @@ public abstract class CheckpointBarrierHandler implements Closeable {
     private final boolean enableCheckpointAfterTasksFinished;
 
     public CheckpointBarrierHandler(
-            AbstractInvokable toNotifyOnCheckpoint,
+            CheckpointableTask toNotifyOnCheckpoint,
             Clock clock,
             boolean enableCheckpointAfterTasksFinished) {
         this.toNotifyOnCheckpoint = checkNotNull(toNotifyOnCheckpoint);
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointBarrierTracker.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointBarrierTracker.java
index 8780308d2ba..40c388cb477 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointBarrierTracker.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/CheckpointBarrierTracker.java
@@ -25,7 +25,7 @@ import org.apache.flink.runtime.checkpoint.CheckpointFailureReason;
 import org.apache.flink.runtime.checkpoint.channel.InputChannelInfo;
 import org.apache.flink.runtime.io.network.api.CancelCheckpointMarker;
 import org.apache.flink.runtime.io.network.api.CheckpointBarrier;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.CheckpointableTask;
 import org.apache.flink.util.clock.Clock;
 
 import org.slf4j.Logger;
@@ -82,7 +82,7 @@ public class CheckpointBarrierTracker extends CheckpointBarrierHandler {
 
     public CheckpointBarrierTracker(
             int totalNumberOfInputChannels,
-            AbstractInvokable toNotifyOnCheckpoint,
+            CheckpointableTask toNotifyOnCheckpoint,
             Clock clock,
             boolean enableCheckpointAfterTasksFinished) {
         super(toNotifyOnCheckpoint, clock, enableCheckpointAfterTasksFinished);
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/InputProcessorUtil.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/InputProcessorUtil.java
index 3bd0264b6ee..efe61fde8c4 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/InputProcessorUtil.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/InputProcessorUtil.java
@@ -22,7 +22,7 @@ import org.apache.flink.api.common.operators.MailboxExecutor;
 import org.apache.flink.runtime.io.network.partition.consumer.CheckpointableInput;
 import org.apache.flink.runtime.io.network.partition.consumer.IndexedInputGate;
 import org.apache.flink.runtime.io.network.partition.consumer.InputGate;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.CheckpointableTask;
 import org.apache.flink.runtime.metrics.MetricNames;
 import org.apache.flink.runtime.metrics.groups.TaskIOMetricGroup;
 import org.apache.flink.streaming.api.environment.ExecutionCheckpointingOptions;
@@ -82,7 +82,7 @@ public class InputProcessorUtil {
     }
 
     public static CheckpointBarrierHandler createCheckpointBarrierHandler(
-            AbstractInvokable toNotifyOnCheckpoint,
+            CheckpointableTask toNotifyOnCheckpoint,
             StreamConfig config,
             SubtaskCheckpointCoordinator checkpointCoordinator,
             String taskName,
@@ -141,7 +141,7 @@ public class InputProcessorUtil {
     }
 
     private static SingleCheckpointBarrierHandler createBarrierHandler(
-            AbstractInvokable toNotifyOnCheckpoint,
+            CheckpointableTask toNotifyOnCheckpoint,
             StreamConfig config,
             SubtaskCheckpointCoordinator checkpointCoordinator,
             String taskName,
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/SingleCheckpointBarrierHandler.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/SingleCheckpointBarrierHandler.java
index 78798694a95..d7b05d28172 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/SingleCheckpointBarrierHandler.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/io/checkpointing/SingleCheckpointBarrierHandler.java
@@ -26,7 +26,7 @@ import org.apache.flink.runtime.checkpoint.channel.InputChannelInfo;
 import org.apache.flink.runtime.io.network.api.CancelCheckpointMarker;
 import org.apache.flink.runtime.io.network.api.CheckpointBarrier;
 import org.apache.flink.runtime.io.network.partition.consumer.CheckpointableInput;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.CheckpointableTask;
 import org.apache.flink.streaming.runtime.tasks.SubtaskCheckpointCoordinator;
 import org.apache.flink.util.ExceptionUtils;
 import org.apache.flink.util.clock.Clock;
@@ -101,7 +101,7 @@ public class SingleCheckpointBarrierHandler extends CheckpointBarrierHandler {
     public static SingleCheckpointBarrierHandler createUnalignedCheckpointBarrierHandler(
             SubtaskCheckpointCoordinator checkpointCoordinator,
             String taskName,
-            AbstractInvokable toNotifyOnCheckpoint,
+            CheckpointableTask toNotifyOnCheckpoint,
             Clock clock,
             boolean enableCheckpointsAfterTasksFinish,
             CheckpointableInput... inputs) {
@@ -124,7 +124,7 @@ public class SingleCheckpointBarrierHandler extends CheckpointBarrierHandler {
 
     public static SingleCheckpointBarrierHandler unaligned(
             String taskName,
-            AbstractInvokable toNotifyOnCheckpoint,
+            CheckpointableTask toNotifyOnCheckpoint,
             SubtaskCheckpointCoordinator checkpointCoordinator,
             Clock clock,
             int numOpenChannels,
@@ -146,7 +146,7 @@ public class SingleCheckpointBarrierHandler extends CheckpointBarrierHandler {
 
     public static SingleCheckpointBarrierHandler aligned(
             String taskName,
-            AbstractInvokable toNotifyOnCheckpoint,
+            CheckpointableTask toNotifyOnCheckpoint,
             Clock clock,
             int numOpenChannels,
             BiFunction<Callable<?>, Duration, Cancellable> registerTimer,
@@ -167,7 +167,7 @@ public class SingleCheckpointBarrierHandler extends CheckpointBarrierHandler {
 
     public static SingleCheckpointBarrierHandler alternating(
             String taskName,
-            AbstractInvokable toNotifyOnCheckpoint,
+            CheckpointableTask toNotifyOnCheckpoint,
             SubtaskCheckpointCoordinator checkpointCoordinator,
             Clock clock,
             int numOpenChannels,
@@ -189,7 +189,7 @@ public class SingleCheckpointBarrierHandler extends CheckpointBarrierHandler {
 
     private SingleCheckpointBarrierHandler(
             String taskName,
-            AbstractInvokable toNotifyOnCheckpoint,
+            CheckpointableTask toNotifyOnCheckpoint,
             @Nullable SubtaskCheckpointCoordinator subTaskCheckpointCoordinator,
             Clock clock,
             int numOpenChannels,
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/ContainingTaskDetails.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/ContainingTaskDetails.java
new file mode 100644
index 00000000000..ffafc7e8c10
--- /dev/null
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/ContainingTaskDetails.java
@@ -0,0 +1,48 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *    http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.streaming.runtime.tasks;
+
+import org.apache.flink.annotation.Internal;
+import org.apache.flink.api.common.ExecutionConfig;
+import org.apache.flink.configuration.Configuration;
+import org.apache.flink.runtime.execution.Environment;
+
+/** Details about the operator containing task (such as {@link StreamTask}). */
+@Internal
+public interface ContainingTaskDetails extends EnvironmentProvider {
+
+    default ClassLoader getUserCodeClassLoader() {
+        return getEnvironment().getUserCodeClassLoader().asClassLoader();
+    }
+
+    default ExecutionConfig getExecutionConfig() {
+        return this.getEnvironment().getExecutionConfig();
+    }
+
+    default Configuration getJobConfiguration() {
+        return this.getEnvironment().getJobConfiguration();
+    }
+
+    default int getIndexInSubtaskGroup() {
+        return this.getEnvironment().getTaskInfo().getIndexOfThisSubtask();
+    }
+}
+
+interface EnvironmentProvider {
+    Environment getEnvironment();
+}
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/MultipleInputStreamTask.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/MultipleInputStreamTask.java
index 378a3e2f292..92a65008c04 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/MultipleInputStreamTask.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/MultipleInputStreamTask.java
@@ -167,7 +167,7 @@ public class MultipleInputStreamTask<OUT>
                         mainOperator,
                         inputWatermarkGauges,
                         getConfiguration(),
-                        getTaskConfiguration(),
+                        getEnvironment().getTaskConfiguration(),
                         getJobConfiguration(),
                         getExecutionConfig(),
                         getUserCodeClassLoader(),
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/OneInputStreamTask.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/OneInputStreamTask.java
index caee3ea22f1..8743ebdb5d6 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/OneInputStreamTask.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/OneInputStreamTask.java
@@ -144,9 +144,12 @@ public class OneInputStreamTask<IN, OUT> extends StreamTask<OUT, OneInputStreamO
                 getEnvironment().getIOManager(),
                 getExecutionConfig().isObjectReuseEnabled(),
                 configuration.getManagedMemoryFractionOperatorUseCaseOfSlot(
-                        ManagedMemoryUseCase.OPERATOR, getTaskConfiguration(), userCodeClassLoader),
+                        ManagedMemoryUseCase.OPERATOR,
+                        getEnvironment().getTaskConfiguration(),
+                        userCodeClassLoader),
                 getJobConfiguration(),
-                this);
+                this,
+                getExecutionConfig());
     }
 
     @SuppressWarnings("unchecked")
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/StreamTask.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/StreamTask.java
index 5a97c0e95e5..59fb0333270 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/StreamTask.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/StreamTask.java
@@ -50,7 +50,9 @@ import org.apache.flink.runtime.io.network.partition.ChannelStateHolder;
 import org.apache.flink.runtime.io.network.partition.consumer.IndexedInputGate;
 import org.apache.flink.runtime.io.network.partition.consumer.InputGate;
 import org.apache.flink.runtime.jobgraph.OperatorID;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.CheckpointableTask;
+import org.apache.flink.runtime.jobgraph.tasks.CoordinatedTask;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.metrics.MetricNames;
 import org.apache.flink.runtime.metrics.TimerGauge;
 import org.apache.flink.runtime.metrics.groups.TaskIOMetricGroup;
@@ -173,8 +175,12 @@ import static org.apache.flink.util.concurrent.FutureUtils.assertNoException;
  * @param <OP>
  */
 @Internal
-public abstract class StreamTask<OUT, OP extends StreamOperator<OUT>> extends AbstractInvokable
-        implements AsyncExceptionHandler {
+public abstract class StreamTask<OUT, OP extends StreamOperator<OUT>>
+        implements TaskInvokable,
+                CheckpointableTask,
+                CoordinatedTask,
+                AsyncExceptionHandler,
+                ContainingTaskDetails {
 
     /** The thread group that holds all trigger timer threads. */
     public static final ThreadGroup TRIGGER_THREAD_GROUP = new ThreadGroup("Triggers");
@@ -287,6 +293,10 @@ public abstract class StreamTask<OUT, OP extends StreamOperator<OUT>> extends Ab
 
     private final long bufferDebloatPeriod;
 
+    private final Environment environment;
+
+    private volatile boolean shouldInterruptOnCancel = true;
+
     // ------------------------------------------------------------------------
 
     /**
@@ -355,10 +365,8 @@ public abstract class StreamTask<OUT, OP extends StreamOperator<OUT>> extends Ab
             StreamTaskActionExecutor actionExecutor,
             TaskMailbox mailbox)
             throws Exception {
-
-        super(environment);
-
-        this.configuration = new StreamConfig(getTaskConfiguration());
+        this.environment = environment;
+        this.configuration = new StreamConfig(environment.getTaskConfiguration());
         this.recordWriter = createRecordWriterDelegate(configuration, environment);
         this.actionExecutor = Preconditions.checkNotNull(actionExecutor);
         this.mailboxProcessor = new MailboxProcessor(this::processInput, mailbox, actionExecutor);
@@ -376,12 +384,12 @@ public abstract class StreamTask<OUT, OP extends StreamOperator<OUT>> extends Ab
 
         this.subtaskCheckpointCoordinator =
                 new SubtaskCheckpointCoordinatorImpl(
-                        checkpointStorage.createCheckpointStorage(getEnvironment().getJobID()),
+                        checkpointStorage.createCheckpointStorage(environment.getJobID()),
                         getName(),
                         actionExecutor,
                         getCancelables(),
                         getAsyncOperationsThreadPool(),
-                        getEnvironment(),
+                        environment,
                         this,
                         configuration.isUnalignedCheckpointsEnabled(),
                         configuration
@@ -413,7 +421,7 @@ public abstract class StreamTask<OUT, OP extends StreamOperator<OUT>> extends Ab
 
         if (taskManagerConf.get(TaskManagerOptions.BUFFER_DEBLOAT_ENABLED)) {
             this.bufferDebloater =
-                    new BufferDebloater(taskManagerConf, getEnvironment().getAllInputGates());
+                    new BufferDebloater(taskManagerConf, environment.getAllInputGates());
             environment
                     .getMetricGroup()
                     .gauge(
@@ -879,7 +887,7 @@ public abstract class StreamTask<OUT, OP extends StreamOperator<OUT>> extends Ab
         // that block and stall shutdown.
         // Additionally, the cancellation watch dog will issue a hard-cancel (kill the TaskManager
         // process) as a backup in case some shutdown procedure blocks outside our control.
-        setShouldInterruptOnCancel(false);
+        shouldInterruptOnCancel = false;
 
         // clear any previously issued interrupt for a more graceful shutdown
         Thread.interrupted();
@@ -1713,4 +1721,14 @@ public abstract class StreamTask<OUT, OP extends StreamOperator<OUT>> extends Ab
     public boolean isUsingNonBlockingInput() {
         return true;
     }
+
+    @Override
+    public boolean shouldInterruptOnCancel() {
+        return shouldInterruptOnCancel;
+    }
+
+    @Override
+    public final Environment getEnvironment() {
+        return environment;
+    }
 }
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/TwoInputStreamTask.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/TwoInputStreamTask.java
index 87e9ee6c507..5f9bfcef0db 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/TwoInputStreamTask.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/TwoInputStreamTask.java
@@ -95,7 +95,7 @@ public class TwoInputStreamTask<IN1, IN2, OUT> extends AbstractTwoInputStreamTas
                         input2WatermarkGauge,
                         operatorChain,
                         getConfiguration(),
-                        getTaskConfiguration(),
+                        getEnvironment().getTaskConfiguration(),
                         getJobConfiguration(),
                         getExecutionConfig(),
                         getUserCodeClassLoader(),
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/LargeSortingDataInputITCase.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/LargeSortingDataInputITCase.java
index 116e0d47ecc..21aa798b12f 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/LargeSortingDataInputITCase.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/LargeSortingDataInputITCase.java
@@ -18,6 +18,7 @@
 
 package org.apache.flink.streaming.api.operators.sort;
 
+import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.common.typeutils.base.IntSerializer;
 import org.apache.flink.api.common.typeutils.base.StringSerializer;
@@ -81,7 +82,8 @@ public class LargeSortingDataInputITCase {
                                 true,
                                 1.0,
                                 new Configuration(),
-                                new DummyInvokable())) {
+                                new DummyInvokable(),
+                                new ExecutionConfig())) {
             DataInputStatus inputStatus;
             VerifyingOutput<Integer> output = new VerifyingOutput<>(keySelector);
             do {
@@ -109,7 +111,8 @@ public class LargeSortingDataInputITCase {
                                 true,
                                 1.0,
                                 new Configuration(),
-                                new DummyInvokable())) {
+                                new DummyInvokable(),
+                                new ExecutionConfig())) {
             DataInputStatus inputStatus;
             VerifyingOutput<String> output = new VerifyingOutput<>(keySelector);
             do {
@@ -143,7 +146,8 @@ public class LargeSortingDataInputITCase {
                             environment.getIOManager(),
                             true,
                             1.0,
-                            new Configuration());
+                            new Configuration(),
+                            new ExecutionConfig());
 
             StreamTaskInput<?>[] sortingDataInputs = selectableSortingInputs.getSortedInputs();
             try (StreamTaskInput<Tuple3<Integer, String, byte[]>> sortedInput1 =
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/MultiInputSortingDataInputsTest.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/MultiInputSortingDataInputsTest.java
index ee91bb70940..11368c22f44 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/MultiInputSortingDataInputsTest.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/MultiInputSortingDataInputsTest.java
@@ -18,6 +18,7 @@
 
 package org.apache.flink.streaming.api.operators.sort;
 
+import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.typeutils.TypeSerializer;
 import org.apache.flink.api.common.typeutils.base.IntSerializer;
 import org.apache.flink.api.java.functions.KeySelector;
@@ -93,7 +94,8 @@ public class MultiInputSortingDataInputsTest {
                             environment.getIOManager(),
                             true,
                             1.0,
-                            new Configuration());
+                            new Configuration(),
+                            new ExecutionConfig());
 
             StreamTaskInput<?>[] sortingDataInputs = selectableSortingInputs.getSortedInputs();
             StreamTaskInput<?>[] preferredDataInputs =
@@ -174,7 +176,8 @@ public class MultiInputSortingDataInputsTest {
                             environment.getIOManager(),
                             true,
                             1.0,
-                            new Configuration());
+                            new Configuration(),
+                            new ExecutionConfig());
 
             StreamTaskInput<?>[] sortingDataInputs = selectableSortingInputs.getSortedInputs();
             try (StreamTaskInput<Object> input1 = (StreamTaskInput<Object>) sortingDataInputs[0];
@@ -254,7 +257,8 @@ public class MultiInputSortingDataInputsTest {
                             environment.getIOManager(),
                             true,
                             1.0,
-                            new Configuration());
+                            new Configuration(),
+                            new ExecutionConfig());
 
             StreamTaskInput<?>[] sortingDataInputs = selectableSortingInputs.getSortedInputs();
             try (StreamTaskInput<Object> input1 = (StreamTaskInput<Object>) sortingDataInputs[0];
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/SortingDataInputTest.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/SortingDataInputTest.java
index cd72677a898..3271f64e2d7 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/SortingDataInputTest.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/api/operators/sort/SortingDataInputTest.java
@@ -18,6 +18,7 @@
 
 package org.apache.flink.streaming.api.operators.sort;
 
+import org.apache.flink.api.common.ExecutionConfig;
 import org.apache.flink.api.common.typeutils.base.IntSerializer;
 import org.apache.flink.api.common.typeutils.base.StringSerializer;
 import org.apache.flink.api.java.functions.KeySelector;
@@ -66,7 +67,8 @@ public class SortingDataInputTest {
                         true,
                         1.0,
                         new Configuration(),
-                        new DummyInvokable());
+                        new DummyInvokable(),
+                        new ExecutionConfig());
 
         DataInputStatus inputStatus;
         do {
@@ -115,7 +117,8 @@ public class SortingDataInputTest {
                         true,
                         1.0,
                         new Configuration(),
-                        new DummyInvokable());
+                        new DummyInvokable(),
+                        new ExecutionConfig());
 
         DataInputStatus inputStatus;
         do {
@@ -159,7 +162,8 @@ public class SortingDataInputTest {
                         true,
                         1.0,
                         new Configuration(),
-                        new DummyInvokable());
+                        new DummyInvokable(),
+                        new ExecutionConfig());
 
         DataInputStatus inputStatus;
         do {
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTest.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTest.java
index 40338185dd5..7e09e85d123 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTest.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTest.java
@@ -54,7 +54,7 @@ import org.apache.flink.runtime.io.network.api.writer.ResultPartitionWriter;
 import org.apache.flink.runtime.io.network.partition.consumer.InputGate;
 import org.apache.flink.runtime.io.network.partition.consumer.TestInputChannel;
 import org.apache.flink.runtime.jobgraph.OperatorID;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.metrics.MetricNames;
 import org.apache.flink.runtime.metrics.TimerGauge;
 import org.apache.flink.runtime.metrics.groups.TaskIOMetricGroup;
@@ -2044,7 +2044,7 @@ public class StreamTaskTest extends TestLogger {
     }
 
     public static Task createTask(
-            Class<? extends AbstractInvokable> invokable,
+            Class<? extends TaskInvokable> invokable,
             ShuffleEnvironment shuffleEnvironment,
             StreamConfig taskConfig,
             Configuration taskManagerConfig)
@@ -2741,7 +2741,7 @@ public class StreamTaskTest extends TestLogger {
     /**
      * A {@link StreamTask} that register a single timer that waits for a cancellation and then
      * emits some data. The assumption is that output remains available until the future returned
-     * from {@link AbstractInvokable#cancel()} is completed. Public * access to allow reflection in
+     * from {@link TaskInvokable#cancel()} is completed. Public * access to allow reflection in
      * {@link Task}.
      */
     public static class StreamTaskWithBlockingTimer extends StreamTask {
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTestHarness.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTestHarness.java
index 75601af6f8f..315fb43ce81 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTestHarness.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTestHarness.java
@@ -300,6 +300,9 @@ public class StreamTaskTestHarness<OUT> {
         taskThread.start();
         // Wait until the task is set
         while (taskThread.task == null) {
+            if (taskThread.error != null) {
+                ExceptionUtils.rethrow(taskThread.error);
+            }
             Thread.sleep(10L);
         }
 
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/SynchronousCheckpointITCase.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/SynchronousCheckpointITCase.java
index b77e2cf0a43..9a1b329a18f 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/SynchronousCheckpointITCase.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/SynchronousCheckpointITCase.java
@@ -44,8 +44,8 @@ import org.apache.flink.runtime.io.network.TaskEventDispatcher;
 import org.apache.flink.runtime.io.network.partition.NoOpResultPartitionConsumableNotifier;
 import org.apache.flink.runtime.io.network.partition.ResultPartitionConsumableNotifier;
 import org.apache.flink.runtime.jobgraph.JobVertexID;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
 import org.apache.flink.runtime.jobgraph.tasks.InputSplitProvider;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.memory.MemoryManager;
 import org.apache.flink.runtime.metrics.groups.TaskMetricGroup;
 import org.apache.flink.runtime.metrics.groups.UnregisteredMetricGroups;
@@ -221,7 +221,7 @@ public class SynchronousCheckpointITCase {
     // --------------------------		Boilerplate tools copied from the TaskAsyncCallTest
     //	--------------------------
 
-    private Task createTask(Class<? extends AbstractInvokable> invokableClass) throws Exception {
+    private Task createTask(Class<? extends TaskInvokable> invokableClass) throws Exception {
 
         ResultPartitionConsumableNotifier consumableNotifier =
                 new NoOpResultPartitionConsumableNotifier();
diff --git a/flink-tests/src/test/java/org/apache/flink/runtime/jobmaster/JobMasterStopWithSavepointITCase.java b/flink-tests/src/test/java/org/apache/flink/runtime/jobmaster/JobMasterStopWithSavepointITCase.java
index 399b96079f0..5a98d140c92 100644
--- a/flink-tests/src/test/java/org/apache/flink/runtime/jobmaster/JobMasterStopWithSavepointITCase.java
+++ b/flink-tests/src/test/java/org/apache/flink/runtime/jobmaster/JobMasterStopWithSavepointITCase.java
@@ -36,9 +36,9 @@ import org.apache.flink.runtime.execution.Environment;
 import org.apache.flink.runtime.jobgraph.JobGraph;
 import org.apache.flink.runtime.jobgraph.JobGraphBuilder;
 import org.apache.flink.runtime.jobgraph.JobVertex;
-import org.apache.flink.runtime.jobgraph.tasks.AbstractInvokable;
 import org.apache.flink.runtime.jobgraph.tasks.CheckpointCoordinatorConfiguration;
 import org.apache.flink.runtime.jobgraph.tasks.JobCheckpointingSettings;
+import org.apache.flink.runtime.jobgraph.tasks.TaskInvokable;
 import org.apache.flink.runtime.testutils.CommonTestUtils;
 import org.apache.flink.streaming.runtime.tasks.StreamTask;
 import org.apache.flink.streaming.runtime.tasks.StreamTaskTest.NoOpStreamTask;
@@ -251,7 +251,7 @@ public class JobMasterStopWithSavepointITCase extends AbstractTestBase {
     }
 
     private void setUpJobGraph(
-            final Class<? extends AbstractInvokable> invokable,
+            final Class<? extends TaskInvokable> invokable,
             final RestartStrategies.RestartStrategyConfiguration restartStrategy)
             throws Exception {
 
