diff --git a/flink-connectors/flink-connector-elasticsearch-base/pom.xml b/flink-connectors/flink-connector-elasticsearch-base/pom.xml
index 113a4756cdd..f5c4252bd76 100644
--- a/flink-connectors/flink-connector-elasticsearch-base/pom.xml
+++ b/flink-connectors/flink-connector-elasticsearch-base/pom.xml
@@ -37,7 +37,7 @@ under the License.
 
 	<!-- Allow users to pass custom connector versions -->
 	<properties>
-		<elasticsearch.version>5.1.2</elasticsearch.version>
+		<elasticsearch.version>5.3.3</elasticsearch.version>
 	</properties>
 
 	<dependencies>
diff --git a/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBase.java b/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBase.java
index c8df2c0f9fa..c285112d63f 100644
--- a/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBase.java
+++ b/flink-connectors/flink-connector-elasticsearch-base/src/main/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBase.java
@@ -29,6 +29,7 @@ import org.apache.flink.streaming.api.functions.sink.RichSinkFunction;
 import org.apache.flink.util.InstantiationUtil;
 
 import org.elasticsearch.action.ActionRequest;
+import org.elasticsearch.action.DocWriteRequest;
 import org.elasticsearch.action.bulk.BulkItemResponse;
 import org.elasticsearch.action.bulk.BulkProcessor;
 import org.elasticsearch.action.bulk.BulkRequest;
@@ -389,6 +390,7 @@ public abstract class ElasticsearchSinkBase<T, C extends AutoCloseable> extends
 	}
 
 	private class BulkProcessorListener implements BulkProcessor.Listener {
+
 		@Override
 		public void beforeBulk(long executionId, BulkRequest request) { }
 
@@ -398,6 +400,7 @@ public abstract class ElasticsearchSinkBase<T, C extends AutoCloseable> extends
 				BulkItemResponse itemResponse;
 				Throwable failure;
 				RestStatus restStatus;
+				DocWriteRequest actionRequest;
 
 				try {
 					for (int i = 0; i < response.getItems().length; i++) {
@@ -407,10 +410,19 @@ public abstract class ElasticsearchSinkBase<T, C extends AutoCloseable> extends
 							LOG.error("Failed Elasticsearch item request: {}", itemResponse.getFailureMessage(), failure);
 
 							restStatus = itemResponse.getFailure().getStatus();
+							actionRequest = request.requests().get(i);
 							if (restStatus == null) {
-								failureHandler.onFailure(request.requests().get(i), failure, -1, failureRequestIndexer);
+								if (actionRequest instanceof ActionRequest) {
+									failureHandler.onFailure((ActionRequest) actionRequest, failure, -1, failureRequestIndexer);
+								} else {
+									throw new UnsupportedOperationException("The sink currently only supports ActionRequests");
+								}
 							} else {
-								failureHandler.onFailure(request.requests().get(i), failure, restStatus.getStatus(), failureRequestIndexer);
+								if (actionRequest instanceof ActionRequest) {
+									failureHandler.onFailure((ActionRequest) actionRequest, failure, restStatus.getStatus(), failureRequestIndexer);
+								} else {
+									throw new UnsupportedOperationException("The sink currently only supports ActionRequests");
+								}
 							}
 						}
 					}
@@ -431,8 +443,12 @@ public abstract class ElasticsearchSinkBase<T, C extends AutoCloseable> extends
 			LOG.error("Failed Elasticsearch bulk request: {}", failure.getMessage(), failure);
 
 			try {
-				for (ActionRequest action : request.requests()) {
-					failureHandler.onFailure(action, failure, -1, failureRequestIndexer);
+				for (DocWriteRequest writeRequest : request.requests()) {
+					if (writeRequest instanceof ActionRequest) {
+						failureHandler.onFailure((ActionRequest) writeRequest, failure, -1, failureRequestIndexer);
+					} else {
+						throw new UnsupportedOperationException("The sink currently only supports ActionRequests");
+					}
 				}
 			} catch (Throwable t) {
 				// fail the sink and skip the rest of the items
diff --git a/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBaseTest.java b/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBaseTest.java
index f0e401ef2b4..0648ed917d6 100644
--- a/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBaseTest.java
+++ b/flink-connectors/flink-connector-elasticsearch-base/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/ElasticsearchSinkBaseTest.java
@@ -26,6 +26,7 @@ import org.apache.flink.streaming.runtime.streamrecord.StreamRecord;
 import org.apache.flink.streaming.util.OneInputStreamOperatorTestHarness;
 
 import org.elasticsearch.action.ActionRequest;
+import org.elasticsearch.action.DocWriteRequest;
 import org.elasticsearch.action.DocWriteResponse;
 import org.elasticsearch.action.bulk.BulkItemResponse;
 import org.elasticsearch.action.bulk.BulkProcessor;
@@ -419,7 +420,7 @@ public class ElasticsearchSinkBaseTest {
 		private transient BulkRequest nextBulkRequest = new BulkRequest();
 		private transient MultiShotLatch flushLatch = new MultiShotLatch();
 
-		private List<? extends Throwable> mockItemFailuresList;
+		private List<? extends Exception> mockItemFailuresList;
 		private Throwable nextBulkFailure;
 
 		public DummyElasticsearchSink(
@@ -454,7 +455,7 @@ public class ElasticsearchSinkBaseTest {
 		 * <p>The list is used with corresponding order to the requests in the bulk, i.e. the first
 		 * request uses the response at index 0, the second requests uses the response at index 1, etc.
 		 */
-		public void setMockItemFailuresListForNextBulkItemResponses(List<? extends Throwable> mockItemFailuresList) {
+		public void setMockItemFailuresListForNextBulkItemResponses(List<? extends Exception> mockItemFailuresList) {
 			this.mockItemFailuresList = mockItemFailuresList;
 		}
 
@@ -506,14 +507,14 @@ public class ElasticsearchSinkBaseTest {
 						if (nextBulkFailure == null) {
 							BulkItemResponse[] mockResponses = new BulkItemResponse[currentBulkRequest.requests().size()];
 							for (int i = 0; i < currentBulkRequest.requests().size(); i++) {
-								Throwable mockItemFailure = mockItemFailuresList.get(i);
+								Exception mockItemFailure = mockItemFailuresList.get(i);
 
 								if (mockItemFailure == null) {
 									// the mock response for the item is success
-									mockResponses[i] = new BulkItemResponse(i, "opType", mock(DocWriteResponse.class));
+									mockResponses[i] = new BulkItemResponse(i, DocWriteRequest.OpType.INDEX, mock(DocWriteResponse.class));
 								} else {
 									// the mock response for the item is failure
-									mockResponses[i] = new BulkItemResponse(i, "opType", new BulkItemResponse.Failure("index", "type", "id", mockItemFailure));
+									mockResponses[i] = new BulkItemResponse(i, DocWriteRequest.OpType.INDEX, new BulkItemResponse.Failure("index", "type", "id", mockItemFailure));
 								}
 							}
 
diff --git a/flink-connectors/flink-connector-elasticsearch5/pom.xml b/flink-connectors/flink-connector-elasticsearch5/pom.xml
index bbec5a59375..0a846d8b8ac 100644
--- a/flink-connectors/flink-connector-elasticsearch5/pom.xml
+++ b/flink-connectors/flink-connector-elasticsearch5/pom.xml
@@ -37,7 +37,7 @@ under the License.
 
 	<!-- Allow users to pass custom connector versions -->
 	<properties>
-		<elasticsearch.version>5.1.2</elasticsearch.version>
+		<elasticsearch.version>5.3.3</elasticsearch.version>
 	</properties>
 
 	<dependencyManagement>
diff --git a/flink-connectors/flink-connector-elasticsearch5/src/main/resources/META-INF/NOTICE b/flink-connectors/flink-connector-elasticsearch5/src/main/resources/META-INF/NOTICE
index 5ab36a27042..c30871cf6ff 100644
--- a/flink-connectors/flink-connector-elasticsearch5/src/main/resources/META-INF/NOTICE
+++ b/flink-connectors/flink-connector-elasticsearch5/src/main/resources/META-INF/NOTICE
@@ -16,44 +16,44 @@ This project bundles the following dependencies under the Apache Software Licens
 - commons-codec:commons-codec:1.10
 - commons-logging:commons-logging:1.1.3
 - io.netty:netty:3.10.6.Final
-- io.netty:netty-buffer:4.1.6.Final
-- io.netty:netty-codec:4.1.6.Final
-- io.netty:netty-codec-http:4.1.6.Final
-- io.netty:netty-common:4.1.6.Final
-- io.netty:netty-handler:4.1.6.Final
-- io.netty:netty-resolver:4.1.6.Final
-- io.netty:netty-transport:4.1.6.Final
-- joda.time:joda-time:2.5
+- io.netty:netty-buffer:4.1.7.Final
+- io.netty:netty-codec:4.1.7.Final
+- io.netty:netty-codec-http:4.1.7.Final
+- io.netty:netty-common:4.1.7.Final
+- io.netty:netty-handler:4.1.7.Final
+- io.netty:netty-resolver:4.1.7.Final
+- io.netty:netty-transport:4.1.7.Final
+- joda-time:joda-time:2.5
 - net.java.dev.jna:jna:4.2.2
 - org.apache.httpcomponents:httpasynclcient:4.1.2
 - org.apache.httpcomponents:httpclient:4.5.3
 - org.apache.httpcomponents:httpcore:4.4.6
 - org.apache.httpcomponents:httpcore-nio:4.4.5
-- org.apache.lucene:lucene-analyzers-common:6.3.0
-- org.apache.lucene:lucene-backward-codecs:6.3.0
-- org.apache.lucene:lucene-core:6.3.0
-- org.apache.lucene:lucene-grouping:6.3.0
-- org.apache.lucene:lucene-highlighter:6.3.0
-- org.apache.lucene:lucene-join:6.3.0
-- org.apache.lucene:lucene-memory:6.3.0
-- org.apache.lucene:lucene-misc:6.3.0
-- org.apache.lucene:lucene-queries:6.3.0
-- org.apache.lucene:lucene-queryparser:6.3.0
-- org.apache.lucene:lucene-sandbox:6.3.0
-- org.apache.lucene:lucene-spatial:6.3.0
-- org.apache.lucene:lucene-spatial-extras:6.3.0
-- org.apache.lucene:lucene-spatial3d:6.3.0
-- org.apache.lucene:lucene-suggest:6.3.0
-- org.elasticsearch:elasticsearch:5.1.2
+- org.apache.lucene:lucene-analyzers-common:6.4.2
+- org.apache.lucene:lucene-backward-codecs:6.4.2
+- org.apache.lucene:lucene-core:6.4.2
+- org.apache.lucene:lucene-grouping:6.4.2
+- org.apache.lucene:lucene-highlighter:6.4.2
+- org.apache.lucene:lucene-join:6.4.2
+- org.apache.lucene:lucene-memory:6.4.2
+- org.apache.lucene:lucene-misc:6.4.2
+- org.apache.lucene:lucene-queries:6.4.2
+- org.apache.lucene:lucene-queryparser:6.4.2
+- org.apache.lucene:lucene-sandbox:6.4.2
+- org.apache.lucene:lucene-spatial:6.4.2
+- org.apache.lucene:lucene-spatial-extras:6.4.2
+- org.apache.lucene:lucene-spatial3d:6.4.2
+- org.apache.lucene:lucene-suggest:6.4.2
+- org.elasticsearch:elasticsearch:5.3.3
 - org.elasticsearch:securesm:1.1
-- org.elasticsearch.client:rest:5.1.2
-- org.elasticsearch.client:transport:5.1.2
-- org.elasticsearch.plugin:lang-mustache-client:5.1.2
-- org.elasticsearch.plugin:percolator-client:5.1.2
-- org.elasticsearch.plugin:reindex-client:5.1.2
-- org.elasticsearch.plugin:transport-netty3-client:5.1.2
-- org.elasticsearch.plugin:transport-netty4-client:5.1.2
-- org.yaml:snakeyaml:1.15
+- org.elasticsearch.client:rest:5.3.3
+- org.elasticsearch.client:transport:5.3.3
+- org.elasticsearch.plugin:lang-mustache-client:5.3.3
+- org.elasticsearch.plugin:percolator-client:5.3.3
+- org.elasticsearch.plugin:reindex-client:5.3.3
+- org.elasticsearch.plugin:transport-netty3-client:5.3.3
+- org.elasticsearch.plugin:transport-netty4-client:5.3.3
+- org.yaml:snakeyaml:1.25
 
 This project bundles the following dependencies under the MIT license. (https://opensource.org/licenses/MIT)
 
diff --git a/flink-connectors/flink-connector-elasticsearch5/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/EmbeddedElasticsearchNodeEnvironmentImpl.java b/flink-connectors/flink-connector-elasticsearch5/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/EmbeddedElasticsearchNodeEnvironmentImpl.java
index 16e292d3c7e..3bd20255d87 100644
--- a/flink-connectors/flink-connector-elasticsearch5/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/EmbeddedElasticsearchNodeEnvironmentImpl.java
+++ b/flink-connectors/flink-connector-elasticsearch5/src/test/java/org/apache/flink/streaming/connectors/elasticsearch/EmbeddedElasticsearchNodeEnvironmentImpl.java
@@ -23,8 +23,8 @@ import org.apache.flink.streaming.connectors.elasticsearch5.ElasticsearchSinkITC
 import org.elasticsearch.client.Client;
 import org.elasticsearch.common.network.NetworkModule;
 import org.elasticsearch.common.settings.Settings;
+import org.elasticsearch.node.InternalSettingsPreparer;
 import org.elasticsearch.node.Node;
-import org.elasticsearch.node.internal.InternalSettingsPreparer;
 import org.elasticsearch.plugins.Plugin;
 import org.elasticsearch.transport.Netty3Plugin;
 
diff --git a/flink-end-to-end-tests/run-nightly-tests.sh b/flink-end-to-end-tests/run-nightly-tests.sh
index 9174ed654b5..a7b68517eb7 100755
--- a/flink-end-to-end-tests/run-nightly-tests.sh
+++ b/flink-end-to-end-tests/run-nightly-tests.sh
@@ -157,7 +157,7 @@ run_test "Streaming File Sink end-to-end test" "$END_TO_END_DIR/test-scripts/tes
 run_test "Streaming File Sink s3 end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_file_sink.sh s3" "skip_check_exceptions"
 run_test "Stateful stream job upgrade end-to-end test" "$END_TO_END_DIR/test-scripts/test_stateful_stream_job_upgrade.sh 2 4"
 
-run_test "Elasticsearch (v5.1.2) sink end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_elasticsearch.sh 5 https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.1.2.tar.gz"
+run_test "Elasticsearch (v5.3.3) sink end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_elasticsearch.sh 5 https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.3.3.tar.gz"
 run_test "Elasticsearch (v6.3.1) sink end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_elasticsearch.sh 6 https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.3.1.tar.gz"
 
 run_test "Quickstarts Java nightly end-to-end test" "$END_TO_END_DIR/test-scripts/test_quickstarts.sh java"
diff --git a/flink-end-to-end-tests/test-scripts/test_quickstarts.sh b/flink-end-to-end-tests/test-scripts/test_quickstarts.sh
index 3999f96509e..e1d71c66ad4 100755
--- a/flink-end-to-end-tests/test-scripts/test_quickstarts.sh
+++ b/flink-end-to-end-tests/test-scripts/test_quickstarts.sh
@@ -95,7 +95,7 @@ else
     echo "Success: Elasticsearch5SinkExample.class and other user classes are included in the jar."
 fi
 
-setup_elasticsearch "https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.1.2.tar.gz"
+setup_elasticsearch "https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.3.3.tar.gz"
 wait_elasticsearch_working
 
 function shutdownAndCleanup {
diff --git a/tools/travis/splits/split_misc.sh b/tools/travis/splits/split_misc.sh
index 814775a1930..30f1d927366 100755
--- a/tools/travis/splits/split_misc.sh
+++ b/tools/travis/splits/split_misc.sh
@@ -57,7 +57,7 @@ run_test "Streaming File Sink end-to-end test" "$END_TO_END_DIR/test-scripts/tes
 run_test "Streaming File Sink s3 end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_file_sink.sh s3" "skip_check_exceptions"
 run_test "Stateful stream job upgrade end-to-end test" "$END_TO_END_DIR/test-scripts/test_stateful_stream_job_upgrade.sh 2 4"
 
-run_test "Elasticsearch (v5.1.2) sink end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_elasticsearch.sh 5 https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.1.2.tar.gz"
+run_test "Elasticsearch (v5.3.3) sink end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_elasticsearch.sh 5 https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.3.3.tar.gz"
 run_test "Elasticsearch (v6.3.1) sink end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_elasticsearch.sh 6 https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.3.1.tar.gz"
 
 run_test "Quickstarts Java nightly end-to-end test" "$END_TO_END_DIR/test-scripts/test_quickstarts.sh java"
diff --git a/tools/travis/splits/split_misc_hadoopfree.sh b/tools/travis/splits/split_misc_hadoopfree.sh
index 609f257aab1..bf7ac04da56 100755
--- a/tools/travis/splits/split_misc_hadoopfree.sh
+++ b/tools/travis/splits/split_misc_hadoopfree.sh
@@ -56,7 +56,7 @@ run_test "Streaming File Sink end-to-end test" "$END_TO_END_DIR/test-scripts/tes
 run_test "Streaming File Sink s3 end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_file_sink.sh s3" "skip_check_exceptions"
 run_test "Stateful stream job upgrade end-to-end test" "$END_TO_END_DIR/test-scripts/test_stateful_stream_job_upgrade.sh 2 4"
 
-run_test "Elasticsearch (v5.1.2) sink end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_elasticsearch.sh 5 https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.1.2.tar.gz"
+run_test "Elasticsearch (v5.3.3) sink end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_elasticsearch.sh 5 https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.3.3.tar.gz"
 run_test "Elasticsearch (v6.3.1) sink end-to-end test" "$END_TO_END_DIR/test-scripts/test_streaming_elasticsearch.sh 6 https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.3.1.tar.gz"
 
 run_test "Quickstarts Java nightly end-to-end test" "$END_TO_END_DIR/test-scripts/test_quickstarts.sh java"
