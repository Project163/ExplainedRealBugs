diff --git a/docs/dev/libs/gelly/library_methods.md b/docs/dev/libs/gelly/library_methods.md
index de53aaf05f9..93a2c5dc611 100644
--- a/docs/dev/libs/gelly/library_methods.md
+++ b/docs/dev/libs/gelly/library_methods.md
@@ -330,6 +330,7 @@ The algorithm takes a simple directed graph as input and outputs a `DataSet` of
 hub score, and authority score. Termination is configured by the number of iterations and/or a convergence threshold on
 the iteration sum of the change in scores over all vertices.
 
+* `setIncludeZeroDegreeVertices`: whether to include zero-degree vertices in the iterative computation
 * `setParallelism`: override the operator parallelism
 
 ### PageRank
diff --git a/flink-libraries/flink-gelly-examples/src/main/java/org/apache/flink/graph/drivers/PageRank.java b/flink-libraries/flink-gelly-examples/src/main/java/org/apache/flink/graph/drivers/PageRank.java
index 299aeed4269..b9997e4cd8b 100644
--- a/flink-libraries/flink-gelly-examples/src/main/java/org/apache/flink/graph/drivers/PageRank.java
+++ b/flink-libraries/flink-gelly-examples/src/main/java/org/apache/flink/graph/drivers/PageRank.java
@@ -20,13 +20,14 @@ package org.apache.flink.graph.drivers;
 
 import org.apache.flink.api.java.DataSet;
 import org.apache.flink.graph.Graph;
+import org.apache.flink.graph.drivers.parameter.BooleanParameter;
 import org.apache.flink.graph.drivers.parameter.DoubleParameter;
 import org.apache.flink.graph.drivers.parameter.IterationConvergence;
 
 import org.apache.commons.lang3.text.StrBuilder;
 
 /**
- * @see org.apache.flink.graph.library.linkanalysis.PageRank
+ * Driver for {@link org.apache.flink.graph.library.linkanalysis.PageRank}.
  */
 public class PageRank<K, VV, EV>
 extends DriverBase<K, VV, EV> {
@@ -40,6 +41,8 @@ extends DriverBase<K, VV, EV> {
 
 	private IterationConvergence iterationConvergence = new IterationConvergence(this, DEFAULT_ITERATIONS);
 
+	private BooleanParameter includeZeroDegreeVertices = new BooleanParameter(this, "__include_zero_degree_vertices");
+
 	@Override
 	public String getShortDescription() {
 		return "score vertices by the number and quality of incoming links";
@@ -63,6 +66,7 @@ extends DriverBase<K, VV, EV> {
 					dampingFactor.getValue(),
 					iterationConvergence.getValue().iterations,
 					iterationConvergence.getValue().convergenceThreshold)
+				.setIncludeZeroDegreeVertices(includeZeroDegreeVertices.getValue())
 				.setParallelism(parallelism.getValue().intValue()));
 	}
 }
diff --git a/flink-libraries/flink-gelly-examples/src/main/java/org/apache/flink/graph/drivers/input/GridGraph.java b/flink-libraries/flink-gelly-examples/src/main/java/org/apache/flink/graph/drivers/input/GridGraph.java
index 1421b1d9b39..fdb144f7e7c 100644
--- a/flink-libraries/flink-gelly-examples/src/main/java/org/apache/flink/graph/drivers/input/GridGraph.java
+++ b/flink-libraries/flink-gelly-examples/src/main/java/org/apache/flink/graph/drivers/input/GridGraph.java
@@ -76,7 +76,6 @@ extends GeneratedGraph {
 
 	@Override
 	protected long vertexCount() {
-		// in Java 8 use Math.multiplyExact(long, long)
 		BigInteger vertexCount = BigInteger.ONE;
 		for (Dimension dimension : dimensions) {
 			vertexCount = vertexCount.multiply(BigInteger.valueOf(dimension.size));
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CirculantGraph.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CirculantGraph.java
index 1dc9e6687db..0cb3edd116a 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CirculantGraph.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CirculantGraph.java
@@ -51,7 +51,7 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 	private final ExecutionEnvironment env;
 
 	// Required configuration
-	private long vertexCount;
+	private final long vertexCount;
 
 	private List<OffsetRange> offsetRanges = new ArrayList<>();
 
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CompleteGraph.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CompleteGraph.java
index bf7dedf0819..46d8e671161 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CompleteGraph.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CompleteGraph.java
@@ -36,7 +36,7 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 	private final ExecutionEnvironment env;
 
 	// Required configuration
-	private long vertexCount;
+	private final long vertexCount;
 
 	/**
 	 * An undirected {@link Graph} connecting every distinct pair of vertices.
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CycleGraph.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CycleGraph.java
index 5b61fa82266..5dad4c86d25 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CycleGraph.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/CycleGraph.java
@@ -36,7 +36,7 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 	private final ExecutionEnvironment env;
 
 	// Required configuration
-	private long vertexCount;
+	private final long vertexCount;
 
 	/**
 	 * An undirected {@link Graph} with {@code n} vertices where each vertex
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/EchoGraph.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/EchoGraph.java
index d834df17634..4baeb258d28 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/EchoGraph.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/EchoGraph.java
@@ -46,9 +46,9 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 	private final ExecutionEnvironment env;
 
 	// Required configuration
-	private long vertexCount;
+	private final long vertexCount;
 
-	private long vertexDegree;
+	private final long vertexDegree;
 
 	/**
 	 * An undirected {@link Graph} whose vertices have the same degree.
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/EmptyGraph.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/EmptyGraph.java
index 466e2d358e3..30d0d2fa690 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/EmptyGraph.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/EmptyGraph.java
@@ -18,12 +18,11 @@
 
 package org.apache.flink.graph.generator;
 
+import org.apache.flink.api.common.typeinfo.TypeHint;
 import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.java.DataSet;
 import org.apache.flink.api.java.ExecutionEnvironment;
 import org.apache.flink.api.java.operators.DataSource;
-import org.apache.flink.api.java.typeutils.TupleTypeInfo;
-import org.apache.flink.api.java.typeutils.ValueTypeInfo;
 import org.apache.flink.graph.Edge;
 import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.Vertex;
@@ -39,13 +38,13 @@ import java.util.Collections;
 public class EmptyGraph
 extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 
-	public static final int MINIMUM_VERTEX_COUNT = 1;
+	public static final int MINIMUM_VERTEX_COUNT = 0;
 
 	// Required to create the DataSource
 	private final ExecutionEnvironment env;
 
 	// Required configuration
-	private long vertexCount;
+	private final long vertexCount;
 
 	/**
 	 * The {@link Graph} containing no edges.
@@ -63,15 +62,14 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 
 	@Override
 	public Graph<LongValue, NullValue, NullValue> generate() {
+		Preconditions.checkState(vertexCount >= 0);
+
 		// Vertices
 		DataSet<Vertex<LongValue, NullValue>> vertices = GraphGeneratorUtils.vertexSequence(env, parallelism, vertexCount);
 
 		// Edges
-		TypeInformation<Edge<LongValue, NullValue>> typeInformation = new TupleTypeInfo<>(
-			ValueTypeInfo.LONG_VALUE_TYPE_INFO, ValueTypeInfo.LONG_VALUE_TYPE_INFO, ValueTypeInfo.NULL_VALUE_TYPE_INFO);
-
 		DataSource<Edge<LongValue, NullValue>> edges = env
-			.fromCollection(Collections.<Edge<LongValue, NullValue>>emptyList(), typeInformation)
+			.fromCollection(Collections.<Edge<LongValue, NullValue>>emptyList(), TypeInformation.of(new TypeHint<Edge<LongValue, NullValue>>(){}))
 				.setParallelism(parallelism)
 				.name("Empty edge set");
 
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/GraphGeneratorUtils.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/GraphGeneratorUtils.java
index d5a70f325c2..61a27c4fbb7 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/GraphGeneratorUtils.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/GraphGeneratorUtils.java
@@ -20,6 +20,9 @@ package org.apache.flink.graph.generator;
 
 import org.apache.flink.api.common.functions.FlatMapFunction;
 import org.apache.flink.api.common.functions.MapFunction;
+import org.apache.flink.api.common.operators.base.ReduceOperatorBase.CombineHint;
+import org.apache.flink.api.common.typeinfo.TypeHint;
+import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.java.DataSet;
 import org.apache.flink.api.java.ExecutionEnvironment;
 import org.apache.flink.api.java.functions.FunctionAnnotation.ForwardedFields;
@@ -31,6 +34,9 @@ import org.apache.flink.types.LongValue;
 import org.apache.flink.types.NullValue;
 import org.apache.flink.util.Collector;
 import org.apache.flink.util.LongValueSequenceIterator;
+import org.apache.flink.util.Preconditions;
+
+import java.util.Collections;
 
 /**
  * Utilities for graph generators.
@@ -45,26 +51,34 @@ public class GraphGeneratorUtils {
 	 * @param env the Flink execution environment.
 	 * @param parallelism operator parallelism
 	 * @param vertexCount number of sequential vertex labels
-	 * @return {@link DataSet} of sequentially labeled {@link Vertex Vertices}
+	 * @return {@link DataSet} of sequentially labeled {@link Vertex vertices}
 	 */
 	public static DataSet<Vertex<LongValue, NullValue>> vertexSequence(ExecutionEnvironment env, int parallelism, long vertexCount) {
-		LongValueSequenceIterator iterator = new LongValueSequenceIterator(0, vertexCount - 1);
-
-		DataSource<LongValue> vertexLabels = env
-			.fromParallelCollection(iterator, LongValue.class)
-				.setParallelism(parallelism)
-				.name("Vertex iterators");
-
-		return vertexLabels
-			.map(new CreateVertex())
-				.setParallelism(parallelism)
-				.name("Vertex sequence");
+		Preconditions.checkArgument(vertexCount >= 0, "Vertex count must be non-negative");
+
+		if (vertexCount == 0) {
+			return env
+				.fromCollection(Collections.emptyList(), TypeInformation.of(new TypeHint<Vertex<LongValue, NullValue>>(){}))
+					.setParallelism(parallelism)
+					.name("Empty vertex set");
+		} else {
+			LongValueSequenceIterator iterator = new LongValueSequenceIterator(0, vertexCount - 1);
+
+			DataSource<LongValue> vertexLabels = env
+				.fromParallelCollection(iterator, LongValue.class)
+					.setParallelism(parallelism)
+					.name("Vertex indices");
+
+			return vertexLabels
+				.map(new CreateVertex())
+					.setParallelism(parallelism)
+					.name("Vertex sequence");
+		}
 	}
 
 	@ForwardedFields("*->f0")
 	private static class CreateVertex
 	implements MapFunction<LongValue, Vertex<LongValue, NullValue>> {
-
 		private Vertex<LongValue, NullValue> vertex = new Vertex<>(null, NullValue.getInstance());
 
 		@Override
@@ -79,13 +93,13 @@ public class GraphGeneratorUtils {
 	// --------------------------------------------------------------------------------------------
 
 	/**
-	 * Generates {@link Vertex Vertices} present in the given set of {@link Edge}s.
+	 * Generates {@link Vertex vertices} present in the given set of {@link Edge}s.
 	 *
 	 * @param edges source {@link DataSet} of {@link Edge}s
 	 * @param parallelism operator parallelism
 	 * @param <K> label type
 	 * @param <EV> edge value type
-	 * @return {@link DataSet} of discovered {@link Vertex Vertices}
+	 * @return {@link DataSet} of discovered {@link Vertex vertices}
 	 *
 	 * @see Graph#fromDataSet(DataSet, DataSet, ExecutionEnvironment)
 	 */
@@ -97,6 +111,7 @@ public class GraphGeneratorUtils {
 
 		return vertexSet
 			.distinct()
+			.setCombineHint(CombineHint.HASH)
 				.setParallelism(parallelism)
 				.name("Emit vertex labels");
 	}
@@ -106,7 +121,6 @@ public class GraphGeneratorUtils {
 	 */
 	private static final class EmitSrcAndTarget<K, EV>
 	implements FlatMapFunction<Edge<K, EV>, Vertex<K, NullValue>> {
-
 		private Vertex<K, NullValue> output = new Vertex<>(null, new NullValue());
 
 		@Override
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/GridGraph.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/GridGraph.java
index cae2bc4d4a4..1d91b5368f7 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/GridGraph.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/GridGraph.java
@@ -71,7 +71,7 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 	public GridGraph addDimension(long size, boolean wrapEndpoints) {
 		Preconditions.checkArgument(size >= 2, "Dimension size must be at least 2");
 
-		vertexCount *= size;
+		vertexCount = Math.multiplyExact(vertexCount, size);
 
 		// prevent duplicate edges
 		if (size == 2) {
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/HypercubeGraph.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/HypercubeGraph.java
index daaaf53f4ef..0dc95e75ab0 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/HypercubeGraph.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/HypercubeGraph.java
@@ -36,7 +36,7 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 	private final ExecutionEnvironment env;
 
 	// Required configuration
-	private long dimensions;
+	private final long dimensions;
 
 	/**
 	 * An undirected {@code Graph} where edges form an n-dimensional hypercube.
@@ -56,6 +56,8 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 
 	@Override
 	public Graph<LongValue, NullValue, NullValue> generate() {
+		Preconditions.checkState(dimensions > 0);
+
 		GridGraph graph = new GridGraph(env);
 
 		for (int i = 0; i < dimensions; i++) {
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/PathGraph.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/PathGraph.java
index e61fcd80b40..bae8633f2d2 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/PathGraph.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/PathGraph.java
@@ -36,7 +36,7 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 	private final ExecutionEnvironment env;
 
 	// Required configuration
-	private long vertexCount;
+	private final long vertexCount;
 
 	/**
 	 * An undirected {@link Graph} with {@code n} vertices where each vertex
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/SingletonEdgeGraph.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/SingletonEdgeGraph.java
index 159e55dd935..333c051be6c 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/SingletonEdgeGraph.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/SingletonEdgeGraph.java
@@ -42,7 +42,7 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 	private final ExecutionEnvironment env;
 
 	// Required configuration
-	private long vertexPairCount;
+	private final long vertexPairCount;
 
 	/**
 	 * An undirected {@link Graph} containing one or more isolated two-paths.
@@ -62,8 +62,10 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 
 	@Override
 	public Graph<LongValue, NullValue, NullValue> generate() {
+		Preconditions.checkState(vertexPairCount > 0);
+
 		// Vertices
-		long vertexCount = 2 * this.vertexPairCount;
+		long vertexCount = 2 * vertexPairCount;
 
 		DataSet<Vertex<LongValue, NullValue>> vertices = GraphGeneratorUtils.vertexSequence(env, parallelism, vertexCount);
 
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/StarGraph.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/StarGraph.java
index 7133320fb68..5cbb2560a41 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/StarGraph.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/generator/StarGraph.java
@@ -43,11 +43,11 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 	private final ExecutionEnvironment env;
 
 	// Required configuration
-	private long vertexCount;
+	private final long vertexCount;
 
 	/**
-	 * An undirected {@Graph} with {@code n} vertices where the single central
-	 * node has degree {@code n-1}, connecting to the other {@code n-1}
+	 * An undirected {@link Graph} with {@code n} vertices where the single
+	 * central node has degree {@code n-1}, connecting to the other {@code n-1}
 	 * vertices which have degree {@code 1}.
 	 *
 	 * @param env the Flink execution environment
@@ -63,6 +63,8 @@ extends GraphGeneratorBase<LongValue, NullValue, NullValue> {
 
 	@Override
 	public Graph<LongValue, NullValue, NullValue> generate() {
+		Preconditions.checkState(vertexCount >= 2);
+
 		// Vertices
 		DataSet<Vertex<LongValue, NullValue>> vertices = GraphGeneratorUtils.vertexSequence(env, parallelism, vertexCount);
 
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/AverageClusteringCoefficient.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/AverageClusteringCoefficient.java
index 2ff5dc231b2..1d3b7c6d797 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/AverageClusteringCoefficient.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/AverageClusteringCoefficient.java
@@ -149,6 +149,11 @@ extends GraphAnalyticBase<K, VV, EV, Result> {
 			return averageLocalClusteringCoefficient;
 		}
 
+		@Override
+		public String toString() {
+			return toPrintableString();
+		}
+
 		@Override
 		public String toPrintableString() {
 			return "vertex count: " + vertexCount
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/GlobalClusteringCoefficient.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/GlobalClusteringCoefficient.java
index a6b0baa98d8..ae15d40bfcb 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/GlobalClusteringCoefficient.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/GlobalClusteringCoefficient.java
@@ -136,6 +136,11 @@ extends GraphAnalyticBase<K, VV, EV, Result> {
 			return (tripletCount == 0) ? Double.NaN : triangleCount / (double) tripletCount;
 		}
 
+		@Override
+		public String toString() {
+			return toPrintableString();
+		}
+
 		@Override
 		public String toPrintableString() {
 			return "triplet count: " + tripletCount
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/TriadicCensus.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/TriadicCensus.java
index 93eadc57cc8..f99df1cf202 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/TriadicCensus.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/directed/TriadicCensus.java
@@ -503,6 +503,11 @@ extends GraphAnalyticBase<K, VV, EV, Result> {
 			return counts;
 		}
 
+		@Override
+		public String toString() {
+			return toPrintableString();
+		}
+
 		@Override
 		public String toPrintableString() {
 			NumberFormat nf = NumberFormat.getInstance();
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/AverageClusteringCoefficient.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/AverageClusteringCoefficient.java
index c0ddb058c8e..2885d6edc3f 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/AverageClusteringCoefficient.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/AverageClusteringCoefficient.java
@@ -149,6 +149,11 @@ extends GraphAnalyticBase<K, VV, EV, Result> {
 			return averageLocalClusteringCoefficient;
 		}
 
+		@Override
+		public String toString() {
+			return toPrintableString();
+		}
+
 		@Override
 		public String toPrintableString() {
 			return "vertex count: " + vertexCount
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/GlobalClusteringCoefficient.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/GlobalClusteringCoefficient.java
index ef212ae1981..1a7314e28f8 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/GlobalClusteringCoefficient.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/GlobalClusteringCoefficient.java
@@ -135,6 +135,11 @@ extends GraphAnalyticBase<K, VV, EV, Result> {
 			return (tripletCount == 0) ? Double.NaN : triangleCount / (double) tripletCount;
 		}
 
+		@Override
+		public String toString() {
+			return toPrintableString();
+		}
+
 		@Override
 		public String toPrintableString() {
 			return "triplet count: " + tripletCount
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/TriadicCensus.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/TriadicCensus.java
index f4400988818..24dcade1876 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/TriadicCensus.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/clustering/undirected/TriadicCensus.java
@@ -197,6 +197,11 @@ extends GraphAnalyticBase<K, VV, EV, Result> {
 			return counts;
 		}
 
+		@Override
+		public String toString() {
+			return toPrintableString();
+		}
+
 		@Override
 		public String toPrintableString() {
 			NumberFormat nf = NumberFormat.getInstance();
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/linkanalysis/HITS.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/linkanalysis/HITS.java
index e59240b0529..9ec1eea548a 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/linkanalysis/HITS.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/linkanalysis/HITS.java
@@ -48,6 +48,7 @@ import org.apache.flink.util.Collector;
 import org.apache.flink.util.Preconditions;
 
 import java.util.Collection;
+import java.util.Iterator;
 
 /**
  * Hyperlink-Induced Topic Search computes two interdependent scores for every
@@ -387,12 +388,13 @@ extends GraphAlgorithmWrappingDataSet<K, VV, EV, Result<K>> {
 		public void open(Configuration parameters) throws Exception {
 			super.open(parameters);
 
-			Collection<DoubleValue> var;
-			var = getRuntimeContext().getBroadcastVariable(HUBBINESS_SUM_SQUARED);
-			hubbinessRootSumSquared = Math.sqrt(var.iterator().next().getValue());
+			Collection<DoubleValue> hubbinessSumSquared = getRuntimeContext().getBroadcastVariable(HUBBINESS_SUM_SQUARED);
+			Iterator<DoubleValue> hubbinessSumSquaredIterator = hubbinessSumSquared.iterator();
+			this.hubbinessRootSumSquared = hubbinessSumSquaredIterator.hasNext() ? Math.sqrt(hubbinessSumSquaredIterator.next().getValue()) : Double.NaN;
 
-			var = getRuntimeContext().getBroadcastVariable(AUTHORITY_SUM_SQUARED);
-			authorityRootSumSquared = Math.sqrt(var.iterator().next().getValue());
+			Collection<DoubleValue> authoritySumSquared = getRuntimeContext().getBroadcastVariable(AUTHORITY_SUM_SQUARED);
+			Iterator<DoubleValue> authoritySumSquaredIterator = authoritySumSquared.iterator();
+			authorityRootSumSquared = authoritySumSquaredIterator.hasNext() ? Math.sqrt(authoritySumSquaredIterator.next().getValue()) : Double.NaN;
 		}
 
 		@Override
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/linkanalysis/PageRank.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/linkanalysis/PageRank.java
index 71c37aa5552..d259fac6341 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/linkanalysis/PageRank.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/linkanalysis/PageRank.java
@@ -84,6 +84,9 @@ extends GraphAlgorithmWrappingDataSet<K, VV, EV, Result<K>> {
 
 	private double convergenceThreshold;
 
+	// Optional configuration
+	private boolean includeZeroDegreeVertices = false;
+
 	/**
 	 * PageRank with a fixed number of iterations.
 	 *
@@ -126,6 +129,42 @@ extends GraphAlgorithmWrappingDataSet<K, VV, EV, Result<K>> {
 		this.convergenceThreshold = convergenceThreshold;
 	}
 
+	/**
+	 * This PageRank implementation properly handles both source and sink
+	 * vertices which have, respectively, only outgoing and incoming edges.
+	 *
+	 * <p>Setting this flag includes "zero-degree" vertices in the PageRank
+	 * computation and result. These vertices are handled the same as other
+	 * "source" vertices (with a consistent score of
+	 * <code>(1 - damping factor) / number of vertices</code>) but only
+	 * affect the scores of other vertices indirectly through the taking of
+	 * this proportional portion of the "random jump" score.
+	 *
+	 * <p>The cost to include zero-degree vertices is a reduce for uniqueness
+	 * on the vertex set followed by an outer join on the vertex degree
+	 * DataSet.
+	 *
+	 * @param includeZeroDegreeVertices whether to include zero-degree vertices in the iterative computation
+	 * @return this
+	 */
+	public PageRank<K, VV, EV> setIncludeZeroDegreeVertices(boolean includeZeroDegreeVertices) {
+		this.includeZeroDegreeVertices = includeZeroDegreeVertices;
+
+		return this;
+	}
+
+	@Override
+	protected boolean canMergeConfigurationWith(GraphAlgorithmWrappingBase other) {
+		if (!super.canMergeConfigurationWith(other)) {
+			return false;
+		}
+
+		PageRank rhs = (PageRank) other;
+
+		return dampingFactor == rhs.dampingFactor &&
+			includeZeroDegreeVertices == rhs.includeZeroDegreeVertices;
+	}
+
 	@Override
 	protected void mergeConfiguration(GraphAlgorithmWrappingBase other) {
 		super.mergeConfiguration(other);
@@ -142,6 +181,7 @@ extends GraphAlgorithmWrappingDataSet<K, VV, EV, Result<K>> {
 		// vertex degree
 		DataSet<Vertex<K, Degrees>> vertexDegree = input
 			.run(new VertexDegrees<K, VV, EV>()
+				.setIncludeZeroDegreeVertices(includeZeroDegreeVertices)
 				.setParallelism(parallelism));
 
 		// vertex count
@@ -158,7 +198,6 @@ extends GraphAlgorithmWrappingDataSet<K, VV, EV, Result<K>> {
 		// vertices with zero in-edges
 		DataSet<Tuple2<K, DoubleValue>> sourceVertices = vertexDegree
 			.flatMap(new InitializeSourceVertices<>())
-			.withBroadcastSet(vertexCount, VERTEX_COUNT)
 				.setParallelism(parallelism)
 				.name("Initialize source vertex scores");
 
@@ -285,7 +324,8 @@ extends GraphAlgorithmWrappingDataSet<K, VV, EV, Result<K>> {
 			super.open(parameters);
 
 			Collection<LongValue> vertexCount = getRuntimeContext().getBroadcastVariable(VERTEX_COUNT);
-			output.f1 = new DoubleValue(1.0 / vertexCount.iterator().next().getValue());
+			Iterator<LongValue> vertexCountIterator = vertexCount.iterator();
+			output.f1 = new DoubleValue(vertexCountIterator.hasNext() ? 1.0 / vertexCountIterator.next().getValue() : Double.NaN);
 		}
 
 		@Override
@@ -376,11 +416,13 @@ extends GraphAlgorithmWrappingDataSet<K, VV, EV, Result<K>> {
 			super.open(parameters);
 
 			Collection<Tuple2<T, DoubleValue>> sumOfScores = getRuntimeContext().getBroadcastVariable(SUM_OF_SCORES);
+			Iterator<Tuple2<T, DoubleValue>> sumOfScoresIterator = sumOfScores.iterator();
 			// floating point precision error is also included in sumOfSinks
-			double sumOfSinks = 1 - sumOfScores.iterator().next().f1.getValue();
+			double sumOfSinks = 1 - (sumOfScoresIterator.hasNext() ? sumOfScoresIterator.next().f1.getValue() : 0);
 
 			Collection<LongValue> vertexCount = getRuntimeContext().getBroadcastVariable(VERTEX_COUNT);
-			this.vertexCount = vertexCount.iterator().next().getValue();
+			Iterator<LongValue> vertexCountIterator = vertexCount.iterator();
+			this.vertexCount = vertexCountIterator.hasNext() ? vertexCountIterator.next().getValue() : 0;
 
 			this.uniformlyDistributedScore = ((1 - dampingFactor) + dampingFactor * sumOfSinks) / this.vertexCount;
 		}
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/directed/EdgeMetrics.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/directed/EdgeMetrics.java
index 7294fd152e3..796667f042f 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/directed/EdgeMetrics.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/directed/EdgeMetrics.java
@@ -309,6 +309,11 @@ extends GraphAnalyticBase<K, VV, EV, Result> {
 			return maximumRectangleTriplets;
 		}
 
+		@Override
+		public String toString() {
+			return toPrintableString();
+		}
+
 		@Override
 		public String toPrintableString() {
 			NumberFormat nf = NumberFormat.getInstance();
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/directed/VertexMetrics.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/directed/VertexMetrics.java
index 97ee6fa79c0..87c50ce731f 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/directed/VertexMetrics.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/directed/VertexMetrics.java
@@ -306,6 +306,11 @@ extends GraphAnalyticBase<K, VV, EV, Result> {
 			return maximumTriplets;
 		}
 
+		@Override
+		public String toString() {
+			return toPrintableString();
+		}
+
 		@Override
 		public String toPrintableString() {
 			NumberFormat nf = NumberFormat.getInstance();
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/undirected/EdgeMetrics.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/undirected/EdgeMetrics.java
index 8c520e67b6b..3392d47f3c9 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/undirected/EdgeMetrics.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/undirected/EdgeMetrics.java
@@ -282,6 +282,11 @@ extends GraphAnalyticBase<K, VV, EV, Result> {
 			return maximumRectangleTriplets;
 		}
 
+		@Override
+		public String toString() {
+			return toPrintableString();
+		}
+
 		@Override
 		public String toPrintableString() {
 			NumberFormat nf = NumberFormat.getInstance();
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/undirected/VertexMetrics.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/undirected/VertexMetrics.java
index 1116149c981..39fec4a3bdd 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/undirected/VertexMetrics.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/metric/undirected/VertexMetrics.java
@@ -256,6 +256,11 @@ extends GraphAnalyticBase<K, VV, EV, Result> {
 			return maximumTriplets;
 		}
 
+		@Override
+		public String toString() {
+			return toPrintableString();
+		}
+
 		@Override
 		public String toPrintableString() {
 			NumberFormat nf = NumberFormat.getInstance();
diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/similarity/AdamicAdar.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/similarity/AdamicAdar.java
index 752e2064838..701e6983e7d 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/similarity/AdamicAdar.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/similarity/AdamicAdar.java
@@ -410,7 +410,7 @@ extends GraphAlgorithmWrappingDataSet<K, VV, EV, Result<K>> {
 		@Override
 		public void reduce(Iterable<Tuple3<T, T, FloatValue>> values, Collector<Result<T>> out)
 				throws Exception {
-			float sum = 0;
+			double sum = 0;
 			Tuple3<T, T, FloatValue> edge = null;
 
 			for (Tuple3<T, T, FloatValue> next : values) {
@@ -421,7 +421,7 @@ extends GraphAlgorithmWrappingDataSet<K, VV, EV, Result<K>> {
 			if (sum >= minimumScore) {
 				output.setVertexId0(edge.f0);
 				output.setVertexId1(edge.f1);
-				output.setAdamicAdarScore(sum);
+				output.setAdamicAdarScore((float) sum);
 				out.collect(output);
 			}
 		}
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/AsmTestBase.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/AsmTestBase.java
index 1afb5dadda8..1b6acbcdb32 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/AsmTestBase.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/AsmTestBase.java
@@ -24,6 +24,7 @@ import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.generator.CompleteGraph;
 import org.apache.flink.graph.generator.EmptyGraph;
 import org.apache.flink.graph.generator.RMatGraph;
+import org.apache.flink.graph.generator.StarGraph;
 import org.apache.flink.graph.generator.random.JDKRandomGeneratorFactory;
 import org.apache.flink.types.IntValue;
 import org.apache.flink.types.LongValue;
@@ -56,11 +57,17 @@ public class AsmTestBase {
 	// empty graph
 	protected final long emptyGraphVertexCount = 3;
 
-	protected Graph<LongValue, NullValue, NullValue> emptyGraph;
+	protected Graph<LongValue, NullValue, NullValue> emptyGraphWithVertices;
+
+	protected Graph<LongValue, NullValue, NullValue> emptyGraphWithoutVertices;
+
+	// star graph
+	protected final long starGraphVertexCount = 29;
+
+	protected Graph<LongValue, NullValue, NullValue> starGraph;
 
 	@Before
-	public void setup()
-			throws Exception {
+	public void setup() throws Exception {
 		env = ExecutionEnvironment.createCollectionsEnvironment();
 		env.getConfig().enableObjectReuse();
 
@@ -89,8 +96,16 @@ public class AsmTestBase {
 		completeGraph = new CompleteGraph(env, completeGraphVertexCount)
 			.generate();
 
-		// empty graph
-		emptyGraph = new EmptyGraph(env, emptyGraphVertexCount)
+		// empty graph with vertices but no edges
+		emptyGraphWithVertices = new EmptyGraph(env, emptyGraphVertexCount)
+			.generate();
+
+		// empty graph with no vertices or edges
+		emptyGraphWithoutVertices = new EmptyGraph(env, 0)
+			.generate();
+
+		// star graph
+		starGraph = new StarGraph(env, starGraphVertexCount)
 			.generate();
 	}
 
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/ChecksumHashCodeTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/ChecksumHashCodeTest.java
index 7d82b80e907..a31ce2eccf8 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/ChecksumHashCodeTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/ChecksumHashCodeTest.java
@@ -18,6 +18,8 @@
 
 package org.apache.flink.graph.asm.dataset;
 
+import org.apache.flink.api.common.typeinfo.TypeHint;
+import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.java.DataSet;
 import org.apache.flink.api.java.ExecutionEnvironment;
 import org.apache.flink.graph.asm.dataset.ChecksumHashCode.Checksum;
@@ -27,6 +29,7 @@ import org.junit.Before;
 import org.junit.Test;
 
 import java.util.Arrays;
+import java.util.Collections;
 import java.util.List;
 
 import static org.junit.Assert.assertEquals;
@@ -39,15 +42,13 @@ public class ChecksumHashCodeTest {
 	private ExecutionEnvironment env;
 
 	@Before
-	public void setup()
-			throws Exception {
+	public void setup() throws Exception {
 		env = ExecutionEnvironment.createCollectionsEnvironment();
 		env.getConfig().enableObjectReuse();
 	}
 
 	@Test
-	public void testChecksumHashCode()
-			throws Exception {
+	public void testList() throws Exception {
 		List<Long> list = Arrays.asList(ArrayUtils.toObject(
 			new long[]{ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }));
 
@@ -58,4 +59,14 @@ public class ChecksumHashCodeTest {
 		assertEquals(list.size(), checksum.getCount());
 		assertEquals(list.size() * (list.size() - 1) / 2, checksum.getChecksum());
 	}
+
+	@Test
+	public void testEmptyList() throws Exception {
+		DataSet<Long> dataset = env.fromCollection(Collections.emptyList(), TypeInformation.of(new TypeHint<Long>(){}));
+
+		Checksum checksum = new ChecksumHashCode<Long>().run(dataset).execute();
+
+		assertEquals(0, checksum.getCount());
+		assertEquals(0, checksum.getChecksum());
+	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/CollectTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/CollectTest.java
index 29b454bfbac..cfeadceb91b 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/CollectTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/CollectTest.java
@@ -18,6 +18,8 @@
 
 package org.apache.flink.graph.asm.dataset;
 
+import org.apache.flink.api.common.typeinfo.TypeHint;
+import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.java.DataSet;
 import org.apache.flink.api.java.ExecutionEnvironment;
 
@@ -26,9 +28,11 @@ import org.junit.Before;
 import org.junit.Test;
 
 import java.util.Arrays;
+import java.util.Collections;
 import java.util.List;
 
 import static org.junit.Assert.assertArrayEquals;
+import static org.junit.Assert.assertEquals;
 
 /**
  * Tests for {@link Collect}.
@@ -38,15 +42,13 @@ public class CollectTest {
 	private ExecutionEnvironment env;
 
 	@Before
-	public void setup()
-			throws Exception {
+	public void setup() throws Exception {
 		env = ExecutionEnvironment.createCollectionsEnvironment();
 		env.getConfig().enableObjectReuse();
 	}
 
 	@Test
-	public void testCollect()
-			throws Exception {
+	public void testList() throws Exception {
 		List<Long> list = Arrays.asList(ArrayUtils.toObject(
 			new long[]{ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }));
 
@@ -56,4 +58,13 @@ public class CollectTest {
 
 		assertArrayEquals(list.toArray(), collected.toArray());
 	}
+
+	@Test
+	public void testEmptyList() throws Exception {
+		DataSet<Long> dataset = env.fromCollection(Collections.emptyList(), TypeInformation.of(new TypeHint<Long>(){}));
+
+		List<Long> collected = new Collect<Long>().run(dataset).execute();
+
+		assertEquals(0, collected.size());
+	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/CountTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/CountTest.java
index a1160ce29cc..0167a5f4a58 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/CountTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/dataset/CountTest.java
@@ -18,6 +18,8 @@
 
 package org.apache.flink.graph.asm.dataset;
 
+import org.apache.flink.api.common.typeinfo.TypeHint;
+import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.java.DataSet;
 import org.apache.flink.api.java.ExecutionEnvironment;
 
@@ -26,6 +28,7 @@ import org.junit.Before;
 import org.junit.Test;
 
 import java.util.Arrays;
+import java.util.Collections;
 import java.util.List;
 
 import static org.junit.Assert.assertEquals;
@@ -38,15 +41,13 @@ public class CountTest {
 	private ExecutionEnvironment env;
 
 	@Before
-	public void setup()
-			throws Exception {
+	public void setup() throws Exception {
 		env = ExecutionEnvironment.createCollectionsEnvironment();
 		env.getConfig().enableObjectReuse();
 	}
 
 	@Test
-	public void testCount()
-			throws Exception {
+	public void testList() throws Exception {
 		List<Long> list = Arrays.asList(ArrayUtils.toObject(
 			new long[]{ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }));
 
@@ -56,4 +57,13 @@ public class CountTest {
 
 		assertEquals(list.size(), count);
 	}
+
+	@Test
+	public void testEmptyList() throws Exception {
+		DataSet<Long> dataset = env.fromCollection(Collections.emptyList(), TypeInformation.of(new TypeHint<Long>(){}));
+
+		long count = new Count<Long>().run(dataset).execute();
+
+		assertEquals(0, count);
+	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeDegreesPairTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeDegreesPairTest.java
index 63bf133aef1..08ba4aa63ba 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeDegreesPairTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeDegreesPairTest.java
@@ -37,12 +37,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link EdgeDegreesPair}.
  */
-public class EdgeDegreesPairTest
-extends AsmTestBase {
+public class EdgeDegreesPairTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		String expectedResult =
 			"(0,1,((null),(2,2,0),(3,0,3)))\n" +
 			"(0,2,((null),(2,2,0),(3,2,1)))\n" +
@@ -59,8 +57,23 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple3<NullValue, Degrees, Degrees>>> degreesPair = emptyGraphWithVertices
+			.run(new EdgeDegreesPair<>());
+
+		assertEquals(0, degreesPair.collect().size());
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple3<NullValue, Degrees, Degrees>>> degreesPair = emptyGraphWithoutVertices
+			.run(new EdgeDegreesPair<>());
+
+		assertEquals(0, degreesPair.collect().size());
+	}
+
+	@Test
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Edge<LongValue, Tuple3<NullValue, Degrees, Degrees>>> degreesPair = directedRMatGraph(10, 16)
 			.run(new EdgeDegreesPair<>());
 
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeSourceDegreesTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeSourceDegreesTest.java
index 967cfb2bbb7..884e2d5a776 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeSourceDegreesTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeSourceDegreesTest.java
@@ -37,12 +37,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link EdgeSourceDegrees}.
  */
-public class EdgeSourceDegreesTest
-extends AsmTestBase {
+public class EdgeSourceDegreesTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		String expectedResult =
 			"(0,1,((null),(2,2,0)))\n" +
 			"(0,2,((null),(2,2,0)))\n" +
@@ -59,8 +57,23 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple2<NullValue, Degrees>>> sourceDegrees = emptyGraphWithVertices
+			.run(new EdgeSourceDegrees<>());
+
+		assertEquals(0, sourceDegrees.collect().size());
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple2<NullValue, Degrees>>> sourceDegrees = emptyGraphWithoutVertices
+			.run(new EdgeSourceDegrees<>());
+
+		assertEquals(0, sourceDegrees.collect().size());
+	}
+
+	@Test
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Edge<LongValue, Tuple2<NullValue, Degrees>>> sourceDegrees = directedRMatGraph(10, 16)
 			.run(new EdgeSourceDegrees<>());
 
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeTargetDegreesTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeTargetDegreesTest.java
index abb76c4f1b5..5afd64c303d 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeTargetDegreesTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/EdgeTargetDegreesTest.java
@@ -37,12 +37,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link EdgeTargetDegrees}.
  */
-public class EdgeTargetDegreesTest
-extends AsmTestBase {
+public class EdgeTargetDegreesTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		String expectedResult =
 			"(0,1,((null),(3,0,3)))\n" +
 			"(0,2,((null),(3,2,1)))\n" +
@@ -59,8 +57,23 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple2<NullValue, Degrees>>> targetDegrees = emptyGraphWithVertices
+			.run(new EdgeTargetDegrees<>());
+
+		assertEquals(0, targetDegrees.collect().size());
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple2<NullValue, Degrees>>> targetDegrees = emptyGraphWithoutVertices
+			.run(new EdgeTargetDegrees<>());
+
+		assertEquals(0, targetDegrees.collect().size());
+	}
+
+	@Test
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Edge<LongValue, Tuple2<NullValue, Degrees>>> targetDegrees = directedRMatGraph(10, 16)
 			.run(new EdgeTargetDegrees<>());
 
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexDegreesTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexDegreesTest.java
index 91f354f2eef..7b89fe7c29d 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexDegreesTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexDegreesTest.java
@@ -36,12 +36,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link VertexDegrees}.
  */
-public class VertexDegreesTest
-extends AsmTestBase {
+public class VertexDegreesTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleDirectedGraph()
-			throws Exception {
+	public void testWithDirectedSimpleGraph() throws Exception {
 		DataSet<Vertex<IntValue, Degrees>> degrees = directedSimpleGraph
 			.run(new VertexDegrees<>());
 
@@ -57,8 +55,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithSimpleUndirectedGraph()
-			throws Exception {
+	public void testWithUndirectedSimpleGraph() throws Exception {
 		DataSet<Vertex<IntValue, Degrees>> degrees = undirectedSimpleGraph
 			.run(new VertexDegrees<>());
 
@@ -74,17 +71,14 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		DataSet<Vertex<LongValue, Degrees>> degrees;
-
-		degrees = emptyGraph
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Vertex<LongValue, Degrees>> degreesWithoutZeroDegreeVertices = emptyGraphWithVertices
 			.run(new VertexDegrees<LongValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(false));
 
-		assertEquals(0, degrees.collect().size());
+		assertEquals(0, degreesWithoutZeroDegreeVertices.collect().size());
 
-		degrees = emptyGraph
+		DataSet<Vertex<LongValue, Degrees>> degreesWithZeroDegreeVertices = emptyGraphWithVertices
 			.run(new VertexDegrees<LongValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(true));
 
@@ -93,12 +87,26 @@ extends AsmTestBase {
 			"(1,(0,0,0))\n" +
 			"(2,(0,0,0))";
 
-		TestBaseUtils.compareResultAsText(degrees.collect(), expectedResult);
+		TestBaseUtils.compareResultAsText(degreesWithZeroDegreeVertices.collect(), expectedResult);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Vertex<LongValue, Degrees>> degreesWithoutZeroDegreeVertices = emptyGraphWithoutVertices
+			.run(new VertexDegrees<LongValue, NullValue, NullValue>()
+				.setIncludeZeroDegreeVertices(false));
+
+		assertEquals(0, degreesWithoutZeroDegreeVertices.collect().size());
+
+		DataSet<Vertex<LongValue, Degrees>> degreesWithZeroDegreeVertices = emptyGraphWithoutVertices
+			.run(new VertexDegrees<LongValue, NullValue, NullValue>()
+				.setIncludeZeroDegreeVertices(true));
+
+		assertEquals(0, degreesWithZeroDegreeVertices.collect().size());
 	}
 
 	@Test
-	public void testWithRMatGraph()
-	throws Exception {
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Vertex<LongValue, Degrees>> degrees = directedRMatGraph(10, 16)
 			.run(new VertexDegrees<>());
 
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexInDegreeTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexInDegreeTest.java
index f671cab28a5..7f6c9e3206e 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexInDegreeTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexInDegreeTest.java
@@ -35,12 +35,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link VertexInDegree}.
  */
-public class VertexInDegreeTest
-extends AsmTestBase {
+public class VertexInDegreeTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithDirectedSimpleGraph() throws Exception {
 		DataSet<Vertex<IntValue, LongValue>> inDegree = directedSimpleGraph
 			.run(new VertexInDegree<IntValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(true));
@@ -57,17 +55,31 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		DataSet<Vertex<LongValue, LongValue>> inDegree;
+	public void testWithUndirectedSimpleGraph() throws Exception {
+		DataSet<Vertex<IntValue, LongValue>> inDegree = undirectedSimpleGraph
+			.run(new VertexInDegree<IntValue, NullValue, NullValue>()
+				.setIncludeZeroDegreeVertices(true));
+
+		String expectedResult =
+			"(0,2)\n" +
+			"(1,3)\n" +
+			"(2,3)\n" +
+			"(3,4)\n" +
+			"(4,1)\n" +
+			"(5,1)";
 
-		inDegree = emptyGraph
+		TestBaseUtils.compareResultAsText(inDegree.collect(), expectedResult);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Vertex<LongValue, LongValue>> inDegreeWithoutZeroDegreeVertices = emptyGraphWithVertices
 			.run(new VertexInDegree<LongValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(false));
 
-		assertEquals(0, inDegree.collect().size());
+		assertEquals(0, inDegreeWithoutZeroDegreeVertices.collect().size());
 
-		inDegree = emptyGraph
+		DataSet<Vertex<LongValue, LongValue>> inDegreeWithZeroDegreeVertices = emptyGraphWithVertices
 			.run(new VertexInDegree<LongValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(true));
 
@@ -76,12 +88,26 @@ extends AsmTestBase {
 			"(1,0)\n" +
 			"(2,0)";
 
-		TestBaseUtils.compareResultAsText(inDegree.collect(), expectedResult);
+		TestBaseUtils.compareResultAsText(inDegreeWithZeroDegreeVertices.collect(), expectedResult);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Vertex<LongValue, LongValue>> inDegreeWithoutZeroDegreeVertices = emptyGraphWithoutVertices
+			.run(new VertexInDegree<LongValue, NullValue, NullValue>()
+				.setIncludeZeroDegreeVertices(false));
+
+		assertEquals(0, inDegreeWithoutZeroDegreeVertices.collect().size());
+
+		DataSet<Vertex<LongValue, LongValue>> inDegreeWithZeroDegreeVertices = emptyGraphWithoutVertices
+			.run(new VertexInDegree<LongValue, NullValue, NullValue>()
+				.setIncludeZeroDegreeVertices(true));
+
+		assertEquals(0, inDegreeWithZeroDegreeVertices.collect().size());
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Vertex<LongValue, LongValue>> inDegree = directedRMatGraph(10, 16)
 			.run(new VertexInDegree<LongValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(true));
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexOutDegreeTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexOutDegreeTest.java
index 1517f234eae..7031d8f62ff 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexOutDegreeTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/directed/VertexOutDegreeTest.java
@@ -35,12 +35,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link VertexOutDegree}.
  */
-public class VertexOutDegreeTest
-extends AsmTestBase {
+public class VertexOutDegreeTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithDirectedSimpleGraph() throws Exception {
 		DataSet<Vertex<IntValue, LongValue>> outDegree = directedSimpleGraph
 			.run(new VertexOutDegree<IntValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(true));
@@ -57,17 +55,31 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		DataSet<Vertex<LongValue, LongValue>> outDegree;
+	public void testWithUndirectedSimpleGraph() throws Exception {
+		DataSet<Vertex<IntValue, LongValue>> outDegree = undirectedSimpleGraph
+			.run(new VertexOutDegree<IntValue, NullValue, NullValue>()
+				.setIncludeZeroDegreeVertices(true));
+
+		String expectedResult =
+			"(0,2)\n" +
+			"(1,3)\n" +
+			"(2,3)\n" +
+			"(3,4)\n" +
+			"(4,1)\n" +
+			"(5,1)";
 
-		outDegree = emptyGraph
+		TestBaseUtils.compareResultAsText(outDegree.collect(), expectedResult);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Vertex<LongValue, LongValue>> outDegreeWithoutZeroDegreeVertices = emptyGraphWithVertices
 			.run(new VertexOutDegree<LongValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(false));
 
-		assertEquals(0, outDegree.collect().size());
+		assertEquals(0, outDegreeWithoutZeroDegreeVertices.collect().size());
 
-		outDegree = emptyGraph
+		DataSet<Vertex<LongValue, LongValue>> outDegreeWithZeroDegreeVertices = emptyGraphWithVertices
 			.run(new VertexOutDegree<LongValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(true));
 
@@ -76,12 +88,26 @@ extends AsmTestBase {
 			"(1,0)\n" +
 			"(2,0)";
 
-		TestBaseUtils.compareResultAsText(outDegree.collect(), expectedResult);
+		TestBaseUtils.compareResultAsText(outDegreeWithZeroDegreeVertices.collect(), expectedResult);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Vertex<LongValue, LongValue>> outDegreeWithoutZeroDegreeVertices = emptyGraphWithoutVertices
+			.run(new VertexOutDegree<LongValue, NullValue, NullValue>()
+				.setIncludeZeroDegreeVertices(false));
+
+		assertEquals(0, outDegreeWithoutZeroDegreeVertices.collect().size());
+
+		DataSet<Vertex<LongValue, LongValue>> outDegreeWithZeroDegreeVertices = emptyGraphWithoutVertices
+			.run(new VertexOutDegree<LongValue, NullValue, NullValue>()
+				.setIncludeZeroDegreeVertices(true));
+
+		assertEquals(0, outDegreeWithZeroDegreeVertices.collect().size());
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Vertex<LongValue, LongValue>> outDegree = directedRMatGraph(10, 16)
 			.run(new VertexOutDegree<LongValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(true));
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeDegreePairTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeDegreePairTest.java
index 1cae2e77f17..95a89c5dbcc 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeDegreePairTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeDegreePairTest.java
@@ -36,12 +36,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link EdgeDegreePair}.
  */
-public class EdgeDegreePairTest
-extends AsmTestBase {
+public class EdgeDegreePairTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		String expectedResult =
 			"(0,1,((null),2,3))\n" +
 			"(0,2,((null),2,3))\n" +
@@ -59,7 +57,8 @@ extends AsmTestBase {
 			"(5,3,((null),1,4))";
 
 		DataSet<Edge<IntValue, Tuple3<NullValue, LongValue, LongValue>>> degreePairOnSourceId = undirectedSimpleGraph
-			.run(new EdgeDegreePair<>());
+			.run(new EdgeDegreePair<IntValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
 
 		TestBaseUtils.compareResultAsText(degreePairOnSourceId.collect(), expectedResult);
 
@@ -71,10 +70,40 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple3<NullValue, LongValue, LongValue>>> degreePairOnSourceId = emptyGraphWithVertices
+			.run(new EdgeDegreePair<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
+
+		assertEquals(0, degreePairOnSourceId.collect().size());
+
+		DataSet<Edge<LongValue, Tuple3<NullValue, LongValue, LongValue>>> degreePairOnTargetId = emptyGraphWithVertices
+			.run(new EdgeDegreePair<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(true));
+
+		assertEquals(0, degreePairOnTargetId.collect().size());
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple3<NullValue, LongValue, LongValue>>> degreePairOnSourceId = emptyGraphWithoutVertices
+			.run(new EdgeDegreePair<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
+
+		assertEquals(0, degreePairOnSourceId.collect().size());
+
+		DataSet<Edge<LongValue, Tuple3<NullValue, LongValue, LongValue>>> degreePairOnTargetId = emptyGraphWithoutVertices
+			.run(new EdgeDegreePair<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(true));
+
+		assertEquals(0, degreePairOnTargetId.collect().size());
+	}
+
+	@Test
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Edge<LongValue, Tuple3<NullValue, LongValue, LongValue>>> degreePairOnSourceId = undirectedRMatGraph(10, 16)
-			.run(new EdgeDegreePair<>());
+			.run(new EdgeDegreePair<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
 
 		Checksum checksumOnSourceId = new ChecksumHashCode<Edge<LongValue, Tuple3<NullValue, LongValue, LongValue>>>()
 			.run(degreePairOnSourceId)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeSourceDegreeTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeSourceDegreeTest.java
index 2d8b2e3071d..3802b4f41a3 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeSourceDegreeTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeSourceDegreeTest.java
@@ -36,12 +36,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link EdgeSourceDegree}.
  */
-public class EdgeSourceDegreeTest
-extends AsmTestBase {
+public class EdgeSourceDegreeTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		String expectedResult =
 			"(0,1,((null),2))\n" +
 			"(0,2,((null),2))\n" +
@@ -59,7 +57,8 @@ extends AsmTestBase {
 			"(5,3,((null),1))";
 
 		DataSet<Edge<IntValue, Tuple2<NullValue, LongValue>>> sourceDegreeOnSourceId = undirectedSimpleGraph
-			.run(new EdgeSourceDegree<>());
+			.run(new EdgeSourceDegree<IntValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
 
 		TestBaseUtils.compareResultAsText(sourceDegreeOnSourceId.collect(), expectedResult);
 
@@ -71,10 +70,40 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple2<NullValue, LongValue>>> sourceDegreeOnSourceId = emptyGraphWithVertices
+			.run(new EdgeSourceDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
+
+		assertEquals(0, sourceDegreeOnSourceId.collect().size());
+
+		DataSet<Edge<LongValue, Tuple2<NullValue, LongValue>>> sourceDegreeOnTargetId = emptyGraphWithVertices
+			.run(new EdgeSourceDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(true));
+
+		assertEquals(0, sourceDegreeOnTargetId.collect().size());
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple2<NullValue, LongValue>>> sourceDegreeOnSourceId = emptyGraphWithoutVertices
+			.run(new EdgeSourceDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
+
+		assertEquals(0, sourceDegreeOnSourceId.collect().size());
+
+		DataSet<Edge<LongValue, Tuple2<NullValue, LongValue>>> sourceDegreeOnTargetId = emptyGraphWithoutVertices
+			.run(new EdgeSourceDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(true));
+
+		assertEquals(0, sourceDegreeOnTargetId.collect().size());
+	}
+
+	@Test
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Edge<LongValue, Tuple2<NullValue, LongValue>>> sourceDegreeOnSourceId = undirectedRMatGraph(10, 16)
-			.run(new EdgeSourceDegree<>());
+			.run(new EdgeSourceDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
 
 		Checksum checksumOnSourceId = new ChecksumHashCode<Edge<LongValue, Tuple2<NullValue, LongValue>>>()
 			.run(sourceDegreeOnSourceId)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeTargetDegreeTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeTargetDegreeTest.java
index a7c88a1f0f1..51f880b8694 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeTargetDegreeTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/EdgeTargetDegreeTest.java
@@ -36,12 +36,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link EdgeTargetDegree}.
  */
-public class EdgeTargetDegreeTest
-extends AsmTestBase {
+public class EdgeTargetDegreeTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		String expectedResult =
 			"(0,1,((null),3))\n" +
 			"(0,2,((null),3))\n" +
@@ -59,7 +57,8 @@ extends AsmTestBase {
 			"(5,3,((null),4))";
 
 		DataSet<Edge<IntValue, Tuple2<NullValue, LongValue>>> targetDegreeOnTargetId = undirectedSimpleGraph
-				.run(new EdgeTargetDegree<>());
+			.run(new EdgeTargetDegree<IntValue, NullValue, NullValue>()
+				.setReduceOnSourceId(false));
 
 		TestBaseUtils.compareResultAsText(targetDegreeOnTargetId.collect(), expectedResult);
 
@@ -71,10 +70,40 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple2<NullValue, LongValue>>> targetDegreeOnTargetId = emptyGraphWithVertices
+			.run(new EdgeTargetDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnSourceId(false));
+
+		assertEquals(0, targetDegreeOnTargetId.collect().size());
+
+		DataSet<Edge<LongValue, Tuple2<NullValue, LongValue>>> targetDegreeOnSourceId = emptyGraphWithVertices
+			.run(new EdgeTargetDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnSourceId(true));
+
+		assertEquals(0, targetDegreeOnSourceId.collect().size());
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Edge<LongValue, Tuple2<NullValue, LongValue>>> targetDegreeOnTargetId = emptyGraphWithoutVertices
+			.run(new EdgeTargetDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnSourceId(false));
+
+		assertEquals(0, targetDegreeOnTargetId.collect().size());
+
+		DataSet<Edge<LongValue, Tuple2<NullValue, LongValue>>> targetDegreeOnSourceId = emptyGraphWithoutVertices
+			.run(new EdgeTargetDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnSourceId(true));
+
+		assertEquals(0, targetDegreeOnSourceId.collect().size());
+	}
+
+	@Test
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Edge<LongValue, Tuple2<NullValue, LongValue>>> targetDegreeOnTargetId = undirectedRMatGraph(10, 16)
-			.run(new EdgeSourceDegree<>());
+			.run(new EdgeTargetDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnSourceId(false));
 
 		Checksum checksumOnTargetId = new ChecksumHashCode<Edge<LongValue, Tuple2<NullValue, LongValue>>>()
 			.run(targetDegreeOnTargetId)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/VertexDegreeTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/VertexDegreeTest.java
index bc76bffba37..49f000770df 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/VertexDegreeTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/annotate/undirected/VertexDegreeTest.java
@@ -35,12 +35,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link VertexDegree}.
  */
-public class VertexDegreeTest
-extends AsmTestBase {
+public class VertexDegreeTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		String expectedResult =
 			"(0,2)\n" +
 			"(1,3)\n" +
@@ -50,7 +48,8 @@ extends AsmTestBase {
 			"(5,1)";
 
 		DataSet<Vertex<IntValue, LongValue>> degreeOnSourceId = undirectedSimpleGraph
-			.run(new VertexDegree<>());
+			.run(new VertexDegree<IntValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
 
 		TestBaseUtils.compareResultAsText(degreeOnSourceId.collect(), expectedResult);
 
@@ -62,12 +61,12 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
 		long expectedDegree = completeGraphVertexCount - 1;
 
 		DataSet<Vertex<LongValue, LongValue>> degreeOnSourceId = completeGraph
-			.run(new VertexDegree<>());
+			.run(new VertexDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
 
 		for (Vertex<LongValue, LongValue> vertex : degreeOnSourceId.collect()) {
 			assertEquals(expectedDegree, vertex.getValue().getValue());
@@ -83,17 +82,16 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
 		DataSet<Vertex<LongValue, LongValue>> degree;
 
-		degree = emptyGraph
+		degree = emptyGraphWithVertices
 			.run(new VertexDegree<LongValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(false));
 
 		assertEquals(0, degree.collect().size());
 
-		degree = emptyGraph
+		degree = emptyGraphWithVertices
 			.run(new VertexDegree<LongValue, NullValue, NullValue>()
 				.setIncludeZeroDegreeVertices(true));
 
@@ -106,10 +104,27 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Vertex<LongValue, LongValue>> degree;
+
+		degree = emptyGraphWithoutVertices
+			.run(new VertexDegree<LongValue, NullValue, NullValue>()
+				.setIncludeZeroDegreeVertices(false));
+
+		assertEquals(0, degree.collect().size());
+
+		degree = emptyGraphWithoutVertices
+			.run(new VertexDegree<LongValue, NullValue, NullValue>()
+				.setIncludeZeroDegreeVertices(true));
+
+		assertEquals(0, degree.collect().size());
+	}
+
+	@Test
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Vertex<LongValue, LongValue>> degreeOnSourceId = undirectedRMatGraph(10, 16)
-			.run(new VertexDegree<>());
+			.run(new VertexDegree<LongValue, NullValue, NullValue>()
+				.setReduceOnTargetId(false));
 
 		Checksum checksumOnSourceId = new ChecksumHashCode<Vertex<LongValue, LongValue>>()
 			.run(degreeOnSourceId)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/filter/undirected/MaximumDegreeTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/filter/undirected/MaximumDegreeTest.java
index 51e7712f589..f43be9c30a3 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/filter/undirected/MaximumDegreeTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/degree/filter/undirected/MaximumDegreeTest.java
@@ -24,6 +24,7 @@ import org.apache.flink.graph.asm.dataset.ChecksumHashCode.Checksum;
 import org.apache.flink.graph.library.metric.ChecksumHashCode;
 import org.apache.flink.test.util.TestBaseUtils;
 import org.apache.flink.types.IntValue;
+import org.apache.flink.types.LongValue;
 import org.apache.flink.types.NullValue;
 
 import org.junit.Test;
@@ -33,12 +34,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link MaximumDegree}.
  */
-public class MaximumDegreeTest
-extends AsmTestBase {
+public class MaximumDegreeTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		Graph<IntValue, NullValue, NullValue> graph = undirectedSimpleGraph
 			.run(new MaximumDegree<>(3));
 
@@ -63,8 +62,25 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		Graph<LongValue, NullValue, NullValue> graph = emptyGraphWithVertices
+			.run(new MaximumDegree<>(1));
+
+		assertEquals(emptyGraphVertexCount, graph.getVertices().collect().size());
+		assertEquals(0, graph.getEdges().collect().size());
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		Graph<LongValue, NullValue, NullValue> graph = emptyGraphWithoutVertices
+			.run(new MaximumDegree<>(1));
+
+		assertEquals(0, graph.getVertices().collect().size());
+		assertEquals(0, graph.getEdges().collect().size());
+	}
+
+	@Test
+	public void testWithRMatGraph() throws Exception {
 		Checksum checksum = undirectedRMatGraph(10, 16)
 			.run(new MaximumDegree<>(16))
 			.run(new ChecksumHashCode<>())
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/simple/directed/SimplifyTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/simple/directed/SimplifyTest.java
index 751d030027f..f31c09a3427 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/simple/directed/SimplifyTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/simple/directed/SimplifyTest.java
@@ -62,8 +62,7 @@ public class SimplifyTest {
 	}
 
 	@Test
-	public void test()
-			throws Exception {
+	public void test() throws Exception {
 		String expectedResult =
 			"(0,1,(null))\n" +
 			"(0,2,(null))\n" +
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/simple/undirected/SimplifyTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/simple/undirected/SimplifyTest.java
index 68b4e0c3cbe..45abb741d70 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/simple/undirected/SimplifyTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/simple/undirected/SimplifyTest.java
@@ -62,8 +62,7 @@ public class SimplifyTest {
 	}
 
 	@Test
-	public void testWithFullFlip()
-			throws Exception {
+	public void testWithFullFlip() throws Exception {
 		String expectedResult =
 			"(0,1,(null))\n" +
 			"(0,2,(null))\n" +
@@ -77,8 +76,7 @@ public class SimplifyTest {
 	}
 
 	@Test
-	public void testWithClipAndFlip()
-			throws Exception {
+	public void testWithClipAndFlip() throws Exception {
 		String expectedResult =
 			"(0,1,(null))\n" +
 			"(1,0,(null))";
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/translate/TranslateTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/translate/TranslateTest.java
index dacea267099..b1afd9a5f25 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/translate/TranslateTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/asm/translate/TranslateTest.java
@@ -88,8 +88,7 @@ public class TranslateTest {
 	}
 
 	@Test
-	public void testTranslateGraphIds()
-			throws Exception {
+	public void testTranslateGraphIds() throws Exception {
 		Graph<StringValue, LongValue, LongValue> stringIdGraph = graph
 			.translateGraphIds(new LongValueToStringValue());
 
@@ -109,8 +108,7 @@ public class TranslateTest {
 	}
 
 	@Test
-	public void testTranslateVertexValues()
-			throws Exception {
+	public void testTranslateVertexValues() throws Exception {
 		DataSet<Vertex<LongValue, StringValue>> vertexSet = graph
 			.translateVertexValues(new LongValueToStringValue())
 			.getVertices();
@@ -124,8 +122,7 @@ public class TranslateTest {
 	}
 
 	@Test
-	public void testTranslateEdgeValues()
-			throws Exception {
+	public void testTranslateEdgeValues() throws Exception {
 		DataSet<Edge<LongValue, StringValue>> edgeSet = graph
 			.translateEdgeValues(new LongValueToStringValue())
 			.getEdges();
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CirculantGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CirculantGraphTest.java
index 79c3468f2b5..1596b65be3b 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CirculantGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CirculantGraphTest.java
@@ -30,12 +30,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link CirculantGraph}.
  */
-public class CirculantGraphTest
-extends GraphGeneratorTestBase {
+public class CirculantGraphTest extends GraphGeneratorTestBase {
 
 	@Test
-	public void testGraph()
-			throws Exception {
+	public void testGraph() throws Exception {
 		Graph<LongValue, NullValue, NullValue> graph = new CirculantGraph(env, 10)
 			.addRange(4, 3)
 			.generate();
@@ -50,8 +48,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		int vertexCount = 10;
 		int offset = 4;
 		int length = 2;
@@ -71,8 +68,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		Graph<LongValue, NullValue, NullValue> graph = new CirculantGraph(env, 10)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CompleteGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CompleteGraphTest.java
index 45446b39f63..969c48a2e11 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CompleteGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CompleteGraphTest.java
@@ -30,12 +30,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link CompleteGraph}.
  */
-public class CompleteGraphTest
-extends GraphGeneratorTestBase {
+public class CompleteGraphTest extends GraphGeneratorTestBase {
 
 	@Test
-	public void testGraph()
-			throws Exception {
+	public void testGraph() throws Exception {
 		int vertexCount = 4;
 
 		Graph<LongValue, NullValue, NullValue> graph = new CompleteGraph(env, vertexCount)
@@ -48,8 +46,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		int vertexCount = 10;
 
 		Graph<LongValue, NullValue, NullValue> graph = new CompleteGraph(env, vertexCount)
@@ -70,8 +67,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		Graph<LongValue, NullValue, NullValue> graph = new CompleteGraph(env, 10)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CycleGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CycleGraphTest.java
index dd0912aa6d7..1291e00626f 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CycleGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/CycleGraphTest.java
@@ -30,12 +30,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link CycleGraph}.
  */
-public class CycleGraphTest
-extends GraphGeneratorTestBase {
+public class CycleGraphTest extends GraphGeneratorTestBase {
 
 	@Test
-	public void testGraph()
-			throws Exception {
+	public void testGraph() throws Exception {
 		Graph<LongValue, NullValue, NullValue> graph = new CycleGraph(env, 10)
 			.generate();
 
@@ -47,8 +45,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		int vertexCount = 100;
 
 		Graph<LongValue, NullValue, NullValue> graph = new CycleGraph(env, vertexCount)
@@ -69,8 +66,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		Graph<LongValue, NullValue, NullValue> graph = new CycleGraph(env, 100)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/EchoGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/EchoGraphTest.java
index 5d8bfc4a610..b98f5dd26da 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/EchoGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/EchoGraphTest.java
@@ -32,15 +32,13 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link EchoGraph}.
  */
-public class EchoGraphTest
-extends GraphGeneratorTestBase {
+public class EchoGraphTest extends GraphGeneratorTestBase {
 
 	@Rule
 	public ExpectedException thrown = ExpectedException.none();
 
 	@Test
-	public void testGraphWithEvenVertexCountWithOddVertexDegree()
-			throws Exception {
+	public void testGraphWithEvenVertexCountWithOddVertexDegree() throws Exception {
 		Graph<LongValue, NullValue, NullValue> graph = new EchoGraph(env, 10, 3)
 			.generate();
 
@@ -54,8 +52,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphWithOddVertexCountWithEvenVertexDegree()
-			throws Exception {
+	public void testGraphWithOddVertexCountWithEvenVertexDegree() throws Exception {
 		Graph<LongValue, NullValue, NullValue> graph = new EchoGraph(env, 9, 2)
 			.generate();
 
@@ -68,8 +65,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphWithOddVertexCountWithOddVertexDegree()
-			throws Exception {
+	public void testGraphWithOddVertexCountWithOddVertexDegree() throws Exception {
 		thrown.expect(IllegalArgumentException.class);
 		thrown.expectMessage("Vertex count or vertex degree must be an even number but not both.");
 
@@ -77,8 +73,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphWithEvenVertexCountWithEvenVertexDegree()
-			throws Exception {
+	public void testGraphWithEvenVertexCountWithEvenVertexDegree() throws Exception {
 		thrown.expect(IllegalArgumentException.class);
 		thrown.expectMessage("Vertex count or vertex degree must be an even number but not both.");
 
@@ -86,8 +81,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphWithVertexDegreeTooLarge()
-			throws Exception {
+	public void testGraphWithVertexDegreeTooLarge() throws Exception {
 		thrown.expect(IllegalArgumentException.class);
 		thrown.expectMessage("Vertex degree must be less than the vertex count.");
 
@@ -95,8 +89,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		int vertexCount = 10;
 		int vertexDegree = 3;
 
@@ -114,8 +107,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		Graph<LongValue, NullValue, NullValue> graph = new EchoGraph(env, 10, 3)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/EmptyGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/EmptyGraphTest.java
index 35909220919..4ee69a09a0a 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/EmptyGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/EmptyGraphTest.java
@@ -30,12 +30,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link EmptyGraph}.
  */
-public class EmptyGraphTest
-extends GraphGeneratorTestBase {
+public class EmptyGraphTest extends GraphGeneratorTestBase {
 
 	@Test
-	public void testGraph()
-			throws Exception {
+	public void testGraph() throws Exception {
 		Graph<LongValue, NullValue, NullValue> graph = new EmptyGraph(env, 10)
 			.generate();
 
@@ -46,8 +44,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		int vertexCount = 100;
 
 		Graph<LongValue, NullValue, NullValue> graph = new EmptyGraph(env, vertexCount)
@@ -64,8 +61,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		Graph<LongValue, NullValue, NullValue> graph = new EmptyGraph(env, 100)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/GridGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/GridGraphTest.java
index 7281770e6d3..19bf43c4802 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/GridGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/GridGraphTest.java
@@ -30,12 +30,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link GridGraph}.
  */
-public class GridGraphTest
-extends GraphGeneratorTestBase {
+public class GridGraphTest extends GraphGeneratorTestBase {
 
 	@Test
-	public void testGraph()
-			throws Exception {
+	public void testGraph() throws Exception {
 		Graph<LongValue, NullValue, NullValue> graph = new GridGraph(env)
 			.addDimension(2, false)
 			.addDimension(3, false)
@@ -51,8 +49,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		Graph<LongValue, NullValue, NullValue> graph = new GridGraph(env)
 			.addDimension(2, true)
 			.addDimension(3, true)
@@ -77,8 +74,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		Graph<LongValue, NullValue, NullValue> graph = new GridGraph(env)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/HypercubeGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/HypercubeGraphTest.java
index 3ecd4a446c6..ce9b050fb60 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/HypercubeGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/HypercubeGraphTest.java
@@ -30,12 +30,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link HypercubeGraph}.
  */
-public class HypercubeGraphTest
-extends GraphGeneratorTestBase {
+public class HypercubeGraphTest extends GraphGeneratorTestBase {
 
 	@Test
-	public void testGraph()
-			throws Exception {
+	public void testGraph() throws Exception {
 		int dimensions = 3;
 
 		Graph<LongValue, NullValue, NullValue> graph = new HypercubeGraph(env, dimensions)
@@ -49,8 +47,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		int dimensions = 10;
 
 		Graph<LongValue, NullValue, NullValue> graph = new HypercubeGraph(env, dimensions)
@@ -71,8 +68,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		Graph<LongValue, NullValue, NullValue> graph = new HypercubeGraph(env, 4)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/PathGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/PathGraphTest.java
index 6817e92a763..ebf8c40725e 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/PathGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/PathGraphTest.java
@@ -30,12 +30,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link PathGraph}.
  */
-public class PathGraphTest
-extends GraphGeneratorTestBase {
+public class PathGraphTest extends GraphGeneratorTestBase {
 
 	@Test
-	public void testGraph()
-			throws Exception {
+	public void testGraph() throws Exception {
 		Graph<LongValue, NullValue, NullValue> graph = new PathGraph(env, 10)
 			.generate();
 
@@ -47,8 +45,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		int vertexCount = 100;
 
 		Graph<LongValue, NullValue, NullValue> graph = new PathGraph(env, vertexCount)
@@ -69,8 +66,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		Graph<LongValue, NullValue, NullValue> graph = new PathGraph(env, 100)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/RMatGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/RMatGraphTest.java
index 5f18a73f89a..26bc911e342 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/RMatGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/RMatGraphTest.java
@@ -34,12 +34,10 @@ import static org.junit.Assert.assertTrue;
 /**
  * Tests for {@link RMatGraph}.
  */
-public class RMatGraphTest
-extends GraphGeneratorTestBase {
+public class RMatGraphTest extends GraphGeneratorTestBase {
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		long vertexCount = 100;
 
 		long edgeCount = 1000;
@@ -54,8 +52,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		RandomGenerableFactory<JDKRandomGenerator> rnd = new JDKRandomGeneratorFactory();
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/SingletonEdgeGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/SingletonEdgeGraphTest.java
index f78b7ff972a..e02832024b5 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/SingletonEdgeGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/SingletonEdgeGraphTest.java
@@ -30,12 +30,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link SingletonEdgeGraph}.
  */
-public class SingletonEdgeGraphTest
-extends GraphGeneratorTestBase {
+public class SingletonEdgeGraphTest extends GraphGeneratorTestBase {
 
 	@Test
-	public void testGraph()
-			throws Exception {
+	public void testGraph() throws Exception {
 		int vertexPairCount = 5;
 
 		Graph<LongValue, NullValue, NullValue> graph = new SingletonEdgeGraph(env, vertexPairCount)
@@ -48,8 +46,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		int vertexPairCount = 10;
 
 		Graph<LongValue, NullValue, NullValue> graph = new SingletonEdgeGraph(env, vertexPairCount)
@@ -70,8 +67,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		Graph<LongValue, NullValue, NullValue> graph = new SingletonEdgeGraph(env, 10)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/StarGraphTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/StarGraphTest.java
index 9e9da5f1cc3..6a20a850ebd 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/StarGraphTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/StarGraphTest.java
@@ -30,12 +30,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link StarGraph}.
  */
-public class StarGraphTest
-extends GraphGeneratorTestBase {
+public class StarGraphTest extends GraphGeneratorTestBase {
 
 	@Test
-	public void testGraph()
-			throws Exception {
+	public void testGraph() throws Exception {
 		int vertexCount = 10;
 
 		Graph<LongValue, NullValue, NullValue> graph = new StarGraph(env, vertexCount)
@@ -49,8 +47,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testGraphMetrics()
-			throws Exception {
+	public void testGraphMetrics() throws Exception {
 		int vertexCount = 100;
 
 		Graph<LongValue, NullValue, NullValue> graph = new StarGraph(env, vertexCount)
@@ -71,8 +68,7 @@ extends GraphGeneratorTestBase {
 	}
 
 	@Test
-	public void testParallelism()
-			throws Exception {
+	public void testParallelism() throws Exception {
 		int parallelism = 2;
 
 		Graph<LongValue, NullValue, NullValue> graph = new StarGraph(env, 100)
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/TestUtils.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/TestUtils.java
index fd099c04b8b..b44b2afe71b 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/TestUtils.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/generator/TestUtils.java
@@ -53,14 +53,12 @@ public final class TestUtils {
 	 * @param <EV> the value type for edges
 	 * @throws Exception
 	 */
-	public static <K, VV, EV> void compareGraph(Graph<K, VV, EV> graph, String expectedVertices, String expectedEdges)
-			throws Exception {
+	public static <K, VV, EV> void compareGraph(Graph<K, VV, EV> graph, String expectedVertices, String expectedEdges) throws Exception {
 		compareVertices(graph, expectedVertices);
 		compareEdges(graph, expectedEdges);
 	}
 
-	private static <K, VV, EV> void compareVertices(Graph<K, VV, EV> graph, String expectedVertices)
-			throws Exception {
+	private static <K, VV, EV> void compareVertices(Graph<K, VV, EV> graph, String expectedVertices) throws Exception {
 		if (expectedVertices != null) {
 			List<Vertex<K, VV>> vertices = graph.getVertices().collect();
 			List<String> resultVertices = new ArrayList<>(vertices.size());
@@ -73,8 +71,7 @@ public final class TestUtils {
 		}
 	}
 
-	private static <K, VV, EV> void compareEdges(Graph<K, VV, EV> graph, String expectedEdges)
-			throws Exception {
+	private static <K, VV, EV> void compareEdges(Graph<K, VV, EV> graph, String expectedEdges) throws Exception {
 		if (expectedEdges != null) {
 			List<Edge<K, EV>> edges = graph.getEdges().collect();
 			List<String> resultEdges = new ArrayList<>(edges.size());
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/AverageClusteringCoefficientTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/AverageClusteringCoefficientTest.java
index 6474199a73c..5c422982f0a 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/AverageClusteringCoefficientTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/AverageClusteringCoefficientTest.java
@@ -18,10 +18,10 @@
 
 package org.apache.flink.graph.library.clustering.directed;
 
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.library.clustering.directed.AverageClusteringCoefficient.Result;
-import org.apache.flink.types.IntValue;
-import org.apache.flink.types.LongValue;
+import org.apache.flink.types.CopyableValue;
 import org.apache.flink.types.NullValue;
 
 import org.junit.Test;
@@ -31,56 +31,50 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link AverageClusteringCoefficient}.
  */
-public class AverageClusteringCoefficientTest
-extends AsmTestBase {
-
-	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
-		// see results in LocalClusteringCoefficientTest.testSimpleGraph
-		Result expectedResult = new Result(6, 1.0 / 2 + 2.0 / 6 + 2.0 / 6 + 1.0 / 12);
-
-		Result averageClusteringCoefficient = new AverageClusteringCoefficient<IntValue, NullValue, NullValue>()
-			.run(directedSimpleGraph)
+public class AverageClusteringCoefficientTest extends AsmTestBase {
+
+	/**
+	 * Validate a test result.
+	 *
+	 * @param graph input graph
+	 * @param vertexCount result vertex count
+	 * @param averageClusteringCoefficient result average clustering coefficient
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends Comparable<T> & CopyableValue<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, long vertexCount, double averageClusteringCoefficient) throws Exception {
+		Result result = new AverageClusteringCoefficient<T, NullValue, NullValue>()
+			.run(graph)
 			.execute();
 
-		assertEquals(expectedResult, averageClusteringCoefficient);
+		assertEquals(vertexCount, result.getNumberOfVertices());
+		assertEquals(averageClusteringCoefficient, result.getAverageClusteringCoefficient(), ACCURACY);
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
-		Result expectedResult = new Result(completeGraphVertexCount, completeGraphVertexCount);
-
-		Result averageClusteringCoefficient = new AverageClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(completeGraph)
-			.execute();
-
-		assertEquals(expectedResult, averageClusteringCoefficient);
+	public void testWithSimpleGraph() throws Exception {
+		// see results in LocalClusteringCoefficientTest.testSimpleGraph
+		validate(directedSimpleGraph, 6, (1.0 / 2 + 2.0 / 6 + 2.0 / 6 + 1.0 / 12) / 6);
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		Result expectedResult = new Result(emptyGraphVertexCount, 0);
-
-		Result averageClusteringCoefficient = new AverageClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(emptyGraph)
-			.execute();
-
-		assertEquals(expectedResult, averageClusteringCoefficient);
+	public void testWithCompleteGraph() throws Exception {
+		validate(completeGraph, completeGraphVertexCount, 1.0);
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
-		Result expectedResult = new Result(902, 297.152607);
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, emptyGraphVertexCount, 0);
+	}
 
-		Result averageClusteringCoefficient = new AverageClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(directedRMatGraph(10, 16))
-			.execute();
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, 0, Double.NaN);
+	}
 
-		assertEquals(expectedResult.getNumberOfVertices(), averageClusteringCoefficient.getNumberOfVertices());
-		assertEquals(expectedResult.getAverageClusteringCoefficient(), averageClusteringCoefficient.getAverageClusteringCoefficient(), 0.000001);
+	@Test
+	public void testWithRMatGraph() throws Exception {
+		validate(directedRMatGraph(10, 16), 902, 0.329437);
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/GlobalClusteringCoefficientTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/GlobalClusteringCoefficientTest.java
index d74948aa29c..56bcf32825b 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/GlobalClusteringCoefficientTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/GlobalClusteringCoefficientTest.java
@@ -18,10 +18,10 @@
 
 package org.apache.flink.graph.library.clustering.directed;
 
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.library.clustering.directed.GlobalClusteringCoefficient.Result;
-import org.apache.flink.types.IntValue;
-import org.apache.flink.types.LongValue;
+import org.apache.flink.types.CopyableValue;
 import org.apache.flink.types.NullValue;
 
 import org.apache.commons.math3.util.CombinatoricsUtils;
@@ -32,57 +32,52 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link GlobalClusteringCoefficient}.
  */
-public class GlobalClusteringCoefficientTest
-extends AsmTestBase {
-
-	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
-		Result expectedResult = new Result(13, 6);
-
-		Result globalClusteringCoefficient = new GlobalClusteringCoefficient<IntValue, NullValue, NullValue>()
-			.run(directedSimpleGraph)
+public class GlobalClusteringCoefficientTest extends AsmTestBase {
+
+	/**
+	 * Validate a test result.
+	 *
+	 * @param graph input graph
+	 * @param tripletCount result triplet count
+	 * @param triangleCount result triangle count
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends Comparable<T> & CopyableValue<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, long tripletCount, long triangleCount) throws Exception {
+		Result result = new GlobalClusteringCoefficient<T, NullValue, NullValue>()
+			.run(graph)
 			.execute();
 
-		assertEquals(expectedResult, globalClusteringCoefficient);
+		assertEquals(tripletCount, result.getNumberOfTriplets());
+		assertEquals(triangleCount, result.getNumberOfTriangles());
+	}
+
+	@Test
+	public void testWithSimpleGraph() throws Exception {
+		validate(directedSimpleGraph, 13, 6);
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
 		long expectedDegree = completeGraphVertexCount - 1;
 		long expectedCount = completeGraphVertexCount * CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2);
 
-		Result expectedResult = new Result(expectedCount, expectedCount);
-
-		Result globalClusteringCoefficient = new GlobalClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(completeGraph)
-			.execute();
-
-		assertEquals(expectedResult, globalClusteringCoefficient);
+		validate(completeGraph, expectedCount, expectedCount);
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		Result expectedResult = new Result(0, 0);
-
-		Result globalClusteringCoefficient = new GlobalClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(emptyGraph)
-			.execute();
-
-		assertEquals(expectedResult, globalClusteringCoefficient);
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, 0, 0);
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
-		Result expectedResult = new Result(1003442, 225147);
-
-		Result globalClusteringCoefficient = new GlobalClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(directedRMatGraph(10, 16))
-			.execute();
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, 0, 0);
+	}
 
-		assertEquals(expectedResult, globalClusteringCoefficient);
+	@Test
+	public void testWithRMatGraph() throws Exception {
+		validate(directedRMatGraph(10, 16), 1003442, 225147);
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/LocalClusteringCoefficientTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/LocalClusteringCoefficientTest.java
index 626b754b374..0e3b1cc35c4 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/LocalClusteringCoefficientTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/LocalClusteringCoefficientTest.java
@@ -19,12 +19,15 @@
 package org.apache.flink.graph.library.clustering.directed;
 
 import org.apache.flink.api.java.DataSet;
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.asm.dataset.ChecksumHashCode.Checksum;
 import org.apache.flink.graph.library.clustering.directed.LocalClusteringCoefficient.Result;
 import org.apache.flink.test.util.TestBaseUtils;
+import org.apache.flink.types.CopyableValue;
 import org.apache.flink.types.IntValue;
 import org.apache.flink.types.LongValue;
+import org.apache.flink.types.NullValue;
 
 import org.apache.commons.math3.util.CombinatoricsUtils;
 import org.junit.Test;
@@ -36,12 +39,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link LocalClusteringCoefficient}.
  */
-public class LocalClusteringCoefficientTest
-extends AsmTestBase {
+public class LocalClusteringCoefficientTest extends AsmTestBase {
 
 	@Test
-	public void testSimpleGraph()
-			throws Exception {
+	public void testSimpleGraph() throws Exception {
 		String expectedResult =
 			"(0,2,1)\n" +
 			"(1,3,2)\n" +
@@ -56,28 +57,51 @@ extends AsmTestBase {
 		TestBaseUtils.compareResultAsText(cc.collect(), expectedResult);
 	}
 
-	@Test
-	public void testCompleteGraph()
-			throws Exception {
-		long expectedDegree = completeGraphVertexCount - 1;
-		long expectedTriangleCount = 2 * CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2);
-
-		DataSet<Result<LongValue>> cc = completeGraph
+	/**
+	 * Validate a test where each result has the same values.
+	 *
+	 * @param graph input graph
+	 * @param count number of results
+	 * @param degree result degree
+	 * @param triangleCount result triangle count
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends Comparable<T> & CopyableValue<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, long count, long degree, long triangleCount) throws Exception {
+		DataSet<Result<T>> cc = graph
 			.run(new LocalClusteringCoefficient<>());
 
-		List<Result<LongValue>> results = cc.collect();
+		List<Result<T>> results = cc.collect();
 
-		assertEquals(completeGraphVertexCount, results.size());
+		assertEquals(count, results.size());
 
-		for (Result<LongValue> result : results) {
-			assertEquals(expectedDegree, result.getDegree().getValue());
-			assertEquals(expectedTriangleCount, result.getTriangleCount().getValue());
+		for (Result<T> result : results) {
+			assertEquals(degree, result.getDegree().getValue());
+			assertEquals(triangleCount, result.getTriangleCount().getValue());
 		}
 	}
 
 	@Test
-	public void testRMatGraph()
-			throws Exception {
+	public void testCompleteGraph() throws Exception {
+		long degree = completeGraphVertexCount - 1;
+		long triangleCount = 2 * CombinatoricsUtils.binomialCoefficient((int) degree, 2);
+
+		validate(completeGraph, completeGraphVertexCount, degree, triangleCount);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, emptyGraphVertexCount, 0, 0);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, 0, 0, 0);
+	}
+
+	@Test
+	public void testRMatGraph() throws Exception {
 		DataSet<Result<LongValue>> cc = directedRMatGraph(10, 16)
 			.run(new LocalClusteringCoefficient<>());
 
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/TriadicCensusTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/TriadicCensusTest.java
index 68d5d9d7e1d..5689d12738d 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/TriadicCensusTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/TriadicCensusTest.java
@@ -32,12 +32,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link TriadicCensus}.
  */
-public class TriadicCensusTest
-extends AsmTestBase {
+public class TriadicCensusTest extends AsmTestBase {
 
 	@Test
-	public void testWithUndirectedSimpleGraph()
-			throws Exception {
+	public void testWithUndirectedSimpleGraph() throws Exception {
 		Result expectedResult = new Result(3, 0, 8, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 2);
 
 		Result triadCensus = new TriadicCensus<IntValue, NullValue, NullValue>()
@@ -48,8 +46,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithDirectedSimpleGraph()
-			throws Exception {
+	public void testWithDirectedSimpleGraph() throws Exception {
 		Result expectedResult = new Result(3, 8, 0, 1, 2, 4, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0);
 
 		Result triadCensus = new TriadicCensus<IntValue, NullValue, NullValue>()
@@ -60,8 +57,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
 		long expectedDegree = completeGraphVertexCount - 1;
 		long expectedCount = completeGraphVertexCount * CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2) / 3;
 
@@ -75,20 +71,29 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
 		Result expectedResult = new Result(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
 
 		Result triadCensus = new TriadicCensus<LongValue, NullValue, NullValue>()
-			.run(emptyGraph)
+			.run(emptyGraphWithVertices)
 			.execute();
 
 		assertEquals(expectedResult, triadCensus);
 	}
 
 	@Test
-	public void testWithUndirectedRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		Result expectedResult = new Result(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
+
+		Result triadCensus = new TriadicCensus<LongValue, NullValue, NullValue>()
+			.run(emptyGraphWithoutVertices)
+			.execute();
+
+		assertEquals(expectedResult, triadCensus);
+	}
+
+	@Test
+	public void testWithUndirectedRMatGraph() throws Exception {
 		Result expectedResult = new Result(113_435_893, 0, 7_616_063, 0, 0, 0, 0, 0, 0, 0, 778_295, 0, 0, 0, 0, 75_049);
 
 		Result triadCensus = new TriadicCensus<LongValue, NullValue, NullValue>()
@@ -110,8 +115,7 @@ extends AsmTestBase {
 		print('{}: {}'.format(key, census[key]))
 	 */
 	@Test
-	public void testWithDirectedRMatGraph()
-			throws Exception {
+	public void testWithDirectedRMatGraph() throws Exception {
 		Result expectedResult = new Result(
 			113_435_893, 6_632_528, 983_535, 118_574,
 			118_566, 237_767, 129_773, 130_041,
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/TriangleListingTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/TriangleListingTest.java
index 2d02907b55c..7eb47988d3e 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/TriangleListingTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/directed/TriangleListingTest.java
@@ -39,12 +39,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link TriangleListing}.
  */
-public class TriangleListingTest
-extends AsmTestBase {
+public class TriangleListingTest extends AsmTestBase {
 
 	@Test
-	public void testSimpleGraphSorted()
-			throws Exception {
+	public void testSimpleGraphSorted() throws Exception {
 		DataSet<Result<IntValue>> tl = directedSimpleGraph
 			.run(new TriangleListing<IntValue, NullValue, NullValue>()
 				.setSortTriangleVertices(true));
@@ -57,8 +55,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testSimpleGraphPermuted()
-			throws Exception {
+	public void testSimpleGraphPermuted() throws Exception {
 		DataSet<Result<IntValue>> tl = directedSimpleGraph
 			.run(new TriangleListing<IntValue, NullValue, NullValue>()
 				.setPermuteResults(true));
@@ -107,8 +104,23 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Result<LongValue>> tl = emptyGraphWithVertices
+			.run(new TriangleListing<>());
+
+		assertEquals(0, tl.collect().size());
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Result<LongValue>> tl = emptyGraphWithoutVertices
+			.run(new TriangleListing<>());
+
+		assertEquals(0, tl.collect().size());
+	}
+
+	@Test
+	public void testRMatGraph() throws Exception {
 		DataSet<Result<LongValue>> tl = directedRMatGraph(10, 16)
 			.run(new TriangleListing<LongValue, NullValue, NullValue>()
 				.setSortTriangleVertices(true));
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/AverageClusteringCoefficientTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/AverageClusteringCoefficientTest.java
index 0835169ea64..4bd89158301 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/AverageClusteringCoefficientTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/AverageClusteringCoefficientTest.java
@@ -18,10 +18,10 @@
 
 package org.apache.flink.graph.library.clustering.undirected;
 
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.library.clustering.undirected.AverageClusteringCoefficient.Result;
-import org.apache.flink.types.IntValue;
-import org.apache.flink.types.LongValue;
+import org.apache.flink.types.CopyableValue;
 import org.apache.flink.types.NullValue;
 
 import org.junit.Test;
@@ -31,56 +31,50 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link AverageClusteringCoefficient}.
  */
-public class AverageClusteringCoefficientTest
-extends AsmTestBase {
-
-	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
-		// see results in LocalClusteringCoefficientTest.testSimpleGraph
-		Result expectedResult = new Result(6, 1.0 / 1 + 2.0 / 3 + 2.0 / 3 + 1.0 / 6);
-
-		Result averageClusteringCoefficient = new AverageClusteringCoefficient<IntValue, NullValue, NullValue>()
-			.run(undirectedSimpleGraph)
+public class AverageClusteringCoefficientTest extends AsmTestBase {
+
+	/**
+	 * Validate a test result.
+	 *
+	 * @param graph input graph
+	 * @param vertexCount result vertex count
+	 * @param averageClusteringCoefficient result average clustering coefficient
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends Comparable<T> & CopyableValue<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, long vertexCount, double averageClusteringCoefficient) throws Exception {
+		Result result = new AverageClusteringCoefficient<T, NullValue, NullValue>()
+			.run(graph)
 			.execute();
 
-		assertEquals(expectedResult, averageClusteringCoefficient);
+		assertEquals(vertexCount, result.getNumberOfVertices());
+		assertEquals(averageClusteringCoefficient, result.getAverageClusteringCoefficient(), ACCURACY);
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
-		Result expectedResult = new Result(completeGraphVertexCount, completeGraphVertexCount);
-
-		Result averageClusteringCoefficient = new AverageClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(completeGraph)
-			.execute();
-
-		assertEquals(expectedResult, averageClusteringCoefficient);
+	public void testWithSimpleGraph() throws Exception {
+		// see results in LocalClusteringCoefficientTest.testSimpleGraph
+		validate(undirectedSimpleGraph, 6, (1.0 / 1 + 2.0 / 3 + 2.0 / 3 + 1.0 / 6) / 6);
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		Result expectedResult = new Result(emptyGraphVertexCount, 0);
-
-		Result averageClusteringCoefficient = new AverageClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(emptyGraph)
-			.execute();
-
-		assertEquals(expectedResult, averageClusteringCoefficient);
+	public void testWithCompleteGraph() throws Exception {
+		validate(completeGraph, completeGraphVertexCount, 1.0);
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
-		Result expectedResult = new Result(902, 380.40109);
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, emptyGraphVertexCount, 0);
+	}
 
-		Result averageClusteringCoefficient = new AverageClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(undirectedRMatGraph(10, 16))
-			.execute();
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, 0, Double.NaN);
+	}
 
-		assertEquals(expectedResult.getNumberOfVertices(), averageClusteringCoefficient.getNumberOfVertices());
-		assertEquals(expectedResult.getAverageClusteringCoefficient(), averageClusteringCoefficient.getAverageClusteringCoefficient(), 0.000001);
+	@Test
+	public void testWithRMatGraph() throws Exception {
+		validate(undirectedRMatGraph(10, 16), 902, 0.421730);
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/GlobalClusteringCoefficientTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/GlobalClusteringCoefficientTest.java
index d9b0ab5833a..7fcf98d3ae6 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/GlobalClusteringCoefficientTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/GlobalClusteringCoefficientTest.java
@@ -18,10 +18,10 @@
 
 package org.apache.flink.graph.library.clustering.undirected;
 
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.library.clustering.undirected.GlobalClusteringCoefficient.Result;
-import org.apache.flink.types.IntValue;
-import org.apache.flink.types.LongValue;
+import org.apache.flink.types.CopyableValue;
 import org.apache.flink.types.NullValue;
 
 import org.apache.commons.math3.util.CombinatoricsUtils;
@@ -32,57 +32,52 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link GlobalClusteringCoefficient}.
  */
-public class GlobalClusteringCoefficientTest
-extends AsmTestBase {
-
-	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
-		Result expectedResult = new Result(13, 6);
-
-		Result globalClusteringCoefficient = new GlobalClusteringCoefficient<IntValue, NullValue, NullValue>()
-			.run(undirectedSimpleGraph)
+public class GlobalClusteringCoefficientTest extends AsmTestBase {
+
+	/**
+	 * Validate a test result.
+	 *
+	 * @param graph input graph
+	 * @param tripletCount result triplet count
+	 * @param triangleCount result triangle count
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends Comparable<T> & CopyableValue<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, long tripletCount, long triangleCount) throws Exception {
+		Result result = new GlobalClusteringCoefficient<T, NullValue, NullValue>()
+			.run(graph)
 			.execute();
 
-		assertEquals(expectedResult, globalClusteringCoefficient);
+		assertEquals(tripletCount, result.getNumberOfTriplets());
+		assertEquals(triangleCount, result.getNumberOfTriangles());
+	}
+
+	@Test
+	public void testWithSimpleGraph() throws Exception {
+		validate(undirectedSimpleGraph, 13, 6);
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
 		long expectedDegree = completeGraphVertexCount - 1;
 		long expectedCount = completeGraphVertexCount * CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2);
 
-		Result expectedResult = new Result(expectedCount, expectedCount);
-
-		Result globalClusteringCoefficient = new GlobalClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(completeGraph)
-			.execute();
-
-		assertEquals(expectedResult, globalClusteringCoefficient);
+		validate(completeGraph, expectedCount, expectedCount);
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		Result expectedResult = new Result(0, 0);
-
-		Result globalClusteringCoefficient = new GlobalClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(emptyGraph)
-			.execute();
-
-		assertEquals(expectedResult, globalClusteringCoefficient);
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, 0, 0);
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
-		Result expectedResult = new Result(1003442, 225147);
-
-		Result globalClusteringCoefficient = new GlobalClusteringCoefficient<LongValue, NullValue, NullValue>()
-			.run(undirectedRMatGraph(10, 16))
-			.execute();
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, 0, 0);
+	}
 
-		assertEquals(expectedResult, globalClusteringCoefficient);
+	@Test
+	public void testWithRMatGraph() throws Exception {
+		validate(undirectedRMatGraph(10, 16), 1003442, 225147);
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/LocalClusteringCoefficientTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/LocalClusteringCoefficientTest.java
index d77707e9256..085b59a0684 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/LocalClusteringCoefficientTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/LocalClusteringCoefficientTest.java
@@ -19,13 +19,16 @@
 package org.apache.flink.graph.library.clustering.undirected;
 
 import org.apache.flink.api.java.DataSet;
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.asm.dataset.ChecksumHashCode;
 import org.apache.flink.graph.asm.dataset.ChecksumHashCode.Checksum;
 import org.apache.flink.graph.library.clustering.undirected.LocalClusteringCoefficient.Result;
 import org.apache.flink.test.util.TestBaseUtils;
+import org.apache.flink.types.CopyableValue;
 import org.apache.flink.types.IntValue;
 import org.apache.flink.types.LongValue;
+import org.apache.flink.types.NullValue;
 
 import org.apache.commons.math3.util.CombinatoricsUtils;
 import org.junit.Test;
@@ -37,12 +40,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link LocalClusteringCoefficient}.
  */
-public class LocalClusteringCoefficientTest
-extends AsmTestBase {
+public class LocalClusteringCoefficientTest extends AsmTestBase {
 
 	@Test
-	public void testSimpleGraph()
-			throws Exception {
+	public void testSimpleGraph() throws Exception {
 		String expectedResult =
 			"(0,2,1)\n" +
 			"(1,3,2)\n" +
@@ -57,28 +58,51 @@ extends AsmTestBase {
 		TestBaseUtils.compareResultAsText(cc.collect(), expectedResult);
 	}
 
-	@Test
-	public void testCompleteGraph()
-			throws Exception {
-		long expectedDegree = completeGraphVertexCount - 1;
-		long expectedTriangleCount = CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2);
-
-		DataSet<Result<LongValue>> cc = completeGraph
+	/**
+	 * Validate a test where each result has the same values.
+	 *
+	 * @param graph input graph
+	 * @param count number of results
+	 * @param degree result degree
+	 * @param triangleCount result triangle count
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends Comparable<T> & CopyableValue<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, long count, long degree, long triangleCount) throws Exception {
+		DataSet<Result<T>> cc = graph
 			.run(new LocalClusteringCoefficient<>());
 
-		List<Result<LongValue>> results = cc.collect();
+		List<Result<T>> results = cc.collect();
 
-		assertEquals(completeGraphVertexCount, results.size());
+		assertEquals(count, results.size());
 
-		for (Result<LongValue> result : results) {
-			assertEquals(expectedDegree, result.getDegree().getValue());
-			assertEquals(expectedTriangleCount, result.getTriangleCount().getValue());
+		for (Result<T> result : results) {
+			assertEquals(degree, result.getDegree().getValue());
+			assertEquals(triangleCount, result.getTriangleCount().getValue());
 		}
 	}
 
 	@Test
-	public void testRMatGraph()
-			throws Exception {
+	public void testCompleteGraph() throws Exception {
+		long degree = completeGraphVertexCount - 1;
+		long triangleCount = CombinatoricsUtils.binomialCoefficient((int) degree, 2);
+
+		validate(completeGraph, completeGraphVertexCount, degree, triangleCount);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, emptyGraphVertexCount, 0, 0);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, 0, 0, 0);
+	}
+
+	@Test
+	public void testRMatGraph() throws Exception {
 		DataSet<Result<LongValue>> cc = undirectedRMatGraph(10, 16)
 			.run(new LocalClusteringCoefficient<>());
 
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/TriadicCensusTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/TriadicCensusTest.java
index 38cf9812eb9..bed32350c9f 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/TriadicCensusTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/TriadicCensusTest.java
@@ -32,12 +32,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link TriadicCensus}.
  */
-public class TriadicCensusTest
-extends AsmTestBase {
+public class TriadicCensusTest extends AsmTestBase {
 
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		Result expectedResult = new Result(3, 8, 7, 2);
 
 		Result triadCensus = new TriadicCensus<IntValue, NullValue, NullValue>()
@@ -48,8 +46,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
 		long expectedDegree = completeGraphVertexCount - 1;
 		long expectedCount = completeGraphVertexCount * CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2) / 3;
 
@@ -63,12 +60,22 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
 		Result expectedResult = new Result(0, 0, 0, 0);
 
 		Result triadCensus = new TriadicCensus<LongValue, NullValue, NullValue>()
-			.run(emptyGraph)
+			.run(emptyGraphWithVertices)
+			.execute();
+
+		assertEquals(expectedResult, triadCensus);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		Result expectedResult = new Result(0, 0, 0, 0);
+
+		Result triadCensus = new TriadicCensus<LongValue, NullValue, NullValue>()
+			.run(emptyGraphWithoutVertices)
 			.execute();
 
 		assertEquals(expectedResult, triadCensus);
@@ -85,8 +92,7 @@ extends AsmTestBase {
 		print('{}: {}'.format(key, census[key]))
 	 */
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithRMatGraph() throws Exception {
 		Result expectedResult = new Result(113_435_893, 7_616_063, 778_295, 75_049);
 
 		Result triadCensus = new TriadicCensus<LongValue, NullValue, NullValue>()
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/TriangleListingTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/TriangleListingTest.java
index 2e34945b58f..73ffee0d13f 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/TriangleListingTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/clustering/undirected/TriangleListingTest.java
@@ -39,12 +39,10 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link TriangleListing}.
  */
-public class TriangleListingTest
-extends AsmTestBase {
+public class TriangleListingTest extends AsmTestBase {
 
 	@Test
-	public void testSimpleGraphSorted()
-			throws Exception {
+	public void testSimpleGraphSorted() throws Exception {
 		DataSet<Result<IntValue>> tl = undirectedSimpleGraph
 			.run(new TriangleListing<IntValue, NullValue, NullValue>()
 				.setSortTriangleVertices(true));
@@ -57,8 +55,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testSimpleGraphPermuted()
-			throws Exception {
+	public void testSimpleGraphPermuted() throws Exception {
 		DataSet<Result<IntValue>> tl = undirectedSimpleGraph
 			.run(new TriangleListing<IntValue, NullValue, NullValue>()
 				.setPermuteResults(true));
@@ -89,8 +86,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testCompleteGraph()
-			throws Exception {
+	public void testCompleteGraph() throws Exception {
 		long expectedDegree = completeGraphVertexCount - 1;
 		long expectedCount = completeGraphVertexCount * CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2) / 3;
 
@@ -105,8 +101,23 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testRMatGraph()
-			throws Exception {
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		DataSet<Result<LongValue>> tl = emptyGraphWithVertices
+			.run(new TriangleListing<>());
+
+		assertEquals(0, tl.collect().size());
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		DataSet<Result<LongValue>> tl = emptyGraphWithoutVertices
+			.run(new TriangleListing<>());
+
+		assertEquals(0, tl.collect().size());
+	}
+
+	@Test
+	public void testRMatGraph() throws Exception {
 		DataSet<Result<LongValue>> tl = undirectedRMatGraph(10, 16)
 			.run(new TriangleListing<LongValue, NullValue, NullValue>()
 				.setSortTriangleVertices(true));
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/linkanalysis/HITSTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/linkanalysis/HITSTest.java
index 2c942605bdf..29d77d2bd9a 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/linkanalysis/HITSTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/linkanalysis/HITSTest.java
@@ -20,6 +20,7 @@ package org.apache.flink.graph.library.linkanalysis;
 
 import org.apache.flink.api.java.DataSet;
 import org.apache.flink.api.java.tuple.Tuple2;
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.asm.dataset.Collect;
 import org.apache.flink.graph.library.linkanalysis.HITS.Result;
@@ -39,8 +40,7 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link HITS}.
  */
-public class HITSTest
-extends AsmTestBase {
+public class HITSTest extends AsmTestBase {
 
 	/*
 	 * This test result can be verified with the following Python script.
@@ -49,7 +49,7 @@ extends AsmTestBase {
 	import networkx as nx
 
 	graph=nx.read_edgelist('directedSimpleGraph.csv', delimiter=',', create_using=nx.DiGraph())
-	hits=nx.algorithms.link_analysis.hits(graph)
+	hits=nx.algorithms.link_analysis.hits(graph, tol=0.000001)
 
 	hubbiness_norm=math.sqrt(sum(v*v for v in hits[0].values()))
 	authority_norm=math.sqrt(sum(v*v for v in hits[1].values()))
@@ -58,44 +58,66 @@ extends AsmTestBase {
 		print('{}: {}, {}'.format(key, hits[0][key]/hubbiness_norm, hits[1][key]/authority_norm))
 	 */
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		DataSet<Result<IntValue>> hits = new HITS<IntValue, NullValue, NullValue>(20)
 			.run(directedSimpleGraph);
 
 		List<Tuple2<Double, Double>> expectedResults = new ArrayList<>();
-		expectedResults.add(Tuple2.of(0.544643396306, 0.0));
-		expectedResults.add(Tuple2.of(0.0, 0.836329395866));
-		expectedResults.add(Tuple2.of(0.607227031134, 0.268492526138));
-		expectedResults.add(Tuple2.of(0.544643396306, 0.395444899355));
-		expectedResults.add(Tuple2.of(0.0, 0.268492526138));
-		expectedResults.add(Tuple2.of(0.194942233447, 0.0));
+		expectedResults.add(Tuple2.of(0.54464336064, 0.0));
+		expectedResults.add(Tuple2.of(0.0, 0.836329364957));
+		expectedResults.add(Tuple2.of(0.607227075863, 0.268492484699));
+		expectedResults.add(Tuple2.of(0.54464336064, 0.395445020996));
+		expectedResults.add(Tuple2.of(0.0, 0.268492484699));
+		expectedResults.add(Tuple2.of(0.194942293412, 0.0));
 
 		for (Result<IntValue> result : hits.collect()) {
 			int id = result.getVertexId0().getValue();
-			assertEquals(expectedResults.get(id).f0, result.getHubScore().getValue(), 0.000001);
-			assertEquals(expectedResults.get(id).f1, result.getAuthorityScore().getValue(), 0.000001);
+			assertEquals(expectedResults.get(id).f0, result.getHubScore().getValue(), ACCURACY);
+			assertEquals(expectedResults.get(id).f1, result.getAuthorityScore().getValue(), ACCURACY);
 		}
 	}
 
-	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
-		double expectedScore = 1.0 / Math.sqrt(completeGraphVertexCount);
-
-		DataSet<Result<LongValue>> hits = new HITS<LongValue, NullValue, NullValue>(0.000001)
-			.run(completeGraph);
+	/**
+	 * Validate a test where each result has the same values.
+	 *
+	 * @param graph input graph
+	 * @param count number of results
+	 * @param score result hub and authority score
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T> void validate(Graph<T, NullValue, NullValue> graph, long count, double score) throws Exception {
+		DataSet<Result<T>> hits = new HITS<T, NullValue, NullValue>(ACCURACY)
+			.run(graph);
 
-		List<Result<LongValue>> results = hits.collect();
+		List<Result<T>> results = hits.collect();
 
-		assertEquals(completeGraphVertexCount, results.size());
+		assertEquals(count, results.size());
 
-		for (Result<LongValue> result : results) {
-			assertEquals(expectedScore, result.getHubScore().getValue(), 0.000001);
-			assertEquals(expectedScore, result.getAuthorityScore().getValue(), 0.000001);
+		for (Result<T> result : results) {
+			assertEquals(score, result.getHubScore().getValue(), ACCURACY);
+			assertEquals(score, result.getAuthorityScore().getValue(), ACCURACY);
 		}
 	}
 
+	@Test
+	public void testWithCompleteGraph() throws Exception {
+		validate(completeGraph, completeGraphVertexCount, 1.0 / Math.sqrt(completeGraphVertexCount));
+	}
+
+	@Test
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		// the HITS implementation does not currently produce scores for
+		// 0-degree vertices as this exclusion does not affect the scores of
+		// other vertices in the graph
+		validate(emptyGraphWithVertices, 0, Double.NaN);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, 0, Double.NaN);
+	}
+
 	/*
 	 * This test result can be verified with the following Python script.
 
@@ -103,7 +125,7 @@ extends AsmTestBase {
 	import networkx as nx
 
 	graph=nx.read_edgelist('directedRMatGraph.csv', delimiter=',', create_using=nx.DiGraph())
-	hits=nx.algorithms.link_analysis.hits(graph)
+	hits=nx.algorithms.link_analysis.hits(graph, tol=0.000001)
 
 	hubbiness_norm=math.sqrt(sum(v*v for v in hits[0].values()))
 	authority_norm=math.sqrt(sum(v*v for v in hits[1].values()))
@@ -112,10 +134,9 @@ extends AsmTestBase {
 		print('{}: {}, {}'.format(key, hits[0][str(key)]/hubbiness_norm, hits[1][str(key)]/authority_norm))
 	 */
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Result<LongValue>> hits = directedRMatGraph(10, 16)
-			.run(new HITS<>(0.000001));
+			.run(new HITS<>(ACCURACY));
 
 		Map<Long, Result<LongValue>> results = new HashMap<>();
 		for (Result<LongValue> result :  new Collect<Result<LongValue>>().run(hits).execute()) {
@@ -126,23 +147,23 @@ extends AsmTestBase {
 
 		Map<Long, Tuple2<Double, Double>> expectedResults = new HashMap<>();
 		// a pseudo-random selection of results, both high and low
-		expectedResults.put(0L, Tuple2.of(0.231077034747, 0.238110214937));
-		expectedResults.put(1L, Tuple2.of(0.162364053933, 0.169679504287));
-		expectedResults.put(2L, Tuple2.of(0.162412612499, 0.161015667261));
-		expectedResults.put(8L, Tuple2.of(0.167064641724, 0.158592966505));
-		expectedResults.put(13L, Tuple2.of(0.041915595624, 0.0407091625629));
-		expectedResults.put(29L, Tuple2.of(0.0102017346511, 0.0146218045999));
-		expectedResults.put(109L, Tuple2.of(0.00190531000389, 0.00481944993023));
-		expectedResults.put(394L, Tuple2.of(0.0122287016161, 0.0147987969538));
-		expectedResults.put(652L, Tuple2.of(0.010966659242, 0.0113713306749));
-		expectedResults.put(1020L, Tuple2.of(0.0, 0.000326973732127));
+		expectedResults.put(0L, Tuple2.of(0.231077034503, 0.238110215657));
+		expectedResults.put(1L, Tuple2.of(0.162364053853, 0.169679504542));
+		expectedResults.put(2L, Tuple2.of(0.162412612418, 0.161015667467));
+		expectedResults.put(8L, Tuple2.of(0.167064641648, 0.158592966732));
+		expectedResults.put(13L, Tuple2.of(0.0419155956364, 0.0407091624972));
+		expectedResults.put(29L, Tuple2.of(0.0102017346609, 0.0146218045619));
+		expectedResults.put(109L, Tuple2.of(0.00190531000308, 0.00481944991974));
+		expectedResults.put(394L, Tuple2.of(0.0122287016151, 0.0147987969383));
+		expectedResults.put(652L, Tuple2.of(0.0109666592418, 0.0113713306828));
+		expectedResults.put(1020L, Tuple2.of(0.0, 0.000326973733252));
 
 		for (Map.Entry<Long, Tuple2<Double, Double>> expected : expectedResults.entrySet()) {
 			double hubScore = results.get(expected.getKey()).getHubScore().getValue();
 			double authorityScore = results.get(expected.getKey()).getAuthorityScore().getValue();
 
-			assertEquals(expected.getValue().f0, hubScore, 0.00001);
-			assertEquals(expected.getValue().f1, authorityScore, 0.00001);
+			assertEquals(expected.getValue().f0, hubScore, ACCURACY);
+			assertEquals(expected.getValue().f1, authorityScore, ACCURACY);
 		}
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/linkanalysis/PageRankTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/linkanalysis/PageRankTest.java
index 64234d16cc8..10aa6017185 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/linkanalysis/PageRankTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/linkanalysis/PageRankTest.java
@@ -19,6 +19,7 @@
 package org.apache.flink.graph.library.linkanalysis;
 
 import org.apache.flink.api.java.DataSet;
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.asm.dataset.Collect;
 import org.apache.flink.graph.library.linkanalysis.PageRank.Result;
@@ -38,8 +39,7 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link PageRank}.
  */
-public class PageRankTest
-extends AsmTestBase {
+public class PageRankTest extends AsmTestBase {
 
 	private static final double DAMPING_FACTOR = 0.85;
 
@@ -49,63 +49,82 @@ extends AsmTestBase {
 	import networkx as nx
 
 	graph=nx.read_edgelist('directedSimpleGraph.csv', delimiter=',', create_using=nx.DiGraph())
-	pagerank=nx.algorithms.link_analysis.pagerank(graph)
+	pagerank=nx.algorithms.link_analysis.pagerank(graph, tol=0.000001)
 
 	for key in sorted(pagerank):
 		print('{}: {}'.format(key, pagerank[key]))
 	 */
 	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
-		DataSet<Result<IntValue>> pr = new PageRank<IntValue, NullValue, NullValue>(DAMPING_FACTOR, 10)
+	public void testWithSimpleGraph() throws Exception {
+		DataSet<Result<IntValue>> pr = new PageRank<IntValue, NullValue, NullValue>(DAMPING_FACTOR, 20)
 			.run(directedSimpleGraph);
 
 		List<Double> expectedResults = new ArrayList<>();
-		expectedResults.add(0.09091296131286301);
-		expectedResults.add(0.27951855944178117);
-		expectedResults.add(0.12956847924535586);
-		expectedResults.add(0.22329643739217675);
-		expectedResults.add(0.18579060129496028);
-		expectedResults.add(0.09091296131286301);
+		expectedResults.add(0.0909212166211);
+		expectedResults.add(0.279516064311);
+		expectedResults.add(0.129562719068);
+		expectedResults.add(0.223268406353);
+		expectedResults.add(0.185810377026);
+		expectedResults.add(0.0909212166211);
 
 		for (Result<IntValue> result : pr.collect()) {
 			int id = result.getVertexId0().getValue();
-			assertEquals(expectedResults.get(id), result.getPageRankScore().getValue(), 0.000001);
+			assertEquals(expectedResults.get(id), result.getPageRankScore().getValue(), ACCURACY);
 		}
 	}
 
-	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
-		double expectedScore = 1.0 / completeGraphVertexCount;
-
-		DataSet<Result<LongValue>> pr = new PageRank<LongValue, NullValue, NullValue>(DAMPING_FACTOR, 0.000001)
-			.run(completeGraph);
+	/**
+	 * Validate a test where each result has the same values.
+	 *
+	 * @param graph input graph
+	 * @param count number of results
+	 * @param score result PageRank score
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T> void validate(Graph<T, NullValue, NullValue> graph, long count, double score) throws Exception {
+		DataSet<Result<T>> pr = new PageRank<T, NullValue, NullValue>(DAMPING_FACTOR, ACCURACY)
+			.setIncludeZeroDegreeVertices(true)
+			.run(graph);
 
-		List<Result<LongValue>> results = pr.collect();
+		List<Result<T>> results = pr.collect();
 
-		assertEquals(completeGraphVertexCount, results.size());
+		assertEquals(count, results.size());
 
-		for (Result<LongValue> result : results) {
-			assertEquals(expectedScore, result.getPageRankScore().getValue(), 0.000001);
+		for (Result<T> result : results) {
+			assertEquals(score, result.getPageRankScore().getValue(), ACCURACY);
 		}
 	}
 
+	@Test
+	public void testWithCompleteGraph() throws Exception {
+		validate(completeGraph, completeGraphVertexCount, 1.0 / completeGraphVertexCount);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, emptyGraphVertexCount, 1.0 / emptyGraphVertexCount);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, 0, Double.NaN);
+	}
+
 	/*
 	 * This test result can be verified with the following Python script.
 
 	import networkx as nx
 
 	graph=nx.read_edgelist('directedRMatGraph.csv', delimiter=',', create_using=nx.DiGraph())
-	pagerank=nx.algorithms.link_analysis.pagerank(graph)
+	pagerank=nx.algorithms.link_analysis.pagerank(graph, tol=0.000001)
 
 	for key in [0, 1, 2, 8, 13, 29, 109, 394, 652, 1020]:
 		print('{}: {}'.format(key, pagerank[str(key)]))
 	 */
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
-		DataSet<Result<LongValue>> pr = new PageRank<LongValue, NullValue, NullValue>(DAMPING_FACTOR, 0.000001)
+	public void testWithRMatGraph() throws Exception {
+		DataSet<Result<LongValue>> pr = new PageRank<LongValue, NullValue, NullValue>(DAMPING_FACTOR, ACCURACY)
 			.run(directedRMatGraph(10, 16));
 
 		Map<Long, Result<LongValue>> results = new HashMap<>();
@@ -117,21 +136,21 @@ extends AsmTestBase {
 
 		Map<Long, Double> expectedResults = new HashMap<>();
 		// a pseudo-random selection of results, both high and low
-		expectedResults.put(0L, 0.027111807822);
-		expectedResults.put(1L, 0.0132842310382);
-		expectedResults.put(2L, 0.0121818392504);
-		expectedResults.put(8L, 0.0115916809743);
-		expectedResults.put(13L, 0.00183249490033);
-		expectedResults.put(29L, 0.000848095047082);
-		expectedResults.put(109L, 0.000308507844048);
-		expectedResults.put(394L, 0.000828743280246);
-		expectedResults.put(652L, 0.000684102931253);
-		expectedResults.put(1020L, 0.000250487135148);
+		expectedResults.put(0L, 0.0271152394743);
+		expectedResults.put(1L, 0.0132848430616);
+		expectedResults.put(2L, 0.0121819700294);
+		expectedResults.put(8L, 0.0115923214664);
+		expectedResults.put(13L, 0.00183241122822);
+		expectedResults.put(29L, 0.000848190646547);
+		expectedResults.put(109L, 0.00030846825644);
+		expectedResults.put(394L, 0.000828826945546);
+		expectedResults.put(652L, 0.000683948671035);
+		expectedResults.put(1020L, 0.000250442325034);
 
 		for (Map.Entry<Long, Double> expected : expectedResults.entrySet()) {
 			double value = results.get(expected.getKey()).getPageRankScore().getValue();
 
-			assertEquals(expected.getValue(), value, 0.00001);
+			assertEquals(expected.getValue(), value, ACCURACY);
 		}
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/ChecksumHashCodeTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/ChecksumHashCodeTest.java
index 4deb491d85b..4e073e0e6b0 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/ChecksumHashCodeTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/ChecksumHashCodeTest.java
@@ -30,8 +30,7 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link ChecksumHashCode}.
  */
-public class ChecksumHashCodeTest
-extends AsmTestBase {
+public class ChecksumHashCodeTest extends AsmTestBase {
 
 	@Test
 	public void testSmallGraph() throws Exception {
@@ -44,7 +43,27 @@ extends AsmTestBase {
 			.run(new ChecksumHashCode<>())
 			.execute();
 
-		assertEquals(checksum.getCount(), 12L);
-		assertEquals(checksum.getChecksum(), 19665L);
+		assertEquals(12, checksum.getCount());
+		assertEquals(0x4cd1, checksum.getChecksum());
+	}
+
+	@Test
+	public void testEmptyGraphWithVertices() throws Exception {
+		Checksum checksum = emptyGraphWithVertices
+			.run(new ChecksumHashCode<>())
+			.execute();
+
+		assertEquals(3, checksum.getCount());
+		assertEquals(0x109b, checksum.getChecksum());
+	}
+
+	@Test
+	public void testEmptyGraphWithoutVertices() throws Exception {
+		Checksum checksum = emptyGraphWithoutVertices
+			.run(new ChecksumHashCode<>())
+			.execute();
+
+		assertEquals(0, checksum.getCount());
+		assertEquals(0, checksum.getChecksum());
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/directed/EdgeMetricsTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/directed/EdgeMetricsTest.java
index 05042c259b3..9dc9a6cff80 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/directed/EdgeMetricsTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/directed/EdgeMetricsTest.java
@@ -18,10 +18,9 @@
 
 package org.apache.flink.graph.library.metric.directed;
 
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.library.metric.directed.EdgeMetrics.Result;
-import org.apache.flink.types.IntValue;
-import org.apache.flink.types.LongValue;
 import org.apache.flink.types.NullValue;
 
 import org.apache.commons.math3.util.CombinatoricsUtils;
@@ -32,24 +31,32 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link EdgeMetrics}.
  */
-public class EdgeMetricsTest
-extends AsmTestBase {
-
-	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
-		Result expectedResult = new Result(2, 6, 1, 3);
-
-		Result edgeMetrics = new EdgeMetrics<IntValue, NullValue, NullValue>()
-			.run(directedSimpleGraph)
+public class EdgeMetricsTest extends AsmTestBase {
+
+	/**
+	 * Validate a test result.
+	 *
+	 * @param graph input graph
+	 * @param result expected {@link Result}
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends Comparable<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, Result result) throws Exception {
+		Result edgeMetrics = new EdgeMetrics<T, NullValue, NullValue>()
+			.run(graph)
 			.execute();
 
-		assertEquals(expectedResult, edgeMetrics);
+		assertEquals(result, edgeMetrics);
+	}
+
+	@Test
+	public void testWithSimpleGraph() throws Exception {
+		validate(directedSimpleGraph, new Result(2, 6, 1, 3));
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
 		long expectedDegree = completeGraphVertexCount - 1;
 		long expectedMaximumTriplets = CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2);
 		long expectedTriplets = completeGraphVertexCount * expectedMaximumTriplets;
@@ -57,36 +64,21 @@ extends AsmTestBase {
 		Result expectedResult = new Result(expectedTriplets / 3, 2 * expectedTriplets / 3,
 			expectedMaximumTriplets, expectedMaximumTriplets);
 
-		Result edgeMetrics = new EdgeMetrics<LongValue, NullValue, NullValue>()
-			.run(completeGraph)
-			.execute();
-
-		assertEquals(expectedResult, edgeMetrics);
+		validate(completeGraph, expectedResult);
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		Result expectedResult;
-
-		expectedResult = new Result(0, 0, 0, 0);
-
-		Result withoutZeroDegreeVertices = new EdgeMetrics<LongValue, NullValue, NullValue>()
-			.run(emptyGraph)
-			.execute();
-
-		assertEquals(withoutZeroDegreeVertices, expectedResult);
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, new Result(0, 0, 0, 0));
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
-		Result expectedResult = new Result(107817, 315537, 820, 3822);
-
-		Result withoutZeroDegreeVertices = new EdgeMetrics<LongValue, NullValue, NullValue>()
-			.run(directedRMatGraph(10, 16))
-			.execute();
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, new Result(0, 0, 0, 0));
+	}
 
-		assertEquals(expectedResult, withoutZeroDegreeVertices);
+	@Test
+	public void testWithRMatGraph() throws Exception {
+		validate(directedRMatGraph(10, 16), new Result(107817, 315537, 820, 3822));
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/directed/VertexMetricsTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/directed/VertexMetricsTest.java
index f72a7bb5015..e237832fc71 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/directed/VertexMetricsTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/directed/VertexMetricsTest.java
@@ -18,10 +18,9 @@
 
 package org.apache.flink.graph.library.metric.directed;
 
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.library.metric.directed.VertexMetrics.Result;
-import org.apache.flink.types.IntValue;
-import org.apache.flink.types.LongValue;
 import org.apache.flink.types.NullValue;
 
 import org.apache.commons.math3.util.CombinatoricsUtils;
@@ -32,24 +31,39 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link VertexMetrics}.
  */
-public class VertexMetricsTest
-extends AsmTestBase {
-
-	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
-		Result expectedResult = new Result(6, 7, 0, 13, 4, 2, 3, 6);
-
-		Result vertexMetrics = new VertexMetrics<IntValue, NullValue, NullValue>()
-			.run(directedSimpleGraph)
+public class VertexMetricsTest extends AsmTestBase {
+
+	/**
+	 * Validate a test result.
+	 *
+	 * @param graph input graph
+	 * @param includeZeroDegreeVertices whether to include zero-degree vertices
+	 * @param result expected {@link Result}
+	 * @param averageDegree result average degree
+	 * @param density result density
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends Comparable<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, boolean includeZeroDegreeVertices,
+			Result result, float averageDegree, float density) throws Exception {
+		Result vertexMetrics = new VertexMetrics<T, NullValue, NullValue>()
+			.setIncludeZeroDegreeVertices(includeZeroDegreeVertices)
+			.run(graph)
 			.execute();
 
-		assertEquals(expectedResult, vertexMetrics);
+		assertEquals(result, vertexMetrics);
+		assertEquals(averageDegree, vertexMetrics.getAverageDegree(), ACCURACY);
+		assertEquals(density, vertexMetrics.getDensity(), ACCURACY);
+	}
+
+	@Test
+	public void testWithSimpleGraph() throws Exception {
+		validate(directedSimpleGraph, false, new Result(6, 7, 0, 13, 4, 2, 3, 6), 7f / 6, 7f / 30);
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
 		long expectedDegree = completeGraphVertexCount - 1;
 		long expectedBidirectionalEdges = completeGraphVertexCount * expectedDegree / 2;
 		long expectedMaximumTriplets = CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2);
@@ -58,52 +72,25 @@ extends AsmTestBase {
 		Result expectedResult = new Result(completeGraphVertexCount, 0, expectedBidirectionalEdges,
 			expectedTriplets, expectedDegree, expectedDegree, expectedDegree, expectedMaximumTriplets);
 
-		Result vertexMetrics = new VertexMetrics<LongValue, NullValue, NullValue>()
-			.run(completeGraph)
-			.execute();
-
-		assertEquals(expectedResult, vertexMetrics);
-		assertEquals(expectedDegree, vertexMetrics.getAverageDegree(), ACCURACY);
-		assertEquals(1.0f, vertexMetrics.getDensity(), ACCURACY);
+		validate(completeGraph, false, expectedResult, expectedDegree, 1.0f);
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		Result expectedResult;
-
-		expectedResult = new Result(0, 0, 0, 0, 0, 0, 0, 0);
-
-		Result withoutZeroDegreeVertices = new VertexMetrics<LongValue, NullValue, NullValue>()
-			.setIncludeZeroDegreeVertices(false)
-			.run(emptyGraph)
-			.execute();
-
-		assertEquals(expectedResult, withoutZeroDegreeVertices);
-		assertEquals(Float.NaN, withoutZeroDegreeVertices.getAverageDegree(), ACCURACY);
-		assertEquals(Float.NaN, withoutZeroDegreeVertices.getDensity(), ACCURACY);
-
-		expectedResult = new Result(3, 0, 0, 0, 0, 0, 0, 0);
-
-		Result withZeroDegreeVertices = new VertexMetrics<LongValue, NullValue, NullValue>()
-			.setIncludeZeroDegreeVertices(true)
-			.run(emptyGraph)
-			.execute();
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, false, new Result(0, 0, 0, 0, 0, 0, 0, 0), Float.NaN, Float.NaN);
+		validate(emptyGraphWithVertices, true, new Result(3, 0, 0, 0, 0, 0, 0, 0), 0.0f, 0.0f);
+	}
 
-		assertEquals(expectedResult, withZeroDegreeVertices);
-		assertEquals(0.0f, withZeroDegreeVertices.getAverageDegree(), ACCURACY);
-		assertEquals(0.0f, withZeroDegreeVertices.getDensity(), ACCURACY);
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		Result expectedResult =  new Result(0, 0, 0, 0, 0, 0, 0, 0);
+		validate(emptyGraphWithoutVertices, false, expectedResult, Float.NaN, Float.NaN);
+		validate(emptyGraphWithoutVertices, true, expectedResult, Float.NaN, Float.NaN);
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithRMatGraph() throws Exception {
 		Result expectedResult = new Result(902, 8875, 1567, 1003442, 463, 334, 342, 106953);
-
-		Result withoutZeroDegreeVertices = new VertexMetrics<LongValue, NullValue, NullValue>()
-			.run(directedRMatGraph(10, 16))
-			.execute();
-
-		assertEquals(expectedResult, withoutZeroDegreeVertices);
+		validate(directedRMatGraph(10, 16), false, expectedResult, 13.3137472f, 0.0147766f);
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/undirected/EdgeMetricsTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/undirected/EdgeMetricsTest.java
index 3e23906f8a6..ae97c60a288 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/undirected/EdgeMetricsTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/undirected/EdgeMetricsTest.java
@@ -18,10 +18,9 @@
 
 package org.apache.flink.graph.library.metric.undirected;
 
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.library.metric.undirected.EdgeMetrics.Result;
-import org.apache.flink.types.IntValue;
-import org.apache.flink.types.LongValue;
 import org.apache.flink.types.NullValue;
 
 import org.apache.commons.math3.util.CombinatoricsUtils;
@@ -32,24 +31,32 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link EdgeMetrics}.
  */
-public class EdgeMetricsTest
-extends AsmTestBase {
-
-	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
-		Result expectedResult = new Result(2, 6, 1, 3);
-
-		Result edgeMetrics = new EdgeMetrics<IntValue, NullValue, NullValue>()
-			.run(undirectedSimpleGraph)
+public class EdgeMetricsTest extends AsmTestBase {
+
+	/**
+	 * Validate a test result.
+	 *
+	 * @param graph input graph
+	 * @param result expected {@link Result}
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends Comparable<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, Result result) throws Exception {
+		Result edgeMetrics = new EdgeMetrics<T, NullValue, NullValue>()
+			.run(graph)
 			.execute();
 
-		assertEquals(expectedResult, edgeMetrics);
+		assertEquals(result, edgeMetrics);
+	}
+
+	@Test
+	public void testWithSimpleGraph() throws Exception {
+		validate(undirectedSimpleGraph, new Result(2, 6, 1, 3));
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
 		long expectedDegree = completeGraphVertexCount - 1;
 		long expectedMaximumTriplets = CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2);
 		long expectedTriplets = completeGraphVertexCount * expectedMaximumTriplets;
@@ -57,36 +64,21 @@ extends AsmTestBase {
 		Result expectedResult = new Result(expectedTriplets / 3, 2 * expectedTriplets / 3,
 			expectedMaximumTriplets, expectedMaximumTriplets);
 
-		Result edgeMetrics = new EdgeMetrics<LongValue, NullValue, NullValue>()
-			.run(completeGraph)
-			.execute();
-
-		assertEquals(expectedResult, edgeMetrics);
+		validate(completeGraph, expectedResult);
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		Result expectedResult;
-
-		expectedResult = new Result(0, 0, 0, 0);
-
-		Result withoutZeroDegreeVertices = new EdgeMetrics<LongValue, NullValue, NullValue>()
-			.run(emptyGraph)
-			.execute();
-
-		assertEquals(withoutZeroDegreeVertices, expectedResult);
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, new Result(0, 0, 0, 0));
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
-		Result expectedResult = new Result(107817, 315537, 820, 3822);
-
-		Result withoutZeroDegreeVertices = new EdgeMetrics<LongValue, NullValue, NullValue>()
-			.run(undirectedRMatGraph(10, 16))
-			.execute();
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, new Result(0, 0, 0, 0));
+	}
 
-		assertEquals(expectedResult, withoutZeroDegreeVertices);
+	@Test
+	public void testWithRMatGraph() throws Exception {
+		validate(undirectedRMatGraph(10, 16), new Result(107817, 315537, 820, 3822));
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/undirected/VertexMetricsTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/undirected/VertexMetricsTest.java
index 71e587bc757..d0d0a1caaa0 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/undirected/VertexMetricsTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/metric/undirected/VertexMetricsTest.java
@@ -18,10 +18,9 @@
 
 package org.apache.flink.graph.library.metric.undirected;
 
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.library.metric.undirected.VertexMetrics.Result;
-import org.apache.flink.types.IntValue;
-import org.apache.flink.types.LongValue;
 import org.apache.flink.types.NullValue;
 
 import org.apache.commons.math3.util.CombinatoricsUtils;
@@ -32,24 +31,39 @@ import static org.junit.Assert.assertEquals;
 /**
  * Tests for {@link VertexMetrics}.
  */
-public class VertexMetricsTest
-extends AsmTestBase {
-
-	@Test
-	public void testWithSimpleGraph()
-			throws Exception {
-		Result expectedResult = new Result(6, 7, 13, 4, 6);
-
-		Result vertexMetrics = new VertexMetrics<IntValue, NullValue, NullValue>()
-			.run(undirectedSimpleGraph)
+public class VertexMetricsTest extends AsmTestBase {
+
+	/**
+	 * Validate a test result.
+	 *
+	 * @param graph input graph
+	 * @param includeZeroDegreeVertices whether to include zero-degree vertices
+	 * @param result expected {@link Result}
+	 * @param averageDegree result average degree
+	 * @param density result density
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends Comparable<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, boolean includeZeroDegreeVertices,
+			Result result, float averageDegree, float density) throws Exception {
+		Result vertexMetrics = new VertexMetrics<T, NullValue, NullValue>()
+			.setIncludeZeroDegreeVertices(includeZeroDegreeVertices)
+			.run(graph)
 			.execute();
 
-		assertEquals(expectedResult, vertexMetrics);
+		assertEquals(result, vertexMetrics);
+		assertEquals(averageDegree, vertexMetrics.getAverageDegree(), ACCURACY);
+		assertEquals(density, vertexMetrics.getDensity(), ACCURACY);
+	}
+
+	@Test
+	public void testWithSimpleGraph() throws Exception {
+		validate(undirectedSimpleGraph, false, new Result(6, 7, 13, 4, 6), 14f / 6, 7f / 15);
 	}
 
 	@Test
-	public void testWithCompleteGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
 		long expectedDegree = completeGraphVertexCount - 1;
 		long expectedEdges = completeGraphVertexCount * expectedDegree / 2;
 		long expectedMaximumTriplets = CombinatoricsUtils.binomialCoefficient((int) expectedDegree, 2);
@@ -58,52 +72,25 @@ extends AsmTestBase {
 		Result expectedResult = new Result(completeGraphVertexCount, expectedEdges, expectedTriplets,
 			expectedDegree, expectedMaximumTriplets);
 
-		Result vertexMetrics = new VertexMetrics<LongValue, NullValue, NullValue>()
-			.run(completeGraph)
-			.execute();
-
-		assertEquals(expectedResult, vertexMetrics);
-		assertEquals(expectedDegree, vertexMetrics.getAverageDegree(), ACCURACY);
-		assertEquals(1.0f, vertexMetrics.getDensity(), ACCURACY);
+		validate(completeGraph, false, expectedResult, expectedDegree, 1.0f);
 	}
 
 	@Test
-	public void testWithEmptyGraph()
-			throws Exception {
-		Result expectedResult;
-
-		expectedResult = new Result(0, 0, 0, 0, 0);
-
-		Result withoutZeroDegreeVertices = new VertexMetrics<LongValue, NullValue, NullValue>()
-			.setIncludeZeroDegreeVertices(false)
-			.run(emptyGraph)
-			.execute();
-
-		assertEquals(expectedResult, withoutZeroDegreeVertices);
-		assertEquals(Float.NaN, withoutZeroDegreeVertices.getAverageDegree(), ACCURACY);
-		assertEquals(Float.NaN, withoutZeroDegreeVertices.getDensity(), ACCURACY);
-
-		expectedResult = new Result(3, 0, 0, 0, 0);
-
-		Result withZeroDegreeVertices = new VertexMetrics<LongValue, NullValue, NullValue>()
-			.setIncludeZeroDegreeVertices(true)
-			.run(emptyGraph)
-			.execute();
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, false, new Result(0, 0, 0, 0, 0), Float.NaN, Float.NaN);
+		validate(emptyGraphWithVertices, true, new Result(3, 0, 0, 0, 0), 0.0f, 0.0f);
+	}
 
-		assertEquals(expectedResult, withZeroDegreeVertices);
-		assertEquals(0.0f, withZeroDegreeVertices.getAverageDegree(), ACCURACY);
-		assertEquals(0.0f, withZeroDegreeVertices.getDensity(), ACCURACY);
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		Result expectedResult =  new Result(0, 0, 0, 0, 0);
+		validate(emptyGraphWithoutVertices, false, expectedResult, Float.NaN, Float.NaN);
+		validate(emptyGraphWithoutVertices, true, expectedResult, Float.NaN, Float.NaN);
 	}
 
 	@Test
-	public void testWithRMatGraph()
-			throws Exception {
+	public void testWithRMatGraph() throws Exception {
 		Result expectedResult = new Result(902, 10442, 1003442, 463, 106953);
-
-		Result withoutZeroDegreeVertices = new VertexMetrics<LongValue, NullValue, NullValue>()
-			.run(undirectedRMatGraph(10, 16))
-			.execute();
-
-		assertEquals(expectedResult, withoutZeroDegreeVertices);
+		validate(undirectedRMatGraph(10, 16), false, expectedResult, 23.1529933f, 0.0256969f);
 	}
 }
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/similarity/AdamicAdarTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/similarity/AdamicAdarTest.java
index 5afd0ee796d..ef5e863ca78 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/similarity/AdamicAdarTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/similarity/AdamicAdarTest.java
@@ -19,22 +19,26 @@
 package org.apache.flink.graph.library.similarity;
 
 import org.apache.flink.api.java.DataSet;
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.library.similarity.AdamicAdar.Result;
 import org.apache.flink.test.util.TestBaseUtils;
+import org.apache.flink.types.CopyableValue;
 import org.apache.flink.types.IntValue;
 import org.apache.flink.types.LongValue;
 import org.apache.flink.types.NullValue;
 
+import org.apache.commons.math3.util.CombinatoricsUtils;
 import org.junit.Test;
 
+import java.util.List;
+
 import static org.junit.Assert.assertEquals;
 
 /**
  * Tests for {@link AdamicAdar}.
  */
-public class AdamicAdarTest
-extends AsmTestBase {
+public class AdamicAdarTest extends AsmTestBase {
 
 	private float[] ilog = {
 		1.0f / (float) Math.log(2),
@@ -46,8 +50,7 @@ extends AsmTestBase {
 	};
 
 	@Test
-	public void testSimpleGraph()
-			throws Exception {
+	public void testWithSimpleGraph() throws Exception {
 		DataSet<Result<IntValue>> aa = undirectedSimpleGraph
 			.run(new AdamicAdar<>());
 
@@ -68,8 +71,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testSimpleGraphWithMinimumScore()
-			throws Exception {
+	public void testWithSimpleGraphWithMinimumScore() throws Exception {
 		DataSet<Result<IntValue>> aa = undirectedSimpleGraph
 			.run(new AdamicAdar<IntValue, NullValue, NullValue>()
 				.setMinimumScore(0.75f));
@@ -86,8 +88,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testSimpleGraphWithMinimumRatio()
-			throws Exception {
+	public void testWithSimpleGraphWithMinimumRatio() throws Exception {
 		DataSet<Result<IntValue>> aa = undirectedSimpleGraph
 			.run(new AdamicAdar<IntValue, NullValue, NullValue>()
 				.setMinimumRatio(1.5f));
@@ -99,22 +100,63 @@ extends AsmTestBase {
 		TestBaseUtils.compareResultAsText(aa.collect(), expectedResult);
 	}
 
+	/**
+	 * Validate a test where each result has the same values.
+	 *
+	 * @param graph input graph
+	 * @param count number of results
+	 * @param score result score
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends CopyableValue<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, long count, double score) throws Exception {
+		DataSet<Result<T>> aa = graph
+			.run(new AdamicAdar<>());
+
+		List<Result<T>> results = aa.collect();
+
+		assertEquals(count, results.size());
+
+		for (Result<T> result : results) {
+			assertEquals(score, result.getAdamicAdarScore().getValue(), ACCURACY);
+		}
+	}
+
 	@Test
-	public void testCompleteGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
+		// all vertex pairs are linked
+		long expectedCount = CombinatoricsUtils.binomialCoefficient((int) completeGraphVertexCount, 2);
+
 		float expectedScore = (completeGraphVertexCount - 2) / (float) Math.log(completeGraphVertexCount - 1);
 
-		DataSet<Result<LongValue>> aa = completeGraph
-			.run(new AdamicAdar<>());
+		validate(completeGraph, expectedCount, expectedScore);
+	}
 
-		for (Result<LongValue> result : aa.collect()) {
-			assertEquals(expectedScore, result.getAdamicAdarScore().getValue(), 0.00001);
-		}
+	@Test
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, 0, Double.NaN);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, 0, Double.NaN);
+	}
+
+	@Test
+	public void testWithStarGraph() throws Exception {
+		// all leaf vertices form a triplet with all other leaf vertices;
+		// only the center vertex is excluded
+		long expectedCount = CombinatoricsUtils.binomialCoefficient((int) starGraphVertexCount - 1, 2);
+
+		// the intersection includes only the center vertex
+		float expectedScore = 1 / (float) Math.log(starGraphVertexCount - 1);
+
+		validate(starGraph, expectedCount, expectedScore);
 	}
 
 	@Test
-	public void testRMatGraph()
-			throws Exception {
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Result<LongValue>> aa = undirectedRMatGraph(8, 8)
 			.run(new AdamicAdar<>());
 
diff --git a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/similarity/JaccardIndexTest.java b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/similarity/JaccardIndexTest.java
index 2e59f934ba4..0fc46565917 100644
--- a/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/similarity/JaccardIndexTest.java
+++ b/flink-libraries/flink-gelly/src/test/java/org/apache/flink/graph/library/similarity/JaccardIndexTest.java
@@ -19,28 +19,31 @@
 package org.apache.flink.graph.library.similarity;
 
 import org.apache.flink.api.java.DataSet;
+import org.apache.flink.graph.Graph;
 import org.apache.flink.graph.asm.AsmTestBase;
 import org.apache.flink.graph.asm.dataset.ChecksumHashCode;
 import org.apache.flink.graph.asm.dataset.ChecksumHashCode.Checksum;
 import org.apache.flink.graph.library.similarity.JaccardIndex.Result;
 import org.apache.flink.test.util.TestBaseUtils;
+import org.apache.flink.types.CopyableValue;
 import org.apache.flink.types.IntValue;
 import org.apache.flink.types.LongValue;
 import org.apache.flink.types.NullValue;
 
+import org.apache.commons.math3.util.CombinatoricsUtils;
 import org.junit.Test;
 
+import java.util.List;
+
 import static org.junit.Assert.assertEquals;
 
 /**
  * Tests for {@link JaccardIndex}.
  */
-public class JaccardIndexTest
-extends AsmTestBase {
+public class JaccardIndexTest extends AsmTestBase {
 
 	@Test
-	public void testSimpleGraph()
-			throws Exception {
+	public void testSimpleGraph() throws Exception {
 		DataSet<Result<IntValue>> ji = undirectedSimpleGraph
 			.run(new JaccardIndex<>());
 
@@ -61,8 +64,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testSimpleGraphWithMinimumScore()
-			throws Exception {
+	public void testWithSimpleGraphWithMinimumScore() throws Exception {
 		DataSet<Result<IntValue>> ji = undirectedSimpleGraph
 			.run(new JaccardIndex<IntValue, NullValue, NullValue>()
 				.setMinimumScore(1, 2));
@@ -76,8 +78,7 @@ extends AsmTestBase {
 	}
 
 	@Test
-	public void testSimpleGraphWithMaximumScore()
-			throws Exception {
+	public void testWithSimpleGraphWithMaximumScore() throws Exception {
 		DataSet<Result<IntValue>> ji = undirectedSimpleGraph
 			.run(new JaccardIndex<IntValue, NullValue, NullValue>()
 				.setMaximumScore(1, 2));
@@ -97,25 +98,73 @@ extends AsmTestBase {
 		TestBaseUtils.compareResultAsText(ji.collect(), expectedResult);
 	}
 
-	@Test
-	public void testCompleteGraph()
-			throws Exception {
-		DataSet<Result<LongValue>> ji = completeGraph
-			.run(new JaccardIndex<LongValue, NullValue, NullValue>()
+	/**
+	 * Validate a test where each result has the same values.
+	 *
+	 * @param graph input graph
+	 * @param count number of results
+	 * @param distinctNeighborCount result distinct neighbor count
+	 * @param sharedNeighborCount result shared neighbor count
+	 * @param <T> graph ID type
+	 * @throws Exception on error
+	 */
+	private static <T extends CopyableValue<T>> void validate(
+			Graph<T, NullValue, NullValue> graph, long count, long distinctNeighborCount, long sharedNeighborCount) throws Exception {
+		DataSet<Result<T>> ji = graph
+			.run(new JaccardIndex<T, NullValue, NullValue>()
 				.setGroupSize(4));
 
-		for (Result<LongValue> result : ji.collect()) {
-			// the intersection includes every vertex
-			assertEquals(completeGraphVertexCount, result.getDistinctNeighborCount().getValue());
+		List<Result<T>> results = ji.collect();
 
-			// the union only excludes the two vertices from the similarity score
-			assertEquals(completeGraphVertexCount - 2, result.getSharedNeighborCount().getValue());
+		assertEquals(count, results.size());
+
+		for (Result<T> result : results) {
+			assertEquals(distinctNeighborCount, result.getDistinctNeighborCount().getValue());
+			assertEquals(sharedNeighborCount, result.getSharedNeighborCount().getValue());
 		}
 	}
 
 	@Test
-	public void testRMatGraph()
-			throws Exception {
+	public void testWithCompleteGraph() throws Exception {
+		// all vertex pairs are linked
+		long expectedCount = CombinatoricsUtils.binomialCoefficient((int) completeGraphVertexCount, 2);
+
+		// the intersection includes every vertex
+		long expectedDistinctNeighborCount = completeGraphVertexCount;
+
+		// the union only excludes the two vertices from the similarity score
+		long expectedSharedNeighborCount = completeGraphVertexCount - 2;
+
+		validate(completeGraph, expectedCount, expectedDistinctNeighborCount, expectedSharedNeighborCount);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithVertices() throws Exception {
+		validate(emptyGraphWithVertices, 0, 0, 0);
+	}
+
+	@Test
+	public void testWithEmptyGraphWithoutVertices() throws Exception {
+		validate(emptyGraphWithoutVertices, 0, 0, 0);
+	}
+
+	@Test
+	public void testWithStarGraph() throws Exception {
+		// all leaf vertices form a triplet with all other leaf vertices;
+		// only the center vertex is excluded
+		long expectedCount = CombinatoricsUtils.binomialCoefficient((int) starGraphVertexCount - 1, 2);
+
+		// the intersection includes only the center vertex
+		long expectedDistinctNeighborCount = 1;
+
+		// the union includes only the center vertex
+		long expectedSharedNeighborCount = 1;
+
+		validate(starGraph, expectedCount, expectedDistinctNeighborCount, expectedSharedNeighborCount);
+	}
+
+	@Test
+	public void testWithRMatGraph() throws Exception {
 		DataSet<Result<LongValue>> ji = undirectedRMatGraph(8, 8)
 			.run(new JaccardIndex<LongValue, NullValue, NullValue>()
 				.setGroupSize(4));
