diff --git a/flink-python/pyflink/fn_execution/coder_impl_fast.pyx b/flink-python/pyflink/fn_execution/coder_impl_fast.pyx
index 0d2a8b1d4db..6d98c350cb0 100644
--- a/flink-python/pyflink/fn_execution/coder_impl_fast.pyx
+++ b/flink-python/pyflink/fn_execution/coder_impl_fast.pyx
@@ -700,8 +700,8 @@ cdef class FlattenRowCoderImpl(BaseCoderImpl):
             # Row
             row_field_coders = (<RowCoderImpl> field_coder).field_coders
             row_field_count = len(row_field_coders)
-            leading_complete_bytes_num = row_field_count // 8
-            remaining_bits_num = row_field_count % 8
+            leading_complete_bytes_num = (row_field_count + ROW_KIND_BIT_SIZE) // 8
+            remaining_bits_num = (row_field_count + ROW_KIND_BIT_SIZE) % 8
             row_value = list(item)
             row_kind_value = item._row_kind.value
             self._write_mask(row_value, leading_complete_bytes_num, remaining_bits_num, row_kind_value, row_field_count)
diff --git a/flink-python/pyflink/fn_execution/tests/test_fast_coders.py b/flink-python/pyflink/fn_execution/tests/test_fast_coders.py
index f3f7e825315..51ba9dbb6f4 100644
--- a/flink-python/pyflink/fn_execution/tests/test_fast_coders.py
+++ b/flink-python/pyflink/fn_execution/tests/test_fast_coders.py
@@ -212,16 +212,16 @@ class CodersTest(PyFlinkTestCase):
 
     def test_cython_row_coder(self):
         from pyflink.common import Row, RowKind
-        field_count = 2
+        field_count = 15
         field_names = ['f{}'.format(i) for i in range(field_count)]
         row = Row(**{field_names[i]: None if i % 2 == 0 else i for i in range(field_count)})
         data = [row]
         python_field_coders = [coder_impl.RowCoderImpl([coder_impl.BigIntCoderImpl()
                                                         for _ in range(field_count)],
-                                                       field_names)]
+                                                       row._fields)]
         cython_field_coders = [coder_impl_fast.RowCoderImpl([coder_impl_fast.BigIntCoderImpl()
                                                              for _ in range(field_count)],
-                                                            field_names)]
+                                                            row._fields)]
         row.set_row_kind(RowKind.INSERT)
         self.check_cython_coder(python_field_coders, cython_field_coders, data)
         row.set_row_kind(RowKind.UPDATE_BEFORE)
