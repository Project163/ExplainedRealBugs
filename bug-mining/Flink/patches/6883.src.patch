diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/state/StateUtil.java b/flink-runtime/src/main/java/org/apache/flink/runtime/state/StateUtil.java
index 949107e1d43..324abbb0b95 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/state/StateUtil.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/state/StateUtil.java
@@ -63,6 +63,17 @@ public class StateUtil {
                 handlesToDiscard, StateObject::discardState);
     }
 
+    public static void discardStateObjectQuietly(StateObject stateObject) {
+        if (stateObject == null) {
+            return;
+        }
+        try {
+            stateObject.discardState();
+        } catch (Exception exception) {
+            LOG.warn("Discard {} exception.", stateObject, exception);
+        }
+    }
+
     /**
      * Discards the given state future by first trying to cancel it. If this is not possible, then
      * the state object contained in the future is calculated and afterwards discarded.
diff --git a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBStateUploader.java b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBStateUploader.java
index c6f4ad8c171..02270e82d7d 100644
--- a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBStateUploader.java
+++ b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/RocksDBStateUploader.java
@@ -23,6 +23,7 @@ import org.apache.flink.runtime.state.CheckpointStateOutputStream;
 import org.apache.flink.runtime.state.CheckpointStreamFactory;
 import org.apache.flink.runtime.state.CheckpointedStateScope;
 import org.apache.flink.runtime.state.StateHandleID;
+import org.apache.flink.runtime.state.StateUtil;
 import org.apache.flink.runtime.state.StreamStateHandle;
 import org.apache.flink.util.ExceptionUtils;
 import org.apache.flink.util.FlinkRuntimeException;
@@ -62,13 +63,19 @@ public class RocksDBStateUploader extends RocksDBStateDataTransfer {
             @Nonnull Map<StateHandleID, Path> files,
             CheckpointStreamFactory checkpointStreamFactory,
             CheckpointedStateScope stateScope,
-            CloseableRegistry closeableRegistry)
+            CloseableRegistry closeableRegistry,
+            CloseableRegistry tmpResourcesRegistry)
             throws Exception {
 
         Map<StateHandleID, StreamStateHandle> handles = new HashMap<>();
 
         Map<StateHandleID, CompletableFuture<StreamStateHandle>> futures =
-                createUploadFutures(files, checkpointStreamFactory, stateScope, closeableRegistry);
+                createUploadFutures(
+                        files,
+                        checkpointStreamFactory,
+                        stateScope,
+                        closeableRegistry,
+                        tmpResourcesRegistry);
 
         try {
             FutureUtils.waitForAll(futures.values()).get();
@@ -94,7 +101,8 @@ public class RocksDBStateUploader extends RocksDBStateDataTransfer {
             Map<StateHandleID, Path> files,
             CheckpointStreamFactory checkpointStreamFactory,
             CheckpointedStateScope stateScope,
-            CloseableRegistry closeableRegistry) {
+            CloseableRegistry closeableRegistry,
+            CloseableRegistry tmpResourcesRegistry) {
         Map<StateHandleID, CompletableFuture<StreamStateHandle>> futures =
                 new HashMap<>(files.size());
 
@@ -106,7 +114,8 @@ public class RocksDBStateUploader extends RocksDBStateDataTransfer {
                                             entry.getValue(),
                                             checkpointStreamFactory,
                                             stateScope,
-                                            closeableRegistry));
+                                            closeableRegistry,
+                                            tmpResourcesRegistry));
             futures.put(entry.getKey(), CompletableFuture.supplyAsync(supplier, executorService));
         }
 
@@ -117,7 +126,8 @@ public class RocksDBStateUploader extends RocksDBStateDataTransfer {
             Path filePath,
             CheckpointStreamFactory checkpointStreamFactory,
             CheckpointedStateScope stateScope,
-            CloseableRegistry closeableRegistry)
+            CloseableRegistry closeableRegistry,
+            CloseableRegistry tmpResourcesRegistry)
             throws IOException {
 
         InputStream inputStream = null;
@@ -142,11 +152,15 @@ public class RocksDBStateUploader extends RocksDBStateDataTransfer {
                 outputStream.write(buffer, 0, numBytes);
             }
 
-            StreamStateHandle result = null;
+            final StreamStateHandle result;
             if (closeableRegistry.unregisterCloseable(outputStream)) {
                 result = outputStream.closeAndGetHandle();
                 outputStream = null;
+            } else {
+                result = null;
             }
+            tmpResourcesRegistry.registerCloseable(
+                    () -> StateUtil.discardStateObjectQuietly(result));
             return result;
 
         } finally {
diff --git a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksDBSnapshotStrategyBase.java b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksDBSnapshotStrategyBase.java
index de2be83d8ef..6db43289cad 100644
--- a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksDBSnapshotStrategyBase.java
+++ b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksDBSnapshotStrategyBase.java
@@ -40,7 +40,6 @@ import org.apache.flink.runtime.state.SnapshotResources;
 import org.apache.flink.runtime.state.SnapshotResult;
 import org.apache.flink.runtime.state.SnapshotStrategy;
 import org.apache.flink.runtime.state.StateHandleID;
-import org.apache.flink.runtime.state.StateObject;
 import org.apache.flink.runtime.state.StateUtil;
 import org.apache.flink.runtime.state.StreamStateHandle;
 import org.apache.flink.runtime.state.metainfo.StateMetaInfoSnapshot;
@@ -228,12 +227,12 @@ public abstract class RocksDBSnapshotStrategyBase<K, R extends SnapshotResources
     }
 
     protected void cleanupIncompleteSnapshot(
-            @Nonnull List<StateObject> statesToDiscard,
+            @Nonnull CloseableRegistry tmpResourcesRegistry,
             @Nonnull SnapshotDirectory localBackupDirectory) {
         try {
-            StateUtil.bestEffortDiscardAllStateObjects(statesToDiscard);
+            tmpResourcesRegistry.close();
         } catch (Exception e) {
-            LOG.warn("Could not properly discard states.", e);
+            LOG.warn("Could not properly clean tmp resources.", e);
         }
 
         if (localBackupDirectory.isSnapshotCompleted()) {
@@ -252,6 +251,7 @@ public abstract class RocksDBSnapshotStrategyBase<K, R extends SnapshotResources
     @Nonnull
     protected SnapshotResult<StreamStateHandle> materializeMetaData(
             @Nonnull CloseableRegistry snapshotCloseableRegistry,
+            @Nonnull CloseableRegistry tmpResourcesRegistry,
             @Nonnull List<StateMetaInfoSnapshot> stateMetaInfoSnapshots,
             long checkpointId,
             @Nonnull CheckpointStreamFactory checkpointStreamFactory)
@@ -287,6 +287,8 @@ public abstract class RocksDBSnapshotStrategyBase<K, R extends SnapshotResources
                 SnapshotResult<StreamStateHandle> result =
                         streamWithResultProvider.closeAndFinalizeCheckpointStreamResult();
                 streamWithResultProvider = null;
+                tmpResourcesRegistry.registerCloseable(
+                        () -> StateUtil.discardStateObjectQuietly(result));
                 return result;
             } else {
                 throw new IOException("Stream already closed and cannot return a handle.");
@@ -316,6 +318,8 @@ public abstract class RocksDBSnapshotStrategyBase<K, R extends SnapshotResources
         /** Local directory for the RocksDB native backup. */
         @Nonnull protected final SnapshotDirectory localBackupDirectory;
 
+        @Nonnull protected final CloseableRegistry tmpResourcesRegistry;
+
         protected RocksDBSnapshotOperation(
                 long checkpointId,
                 @Nonnull CheckpointStreamFactory checkpointStreamFactory,
@@ -325,6 +329,7 @@ public abstract class RocksDBSnapshotStrategyBase<K, R extends SnapshotResources
             this.checkpointStreamFactory = checkpointStreamFactory;
             this.stateMetaInfoSnapshots = stateMetaInfoSnapshots;
             this.localBackupDirectory = localBackupDirectory;
+            this.tmpResourcesRegistry = new CloseableRegistry();
         }
 
         protected Optional<KeyedStateHandle> getLocalSnapshot(
diff --git a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksIncrementalSnapshotStrategy.java b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksIncrementalSnapshotStrategy.java
index 67c6a9659e4..f93f41fbaa0 100644
--- a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksIncrementalSnapshotStrategy.java
+++ b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksIncrementalSnapshotStrategy.java
@@ -35,7 +35,6 @@ import org.apache.flink.runtime.state.PlaceholderStreamStateHandle;
 import org.apache.flink.runtime.state.SnapshotDirectory;
 import org.apache.flink.runtime.state.SnapshotResult;
 import org.apache.flink.runtime.state.StateHandleID;
-import org.apache.flink.runtime.state.StateObject;
 import org.apache.flink.runtime.state.StreamStateHandle;
 import org.apache.flink.runtime.state.metainfo.StateMetaInfoSnapshot;
 import org.apache.flink.util.Preconditions;
@@ -50,7 +49,6 @@ import javax.annotation.Nonnull;
 
 import java.io.File;
 import java.nio.file.Path;
-import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.LinkedHashMap;
 import java.util.List;
@@ -279,6 +277,7 @@ public class RocksIncrementalSnapshotStrategy<K>
                 metaStateHandle =
                         materializeMetaData(
                                 snapshotCloseableRegistry,
+                                tmpResourcesRegistry,
                                 stateMetaInfoSnapshots,
                                 checkpointId,
                                 checkpointStreamFactory);
@@ -289,7 +288,8 @@ public class RocksIncrementalSnapshotStrategy<K>
                         metaStateHandle.getJobManagerOwnedSnapshot(),
                         "Metadata for job manager was not properly created.");
 
-                uploadSstFiles(sstFiles, miscFiles, snapshotCloseableRegistry);
+                uploadSstFiles(
+                        sstFiles, miscFiles, snapshotCloseableRegistry, tmpResourcesRegistry);
                 long checkpointedSize = metaStateHandle.getStateSize();
                 checkpointedSize += getUploadedStateSize(sstFiles.values());
                 checkpointedSize += getUploadedStateSize(miscFiles.values());
@@ -329,12 +329,7 @@ public class RocksIncrementalSnapshotStrategy<K>
                 return snapshotResult;
             } finally {
                 if (!completed) {
-                    final List<StateObject> statesToDiscard =
-                            new ArrayList<>(1 + miscFiles.size() + sstFiles.size());
-                    statesToDiscard.add(metaStateHandle);
-                    statesToDiscard.addAll(miscFiles.values());
-                    statesToDiscard.addAll(sstFiles.values());
-                    cleanupIncompleteSnapshot(statesToDiscard, localBackupDirectory);
+                    cleanupIncompleteSnapshot(tmpResourcesRegistry, localBackupDirectory);
                 }
             }
         }
@@ -342,7 +337,8 @@ public class RocksIncrementalSnapshotStrategy<K>
         private void uploadSstFiles(
                 @Nonnull Map<StateHandleID, StreamStateHandle> sstFiles,
                 @Nonnull Map<StateHandleID, StreamStateHandle> miscFiles,
-                @Nonnull CloseableRegistry snapshotCloseableRegistry)
+                @Nonnull CloseableRegistry snapshotCloseableRegistry,
+                @Nonnull CloseableRegistry tmpResourcesRegistry)
                 throws Exception {
 
             // write state data
@@ -364,13 +360,15 @@ public class RocksIncrementalSnapshotStrategy<K>
                                 sstFilePaths,
                                 checkpointStreamFactory,
                                 stateScope,
-                                snapshotCloseableRegistry));
+                                snapshotCloseableRegistry,
+                                tmpResourcesRegistry));
                 miscFiles.putAll(
                         stateUploader.uploadFilesToCheckpointFs(
                                 miscFilePaths,
                                 checkpointStreamFactory,
                                 stateScope,
-                                snapshotCloseableRegistry));
+                                snapshotCloseableRegistry,
+                                tmpResourcesRegistry));
 
                 synchronized (uploadedStateIDs) {
                     switch (sharingFilesStrategy) {
diff --git a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksNativeFullSnapshotStrategy.java b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksNativeFullSnapshotStrategy.java
index eafffebe4ca..a6d4f843d7d 100644
--- a/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksNativeFullSnapshotStrategy.java
+++ b/flink-state-backends/flink-statebackend-rocksdb/src/main/java/org/apache/flink/contrib/streaming/state/snapshot/RocksNativeFullSnapshotStrategy.java
@@ -33,7 +33,6 @@ import org.apache.flink.runtime.state.LocalRecoveryConfig;
 import org.apache.flink.runtime.state.SnapshotDirectory;
 import org.apache.flink.runtime.state.SnapshotResult;
 import org.apache.flink.runtime.state.StateHandleID;
-import org.apache.flink.runtime.state.StateObject;
 import org.apache.flink.runtime.state.StreamStateHandle;
 import org.apache.flink.runtime.state.metainfo.StateMetaInfoSnapshot;
 import org.apache.flink.util.Preconditions;
@@ -46,7 +45,6 @@ import javax.annotation.Nonnull;
 
 import java.io.File;
 import java.nio.file.Path;
-import java.util.ArrayList;
 import java.util.Collections;
 import java.util.HashMap;
 import java.util.LinkedHashMap;
@@ -174,6 +172,7 @@ public class RocksNativeFullSnapshotStrategy<K>
                 metaStateHandle =
                         materializeMetaData(
                                 snapshotCloseableRegistry,
+                                tmpResourcesRegistry,
                                 stateMetaInfoSnapshots,
                                 checkpointId,
                                 checkpointStreamFactory);
@@ -184,7 +183,7 @@ public class RocksNativeFullSnapshotStrategy<K>
                         metaStateHandle.getJobManagerOwnedSnapshot(),
                         "Metadata for job manager was not properly created.");
 
-                uploadSstFiles(privateFiles, snapshotCloseableRegistry);
+                uploadSstFiles(privateFiles, snapshotCloseableRegistry, tmpResourcesRegistry);
                 long checkpointedSize = metaStateHandle.getStateSize();
                 checkpointedSize += getUploadedStateSize(privateFiles.values());
 
@@ -215,18 +214,15 @@ public class RocksNativeFullSnapshotStrategy<K>
                 return snapshotResult;
             } finally {
                 if (!completed) {
-                    final List<StateObject> statesToDiscard =
-                            new ArrayList<>(1 + privateFiles.size());
-                    statesToDiscard.add(metaStateHandle);
-                    statesToDiscard.addAll(privateFiles.values());
-                    cleanupIncompleteSnapshot(statesToDiscard, localBackupDirectory);
+                    cleanupIncompleteSnapshot(tmpResourcesRegistry, localBackupDirectory);
                 }
             }
         }
 
         private void uploadSstFiles(
                 @Nonnull Map<StateHandleID, StreamStateHandle> privateFiles,
-                @Nonnull CloseableRegistry snapshotCloseableRegistry)
+                @Nonnull CloseableRegistry snapshotCloseableRegistry,
+                @Nonnull CloseableRegistry tmpResourcesRegistry)
                 throws Exception {
 
             // write state data
@@ -248,7 +244,8 @@ public class RocksNativeFullSnapshotStrategy<K>
                                 privateFilePaths,
                                 checkpointStreamFactory,
                                 CheckpointedStateScope.EXCLUSIVE,
-                                snapshotCloseableRegistry));
+                                snapshotCloseableRegistry,
+                                tmpResourcesRegistry));
             }
         }
     }
diff --git a/flink-state-backends/flink-statebackend-rocksdb/src/test/java/org/apache/flink/contrib/streaming/state/RocksDBStateUploaderTest.java b/flink-state-backends/flink-statebackend-rocksdb/src/test/java/org/apache/flink/contrib/streaming/state/RocksDBStateUploaderTest.java
index ea4b6fb6c10..fcb2ba23fa7 100644
--- a/flink-state-backends/flink-statebackend-rocksdb/src/test/java/org/apache/flink/contrib/streaming/state/RocksDBStateUploaderTest.java
+++ b/flink-state-backends/flink-statebackend-rocksdb/src/test/java/org/apache/flink/contrib/streaming/state/RocksDBStateUploaderTest.java
@@ -42,11 +42,13 @@ import java.io.FileOutputStream;
 import java.io.IOException;
 import java.nio.file.Files;
 import java.nio.file.Path;
+import java.util.Collections;
 import java.util.HashMap;
 import java.util.List;
 import java.util.Map;
 import java.util.UUID;
 import java.util.concurrent.ThreadLocalRandom;
+import java.util.concurrent.atomic.AtomicInteger;
 
 import static org.assertj.core.api.Assertions.assertThat;
 import static org.assertj.core.api.Assertions.assertThatThrownBy;
@@ -97,11 +99,91 @@ public class RocksDBStateUploaderTest extends TestLogger {
                                             filePaths,
                                             checkpointStreamFactory,
                                             CheckpointedStateScope.SHARED,
+                                            new CloseableRegistry(),
                                             new CloseableRegistry()))
                     .isEqualTo(expectedException);
         }
     }
 
+    @Test
+    void testUploadedSstCanBeCleanedUp() throws Exception {
+        SpecifiedException expectedException =
+                new SpecifiedException("throw exception while multi thread upload states.");
+
+        File checkpointPrivateFolder = TempDirUtils.newFolder(temporaryFolder, "private");
+        org.apache.flink.core.fs.Path checkpointPrivateDirectory =
+                org.apache.flink.core.fs.Path.fromLocalFile(checkpointPrivateFolder);
+
+        File checkpointSharedFolder = TempDirUtils.newFolder(temporaryFolder, "shared");
+        org.apache.flink.core.fs.Path checkpointSharedDirectory =
+                org.apache.flink.core.fs.Path.fromLocalFile(checkpointSharedFolder);
+
+        FileSystem fileSystem = checkpointPrivateDirectory.getFileSystem();
+
+        int sstFileCount = 6;
+        int fileStateSizeThreshold = 1024;
+        int writeBufferSize = 4096;
+        CheckpointStreamFactory checkpointStreamFactory =
+                new FsCheckpointStreamFactory(
+                        fileSystem,
+                        checkpointPrivateDirectory,
+                        checkpointSharedDirectory,
+                        fileStateSizeThreshold,
+                        writeBufferSize);
+
+        String localFolder = "local";
+        TempDirUtils.newFolder(temporaryFolder, localFolder);
+
+        Map<StateHandleID, Path> filePaths =
+                generateRandomSstFiles(localFolder, sstFileCount, fileStateSizeThreshold);
+        CloseableRegistry tmpResourcesRegistry = new CloseableRegistry();
+        try (RocksDBStateUploader rocksDBStateUploader = new RocksDBStateUploader(sstFileCount)) {
+            rocksDBStateUploader.uploadFilesToCheckpointFs(
+                    filePaths,
+                    checkpointStreamFactory,
+                    CheckpointedStateScope.SHARED,
+                    new CloseableRegistry(),
+                    tmpResourcesRegistry);
+
+            assertThatThrownBy(
+                            () ->
+                                    rocksDBStateUploader.uploadFilesToCheckpointFs(
+                                            filePaths,
+                                            new LastFailingCheckpointStateOutputStreamFactory(
+                                                    checkpointStreamFactory,
+                                                    sstFileCount,
+                                                    expectedException),
+                                            CheckpointedStateScope.SHARED,
+                                            new CloseableRegistry(),
+                                            tmpResourcesRegistry))
+                    .isEqualTo(expectedException);
+            assertThat(checkpointPrivateFolder.list()).isEmpty();
+            assertThat(checkpointSharedFolder.list()).isNotEmpty();
+
+            tmpResourcesRegistry.close();
+            // Check whether the temporary file before the exception can be cleaned up
+            assertThat(checkpointPrivateFolder.list()).isEmpty();
+            assertThat(checkpointSharedFolder.list()).isEmpty();
+
+            Map.Entry<StateHandleID, Path> first = filePaths.entrySet().stream().findFirst().get();
+            assertThatThrownBy(
+                            () ->
+                                    rocksDBStateUploader.uploadFilesToCheckpointFs(
+                                            Collections.singletonMap(
+                                                    first.getKey(), first.getValue()),
+                                            checkpointStreamFactory,
+                                            CheckpointedStateScope.SHARED,
+                                            new CloseableRegistry(),
+                                            tmpResourcesRegistry))
+                    .as("Cannot register Closeable, registry is already closed. Closing argument.")
+                    .isInstanceOf(IOException.class);
+
+            // Check whether the temporary file after the exception can be cleaned up.
+            assertThat(checkpointPrivateFolder.list()).isEmpty();
+            assertThat(checkpointSharedFolder.list()).isEmpty();
+        }
+    }
+
     /** Test that upload files with multi-thread correctly. */
     @Test
     void testMultiThreadUploadCorrectly() throws Exception {
@@ -137,6 +219,7 @@ public class RocksDBStateUploaderTest extends TestLogger {
                             sstFilePaths,
                             checkpointStreamFactory,
                             CheckpointedStateScope.SHARED,
+                            new CloseableRegistry(),
                             new CloseableRegistry());
 
             for (Map.Entry<StateHandleID, Path> entry : sstFilePaths.entrySet()) {
@@ -146,7 +229,7 @@ public class RocksDBStateUploaderTest extends TestLogger {
         }
     }
 
-    private CheckpointStateOutputStream createFailingCheckpointStateOutputStream(
+    private static CheckpointStateOutputStream createFailingCheckpointStateOutputStream(
             IOException failureException) {
         return new CheckpointStateOutputStream() {
             @Nullable
@@ -214,4 +297,46 @@ public class RocksDBStateUploaderTest extends TestLogger {
             super(message);
         }
     }
+
+    /** The last stream will be broken stream. */
+    private static class LastFailingCheckpointStateOutputStreamFactory
+            implements CheckpointStreamFactory {
+
+        private final CheckpointStreamFactory checkpointStreamFactory;
+        private final int streamTotalCount;
+        private final AtomicInteger streamCount;
+        private final IOException expectedException;
+
+        private LastFailingCheckpointStateOutputStreamFactory(
+                CheckpointStreamFactory checkpointStreamFactory,
+                int streamTotalCount,
+                IOException expectedException) {
+            this.checkpointStreamFactory = checkpointStreamFactory;
+            this.streamTotalCount = streamTotalCount;
+            this.expectedException = expectedException;
+            this.streamCount = new AtomicInteger();
+        }
+
+        @Override
+        public CheckpointStateOutputStream createCheckpointStateOutputStream(
+                CheckpointedStateScope scope) throws IOException {
+            if (streamCount.incrementAndGet() == streamTotalCount) {
+                return createFailingCheckpointStateOutputStream(expectedException);
+            }
+            return checkpointStreamFactory.createCheckpointStateOutputStream(scope);
+        }
+
+        @Override
+        public boolean canFastDuplicate(
+                StreamStateHandle stateHandle, CheckpointedStateScope scope) {
+            return false;
+        }
+
+        @Override
+        public List<StreamStateHandle> duplicate(
+                List<StreamStateHandle> stateHandles, CheckpointedStateScope scope)
+                throws IOException {
+            throw new UnsupportedOperationException();
+        }
+    }
 }
