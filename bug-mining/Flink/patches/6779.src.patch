diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/AbstractUdfStreamOperator.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/AbstractUdfStreamOperator.java
index d134077d267..70c7c805545 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/AbstractUdfStreamOperator.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/AbstractUdfStreamOperator.java
@@ -47,7 +47,8 @@ import static java.util.Objects.requireNonNull;
  */
 @PublicEvolving
 public abstract class AbstractUdfStreamOperator<OUT, F extends Function>
-        extends AbstractStreamOperator<OUT> implements OutputTypeConfigurable<OUT> {
+        extends AbstractStreamOperator<OUT>
+        implements OutputTypeConfigurable<OUT>, UserFunctionProvider<F> {
 
     private static final long serialVersionUID = 1L;
 
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/OutputFormatOperatorFactory.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/OutputFormatOperatorFactory.java
index d9207669931..406666b4c23 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/OutputFormatOperatorFactory.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/OutputFormatOperatorFactory.java
@@ -27,7 +27,7 @@ import org.apache.flink.api.common.io.OutputFormat;
  * @param <IN> The input type of the operator.
  */
 @Internal
-public interface OutputFormatOperatorFactory<IN> extends StreamOperatorFactory<Object> {
+public interface OutputFormatOperatorFactory<IN, OUT> extends StreamOperatorFactory<OUT> {
 
     /** @return output format of the operator created by this factory. */
     OutputFormat<IN> getOutputFormat();
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/SimpleOperatorFactory.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/SimpleOperatorFactory.java
index bb9692df3ef..95329baaef4 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/SimpleOperatorFactory.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/SimpleOperatorFactory.java
@@ -19,6 +19,7 @@ package org.apache.flink.streaming.api.operators;
 
 import org.apache.flink.annotation.Internal;
 import org.apache.flink.api.common.ExecutionConfig;
+import org.apache.flink.api.common.functions.Function;
 import org.apache.flink.api.common.typeinfo.TypeInformation;
 import org.apache.flink.api.java.typeutils.InputTypeConfigurable;
 import org.apache.flink.streaming.api.functions.sink.OutputFormatSinkFunction;
@@ -45,9 +46,14 @@ public class SimpleOperatorFactory<OUT> extends AbstractStreamOperatorFactory<OU
                 && ((StreamSource) operator).getUserFunction()
                         instanceof InputFormatSourceFunction) {
             return new SimpleInputFormatOperatorFactory<OUT>((StreamSource) operator);
-        } else if (operator instanceof StreamSink
-                && ((StreamSink) operator).getUserFunction() instanceof OutputFormatSinkFunction) {
-            return new SimpleOutputFormatOperatorFactory<>((StreamSink) operator);
+        } else if (operator instanceof UserFunctionProvider
+                && (((UserFunctionProvider<Function>) operator).getUserFunction()
+                        instanceof OutputFormatSinkFunction)) {
+            return new SimpleOutputFormatOperatorFactory<>(
+                    (((OutputFormatSinkFunction<?>)
+                                    ((UserFunctionProvider<Function>) operator).getUserFunction())
+                            .getFormat()),
+                    operator);
         } else if (operator instanceof AbstractUdfStreamOperator) {
             return new SimpleUdfStreamOperatorFactory<OUT>((AbstractUdfStreamOperator) operator);
         } else {
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/SimpleOutputFormatOperatorFactory.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/SimpleOutputFormatOperatorFactory.java
index a436cd8f736..7b17be00e41 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/SimpleOutputFormatOperatorFactory.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/SimpleOutputFormatOperatorFactory.java
@@ -19,30 +19,26 @@ package org.apache.flink.streaming.api.operators;
 
 import org.apache.flink.annotation.Internal;
 import org.apache.flink.api.common.io.OutputFormat;
-import org.apache.flink.streaming.api.functions.sink.OutputFormatSinkFunction;
-
-import static org.apache.flink.util.Preconditions.checkState;
 
 /**
- * A simple operator factory which create {@link StreamSink} containing an {@link OutputFormat}.
+ * A simple operator factory which create an operator containing an {@link OutputFormat}.
  *
  * @param <IN> The input type of the operator.
  */
 @Internal
-public class SimpleOutputFormatOperatorFactory<IN> extends SimpleOperatorFactory<Object>
-        implements OutputFormatOperatorFactory<IN> {
+public class SimpleOutputFormatOperatorFactory<IN, OUT> extends SimpleOperatorFactory<OUT>
+        implements OutputFormatOperatorFactory<IN, OUT> {
 
-    private final StreamSink<IN> operator;
+    private final OutputFormat<IN> outputFormat;
 
-    public SimpleOutputFormatOperatorFactory(StreamSink<IN> operator) {
+    public SimpleOutputFormatOperatorFactory(
+            OutputFormat<IN> outputFormat, StreamOperator<OUT> operator) {
         super(operator);
-
-        checkState(operator.getUserFunction() instanceof OutputFormatSinkFunction);
-        this.operator = operator;
+        this.outputFormat = outputFormat;
     }
 
     @Override
     public OutputFormat<IN> getOutputFormat() {
-        return ((OutputFormatSinkFunction<IN>) operator.getUserFunction()).getFormat();
+        return outputFormat;
     }
 }
diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/UserFunctionProvider.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/UserFunctionProvider.java
new file mode 100644
index 00000000000..d683a6306b0
--- /dev/null
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/operators/UserFunctionProvider.java
@@ -0,0 +1,28 @@
+/*
+ *  Licensed to the Apache Software Foundation (ASF) under one or more
+ *  contributor license agreements.  See the NOTICE file distributed with
+ *  this work for additional information regarding copyright ownership.
+ *  The ASF licenses this file to You under the Apache License, Version 2.0
+ *  (the "License"); you may not use this file except in compliance with
+ *  the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing, software
+ *  distributed under the License is distributed on an "AS IS" BASIS,
+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ *  See the License for the specific language governing permissions and
+ *  limitations under the License.
+ */
+
+package org.apache.flink.streaming.api.operators;
+
+import org.apache.flink.annotation.Internal;
+import org.apache.flink.api.common.functions.Function;
+
+/** The interface with user function. */
+@Internal
+public interface UserFunctionProvider<F extends Function> {
+
+    F getUserFunction();
+}
diff --git a/flink-table/flink-table-runtime/src/test/java/org/apache/flink/table/runtime/operators/sink/SinkOperatorTest.java b/flink-table/flink-table-runtime/src/test/java/org/apache/flink/table/runtime/operators/sink/SinkOperatorTest.java
new file mode 100644
index 00000000000..84c8e00f7f2
--- /dev/null
+++ b/flink-table/flink-table-runtime/src/test/java/org/apache/flink/table/runtime/operators/sink/SinkOperatorTest.java
@@ -0,0 +1,59 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.table.runtime.operators.sink;
+
+import org.apache.flink.api.common.io.OutputFormat;
+import org.apache.flink.configuration.Configuration;
+import org.apache.flink.streaming.api.functions.sink.OutputFormatSinkFunction;
+import org.apache.flink.streaming.api.operators.SimpleOperatorFactory;
+import org.apache.flink.streaming.api.operators.SimpleOutputFormatOperatorFactory;
+import org.apache.flink.table.data.RowData;
+
+import org.junit.jupiter.api.Test;
+
+import static org.assertj.core.api.Assertions.assertThat;
+
+/** Test for {@link SinkOperator}. */
+public class SinkOperatorTest {
+
+    @Test
+    public void testSinkOperatorWithOutputFormat() {
+        SinkOperator operator =
+                new SinkOperator(
+                        new OutputFormatSinkFunction<>(
+                                new OutputFormat<RowData>() {
+                                    private static final long serialVersionUID = 1L;
+
+                                    @Override
+                                    public void configure(Configuration parameters) {}
+
+                                    @Override
+                                    public void open(int taskNumber, int numTasks) {}
+
+                                    @Override
+                                    public void writeRecord(RowData record) {}
+
+                                    @Override
+                                    public void close() {}
+                                }),
+                        -1);
+        SimpleOperatorFactory<?> factory = SimpleOperatorFactory.of(operator);
+        assertThat(factory).isInstanceOf(SimpleOutputFormatOperatorFactory.class);
+    }
+}
