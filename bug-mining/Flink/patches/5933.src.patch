diff --git a/flink-queryable-state/flink-queryable-state-runtime/src/test/java/org/apache/flink/queryablestate/network/ClientTest.java b/flink-queryable-state/flink-queryable-state-runtime/src/test/java/org/apache/flink/queryablestate/network/ClientTest.java
index 13bb73b9f6a..83c86131e8b 100644
--- a/flink-queryable-state/flink-queryable-state-runtime/src/test/java/org/apache/flink/queryablestate/network/ClientTest.java
+++ b/flink-queryable-state/flink-queryable-state-runtime/src/test/java/org/apache/flink/queryablestate/network/ClientTest.java
@@ -73,6 +73,7 @@ import java.net.InetAddress;
 import java.net.InetSocketAddress;
 import java.net.UnknownHostException;
 import java.nio.channels.ClosedChannelException;
+import java.time.Duration;
 import java.util.ArrayList;
 import java.util.Collections;
 import java.util.List;
@@ -266,15 +267,10 @@ public class ClientTest extends TestLogger {
                     new KvStateInternalRequest(new KvStateID(), new byte[0]);
             CompletableFuture<KvStateResponse> future = client.sendRequest(serverAddress, request);
 
-            try {
-                future.get();
-                fail("Did not throw expected ConnectException");
-            } catch (ExecutionException e) {
-                if (!(e.getCause() instanceof ConnectException)) {
-                    fail("Did not throw expected ConnectException");
-                }
-                // else expected
-            }
+            assertThat(
+                    future,
+                    FlinkMatchers.futureWillCompleteExceptionally(
+                            ConnectException.class, Duration.ofHours(1)));
         } finally {
             if (client != null) {
                 try {
