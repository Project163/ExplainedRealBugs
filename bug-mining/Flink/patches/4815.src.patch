diff --git a/flink-connectors/flink-connector-hbase-1.4/src/test/java/org/apache/flink/connector/hbase1/util/HBaseTestingClusterAutoStarter.java b/flink-connectors/flink-connector-hbase-1.4/src/test/java/org/apache/flink/connector/hbase1/util/HBaseTestingClusterAutoStarter.java
index ace32b90410..58d6c62bcb7 100644
--- a/flink-connectors/flink-connector-hbase-1.4/src/test/java/org/apache/flink/connector/hbase1/util/HBaseTestingClusterAutoStarter.java
+++ b/flink-connectors/flink-connector-hbase-1.4/src/test/java/org/apache/flink/connector/hbase1/util/HBaseTestingClusterAutoStarter.java
@@ -114,9 +114,10 @@ public abstract class HBaseTestingClusterAutoStarter extends AbstractTestBase {
 		}
 	}
 
-	private static Configuration initialize(Configuration conf) {
-		conf = HBaseConfiguration.create(conf);
-		conf.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER, 1);
+	private static void initialize(Configuration c) {
+		conf = HBaseConfiguration.create(c);
+		// the default retry number is 35 in hbase-1.4, set 5 for test
+		conf.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER, 5);
 		try {
 			admin = TEST_UTIL.getHBaseAdmin();
 		} catch (MasterNotRunningException e) {
@@ -126,7 +127,6 @@ public abstract class HBaseTestingClusterAutoStarter extends AbstractTestBase {
 		} catch (IOException e) {
 			assertNull("IOException", e);
 		}
-		return conf;
 	}
 
 	@BeforeClass
@@ -147,7 +147,7 @@ public abstract class HBaseTestingClusterAutoStarter extends AbstractTestBase {
 		LOG.info("Hbase minicluster client port: " + TEST_UTIL.getZkCluster().getClientPort());
 		TEST_UTIL.getConfiguration().set("hbase.zookeeper.quorum", "localhost:" + TEST_UTIL.getZkCluster().getClientPort());
 
-		conf = initialize(TEST_UTIL.getConfiguration());
+		initialize(TEST_UTIL.getConfiguration());
 		LOG.info("HBase minicluster: Running");
 	}
 
diff --git a/flink-connectors/flink-connector-hbase-2.2/src/test/java/org/apache/flink/connector/hbase2/util/HBaseTestingClusterAutoStarter.java b/flink-connectors/flink-connector-hbase-2.2/src/test/java/org/apache/flink/connector/hbase2/util/HBaseTestingClusterAutoStarter.java
index 9e6acd0a6df..0606ff128db 100644
--- a/flink-connectors/flink-connector-hbase-2.2/src/test/java/org/apache/flink/connector/hbase2/util/HBaseTestingClusterAutoStarter.java
+++ b/flink-connectors/flink-connector-hbase-2.2/src/test/java/org/apache/flink/connector/hbase2/util/HBaseTestingClusterAutoStarter.java
@@ -110,7 +110,8 @@ public class HBaseTestingClusterAutoStarter {
 
 	private static void initialize(Configuration c) {
 		conf = HBaseConfiguration.create(c);
-		conf.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER, 1);
+		// the default retry number is 15 in hbase-2.2, set 5 for test
+		conf.setInt(HConstants.HBASE_CLIENT_RETRIES_NUMBER, 5);
 		try {
 			admin = TEST_UTIL.getAdmin();
 		} catch (MasterNotRunningException e) {
@@ -128,6 +129,14 @@ public class HBaseTestingClusterAutoStarter {
 		String hadoopVersion = System.getProperty("hadoop.version");
 		Assume.assumeTrue(HADOOP_VERSION_RANGE.contains(hadoopVersion));
 		TEST_UTIL.startMiniCluster(1);
+
+		// https://issues.apache.org/jira/browse/HBASE-11711
+		TEST_UTIL.getConfiguration().setInt("hbase.master.info.port", -1);
+
+		// Make sure the zookeeper quorum value contains the right port number (varies per run).
+		LOG.info("Hbase minicluster client port: " + TEST_UTIL.getZkCluster().getClientPort());
+		TEST_UTIL.getConfiguration().set("hbase.zookeeper.quorum", "localhost:" + TEST_UTIL.getZkCluster().getClientPort());
+
 		initialize(TEST_UTIL.getConfiguration());
 	}
 
