diff --git a/flink-tests/src/test/java/org/apache/flink/test/checkpointing/UnalignedCheckpointTestBase.java b/flink-tests/src/test/java/org/apache/flink/test/checkpointing/UnalignedCheckpointTestBase.java
index d71c8c690b5..72e82070d68 100644
--- a/flink-tests/src/test/java/org/apache/flink/test/checkpointing/UnalignedCheckpointTestBase.java
+++ b/flink-tests/src/test/java/org/apache/flink/test/checkpointing/UnalignedCheckpointTestBase.java
@@ -224,8 +224,8 @@ public abstract class UnalignedCheckpointTestBase extends TestLogger {
 
 			@Override
 			public void notifyCheckpointComplete(long checkpointId) {
-				LOG.info("notifyCheckpointComplete {} @ {} subtask (? attempt)", split.numCompletedCheckpoints, split.nextNumber % split.increment);
 				if (split != null) {
+					LOG.info("notifyCheckpointComplete {} @ {} subtask (? attempt)", split.numCompletedCheckpoints, split.nextNumber % split.increment);
 					split.numCompletedCheckpoints++;
 				}
 			}
@@ -330,6 +330,11 @@ public abstract class UnalignedCheckpointTestBase extends TestLogger {
 				}
 			}
 
+			@Override
+			public void notifyCheckpointComplete(long checkpointId) {
+				unassignedSplits.forEach(s -> s.numCompletedCheckpoints++);
+			}
+
 			@Override
 			public List<LongSplit> snapshotState() throws Exception {
 				LOG.info("snapshotState {}", unassignedSplits);
@@ -673,6 +678,5 @@ public abstract class UnalignedCheckpointTestBase extends TestLogger {
 			LOG.info("Last state {} @ {} subtask ({} attempt)", state, getRuntimeContext().getIndexOfThisSubtask(), getRuntimeContext().getAttemptNumber());
 			super.close();
 		}
-
 	}
 }
