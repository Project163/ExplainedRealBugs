diff --git a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/link_analysis/PageRank.java b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/link_analysis/PageRank.java
index c5c41782753..747735eba27 100644
--- a/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/link_analysis/PageRank.java
+++ b/flink-libraries/flink-gelly/src/main/java/org/apache/flink/graph/library/link_analysis/PageRank.java
@@ -45,7 +45,6 @@ import org.apache.flink.graph.asm.result.UnaryResult;
 import org.apache.flink.graph.library.link_analysis.Functions.SumScore;
 import org.apache.flink.graph.library.link_analysis.PageRank.Result;
 import org.apache.flink.graph.utils.GraphUtils;
-import org.apache.flink.graph.utils.GraphUtils.IdentityMapper;
 import org.apache.flink.graph.utils.Murmur3_32;
 import org.apache.flink.graph.utils.proxy.GraphAlgorithmWrappingDataSet;
 import org.apache.flink.types.DoubleValue;
@@ -176,10 +175,6 @@ extends GraphAlgorithmWrappingDataSet<K, VV, EV, Result<K>> {
 			.run(new VertexDegrees<K, VV, EV>()
 				.setParallelism(parallelism));
 
-		// prevent Exception "The dam has been closed." in TempBarrier
-		// for a simplified Graph as in PageRankITCase (see FLINK-5623)
-		vertexDegree = vertexDegree.map(new IdentityMapper<Vertex<K, Degrees>>());
-
 		// vertex count
 		DataSet<LongValue> vertexCount = GraphUtils.count(vertexDegree);
 
diff --git a/flink-runtime/src/main/java/org/apache/flink/runtime/operators/BatchTask.java b/flink-runtime/src/main/java/org/apache/flink/runtime/operators/BatchTask.java
index f7480794c40..87b0a76d0e8 100644
--- a/flink-runtime/src/main/java/org/apache/flink/runtime/operators/BatchTask.java
+++ b/flink-runtime/src/main/java/org/apache/flink/runtime/operators/BatchTask.java
@@ -884,6 +884,7 @@ public class BatchTask<S extends Function, OT> extends AbstractInvokable impleme
 					// close the async barrier if there is one
 					if (this.tempBarriers[i] != null) {
 						this.tempBarriers[i].close();
+						this.tempBarriers[i] = null;
 					}
 
 					// recreate the local strategy
