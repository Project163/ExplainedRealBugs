diff --git a/flink-connectors/flink-connector-filesystem/src/test/java/org/apache/flink/streaming/connectors/fs/bucketing/BucketingSinkTest.java b/flink-connectors/flink-connector-filesystem/src/test/java/org/apache/flink/streaming/connectors/fs/bucketing/BucketingSinkTest.java
index d671874f86e..090c54a7566 100644
--- a/flink-connectors/flink-connector-filesystem/src/test/java/org/apache/flink/streaming/connectors/fs/bucketing/BucketingSinkTest.java
+++ b/flink-connectors/flink-connector-filesystem/src/test/java/org/apache/flink/streaming/connectors/fs/bucketing/BucketingSinkTest.java
@@ -150,6 +150,19 @@ public class BucketingSinkTest {
 		hdfsCluster.shutdown();
 	}
 
+	@Test
+	public void testClosingWithoutInput() throws Exception {
+		final File outDir = tempFolder.newFolder();
+
+		OneInputStreamOperatorTestHarness<String, Object> testHarness = createRescalingTestSink(outDir, 1, 0, 100);
+		testHarness.setup();
+		testHarness.open();
+
+		// verify that we can close without ever having an input. An earlier version of the code
+		// was throwing an NPE because we never initialized some internal state
+		testHarness.close();
+	}
+
 	@Test
 	public void testInactivityPeriodWithLateNotify() throws Exception {
 		final File outDir = tempFolder.newFolder();
