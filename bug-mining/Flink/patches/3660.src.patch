diff --git a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClientYarnClusterInformationRetriever.java b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClientYarnClusterInformationRetriever.java
new file mode 100644
index 00000000000..78f65e0f170
--- /dev/null
+++ b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClientYarnClusterInformationRetriever.java
@@ -0,0 +1,56 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *    http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.yarn;
+
+import org.apache.flink.util.FlinkException;
+
+import org.apache.hadoop.yarn.api.records.NodeState;
+import org.apache.hadoop.yarn.client.api.YarnClient;
+import org.apache.hadoop.yarn.exceptions.YarnException;
+
+import java.io.IOException;
+
+/**
+ * {@link YarnClusterInformationRetriever} implementation which queries the Yarn cluster using
+ * a {@link YarnClient} instance.
+ */
+public final class YarnClientYarnClusterInformationRetriever implements YarnClusterInformationRetriever {
+	private final YarnClient yarnClient;
+
+	private YarnClientYarnClusterInformationRetriever(YarnClient yarnClient) {
+		this.yarnClient = yarnClient;
+	}
+
+	@Override
+	public int getMaxVcores() throws FlinkException {
+		try {
+			return yarnClient.getNodeReports(NodeState.RUNNING)
+				.stream()
+				.mapToInt(report -> report.getCapability().getVirtualCores())
+				.max()
+				.orElse(0);
+		} catch (YarnException | IOException e) {
+			throw new FlinkException("Couldn't get cluster description, please check on the YarnConfiguration", e);
+		}
+	}
+
+	public static YarnClientYarnClusterInformationRetriever create(YarnClient yarnClient) {
+		return new YarnClientYarnClusterInformationRetriever(yarnClient);
+	}
+}
diff --git a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterClientFactory.java b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterClientFactory.java
index 7fca2fce119..0b5beb250c2 100644
--- a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterClientFactory.java
+++ b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterClientFactory.java
@@ -75,6 +75,7 @@ public class YarnClusterClientFactory extends AbstractContainerizedClusterClient
 				configuration,
 				yarnConfiguration,
 				yarnClient,
+				YarnClientYarnClusterInformationRetriever.create(yarnClient),
 				false);
 	}
 }
diff --git a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterDescriptor.java b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterDescriptor.java
index 4b2dff6570d..bc5f9939a39 100644
--- a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterDescriptor.java
+++ b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterDescriptor.java
@@ -131,6 +131,8 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 
 	private final YarnClient yarnClient;
 
+	private final YarnClusterInformationRetriever yarnClusterInformationRetriever;
+
 	/** True if the descriptor must not shut down the YarnClient. */
 	private final boolean sharedYarnClient;
 
@@ -157,10 +159,12 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 			Configuration flinkConfiguration,
 			YarnConfiguration yarnConfiguration,
 			YarnClient yarnClient,
+			YarnClusterInformationRetriever yarnClusterInformationRetriever,
 			boolean sharedYarnClient) {
 
 		this.yarnConfiguration = Preconditions.checkNotNull(yarnConfiguration);
 		this.yarnClient = Preconditions.checkNotNull(yarnClient);
+		this.yarnClusterInformationRetriever = Preconditions.checkNotNull(yarnClusterInformationRetriever);
 		this.sharedYarnClient = sharedYarnClient;
 
 		this.flinkConfiguration = Preconditions.checkNotNull(flinkConfiguration);
@@ -265,7 +269,7 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 		this.shipFiles.addAll(shipFiles);
 	}
 
-	private void isReadyForDeployment(ClusterSpecification clusterSpecification) throws YarnDeploymentException {
+	private void isReadyForDeployment(ClusterSpecification clusterSpecification) throws Exception {
 
 		if (clusterSpecification.getNumberTaskManagers() <= 0) {
 			throw new YarnDeploymentException("Taskmanager count must be positive");
@@ -278,7 +282,7 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 		}
 
 		// Check if we don't exceed YARN's maximum virtual cores.
-		final int numYarnMaxVcores = getNumYarnMaxVcores();
+		final int numYarnMaxVcores = yarnClusterInformationRetriever.getMaxVcores();
 
 		int configuredAmVcores = flinkConfiguration.getInteger(YarnConfigOptions.APP_MASTER_VCORES);
 		if (configuredAmVcores > numYarnMaxVcores) {
@@ -308,20 +312,6 @@ public class YarnClusterDescriptor implements ClusterDescriptor<ApplicationId> {
 		}
 	}
 
-	@VisibleForTesting
-	protected int getNumYarnMaxVcores() throws YarnDeploymentException {
-		// Fetch numYarnMaxVcores from all the RUNNING nodes via yarnClient
-		try {
-			return yarnClient.getNodeReports(NodeState.RUNNING)
-				.stream()
-				.mapToInt(report -> report.getCapability().getVirtualCores())
-				.max()
-				.orElse(0);
-		} catch (Exception e) {
-			throw new YarnDeploymentException("Couldn't get cluster description, please check on the YarnConfiguration", e);
-		}
-	}
-
 	private static boolean allocateResource(int[] nodeManagers, int toAllocate) {
 		for (int i = 0; i < nodeManagers.length; i++) {
 			if (nodeManagers[i] >= toAllocate) {
diff --git a/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterInformationRetriever.java b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterInformationRetriever.java
new file mode 100644
index 00000000000..1d8bdfa53e5
--- /dev/null
+++ b/flink-yarn/src/main/java/org/apache/flink/yarn/YarnClusterInformationRetriever.java
@@ -0,0 +1,34 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *    http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.yarn;
+
+import org.apache.flink.util.FlinkException;
+
+/**
+ * Interface which allows to retrieve information about a Yarn cluster.
+ */
+public interface YarnClusterInformationRetriever {
+
+	/**
+	 * Get the maximum number of vcores supported by the Yarn cluster.
+	 *
+	 * @return max vcores supported by the cluster
+	 */
+	int getMaxVcores() throws FlinkException;
+}
diff --git a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorBuilder.java b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorBuilder.java
new file mode 100644
index 00000000000..20b8d35dd04
--- /dev/null
+++ b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorBuilder.java
@@ -0,0 +1,82 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *    http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.flink.yarn;
+
+import org.apache.flink.configuration.Configuration;
+
+import org.apache.hadoop.yarn.client.api.YarnClient;
+import org.apache.hadoop.yarn.conf.YarnConfiguration;
+
+import javax.annotation.Nullable;
+
+/**
+ * Builder for the {@link YarnClusterDescriptor}.
+ */
+public final class YarnClusterDescriptorBuilder {
+
+	private final YarnClient yarnClient;
+	private final boolean sharedYarnClient;
+
+	private Configuration flinkConfiguration = new Configuration();
+	private YarnConfiguration yarnConfiguration = new YarnConfiguration();
+
+	@Nullable
+	private YarnClusterInformationRetriever yarnClusterInformationRetriever = null;
+
+	private YarnClusterDescriptorBuilder(YarnClient yarnClient, boolean sharedYarnClient) {
+		this.yarnClient = yarnClient;
+		this.sharedYarnClient = sharedYarnClient;
+	}
+
+	public YarnClusterDescriptorBuilder setFlinkConfiguration(Configuration flinkConfiguration) {
+		this.flinkConfiguration = flinkConfiguration;
+		return this;
+	}
+
+	public YarnClusterDescriptorBuilder setYarnConfiguration(YarnConfiguration yarnConfiguration) {
+		this.yarnConfiguration = yarnConfiguration;
+		return this;
+	}
+
+	public YarnClusterDescriptorBuilder setYarnClusterInformationRetriever(YarnClusterInformationRetriever yarnClusterInformationRetriever) {
+		this.yarnClusterInformationRetriever = yarnClusterInformationRetriever;
+		return this;
+	}
+
+	public YarnClusterDescriptor build() {
+		final YarnClusterInformationRetriever clusterInformationRetriever;
+
+		if (yarnClusterInformationRetriever == null) {
+			clusterInformationRetriever = YarnClientYarnClusterInformationRetriever.create(yarnClient);
+		} else {
+			clusterInformationRetriever = yarnClusterInformationRetriever;
+		}
+
+		return new YarnClusterDescriptor(
+			flinkConfiguration,
+			yarnConfiguration,
+			yarnClient,
+			clusterInformationRetriever,
+			sharedYarnClient);
+	}
+
+	public static YarnClusterDescriptorBuilder newBuilder(YarnClient yarnClient, boolean sharedYarnClient) {
+		return new YarnClusterDescriptorBuilder(yarnClient, sharedYarnClient);
+	}
+}
diff --git a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorTest.java b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorTest.java
index 1b323803ffa..7c102117695 100644
--- a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorTest.java
+++ b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnClusterDescriptorTest.java
@@ -66,6 +66,7 @@ import static org.junit.Assert.fail;
  */
 public class YarnClusterDescriptorTest extends TestLogger {
 
+	private static final int YARN_MAX_VCORES = 16;
 	private static YarnConfiguration yarnConfiguration;
 
 	private static YarnClient yarnClient;
@@ -535,11 +536,13 @@ public class YarnClusterDescriptorTest extends TestLogger {
 	}
 
 	private YarnClusterDescriptor createYarnClusterDescriptor(Configuration configuration) {
-		return YarnTestUtils.createClusterDescriptorWithLogging(
-				temporaryFolder.getRoot().getAbsolutePath(),
-				configuration,
-				yarnConfiguration,
-				yarnClient,
-				true);
+		YarnTestUtils.configureLogFile(configuration, temporaryFolder.getRoot().getAbsolutePath());
+
+		return YarnClusterDescriptorBuilder.newBuilder(yarnClient, true)
+			.setFlinkConfiguration(configuration)
+			.setYarnConfiguration(yarnConfiguration)
+			.setYarnClusterInformationRetriever(() -> YARN_MAX_VCORES)
+			.build();
+
 	}
 }
diff --git a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnTestUtils.java b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnTestUtils.java
index e5ed6d53802..ec63d6d2310 100644
--- a/flink-yarn/src/test/java/org/apache/flink/yarn/YarnTestUtils.java
+++ b/flink-yarn/src/test/java/org/apache/flink/yarn/YarnTestUtils.java
@@ -32,8 +32,6 @@ import java.util.Arrays;
  */
 public class YarnTestUtils {
 
-	private static final int NUM_YARN_MAX_VCORES = 16;
-
 	static boolean isHadoopVersionGreaterThanOrEquals(final int major, final int minor) {
 		final String[] splitVersion = VersionInfo.getVersion().split("\\.");
 		final int[] versions = Arrays.stream(splitVersion).mapToInt(Integer::parseInt).toArray();
@@ -50,12 +48,16 @@ public class YarnTestUtils {
 			final YarnConfiguration yarnConfiguration,
 			final YarnClient yarnClient,
 			final boolean sharedYarnClient) {
-		final Configuration effectiveConfiguration = FlinkYarnSessionCli.setLogConfigFileInConfig(flinkConfiguration, flinkConfDir);
-		return new YarnClusterDescriptor(effectiveConfiguration, yarnConfiguration, yarnClient, sharedYarnClient) {
-			@Override
-			protected int getNumYarnMaxVcores() {
-				return NUM_YARN_MAX_VCORES;
-			}
-		};
+		final Configuration effectiveConfiguration = configureLogFile(flinkConfiguration, flinkConfDir);
+		return new YarnClusterDescriptor(
+			effectiveConfiguration,
+			yarnConfiguration,
+			yarnClient,
+			YarnClientYarnClusterInformationRetriever.create(yarnClient),
+			sharedYarnClient);
+	}
+
+	public static Configuration configureLogFile(Configuration flinkConfiguration, String flinkConfDir) {
+		return FlinkYarnSessionCli.setLogConfigFileInConfig(flinkConfiguration, flinkConfDir);
 	}
 }
