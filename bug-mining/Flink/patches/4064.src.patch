diff --git a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/SubtaskCheckpointCoordinatorImpl.java b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/SubtaskCheckpointCoordinatorImpl.java
index 37bf11206e1..2a0f78bf385 100644
--- a/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/SubtaskCheckpointCoordinatorImpl.java
+++ b/flink-streaming-java/src/main/java/org/apache/flink/streaming/runtime/tasks/SubtaskCheckpointCoordinatorImpl.java
@@ -164,7 +164,8 @@ class SubtaskCheckpointCoordinatorImpl implements SubtaskCheckpointCoordinator {
 			takeSnapshotSync(snapshotFutures, metadata, metrics, options, operatorChain, isCanceled);
 			finishAndReportAsync(snapshotFutures, metadata, metrics, options);
 		} catch (Exception ex) {
-			cleanup(snapshotFutures, metadata, metrics, options, ex);
+			cleanup(snapshotFutures, metadata, metrics);
+			throw ex;
 		}
 	}
 
@@ -185,8 +186,7 @@ class SubtaskCheckpointCoordinatorImpl implements SubtaskCheckpointCoordinator {
 	private void cleanup(
 			Map<OperatorID, OperatorSnapshotFutures> operatorSnapshotsInProgress,
 			CheckpointMetaData metadata,
-			CheckpointMetrics metrics, CheckpointOptions options,
-			Exception ex) throws Exception {
+			CheckpointMetrics metrics) throws Exception {
 
 		channelStateWriter.abort(metadata.getCheckpointId(), ex);
 		for (OperatorSnapshotFutures operatorSnapshotResult : operatorSnapshotsInProgress.values()) {
@@ -206,16 +206,6 @@ class SubtaskCheckpointCoordinatorImpl implements SubtaskCheckpointCoordinator {
 				metrics.getAlignmentDurationNanos() / 1_000_000,
 				metrics.getSyncDurationMillis());
 		}
-
-		if (options.getCheckpointType().isSynchronous()) {
-			// in the case of a synchronous checkpoint, we always rethrow the exception,
-			// so that the task fails.
-			// this is because the intention is always to stop the job after this checkpointing
-			// operation, and without the failure, the task would go back to normal execution.
-			throw ex;
-		} else {
-			env.declineCheckpoint(metadata.getCheckpointId(), ex);
-		}
 	}
 
 	private void prepareInflightDataSnapshot(long checkpointId) throws IOException {
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTest.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTest.java
index e8e52e86412..9d6d61842ae 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTest.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/StreamTaskTest.java
@@ -515,7 +515,7 @@ public class StreamTaskTest extends TestLogger {
 		OperatorSnapshotFutures operatorSnapshotResult1 = mock(OperatorSnapshotFutures.class);
 		OperatorSnapshotFutures operatorSnapshotResult2 = mock(OperatorSnapshotFutures.class);
 
-		final Exception testException = new Exception("Test exception");
+		final Exception testException = new ExpectedTestException();
 
 		RunningTask<MockStreamTask> task = runTask(() -> createMockStreamTask(
 			declineDummyEnvironment,
@@ -531,16 +531,19 @@ public class StreamTaskTest extends TestLogger {
 		streamTask.triggerCheckpointAsync(
 			new CheckpointMetaData(42L, 1L),
 			CheckpointOptions.forCheckpointWithDefaultLocation(),
-			false)
-			.get();
+			false);
 
-		assertEquals(testException, declineDummyEnvironment.getLastDeclinedCheckpointCause());
+		try {
+			task.waitForTaskCompletion(false);
+		}
+		catch (Exception ex) {
+			if (!ExceptionUtils.findThrowable(ex, ExpectedTestException.class).isPresent()) {
+				throw ex;
+			}
+		}
 
 		verify(operatorSnapshotResult1).cancel();
 		verify(operatorSnapshotResult2).cancel();
-
-		task.streamTask.finishInput();
-		task.waitForTaskCompletion(false);
 	}
 
 	/**
diff --git a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/TaskCheckpointingBehaviourTest.java b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/TaskCheckpointingBehaviourTest.java
index adb305471a5..9619bea8b4f 100644
--- a/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/TaskCheckpointingBehaviourTest.java
+++ b/flink-streaming-java/src/test/java/org/apache/flink/streaming/runtime/tasks/TaskCheckpointingBehaviourTest.java
@@ -54,7 +54,6 @@ import org.apache.flink.runtime.metrics.groups.UnregisteredMetricGroups;
 import org.apache.flink.runtime.query.KvStateRegistry;
 import org.apache.flink.runtime.shuffle.ShuffleEnvironment;
 import org.apache.flink.runtime.state.AbstractSnapshotStrategy;
-import org.apache.flink.runtime.state.AbstractStateBackend;
 import org.apache.flink.runtime.state.CheckpointStreamFactory;
 import org.apache.flink.runtime.state.CheckpointStreamFactory.CheckpointStateOutputStream;
 import org.apache.flink.runtime.state.DefaultOperatorStateBackend;
@@ -112,12 +111,16 @@ public class TaskCheckpointingBehaviourTest extends TestLogger {
 
 	@Test
 	public void testDeclineOnCheckpointErrorInSyncPart() throws Exception {
-		runTestDeclineOnCheckpointError(new SyncFailureInducingStateBackend());
+		TestDeclinedCheckpointResponder checkpointResponder = new TestDeclinedCheckpointResponder();
+		Task task = createTask(new FilterOperator(), new SyncFailureInducingStateBackend(), checkpointResponder);
+		runTaskExpectFailure(task);
 	}
 
 	@Test
 	public void testDeclineOnCheckpointErrorInAsyncPart() throws Exception {
-		runTestDeclineOnCheckpointError(new AsyncFailureInducingStateBackend());
+		TestDeclinedCheckpointResponder checkpointResponder = new TestDeclinedCheckpointResponder();
+		Task task = createTask(new FilterOperator(), new AsyncFailureInducingStateBackend(), checkpointResponder);
+		runTaskExpectCheckpointDeclined(task, checkpointResponder);
 	}
 
 	@Test
@@ -141,13 +144,7 @@ public class TaskCheckpointingBehaviourTest extends TestLogger {
 		assertNull(task.getFailureCause());
 	}
 
-	private void runTestDeclineOnCheckpointError(AbstractStateBackend backend) throws Exception{
-
-		TestDeclinedCheckpointResponder checkpointResponder = new TestDeclinedCheckpointResponder();
-
-		Task task =
-			createTask(new FilterOperator(), backend, checkpointResponder);
-
+	private void runTaskExpectCheckpointDeclined(Task task, TestDeclinedCheckpointResponder checkpointResponder) throws Exception{
 		// start the task and wait until it is in "restore"
 		task.startTaskThread();
 
@@ -159,6 +156,12 @@ public class TaskCheckpointingBehaviourTest extends TestLogger {
 		task.getExecutingThread().join();
 	}
 
+	private void runTaskExpectFailure(Task task) throws Exception{
+		task.startTaskThread();
+		task.getExecutingThread().join();
+		Assert.assertEquals(ExecutionState.FAILED, task.getExecutionState());
+	}
+
 	// ------------------------------------------------------------------------
 	//  Utilities
 	// ------------------------------------------------------------------------
